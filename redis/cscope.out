cscope 15 $HOME/pavise/redis               0004046398
	@deps/geohash-int/geohash.c

31 
	~"geohash.h
"

52 
šlše
 
ušt64_t
 
	$š‹¾—ve64
(
ušt32_t
 
xlo
, ušt32_ˆ
ylo
) {

53 cÚ¡ 
ušt64_t
 
B
[] = {0x5555555555555555ULL, 0x3333333333333333ULL,

56 cÚ¡ 
S
[] = {1, 2, 4, 8, 16};

58 
ušt64_t
 
x
 = 
xlo
;

59 
ušt64_t
 
y
 = 
ylo
;

61 
x
 = (x | (x << 
S
[4])è& 
B
[4];

62 
y
 = (y | (y << 
S
[4])è& 
B
[4];

64 
x
 = (x | (x << 
S
[3])è& 
B
[3];

65 
y
 = (y | (y << 
S
[3])è& 
B
[3];

67 
x
 = (x | (x << 
S
[2])è& 
B
[2];

68 
y
 = (y | (y << 
S
[2])è& 
B
[2];

70 
x
 = (x | (x << 
S
[1])è& 
B
[1];

71 
y
 = (y | (y << 
S
[1])è& 
B
[1];

73 
x
 = (x | (x << 
S
[0])è& 
B
[0];

74 
y
 = (y | (y << 
S
[0])è& 
B
[0];

76  
x
 | (
y
 << 1);

77 
	}
}

82 
šlše
 
ušt64_t
 
	$deš‹¾—ve64
(
ušt64_t
 
š‹¾—ved
) {

83 cÚ¡ 
ušt64_t
 
B
[] = {0x5555555555555555ULL, 0x3333333333333333ULL,

86 cÚ¡ 
S
[] = {0, 1, 2, 4, 8, 16};

88 
ušt64_t
 
x
 = 
š‹¾—ved
;

89 
ušt64_t
 
y
 = 
š‹¾—ved
 >> 1;

91 
x
 = (x | (x >> 
S
[0])è& 
B
[0];

92 
y
 = (y | (y >> 
S
[0])è& 
B
[0];

94 
x
 = (x | (x >> 
S
[1])è& 
B
[1];

95 
y
 = (y | (y >> 
S
[1])è& 
B
[1];

97 
x
 = (x | (x >> 
S
[2])è& 
B
[2];

98 
y
 = (y | (y >> 
S
[2])è& 
B
[2];

100 
x
 = (x | (x >> 
S
[3])è& 
B
[3];

101 
y
 = (y | (y >> 
S
[3])è& 
B
[3];

103 
x
 = (x | (x >> 
S
[4])è& 
B
[4];

104 
y
 = (y | (y >> 
S
[4])è& 
B
[4];

106 
x
 = (x | (x >> 
S
[5])è& 
B
[5];

107 
y
 = (y | (y >> 
S
[5])è& 
B
[5];

109  
x
 | (
y
 << 32);

110 
	}
}

112 
	$geohashG‘CoÜdRªge
(
GeoHashRªge
 *
lÚg_¿nge
, GeoHashRªg*
Ït_¿nge
) {

115 
lÚg_¿nge
->
max
 = 
GEO_LONG_MAX
;

116 
lÚg_¿nge
->
mš
 = 
GEO_LONG_MIN
;

117 
Ït_¿nge
->
max
 = 
GEO_LAT_MAX
;

118 
Ït_¿nge
->
mš
 = 
GEO_LAT_MIN
;

119 
	}
}

121 
	$geohashEncode
(cÚ¡ 
GeoHashRªge
 *
lÚg_¿nge
, cÚ¡ GeoHashRªg*
Ït_¿nge
,

122 
lÚg™ude
, 
Ït™ude
, 
ušt8_t
 
¡•
,

123 
GeoHashB™s
 *
hash
) {

125 ià(
hash
 =ğ
NULL
 || 
¡•
 > 32 || step == 0 ||

126 
	`RANGEPISZERO
(
Ït_¿nge
è|| RANGEPISZERO(
lÚg_¿nge
))  0;

130 ià(
lÚg™ude
 > 180 ||†ongitude < -180 ||

131 
Ït™ude
 > 85.05112878 ||†atitude < -85.05112878)  0;

133 
hash
->
b™s
 = 0;

134 
hash
->
¡•
 = step;

136 ià(
Ït™ude
 < 
Ït_¿nge
->
mš
 ||†©™ud>†©_¿nge->
max
 ||

137 
lÚg™ude
 < 
lÚg_¿nge
->
mš
 ||†Úg™ud>†Úg_¿nge->
max
) {

141 
Ït_off£t
 =

142 (
Ït™ude
 - 
Ït_¿nge
->
mš
è/ (Ït_¿nge->
max
 -†at_range->min);

143 
lÚg_off£t
 =

144 (
lÚg™ude
 - 
lÚg_¿nge
->
mš
è/ (lÚg_¿nge->
max
 -†ong_range->min);

147 
Ït_off£t
 *ğ(1 << 
¡•
);

148 
lÚg_off£t
 *ğ(1 << 
¡•
);

149 
hash
->
b™s
 = 
	`š‹¾—ve64
(
Ït_off£t
, 
lÚg_off£t
);

151 
	}
}

153 
	$geohashEncodeTy³
(
lÚg™ude
, 
Ït™ude
, 
ušt8_t
 
¡•
, 
GeoHashB™s
 *
hash
) {

154 
GeoHashRªge
 
r
[2] = { { 0 } };

155 
	`geohashG‘CoÜdRªge
(&
r
[0], &r[1]);

156  
	`geohashEncode
(&
r
[0], &r[1], 
lÚg™ude
, 
Ït™ude
, 
¡•
, 
hash
);

157 
	}
}

159 
	$geohashEncodeWGS84
(
lÚg™ude
, 
Ït™ude
, 
ušt8_t
 
¡•
,

160 
GeoHashB™s
 *
hash
) {

161  
	`geohashEncodeTy³
(
lÚg™ude
, 
Ït™ude
, 
¡•
, 
hash
);

162 
	}
}

164 
	$geohashDecode
(cÚ¡ 
GeoHashRªge
 
lÚg_¿nge
, cÚ¡ GeoHashRªg
Ït_¿nge
,

165 cÚ¡ 
GeoHashB™s
 
hash
, 
GeoHashA»a
 *
¬—
) {

166 ià(
	`HASHISZERO
(
hash
è|| 
NULL
 =ğ
¬—
 || 
	`RANGEISZERO
(
Ït_¿nge
) ||

167 
	`RANGEISZERO
(
lÚg_¿nge
)) {

171 
¬—
->
hash
 = hash;

172 
ušt8_t
 
¡•
 = 
hash
.step;

173 
ušt64_t
 
hash_£p
 = 
	`deš‹¾—ve64
(
hash
.
b™s
);

175 
Ït_sÿË
 = 
Ït_¿nge
.
max
 -†©_¿nge.
mš
;

176 
lÚg_sÿË
 = 
lÚg_¿nge
.
max
 -†Úg_¿nge.
mš
;

178 
ušt32_t
 
©o
 = 
hash_£p
;

179 
ušt32_t
 
Úo
 = 
hash_£p
 >> 32;

184 
¬—
->
Ït™ude
.
mš
 =

185 
Ït_¿nge
.
mš
 + (
©o
 * 1.0 / (1uÎ << 
¡•
)è* 
Ït_sÿË
;

186 
¬—
->
Ït™ude
.
max
 =

187 
Ït_¿nge
.
mš
 + ((
©o
 + 1è* 1.0 / (1uÎ << 
¡•
)è* 
Ït_sÿË
;

188 
¬—
->
lÚg™ude
.
mš
 =

189 
lÚg_¿nge
.
mš
 + (
Úo
 * 1.0 / (1uÎ << 
¡•
)è* 
lÚg_sÿË
;

190 
¬—
->
lÚg™ude
.
max
 =

191 
lÚg_¿nge
.
mš
 + ((
Úo
 + 1è* 1.0 / (1uÎ << 
¡•
)è* 
lÚg_sÿË
;

194 
	}
}

196 
	$geohashDecodeTy³
(cÚ¡ 
GeoHashB™s
 
hash
, 
GeoHashA»a
 *
¬—
) {

197 
GeoHashRªge
 
r
[2] = { { 0 } };

198 
	`geohashG‘CoÜdRªge
(&
r
[0], &r[1]);

199  
	`geohashDecode
(
r
[0],„[1], 
hash
, 
¬—
);

200 
	}
}

202 
	$geohashDecodeWGS84
(cÚ¡ 
GeoHashB™s
 
hash
, 
GeoHashA»a
 *
¬—
) {

203  
	`geohashDecodeTy³
(
hash
, 
¬—
);

204 
	}
}

206 
	$geohashDecodeA»aToLÚgL©
(cÚ¡ 
GeoHashA»a
 *
¬—
, *
xy
) {

207 ià(!
xy
)  0;

208 
xy
[0] = (
¬—
->
lÚg™ude
.
mš
 +‡»a->lÚg™ude.
max
) / 2;

209 
xy
[1] = (
¬—
->
Ït™ude
.
mš
 +‡»a->Ït™ude.
max
) / 2;

211 
	}
}

213 
	$geohashDecodeToLÚgL©Ty³
(cÚ¡ 
GeoHashB™s
 
hash
, *
xy
) {

214 
GeoHashA»a
 
¬—
 = { { 0 } };

215 ià(!
xy
 || !
	`geohashDecodeTy³
(
hash
, &
¬—
))

217  
	`geohashDecodeA»aToLÚgL©
(&
¬—
, 
xy
);

218 
	}
}

220 
	$geohashDecodeToLÚgL©WGS84
(cÚ¡ 
GeoHashB™s
 
hash
, *
xy
) {

221  
	`geohashDecodeToLÚgL©Ty³
(
hash
, 
xy
);

222 
	}
}

224 
	$geohash_move_x
(
GeoHashB™s
 *
hash
, 
št8_t
 
d
) {

225 ià(
d
 == 0)

228 
ušt64_t
 
x
 = 
hash
->
b™s
 & 0xaaaaaaaaaaaaaaaaULL;

229 
ušt64_t
 
y
 = 
hash
->
b™s
 & 0x5555555555555555ULL;

231 
ušt64_t
 
zz
 = 0x5555555555555555ULL >> (64 - 
hash
->
¡•
 * 2);

233 ià(
d
 > 0) {

234 
x
 = x + (
zz
 + 1);

236 
x
 = x | 
zz
;

237 
x
 = x - (
zz
 + 1);

240 
x
 &ğ(0x¯¯¯¯¯¯¯¯ULL >> (64 - 
hash
->
¡•
 * 2));

241 
hash
->
b™s
 = (
x
 | 
y
);

242 
	}
}

244 
	$geohash_move_y
(
GeoHashB™s
 *
hash
, 
št8_t
 
d
) {

245 ià(
d
 == 0)

248 
ušt64_t
 
x
 = 
hash
->
b™s
 & 0xaaaaaaaaaaaaaaaaULL;

249 
ušt64_t
 
y
 = 
hash
->
b™s
 & 0x5555555555555555ULL;

251 
ušt64_t
 
zz
 = 0x¯¯¯¯¯¯¯¯ULL >> (64 - 
hash
->
¡•
 * 2);

252 ià(
d
 > 0) {

253 
y
 = y + (
zz
 + 1);

255 
y
 = y | 
zz
;

256 
y
 = y - (
zz
 + 1);

258 
y
 &ğ(0x5555555555555555ULL >> (64 - 
hash
->
¡•
 * 2));

259 
hash
->
b™s
 = (
x
 | 
y
);

260 
	}
}

262 
	$geohashNeighbÜs
(cÚ¡ 
GeoHashB™s
 *
hash
, 
GeoHashNeighbÜs
 *
ÃighbÜs
) {

263 
ÃighbÜs
->
—¡
 = *
hash
;

264 
ÃighbÜs
->
we¡
 = *
hash
;

265 
ÃighbÜs
->
nÜth
 = *
hash
;

266 
ÃighbÜs
->
south
 = *
hash
;

267 
ÃighbÜs
->
south_—¡
 = *
hash
;

268 
ÃighbÜs
->
south_we¡
 = *
hash
;

269 
ÃighbÜs
->
nÜth_—¡
 = *
hash
;

270 
ÃighbÜs
->
nÜth_we¡
 = *
hash
;

272 
	`geohash_move_x
(&
ÃighbÜs
->
—¡
, 1);

273 
	`geohash_move_y
(&
ÃighbÜs
->
—¡
, 0);

275 
	`geohash_move_x
(&
ÃighbÜs
->
we¡
, -1);

276 
	`geohash_move_y
(&
ÃighbÜs
->
we¡
, 0);

278 
	`geohash_move_x
(&
ÃighbÜs
->
south
, 0);

279 
	`geohash_move_y
(&
ÃighbÜs
->
south
, -1);

281 
	`geohash_move_x
(&
ÃighbÜs
->
nÜth
, 0);

282 
	`geohash_move_y
(&
ÃighbÜs
->
nÜth
, 1);

284 
	`geohash_move_x
(&
ÃighbÜs
->
nÜth_we¡
, -1);

285 
	`geohash_move_y
(&
ÃighbÜs
->
nÜth_we¡
, 1);

287 
	`geohash_move_x
(&
ÃighbÜs
->
nÜth_—¡
, 1);

288 
	`geohash_move_y
(&
ÃighbÜs
->
nÜth_—¡
, 1);

290 
	`geohash_move_x
(&
ÃighbÜs
->
south_—¡
, 1);

291 
	`geohash_move_y
(&
ÃighbÜs
->
south_—¡
, -1);

293 
	`geohash_move_x
(&
ÃighbÜs
->
south_we¡
, -1);

294 
	`geohash_move_y
(&
ÃighbÜs
->
south_we¡
, -1);

295 
	}
}

	@deps/geohash-int/geohash.h

32 #iâdeà
GEOHASH_H_


33 
	#GEOHASH_H_


	)

35 
	~<¡ddef.h
>

36 
	~<¡dšt.h
>

37 
	~<¡dšt.h
>

39 #ià
defšed
(
__ılu¥lus
)

43 
	#HASHISZERO
(
r
è(!Ô).
b™s
 && !Ô).
¡•
)

	)

44 
	#RANGEISZERO
(
r
è(!Ô).
max
 && !Ô).
mš
)

	)

45 
	#RANGEPISZERO
(
r
èÔ =ğ
NULL
 || 
	`RANGEISZERO
(*r))

	)

47 
	#GEO_STEP_MAX
 26

	)

50 
	#GEO_LAT_MIN
 -85.05112878

	)

51 
	#GEO_LAT_MAX
 85.05112878

	)

52 
	#GEO_LONG_MIN
 -180

	)

53 
	#GEO_LONG_MAX
 180

	)

56 
GEOHASH_NORTH
 = 0,

57 
GEOHASH_EAST
,

58 
GEOHASH_WEST
,

59 
GEOHASH_SOUTH
,

60 
GEOHASH_SOUTH_WEST
,

61 
GEOHASH_SOUTH_EAST
,

62 
GEOHASH_NORT_WEST
,

63 
GEOHASH_NORT_EAST


64 } 
	tGeoDœeùiÚ
;

67 
ušt64_t
 
b™s
;

68 
ušt8_t
 
¡•
;

69 } 
	tGeoHashB™s
;

72 
mš
;

73 
max
;

74 } 
	tGeoHashRªge
;

77 
GeoHashB™s
 
hash
;

78 
GeoHashRªge
 
lÚg™ude
;

79 
GeoHashRªge
 
Ït™ude
;

80 } 
	tGeoHashA»a
;

83 
GeoHashB™s
 
nÜth
;

84 
GeoHashB™s
 
—¡
;

85 
GeoHashB™s
 
we¡
;

86 
GeoHashB™s
 
south
;

87 
GeoHashB™s
 
nÜth_—¡
;

88 
GeoHashB™s
 
south_—¡
;

89 
GeoHashB™s
 
nÜth_we¡
;

90 
GeoHashB™s
 
south_we¡
;

91 } 
	tGeoHashNeighbÜs
;

97 
geohashG‘CoÜdRªge
(
GeoHashRªge
 *
lÚg_¿nge
, GeoHashRªg*
Ït_¿nge
);

98 
geohashEncode
(cÚ¡ 
GeoHashRªge
 *
lÚg_¿nge
, cÚ¡ GeoHashRªg*
Ït_¿nge
,

99 
lÚg™ude
, 
Ït™ude
, 
ušt8_t
 
¡•
,

100 
GeoHashB™s
 *
hash
);

101 
geohashEncodeTy³
(
lÚg™ude
, 
Ït™ude
,

102 
ušt8_t
 
¡•
, 
GeoHashB™s
 *
hash
);

103 
geohashEncodeWGS84
(
lÚg™ude
, 
Ït™ude
, 
ušt8_t
 
¡•
,

104 
GeoHashB™s
 *
hash
);

105 
geohashDecode
(cÚ¡ 
GeoHashRªge
 
lÚg_¿nge
, cÚ¡ GeoHashRªg
Ït_¿nge
,

106 cÚ¡ 
GeoHashB™s
 
hash
, 
GeoHashA»a
 *
¬—
);

107 
geohashDecodeTy³
(cÚ¡ 
GeoHashB™s
 
hash
, 
GeoHashA»a
 *
¬—
);

108 
geohashDecodeWGS84
(cÚ¡ 
GeoHashB™s
 
hash
, 
GeoHashA»a
 *
¬—
);

109 
geohashDecodeA»aToLÚgL©
(cÚ¡ 
GeoHashA»a
 *
¬—
, *
xy
);

110 
geohashDecodeToLÚgL©Ty³
(cÚ¡ 
GeoHashB™s
 
hash
, *
xy
);

111 
geohashDecodeToLÚgL©WGS84
(cÚ¡ 
GeoHashB™s
 
hash
, *
xy
);

112 
geohashDecodeToLÚgL©M”ÿtÜ
(cÚ¡ 
GeoHashB™s
 
hash
, *
xy
);

113 
geohashNeighbÜs
(cÚ¡ 
GeoHashB™s
 *
hash
, 
GeoHashNeighbÜs
 *
ÃighbÜs
);

115 #ià
defšed
(
__ılu¥lus
)

	@deps/geohash-int/geohash_helper.c

37 
	~"geohash_h–³r.h
"

38 
	~<m©h.h
>

40 
	#D_R
 (
M_PI
 / 180.0)

	)

41 
	#R_MAJOR
 6378137.0

	)

42 
	#R_MINOR
 6356752.3142

	)

43 
	#RATIO
 (
R_MINOR
 / 
R_MAJOR
)

	)

44 
	#ECCENT
 (
	`sq¹
(1.0 - (
RATIO
 *RATIO)))

	)

45 
	#COM
 (0.5 * 
ECCENT
)

	)

48 cÚ¡ 
	gDEG_TO_RAD
 = 0.017453292519943295769236907684886;

50 cÚ¡ 
	gEARTH_RADIUS_IN_METERS
 = 6372797.560856;

52 cÚ¡ 
	gMERCATOR_MAX
 = 20037726.37;

53 cÚ¡ 
	gMERCATOR_MIN
 = -20037726.37;

55 
šlše
 
	$deg_¿d
(
ªg
è{ ‡ng * 
D_R
; 
	}
}

56 
šlše
 
	$¿d_deg
(
ªg
è{ ‡ng / 
D_R
; 
	}
}

60 
ušt8_t
 
	$geohashE¡im©eS‹psByRadius
(
¿nge_m‘”s
, 
Ït
) {

61 ià(
¿nge_m‘”s
 == 0)  26;

62 
¡•
 = 1;

63 
¿nge_m‘”s
 < 
MERCATOR_MAX
) {

64 
¿nge_m‘”s
 *= 2;

65 
¡•
++;

67 
¡•
 -= 2;

72 ià(
Ït
 > 66 ||†at < -66) {

73 
¡•
--;

74 ià(
Ït
 > 80 ||†© < -80è
¡•
--;

78 ià(
¡•
 < 1) step = 1;

79 ià(
¡•
 > 26) step = 26;

80  
¡•
;

81 
	}
}

87 
	$geohashBoundšgBox
(
lÚg™ude
, 
Ït™ude
, 
¿dius_m‘”s
,

88 *
bounds
) {

89 ià(!
bounds
)  0;

91 
bounds
[0] = 
lÚg™ude
 - 
	`¿d_deg
(
¿dius_m‘”s
/
EARTH_RADIUS_IN_METERS
/
	`cos
(
	`deg_¿d
(
Ït™ude
)));

92 
bounds
[2] = 
lÚg™ude
 + 
	`¿d_deg
(
¿dius_m‘”s
/
EARTH_RADIUS_IN_METERS
/
	`cos
(
	`deg_¿d
(
Ït™ude
)));

93 
bounds
[1] = 
Ït™ude
 - 
	`¿d_deg
(
¿dius_m‘”s
/
EARTH_RADIUS_IN_METERS
);

94 
bounds
[3] = 
Ït™ude
 + 
	`¿d_deg
(
¿dius_m‘”s
/
EARTH_RADIUS_IN_METERS
);

96 
	}
}

100 
GeoHashRadius
 
	$geohashG‘A»asByRadius
(
lÚg™ude
, 
Ït™ude
, 
¿dius_m‘”s
) {

101 
GeoHashRªge
 
lÚg_¿nge
, 
Ït_¿nge
;

102 
GeoHashRadius
 
¿dius
;

103 
GeoHashB™s
 
hash
;

104 
GeoHashNeighbÜs
 
ÃighbÜs
;

105 
GeoHashA»a
 
¬—
;

106 
mš_lÚ
, 
max_lÚ
, 
mš_Ït
, 
max_Ït
;

107 
bounds
[4];

108 
¡•s
;

110 
	`geohashBoundšgBox
(
lÚg™ude
, 
Ït™ude
, 
¿dius_m‘”s
, 
bounds
);

111 
mš_lÚ
 = 
bounds
[0];

112 
mš_Ït
 = 
bounds
[1];

113 
max_lÚ
 = 
bounds
[2];

114 
max_Ït
 = 
bounds
[3];

116 
¡•s
 = 
	`geohashE¡im©eS‹psByRadius
(
¿dius_m‘”s
,
Ït™ude
);

118 
	`geohashG‘CoÜdRªge
(&
lÚg_¿nge
,&
Ït_¿nge
);

119 
	`geohashEncode
(&
lÚg_¿nge
,&
Ït_¿nge
,
lÚg™ude
,
Ït™ude
,
¡•s
,&
hash
);

120 
	`geohashNeighbÜs
(&
hash
,&
ÃighbÜs
);

121 
	`geohashDecode
(
lÚg_¿nge
,
Ït_¿nge
,
hash
,&
¬—
);

128 
deü—£_¡•
 = 0;

130 
GeoHashA»a
 
nÜth
, 
south
, 
—¡
, 
we¡
;

132 
	`geohashDecode
(
lÚg_¿nge
, 
Ït_¿nge
, 
ÃighbÜs
.
nÜth
, &north);

133 
	`geohashDecode
(
lÚg_¿nge
, 
Ït_¿nge
, 
ÃighbÜs
.
south
, &south);

134 
	`geohashDecode
(
lÚg_¿nge
, 
Ït_¿nge
, 
ÃighbÜs
.
—¡
, &east);

135 
	`geohashDecode
(
lÚg_¿nge
, 
Ït_¿nge
, 
ÃighbÜs
.
we¡
, &west);

137 ià(
	`geohashG‘Di¡ªû
(
lÚg™ude
,
Ït™ude
,lÚg™ude,
nÜth
.Ït™ude.
max
)

138 < 
¿dius_m‘”s
è
deü—£_¡•
 = 1;

139 ià(
	`geohashG‘Di¡ªû
(
lÚg™ude
,
Ït™ude
,lÚg™ude,
south
.Ït™ude.
mš
)

140 < 
¿dius_m‘”s
è
deü—£_¡•
 = 1;

141 ià(
	`geohashG‘Di¡ªû
(
lÚg™ude
,
Ït™ude
,
—¡
.lÚg™ude.
max
,latitude)

142 < 
¿dius_m‘”s
è
deü—£_¡•
 = 1;

143 ià(
	`geohashG‘Di¡ªû
(
lÚg™ude
,
Ït™ude
,
we¡
.lÚg™ude.
mš
,latitude)

144 < 
¿dius_m‘”s
è
deü—£_¡•
 = 1;

147 ià(
¡•s
 > 1 && 
deü—£_¡•
) {

148 
¡•s
--;

149 
	`geohashEncode
(&
lÚg_¿nge
,&
Ït_¿nge
,
lÚg™ude
,
Ït™ude
,
¡•s
,&
hash
);

150 
	`geohashNeighbÜs
(&
hash
,&
ÃighbÜs
);

151 
	`geohashDecode
(
lÚg_¿nge
,
Ït_¿nge
,
hash
,&
¬—
);

155 ià(
¬—
.
Ït™ude
.
mš
 < 
mš_Ït
) {

156 
	`GZERO
(
ÃighbÜs
.
south
);

157 
	`GZERO
(
ÃighbÜs
.
south_we¡
);

158 
	`GZERO
(
ÃighbÜs
.
south_—¡
);

160 ià(
¬—
.
Ït™ude
.
max
 > 
max_Ït
) {

161 
	`GZERO
(
ÃighbÜs
.
nÜth
);

162 
	`GZERO
(
ÃighbÜs
.
nÜth_—¡
);

163 
	`GZERO
(
ÃighbÜs
.
nÜth_we¡
);

165 ià(
¬—
.
lÚg™ude
.
mš
 < 
mš_lÚ
) {

166 
	`GZERO
(
ÃighbÜs
.
we¡
);

167 
	`GZERO
(
ÃighbÜs
.
south_we¡
);

168 
	`GZERO
(
ÃighbÜs
.
nÜth_we¡
);

170 ià(
¬—
.
lÚg™ude
.
max
 > 
max_lÚ
) {

171 
	`GZERO
(
ÃighbÜs
.
—¡
);

172 
	`GZERO
(
ÃighbÜs
.
south_—¡
);

173 
	`GZERO
(
ÃighbÜs
.
nÜth_—¡
);

175 
¿dius
.
hash
 = hash;

176 
¿dius
.
ÃighbÜs
 =‚eighbors;

177 
¿dius
.
¬—
 =‡rea;

178  
¿dius
;

179 
	}
}

181 
GeoHashRadius
 
	$geohashG‘A»asByRadiusWGS84
(
lÚg™ude
, 
Ït™ude
,

182 
¿dius_m‘”s
) {

183  
	`geohashG‘A»asByRadius
(
lÚg™ude
, 
Ït™ude
, 
¿dius_m‘”s
);

184 
	}
}

186 
GeoHashFix52B™s
 
	$geohashAlign52B™s
(cÚ¡ 
GeoHashB™s
 
hash
) {

187 
ušt64_t
 
b™s
 = 
hash
.bits;

188 
b™s
 <<ğ(52 - 
hash
.
¡•
 * 2);

189  
b™s
;

190 
	}
}

193 
	$geohashG‘Di¡ªû
(
lÚ1d
, 
Ït1d
, 
lÚ2d
, 
Ït2d
) {

194 
Ït1r
, 
lÚ1r
, 
Ït2r
, 
lÚ2r
, 
u
, 
v
;

195 
Ït1r
 = 
	`deg_¿d
(
Ït1d
);

196 
lÚ1r
 = 
	`deg_¿d
(
lÚ1d
);

197 
Ït2r
 = 
	`deg_¿d
(
Ït2d
);

198 
lÚ2r
 = 
	`deg_¿d
(
lÚ2d
);

199 
u
 = 
	`sš
((
Ït2r
 - 
Ït1r
) / 2);

200 
v
 = 
	`sš
((
lÚ2r
 - 
lÚ1r
) / 2);

201  2.0 * 
EARTH_RADIUS_IN_METERS
 *

202 
	`asš
(
	`sq¹
(
u
 * u + 
	`cos
(
Ït1r
è* cos(
Ït2r
è* 
v
 * v));

203 
	}
}

205 
	$geohashG‘Di¡ªûIfInRadius
(
x1
, 
y1
,

206 
x2
, 
y2
, 
¿dius
,

207 *
di¡ªû
) {

208 *
di¡ªû
 = 
	`geohashG‘Di¡ªû
(
x1
, 
y1
, 
x2
, 
y2
);

209 ià(*
di¡ªû
 > 
¿dius
)  0;

211 
	}
}

213 
	$geohashG‘Di¡ªûIfInRadiusWGS84
(
x1
, 
y1
, 
x2
,

214 
y2
, 
¿dius
,

215 *
di¡ªû
) {

216  
	`geohashG‘Di¡ªûIfInRadius
(
x1
, 
y1
, 
x2
, 
y2
, 
¿dius
, 
di¡ªû
);

217 
	}
}

	@deps/geohash-int/geohash_helper.h

32 #iâdeà
GEOHASH_HELPER_HPP_


33 
	#GEOHASH_HELPER_HPP_


	)

35 
	~<m©h.h
>

36 
	~"geohash.h
"

38 
	#GZERO
(
s
ès.
b™s
 = s.
¡•
 = 0;

	)

39 
	#GISZERO
(
s
è(!s.
b™s
 && !s.
¡•
)

	)

40 
	#GISNOTZERO
(
s
è(s.
b™s
 || s.
¡•
)

	)

42 
ušt64_t
 
	tGeoHashFix52B™s
;

43 
ušt64_t
 
	tGeoHashV¬B™s
;

46 
GeoHashB™s
 
	mhash
;

47 
GeoHashA»a
 
	m¬—
;

48 
GeoHashNeighbÜs
 
	mÃighbÜs
;

49 } 
	tGeoHashRadius
;

51 
GeoHashB™sCom·¿tÜ
(cÚ¡ 
GeoHashB™s
 *
a
, cÚ¡ GeoHashB™ *
b
);

52 
ušt8_t
 
geohashE¡im©eS‹psByRadius
(
¿nge_m‘”s
, 
Ït
);

53 
geohashBoundšgBox
(
lÚg™ude
, 
Ït™ude
, 
¿dius_m‘”s
,

54 *
bounds
);

55 
GeoHashRadius
 
geohashG‘A»asByRadius
(
lÚg™ude
,

56 
Ït™ude
, 
¿dius_m‘”s
);

57 
GeoHashRadius
 
geohashG‘A»asByRadiusWGS84
(
lÚg™ude
, 
Ït™ude
,

58 
¿dius_m‘”s
);

59 
GeoHashRadius
 
geohashG‘A»asByRadiusM”ÿtÜ
(
lÚg™ude
, 
Ït™ude
,

60 
¿dius_m‘”s
);

61 
GeoHashFix52B™s
 
geohashAlign52B™s
(cÚ¡ 
GeoHashB™s
 
hash
);

62 
geohashG‘Di¡ªû
(
lÚ1d
, 
Ït1d
,

63 
lÚ2d
, 
Ït2d
);

64 
geohashG‘Di¡ªûIfInRadius
(
x1
, 
y1
,

65 
x2
, 
y2
, 
¿dius
,

66 *
di¡ªû
);

67 
geohashG‘Di¡ªûIfInRadiusWGS84
(
x1
, 
y1
, 
x2
,

68 
y2
, 
¿dius
,

69 *
di¡ªû
);

	@deps/hiredis/adapters/ae.h

31 #iâdeà
__HIREDIS_AE_H__


32 
	#__HIREDIS_AE_H__


	)

33 
	~<sys/ty³s.h
>

34 
	~<«.h
>

35 
	~"../hœedis.h
"

36 
	~"../async.h
"

38 
	s»disAeEv’ts
 {

39 
»disAsyncCÚ‹xt
 *
	mcÚ‹xt
;

40 
«Ev’tLoİ
 *
	mloİ
;

41 
	mfd
;

42 
	m»adšg
, 
	mwr™šg
;

43 } 
	t»disAeEv’ts
;

45 
	$»disAeR—dEv’t
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

46 (()
–
); (()
fd
); (()
mask
);

48 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

49 
	`»disAsyncHªdËR—d
(
e
->
cÚ‹xt
);

50 
	}
}

52 
	$»disAeWr™eEv’t
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

53 (()
–
); (()
fd
); (()
mask
);

55 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

56 
	`»disAsyncHªdËWr™e
(
e
->
cÚ‹xt
);

57 
	}
}

59 
	$»disAeAddR—d
(*
´ivd©a
) {

60 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

61 
«Ev’tLoİ
 *
loİ
 = 
e
->loop;

62 ià(!
e
->
»adšg
) {

63 
e
->
»adšg
 = 1;

64 
	`«C»©eFeEv’t
(
loİ
,
e
->
fd
,
AE_READABLE
,
»disAeR—dEv’t
,e);

66 
	}
}

68 
	$»disAeD–R—d
(*
´ivd©a
) {

69 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

70 
«Ev’tLoİ
 *
loİ
 = 
e
->loop;

71 ià(
e
->
»adšg
) {

72 
e
->
»adšg
 = 0;

73 
	`«D–‘eFeEv’t
(
loİ
,
e
->
fd
,
AE_READABLE
);

75 
	}
}

77 
	$»disAeAddWr™e
(*
´ivd©a
) {

78 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

79 
«Ev’tLoİ
 *
loİ
 = 
e
->loop;

80 ià(!
e
->
wr™šg
) {

81 
e
->
wr™šg
 = 1;

82 
	`«C»©eFeEv’t
(
loİ
,
e
->
fd
,
AE_WRITABLE
,
»disAeWr™eEv’t
,e);

84 
	}
}

86 
	$»disAeD–Wr™e
(*
´ivd©a
) {

87 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

88 
«Ev’tLoİ
 *
loİ
 = 
e
->loop;

89 ià(
e
->
wr™šg
) {

90 
e
->
wr™šg
 = 0;

91 
	`«D–‘eFeEv’t
(
loİ
,
e
->
fd
,
AE_WRITABLE
);

93 
	}
}

95 
	$»disAeCËªup
(*
´ivd©a
) {

96 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

97 
	`»disAeD–R—d
(
´ivd©a
);

98 
	`»disAeD–Wr™e
(
´ivd©a
);

99 
	`ä“
(
e
);

100 
	}
}

102 
	$»disAeA‰ach
(
«Ev’tLoİ
 *
loİ
, 
»disAsyncCÚ‹xt
 *
ac
) {

103 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

104 
»disAeEv’ts
 *
e
;

107 ià(
ac
->
ev
.
d©a
 !ğ
NULL
)

108  
REDIS_ERR
;

111 
e
 = (
»disAeEv’ts
*)
	`m®loc
((*e));

112 
e
->
cÚ‹xt
 = 
ac
;

113 
e
->
loİ
 =†oop;

114 
e
->
fd
 = 
c
->fd;

115 
e
->
»adšg
 =ƒ->
wr™šg
 = 0;

118 
ac
->
ev
.
addR—d
 = 
»disAeAddR—d
;

119 
ac
->
ev
.
d–R—d
 = 
»disAeD–R—d
;

120 
ac
->
ev
.
addWr™e
 = 
»disAeAddWr™e
;

121 
ac
->
ev
.
d–Wr™e
 = 
»disAeD–Wr™e
;

122 
ac
->
ev
.
ş—nup
 = 
»disAeCËªup
;

123 
ac
->
ev
.
d©a
 = 
e
;

125  
REDIS_OK
;

126 
	}
}

	@deps/hiredis/adapters/libev.h

31 #iâdeà
__HIREDIS_LIBEV_H__


32 
	#__HIREDIS_LIBEV_H__


	)

33 
	~<¡dlib.h
>

34 
	~<sys/ty³s.h
>

35 
	~<ev.h
>

36 
	~"../hœedis.h
"

37 
	~"../async.h
"

39 
	s»disLibevEv’ts
 {

40 
»disAsyncCÚ‹xt
 *
	mcÚ‹xt
;

41 
ev_loİ
 *
	mloİ
;

42 
	m»adšg
, 
	mwr™šg
;

43 
ev_io
 
	m»v
, 
	mwev
;

44 } 
	t»disLibevEv’ts
;

46 
	$»disLibevR—dEv’t
(
EV_P_
 
ev_io
 *
w©ch”
, 
»v’ts
) {

47 #ià
EV_MULTIPLICITY


48 (()
loİ
);

50 (()
»v’ts
);

52 
»disLibevEv’ts
 *
e
 = (»disLibevEv’ts*)
w©ch”
->
d©a
;

53 
	`»disAsyncHªdËR—d
(
e
->
cÚ‹xt
);

54 
	}
}

56 
	$»disLibevWr™eEv’t
(
EV_P_
 
ev_io
 *
w©ch”
, 
»v’ts
) {

57 #ià
EV_MULTIPLICITY


58 (()
loİ
);

60 (()
»v’ts
);

62 
»disLibevEv’ts
 *
e
 = (»disLibevEv’ts*)
w©ch”
->
d©a
;

63 
	`»disAsyncHªdËWr™e
(
e
->
cÚ‹xt
);

64 
	}
}

66 
	$»disLibevAddR—d
(*
´ivd©a
) {

67 
»disLibevEv’ts
 *
e
 = (»disLibevEv’ts*)
´ivd©a
;

68 
ev_loİ
 *
loİ
 = 
e
->loop;

69 (()
loİ
);

70 ià(!
e
->
»adšg
) {

71 
e
->
»adšg
 = 1;

72 
	`ev_io_¡¬t
(
EV_A_
 &
e
->
»v
);

74 
	}
}

76 
	$»disLibevD–R—d
(*
´ivd©a
) {

77 
»disLibevEv’ts
 *
e
 = (»disLibevEv’ts*)
´ivd©a
;

78 
ev_loİ
 *
loİ
 = 
e
->loop;

79 (()
loİ
);

80 ià(
e
->
»adšg
) {

81 
e
->
»adšg
 = 0;

82 
	`ev_io_¡İ
(
EV_A_
 &
e
->
»v
);

84 
	}
}

86 
	$»disLibevAddWr™e
(*
´ivd©a
) {

87 
»disLibevEv’ts
 *
e
 = (»disLibevEv’ts*)
´ivd©a
;

88 
ev_loİ
 *
loİ
 = 
e
->loop;

89 (()
loİ
);

90 ià(!
e
->
wr™šg
) {

91 
e
->
wr™šg
 = 1;

92 
	`ev_io_¡¬t
(
EV_A_
 &
e
->
wev
);

94 
	}
}

96 
	$»disLibevD–Wr™e
(*
´ivd©a
) {

97 
»disLibevEv’ts
 *
e
 = (»disLibevEv’ts*)
´ivd©a
;

98 
ev_loİ
 *
loİ
 = 
e
->loop;

99 (()
loİ
);

100 ià(
e
->
wr™šg
) {

101 
e
->
wr™šg
 = 0;

102 
	`ev_io_¡İ
(
EV_A_
 &
e
->
wev
);

104 
	}
}

106 
	$»disLibevCËªup
(*
´ivd©a
) {

107 
»disLibevEv’ts
 *
e
 = (»disLibevEv’ts*)
´ivd©a
;

108 
	`»disLibevD–R—d
(
´ivd©a
);

109 
	`»disLibevD–Wr™e
(
´ivd©a
);

110 
	`ä“
(
e
);

111 
	}
}

113 
	$»disLibevA‰ach
(
EV_P_
 
»disAsyncCÚ‹xt
 *
ac
) {

114 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

115 
»disLibevEv’ts
 *
e
;

118 ià(
ac
->
ev
.
d©a
 !ğ
NULL
)

119  
REDIS_ERR
;

122 
e
 = (
»disLibevEv’ts
*)
	`m®loc
((*e));

123 
e
->
cÚ‹xt
 = 
ac
;

124 #ià
EV_MULTIPLICITY


125 
e
->
loİ
 =†oop;

127 
e
->
loİ
 = 
NULL
;

129 
e
->
»adšg
 =ƒ->
wr™šg
 = 0;

130 
e
->
»v
.
d©a
 =ƒ;

131 
e
->
wev
.
d©a
 =ƒ;

134 
ac
->
ev
.
addR—d
 = 
»disLibevAddR—d
;

135 
ac
->
ev
.
d–R—d
 = 
»disLibevD–R—d
;

136 
ac
->
ev
.
addWr™e
 = 
»disLibevAddWr™e
;

137 
ac
->
ev
.
d–Wr™e
 = 
»disLibevD–Wr™e
;

138 
ac
->
ev
.
ş—nup
 = 
»disLibevCËªup
;

139 
ac
->
ev
.
d©a
 = 
e
;

142 
	`ev_io_š™
(&
e
->
»v
,
»disLibevR—dEv’t
,
c
->
fd
,
EV_READ
);

143 
	`ev_io_š™
(&
e
->
wev
,
»disLibevWr™eEv’t
,
c
->
fd
,
EV_WRITE
);

144  
REDIS_OK
;

145 
	}
}

	@deps/hiredis/adapters/libevent.h

31 #iâdeà
__HIREDIS_LIBEVENT_H__


32 
	#__HIREDIS_LIBEVENT_H__


	)

33 
	~<ev’t.h
>

34 
	~"../hœedis.h
"

35 
	~"../async.h
"

37 
	s»disLibev’tEv’ts
 {

38 
»disAsyncCÚ‹xt
 *
	mcÚ‹xt
;

39 
ev’t
 
	m»v
, 
	mwev
;

40 } 
	t»disLibev’tEv’ts
;

42 
	$»disLibev’tR—dEv’t
(
fd
, 
ev’t
, *
¬g
) {

43 (()
fd
); (()
ev’t
);

44 
»disLibev’tEv’ts
 *
e
 = (»disLibev’tEv’ts*)
¬g
;

45 
	`»disAsyncHªdËR—d
(
e
->
cÚ‹xt
);

46 
	}
}

48 
	$»disLibev’tWr™eEv’t
(
fd
, 
ev’t
, *
¬g
) {

49 (()
fd
); (()
ev’t
);

50 
»disLibev’tEv’ts
 *
e
 = (»disLibev’tEv’ts*)
¬g
;

51 
	`»disAsyncHªdËWr™e
(
e
->
cÚ‹xt
);

52 
	}
}

54 
	$»disLibev’tAddR—d
(*
´ivd©a
) {

55 
»disLibev’tEv’ts
 *
e
 = (»disLibev’tEv’ts*)
´ivd©a
;

56 
	`ev’t_add
(&
e
->
»v
,
NULL
);

57 
	}
}

59 
	$»disLibev’tD–R—d
(*
´ivd©a
) {

60 
»disLibev’tEv’ts
 *
e
 = (»disLibev’tEv’ts*)
´ivd©a
;

61 
	`ev’t_d–
(&
e
->
»v
);

62 
	}
}

64 
	$»disLibev’tAddWr™e
(*
´ivd©a
) {

65 
»disLibev’tEv’ts
 *
e
 = (»disLibev’tEv’ts*)
´ivd©a
;

66 
	`ev’t_add
(&
e
->
wev
,
NULL
);

67 
	}
}

69 
	$»disLibev’tD–Wr™e
(*
´ivd©a
) {

70 
»disLibev’tEv’ts
 *
e
 = (»disLibev’tEv’ts*)
´ivd©a
;

71 
	`ev’t_d–
(&
e
->
wev
);

72 
	}
}

74 
	$»disLibev’tCËªup
(*
´ivd©a
) {

75 
»disLibev’tEv’ts
 *
e
 = (»disLibev’tEv’ts*)
´ivd©a
;

76 
	`ev’t_d–
(&
e
->
»v
);

77 
	`ev’t_d–
(&
e
->
wev
);

78 
	`ä“
(
e
);

79 
	}
}

81 
	$»disLibev’tA‰ach
(
»disAsyncCÚ‹xt
 *
ac
, 
ev’t_ba£
 *
ba£
) {

82 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

83 
»disLibev’tEv’ts
 *
e
;

86 ià(
ac
->
ev
.
d©a
 !ğ
NULL
)

87  
REDIS_ERR
;

90 
e
 = (
»disLibev’tEv’ts
*)
	`m®loc
((*e));

91 
e
->
cÚ‹xt
 = 
ac
;

94 
ac
->
ev
.
addR—d
 = 
»disLibev’tAddR—d
;

95 
ac
->
ev
.
d–R—d
 = 
»disLibev’tD–R—d
;

96 
ac
->
ev
.
addWr™e
 = 
»disLibev’tAddWr™e
;

97 
ac
->
ev
.
d–Wr™e
 = 
»disLibev’tD–Wr™e
;

98 
ac
->
ev
.
ş—nup
 = 
»disLibev’tCËªup
;

99 
ac
->
ev
.
d©a
 = 
e
;

102 
	`ev’t_£t
(&
e
->
»v
,
c
->
fd
,
EV_READ
,
»disLibev’tR—dEv’t
,e);

103 
	`ev’t_£t
(&
e
->
wev
,
c
->
fd
,
EV_WRITE
,
»disLibev’tWr™eEv’t
,e);

104 
	`ev’t_ba£_£t
(
ba£
,&
e
->
»v
);

105 
	`ev’t_ba£_£t
(
ba£
,&
e
->
wev
);

106  
REDIS_OK
;

107 
	}
}

	@deps/hiredis/adapters/libuv.h

1 #iâdeà
__HIREDIS_LIBUV_H__


2 
	#__HIREDIS_LIBUV_H__


	)

3 
	~<uv.h
>

4 
	~"../hœedis.h
"

5 
	~"../async.h
"

6 
	~<¡ršg.h
>

8 
	s»disLibuvEv’ts
 {

9 
»disAsyncCÚ‹xt
* 
	mcÚ‹xt
;

10 
uv_pŞl_t
 
	mhªdË
;

11 
	mev’ts
;

12 } 
	t»disLibuvEv’ts
;

14 
»disLibuvA‰ach
(
»disAsyncCÚ‹xt
*, 
uv_loİ_t
*);

16 
	$»disLibuvPŞl
(
uv_pŞl_t
* 
hªdË
, 
¡©us
, 
ev’ts
) {

17 
»disLibuvEv’ts
* 
p
 = (»disLibuvEv’ts*)
hªdË
->
d©a
;

19 ià(
¡©us
 != 0) {

23 ià(
ev’ts
 & 
UV_READABLE
) {

24 
	`»disAsyncHªdËR—d
(
p
->
cÚ‹xt
);

26 ià(
ev’ts
 & 
UV_WRITABLE
) {

27 
	`»disAsyncHªdËWr™e
(
p
->
cÚ‹xt
);

29 
	}
}

32 
	$»disLibuvAddR—d
(*
´ivd©a
) {

33 
»disLibuvEv’ts
* 
p
 = (»disLibuvEv’ts*)
´ivd©a
;

35 
p
->
ev’ts
 |ğ
UV_READABLE
;

37 
	`uv_pŞl_¡¬t
(&
p
->
hªdË
,…->
ev’ts
, 
»disLibuvPŞl
);

38 
	}
}

41 
	$»disLibuvD–R—d
(*
´ivd©a
) {

42 
»disLibuvEv’ts
* 
p
 = (»disLibuvEv’ts*)
´ivd©a
;

44 
p
->
ev’ts
 &ğ~
UV_READABLE
;

46 ià(
p
->
ev’ts
) {

47 
	`uv_pŞl_¡¬t
(&
p
->
hªdË
,…->
ev’ts
, 
»disLibuvPŞl
);

49 
	`uv_pŞl_¡İ
(&
p
->
hªdË
);

51 
	}
}

54 
	$»disLibuvAddWr™e
(*
´ivd©a
) {

55 
»disLibuvEv’ts
* 
p
 = (»disLibuvEv’ts*)
´ivd©a
;

57 
p
->
ev’ts
 |ğ
UV_WRITABLE
;

59 
	`uv_pŞl_¡¬t
(&
p
->
hªdË
,…->
ev’ts
, 
»disLibuvPŞl
);

60 
	}
}

63 
	$»disLibuvD–Wr™e
(*
´ivd©a
) {

64 
»disLibuvEv’ts
* 
p
 = (»disLibuvEv’ts*)
´ivd©a
;

66 
p
->
ev’ts
 &ğ~
UV_WRITABLE
;

68 ià(
p
->
ev’ts
) {

69 
	`uv_pŞl_¡¬t
(&
p
->
hªdË
,…->
ev’ts
, 
»disLibuvPŞl
);

71 
	`uv_pŞl_¡İ
(&
p
->
hªdË
);

73 
	}
}

76 
	$Ú_şo£
(
uv_hªdË_t
* 
hªdË
) {

77 
»disLibuvEv’ts
* 
p
 = (»disLibuvEv’ts*)
hªdË
->
d©a
;

79 
	`ä“
(
p
);

80 
	}
}

83 
	$»disLibuvCËªup
(*
´ivd©a
) {

84 
»disLibuvEv’ts
* 
p
 = (»disLibuvEv’ts*)
´ivd©a
;

86 
	`uv_şo£
((
uv_hªdË_t
*)&
p
->
hªdË
, 
Ú_şo£
);

87 
	}
}

90 
	$»disLibuvA‰ach
(
»disAsyncCÚ‹xt
* 
ac
, 
uv_loİ_t
* 
loİ
) {

91 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

93 ià(
ac
->
ev
.
d©a
 !ğ
NULL
) {

94  
REDIS_ERR
;

97 
ac
->
ev
.
addR—d
 = 
»disLibuvAddR—d
;

98 
ac
->
ev
.
d–R—d
 = 
»disLibuvD–R—d
;

99 
ac
->
ev
.
addWr™e
 = 
»disLibuvAddWr™e
;

100 
ac
->
ev
.
d–Wr™e
 = 
»disLibuvD–Wr™e
;

101 
ac
->
ev
.
ş—nup
 = 
»disLibuvCËªup
;

103 
»disLibuvEv’ts
* 
p
 = (»disLibuvEv’ts*)
	`m®loc
((*p));

105 ià(!
p
) {

106  
REDIS_ERR
;

109 
	`mem£t
(
p
, 0, (*p));

111 ià(
	`uv_pŞl_š™
(
loİ
, &
p
->
hªdË
, 
c
->
fd
) != 0) {

112  
REDIS_ERR
;

115 
ac
->
ev
.
d©a
 = 
p
;

116 
p
->
hªdË
.
d©a
 =…;

117 
p
->
cÚ‹xt
 = 
ac
;

119  
REDIS_OK
;

120 
	}
}

	@deps/hiredis/async.c

32 
	~"fmaüos.h
"

33 
	~<¡dlib.h
>

34 
	~<¡ršg.h
>

35 
	~<¡ršgs.h
>

36 
	~<as£¹.h
>

37 
	~<ùy³.h
>

38 
	~<”ºo.h
>

39 
	~"async.h
"

40 
	~"Ãt.h
"

41 
	~"diù.c
"

42 
	~"sds.h
"

44 
	#_EL_ADD_READ
(
ùx
) do { \

45 ià((
ùx
)->
ev
.
addR—d
è(ùx)->ev.
	`addR—d
((ùx)->ev.
d©a
); \

46 } 0)

	)

47 
	#_EL_DEL_READ
(
ùx
) do { \

48 ià((
ùx
)->
ev
.
d–R—d
è(ùx)->ev.
	`d–R—d
((ùx)->ev.
d©a
); \

49 } 0)

	)

50 
	#_EL_ADD_WRITE
(
ùx
) do { \

51 ià((
ùx
)->
ev
.
addWr™e
è(ùx)->ev.
	`addWr™e
((ùx)->ev.
d©a
); \

52 } 0)

	)

53 
	#_EL_DEL_WRITE
(
ùx
) do { \

54 ià((
ùx
)->
ev
.
d–Wr™e
è(ùx)->ev.
	`d–Wr™e
((ùx)->ev.
d©a
); \

55 } 0)

	)

56 
	#_EL_CLEANUP
(
ùx
) do { \

57 ià((
ùx
)->
ev
.
ş—nup
è(ùx)->ev.
	`ş—nup
((ùx)->ev.
d©a
); \

58 } 0);

	)

61 
__»disAµ’dCommªd
(
»disCÚ‹xt
 *
c
, *
cmd
, 
size_t
 
Ën
);

64 
	$ÿÎbackHash
(cÚ¡ *
key
) {

65  
	`diùG’HashFunùiÚ
((cÚ¡ *)
key
,

66 
	`sd¦’
((cÚ¡ 
sds
)
key
));

67 
	}
}

69 *
	$ÿÎbackV®Dup
(*
´ivd©a
, cÚ¡ *
¤c
) {

70 ((è
´ivd©a
);

71 
»disC®lback
 *
dup
 = 
	`m®loc
((*dup));

72 
	`memıy
(
dup
,
¤c
,(*dup));

73  
dup
;

74 
	}
}

76 
	$ÿÎbackKeyCom·»
(*
´ivd©a
, cÚ¡ *
key1
, cÚ¡ *
key2
) {

77 
l1
, 
l2
;

78 ((è
´ivd©a
);

80 
l1
 = 
	`sd¦’
((cÚ¡ 
sds
)
key1
);

81 
l2
 = 
	`sd¦’
((cÚ¡ 
sds
)
key2
);

82 ià(
l1
 !ğ
l2
)  0;

83  
	`memcmp
(
key1
,
key2
,
l1
) == 0;

84 
	}
}

86 
	$ÿÎbackKeyDe¡ruùÜ
(*
´ivd©a
, *
key
) {

87 ((è
´ivd©a
);

88 
	`sdsä“
((
sds
)
key
);

89 
	}
}

91 
	$ÿÎbackV®De¡ruùÜ
(*
´ivd©a
, *
v®
) {

92 ((è
´ivd©a
);

93 
	`ä“
(
v®
);

94 
	}
}

96 
diùTy³
 
	gÿÎbackDiù
 = {

97 
ÿÎbackHash
,

98 
NULL
,

99 
ÿÎbackV®Dup
,

100 
ÿÎbackKeyCom·»
,

101 
ÿÎbackKeyDe¡ruùÜ
,

102 
ÿÎbackV®De¡ruùÜ


105 
»disAsyncCÚ‹xt
 *
	$»disAsyncIn™Ÿlize
(
»disCÚ‹xt
 *
c
) {

106 
»disAsyncCÚ‹xt
 *
ac
;

108 
ac
 = 
	`»®loc
(
c
,(
»disAsyncCÚ‹xt
));

109 ià(
ac
 =ğ
NULL
)

110  
NULL
;

112 
c
 = &(
ac
->c);

117 
c
->
æags
 &ğ~
REDIS_CONNECTED
;

119 
ac
->
”r
 = 0;

120 
ac
->
”r¡r
 = 
NULL
;

121 
ac
->
d©a
 = 
NULL
;

123 
ac
->
ev
.
d©a
 = 
NULL
;

124 
ac
->
ev
.
addR—d
 = 
NULL
;

125 
ac
->
ev
.
d–R—d
 = 
NULL
;

126 
ac
->
ev
.
addWr™e
 = 
NULL
;

127 
ac
->
ev
.
d–Wr™e
 = 
NULL
;

128 
ac
->
ev
.
ş—nup
 = 
NULL
;

130 
ac
->
ÚCÚÃù
 = 
NULL
;

131 
ac
->
ÚDiscÚÃù
 = 
NULL
;

133 
ac
->
»¶›s
.
h—d
 = 
NULL
;

134 
ac
->
»¶›s
.

 = 
NULL
;

135 
ac
->
sub
.
šv®id
.
h—d
 = 
NULL
;

136 
ac
->
sub
.
šv®id
.

 = 
NULL
;

137 
ac
->
sub
.
chªÃls
 = 
	`diùC»©e
(&
ÿÎbackDiù
,
NULL
);

138 
ac
->
sub
.
·‰”ns
 = 
	`diùC»©e
(&
ÿÎbackDiù
,
NULL
);

139  
ac
;

140 
	}
}

144 
	$__»disAsyncCİyE¼Ü
(
»disAsyncCÚ‹xt
 *
ac
) {

145 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

146 
ac
->
”r
 = 
c
->err;

147 
ac
->
”r¡r
 = 
c
->errstr;

148 
	}
}

150 
»disAsyncCÚ‹xt
 *
	$»disAsyncCÚÃù
(cÚ¡ *

, 
pÜt
) {

151 
»disCÚ‹xt
 *
c
;

152 
»disAsyncCÚ‹xt
 *
ac
;

154 
c
 = 
	`»disCÚÃùNÚBlock
(

,
pÜt
);

155 ià(
c
 =ğ
NULL
)

156  
NULL
;

158 
ac
 = 
	`»disAsyncIn™Ÿlize
(
c
);

159 ià(
ac
 =ğ
NULL
) {

160 
	`»disF»e
(
c
);

161  
NULL
;

164 
	`__»disAsyncCİyE¼Ü
(
ac
);

165  
ac
;

166 
	}
}

168 
»disAsyncCÚ‹xt
 *
	$»disAsyncCÚÃùBšd
(cÚ¡ *

, 
pÜt
,

169 cÚ¡ *
sourû_addr
) {

170 
»disCÚ‹xt
 *
c
 = 
	`»disCÚÃùBšdNÚBlock
(

,
pÜt
,
sourû_addr
);

171 
»disAsyncCÚ‹xt
 *
ac
 = 
	`»disAsyncIn™Ÿlize
(
c
);

172 
	`__»disAsyncCİyE¼Ü
(
ac
);

173  
ac
;

174 
	}
}

176 
»disAsyncCÚ‹xt
 *
	$»disAsyncCÚÃùUnix
(cÚ¡ *
·th
) {

177 
»disCÚ‹xt
 *
c
;

178 
»disAsyncCÚ‹xt
 *
ac
;

180 
c
 = 
	`»disCÚÃùUnixNÚBlock
(
·th
);

181 ià(
c
 =ğ
NULL
)

182  
NULL
;

184 
ac
 = 
	`»disAsyncIn™Ÿlize
(
c
);

185 ià(
ac
 =ğ
NULL
) {

186 
	`»disF»e
(
c
);

187  
NULL
;

190 
	`__»disAsyncCİyE¼Ü
(
ac
);

191  
ac
;

192 
	}
}

194 
	$»disAsyncS‘CÚÃùC®lback
(
»disAsyncCÚ‹xt
 *
ac
, 
»disCÚÃùC®lback
 *
â
) {

195 ià(
ac
->
ÚCÚÃù
 =ğ
NULL
) {

196 
ac
->
ÚCÚÃù
 = 
â
;

201 
	`_EL_ADD_WRITE
(
ac
);

202  
REDIS_OK
;

204  
REDIS_ERR
;

205 
	}
}

207 
	$»disAsyncS‘DiscÚÃùC®lback
(
»disAsyncCÚ‹xt
 *
ac
, 
»disDiscÚÃùC®lback
 *
â
) {

208 ià(
ac
->
ÚDiscÚÃù
 =ğ
NULL
) {

209 
ac
->
ÚDiscÚÃù
 = 
â
;

210  
REDIS_OK
;

212  
REDIS_ERR
;

213 
	}
}

216 
	$__»disPushC®lback
(
»disC®lbackLi¡
 *
li¡
, 
»disC®lback
 *
sourû
) {

217 
»disC®lback
 *
cb
;

220 
cb
 = 
	`m®loc
((*cb));

221 ià(
cb
 =ğ
NULL
)

222  
REDIS_ERR_OOM
;

224 ià(
sourû
 !ğ
NULL
) {

225 
	`memıy
(
cb
,
sourû
,(*cb));

226 
cb
->
Ãxt
 = 
NULL
;

230 ià(
li¡
->
h—d
 =ğ
NULL
)

231 
li¡
->
h—d
 = 
cb
;

232 ià(
li¡
->

 !ğ
NULL
)

233 
li¡
->

->
Ãxt
 = 
cb
;

234 
li¡
->

 = 
cb
;

235  
REDIS_OK
;

236 
	}
}

238 
	$__»disShiáC®lback
(
»disC®lbackLi¡
 *
li¡
, 
»disC®lback
 *
rg‘
) {

239 
»disC®lback
 *
cb
 = 
li¡
->
h—d
;

240 ià(
cb
 !ğ
NULL
) {

241 
li¡
->
h—d
 = 
cb
->
Ãxt
;

242 ià(
cb
 =ğ
li¡
->

)

243 
li¡
->

 = 
NULL
;

246 ià(
rg‘
 !ğ
NULL
)

247 
	`memıy
(
rg‘
,
cb
,(*cb));

248 
	`ä“
(
cb
);

249  
REDIS_OK
;

251  
REDIS_ERR
;

252 
	}
}

254 
	$__»disRunC®lback
(
»disAsyncCÚ‹xt
 *
ac
, 
»disC®lback
 *
cb
, 
»disR•ly
 *
»¶y
) {

255 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

256 ià(
cb
->
â
 !ğ
NULL
) {

257 
c
->
æags
 |ğ
REDIS_IN_CALLBACK
;

258 
cb
->
	`â
(
ac
,
»¶y
,cb->
´ivd©a
);

259 
c
->
æags
 &ğ~
REDIS_IN_CALLBACK
;

261 
	}
}

264 
	$__»disAsyncF»e
(
»disAsyncCÚ‹xt
 *
ac
) {

265 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

266 
»disC®lback
 
cb
;

267 
diùI‹¿tÜ
 *
™
;

268 
diùEÁry
 *
de
;

271 
	`__»disShiáC®lback
(&
ac
->
»¶›s
,&
cb
è=ğ
REDIS_OK
)

272 
	`__»disRunC®lback
(
ac
,&
cb
,
NULL
);

275 
	`__»disShiáC®lback
(&
ac
->
sub
.
šv®id
,&
cb
è=ğ
REDIS_OK
)

276 
	`__»disRunC®lback
(
ac
,&
cb
,
NULL
);

279 
™
 = 
	`diùG‘I‹¿tÜ
(
ac
->
sub
.
chªÃls
);

280 (
de
 = 
	`diùNext
(
™
)è!ğ
NULL
)

281 
	`__»disRunC®lback
(
ac
,
	`diùG‘EÁryV®
(
de
),
NULL
);

282 
	`diùR–—£I‹¿tÜ
(
™
);

283 
	`diùR–—£
(
ac
->
sub
.
chªÃls
);

285 
™
 = 
	`diùG‘I‹¿tÜ
(
ac
->
sub
.
·‰”ns
);

286 (
de
 = 
	`diùNext
(
™
)è!ğ
NULL
)

287 
	`__»disRunC®lback
(
ac
,
	`diùG‘EÁryV®
(
de
),
NULL
);

288 
	`diùR–—£I‹¿tÜ
(
™
);

289 
	`diùR–—£
(
ac
->
sub
.
·‰”ns
);

292 
	`_EL_CLEANUP
(
ac
);

296 ià(
ac
->
ÚDiscÚÃù
 && (
c
->
æags
 & 
REDIS_CONNECTED
)) {

297 ià(
c
->
æags
 & 
REDIS_FREEING
) {

298 
ac
->
	`ÚDiscÚÃù
×c,
REDIS_OK
);

300 
ac
->
	`ÚDiscÚÃù
×c,×c->
”r
 =ğ0è? 
REDIS_OK
 : 
REDIS_ERR
);

305 
	`»disF»e
(
c
);

306 
	}
}

312 
	$»disAsyncF»e
(
»disAsyncCÚ‹xt
 *
ac
) {

313 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

314 
c
->
æags
 |ğ
REDIS_FREEING
;

315 ià(!(
c
->
æags
 & 
REDIS_IN_CALLBACK
))

316 
	`__»disAsyncF»e
(
ac
);

317 
	}
}

320 
	$__»disAsyncDiscÚÃù
(
»disAsyncCÚ‹xt
 *
ac
) {

321 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

324 
	`__»disAsyncCİyE¼Ü
(
ac
);

326 ià(
ac
->
”r
 == 0) {

328 
	`as£¹
(
	`__»disShiáC®lback
(&
ac
->
»¶›s
,
NULL
è=ğ
REDIS_ERR
);

332 
c
->
æags
 |ğ
REDIS_DISCONNECTING
;

337 
	`__»disAsyncF»e
(
ac
);

338 
	}
}

346 
	$»disAsyncDiscÚÃù
(
»disAsyncCÚ‹xt
 *
ac
) {

347 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

348 
c
->
æags
 |ğ
REDIS_DISCONNECTING
;

349 ià(!(
c
->
æags
 & 
REDIS_IN_CALLBACK
è&& 
ac
->
»¶›s
.
h—d
 =ğ
NULL
)

350 
	`__»disAsyncDiscÚÃù
(
ac
);

351 
	}
}

353 
	$__»disG‘SubsüibeC®lback
(
»disAsyncCÚ‹xt
 *
ac
, 
»disR•ly
 *
»¶y
, 
»disC®lback
 *
d¡cb
) {

354 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

355 
diù
 *
ÿÎbacks
;

356 
diùEÁry
 *
de
;

357 
pv¬ŸÁ
;

358 *
¡y³
;

359 
sds
 
¢ame
;

363 ià(
»¶y
->
ty³
 =ğ
REDIS_REPLY_ARRAY
) {

364 
	`as£¹
(
»¶y
->
–em’ts
 >= 2);

365 
	`as£¹
(
»¶y
->
–em’t
[0]->
ty³
 =ğ
REDIS_REPLY_STRING
);

366 
¡y³
 = 
»¶y
->
–em’t
[0]->
¡r
;

367 
pv¬ŸÁ
 = (
	`tŞow”
(
¡y³
[0]) == 'p') ? 1 : 0;

369 ià(
pv¬ŸÁ
)

370 
ÿÎbacks
 = 
ac
->
sub
.
·‰”ns
;

372 
ÿÎbacks
 = 
ac
->
sub
.
chªÃls
;

375 
	`as£¹
(
»¶y
->
–em’t
[1]->
ty³
 =ğ
REDIS_REPLY_STRING
);

376 
¢ame
 = 
	`sd¢ewËn
(
»¶y
->
–em’t
[1]->
¡r
,»¶y->–em’t[1]->
Ën
);

377 
de
 = 
	`diùFšd
(
ÿÎbacks
,
¢ame
);

378 ià(
de
 !ğ
NULL
) {

379 
	`memıy
(
d¡cb
,
	`diùG‘EÁryV®
(
de
),(*dstcb));

382 ià(
	`¡rÿ£cmp
(
¡y³
+
pv¬ŸÁ
,"unsubscribe") == 0) {

383 
	`diùD–‘e
(
ÿÎbacks
,
¢ame
);

387 
	`as£¹
(
»¶y
->
–em’t
[2]->
ty³
 =ğ
REDIS_REPLY_INTEGER
);

388 ià(
»¶y
->
–em’t
[2]->
š‹g”
 == 0)

389 
c
->
æags
 &ğ~
REDIS_SUBSCRIBED
;

392 
	`sdsä“
(
¢ame
);

395 
	`__»disShiáC®lback
(&
ac
->
sub
.
šv®id
,
d¡cb
);

397  
REDIS_OK
;

398 
	}
}

400 
	$»disProûssC®lbacks
(
»disAsyncCÚ‹xt
 *
ac
) {

401 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

402 
»disC®lback
 
cb
 = {
NULL
, NULL, NULL};

403 *
»¶y
 = 
NULL
;

404 
¡©us
;

406 (
¡©us
 = 
	`»disG‘R•ly
(
c
,&
»¶y
)è=ğ
REDIS_OK
) {

407 ià(
»¶y
 =ğ
NULL
) {

410 ià(
c
->
æags
 & 
REDIS_DISCONNECTING
 && 
	`sd¦’
(c->
obuf
) == 0) {

411 
	`__»disAsyncDiscÚÃù
(
ac
);

416 if(
c
->
æags
 & 
REDIS_MONITORING
) {

417 
	`__»disPushC®lback
(&
ac
->
»¶›s
,&
cb
);

427 ià(
	`__»disShiáC®lback
(&
ac
->
»¶›s
,&
cb
è!ğ
REDIS_OK
) {

443 ià(((
»disR•ly
*)
»¶y
)->
ty³
 =ğ
REDIS_REPLY_ERROR
) {

444 
c
->
”r
 = 
REDIS_ERR_OTHER
;

445 
	`¢´štf
(
c
->
”r¡r
,(c->”r¡r),"%s",((
»disR•ly
*)
»¶y
)->
¡r
);

446 
c
->
»ad”
->
â
->
	`ä“Objeù
(
»¶y
);

447 
	`__»disAsyncDiscÚÃù
(
ac
);

451 
	`as£¹
((
c
->
æags
 & 
REDIS_SUBSCRIBED
 || c->æag & 
REDIS_MONITORING
));

452 if(
c
->
æags
 & 
REDIS_SUBSCRIBED
)

453 
	`__»disG‘SubsüibeC®lback
(
ac
,
»¶y
,&
cb
);

456 ià(
cb
.
â
 !ğ
NULL
) {

457 
	`__»disRunC®lback
(
ac
,&
cb
,
»¶y
);

458 
c
->
»ad”
->
â
->
	`ä“Objeù
(
»¶y
);

461 ià(
c
->
æags
 & 
REDIS_FREEING
) {

462 
	`__»disAsyncF»e
(
ac
);

470 
c
->
»ad”
->
â
->
	`ä“Objeù
(
»¶y
);

475 ià(
¡©us
 !ğ
REDIS_OK
)

476 
	`__»disAsyncDiscÚÃù
(
ac
);

477 
	}
}

482 
	$__»disAsyncHªdËCÚÃù
(
»disAsyncCÚ‹xt
 *
ac
) {

483 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

485 ià(
	`»disCheckSock‘E¼Ü
(
c
è=ğ
REDIS_ERR
) {

487 ià(
”ºo
 =ğ
EINPROGRESS
)

488  
REDIS_OK
;

490 ià(
ac
->
ÚCÚÃù
èac->
	`ÚCÚÃù
×c,
REDIS_ERR
);

491 
	`__»disAsyncDiscÚÃù
(
ac
);

492  
REDIS_ERR
;

496 
c
->
æags
 |ğ
REDIS_CONNECTED
;

497 ià(
ac
->
ÚCÚÃù
èac->
	`ÚCÚÃù
×c,
REDIS_OK
);

498  
REDIS_OK
;

499 
	}
}

504 
	$»disAsyncHªdËR—d
(
»disAsyncCÚ‹xt
 *
ac
) {

505 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

507 ià(!(
c
->
æags
 & 
REDIS_CONNECTED
)) {

509 ià(
	`__»disAsyncHªdËCÚÃù
(
ac
è!ğ
REDIS_OK
)

512 ià(!(
c
->
æags
 & 
REDIS_CONNECTED
))

516 ià(
	`»disBufãrR—d
(
c
è=ğ
REDIS_ERR
) {

517 
	`__»disAsyncDiscÚÃù
(
ac
);

520 
	`_EL_ADD_READ
(
ac
);

521 
	`»disProûssC®lbacks
(
ac
);

523 
	}
}

525 
	$»disAsyncHªdËWr™e
(
»disAsyncCÚ‹xt
 *
ac
) {

526 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

527 
dÚe
 = 0;

529 ià(!(
c
->
æags
 & 
REDIS_CONNECTED
)) {

531 ià(
	`__»disAsyncHªdËCÚÃù
(
ac
è!ğ
REDIS_OK
)

534 ià(!(
c
->
æags
 & 
REDIS_CONNECTED
))

538 ià(
	`»disBufãrWr™e
(
c
,&
dÚe
è=ğ
REDIS_ERR
) {

539 
	`__»disAsyncDiscÚÃù
(
ac
);

542 ià(!
dÚe
)

543 
	`_EL_ADD_WRITE
(
ac
);

545 
	`_EL_DEL_WRITE
(
ac
);

548 
	`_EL_ADD_READ
(
ac
);

550 
	}
}

554 *
	$ÃxtArgum’t
(*
¡¬t
, **
¡r
, 
size_t
 *
Ën
) {

555 *
p
 = 
¡¬t
;

556 ià(
p
[0] != '$') {

557 
p
 = 
	`¡rchr
(p,'$');

558 ià(
p
 =ğ
NULL
)  NULL;

561 *
Ën
 = ()
	`¡¹Ş
(
p
+1,
NULL
,10);

562 
p
 = 
	`¡rchr
(p,'\r');

563 
	`as£¹
(
p
);

564 *
¡r
 = 
p
+2;

565  
p
+2+(*
Ën
)+2;

566 
	}
}

571 
	$__»disAsyncCommªd
(
»disAsyncCÚ‹xt
 *
ac
, 
»disC®lbackFn
 *
â
, *
´ivd©a
, *
cmd
, 
size_t
 
Ën
) {

572 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

573 
»disC®lback
 
cb
;

574 
pv¬ŸÁ
, 
ha¢ext
;

575 *
c¡r
, *
a¡r
;

576 
size_t
 
ş’
, 
®’
;

577 *
p
;

578 
sds
 
¢ame
;

581 ià(
c
->
æags
 & (
REDIS_DISCONNECTING
 | 
REDIS_FREEING
)è 
REDIS_ERR
;

584 
cb
.
â
 = fn;

585 
cb
.
´ivd©a
 =…rivdata;

588 
p
 = 
	`ÃxtArgum’t
(
cmd
,&
c¡r
,&
ş’
);

589 
	`as£¹
(
p
 !ğ
NULL
);

590 
ha¢ext
 = (
p
[0] == '$');

591 
pv¬ŸÁ
 = (
	`tŞow”
(
c¡r
[0]) == 'p') ? 1 : 0;

592 
c¡r
 +ğ
pv¬ŸÁ
;

593 
ş’
 -ğ
pv¬ŸÁ
;

595 ià(
ha¢ext
 && 
	`¡ºÿ£cmp
(
c¡r
,"subscribe\r\n",11) == 0) {

596 
c
->
æags
 |ğ
REDIS_SUBSCRIBED
;

599 (
p
 = 
	`ÃxtArgum’t
Õ,&
a¡r
,&
®’
)è!ğ
NULL
) {

600 
¢ame
 = 
	`sd¢ewËn
(
a¡r
,
®’
);

601 ià(
pv¬ŸÁ
)

602 
	`diùR•Ïû
(
ac
->
sub
.
·‰”ns
,
¢ame
,&
cb
);

604 
	`diùR•Ïû
(
ac
->
sub
.
chªÃls
,
¢ame
,&
cb
);

606 } ià(
	`¡ºÿ£cmp
(
c¡r
,"unsubscribe\r\n",13) == 0) {

609 ià(!(
c
->
æags
 & 
REDIS_SUBSCRIBED
)è 
REDIS_ERR
;

614 } if(
	`¡ºÿ£cmp
(
c¡r
,"monitor\r\n",9) == 0) {

616 
c
->
æags
 |ğ
REDIS_MONITORING
;

617 
	`__»disPushC®lback
(&
ac
->
»¶›s
,&
cb
);

619 ià(
c
->
æags
 & 
REDIS_SUBSCRIBED
)

622 
	`__»disPushC®lback
(&
ac
->
sub
.
šv®id
,&
cb
);

624 
	`__»disPushC®lback
(&
ac
->
»¶›s
,&
cb
);

627 
	`__»disAµ’dCommªd
(
c
,
cmd
,
Ën
);

630 
	`_EL_ADD_WRITE
(
ac
);

632  
REDIS_OK
;

633 
	}
}

635 
	$»disvAsyncCommªd
(
»disAsyncCÚ‹xt
 *
ac
, 
»disC®lbackFn
 *
â
, *
´ivd©a
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
) {

636 *
cmd
;

637 
Ën
;

638 
¡©us
;

639 
Ën
 = 
	`»disvFÜm©Commªd
(&
cmd
,
fÜm©
,
­
);

640 
¡©us
 = 
	`__»disAsyncCommªd
(
ac
,
â
,
´ivd©a
,
cmd
,
Ën
);

641 
	`ä“
(
cmd
);

642  
¡©us
;

643 
	}
}

645 
	$»disAsyncCommªd
(
»disAsyncCÚ‹xt
 *
ac
, 
»disC®lbackFn
 *
â
, *
´ivd©a
, cÚ¡ *
fÜm©
, ...) {

646 
va_li¡
 
­
;

647 
¡©us
;

648 
	`va_¡¬t
(
­
,
fÜm©
);

649 
¡©us
 = 
	`»disvAsyncCommªd
(
ac
,
â
,
´ivd©a
,
fÜm©
,
­
);

650 
	`va_’d
(
­
);

651  
¡©us
;

652 
	}
}

654 
	$»disAsyncCommªdArgv
(
»disAsyncCÚ‹xt
 *
ac
, 
»disC®lbackFn
 *
â
, *
´ivd©a
, 
¬gc
, cÚ¡ **
¬gv
, cÚ¡ 
size_t
 *
¬gvËn
) {

655 *
cmd
;

656 
Ën
;

657 
¡©us
;

658 
Ën
 = 
	`»disFÜm©CommªdArgv
(&
cmd
,
¬gc
,
¬gv
,
¬gvËn
);

659 
¡©us
 = 
	`__»disAsyncCommªd
(
ac
,
â
,
´ivd©a
,
cmd
,
Ën
);

660 
	`ä“
(
cmd
);

661  
¡©us
;

662 
	}
}

	@deps/hiredis/async.h

32 #iâdeà
__HIREDIS_ASYNC_H


33 
	#__HIREDIS_ASYNC_H


	)

34 
	~"hœedis.h
"

36 #ifdeà
__ılu¥lus


40 
»disAsyncCÚ‹xt
;

41 
diù
;

44 (
»disC®lbackFn
)(
	t»disAsyncCÚ‹xt
*, *, *);

45 
	s»disC®lback
 {

46 
»disC®lback
 *
Ãxt
;

47 
»disC®lbackFn
 *
â
;

48 *
´ivd©a
;

49 } 
	t»disC®lback
;

52 
	s»disC®lbackLi¡
 {

53 
»disC®lback
 *
h—d
, *

;

54 } 
	t»disC®lbackLi¡
;

57 (
»disDiscÚÃùC®lback
)(cÚ¡ 
	t»disAsyncCÚ‹xt
*, 
	t¡©us
);

58 (
»disCÚÃùC®lback
)(cÚ¡ 
	t»disAsyncCÚ‹xt
*, 
	t¡©us
);

61 
	s»disAsyncCÚ‹xt
 {

63 
»disCÚ‹xt
 
c
;

66 
”r
;

67 *
”r¡r
;

70 *
d©a
;

74 *
d©a
;

78 (*
addR—d
)(*
´ivd©a
);

79 (*
d–R—d
)(*
´ivd©a
);

80 (*
addWr™e
)(*
´ivd©a
);

81 (*
d–Wr™e
)(*
´ivd©a
);

82 (*
ş—nup
)(*
´ivd©a
);

83 } 
ev
;

87 
»disDiscÚÃùC®lback
 *
ÚDiscÚÃù
;

90 
»disCÚÃùC®lback
 *
ÚCÚÃù
;

93 
»disC®lbackLi¡
 
»¶›s
;

97 
»disC®lbackLi¡
 
šv®id
;

98 
diù
 *
chªÃls
;

99 
diù
 *
·‰”ns
;

100 } 
sub
;

101 } 
	t»disAsyncCÚ‹xt
;

104 
»disAsyncCÚ‹xt
 *
»disAsyncCÚÃù
(cÚ¡ *

, 
pÜt
);

105 
»disAsyncCÚ‹xt
 *
»disAsyncCÚÃùBšd
(cÚ¡ *

, 
pÜt
, cÚ¡ *
sourû_addr
);

106 
»disAsyncCÚ‹xt
 *
»disAsyncCÚÃùUnix
(cÚ¡ *
·th
);

107 
»disAsyncS‘CÚÃùC®lback
(
»disAsyncCÚ‹xt
 *
ac
, 
»disCÚÃùC®lback
 *
â
);

108 
»disAsyncS‘DiscÚÃùC®lback
(
»disAsyncCÚ‹xt
 *
ac
, 
»disDiscÚÃùC®lback
 *
â
);

109 
»disAsyncDiscÚÃù
(
»disAsyncCÚ‹xt
 *
ac
);

110 
»disAsyncF»e
(
»disAsyncCÚ‹xt
 *
ac
);

113 
»disAsyncHªdËR—d
(
»disAsyncCÚ‹xt
 *
ac
);

114 
»disAsyncHªdËWr™e
(
»disAsyncCÚ‹xt
 *
ac
);

118 
»disvAsyncCommªd
(
»disAsyncCÚ‹xt
 *
ac
, 
»disC®lbackFn
 *
â
, *
´ivd©a
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
);

119 
»disAsyncCommªd
(
»disAsyncCÚ‹xt
 *
ac
, 
»disC®lbackFn
 *
â
, *
´ivd©a
, cÚ¡ *
fÜm©
, ...);

120 
»disAsyncCommªdArgv
(
»disAsyncCÚ‹xt
 *
ac
, 
»disC®lbackFn
 *
â
, *
´ivd©a
, 
¬gc
, cÚ¡ **
¬gv
, cÚ¡ 
size_t
 *
¬gvËn
);

122 #ifdeà
__ılu¥lus


	@deps/hiredis/dict.c

36 
	~"fmaüos.h
"

37 
	~<¡dlib.h
>

38 
	~<as£¹.h
>

39 
	~<lim™s.h
>

40 
	~"diù.h
"

44 
_diùEx·ndIfN“ded
(
diù
 *
ht
);

45 
_diùNextPow”
(
size
);

46 
_diùKeyIndex
(
diù
 *
ht
, cÚ¡ *
key
);

47 
_diùIn™
(
diù
 *
ht
, 
diùTy³
 *
ty³
, *
´ivD©aPŒ
);

53 
	$diùG’HashFunùiÚ
(cÚ¡ *
buf
, 
Ën
) {

54 
hash
 = 5381;

56 
Ën
--)

57 
hash
 = ((hash << 5è+ hashè+ (*
buf
++);

58  
hash
;

59 
	}
}

65 
	$_diùRe£t
(
diù
 *
ht
) {

66 
ht
->
bË
 = 
NULL
;

67 
ht
->
size
 = 0;

68 
ht
->
sizemask
 = 0;

69 
ht
->
u£d
 = 0;

70 
	}
}

73 
diù
 *
	$diùC»©e
(
diùTy³
 *
ty³
, *
´ivD©aPŒ
) {

74 
diù
 *
ht
 = 
	`m®loc
((*ht));

75 
	`_diùIn™
(
ht
,
ty³
,
´ivD©aPŒ
);

76  
ht
;

77 
	}
}

80 
	$_diùIn™
(
diù
 *
ht
, 
diùTy³
 *
ty³
, *
´ivD©aPŒ
) {

81 
	`_diùRe£t
(
ht
);

82 
ht
->
ty³
 =ype;

83 
ht
->
´ivd©a
 = 
´ivD©aPŒ
;

84  
DICT_OK
;

85 
	}
}

88 
	$diùEx·nd
(
diù
 *
ht
, 
size
) {

89 
diù
 
n
;

90 
»®size
 = 
	`_diùNextPow”
(
size
), 
i
;

94 ià(
ht
->
u£d
 > 
size
)

95  
DICT_ERR
;

97 
	`_diùIn™
(&
n
, 
ht
->
ty³
, ht->
´ivd©a
);

98 
n
.
size
 = 
»®size
;

99 
n
.
sizemask
 = 
»®size
-1;

100 
n
.
bË
 = 
	`ÿÎoc
(
»®size
,(
diùEÁry
*));

105 
n
.
u£d
 = 
ht
->used;

106 
i
 = 0; i < 
ht
->
size
 && ht->
u£d
 > 0; i++) {

107 
diùEÁry
 *
he
, *
ÃxtHe
;

109 ià(
ht
->
bË
[
i
] =ğ
NULL
) ;

112 
he
 = 
ht
->
bË
[
i
];

113 
he
) {

114 
h
;

116 
ÃxtHe
 = 
he
->
Ãxt
;

118 
h
 = 
	`diùHashKey
(
ht
, 
he
->
key
è& 
n
.
sizemask
;

119 
he
->
Ãxt
 = 
n
.
bË
[
h
];

120 
n
.
bË
[
h
] = 
he
;

121 
ht
->
u£d
--;

123 
he
 = 
ÃxtHe
;

126 
	`as£¹
(
ht
->
u£d
 == 0);

127 
	`ä“
(
ht
->
bË
);

130 *
ht
 = 
n
;

131  
DICT_OK
;

132 
	}
}

135 
	$diùAdd
(
diù
 *
ht
, *
key
, *
v®
) {

136 
šdex
;

137 
diùEÁry
 *
’Œy
;

141 ià((
šdex
 = 
	`_diùKeyIndex
(
ht
, 
key
)) == -1)

142  
DICT_ERR
;

145 
’Œy
 = 
	`m®loc
((*entry));

146 
’Œy
->
Ãxt
 = 
ht
->
bË
[
šdex
];

147 
ht
->
bË
[
šdex
] = 
’Œy
;

150 
	`diùS‘HashKey
(
ht
, 
’Œy
, 
key
);

151 
	`diùS‘HashV®
(
ht
, 
’Œy
, 
v®
);

152 
ht
->
u£d
++;

153  
DICT_OK
;

154 
	}
}

160 
	$diùR•Ïû
(
diù
 *
ht
, *
key
, *
v®
) {

161 
diùEÁry
 *
’Œy
, 
aux’Œy
;

165 ià(
	`diùAdd
(
ht
, 
key
, 
v®
è=ğ
DICT_OK
)

168 
’Œy
 = 
	`diùFšd
(
ht
, 
key
);

175 
aux’Œy
 = *
’Œy
;

176 
	`diùS‘HashV®
(
ht
, 
’Œy
, 
v®
);

177 
	`diùF»eEÁryV®
(
ht
, &
aux’Œy
);

179 
	}
}

182 
	$diùD–‘e
(
diù
 *
ht
, cÚ¡ *
key
) {

183 
h
;

184 
diùEÁry
 *
de
, *
´evde
;

186 ià(
ht
->
size
 == 0)

187  
DICT_ERR
;

188 
h
 = 
	`diùHashKey
(
ht
, 
key
è& ht->
sizemask
;

189 
de
 = 
ht
->
bË
[
h
];

191 
´evde
 = 
NULL
;

192 
de
) {

193 ià(
	`diùCom·»HashKeys
(
ht
,
key
,
de
->key)) {

195 ià(
´evde
)

196 
´evde
->
Ãxt
 = 
de
->next;

198 
ht
->
bË
[
h
] = 
de
->
Ãxt
;

200 
	`diùF»eEÁryKey
(
ht
,
de
);

201 
	`diùF»eEÁryV®
(
ht
,
de
);

202 
	`ä“
(
de
);

203 
ht
->
u£d
--;

204  
DICT_OK
;

206 
´evde
 = 
de
;

207 
de
 = de->
Ãxt
;

209  
DICT_ERR
;

210 
	}
}

213 
	$_diùCË¬
(
diù
 *
ht
) {

214 
i
;

217 
i
 = 0; i < 
ht
->
size
 && ht->
u£d
 > 0; i++) {

218 
diùEÁry
 *
he
, *
ÃxtHe
;

220 ià((
he
 = 
ht
->
bË
[
i
]è=ğ
NULL
) ;

221 
he
) {

222 
ÃxtHe
 = 
he
->
Ãxt
;

223 
	`diùF»eEÁryKey
(
ht
, 
he
);

224 
	`diùF»eEÁryV®
(
ht
, 
he
);

225 
	`ä“
(
he
);

226 
ht
->
u£d
--;

227 
he
 = 
ÃxtHe
;

231 
	`ä“
(
ht
->
bË
);

233 
	`_diùRe£t
(
ht
);

234  
DICT_OK
;

235 
	}
}

238 
	$diùR–—£
(
diù
 *
ht
) {

239 
	`_diùCË¬
(
ht
);

240 
	`ä“
(
ht
);

241 
	}
}

243 
diùEÁry
 *
	$diùFšd
(
diù
 *
ht
, cÚ¡ *
key
) {

244 
diùEÁry
 *
he
;

245 
h
;

247 ià(
ht
->
size
 =ğ0è 
NULL
;

248 
h
 = 
	`diùHashKey
(
ht
, 
key
è& ht->
sizemask
;

249 
he
 = 
ht
->
bË
[
h
];

250 
he
) {

251 ià(
	`diùCom·»HashKeys
(
ht
, 
key
, 
he
->key))

252  
he
;

253 
he
 = he->
Ãxt
;

255  
NULL
;

256 
	}
}

258 
diùI‹¿tÜ
 *
	$diùG‘I‹¿tÜ
(
diù
 *
ht
) {

259 
diùI‹¿tÜ
 *
™”
 = 
	`m®loc
((*iter));

261 
™”
->
ht
 = ht;

262 
™”
->
šdex
 = -1;

263 
™”
->
’Œy
 = 
NULL
;

264 
™”
->
ÃxtEÁry
 = 
NULL
;

265  
™”
;

266 
	}
}

268 
diùEÁry
 *
	$diùNext
(
diùI‹¿tÜ
 *
™”
) {

270 ià(
™”
->
’Œy
 =ğ
NULL
) {

271 
™”
->
šdex
++;

272 ià(
™”
->
šdex
 >=

273 (sigÃd)
™”
->
ht
->
size
) ;

274 
™”
->
’Œy
 = i‹r->
ht
->
bË
[™”->
šdex
];

276 
™”
->
’Œy
 = i‹r->
ÃxtEÁry
;

278 ià(
™”
->
’Œy
) {

281 
™”
->
ÃxtEÁry
 = i‹r->
’Œy
->
Ãxt
;

282  
™”
->
’Œy
;

285  
NULL
;

286 
	}
}

288 
	$diùR–—£I‹¿tÜ
(
diùI‹¿tÜ
 *
™”
) {

289 
	`ä“
(
™”
);

290 
	}
}

295 
	$_diùEx·ndIfN“ded
(
diù
 *
ht
) {

298 ià(
ht
->
size
 == 0)

299  
	`diùEx·nd
(
ht
, 
DICT_HT_INITIAL_SIZE
);

300 ià(
ht
->
u£d
 =ğht->
size
)

301  
	`diùEx·nd
(
ht
, ht->
size
*2);

302  
DICT_OK
;

303 
	}
}

306 
	$_diùNextPow”
(
size
) {

307 
i
 = 
DICT_HT_INITIAL_SIZE
;

309 ià(
size
 >ğ
LONG_MAX
)  LONG_MAX;

311 ià(
i
 >ğ
size
)

312  
i
;

313 
i
 *= 2;

315 
	}
}

320 
	$_diùKeyIndex
(
diù
 *
ht
, cÚ¡ *
key
) {

321 
h
;

322 
diùEÁry
 *
he
;

325 ià(
	`_diùEx·ndIfN“ded
(
ht
è=ğ
DICT_ERR
)

328 
h
 = 
	`diùHashKey
(
ht
, 
key
è& ht->
sizemask
;

330 
he
 = 
ht
->
bË
[
h
];

331 
he
) {

332 ià(
	`diùCom·»HashKeys
(
ht
, 
key
, 
he
->key))

334 
he
 = he->
Ãxt
;

336  
h
;

337 
	}
}

	@deps/hiredis/dict.h

36 #iâdeà
__DICT_H


37 
	#__DICT_H


	)

39 
	#DICT_OK
 0

	)

40 
	#DICT_ERR
 1

	)

43 
	#DICT_NOTUSED
(
V
è((èV)

	)

45 
	sdiùEÁry
 {

46 *
	mkey
;

47 *
	mv®
;

48 
diùEÁry
 *
	mÃxt
;

49 } 
	tdiùEÁry
;

51 
	sdiùTy³
 {

52 (*
	mhashFunùiÚ
)(cÚ¡ *
	mkey
);

53 *(*
	mkeyDup
)(*
	m´ivd©a
, cÚ¡ *
	mkey
);

54 *(*
	mv®Dup
)(*
	m´ivd©a
, cÚ¡ *
	mobj
);

55 (*
	mkeyCom·»
)(*
	m´ivd©a
, cÚ¡ *
	mkey1
, cÚ¡ *
	mkey2
);

56 (*
	mkeyDe¡ruùÜ
)(*
	m´ivd©a
, *
	mkey
);

57 (*
	mv®De¡ruùÜ
)(*
	m´ivd©a
, *
	mobj
);

58 } 
	tdiùTy³
;

60 
	sdiù
 {

61 
diùEÁry
 **
	mbË
;

62 
diùTy³
 *
	mty³
;

63 
	msize
;

64 
	msizemask
;

65 
	mu£d
;

66 *
	m´ivd©a
;

67 } 
	tdiù
;

69 
	sdiùI‹¿tÜ
 {

70 
diù
 *
	mht
;

71 
	mšdex
;

72 
diùEÁry
 *
	m’Œy
, *
	mÃxtEÁry
;

73 } 
	tdiùI‹¿tÜ
;

76 
	#DICT_HT_INITIAL_SIZE
 4

	)

79 
	#diùF»eEÁryV®
(
ht
, 
’Œy
) \

80 ià((
ht
)->
ty³
->
v®De¡ruùÜ
) \

81 (
ht
)->
ty³
->
	`v®De¡ruùÜ
((ht)->
´ivd©a
, (
’Œy
)->
v®
)

	)

83 
	#diùS‘HashV®
(
ht
, 
’Œy
, 
_v®_
) do { \

84 ià((
ht
)->
ty³
->
v®Dup
) \

85 
’Œy
->
v®
 = (
ht
)->
ty³
->
	`v®Dup
((ht)->
´ivd©a
, 
_v®_
); \

87 
’Œy
->
v®
 = (
_v®_
); \

88 } 0)

	)

90 
	#diùF»eEÁryKey
(
ht
, 
’Œy
) \

91 ià((
ht
)->
ty³
->
keyDe¡ruùÜ
) \

92 (
ht
)->
ty³
->
	`keyDe¡ruùÜ
((ht)->
´ivd©a
, (
’Œy
)->
key
)

	)

94 
	#diùS‘HashKey
(
ht
, 
’Œy
, 
_key_
) do { \

95 ià((
ht
)->
ty³
->
keyDup
) \

96 
’Œy
->
key
 = (
ht
)->
ty³
->
	`keyDup
((ht)->
´ivd©a
, 
_key_
); \

98 
’Œy
->
key
 = (
_key_
); \

99 } 0)

	)

101 
	#diùCom·»HashKeys
(
ht
, 
key1
, 
key2
) \

102 (((
ht
)->
ty³
->
keyCom·»
) ? \

103 (
ht
)->
ty³
->
	`keyCom·»
((ht)->
´ivd©a
, 
key1
, 
key2
) : \

104 (
key1
è=ğ(
key2
))

	)

106 
	#diùHashKey
(
ht
, 
key
è(ht)->
ty³
->
	`hashFunùiÚ
(key)

	)

108 
	#diùG‘EÁryKey
(
he
è((he)->
key
)

	)

109 
	#diùG‘EÁryV®
(
he
è((he)->
v®
)

	)

110 
	#diùSlÙs
(
ht
è((ht)->
size
)

	)

111 
	#diùSize
(
ht
è((ht)->
u£d
)

	)

114 
diùG’HashFunùiÚ
(cÚ¡ *
buf
, 
Ën
);

115 
diù
 *
diùC»©e
(
diùTy³
 *
ty³
, *
´ivD©aPŒ
);

116 
diùEx·nd
(
diù
 *
ht
, 
size
);

117 
diùAdd
(
diù
 *
ht
, *
key
, *
v®
);

118 
diùR•Ïû
(
diù
 *
ht
, *
key
, *
v®
);

119 
diùD–‘e
(
diù
 *
ht
, cÚ¡ *
key
);

120 
diùR–—£
(
diù
 *
ht
);

121 
diùEÁry
 * 
diùFšd
(
diù
 *
ht
, cÚ¡ *
key
);

122 
diùI‹¿tÜ
 *
diùG‘I‹¿tÜ
(
diù
 *
ht
);

123 
diùEÁry
 *
diùNext
(
diùI‹¿tÜ
 *
™”
);

124 
diùR–—£I‹¿tÜ
(
diùI‹¿tÜ
 *
™”
);

	@deps/hiredis/examples/example-ae.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<sigÇl.h
>

6 
	~<hœedis.h
>

7 
	~<async.h
>

8 
	~<ad­‹rs/«.h
>

11 
«Ev’tLoİ
 *
	gloİ
;

13 
	$g‘C®lback
(
»disAsyncCÚ‹xt
 *
c
, *
r
, *
´ivd©a
) {

14 
»disR•ly
 *
»¶y
 = 
r
;

15 ià(
»¶y
 =ğ
NULL
) ;

16 
	`´štf
("¬gv[%s]: %s\n", (*)
´ivd©a
, 
»¶y
->
¡r
);

19 
	`»disAsyncDiscÚÃù
(
c
);

20 
	}
}

22 
	$cÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

23 ià(
¡©us
 !ğ
REDIS_OK
) {

24 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

25 
	`«Stİ
(
loİ
);

29 
	`´štf
("Connected...\n");

30 
	}
}

32 
	$discÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

33 ià(
¡©us
 !ğ
REDIS_OK
) {

34 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

35 
	`«Stİ
(
loİ
);

39 
	`´štf
("Disconnected...\n");

40 
	`«Stİ
(
loİ
);

41 
	}
}

43 
	$maš
 (
¬gc
, **
¬gv
) {

44 
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
);

46 
»disAsyncCÚ‹xt
 *
c
 = 
	`»disAsyncCÚÃù
("127.0.0.1", 6379);

47 ià(
c
->
”r
) {

49 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

53 
loİ
 = 
	`«C»©eEv’tLoİ
(64);

54 
	`»disAeA‰ach
(
loİ
, 
c
);

55 
	`»disAsyncS‘CÚÃùC®lback
(
c
,
cÚÃùC®lback
);

56 
	`»disAsyncS‘DiscÚÃùC®lback
(
c
,
discÚÃùC®lback
);

57 
	`»disAsyncCommªd
(
c
, 
NULL
, NULL, "SET key %b", 
¬gv
[
¬gc
-1], 
	`¡¾’
(argv[argc-1]));

58 
	`»disAsyncCommªd
(
c
, 
g‘C®lback
, (*)"end-1", "GET key");

59 
	`«Maš
(
loİ
);

61 
	}
}

	@deps/hiredis/examples/example-libev.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<sigÇl.h
>

6 
	~<hœedis.h
>

7 
	~<async.h
>

8 
	~<ad­‹rs/libev.h
>

10 
	$g‘C®lback
(
»disAsyncCÚ‹xt
 *
c
, *
r
, *
´ivd©a
) {

11 
»disR•ly
 *
»¶y
 = 
r
;

12 ià(
»¶y
 =ğ
NULL
) ;

13 
	`´štf
("¬gv[%s]: %s\n", (*)
´ivd©a
, 
»¶y
->
¡r
);

16 
	`»disAsyncDiscÚÃù
(
c
);

17 
	}
}

19 
	$cÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

20 ià(
¡©us
 !ğ
REDIS_OK
) {

21 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

24 
	`´štf
("Connected...\n");

25 
	}
}

27 
	$discÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

28 ià(
¡©us
 !ğ
REDIS_OK
) {

29 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

32 
	`´štf
("Disconnected...\n");

33 
	}
}

35 
	$maš
 (
¬gc
, **
¬gv
) {

36 
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
);

38 
»disAsyncCÚ‹xt
 *
c
 = 
	`»disAsyncCÚÃù
("127.0.0.1", 6379);

39 ià(
c
->
”r
) {

41 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

45 
	`»disLibevA‰ach
(
EV_DEFAULT_
 
c
);

46 
	`»disAsyncS‘CÚÃùC®lback
(
c
,
cÚÃùC®lback
);

47 
	`»disAsyncS‘DiscÚÃùC®lback
(
c
,
discÚÃùC®lback
);

48 
	`»disAsyncCommªd
(
c
, 
NULL
, NULL, "SET key %b", 
¬gv
[
¬gc
-1], 
	`¡¾’
(argv[argc-1]));

49 
	`»disAsyncCommªd
(
c
, 
g‘C®lback
, (*)"end-1", "GET key");

50 
	`ev_loİ
(
EV_DEFAULT_
 0);

52 
	}
}

	@deps/hiredis/examples/example-libevent.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<sigÇl.h
>

6 
	~<hœedis.h
>

7 
	~<async.h
>

8 
	~<ad­‹rs/libev’t.h
>

10 
	$g‘C®lback
(
»disAsyncCÚ‹xt
 *
c
, *
r
, *
´ivd©a
) {

11 
»disR•ly
 *
»¶y
 = 
r
;

12 ià(
»¶y
 =ğ
NULL
) ;

13 
	`´štf
("¬gv[%s]: %s\n", (*)
´ivd©a
, 
»¶y
->
¡r
);

16 
	`»disAsyncDiscÚÃù
(
c
);

17 
	}
}

19 
	$cÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

20 ià(
¡©us
 !ğ
REDIS_OK
) {

21 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

24 
	`´štf
("Connected...\n");

25 
	}
}

27 
	$discÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

28 ià(
¡©us
 !ğ
REDIS_OK
) {

29 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

32 
	`´štf
("Disconnected...\n");

33 
	}
}

35 
	$maš
 (
¬gc
, **
¬gv
) {

36 
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
);

37 
ev’t_ba£
 *
ba£
 = 
	`ev’t_ba£_Ãw
();

39 
»disAsyncCÚ‹xt
 *
c
 = 
	`»disAsyncCÚÃù
("127.0.0.1", 6379);

40 ià(
c
->
”r
) {

42 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

46 
	`»disLibev’tA‰ach
(
c
,
ba£
);

47 
	`»disAsyncS‘CÚÃùC®lback
(
c
,
cÚÃùC®lback
);

48 
	`»disAsyncS‘DiscÚÃùC®lback
(
c
,
discÚÃùC®lback
);

49 
	`»disAsyncCommªd
(
c
, 
NULL
, NULL, "SET key %b", 
¬gv
[
¬gc
-1], 
	`¡¾’
(argv[argc-1]));

50 
	`»disAsyncCommªd
(
c
, 
g‘C®lback
, (*)"end-1", "GET key");

51 
	`ev’t_ba£_di¥©ch
(
ba£
);

53 
	}
}

	@deps/hiredis/examples/example-libuv.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<sigÇl.h
>

6 
	~<hœedis.h
>

7 
	~<async.h
>

8 
	~<ad­‹rs/libuv.h
>

10 
	$g‘C®lback
(
»disAsyncCÚ‹xt
 *
c
, *
r
, *
´ivd©a
) {

11 
»disR•ly
 *
»¶y
 = 
r
;

12 ià(
»¶y
 =ğ
NULL
) ;

13 
	`´štf
("¬gv[%s]: %s\n", (*)
´ivd©a
, 
»¶y
->
¡r
);

16 
	`»disAsyncDiscÚÃù
(
c
);

17 
	}
}

19 
	$cÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

20 ià(
¡©us
 !ğ
REDIS_OK
) {

21 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

24 
	`´štf
("Connected...\n");

25 
	}
}

27 
	$discÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

28 ià(
¡©us
 !ğ
REDIS_OK
) {

29 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

32 
	`´štf
("Disconnected...\n");

33 
	}
}

35 
	$maš
 (
¬gc
, **
¬gv
) {

36 
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
);

37 
uv_loİ_t
* 
loİ
 = 
	`uv_deçuÉ_loİ
();

39 
»disAsyncCÚ‹xt
 *
c
 = 
	`»disAsyncCÚÃù
("127.0.0.1", 6379);

40 ià(
c
->
”r
) {

42 
	`´štf
("E¼Ü: %s\n", 
c
->
”r¡r
);

46 
	`»disLibuvA‰ach
(
c
,
loİ
);

47 
	`»disAsyncS‘CÚÃùC®lback
(
c
,
cÚÃùC®lback
);

48 
	`»disAsyncS‘DiscÚÃùC®lback
(
c
,
discÚÃùC®lback
);

49 
	`»disAsyncCommªd
(
c
, 
NULL
, NULL, "SET key %b", 
¬gv
[
¬gc
-1], 
	`¡¾’
(argv[argc-1]));

50 
	`»disAsyncCommªd
(
c
, 
g‘C®lback
, (*)"end-1", "GET key");

51 
	`uv_run
(
loİ
, 
UV_RUN_DEFAULT
);

53 
	}
}

	@deps/hiredis/examples/example.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

5 
	~<hœedis.h
>

7 
	$maš
(
¬gc
, **
¬gv
) {

8 
j
;

9 
»disCÚ‹xt
 *
c
;

10 
»disR•ly
 *
»¶y
;

11 cÚ¡ *
ho¡Çme
 = (
¬gc
 > 1è? 
¬gv
[1] : "127.0.0.1";

12 
pÜt
 = (
¬gc
 > 2è? 
	`©oi
(
¬gv
[2]) : 6379;

14 
timev®
 
timeout
 = { 1, 500000 };

15 
c
 = 
	`»disCÚÃùW™hTimeout
(
ho¡Çme
, 
pÜt
, 
timeout
);

16 ià(
c
 =ğ
NULL
 || c->
”r
) {

17 ià(
c
) {

18 
	`´štf
("CÚÃùiÚƒ¼Ü: %s\n", 
c
->
”r¡r
);

19 
	`»disF»e
(
c
);

21 
	`´štf
("Connectionƒrror: can't‡llocate„edis context\n");

23 
	`ex™
(1);

27 
»¶y
 = 
	`»disCommªd
(
c
,"PING");

28 
	`´štf
("PING: %s\n", 
»¶y
->
¡r
);

29 
	`ä“R•lyObjeù
(
»¶y
);

32 
»¶y
 = 
	`»disCommªd
(
c
,"SET %s %s", "foo", "hello world");

33 
	`´štf
("SET: %s\n", 
»¶y
->
¡r
);

34 
	`ä“R•lyObjeù
(
»¶y
);

37 
»¶y
 = 
	`»disCommªd
(
c
,"SET %b %b", "b¬", (
size_t
) 3, "hello", (size_t) 5);

38 
	`´štf
("SET (bš¬y API): %s\n", 
»¶y
->
¡r
);

39 
	`ä“R•lyObjeù
(
»¶y
);

42 
»¶y
 = 
	`»disCommªd
(
c
,"GET foo");

43 
	`´štf
("GET foo: %s\n", 
»¶y
->
¡r
);

44 
	`ä“R•lyObjeù
(
»¶y
);

46 
»¶y
 = 
	`»disCommªd
(
c
,"INCR counter");

47 
	`´štf
("INCR couÁ”: %Îd\n", 
»¶y
->
š‹g”
);

48 
	`ä“R•lyObjeù
(
»¶y
);

50 
»¶y
 = 
	`»disCommªd
(
c
,"INCR counter");

51 
	`´štf
("INCR couÁ”: %Îd\n", 
»¶y
->
š‹g”
);

52 
	`ä“R•lyObjeù
(
»¶y
);

55 
»¶y
 = 
	`»disCommªd
(
c
,"DEL mylist");

56 
	`ä“R•lyObjeù
(
»¶y
);

57 
j
 = 0; j < 10; j++) {

58 
buf
[64];

60 
	`¢´štf
(
buf
,64,"%d",
j
);

61 
»¶y
 = 
	`»disCommªd
(
c
,"LPUSH myli¡ƒËm’t-%s", 
buf
);

62 
	`ä“R•lyObjeù
(
»¶y
);

66 
»¶y
 = 
	`»disCommªd
(
c
,"LRANGE mylist 0 -1");

67 ià(
»¶y
->
ty³
 =ğ
REDIS_REPLY_ARRAY
) {

68 
j
 = 0; j < 
»¶y
->
–em’ts
; j++) {

69 
	`´štf
("%uè%s\n", 
j
, 
»¶y
->
–em’t
[j]->
¡r
);

72 
	`ä“R•lyObjeù
(
»¶y
);

75 
	`»disF»e
(
c
);

78 
	}
}

	@deps/hiredis/fmacros.h

1 #iâdeà
__HIREDIS_FMACRO_H


2 
	#__HIREDIS_FMACRO_H


	)

4 #ià!
defšed
(
_BSD_SOURCE
)

5 
	#_BSD_SOURCE


	)

8 #ià
defšed
(
_AIX
)

9 
	#_ALL_SOURCE


	)

12 #ià
defšed
(
__sun__
)

13 
	#_POSIX_C_SOURCE
 200112L

	)

14 #–ià
defšed
(
__lšux__
è|| defšed(
__O³nBSD__
è|| defšed(
__N‘BSD__
)

15 
	#_XOPEN_SOURCE
 600

	)

17 
	#_XOPEN_SOURCE


	)

20 #ià
__APPLE__
 && 
__MACH__


21 
	#_OSX


	)

	@deps/hiredis/hiredis.c

32 
	~"fmaüos.h
"

33 
	~<¡ršg.h
>

34 
	~<¡dlib.h
>

35 
	~<uni¡d.h
>

36 
	~<as£¹.h
>

37 
	~<”ºo.h
>

38 
	~<ùy³.h
>

40 
	~"hœedis.h
"

41 
	~"Ãt.h
"

42 
	~"sds.h
"

44 
»disR•ly
 *
ü—‹R•lyObjeù
(
ty³
);

45 *
ü—‹SŒšgObjeù
(cÚ¡ 
»disR—dTask
 *
sk
, *
¡r
, 
size_t
 
Ën
);

46 *
ü—‹A¼ayObjeù
(cÚ¡ 
»disR—dTask
 *
sk
, 
–em’ts
);

47 *
ü—‹IÁeg”Objeù
(cÚ¡ 
»disR—dTask
 *
sk
, 
v®ue
);

48 *
ü—‹NObjeù
(cÚ¡ 
»disR—dTask
 *
sk
);

52 
»disR•lyObjeùFunùiÚs
 
	gdeçuÉFunùiÚs
 = {

53 
ü—‹SŒšgObjeù
,

54 
ü—‹A¼ayObjeù
,

55 
ü—‹IÁeg”Objeù
,

56 
ü—‹NObjeù
,

57 
ä“R•lyObjeù


61 
»disR•ly
 *
	$ü—‹R•lyObjeù
(
ty³
) {

62 
»disR•ly
 *
r
 = 
	`ÿÎoc
(1,(*r));

64 ià(
r
 =ğ
NULL
)

65  
NULL
;

67 
r
->
ty³
 =ype;

68  
r
;

69 
	}
}

72 
	$ä“R•lyObjeù
(*
»¶y
) {

73 
»disR•ly
 *
r
 = 
»¶y
;

74 
size_t
 
j
;

76 
r
->
ty³
) {

77 
REDIS_REPLY_INTEGER
:

79 
REDIS_REPLY_ARRAY
:

80 ià(
r
->
–em’t
 !ğ
NULL
) {

81 
j
 = 0; j < 
r
->
–em’ts
; j++)

82 ià(
r
->
–em’t
[
j
] !ğ
NULL
)

83 
	`ä“R•lyObjeù
(
r
->
–em’t
[
j
]);

84 
	`ä“
(
r
->
–em’t
);

87 
REDIS_REPLY_ERROR
:

88 
REDIS_REPLY_STATUS
:

89 
REDIS_REPLY_STRING
:

90 ià(
r
->
¡r
 !ğ
NULL
)

91 
	`ä“
(
r
->
¡r
);

94 
	`ä“
(
r
);

95 
	}
}

97 *
	$ü—‹SŒšgObjeù
(cÚ¡ 
»disR—dTask
 *
sk
, *
¡r
, 
size_t
 
Ën
) {

98 
»disR•ly
 *
r
, *
·»Á
;

99 *
buf
;

101 
r
 = 
	`ü—‹R•lyObjeù
(
sk
->
ty³
);

102 ià(
r
 =ğ
NULL
)

103  
NULL
;

105 
buf
 = 
	`m®loc
(
Ën
+1);

106 ià(
buf
 =ğ
NULL
) {

107 
	`ä“R•lyObjeù
(
r
);

108  
NULL
;

111 
	`as£¹
(
sk
->
ty³
 =ğ
REDIS_REPLY_ERROR
 ||

112 
sk
->
ty³
 =ğ
REDIS_REPLY_STATUS
 ||

113 
sk
->
ty³
 =ğ
REDIS_REPLY_STRING
);

116 
	`memıy
(
buf
,
¡r
,
Ën
);

117 
buf
[
Ën
] = '\0';

118 
r
->
¡r
 = 
buf
;

119 
r
->
Ën
 =†en;

121 ià(
sk
->
·»Á
) {

122 
·»Á
 = 
sk
->·»Á->
obj
;

123 
	`as£¹
(
·»Á
->
ty³
 =ğ
REDIS_REPLY_ARRAY
);

124 
·»Á
->
–em’t
[
sk
->
idx
] = 
r
;

126  
r
;

127 
	}
}

129 *
	$ü—‹A¼ayObjeù
(cÚ¡ 
»disR—dTask
 *
sk
, 
–em’ts
) {

130 
»disR•ly
 *
r
, *
·»Á
;

132 
r
 = 
	`ü—‹R•lyObjeù
(
REDIS_REPLY_ARRAY
);

133 ià(
r
 =ğ
NULL
)

134  
NULL
;

136 ià(
–em’ts
 > 0) {

137 
r
->
–em’t
 = 
	`ÿÎoc
(
–em’ts
,(
»disR•ly
*));

138 ià(
r
->
–em’t
 =ğ
NULL
) {

139 
	`ä“R•lyObjeù
(
r
);

140  
NULL
;

144 
r
->
–em’ts
 =ƒlements;

146 ià(
sk
->
·»Á
) {

147 
·»Á
 = 
sk
->·»Á->
obj
;

148 
	`as£¹
(
·»Á
->
ty³
 =ğ
REDIS_REPLY_ARRAY
);

149 
·»Á
->
–em’t
[
sk
->
idx
] = 
r
;

151  
r
;

152 
	}
}

154 *
	$ü—‹IÁeg”Objeù
(cÚ¡ 
»disR—dTask
 *
sk
, 
v®ue
) {

155 
»disR•ly
 *
r
, *
·»Á
;

157 
r
 = 
	`ü—‹R•lyObjeù
(
REDIS_REPLY_INTEGER
);

158 ià(
r
 =ğ
NULL
)

159  
NULL
;

161 
r
->
š‹g”
 = 
v®ue
;

163 ià(
sk
->
·»Á
) {

164 
·»Á
 = 
sk
->·»Á->
obj
;

165 
	`as£¹
(
·»Á
->
ty³
 =ğ
REDIS_REPLY_ARRAY
);

166 
·»Á
->
–em’t
[
sk
->
idx
] = 
r
;

168  
r
;

169 
	}
}

171 *
	$ü—‹NObjeù
(cÚ¡ 
»disR—dTask
 *
sk
) {

172 
»disR•ly
 *
r
, *
·»Á
;

174 
r
 = 
	`ü—‹R•lyObjeù
(
REDIS_REPLY_NIL
);

175 ià(
r
 =ğ
NULL
)

176  
NULL
;

178 ià(
sk
->
·»Á
) {

179 
·»Á
 = 
sk
->·»Á->
obj
;

180 
	`as£¹
(
·»Á
->
ty³
 =ğ
REDIS_REPLY_ARRAY
);

181 
·»Á
->
–em’t
[
sk
->
idx
] = 
r
;

183  
r
;

184 
	}
}

186 
	$__»disR—d”S‘E¼Ü
(
»disR—d”
 *
r
, 
ty³
, cÚ¡ *
¡r
) {

187 
size_t
 
Ën
;

189 ià(
r
->
»¶y
 !ğ
NULL
 &&„->
â
 &&„->â->
ä“Objeù
) {

190 
r
->
â
->
	`ä“Objeù
Ô->
»¶y
);

191 
r
->
»¶y
 = 
NULL
;

195 ià(
r
->
buf
 !ğ
NULL
) {

196 
	`sdsä“
(
r
->
buf
);

197 
r
->
buf
 = 
NULL
;

198 
r
->
pos
 =„->
Ën
 = 0;

202 
r
->
ridx
 = -1;

205 
r
->
”r
 = 
ty³
;

206 
Ën
 = 
	`¡¾’
(
¡r
);

207 
Ën
 =†’ < ((
r
->
”r¡r
)-1) ?†en : ((r->errstr)-1);

208 
	`memıy
(
r
->
”r¡r
,
¡r
,
Ën
);

209 
r
->
”r¡r
[
Ën
] = '\0';

210 
	}
}

212 
size_t
 
	$ch¹os
(*
buf
, 
size_t
 
size
, 
by‹
) {

213 
size_t
 
Ën
 = 0;

215 
by‹
) {

218 
Ën
 = 
	`¢´štf
(
buf
,
size
,"\"\\%c\"",
by‹
);

220 '\n': 
Ën
 = 
	`¢´štf
(
buf
,
size
,"\"\\n\""); ;

221 '\r': 
Ën
 = 
	`¢´štf
(
buf
,
size
,"\"\\r\""); ;

222 '\t': 
Ën
 = 
	`¢´štf
(
buf
,
size
,"\"\\t\""); ;

223 '\a': 
Ën
 = 
	`¢´štf
(
buf
,
size
,"\"\\a\""); ;

224 '\b': 
Ën
 = 
	`¢´štf
(
buf
,
size
,"\"\\b\""); ;

226 ià(
	`i¥ršt
(
by‹
))

227 
Ën
 = 
	`¢´štf
(
buf
,
size
,"\"%c\"",
by‹
);

229 
Ën
 = 
	`¢´štf
(
buf
,
size
,"\"\\x%02x\"",()
by‹
);

233  
Ën
;

234 
	}
}

236 
	$__»disR—d”S‘E¼ÜPrÙocŞBy‹
(
»disR—d”
 *
r
, 
by‹
) {

237 
cbuf
[8], 
sbuf
[128];

239 
	`ch¹os
(
cbuf
,(cbuf),
by‹
);

240 
	`¢´štf
(
sbuf
,(sbuf),

241 "PrÙocŞƒ¼Ü, gÙ % a »¶yy³ by‹", 
cbuf
);

242 
	`__»disR—d”S‘E¼Ü
(
r
,
REDIS_ERR_PROTOCOL
,
sbuf
);

243 
	}
}

245 
	$__»disR—d”S‘E¼ÜOOM
(
»disR—d”
 *
r
) {

246 
	`__»disR—d”S‘E¼Ü
(
r
,
REDIS_ERR_OOM
,"Out of memory");

247 
	}
}

249 *
	$»adBy‹s
(
»disR—d”
 *
r
, 
by‹s
) {

250 *
p
;

251 ià(
r
->
Ën
-r->
pos
 >ğ
by‹s
) {

252 
p
 = 
r
->
buf
+r->
pos
;

253 
r
->
pos
 +ğ
by‹s
;

254  
p
;

256  
NULL
;

257 
	}
}

260 *
	$£ekNewlše
(*
s
, 
size_t
 
Ën
) {

261 
pos
 = 0;

262 
_Ën
 = 
Ën
-1;

268 
pos
 < 
_Ën
) {

269 
pos
 < 
_Ën
 && 
s
[pos] != '\r')…os++;

270 ià(
s
[
pos
] != '\r') {

272  
NULL
;

274 ià(
s
[
pos
+1] == '\n') {

276  
s
+
pos
;

279 
pos
++;

283  
NULL
;

284 
	}
}

288 
	$»adLÚgLÚg
(*
s
) {

289 
v
 = 0;

290 
dec
, 
muÉ
 = 1;

291 
c
;

293 ià(*
s
 == '-') {

294 
muÉ
 = -1;

295 
s
++;

296 } ià(*
s
 == '+') {

297 
muÉ
 = 1;

298 
s
++;

301 (
c
 = *(
s
++)) != '\r') {

302 
dec
 = 
c
 - '0';

303 ià(
dec
 >= 0 && dec < 10) {

304 
v
 *= 10;

305 
v
 +ğ
dec
;

312  
muÉ
*
v
;

313 
	}
}

315 *
	$»adLše
(
»disR—d”
 *
r
, *
_Ën
) {

316 *
p
, *
s
;

317 
Ën
;

319 
p
 = 
r
->
buf
+r->
pos
;

320 
s
 = 
	`£ekNewlše
(
p
,(
r
->
Ën
-r->
pos
));

321 ià(
s
 !ğ
NULL
) {

322 
Ën
 = 
s
-(
r
->
buf
+r->
pos
);

323 
r
->
pos
 +ğ
Ën
+2;

324 ià(
_Ën
è*_ËÀğ
Ën
;

325  
p
;

327  
NULL
;

328 
	}
}

330 
	$moveToNextTask
(
»disR—d”
 *
r
) {

331 
»disR—dTask
 *
cur
, *
´v
;

332 
r
->
ridx
 >= 0) {

334 ià(
r
->
ridx
 == 0) {

335 
r
->
ridx
--;

339 
cur
 = &(
r
->
r¡ack
[r->
ridx
]);

340 
´v
 = &(
r
->
r¡ack
[r->
ridx
-1]);

341 
	`as£¹
(
´v
->
ty³
 =ğ
REDIS_REPLY_ARRAY
);

342 ià(
cur
->
idx
 =ğ
´v
->
–em’ts
-1) {

343 
r
->
ridx
--;

346 
	`as£¹
(
cur
->
idx
 < 
´v
->
–em’ts
);

347 
cur
->
ty³
 = -1;

348 
cur
->
–em’ts
 = -1;

349 
cur
->
idx
++;

353 
	}
}

355 
	$´oûssLšeI‹m
(
»disR—d”
 *
r
) {

356 
»disR—dTask
 *
cur
 = &(
r
->
r¡ack
[r->
ridx
]);

357 *
obj
;

358 *
p
;

359 
Ën
;

361 ià((
p
 = 
	`»adLše
(
r
,&
Ën
)è!ğ
NULL
) {

362 ià(
cur
->
ty³
 =ğ
REDIS_REPLY_INTEGER
) {

363 ià(
r
->
â
 &&„->â->
ü—‹IÁeg”
)

364 
obj
 = 
r
->
â
->
	`ü—‹IÁeg”
(
cur
,
	`»adLÚgLÚg
(
p
));

366 
obj
 = (*)
REDIS_REPLY_INTEGER
;

369 ià(
r
->
â
 &&„->â->
ü—‹SŒšg
)

370 
obj
 = 
r
->
â
->
	`ü—‹SŒšg
(
cur
,
p
,
Ën
);

372 
obj
 = (*)(
size_t
)(
cur
->
ty³
);

375 ià(
obj
 =ğ
NULL
) {

376 
	`__»disR—d”S‘E¼ÜOOM
(
r
);

377  
REDIS_ERR
;

381 ià(
r
->
ridx
 =ğ0èr->
»¶y
 = 
obj
;

382 
	`moveToNextTask
(
r
);

383  
REDIS_OK
;

386  
REDIS_ERR
;

387 
	}
}

389 
	$´oûssBulkI‹m
(
»disR—d”
 *
r
) {

390 
»disR—dTask
 *
cur
 = &(
r
->
r¡ack
[r->
ridx
]);

391 *
obj
 = 
NULL
;

392 *
p
, *
s
;

393 
Ën
;

394 
by‹Ën
;

395 
sucûss
 = 0;

397 
p
 = 
r
->
buf
+r->
pos
;

398 
s
 = 
	`£ekNewlše
(
p
,
r
->
Ën
-r->
pos
);

399 ià(
s
 !ğ
NULL
) {

400 
p
 = 
r
->
buf
+r->
pos
;

401 
by‹Ën
 = 
s
-(
r
->
buf
+r->
pos
)+2;

402 
Ën
 = 
	`»adLÚgLÚg
(
p
);

404 ià(
Ën
 < 0) {

406 ià(
r
->
â
 &&„->â->
ü—‹N
)

407 
obj
 = 
r
->
â
->
	`ü—‹N
(
cur
);

409 
obj
 = (*)
REDIS_REPLY_NIL
;

410 
sucûss
 = 1;

413 
by‹Ën
 +ğ
Ën
+2;

414 ià(
r
->
pos
+
by‹Ën
 <ğr->
Ën
) {

415 ià(
r
->
â
 &&„->â->
ü—‹SŒšg
)

416 
obj
 = 
r
->
â
->
	`ü—‹SŒšg
(
cur
,
s
+2,
Ën
);

418 
obj
 = (*)
REDIS_REPLY_STRING
;

419 
sucûss
 = 1;

424 ià(
sucûss
) {

425 ià(
obj
 =ğ
NULL
) {

426 
	`__»disR—d”S‘E¼ÜOOM
(
r
);

427  
REDIS_ERR
;

430 
r
->
pos
 +ğ
by‹Ën
;

433 ià(
r
->
ridx
 =ğ0èr->
»¶y
 = 
obj
;

434 
	`moveToNextTask
(
r
);

435  
REDIS_OK
;

439  
REDIS_ERR
;

440 
	}
}

442 
	$´oûssMuÉiBulkI‹m
(
»disR—d”
 *
r
) {

443 
»disR—dTask
 *
cur
 = &(
r
->
r¡ack
[r->
ridx
]);

444 *
obj
;

445 *
p
;

446 
–em’ts
;

447 
roÙ
 = 0;

450 ià(
r
->
ridx
 == 8) {

451 
	`__»disR—d”S‘E¼Ü
(
r
,
REDIS_ERR_PROTOCOL
,

453  
REDIS_ERR
;

456 ià((
p
 = 
	`»adLše
(
r
,
NULL
)) != NULL) {

457 
–em’ts
 = 
	`»adLÚgLÚg
(
p
);

458 
roÙ
 = (
r
->
ridx
 == 0);

460 ià(
–em’ts
 == -1) {

461 ià(
r
->
â
 &&„->â->
ü—‹N
)

462 
obj
 = 
r
->
â
->
	`ü—‹N
(
cur
);

464 
obj
 = (*)
REDIS_REPLY_NIL
;

466 ià(
obj
 =ğ
NULL
) {

467 
	`__»disR—d”S‘E¼ÜOOM
(
r
);

468  
REDIS_ERR
;

471 
	`moveToNextTask
(
r
);

473 ià(
r
->
â
 &&„->â->
ü—‹A¼ay
)

474 
obj
 = 
r
->
â
->
	`ü—‹A¼ay
(
cur
,
–em’ts
);

476 
obj
 = (*)
REDIS_REPLY_ARRAY
;

478 ià(
obj
 =ğ
NULL
) {

479 
	`__»disR—d”S‘E¼ÜOOM
(
r
);

480  
REDIS_ERR
;

484 ià(
–em’ts
 > 0) {

485 
cur
->
–em’ts
 =ƒlements;

486 
cur
->
obj
 = obj;

487 
r
->
ridx
++;

488 
r
->
r¡ack
[r->
ridx
].
ty³
 = -1;

489 
r
->
r¡ack
[r->
ridx
].
–em’ts
 = -1;

490 
r
->
r¡ack
[r->
ridx
].
idx
 = 0;

491 
r
->
r¡ack
[r->
ridx
].
obj
 = 
NULL
;

492 
r
->
r¡ack
[r->
ridx
].
·»Á
 = 
cur
;

493 
r
->
r¡ack
[r->
ridx
].
´ivd©a
 =„->privdata;

495 
	`moveToNextTask
(
r
);

500 ià(
roÙ
è
r
->
»¶y
 = 
obj
;

501  
REDIS_OK
;

504  
REDIS_ERR
;

505 
	}
}

507 
	$´oûssI‹m
(
»disR—d”
 *
r
) {

508 
»disR—dTask
 *
cur
 = &(
r
->
r¡ack
[r->
ridx
]);

509 *
p
;

512 ià(
cur
->
ty³
 < 0) {

513 ià((
p
 = 
	`»adBy‹s
(
r
,1)è!ğ
NULL
) {

514 
p
[0]) {

516 
cur
->
ty³
 = 
REDIS_REPLY_ERROR
;

519 
cur
->
ty³
 = 
REDIS_REPLY_STATUS
;

522 
cur
->
ty³
 = 
REDIS_REPLY_INTEGER
;

525 
cur
->
ty³
 = 
REDIS_REPLY_STRING
;

528 
cur
->
ty³
 = 
REDIS_REPLY_ARRAY
;

531 
	`__»disR—d”S‘E¼ÜPrÙocŞBy‹
(
r
,*
p
);

532  
REDIS_ERR
;

536  
REDIS_ERR
;

541 
cur
->
ty³
) {

542 
REDIS_REPLY_ERROR
:

543 
REDIS_REPLY_STATUS
:

544 
REDIS_REPLY_INTEGER
:

545  
	`´oûssLšeI‹m
(
r
);

546 
REDIS_REPLY_STRING
:

547  
	`´oûssBulkI‹m
(
r
);

548 
REDIS_REPLY_ARRAY
:

549  
	`´oûssMuÉiBulkI‹m
(
r
);

551 
	`as£¹
(
NULL
);

552  
REDIS_ERR
;

554 
	}
}

556 
»disR—d”
 *
	$»disR—d”C»©e
() {

557 
»disR—d”
 *
r
;

559 
r
 = 
	`ÿÎoc
((
»disR—d”
),1);

560 ià(
r
 =ğ
NULL
)

561  
NULL
;

563 
r
->
”r
 = 0;

564 
r
->
”r¡r
[0] = '\0';

565 
r
->
â
 = &
deçuÉFunùiÚs
;

566 
r
->
buf
 = 
	`sd£m±y
();

567 
r
->
maxbuf
 = 
REDIS_READER_MAX_BUF
;

568 ià(
r
->
buf
 =ğ
NULL
) {

569 
	`ä“
(
r
);

570  
NULL
;

573 
r
->
ridx
 = -1;

574  
r
;

575 
	}
}

577 
	$»disR—d”F»e
(
»disR—d”
 *
r
) {

578 ià(
r
->
»¶y
 !ğ
NULL
 &&„->
â
 &&„->â->
ä“Objeù
)

579 
r
->
â
->
	`ä“Objeù
Ô->
»¶y
);

580 ià(
r
->
buf
 !ğ
NULL
)

581 
	`sdsä“
(
r
->
buf
);

582 
	`ä“
(
r
);

583 
	}
}

585 
	$»disR—d”F“d
(
»disR—d”
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
) {

586 
sds
 
Ãwbuf
;

589 ià(
r
->
”r
)

590  
REDIS_ERR
;

593 ià(
buf
 !ğ
NULL
 && 
Ën
 >= 1) {

595 ià(
r
->
Ën
 =ğ0 &&„->
maxbuf
 !ğ0 && 
	`sd§va
Ô->
buf
) >„->maxbuf) {

596 
	`sdsä“
(
r
->
buf
);

597 
r
->
buf
 = 
	`sd£m±y
();

598 
r
->
pos
 = 0;

601 
	`as£¹
(
r
->
buf
 !ğ
NULL
);

604 
Ãwbuf
 = 
	`sdsÿ’
(
r
->
buf
,buf,
Ën
);

605 ià(
Ãwbuf
 =ğ
NULL
) {

606 
	`__»disR—d”S‘E¼ÜOOM
(
r
);

607  
REDIS_ERR
;

610 
r
->
buf
 = 
Ãwbuf
;

611 
r
->
Ën
 = 
	`sd¦’
Ô->
buf
);

614  
REDIS_OK
;

615 
	}
}

617 
	$»disR—d”G‘R•ly
(
»disR—d”
 *
r
, **
»¶y
) {

619 ià(
»¶y
 !ğ
NULL
)

620 *
»¶y
 = 
NULL
;

623 ià(
r
->
”r
)

624  
REDIS_ERR
;

627 ià(
r
->
Ën
 == 0)

628  
REDIS_OK
;

631 ià(
r
->
ridx
 == -1) {

632 
r
->
r¡ack
[0].
ty³
 = -1;

633 
r
->
r¡ack
[0].
–em’ts
 = -1;

634 
r
->
r¡ack
[0].
idx
 = -1;

635 
r
->
r¡ack
[0].
obj
 = 
NULL
;

636 
r
->
r¡ack
[0].
·»Á
 = 
NULL
;

637 
r
->
r¡ack
[0].
´ivd©a
 =„->privdata;

638 
r
->
ridx
 = 0;

642 
r
->
ridx
 >= 0)

643 ià(
	`´oûssI‹m
(
r
è!ğ
REDIS_OK
)

647 ià(
r
->
”r
)

648  
REDIS_ERR
;

652 ià(
r
->
pos
 >= 1024) {

653 
	`sd¤ªge
(
r
->
buf
,r->
pos
,-1);

654 
r
->
pos
 = 0;

655 
r
->
Ën
 = 
	`sd¦’
Ô->
buf
);

659 ià(
r
->
ridx
 == -1) {

660 ià(
»¶y
 !ğ
NULL
)

661 *
»¶y
 = 
r
->reply;

662 
r
->
»¶y
 = 
NULL
;

664  
REDIS_OK
;

665 
	}
}

668 
	$š’
(
i
) {

669 
Ën
 = 0;

670 ià(
i
 < 0) {

671 
Ën
++;

672 
i
 = -i;

675 
Ën
++;

676 
i
 /= 10;

677 } 
i
);

678  
Ën
;

679 
	}
}

682 
size_t
 
	$bulkËn
(
size_t
 
Ën
) {

683  1+
	`š’
(
Ën
)+2+len+2;

684 
	}
}

686 
	$»disvFÜm©Commªd
(**
rg‘
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
) {

687 cÚ¡ *
c
 = 
fÜm©
;

688 *
cmd
 = 
NULL
;

689 
pos
;

690 
sds
 
cu¿rg
, 
Ãw¬g
;

691 
touched
 = 0;

692 **
cu¿rgv
 = 
NULL
, **
Ãw¬gv
 = NULL;

693 
¬gc
 = 0;

694 
tÙËn
 = 0;

695 
j
;

698 ià(
rg‘
 =ğ
NULL
)

702 
cu¿rg
 = 
	`sd£m±y
();

703 ià(
cu¿rg
 =ğ
NULL
)

706 *
c
 != '\0') {

707 ià(*
c
 != '%' || c[1] == '\0') {

708 ià(*
c
 == ' ') {

709 ià(
touched
) {

710 
Ãw¬gv
 = 
	`»®loc
(
cu¿rgv
,(*)*(
¬gc
+1));

711 ià(
Ãw¬gv
 =ğ
NULL
è
”r
;

712 
cu¿rgv
 = 
Ãw¬gv
;

713 
cu¿rgv
[
¬gc
++] = 
cu¿rg
;

714 
tÙËn
 +ğ
	`bulkËn
(
	`sd¦’
(
cu¿rg
));

717 
cu¿rg
 = 
	`sd£m±y
();

718 ià(
cu¿rg
 =ğ
NULL
è
”r
;

719 
touched
 = 0;

722 
Ãw¬g
 = 
	`sdsÿ’
(
cu¿rg
,
c
,1);

723 ià(
Ãw¬g
 =ğ
NULL
è
”r
;

724 
cu¿rg
 = 
Ãw¬g
;

725 
touched
 = 1;

728 *
¬g
;

729 
size_t
 
size
;

732 
Ãw¬g
 = 
cu¿rg
;

734 
c
[1]) {

736 
¬g
 = 
	`va_¬g
(
­
,*);

737 
size
 = 
	`¡¾’
(
¬g
);

738 ià(
size
 > 0)

739 
Ãw¬g
 = 
	`sdsÿ’
(
cu¿rg
,
¬g
,
size
);

742 
¬g
 = 
	`va_¬g
(
­
,*);

743 
size
 = 
	`va_¬g
(
­
,
size_t
);

744 ià(
size
 > 0)

745 
Ãw¬g
 = 
	`sdsÿ’
(
cu¿rg
,
¬g
,
size
);

748 
Ãw¬g
 = 
	`sdsÿt
(
cu¿rg
,"%");

753 cÚ¡ 
štfmts
[] = "diouxX";

754 
_fÜm©
[16];

755 cÚ¡ *
_p
 = 
c
+1;

756 
size_t
 
_l
 = 0;

757 
va_li¡
 
_ıy
;

760 ià(*
_p
 != '\0' && *_p == '#') _p++;

761 ià(*
_p
 != '\0' && *_p == '0') _p++;

762 ià(*
_p
 != '\0' && *_p == '-') _p++;

763 ià(*
_p
 != '\0' && *_p == ' ') _p++;

764 ià(*
_p
 != '\0' && *_p == '+') _p++;

767 *
_p
 !ğ'\0' && 
	`isdig™
(*_p)) _p++;

770 ià(*
_p
 == '.') {

771 
_p
++;

772 *
_p
 !ğ'\0' && 
	`isdig™
(*_p)) _p++;

776 
	`va_cİy
(
_ıy
,
­
);

779 ià(
	`¡rchr
(
štfmts
,*
_p
è!ğ
NULL
) {

780 
	`va_¬g
(
­
,);

781 
fmt_v®id
;

785 ià(
	`¡rchr
("eEfFgGaA",*
_p
è!ğ
NULL
) {

786 
	`va_¬g
(
­
,);

787 
fmt_v®id
;

791 ià(
_p
[0] == 'h' && _p[1] == 'h') {

792 
_p
 += 2;

793 ià(*
_p
 !ğ'\0' && 
	`¡rchr
(
štfmts
,*_pè!ğ
NULL
) {

794 
	`va_¬g
(
­
,);

795 
fmt_v®id
;

797 
fmt_šv®id
;

801 ià(
_p
[0] == 'h') {

802 
_p
 += 1;

803 ià(*
_p
 !ğ'\0' && 
	`¡rchr
(
štfmts
,*_pè!ğ
NULL
) {

804 
	`va_¬g
(
­
,);

805 
fmt_v®id
;

807 
fmt_šv®id
;

811 ià(
_p
[0] == 'l' && _p[1] == 'l') {

812 
_p
 += 2;

813 ià(*
_p
 !ğ'\0' && 
	`¡rchr
(
štfmts
,*_pè!ğ
NULL
) {

814 
	`va_¬g
(
­
,);

815 
fmt_v®id
;

817 
fmt_šv®id
;

821 ià(
_p
[0] == 'l') {

822 
_p
 += 1;

823 ià(*
_p
 !ğ'\0' && 
	`¡rchr
(
štfmts
,*_pè!ğ
NULL
) {

824 
	`va_¬g
(
­
,);

825 
fmt_v®id
;

827 
fmt_šv®id
;

830 
fmt_šv®id
:

831 
	`va_’d
(
_ıy
);

832 
”r
;

834 
fmt_v®id
:

835 
_l
 = (
_p
+1)-
c
;

836 ià(
_l
 < (
_fÜm©
)-2) {

837 
	`memıy
(
_fÜm©
,
c
,
_l
);

838 
_fÜm©
[
_l
] = '\0';

839 
Ãw¬g
 = 
	`sdsÿtv´štf
(
cu¿rg
,
_fÜm©
,
_ıy
);

843 
c
 = 
_p
-1;

846 
	`va_’d
(
_ıy
);

851 ià(
Ãw¬g
 =ğ
NULL
è
”r
;

852 
cu¿rg
 = 
Ãw¬g
;

854 
touched
 = 1;

855 
c
++;

857 
c
++;

861 ià(
touched
) {

862 
Ãw¬gv
 = 
	`»®loc
(
cu¿rgv
,(*)*(
¬gc
+1));

863 ià(
Ãw¬gv
 =ğ
NULL
è
”r
;

864 
cu¿rgv
 = 
Ãw¬gv
;

865 
cu¿rgv
[
¬gc
++] = 
cu¿rg
;

866 
tÙËn
 +ğ
	`bulkËn
(
	`sd¦’
(
cu¿rg
));

868 
	`sdsä“
(
cu¿rg
);

872 
cu¿rg
 = 
NULL
;

875 
tÙËn
 +ğ1+
	`š’
(
¬gc
)+2;

878 
cmd
 = 
	`m®loc
(
tÙËn
+1);

879 ià(
cmd
 =ğ
NULL
è
”r
;

881 
pos
 = 
	`¥rštf
(
cmd
,"*%d\r\n",
¬gc
);

882 
j
 = 0; j < 
¬gc
; j++) {

883 
pos
 +ğ
	`¥rštf
(
cmd
+pos,"$%zu\r\n",
	`sd¦’
(
cu¿rgv
[
j
]));

884 
	`memıy
(
cmd
+
pos
,
cu¿rgv
[
j
],
	`sd¦’
(curargv[j]));

885 
pos
 +ğ
	`sd¦’
(
cu¿rgv
[
j
]);

886 
	`sdsä“
(
cu¿rgv
[
j
]);

887 
cmd
[
pos
++] = '\r';

888 
cmd
[
pos
++] = '\n';

890 
	`as£¹
(
pos
 =ğ
tÙËn
);

891 
cmd
[
pos
] = '\0';

893 
	`ä“
(
cu¿rgv
);

894 *
rg‘
 = 
cmd
;

895  
tÙËn
;

897 
”r
:

898 
¬gc
--)

899 
	`sdsä“
(
cu¿rgv
[
¬gc
]);

900 
	`ä“
(
cu¿rgv
);

902 ià(
cu¿rg
 !ğ
NULL
)

903 
	`sdsä“
(
cu¿rg
);

907 ià(
cmd
 !ğ
NULL
)

908 
	`ä“
(
cmd
);

911 
	}
}

925 
	$»disFÜm©Commªd
(**
rg‘
, cÚ¡ *
fÜm©
, ...) {

926 
va_li¡
 
­
;

927 
Ën
;

928 
	`va_¡¬t
(
­
,
fÜm©
);

929 
Ën
 = 
	`»disvFÜm©Commªd
(
rg‘
,
fÜm©
,
­
);

930 
	`va_’d
(
­
);

931  
Ën
;

932 
	}
}

939 
	$»disFÜm©CommªdArgv
(**
rg‘
, 
¬gc
, cÚ¡ **
¬gv
, cÚ¡ 
size_t
 *
¬gvËn
) {

940 *
cmd
 = 
NULL
;

941 
pos
;

942 
size_t
 
Ën
;

943 
tÙËn
, 
j
;

946 
tÙËn
 = 1+
	`š’
(
¬gc
)+2;

947 
j
 = 0; j < 
¬gc
; j++) {

948 
Ën
 = 
¬gvËn
 ?‡rgvËn[
j
] : 
	`¡¾’
(
¬gv
[j]);

949 
tÙËn
 +ğ
	`bulkËn
(
Ën
);

953 
cmd
 = 
	`m®loc
(
tÙËn
+1);

954 ià(
cmd
 =ğ
NULL
)

957 
pos
 = 
	`¥rštf
(
cmd
,"*%d\r\n",
¬gc
);

958 
j
 = 0; j < 
¬gc
; j++) {

959 
Ën
 = 
¬gvËn
 ?‡rgvËn[
j
] : 
	`¡¾’
(
¬gv
[j]);

960 
pos
 +ğ
	`¥rštf
(
cmd
+pos,"$%zu\r\n",
Ën
);

961 
	`memıy
(
cmd
+
pos
,
¬gv
[
j
],
Ën
);

962 
pos
 +ğ
Ën
;

963 
cmd
[
pos
++] = '\r';

964 
cmd
[
pos
++] = '\n';

966 
	`as£¹
(
pos
 =ğ
tÙËn
);

967 
cmd
[
pos
] = '\0';

969 *
rg‘
 = 
cmd
;

970  
tÙËn
;

971 
	}
}

973 
	$__»disS‘E¼Ü
(
»disCÚ‹xt
 *
c
, 
ty³
, cÚ¡ *
¡r
) {

974 
size_t
 
Ën
;

976 
c
->
”r
 = 
ty³
;

977 ià(
¡r
 !ğ
NULL
) {

978 
Ën
 = 
	`¡¾’
(
¡r
);

979 
Ën
 =†’ < ((
c
->
”r¡r
)-1) ?†en : ((c->errstr)-1);

980 
	`memıy
(
c
->
”r¡r
,
¡r
,
Ën
);

981 
c
->
”r¡r
[
Ën
] = '\0';

984 
	`as£¹
(
ty³
 =ğ
REDIS_ERR_IO
);

985 
	`¡»¼Ü_r
(
”ºo
,
c
->
”r¡r
,(c->errstr));

987 
	}
}

989 
»disCÚ‹xt
 *
	$»disCÚ‹xtIn™
() {

990 
»disCÚ‹xt
 *
c
;

992 
c
 = 
	`ÿÎoc
(1,(
»disCÚ‹xt
));

993 ià(
c
 =ğ
NULL
)

994  
NULL
;

996 
c
->
”r
 = 0;

997 
c
->
”r¡r
[0] = '\0';

998 
c
->
obuf
 = 
	`sd£m±y
();

999 
c
->
»ad”
 = 
	`»disR—d”C»©e
();

1000  
c
;

1001 
	}
}

1003 
	$»disF»e
(
»disCÚ‹xt
 *
c
) {

1004 ià(
c
->
fd
 > 0)

1005 
	`şo£
(
c
->
fd
);

1006 ià(
c
->
obuf
 !ğ
NULL
)

1007 
	`sdsä“
(
c
->
obuf
);

1008 ià(
c
->
»ad”
 !ğ
NULL
)

1009 
	`»disR—d”F»e
(
c
->
»ad”
);

1010 
	`ä“
(
c
);

1011 
	}
}

1013 
	$»disF»eK“pFd
(
»disCÚ‹xt
 *
c
) {

1014 
fd
 = 
c
->fd;

1015 
c
->
fd
 = -1;

1016 
	`»disF»e
(
c
);

1017  
fd
;

1018 
	}
}

1023 
»disCÚ‹xt
 *
	$»disCÚÃù
(cÚ¡ *

, 
pÜt
) {

1024 
»disCÚ‹xt
 *
c
;

1026 
c
 = 
	`»disCÚ‹xtIn™
();

1027 ià(
c
 =ğ
NULL
)

1028  
NULL
;

1030 
c
->
æags
 |ğ
REDIS_BLOCK
;

1031 
	`»disCÚ‹xtCÚÃùTı
(
c
,

,
pÜt
,
NULL
);

1032  
c
;

1033 
	}
}

1035 
»disCÚ‹xt
 *
	$»disCÚÃùW™hTimeout
(cÚ¡ *

, 
pÜt
, cÚ¡ 
timev®
 
tv
) {

1036 
»disCÚ‹xt
 *
c
;

1038 
c
 = 
	`»disCÚ‹xtIn™
();

1039 ià(
c
 =ğ
NULL
)

1040  
NULL
;

1042 
c
->
æags
 |ğ
REDIS_BLOCK
;

1043 
	`»disCÚ‹xtCÚÃùTı
(
c
,

,
pÜt
,&
tv
);

1044  
c
;

1045 
	}
}

1047 
»disCÚ‹xt
 *
	$»disCÚÃùNÚBlock
(cÚ¡ *

, 
pÜt
) {

1048 
»disCÚ‹xt
 *
c
;

1050 
c
 = 
	`»disCÚ‹xtIn™
();

1051 ià(
c
 =ğ
NULL
)

1052  
NULL
;

1054 
c
->
æags
 &ğ~
REDIS_BLOCK
;

1055 
	`»disCÚ‹xtCÚÃùTı
(
c
,

,
pÜt
,
NULL
);

1056  
c
;

1057 
	}
}

1059 
»disCÚ‹xt
 *
	$»disCÚÃùBšdNÚBlock
(cÚ¡ *

, 
pÜt
,

1060 cÚ¡ *
sourû_addr
) {

1061 
»disCÚ‹xt
 *
c
 = 
	`»disCÚ‹xtIn™
();

1062 
c
->
æags
 &ğ~
REDIS_BLOCK
;

1063 
	`»disCÚ‹xtCÚÃùBšdTı
(
c
,

,
pÜt
,
NULL
,
sourû_addr
);

1064  
c
;

1065 
	}
}

1067 
»disCÚ‹xt
 *
	$»disCÚÃùUnix
(cÚ¡ *
·th
) {

1068 
»disCÚ‹xt
 *
c
;

1070 
c
 = 
	`»disCÚ‹xtIn™
();

1071 ià(
c
 =ğ
NULL
)

1072  
NULL
;

1074 
c
->
æags
 |ğ
REDIS_BLOCK
;

1075 
	`»disCÚ‹xtCÚÃùUnix
(
c
,
·th
,
NULL
);

1076  
c
;

1077 
	}
}

1079 
»disCÚ‹xt
 *
	$»disCÚÃùUnixW™hTimeout
(cÚ¡ *
·th
, cÚ¡ 
timev®
 
tv
) {

1080 
»disCÚ‹xt
 *
c
;

1082 
c
 = 
	`»disCÚ‹xtIn™
();

1083 ià(
c
 =ğ
NULL
)

1084  
NULL
;

1086 
c
->
æags
 |ğ
REDIS_BLOCK
;

1087 
	`»disCÚ‹xtCÚÃùUnix
(
c
,
·th
,&
tv
);

1088  
c
;

1089 
	}
}

1091 
»disCÚ‹xt
 *
	$»disCÚÃùUnixNÚBlock
(cÚ¡ *
·th
) {

1092 
»disCÚ‹xt
 *
c
;

1094 
c
 = 
	`»disCÚ‹xtIn™
();

1095 ià(
c
 =ğ
NULL
)

1096  
NULL
;

1098 
c
->
æags
 &ğ~
REDIS_BLOCK
;

1099 
	`»disCÚ‹xtCÚÃùUnix
(
c
,
·th
,
NULL
);

1100  
c
;

1101 
	}
}

1103 
»disCÚ‹xt
 *
	$»disCÚÃùFd
(
fd
) {

1104 
»disCÚ‹xt
 *
c
;

1106 
c
 = 
	`»disCÚ‹xtIn™
();

1107 ià(
c
 =ğ
NULL
)

1108  
NULL
;

1110 
c
->
fd
 = fd;

1111 
c
->
æags
 |ğ
REDIS_BLOCK
 | 
REDIS_CONNECTED
;

1112  
c
;

1113 
	}
}

1116 
	$»disS‘Timeout
(
»disCÚ‹xt
 *
c
, cÚ¡ 
timev®
 
tv
) {

1117 ià(
c
->
æags
 & 
REDIS_BLOCK
)

1118  
	`»disCÚ‹xtS‘Timeout
(
c
,
tv
);

1119  
REDIS_ERR
;

1120 
	}
}

1123 
	$»disEÇbËK“pAlive
(
»disCÚ‹xt
 *
c
) {

1124 ià(
	`»disK“pAlive
(
c
, 
REDIS_KEEPALIVE_INTERVAL
è!ğ
REDIS_OK
)

1125  
REDIS_ERR
;

1126  
REDIS_OK
;

1127 
	}
}

1134 
	$»disBufãrR—d
(
»disCÚ‹xt
 *
c
) {

1135 
buf
[1024*16];

1136 
Ä—d
;

1139 ià(
c
->
”r
)

1140  
REDIS_ERR
;

1142 
Ä—d
 = 
	`»ad
(
c
->
fd
,
buf
,(buf));

1143 ià(
Ä—d
 == -1) {

1144 ià((
”ºo
 =ğ
EAGAIN
 && !(
c
->
æags
 & 
REDIS_BLOCK
)è|| (”ºØ=ğ
EINTR
)) {

1147 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_IO
,
NULL
);

1148  
REDIS_ERR
;

1150 } ià(
Ä—d
 == 0) {

1151 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_EOF
,"Server closedhe connection");

1152  
REDIS_ERR
;

1154 ià(
	`»disR—d”F“d
(
c
->
»ad”
,
buf
,
Ä—d
è!ğ
REDIS_OK
) {

1155 
	`__»disS‘E¼Ü
(
c
,c->
»ad”
->
”r
,c->»ad”->
”r¡r
);

1156  
REDIS_ERR
;

1159  
REDIS_OK
;

1160 
	}
}

1171 
	$»disBufãrWr™e
(
»disCÚ‹xt
 *
c
, *
dÚe
) {

1172 
nwr™‹n
;

1175 ià(
c
->
”r
)

1176  
REDIS_ERR
;

1178 ià(
	`sd¦’
(
c
->
obuf
) > 0) {

1179 
nwr™‹n
 = 
	`wr™e
(
c
->
fd
,c->
obuf
,
	`sd¦’
(c->obuf));

1180 ià(
nwr™‹n
 == -1) {

1181 ià((
”ºo
 =ğ
EAGAIN
 && !(
c
->
æags
 & 
REDIS_BLOCK
)è|| (”ºØ=ğ
EINTR
)) {

1184 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_IO
,
NULL
);

1185  
REDIS_ERR
;

1187 } ià(
nwr™‹n
 > 0) {

1188 ià(
nwr™‹n
 =ğ(sigÃd)
	`sd¦’
(
c
->
obuf
)) {

1189 
	`sdsä“
(
c
->
obuf
);

1190 
c
->
obuf
 = 
	`sd£m±y
();

1192 
	`sd¤ªge
(
c
->
obuf
,
nwr™‹n
,-1);

1196 ià(
dÚe
 !ğ
NULL
è*dÚğ(
	`sd¦’
(
c
->
obuf
) == 0);

1197  
REDIS_OK
;

1198 
	}
}

1202 
	$»disG‘R•lyFromR—d”
(
»disCÚ‹xt
 *
c
, **
»¶y
) {

1203 ià(
	`»disR—d”G‘R•ly
(
c
->
»ad”
,
»¶y
è=ğ
REDIS_ERR
) {

1204 
	`__»disS‘E¼Ü
(
c
,c->
»ad”
->
”r
,c->»ad”->
”r¡r
);

1205  
REDIS_ERR
;

1207  
REDIS_OK
;

1208 
	}
}

1210 
	$»disG‘R•ly
(
»disCÚ‹xt
 *
c
, **
»¶y
) {

1211 
wdÚe
 = 0;

1212 *
aux
 = 
NULL
;

1215 ià(
	`»disG‘R•lyFromR—d”
(
c
,&
aux
è=ğ
REDIS_ERR
)

1216  
REDIS_ERR
;

1219 ià(
aux
 =ğ
NULL
 && 
c
->
æags
 & 
REDIS_BLOCK
) {

1222 ià(
	`»disBufãrWr™e
(
c
,&
wdÚe
è=ğ
REDIS_ERR
)

1223  
REDIS_ERR
;

1224 } !
wdÚe
);

1228 ià(
	`»disBufãrR—d
(
c
è=ğ
REDIS_ERR
)

1229  
REDIS_ERR
;

1230 ià(
	`»disG‘R•lyFromR—d”
(
c
,&
aux
è=ğ
REDIS_ERR
)

1231  
REDIS_ERR
;

1232 } 
aux
 =ğ
NULL
);

1236 ià(
»¶y
 !ğ
NULL
è*»¶y = 
aux
;

1237  
REDIS_OK
;

1238 
	}
}

1247 
	$__»disAµ’dCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
cmd
, 
size_t
 
Ën
) {

1248 
sds
 
Ãwbuf
;

1250 
Ãwbuf
 = 
	`sdsÿ’
(
c
->
obuf
,
cmd
,
Ën
);

1251 ià(
Ãwbuf
 =ğ
NULL
) {

1252 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OOM
,"Out of memory");

1253  
REDIS_ERR
;

1256 
c
->
obuf
 = 
Ãwbuf
;

1257  
REDIS_OK
;

1258 
	}
}

1260 
	$»disAµ’dFÜm©‹dCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
cmd
, 
size_t
 
Ën
) {

1262 ià(
	`__»disAµ’dCommªd
(
c
, 
cmd
, 
Ën
è!ğ
REDIS_OK
) {

1263  
REDIS_ERR
;

1266  
REDIS_OK
;

1267 
	}
}

1269 
	$»disvAµ’dCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
) {

1270 *
cmd
;

1271 
Ën
;

1273 
Ën
 = 
	`»disvFÜm©Commªd
(&
cmd
,
fÜm©
,
­
);

1274 ià(
Ën
 == -1) {

1275 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OOM
,"Out of memory");

1276  
REDIS_ERR
;

1279 ià(
	`__»disAµ’dCommªd
(
c
,
cmd
,
Ën
è!ğ
REDIS_OK
) {

1280 
	`ä“
(
cmd
);

1281  
REDIS_ERR
;

1284 
	`ä“
(
cmd
);

1285  
REDIS_OK
;

1286 
	}
}

1288 
	$»disAµ’dCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
fÜm©
, ...) {

1289 
va_li¡
 
­
;

1290 
»t
;

1292 
	`va_¡¬t
(
­
,
fÜm©
);

1293 
»t
 = 
	`»disvAµ’dCommªd
(
c
,
fÜm©
,
­
);

1294 
	`va_’d
(
­
);

1295  
»t
;

1296 
	}
}

1298 
	$»disAµ’dCommªdArgv
(
»disCÚ‹xt
 *
c
, 
¬gc
, cÚ¡ **
¬gv
, cÚ¡ 
size_t
 *
¬gvËn
) {

1299 *
cmd
;

1300 
Ën
;

1302 
Ën
 = 
	`»disFÜm©CommªdArgv
(&
cmd
,
¬gc
,
¬gv
,
¬gvËn
);

1303 ià(
Ën
 == -1) {

1304 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OOM
,"Out of memory");

1305  
REDIS_ERR
;

1308 ià(
	`__»disAµ’dCommªd
(
c
,
cmd
,
Ën
è!ğ
REDIS_OK
) {

1309 
	`ä“
(
cmd
);

1310  
REDIS_ERR
;

1313 
	`ä“
(
cmd
);

1314  
REDIS_OK
;

1315 
	}
}

1328 *
	$__»disBlockFÜR•ly
(
»disCÚ‹xt
 *
c
) {

1329 *
»¶y
;

1331 ià(
c
->
æags
 & 
REDIS_BLOCK
) {

1332 ià(
	`»disG‘R•ly
(
c
,&
»¶y
è!ğ
REDIS_OK
)

1333  
NULL
;

1334  
»¶y
;

1336  
NULL
;

1337 
	}
}

1339 *
	$»disvCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
) {

1340 ià(
	`»disvAµ’dCommªd
(
c
,
fÜm©
,
­
è!ğ
REDIS_OK
)

1341  
NULL
;

1342  
	`__»disBlockFÜR•ly
(
c
);

1343 
	}
}

1345 *
	$»disCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
fÜm©
, ...) {

1346 
va_li¡
 
­
;

1347 *
»¶y
 = 
NULL
;

1348 
	`va_¡¬t
(
­
,
fÜm©
);

1349 
»¶y
 = 
	`»disvCommªd
(
c
,
fÜm©
,
­
);

1350 
	`va_’d
(
­
);

1351  
»¶y
;

1352 
	}
}

1354 *
	$»disCommªdArgv
(
»disCÚ‹xt
 *
c
, 
¬gc
, cÚ¡ **
¬gv
, cÚ¡ 
size_t
 *
¬gvËn
) {

1355 ià(
	`»disAµ’dCommªdArgv
(
c
,
¬gc
,
¬gv
,
¬gvËn
è!ğ
REDIS_OK
)

1356  
NULL
;

1357  
	`__»disBlockFÜR•ly
(
c
);

1358 
	}
}

	@deps/hiredis/hiredis.h

32 #iâdeà
__HIREDIS_H


33 
	#__HIREDIS_H


	)

34 
	~<¡dio.h
>

35 
	~<¡d¬g.h
>

36 
	~<sys/time.h
>

38 
	#HIREDIS_MAJOR
 0

	)

39 
	#HIREDIS_MINOR
 11

	)

40 
	#HIREDIS_PATCH
 0

	)

42 
	#REDIS_ERR
 -1

	)

43 
	#REDIS_OK
 0

	)

49 
	#REDIS_ERR_IO
 1

	)

50 
	#REDIS_ERR_EOF
 3

	)

51 
	#REDIS_ERR_PROTOCOL
 4

	)

52 
	#REDIS_ERR_OOM
 5

	)

53 
	#REDIS_ERR_OTHER
 2

	)

57 
	#REDIS_BLOCK
 0x1

	)

61 
	#REDIS_CONNECTED
 0x2

	)

67 
	#REDIS_DISCONNECTING
 0x4

	)

71 
	#REDIS_FREEING
 0x8

	)

74 
	#REDIS_IN_CALLBACK
 0x10

	)

77 
	#REDIS_SUBSCRIBED
 0x20

	)

80 
	#REDIS_MONITORING
 0x40

	)

82 
	#REDIS_REPLY_STRING
 1

	)

83 
	#REDIS_REPLY_ARRAY
 2

	)

84 
	#REDIS_REPLY_INTEGER
 3

	)

85 
	#REDIS_REPLY_NIL
 4

	)

86 
	#REDIS_REPLY_STATUS
 5

	)

87 
	#REDIS_REPLY_ERROR
 6

	)

89 
	#REDIS_READER_MAX_BUF
 (1024*16è

	)

91 
	#REDIS_KEEPALIVE_INTERVAL
 15

	)

93 #ifdeà
__ılu¥lus


98 
	s»disR•ly
 {

99 
ty³
;

100 
š‹g”
;

101 
Ën
;

102 *
¡r
;

103 
size_t
 
–em’ts
;

104 
»disR•ly
 **
–em’t
;

105 } 
	t»disR•ly
;

107 
	s»disR—dTask
 {

108 
ty³
;

109 
–em’ts
;

110 
idx
;

111 *
obj
;

112 
»disR—dTask
 *
·»Á
;

113 *
´ivd©a
;

114 } 
	t»disR—dTask
;

116 
	s»disR•lyObjeùFunùiÚs
 {

117 *(*
ü—‹SŒšg
)(cÚ¡ 
»disR—dTask
*, *, 
size_t
);

118 *(*
ü—‹A¼ay
)(cÚ¡ 
»disR—dTask
*, );

119 *(*
ü—‹IÁeg”
)(cÚ¡ 
»disR—dTask
*, );

120 *(*
ü—‹N
)(cÚ¡ 
»disR—dTask
*);

121 (*
ä“Objeù
)(*);

122 } 
	t»disR•lyObjeùFunùiÚs
;

125 
	s»disR—d”
 {

126 
”r
;

127 
”r¡r
[128];

129 *
buf
;

130 
size_t
 
pos
;

131 
size_t
 
Ën
;

132 
size_t
 
maxbuf
;

134 
»disR—dTask
 
r¡ack
[9];

135 
ridx
;

136 *
»¶y
;

138 
»disR•lyObjeùFunùiÚs
 *
â
;

139 *
´ivd©a
;

140 } 
	t»disR—d”
;

143 
»disR—d”
 *
»disR—d”C»©e
();

144 
»disR—d”F»e
(
»disR—d”
 *
r
);

145 
»disR—d”F“d
(
»disR—d”
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
);

146 
»disR—d”G‘R•ly
(
»disR—d”
 *
r
, **
»¶y
);

149 
	#»disR•lyR—d”C»©e
 
»disR—d”C»©e


	)

150 
	#»disR•lyR—d”F»e
 
»disR—d”F»e


	)

151 
	#»disR•lyR—d”F“d
 
»disR—d”F“d


	)

152 
	#»disR•lyR—d”G‘R•ly
 
»disR—d”G‘R•ly


	)

153 
	#»disR•lyR—d”S‘Privd©a
(
_r
, 
_p
è()(((
»disR—d”
*)(_r))->
´ivd©a
 = (_p))

	)

154 
	#»disR•lyR—d”G‘Objeù
(
_r
è(((
»disR—d”
*)(_r))->
»¶y
)

	)

155 
	#»disR•lyR—d”G‘E¼Ü
(
_r
è(((
»disR—d”
*)(_r))->
”r¡r
)

	)

158 
ä“R•lyObjeù
(*
»¶y
);

161 
»disvFÜm©Commªd
(**
rg‘
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
);

162 
»disFÜm©Commªd
(**
rg‘
, cÚ¡ *
fÜm©
, ...);

163 
»disFÜm©CommªdArgv
(**
rg‘
, 
¬gc
, cÚ¡ **
¬gv
, cÚ¡ 
size_t
 *
¬gvËn
);

166 
	s»disCÚ‹xt
 {

167 
”r
;

168 
”r¡r
[128];

169 
fd
;

170 
æags
;

171 *
obuf
;

172 
»disR—d”
 *
»ad”
;

173 } 
	t»disCÚ‹xt
;

175 
»disCÚ‹xt
 *
»disCÚÃù
(cÚ¡ *

, 
pÜt
);

176 
»disCÚ‹xt
 *
»disCÚÃùW™hTimeout
(cÚ¡ *

, 
pÜt
, cÚ¡ 
timev®
 
tv
);

177 
»disCÚ‹xt
 *
»disCÚÃùNÚBlock
(cÚ¡ *

, 
pÜt
);

178 
»disCÚ‹xt
 *
»disCÚÃùBšdNÚBlock
(cÚ¡ *

, 
pÜt
, cÚ¡ *
sourû_addr
);

179 
»disCÚ‹xt
 *
»disCÚÃùUnix
(cÚ¡ *
·th
);

180 
»disCÚ‹xt
 *
»disCÚÃùUnixW™hTimeout
(cÚ¡ *
·th
, cÚ¡ 
timev®
 
tv
);

181 
»disCÚ‹xt
 *
»disCÚÃùUnixNÚBlock
(cÚ¡ *
·th
);

182 
»disCÚ‹xt
 *
»disCÚÃùFd
(
fd
);

183 
»disS‘Timeout
(
»disCÚ‹xt
 *
c
, cÚ¡ 
timev®
 
tv
);

184 
»disEÇbËK“pAlive
(
»disCÚ‹xt
 *
c
);

185 
»disF»e
(
»disCÚ‹xt
 *
c
);

186 
»disF»eK“pFd
(
»disCÚ‹xt
 *
c
);

187 
»disBufãrR—d
(
»disCÚ‹xt
 *
c
);

188 
»disBufãrWr™e
(
»disCÚ‹xt
 *
c
, *
dÚe
);

194 
»disG‘R•ly
(
»disCÚ‹xt
 *
c
, **
»¶y
);

195 
»disG‘R•lyFromR—d”
(
»disCÚ‹xt
 *
c
, **
»¶y
);

199 
»disAµ’dFÜm©‹dCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
cmd
, 
size_t
 
Ën
);

203 
»disvAµ’dCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
);

204 
»disAµ’dCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
fÜm©
, ...);

205 
»disAµ’dCommªdArgv
(
»disCÚ‹xt
 *
c
, 
¬gc
, cÚ¡ **
¬gv
, cÚ¡ 
size_t
 *
¬gvËn
);

212 *
»disvCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
);

213 *
»disCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
fÜm©
, ...);

214 *
»disCommªdArgv
(
»disCÚ‹xt
 *
c
, 
¬gc
, cÚ¡ **
¬gv
, cÚ¡ 
size_t
 *
¬gvËn
);

216 #ifdeà
__ılu¥lus


	@deps/hiredis/net.c

33 
	~"fmaüos.h
"

34 
	~<sys/ty³s.h
>

35 
	~<sys/sock‘.h
>

36 
	~<sys/£Ëù.h
>

37 
	~<sys/un.h
>

38 
	~<Ãtš‘/š.h
>

39 
	~<Ãtš‘/tı.h
>

40 
	~<¬·/š‘.h
>

41 
	~<uni¡d.h
>

42 
	~<fú.h
>

43 
	~<¡ršg.h
>

44 
	~<Ãtdb.h
>

45 
	~<”ºo.h
>

46 
	~<¡d¬g.h
>

47 
	~<¡dio.h
>

48 
	~<pŞl.h
>

49 
	~<lim™s.h
>

51 
	~"Ãt.h
"

52 
	~"sds.h
"

55 
__»disS‘E¼Ü
(
»disCÚ‹xt
 *
c
, 
ty³
, cÚ¡ *
¡r
);

57 
	$»disCÚ‹xtClo£Fd
(
»disCÚ‹xt
 *
c
) {

58 ià(
c
 && c->
fd
 >= 0) {

59 
	`şo£
(
c
->
fd
);

60 
c
->
fd
 = -1;

62 
	}
}

64 
	$__»disS‘E¼ÜFromE¼no
(
»disCÚ‹xt
 *
c
, 
ty³
, cÚ¡ *
´efix
) {

65 
buf
[128] = { 0 };

66 
size_t
 
Ën
 = 0;

68 ià(
´efix
 !ğ
NULL
)

69 
Ën
 = 
	`¢´štf
(
buf
,(buf),"%s: ",
´efix
);

70 
	`¡»¼Ü_r
(
”ºo
,
buf
+
Ën
,(buf)-len);

71 
	`__»disS‘E¼Ü
(
c
,
ty³
,
buf
);

72 
	}
}

74 
	$»disS‘Reu£Addr
(
»disCÚ‹xt
 *
c
) {

75 
Ú
 = 1;

76 ià(
	`£tsockİt
(
c
->
fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
Ú
, (on)) == -1) {

77 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,
NULL
);

78 
	`»disCÚ‹xtClo£Fd
(
c
);

79  
REDIS_ERR
;

81  
REDIS_OK
;

82 
	}
}

84 
	$»disC»©eSock‘
(
»disCÚ‹xt
 *
c
, 
ty³
) {

85 
s
;

86 ià((
s
 = 
	`sock‘
(
ty³
, 
SOCK_STREAM
, 0)) == -1) {

87 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,
NULL
);

88  
REDIS_ERR
;

90 
c
->
fd
 = 
s
;

91 ià(
ty³
 =ğ
AF_INET
) {

92 ià(
	`»disS‘Reu£Addr
(
c
è=ğ
REDIS_ERR
) {

93  
REDIS_ERR
;

96  
REDIS_OK
;

97 
	}
}

99 
	$»disS‘Blockšg
(
»disCÚ‹xt
 *
c
, 
blockšg
) {

100 
æags
;

105 ià((
æags
 = 
	`fú
(
c
->
fd
, 
F_GETFL
)) == -1) {

106 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,"fcntl(F_GETFL)");

107 
	`»disCÚ‹xtClo£Fd
(
c
);

108  
REDIS_ERR
;

111 ià(
blockšg
)

112 
æags
 &ğ~
O_NONBLOCK
;

114 
æags
 |ğ
O_NONBLOCK
;

116 ià(
	`fú
(
c
->
fd
, 
F_SETFL
, 
æags
) == -1) {

117 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,"fcntl(F_SETFL)");

118 
	`»disCÚ‹xtClo£Fd
(
c
);

119  
REDIS_ERR
;

121  
REDIS_OK
;

122 
	}
}

124 
	$»disK“pAlive
(
»disCÚ‹xt
 *
c
, 
š‹rv®
) {

125 
v®
 = 1;

126 
fd
 = 
c
->fd;

128 ià(
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_KEEPALIVE
, &
v®
, (val)) == -1){

129 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OTHER
,
	`¡»¼Ü
(
”ºo
));

130  
REDIS_ERR
;

133 
v®
 = 
š‹rv®
;

135 #ifdeà
_OSX


136 ià(
	`£tsockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPALIVE
, &
v®
, (val)) < 0) {

137 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OTHER
,
	`¡»¼Ü
(
”ºo
));

138  
REDIS_ERR
;

141 #iâdeà
__sun


142 
v®
 = 
š‹rv®
;

143 ià(
	`£tsockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPIDLE
, &
v®
, (val)) < 0) {

144 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OTHER
,
	`¡»¼Ü
(
”ºo
));

145  
REDIS_ERR
;

148 
v®
 = 
š‹rv®
/3;

149 ià(
v®
 == 0) val = 1;

150 ià(
	`£tsockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPINTVL
, &
v®
, (val)) < 0) {

151 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OTHER
,
	`¡»¼Ü
(
”ºo
));

152  
REDIS_ERR
;

155 
v®
 = 3;

156 ià(
	`£tsockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPCNT
, &
v®
, (val)) < 0) {

157 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OTHER
,
	`¡»¼Ü
(
”ºo
));

158  
REDIS_ERR
;

163  
REDIS_OK
;

164 
	}
}

166 
	$»disS‘TıNoD–ay
(
»disCÚ‹xt
 *
c
) {

167 
yes
 = 1;

168 ià(
	`£tsockİt
(
c
->
fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
, &
yes
, (yes)) == -1) {

169 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,"setsockopt(TCP_NODELAY)");

170 
	`»disCÚ‹xtClo£Fd
(
c
);

171  
REDIS_ERR
;

173  
REDIS_OK
;

174 
	}
}

176 
	#__MAX_MSEC
 (((
LONG_MAX
è- 999è/ 1000)

	)

178 
	$»disCÚ‹xtWa™R—dy
(
»disCÚ‹xt
 *
c
, cÚ¡ 
timev®
 *
timeout
) {

179 
pŞlfd
 
wfd
[1];

180 
m£c
;

182 
m£c
 = -1;

183 
wfd
[0].
fd
 = 
c
->fd;

184 
wfd
[0].
ev’ts
 = 
POLLOUT
;

187 ià(
timeout
 !ğ
NULL
) {

188 ià(
timeout
->
tv_u£c
 > 1000000 ||imeout->
tv_£c
 > 
__MAX_MSEC
) {

189 
	`__»disS‘E¼ÜFromE¼no
(
c
, 
REDIS_ERR_IO
, 
NULL
);

190 
	`»disCÚ‹xtClo£Fd
(
c
);

191  
REDIS_ERR
;

194 
m£c
 = (
timeout
->
tv_£c
 * 1000è+ (Ñimeout->
tv_u£c
 + 999) / 1000);

196 ià(
m£c
 < 0 || m£ø> 
INT_MAX
) {

197 
m£c
 = 
INT_MAX
;

201 ià(
”ºo
 =ğ
EINPROGRESS
) {

202 
»s
;

204 ià((
»s
 = 
	`pŞl
(
wfd
, 1, 
m£c
)) == -1) {

205 
	`__»disS‘E¼ÜFromE¼no
(
c
, 
REDIS_ERR_IO
, "poll(2)");

206 
	`»disCÚ‹xtClo£Fd
(
c
);

207  
REDIS_ERR
;

208 } ià(
»s
 == 0) {

209 
”ºo
 = 
ETIMEDOUT
;

210 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,
NULL
);

211 
	`»disCÚ‹xtClo£Fd
(
c
);

212  
REDIS_ERR
;

215 ià(
	`»disCheckSock‘E¼Ü
(
c
è!ğ
REDIS_OK
)

216  
REDIS_ERR
;

218  
REDIS_OK
;

221 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,
NULL
);

222 
	`»disCÚ‹xtClo£Fd
(
c
);

223  
REDIS_ERR
;

224 
	}
}

226 
	$»disCheckSock‘E¼Ü
(
»disCÚ‹xt
 *
c
) {

227 
”r
 = 0;

228 
sockËn_t
 
”¾’
 = (
”r
);

230 ià(
	`g‘sockİt
(
c
->
fd
, 
SOL_SOCKET
, 
SO_ERROR
, &
”r
, &
”¾’
) == -1) {

231 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,"getsockopt(SO_ERROR)");

232  
REDIS_ERR
;

235 ià(
”r
) {

236 
”ºo
 = 
”r
;

237 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,
NULL
);

238  
REDIS_ERR
;

241  
REDIS_OK
;

242 
	}
}

244 
	$»disCÚ‹xtS‘Timeout
(
»disCÚ‹xt
 *
c
, cÚ¡ 
timev®
 
tv
) {

245 ià(
	`£tsockİt
(
c
->
fd
,
SOL_SOCKET
,
SO_RCVTIMEO
,&
tv
,(tv)) == -1) {

246 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,"setsockopt(SO_RCVTIMEO)");

247  
REDIS_ERR
;

249 ià(
	`£tsockİt
(
c
->
fd
,
SOL_SOCKET
,
SO_SNDTIMEO
,&
tv
,(tv)) == -1) {

250 
	`__»disS‘E¼ÜFromE¼no
(
c
,
REDIS_ERR_IO
,"setsockopt(SO_SNDTIMEO)");

251  
REDIS_ERR
;

253  
REDIS_OK
;

254 
	}
}

256 
	$_»disCÚ‹xtCÚÃùTı
(
»disCÚ‹xt
 *
c
, cÚ¡ *
addr
, 
pÜt
,

257 cÚ¡ 
timev®
 *
timeout
,

258 cÚ¡ *
sourû_addr
) {

259 
s
, 
rv
;

260 
_pÜt
[6];

261 
addršfo
 
hšts
, *
£rvšfo
, *
b£rvšfo
, *
p
, *
b
;

262 
blockšg
 = (
c
->
æags
 & 
REDIS_BLOCK
);

264 
	`¢´štf
(
_pÜt
, 6, "%d", 
pÜt
);

265 
	`mem£t
(&
hšts
,0,(hints));

266 
hšts
.
ai_çmy
 = 
AF_INET
;

267 
hšts
.
ai_sockty³
 = 
SOCK_STREAM
;

274 ià((
rv
 = 
	`g‘addršfo
(
addr
,
_pÜt
,&
hšts
,&
£rvšfo
)) != 0) {

275 
hšts
.
ai_çmy
 = 
AF_INET6
;

276 ià((
rv
 = 
	`g‘addršfo
(
addr
,
_pÜt
,&
hšts
,&
£rvšfo
)) != 0) {

277 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OTHER
,
	`gai_¡»¼Ü
(
rv
));

278  
REDIS_ERR
;

281 
p
 = 
£rvšfo
;… !ğ
NULL
;… =…->
ai_Ãxt
) {

282 ià((
s
 = 
	`sock‘
(
p
->
ai_çmy
,p->
ai_sockty³
,p->
ai_´ÙocŞ
)) == -1)

285 
c
->
fd
 = 
s
;

286 ià(
	`»disS‘Blockšg
(
c
,0è!ğ
REDIS_OK
)

287 
”rÜ
;

288 ià(
sourû_addr
) {

289 
bound
 = 0;

291 ià((
rv
 = 
	`g‘addršfo
(
sourû_addr
, 
NULL
, &
hšts
, &
b£rvšfo
)) != 0) {

292 
buf
[128];

293 
	`¢´štf
(
buf
,(buf),"Cª'ˆg‘‡ddr: %s",
	`gai_¡»¼Ü
(
rv
));

294 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OTHER
,
buf
);

295 
”rÜ
;

297 
b
 = 
b£rvšfo
; b !ğ
NULL
; b = b->
ai_Ãxt
) {

298 ià(
	`bšd
(
s
,
b
->
ai_addr
,b->
ai_add¾’
) != -1) {

299 
bound
 = 1;

303 
	`ä“addršfo
(
b£rvšfo
);

304 ià(!
bound
) {

305 
buf
[128];

306 
	`¢´štf
(
buf
,(buf),"Cª'ˆbšd sock‘: %s",
	`¡»¼Ü
(
”ºo
));

307 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OTHER
,
buf
);

308 
”rÜ
;

311 ià(
	`cÚÃù
(
s
,
p
->
ai_addr
,p->
ai_add¾’
) == -1) {

312 ià(
”ºo
 =ğ
EHOSTUNREACH
) {

313 
	`»disCÚ‹xtClo£Fd
(
c
);

315 } ià(
”ºo
 =ğ
EINPROGRESS
 && !
blockšg
) {

318 ià(
	`»disCÚ‹xtWa™R—dy
(
c
,
timeout
è!ğ
REDIS_OK
)

319 
”rÜ
;

322 ià(
blockšg
 && 
	`»disS‘Blockšg
(
c
,1è!ğ
REDIS_OK
)

323 
”rÜ
;

324 ià(
	`»disS‘TıNoD–ay
(
c
è!ğ
REDIS_OK
)

325 
”rÜ
;

327 
c
->
æags
 |ğ
REDIS_CONNECTED
;

328 
rv
 = 
REDIS_OK
;

329 
’d
;

331 ià(
p
 =ğ
NULL
) {

332 
buf
[128];

333 
	`¢´štf
(
buf
,(buf),"Cª'ˆü—‹ sock‘: %s",
	`¡»¼Ü
(
”ºo
));

334 
	`__»disS‘E¼Ü
(
c
,
REDIS_ERR_OTHER
,
buf
);

335 
”rÜ
;

338 
”rÜ
:

339 
rv
 = 
REDIS_ERR
;

340 
’d
:

341 
	`ä“addršfo
(
£rvšfo
);

342  
rv
;

343 
	}
}

345 
	$»disCÚ‹xtCÚÃùTı
(
»disCÚ‹xt
 *
c
, cÚ¡ *
addr
, 
pÜt
,

346 cÚ¡ 
timev®
 *
timeout
) {

347  
	`_»disCÚ‹xtCÚÃùTı
(
c
, 
addr
, 
pÜt
, 
timeout
, 
NULL
);

348 
	}
}

350 
	$»disCÚ‹xtCÚÃùBšdTı
(
»disCÚ‹xt
 *
c
, cÚ¡ *
addr
, 
pÜt
,

351 cÚ¡ 
timev®
 *
timeout
,

352 cÚ¡ *
sourû_addr
) {

353  
	`_»disCÚ‹xtCÚÃùTı
(
c
, 
addr
, 
pÜt
, 
timeout
, 
sourû_addr
);

354 
	}
}

356 
	$»disCÚ‹xtCÚÃùUnix
(
»disCÚ‹xt
 *
c
, cÚ¡ *
·th
, cÚ¡ 
timev®
 *
timeout
) {

357 
blockšg
 = (
c
->
æags
 & 
REDIS_BLOCK
);

358 
sockaddr_un
 
§
;

360 ià(
	`»disC»©eSock‘
(
c
,
AF_LOCAL
) < 0)

361  
REDIS_ERR
;

362 ià(
	`»disS‘Blockšg
(
c
,0è!ğ
REDIS_OK
)

363  
REDIS_ERR
;

365 
§
.
sun_çmy
 = 
AF_LOCAL
;

366 
	`¡ºıy
(
§
.
sun_·th
,
·th
,(sa.sun_path)-1);

367 ià(
	`cÚÃù
(
c
->
fd
, (
sockaddr
*)&
§
, (sa)) == -1) {

368 ià(
”ºo
 =ğ
EINPROGRESS
 && !
blockšg
) {

371 ià(
	`»disCÚ‹xtWa™R—dy
(
c
,
timeout
è!ğ
REDIS_OK
)

372  
REDIS_ERR
;

377 ià(
blockšg
 && 
	`»disS‘Blockšg
(
c
,1è!ğ
REDIS_OK
)

378  
REDIS_ERR
;

380 
c
->
æags
 |ğ
REDIS_CONNECTED
;

381  
REDIS_OK
;

382 
	}
}

	@deps/hiredis/net.h

33 #iâdeà
__NET_H


34 
	#__NET_H


	)

36 
	~"hœedis.h
"

38 #ià
defšed
(
__sun
è|| defšed(
_AIX
)

39 
	#AF_LOCAL
 
AF_UNIX


	)

42 
»disCheckSock‘E¼Ü
(
»disCÚ‹xt
 *
c
);

43 
»disCÚ‹xtS‘Timeout
(
»disCÚ‹xt
 *
c
, cÚ¡ 
timev®
 
tv
);

44 
»disCÚ‹xtCÚÃùTı
(
»disCÚ‹xt
 *
c
, cÚ¡ *
addr
, 
pÜt
, cÚ¡ 
timev®
 *
timeout
);

45 
»disCÚ‹xtCÚÃùBšdTı
(
»disCÚ‹xt
 *
c
, cÚ¡ *
addr
, 
pÜt
,

46 cÚ¡ 
timev®
 *
timeout
,

47 cÚ¡ *
sourû_addr
);

48 
»disCÚ‹xtCÚÃùUnix
(
»disCÚ‹xt
 *
c
, cÚ¡ *
·th
, cÚ¡ 
timev®
 *
timeout
);

49 
»disK“pAlive
(
»disCÚ‹xt
 *
c
, 
š‹rv®
);

	@deps/hiredis/sds.c

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ršg.h
>

36 
	~<ùy³.h
>

37 
	~<as£¹.h
>

38 
	~"sds.h
"

39 
	~"sd§Îoc.h
"

41 
šlše
 
	$sdsHdrSize
(
ty³
) {

42 
ty³
&
SDS_TYPE_MASK
) {

43 
SDS_TYPE_5
:

44  (
sdshdr5
);

45 
SDS_TYPE_8
:

46  (
sdshdr8
);

47 
SDS_TYPE_16
:

48  (
sdshdr16
);

49 
SDS_TYPE_32
:

50  (
sdshdr32
);

51 
SDS_TYPE_64
:

52  (
sdshdr64
);

55 
	}
}

57 
šlše
 
	$sdsReqTy³
(
size_t
 
¡ršg_size
) {

58 ià(
¡ršg_size
 < 32)

59  
SDS_TYPE_5
;

60 ià(
¡ršg_size
 < 0xff)

61  
SDS_TYPE_8
;

62 ià(
¡ršg_size
 < 0xffff)

63  
SDS_TYPE_16
;

64 ià(
¡ršg_size
 < 0xffffffff)

65  
SDS_TYPE_32
;

66  
SDS_TYPE_64
;

67 
	}
}

81 
sds
 
	$sd¢ewËn
(cÚ¡ *
š™
, 
size_t
 
š™Ën
) {

82 *
sh
;

83 
sds
 
s
;

84 
ty³
 = 
	`sdsReqTy³
(
š™Ën
);

87 ià(
ty³
 =ğ
SDS_TYPE_5
 && 
š™Ën
 =ğ0èty³ = 
SDS_TYPE_8
;

88 
hd¾’
 = 
	`sdsHdrSize
(
ty³
);

89 *
å
;

91 
sh
 = 
	`s_m®loc
(
hd¾’
+
š™Ën
+1);

92 ià(!
š™
)

93 
	`mem£t
(
sh
, 0, 
hd¾’
+
š™Ën
+1);

94 ià(
sh
 =ğ
NULL
)  NULL;

95 
s
 = (*)
sh
+
hd¾’
;

96 
å
 = ((*)
s
)-1;

97 
ty³
) {

98 
SDS_TYPE_5
: {

99 *
å
 = 
ty³
 | (
š™Ën
 << 
SDS_TYPE_BITS
);

102 
SDS_TYPE_8
: {

103 
	`SDS_HDR_VAR
(8,
s
);

104 
sh
->
Ën
 = 
š™Ën
;

105 
sh
->
®loc
 = 
š™Ën
;

106 *
å
 = 
ty³
;

109 
SDS_TYPE_16
: {

110 
	`SDS_HDR_VAR
(16,
s
);

111 
sh
->
Ën
 = 
š™Ën
;

112 
sh
->
®loc
 = 
š™Ën
;

113 *
å
 = 
ty³
;

116 
SDS_TYPE_32
: {

117 
	`SDS_HDR_VAR
(32,
s
);

118 
sh
->
Ën
 = 
š™Ën
;

119 
sh
->
®loc
 = 
š™Ën
;

120 *
å
 = 
ty³
;

123 
SDS_TYPE_64
: {

124 
	`SDS_HDR_VAR
(64,
s
);

125 
sh
->
Ën
 = 
š™Ën
;

126 
sh
->
®loc
 = 
š™Ën
;

127 *
å
 = 
ty³
;

131 ià(
š™Ën
 && 
š™
)

132 
	`memıy
(
s
, 
š™
, 
š™Ën
);

133 
s
[
š™Ën
] = '\0';

134  
s
;

135 
	}
}

139 
sds
 
	$sd£m±y
() {

140  
	`sd¢ewËn
("",0);

141 
	}
}

144 
sds
 
	$sd¢ew
(cÚ¡ *
š™
) {

145 
size_t
 
š™Ën
 = (
š™
 =ğ
NULL
è? 0 : 
	`¡¾’
(init);

146  
	`sd¢ewËn
(
š™
, 
š™Ën
);

147 
	}
}

150 
sds
 
	$sdsdup
(cÚ¡ 
sds
 
s
) {

151  
	`sd¢ewËn
(
s
, 
	`sd¦’
(s));

152 
	}
}

155 
	$sdsä“
(
sds
 
s
) {

156 ià(
s
 =ğ
NULL
) ;

157 
	`s_ä“
((*)
s
-
	`sdsHdrSize
(s[-1]));

158 
	}
}

174 
	$sdsupd©–’
(
sds
 
s
) {

175 
»®Ën
 = 
	`¡¾’
(
s
);

176 
	`sds£’
(
s
, 
»®Ën
);

177 
	}
}

183 
	$sdsş—r
(
sds
 
s
) {

184 
	`sds£’
(
s
, 0);

185 
s
[0] = '\0';

186 
	}
}

194 
sds
 
	$sdsMakeRoomFÜ
(
sds
 
s
, 
size_t
 
addËn
) {

195 *
sh
, *
Ãwsh
;

196 
size_t
 
ava
 = 
	`sd§va
(
s
);

197 
size_t
 
Ën
, 
ÃwËn
;

198 
ty³
, 
Şdty³
 = 
s
[-1] & 
SDS_TYPE_MASK
;

199 
hd¾’
;

202 ià(
ava
 >ğ
addËn
è 
s
;

204 
Ën
 = 
	`sd¦’
(
s
);

205 
sh
 = (*)
s
-
	`sdsHdrSize
(
Şdty³
);

206 
ÃwËn
 = (
Ën
+
addËn
);

207 ià(
ÃwËn
 < 
SDS_MAX_PREALLOC
)

208 
ÃwËn
 *= 2;

210 
ÃwËn
 +ğ
SDS_MAX_PREALLOC
;

212 
ty³
 = 
	`sdsReqTy³
(
ÃwËn
);

217 ià(
ty³
 =ğ
SDS_TYPE_5
èty³ = 
SDS_TYPE_8
;

219 
hd¾’
 = 
	`sdsHdrSize
(
ty³
);

220 ià(
Şdty³
==
ty³
) {

221 
Ãwsh
 = 
	`s_»®loc
(
sh
, 
hd¾’
+
ÃwËn
+1);

222 ià(
Ãwsh
 =ğ
NULL
)  NULL;

223 
s
 = (*)
Ãwsh
+
hd¾’
;

227 
Ãwsh
 = 
	`s_m®loc
(
hd¾’
+
ÃwËn
+1);

228 ià(
Ãwsh
 =ğ
NULL
)  NULL;

229 
	`memıy
((*)
Ãwsh
+
hd¾’
, 
s
, 
Ën
+1);

230 
	`s_ä“
(
sh
);

231 
s
 = (*)
Ãwsh
+
hd¾’
;

232 
s
[-1] = 
ty³
;

233 
	`sds£’
(
s
, 
Ën
);

235 
	`sds£Îoc
(
s
, 
ÃwËn
);

236  
s
;

237 
	}
}

245 
sds
 
	$sdsRemoveF»eS·û
(
sds
 
s
) {

246 *
sh
, *
Ãwsh
;

247 
ty³
, 
Şdty³
 = 
s
[-1] & 
SDS_TYPE_MASK
;

248 
hd¾’
;

249 
size_t
 
Ën
 = 
	`sd¦’
(
s
);

250 
sh
 = (*)
s
-
	`sdsHdrSize
(
Şdty³
);

252 
ty³
 = 
	`sdsReqTy³
(
Ën
);

253 
hd¾’
 = 
	`sdsHdrSize
(
ty³
);

254 ià(
Şdty³
==
ty³
) {

255 
Ãwsh
 = 
	`s_»®loc
(
sh
, 
hd¾’
+
Ën
+1);

256 ià(
Ãwsh
 =ğ
NULL
)  NULL;

257 
s
 = (*)
Ãwsh
+
hd¾’
;

259 
Ãwsh
 = 
	`s_m®loc
(
hd¾’
+
Ën
+1);

260 ià(
Ãwsh
 =ğ
NULL
)  NULL;

261 
	`memıy
((*)
Ãwsh
+
hd¾’
, 
s
, 
Ën
+1);

262 
	`s_ä“
(
sh
);

263 
s
 = (*)
Ãwsh
+
hd¾’
;

264 
s
[-1] = 
ty³
;

265 
	`sds£’
(
s
, 
Ën
);

267 
	`sds£Îoc
(
s
, 
Ën
);

268  
s
;

269 
	}
}

278 
size_t
 
	$sdsAÎocSize
(
sds
 
s
) {

279 
size_t
 
®loc
 = 
	`sd§Îoc
(
s
);

280  
	`sdsHdrSize
(
s
[-1])+
®loc
+1;

281 
	}
}

285 *
	$sdsAÎocPŒ
(
sds
 
s
) {

286  (*è(
s
-
	`sdsHdrSize
(s[-1]));

287 
	}
}

312 
	$sdsInüL’
(
sds
 
s
, 
šü
) {

313 
æags
 = 
s
[-1];

314 
size_t
 
Ën
;

315 
æags
&
SDS_TYPE_MASK
) {

316 
SDS_TYPE_5
: {

317 *
å
 = ((*)
s
)-1;

318 
ŞdËn
 = 
	`SDS_TYPE_5_LEN
(
æags
);

319 
	`as£¹
((
šü
 > 0 && 
ŞdËn
+incr < 32) || (incr < 0 && oldlen >= ()(-incr)));

320 *
å
 = 
SDS_TYPE_5
 | ((
ŞdËn
+
šü
è<< 
SDS_TYPE_BITS
);

321 
Ën
 = 
ŞdËn
+
šü
;

324 
SDS_TYPE_8
: {

325 
	`SDS_HDR_VAR
(8,
s
);

326 
	`as£¹
((
šü
 >ğ0 && 
sh
->
®loc
-sh->
Ën
 >= incr) || (incr < 0 && sh->len >= ()(-incr)));

327 
Ën
 = (
sh
->ËÀ+ğ
šü
);

330 
SDS_TYPE_16
: {

331 
	`SDS_HDR_VAR
(16,
s
);

332 
	`as£¹
((
šü
 >ğ0 && 
sh
->
®loc
-sh->
Ën
 >= incr) || (incr < 0 && sh->len >= ()(-incr)));

333 
Ën
 = (
sh
->ËÀ+ğ
šü
);

336 
SDS_TYPE_32
: {

337 
	`SDS_HDR_VAR
(32,
s
);

338 
	`as£¹
((
šü
 >ğ0 && 
sh
->
®loc
-sh->
Ën
 >= ()incr) || (incr < 0 && sh->len >= ()(-incr)));

339 
Ën
 = (
sh
->ËÀ+ğ
šü
);

342 
SDS_TYPE_64
: {

343 
	`SDS_HDR_VAR
(64,
s
);

344 
	`as£¹
((
šü
 >ğ0 && 
sh
->
®loc
-sh->
Ën
 >ğ(
ušt64_t
)incr) || (incr < 0 && sh->len >= (uint64_t)(-incr)));

345 
Ën
 = (
sh
->ËÀ+ğ
šü
);

348 : 
Ën
 = 0;

350 
s
[
Ën
] = '\0';

351 
	}
}

358 
sds
 
	$sdsgrowz”o
(
sds
 
s
, 
size_t
 
Ën
) {

359 
size_t
 
cu¾’
 = 
	`sd¦’
(
s
);

361 ià(
Ën
 <ğ
cu¾’
è 
s
;

362 
s
 = 
	`sdsMakeRoomFÜ
(s,
Ën
-
cu¾’
);

363 ià(
s
 =ğ
NULL
)  NULL;

366 
	`mem£t
(
s
+
cu¾’
,0,(
Ën
-curlen+1));

367 
	`sds£’
(
s
, 
Ën
);

368  
s
;

369 
	}
}

376 
sds
 
	$sdsÿ’
(
sds
 
s
, cÚ¡ *
t
, 
size_t
 
Ën
) {

377 
size_t
 
cu¾’
 = 
	`sd¦’
(
s
);

379 
s
 = 
	`sdsMakeRoomFÜ
(s,
Ën
);

380 ià(
s
 =ğ
NULL
)  NULL;

381 
	`memıy
(
s
+
cu¾’
, 
t
, 
Ën
);

382 
	`sds£’
(
s
, 
cu¾’
+
Ën
);

383 
s
[
cu¾’
+
Ën
] = '\0';

384  
s
;

385 
	}
}

391 
sds
 
	$sdsÿt
(
sds
 
s
, cÚ¡ *
t
) {

392  
	`sdsÿ’
(
s
, 
t
, 
	`¡¾’
(t));

393 
	}
}

399 
sds
 
	$sdsÿtsds
(
sds
 
s
, cÚ¡ sd 
t
) {

400  
	`sdsÿ’
(
s
, 
t
, 
	`sd¦’
(t));

401 
	}
}

405 
sds
 
	$sdsıyËn
(
sds
 
s
, cÚ¡ *
t
, 
size_t
 
Ën
) {

406 ià(
	`sd§Îoc
(
s
è< 
Ën
) {

407 
s
 = 
	`sdsMakeRoomFÜ
(s,
Ën
-
	`sd¦’
(s));

408 ià(
s
 =ğ
NULL
)  NULL;

410 
	`memıy
(
s
, 
t
, 
Ën
);

411 
s
[
Ën
] = '\0';

412 
	`sds£’
(
s
, 
Ën
);

413  
s
;

414 
	}
}

418 
sds
 
	$sdsıy
(
sds
 
s
, cÚ¡ *
t
) {

419  
	`sdsıyËn
(
s
, 
t
, 
	`¡¾’
(t));

420 
	}
}

428 
	#SDS_LLSTR_SIZE
 21

	)

429 
	$sd¦l2¡r
(*
s
, 
v®ue
) {

430 *
p
, 
aux
;

431 
v
;

432 
size_t
 
l
;

436 
v
 = (
v®ue
 < 0) ? -value : value;

437 
p
 = 
s
;

439 *
p
++ = '0'+(
v
%10);

440 
v
 /= 10;

441 } 
v
);

442 ià(
v®ue
 < 0è*
p
++ = '-';

445 
l
 = 
p
-
s
;

446 *
p
 = '\0';

449 
p
--;

450 
s
 < 
p
) {

451 
aux
 = *
s
;

452 *
s
 = *
p
;

453 *
p
 = 
aux
;

454 
s
++;

455 
p
--;

457  
l
;

458 
	}
}

461 
	$sdsuÎ2¡r
(*
s
, 
v
) {

462 *
p
, 
aux
;

463 
size_t
 
l
;

467 
p
 = 
s
;

469 *
p
++ = '0'+(
v
%10);

470 
v
 /= 10;

471 } 
v
);

474 
l
 = 
p
-
s
;

475 *
p
 = '\0';

478 
p
--;

479 
s
 < 
p
) {

480 
aux
 = *
s
;

481 *
s
 = *
p
;

482 *
p
 = 
aux
;

483 
s
++;

484 
p
--;

486  
l
;

487 
	}
}

493 
sds
 
	$sdsäomlÚglÚg
(
v®ue
) {

494 
buf
[
SDS_LLSTR_SIZE
];

495 
Ën
 = 
	`sd¦l2¡r
(
buf
,
v®ue
);

497  
	`sd¢ewËn
(
buf
,
Ën
);

498 
	}
}

501 
sds
 
	$sdsÿtv´štf
(
sds
 
s
, cÚ¡ *
fmt
, 
va_li¡
 
­
) {

502 
va_li¡
 
ıy
;

503 
¡©icbuf
[1024], *
buf
 = sticbuf, *
t
;

504 
size_t
 
buæ’
 = 
	`¡¾’
(
fmt
)*2;

508 ià(
buæ’
 > (
¡©icbuf
)) {

509 
buf
 = 
	`s_m®loc
(
buæ’
);

510 ià(
buf
 =ğ
NULL
)  NULL;

512 
buæ’
 = (
¡©icbuf
);

518 
buf
[
buæ’
-2] = '\0';

519 
	`va_cİy
(
ıy
,
­
);

520 
	`v¢´štf
(
buf
, 
buæ’
, 
fmt
, 
ıy
);

521 
	`va_’d
(
ıy
);

522 ià(
buf
[
buæ’
-2] != '\0') {

523 ià(
buf
 !ğ
¡©icbuf
è
	`s_ä“
(buf);

524 
buæ’
 *= 2;

525 
buf
 = 
	`s_m®loc
(
buæ’
);

526 ià(
buf
 =ğ
NULL
)  NULL;

533 
t
 = 
	`sdsÿt
(
s
, 
buf
);

534 ià(
buf
 !ğ
¡©icbuf
è
	`s_ä“
(buf);

535  
t
;

536 
	}
}

554 
sds
 
	$sdsÿrštf
(
sds
 
s
, cÚ¡ *
fmt
, ...) {

555 
va_li¡
 
­
;

556 *
t
;

557 
	`va_¡¬t
(
­
, 
fmt
);

558 
t
 = 
	`sdsÿtv´štf
(
s
,
fmt
,
­
);

559 
	`va_’d
(
­
);

560  
t
;

561 
	}
}

579 
sds
 
	$sdsÿtfmt
(
sds
 
s
, cÚ¡ *
fmt
, ...) {

580 
size_t
 
š™Ën
 = 
	`sd¦’
(
s
);

581 cÚ¡ *
f
 = 
fmt
;

582 
i
;

583 
va_li¡
 
­
;

585 
	`va_¡¬t
(
­
,
fmt
);

586 
f
 = 
fmt
;

587 
i
 = 
š™Ën
;

588 *
f
) {

589 
Ãxt
, *
¡r
;

590 
size_t
 
l
;

591 
num
;

592 
unum
;

595 ià(
	`sd§va
(
s
)==0) {

596 
s
 = 
	`sdsMakeRoomFÜ
(s,1);

599 *
f
) {

601 
Ãxt
 = *(
f
+1);

602 
f
++;

603 
Ãxt
) {

606 
¡r
 = 
	`va_¬g
(
­
,*);

607 
l
 = (
Ãxt
 =ğ's'è? 
	`¡¾’
(
¡r
è: 
	`sd¦’
(str);

608 ià(
	`sd§va
(
s
è< 
l
) {

609 
s
 = 
	`sdsMakeRoomFÜ
(s,
l
);

611 
	`memıy
(
s
+
i
,
¡r
,
l
);

612 
	`sdsšş’
(
s
,
l
);

613 
i
 +ğ
l
;

617 ià(
Ãxt
 == 'i')

618 
num
 = 
	`va_¬g
(
­
,);

620 
num
 = 
	`va_¬g
(
­
,);

622 
buf
[
SDS_LLSTR_SIZE
];

623 
l
 = 
	`sd¦l2¡r
(
buf
,
num
);

624 ià(
	`sd§va
(
s
è< 
l
) {

625 
s
 = 
	`sdsMakeRoomFÜ
(s,
l
);

627 
	`memıy
(
s
+
i
,
buf
,
l
);

628 
	`sdsšş’
(
s
,
l
);

629 
i
 +ğ
l
;

634 ià(
Ãxt
 == 'u')

635 
unum
 = 
	`va_¬g
(
­
,);

637 
unum
 = 
	`va_¬g
(
­
,);

639 
buf
[
SDS_LLSTR_SIZE
];

640 
l
 = 
	`sdsuÎ2¡r
(
buf
,
unum
);

641 ià(
	`sd§va
(
s
è< 
l
) {

642 
s
 = 
	`sdsMakeRoomFÜ
(s,
l
);

644 
	`memıy
(
s
+
i
,
buf
,
l
);

645 
	`sdsšş’
(
s
,
l
);

646 
i
 +ğ
l
;

650 
s
[
i
++] = 
Ãxt
;

651 
	`sdsšş’
(
s
,1);

656 
s
[
i
++] = *
f
;

657 
	`sdsšş’
(
s
,1);

660 
f
++;

662 
	`va_’d
(
­
);

665 
s
[
i
] = '\0';

666  
s
;

667 
	}
}

683 
sds
 
	$sd¡rim
(
sds
 
s
, cÚ¡ *
c£t
) {

684 *
¡¬t
, *
’d
, *
¥
, *
•
;

685 
size_t
 
Ën
;

687 
¥
 = 
¡¬t
 = 
s
;

688 
•
 = 
’d
 = 
s
+
	`sd¦’
(s)-1;

689 
¥
 <ğ
’d
 && 
	`¡rchr
(
c£t
, *sp)) sp++;

690 
•
 > 
¥
 && 
	`¡rchr
(
c£t
, *ep))ƒp--;

691 
Ën
 = (
¥
 > 
•
) ? 0 : ((ep-sp)+1);

692 ià(
s
 !ğ
¥
è
	`memmove
(s, sp, 
Ën
);

693 
s
[
Ën
] = '\0';

694 
	`sds£’
(
s
,
Ën
);

695  
s
;

696 
	}
}

714 
	$sd¤ªge
(
sds
 
s
, 
¡¬t
, 
’d
) {

715 
size_t
 
ÃwËn
, 
Ën
 = 
	`sd¦’
(
s
);

717 ià(
Ën
 == 0) ;

718 ià(
¡¬t
 < 0) {

719 
¡¬t
 = 
Ën
+start;

720 ià(
¡¬t
 < 0) start = 0;

722 ià(
’d
 < 0) {

723 
’d
 = 
Ën
+end;

724 ià(
’d
 < 0)ƒnd = 0;

726 
ÃwËn
 = (
¡¬t
 > 
’d
) ? 0 : (end-start)+1;

727 ià(
ÃwËn
 != 0) {

728 ià(
¡¬t
 >ğ(sigÃd)
Ën
) {

729 
ÃwËn
 = 0;

730 } ià(
’d
 >ğ(sigÃd)
Ën
) {

731 
’d
 = 
Ën
-1;

732 
ÃwËn
 = (
¡¬t
 > 
’d
) ? 0 : (end-start)+1;

735 
¡¬t
 = 0;

737 ià(
¡¬t
 && 
ÃwËn
è
	`memmove
(
s
, s+start,‚ewlen);

738 
s
[
ÃwËn
] = 0;

739 
	`sds£’
(
s
,
ÃwËn
);

740 
	}
}

743 
	$sd¡Şow”
(
sds
 
s
) {

744 
Ën
 = 
	`sd¦’
(
s
), 
j
;

746 
j
 = 0; j < 
Ën
; j++è
s
[j] = 
	`tŞow”
(s[j]);

747 
	}
}

750 
	$sd¡ouµ”
(
sds
 
s
) {

751 
Ën
 = 
	`sd¦’
(
s
), 
j
;

753 
j
 = 0; j < 
Ën
; j++è
s
[j] = 
	`touµ”
(s[j]);

754 
	}
}

767 
	$sdscmp
(cÚ¡ 
sds
 
s1
, cÚ¡ sd 
s2
) {

768 
size_t
 
l1
, 
l2
, 
mšËn
;

769 
cmp
;

771 
l1
 = 
	`sd¦’
(
s1
);

772 
l2
 = 
	`sd¦’
(
s2
);

773 
mšËn
 = (
l1
 < 
l2
) ?†1 :†2;

774 
cmp
 = 
	`memcmp
(
s1
,
s2
,
mšËn
);

775 ià(
cmp
 =ğ0è 
l1
-
l2
;

776  
cmp
;

777 
	}
}

795 
sds
 *
	$sds¥l™Ën
(cÚ¡ *
s
, 
Ën
, cÚ¡ *
£p
, 
£¶’
, *
couÁ
) {

796 
–em’ts
 = 0, 
¦Ùs
 = 5, 
¡¬t
 = 0, 
j
;

797 
sds
 *
tok’s
;

799 ià(
£¶’
 < 1 || 
Ën
 < 0è 
NULL
;

801 
tok’s
 = 
	`s_m®loc
((
sds
)*
¦Ùs
);

802 ià(
tok’s
 =ğ
NULL
)  NULL;

804 ià(
Ën
 == 0) {

805 *
couÁ
 = 0;

806  
tok’s
;

808 
j
 = 0; j < (
Ën
-(
£¶’
-1)); j++) {

810 ià(
¦Ùs
 < 
–em’ts
+2) {

811 
sds
 *
Ãwtok’s
;

813 
¦Ùs
 *= 2;

814 
Ãwtok’s
 = 
	`s_»®loc
(
tok’s
,(
sds
)*
¦Ùs
);

815 ià(
Ãwtok’s
 =ğ
NULL
è
ş—nup
;

816 
tok’s
 = 
Ãwtok’s
;

819 ià((
£¶’
 =ğ1 && *(
s
+
j
è=ğ
£p
[0]è|| (
	`memcmp
(s+j,sep,seplen) == 0)) {

820 
tok’s
[
–em’ts
] = 
	`sd¢ewËn
(
s
+
¡¬t
,
j
-start);

821 ià(
tok’s
[
–em’ts
] =ğ
NULL
è
ş—nup
;

822 
–em’ts
++;

823 
¡¬t
 = 
j
+
£¶’
;

824 
j
 = j+
£¶’
-1;

828 
tok’s
[
–em’ts
] = 
	`sd¢ewËn
(
s
+
¡¬t
,
Ën
-start);

829 ià(
tok’s
[
–em’ts
] =ğ
NULL
è
ş—nup
;

830 
–em’ts
++;

831 *
couÁ
 = 
–em’ts
;

832  
tok’s
;

834 
ş—nup
:

836 
i
;

837 
i
 = 0; i < 
–em’ts
; i++è
	`sdsä“
(
tok’s
[i]);

838 
	`s_ä“
(
tok’s
);

839 *
couÁ
 = 0;

840  
NULL
;

842 
	}
}

845 
	$sdsä“¥l™»s
(
sds
 *
tok’s
, 
couÁ
) {

846 ià(!
tok’s
) ;

847 
couÁ
--)

848 
	`sdsä“
(
tok’s
[
couÁ
]);

849 
	`s_ä“
(
tok’s
);

850 
	}
}

858 
sds
 
	$sdsÿŒ•r
(
sds
 
s
, cÚ¡ *
p
, 
size_t
 
Ën
) {

859 
s
 = 
	`sdsÿ’
(s,"\"",1);

860 
Ën
--) {

861 *
p
) {

864 
s
 = 
	`sdsÿrštf
(s,"\\%c",*
p
);

866 '\n': 
s
 = 
	`sdsÿ’
(s,"\\n",2); ;

867 '\r': 
s
 = 
	`sdsÿ’
(s,"\\r",2); ;

868 '\t': 
s
 = 
	`sdsÿ’
(s,"\\t",2); ;

869 '\a': 
s
 = 
	`sdsÿ’
(s,"\\a",2); ;

870 '\b': 
s
 = 
	`sdsÿ’
(s,"\\b",2); ;

872 ià(
	`i¥ršt
(*
p
))

873 
s
 = 
	`sdsÿrštf
(s,"%c",*
p
);

875 
s
 = 
	`sdsÿrštf
(s,"\\x%02x",()*
p
);

878 
p
++;

880  
	`sdsÿ’
(
s
,"\"",1);

881 
	}
}

885 
	$is_hex_dig™
(
c
) {

886  (
c
 >= '0' && c <= '9') || (c >= 'a' && c <= 'f') ||

887 (
c
 >= 'A' && c <= 'F');

888 
	}
}

892 
	$hex_dig™_to_št
(
c
) {

893 
c
) {

912 
	}
}

933 
sds
 *
	$sds¥l™¬gs
(cÚ¡ *
lše
, *
¬gc
) {

934 cÚ¡ *
p
 = 
lše
;

935 *
cu¼’t
 = 
NULL
;

936 **
veùÜ
 = 
NULL
;

938 *
¬gc
 = 0;

941 *
p
 && 
	`is¥aû
(*p))…++;

942 ià(*
p
) {

944 
šq
=0;

945 
šsq
=0;

946 
dÚe
=0;

948 ià(
cu¼’t
 =ğ
NULL
ècu¼’ˆğ
	`sd£m±y
();

949 !
dÚe
) {

950 ià(
šq
) {

951 ià(*
p
 == '\\' && *(p+1) == 'x' &&

952 
	`is_hex_dig™
(*(
p
+2)) &&

953 
	`is_hex_dig™
(*(
p
+3)))

955 
by‹
;

957 
by‹
 = (
	`hex_dig™_to_št
(*(
p
+2))*16)+

958 
	`hex_dig™_to_št
(*(
p
+3));

959 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,(*)&
by‹
,1);

960 
p
 += 3;

961 } ià(*
p
 == '\\' && *(p+1)) {

962 
c
;

964 
p
++;

965 *
p
) {

966 'n': 
c
 = '\n'; ;

967 'r': 
c
 = '\r'; ;

968 't': 
c
 = '\t'; ;

969 'b': 
c
 = '\b'; ;

970 'a': 
c
 = '\a'; ;

971 : 
c
 = *
p
; ;

973 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,&
c
,1);

974 } ià(*
p
 == '"') {

977 ià(*(
p
+1è&& !
	`is¥aû
(*Õ+1))è
”r
;

978 
dÚe
=1;

979 } ià(!*
p
) {

981 
”r
;

983 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,
p
,1);

985 } ià(
šsq
) {

986 ià(*
p
 == '\\' && *(p+1) == '\'') {

987 
p
++;

988 
cu¼’t
 = 
	`sdsÿ’
(current,"'",1);

989 } ià(*
p
 == '\'') {

992 ià(*(
p
+1è&& !
	`is¥aû
(*Õ+1))è
”r
;

993 
dÚe
=1;

994 } ià(!*
p
) {

996 
”r
;

998 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,
p
,1);

1001 *
p
) {

1007 
dÚe
=1;

1010 
šq
=1;

1013 
šsq
=1;

1016 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,
p
,1);

1020 ià(*
p
)…++;

1023 
veùÜ
 = 
	`s_»®loc
(veùÜ,((*
¬gc
)+1)*(*));

1024 
veùÜ
[*
¬gc
] = 
cu¼’t
;

1025 (*
¬gc
)++;

1026 
cu¼’t
 = 
NULL
;

1029 ià(
veùÜ
 =ğ
NULL
èveùÜ = 
	`s_m®loc
((*));

1030  
veùÜ
;

1034 
”r
:

1035 (*
¬gc
)--)

1036 
	`sdsä“
(
veùÜ
[*
¬gc
]);

1037 
	`s_ä“
(
veùÜ
);

1038 ià(
cu¼’t
è
	`sdsä“
(current);

1039 *
¬gc
 = 0;

1040  
NULL
;

1041 
	}
}

1052 
sds
 
	$sdsm­ch¬s
(
sds
 
s
, cÚ¡ *
äom
, cÚ¡ *
to
, 
size_t
 
£’
) {

1053 
size_t
 
j
, 
i
, 
l
 = 
	`sd¦’
(
s
);

1055 
j
 = 0; j < 
l
; j++) {

1056 
i
 = 0; i < 
£’
; i++) {

1057 ià(
s
[
j
] =ğ
äom
[
i
]) {

1058 
s
[
j
] = 
to
[
i
];

1063  
s
;

1064 
	}
}

1068 
sds
 
	$sdsjoš
(**
¬gv
, 
¬gc
, *
£p
) {

1069 
sds
 
još
 = 
	`sd£m±y
();

1070 
j
;

1072 
j
 = 0; j < 
¬gc
; j++) {

1073 
još
 = 
	`sdsÿt
(još, 
¬gv
[
j
]);

1074 ià(
j
 !ğ
¬gc
-1è
još
 = 
	`sdsÿt
(još,
£p
);

1076  
još
;

1077 
	}
}

1080 
sds
 
	$sdsjošsds
(
sds
 *
¬gv
, 
¬gc
, cÚ¡ *
£p
, 
size_t
 
£¶’
) {

1081 
sds
 
još
 = 
	`sd£m±y
();

1082 
j
;

1084 
j
 = 0; j < 
¬gc
; j++) {

1085 
još
 = 
	`sdsÿtsds
(još, 
¬gv
[
j
]);

1086 ià(
j
 !ğ
¬gc
-1è
još
 = 
	`sdsÿ’
(još,
£p
,
£¶’
);

1088  
još
;

1089 
	}
}

1096 *
	$sds_m®loc
(
size_t
 
size
è{  
	`s_m®loc
(size); 
	}
}

1097 *
	$sds_»®loc
(*
±r
, 
size_t
 
size
è{  
	`s_»®loc
ÕŒ,size); 
	}
}

1098 
	$sds_ä“
(*
±r
è{ 
	`s_ä“
ÕŒ); 
	}
}

1100 #ià
defšed
(
SDS_TEST_MAIN
)

1101 
	~<¡dio.h
>

1102 
	~"‹¡h–p.h
"

1103 
	~"lim™s.h
"

1105 
	#UNUSED
(
x
è()(x)

	)

1106 
	$sdsTe¡
() {

1108 
sds
 
x
 = 
	`sd¢ew
("foo"), 
y
;

1110 
	`‹¡_cÚd
("Create‡ string‡nd obtainhe†ength",

1111 
	`sd¦’
(
x
è=ğ3 && 
	`memcmp
(x,"foo\0",4) == 0)

1113 
	`sdsä“
(
x
);

1114 
x
 = 
	`sd¢ewËn
("foo",2);

1115 
	`‹¡_cÚd
("Create‡ string with specified†ength",

1116 
	`sd¦’
(
x
è=ğ2 && 
	`memcmp
(x,"fo\0",3) == 0)

1118 
x
 = 
	`sdsÿt
(x,"bar");

1119 
	`‹¡_cÚd
("Strings concatenation",

1120 
	`sd¦’
(
x
è=ğ5 && 
	`memcmp
(x,"fobar\0",6) == 0);

1122 
x
 = 
	`sdsıy
(x,"a");

1123 
	`‹¡_cÚd
("sdscpy()‡gainst‡n originally†onger string",

1124 
	`sd¦’
(
x
è=ğ1 && 
	`memcmp
(x,"a\0",2) == 0)

1126 
x
 = 
	`sdsıy
(x,"xyzxxxxxxxxxxyyyyyyyyyykkkkkkkkkk");

1127 
	`‹¡_cÚd
("sdscpy()‡gainst‡n originally shorter string",

1128 
	`sd¦’
(
x
) == 33 &&

1129 
	`memcmp
(
x
,"xyzxxxxxxxxxxyyyyyyyyyykkkkkkkkkk\0",33) == 0)

1131 
	`sdsä“
(
x
);

1132 
x
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"%d",123);

1133 
	`‹¡_cÚd
("sdscatprintf() seems working inhe base case",

1134 
	`sd¦’
(
x
è=ğ3 && 
	`memcmp
(x,"123\0",4) == 0)

1136 
	`sdsä“
(
x
);

1137 
x
 = 
	`sd¢ew
("--");

1138 
x
 = 
	`sdsÿtfmt
(x, "H–lØ% WÜld %I,%I--", "Hi!", 
LLONG_MIN
,
LLONG_MAX
);

1139 
	`‹¡_cÚd
("sdscatfmt() seems working inhe base case",

1140 
	`sd¦’
(
x
) == 60 &&

1141 
	`memcmp
(
x
,"--Hello Hi! World -9223372036854775808,"

1143 
	`´štf
("[%s]\n",
x
);

1145 
	`sdsä“
(
x
);

1146 
x
 = 
	`sd¢ew
("--");

1147 
x
 = 
	`sdsÿtfmt
(x, "%u,%U--", 
UINT_MAX
, 
ULLONG_MAX
);

1148 
	`‹¡_cÚd
("sdscatfmt() seems working with unsigned‚umbers",

1149 
	`sd¦’
(
x
) == 35 &&

1150 
	`memcmp
(
x
,"--4294967295,18446744073709551615--",35) == 0)

1152 
	`sdsä“
(
x
);

1153 
x
 = 
	`sd¢ew
(" x ");

1154 
	`sd¡rim
(
x
," x");

1155 
	`‹¡_cÚd
("sdstrim() works when‡ll chars match",

1156 
	`sd¦’
(
x
) == 0)

1158 
	`sdsä“
(
x
);

1159 
x
 = 
	`sd¢ew
(" x ");

1160 
	`sd¡rim
(
x
," ");

1161 
	`‹¡_cÚd
("sdstrim() works when‡ single char„emains",

1162 
	`sd¦’
(
x
) == 1 && x[0] == 'x')

1164 
	`sdsä“
(
x
);

1165 
x
 = 
	`sd¢ew
("xxciaoyyy");

1166 
	`sd¡rim
(
x
,"xy");

1167 
	`‹¡_cÚd
("sdstrim() correctlyrims characters",

1168 
	`sd¦’
(
x
è=ğ4 && 
	`memcmp
(x,"ciao\0",5) == 0)

1170 
y
 = 
	`sdsdup
(
x
);

1171 
	`sd¤ªge
(
y
,1,1);

1172 
	`‹¡_cÚd
("sdsrange(...,1,1)",

1173 
	`sd¦’
(
y
è=ğ1 && 
	`memcmp
(y,"i\0",2) == 0)

1175 
	`sdsä“
(
y
);

1176 
y
 = 
	`sdsdup
(
x
);

1177 
	`sd¤ªge
(
y
,1,-1);

1178 
	`‹¡_cÚd
("sdsrange(...,1,-1)",

1179 
	`sd¦’
(
y
è=ğ3 && 
	`memcmp
(y,"iao\0",4) == 0)

1181 
	`sdsä“
(
y
);

1182 
y
 = 
	`sdsdup
(
x
);

1183 
	`sd¤ªge
(
y
,-2,-1);

1184 
	`‹¡_cÚd
("sdsrange(...,-2,-1)",

1185 
	`sd¦’
(
y
è=ğ2 && 
	`memcmp
(y,"ao\0",3) == 0)

1187 
	`sdsä“
(
y
);

1188 
y
 = 
	`sdsdup
(
x
);

1189 
	`sd¤ªge
(
y
,2,1);

1190 
	`‹¡_cÚd
("sdsrange(...,2,1)",

1191 
	`sd¦’
(
y
è=ğ0 && 
	`memcmp
(y,"\0",1) == 0)

1193 
	`sdsä“
(
y
);

1194 
y
 = 
	`sdsdup
(
x
);

1195 
	`sd¤ªge
(
y
,1,100);

1196 
	`‹¡_cÚd
("sdsrange(...,1,100)",

1197 
	`sd¦’
(
y
è=ğ3 && 
	`memcmp
(y,"iao\0",4) == 0)

1199 
	`sdsä“
(
y
);

1200 
y
 = 
	`sdsdup
(
x
);

1201 
	`sd¤ªge
(
y
,100,100);

1202 
	`‹¡_cÚd
("sdsrange(...,100,100)",

1203 
	`sd¦’
(
y
è=ğ0 && 
	`memcmp
(y,"\0",1) == 0)

1205 
	`sdsä“
(
y
);

1206 
	`sdsä“
(
x
);

1207 
x
 = 
	`sd¢ew
("foo");

1208 
y
 = 
	`sd¢ew
("foa");

1209 
	`‹¡_cÚd
("sdscmp(foo,fß)", 
	`sdscmp
(
x
,
y
) > 0)

1211 
	`sdsä“
(
y
);

1212 
	`sdsä“
(
x
);

1213 
x
 = 
	`sd¢ew
("bar");

1214 
y
 = 
	`sd¢ew
("bar");

1215 
	`‹¡_cÚd
("sdscmp(b¬,b¬)", 
	`sdscmp
(
x
,
y
) == 0)

1217 
	`sdsä“
(
y
);

1218 
	`sdsä“
(
x
);

1219 
x
 = 
	`sd¢ew
("aar");

1220 
y
 = 
	`sd¢ew
("bar");

1221 
	`‹¡_cÚd
("sdscmp(b¬,b¬)", 
	`sdscmp
(
x
,
y
) < 0)

1223 
	`sdsä“
(
y
);

1224 
	`sdsä“
(
x
);

1225 
x
 = 
	`sd¢ewËn
("\a\n\0foo\r",7);

1226 
y
 = 
	`sdsÿŒ•r
(
	`sd£m±y
(),
x
,
	`sd¦’
(x));

1227 
	`‹¡_cÚd
("sdscatrepr(...data...)",

1228 
	`memcmp
(
y
,"\"\\a\\n\\x00foo\\r\"",15) == 0)

1231 
Şdä“
;

1232 *
p
;

1233 
¡•
 = 10, 
j
, 
i
;

1235 
	`sdsä“
(
x
);

1236 
	`sdsä“
(
y
);

1237 
x
 = 
	`sd¢ew
("0");

1238 
	`‹¡_cÚd
("sd¢ew(èä“/ËÀbufãrs", 
	`sd¦’
(
x
è=ğ1 && 
	`sd§va
(x) == 0);

1242 
i
 = 0; i < 10; i++) {

1243 
ŞdËn
 = 
	`sd¦’
(
x
);

1244 
x
 = 
	`sdsMakeRoomFÜ
(x,
¡•
);

1245 
ty³
 = 
x
[-1]&
SDS_TYPE_MASK
;

1247 
	`‹¡_cÚd
("sdsMakeRoomFÜ(èËn", 
	`sd¦’
(
x
è=ğ
ŞdËn
);

1248 ià(
ty³
 !ğ
SDS_TYPE_5
) {

1249 
	`‹¡_cÚd
("sdsMakeRoomFÜ(èä“", 
	`sd§va
(
x
è>ğ
¡•
);

1250 
Şdä“
 = 
	`sd§va
(
x
);

1252 
p
 = 
x
+
ŞdËn
;

1253 
j
 = 0; j < 
¡•
; j++) {

1254 
p
[
j
] = 'A'+j;

1256 
	`sdsInüL’
(
x
,
¡•
);

1258 
	`‹¡_cÚd
("sdsMakeRoomFor() content",

1259 
	`memcmp
("0ABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJ",
x
,101) == 0);

1260 
	`‹¡_cÚd
("sdsMakeRoomFÜ(èfš®†’gth",
	`sd¦’
(
x
)==101);

1262 
	`sdsä“
(
x
);

1265 
	`‹¡_»pÜt
()

1267 
	}
}

1270 #ifdeà
SDS_TEST_MAIN


1271 
	$maš
() {

1272  
	`sdsTe¡
();

1273 
	}
}

	@deps/hiredis/sds.h

33 #iâdeà
__SDS_H


34 
	#__SDS_H


	)

36 
	#SDS_MAX_PREALLOC
 (1024*1024)

	)

38 
	~<sys/ty³s.h
>

39 
	~<¡d¬g.h
>

40 
	~<¡dšt.h
>

42 *
	tsds
;

46 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr5
 {

47 
	gæags
;

48 
	gbuf
[];

50 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr8
 {

51 
ušt8_t
 
	gËn
;

52 
ušt8_t
 
	g®loc
;

53 
	gæags
;

54 
	gbuf
[];

56 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr16
 {

57 
ušt16_t
 
	gËn
;

58 
ušt16_t
 
	g®loc
;

59 
	gæags
;

60 
	gbuf
[];

62 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr32
 {

63 
ušt32_t
 
	gËn
;

64 
ušt32_t
 
	g®loc
;

65 
	gæags
;

66 
	gbuf
[];

68 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr64
 {

69 
ušt64_t
 
	gËn
;

70 
ušt64_t
 
	g®loc
;

71 
	gæags
;

72 
	gbuf
[];

75 
	#SDS_TYPE_5
 0

	)

76 
	#SDS_TYPE_8
 1

	)

77 
	#SDS_TYPE_16
 2

	)

78 
	#SDS_TYPE_32
 3

	)

79 
	#SDS_TYPE_64
 4

	)

80 
	#SDS_TYPE_MASK
 7

	)

81 
	#SDS_TYPE_BITS
 3

	)

82 
	#SDS_HDR_VAR
(
T
,
s
è
sdshdr
##T *
sh
 = (*)((s)-((sdshdr##T)));

	)

83 
	#SDS_HDR
(
T
,
s
è((
sdshdr
##T *)((s)-((sdshdr##T))))

	)

84 
	#SDS_TYPE_5_LEN
(
f
è((f)>>
SDS_TYPE_BITS
)

	)

86 
šlše
 
size_t
 
	$sd¦’
(cÚ¡ 
sds
 
s
) {

87 
æags
 = 
s
[-1];

88 
æags
&
SDS_TYPE_MASK
) {

89 
SDS_TYPE_5
:

90  
	`SDS_TYPE_5_LEN
(
æags
);

91 
SDS_TYPE_8
:

92  
	`SDS_HDR
(8,
s
)->
Ën
;

93 
SDS_TYPE_16
:

94  
	`SDS_HDR
(16,
s
)->
Ën
;

95 
SDS_TYPE_32
:

96  
	`SDS_HDR
(32,
s
)->
Ën
;

97 
SDS_TYPE_64
:

98  
	`SDS_HDR
(64,
s
)->
Ën
;

101 
	}
}

103 
šlše
 
size_t
 
	$sd§va
(cÚ¡ 
sds
 
s
) {

104 
æags
 = 
s
[-1];

105 
æags
&
SDS_TYPE_MASK
) {

106 
SDS_TYPE_5
: {

109 
SDS_TYPE_8
: {

110 
	`SDS_HDR_VAR
(8,
s
);

111  
sh
->
®loc
 - sh->
Ën
;

113 
SDS_TYPE_16
: {

114 
	`SDS_HDR_VAR
(16,
s
);

115  
sh
->
®loc
 - sh->
Ën
;

117 
SDS_TYPE_32
: {

118 
	`SDS_HDR_VAR
(32,
s
);

119  
sh
->
®loc
 - sh->
Ën
;

121 
SDS_TYPE_64
: {

122 
	`SDS_HDR_VAR
(64,
s
);

123  
sh
->
®loc
 - sh->
Ën
;

127 
	}
}

129 
šlše
 
	$sds£’
(
sds
 
s
, 
size_t
 
ÃwËn
) {

130 
æags
 = 
s
[-1];

131 
æags
&
SDS_TYPE_MASK
) {

132 
SDS_TYPE_5
:

134 *
å
 = ((*)
s
)-1;

135 *
å
 = 
SDS_TYPE_5
 | (
ÃwËn
 << 
SDS_TYPE_BITS
);

138 
SDS_TYPE_8
:

139 
	`SDS_HDR
(8,
s
)->
Ën
 = 
ÃwËn
;

141 
SDS_TYPE_16
:

142 
	`SDS_HDR
(16,
s
)->
Ën
 = 
ÃwËn
;

144 
SDS_TYPE_32
:

145 
	`SDS_HDR
(32,
s
)->
Ën
 = 
ÃwËn
;

147 
SDS_TYPE_64
:

148 
	`SDS_HDR
(64,
s
)->
Ën
 = 
ÃwËn
;

151 
	}
}

153 
šlše
 
	$sdsšş’
(
sds
 
s
, 
size_t
 
šc
) {

154 
æags
 = 
s
[-1];

155 
æags
&
SDS_TYPE_MASK
) {

156 
SDS_TYPE_5
:

158 *
å
 = ((*)
s
)-1;

159 
ÃwËn
 = 
	`SDS_TYPE_5_LEN
(
æags
)+
šc
;

160 *
å
 = 
SDS_TYPE_5
 | (
ÃwËn
 << 
SDS_TYPE_BITS
);

163 
SDS_TYPE_8
:

164 
	`SDS_HDR
(8,
s
)->
Ën
 +ğ
šc
;

166 
SDS_TYPE_16
:

167 
	`SDS_HDR
(16,
s
)->
Ën
 +ğ
šc
;

169 
SDS_TYPE_32
:

170 
	`SDS_HDR
(32,
s
)->
Ën
 +ğ
šc
;

172 
SDS_TYPE_64
:

173 
	`SDS_HDR
(64,
s
)->
Ën
 +ğ
šc
;

176 
	}
}

179 
šlše
 
size_t
 
	$sd§Îoc
(cÚ¡ 
sds
 
s
) {

180 
æags
 = 
s
[-1];

181 
æags
&
SDS_TYPE_MASK
) {

182 
SDS_TYPE_5
:

183  
	`SDS_TYPE_5_LEN
(
æags
);

184 
SDS_TYPE_8
:

185  
	`SDS_HDR
(8,
s
)->
®loc
;

186 
SDS_TYPE_16
:

187  
	`SDS_HDR
(16,
s
)->
®loc
;

188 
SDS_TYPE_32
:

189  
	`SDS_HDR
(32,
s
)->
®loc
;

190 
SDS_TYPE_64
:

191  
	`SDS_HDR
(64,
s
)->
®loc
;

194 
	}
}

196 
šlše
 
	$sds£Îoc
(
sds
 
s
, 
size_t
 
ÃwËn
) {

197 
æags
 = 
s
[-1];

198 
æags
&
SDS_TYPE_MASK
) {

199 
SDS_TYPE_5
:

202 
SDS_TYPE_8
:

203 
	`SDS_HDR
(8,
s
)->
®loc
 = 
ÃwËn
;

205 
SDS_TYPE_16
:

206 
	`SDS_HDR
(16,
s
)->
®loc
 = 
ÃwËn
;

208 
SDS_TYPE_32
:

209 
	`SDS_HDR
(32,
s
)->
®loc
 = 
ÃwËn
;

211 
SDS_TYPE_64
:

212 
	`SDS_HDR
(64,
s
)->
®loc
 = 
ÃwËn
;

215 
	}
}

217 
sds
 
sd¢ewËn
(cÚ¡ *
š™
, 
size_t
 
š™Ën
);

218 
sds
 
sd¢ew
(cÚ¡ *
š™
);

219 
sds
 
sd£m±y
();

220 
sds
 
sdsdup
(cÚ¡ sd 
s
);

221 
sdsä“
(
sds
 
s
);

222 
sds
 
sdsgrowz”o
(sd 
s
, 
size_t
 
Ën
);

223 
sds
 
sdsÿ’
(sd 
s
, cÚ¡ *
t
, 
size_t
 
Ën
);

224 
sds
 
sdsÿt
(sd 
s
, cÚ¡ *
t
);

225 
sds
 
sdsÿtsds
(sd 
s
, cÚ¡ sd 
t
);

226 
sds
 
sdsıyËn
(sd 
s
, cÚ¡ *
t
, 
size_t
 
Ën
);

227 
sds
 
sdsıy
(sd 
s
, cÚ¡ *
t
);

229 
sds
 
sdsÿtv´štf
(sd 
s
, cÚ¡ *
fmt
, 
va_li¡
 
­
);

230 #ifdeà
__GNUC__


231 
sds
 
	$sdsÿrštf
(
sds
 
s
, cÚ¡ *
fmt
, ...)

232 
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 2, 3)));

234 
sds
 
	`sdsÿrštf
(sd 
s
, cÚ¡ *
fmt
, ...);

237 
sds
 
	`sdsÿtfmt
(sd 
s
, cÚ¡ *
fmt
, ...);

238 
sds
 
	`sd¡rim
(sd 
s
, cÚ¡ *
c£t
);

239 
	`sd¤ªge
(
sds
 
s
, 
¡¬t
, 
’d
);

240 
	`sdsupd©–’
(
sds
 
s
);

241 
	`sdsş—r
(
sds
 
s
);

242 
	`sdscmp
(cÚ¡ 
sds
 
s1
, cÚ¡ sd 
s2
);

243 
sds
 *
	`sds¥l™Ën
(cÚ¡ *
s
, 
Ën
, cÚ¡ *
£p
, 
£¶’
, *
couÁ
);

244 
	`sdsä“¥l™»s
(
sds
 *
tok’s
, 
couÁ
);

245 
	`sd¡Şow”
(
sds
 
s
);

246 
	`sd¡ouµ”
(
sds
 
s
);

247 
sds
 
	`sdsäomlÚglÚg
(
v®ue
);

248 
sds
 
	`sdsÿŒ•r
(sd 
s
, cÚ¡ *
p
, 
size_t
 
Ën
);

249 
sds
 *
	`sds¥l™¬gs
(cÚ¡ *
lše
, *
¬gc
);

250 
sds
 
	`sdsm­ch¬s
(sd 
s
, cÚ¡ *
äom
, cÚ¡ *
to
, 
size_t
 
£’
);

251 
sds
 
	`sdsjoš
(**
¬gv
, 
¬gc
, *
£p
);

252 
sds
 
	`sdsjošsds
(sd *
¬gv
, 
¬gc
, cÚ¡ *
£p
, 
size_t
 
£¶’
);

255 
sds
 
	`sdsMakeRoomFÜ
(sd 
s
, 
size_t
 
addËn
);

256 
	`sdsInüL’
(
sds
 
s
, 
šü
);

257 
sds
 
	`sdsRemoveF»eS·û
(sd 
s
);

258 
size_t
 
	`sdsAÎocSize
(
sds
 
s
);

259 *
	`sdsAÎocPŒ
(
sds
 
s
);

265 *
	`sds_m®loc
(
size_t
 
size
);

266 *
	`sds_»®loc
(*
±r
, 
size_t
 
size
);

267 
	`sds_ä“
(*
±r
);

269 #ifdeà
REDIS_TEST


270 
	`sdsTe¡
(
¬gc
, *
¬gv
[]);

	@deps/hiredis/sdsalloc.h

39 
	~"zm®loc.h
"

40 
	#s_m®loc
 
zm®loc


	)

41 
	#s_»®loc
 
z»®loc


	)

42 
	#s_ä“
 
zä“


	)

	@deps/hiredis/test.c

1 
	~"fmaüos.h
"

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~<¡ršg.h
>

5 
	~<¡ršgs.h
>

6 
	~<sys/time.h
>

7 
	~<as£¹.h
>

8 
	~<uni¡d.h
>

9 
	~<sigÇl.h
>

10 
	~<”ºo.h
>

11 
	~<lim™s.h
>

13 
	~"hœedis.h
"

15 
	ecÚÃùiÚ_ty³
 {

16 
	mCONN_TCP
,

17 
	mCONN_UNIX
,

18 
	mCONN_FD


21 
	scÚfig
 {

22 
cÚÃùiÚ_ty³
 
	mty³
;

25 cÚ¡ *
	mho¡
;

26 
	mpÜt
;

27 
timev®
 
	mtimeout
;

28 } 
	mtı
;

31 cÚ¡ *
	m·th
;

32 } 
	munix
;

36 
	g‹¡s
 = 0, 
	gçs
 = 0;

37 
	#‹¡
(
_s
è{ 
	`´štf
("#%02d ", ++
‹¡s
);…rštf(_s); }

	)

38 
	#‹¡_cÚd
(
_c
èif(_cè
	`´štf
("\033[0;32mPASSED\033[0;0m\n"); {´štf("\033[0;31mFAILED\033[0;0m\n"); 
çs
++;}

	)

40 
	$u£c
() {

41 
timev®
 
tv
;

42 
	`g‘timeofday
(&
tv
,
NULL
);

43  ((()
tv
.
tv_£c
)*1000000)+tv.
tv_u£c
;

44 
	}
}

46 
»disCÚ‹xt
 *
	$£Ëù_d©aba£
(
»disCÚ‹xt
 *
c
) {

47 
»disR•ly
 *
»¶y
;

50 
»¶y
 = 
	`»disCommªd
(
c
,"SELECT 9");

51 
	`as£¹
(
»¶y
 !ğ
NULL
);

52 
	`ä“R•lyObjeù
(
»¶y
);

55 
»¶y
 = 
	`»disCommªd
(
c
,"DBSIZE");

56 
	`as£¹
(
»¶y
 !ğ
NULL
);

57 ià(
»¶y
->
ty³
 =ğ
REDIS_REPLY_INTEGER
 &&„•ly->
š‹g”
 == 0) {

59 
	`ä“R•lyObjeù
(
»¶y
);

61 
	`´štf
("Database #9 is‚otƒmpty,est can‚ot continue\n");

62 
	`ex™
(1);

65  
c
;

66 
	}
}

68 
	$discÚÃù
(
»disCÚ‹xt
 *
c
, 
k“p_fd
) {

69 
»disR•ly
 *
»¶y
;

72 
»¶y
 = 
	`»disCommªd
(
c
,"SELECT 9");

73 
	`as£¹
(
»¶y
 !ğ
NULL
);

74 
	`ä“R•lyObjeù
(
»¶y
);

75 
»¶y
 = 
	`»disCommªd
(
c
,"FLUSHDB");

76 
	`as£¹
(
»¶y
 !ğ
NULL
);

77 
	`ä“R•lyObjeù
(
»¶y
);

80 ià(
k“p_fd
)

81  
	`»disF»eK“pFd
(
c
);

82 
	`»disF»e
(
c
);

84 
	}
}

86 
»disCÚ‹xt
 *
	$cÚÃù
(
cÚfig
 config) {

87 
»disCÚ‹xt
 *
c
 = 
NULL
;

89 ià(
cÚfig
.
ty³
 =ğ
CONN_TCP
) {

90 
c
 = 
	`»disCÚÃù
(
cÚfig
.
tı
.
ho¡
, cÚfig.tı.
pÜt
);

91 } ià(
cÚfig
.
ty³
 =ğ
CONN_UNIX
) {

92 
c
 = 
	`»disCÚÃùUnix
(
cÚfig
.
unix
.
·th
);

93 } ià(
cÚfig
.
ty³
 =ğ
CONN_FD
) {

95 
»disCÚ‹xt
 *
dummy_ùx
 = 
	`»disCÚÃùUnix
(
cÚfig
.
unix
.
·th
);

96 ià(
dummy_ùx
) {

97 
fd
 = 
	`discÚÃù
(
dummy_ùx
, 1);

98 
	`´štf
("CÚÃùšgØšh”™ed fd %d\n", 
fd
);

99 
c
 = 
	`»disCÚÃùFd
(
fd
);

102 
	`as£¹
(
NULL
);

105 ià(
c
 =ğ
NULL
) {

106 
	`´štf
("Connectionƒrror: can't‡llocate„edis context\n");

107 
	`ex™
(1);

108 } ià(
c
->
”r
) {

109 
	`´štf
("CÚÃùiÚƒ¼Ü: %s\n", 
c
->
”r¡r
);

110 
	`ex™
(1);

113  
	`£Ëù_d©aba£
(
c
);

114 
	}
}

116 
	$‹¡_fÜm©_commªds
() {

117 *
cmd
;

118 
Ën
;

120 
	`‹¡
("Format command without interpolation: ");

121 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"SET foo bar");

122 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*3\r\n$3\r\nSET\r\n$3\r\nfoo\r\n$3\r\nb¬\r\n",
Ën
) == 0 &&

123 
Ën
 == 4+4+(3+2)+4+(3+2)+4+(3+2));

124 
	`ä“
(
cmd
);

126 
	`‹¡
("Format command with %%s string interpolation: ");

127 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"SET %s %s","foo","bar");

128 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*3\r\n$3\r\nSET\r\n$3\r\nfoo\r\n$3\r\nb¬\r\n",
Ën
) == 0 &&

129 
Ën
 == 4+4+(3+2)+4+(3+2)+4+(3+2));

130 
	`ä“
(
cmd
);

132 
	`‹¡
("Format command with %%s‡nd‡nƒmpty string: ");

133 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"SET %s %s","foo","");

134 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*3\r\n$3\r\nSET\r\n$3\r\nfoo\r\n$0\r\n\r\n",
Ën
) == 0 &&

135 
Ën
 == 4+4+(3+2)+4+(3+2)+4+(0+2));

136 
	`ä“
(
cmd
);

138 
	`‹¡
("Format command with‡nƒmpty string in between…roper interpolations: ");

139 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"SET %s %s","","foo");

140 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*3\r\n$3\r\nSET\r\n$0\r\n\r\n$3\r\nfoo\r\n",
Ën
) == 0 &&

141 
Ën
 == 4+4+(3+2)+4+(0+2)+4+(3+2));

142 
	`ä“
(
cmd
);

144 
	`‹¡
("Format command with %%b string interpolation: ");

145 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"SET %b %b","foo",(
size_t
)3,"b\0r",(size_t)3);

146 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*3\r\n$3\r\nSET\r\n$3\r\nfoo\r\n$3\r\nb\0r\r\n",
Ën
) == 0 &&

147 
Ën
 == 4+4+(3+2)+4+(3+2)+4+(3+2));

148 
	`ä“
(
cmd
);

150 
	`‹¡
("Format command with %%b‡nd‡nƒmpty string: ");

151 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"SET %b %b","foo",(
size_t
)3,"",(size_t)0);

152 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*3\r\n$3\r\nSET\r\n$3\r\nfoo\r\n$0\r\n\r\n",
Ën
) == 0 &&

153 
Ën
 == 4+4+(3+2)+4+(3+2)+4+(0+2));

154 
	`ä“
(
cmd
);

156 
	`‹¡
("Format command with†iteral %%: ");

157 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"SET %% %%");

158 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*3\r\n$3\r\nSET\r\n$1\r\n%\r\n$1\r\n%\r\n",
Ën
) == 0 &&

159 
Ën
 == 4+4+(3+2)+4+(1+2)+4+(1+2));

160 
	`ä“
(
cmd
);

165 
	#INTEGER_WIDTH_TEST
(
fmt
, 
ty³
) do { \

166 
ty³
 
v®ue
 = 123; \

167 
	`‹¡
("Format command with…rintf-delegation (" #type "): "); \

168 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"key:%08" 
fmt
 " sŒ:%s", 
v®ue
, "hello"); \

169 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*2\r\n$12\r\nkey:00000123\r\n$9\r\n¡r:h–lo\r\n",
Ën
) == 0 && \

170 
Ën
 == 4+5+(12+2)+4+(9+2)); \

171 
	`ä“
(
cmd
); \

172 } 0)

	)

174 
	#FLOAT_WIDTH_TEST
(
ty³
) do { \

175 
ty³
 
v®ue
 = 123.0; \

176 
	`‹¡
("Format command with…rintf-delegation (" #type "): "); \

177 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"key:%08.3à¡r:%s", 
v®ue
, "hello"); \

178 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*2\r\n$12\r\nkey:0123.000\r\n$9\r\n¡r:h–lo\r\n",
Ën
) == 0 && \

179 
Ën
 == 4+5+(12+2)+4+(9+2)); \

180 
	`ä“
(
cmd
); \

181 } 0)

	)

183 
	`INTEGER_WIDTH_TEST
("d", );

184 
	`INTEGER_WIDTH_TEST
("hhd", );

185 
	`INTEGER_WIDTH_TEST
("hd", );

186 
	`INTEGER_WIDTH_TEST
("ld", );

187 
	`INTEGER_WIDTH_TEST
("lld", );

188 
	`INTEGER_WIDTH_TEST
("u", );

189 
	`INTEGER_WIDTH_TEST
("hhu", );

190 
	`INTEGER_WIDTH_TEST
("hu", );

191 
	`INTEGER_WIDTH_TEST
("lu", );

192 
	`INTEGER_WIDTH_TEST
("llu", );

193 
	`FLOAT_WIDTH_TEST
();

194 
	`FLOAT_WIDTH_TEST
();

196 
	`‹¡
("Format command with invalid…rintf format: ");

197 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"key:%08°%b",(*)1234,"foo",(
size_t
)3);

198 
	`‹¡_cÚd
(
Ën
 == -1);

200 cÚ¡ *
¬gv
[3];

201 
¬gv
[0] = "SET";

202 
¬gv
[1] = "foo\0xxx";

203 
¬gv
[2] = "bar";

204 
size_t
 
Ëns
[3] = { 3, 7, 3 };

205 
¬gc
 = 3;

207 
	`‹¡
("Format command by…assing‡rgc/argv without†engths: ");

208 
Ën
 = 
	`»disFÜm©CommªdArgv
(&
cmd
,
¬gc
,
¬gv
,
NULL
);

209 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*3\r\n$3\r\nSET\r\n$3\r\nfoo\r\n$3\r\nb¬\r\n",
Ën
) == 0 &&

210 
Ën
 == 4+4+(3+2)+4+(3+2)+4+(3+2));

211 
	`ä“
(
cmd
);

213 
	`‹¡
("Format command by…assing‡rgc/argv with†engths: ");

214 
Ën
 = 
	`»disFÜm©CommªdArgv
(&
cmd
,
¬gc
,
¬gv
,
Ëns
);

215 
	`‹¡_cÚd
(
	`¡ºcmp
(
cmd
,"*3\r\n$3\r\nSET\r\n$7\r\nfoo\0xxx\r\n$3\r\nb¬\r\n",
Ën
) == 0 &&

216 
Ën
 == 4+4+(3+2)+4+(7+2)+4+(3+2));

217 
	`ä“
(
cmd
);

218 
	}
}

220 
	$‹¡_­³nd_fÜm©‹d_commªds
(
cÚfig
 config) {

221 
»disCÚ‹xt
 *
c
;

222 
»disR•ly
 *
»¶y
;

223 *
cmd
;

224 
Ën
;

226 
c
 = 
	`cÚÃù
(
cÚfig
);

228 
	`‹¡
("Append format command: ");

230 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
, "SET foo bar");

232 
	`‹¡_cÚd
(
	`»disAµ’dFÜm©‹dCommªd
(
c
, 
cmd
, 
Ën
è=ğ
REDIS_OK
);

234 
	`as£¹
(
	`»disG‘R•ly
(
c
, (*)&
»¶y
è=ğ
REDIS_OK
);

236 
	`ä“
(
cmd
);

237 
	`ä“R•lyObjeù
(
»¶y
);

239 
	`discÚÃù
(
c
, 0);

240 
	}
}

242 
	$‹¡_»¶y_»ad”
() {

243 
»disR—d”
 *
»ad”
;

244 *
»¶y
;

245 
»t
;

246 
i
;

248 
	`‹¡
("Error handling in„eply…arser: ");

249 
»ad”
 = 
	`»disR—d”C»©e
();

250 
	`»disR—d”F“d
(
»ad”
,(*)"@foo\r\n",6);

251 
»t
 = 
	`»disR—d”G‘R•ly
(
»ad”
,
NULL
);

252 
	`‹¡_cÚd
(
»t
 =ğ
REDIS_ERR
 &&

253 
	`¡rÿ£cmp
(
»ad”
->
”r¡r
,"Protocolƒrror, got \"@\"‡s„eplyype byte") == 0);

254 
	`»disR—d”F»e
(
»ad”
);

258 
	`‹¡
("Memory cleanup in„eply…arser: ");

259 
»ad”
 = 
	`»disR—d”C»©e
();

260 
	`»disR—d”F“d
(
»ad”
,(*)"*2\r\n",4);

261 
	`»disR—d”F“d
(
»ad”
,(*)"$5\r\nhello\r\n",11);

262 
	`»disR—d”F“d
(
»ad”
,(*)"@foo\r\n",6);

263 
»t
 = 
	`»disR—d”G‘R•ly
(
»ad”
,
NULL
);

264 
	`‹¡_cÚd
(
»t
 =ğ
REDIS_ERR
 &&

265 
	`¡rÿ£cmp
(
»ad”
->
”r¡r
,"Protocolƒrror, got \"@\"‡s„eplyype byte") == 0);

266 
	`»disR—d”F»e
(
»ad”
);

268 
	`‹¡
("Setƒrror on‚ested multi bulks with depth > 7: ");

269 
»ad”
 = 
	`»disR—d”C»©e
();

271 
i
 = 0; i < 9; i++) {

272 
	`»disR—d”F“d
(
»ad”
,(*)"*1\r\n",4);

275 
»t
 = 
	`»disR—d”G‘R•ly
(
»ad”
,
NULL
);

276 
	`‹¡_cÚd
(
»t
 =ğ
REDIS_ERR
 &&

277 
	`¡ºÿ£cmp
(
»ad”
->
”r¡r
,"No support for",14) == 0);

278 
	`»disR—d”F»e
(
»ad”
);

280 
	`‹¡
("Works with NULL functions for„eply: ");

281 
»ad”
 = 
	`»disR—d”C»©e
();

282 
»ad”
->
â
 = 
NULL
;

283 
	`»disR—d”F“d
(
»ad”
,(*)"+OK\r\n",5);

284 
»t
 = 
	`»disR—d”G‘R•ly
(
»ad”
,&
»¶y
);

285 
	`‹¡_cÚd
(
»t
 =ğ
REDIS_OK
 && 
»¶y
 =ğ(*)
REDIS_REPLY_STATUS
);

286 
	`»disR—d”F»e
(
»ad”
);

288 
	`‹¡
("Works when‡ single‚ewline (\\r\\n) coverswo callso feed: ");

289 
»ad”
 = 
	`»disR—d”C»©e
();

290 
»ad”
->
â
 = 
NULL
;

291 
	`»disR—d”F“d
(
»ad”
,(*)"+OK\r",4);

292 
»t
 = 
	`»disR—d”G‘R•ly
(
»ad”
,&
»¶y
);

293 
	`as£¹
(
»t
 =ğ
REDIS_OK
 && 
»¶y
 =ğ
NULL
);

294 
	`»disR—d”F“d
(
»ad”
,(*)"\n",1);

295 
»t
 = 
	`»disR—d”G‘R•ly
(
»ad”
,&
»¶y
);

296 
	`‹¡_cÚd
(
»t
 =ğ
REDIS_OK
 && 
»¶y
 =ğ(*)
REDIS_REPLY_STATUS
);

297 
	`»disR—d”F»e
(
»ad”
);

299 
	`‹¡
("Don't„eset state‡fter…rotocolƒrror: ");

300 
»ad”
 = 
	`»disR—d”C»©e
();

301 
»ad”
->
â
 = 
NULL
;

302 
	`»disR—d”F“d
(
»ad”
,(*)"x",1);

303 
»t
 = 
	`»disR—d”G‘R•ly
(
»ad”
,&
»¶y
);

304 
	`as£¹
(
»t
 =ğ
REDIS_ERR
);

305 
»t
 = 
	`»disR—d”G‘R•ly
(
»ad”
,&
»¶y
);

306 
	`‹¡_cÚd
(
»t
 =ğ
REDIS_ERR
 && 
»¶y
 =ğ
NULL
);

307 
	`»disR—d”F»e
(
»ad”
);

310 
	`‹¡
("Don't doƒmpty‡llocation forƒmpty multi bulk: ");

311 
»ad”
 = 
	`»disR—d”C»©e
();

312 
	`»disR—d”F“d
(
»ad”
,(*)"*0\r\n",4);

313 
»t
 = 
	`»disR—d”G‘R•ly
(
»ad”
,&
»¶y
);

314 
	`‹¡_cÚd
(
»t
 =ğ
REDIS_OK
 &&

315 ((
»disR•ly
*)
»¶y
)->
ty³
 =ğ
REDIS_REPLY_ARRAY
 &&

316 ((
»disR•ly
*)
»¶y
)->
–em’ts
 == 0);

317 
	`ä“R•lyObjeù
(
»¶y
);

318 
	`»disR—d”F»e
(
»ad”
);

319 
	}
}

321 
	$‹¡_blockšg_cÚÃùiÚ_”rÜs
() {

322 
»disCÚ‹xt
 *
c
;

324 
	`‹¡
("Returnsƒrror when host cannot be„esolved: ");

325 
c
 = 
	`»disCÚÃù
((*)"idontexist.local", 6379);

326 
	`‹¡_cÚd
(
c
->
”r
 =ğ
REDIS_ERR_OTHER
 &&

327 (
	`¡rcmp
(
c
->
”r¡r
,"Name or service‚ot known") == 0 ||

328 
	`¡rcmp
(
c
->
”r¡r
,"Can't„esolve: idontexist.local") == 0 ||

329 
	`¡rcmp
(
c
->
”r¡r
,"nodename‚or servname…rovided, or‚ot known") == 0 ||

330 
	`¡rcmp
(
c
->
”r¡r
,"No‡ddress‡ssociated with hostname") == 0 ||

331 
	`¡rcmp
(
c
->
”r¡r
,"no‡ddress‡ssociated with‚ame") == 0));

332 
	`»disF»e
(
c
);

334 
	`‹¡
("Returnsƒrror whenhe…ort is‚ot open: ");

335 
c
 = 
	`»disCÚÃù
((*)"localhost", 1);

336 
	`‹¡_cÚd
(
c
->
”r
 =ğ
REDIS_ERR_IO
 &&

337 
	`¡rcmp
(
c
->
”r¡r
,"Connection„efused") == 0);

338 
	`»disF»e
(
c
);

340 
	`‹¡
("Returnsƒrror whenhe unix socket…ath doesn't‡ccept connections: ");

341 
c
 = 
	`»disCÚÃùUnix
((*)"/tmp/idontexist.sock");

342 
	`‹¡_cÚd
(
c
->
”r
 =ğ
REDIS_ERR_IO
);

343 
	`»disF»e
(
c
);

344 
	}
}

346 
	$‹¡_blockšg_cÚÃùiÚ
(
cÚfig
 config) {

347 
»disCÚ‹xt
 *
c
;

348 
»disR•ly
 *
»¶y
;

350 
c
 = 
	`cÚÃù
(
cÚfig
);

352 
	`‹¡
("Is‡bleo deliver commands: ");

353 
»¶y
 = 
	`»disCommªd
(
c
,"PING");

354 
	`‹¡_cÚd
(
»¶y
->
ty³
 =ğ
REDIS_REPLY_STATUS
 &&

355 
	`¡rÿ£cmp
(
»¶y
->
¡r
,"pong") == 0)

356 
	`ä“R•lyObjeù
(
»¶y
);

358 
	`‹¡
("Is‡‡bleo send commands verbatim: ");

359 
»¶y
 = 
	`»disCommªd
(
c
,"SET foo bar");

360 
	`‹¡_cÚd
 (
»¶y
->
ty³
 =ğ
REDIS_REPLY_STATUS
 &&

361 
	`¡rÿ£cmp
(
»¶y
->
¡r
,"ok") == 0)

362 
	`ä“R•lyObjeù
(
»¶y
);

364 
	`‹¡
("%%s String interpolation works: ");

365 
»¶y
 = 
	`»disCommªd
(
c
,"SET %s %s","foo","hello world");

366 
	`ä“R•lyObjeù
(
»¶y
);

367 
»¶y
 = 
	`»disCommªd
(
c
,"GET foo");

368 
	`‹¡_cÚd
(
»¶y
->
ty³
 =ğ
REDIS_REPLY_STRING
 &&

369 
	`¡rcmp
(
»¶y
->
¡r
,"hello world") == 0);

370 
	`ä“R•lyObjeù
(
»¶y
);

372 
	`‹¡
("%%b String interpolation works: ");

373 
»¶y
 = 
	`»disCommªd
(
c
,"SET %b %b","foo",(
size_t
)3,"hello\x00world",(size_t)11);

374 
	`ä“R•lyObjeù
(
»¶y
);

375 
»¶y
 = 
	`»disCommªd
(
c
,"GET foo");

376 
	`‹¡_cÚd
(
»¶y
->
ty³
 =ğ
REDIS_REPLY_STRING
 &&

377 
	`memcmp
(
»¶y
->
¡r
,"hello\x00world",11) == 0)

379 
	`‹¡
("Binary„eply†ength is correct: ");

380 
	`‹¡_cÚd
(
»¶y
->
Ën
 == 11)

381 
	`ä“R•lyObjeù
(
»¶y
);

383 
	`‹¡
("Can…arse‚il„eplies: ");

384 
»¶y
 = 
	`»disCommªd
(
c
,"GET‚okey");

385 
	`‹¡_cÚd
(
»¶y
->
ty³
 =ğ
REDIS_REPLY_NIL
)

386 
	`ä“R•lyObjeù
(
»¶y
);

389 
	`‹¡
("Can…arse integer„eplies: ");

390 
»¶y
 = 
	`»disCommªd
(
c
,"INCR mycounter");

391 
	`‹¡_cÚd
(
»¶y
->
ty³
 =ğ
REDIS_REPLY_INTEGER
 &&„•ly->
š‹g”
 == 1)

392 
	`ä“R•lyObjeù
(
»¶y
);

394 
	`‹¡
("Can…arse multi bulk„eplies: ");

395 
	`ä“R•lyObjeù
(
	`»disCommªd
(
c
,"LPUSH mylist foo"));

396 
	`ä“R•lyObjeù
(
	`»disCommªd
(
c
,"LPUSH mylist bar"));

397 
»¶y
 = 
	`»disCommªd
(
c
,"LRANGE mylist 0 -1");

398 
	`‹¡_cÚd
(
»¶y
->
ty³
 =ğ
REDIS_REPLY_ARRAY
 &&

399 
»¶y
->
–em’ts
 == 2 &&

400 !
	`memcmp
(
»¶y
->
–em’t
[0]->
¡r
,"bar",3) &&

401 !
	`memcmp
(
»¶y
->
–em’t
[1]->
¡r
,"foo",3))

402 
	`ä“R•lyObjeù
(
»¶y
);

406 
	`‹¡
("Can handle‚ested multi bulk„eplies: ");

407 
	`ä“R•lyObjeù
(
	`»disCommªd
(
c
,"MULTI"));

408 
	`ä“R•lyObjeù
(
	`»disCommªd
(
c
,"LRANGE mylist 0 -1"));

409 
	`ä“R•lyObjeù
(
	`»disCommªd
(
c
,"PING"));

410 
»¶y
 = (
	`»disCommªd
(
c
,"EXEC"));

411 
	`‹¡_cÚd
(
»¶y
->
ty³
 =ğ
REDIS_REPLY_ARRAY
 &&

412 
»¶y
->
–em’ts
 == 2 &&

413 
»¶y
->
–em’t
[0]->
ty³
 =ğ
REDIS_REPLY_ARRAY
 &&

414 
»¶y
->
–em’t
[0]->
–em’ts
 == 2 &&

415 !
	`memcmp
(
»¶y
->
–em’t
[0]->–em’t[0]->
¡r
,"bar",3) &&

416 !
	`memcmp
(
»¶y
->
–em’t
[0]->–em’t[1]->
¡r
,"foo",3) &&

417 
»¶y
->
–em’t
[1]->
ty³
 =ğ
REDIS_REPLY_STATUS
 &&

418 
	`¡rÿ£cmp
(
»¶y
->
–em’t
[1]->
¡r
,"pong") == 0);

419 
	`ä“R•lyObjeù
(
»¶y
);

421 
	`discÚÃù
(
c
, 0);

422 
	}
}

424 
	$‹¡_blockšg_io_”rÜs
(
cÚfig
 config) {

425 
»disCÚ‹xt
 *
c
;

426 
»disR•ly
 *
»¶y
;

427 *
_»¶y
;

428 
majÜ
, 
mšÜ
;

431 
c
 = 
	`cÚÃù
(
cÚfig
);

434 cÚ¡ *
f›ld
 = "redis_version:";

435 *
p
, *
•Œ
;

437 
»¶y
 = 
	`»disCommªd
(
c
,"INFO");

438 
p
 = 
	`¡r¡r
(
»¶y
->
¡r
,
f›ld
);

439 
majÜ
 = 
	`¡¹Ş
(
p
+
	`¡¾’
(
f›ld
),&
•Œ
,10);

440 
p
 = 
•Œ
+1;

441 
mšÜ
 = 
	`¡¹Ş
(
p
,&
•Œ
,10);

442 
	`ä“R•lyObjeù
(
»¶y
);

445 
	`‹¡
("Returns I/Oƒrror whenhe connection is†ost: ");

446 
»¶y
 = 
	`»disCommªd
(
c
,"QUIT");

447 ià(
majÜ
 >ğ2 && 
mšÜ
 > 0) {

450 
	`‹¡_cÚd
(
	`¡rÿ£cmp
(
»¶y
->
¡r
,"OK") == 0 &&

451 
	`»disG‘R•ly
(
c
,&
_»¶y
è=ğ
REDIS_ERR
);

452 
	`ä“R•lyObjeù
(
»¶y
);

454 
	`‹¡_cÚd
(
»¶y
 =ğ
NULL
);

462 
	`as£¹
(
c
->
”r
 =ğ
REDIS_ERR_EOF
 &&

463 
	`¡rcmp
(
c
->
”r¡r
,"Server closedhe connection") == 0);

464 
	`»disF»e
(
c
);

466 
c
 = 
	`cÚÃù
(
cÚfig
);

467 
	`‹¡
("Returns I/Oƒrror on socketimeout: ");

468 
timev®
 
tv
 = { 0, 1000 };

469 
	`as£¹
(
	`»disS‘Timeout
(
c
,
tv
è=ğ
REDIS_OK
);

470 
	`‹¡_cÚd
(
	`»disG‘R•ly
(
c
,&
_»¶y
è=ğ
REDIS_ERR
 &&

471 
c
->
”r
 =ğ
REDIS_ERR_IO
 && 
”ºo
 =ğ
EAGAIN
);

472 
	`»disF»e
(
c
);

473 
	}
}

475 
	$‹¡_šv®id_timeout_”rÜs
(
cÚfig
 config) {

476 
»disCÚ‹xt
 *
c
;

478 
	`‹¡
("Setƒrror when‡n invalidimeout usec value is giveno„edisConnectWithTimeout: ");

480 
cÚfig
.
tı
.
timeout
.
tv_£c
 = 0;

481 
cÚfig
.
tı
.
timeout
.
tv_u£c
 = 10000001;

483 
c
 = 
	`»disCÚÃùW™hTimeout
(
cÚfig
.
tı
.
ho¡
, cÚfig.tı.
pÜt
, cÚfig.tı.
timeout
);

485 
	`‹¡_cÚd
(
c
->
”r
 =ğ
REDIS_ERR_IO
);

487 
	`‹¡
("Setƒrror when‡n invalidimeout sec value is giveno„edisConnectWithTimeout: ");

489 
cÚfig
.
tı
.
timeout
.
tv_£c
 = (((
LONG_MAX
) - 999) / 1000) + 1;

490 
cÚfig
.
tı
.
timeout
.
tv_u£c
 = 0;

492 
c
 = 
	`»disCÚÃùW™hTimeout
(
cÚfig
.
tı
.
ho¡
, cÚfig.tı.
pÜt
, cÚfig.tı.
timeout
);

494 
	`‹¡_cÚd
(
c
->
”r
 =ğ
REDIS_ERR_IO
);

496 
	`»disF»e
(
c
);

497 
	}
}

499 
	$‹¡_throughput
(
cÚfig
 config) {

500 
»disCÚ‹xt
 *
c
 = 
	`cÚÃù
(
cÚfig
);

501 
»disR•ly
 **
»¶›s
;

502 
i
, 
num
;

503 
t1
, 
t2
;

505 
	`‹¡
("Throughput:\n");

506 
i
 = 0; i < 500; i++)

507 
	`ä“R•lyObjeù
(
	`»disCommªd
(
c
,"LPUSH mylist foo"));

509 
num
 = 1000;

510 
»¶›s
 = 
	`m®loc
((
»disR•ly
*)*
num
);

511 
t1
 = 
	`u£c
();

512 
i
 = 0; i < 
num
; i++) {

513 
»¶›s
[
i
] = 
	`»disCommªd
(
c
,"PING");

514 
	`as£¹
(
»¶›s
[
i
] !ğ
NULL
 &&„•l›s[i]->
ty³
 =ğ
REDIS_REPLY_STATUS
);

516 
t2
 = 
	`u£c
();

517 
i
 = 0; i < 
num
; i++è
	`ä“R•lyObjeù
(
»¶›s
[i]);

518 
	`ä“
(
»¶›s
);

519 
	`´štf
("\t(%dx PING: %.3fs)\n", 
num
, (
t2
-
t1
)/1000000.0);

521 
»¶›s
 = 
	`m®loc
((
»disR•ly
*)*
num
);

522 
t1
 = 
	`u£c
();

523 
i
 = 0; i < 
num
; i++) {

524 
»¶›s
[
i
] = 
	`»disCommªd
(
c
,"LRANGE mylist 0 499");

525 
	`as£¹
(
»¶›s
[
i
] !ğ
NULL
 &&„•l›s[i]->
ty³
 =ğ
REDIS_REPLY_ARRAY
);

526 
	`as£¹
(
»¶›s
[
i
] !ğ
NULL
 &&„•l›s[i]->
–em’ts
 == 500);

528 
t2
 = 
	`u£c
();

529 
i
 = 0; i < 
num
; i++è
	`ä“R•lyObjeù
(
»¶›s
[i]);

530 
	`ä“
(
»¶›s
);

531 
	`´štf
("\t(%dx LRANGE w™h 500ƒËm’ts: %.3fs)\n", 
num
, (
t2
-
t1
)/1000000.0);

533 
num
 = 10000;

534 
»¶›s
 = 
	`m®loc
((
»disR•ly
*)*
num
);

535 
i
 = 0; i < 
num
; i++)

536 
	`»disAµ’dCommªd
(
c
,"PING");

537 
t1
 = 
	`u£c
();

538 
i
 = 0; i < 
num
; i++) {

539 
	`as£¹
(
	`»disG‘R•ly
(
c
, (*)&
»¶›s
[
i
]è=ğ
REDIS_OK
);

540 
	`as£¹
(
»¶›s
[
i
] !ğ
NULL
 &&„•l›s[i]->
ty³
 =ğ
REDIS_REPLY_STATUS
);

542 
t2
 = 
	`u£c
();

543 
i
 = 0; i < 
num
; i++è
	`ä“R•lyObjeù
(
»¶›s
[i]);

544 
	`ä“
(
»¶›s
);

545 
	`´štf
("\t(%dx PING (p–šed): %.3fs)\n", 
num
, (
t2
-
t1
)/1000000.0);

547 
»¶›s
 = 
	`m®loc
((
»disR•ly
*)*
num
);

548 
i
 = 0; i < 
num
; i++)

549 
	`»disAµ’dCommªd
(
c
,"LRANGE mylist 0 499");

550 
t1
 = 
	`u£c
();

551 
i
 = 0; i < 
num
; i++) {

552 
	`as£¹
(
	`»disG‘R•ly
(
c
, (*)&
»¶›s
[
i
]è=ğ
REDIS_OK
);

553 
	`as£¹
(
»¶›s
[
i
] !ğ
NULL
 &&„•l›s[i]->
ty³
 =ğ
REDIS_REPLY_ARRAY
);

554 
	`as£¹
(
»¶›s
[
i
] !ğ
NULL
 &&„•l›s[i]->
–em’ts
 == 500);

556 
t2
 = 
	`u£c
();

557 
i
 = 0; i < 
num
; i++è
	`ä“R•lyObjeù
(
»¶›s
[i]);

558 
	`ä“
(
»¶›s
);

559 
	`´štf
("\t(%dx LRANGE w™h 500ƒËm’t Õ–šed): %.3fs)\n", 
num
, (
t2
-
t1
)/1000000.0);

561 
	`discÚÃù
(
c
, 0);

562 
	}
}

663 
	$maš
(
¬gc
, **
¬gv
) {

664 
cÚfig
 
cfg
 = {

665 .
tı
 = {

666 .
ho¡
 = "127.0.0.1",

667 .
pÜt
 = 6379

669 .
unix
 = {

670 .
·th
 = "/tmp/redis.sock"

673 
throughput
 = 1;

674 
‹¡_šh”™_fd
 = 1;

677 
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
);

680 
¬gv
++; 
¬gc
--;

681 
¬gc
) {

682 ià(
¬gc
 >ğ2 && !
	`¡rcmp
(
¬gv
[0],"-h")) {

683 
¬gv
++; 
¬gc
--;

684 
cfg
.
tı
.
ho¡
 = 
¬gv
[0];

685 } ià(
¬gc
 >ğ2 && !
	`¡rcmp
(
¬gv
[0],"-p")) {

686 
¬gv
++; 
¬gc
--;

687 
cfg
.
tı
.
pÜt
 = 
	`©oi
(
¬gv
[0]);

688 } ià(
¬gc
 >ğ2 && !
	`¡rcmp
(
¬gv
[0],"-s")) {

689 
¬gv
++; 
¬gc
--;

690 
cfg
.
unix
.
·th
 = 
¬gv
[0];

691 } ià(
¬gc
 >ğ1 && !
	`¡rcmp
(
¬gv
[0],"--skip-throughput")) {

692 
throughput
 = 0;

693 } ià(
¬gc
 >ğ1 && !
	`¡rcmp
(
¬gv
[0],"--skip-inherit-fd")) {

694 
‹¡_šh”™_fd
 = 0;

696 
	`årštf
(
¡d”r
, "Inv®id‡rgum’t: %s\n", 
¬gv
[0]);

697 
	`ex™
(1);

699 
¬gv
++; 
¬gc
--;

702 
	`‹¡_fÜm©_commªds
();

703 
	`‹¡_»¶y_»ad”
();

704 
	`‹¡_blockšg_cÚÃùiÚ_”rÜs
();

706 
	`´štf
("\nTe¡šg‡gaš¡ TCP cÚÃùiÚ (%s:%d):\n", 
cfg
.
tı
.
ho¡
, cfg.tı.
pÜt
);

707 
cfg
.
ty³
 = 
CONN_TCP
;

708 
	`‹¡_blockšg_cÚÃùiÚ
(
cfg
);

709 
	`‹¡_blockšg_io_”rÜs
(
cfg
);

710 
	`‹¡_šv®id_timeout_”rÜs
(
cfg
);

711 
	`‹¡_­³nd_fÜm©‹d_commªds
(
cfg
);

712 ià(
throughput
è
	`‹¡_throughput
(
cfg
);

714 
	`´štf
("\nTe¡šg‡gaš¡ Unix sock‘ cÚÃùiÚ (%s):\n", 
cfg
.
unix
.
·th
);

715 
cfg
.
ty³
 = 
CONN_UNIX
;

716 
	`‹¡_blockšg_cÚÃùiÚ
(
cfg
);

717 
	`‹¡_blockšg_io_”rÜs
(
cfg
);

718 ià(
throughput
è
	`‹¡_throughput
(
cfg
);

720 ià(
‹¡_šh”™_fd
) {

721 
	`´štf
("\nTe¡šg‡gaš¡ inh”™ed fd (%s):\n", 
cfg
.
unix
.
·th
);

722 
cfg
.
ty³
 = 
CONN_FD
;

723 
	`‹¡_blockšg_cÚÃùiÚ
(
cfg
);

726 ià(
çs
) {

727 
	`´štf
("*** %d TESTS FAILED ***\n", 
çs
);

731 
	`´štf
("ALL TESTS PASSED\n");

733 
	}
}

	@deps/hiredis/zmalloc.h

4 #iâdeà
ZMALLOC_H


5 
	#ZMALLOC_H


	)

7 
	#zm®loc
 
m®loc


	)

8 
	#z»®loc
 
»®loc


	)

9 
	#zÿÎoc
(
x
è
	`ÿÎoc
(x,1)

	)

10 
	#zä“
 
ä“


	)

11 
	#z¡rdup
 
¡rdup


	)

	@deps/jemalloc/include/jemalloc/internal/arena.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
	#LARGE_MINCLASS
 (
	`ZU
(1è<< 
LG_LARGE_MINCLASS
)

	)

7 
	#LG_RUN_MAXREGS
 (
LG_PAGE
 - 
LG_TINY_MIN
)

	)

8 
	#RUN_MAXREGS
 (1U << 
LG_RUN_MAXREGS
)

	)

14 
	#REDZONE_MINSIZE
 16

	)

24 
	#LG_DIRTY_MULT_DEFAULT
 3

	)

27 
	mpurge_mode_¿tio
 = 0,

28 
	mpurge_mode_deÿy
 = 1,

30 
	mpurge_mode_lim™
 = 2

31 } 
	tpurge_mode_t
;

32 
	#PURGE_DEFAULT
 
purge_mode_¿tio


	)

34 
	#DECAY_TIME_DEFAULT
 10

	)

36 
	#DECAY_NTICKS_PER_UPDATE
 1000

	)

38 
¬’a_runs_dœty_lšk_s
 
	t¬’a_runs_dœty_lšk_t
;

39 
¬’a_ava_lšks_s
 
	t¬’a_ava_lšks_t
;

40 
¬’a_run_s
 
	t¬’a_run_t
;

41 
¬’a_chunk_m­_b™s_s
 
	t¬’a_chunk_m­_b™s_t
;

42 
¬’a_chunk_m­_misc_s
 
	t¬’a_chunk_m­_misc_t
;

43 
¬’a_chunk_s
 
	t¬’a_chunk_t
;

44 
¬’a_bš_šfo_s
 
	t¬’a_bš_šfo_t
;

45 
¬’a_deÿy_s
 
	t¬’a_deÿy_t
;

46 
¬’a_bš_s
 
	t¬’a_bš_t
;

47 
¬’a_s
 
	t¬’a_t
;

48 
¬’a_td©a_s
 
	t¬’a_td©a_t
;

52 #ifdeà
JEMALLOC_H_STRUCTS


54 #ifdeà
JEMALLOC_ARENA_STRUCTS_A


55 
	s¬’a_run_s
 {

57 
szšd_t
 
	mbššd
;

60 
	mnä“
;

63 
b™m­_t
 
	mb™m­
[
BITMAP_GROUPS_MAX
];

67 
	s¬’a_chunk_m­_b™s_s
 {

126 
size_t
 
	mb™s
;

127 
	#CHUNK_MAP_ALLOCATED
 ((
size_t
)0x01U)

	)

128 
	#CHUNK_MAP_LARGE
 ((
size_t
)0x02U)

	)

129 
	#CHUNK_MAP_STATE_MASK
 ((
size_t
)0x3U)

	)

131 
	#CHUNK_MAP_DECOMMITTED
 ((
size_t
)0x04U)

	)

132 
	#CHUNK_MAP_UNZEROED
 ((
size_t
)0x08U)

	)

133 
	#CHUNK_MAP_DIRTY
 ((
size_t
)0x10U)

	)

134 
	#CHUNK_MAP_FLAGS_MASK
 ((
size_t
)0x1cU)

	)

136 
	#CHUNK_MAP_BININD_SHIFT
 5

	)

137 
	#BININD_INVALID
 ((
size_t
)0xffU)

	)

138 
	#CHUNK_MAP_BININD_MASK
 (
BININD_INVALID
 << 
CHUNK_MAP_BININD_SHIFT
)

	)

139 
	#CHUNK_MAP_BININD_INVALID
 
CHUNK_MAP_BININD_MASK


	)

141 
	#CHUNK_MAP_RUNIND_SHIFT
 (
CHUNK_MAP_BININD_SHIFT
 + 8)

	)

142 
	#CHUNK_MAP_SIZE_SHIFT
 (
CHUNK_MAP_RUNIND_SHIFT
 - 
LG_PAGE
)

	)

143 
	#CHUNK_MAP_SIZE_MASK
 \

144 (~(
CHUNK_MAP_BININD_MASK
 | 
CHUNK_MAP_FLAGS_MASK
 | 
CHUNK_MAP_STATE_MASK
))

	)

147 
	s¬’a_runs_dœty_lšk_s
 {

148 
qr
(
¬’a_runs_dœty_lšk_t
è
	mrd_lšk
;

156 
	s¬’a_chunk_m­_misc_s
 {

164 
phn
(
¬’a_chunk_m­_misc_t
è
	mph_lšk
;

168 
¬’a_runs_dœty_lšk_t
 
	mrd
;

172 *
	m´of_tùx_pun
;

173 
´of_tùx_t
 *
	m´of_tùx
;

177 
¬’a_run_t
 
	mrun
;

180 
	$ph
(
	t¬’a_chunk_m­_misc_t
è
	t¬’a_run_h—p_t
;

183 #ifdeà
JEMALLOC_ARENA_STRUCTS_B


185 
	s¬’a_chunk_s
 {

191 
ex‹Á_node_t
 
node
;

199 
boŞ
 
hug•age
;

207 
¬’a_chunk_m­_b™s_t
 
m­_b™s
[1];

243 
	s¬’a_bš_šfo_s
 {

245 
size_t
 
»g_size
;

248 
size_t
 
»dzÚe_size
;

251 
size_t
 
»g_š‹rv®
;

254 
size_t
 
run_size
;

257 
ušt32_t
 
Äegs
;

263 
b™m­_šfo_t
 
b™m­_šfo
;

266 
ušt32_t
 
»g0_off£t
;

269 
	s¬’a_deÿy_s
 {

275 
ssize_t
 
time
;

277 
n¡ime_t
 
š‹rv®
;

285 
n¡ime_t
 
•och
;

287 
ušt64_t
 
j™‹r_¡©e
;

295 
n¡ime_t
 
d—dlše
;

302 
size_t
 
ndœty
;

309 
size_t
 
backlog
[
SMOOTHSTEP_NSTEPS
];

312 
	s¬’a_bš_s
 {

319 
m®loc_mu‹x_t
 
lock
;

325 
¬’a_run_t
 *
runcur
;

334 
¬’a_run_h—p_t
 
runs
;

337 
m®loc_bš_¡©s_t
 
¡©s
;

340 
	s¬’a_s
 {

342 
šd
;

356 
Áh»ads
[2];

365 
m®loc_mu‹x_t
 
lock
;

367 
¬’a_¡©s_t
 
¡©s
;

373 
	`ql_h—d
(
tÿche_t
è
tÿche_ql
;

375 
ušt64_t
 
´of_accumby‹s
;

381 
size_t
 
off£t_¡©e
;

383 
dss_´ec_t
 
dss_´ec
;

386 
	`ql_h—d
(
ex‹Á_node_t
è
achunks
;

389 
size_t
 
ex‹Á_¢_Ãxt
;

401 
¬’a_chunk_t
 *
¥¬e
;

404 
ssize_t
 
lg_dœty_muÉ
;

407 
boŞ
 
purgšg
;

410 
size_t
 
Çùive
;

418 
size_t
 
ndœty
;

448 
¬’a_runs_dœty_lšk_t
 
runs_dœty
;

449 
ex‹Á_node_t
 
chunks_ÿche
;

452 
¬’a_deÿy_t
 
deÿy
;

455 
	`ql_h—d
(
ex‹Á_node_t
è
huge
;

457 
m®loc_mu‹x_t
 
huge_mtx
;

466 
ex‹Á_Œ“_t
 
chunks_sz¢ad_ÿched
;

467 
ex‹Á_Œ“_t
 
chunks_ad_ÿched
;

468 
ex‹Á_Œ“_t
 
chunks_sz¢ad_»šed
;

469 
ex‹Á_Œ“_t
 
chunks_ad_»šed
;

471 
m®loc_mu‹x_t
 
chunks_mtx
;

473 
	`ql_h—d
(
ex‹Á_node_t
è
node_ÿche
;

474 
m®loc_mu‹x_t
 
node_ÿche_mtx
;

477 
chunk_hooks_t
 
chunk_hooks
;

480 
¬’a_bš_t
 
bšs
[
NBINS
];

488 
¬’a_run_h—p_t
 
runs_ava
[
NPSIZES
];

492 
	s¬’a_td©a_s
 {

493 
tick”_t
 
deÿy_tick”
;

499 #ifdeà
JEMALLOC_H_EXTERNS


501 cÚ¡ 
size_t
 
Ïrge_·d
 =

502 #ifdeà
JEMALLOC_CACHE_OBLIVIOUS


503 
PAGE


509 
purge_mode_t
 
İt_purge
;

510 cÚ¡ *
purge_mode_Çmes
[];

511 
ssize_t
 
İt_lg_dœty_muÉ
;

512 
ssize_t
 
İt_deÿy_time
;

514 
¬’a_bš_šfo_t
 
¬’a_bš_šfo
[
NBINS
];

516 
size_t
 
m­_bŸs
;

517 
size_t
 
m­_misc_off£t
;

518 
size_t
 
¬’a_maxrun
;

519 
size_t
 
Ïrge_maxşass
;

520 
Æşas£s
;

521 
nhşas£s
;

523 #ifdeà
JEMALLOC_JET


524 
	$size_t
 (
	trun_quªtize_t
)(
	tsize_t
);

525 
run_quªtize_t
 *
run_quªtize_æoÜ
;

526 
run_quªtize_t
 *
run_quªtize_û
;

528 
	`¬’a_chunk_ÿche_maybe_š£¹
(
¬’a_t
 *
¬’a
, 
ex‹Á_node_t
 *
node
,

529 
boŞ
 
ÿche
);

530 
	`¬’a_chunk_ÿche_maybe_»move
(
¬’a_t
 *
¬’a
, 
ex‹Á_node_t
 *
node
,

531 
boŞ
 
ÿche
);

532 
ex‹Á_node_t
 *
	`¬’a_node_®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

533 
	`¬’a_node_d®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
ex‹Á_node_t
 *
node
);

534 *
	`¬’a_chunk_®loc_huge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
,

535 
size_t
 
®ignm’t
, size_ˆ*
¢
, 
boŞ
 *
z”o
);

536 
	`¬’a_chunk_d®loc_huge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
chunk
,

537 
size_t
 
usize
, size_ˆ
¢
);

538 
	`¬’a_chunk_¿Îoc_huge_sim¬
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

539 *
chunk
, 
size_t
 
Şdsize
, size_ˆ
usize
);

540 
	`¬’a_chunk_¿Îoc_huge_shršk
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

541 *
chunk
, 
size_t
 
Şdsize
, size_ˆ
usize
, size_ˆ
¢
);

542 
boŞ
 
	`¬’a_chunk_¿Îoc_huge_ex·nd
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

543 *
chunk
, 
size_t
 
Şdsize
, size_ˆ
usize
, 
boŞ
 *
z”o
);

544 
ssize_t
 
	`¬’a_lg_dœty_muÉ_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

545 
boŞ
 
	`¬’a_lg_dœty_muÉ_£t
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

546 
ssize_t
 
lg_dœty_muÉ
);

547 
ssize_t
 
	`¬’a_deÿy_time_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

548 
boŞ
 
	`¬’a_deÿy_time_£t
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
ssize_t
 
deÿy_time
);

549 
	`¬’a_purge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
boŞ
 
®l
);

550 
	`¬’a_maybe_purge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

551 
	`¬’a_»£t
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
);

552 
	`¬’a_tÿche_fl_sm®l
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

553 
tÿche_bš_t
 *
tbš
, 
szšd_t
 
bššd
, 
ušt64_t
 
´of_accumby‹s
);

554 
	`¬’a_®loc_junk_sm®l
(*
±r
, 
¬’a_bš_šfo_t
 *
bš_šfo
,

555 
boŞ
 
z”o
);

556 #ifdeà
JEMALLOC_JET


557 (
	t¬’a_»dzÚe_cÜru±iÚ_t
)(*, 
	tsize_t
, 
	tboŞ
, size_t,

558 
	tušt8_t
);

559 
¬’a_»dzÚe_cÜru±iÚ_t
 *
¬’a_»dzÚe_cÜru±iÚ
;

560 (
	t¬’a_d®loc_junk_sm®l_t
)(*, 
	t¬’a_bš_šfo_t
 *);

561 
¬’a_d®loc_junk_sm®l_t
 *
¬’a_d®loc_junk_sm®l
;

563 
	`¬’a_d®loc_junk_sm®l
(*
±r
, 
¬’a_bš_šfo_t
 *
bš_šfo
);

565 
	`¬’a_qu¬ªtše_junk_sm®l
(*
±r
, 
size_t
 
usize
);

566 *
	`¬’a_m®loc_Ïrge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
szšd_t
 
šd
,

567 
boŞ
 
z”o
);

568 *
	`¬’a_m®loc_h¬d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
size
,

569 
szšd_t
 
šd
, 
boŞ
 
z”o
);

570 *
	`¬’a_·Îoc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
,

571 
size_t
 
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
);

572 
	`¬’a_´of_´omÙed
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
size
);

573 
	`¬’a_d®loc_bš_junked_locked
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

574 
¬’a_chunk_t
 *
chunk
, *
±r
, 
¬’a_chunk_m­_b™s_t
 *
b™£lm
);

575 
	`¬’a_d®loc_bš
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

576 *
±r
, 
size_t
 
·gešd
, 
¬’a_chunk_m­_b™s_t
 *
b™£lm
);

577 
	`¬’a_d®loc_sm®l
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

578 *
±r
, 
size_t
 
·gešd
);

579 #ifdeà
JEMALLOC_JET


580 (
	t¬’a_d®loc_junk_Ïrge_t
)(*, 
	tsize_t
);

581 
¬’a_d®loc_junk_Ïrge_t
 *
¬’a_d®loc_junk_Ïrge
;

583 
	`¬’a_d®loc_junk_Ïrge
(*
±r
, 
size_t
 
usize
);

585 
	`¬’a_d®loc_Ïrge_junked_locked
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

586 
¬’a_chunk_t
 *
chunk
, *
±r
);

587 
	`¬’a_d®loc_Ïrge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

588 *
±r
);

589 #ifdeà
JEMALLOC_JET


590 (
	t¬’a_¿Îoc_junk_Ïrge_t
)(*, 
	tsize_t
, size_t);

591 
¬’a_¿Îoc_junk_Ïrge_t
 *
¬’a_¿Îoc_junk_Ïrge
;

593 
boŞ
 
	`¬’a_¿Îoc_no_move
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
,

594 
size_t
 
size
, size_ˆ
exŒa
, 
boŞ
 
z”o
);

595 *
	`¬’a_¿Îoc
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, *
±r
, 
size_t
 
Şdsize
,

596 
size_t
 
size
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
);

597 
dss_´ec_t
 
	`¬’a_dss_´ec_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

598 
boŞ
 
	`¬’a_dss_´ec_£t
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
dss_´ec_t
 
dss_´ec
);

599 
ssize_t
 
	`¬’a_lg_dœty_muÉ_deçuÉ_g‘
();

600 
boŞ
 
	`¬’a_lg_dœty_muÉ_deçuÉ_£t
(
ssize_t
 
lg_dœty_muÉ
);

601 
ssize_t
 
	`¬’a_deÿy_time_deçuÉ_g‘
();

602 
boŞ
 
	`¬’a_deÿy_time_deçuÉ_£t
(
ssize_t
 
deÿy_time
);

603 
	`¬’a_basic_¡©s_m”ge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

604 *
Áh»ads
, cÚ¡ **
dss
, 
ssize_t
 *
lg_dœty_muÉ
,

605 
ssize_t
 *
deÿy_time
, 
size_t
 *
Çùive
, size_ˆ*
ndœty
);

606 
	`¬’a_¡©s_m”ge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
Áh»ads
,

607 cÚ¡ **
dss
, 
ssize_t
 *
lg_dœty_muÉ
, ssize_ˆ*
deÿy_time
,

608 
size_t
 *
Çùive
, size_ˆ*
ndœty
, 
¬’a_¡©s_t
 *
a¡©s
,

609 
m®loc_bš_¡©s_t
 *
b¡©s
, 
m®loc_Ïrge_¡©s_t
 *
l¡©s
,

610 
m®loc_huge_¡©s_t
 *
h¡©s
);

611 
	`¬’a_Áh»ads_g‘
(
¬’a_t
 *
¬’a
, 
boŞ
 
š‹º®
);

612 
	`¬’a_Áh»ads_šc
(
¬’a_t
 *
¬’a
, 
boŞ
 
š‹º®
);

613 
	`¬’a_Áh»ads_dec
(
¬’a_t
 *
¬’a
, 
boŞ
 
š‹º®
);

614 
size_t
 
	`¬’a_ex‹Á_¢_Ãxt
(
¬’a_t
 *
¬’a
);

615 
¬’a_t
 *
	`¬’a_Ãw
(
tsdn_t
 *
tsdn
, 
šd
);

616 
	`¬’a_boÙ
();

617 
	`¬’a_´efÜk0
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

618 
	`¬’a_´efÜk1
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

619 
	`¬’a_´efÜk2
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

620 
	`¬’a_´efÜk3
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

621 
	`¬’a_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

622 
	`¬’a_po¡fÜk_chd
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

626 #ifdeà
JEMALLOC_H_INLINES


628 #iâdeà
JEMALLOC_ENABLE_INLINE


629 
¬’a_chunk_m­_b™s_t
 *
	`¬’a_b™£lm_g‘_mubË
(
¬’a_chunk_t
 *
chunk
,

630 
size_t
 
·gešd
);

631 cÚ¡ 
¬’a_chunk_m­_b™s_t
 *
	`¬’a_b™£lm_g‘_cÚ¡
(

632 cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
);

633 
¬’a_chunk_m­_misc_t
 *
	`¬’a_misûlm_g‘_mubË
(
¬’a_chunk_t
 *
chunk
,

634 
size_t
 
·gešd
);

635 cÚ¡ 
¬’a_chunk_m­_misc_t
 *
	`¬’a_misûlm_g‘_cÚ¡
(

636 cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
);

637 
size_t
 
	`¬’a_misûlm_to_·gešd
(cÚ¡ 
¬’a_chunk_m­_misc_t
 *
misûlm
);

638 *
	`¬’a_misûlm_to_½ages
(cÚ¡ 
¬’a_chunk_m­_misc_t
 *
misûlm
);

639 
¬’a_chunk_m­_misc_t
 *
	`¬’a_rd_to_misûlm
(
¬’a_runs_dœty_lšk_t
 *
rd
);

640 
¬’a_chunk_m­_misc_t
 *
	`¬’a_run_to_misûlm
(
¬’a_run_t
 *
run
);

641 
size_t
 *
	`¬’a_m­b™¥_g‘_mubË
(
¬’a_chunk_t
 *
chunk
, size_ˆ
·gešd
);

642 cÚ¡ 
size_t
 *
	`¬’a_m­b™¥_g‘_cÚ¡
(cÚ¡ 
¬’a_chunk_t
 *
chunk
,

643 
size_t
 
·gešd
);

644 
size_t
 
	`¬’a_m­b™¥_»ad
(cÚ¡ size_ˆ*
m­b™¥
);

645 
size_t
 
	`¬’a_m­b™s_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, size_ˆ
·gešd
);

646 
size_t
 
	`¬’a_m­b™s_size_decode
(size_ˆ
m­b™s
);

647 
size_t
 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
,

648 
size_t
 
·gešd
);

649 
size_t
 
	`¬’a_m­b™s_Ïrge_size_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
,

650 
size_t
 
·gešd
);

651 
size_t
 
	`¬’a_m­b™s_sm®l_runšd_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
,

652 
size_t
 
·gešd
);

653 
szšd_t
 
	`¬’a_m­b™s_bššd_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
);

654 
size_t
 
	`¬’a_m­b™s_dœty_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, size_ˆ
·gešd
);

655 
size_t
 
	`¬’a_m­b™s_unz”Ûd_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, size_ˆ
·gešd
);

656 
size_t
 
	`¬’a_m­b™s_decomm™‹d_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
,

657 
size_t
 
·gešd
);

658 
size_t
 
	`¬’a_m­b™s_Ïrge_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, size_ˆ
·gešd
);

659 
size_t
 
	`¬’a_m­b™s_®loÿ‹d_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, size_ˆ
·gešd
);

660 
	`¬’a_m­b™¥_wr™e
(
size_t
 *
m­b™¥
, size_ˆ
m­b™s
);

661 
size_t
 
	`¬’a_m­b™s_size_’code
(size_ˆ
size
);

662 
	`¬’a_m­b™s_uÇÎoÿ‹d_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

663 
size_t
 
size
, size_ˆ
æags
);

664 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

665 
size_t
 
size
);

666 
	`¬’a_m­b™s_š‹º®_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

667 
size_t
 
æags
);

668 
	`¬’a_m­b™s_Ïrge_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

669 
size_t
 
size
, size_ˆ
æags
);

670 
	`¬’a_m­b™s_Ïrge_bššd_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

671 
szšd_t
 
bššd
);

672 
	`¬’a_m­b™s_sm®l_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

673 
size_t
 
runšd
, 
szšd_t
 
bššd
, size_ˆ
æags
);

674 
	`¬’a_m‘ad©a_®loÿ‹d_add
(
¬’a_t
 *
¬’a
, 
size_t
 
size
);

675 
	`¬’a_m‘ad©a_®loÿ‹d_sub
(
¬’a_t
 *
¬’a
, 
size_t
 
size
);

676 
size_t
 
	`¬’a_m‘ad©a_®loÿ‹d_g‘
(
¬’a_t
 *
¬’a
);

677 
boŞ
 
	`¬’a_´of_accum_im¶
(
¬’a_t
 *
¬’a
, 
ušt64_t
 
accumby‹s
);

678 
boŞ
 
	`¬’a_´of_accum_locked
(
¬’a_t
 *
¬’a
, 
ušt64_t
 
accumby‹s
);

679 
boŞ
 
	`¬’a_´of_accum
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
ušt64_t
 
accumby‹s
);

680 
szšd_t
 
	`¬’a_±r_sm®l_bššd_g‘
(cÚ¡ *
±r
, 
size_t
 
m­b™s
);

681 
szšd_t
 
	`¬’a_bš_šdex
(
¬’a_t
 *
¬’a
, 
¬’a_bš_t
 *
bš
);

682 
size_t
 
	`¬’a_run_»gšd
(
¬’a_run_t
 *
run
, 
¬’a_bš_šfo_t
 *
bš_šfo
,

683 cÚ¡ *
±r
);

684 
´of_tùx_t
 *
	`¬’a_´of_tùx_g‘
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
);

685 
	`¬’a_´of_tùx_£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
,

686 
´of_tùx_t
 *
tùx
);

687 
	`¬’a_´of_tùx_»£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
,

688 cÚ¡ *
Şd_±r
, 
´of_tùx_t
 *
Şd_tùx
);

689 
	`¬’a_deÿy_ticks
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
Áicks
);

690 
	`¬’a_deÿy_tick
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

691 *
	`¬’a_m®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
size
, 
szšd_t
 
šd
,

692 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
, boŞ 
¦ow_·th
);

693 
¬’a_t
 *
	`¬’a_¯Îoc
(cÚ¡ *
±r
);

694 
size_t
 
	`¬’a_§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
boŞ
 
demÙe
);

695 
	`¬’a_d®loc
(
tsdn_t
 *
tsdn
, *
±r
, 
tÿche_t
 *
tÿche
, 
boŞ
 
¦ow_·th
);

696 
	`¬’a_sd®loc
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
size
, 
tÿche_t
 *
tÿche
,

697 
boŞ
 
¦ow_·th
);

700 #ià(
	`defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_ARENA_C_
))

701 #ifdeà
JEMALLOC_ARENA_INLINE_A


702 
JEMALLOC_ALWAYS_INLINE
 
¬’a_chunk_m­_b™s_t
 *

703 
	$¬’a_b™£lm_g‘_mubË
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

706 
	`as£¹
(
·gešd
 >ğ
m­_bŸs
);

707 
	`as£¹
(
·gešd
 < 
chunk_Åages
);

709  (&
chunk
->
m­_b™s
[
·gešd
-
m­_bŸs
]);

710 
	}
}

712 
JEMALLOC_ALWAYS_INLINE
 cÚ¡ 
¬’a_chunk_m­_b™s_t
 *

713 
	$¬’a_b™£lm_g‘_cÚ¡
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

716  (
	`¬’a_b™£lm_g‘_mubË
((
¬’a_chunk_t
 *)
chunk
, 
·gešd
));

717 
	}
}

719 
JEMALLOC_ALWAYS_INLINE
 
¬’a_chunk_m­_misc_t
 *

720 
	$¬’a_misûlm_g‘_mubË
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

723 
	`as£¹
(
·gešd
 >ğ
m­_bŸs
);

724 
	`as£¹
(
·gešd
 < 
chunk_Åages
);

726  ((
¬’a_chunk_m­_misc_t
 *)((
ušŒ_t
)
chunk
 +

727 (
ušŒ_t
)
m­_misc_off£t
è+ 
·gešd
-
m­_bŸs
);

728 
	}
}

730 
JEMALLOC_ALWAYS_INLINE
 cÚ¡ 
¬’a_chunk_m­_misc_t
 *

731 
	$¬’a_misûlm_g‘_cÚ¡
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

734  (
	`¬’a_misûlm_g‘_mubË
((
¬’a_chunk_t
 *)
chunk
, 
·gešd
));

735 
	}
}

737 
JEMALLOC_ALWAYS_INLINE
 
size_t


738 
	$¬’a_misûlm_to_·gešd
(cÚ¡ 
¬’a_chunk_m­_misc_t
 *
misûlm
)

740 
¬’a_chunk_t
 *
chunk
 = (¬’a_chunk_ˆ*)
	`CHUNK_ADDR2BASE
(
misûlm
);

741 
size_t
 
·gešd
 = ((
ušŒ_t
)
misûlm
 - ((ušŒ_t)
chunk
 +

742 
m­_misc_off£t
)è/ (
¬’a_chunk_m­_misc_t
è+ 
m­_bŸs
;

744 
	`as£¹
(
·gešd
 >ğ
m­_bŸs
);

745 
	`as£¹
(
·gešd
 < 
chunk_Åages
);

747  (
·gešd
);

748 
	}
}

750 
JEMALLOC_ALWAYS_INLINE
 *

751 
	$¬’a_misûlm_to_½ages
(cÚ¡ 
¬’a_chunk_m­_misc_t
 *
misûlm
)

753 
¬’a_chunk_t
 *
chunk
 = (¬’a_chunk_ˆ*)
	`CHUNK_ADDR2BASE
(
misûlm
);

754 
size_t
 
·gešd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

756  ((*)((
ušŒ_t
)
chunk
 + (
·gešd
 << 
LG_PAGE
)));

757 
	}
}

759 
JEMALLOC_ALWAYS_INLINE
 
¬’a_chunk_m­_misc_t
 *

760 
	$¬’a_rd_to_misûlm
(
¬’a_runs_dœty_lšk_t
 *
rd
)

762 
¬’a_chunk_m­_misc_t
 *
misûlm
 = (arena_chunk_map_misc_t

763 *)((
ušŒ_t
)
rd
 - 
	`off£tof
(
¬’a_chunk_m­_misc_t
,„d));

765 
	`as£¹
(
	`¬’a_misûlm_to_·gešd
(
misûlm
è>ğ
m­_bŸs
);

766 
	`as£¹
(
	`¬’a_misûlm_to_·gešd
(
misûlm
è< 
chunk_Åages
);

768  (
misûlm
);

769 
	}
}

771 
JEMALLOC_ALWAYS_INLINE
 
¬’a_chunk_m­_misc_t
 *

772 
	$¬’a_run_to_misûlm
(
¬’a_run_t
 *
run
)

774 
¬’a_chunk_m­_misc_t
 *
misûlm
 = (arena_chunk_map_misc_t

775 *)((
ušŒ_t
)
run
 - 
	`off£tof
(
¬’a_chunk_m­_misc_t
,„un));

777 
	`as£¹
(
	`¬’a_misûlm_to_·gešd
(
misûlm
è>ğ
m­_bŸs
);

778 
	`as£¹
(
	`¬’a_misûlm_to_·gešd
(
misûlm
è< 
chunk_Åages
);

780  (
misûlm
);

781 
	}
}

783 
JEMALLOC_ALWAYS_INLINE
 
size_t
 *

784 
	$¬’a_m­b™¥_g‘_mubË
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

787  (&
	`¬’a_b™£lm_g‘_mubË
(
chunk
, 
·gešd
)->
b™s
);

788 
	}
}

790 
JEMALLOC_ALWAYS_INLINE
 cÚ¡ 
size_t
 *

791 
	$¬’a_m­b™¥_g‘_cÚ¡
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

794  (
	`¬’a_m­b™¥_g‘_mubË
((
¬’a_chunk_t
 *)
chunk
, 
·gešd
));

795 
	}
}

797 
JEMALLOC_ALWAYS_INLINE
 
size_t


798 
	$¬’a_m­b™¥_»ad
(cÚ¡ 
size_t
 *
m­b™¥
)

801  (*
m­b™¥
);

802 
	}
}

804 
JEMALLOC_ALWAYS_INLINE
 
size_t


805 
	$¬’a_m­b™s_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

808  (
	`¬’a_m­b™¥_»ad
(
	`¬’a_m­b™¥_g‘_cÚ¡
(
chunk
, 
·gešd
)));

809 
	}
}

811 
JEMALLOC_ALWAYS_INLINE
 
size_t


812 
	$¬’a_m­b™s_size_decode
(
size_t
 
m­b™s
)

814 
size_t
 
size
;

816 #ià
CHUNK_MAP_SIZE_SHIFT
 > 0

817 
size
 = (
m­b™s
 & 
CHUNK_MAP_SIZE_MASK
è>> 
CHUNK_MAP_SIZE_SHIFT
;

818 #–ià
CHUNK_MAP_SIZE_SHIFT
 == 0

819 
size
 = 
m­b™s
 & 
CHUNK_MAP_SIZE_MASK
;

821 
size
 = (
m­b™s
 & 
CHUNK_MAP_SIZE_MASK
è<< -
CHUNK_MAP_SIZE_SHIFT
;

824  (
size
);

825 
	}
}

827 
JEMALLOC_ALWAYS_INLINE
 
size_t


828 
	$¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

830 
size_t
 
m­b™s
;

832 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

833 
	`as£¹
((
m­b™s
 & (
CHUNK_MAP_LARGE
|
CHUNK_MAP_ALLOCATED
)) == 0);

834  (
	`¬’a_m­b™s_size_decode
(
m­b™s
));

835 
	}
}

837 
JEMALLOC_ALWAYS_INLINE
 
size_t


838 
	$¬’a_m­b™s_Ïrge_size_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

840 
size_t
 
m­b™s
;

842 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

843 
	`as£¹
((
m­b™s
 & (
CHUNK_MAP_LARGE
|
CHUNK_MAP_ALLOCATED
)) ==

844 (
CHUNK_MAP_LARGE
|
CHUNK_MAP_ALLOCATED
));

845  (
	`¬’a_m­b™s_size_decode
(
m­b™s
));

846 
	}
}

848 
JEMALLOC_ALWAYS_INLINE
 
size_t


849 
	$¬’a_m­b™s_sm®l_runšd_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

851 
size_t
 
m­b™s
;

853 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

854 
	`as£¹
((
m­b™s
 & (
CHUNK_MAP_LARGE
|
CHUNK_MAP_ALLOCATED
)) ==

855 
CHUNK_MAP_ALLOCATED
);

856  (
m­b™s
 >> 
CHUNK_MAP_RUNIND_SHIFT
);

857 
	}
}

859 
JEMALLOC_ALWAYS_INLINE
 
szšd_t


860 
	$¬’a_m­b™s_bššd_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

862 
size_t
 
m­b™s
;

863 
szšd_t
 
bššd
;

865 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

866 
bššd
 = (
m­b™s
 & 
CHUNK_MAP_BININD_MASK
è>> 
CHUNK_MAP_BININD_SHIFT
;

867 
	`as£¹
(
bššd
 < 
NBINS
 || bššd =ğ
BININD_INVALID
);

868  (
bššd
);

869 
	}
}

871 
JEMALLOC_ALWAYS_INLINE
 
size_t


872 
	$¬’a_m­b™s_dœty_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

874 
size_t
 
m­b™s
;

876 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

877 
	`as£¹
((
m­b™s
 & 
CHUNK_MAP_DECOMMITTED
) == 0 || (mapbits &

878 (
CHUNK_MAP_DIRTY
|
CHUNK_MAP_UNZEROED
)) == 0);

879  (
m­b™s
 & 
CHUNK_MAP_DIRTY
);

880 
	}
}

882 
JEMALLOC_ALWAYS_INLINE
 
size_t


883 
	$¬’a_m­b™s_unz”Ûd_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

885 
size_t
 
m­b™s
;

887 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

888 
	`as£¹
((
m­b™s
 & 
CHUNK_MAP_DECOMMITTED
) == 0 || (mapbits &

889 (
CHUNK_MAP_DIRTY
|
CHUNK_MAP_UNZEROED
)) == 0);

890  (
m­b™s
 & 
CHUNK_MAP_UNZEROED
);

891 
	}
}

893 
JEMALLOC_ALWAYS_INLINE
 
size_t


894 
	$¬’a_m­b™s_decomm™‹d_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

896 
size_t
 
m­b™s
;

898 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

899 
	`as£¹
((
m­b™s
 & 
CHUNK_MAP_DECOMMITTED
) == 0 || (mapbits &

900 (
CHUNK_MAP_DIRTY
|
CHUNK_MAP_UNZEROED
)) == 0);

901  (
m­b™s
 & 
CHUNK_MAP_DECOMMITTED
);

902 
	}
}

904 
JEMALLOC_ALWAYS_INLINE
 
size_t


905 
	$¬’a_m­b™s_Ïrge_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

907 
size_t
 
m­b™s
;

909 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

910  (
m­b™s
 & 
CHUNK_MAP_LARGE
);

911 
	}
}

913 
JEMALLOC_ALWAYS_INLINE
 
size_t


914 
	$¬’a_m­b™s_®loÿ‹d_g‘
(cÚ¡ 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
)

916 
size_t
 
m­b™s
;

918 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

919  (
m­b™s
 & 
CHUNK_MAP_ALLOCATED
);

920 
	}
}

922 
JEMALLOC_ALWAYS_INLINE
 

923 
	$¬’a_m­b™¥_wr™e
(
size_t
 *
m­b™¥
, size_ˆ
m­b™s
)

926 *
m­b™¥
 = 
m­b™s
;

927 
	}
}

929 
JEMALLOC_ALWAYS_INLINE
 
size_t


930 
	$¬’a_m­b™s_size_’code
(
size_t
 
size
)

932 
size_t
 
m­b™s
;

934 #ià
CHUNK_MAP_SIZE_SHIFT
 > 0

935 
m­b™s
 = 
size
 << 
CHUNK_MAP_SIZE_SHIFT
;

936 #–ià
CHUNK_MAP_SIZE_SHIFT
 == 0

937 
m­b™s
 = 
size
;

939 
m­b™s
 = 
size
 >> -
CHUNK_MAP_SIZE_SHIFT
;

942 
	`as£¹
((
m­b™s
 & ~
CHUNK_MAP_SIZE_MASK
) == 0);

943  (
m­b™s
);

944 
	}
}

946 
JEMALLOC_ALWAYS_INLINE
 

947 
	$¬’a_m­b™s_uÇÎoÿ‹d_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
, size_ˆ
size
,

948 
size_t
 
æags
)

950 
size_t
 *
m­b™¥
 = 
	`¬’a_m­b™¥_g‘_mubË
(
chunk
, 
·gešd
);

952 
	`as£¹
((
size
 & 
PAGE_MASK
) == 0);

953 
	`as£¹
((
æags
 & 
CHUNK_MAP_FLAGS_MASK
) == flags);

954 
	`as£¹
((
æags
 & 
CHUNK_MAP_DECOMMITTED
) == 0 || (flags &

955 (
CHUNK_MAP_DIRTY
|
CHUNK_MAP_UNZEROED
)) == 0);

956 
	`¬’a_m­b™¥_wr™e
(
m­b™¥
, 
	`¬’a_m­b™s_size_’code
(
size
) |

957 
CHUNK_MAP_BININD_INVALID
 | 
æags
);

958 
	}
}

960 
JEMALLOC_ALWAYS_INLINE
 

961 
	$¬’a_m­b™s_uÇÎoÿ‹d_size_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

962 
size_t
 
size
)

964 
size_t
 *
m­b™¥
 = 
	`¬’a_m­b™¥_g‘_mubË
(
chunk
, 
·gešd
);

965 
size_t
 
m­b™s
 = 
	`¬’a_m­b™¥_»ad
(
m­b™¥
);

967 
	`as£¹
((
size
 & 
PAGE_MASK
) == 0);

968 
	`as£¹
((
m­b™s
 & (
CHUNK_MAP_LARGE
|
CHUNK_MAP_ALLOCATED
)) == 0);

969 
	`¬’a_m­b™¥_wr™e
(
m­b™¥
, 
	`¬’a_m­b™s_size_’code
(
size
) |

970 (
m­b™s
 & ~
CHUNK_MAP_SIZE_MASK
));

971 
	}
}

973 
JEMALLOC_ALWAYS_INLINE
 

974 
	$¬’a_m­b™s_š‹º®_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
, size_ˆ
æags
)

976 
size_t
 *
m­b™¥
 = 
	`¬’a_m­b™¥_g‘_mubË
(
chunk
, 
·gešd
);

978 
	`as£¹
((
æags
 & 
CHUNK_MAP_UNZEROED
) == flags);

979 
	`¬’a_m­b™¥_wr™e
(
m­b™¥
, 
æags
);

980 
	}
}

982 
JEMALLOC_ALWAYS_INLINE
 

983 
	$¬’a_m­b™s_Ïrge_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
, size_ˆ
size
,

984 
size_t
 
æags
)

986 
size_t
 *
m­b™¥
 = 
	`¬’a_m­b™¥_g‘_mubË
(
chunk
, 
·gešd
);

988 
	`as£¹
((
size
 & 
PAGE_MASK
) == 0);

989 
	`as£¹
((
æags
 & 
CHUNK_MAP_FLAGS_MASK
) == flags);

990 
	`as£¹
((
æags
 & 
CHUNK_MAP_DECOMMITTED
) == 0 || (flags &

991 (
CHUNK_MAP_DIRTY
|
CHUNK_MAP_UNZEROED
)) == 0);

992 
	`¬’a_m­b™¥_wr™e
(
m­b™¥
, 
	`¬’a_m­b™s_size_’code
(
size
) |

993 
CHUNK_MAP_BININD_INVALID
 | 
æags
 | 
CHUNK_MAP_LARGE
 |

994 
CHUNK_MAP_ALLOCATED
);

995 
	}
}

997 
JEMALLOC_ALWAYS_INLINE
 

998 
	$¬’a_m­b™s_Ïrge_bššd_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

999 
szšd_t
 
bššd
)

1001 
size_t
 *
m­b™¥
 = 
	`¬’a_m­b™¥_g‘_mubË
(
chunk
, 
·gešd
);

1002 
size_t
 
m­b™s
 = 
	`¬’a_m­b™¥_»ad
(
m­b™¥
);

1004 
	`as£¹
(
bššd
 <ğ
BININD_INVALID
);

1005 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
, 
·gešd
è=ğ
LARGE_MINCLASS
 +

1006 
Ïrge_·d
);

1007 
	`¬’a_m­b™¥_wr™e
(
m­b™¥
, (
m­b™s
 & ~
CHUNK_MAP_BININD_MASK
) |

1008 (
bššd
 << 
CHUNK_MAP_BININD_SHIFT
));

1009 
	}
}

1011 
JEMALLOC_ALWAYS_INLINE
 

1012 
	$¬’a_m­b™s_sm®l_£t
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
, size_ˆ
runšd
,

1013 
szšd_t
 
bššd
, 
size_t
 
æags
)

1015 
size_t
 *
m­b™¥
 = 
	`¬’a_m­b™¥_g‘_mubË
(
chunk
, 
·gešd
);

1017 
	`as£¹
(
bššd
 < 
BININD_INVALID
);

1018 
	`as£¹
(
·gešd
 - 
runšd
 >ğ
m­_bŸs
);

1019 
	`as£¹
((
æags
 & 
CHUNK_MAP_UNZEROED
) == flags);

1020 
	`¬’a_m­b™¥_wr™e
(
m­b™¥
, (
runšd
 << 
CHUNK_MAP_RUNIND_SHIFT
) |

1021 (
bššd
 << 
CHUNK_MAP_BININD_SHIFT
è| 
æags
 | 
CHUNK_MAP_ALLOCATED
);

1022 
	}
}

1024 
JEMALLOC_INLINE
 

1025 
	$¬’a_m‘ad©a_®loÿ‹d_add
(
¬’a_t
 *
¬’a
, 
size_t
 
size
)

1028 
	`©omic_add_z
(&
¬’a
->
¡©s
.
m‘ad©a_®loÿ‹d
, 
size
);

1029 
	}
}

1031 
JEMALLOC_INLINE
 

1032 
	$¬’a_m‘ad©a_®loÿ‹d_sub
(
¬’a_t
 *
¬’a
, 
size_t
 
size
)

1035 
	`©omic_sub_z
(&
¬’a
->
¡©s
.
m‘ad©a_®loÿ‹d
, 
size
);

1036 
	}
}

1038 
JEMALLOC_INLINE
 
size_t


1039 
	$¬’a_m‘ad©a_®loÿ‹d_g‘
(
¬’a_t
 *
¬’a
)

1042  (
	`©omic_»ad_z
(&
¬’a
->
¡©s
.
m‘ad©a_®loÿ‹d
));

1043 
	}
}

1045 
JEMALLOC_INLINE
 
boŞ


1046 
	$¬’a_´of_accum_im¶
(
¬’a_t
 *
¬’a
, 
ušt64_t
 
accumby‹s
)

1049 
	`ÿs£¹
(
cÚfig_´of
);

1050 
	`as£¹
(
´of_š‹rv®
 != 0);

1052 
¬’a
->
´of_accumby‹s
 +ğ
accumby‹s
;

1053 ià(
¬’a
->
´of_accumby‹s
 >ğ
´of_š‹rv®
) {

1054 
¬’a
->
´of_accumby‹s
 -ğ
´of_š‹rv®
;

1055  (
Œue
);

1057  (
çl£
);

1058 
	}
}

1060 
JEMALLOC_INLINE
 
boŞ


1061 
	$¬’a_´of_accum_locked
(
¬’a_t
 *
¬’a
, 
ušt64_t
 
accumby‹s
)

1064 
	`ÿs£¹
(
cÚfig_´of
);

1066 ià(
	`lik–y
(
´of_š‹rv®
 == 0))

1067  (
çl£
);

1068  (
	`¬’a_´of_accum_im¶
(
¬’a
, 
accumby‹s
));

1069 
	}
}

1071 
JEMALLOC_INLINE
 
boŞ


1072 
	$¬’a_´of_accum
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
ušt64_t
 
accumby‹s
)

1075 
	`ÿs£¹
(
cÚfig_´of
);

1077 ià(
	`lik–y
(
´of_š‹rv®
 == 0))

1078  (
çl£
);

1081 
boŞ
 
»t
;

1083 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1084 
»t
 = 
	`¬’a_´of_accum_im¶
(
¬’a
, 
accumby‹s
);

1085 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1086  (
»t
);

1088 
	}
}

1090 
JEMALLOC_ALWAYS_INLINE
 
szšd_t


1091 
	$¬’a_±r_sm®l_bššd_g‘
(cÚ¡ *
±r
, 
size_t
 
m­b™s
)

1093 
szšd_t
 
bššd
;

1095 
bššd
 = (
m­b™s
 & 
CHUNK_MAP_BININD_MASK
è>> 
CHUNK_MAP_BININD_SHIFT
;

1097 ià(
cÚfig_debug
) {

1098 
¬’a_chunk_t
 *
chunk
;

1099 
¬’a_t
 *
¬’a
;

1100 
size_t
 
·gešd
;

1101 
size_t
 
aùu®_m­b™s
;

1102 
size_t
 
½ages_šd
;

1103 cÚ¡ 
¬’a_run_t
 *
run
;

1104 
¬’a_bš_t
 *
bš
;

1105 
szšd_t
 
run_bššd
, 
aùu®_bššd
;

1106 
¬’a_bš_šfo_t
 *
bš_šfo
;

1107 cÚ¡ 
¬’a_chunk_m­_misc_t
 *
misûlm
;

1108 cÚ¡ *
½ages
;

1110 
	`as£¹
(
bššd
 !ğ
BININD_INVALID
);

1111 
	`as£¹
(
bššd
 < 
NBINS
);

1112 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

1113 
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
);

1114 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

1115 
aùu®_m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

1116 
	`as£¹
(
m­b™s
 =ğ
aùu®_m­b™s
);

1117 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
·gešd
) == 0);

1118 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
·gešd
) != 0);

1119 
½ages_šd
 = 
·gešd
 - 
	`¬’a_m­b™s_sm®l_runšd_g‘
(
chunk
,

1120 
·gešd
);

1121 
misûlm
 = 
	`¬’a_misûlm_g‘_cÚ¡
(
chunk
, 
½ages_šd
);

1122 
run
 = &
misûlm
->run;

1123 
run_bššd
 = 
run
->
bššd
;

1124 
bš
 = &
¬’a
->
bšs
[
run_bššd
];

1125 
aùu®_bššd
 = (
szšd_t
)(
bš
 - 
¬’a
->
bšs
);

1126 
	`as£¹
(
run_bššd
 =ğ
aùu®_bššd
);

1127 
bš_šfo
 = &
¬’a_bš_šfo
[
aùu®_bššd
];

1128 
½ages
 = 
	`¬’a_misûlm_to_½ages
(
misûlm
);

1129 
	`as£¹
(((
ušŒ_t
)
±r
 - ((ušŒ_t)
½ages
 +

1130 (
ušŒ_t
)
bš_šfo
->
»g0_off£t
)è% bš_šfo->
»g_š‹rv®


1134  (
bššd
);

1135 
	}
}

1138 #ifdeà
JEMALLOC_ARENA_INLINE_B


1139 
JEMALLOC_INLINE
 
szšd_t


1140 
	$¬’a_bš_šdex
(
¬’a_t
 *
¬’a
, 
¬’a_bš_t
 *
bš
)

1142 
szšd_t
 
bššd
 = (szšd_t)(
bš
 - 
¬’a
->
bšs
);

1143 
	`as£¹
(
bššd
 < 
NBINS
);

1144  (
bššd
);

1145 
	}
}

1147 
JEMALLOC_INLINE
 
size_t


1148 
	$¬’a_run_»gšd
(
¬’a_run_t
 *
run
, 
¬’a_bš_šfo_t
 *
bš_šfo
, cÚ¡ *
±r
)

1150 
size_t
 
diff
, 
š‹rv®
, 
shiá
, 
»gšd
;

1151 
¬’a_chunk_m­_misc_t
 *
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

1152 *
½ages
 = 
	`¬’a_misûlm_to_½ages
(
misûlm
);

1158 
	`as£¹
((
ušŒ_t
)
±r
 >ğ(ušŒ_t)
½ages
 +

1159 (
ušŒ_t
)
bš_šfo
->
»g0_off£t
);

1165 
diff
 = (
size_t
)((
ušŒ_t
)
±r
 - (ušŒ_t)
½ages
 -

1166 
bš_šfo
->
»g0_off£t
);

1169 
š‹rv®
 = 
bš_šfo
->
»g_š‹rv®
;

1170 
shiá
 = 
	`ffs_zu
(
š‹rv®
) - 1;

1171 
diff
 >>ğ
shiá
;

1172 
š‹rv®
 >>ğ
shiá
;

1174 ià(
š‹rv®
 == 1) {

1176 
»gšd
 = 
diff
;

1192 
	#SIZE_INV_SHIFT
 (((
size_t
è<< 3è- 
LG_RUN_MAXREGS
)

	)

1193 
	#SIZE_INV
(
s
è(((
	`ZU
(1è<< 
SIZE_INV_SHIFT
è/ (s)è+ 1)

	)

1194 cÚ¡ 
size_t
 
š‹rv®_švs
[] = {

1195 
	`SIZE_INV
(3),

1196 
	`SIZE_INV
(4), SIZE_INV(5), SIZE_INV(6), SIZE_INV(7),

1197 
	`SIZE_INV
(8), SIZE_INV(9), SIZE_INV(10), SIZE_INV(11),

1198 
	`SIZE_INV
(12), SIZE_INV(13), SIZE_INV(14), SIZE_INV(15),

1199 
	`SIZE_INV
(16), SIZE_INV(17), SIZE_INV(18), SIZE_INV(19),

1200 
	`SIZE_INV
(20), SIZE_INV(21), SIZE_INV(22), SIZE_INV(23),

1201 
	`SIZE_INV
(24), SIZE_INV(25), SIZE_INV(26), SIZE_INV(27),

1202 
	`SIZE_INV
(28), SIZE_INV(29), SIZE_INV(30), SIZE_INV(31)

1205 ià(
	`lik–y
(
š‹rv®
 <ğ(((
š‹rv®_švs
è/ (
size_t
))

1207 
»gšd
 = (
diff
 * 
š‹rv®_švs
[
š‹rv®
 - 3]) >>

1208 
SIZE_INV_SHIFT
;

1210 
»gšd
 = 
diff
 / 
š‹rv®
;

1211 #undeà
SIZE_INV


1212 #undeà
SIZE_INV_SHIFT


1214 
	`as£¹
(
diff
 =ğ
»gšd
 * 
š‹rv®
);

1215 
	`as£¹
(
»gšd
 < 
bš_šfo
->
Äegs
);

1217  (
»gšd
);

1218 
	}
}

1220 
JEMALLOC_INLINE
 
´of_tùx_t
 *

1221 
	$¬’a_´of_tùx_g‘
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
)

1223 
´of_tùx_t
 *
»t
;

1224 
¬’a_chunk_t
 *
chunk
;

1226 
	`ÿs£¹
(
cÚfig_´of
);

1227 
	`as£¹
(
±r
 !ğ
NULL
);

1229 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

1230 ià(
	`lik–y
(
chunk
 !ğ
±r
)) {

1231 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

1232 
size_t
 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

1233 
	`as£¹
((
m­b™s
 & 
CHUNK_MAP_ALLOCATED
) != 0);

1234 ià(
	`lik–y
((
m­b™s
 & 
CHUNK_MAP_LARGE
) == 0))

1235 
»t
 = (
´of_tùx_t
 *)(
ušŒ_t
)1U;

1237 
¬’a_chunk_m­_misc_t
 *
–m
 =

1238 
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
·gešd
);

1239 
»t
 = 
	`©omic_»ad_p
(&
–m
->
´of_tùx_pun
);

1242 
»t
 = 
	`huge_´of_tùx_g‘
(
tsdn
, 
±r
);

1244  (
»t
);

1245 
	}
}

1247 
JEMALLOC_INLINE
 

1248 
	$¬’a_´of_tùx_£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
,

1249 
´of_tùx_t
 *
tùx
)

1251 
¬’a_chunk_t
 *
chunk
;

1253 
	`ÿs£¹
(
cÚfig_´of
);

1254 
	`as£¹
(
±r
 !ğ
NULL
);

1256 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

1257 ià(
	`lik–y
(
chunk
 !ğ
±r
)) {

1258 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

1260 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
·gešd
) != 0);

1262 ià(
	`uÆik–y
(
usize
 > 
SMALL_MAXCLASS
 || (
ušŒ_t
)
tùx
 >

1263 (
ušŒ_t
)1U)) {

1264 
¬’a_chunk_m­_misc_t
 *
–m
;

1266 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
·gešd
) != 0);

1268 
–m
 = 
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
·gešd
);

1269 
	`©omic_wr™e_p
(&
–m
->
´of_tùx_pun
, 
tùx
);

1277 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
·gešd
) == 0);

1280 
	`huge_´of_tùx_£t
(
tsdn
, 
±r
, 
tùx
);

1281 
	}
}

1283 
JEMALLOC_INLINE
 

1284 
	$¬’a_´of_tùx_»£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
,

1285 cÚ¡ *
Şd_±r
, 
´of_tùx_t
 *
Şd_tùx
)

1288 
	`ÿs£¹
(
cÚfig_´of
);

1289 
	`as£¹
(
±r
 !ğ
NULL
);

1291 ià(
	`uÆik–y
(
usize
 > 
SMALL_MAXCLASS
 || (
±r
 =ğ
Şd_±r
 &&

1292 (
ušŒ_t
)
Şd_tùx
 > (uintptr_t)1U))) {

1293 
¬’a_chunk_t
 *
chunk
 = (¬’a_chunk_ˆ*)
	`CHUNK_ADDR2BASE
(
±r
);

1294 ià(
	`lik–y
(
chunk
 !ğ
±r
)) {

1295 
size_t
 
·gešd
;

1296 
¬’a_chunk_m­_misc_t
 *
–m
;

1298 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
) >>

1299 
LG_PAGE
;

1300 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
·gešd
) !=

1302 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
·gešd
) != 0);

1304 
–m
 = 
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
·gešd
);

1305 
	`©omic_wr™e_p
(&
–m
->
´of_tùx_pun
,

1306 (
´of_tùx_t
 *)(
ušŒ_t
)1U);

1308 
	`huge_´of_tùx_»£t
(
tsdn
, 
±r
);

1310 
	}
}

1312 
JEMALLOC_ALWAYS_INLINE
 

1313 
	$¬’a_deÿy_ticks
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
Áicks
)

1315 
tsd_t
 *
tsd
;

1316 
tick”_t
 *
deÿy_tick”
;

1318 ià(
	`uÆik–y
(
	`tsdn_nuÎ
(
tsdn
)))

1320 
tsd
 = 
	`tsdn_tsd
(
tsdn
);

1321 
deÿy_tick”
 = 
	`deÿy_tick”_g‘
(
tsd
, 
¬’a
->
šd
);

1322 ià(
	`uÆik–y
(
deÿy_tick”
 =ğ
NULL
))

1324 ià(
	`uÆik–y
(
	`tick”_ticks
(
deÿy_tick”
, 
Áicks
)))

1325 
	`¬’a_purge
(
tsdn
, 
¬’a
, 
çl£
);

1326 
	}
}

1328 
JEMALLOC_ALWAYS_INLINE
 

1329 
	$¬’a_deÿy_tick
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

1332 
	`¬’a_deÿy_ticks
(
tsdn
, 
¬’a
, 1);

1333 
	}
}

1335 
JEMALLOC_ALWAYS_INLINE
 *

1336 
	$¬’a_m®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
size
, 
szšd_t
 
šd
, 
boŞ
 
z”o
,

1337 
tÿche_t
 *
tÿche
, 
boŞ
 
¦ow_·th
)

1340 
	`as£¹
(!
	`tsdn_nuÎ
(
tsdn
è|| 
tÿche
 =ğ
NULL
);

1341 
	`as£¹
(
size
 != 0);

1343 ià(
	`lik–y
(
tÿche
 !ğ
NULL
)) {

1344 ià(
	`lik–y
(
size
 <ğ
SMALL_MAXCLASS
)) {

1345  (
	`tÿche_®loc_sm®l
(
	`tsdn_tsd
(
tsdn
), 
¬’a
,

1346 
tÿche
, 
size
, 
šd
, 
z”o
, 
¦ow_·th
));

1348 ià(
	`lik–y
(
size
 <ğ
tÿche_maxşass
)) {

1349  (
	`tÿche_®loc_Ïrge
(
	`tsdn_tsd
(
tsdn
), 
¬’a
,

1350 
tÿche
, 
size
, 
šd
, 
z”o
, 
¦ow_·th
));

1353 
	`as£¹
(
size
 > 
tÿche_maxşass
);

1356  (
	`¬’a_m®loc_h¬d
(
tsdn
, 
¬’a
, 
size
, 
šd
, 
z”o
));

1357 
	}
}

1359 
JEMALLOC_ALWAYS_INLINE
 
¬’a_t
 *

1360 
	$¬’a_¯Îoc
(cÚ¡ *
±r
)

1362 
¬’a_chunk_t
 *
chunk
;

1364 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

1365 ià(
	`lik–y
(
chunk
 !ğ
±r
))

1366  (
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
));

1368  (
	`huge_¯Îoc
(
±r
));

1369 
	}
}

1372 
JEMALLOC_ALWAYS_INLINE
 
size_t


1373 
	$¬’a_§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
boŞ
 
demÙe
)

1375 
size_t
 
»t
;

1376 
¬’a_chunk_t
 *
chunk
;

1377 
size_t
 
·gešd
;

1378 
szšd_t
 
bššd
;

1380 
	`as£¹
(
±r
 !ğ
NULL
);

1382 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

1383 ià(
	`lik–y
(
chunk
 !ğ
±r
)) {

1384 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

1385 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
·gešd
) != 0);

1386 
bššd
 = 
	`¬’a_m­b™s_bššd_g‘
(
chunk
, 
·gešd
);

1387 ià(
	`uÆik–y
(
bššd
 =ğ
BININD_INVALID
 || (
cÚfig_´of
 && !
demÙe


1388 && 
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
·gešd
) != 0))) {

1395 
	`as£¹
(
cÚfig_ÿche_oblivious
 || ((
ušŒ_t
)
±r
 &

1396 
PAGE_MASK
) == 0);

1397 
»t
 = 
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
, 
·gešd
) -

1398 
Ïrge_·d
;

1399 
	`as£¹
(
»t
 != 0);

1400 
	`as£¹
(
·gešd
 + ((
»t
+
Ïrge_·d
)>>
LG_PAGE
) <=

1401 
chunk_Åages
);

1402 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
) ==

1403 
	`¬’a_m­b™s_dœty_g‘
(
chunk
,

1404 
·gešd
+((
»t
+
Ïrge_·d
)>>
LG_PAGE
)-1));

1410 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
·gešd
) != 0 ||

1411 
	`¬’a_±r_sm®l_bššd_g‘
(
±r
,

1412 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
)è=ğ
bššd
);

1413 
»t
 = 
	`šdex2size
(
bššd
);

1416 
»t
 = 
	`huge_§Îoc
(
tsdn
, 
±r
);

1418  (
»t
);

1419 
	}
}

1421 
JEMALLOC_ALWAYS_INLINE
 

1422 
	$¬’a_d®loc
(
tsdn_t
 *
tsdn
, *
±r
, 
tÿche_t
 *
tÿche
, 
boŞ
 
¦ow_·th
)

1424 
¬’a_chunk_t
 *
chunk
;

1425 
size_t
 
·gešd
, 
m­b™s
;

1427 
	`as£¹
(!
	`tsdn_nuÎ
(
tsdn
è|| 
tÿche
 =ğ
NULL
);

1428 
	`as£¹
(
±r
 !ğ
NULL
);

1430 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

1431 ià(
	`lik–y
(
chunk
 !ğ
±r
)) {

1432 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

1433 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

1434 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
·gešd
) != 0);

1435 ià(
	`lik–y
((
m­b™s
 & 
CHUNK_MAP_LARGE
) == 0)) {

1437 ià(
	`lik–y
(
tÿche
 !ğ
NULL
)) {

1438 
szšd_t
 
bššd
 = 
	`¬’a_±r_sm®l_bššd_g‘
(
±r
,

1439 
m­b™s
);

1440 
	`tÿche_d®loc_sm®l
(
	`tsdn_tsd
(
tsdn
), 
tÿche
, 
±r
,

1441 
bššd
, 
¦ow_·th
);

1443 
	`¬’a_d®loc_sm®l
(
tsdn
,

1444 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
), chunk,

1445 
±r
, 
·gešd
);

1448 
size_t
 
size
 = 
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
,

1449 
·gešd
);

1451 
	`as£¹
(
cÚfig_ÿche_oblivious
 || ((
ušŒ_t
)
±r
 &

1452 
PAGE_MASK
) == 0);

1454 ià(
	`lik–y
(
tÿche
 !ğ
NULL
è&& 
size
 - 
Ïrge_·d
 <=

1455 
tÿche_maxşass
) {

1456 
	`tÿche_d®loc_Ïrge
(
	`tsdn_tsd
(
tsdn
), 
tÿche
, 
±r
,

1457 
size
 - 
Ïrge_·d
, 
¦ow_·th
);

1459 
	`¬’a_d®loc_Ïrge
(
tsdn
,

1460 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
), chunk,

1461 
±r
);

1465 
	`huge_d®loc
(
tsdn
, 
±r
);

1466 
	}
}

1468 
JEMALLOC_ALWAYS_INLINE
 

1469 
	$¬’a_sd®loc
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
size
, 
tÿche_t
 *
tÿche
,

1470 
boŞ
 
¦ow_·th
)

1472 
¬’a_chunk_t
 *
chunk
;

1474 
	`as£¹
(!
	`tsdn_nuÎ
(
tsdn
è|| 
tÿche
 =ğ
NULL
);

1476 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

1477 ià(
	`lik–y
(
chunk
 !ğ
±r
)) {

1478 ià(
cÚfig_´of
 && 
İt_´of
) {

1479 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
) >>

1480 
LG_PAGE
;

1481 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
·gešd
) !=

1483 ià(
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
·gešd
) != 0) {

1488 
size
 = 
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
,

1489 
·gešd
è- 
Ïrge_·d
;

1492 
	`as£¹
(
	`s2u
(
size
è=ğs2u(
	`¬’a_§Îoc
(
tsdn
, 
±r
, 
çl£
)));

1494 ià(
	`lik–y
(
size
 <ğ
SMALL_MAXCLASS
)) {

1496 ià(
	`lik–y
(
tÿche
 !ğ
NULL
)) {

1497 
szšd_t
 
bššd
 = 
	`size2šdex
(
size
);

1498 
	`tÿche_d®loc_sm®l
(
	`tsdn_tsd
(
tsdn
), 
tÿche
, 
±r
,

1499 
bššd
, 
¦ow_·th
);

1501 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 -

1502 (
ušŒ_t
)
chunk
è>> 
LG_PAGE
;

1503 
	`¬’a_d®loc_sm®l
(
tsdn
,

1504 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
), chunk,

1505 
±r
, 
·gešd
);

1508 
	`as£¹
(
cÚfig_ÿche_oblivious
 || ((
ušŒ_t
)
±r
 &

1509 
PAGE_MASK
) == 0);

1511 ià(
	`lik–y
(
tÿche
 !ğ
NULL
è&& 
size
 <ğ
tÿche_maxşass
) {

1512 
	`tÿche_d®loc_Ïrge
(
	`tsdn_tsd
(
tsdn
), 
tÿche
, 
±r
,

1513 
size
, 
¦ow_·th
);

1515 
	`¬’a_d®loc_Ïrge
(
tsdn
,

1516 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
), chunk,

1517 
±r
);

1521 
	`huge_d®loc
(
tsdn
, 
±r
);

1522 
	}
}

	@deps/jemalloc/include/jemalloc/internal/assert.h

5 #iâdeà
as£¹


6 
	#as£¹
(
e
) do { \

7 ià(
	`uÆik–y
(
cÚfig_debug
 && !(
e
))) { \

8 
	`m®loc_´štf
( \

10 
__FILE__
, 
__LINE__
, #e); \

11 
	`abÜt
(); \

13 } 0)

	)

16 #iâdeà
nÙ_»ached


17 
	#nÙ_»ached
() do { \

18 ià(
cÚfig_debug
) { \

19 
	`m®loc_´štf
( \

21 
__FILE__
, 
__LINE__
); \

22 
	`abÜt
(); \

24 
	`uÄ—chabË
(); \

25 } 0)

	)

28 #iâdeà
nÙ_im¶em’‹d


29 
	#nÙ_im¶em’‹d
() do { \

30 ià(
cÚfig_debug
) { \

31 
	`m®loc_´štf
("<jemalloc>: %s:%d: Not implemented\n", \

32 
__FILE__
, 
__LINE__
); \

33 
	`abÜt
(); \

35 } 0)

	)

38 #iâdeà
as£¹_nÙ_im¶em’‹d


39 
	#as£¹_nÙ_im¶em’‹d
(
e
) do { \

40 ià(
	`uÆik–y
(
cÚfig_debug
 && !(
e
))) \

41 
	`nÙ_im¶em’‹d
(); \

42 } 0)

	)

	@deps/jemalloc/include/jemalloc/internal/atomic.h

2 #ifdeà
JEMALLOC_H_TYPES


6 #ifdeà
JEMALLOC_H_STRUCTS


10 #ifdeà
JEMALLOC_H_EXTERNS


12 
	#©omic_»ad_ušt64
(
p
è
	`©omic_add_ušt64
Õ, 0)

	)

13 
	#©omic_»ad_ušt32
(
p
è
	`©omic_add_ušt32
Õ, 0)

	)

14 
	#©omic_»ad_p
(
p
è
	`©omic_add_p
Õ, 
NULL
)

	)

15 
	#©omic_»ad_z
(
p
è
	`©omic_add_z
Õ, 0)

	)

16 
	#©omic_»ad_u
(
p
è
	`©omic_add_u
Õ, 0)

	)

20 #ifdeà
JEMALLOC_H_INLINES


43 #iâdeà
JEMALLOC_ENABLE_INLINE


44 
ušt64_t
 
©omic_add_ušt64
(ušt64_ˆ*
p
, ušt64_ˆ
x
);

45 
ušt64_t
 
©omic_sub_ušt64
(ušt64_ˆ*
p
, ušt64_ˆ
x
);

46 
boŞ
 
©omic_ÿs_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
c
, ušt64_ˆ
s
);

47 
©omic_wr™e_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
);

48 
ušt32_t
 
©omic_add_ušt32
(ušt32_ˆ*
p
, ušt32_ˆ
x
);

49 
ušt32_t
 
©omic_sub_ušt32
(ušt32_ˆ*
p
, ušt32_ˆ
x
);

50 
boŞ
 
©omic_ÿs_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
c
, ušt32_ˆ
s
);

51 
©omic_wr™e_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
);

52 *
©omic_add_p
(**
p
, *
x
);

53 *
©omic_sub_p
(**
p
, *
x
);

54 
boŞ
 
©omic_ÿs_p
(**
p
, *
c
, *
s
);

55 
©omic_wr™e_p
(**
p
, cÚ¡ *
x
);

56 
size_t
 
©omic_add_z
(size_ˆ*
p
, size_ˆ
x
);

57 
size_t
 
©omic_sub_z
(size_ˆ*
p
, size_ˆ
x
);

58 
boŞ
 
©omic_ÿs_z
(
size_t
 *
p
, size_ˆ
c
, size_ˆ
s
);

59 
©omic_wr™e_z
(
size_t
 *
p
, size_ˆ
x
);

60 
©omic_add_u
(*
p
, 
x
);

61 
©omic_sub_u
(*
p
, 
x
);

62 
boŞ
 
©omic_ÿs_u
(*
p
, 
c
, 
s
);

63 
©omic_wr™e_u
(*
p
, 
x
);

66 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_ATOMIC_C_
))

69 #ià(
LG_SIZEOF_PTR
 =ğ3 || 
LG_SIZEOF_INT
 == 3)

70 #ià(
defšed
(
__amd64__
è|| defšed(
__x86_64__
))

71 
JEMALLOC_INLINE
 
ušt64_t


72 
	$©omic_add_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

74 
ušt64_t
 
t
 = 
x
;

76 
asm
 volatile (

78 : "+r" (
t
), "=m" (*
p
)

79 : "m" (*
p
)

82  (
t
 + 
x
);

83 
	}
}

85 
JEMALLOC_INLINE
 
ušt64_t


86 
	$©omic_sub_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

88 
ušt64_t
 
t
;

90 
x
 = (
ušt64_t
)(-(
št64_t
)x);

91 
t
 = 
x
;

92 
asm
 volatile (

94 : "+r" (
t
), "=m" (*
p
)

95 : "m" (*
p
)

98  (
t
 + 
x
);

99 
	}
}

101 
JEMALLOC_INLINE
 
boŞ


102 
	$©omic_ÿs_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
c
, ušt64_ˆ
s
)

104 
ušt8_t
 
sucûss
;

106 
asm
 volatile (

109 : "=m" (*
p
), "÷" (
sucûss
)

110 : "m" (*
p
), "a" (
c
), "r" (
s
)

114  (!(
boŞ
)
sucûss
);

115 
	}
}

117 
JEMALLOC_INLINE
 

118 
	$©omic_wr™e_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

121 
asm
 volatile (

123 : "=m" (*
p
), "+r" (
x
)

124 : "m" (*
p
)

127 
	}
}

128 #–ià(
defšed
(
JEMALLOC_C11ATOMICS
))

129 
JEMALLOC_INLINE
 
ušt64_t


130 
	$©omic_add_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

132 vŞ©
©omic_ušt_Ëa¡64_t
 *
a
 = (vŞ©©omic_ušt_Ëa¡64_ˆ*)
p
;

133  (
	`©omic_ãtch_add
(
a
, 
x
) + x);

134 
	}
}

136 
JEMALLOC_INLINE
 
ušt64_t


137 
	$©omic_sub_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

139 vŞ©
©omic_ušt_Ëa¡64_t
 *
a
 = (vŞ©©omic_ušt_Ëa¡64_ˆ*)
p
;

140  (
	`©omic_ãtch_sub
(
a
, 
x
) - x);

141 
	}
}

143 
JEMALLOC_INLINE
 
boŞ


144 
	$©omic_ÿs_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
c
, ušt64_ˆ
s
)

146 vŞ©
©omic_ušt_Ëa¡64_t
 *
a
 = (vŞ©©omic_ušt_Ëa¡64_ˆ*)
p
;

147  (!
	`©omic_com·»_exchªge_¡rÚg
(
a
, &
c
, 
s
));

148 
	}
}

150 
JEMALLOC_INLINE
 

151 
	$©omic_wr™e_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

153 vŞ©
©omic_ušt_Ëa¡64_t
 *
a
 = (vŞ©©omic_ušt_Ëa¡64_ˆ*)
p
;

154 
	`©omic_¡Üe
(
a
, 
x
);

155 
	}
}

156 #–ià(
defšed
(
JEMALLOC_ATOMIC9
))

157 
JEMALLOC_INLINE
 
ušt64_t


158 
	$©omic_add_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

165 
	`as£¹
((
ušt64_t
) == ());

167  (
	`©omic_ãtchadd_lÚg
(
p
, ()
x
) + x);

168 
	}
}

170 
JEMALLOC_INLINE
 
ušt64_t


171 
	$©omic_sub_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

174 
	`as£¹
((
ušt64_t
) == ());

176  (
	`©omic_ãtchadd_lÚg
(
p
, ()(-()
x
)) - x);

177 
	}
}

179 
JEMALLOC_INLINE
 
boŞ


180 
	$©omic_ÿs_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
c
, ušt64_ˆ
s
)

183 
	`as£¹
((
ušt64_t
) == ());

185  (!
	`©omic_cmp£t_lÚg
(
p
, ()
c
, ()
s
));

186 
	}
}

188 
JEMALLOC_INLINE
 

189 
	$©omic_wr™e_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

192 
	`as£¹
((
ušt64_t
) == ());

194 
	`©omic_¡Üe_»l_lÚg
(
p
, 
x
);

195 
	}
}

196 #–ià(
defšed
(
JEMALLOC_OSATOMIC
))

197 
JEMALLOC_INLINE
 
ušt64_t


198 
	$©omic_add_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

201  (
	`OSAtomicAdd64
((
št64_t
)
x
, (št64_ˆ*)
p
));

202 
	}
}

204 
JEMALLOC_INLINE
 
ušt64_t


205 
	$©omic_sub_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

208  (
	`OSAtomicAdd64
(-((
št64_t
)
x
), (št64_ˆ*)
p
));

209 
	}
}

211 
JEMALLOC_INLINE
 
boŞ


212 
	$©omic_ÿs_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
c
, ušt64_ˆ
s
)

215  (!
	`OSAtomicCom·»AndSw­64
(
c
, 
s
, (
št64_t
 *)
p
));

216 
	}
}

218 
JEMALLOC_INLINE
 

219 
	$©omic_wr™e_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

221 
ušt64_t
 
o
;

225 
o
 = 
	`©omic_»ad_ušt64
(
p
);

226 } 
	`©omic_ÿs_ušt64
(
p
, 
o
, 
x
));

227 
	}
}

228 #–ià(
defšed
(
_MSC_VER
))

229 
JEMALLOC_INLINE
 
ušt64_t


230 
	$©omic_add_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

233  (
	`IÁ”lockedExchªgeAdd64
(
p
, 
x
) + x);

234 
	}
}

236 
JEMALLOC_INLINE
 
ušt64_t


237 
	$©omic_sub_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

240  (
	`IÁ”lockedExchªgeAdd64
(
p
, -((
št64_t
)
x
)) - x);

241 
	}
}

243 
JEMALLOC_INLINE
 
boŞ


244 
	$©omic_ÿs_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
c
, ušt64_ˆ
s
)

246 
ušt64_t
 
o
;

248 
o
 = 
	`IÁ”lockedCom·»Exchªge64
(
p
, 
s
, 
c
);

249  (
o
 !ğ
c
);

250 
	}
}

252 
JEMALLOC_INLINE
 

253 
	$©omic_wr™e_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

256 
	`IÁ”lockedExchªge64
(
p
, 
x
);

257 
	}
}

258 #–ià(
defšed
(
__GCC_HAVE_SYNC_COMPARE_AND_SWAP_8
) || \

259 
	$defšed
(
JE_FORCE_SYNC_COMPARE_AND_SWAP_8
))

260 
JEMALLOC_INLINE
 
ušt64_t


261 
	$©omic_add_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

264  (
	`__sync_add_ªd_ãtch
(
p
, 
x
));

265 
	}
}

267 
JEMALLOC_INLINE
 
ušt64_t


268 
	$©omic_sub_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

271  (
	`__sync_sub_ªd_ãtch
(
p
, 
x
));

272 
	}
}

274 
JEMALLOC_INLINE
 
boŞ


275 
	$©omic_ÿs_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
c
, ušt64_ˆ
s
)

278  (!
	`__sync_boŞ_com·»_ªd_sw­
(
p
, 
c
, 
s
));

279 
	}
}

281 
JEMALLOC_INLINE
 

282 
	$©omic_wr™e_ušt64
(
ušt64_t
 *
p
, ušt64_ˆ
x
)

285 
	`__sync_lock_‹¡_ªd_£t
(
p
, 
x
);

286 
	}
}

294 #ià(
defšed
(
__i386__
è|| defšed(
__amd64__
è|| defšed(
__x86_64__
))

295 
JEMALLOC_INLINE
 
ušt32_t


296 
	$©omic_add_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

298 
ušt32_t
 
t
 = 
x
;

300 
asm
 volatile (

302 : "+r" (
t
), "=m" (*
p
)

303 : "m" (*
p
)

306  (
t
 + 
x
);

307 
	}
}

309 
JEMALLOC_INLINE
 
ušt32_t


310 
	$©omic_sub_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

312 
ušt32_t
 
t
;

314 
x
 = (
ušt32_t
)(-(
št32_t
)x);

315 
t
 = 
x
;

316 
asm
 volatile (

318 : "+r" (
t
), "=m" (*
p
)

319 : "m" (*
p
)

322  (
t
 + 
x
);

323 
	}
}

325 
JEMALLOC_INLINE
 
boŞ


326 
	$©omic_ÿs_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
c
, ušt32_ˆ
s
)

328 
ušt8_t
 
sucûss
;

330 
asm
 volatile (

333 : "=m" (*
p
), "÷" (
sucûss
)

334 : "m" (*
p
), "a" (
c
), "r" (
s
)

338  (!(
boŞ
)
sucûss
);

339 
	}
}

341 
JEMALLOC_INLINE
 

342 
	$©omic_wr™e_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

345 
asm
 volatile (

347 : "=m" (*
p
), "+r" (
x
)

348 : "m" (*
p
)

351 
	}
}

352 #–ià(
defšed
(
JEMALLOC_C11ATOMICS
))

353 
JEMALLOC_INLINE
 
ušt32_t


354 
	$©omic_add_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

356 vŞ©
©omic_ušt_Ëa¡32_t
 *
a
 = (vŞ©©omic_ušt_Ëa¡32_ˆ*)
p
;

357  (
	`©omic_ãtch_add
(
a
, 
x
) + x);

358 
	}
}

360 
JEMALLOC_INLINE
 
ušt32_t


361 
	$©omic_sub_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

363 vŞ©
©omic_ušt_Ëa¡32_t
 *
a
 = (vŞ©©omic_ušt_Ëa¡32_ˆ*)
p
;

364  (
	`©omic_ãtch_sub
(
a
, 
x
) - x);

365 
	}
}

367 
JEMALLOC_INLINE
 
boŞ


368 
	$©omic_ÿs_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
c
, ušt32_ˆ
s
)

370 vŞ©
©omic_ušt_Ëa¡32_t
 *
a
 = (vŞ©©omic_ušt_Ëa¡32_ˆ*)
p
;

371  (!
	`©omic_com·»_exchªge_¡rÚg
(
a
, &
c
, 
s
));

372 
	}
}

374 
JEMALLOC_INLINE
 

375 
	$©omic_wr™e_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

377 vŞ©
©omic_ušt_Ëa¡32_t
 *
a
 = (vŞ©©omic_ušt_Ëa¡32_ˆ*)
p
;

378 
	`©omic_¡Üe
(
a
, 
x
);

379 
	}
}

380 #–ià(
defšed
(
JEMALLOC_ATOMIC9
))

381 
JEMALLOC_INLINE
 
ušt32_t


382 
	$©omic_add_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

385  (
	`©omic_ãtchadd_32
(
p
, 
x
) + x);

386 
	}
}

388 
JEMALLOC_INLINE
 
ušt32_t


389 
	$©omic_sub_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

392  (
	`©omic_ãtchadd_32
(
p
, (
ušt32_t
)(-(
št32_t
)
x
)) - x);

393 
	}
}

395 
JEMALLOC_INLINE
 
boŞ


396 
	$©omic_ÿs_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
c
, ušt32_ˆ
s
)

399  (!
	`©omic_cmp£t_32
(
p
, 
c
, 
s
));

400 
	}
}

402 
JEMALLOC_INLINE
 

403 
	$©omic_wr™e_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

406 
	`©omic_¡Üe_»l_32
(
p
, 
x
);

407 
	}
}

408 #–ià(
defšed
(
JEMALLOC_OSATOMIC
))

409 
JEMALLOC_INLINE
 
ušt32_t


410 
	$©omic_add_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

413  (
	`OSAtomicAdd32
((
št32_t
)
x
, (št32_ˆ*)
p
));

414 
	}
}

416 
JEMALLOC_INLINE
 
ušt32_t


417 
	$©omic_sub_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

420  (
	`OSAtomicAdd32
(-((
št32_t
)
x
), (št32_ˆ*)
p
));

421 
	}
}

423 
JEMALLOC_INLINE
 
boŞ


424 
	$©omic_ÿs_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
c
, ušt32_ˆ
s
)

427  (!
	`OSAtomicCom·»AndSw­32
(
c
, 
s
, (
št32_t
 *)
p
));

428 
	}
}

430 
JEMALLOC_INLINE
 

431 
	$©omic_wr™e_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

433 
ušt32_t
 
o
;

437 
o
 = 
	`©omic_»ad_ušt32
(
p
);

438 } 
	`©omic_ÿs_ušt32
(
p
, 
o
, 
x
));

439 
	}
}

440 #–ià(
defšed
(
_MSC_VER
))

441 
JEMALLOC_INLINE
 
ušt32_t


442 
	$©omic_add_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

445  (
	`IÁ”lockedExchªgeAdd
(
p
, 
x
) + x);

446 
	}
}

448 
JEMALLOC_INLINE
 
ušt32_t


449 
	$©omic_sub_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

452  (
	`IÁ”lockedExchªgeAdd
(
p
, -((
št32_t
)
x
)) - x);

453 
	}
}

455 
JEMALLOC_INLINE
 
boŞ


456 
	$©omic_ÿs_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
c
, ušt32_ˆ
s
)

458 
ušt32_t
 
o
;

460 
o
 = 
	`IÁ”lockedCom·»Exchªge
(
p
, 
s
, 
c
);

461  (
o
 !ğ
c
);

462 
	}
}

464 
JEMALLOC_INLINE
 

465 
	$©omic_wr™e_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

468 
	`IÁ”lockedExchªge
(
p
, 
x
);

469 
	}
}

470 #–ià(
defšed
(
__GCC_HAVE_SYNC_COMPARE_AND_SWAP_4
) || \

471 
	$defšed
(
JE_FORCE_SYNC_COMPARE_AND_SWAP_4
))

472 
JEMALLOC_INLINE
 
ušt32_t


473 
	$©omic_add_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

476  (
	`__sync_add_ªd_ãtch
(
p
, 
x
));

477 
	}
}

479 
JEMALLOC_INLINE
 
ušt32_t


480 
	$©omic_sub_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

483  (
	`__sync_sub_ªd_ãtch
(
p
, 
x
));

484 
	}
}

486 
JEMALLOC_INLINE
 
boŞ


487 
	$©omic_ÿs_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
c
, ušt32_ˆ
s
)

490  (!
	`__sync_boŞ_com·»_ªd_sw­
(
p
, 
c
, 
s
));

491 
	}
}

493 
JEMALLOC_INLINE
 

494 
	$©omic_wr™e_ušt32
(
ušt32_t
 *
p
, ušt32_ˆ
x
)

497 
	`__sync_lock_‹¡_ªd_£t
(
p
, 
x
);

498 
	}
}

505 
JEMALLOC_INLINE
 *

506 
	$©omic_add_p
(**
p
, *
x
)

509 #ià(
LG_SIZEOF_PTR
 == 3)

510  ((*)
	`©omic_add_ušt64
((
ušt64_t
 *)
p
, (ušt64_t)
x
));

511 #–ià(
LG_SIZEOF_PTR
 == 2)

512  ((*)
	`©omic_add_ušt32
((
ušt32_t
 *)
p
, (ušt32_t)
x
));

514 
	}
}

516 
JEMALLOC_INLINE
 *

517 
	$©omic_sub_p
(**
p
, *
x
)

520 #ià(
LG_SIZEOF_PTR
 == 3)

521  ((*)
	`©omic_add_ušt64
((
ušt64_t
 *)
p
,

522 (
ušt64_t
)-((
št64_t
)
x
)));

523 #–ià(
LG_SIZEOF_PTR
 == 2)

524  ((*)
	`©omic_add_ušt32
((
ušt32_t
 *)
p
,

525 (
ušt32_t
)-((
št32_t
)
x
)));

527 
	}
}

529 
JEMALLOC_INLINE
 
boŞ


530 
	$©omic_ÿs_p
(**
p
, *
c
, *
s
)

533 #ià(
LG_SIZEOF_PTR
 == 3)

534  (
	`©omic_ÿs_ušt64
((
ušt64_t
 *)
p
, (ušt64_t)
c
, (ušt64_t)
s
));

535 #–ià(
LG_SIZEOF_PTR
 == 2)

536  (
	`©omic_ÿs_ušt32
((
ušt32_t
 *)
p
, (ušt32_t)
c
, (ušt32_t)
s
));

538 
	}
}

540 
JEMALLOC_INLINE
 

541 
	$©omic_wr™e_p
(**
p
, cÚ¡ *
x
)

544 #ià(
LG_SIZEOF_PTR
 == 3)

545 
	`©omic_wr™e_ušt64
((
ušt64_t
 *)
p
, (ušt64_t)
x
);

546 #–ià(
LG_SIZEOF_PTR
 == 2)

547 
	`©omic_wr™e_ušt32
((
ušt32_t
 *)
p
, (ušt32_t)
x
);

549 
	}
}

553 
JEMALLOC_INLINE
 
size_t


554 
	$©omic_add_z
(
size_t
 *
p
, size_ˆ
x
)

557 #ià(
LG_SIZEOF_PTR
 == 3)

558  ((
size_t
)
	`©omic_add_ušt64
((
ušt64_t
 *)
p
, (ušt64_t)
x
));

559 #–ià(
LG_SIZEOF_PTR
 == 2)

560  ((
size_t
)
	`©omic_add_ušt32
((
ušt32_t
 *)
p
, (ušt32_t)
x
));

562 
	}
}

564 
JEMALLOC_INLINE
 
size_t


565 
	$©omic_sub_z
(
size_t
 *
p
, size_ˆ
x
)

568 #ià(
LG_SIZEOF_PTR
 == 3)

569  ((
size_t
)
	`©omic_add_ušt64
((
ušt64_t
 *)
p
,

570 (
ušt64_t
)-((
št64_t
)
x
)));

571 #–ià(
LG_SIZEOF_PTR
 == 2)

572  ((
size_t
)
	`©omic_add_ušt32
((
ušt32_t
 *)
p
,

573 (
ušt32_t
)-((
št32_t
)
x
)));

575 
	}
}

577 
JEMALLOC_INLINE
 
boŞ


578 
	$©omic_ÿs_z
(
size_t
 *
p
, size_ˆ
c
, size_ˆ
s
)

581 #ià(
LG_SIZEOF_PTR
 == 3)

582  (
	`©omic_ÿs_ušt64
((
ušt64_t
 *)
p
, (ušt64_t)
c
, (ušt64_t)
s
));

583 #–ià(
LG_SIZEOF_PTR
 == 2)

584  (
	`©omic_ÿs_ušt32
((
ušt32_t
 *)
p
, (ušt32_t)
c
, (ušt32_t)
s
));

586 
	}
}

588 
JEMALLOC_INLINE
 

589 
	$©omic_wr™e_z
(
size_t
 *
p
, size_ˆ
x
)

592 #ià(
LG_SIZEOF_PTR
 == 3)

593 
	`©omic_wr™e_ušt64
((
ušt64_t
 *)
p
, (ušt64_t)
x
);

594 #–ià(
LG_SIZEOF_PTR
 == 2)

595 
	`©omic_wr™e_ušt32
((
ušt32_t
 *)
p
, (ušt32_t)
x
);

597 
	}
}

601 
JEMALLOC_INLINE
 

602 
	$©omic_add_u
(*
p
, 
x
)

605 #ià(
LG_SIZEOF_INT
 == 3)

606  (()
	`©omic_add_ušt64
((
ušt64_t
 *)
p
, (ušt64_t)
x
));

607 #–ià(
LG_SIZEOF_INT
 == 2)

608  (()
	`©omic_add_ušt32
((
ušt32_t
 *)
p
, (ušt32_t)
x
));

610 
	}
}

612 
JEMALLOC_INLINE
 

613 
	$©omic_sub_u
(*
p
, 
x
)

616 #ià(
LG_SIZEOF_INT
 == 3)

617  (()
	`©omic_add_ušt64
((
ušt64_t
 *)
p
,

618 (
ušt64_t
)-((
št64_t
)
x
)));

619 #–ià(
LG_SIZEOF_INT
 == 2)

620  (()
	`©omic_add_ušt32
((
ušt32_t
 *)
p
,

621 (
ušt32_t
)-((
št32_t
)
x
)));

623 
	}
}

625 
JEMALLOC_INLINE
 
boŞ


626 
	$©omic_ÿs_u
(*
p
, 
c
, 
s
)

629 #ià(
LG_SIZEOF_INT
 == 3)

630  (
	`©omic_ÿs_ušt64
((
ušt64_t
 *)
p
, (ušt64_t)
c
, (ušt64_t)
s
));

631 #–ià(
LG_SIZEOF_INT
 == 2)

632  (
	`©omic_ÿs_ušt32
((
ušt32_t
 *)
p
, (ušt32_t)
c
, (ušt32_t)
s
));

634 
	}
}

636 
JEMALLOC_INLINE
 

637 
	$©omic_wr™e_u
(*
p
, 
x
)

640 #ià(
LG_SIZEOF_INT
 == 3)

641 
	`©omic_wr™e_ušt64
((
ušt64_t
 *)
p
, (ušt64_t)
x
);

642 #–ià(
LG_SIZEOF_INT
 == 2)

643 
	`©omic_wr™e_ušt32
((
ušt32_t
 *)
p
, (ušt32_t)
x
);

645 
	}
}

	@deps/jemalloc/include/jemalloc/internal/base.h

2 #ifdeà
JEMALLOC_H_TYPES


6 #ifdeà
JEMALLOC_H_STRUCTS


10 #ifdeà
JEMALLOC_H_EXTERNS


12 *
ba£_®loc
(
tsdn_t
 *
tsdn
, 
size_t
 
size
);

13 
ba£_¡©s_g‘
(
tsdn_t
 *
tsdn
, 
size_t
 *
®loÿ‹d
, size_ˆ*
»sid’t
,

14 
size_t
 *
m­³d
);

15 
boŞ
 
ba£_boÙ
();

16 
ba£_´efÜk
(
tsdn_t
 *
tsdn
);

17 
ba£_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
);

18 
ba£_po¡fÜk_chd
(
tsdn_t
 *
tsdn
);

22 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/bitmap.h

2 #ifdeà
JEMALLOC_H_TYPES


5 
	#LG_BITMAP_MAXBITS
 
LG_RUN_MAXREGS


	)

6 
	#BITMAP_MAXBITS
 (
	`ZU
(1è<< 
LG_BITMAP_MAXBITS
)

	)

8 
b™m­_Ëv–_s
 
	tb™m­_Ëv–_t
;

9 
b™m­_šfo_s
 
	tb™m­_šfo_t
;

10 
	tb™m­_t
;

11 
	#LG_SIZEOF_BITMAP
 
LG_SIZEOF_LONG


	)

14 
	#LG_BITMAP_GROUP_NBITS
 (
LG_SIZEOF_BITMAP
 + 3)

	)

15 
	#BITMAP_GROUP_NBITS
 (
	`ZU
(1è<< 
LG_BITMAP_GROUP_NBITS
)

	)

16 
	#BITMAP_GROUP_NBITS_MASK
 (
BITMAP_GROUP_NBITS
-1)

	)

23 #ià
LG_BITMAP_MAXBITS
 - 
LG_BITMAP_GROUP_NBITS
 > 3

24 
	#USE_TREE


	)

28 
	#BITMAP_BITS2GROUPS
(
nb™s
) \

29 ((
nb™s
 + 
BITMAP_GROUP_NBITS_MASK
è>> 
LG_BITMAP_GROUP_NBITS
)

	)

34 
	#BITMAP_GROUPS_L0
(
nb™s
) \

35 
	`BITMAP_BITS2GROUPS
(
nb™s
)

	)

36 
	#BITMAP_GROUPS_L1
(
nb™s
) \

37 
	`BITMAP_BITS2GROUPS
(BITMAP_BITS2GROUPS(
nb™s
))

	)

38 
	#BITMAP_GROUPS_L2
(
nb™s
) \

39 
	`BITMAP_BITS2GROUPS
(BITMAP_BITS2GROUPS(BITMAP_BITS2GROUPS((
nb™s
))))

	)

40 
	#BITMAP_GROUPS_L3
(
nb™s
) \

41 
	`BITMAP_BITS2GROUPS
(BITMAP_BITS2GROUPS(BITMAP_BITS2GROUPS( \

42 
	`BITMAP_BITS2GROUPS
((
nb™s
)))))

	)

48 
	#BITMAP_GROUPS_1_LEVEL
(
nb™s
) \

49 
	`BITMAP_GROUPS_L0
(
nb™s
)

	)

50 
	#BITMAP_GROUPS_2_LEVEL
(
nb™s
) \

51 (
	`BITMAP_GROUPS_1_LEVEL
(
nb™s
è+ 
	`BITMAP_GROUPS_L1
Òb™s))

	)

52 
	#BITMAP_GROUPS_3_LEVEL
(
nb™s
) \

53 (
	`BITMAP_GROUPS_2_LEVEL
(
nb™s
è+ 
	`BITMAP_GROUPS_L2
Òb™s))

	)

54 
	#BITMAP_GROUPS_4_LEVEL
(
nb™s
) \

55 (
	`BITMAP_GROUPS_3_LEVEL
(
nb™s
è+ 
	`BITMAP_GROUPS_L3
Òb™s))

	)

60 #ifdeà
USE_TREE


62 #ià
LG_BITMAP_MAXBITS
 <ğ
LG_BITMAP_GROUP_NBITS


63 
	#BITMAP_GROUPS_MAX
 
	`BITMAP_GROUPS_1_LEVEL
(
BITMAP_MAXBITS
)

	)

64 #–ià
LG_BITMAP_MAXBITS
 <ğ
LG_BITMAP_GROUP_NBITS
 * 2

65 
	#BITMAP_GROUPS_MAX
 
	`BITMAP_GROUPS_2_LEVEL
(
BITMAP_MAXBITS
)

	)

66 #–ià
LG_BITMAP_MAXBITS
 <ğ
LG_BITMAP_GROUP_NBITS
 * 3

67 
	#BITMAP_GROUPS_MAX
 
	`BITMAP_GROUPS_3_LEVEL
(
BITMAP_MAXBITS
)

	)

68 #–ià
LG_BITMAP_MAXBITS
 <ğ
LG_BITMAP_GROUP_NBITS
 * 4

69 
	#BITMAP_GROUPS_MAX
 
	`BITMAP_GROUPS_4_LEVEL
(
BITMAP_MAXBITS
)

	)

75 
	#BITMAP_MAX_LEVELS
 \

76 (
LG_BITMAP_MAXBITS
 / 
LG_SIZEOF_BITMAP
) \

77 + !!(
LG_BITMAP_MAXBITS
 % 
LG_SIZEOF_BITMAP
)

	)

81 
	#BITMAP_GROUPS_MAX
 
	`BITMAP_BITS2GROUPS
(
BITMAP_MAXBITS
)

	)

87 #ifdeà
JEMALLOC_H_STRUCTS


89 
	sb™m­_Ëv–_s
 {

91 
size_t
 
	mgroup_off£t
;

94 
	sb™m­_šfo_s
 {

96 
size_t
 
	mnb™s
;

98 #ifdeà
USE_TREE


100 
	mÆev–s
;

106 
b™m­_Ëv–_t
 
	mËv–s
[
BITMAP_MAX_LEVELS
+1];

109 
size_t
 
	mngroups
;

115 #ifdeà
JEMALLOC_H_EXTERNS


117 
b™m­_šfo_š™
(
b™m­_šfo_t
 *
bšfo
, 
size_t
 
nb™s
);

118 
b™m­_š™
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
);

119 
size_t
 
b™m­_size
(cÚ¡ 
b™m­_šfo_t
 *
bšfo
);

123 #ifdeà
JEMALLOC_H_INLINES


125 #iâdeà
JEMALLOC_ENABLE_INLINE


126 
boŞ
 
b™m­_fuÎ
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
);

127 
boŞ
 
b™m­_g‘
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
, 
size_t
 
b™
);

128 
b™m­_£t
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
, 
size_t
 
b™
);

129 
size_t
 
b™m­_sfu
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
);

130 
b™m­_un£t
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
, 
size_t
 
b™
);

133 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_BITMAP_C_
))

134 
JEMALLOC_INLINE
 
boŞ


135 
	$b™m­_fuÎ
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
)

137 #ifdeà
USE_TREE


138 
size_t
 
rgoff
 = 
bšfo
->
Ëv–s
[bšfo->
Æev–s
].
group_off£t
 - 1;

139 
b™m­_t
 
rg
 = 
b™m­
[
rgoff
];

141  (
rg
 == 0);

143 
size_t
 
i
;

145 
i
 = 0; i < 
bšfo
->
ngroups
; i++) {

146 ià(
b™m­
[
i
] != 0)

147  (
çl£
);

149  (
Œue
);

151 
	}
}

153 
JEMALLOC_INLINE
 
boŞ


154 
	$b™m­_g‘
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
, 
size_t
 
b™
)

156 
size_t
 
goff
;

157 
b™m­_t
 
g
;

159 
	`as£¹
(
b™
 < 
bšfo
->
nb™s
);

160 
goff
 = 
b™
 >> 
LG_BITMAP_GROUP_NBITS
;

161 
g
 = 
b™m­
[
goff
];

162  (!(
g
 & (
	`ZU
(1è<< (
b™
 & 
BITMAP_GROUP_NBITS_MASK
))));

163 
	}
}

165 
JEMALLOC_INLINE
 

166 
	$b™m­_£t
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
, 
size_t
 
b™
)

168 
size_t
 
goff
;

169 
b™m­_t
 *
gp
;

170 
b™m­_t
 
g
;

172 
	`as£¹
(
b™
 < 
bšfo
->
nb™s
);

173 
	`as£¹
(!
	`b™m­_g‘
(
b™m­
, 
bšfo
, 
b™
));

174 
goff
 = 
b™
 >> 
LG_BITMAP_GROUP_NBITS
;

175 
gp
 = &
b™m­
[
goff
];

176 
g
 = *
gp
;

177 
	`as£¹
(
g
 & (
	`ZU
(1è<< (
b™
 & 
BITMAP_GROUP_NBITS_MASK
)));

178 
g
 ^ğ
	`ZU
(1è<< (
b™
 & 
BITMAP_GROUP_NBITS_MASK
);

179 *
gp
 = 
g
;

180 
	`as£¹
(
	`b™m­_g‘
(
b™m­
, 
bšfo
, 
b™
));

181 #ifdeà
USE_TREE


183 ià(
g
 == 0) {

184 
i
;

185 
i
 = 1; i < 
bšfo
->
Æev–s
; i++) {

186 
b™
 = 
goff
;

187 
goff
 = 
b™
 >> 
LG_BITMAP_GROUP_NBITS
;

188 
gp
 = &
b™m­
[
bšfo
->
Ëv–s
[
i
].
group_off£t
 + 
goff
];

189 
g
 = *
gp
;

190 
	`as£¹
(
g
 & (
	`ZU
(1è<< (
b™
 & 
BITMAP_GROUP_NBITS_MASK
)));

191 
g
 ^ğ
	`ZU
(1è<< (
b™
 & 
BITMAP_GROUP_NBITS_MASK
);

192 *
gp
 = 
g
;

193 ià(
g
 != 0)

198 
	}
}

201 
JEMALLOC_INLINE
 
size_t


202 
	$b™m­_sfu
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
)

204 
size_t
 
b™
;

205 
b™m­_t
 
g
;

206 
i
;

208 
	`as£¹
(!
	`b™m­_fuÎ
(
b™m­
, 
bšfo
));

210 #ifdeà
USE_TREE


211 
i
 = 
bšfo
->
Æev–s
 - 1;

212 
g
 = 
b™m­
[
bšfo
->
Ëv–s
[
i
].
group_off£t
];

213 
b™
 = 
	`ffs_lu
(
g
) - 1;

214 
i
 > 0) {

215 
i
--;

216 
g
 = 
b™m­
[
bšfo
->
Ëv–s
[
i
].
group_off£t
 + 
b™
];

217 
b™
 = (b™ << 
LG_BITMAP_GROUP_NBITS
è+ (
	`ffs_lu
(
g
) - 1);

220 
i
 = 0;

221 
g
 = 
b™m­
[0];

222 (
b™
 = 
	`ffs_lu
(
g
)) == 0) {

223 
i
++;

224 
g
 = 
b™m­
[
i
];

226 
b™
 = (
i
 << 
LG_BITMAP_GROUP_NBITS
) + (bit - 1);

228 
	`b™m­_£t
(
b™m­
, 
bšfo
, 
b™
);

229  (
b™
);

230 
	}
}

232 
JEMALLOC_INLINE
 

233 
	$b™m­_un£t
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
, 
size_t
 
b™
)

235 
size_t
 
goff
;

236 
b™m­_t
 *
gp
;

237 
b™m­_t
 
g
;

238 
UNUSED
 
boŞ
 
´İag©e
;

240 
	`as£¹
(
b™
 < 
bšfo
->
nb™s
);

241 
	`as£¹
(
	`b™m­_g‘
(
b™m­
, 
bšfo
, 
b™
));

242 
goff
 = 
b™
 >> 
LG_BITMAP_GROUP_NBITS
;

243 
gp
 = &
b™m­
[
goff
];

244 
g
 = *
gp
;

245 
´İag©e
 = (
g
 == 0);

246 
	`as£¹
((
g
 & (
	`ZU
(1è<< (
b™
 & 
BITMAP_GROUP_NBITS_MASK
))) == 0);

247 
g
 ^ğ
	`ZU
(1è<< (
b™
 & 
BITMAP_GROUP_NBITS_MASK
);

248 *
gp
 = 
g
;

249 
	`as£¹
(!
	`b™m­_g‘
(
b™m­
, 
bšfo
, 
b™
));

250 #ifdeà
USE_TREE


252 ià(
´İag©e
) {

253 
i
;

254 
i
 = 1; i < 
bšfo
->
Æev–s
; i++) {

255 
b™
 = 
goff
;

256 
goff
 = 
b™
 >> 
LG_BITMAP_GROUP_NBITS
;

257 
gp
 = &
b™m­
[
bšfo
->
Ëv–s
[
i
].
group_off£t
 + 
goff
];

258 
g
 = *
gp
;

259 
´İag©e
 = (
g
 == 0);

260 
	`as£¹
((
g
 & (
	`ZU
(1è<< (
b™
 & 
BITMAP_GROUP_NBITS_MASK
)))

262 
g
 ^ğ
	`ZU
(1è<< (
b™
 & 
BITMAP_GROUP_NBITS_MASK
);

263 *
gp
 = 
g
;

264 ià(!
´İag©e
)

269 
	}
}

	@deps/jemalloc/include/jemalloc/internal/chunk.h

2 #ifdeà
JEMALLOC_H_TYPES


8 
	#LG_CHUNK_DEFAULT
 21

	)

11 
	#CHUNK_ADDR2BASE
(
a
) \

12 ((*)((
ušŒ_t
)(
a
è& ~
chunksize_mask
))

	)

15 
	#CHUNK_ADDR2OFFSET
(
a
) \

16 ((
size_t
)((
ušŒ_t
)(
a
è& 
chunksize_mask
))

	)

19 
	#CHUNK_CEILING
(
s
) \

20 (((
s
è+ 
chunksize_mask
è& ~chunksize_mask)

	)

22 
	#CHUNK_HOOKS_INITIALIZER
 { \

23 
NULL
, \

24 
NULL
, \

25 
NULL
, \

26 
NULL
, \

27 
NULL
, \

28 
NULL
, \

29 
NULL
 \

30 }

	)

34 #ifdeà
JEMALLOC_H_STRUCTS


38 #ifdeà
JEMALLOC_H_EXTERNS


40 
size_t
 
İt_lg_chunk
;

41 cÚ¡ *
İt_dss
;

43 
¹»e_t
 
chunks_¹»e
;

45 
size_t
 
chunksize
;

46 
size_t
 
chunksize_mask
;

47 
size_t
 
chunk_Åages
;

49 cÚ¡ 
chunk_hooks_t
 
chunk_hooks_deçuÉ
;

51 
chunk_hooks_t
 
chunk_hooks_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

52 
chunk_hooks_t
 
chunk_hooks_£t
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

53 cÚ¡ 
chunk_hooks_t
 *
chunk_hooks
);

55 
boŞ
 
chunk_»gi¡”
(
tsdn_t
 *
tsdn
, cÚ¡ *
chunk
,

56 cÚ¡ 
ex‹Á_node_t
 *
node
);

57 
chunk_d”egi¡”
(cÚ¡ *
chunk
, cÚ¡ 
ex‹Á_node_t
 *
node
);

58 *
chunk_®loc_ba£
(
size_t
 
size
);

59 *
chunk_®loc_ÿche
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

60 
chunk_hooks_t
 *
chunk_hooks
, *
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
,

61 
size_t
 *
¢
, 
boŞ
 *
z”o
, boŞ *
comm™
, boŞ 
d®loc_node
);

62 *
chunk_®loc_w¿µ”
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

63 
chunk_hooks_t
 *
chunk_hooks
, *
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
,

64 
size_t
 *
¢
, 
boŞ
 *
z”o
, boŞ *
comm™
);

65 
chunk_d®loc_ÿche
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

66 
chunk_hooks_t
 *
chunk_hooks
, *
chunk
, 
size_t
 
size
, size_ˆ
¢
,

67 
boŞ
 
comm™‹d
);

68 
chunk_d®loc_w¿µ”
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

69 
chunk_hooks_t
 *
chunk_hooks
, *
chunk
, 
size_t
 
size
, size_ˆ
¢
,

70 
boŞ
 
z”Ûd
, boŞ 
comm™‹d
);

71 
boŞ
 
chunk_purge_w¿µ”
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

72 
chunk_hooks_t
 *
chunk_hooks
, *
chunk
, 
size_t
 
size
, size_ˆ
off£t
,

73 
size_t
 
Ëngth
);

74 
boŞ
 
chunk_boÙ
();

78 #ifdeà
JEMALLOC_H_INLINES


80 #iâdeà
JEMALLOC_ENABLE_INLINE


81 
ex‹Á_node_t
 *
chunk_lookup
(cÚ¡ *
chunk
, 
boŞ
 
d•’d’t
);

84 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_CHUNK_C_
))

85 
JEMALLOC_INLINE
 
ex‹Á_node_t
 *

86 
	$chunk_lookup
(cÚ¡ *
±r
, 
boŞ
 
d•’d’t
)

89  (
	`¹»e_g‘
(&
chunks_¹»e
, (
ušŒ_t
)
±r
, 
d•’d’t
));

90 
	}
}

96 
	~"jem®loc/š‹º®/chunk_dss.h
"

97 
	~"jem®loc/š‹º®/chunk_mm­.h
"

	@deps/jemalloc/include/jemalloc/internal/chunk_dss.h

2 #ifdeà
JEMALLOC_H_TYPES


5 
	mdss_´ec_di§bËd
 = 0,

6 
	mdss_´ec_´im¬y
 = 1,

7 
	mdss_´ec_£cÚd¬y
 = 2,

9 
	mdss_´ec_lim™
 = 3

10 } 
	tdss_´ec_t
;

11 
	#DSS_PREC_DEFAULT
 
dss_´ec_£cÚd¬y


	)

12 
	#DSS_DEFAULT
 "£cÚd¬y"

	)

16 #ifdeà
JEMALLOC_H_STRUCTS


18 cÚ¡ *
dss_´ec_Çmes
[];

22 #ifdeà
JEMALLOC_H_EXTERNS


24 
dss_´ec_t
 
chunk_dss_´ec_g‘
();

25 
boŞ
 
chunk_dss_´ec_£t
(
dss_´ec_t
 
dss_´ec
);

26 *
chunk_®loc_dss
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
Ãw_addr
,

27 
size_t
 
size
, size_ˆ
®ignm’t
, 
boŞ
 *
z”o
, boŞ *
comm™
);

28 
boŞ
 
chunk_š_dss
(*
chunk
);

29 
boŞ
 
chunk_dss_m”g—bË
(*
chunk_a
, *
chunk_b
);

30 
chunk_dss_boÙ
();

34 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/chunk_mmap.h

2 #ifdeà
JEMALLOC_H_TYPES


6 #ifdeà
JEMALLOC_H_STRUCTS


10 #ifdeà
JEMALLOC_H_EXTERNS


12 *
chunk_®loc_mm­
(*
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
,

13 
boŞ
 *
z”o
, boŞ *
comm™
);

14 
boŞ
 
chunk_d®loc_mm­
(*
chunk
, 
size_t
 
size
);

18 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/ckh.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
ckh_s
 
	tckh_t
;

5 
ckhc_s
 
	tckhc_t
;

8 
	tckh_hash_t
 (cÚ¡ *, 
	tsize_t
[2]);

9 
boŞ
 
	tckh_keycomp_t
 (const *, const *);

20 
	#LG_CKH_BUCKET_CELLS
 (
LG_CACHELINE
 - 
LG_SIZEOF_PTR
 - 1)

	)

24 #ifdeà
JEMALLOC_H_STRUCTS


27 
	sckhc_s
 {

28 cÚ¡ *
	mkey
;

29 cÚ¡ *
	md©a
;

32 
	sckh_s
 {

33 #ifdeà
CKH_COUNT


35 
ušt64_t
 
	mngrows
;

36 
ušt64_t
 
	mnshršks
;

37 
ušt64_t
 
	mnshrškçs
;

38 
ušt64_t
 
	mnš£¹s
;

39 
ušt64_t
 
	mÄ–ocs
;

43 
ušt64_t
 
	m´ng_¡©e
;

46 
size_t
 
	mcouÁ
;

52 
	mlg_mšbuck‘s
;

53 
	mlg_curbuck‘s
;

56 
ckh_hash_t
 *
	mhash
;

57 
ckh_keycomp_t
 *
	mkeycomp
;

60 
ckhc_t
 *
	mb
;

65 #ifdeà
JEMALLOC_H_EXTERNS


67 
boŞ
 
ckh_Ãw
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
, 
size_t
 
mš™ems
, 
ckh_hash_t
 *
hash
,

68 
ckh_keycomp_t
 *
keycomp
);

69 
ckh_d–‘e
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
);

70 
size_t
 
ckh_couÁ
(
ckh_t
 *
ckh
);

71 
boŞ
 
ckh_™”
(
ckh_t
 *
ckh
, 
size_t
 *
bšd
, **
key
, **
d©a
);

72 
boŞ
 
ckh_š£¹
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
, cÚ¡ *
key
, cÚ¡ *
d©a
);

73 
boŞ
 
ckh_»move
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
, cÚ¡ *
£¬chkey
, **
key
,

74 **
d©a
);

75 
boŞ
 
ckh_£¬ch
(
ckh_t
 *
ckh
, cÚ¡ *
£¬chkey
, **
key
, **
d©a
);

76 
ckh_¡ršg_hash
(cÚ¡ *
key
, 
size_t
 
r_hash
[2]);

77 
boŞ
 
ckh_¡ršg_keycomp
(cÚ¡ *
k1
, cÚ¡ *
k2
);

78 
ckh_poš‹r_hash
(cÚ¡ *
key
, 
size_t
 
r_hash
[2]);

79 
boŞ
 
ckh_poš‹r_keycomp
(cÚ¡ *
k1
, cÚ¡ *
k2
);

83 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/ctl.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
ùl_node_s
 
	tùl_node_t
;

5 
ùl_Çmed_node_s
 
	tùl_Çmed_node_t
;

6 
ùl_šdexed_node_s
 
	tùl_šdexed_node_t
;

7 
ùl_¬’a_¡©s_s
 
	tùl_¬’a_¡©s_t
;

8 
ùl_¡©s_s
 
	tùl_¡©s_t
;

12 #ifdeà
JEMALLOC_H_STRUCTS


14 
	sùl_node_s
 {

15 
boŞ
 
	mÇmed
;

18 
	sùl_Çmed_node_s
 {

19 
ùl_node_s
 
	mnode
;

20 cÚ¡ *
	mÇme
;

22 
	mnchd»n
;

23 cÚ¡ 
ùl_node_t
 *
	mchd»n
;

24 (*
	mùl
)(
	mtsd_t
 *, cÚ¡ 
	msize_t
 *, size_t, *,

25 
	msize_t
 *, *, size_t);

28 
	sùl_šdexed_node_s
 {

29 
ùl_node_s
 
	mnode
;

30 cÚ¡ 
	mùl_Çmed_node_t
 *(*
	mšdex
)(
	mtsdn_t
 *, cÚ¡ 
	msize_t
 *, size_t,

31 
	msize_t
);

34 
	sùl_¬’a_¡©s_s
 {

35 
boŞ
 
	mš™Ÿlized
;

36 
	mÁh»ads
;

37 cÚ¡ *
	mdss
;

38 
ssize_t
 
	mlg_dœty_muÉ
;

39 
ssize_t
 
	mdeÿy_time
;

40 
size_t
 
	m·ùive
;

41 
size_t
 
	mpdœty
;

45 
¬’a_¡©s_t
 
	ma¡©s
;

48 
size_t
 
	m®loÿ‹d_sm®l
;

49 
ušt64_t
 
	mnm®loc_sm®l
;

50 
ušt64_t
 
	mnd®loc_sm®l
;

51 
ušt64_t
 
	mÄeque¡s_sm®l
;

53 
m®loc_bš_¡©s_t
 
	mb¡©s
[
NBINS
];

54 
m®loc_Ïrge_¡©s_t
 *
	ml¡©s
;

55 
m®loc_huge_¡©s_t
 *
	mh¡©s
;

58 
	sùl_¡©s_s
 {

59 
size_t
 
	m®loÿ‹d
;

60 
size_t
 
	maùive
;

61 
size_t
 
	mm‘ad©a
;

62 
size_t
 
	m»sid’t
;

63 
size_t
 
	mm­³d
;

64 
size_t
 
	m»šed
;

65 
	mÇ»Çs
;

66 
ùl_¬’a_¡©s_t
 *
	m¬’as
;

71 #ifdeà
JEMALLOC_H_EXTERNS


73 
ùl_byÇme
(
tsd_t
 *
tsd
, cÚ¡ *
Çme
, *
Şdp
, 
size_t
 *
ŞdËÅ
,

74 *
Ãwp
, 
size_t
 
ÃwËn
);

75 
ùl_Çm‘omib
(
tsdn_t
 *
tsdn
, cÚ¡ *
Çme
, 
size_t
 *
mibp
,

76 
size_t
 *
mibËÅ
);

78 
ùl_bymib
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

79 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
);

80 
boŞ
 
ùl_boÙ
();

81 
ùl_´efÜk
(
tsdn_t
 *
tsdn
);

82 
ùl_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
);

83 
ùl_po¡fÜk_chd
(
tsdn_t
 *
tsdn
);

85 
	#xm®lùl
(
Çme
, 
Şdp
, 
ŞdËÅ
, 
Ãwp
, 
ÃwËn
) do { \

86 ià(
	`je_m®lùl
(
Çme
, 
Şdp
, 
ŞdËÅ
, 
Ãwp
, 
ÃwËn
) \

88 
	`m®loc_´štf
( \

90 
Çme
); \

91 
	`abÜt
(); \

93 } 0)

	)

95 
	#xm®lùÊam‘omib
(
Çme
, 
mibp
, 
mibËÅ
) do { \

96 ià(
	`je_m®lùÊam‘omib
(
Çme
, 
mibp
, 
mibËÅ
) != 0) { \

97 
	`m®loc_´štf
("<jemalloc>: Failure in " \

98 "xm®lùÊam‘omib(\"%s\", ...)\n", 
Çme
); \

99 
	`abÜt
(); \

101 } 0)

	)

103 
	#xm®lùlbymib
(
mib
, 
mibËn
, 
Şdp
, 
ŞdËÅ
, 
Ãwp
, 
ÃwËn
) do { \

104 ià(
	`je_m®lùlbymib
(
mib
, 
mibËn
, 
Şdp
, 
ŞdËÅ
, 
Ãwp
, \

105 
ÃwËn
) != 0) { \

106 
	`m®loc_wr™e
( \

108 
	`abÜt
(); \

110 } 0)

	)

114 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/extent.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
ex‹Á_node_s
 
	tex‹Á_node_t
;

8 #ifdeà
JEMALLOC_H_STRUCTS


11 
	sex‹Á_node_s
 {

13 
¬’a_t
 *
	m’_¬’a
;

16 *
	m’_addr
;

19 
size_t
 
	m’_size
;

33 
size_t
 
	m’_¢
;

39 
boŞ
 
	m’_z”Ûd
;

46 
boŞ
 
	m’_comm™‹d
;

52 
boŞ
 
	m’_achunk
;

55 
´of_tùx_t
 *
	m’_´of_tùx
;

58 
¬’a_runs_dœty_lšk_t
 
	mrd
;

59 
qr
(
ex‹Á_node_t
è
	mcc_lšk
;

63 
rb_node
(
ex‹Á_node_t
è
	msz¢ad_lšk
;

66 
ql_–m
(
ex‹Á_node_t
è
	mql_lšk
;

70 
rb_node
(
ex‹Á_node_t
è
	mad_lšk
;

72 
	$rb_Œ“
(
	tex‹Á_node_t
è
	tex‹Á_Œ“_t
;

76 #ifdeà
JEMALLOC_H_EXTERNS


78 
	$rb_´Ùo
(, 
ex‹Á_Œ“_sz¢ad_
, 
ex‹Á_Œ“_t
, 
ex‹Á_node_t
)

80 
	$rb_´Ùo
(, 
ex‹Á_Œ“_ad_
, 
ex‹Á_Œ“_t
, 
ex‹Á_node_t
)

84 #ifdeà
JEMALLOC_H_INLINES


86 #iâdeà
JEMALLOC_ENABLE_INLINE


87 
¬’a_t
 *
	`ex‹Á_node_¬’a_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
);

88 *
	`ex‹Á_node_addr_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
);

89 
size_t
 
	`ex‹Á_node_size_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
);

90 
size_t
 
	`ex‹Á_node_¢_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
);

91 
boŞ
 
	`ex‹Á_node_z”Ûd_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
);

92 
boŞ
 
	`ex‹Á_node_comm™‹d_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
);

93 
boŞ
 
	`ex‹Á_node_achunk_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
);

94 
´of_tùx_t
 *
	`ex‹Á_node_´of_tùx_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
);

95 
	`ex‹Á_node_¬’a_£t
(
ex‹Á_node_t
 *
node
, 
¬’a_t
 *
¬’a
);

96 
	`ex‹Á_node_addr_£t
(
ex‹Á_node_t
 *
node
, *
addr
);

97 
	`ex‹Á_node_size_£t
(
ex‹Á_node_t
 *
node
, 
size_t
 
size
);

98 
	`ex‹Á_node_¢_£t
(
ex‹Á_node_t
 *
node
, 
size_t
 
¢
);

99 
	`ex‹Á_node_z”Ûd_£t
(
ex‹Á_node_t
 *
node
, 
boŞ
 
z”Ûd
);

100 
	`ex‹Á_node_comm™‹d_£t
(
ex‹Á_node_t
 *
node
, 
boŞ
 
comm™‹d
);

101 
	`ex‹Á_node_achunk_£t
(
ex‹Á_node_t
 *
node
, 
boŞ
 
achunk
);

102 
	`ex‹Á_node_´of_tùx_£t
(
ex‹Á_node_t
 *
node
, 
´of_tùx_t
 *
tùx
);

103 
	`ex‹Á_node_š™
(
ex‹Á_node_t
 *
node
, 
¬’a_t
 *
¬’a
, *
addr
,

104 
size_t
 
size
, size_ˆ
¢
, 
boŞ
 
z”Ûd
, boŞ 
comm™‹d
);

105 
	`ex‹Á_node_dœty_lškage_š™
(
ex‹Á_node_t
 *
node
);

106 
	`ex‹Á_node_dœty_š£¹
(
ex‹Á_node_t
 *
node
,

107 
¬’a_runs_dœty_lšk_t
 *
runs_dœty
, 
ex‹Á_node_t
 *
chunks_dœty
);

108 
	`ex‹Á_node_dœty_»move
(
ex‹Á_node_t
 *
node
);

111 #ià(
	`defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_EXTENT_C_
))

112 
JEMALLOC_INLINE
 
¬’a_t
 *

113 
	$ex‹Á_node_¬’a_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
)

116  (
node
->
’_¬’a
);

117 
	}
}

119 
JEMALLOC_INLINE
 *

120 
	$ex‹Á_node_addr_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
)

123  (
node
->
’_addr
);

124 
	}
}

126 
JEMALLOC_INLINE
 
size_t


127 
	$ex‹Á_node_size_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
)

130  (
node
->
’_size
);

131 
	}
}

133 
JEMALLOC_INLINE
 
size_t


134 
	$ex‹Á_node_¢_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
)

137  (
node
->
’_¢
);

138 
	}
}

140 
JEMALLOC_INLINE
 
boŞ


141 
	$ex‹Á_node_z”Ûd_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
)

144  (
node
->
’_z”Ûd
);

145 
	}
}

147 
JEMALLOC_INLINE
 
boŞ


148 
	$ex‹Á_node_comm™‹d_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
)

151 
	`as£¹
(!
node
->
’_achunk
);

152  (
node
->
’_comm™‹d
);

153 
	}
}

155 
JEMALLOC_INLINE
 
boŞ


156 
	$ex‹Á_node_achunk_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
)

159  (
node
->
’_achunk
);

160 
	}
}

162 
JEMALLOC_INLINE
 
´of_tùx_t
 *

163 
	$ex‹Á_node_´of_tùx_g‘
(cÚ¡ 
ex‹Á_node_t
 *
node
)

166  (
node
->
’_´of_tùx
);

167 
	}
}

169 
JEMALLOC_INLINE
 

170 
	$ex‹Á_node_¬’a_£t
(
ex‹Á_node_t
 *
node
, 
¬’a_t
 *
¬’a
)

173 
node
->
’_¬’a
 = 
¬’a
;

174 
	}
}

176 
JEMALLOC_INLINE
 

177 
	$ex‹Á_node_addr_£t
(
ex‹Á_node_t
 *
node
, *
addr
)

180 
node
->
’_addr
 = 
addr
;

181 
	}
}

183 
JEMALLOC_INLINE
 

184 
	$ex‹Á_node_size_£t
(
ex‹Á_node_t
 *
node
, 
size_t
 
size
)

187 
node
->
’_size
 = 
size
;

188 
	}
}

190 
JEMALLOC_INLINE
 

191 
	$ex‹Á_node_¢_£t
(
ex‹Á_node_t
 *
node
, 
size_t
 
¢
)

194 
node
->
’_¢
 = 
¢
;

195 
	}
}

197 
JEMALLOC_INLINE
 

198 
	$ex‹Á_node_z”Ûd_£t
(
ex‹Á_node_t
 *
node
, 
boŞ
 
z”Ûd
)

201 
node
->
’_z”Ûd
 = 
z”Ûd
;

202 
	}
}

204 
JEMALLOC_INLINE
 

205 
	$ex‹Á_node_comm™‹d_£t
(
ex‹Á_node_t
 *
node
, 
boŞ
 
comm™‹d
)

208 
node
->
’_comm™‹d
 = 
comm™‹d
;

209 
	}
}

211 
JEMALLOC_INLINE
 

212 
	$ex‹Á_node_achunk_£t
(
ex‹Á_node_t
 *
node
, 
boŞ
 
achunk
)

215 
node
->
’_achunk
 = 
achunk
;

216 
	}
}

218 
JEMALLOC_INLINE
 

219 
	$ex‹Á_node_´of_tùx_£t
(
ex‹Á_node_t
 *
node
, 
´of_tùx_t
 *
tùx
)

222 
node
->
’_´of_tùx
 = 
tùx
;

223 
	}
}

225 
JEMALLOC_INLINE
 

226 
	$ex‹Á_node_š™
(
ex‹Á_node_t
 *
node
, 
¬’a_t
 *
¬’a
, *
addr
, 
size_t
 
size
,

227 
size_t
 
¢
, 
boŞ
 
z”Ûd
, boŞ 
comm™‹d
)

230 
	`ex‹Á_node_¬’a_£t
(
node
, 
¬’a
);

231 
	`ex‹Á_node_addr_£t
(
node
, 
addr
);

232 
	`ex‹Á_node_size_£t
(
node
, 
size
);

233 
	`ex‹Á_node_¢_£t
(
node
, 
¢
);

234 
	`ex‹Á_node_z”Ûd_£t
(
node
, 
z”Ûd
);

235 
	`ex‹Á_node_comm™‹d_£t
(
node
, 
comm™‹d
);

236 
	`ex‹Á_node_achunk_£t
(
node
, 
çl£
);

237 ià(
cÚfig_´of
)

238 
	`ex‹Á_node_´of_tùx_£t
(
node
, 
NULL
);

239 
	}
}

241 
JEMALLOC_INLINE
 

242 
	$ex‹Á_node_dœty_lškage_š™
(
ex‹Á_node_t
 *
node
)

245 
	`qr_Ãw
(&
node
->
rd
, 
rd_lšk
);

246 
	`qr_Ãw
(
node
, 
cc_lšk
);

247 
	}
}

249 
JEMALLOC_INLINE
 

250 
	$ex‹Á_node_dœty_š£¹
(
ex‹Á_node_t
 *
node
,

251 
¬’a_runs_dœty_lšk_t
 *
runs_dœty
, 
ex‹Á_node_t
 *
chunks_dœty
)

254 
	`qr_m–d
(
runs_dœty
, &
node
->
rd
, 
rd_lšk
);

255 
	`qr_m–d
(
chunks_dœty
, 
node
, 
cc_lšk
);

256 
	}
}

258 
JEMALLOC_INLINE
 

259 
	$ex‹Á_node_dœty_»move
(
ex‹Á_node_t
 *
node
)

262 
	`qr_»move
(&
node
->
rd
, 
rd_lšk
);

263 
	`qr_»move
(
node
, 
cc_lšk
);

264 
	}
}

	@deps/jemalloc/include/jemalloc/internal/hash.h

7 #ifdeà
JEMALLOC_H_TYPES


11 #ifdeà
JEMALLOC_H_STRUCTS


15 #ifdeà
JEMALLOC_H_EXTERNS


19 #ifdeà
JEMALLOC_H_INLINES


21 #iâdeà
JEMALLOC_ENABLE_INLINE


22 
ušt32_t
 
hash_x86_32
(cÚ¡ *
key
, 
Ën
, ušt32_ˆ
£ed
);

23 
hash_x86_128
(cÚ¡ *
key
, cÚ¡ 
Ën
, 
ušt32_t
 
£ed
,

24 
ušt64_t
 
r_out
[2]);

25 
hash_x64_128
(cÚ¡ *
key
, cÚ¡ 
Ën
, cÚ¡ 
ušt32_t
 
£ed
,

26 
ušt64_t
 
r_out
[2]);

27 
hash
(cÚ¡ *
key
, 
size_t
 
Ën
, cÚ¡ 
ušt32_t
 
£ed
,

28 
size_t
 
r_hash
[2]);

31 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_HASH_C_
))

34 
JEMALLOC_INLINE
 
ušt32_t


35 
	$hash_rÙl_32
(
ušt32_t
 
x
, 
št8_t
 
r
)

38  ((
x
 << 
r
) | (x >> (32 -„)));

39 
	}
}

41 
JEMALLOC_INLINE
 
ušt64_t


42 
	$hash_rÙl_64
(
ušt64_t
 
x
, 
št8_t
 
r
)

45  ((
x
 << 
r
) | (x >> (64 -„)));

46 
	}
}

48 
JEMALLOC_INLINE
 
ušt32_t


49 
	$hash_g‘_block_32
(cÚ¡ 
ušt32_t
 *
p
, 
i
)

53 ià(
	`uÆik–y
((
ušŒ_t
)
p
 & ((
ušt32_t
)-1)) != 0) {

54 
ušt32_t
 
»t
;

56 
	`memıy
(&
»t
, (
ušt8_t
 *)(
p
 + 
i
), (
ušt32_t
));

57  (
»t
);

60  (
p
[
i
]);

61 
	}
}

63 
JEMALLOC_INLINE
 
ušt64_t


64 
	$hash_g‘_block_64
(cÚ¡ 
ušt64_t
 *
p
, 
i
)

68 ià(
	`uÆik–y
((
ušŒ_t
)
p
 & ((
ušt64_t
)-1)) != 0) {

69 
ušt64_t
 
»t
;

71 
	`memıy
(&
»t
, (
ušt8_t
 *)(
p
 + 
i
), (
ušt64_t
));

72  (
»t
);

75  (
p
[
i
]);

76 
	}
}

78 
JEMALLOC_INLINE
 
ušt32_t


79 
	$hash_fmix_32
(
ušt32_t
 
h
)

82 
h
 ^= h >> 16;

83 
h
 *= 0x85ebca6b;

84 
h
 ^= h >> 13;

85 
h
 *= 0xc2b2ae35;

86 
h
 ^= h >> 16;

88  (
h
);

89 
	}
}

91 
JEMALLOC_INLINE
 
ušt64_t


92 
	$hash_fmix_64
(
ušt64_t
 
k
)

95 
k
 ^= k >> 33;

96 
k
 *ğ
	`KQU
(0xff51afd7ed558ccd);

97 
k
 ^= k >> 33;

98 
k
 *ğ
	`KQU
(0xc4ceb9fe1a85ec53);

99 
k
 ^= k >> 33;

101  (
k
);

102 
	}
}

104 
JEMALLOC_INLINE
 
ušt32_t


105 
	$hash_x86_32
(cÚ¡ *
key
, 
Ën
, 
ušt32_t
 
£ed
)

107 cÚ¡ 
ušt8_t
 *
d©a
 = (cÚ¡ ušt8_ˆ*è
key
;

108 cÚ¡ 
nblocks
 = 
Ën
 / 4;

110 
ušt32_t
 
h1
 = 
£ed
;

112 cÚ¡ 
ušt32_t
 
c1
 = 0xcc9e2d51;

113 cÚ¡ 
ušt32_t
 
c2
 = 0x1b873593;

117 cÚ¡ 
ušt32_t
 *
blocks
 = (cÚ¡ ušt32_ˆ*è(
d©a
 + 
nblocks
*4);

118 
i
;

120 
i
 = -
nblocks
; i; i++) {

121 
ušt32_t
 
k1
 = 
	`hash_g‘_block_32
(
blocks
, 
i
);

123 
k1
 *ğ
c1
;

124 
k1
 = 
	`hash_rÙl_32
(k1, 15);

125 
k1
 *ğ
c2
;

127 
h1
 ^ğ
k1
;

128 
h1
 = 
	`hash_rÙl_32
(h1, 13);

129 
h1
 = h1*5 + 0xe6546b64;

135 cÚ¡ 
ušt8_t
 *

 = (cÚ¡ ušt8_ˆ*è(
d©a
 + 
nblocks
*4);

137 
ušt32_t
 
k1
 = 0;

139 
Ën
 & 3) {

140 3: 
k1
 ^ğ

[2] << 16;

141 2: 
k1
 ^ğ

[1] << 8;

142 1: 
k1
 ^ğ

[0]; k1 *ğ
c1
; k1 = 
	`hash_rÙl_32
(k1, 15);

143 
k1
 *ğ
c2
; 
h1
 ^= k1;

148 
h1
 ^ğ
Ën
;

150 
h1
 = 
	`hash_fmix_32
(h1);

152  (
h1
);

153 
	}
}

155 
UNUSED
 
JEMALLOC_INLINE
 

156 
	$hash_x86_128
(cÚ¡ *
key
, cÚ¡ 
Ën
, 
ušt32_t
 
£ed
,

157 
ušt64_t
 
r_out
[2])

159 cÚ¡ 
ušt8_t
 * 
d©a
 = (cÚ¡ ušt8_ˆ*è
key
;

160 cÚ¡ 
nblocks
 = 
Ën
 / 16;

162 
ušt32_t
 
h1
 = 
£ed
;

163 
ušt32_t
 
h2
 = 
£ed
;

164 
ušt32_t
 
h3
 = 
£ed
;

165 
ušt32_t
 
h4
 = 
£ed
;

167 cÚ¡ 
ušt32_t
 
c1
 = 0x239b961b;

168 cÚ¡ 
ušt32_t
 
c2
 = 0xab0e9789;

169 cÚ¡ 
ušt32_t
 
c3
 = 0x38b34ae5;

170 cÚ¡ 
ušt32_t
 
c4
 = 0xa1e38b93;

174 cÚ¡ 
ušt32_t
 *
blocks
 = (cÚ¡ ušt32_ˆ*è(
d©a
 + 
nblocks
*16);

175 
i
;

177 
i
 = -
nblocks
; i; i++) {

178 
ušt32_t
 
k1
 = 
	`hash_g‘_block_32
(
blocks
, 
i
*4 + 0);

179 
ušt32_t
 
k2
 = 
	`hash_g‘_block_32
(
blocks
, 
i
*4 + 1);

180 
ušt32_t
 
k3
 = 
	`hash_g‘_block_32
(
blocks
, 
i
*4 + 2);

181 
ušt32_t
 
k4
 = 
	`hash_g‘_block_32
(
blocks
, 
i
*4 + 3);

183 
k1
 *ğ
c1
; k1 = 
	`hash_rÙl_32
(k1, 15); k1 *ğ
c2
; 
h1
 ^= k1;

185 
h1
 = 
	`hash_rÙl_32
(h1, 19); h1 +ğ
h2
;

186 
h1
 = h1*5 + 0x561ccd1b;

188 
k2
 *ğ
c2
; k2 = 
	`hash_rÙl_32
(k2, 16); k2 *ğ
c3
; 
h2
 ^= k2;

190 
h2
 = 
	`hash_rÙl_32
(h2, 17); h2 +ğ
h3
;

191 
h2
 = h2*5 + 0x0bcaa747;

193 
k3
 *ğ
c3
; k3 = 
	`hash_rÙl_32
(k3, 17); k3 *ğ
c4
; 
h3
 ^= k3;

195 
h3
 = 
	`hash_rÙl_32
(h3, 15); h3 +ğ
h4
;

196 
h3
 = h3*5 + 0x96cd1c35;

198 
k4
 *ğ
c4
; k4 = 
	`hash_rÙl_32
(k4, 18); k4 *ğ
c1
; 
h4
 ^= k4;

200 
h4
 = 
	`hash_rÙl_32
(h4, 13); h4 +ğ
h1
;

201 
h4
 = h4*5 + 0x32ac3b17;

207 cÚ¡ 
ušt8_t
 *

 = (cÚ¡ ušt8_ˆ*è(
d©a
 + 
nblocks
*16);

208 
ušt32_t
 
k1
 = 0;

209 
ušt32_t
 
k2
 = 0;

210 
ušt32_t
 
k3
 = 0;

211 
ušt32_t
 
k4
 = 0;

213 
Ën
 & 15) {

214 15: 
k4
 ^ğ

[14] << 16;

215 14: 
k4
 ^ğ

[13] << 8;

216 13: 
k4
 ^ğ

[12] << 0;

217 
k4
 *ğ
c4
; k4 = 
	`hash_rÙl_32
(k4, 18); k4 *ğ
c1
; 
h4
 ^= k4;

219 12: 
k3
 ^ğ

[11] << 24;

220 11: 
k3
 ^ğ

[10] << 16;

221 10: 
k3
 ^ğ

[ 9] << 8;

222 9: 
k3
 ^ğ

[ 8] << 0;

223 
k3
 *ğ
c3
; k3 = 
	`hash_rÙl_32
(k3, 17); k3 *ğ
c4
; 
h3
 ^= k3;

225 8: 
k2
 ^ğ

[ 7] << 24;

226 7: 
k2
 ^ğ

[ 6] << 16;

227 6: 
k2
 ^ğ

[ 5] << 8;

228 5: 
k2
 ^ğ

[ 4] << 0;

229 
k2
 *ğ
c2
; k2 = 
	`hash_rÙl_32
(k2, 16); k2 *ğ
c3
; 
h2
 ^= k2;

231 4: 
k1
 ^ğ

[ 3] << 24;

232 3: 
k1
 ^ğ

[ 2] << 16;

233 2: 
k1
 ^ğ

[ 1] << 8;

234 1: 
k1
 ^ğ

[ 0] << 0;

235 
k1
 *ğ
c1
; k1 = 
	`hash_rÙl_32
(k1, 15); k1 *ğ
c2
; 
h1
 ^= k1;

240 
h1
 ^ğ
Ën
; 
h2
 ^ğËn; 
h3
 ^ğËn; 
h4
 ^=†en;

242 
h1
 +ğ
h2
; h1 +ğ
h3
; h1 +ğ
h4
;

243 
h2
 +ğ
h1
; 
h3
 +ğh1; 
h4
 += h1;

245 
h1
 = 
	`hash_fmix_32
(h1);

246 
h2
 = 
	`hash_fmix_32
(h2);

247 
h3
 = 
	`hash_fmix_32
(h3);

248 
h4
 = 
	`hash_fmix_32
(h4);

250 
h1
 +ğ
h2
; h1 +ğ
h3
; h1 +ğ
h4
;

251 
h2
 +ğ
h1
; 
h3
 +ğh1; 
h4
 += h1;

253 
r_out
[0] = (((
ušt64_t
è
h2
è<< 32è| 
h1
;

254 
r_out
[1] = (((
ušt64_t
è
h4
è<< 32è| 
h3
;

255 
	}
}

257 
UNUSED
 
JEMALLOC_INLINE
 

258 
	$hash_x64_128
(cÚ¡ *
key
, cÚ¡ 
Ën
, cÚ¡ 
ušt32_t
 
£ed
,

259 
ušt64_t
 
r_out
[2])

261 cÚ¡ 
ušt8_t
 *
d©a
 = (cÚ¡ ušt8_ˆ*è
key
;

262 cÚ¡ 
nblocks
 = 
Ën
 / 16;

264 
ušt64_t
 
h1
 = 
£ed
;

265 
ušt64_t
 
h2
 = 
£ed
;

267 cÚ¡ 
ušt64_t
 
c1
 = 
	`KQU
(0x87c37b91114253d5);

268 cÚ¡ 
ušt64_t
 
c2
 = 
	`KQU
(0x4cf5ad432745937f);

272 cÚ¡ 
ušt64_t
 *
blocks
 = (cÚ¡ ušt64_ˆ*è(
d©a
);

273 
i
;

275 
i
 = 0; i < 
nblocks
; i++) {

276 
ušt64_t
 
k1
 = 
	`hash_g‘_block_64
(
blocks
, 
i
*2 + 0);

277 
ušt64_t
 
k2
 = 
	`hash_g‘_block_64
(
blocks
, 
i
*2 + 1);

279 
k1
 *ğ
c1
; k1 = 
	`hash_rÙl_64
(k1, 31); k1 *ğ
c2
; 
h1
 ^= k1;

281 
h1
 = 
	`hash_rÙl_64
(h1, 27); h1 +ğ
h2
;

282 
h1
 = h1*5 + 0x52dce729;

284 
k2
 *ğ
c2
; k2 = 
	`hash_rÙl_64
(k2, 33); k2 *ğ
c1
; 
h2
 ^= k2;

286 
h2
 = 
	`hash_rÙl_64
(h2, 31); h2 +ğ
h1
;

287 
h2
 = h2*5 + 0x38495ab5;

293 cÚ¡ 
ušt8_t
 *

 = (cÚ¡ ušt8_t*)(
d©a
 + 
nblocks
*16);

294 
ušt64_t
 
k1
 = 0;

295 
ušt64_t
 
k2
 = 0;

297 
Ën
 & 15) {

298 15: 
k2
 ^ğ((
ušt64_t
)(

[14])) << 48;

299 14: 
k2
 ^ğ((
ušt64_t
)(

[13])) << 40;

300 13: 
k2
 ^ğ((
ušt64_t
)(

[12])) << 32;

301 12: 
k2
 ^ğ((
ušt64_t
)(

[11])) << 24;

302 11: 
k2
 ^ğ((
ušt64_t
)(

[10])) << 16;

303 10: 
k2
 ^ğ((
ušt64_t
)(

[ 9])) << 8;

304 9: 
k2
 ^ğ((
ušt64_t
)(

[ 8])) << 0;

305 
k2
 *ğ
c2
; k2 = 
	`hash_rÙl_64
(k2, 33); k2 *ğ
c1
; 
h2
 ^= k2;

307 8: 
k1
 ^ğ((
ušt64_t
)(

[ 7])) << 56;

308 7: 
k1
 ^ğ((
ušt64_t
)(

[ 6])) << 48;

309 6: 
k1
 ^ğ((
ušt64_t
)(

[ 5])) << 40;

310 5: 
k1
 ^ğ((
ušt64_t
)(

[ 4])) << 32;

311 4: 
k1
 ^ğ((
ušt64_t
)(

[ 3])) << 24;

312 3: 
k1
 ^ğ((
ušt64_t
)(

[ 2])) << 16;

313 2: 
k1
 ^ğ((
ušt64_t
)(

[ 1])) << 8;

314 1: 
k1
 ^ğ((
ušt64_t
)(

[ 0])) << 0;

315 
k1
 *ğ
c1
; k1 = 
	`hash_rÙl_64
(k1, 31); k1 *ğ
c2
; 
h1
 ^= k1;

320 
h1
 ^ğ
Ën
; 
h2
 ^=†en;

322 
h1
 +ğ
h2
;

323 
h2
 +ğ
h1
;

325 
h1
 = 
	`hash_fmix_64
(h1);

326 
h2
 = 
	`hash_fmix_64
(h2);

328 
h1
 +ğ
h2
;

329 
h2
 +ğ
h1
;

331 
r_out
[0] = 
h1
;

332 
r_out
[1] = 
h2
;

333 
	}
}

337 
JEMALLOC_INLINE
 

338 
	$hash
(cÚ¡ *
key
, 
size_t
 
Ën
, cÚ¡ 
ušt32_t
 
£ed
, size_ˆ
r_hash
[2])

341 
	`as£¹
(
Ën
 <ğ
INT_MAX
);

343 #ià(
LG_SIZEOF_PTR
 =ğ3 && !
	`defšed
(
JEMALLOC_BIG_ENDIAN
))

344 
	`hash_x64_128
(
key
, ()
Ën
, 
£ed
, (
ušt64_t
 *)
r_hash
);

347 
ušt64_t
 
hashes
[2];

348 
	`hash_x86_128
(
key
, ()
Ën
, 
£ed
, 
hashes
);

349 
r_hash
[0] = (
size_t
)
hashes
[0];

350 
r_hash
[1] = (
size_t
)
hashes
[1];

353 
	}
}

	@deps/jemalloc/include/jemalloc/internal/huge.h

2 #ifdeà
JEMALLOC_H_TYPES


6 #ifdeà
JEMALLOC_H_STRUCTS


10 #ifdeà
JEMALLOC_H_EXTERNS


12 *
huge_m®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
, 
boŞ
 
z”o
);

13 *
huge_·Îoc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
,

14 
size_t
 
®ignm’t
, 
boŞ
 
z”o
);

15 
boŞ
 
huge_¿Îoc_no_move
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
,

16 
size_t
 
usize_mš
, size_ˆ
usize_max
, 
boŞ
 
z”o
);

17 *
huge_¿Îoc
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, *
±r
, 
size_t
 
Şdsize
,

18 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
);

19 #ifdeà
JEMALLOC_JET


20 (
	thuge_d®loc_junk_t
)(*, 
	tsize_t
);

21 
huge_d®loc_junk_t
 *
huge_d®loc_junk
;

23 
	`huge_d®loc
(
tsdn_t
 *
tsdn
, *
±r
);

24 
¬’a_t
 *
	`huge_¯Îoc
(cÚ¡ *
±r
);

25 
size_t
 
	`huge_§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
);

26 
´of_tùx_t
 *
	`huge_´of_tùx_g‘
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
);

27 
	`huge_´of_tùx_£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
´of_tùx_t
 *
tùx
);

28 
	`huge_´of_tùx_»£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
);

32 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/jemalloc_internal.h

1 #iâdeà
JEMALLOC_INTERNAL_H


2 
	#JEMALLOC_INTERNAL_H


	)

4 
	~"jem®loc_š‹º®_defs.h
"

5 
	~"jem®loc/š‹º®/jem®loc_š‹º®_deşs.h
"

7 #ifdeà
JEMALLOC_UTRACE


8 
	~<sys/kŒaû.h
>

11 
	#JEMALLOC_NO_DEMANGLE


	)

12 #ifdeà
JEMALLOC_JET


13 
	#JEMALLOC_N
(
n
è
j‘_
##
	)
n

14 
	~"jem®loc/š‹º®/public_Çme¥aû.h
"

15 
	#JEMALLOC_NO_RENAME


	)

16 
	~"../jem®loc.h
"

17 #undeà
JEMALLOC_NO_RENAME


19 
	#JEMALLOC_N
(
n
è
je_
##
	)
n

20 
	~"../jem®loc.h
"

22 
	~"jem®loc/š‹º®/´iv©e_Çme¥aû.h
"

24 cÚ¡ 
boŞ
 
	gcÚfig_debug
 =

25 #ifdeà
JEMALLOC_DEBUG


26 
Œue


28 
çl£


31 cÚ¡ 
boŞ
 
	ghave_dss
 =

32 #ifdeà
JEMALLOC_DSS


33 
Œue


35 
çl£


38 cÚ¡ 
boŞ
 
	gcÚfig_fl
 =

39 #ifdeà
JEMALLOC_FILL


40 
Œue


42 
çl£


45 cÚ¡ 
boŞ
 
	gcÚfig_Ïzy_lock
 =

46 #ifdeà
JEMALLOC_LAZY_LOCK


47 
Œue


49 
çl£


52 cÚ¡ * cÚ¡ 
	gcÚfig_m®loc_cÚf
 = 
JEMALLOC_CONFIG_MALLOC_CONF
;

53 cÚ¡ 
boŞ
 
	gcÚfig_´of
 =

54 #ifdeà
JEMALLOC_PROF


55 
Œue


57 
çl£


60 cÚ¡ 
boŞ
 
	gcÚfig_´of_libgcc
 =

61 #ifdeà
JEMALLOC_PROF_LIBGCC


62 
Œue


64 
çl£


67 cÚ¡ 
boŞ
 
	gcÚfig_´of_libunwšd
 =

68 #ifdeà
JEMALLOC_PROF_LIBUNWIND


69 
Œue


71 
çl£


74 cÚ¡ 
boŞ
 
	gm­s_cßËsû
 =

75 #ifdeà
JEMALLOC_MAPS_COALESCE


76 
Œue


78 
çl£


81 cÚ¡ 
boŞ
 
	gcÚfig_munm­
 =

82 #ifdeà
JEMALLOC_MUNMAP


83 
Œue


85 
çl£


88 cÚ¡ 
boŞ
 
	gcÚfig_¡©s
 =

89 #ifdeà
JEMALLOC_STATS


90 
Œue


92 
çl£


95 cÚ¡ 
boŞ
 
	gcÚfig_tÿche
 =

96 #ifdeà
JEMALLOC_TCACHE


97 
Œue


99 
çl£


102 cÚ¡ 
boŞ
 
	gcÚfig_s
 =

103 #ifdeà
JEMALLOC_TLS


104 
Œue


106 
çl£


109 cÚ¡ 
boŞ
 
	gcÚfig_uŒaû
 =

110 #ifdeà
JEMALLOC_UTRACE


111 
Œue


113 
çl£


116 cÚ¡ 
boŞ
 
	gcÚfig_v®gršd
 =

117 #ifdeà
JEMALLOC_VALGRIND


118 
Œue


120 
çl£


123 cÚ¡ 
boŞ
 
	gcÚfig_xm®loc
 =

124 #ifdeà
JEMALLOC_XMALLOC


125 
Œue


127 
çl£


130 cÚ¡ 
boŞ
 
	gcÚfig_iv§Îoc
 =

131 #ifdeà
JEMALLOC_IVSALLOC


132 
Œue


134 
çl£


137 cÚ¡ 
boŞ
 
	gcÚfig_ÿche_oblivious
 =

138 #ifdeà
JEMALLOC_CACHE_OBLIVIOUS


139 
Œue


141 
çl£


145 #ifdeà
JEMALLOC_C11ATOMICS


146 
	~<¡d©omic.h
>

149 #ifdeà
JEMALLOC_ATOMIC9


150 
	~<machše/©omic.h
>

153 #ià(
defšed
(
JEMALLOC_OSATOMIC
è|| defšed(
JEMALLOC_OSSPIN
))

154 
	~<libk”n/OSAtomic.h
>

157 #ifdeà
JEMALLOC_ZONE


158 
	~<mach/mach_”rÜ.h
>

159 
	~<mach/mach_š™.h
>

160 
	~<mach/vm_m­.h
>

161 
	~<m®loc/m®loc.h
>

164 
	~"jem®loc/š‹º®/ph.h
"

165 #iâdeà
__PGI


166 
	#RB_COMPACT


	)

168 
	~"jem®loc/š‹º®/rb.h
"

169 
	~"jem®loc/š‹º®/qr.h
"

170 
	~"jem®loc/š‹º®/ql.h
"

186 
	#JEMALLOC_H_TYPES


	)

188 
	~"jem®loc/š‹º®/jem®loc_š‹º®_maüos.h
"

191 
	tpszšd_t
;

194 
	tszšd_t
;

207 
	#MALLOCX_ARENA_MASK
 (()~0xfffff)

	)

208 
	#MALLOCX_ARENA_MAX
 0xfã

	)

209 
	#MALLOCX_TCACHE_MASK
 (()~0xfff000ffU)

	)

210 
	#MALLOCX_TCACHE_MAX
 0xffd

	)

211 
	#MALLOCX_LG_ALIGN_MASK
 (()0x3f)

	)

213 
	#MALLOCX_ALIGN_GET_SPECIFIED
(
æags
) \

214 (
	`ZU
(1è<< (
æags
 & 
MALLOCX_LG_ALIGN_MASK
))

	)

215 
	#MALLOCX_ALIGN_GET
(
æags
) \

216 (
	`MALLOCX_ALIGN_GET_SPECIFIED
(
æags
è& (
SIZE_T_MAX
-1))

	)

217 
	#MALLOCX_ZERO_GET
(
æags
) \

218 ((
boŞ
)(
æags
 & 
MALLOCX_ZERO
))

	)

220 
	#MALLOCX_TCACHE_GET
(
æags
) \

221 ((()((
æags
 & 
MALLOCX_TCACHE_MASK
è>> 8)è- 2)

	)

222 
	#MALLOCX_ARENA_GET
(
æags
) \

223 ((()((()
æags
è>> 20)è- 1)

	)

226 
	#TINY_MIN
 (1U << 
LG_TINY_MIN
)

	)

232 #iâdeà
LG_QUANTUM


233 #ià(
defšed
(
__i386__
è|| defšed(
_M_IX86
))

234 
	#LG_QUANTUM
 4

	)

236 #ifdeà
__Ÿ64__


237 
	#LG_QUANTUM
 4

	)

239 #ifdeà
__®pha__


240 
	#LG_QUANTUM
 4

	)

242 #ià(
defšed
(
__¥¬c64__
è|| defšed(
__¥¬cv9
è|| defšed(
__¥¬c_v9__
))

243 
	#LG_QUANTUM
 4

	)

245 #ià(
defšed
(
__amd64__
è|| defšed(
__x86_64__
è|| defšed(
_M_X64
))

246 
	#LG_QUANTUM
 4

	)

248 #ifdeà
__¬m__


249 
	#LG_QUANTUM
 3

	)

251 #ifdeà
__¯rch64__


252 
	#LG_QUANTUM
 4

	)

254 #ifdeà
__hµa__


255 
	#LG_QUANTUM
 4

	)

257 #ifdeà
__ms__


258 
	#LG_QUANTUM
 3

	)

260 #ifdeà
__Ü1k__


261 
	#LG_QUANTUM
 3

	)

263 #ifdeà
__pow”pc__


264 
	#LG_QUANTUM
 4

	)

266 #ifdeà
__riscv__


267 
	#LG_QUANTUM
 4

	)

269 #ifdeà
__s390__


270 
	#LG_QUANTUM
 4

	)

272 #ifdeà
__SH4__


273 
	#LG_QUANTUM
 4

	)

275 #ifdeà
__te__


276 
	#LG_QUANTUM
 4

	)

278 #ifdeà
__Ë32__


279 
	#LG_QUANTUM
 4

	)

281 #iâdeà
LG_QUANTUM


287 
	#QUANTUM
 ((
size_t
)(1U << 
LG_QUANTUM
))

	)

288 
	#QUANTUM_MASK
 (
QUANTUM
 - 1)

	)

291 
	#QUANTUM_CEILING
(
a
) \

292 (((
a
è+ 
QUANTUM_MASK
è& ~QUANTUM_MASK)

	)

294 
	#LONG
 ((
size_t
)(1U << 
LG_SIZEOF_LONG
))

	)

295 
	#LONG_MASK
 (
LONG
 - 1)

	)

298 
	#LONG_CEILING
(
a
) \

299 (((
a
è+ 
LONG_MASK
è& ~LONG_MASK)

	)

301 
	#SIZEOF_PTR
 (1U << 
LG_SIZEOF_PTR
)

	)

302 
	#PTR_MASK
 (
SIZEOF_PTR
 - 1)

	)

305 
	#PTR_CEILING
(
a
) \

306 (((
a
è+ 
PTR_MASK
è& ~PTR_MASK)

	)

315 
	#LG_CACHELINE
 6

	)

316 
	#CACHELINE
 64

	)

317 
	#CACHELINE_MASK
 (
CACHELINE
 - 1)

	)

320 
	#CACHELINE_CEILING
(
s
) \

321 (((
s
è+ 
CACHELINE_MASK
è& ~CACHELINE_MASK)

	)

324 #ifdeà
PAGE_MASK


325 #undeà
PAGE_MASK


327 
	#PAGE
 ((
size_t
)(1U << 
LG_PAGE
))

	)

328 
	#PAGE_MASK
 ((
size_t
)(
PAGE
 - 1))

	)

331 
	#PAGE_ADDR2BASE
(
a
) \

332 ((*)((
ušŒ_t
)(
a
è& ~
PAGE_MASK
))

	)

335 
	#PAGE_CEILING
(
s
) \

336 (((
s
è+ 
PAGE_MASK
è& ~PAGE_MASK)

	)

339 
	#ALIGNMENT_ADDR2BASE
(
a
, 
®ignm’t
) \

340 ((*)((
ušŒ_t
)(
a
è& ((~(
®ignm’t
)è+ 1)))

	)

343 
	#ALIGNMENT_ADDR2OFFSET
(
a
, 
®ignm’t
) \

344 ((
size_t
)((
ušŒ_t
)(
a
è& (
®ignm’t
 - 1)))

	)

347 
	#ALIGNMENT_CEILING
(
s
, 
®ignm’t
) \

348 (((
s
è+ (
®ignm’t
 - 1)è& ((~×lignm’t)è+ 1))

	)

351 #ià
__STDC_VERSION__
 < 199901L

352 #ifdeà
_MSC_VER


353 
	~<m®loc.h
>

354 
	#®loÿ
 
_®loÿ


	)

356 #ifdeà
JEMALLOC_HAS_ALLOCA_H


357 
	~<®loÿ.h
>

359 
	~<¡dlib.h
>

362 
	#VARIABLE_ARRAY
(
ty³
, 
Çme
, 
couÁ
) \

363 
ty³
 *
Çme
 = 
	`®loÿ
(Ñy³è* (
couÁ
))

	)

365 
	#VARIABLE_ARRAY
(
ty³
, 
Çme
, 
couÁ
èty³‚ame[(couÁ)]

	)

368 
	~"jem®loc/š‹º®/n¡ime.h
"

369 
	~"jem®loc/š‹º®/v®gršd.h
"

370 
	~"jem®loc/š‹º®/ut.h
"

371 
	~"jem®loc/š‹º®/©omic.h
"

372 
	~"jem®loc/š‹º®/¥š.h
"

373 
	~"jem®loc/š‹º®/´ng.h
"

374 
	~"jem®loc/š‹º®/tick”.h
"

375 
	~"jem®loc/š‹º®/ckh.h
"

376 
	~"jem®loc/š‹º®/size_şas£s.h
"

377 
	~"jem®loc/š‹º®/smoÙh¡•.h
"

378 
	~"jem®loc/š‹º®/¡©s.h
"

379 
	~"jem®loc/š‹º®/ùl.h
"

380 
	~"jem®loc/š‹º®/w™Ãss.h
"

381 
	~"jem®loc/š‹º®/mu‹x.h
"

382 
	~"jem®loc/š‹º®/tsd.h
"

383 
	~"jem®loc/š‹º®/mb.h
"

384 
	~"jem®loc/š‹º®/ex‹Á.h
"

385 
	~"jem®loc/š‹º®/¬’a.h
"

386 
	~"jem®loc/š‹º®/b™m­.h
"

387 
	~"jem®loc/š‹º®/ba£.h
"

388 
	~"jem®loc/š‹º®/¹»e.h
"

389 
	~"jem®loc/š‹º®/·ges.h
"

390 
	~"jem®loc/š‹º®/chunk.h
"

391 
	~"jem®loc/š‹º®/huge.h
"

392 
	~"jem®loc/š‹º®/tÿche.h
"

393 
	~"jem®loc/š‹º®/hash.h
"

394 
	~"jem®loc/š‹º®/qu¬ªtše.h
"

395 
	~"jem®loc/š‹º®/´of.h
"

397 #undeà
JEMALLOC_H_TYPES


399 
	#JEMALLOC_H_STRUCTS


	)

401 
	~"jem®loc/š‹º®/n¡ime.h
"

402 
	~"jem®loc/š‹º®/v®gršd.h
"

403 
	~"jem®loc/š‹º®/ut.h
"

404 
	~"jem®loc/š‹º®/©omic.h
"

405 
	~"jem®loc/š‹º®/¥š.h
"

406 
	~"jem®loc/š‹º®/´ng.h
"

407 
	~"jem®loc/š‹º®/tick”.h
"

408 
	~"jem®loc/š‹º®/ckh.h
"

409 
	~"jem®loc/š‹º®/size_şas£s.h
"

410 
	~"jem®loc/š‹º®/smoÙh¡•.h
"

411 
	~"jem®loc/š‹º®/¡©s.h
"

412 
	~"jem®loc/š‹º®/ùl.h
"

413 
	~"jem®loc/š‹º®/w™Ãss.h
"

414 
	~"jem®loc/š‹º®/mu‹x.h
"

415 
	~"jem®loc/š‹º®/mb.h
"

416 
	~"jem®loc/š‹º®/b™m­.h
"

417 
	#JEMALLOC_ARENA_STRUCTS_A


	)

418 
	~"jem®loc/š‹º®/¬’a.h
"

419 #undeà
JEMALLOC_ARENA_STRUCTS_A


420 
	~"jem®loc/š‹º®/ex‹Á.h
"

421 
	#JEMALLOC_ARENA_STRUCTS_B


	)

422 
	~"jem®loc/š‹º®/¬’a.h
"

423 #undeà
JEMALLOC_ARENA_STRUCTS_B


424 
	~"jem®loc/š‹º®/ba£.h
"

425 
	~"jem®loc/š‹º®/¹»e.h
"

426 
	~"jem®loc/š‹º®/·ges.h
"

427 
	~"jem®loc/š‹º®/chunk.h
"

428 
	~"jem®loc/š‹º®/huge.h
"

429 
	~"jem®loc/š‹º®/tÿche.h
"

430 
	~"jem®loc/š‹º®/hash.h
"

431 
	~"jem®loc/š‹º®/qu¬ªtše.h
"

432 
	~"jem®loc/š‹º®/´of.h
"

434 
	~"jem®loc/š‹º®/tsd.h
"

436 #undeà
JEMALLOC_H_STRUCTS


438 
	#JEMALLOC_H_EXTERNS


	)

440 
boŞ
 
İt_abÜt
;

441 cÚ¡ *
İt_junk
;

442 
boŞ
 
İt_junk_®loc
;

443 
boŞ
 
İt_junk_ä“
;

444 
size_t
 
İt_qu¬ªtše
;

445 
boŞ
 
İt_»dzÚe
;

446 
boŞ
 
İt_uŒaû
;

447 
boŞ
 
İt_xm®loc
;

448 
boŞ
 
İt_z”o
;

449 
İt_Ç»Çs
;

451 
boŞ
 
š_v®gršd
;

454 
nıus
;

457 
Ç»Çs_auto
;

463 
¬’a_t
 **
¬’as
;

469 
size_t
 cÚ¡ 
pšd2sz_b
[
NPSIZES
];

474 
size_t
 cÚ¡ 
šdex2size_b
[
NSIZES
];

480 
ušt8_t
 cÚ¡ 
size2šdex_b
[];

482 
¬’a_t
 *
a0g‘
();

483 *
a0m®loc
(
size_t
 
size
);

484 
a0d®loc
(*
±r
);

485 *
boÙ¡¿p_m®loc
(
size_t
 
size
);

486 *
boÙ¡¿p_ÿÎoc
(
size_t
 
num
, size_ˆ
size
);

487 
boÙ¡¿p_ä“
(*
±r
);

488 
Ç»Çs_tÙ®_g‘
();

489 
¬’a_t
 *
¬’a_š™
(
tsdn_t
 *
tsdn
, 
šd
);

490 
¬’a_td©a_t
 *
¬’a_td©a_g‘_h¬d
(
tsd_t
 *
tsd
, 
šd
);

491 
¬’a_t
 *
¬’a_choo£_h¬d
(
tsd_t
 *
tsd
, 
boŞ
 
š‹º®
);

492 
¬’a_mig¿‹
(
tsd_t
 *
tsd
, 
Şdšd
, 
Ãwšd
);

493 
th»ad_®loÿ‹d_ş—nup
(
tsd_t
 *
tsd
);

494 
th»ad_d—Îoÿ‹d_ş—nup
(
tsd_t
 *
tsd
);

495 
Ÿ»Ç_ş—nup
(
tsd_t
 *
tsd
);

496 
¬’a_ş—nup
(
tsd_t
 *
tsd
);

497 
¬’as_td©a_ş—nup
(
tsd_t
 *
tsd
);

498 
Ç»Çs_td©a_ş—nup
(
tsd_t
 *
tsd
);

499 
¬’as_td©a_by·ss_ş—nup
(
tsd_t
 *
tsd
);

500 
jem®loc_´efÜk
();

501 
jem®loc_po¡fÜk_·»Á
();

502 
jem®loc_po¡fÜk_chd
();

504 
	~"jem®loc/š‹º®/n¡ime.h
"

505 
	~"jem®loc/š‹º®/v®gršd.h
"

506 
	~"jem®loc/š‹º®/ut.h
"

507 
	~"jem®loc/š‹º®/©omic.h
"

508 
	~"jem®loc/š‹º®/¥š.h
"

509 
	~"jem®loc/š‹º®/´ng.h
"

510 
	~"jem®loc/š‹º®/tick”.h
"

511 
	~"jem®loc/š‹º®/ckh.h
"

512 
	~"jem®loc/š‹º®/size_şas£s.h
"

513 
	~"jem®loc/š‹º®/smoÙh¡•.h
"

514 
	~"jem®loc/š‹º®/¡©s.h
"

515 
	~"jem®loc/š‹º®/ùl.h
"

516 
	~"jem®loc/š‹º®/w™Ãss.h
"

517 
	~"jem®loc/š‹º®/mu‹x.h
"

518 
	~"jem®loc/š‹º®/mb.h
"

519 
	~"jem®loc/š‹º®/b™m­.h
"

520 
	~"jem®loc/š‹º®/ex‹Á.h
"

521 
	~"jem®loc/š‹º®/¬’a.h
"

522 
	~"jem®loc/š‹º®/ba£.h
"

523 
	~"jem®loc/š‹º®/¹»e.h
"

524 
	~"jem®loc/š‹º®/·ges.h
"

525 
	~"jem®loc/š‹º®/chunk.h
"

526 
	~"jem®loc/š‹º®/huge.h
"

527 
	~"jem®loc/š‹º®/tÿche.h
"

528 
	~"jem®loc/š‹º®/hash.h
"

529 
	~"jem®loc/š‹º®/qu¬ªtše.h
"

530 
	~"jem®loc/š‹º®/´of.h
"

531 
	~"jem®loc/š‹º®/tsd.h
"

533 #undeà
JEMALLOC_H_EXTERNS


535 
	#JEMALLOC_H_INLINES


	)

537 
	~"jem®loc/š‹º®/n¡ime.h
"

538 
	~"jem®loc/š‹º®/v®gršd.h
"

539 
	~"jem®loc/š‹º®/ut.h
"

540 
	~"jem®loc/š‹º®/©omic.h
"

541 
	~"jem®loc/š‹º®/¥š.h
"

542 
	~"jem®loc/š‹º®/´ng.h
"

543 
	~"jem®loc/š‹º®/tick”.h
"

544 
	~"jem®loc/š‹º®/ckh.h
"

545 
	~"jem®loc/š‹º®/size_şas£s.h
"

546 
	~"jem®loc/š‹º®/smoÙh¡•.h
"

547 
	~"jem®loc/š‹º®/¡©s.h
"

548 
	~"jem®loc/š‹º®/ùl.h
"

549 
	~"jem®loc/š‹º®/tsd.h
"

550 
	~"jem®loc/š‹º®/w™Ãss.h
"

551 
	~"jem®loc/š‹º®/mu‹x.h
"

552 
	~"jem®loc/š‹º®/mb.h
"

553 
	~"jem®loc/š‹º®/ex‹Á.h
"

554 
	~"jem®loc/š‹º®/ba£.h
"

555 
	~"jem®loc/š‹º®/¹»e.h
"

556 
	~"jem®loc/š‹º®/·ges.h
"

557 
	~"jem®loc/š‹º®/chunk.h
"

558 
	~"jem®loc/š‹º®/huge.h
"

560 #iâdeà
JEMALLOC_ENABLE_INLINE


561 
pszšd_t
 
psz2šd
(
size_t
 
psz
);

562 
size_t
 
pšd2sz_compu‹
(
pszšd_t
 
pšd
);

563 
size_t
 
pšd2sz_lookup
(
pszšd_t
 
pšd
);

564 
size_t
 
pšd2sz
(
pszšd_t
 
pšd
);

565 
size_t
 
psz2u
(size_ˆ
psz
);

566 
szšd_t
 
size2šdex_compu‹
(
size_t
 
size
);

567 
szšd_t
 
size2šdex_lookup
(
size_t
 
size
);

568 
szšd_t
 
size2šdex
(
size_t
 
size
);

569 
size_t
 
šdex2size_compu‹
(
szšd_t
 
šdex
);

570 
size_t
 
šdex2size_lookup
(
szšd_t
 
šdex
);

571 
size_t
 
šdex2size
(
szšd_t
 
šdex
);

572 
size_t
 
s2u_compu‹
(size_ˆ
size
);

573 
size_t
 
s2u_lookup
(size_ˆ
size
);

574 
size_t
 
s2u
(size_ˆ
size
);

575 
size_t
 
§2u
(size_ˆ
size
, size_ˆ
®ignm’t
);

576 
¬’a_t
 *
¬’a_choo£_im¶
(
tsd_t
 *
tsd
,‡»Ç_ˆ*
¬’a
, 
boŞ
 
š‹º®
);

577 
¬’a_t
 *
¬’a_choo£
(
tsd_t
 *
tsd
,‡»Ç_ˆ*
¬’a
);

578 
¬’a_t
 *
¬’a_ichoo£
(
tsd_t
 *
tsd
,‡»Ç_ˆ*
¬’a
);

579 
¬’a_td©a_t
 *
¬’a_td©a_g‘
(
tsd_t
 *
tsd
, 
šd
,

580 
boŞ
 
»äesh_if_missšg
);

581 
¬’a_t
 *
¬’a_g‘
(
tsdn_t
 *
tsdn
, 
šd
, 
boŞ
 
š™_if_missšg
);

582 
tick”_t
 *
deÿy_tick”_g‘
(
tsd_t
 *
tsd
, 
šd
);

585 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_C_
))

586 
JEMALLOC_INLINE
 
pszšd_t


587 
	$psz2šd
(
size_t
 
psz
)

590 ià(
	`uÆik–y
(
psz
 > 
HUGE_MAXCLASS
))

591  (
NPSIZES
);

593 
pszšd_t
 
x
 = 
	`lg_æoÜ
((
psz
<<1)-1);

594 
pszšd_t
 
shiá
 = (
x
 < 
LG_SIZE_CLASS_GROUP
 + 
LG_PAGE
) ? 0 : x -

595 (
LG_SIZE_CLASS_GROUP
 + 
LG_PAGE
);

596 
pszšd_t
 
g½
 = 
shiá
 << 
LG_SIZE_CLASS_GROUP
;

598 
pszšd_t
 
lg_d–
 = (
x
 < 
LG_SIZE_CLASS_GROUP
 + 
LG_PAGE
 + 1) ?

599 
LG_PAGE
 : 
x
 - 
LG_SIZE_CLASS_GROUP
 - 1;

601 
size_t
 
d–_šv”£_mask
 = 
	`ZI
(-1è<< 
lg_d–
;

602 
pszšd_t
 
mod
 = ((((
psz
-1è& 
d–_šv”£_mask
è>> 
lg_d–
)) &

603 ((
	`ZU
(1è<< 
LG_SIZE_CLASS_GROUP
) - 1);

605 
pszšd_t
 
šd
 = 
g½
 + 
mod
;

606  (
šd
);

608 
	}
}

610 
JEMALLOC_INLINE
 
size_t


611 
	$pšd2sz_compu‹
(
pszšd_t
 
pšd
)

615 
size_t
 
g½
 = 
pšd
 >> 
LG_SIZE_CLASS_GROUP
;

616 
size_t
 
mod
 = 
pšd
 & ((
	`ZU
(1è<< 
LG_SIZE_CLASS_GROUP
) - 1);

618 
size_t
 
g½_size_mask
 = ~((!!
g½
)-1);

619 
size_t
 
g½_size
 = ((
	`ZU
(1è<< (
LG_PAGE
 +

620 (
LG_SIZE_CLASS_GROUP
-1))è<< 
g½
è& 
g½_size_mask
;

622 
size_t
 
shiá
 = (
g½
 == 0) ? 1 : grp;

623 
size_t
 
lg_d–
 = 
shiá
 + (
LG_PAGE
-1);

624 
size_t
 
mod_size
 = (
mod
+1è<< 
lg_d–
;

626 
size_t
 
sz
 = 
g½_size
 + 
mod_size
;

627  (
sz
);

629 
	}
}

631 
JEMALLOC_INLINE
 
size_t


632 
	$pšd2sz_lookup
(
pszšd_t
 
pšd
)

634 
size_t
 
»t
 = (size_t)
pšd2sz_b
[
pšd
];

635 
	`as£¹
(
»t
 =ğ
	`pšd2sz_compu‹
(
pšd
));

636  (
»t
);

637 
	}
}

639 
JEMALLOC_INLINE
 
size_t


640 
	$pšd2sz
(
pszšd_t
 
pšd
)

643 
	`as£¹
(
pšd
 < 
NPSIZES
);

644  (
	`pšd2sz_lookup
(
pšd
));

645 
	}
}

647 
JEMALLOC_INLINE
 
size_t


648 
	$psz2u
(
size_t
 
psz
)

651 ià(
	`uÆik–y
(
psz
 > 
HUGE_MAXCLASS
))

654 
size_t
 
x
 = 
	`lg_æoÜ
((
psz
<<1)-1);

655 
size_t
 
lg_d–
 = (
x
 < 
LG_SIZE_CLASS_GROUP
 + 
LG_PAGE
 + 1) ?

656 
LG_PAGE
 : 
x
 - 
LG_SIZE_CLASS_GROUP
 - 1;

657 
size_t
 
d–
 = 
	`ZU
(1è<< 
lg_d–
;

658 
size_t
 
d–_mask
 = 
d–
 - 1;

659 
size_t
 
usize
 = (
psz
 + 
d–_mask
) & ~delta_mask;

660  (
usize
);

662 
	}
}

664 
JEMALLOC_INLINE
 
szšd_t


665 
	$size2šdex_compu‹
(
size_t
 
size
)

668 ià(
	`uÆik–y
(
size
 > 
HUGE_MAXCLASS
))

669  (
NSIZES
);

670 #ià(
NTBINS
 != 0)

671 ià(
size
 <ğ(
	`ZU
(1è<< 
LG_TINY_MAXCLASS
)) {

672 
szšd_t
 
lg_tmš
 = 
LG_TINY_MAXCLASS
 - 
NTBINS
 + 1;

673 
szšd_t
 
lg_û
 = 
	`lg_æoÜ
(
	`pow2_û_zu
(
size
));

674  (
lg_û
 < 
lg_tmš
 ? 0 :†g_ceil -†g_tmin);

678 
szšd_t
 
x
 = 
	`lg_æoÜ
((
size
<<1)-1);

679 
szšd_t
 
shiá
 = (
x
 < 
LG_SIZE_CLASS_GROUP
 + 
LG_QUANTUM
) ? 0 :

680 
x
 - (
LG_SIZE_CLASS_GROUP
 + 
LG_QUANTUM
);

681 
szšd_t
 
g½
 = 
shiá
 << 
LG_SIZE_CLASS_GROUP
;

683 
szšd_t
 
lg_d–
 = (
x
 < 
LG_SIZE_CLASS_GROUP
 + 
LG_QUANTUM
 + 1)

684 ? 
LG_QUANTUM
 : 
x
 - 
LG_SIZE_CLASS_GROUP
 - 1;

686 
size_t
 
d–_šv”£_mask
 = 
	`ZI
(-1è<< 
lg_d–
;

687 
szšd_t
 
mod
 = ((((
size
-1è& 
d–_šv”£_mask
è>> 
lg_d–
)) &

688 ((
	`ZU
(1è<< 
LG_SIZE_CLASS_GROUP
) - 1);

690 
szšd_t
 
šdex
 = 
NTBINS
 + 
g½
 + 
mod
;

691  (
šdex
);

693 
	}
}

695 
JEMALLOC_ALWAYS_INLINE
 
szšd_t


696 
	$size2šdex_lookup
(
size_t
 
size
)

699 
	`as£¹
(
size
 <ğ
LOOKUP_MAXCLASS
);

701 
szšd_t
 
»t
 = (
size2šdex_b
[(
size
-1è>> 
LG_TINY_MIN
]);

702 
	`as£¹
(
»t
 =ğ
	`size2šdex_compu‹
(
size
));

703  (
»t
);

705 
	}
}

707 
JEMALLOC_ALWAYS_INLINE
 
szšd_t


708 
	$size2šdex
(
size_t
 
size
)

711 
	`as£¹
(
size
 > 0);

712 ià(
	`lik–y
(
size
 <ğ
LOOKUP_MAXCLASS
))

713  (
	`size2šdex_lookup
(
size
));

714  (
	`size2šdex_compu‹
(
size
));

715 
	}
}

717 
JEMALLOC_INLINE
 
size_t


718 
	$šdex2size_compu‹
(
szšd_t
 
šdex
)

721 #ià(
NTBINS
 > 0)

722 ià(
šdex
 < 
NTBINS
)

723  (
	`ZU
(1è<< (
LG_TINY_MAXCLASS
 - 
NTBINS
 + 1 + 
šdex
));

726 
size_t
 
»duûd_šdex
 = 
šdex
 - 
NTBINS
;

727 
size_t
 
g½
 = 
»duûd_šdex
 >> 
LG_SIZE_CLASS_GROUP
;

728 
size_t
 
mod
 = 
»duûd_šdex
 & ((
	`ZU
(1è<< 
LG_SIZE_CLASS_GROUP
) -

731 
size_t
 
g½_size_mask
 = ~((!!
g½
)-1);

732 
size_t
 
g½_size
 = ((
	`ZU
(1è<< (
LG_QUANTUM
 +

733 (
LG_SIZE_CLASS_GROUP
-1))è<< 
g½
è& 
g½_size_mask
;

735 
size_t
 
shiá
 = (
g½
 == 0) ? 1 : grp;

736 
size_t
 
lg_d–
 = 
shiá
 + (
LG_QUANTUM
-1);

737 
size_t
 
mod_size
 = (
mod
+1è<< 
lg_d–
;

739 
size_t
 
usize
 = 
g½_size
 + 
mod_size
;

740  (
usize
);

742 
	}
}

744 
JEMALLOC_ALWAYS_INLINE
 
size_t


745 
	$šdex2size_lookup
(
szšd_t
 
šdex
)

747 
size_t
 
»t
 = (size_t)
šdex2size_b
[
šdex
];

748 
	`as£¹
(
»t
 =ğ
	`šdex2size_compu‹
(
šdex
));

749  (
»t
);

750 
	}
}

752 
JEMALLOC_ALWAYS_INLINE
 
size_t


753 
	$šdex2size
(
szšd_t
 
šdex
)

756 
	`as£¹
(
šdex
 < 
NSIZES
);

757  (
	`šdex2size_lookup
(
šdex
));

758 
	}
}

760 
JEMALLOC_ALWAYS_INLINE
 
size_t


761 
	$s2u_compu‹
(
size_t
 
size
)

764 ià(
	`uÆik–y
(
size
 > 
HUGE_MAXCLASS
))

766 #ià(
NTBINS
 > 0)

767 ià(
size
 <ğ(
	`ZU
(1è<< 
LG_TINY_MAXCLASS
)) {

768 
size_t
 
lg_tmš
 = 
LG_TINY_MAXCLASS
 - 
NTBINS
 + 1;

769 
size_t
 
lg_û
 = 
	`lg_æoÜ
(
	`pow2_û_zu
(
size
));

770  (
lg_û
 < 
lg_tmš
 ? (
	`ZU
(1) <<†g_tmin) :

771 (
	`ZU
(1è<< 
lg_û
));

775 
size_t
 
x
 = 
	`lg_æoÜ
((
size
<<1)-1);

776 
size_t
 
lg_d–
 = (
x
 < 
LG_SIZE_CLASS_GROUP
 + 
LG_QUANTUM
 + 1)

777 ? 
LG_QUANTUM
 : 
x
 - 
LG_SIZE_CLASS_GROUP
 - 1;

778 
size_t
 
d–
 = 
	`ZU
(1è<< 
lg_d–
;

779 
size_t
 
d–_mask
 = 
d–
 - 1;

780 
size_t
 
usize
 = (
size
 + 
d–_mask
) & ~delta_mask;

781  (
usize
);

783 
	}
}

785 
JEMALLOC_ALWAYS_INLINE
 
size_t


786 
	$s2u_lookup
(
size_t
 
size
)

788 
size_t
 
»t
 = 
	`šdex2size_lookup
(
	`size2šdex_lookup
(
size
));

790 
	`as£¹
(
»t
 =ğ
	`s2u_compu‹
(
size
));

791  (
»t
);

792 
	}
}

798 
JEMALLOC_ALWAYS_INLINE
 
size_t


799 
	$s2u
(
size_t
 
size
)

802 
	`as£¹
(
size
 > 0);

803 ià(
	`lik–y
(
size
 <ğ
LOOKUP_MAXCLASS
))

804  (
	`s2u_lookup
(
size
));

805  (
	`s2u_compu‹
(
size
));

806 
	}
}

812 
JEMALLOC_ALWAYS_INLINE
 
size_t


813 
	$§2u
(
size_t
 
size
, size_ˆ
®ignm’t
)

815 
size_t
 
usize
;

817 
	`as£¹
(
®ignm’t
 != 0 && ((alignment - 1) &‡lignment) == 0);

820 ià(
size
 <ğ
SMALL_MAXCLASS
 && 
®ignm’t
 < 
PAGE
) {

835 
usize
 = 
	`s2u
(
	`ALIGNMENT_CEILING
(
size
, 
®ignm’t
));

836 ià(
usize
 < 
LARGE_MINCLASS
)

837  (
usize
);

841 ià(
	`lik–y
(
size
 <ğ
Ïrge_maxşass
è&&†ik–y(
®ignm’t
 < 
chunksize
)) {

846 
®ignm’t
 = 
	`PAGE_CEILING
(alignment);

849 
usize
 = (
size
 <ğ
LARGE_MINCLASS
è? LARGE_MINCLASS : 
	`s2u
(size);

855 ià(
usize
 + 
Ïrge_·d
 + 
®ignm’t
 - 
PAGE
 <ğ
¬’a_maxrun
)

856  (
usize
);

861 ià(
	`uÆik–y
(
®ignm’t
 > 
HUGE_MAXCLASS
))

868 
®ignm’t
 = 
	`CHUNK_CEILING
(alignment);

871 ià(
size
 <ğ
chunksize
)

872 
usize
 = 
chunksize
;

874 
usize
 = 
	`s2u
(
size
);

875 ià(
usize
 < 
size
) {

885 ià(
usize
 + 
®ignm’t
 - 
PAGE
 < usize) {

889  (
usize
);

890 
	}
}

893 
JEMALLOC_INLINE
 
¬’a_t
 *

894 
	$¬’a_choo£_im¶
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, 
boŞ
 
š‹º®
)

896 
¬’a_t
 *
»t
;

898 ià(
¬’a
 !ğ
NULL
)

899  (
¬’a
);

901 
»t
 = 
š‹º®
 ? 
	`tsd_Ÿ»Ç_g‘
(
tsd
è: 
	`tsd_¬’a_g‘
(tsd);

902 ià(
	`uÆik–y
(
»t
 =ğ
NULL
))

903 
»t
 = 
	`¬’a_choo£_h¬d
(
tsd
, 
š‹º®
);

905  (
»t
);

906 
	}
}

908 
JEMALLOC_INLINE
 
¬’a_t
 *

909 
	$¬’a_choo£
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
)

912  (
	`¬’a_choo£_im¶
(
tsd
, 
¬’a
, 
çl£
));

913 
	}
}

915 
JEMALLOC_INLINE
 
¬’a_t
 *

916 
	$¬’a_ichoo£
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
)

919  (
	`¬’a_choo£_im¶
(
tsd
, 
¬’a
, 
Œue
));

920 
	}
}

922 
JEMALLOC_INLINE
 
¬’a_td©a_t
 *

923 
	$¬’a_td©a_g‘
(
tsd_t
 *
tsd
, 
šd
, 
boŞ
 
»äesh_if_missšg
)

925 
¬’a_td©a_t
 *
td©a
;

926 
¬’a_td©a_t
 *
¬’as_td©a
 = 
	`tsd_¬’as_td©a_g‘
(
tsd
);

928 ià(
	`uÆik–y
(
¬’as_td©a
 =ğ
NULL
)) {

930  (
	`¬’a_td©a_g‘_h¬d
(
tsd
, 
šd
));

932 ià(
	`uÆik–y
(
šd
 >ğ
	`tsd_Ç»Çs_td©a_g‘
(
tsd
))) {

937  (
»äesh_if_missšg
 ? 
	`¬’a_td©a_g‘_h¬d
(
tsd
, 
šd
) :

938 
NULL
);

941 
td©a
 = &
¬’as_td©a
[
šd
];

942 ià(
	`lik–y
(
td©a
 !ğ
NULL
è|| !
»äesh_if_missšg
)

943  (
td©a
);

944  (
	`¬’a_td©a_g‘_h¬d
(
tsd
, 
šd
));

945 
	}
}

947 
JEMALLOC_INLINE
 
¬’a_t
 *

948 
	$¬’a_g‘
(
tsdn_t
 *
tsdn
, 
šd
, 
boŞ
 
š™_if_missšg
)

950 
¬’a_t
 *
»t
;

952 
	`as£¹
(
šd
 <ğ
MALLOCX_ARENA_MAX
);

954 
»t
 = 
¬’as
[
šd
];

955 ià(
	`uÆik–y
(
»t
 =ğ
NULL
)) {

956 
»t
 = 
	`©omic_»ad_p
((*)&
¬’as
[
šd
]);

957 ià(
š™_if_missšg
 && 
	`uÆik–y
(
»t
 =ğ
NULL
))

958 
»t
 = 
	`¬’a_š™
(
tsdn
, 
šd
);

960  (
»t
);

961 
	}
}

963 
JEMALLOC_INLINE
 
tick”_t
 *

964 
	$deÿy_tick”_g‘
(
tsd_t
 *
tsd
, 
šd
)

966 
¬’a_td©a_t
 *
td©a
;

968 
td©a
 = 
	`¬’a_td©a_g‘
(
tsd
, 
šd
, 
Œue
);

969 ià(
	`uÆik–y
(
td©a
 =ğ
NULL
))

970  (
NULL
);

971  (&
td©a
->
deÿy_tick”
);

972 
	}
}

975 
	~"jem®loc/š‹º®/b™m­.h
"

980 
	#JEMALLOC_ARENA_INLINE_A


	)

981 
	~"jem®loc/š‹º®/¬’a.h
"

982 #undeà
JEMALLOC_ARENA_INLINE_A


983 
	~"jem®loc/š‹º®/tÿche.h
"

984 
	#JEMALLOC_ARENA_INLINE_B


	)

985 
	~"jem®loc/š‹º®/¬’a.h
"

986 #undeà
JEMALLOC_ARENA_INLINE_B


987 
	~"jem®loc/š‹º®/hash.h
"

988 
	~"jem®loc/š‹º®/qu¬ªtše.h
"

990 #iâdeà
JEMALLOC_ENABLE_INLINE


991 
¬’a_t
 *
Ÿ®loc
(cÚ¡ *
±r
);

992 
size_t
 
i§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
boŞ
 
demÙe
);

993 *
ŸÎocztm
(
tsdn_t
 *
tsdn
, 
size_t
 
size
, 
szšd_t
 
šd
, 
boŞ
 
z”o
,

994 
tÿche_t
 *
tÿche
, 
boŞ
 
is_m‘ad©a
, 
¬’a_t
 *
¬’a
, boŞ 
¦ow_·th
);

995 *
ŸÎoc
(
tsd_t
 *
tsd
, 
size_t
 
size
, 
szšd_t
 
šd
, 
boŞ
 
z”o
,

996 
boŞ
 
¦ow_·th
);

997 *
®locztm
(
tsdn_t
 *
tsdn
, 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
,

998 
tÿche_t
 *
tÿche
, 
boŞ
 
is_m‘ad©a
, 
¬’a_t
 *
¬’a
);

999 *
®loù
(
tsdn_t
 *
tsdn
, 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
,

1000 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
);

1001 *
®loc
(
tsd_t
 *
tsd
, 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
);

1002 
size_t
 
iv§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
boŞ
 
demÙe
);

1003 
size_t
 
u2rz
(size_ˆ
usize
);

1004 
size_t
 
p2rz
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
);

1005 
id®loùm
(
tsdn_t
 *
tsdn
, *
±r
, 
tÿche_t
 *
tÿche
, 
boŞ
 
is_m‘ad©a
,

1006 
boŞ
 
¦ow_·th
);

1007 
id®loc
(
tsd_t
 *
tsd
, *
±r
);

1008 
iq®loc
(
tsd_t
 *
tsd
, *
±r
, 
tÿche_t
 *
tÿche
, 
boŞ
 
¦ow_·th
);

1009 
isd®loù
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
size
, 
tÿche_t
 *
tÿche
,

1010 
boŞ
 
¦ow_·th
);

1011 
isq®loc
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
size
, 
tÿche_t
 *
tÿche
,

1012 
boŞ
 
¦ow_·th
);

1013 *
œ®loù_»®ign
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
,

1014 
size_t
 
exŒa
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
,

1015 
¬’a_t
 *
¬’a
);

1016 *
œ®loù
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
,

1017 
size_t
 
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
);

1018 *
œ®loc
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
,

1019 
size_t
 
®ignm’t
, 
boŞ
 
z”o
);

1020 
boŞ
 
ix®loc
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
,

1021 
size_t
 
exŒa
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
);

1024 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_C_
))

1025 
JEMALLOC_ALWAYS_INLINE
 
¬’a_t
 *

1026 
	$Ÿ®loc
(cÚ¡ *
±r
)

1029 
	`as£¹
(
±r
 !ğ
NULL
);

1031  (
	`¬’a_¯Îoc
(
±r
));

1032 
	}
}

1040 
JEMALLOC_ALWAYS_INLINE
 
size_t


1041 
	$i§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
boŞ
 
demÙe
)

1044 
	`as£¹
(
±r
 !ğ
NULL
);

1046 
	`as£¹
(
cÚfig_´of
 || !
demÙe
);

1048  (
	`¬’a_§Îoc
(
tsdn
, 
±r
, 
demÙe
));

1049 
	}
}

1051 
JEMALLOC_ALWAYS_INLINE
 *

1052 
	$ŸÎocztm
(
tsdn_t
 *
tsdn
, 
size_t
 
size
, 
szšd_t
 
šd
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
,

1053 
boŞ
 
is_m‘ad©a
, 
¬’a_t
 *
¬’a
, boŞ 
¦ow_·th
)

1055 *
»t
;

1057 
	`as£¹
(
size
 != 0);

1058 
	`as£¹
(!
is_m‘ad©a
 || 
tÿche
 =ğ
NULL
);

1059 
	`as£¹
(!
is_m‘ad©a
 || 
¬’a
 =ğ
NULL
 ||‡»Ç->
šd
 < 
Ç»Çs_auto
);

1061 
»t
 = 
	`¬’a_m®loc
(
tsdn
, 
¬’a
, 
size
, 
šd
, 
z”o
, 
tÿche
, 
¦ow_·th
);

1062 ià(
cÚfig_¡©s
 && 
is_m‘ad©a
 && 
	`lik–y
(
»t
 !ğ
NULL
)) {

1063 
	`¬’a_m‘ad©a_®loÿ‹d_add
(
	`Ÿ®loc
(
»t
),

1064 
	`i§Îoc
(
tsdn
, 
»t
, 
cÚfig_´of
));

1066  (
»t
);

1067 
	}
}

1069 
JEMALLOC_ALWAYS_INLINE
 *

1070 
	$ŸÎoc
(
tsd_t
 *
tsd
, 
size_t
 
size
, 
szšd_t
 
šd
, 
boŞ
 
z”o
, boŞ 
¦ow_·th
)

1073  (
	`ŸÎocztm
(
	`tsd_tsdn
(
tsd
), 
size
, 
šd
, 
z”o
, 
	`tÿche_g‘
Ñsd, 
Œue
),

1074 
çl£
, 
NULL
, 
¦ow_·th
));

1075 
	}
}

1077 
JEMALLOC_ALWAYS_INLINE
 *

1078 
	$®locztm
(
tsdn_t
 *
tsdn
, 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
,

1079 
tÿche_t
 *
tÿche
, 
boŞ
 
is_m‘ad©a
, 
¬’a_t
 *
¬’a
)

1081 *
»t
;

1083 
	`as£¹
(
usize
 != 0);

1084 
	`as£¹
(
usize
 =ğ
	`§2u
(usize, 
®ignm’t
));

1085 
	`as£¹
(!
is_m‘ad©a
 || 
tÿche
 =ğ
NULL
);

1086 
	`as£¹
(!
is_m‘ad©a
 || 
¬’a
 =ğ
NULL
 ||‡»Ç->
šd
 < 
Ç»Çs_auto
);

1088 
»t
 = 
	`¬’a_·Îoc
(
tsdn
, 
¬’a
, 
usize
, 
®ignm’t
, 
z”o
, 
tÿche
);

1089 
	`as£¹
(
	`ALIGNMENT_ADDR2BASE
(
»t
, 
®ignm’t
) ==„et);

1090 ià(
cÚfig_¡©s
 && 
is_m‘ad©a
 && 
	`lik–y
(
»t
 !ğ
NULL
)) {

1091 
	`¬’a_m‘ad©a_®loÿ‹d_add
(
	`Ÿ®loc
(
»t
), 
	`i§Îoc
(
tsdn
,„et,

1092 
cÚfig_´of
));

1094  (
»t
);

1095 
	}
}

1097 
JEMALLOC_ALWAYS_INLINE
 *

1098 
	$®loù
(
tsdn_t
 *
tsdn
, 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
,

1099 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
)

1102  (
	`®locztm
(
tsdn
, 
usize
, 
®ignm’t
, 
z”o
, 
tÿche
, 
çl£
, 
¬’a
));

1103 
	}
}

1105 
JEMALLOC_ALWAYS_INLINE
 *

1106 
	$®loc
(
tsd_t
 *
tsd
, 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
)

1109  (
	`®locztm
(
	`tsd_tsdn
(
tsd
), 
usize
, 
®ignm’t
, 
z”o
,

1110 
	`tÿche_g‘
(
tsd
, 
Œue
), 
çl£
, 
NULL
));

1111 
	}
}

1113 
JEMALLOC_ALWAYS_INLINE
 
size_t


1114 
	$iv§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
boŞ
 
demÙe
)

1116 
ex‹Á_node_t
 *
node
;

1119 
node
 = 
	`chunk_lookup
(
±r
, 
çl£
);

1120 ià(
node
 =ğ
NULL
)

1123 
	`as£¹
(
	`ex‹Á_node_addr_g‘
(
node
è=ğ
±r
 ||

1124 
	`ex‹Á_node_achunk_g‘
(
node
));

1126  (
	`i§Îoc
(
tsdn
, 
±r
, 
demÙe
));

1127 
	}
}

1129 
JEMALLOC_INLINE
 
size_t


1130 
	$u2rz
(
size_t
 
usize
)

1132 
size_t
 
»t
;

1134 ià(
usize
 <ğ
SMALL_MAXCLASS
) {

1135 
szšd_t
 
bššd
 = 
	`size2šdex
(
usize
);

1136 
»t
 = 
¬’a_bš_šfo
[
bššd
].
»dzÚe_size
;

1138 
»t
 = 0;

1140  (
»t
);

1141 
	}
}

1143 
JEMALLOC_INLINE
 
size_t


1144 
	$p2rz
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
)

1146 
size_t
 
usize
 = 
	`i§Îoc
(
tsdn
, 
±r
, 
çl£
);

1148  (
	`u2rz
(
usize
));

1149 
	}
}

1151 
JEMALLOC_ALWAYS_INLINE
 

1152 
	$id®loùm
(
tsdn_t
 *
tsdn
, *
±r
, 
tÿche_t
 *
tÿche
, 
boŞ
 
is_m‘ad©a
,

1153 
boŞ
 
¦ow_·th
)

1156 
	`as£¹
(
±r
 !ğ
NULL
);

1157 
	`as£¹
(!
is_m‘ad©a
 || 
tÿche
 =ğ
NULL
);

1158 
	`as£¹
(!
is_m‘ad©a
 || 
	`Ÿ®loc
(
±r
)->
šd
 < 
Ç»Çs_auto
);

1159 ià(
cÚfig_¡©s
 && 
is_m‘ad©a
) {

1160 
	`¬’a_m‘ad©a_®loÿ‹d_sub
(
	`Ÿ®loc
(
±r
), 
	`i§Îoc
(
tsdn
,…tr,

1161 
cÚfig_´of
));

1164 
	`¬’a_d®loc
(
tsdn
, 
±r
, 
tÿche
, 
¦ow_·th
);

1165 
	}
}

1167 
JEMALLOC_ALWAYS_INLINE
 

1168 
	$id®loc
(
tsd_t
 *
tsd
, *
±r
)

1171 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
±r
, 
	`tÿche_g‘
Ñsd, 
çl£
), f®£, 
Œue
);

1172 
	}
}

1174 
JEMALLOC_ALWAYS_INLINE
 

1175 
	$iq®loc
(
tsd_t
 *
tsd
, *
±r
, 
tÿche_t
 *
tÿche
, 
boŞ
 
¦ow_·th
)

1178 ià(
¦ow_·th
 && 
cÚfig_fl
 && 
	`uÆik–y
(
İt_qu¬ªtše
))

1179 
	`qu¬ªtše
(
tsd
, 
±r
);

1181 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
±r
, 
tÿche
, 
çl£
, 
¦ow_·th
);

1182 
	}
}

1184 
JEMALLOC_ALWAYS_INLINE
 

1185 
	$isd®loù
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
size
, 
tÿche_t
 *
tÿche
,

1186 
boŞ
 
¦ow_·th
)

1189 
	`¬’a_sd®loc
(
tsdn
, 
±r
, 
size
, 
tÿche
, 
¦ow_·th
);

1190 
	}
}

1192 
JEMALLOC_ALWAYS_INLINE
 

1193 
	$isq®loc
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
size
, 
tÿche_t
 *
tÿche
, 
boŞ
 
¦ow_·th
)

1196 ià(
¦ow_·th
 && 
cÚfig_fl
 && 
	`uÆik–y
(
İt_qu¬ªtše
))

1197 
	`qu¬ªtše
(
tsd
, 
±r
);

1199 
	`isd®loù
(
	`tsd_tsdn
(
tsd
), 
±r
, 
size
, 
tÿche
, 
¦ow_·th
);

1200 
	}
}

1202 
JEMALLOC_ALWAYS_INLINE
 *

1203 
	$œ®loù_»®ign
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
,

1204 
size_t
 
exŒa
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
)

1206 *
p
;

1207 
size_t
 
usize
, 
cİysize
;

1209 
usize
 = 
	`§2u
(
size
 + 
exŒa
, 
®ignm’t
);

1210 ià(
	`uÆik–y
(
usize
 =ğ0 || usiz> 
HUGE_MAXCLASS
))

1211  (
NULL
);

1212 
p
 = 
	`®loù
(
	`tsd_tsdn
(
tsd
), 
usize
, 
®ignm’t
, 
z”o
, 
tÿche
, 
¬’a
);

1213 ià(
p
 =ğ
NULL
) {

1214 ià(
exŒa
 == 0)

1215  (
NULL
);

1217 
usize
 = 
	`§2u
(
size
, 
®ignm’t
);

1218 ià(
	`uÆik–y
(
usize
 =ğ0 || usiz> 
HUGE_MAXCLASS
))

1219  (
NULL
);

1220 
p
 = 
	`®loù
(
	`tsd_tsdn
(
tsd
), 
usize
, 
®ignm’t
, 
z”o
, 
tÿche
,

1221 
¬’a
);

1222 ià(
p
 =ğ
NULL
)

1223  (
NULL
);

1229 
cİysize
 = (
size
 < 
Şdsize
) ? size : oldsize;

1230 
	`memıy
(
p
, 
±r
, 
cİysize
);

1231 
	`isq®loc
(
tsd
, 
±r
, 
Şdsize
, 
tÿche
, 
Œue
);

1232  (
p
);

1233 
	}
}

1235 
JEMALLOC_ALWAYS_INLINE
 *

1236 
	$œ®loù
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
, size_ˆ
®ignm’t
,

1237 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
)

1240 
	`as£¹
(
±r
 !ğ
NULL
);

1241 
	`as£¹
(
size
 != 0);

1243 ià(
®ignm’t
 !ğ0 && ((
ušŒ_t
)
±r
 & ((uintptr_t)alignment-1))

1249  (
	`œ®loù_»®ign
(
tsd
, 
±r
, 
Şdsize
, 
size
, 0, 
®ignm’t
,

1250 
z”o
, 
tÿche
, 
¬’a
));

1253  (
	`¬’a_¿Îoc
(
tsd
, 
¬’a
, 
±r
, 
Şdsize
, 
size
, 
®ignm’t
, 
z”o
,

1254 
tÿche
));

1255 
	}
}

1257 
JEMALLOC_ALWAYS_INLINE
 *

1258 
	$œ®loc
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
, size_ˆ
®ignm’t
,

1259 
boŞ
 
z”o
)

1262  (
	`œ®loù
(
tsd
, 
±r
, 
Şdsize
, 
size
, 
®ignm’t
, 
z”o
,

1263 
	`tÿche_g‘
(
tsd
, 
Œue
), 
NULL
));

1264 
	}
}

1266 
JEMALLOC_ALWAYS_INLINE
 
boŞ


1267 
	$ix®loc
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
, size_ˆ
exŒa
,

1268 
size_t
 
®ignm’t
, 
boŞ
 
z”o
)

1271 
	`as£¹
(
±r
 !ğ
NULL
);

1272 
	`as£¹
(
size
 != 0);

1274 ià(
®ignm’t
 !ğ0 && ((
ušŒ_t
)
±r
 & ((uintptr_t)alignment-1))

1277  (
Œue
);

1280  (
	`¬’a_¿Îoc_no_move
(
tsdn
, 
±r
, 
Şdsize
, 
size
, 
exŒa
, 
z”o
));

1281 
	}
}

1284 
	~"jem®loc/š‹º®/´of.h
"

1286 #undeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/jemalloc_internal_decls.h

1 #iâdeà
JEMALLOC_INTERNAL_DECLS_H


2 
	#JEMALLOC_INTERNAL_DECLS_H


	)

4 
	~<m©h.h
>

5 #ifdeà
_WIN32


6 
	~<wšdows.h
>

7 
	~"msvc_com·t/wšdows_exŒa.h
"

10 
	~<sys/·¿m.h
>

11 
	~<sys/mmª.h
>

12 #ià!
defšed
(
__²aş__
è&& !defšed(
__Çtive_ş›Á__
)

13 
	~<sys/sysÿÎ.h
>

14 #ià!
defšed
(
SYS_wr™e
è&& defšed(
__NR_wr™e
)

15 
	#SYS_wr™e
 
__NR_wr™e


	)

17 
	~<sys/uio.h
>

19 
	~<±h»ad.h
>

20 #ifdeà
JEMALLOC_OS_UNFAIR_LOCK


21 
	~<os/lock.h
>

23 #ifdeà
JEMALLOC_GLIBC_MALLOC_HOOK


24 
	~<sched.h
>

26 
	~<”ºo.h
>

27 
	~<sys/time.h
>

28 
	~<time.h
>

29 #ifdeà
JEMALLOC_HAVE_MACH_ABSOLUTE_TIME


30 
	~<mach/mach_time.h
>

33 
	~<sys/ty³s.h
>

35 
	~<lim™s.h
>

36 #iâdeà
SIZE_T_MAX


37 
	#SIZE_T_MAX
 
SIZE_MAX


	)

39 
	~<¡d¬g.h
>

40 
	~<¡dboŞ.h
>

41 
	~<¡dio.h
>

42 
	~<¡dlib.h
>

43 
	~<¡dšt.h
>

44 
	~<¡ddef.h
>

45 #iâdeà
off£tof


46 
	#off£tof
(
ty³
, 
memb”
è((
size_t
)&((Ñy³ *)
NULL
)->memb”))

	)

48 
	~<¡ršg.h
>

49 
	~<¡ršgs.h
>

50 
	~<ùy³.h
>

51 #ifdeà
_MSC_VER


52 
	~<io.h
>

53 
šŒ_t
 
	tssize_t
;

54 
	#PATH_MAX
 1024

	)

55 
	#STDERR_FILENO
 2

	)

56 
	#__func__
 
__FUNCTION__


	)

57 #ifdeà
JEMALLOC_HAS_RESTRICT


58 
	#»¡riù
 
__»¡riù


	)

61 #´agm¨
w¬nšg
(
di§bË
: 4996)

62 #ià
_MSC_VER
 < 1800

64 
	$isbÏnk
(
c
)

67  (
c
 == '\t' || c == ' ');

68 
	}
}

71 
	~<uni¡d.h
>

73 
	~<fú.h
>

	@deps/jemalloc/include/jemalloc/internal/jemalloc_internal_defs.h

2 #iâdeà
JEMALLOC_INTERNAL_DEFS_H_


3 
	#JEMALLOC_INTERNAL_DEFS_H_


	)

9 
	#JEMALLOC_PREFIX
 "je_"

	)

10 
	#JEMALLOC_CPREFIX
 "JE_"

	)

18 
	#JEMALLOC_PRIVATE_NAMESPACE
 
je_


	)

24 
	#CPU_SPINWAIT
 
__asm__
 vŞ©e("·u£")

	)

57 
	#JEMALLOC_HAVE_BUILTIN_CLZ


	)

71 
	#JEMALLOC_USE_SYSCALL


	)

76 
	#JEMALLOC_HAVE_SECURE_GETENV


	)

84 
	#JEMALLOC_HAVE_PTHREAD_ATFORK


	)

89 
	#JEMALLOC_HAVE_CLOCK_MONOTONIC_COARSE
 1

	)

94 
	#JEMALLOC_HAVE_CLOCK_MONOTONIC
 1

	)

115 
	#JEMALLOC_THREADED_INIT


	)

125 
	#JEMALLOC_TLS_MODEL
 
	`__©Œibu‹__
((
	`s_mod–
("š™Ÿl-exec")))

	)

128 
	#JEMALLOC_CC_SILENCE


	)

140 
	#JEMALLOC_STATS


	)

159 
	#JEMALLOC_TCACHE


	)

165 
	#JEMALLOC_DSS


	)

168 
	#JEMALLOC_FILL


	)

174 
	#JEMALLOC_VALGRIND


	)

183 
	#LG_TINY_MIN
 3

	)

189 
	#LG_QUANTUM
 3

	)

192 
	#LG_PAGE
 12

	)

201 
	#JEMALLOC_MAPS_COALESCE


	)

211 
	#JEMALLOC_TLS


	)

217 
	#JEMALLOC_INTERNAL_UNREACHABLE
 
__butš_uÄ—chabË


	)

223 
	#JEMALLOC_INTERNAL_FFSLL
 
__butš_ff¦l


	)

224 
	#JEMALLOC_INTERNAL_FFSL
 
__butš_ff¦


	)

225 
	#JEMALLOC_INTERNAL_FFS
 
__butš_ffs


	)

237 
	#JEMALLOC_CACHE_OBLIVIOUS


	)

252 
	#JEMALLOC_PROC_SYS_VM_OVERCOMMIT_MEMORY


	)

255 
	#JEMALLOC_HAVE_MADVISE


	)

266 
	#JEMALLOC_PURGE_MADVISE_FREE


	)

267 
	#JEMALLOC_PURGE_MADVISE_DONTNEED


	)

273 
	#JEMALLOC_THP


	)

276 
	#JEMALLOC_HAS_ALLOCA_H
 1

	)

285 
	#LG_SIZEOF_INT
 2

	)

288 
	#LG_SIZEOF_LONG
 3

	)

291 
	#LG_SIZEOF_LONG_LONG
 3

	)

294 
	#LG_SIZEOF_INTMAX_T
 3

	)

297 
	#JEMALLOC_GLIBC_MALLOC_HOOK


	)

300 
	#JEMALLOC_GLIBC_MEMALIGN_HOOK


	)

303 
	#JEMALLOC_HAVE_PTHREAD_MUTEX_ADAPTIVE_NP


	)

312 
	#JEMALLOC_CONFIG_MALLOC_CONF
 ""

	)

	@deps/jemalloc/include/jemalloc/internal/jemalloc_internal_macros.h

10 #ià
defšed
(
JEMALLOC_DEBUG
è|| defšed(
JEMALLOC_CODE_COVERAGE
)

12 
	#JEMALLOC_ALWAYS_INLINE


	)

13 
	#JEMALLOC_ALWAYS_INLINE_C
 

	)

14 
	#JEMALLOC_INLINE


	)

15 
	#JEMALLOC_INLINE_C
 

	)

16 
	#šlše


	)

18 
	#JEMALLOC_ENABLE_INLINE


	)

19 #ifdeà
JEMALLOC_HAVE_ATTR


20 
	#JEMALLOC_ALWAYS_INLINE
 \

21 
šlše
 
	`JEMALLOC_ATTR
(
unu£d
èJEMALLOC_ATTR(
®ways_šlše
)

	)

22 
	#JEMALLOC_ALWAYS_INLINE_C
 \

23 
šlše
 
	`JEMALLOC_ATTR
(
®ways_šlše
)

	)

25 
	#JEMALLOC_ALWAYS_INLINE
 
šlše


	)

26 
	#JEMALLOC_ALWAYS_INLINE_C
 
šlše


	)

28 
	#JEMALLOC_INLINE
 
šlše


	)

29 
	#JEMALLOC_INLINE_C
 
šlše


	)

30 #ifdeà
_MSC_VER


31 
	#šlše
 
_šlše


	)

35 #ifdeà
JEMALLOC_CC_SILENCE


36 
	#UNUSED
 
	`JEMALLOC_ATTR
(
unu£d
)

	)

38 
	#UNUSED


	)

41 
	#ZU
(
z
è((
size_t
)z)

	)

42 
	#ZI
(
z
è((
ssize_t
)z)

	)

43 
	#QU
(
q
è((
ušt64_t
)q)

	)

44 
	#QI
(
q
è((
št64_t
)q)

	)

46 
	#KZU
(
z
è
	`ZU
(z##
ULL
)

	)

47 
	#KZI
(
z
è
	`ZI
(z##
LL
)

	)

48 
	#KQU
(
q
è
	`QU
(q##
ULL
)

	)

49 
	#KQI
(
q
è
	`QI
(q##
LL
)

	)

51 #iâdeà
__DECONST


52 
	#__DECONST
(
ty³
, 
v¬
è(Ñy³)(
ušŒ_t
)(cÚ¡ *)(v¬))

	)

55 #iâdeà
JEMALLOC_HAS_RESTRICT


56 
	#»¡riù


	)

	@deps/jemalloc/include/jemalloc/internal/mb.h

2 #ifdeà
JEMALLOC_H_TYPES


6 #ifdeà
JEMALLOC_H_STRUCTS


10 #ifdeà
JEMALLOC_H_EXTERNS


14 #ifdeà
JEMALLOC_H_INLINES


16 #iâdeà
JEMALLOC_ENABLE_INLINE


17 
mb_wr™e
();

20 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_MB_C_
))

21 #ifdeà
__i386__


31 
JEMALLOC_INLINE
 

32 
	$mb_wr™e
()

37 
asm
 volatile ("pusha;"

50 
asm
 volatile ("nop;"

56 
	}
}

57 #–ià(
defšed
(
__amd64__
è|| defšed(
__x86_64__
))

58 
JEMALLOC_INLINE
 

59 
	$mb_wr™e
()

62 
asm
 volatile ("sfence"

67 
	}
}

68 #–ià
defšed
(
__pow”pc__
)

69 
JEMALLOC_INLINE
 

70 
	$mb_wr™e
()

73 
asm
 volatile ("eieio"

78 
	}
}

79 #–ià
defšed
(
__¥¬c64__
)

80 
JEMALLOC_INLINE
 

81 
	$mb_wr™e
()

84 
asm
 volatile ("membar #StoreStore"

89 
	}
}

90 #–ià
defšed
(
__te__
)

91 
JEMALLOC_INLINE
 

92 
	$mb_wr™e
()

95 
	`__sync_synchrÚize
();

96 
	}
}

102 
JEMALLOC_INLINE
 

103 
	$mb_wr™e
()

105 
m®loc_mu‹x_t
 
mtx
;

107 
	`m®loc_mu‹x_š™
(&
mtx
, "mb", 
WITNESS_RANK_OMIT
);

108 
	`m®loc_mu‹x_lock
(
TSDN_NULL
, &
mtx
);

109 
	`m®loc_mu‹x_uÆock
(
TSDN_NULL
, &
mtx
);

110 
	}
}

	@deps/jemalloc/include/jemalloc/internal/mutex.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
m®loc_mu‹x_s
 
	tm®loc_mu‹x_t
;

6 #ifdeà
_WIN32


7 
	#MALLOC_MUTEX_INITIALIZER


	)

8 #–ià(
defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

9 
	#MALLOC_MUTEX_INITIALIZER
 \

10 {
OS_UNFAIR_LOCK_INIT
, 
	`WITNESS_INITIALIZER
(
WITNESS_RANK_OMIT
)}

	)

11 #–ià(
defšed
(
JEMALLOC_OSSPIN
))

12 
	#MALLOC_MUTEX_INITIALIZER
 {0, 
	`WITNESS_INITIALIZER
(
WITNESS_RANK_OMIT
)}

	)

13 #–ià(
defšed
(
JEMALLOC_MUTEX_INIT_CB
))

14 
	#MALLOC_MUTEX_INITIALIZER
 \

15 {
PTHREAD_MUTEX_INITIALIZER
, 
NULL
, 
	`WITNESS_INITIALIZER
(
WITNESS_RANK_OMIT
)}

	)

17 #ià(
defšed
(
JEMALLOC_HAVE_PTHREAD_MUTEX_ADAPTIVE_NP
) && \

18 
	$defšed
(
PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
))

19 
	#MALLOC_MUTEX_TYPE
 
PTHREAD_MUTEX_ADAPTIVE_NP


	)

20 
	#MALLOC_MUTEX_INITIALIZER
 \

21 {
PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
, \

22 
	`WITNESS_INITIALIZER
(
WITNESS_RANK_OMIT
)
	}

	)
}

24 
	#MALLOC_MUTEX_TYPE
 
PTHREAD_MUTEX_DEFAULT


	)

25 
	#MALLOC_MUTEX_INITIALIZER
 \

26 {
PTHREAD_MUTEX_INITIALIZER
, 
	`WITNESS_INITIALIZER
(
WITNESS_RANK_OMIT
)}

	)

32 #ifdeà
JEMALLOC_H_STRUCTS


34 
	sm®loc_mu‹x_s
 {

35 #ifdeà
_WIN32


36 #ià
_WIN32_WINNT
 >= 0x0600

37 
SRWLOCK
 
	mlock
;

39 
CRITICAL_SECTION
 
	mlock
;

41 #–ià(
defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

42 
os_unçœ_lock
 
	mlock
;

43 #–ià(
defšed
(
JEMALLOC_OSSPIN
))

44 
OSSpšLock
 
	mlock
;

45 #–ià(
defšed
(
JEMALLOC_MUTEX_INIT_CB
))

46 
±h»ad_mu‹x_t
 
	mlock
;

47 
m®loc_mu‹x_t
 *
	mpo¡pÚed_Ãxt
;

49 
±h»ad_mu‹x_t
 
	mlock
;

51 
w™Ãss_t
 
	mw™Ãss
;

56 #ifdeà
JEMALLOC_H_EXTERNS


58 #ifdeà
JEMALLOC_LAZY_LOCK


59 
boŞ
 
i¡h»aded
;

61 #undeà
i¡h»aded


62 
	#i¡h»aded
 
Œue


	)

65 
boŞ
 
m®loc_mu‹x_š™
(
m®loc_mu‹x_t
 *
mu‹x
, cÚ¡ *
Çme
,

66 
w™Ãss_¿nk_t
 
¿nk
);

67 
m®loc_mu‹x_´efÜk
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
);

68 
m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
);

69 
m®loc_mu‹x_po¡fÜk_chd
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
);

70 
boŞ
 
m®loc_mu‹x_boÙ
();

74 #ifdeà
JEMALLOC_H_INLINES


76 #iâdeà
JEMALLOC_ENABLE_INLINE


77 
m®loc_mu‹x_lock
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
);

78 
m®loc_mu‹x_uÆock
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
);

79 
m®loc_mu‹x_as£¹_owÃr
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
);

80 
m®loc_mu‹x_as£¹_nÙ_owÃr
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
);

83 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_MUTEX_C_
))

84 
JEMALLOC_INLINE
 

85 
	$m®loc_mu‹x_lock
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
)

88 ià(
i¡h»aded
) {

89 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn
, &
mu‹x
->
w™Ãss
);

90 #ifdeà
_WIN32


91 #ià
_WIN32_WINNT
 >= 0x0600

92 
	`AcquœeSRWLockExşusive
(&
mu‹x
->
lock
);

94 
	`EÁ”Cr™iÿlSeùiÚ
(&
mu‹x
->
lock
);

96 #–ià(
	`defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

97 
	`os_unçœ_lock_lock
(&
mu‹x
->
lock
);

98 #–ià(
	`defšed
(
JEMALLOC_OSSPIN
))

99 
	`OSSpšLockLock
(&
mu‹x
->
lock
);

101 
	`±h»ad_mu‹x_lock
(&
mu‹x
->
lock
);

103 
	`w™Ãss_lock
(
tsdn
, &
mu‹x
->
w™Ãss
);

105 
	}
}

107 
JEMALLOC_INLINE
 

108 
	$m®loc_mu‹x_uÆock
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
)

111 ià(
i¡h»aded
) {

112 
	`w™Ãss_uÆock
(
tsdn
, &
mu‹x
->
w™Ãss
);

113 #ifdeà
_WIN32


114 #ià
_WIN32_WINNT
 >= 0x0600

115 
	`R–—£SRWLockExşusive
(&
mu‹x
->
lock
);

117 
	`L—veCr™iÿlSeùiÚ
(&
mu‹x
->
lock
);

119 #–ià(
	`defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

120 
	`os_unçœ_lock_uÆock
(&
mu‹x
->
lock
);

121 #–ià(
	`defšed
(
JEMALLOC_OSSPIN
))

122 
	`OSSpšLockUÆock
(&
mu‹x
->
lock
);

124 
	`±h»ad_mu‹x_uÆock
(&
mu‹x
->
lock
);

127 
	}
}

129 
JEMALLOC_INLINE
 

130 
	$m®loc_mu‹x_as£¹_owÃr
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
)

133 ià(
i¡h»aded
)

134 
	`w™Ãss_as£¹_owÃr
(
tsdn
, &
mu‹x
->
w™Ãss
);

135 
	}
}

137 
JEMALLOC_INLINE
 

138 
	$m®loc_mu‹x_as£¹_nÙ_owÃr
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
)

141 ià(
i¡h»aded
)

142 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn
, &
mu‹x
->
w™Ãss
);

143 
	}
}

	@deps/jemalloc/include/jemalloc/internal/nstime.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
n¡ime_s
 
	tn¡ime_t
;

7 
	#NSTIME_SEC_MAX
 
	`KQU
(18446744072)

	)

11 #ifdeà
JEMALLOC_H_STRUCTS


13 
	sn¡ime_s
 {

14 
ušt64_t
 
	mns
;

19 #ifdeà
JEMALLOC_H_EXTERNS


21 
n¡ime_š™
(
n¡ime_t
 *
time
, 
ušt64_t
 
ns
);

22 
n¡ime_š™2
(
n¡ime_t
 *
time
, 
ušt64_t
 
£c
, ušt64_ˆ
n£c
);

23 
ušt64_t
 
n¡ime_ns
(cÚ¡ 
n¡ime_t
 *
time
);

24 
ušt64_t
 
n¡ime_£c
(cÚ¡ 
n¡ime_t
 *
time
);

25 
ušt64_t
 
n¡ime_n£c
(cÚ¡ 
n¡ime_t
 *
time
);

26 
n¡ime_cİy
(
n¡ime_t
 *
time
, cÚ¡‚¡ime_ˆ*
sourû
);

27 
n¡ime_com·»
(cÚ¡ 
n¡ime_t
 *
a
, cÚ¡‚¡ime_ˆ*
b
);

28 
n¡ime_add
(
n¡ime_t
 *
time
, cÚ¡‚¡ime_ˆ*
add’d
);

29 
n¡ime_subŒaù
(
n¡ime_t
 *
time
, cÚ¡‚¡ime_ˆ*
subŒah’d
);

30 
n¡ime_imuÉly
(
n¡ime_t
 *
time
, 
ušt64_t
 
muÉl›r
);

31 
n¡ime_idivide
(
n¡ime_t
 *
time
, 
ušt64_t
 
divisÜ
);

32 
ušt64_t
 
n¡ime_divide
(cÚ¡ 
n¡ime_t
 *
time
, cÚ¡‚¡ime_ˆ*
divisÜ
);

33 #ifdeà
JEMALLOC_JET


34 
	$boŞ
 (
	tn¡ime_mÚÙÚic_t
)();

35 
n¡ime_mÚÙÚic_t
 *
n¡ime_mÚÙÚic
;

36 
	$boŞ
 (
	tn¡ime_upd©e_t
)(
	tn¡ime_t
 *);

37 
n¡ime_upd©e_t
 *
n¡ime_upd©e
;

39 
boŞ
 
	`n¡ime_mÚÙÚic
();

40 
boŞ
 
	`n¡ime_upd©e
(
n¡ime_t
 *
time
);

45 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/pages.h

2 #ifdeà
JEMALLOC_H_TYPES


6 #ifdeà
JEMALLOC_H_STRUCTS


10 #ifdeà
JEMALLOC_H_EXTERNS


12 *
·ges_m­
(*
addr
, 
size_t
 
size
, 
boŞ
 *
comm™
);

13 
·ges_unm­
(*
addr
, 
size_t
 
size
);

14 *
·ges_Œim
(*
addr
, 
size_t
 
®loc_size
, size_ˆ
Ëadsize
,

15 
size_t
 
size
, 
boŞ
 *
comm™
);

16 
boŞ
 
·ges_comm™
(*
addr
, 
size_t
 
size
);

17 
boŞ
 
·ges_decomm™
(*
addr
, 
size_t
 
size
);

18 
boŞ
 
·ges_purge
(*
addr
, 
size_t
 
size
);

19 
boŞ
 
·ges_huge
(*
addr
, 
size_t
 
size
);

20 
boŞ
 
·ges_nohuge
(*
addr
, 
size_t
 
size
);

21 
·ges_boÙ
();

25 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/ph.h

15 #iâdeà
PH_H_


16 
	#PH_H_


	)

19 
	#phn
(
a_ty³
) \

21 
a_ty³
 *
phn_´ev
; \

22 
a_ty³
 *
phn_Ãxt
; \

23 
a_ty³
 *
phn_lchd
; \

24 }

	)

27 
	#ph
(
a_ty³
) \

29 
a_ty³
 *
ph_roÙ
; \

30 }

	)

33 
	#phn_lchd_g‘
(
a_ty³
, 
a_f›ld
, 
a_phn
) \

34 (
a_phn
->
a_f›ld
.
phn_lchd
)

	)

35 
	#phn_lchd_£t
(
a_ty³
, 
a_f›ld
, 
a_phn
, 
a_lchd
) do { \

36 
a_phn
->
a_f›ld
.
phn_lchd
 = 
a_lchd
; \

37 } 0)

	)

39 
	#phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
a_phn
) \

40 (
a_phn
->
a_f›ld
.
phn_Ãxt
)

	)

41 
	#phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
a_phn
, 
a_´ev
) do { \

42 
a_phn
->
a_f›ld
.
phn_´ev
 = 
a_´ev
; \

43 } 0)

	)

45 
	#phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, 
a_phn
) \

46 (
a_phn
->
a_f›ld
.
phn_´ev
)

	)

47 
	#phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
a_phn
, 
a_Ãxt
) do { \

48 
a_phn
->
a_f›ld
.
phn_Ãxt
 = 
a_Ãxt
; \

49 } 0)

	)

51 
	#phn_m”ge_Üd”ed
(
a_ty³
, 
a_f›ld
, 
a_phn0
, 
a_phn1
, 
a_cmp
) do { \

52 
a_ty³
 *
phn0chd
; \

54 
	`as£¹
(
a_phn0
 !ğ
NULL
); \

55 
	`as£¹
(
a_phn1
 !ğ
NULL
); \

56 
	`as£¹
(
	`a_cmp
(
a_phn0
, 
a_phn1
) <= 0); \

58 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
a_phn1
, 
a_phn0
); \

59 
phn0chd
 = 
	`phn_lchd_g‘
(
a_ty³
, 
a_f›ld
, 
a_phn0
); \

60 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
a_phn1
, 
phn0chd
); \

61 ià(
phn0chd
 !ğ
NULL
) \

62 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
phn0chd
, 
a_phn1
); \

63 
	`phn_lchd_£t
(
a_ty³
, 
a_f›ld
, 
a_phn0
, 
a_phn1
); \

64 } 0)

	)

66 
	#phn_m”ge
(
a_ty³
, 
a_f›ld
, 
a_phn0
, 
a_phn1
, 
a_cmp
, 
r_phn
) do { \

67 ià(
a_phn0
 =ğ
NULL
) \

68 
r_phn
 = 
a_phn1
; \

69 ià(
a_phn1
 =ğ
NULL
) \

70 
r_phn
 = 
a_phn0
; \

71 ià(
	`a_cmp
(
a_phn0
, 
a_phn1
) < 0) { \

72 
	`phn_m”ge_Üd”ed
(
a_ty³
, 
a_f›ld
, 
a_phn0
, 
a_phn1
, \

73 
a_cmp
); \

74 
r_phn
 = 
a_phn0
; \

76 
	`phn_m”ge_Üd”ed
(
a_ty³
, 
a_f›ld
, 
a_phn1
, 
a_phn0
, \

77 
a_cmp
); \

78 
r_phn
 = 
a_phn1
; \

80 } 0)

	)

82 
	#ph_m”ge_siblšgs
(
a_ty³
, 
a_f›ld
, 
a_phn
, 
a_cmp
, 
r_phn
) do { \

83 
a_ty³
 *
h—d
 = 
NULL
; \

84 
a_ty³
 *

 = 
NULL
; \

85 
a_ty³
 *
phn0
 = 
a_phn
; \

86 
a_ty³
 *
phn1
 = 
	`phn_Ãxt_g‘
×_ty³, 
a_f›ld
, 
phn0
); \

96 ià(
phn1
 !ğ
NULL
) { \

97 
a_ty³
 *
phÄe¡
 = 
	`phn_Ãxt_g‘
×_ty³, 
a_f›ld
, 
phn1
); \

98 ià(
phÄe¡
 !ğ
NULL
) \

99 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
phÄe¡
, 
NULL
); \

100 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
phn0
, 
NULL
); \

101 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
phn0
, 
NULL
); \

102 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
phn1
, 
NULL
); \

103 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
phn1
, 
NULL
); \

104 
	`phn_m”ge
(
a_ty³
, 
a_f›ld
, 
phn0
, 
phn1
, 
a_cmp
,…hn0); \

105 
h—d
 = 

 = 
phn0
; \

106 
phn0
 = 
phÄe¡
; \

107 
phn0
 !ğ
NULL
) { \

108 
phn1
 = 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
phn0
); \

109 ià(
phn1
 !ğ
NULL
) { \

110 
phÄe¡
 = 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, \

111 
phn1
); \

112 ià(
phÄe¡
 !ğ
NULL
) { \

113 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, \

114 
phÄe¡
, 
NULL
); \

116 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
phn0
, \

117 
NULL
); \

118 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
phn0
, \

119 
NULL
); \

120 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
phn1
, \

121 
NULL
); \

122 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
phn1
, \

123 
NULL
); \

124 
	`phn_m”ge
(
a_ty³
, 
a_f›ld
, 
phn0
, 
phn1
, \

125 
a_cmp
, 
phn0
); \

126 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 

, \

127 
phn0
); \

128 

 = 
phn0
; \

129 
phn0
 = 
phÄe¡
; \

131 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 

, \

132 
phn0
); \

133 

 = 
phn0
; \

134 
phn0
 = 
NULL
; \

137 
phn0
 = 
h—d
; \

138 
phn1
 = 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
phn0
); \

139 ià(
phn1
 !ğ
NULL
) { \

140 
Œue
) { \

141 
h—d
 = 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, \

142 
phn1
); \

143 
	`as£¹
(
	`phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, \

144 
phn0
è=ğ
NULL
); \

145 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
phn0
, \

146 
NULL
); \

147 
	`as£¹
(
	`phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, \

148 
phn1
è=ğ
NULL
); \

149 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
phn1
, \

150 
NULL
); \

151 
	`phn_m”ge
(
a_ty³
, 
a_f›ld
, 
phn0
, 
phn1
, \

152 
a_cmp
, 
phn0
); \

153 ià(
h—d
 =ğ
NULL
) \

155 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 

, \

156 
phn0
); \

157 

 = 
phn0
; \

158 
phn0
 = 
h—d
; \

159 
phn1
 = 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, \

160 
phn0
); \

164 
r_phn
 = 
phn0
; \

165 } 0)

	)

167 
	#ph_m”ge_aux
(
a_ty³
, 
a_f›ld
, 
a_ph
, 
a_cmp
) do { \

168 
a_ty³
 *
phn
 = 
	`phn_Ãxt_g‘
×_ty³, 
a_f›ld
, 
a_ph
->
ph_roÙ
); \

169 ià(
phn
 !ğ
NULL
) { \

170 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
a_ph
->
ph_roÙ
, 
NULL
); \

171 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
a_ph
->
ph_roÙ
, 
NULL
); \

172 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
phn
, 
NULL
); \

173 
	`ph_m”ge_siblšgs
(
a_ty³
, 
a_f›ld
, 
phn
, 
a_cmp
,…hn); \

174 
	`as£¹
(
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
phn
è=ğ
NULL
); \

175 
	`phn_m”ge
(
a_ty³
, 
a_f›ld
, 
a_ph
->
ph_roÙ
, 
phn
, 
a_cmp
, \

176 
a_ph
->
ph_roÙ
); \

178 } 0)

	)

180 
	#ph_m”ge_chd»n
(
a_ty³
, 
a_f›ld
, 
a_phn
, 
a_cmp
, 
r_phn
) do { \

181 
a_ty³
 *
lchd
 = 
	`phn_lchd_g‘
×_ty³, 
a_f›ld
, 
a_phn
); \

182 ià(
lchd
 =ğ
NULL
) \

183 
r_phn
 = 
NULL
; \

185 
	`ph_m”ge_siblšgs
(
a_ty³
, 
a_f›ld
, 
lchd
, 
a_cmp
, \

186 
r_phn
); \

188 } 0)

	)

194 
	#ph_´Ùo
(
a_©Œ
, 
a_´efix
, 
a_ph_ty³
, 
a_ty³
) \

195 
a_©Œ
 
a_´efix
##
	`Ãw
(
a_ph_ty³
 *
ph
); \

196 
a_©Œ
 
boŞ
 
a_´efix
##
	`em±y
(
a_ph_ty³
 *
ph
); \

197 
a_©Œ
 
a_ty³
 *
a_´efix
##
	`fœ¡
(
a_ph_ty³
 *
ph
); \

198 
a_©Œ
 
a_´efix
##
	`š£¹
(
a_ph_ty³
 *
ph
, 
a_ty³
 *
phn
); \

199 
a_©Œ
 
a_ty³
 *
a_´efix
##
	`»move_fœ¡
(
a_ph_ty³
 *
ph
); \

200 
a_©Œ
 
a_´efix
##
	`»move
(
a_ph_ty³
 *
ph
, 
a_ty³
 *
phn
);

	)

206 
	#ph_g’
(
a_©Œ
, 
a_´efix
, 
a_ph_ty³
, 
a_ty³
, 
a_f›ld
, 
a_cmp
) \

207 
a_©Œ
 \

208 
a_´efix
##
	`Ãw
(
a_ph_ty³
 *
ph
) \

211 
	`mem£t
(
ph
, 0, (
	`ph
(
a_ty³
))); \

213 
a_©Œ
 
boŞ
 \

214 
a_´efix
##
	`em±y
(
a_ph_ty³
 *
ph
) \

217  (
ph
->
ph_roÙ
 =ğ
NULL
); \

219 
a_©Œ
 
a_ty³
 * \

220 
a_´efix
##
	`fœ¡
(
a_ph_ty³
 *
ph
) \

223 ià(
ph
->
ph_roÙ
 =ğ
NULL
) \

224  (
NULL
); \

225 
	`ph_m”ge_aux
(
a_ty³
, 
a_f›ld
, 
ph
, 
a_cmp
); \

226  (
ph
->
ph_roÙ
); \

228 
a_©Œ
 \

229 
a_´efix
##
	`š£¹
(
a_ph_ty³
 *
ph
, 
a_ty³
 *
phn
) \

232 
	`mem£t
(&
phn
->
a_f›ld
, 0, (
	`phn
(
a_ty³
))); \

242 ià(
ph
->
ph_roÙ
 =ğ
NULL
) \

243 
ph
->
ph_roÙ
 = 
phn
; \

245 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
phn
, 
	`phn_Ãxt_g‘
(a_type, \

246 
a_f›ld
, 
ph
->
ph_roÙ
)); \

247 ià(
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
ph
->
ph_roÙ
) != \

248 
NULL
) { \

249 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, \

250 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
ph
->
ph_roÙ
), \

251 
phn
); \

253 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
phn
, 
ph
->
ph_roÙ
); \

254 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
ph
->
ph_roÙ
, 
phn
); \

257 
a_©Œ
 
a_ty³
 * \

258 
a_´efix
##
	`»move_fœ¡
(
a_ph_ty³
 *
ph
) \

260 
a_ty³
 *
»t
; \

262 ià(
ph
->
ph_roÙ
 =ğ
NULL
) \

263  (
NULL
); \

264 
	`ph_m”ge_aux
(
a_ty³
, 
a_f›ld
, 
ph
, 
a_cmp
); \

266 
»t
 = 
ph
->
ph_roÙ
; \

268 
	`ph_m”ge_chd»n
(
a_ty³
, 
a_f›ld
, 
ph
->
ph_roÙ
, 
a_cmp
, \

269 
ph
->
ph_roÙ
); \

271  (
»t
); \

273 
a_©Œ
 \

274 
a_´efix
##
	`»move
(
a_ph_ty³
 *
ph
, 
a_ty³
 *
phn
) \

276 
a_ty³
 *
»¶aû
, *
·»Á
; \

282 ià(
ph
->
ph_roÙ
 =ğ
phn
) { \

283 
	`ph_m”ge_aux
(
a_ty³
, 
a_f›ld
, 
ph
, 
a_cmp
); \

284 ià(
ph
->
ph_roÙ
 =ğ
phn
) { \

285 
	`ph_m”ge_chd»n
(
a_ty³
, 
a_f›ld
, 
ph
->
ph_roÙ
, \

286 
a_cmp
, 
ph
->
ph_roÙ
); \

292 ià((
·»Á
 = 
	`phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, 
phn
)è!ğ
NULL
) { \

293 ià(
	`phn_lchd_g‘
(
a_ty³
, 
a_f›ld
, 
·»Á
è!ğ
phn
) \

294 
·»Á
 = 
NULL
; \

297 
	`ph_m”ge_chd»n
(
a_ty³
, 
a_f›ld
, 
phn
, 
a_cmp
, 
»¶aû
); \

299 ià(
»¶aû
 !ğ
NULL
) { \

300 ià(
·»Á
 !ğ
NULL
) { \

301 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
»¶aû
, 
·»Á
); \

302 
	`phn_lchd_£t
(
a_ty³
, 
a_f›ld
, 
·»Á
, \

303 
»¶aû
); \

305 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
»¶aû
, \

306 
	`phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, 
phn
)); \

307 ià(
	`phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, 
phn
) != \

308 
NULL
) { \

309 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, \

310 
	`phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, 
phn
), \

311 
»¶aû
); \

314 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, 
»¶aû
, \

315 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
phn
)); \

316 ià(
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
phn
è!ğ
NULL
) { \

317 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, \

318 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
phn
), \

319 
»¶aû
); \

322 ià(
·»Á
 !ğ
NULL
) { \

323 
a_ty³
 *
Ãxt
 = 
	`phn_Ãxt_g‘
×_ty³, 
a_f›ld
, \

324 
phn
); \

325 
	`phn_lchd_£t
(
a_ty³
, 
a_f›ld
, 
·»Á
, 
Ãxt
); \

326 ià(
Ãxt
 !ğ
NULL
) { \

327 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, 
Ãxt
, \

328 
·»Á
); \

331 
	`as£¹
(
	`phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, 
phn
) != \

332 
NULL
); \

333 
	`phn_Ãxt_£t
(
a_ty³
, 
a_f›ld
, \

334 
	`phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, 
phn
), \

335 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
phn
)); \

337 ià(
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
phn
è!ğ
NULL
) { \

338 
	`phn_´ev_£t
(
a_ty³
, 
a_f›ld
, \

339 
	`phn_Ãxt_g‘
(
a_ty³
, 
a_f›ld
, 
phn
), \

340 
	`phn_´ev_g‘
(
a_ty³
, 
a_f›ld
, 
phn
)); \

343 }

	)

	@deps/jemalloc/include/jemalloc/internal/private_namespace.h

1 
	#a0d®loc
 
	`JEMALLOC_N
(
a0d®loc
)

	)

2 
	#a0g‘
 
	`JEMALLOC_N
(
a0g‘
)

	)

3 
	#a0m®loc
 
	`JEMALLOC_N
(
a0m®loc
)

	)

4 
	#¬’a_¯Îoc
 
	`JEMALLOC_N
(
¬’a_¯Îoc
)

	)

5 
	#¬’a_®loc_junk_sm®l
 
	`JEMALLOC_N
(
¬’a_®loc_junk_sm®l
)

	)

6 
	#¬’a_basic_¡©s_m”ge
 
	`JEMALLOC_N
(
¬’a_basic_¡©s_m”ge
)

	)

7 
	#¬’a_bš_šdex
 
	`JEMALLOC_N
(
¬’a_bš_šdex
)

	)

8 
	#¬’a_bš_šfo
 
	`JEMALLOC_N
(
¬’a_bš_šfo
)

	)

9 
	#¬’a_b™£lm_g‘_cÚ¡
 
	`JEMALLOC_N
(
¬’a_b™£lm_g‘_cÚ¡
)

	)

10 
	#¬’a_b™£lm_g‘_mubË
 
	`JEMALLOC_N
(
¬’a_b™£lm_g‘_mubË
)

	)

11 
	#¬’a_boÙ
 
	`JEMALLOC_N
(
¬’a_boÙ
)

	)

12 
	#¬’a_choo£
 
	`JEMALLOC_N
(
¬’a_choo£
)

	)

13 
	#¬’a_choo£_h¬d
 
	`JEMALLOC_N
(
¬’a_choo£_h¬d
)

	)

14 
	#¬’a_choo£_im¶
 
	`JEMALLOC_N
(
¬’a_choo£_im¶
)

	)

15 
	#¬’a_chunk_®loc_huge
 
	`JEMALLOC_N
(
¬’a_chunk_®loc_huge
)

	)

16 
	#¬’a_chunk_ÿche_maybe_š£¹
 
	`JEMALLOC_N
(
¬’a_chunk_ÿche_maybe_š£¹
)

	)

17 
	#¬’a_chunk_ÿche_maybe_»move
 
	`JEMALLOC_N
(
¬’a_chunk_ÿche_maybe_»move
)

	)

18 
	#¬’a_chunk_d®loc_huge
 
	`JEMALLOC_N
(
¬’a_chunk_d®loc_huge
)

	)

19 
	#¬’a_chunk_¿Îoc_huge_ex·nd
 
	`JEMALLOC_N
(
¬’a_chunk_¿Îoc_huge_ex·nd
)

	)

20 
	#¬’a_chunk_¿Îoc_huge_shršk
 
	`JEMALLOC_N
(
¬’a_chunk_¿Îoc_huge_shršk
)

	)

21 
	#¬’a_chunk_¿Îoc_huge_sim¬
 
	`JEMALLOC_N
(
¬’a_chunk_¿Îoc_huge_sim¬
)

	)

22 
	#¬’a_ş—nup
 
	`JEMALLOC_N
(
¬’a_ş—nup
)

	)

23 
	#¬’a_d®loc
 
	`JEMALLOC_N
(
¬’a_d®loc
)

	)

24 
	#¬’a_d®loc_bš
 
	`JEMALLOC_N
(
¬’a_d®loc_bš
)

	)

25 
	#¬’a_d®loc_bš_junked_locked
 
	`JEMALLOC_N
(
¬’a_d®loc_bš_junked_locked
)

	)

26 
	#¬’a_d®loc_junk_Ïrge
 
	`JEMALLOC_N
(
¬’a_d®loc_junk_Ïrge
)

	)

27 
	#¬’a_d®loc_junk_sm®l
 
	`JEMALLOC_N
(
¬’a_d®loc_junk_sm®l
)

	)

28 
	#¬’a_d®loc_Ïrge
 
	`JEMALLOC_N
(
¬’a_d®loc_Ïrge
)

	)

29 
	#¬’a_d®loc_Ïrge_junked_locked
 
	`JEMALLOC_N
(
¬’a_d®loc_Ïrge_junked_locked
)

	)

30 
	#¬’a_d®loc_sm®l
 
	`JEMALLOC_N
(
¬’a_d®loc_sm®l
)

	)

31 
	#¬’a_deÿy_tick
 
	`JEMALLOC_N
(
¬’a_deÿy_tick
)

	)

32 
	#¬’a_deÿy_ticks
 
	`JEMALLOC_N
(
¬’a_deÿy_ticks
)

	)

33 
	#¬’a_deÿy_time_deçuÉ_g‘
 
	`JEMALLOC_N
(
¬’a_deÿy_time_deçuÉ_g‘
)

	)

34 
	#¬’a_deÿy_time_deçuÉ_£t
 
	`JEMALLOC_N
(
¬’a_deÿy_time_deçuÉ_£t
)

	)

35 
	#¬’a_deÿy_time_g‘
 
	`JEMALLOC_N
(
¬’a_deÿy_time_g‘
)

	)

36 
	#¬’a_deÿy_time_£t
 
	`JEMALLOC_N
(
¬’a_deÿy_time_£t
)

	)

37 
	#¬’a_dss_´ec_g‘
 
	`JEMALLOC_N
(
¬’a_dss_´ec_g‘
)

	)

38 
	#¬’a_dss_´ec_£t
 
	`JEMALLOC_N
(
¬’a_dss_´ec_£t
)

	)

39 
	#¬’a_ex‹Á_¢_Ãxt
 
	`JEMALLOC_N
(
¬’a_ex‹Á_¢_Ãxt
)

	)

40 
	#¬’a_g‘
 
	`JEMALLOC_N
(
¬’a_g‘
)

	)

41 
	#¬’a_ichoo£
 
	`JEMALLOC_N
(
¬’a_ichoo£
)

	)

42 
	#¬’a_š™
 
	`JEMALLOC_N
(
¬’a_š™
)

	)

43 
	#¬’a_lg_dœty_muÉ_deçuÉ_g‘
 
	`JEMALLOC_N
(
¬’a_lg_dœty_muÉ_deçuÉ_g‘
)

	)

44 
	#¬’a_lg_dœty_muÉ_deçuÉ_£t
 
	`JEMALLOC_N
(
¬’a_lg_dœty_muÉ_deçuÉ_£t
)

	)

45 
	#¬’a_lg_dœty_muÉ_g‘
 
	`JEMALLOC_N
(
¬’a_lg_dœty_muÉ_g‘
)

	)

46 
	#¬’a_lg_dœty_muÉ_£t
 
	`JEMALLOC_N
(
¬’a_lg_dœty_muÉ_£t
)

	)

47 
	#¬’a_m®loc
 
	`JEMALLOC_N
(
¬’a_m®loc
)

	)

48 
	#¬’a_m®loc_h¬d
 
	`JEMALLOC_N
(
¬’a_m®loc_h¬d
)

	)

49 
	#¬’a_m®loc_Ïrge
 
	`JEMALLOC_N
(
¬’a_m®loc_Ïrge
)

	)

50 
	#¬’a_m­b™s_®loÿ‹d_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_®loÿ‹d_g‘
)

	)

51 
	#¬’a_m­b™s_bššd_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_bššd_g‘
)

	)

52 
	#¬’a_m­b™s_decomm™‹d_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_decomm™‹d_g‘
)

	)

53 
	#¬’a_m­b™s_dœty_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_dœty_g‘
)

	)

54 
	#¬’a_m­b™s_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_g‘
)

	)

55 
	#¬’a_m­b™s_š‹º®_£t
 
	`JEMALLOC_N
(
¬’a_m­b™s_š‹º®_£t
)

	)

56 
	#¬’a_m­b™s_Ïrge_bššd_£t
 
	`JEMALLOC_N
(
¬’a_m­b™s_Ïrge_bššd_£t
)

	)

57 
	#¬’a_m­b™s_Ïrge_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_Ïrge_g‘
)

	)

58 
	#¬’a_m­b™s_Ïrge_£t
 
	`JEMALLOC_N
(
¬’a_m­b™s_Ïrge_£t
)

	)

59 
	#¬’a_m­b™s_Ïrge_size_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_Ïrge_size_g‘
)

	)

60 
	#¬’a_m­b™s_size_decode
 
	`JEMALLOC_N
(
¬’a_m­b™s_size_decode
)

	)

61 
	#¬’a_m­b™s_size_’code
 
	`JEMALLOC_N
(
¬’a_m­b™s_size_’code
)

	)

62 
	#¬’a_m­b™s_sm®l_runšd_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_sm®l_runšd_g‘
)

	)

63 
	#¬’a_m­b™s_sm®l_£t
 
	`JEMALLOC_N
(
¬’a_m­b™s_sm®l_£t
)

	)

64 
	#¬’a_m­b™s_uÇÎoÿ‹d_£t
 
	`JEMALLOC_N
(
¬’a_m­b™s_uÇÎoÿ‹d_£t
)

	)

65 
	#¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
)

	)

66 
	#¬’a_m­b™s_uÇÎoÿ‹d_size_£t
 
	`JEMALLOC_N
(
¬’a_m­b™s_uÇÎoÿ‹d_size_£t
)

	)

67 
	#¬’a_m­b™s_unz”Ûd_g‘
 
	`JEMALLOC_N
(
¬’a_m­b™s_unz”Ûd_g‘
)

	)

68 
	#¬’a_m­b™¥_g‘_cÚ¡
 
	`JEMALLOC_N
(
¬’a_m­b™¥_g‘_cÚ¡
)

	)

69 
	#¬’a_m­b™¥_g‘_mubË
 
	`JEMALLOC_N
(
¬’a_m­b™¥_g‘_mubË
)

	)

70 
	#¬’a_m­b™¥_»ad
 
	`JEMALLOC_N
(
¬’a_m­b™¥_»ad
)

	)

71 
	#¬’a_m­b™¥_wr™e
 
	`JEMALLOC_N
(
¬’a_m­b™¥_wr™e
)

	)

72 
	#¬’a_maxrun
 
	`JEMALLOC_N
(
¬’a_maxrun
)

	)

73 
	#¬’a_maybe_purge
 
	`JEMALLOC_N
(
¬’a_maybe_purge
)

	)

74 
	#¬’a_m‘ad©a_®loÿ‹d_add
 
	`JEMALLOC_N
(
¬’a_m‘ad©a_®loÿ‹d_add
)

	)

75 
	#¬’a_m‘ad©a_®loÿ‹d_g‘
 
	`JEMALLOC_N
(
¬’a_m‘ad©a_®loÿ‹d_g‘
)

	)

76 
	#¬’a_m‘ad©a_®loÿ‹d_sub
 
	`JEMALLOC_N
(
¬’a_m‘ad©a_®loÿ‹d_sub
)

	)

77 
	#¬’a_mig¿‹
 
	`JEMALLOC_N
(
¬’a_mig¿‹
)

	)

78 
	#¬’a_misûlm_g‘_cÚ¡
 
	`JEMALLOC_N
(
¬’a_misûlm_g‘_cÚ¡
)

	)

79 
	#¬’a_misûlm_g‘_mubË
 
	`JEMALLOC_N
(
¬’a_misûlm_g‘_mubË
)

	)

80 
	#¬’a_misûlm_to_·gešd
 
	`JEMALLOC_N
(
¬’a_misûlm_to_·gešd
)

	)

81 
	#¬’a_misûlm_to_½ages
 
	`JEMALLOC_N
(
¬’a_misûlm_to_½ages
)

	)

82 
	#¬’a_Ãw
 
	`JEMALLOC_N
(
¬’a_Ãw
)

	)

83 
	#¬’a_node_®loc
 
	`JEMALLOC_N
(
¬’a_node_®loc
)

	)

84 
	#¬’a_node_d®loc
 
	`JEMALLOC_N
(
¬’a_node_d®loc
)

	)

85 
	#¬’a_Áh»ads_dec
 
	`JEMALLOC_N
(
¬’a_Áh»ads_dec
)

	)

86 
	#¬’a_Áh»ads_g‘
 
	`JEMALLOC_N
(
¬’a_Áh»ads_g‘
)

	)

87 
	#¬’a_Áh»ads_šc
 
	`JEMALLOC_N
(
¬’a_Áh»ads_šc
)

	)

88 
	#¬’a_·Îoc
 
	`JEMALLOC_N
(
¬’a_·Îoc
)

	)

89 
	#¬’a_po¡fÜk_chd
 
	`JEMALLOC_N
(
¬’a_po¡fÜk_chd
)

	)

90 
	#¬’a_po¡fÜk_·»Á
 
	`JEMALLOC_N
(
¬’a_po¡fÜk_·»Á
)

	)

91 
	#¬’a_´efÜk0
 
	`JEMALLOC_N
(
¬’a_´efÜk0
)

	)

92 
	#¬’a_´efÜk1
 
	`JEMALLOC_N
(
¬’a_´efÜk1
)

	)

93 
	#¬’a_´efÜk2
 
	`JEMALLOC_N
(
¬’a_´efÜk2
)

	)

94 
	#¬’a_´efÜk3
 
	`JEMALLOC_N
(
¬’a_´efÜk3
)

	)

95 
	#¬’a_´of_accum
 
	`JEMALLOC_N
(
¬’a_´of_accum
)

	)

96 
	#¬’a_´of_accum_im¶
 
	`JEMALLOC_N
(
¬’a_´of_accum_im¶
)

	)

97 
	#¬’a_´of_accum_locked
 
	`JEMALLOC_N
(
¬’a_´of_accum_locked
)

	)

98 
	#¬’a_´of_´omÙed
 
	`JEMALLOC_N
(
¬’a_´of_´omÙed
)

	)

99 
	#¬’a_´of_tùx_g‘
 
	`JEMALLOC_N
(
¬’a_´of_tùx_g‘
)

	)

100 
	#¬’a_´of_tùx_»£t
 
	`JEMALLOC_N
(
¬’a_´of_tùx_»£t
)

	)

101 
	#¬’a_´of_tùx_£t
 
	`JEMALLOC_N
(
¬’a_´of_tùx_£t
)

	)

102 
	#¬’a_±r_sm®l_bššd_g‘
 
	`JEMALLOC_N
(
¬’a_±r_sm®l_bššd_g‘
)

	)

103 
	#¬’a_purge
 
	`JEMALLOC_N
(
¬’a_purge
)

	)

104 
	#¬’a_qu¬ªtše_junk_sm®l
 
	`JEMALLOC_N
(
¬’a_qu¬ªtše_junk_sm®l
)

	)

105 
	#¬’a_¿Îoc
 
	`JEMALLOC_N
(
¬’a_¿Îoc
)

	)

106 
	#¬’a_¿Îoc_junk_Ïrge
 
	`JEMALLOC_N
(
¬’a_¿Îoc_junk_Ïrge
)

	)

107 
	#¬’a_¿Îoc_no_move
 
	`JEMALLOC_N
(
¬’a_¿Îoc_no_move
)

	)

108 
	#¬’a_rd_to_misûlm
 
	`JEMALLOC_N
(
¬’a_rd_to_misûlm
)

	)

109 
	#¬’a_»dzÚe_cÜru±iÚ
 
	`JEMALLOC_N
(
¬’a_»dzÚe_cÜru±iÚ
)

	)

110 
	#¬’a_»£t
 
	`JEMALLOC_N
(
¬’a_»£t
)

	)

111 
	#¬’a_run_»gšd
 
	`JEMALLOC_N
(
¬’a_run_»gšd
)

	)

112 
	#¬’a_run_to_misûlm
 
	`JEMALLOC_N
(
¬’a_run_to_misûlm
)

	)

113 
	#¬’a_§Îoc
 
	`JEMALLOC_N
(
¬’a_§Îoc
)

	)

114 
	#¬’a_sd®loc
 
	`JEMALLOC_N
(
¬’a_sd®loc
)

	)

115 
	#¬’a_¡©s_m”ge
 
	`JEMALLOC_N
(
¬’a_¡©s_m”ge
)

	)

116 
	#¬’a_tÿche_fl_sm®l
 
	`JEMALLOC_N
(
¬’a_tÿche_fl_sm®l
)

	)

117 
	#¬’a_td©a_g‘
 
	`JEMALLOC_N
(
¬’a_td©a_g‘
)

	)

118 
	#¬’a_td©a_g‘_h¬d
 
	`JEMALLOC_N
(
¬’a_td©a_g‘_h¬d
)

	)

119 
	#¬’as
 
	`JEMALLOC_N
(
¬’as
)

	)

120 
	#¬’as_td©a_by·ss_ş—nup
 
	`JEMALLOC_N
(
¬’as_td©a_by·ss_ş—nup
)

	)

121 
	#¬’as_td©a_ş—nup
 
	`JEMALLOC_N
(
¬’as_td©a_ş—nup
)

	)

122 
	#©omic_add_p
 
	`JEMALLOC_N
(
©omic_add_p
)

	)

123 
	#©omic_add_u
 
	`JEMALLOC_N
(
©omic_add_u
)

	)

124 
	#©omic_add_ušt32
 
	`JEMALLOC_N
(
©omic_add_ušt32
)

	)

125 
	#©omic_add_ušt64
 
	`JEMALLOC_N
(
©omic_add_ušt64
)

	)

126 
	#©omic_add_z
 
	`JEMALLOC_N
(
©omic_add_z
)

	)

127 
	#©omic_ÿs_p
 
	`JEMALLOC_N
(
©omic_ÿs_p
)

	)

128 
	#©omic_ÿs_u
 
	`JEMALLOC_N
(
©omic_ÿs_u
)

	)

129 
	#©omic_ÿs_ušt32
 
	`JEMALLOC_N
(
©omic_ÿs_ušt32
)

	)

130 
	#©omic_ÿs_ušt64
 
	`JEMALLOC_N
(
©omic_ÿs_ušt64
)

	)

131 
	#©omic_ÿs_z
 
	`JEMALLOC_N
(
©omic_ÿs_z
)

	)

132 
	#©omic_sub_p
 
	`JEMALLOC_N
(
©omic_sub_p
)

	)

133 
	#©omic_sub_u
 
	`JEMALLOC_N
(
©omic_sub_u
)

	)

134 
	#©omic_sub_ušt32
 
	`JEMALLOC_N
(
©omic_sub_ušt32
)

	)

135 
	#©omic_sub_ušt64
 
	`JEMALLOC_N
(
©omic_sub_ušt64
)

	)

136 
	#©omic_sub_z
 
	`JEMALLOC_N
(
©omic_sub_z
)

	)

137 
	#©omic_wr™e_p
 
	`JEMALLOC_N
(
©omic_wr™e_p
)

	)

138 
	#©omic_wr™e_u
 
	`JEMALLOC_N
(
©omic_wr™e_u
)

	)

139 
	#©omic_wr™e_ušt32
 
	`JEMALLOC_N
(
©omic_wr™e_ušt32
)

	)

140 
	#©omic_wr™e_ušt64
 
	`JEMALLOC_N
(
©omic_wr™e_ušt64
)

	)

141 
	#©omic_wr™e_z
 
	`JEMALLOC_N
(
©omic_wr™e_z
)

	)

142 
	#ba£_®loc
 
	`JEMALLOC_N
(
ba£_®loc
)

	)

143 
	#ba£_boÙ
 
	`JEMALLOC_N
(
ba£_boÙ
)

	)

144 
	#ba£_po¡fÜk_chd
 
	`JEMALLOC_N
(
ba£_po¡fÜk_chd
)

	)

145 
	#ba£_po¡fÜk_·»Á
 
	`JEMALLOC_N
(
ba£_po¡fÜk_·»Á
)

	)

146 
	#ba£_´efÜk
 
	`JEMALLOC_N
(
ba£_´efÜk
)

	)

147 
	#ba£_¡©s_g‘
 
	`JEMALLOC_N
(
ba£_¡©s_g‘
)

	)

148 
	#b™m­_fuÎ
 
	`JEMALLOC_N
(
b™m­_fuÎ
)

	)

149 
	#b™m­_g‘
 
	`JEMALLOC_N
(
b™m­_g‘
)

	)

150 
	#b™m­_šfo_š™
 
	`JEMALLOC_N
(
b™m­_šfo_š™
)

	)

151 
	#b™m­_š™
 
	`JEMALLOC_N
(
b™m­_š™
)

	)

152 
	#b™m­_£t
 
	`JEMALLOC_N
(
b™m­_£t
)

	)

153 
	#b™m­_sfu
 
	`JEMALLOC_N
(
b™m­_sfu
)

	)

154 
	#b™m­_size
 
	`JEMALLOC_N
(
b™m­_size
)

	)

155 
	#b™m­_un£t
 
	`JEMALLOC_N
(
b™m­_un£t
)

	)

156 
	#boÙ¡¿p_ÿÎoc
 
	`JEMALLOC_N
(
boÙ¡¿p_ÿÎoc
)

	)

157 
	#boÙ¡¿p_ä“
 
	`JEMALLOC_N
(
boÙ¡¿p_ä“
)

	)

158 
	#boÙ¡¿p_m®loc
 
	`JEMALLOC_N
(
boÙ¡¿p_m®loc
)

	)

159 
	#bt_š™
 
	`JEMALLOC_N
(
bt_š™
)

	)

160 
	#buã¼Ü
 
	`JEMALLOC_N
(
buã¼Ü
)

	)

161 
	#chunk_®loc_ba£
 
	`JEMALLOC_N
(
chunk_®loc_ba£
)

	)

162 
	#chunk_®loc_ÿche
 
	`JEMALLOC_N
(
chunk_®loc_ÿche
)

	)

163 
	#chunk_®loc_dss
 
	`JEMALLOC_N
(
chunk_®loc_dss
)

	)

164 
	#chunk_®loc_mm­
 
	`JEMALLOC_N
(
chunk_®loc_mm­
)

	)

165 
	#chunk_®loc_w¿µ”
 
	`JEMALLOC_N
(
chunk_®loc_w¿µ”
)

	)

166 
	#chunk_boÙ
 
	`JEMALLOC_N
(
chunk_boÙ
)

	)

167 
	#chunk_d®loc_ÿche
 
	`JEMALLOC_N
(
chunk_d®loc_ÿche
)

	)

168 
	#chunk_d®loc_mm­
 
	`JEMALLOC_N
(
chunk_d®loc_mm­
)

	)

169 
	#chunk_d®loc_w¿µ”
 
	`JEMALLOC_N
(
chunk_d®loc_w¿µ”
)

	)

170 
	#chunk_d”egi¡”
 
	`JEMALLOC_N
(
chunk_d”egi¡”
)

	)

171 
	#chunk_dss_boÙ
 
	`JEMALLOC_N
(
chunk_dss_boÙ
)

	)

172 
	#chunk_dss_m”g—bË
 
	`JEMALLOC_N
(
chunk_dss_m”g—bË
)

	)

173 
	#chunk_dss_´ec_g‘
 
	`JEMALLOC_N
(
chunk_dss_´ec_g‘
)

	)

174 
	#chunk_dss_´ec_£t
 
	`JEMALLOC_N
(
chunk_dss_´ec_£t
)

	)

175 
	#chunk_hooks_deçuÉ
 
	`JEMALLOC_N
(
chunk_hooks_deçuÉ
)

	)

176 
	#chunk_hooks_g‘
 
	`JEMALLOC_N
(
chunk_hooks_g‘
)

	)

177 
	#chunk_hooks_£t
 
	`JEMALLOC_N
(
chunk_hooks_£t
)

	)

178 
	#chunk_š_dss
 
	`JEMALLOC_N
(
chunk_š_dss
)

	)

179 
	#chunk_lookup
 
	`JEMALLOC_N
(
chunk_lookup
)

	)

180 
	#chunk_Åages
 
	`JEMALLOC_N
(
chunk_Åages
)

	)

181 
	#chunk_purge_w¿µ”
 
	`JEMALLOC_N
(
chunk_purge_w¿µ”
)

	)

182 
	#chunk_»gi¡”
 
	`JEMALLOC_N
(
chunk_»gi¡”
)

	)

183 
	#chunks_¹»e
 
	`JEMALLOC_N
(
chunks_¹»e
)

	)

184 
	#chunksize
 
	`JEMALLOC_N
(
chunksize
)

	)

185 
	#chunksize_mask
 
	`JEMALLOC_N
(
chunksize_mask
)

	)

186 
	#ckh_couÁ
 
	`JEMALLOC_N
(
ckh_couÁ
)

	)

187 
	#ckh_d–‘e
 
	`JEMALLOC_N
(
ckh_d–‘e
)

	)

188 
	#ckh_š£¹
 
	`JEMALLOC_N
(
ckh_š£¹
)

	)

189 
	#ckh_™”
 
	`JEMALLOC_N
(
ckh_™”
)

	)

190 
	#ckh_Ãw
 
	`JEMALLOC_N
(
ckh_Ãw
)

	)

191 
	#ckh_poš‹r_hash
 
	`JEMALLOC_N
(
ckh_poš‹r_hash
)

	)

192 
	#ckh_poš‹r_keycomp
 
	`JEMALLOC_N
(
ckh_poš‹r_keycomp
)

	)

193 
	#ckh_»move
 
	`JEMALLOC_N
(
ckh_»move
)

	)

194 
	#ckh_£¬ch
 
	`JEMALLOC_N
(
ckh_£¬ch
)

	)

195 
	#ckh_¡ršg_hash
 
	`JEMALLOC_N
(
ckh_¡ršg_hash
)

	)

196 
	#ckh_¡ršg_keycomp
 
	`JEMALLOC_N
(
ckh_¡ršg_keycomp
)

	)

197 
	#ùl_boÙ
 
	`JEMALLOC_N
(
ùl_boÙ
)

	)

198 
	#ùl_bymib
 
	`JEMALLOC_N
(
ùl_bymib
)

	)

199 
	#ùl_byÇme
 
	`JEMALLOC_N
(
ùl_byÇme
)

	)

200 
	#ùl_Çm‘omib
 
	`JEMALLOC_N
(
ùl_Çm‘omib
)

	)

201 
	#ùl_po¡fÜk_chd
 
	`JEMALLOC_N
(
ùl_po¡fÜk_chd
)

	)

202 
	#ùl_po¡fÜk_·»Á
 
	`JEMALLOC_N
(
ùl_po¡fÜk_·»Á
)

	)

203 
	#ùl_´efÜk
 
	`JEMALLOC_N
(
ùl_´efÜk
)

	)

204 
	#deÿy_tick”_g‘
 
	`JEMALLOC_N
(
deÿy_tick”_g‘
)

	)

205 
	#dss_´ec_Çmes
 
	`JEMALLOC_N
(
dss_´ec_Çmes
)

	)

206 
	#ex‹Á_node_achunk_g‘
 
	`JEMALLOC_N
(
ex‹Á_node_achunk_g‘
)

	)

207 
	#ex‹Á_node_achunk_£t
 
	`JEMALLOC_N
(
ex‹Á_node_achunk_£t
)

	)

208 
	#ex‹Á_node_addr_g‘
 
	`JEMALLOC_N
(
ex‹Á_node_addr_g‘
)

	)

209 
	#ex‹Á_node_addr_£t
 
	`JEMALLOC_N
(
ex‹Á_node_addr_£t
)

	)

210 
	#ex‹Á_node_¬’a_g‘
 
	`JEMALLOC_N
(
ex‹Á_node_¬’a_g‘
)

	)

211 
	#ex‹Á_node_¬’a_£t
 
	`JEMALLOC_N
(
ex‹Á_node_¬’a_£t
)

	)

212 
	#ex‹Á_node_comm™‹d_g‘
 
	`JEMALLOC_N
(
ex‹Á_node_comm™‹d_g‘
)

	)

213 
	#ex‹Á_node_comm™‹d_£t
 
	`JEMALLOC_N
(
ex‹Á_node_comm™‹d_£t
)

	)

214 
	#ex‹Á_node_dœty_š£¹
 
	`JEMALLOC_N
(
ex‹Á_node_dœty_š£¹
)

	)

215 
	#ex‹Á_node_dœty_lškage_š™
 
	`JEMALLOC_N
(
ex‹Á_node_dœty_lškage_š™
)

	)

216 
	#ex‹Á_node_dœty_»move
 
	`JEMALLOC_N
(
ex‹Á_node_dœty_»move
)

	)

217 
	#ex‹Á_node_š™
 
	`JEMALLOC_N
(
ex‹Á_node_š™
)

	)

218 
	#ex‹Á_node_´of_tùx_g‘
 
	`JEMALLOC_N
(
ex‹Á_node_´of_tùx_g‘
)

	)

219 
	#ex‹Á_node_´of_tùx_£t
 
	`JEMALLOC_N
(
ex‹Á_node_´of_tùx_£t
)

	)

220 
	#ex‹Á_node_size_g‘
 
	`JEMALLOC_N
(
ex‹Á_node_size_g‘
)

	)

221 
	#ex‹Á_node_size_£t
 
	`JEMALLOC_N
(
ex‹Á_node_size_£t
)

	)

222 
	#ex‹Á_node_¢_g‘
 
	`JEMALLOC_N
(
ex‹Á_node_¢_g‘
)

	)

223 
	#ex‹Á_node_¢_£t
 
	`JEMALLOC_N
(
ex‹Á_node_¢_£t
)

	)

224 
	#ex‹Á_node_z”Ûd_g‘
 
	`JEMALLOC_N
(
ex‹Á_node_z”Ûd_g‘
)

	)

225 
	#ex‹Á_node_z”Ûd_£t
 
	`JEMALLOC_N
(
ex‹Á_node_z”Ûd_£t
)

	)

226 
	#ex‹Á_Œ“_ad_de¡roy
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_de¡roy
)

	)

227 
	#ex‹Á_Œ“_ad_de¡roy_»cur£
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_de¡roy_»cur£
)

	)

228 
	#ex‹Á_Œ“_ad_em±y
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_em±y
)

	)

229 
	#ex‹Á_Œ“_ad_fœ¡
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_fœ¡
)

	)

230 
	#ex‹Á_Œ“_ad_š£¹
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_š£¹
)

	)

231 
	#ex‹Á_Œ“_ad_™”
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_™”
)

	)

232 
	#ex‹Á_Œ“_ad_™”_»cur£
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_™”_»cur£
)

	)

233 
	#ex‹Á_Œ“_ad_™”_¡¬t
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_™”_¡¬t
)

	)

234 
	#ex‹Á_Œ“_ad_Ï¡
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_Ï¡
)

	)

235 
	#ex‹Á_Œ“_ad_Ãw
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_Ãw
)

	)

236 
	#ex‹Á_Œ“_ad_Ãxt
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_Ãxt
)

	)

237 
	#ex‹Á_Œ“_ad_n£¬ch
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_n£¬ch
)

	)

238 
	#ex‹Á_Œ“_ad_´ev
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_´ev
)

	)

239 
	#ex‹Á_Œ“_ad_p£¬ch
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_p£¬ch
)

	)

240 
	#ex‹Á_Œ“_ad_»move
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_»move
)

	)

241 
	#ex‹Á_Œ“_ad_»v”£_™”
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_»v”£_™”
)

	)

242 
	#ex‹Á_Œ“_ad_»v”£_™”_»cur£
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_»v”£_™”_»cur£
)

	)

243 
	#ex‹Á_Œ“_ad_»v”£_™”_¡¬t
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_»v”£_™”_¡¬t
)

	)

244 
	#ex‹Á_Œ“_ad_£¬ch
 
	`JEMALLOC_N
(
ex‹Á_Œ“_ad_£¬ch
)

	)

245 
	#ex‹Á_Œ“_sz¢ad_de¡roy
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_de¡roy
)

	)

246 
	#ex‹Á_Œ“_sz¢ad_de¡roy_»cur£
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_de¡roy_»cur£
)

	)

247 
	#ex‹Á_Œ“_sz¢ad_em±y
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_em±y
)

	)

248 
	#ex‹Á_Œ“_sz¢ad_fœ¡
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_fœ¡
)

	)

249 
	#ex‹Á_Œ“_sz¢ad_š£¹
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_š£¹
)

	)

250 
	#ex‹Á_Œ“_sz¢ad_™”
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_™”
)

	)

251 
	#ex‹Á_Œ“_sz¢ad_™”_»cur£
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_™”_»cur£
)

	)

252 
	#ex‹Á_Œ“_sz¢ad_™”_¡¬t
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_™”_¡¬t
)

	)

253 
	#ex‹Á_Œ“_sz¢ad_Ï¡
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_Ï¡
)

	)

254 
	#ex‹Á_Œ“_sz¢ad_Ãw
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_Ãw
)

	)

255 
	#ex‹Á_Œ“_sz¢ad_Ãxt
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_Ãxt
)

	)

256 
	#ex‹Á_Œ“_sz¢ad_n£¬ch
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_n£¬ch
)

	)

257 
	#ex‹Á_Œ“_sz¢ad_´ev
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_´ev
)

	)

258 
	#ex‹Á_Œ“_sz¢ad_p£¬ch
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_p£¬ch
)

	)

259 
	#ex‹Á_Œ“_sz¢ad_»move
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_»move
)

	)

260 
	#ex‹Á_Œ“_sz¢ad_»v”£_™”
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_»v”£_™”
)

	)

261 
	#ex‹Á_Œ“_sz¢ad_»v”£_™”_»cur£
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_»v”£_™”_»cur£
)

	)

262 
	#ex‹Á_Œ“_sz¢ad_»v”£_™”_¡¬t
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_»v”£_™”_¡¬t
)

	)

263 
	#ex‹Á_Œ“_sz¢ad_£¬ch
 
	`JEMALLOC_N
(
ex‹Á_Œ“_sz¢ad_£¬ch
)

	)

264 
	#ffs_Îu
 
	`JEMALLOC_N
(
ffs_Îu
)

	)

265 
	#ffs_lu
 
	`JEMALLOC_N
(
ffs_lu
)

	)

266 
	#ffs_u
 
	`JEMALLOC_N
(
ffs_u
)

	)

267 
	#ffs_u32
 
	`JEMALLOC_N
(
ffs_u32
)

	)

268 
	#ffs_u64
 
	`JEMALLOC_N
(
ffs_u64
)

	)

269 
	#ffs_zu
 
	`JEMALLOC_N
(
ffs_zu
)

	)

270 
	#g‘_”ºo
 
	`JEMALLOC_N
(
g‘_”ºo
)

	)

271 
	#hash
 
	`JEMALLOC_N
(
hash
)

	)

272 
	#hash_fmix_32
 
	`JEMALLOC_N
(
hash_fmix_32
)

	)

273 
	#hash_fmix_64
 
	`JEMALLOC_N
(
hash_fmix_64
)

	)

274 
	#hash_g‘_block_32
 
	`JEMALLOC_N
(
hash_g‘_block_32
)

	)

275 
	#hash_g‘_block_64
 
	`JEMALLOC_N
(
hash_g‘_block_64
)

	)

276 
	#hash_rÙl_32
 
	`JEMALLOC_N
(
hash_rÙl_32
)

	)

277 
	#hash_rÙl_64
 
	`JEMALLOC_N
(
hash_rÙl_64
)

	)

278 
	#hash_x64_128
 
	`JEMALLOC_N
(
hash_x64_128
)

	)

279 
	#hash_x86_128
 
	`JEMALLOC_N
(
hash_x86_128
)

	)

280 
	#hash_x86_32
 
	`JEMALLOC_N
(
hash_x86_32
)

	)

281 
	#huge_¯Îoc
 
	`JEMALLOC_N
(
huge_¯Îoc
)

	)

282 
	#huge_d®loc
 
	`JEMALLOC_N
(
huge_d®loc
)

	)

283 
	#huge_d®loc_junk
 
	`JEMALLOC_N
(
huge_d®loc_junk
)

	)

284 
	#huge_m®loc
 
	`JEMALLOC_N
(
huge_m®loc
)

	)

285 
	#huge_·Îoc
 
	`JEMALLOC_N
(
huge_·Îoc
)

	)

286 
	#huge_´of_tùx_g‘
 
	`JEMALLOC_N
(
huge_´of_tùx_g‘
)

	)

287 
	#huge_´of_tùx_»£t
 
	`JEMALLOC_N
(
huge_´of_tùx_»£t
)

	)

288 
	#huge_´of_tùx_£t
 
	`JEMALLOC_N
(
huge_´of_tùx_£t
)

	)

289 
	#huge_¿Îoc
 
	`JEMALLOC_N
(
huge_¿Îoc
)

	)

290 
	#huge_¿Îoc_no_move
 
	`JEMALLOC_N
(
huge_¿Îoc_no_move
)

	)

291 
	#huge_§Îoc
 
	`JEMALLOC_N
(
huge_§Îoc
)

	)

292 
	#Ÿ®loc
 
	`JEMALLOC_N
(
Ÿ®loc
)

	)

293 
	#ŸÎoc
 
	`JEMALLOC_N
(
ŸÎoc
)

	)

294 
	#ŸÎocztm
 
	`JEMALLOC_N
(
ŸÎocztm
)

	)

295 
	#Ÿ»Ç_ş—nup
 
	`JEMALLOC_N
(
Ÿ»Ç_ş—nup
)

	)

296 
	#id®loc
 
	`JEMALLOC_N
(
id®loc
)

	)

297 
	#id®loùm
 
	`JEMALLOC_N
(
id®loùm
)

	)

298 
	#š_v®gršd
 
	`JEMALLOC_N
(
š_v®gršd
)

	)

299 
	#šdex2size
 
	`JEMALLOC_N
(
šdex2size
)

	)

300 
	#šdex2size_compu‹
 
	`JEMALLOC_N
(
šdex2size_compu‹
)

	)

301 
	#šdex2size_lookup
 
	`JEMALLOC_N
(
šdex2size_lookup
)

	)

302 
	#šdex2size_b
 
	`JEMALLOC_N
(
šdex2size_b
)

	)

303 
	#®loc
 
	`JEMALLOC_N
(
®loc
)

	)

304 
	#®loù
 
	`JEMALLOC_N
(
®loù
)

	)

305 
	#®locztm
 
	`JEMALLOC_N
(
®locztm
)

	)

306 
	#iq®loc
 
	`JEMALLOC_N
(
iq®loc
)

	)

307 
	#œ®loc
 
	`JEMALLOC_N
(
œ®loc
)

	)

308 
	#œ®loù
 
	`JEMALLOC_N
(
œ®loù
)

	)

309 
	#œ®loù_»®ign
 
	`JEMALLOC_N
(
œ®loù_»®ign
)

	)

310 
	#i§Îoc
 
	`JEMALLOC_N
(
i§Îoc
)

	)

311 
	#isd®loù
 
	`JEMALLOC_N
(
isd®loù
)

	)

312 
	#isq®loc
 
	`JEMALLOC_N
(
isq®loc
)

	)

313 
	#i¡h»aded
 
	`JEMALLOC_N
(
i¡h»aded
)

	)

314 
	#iv§Îoc
 
	`JEMALLOC_N
(
iv§Îoc
)

	)

315 
	#ix®loc
 
	`JEMALLOC_N
(
ix®loc
)

	)

316 
	#jem®loc_po¡fÜk_chd
 
	`JEMALLOC_N
(
jem®loc_po¡fÜk_chd
)

	)

317 
	#jem®loc_po¡fÜk_·»Á
 
	`JEMALLOC_N
(
jem®loc_po¡fÜk_·»Á
)

	)

318 
	#jem®loc_´efÜk
 
	`JEMALLOC_N
(
jem®loc_´efÜk
)

	)

319 
	#Ïrge_maxşass
 
	`JEMALLOC_N
(
Ïrge_maxşass
)

	)

320 
	#lg_æoÜ
 
	`JEMALLOC_N
(
lg_æoÜ
)

	)

321 
	#lg_´of_§m¶e
 
	`JEMALLOC_N
(
lg_´of_§m¶e
)

	)

322 
	#m®loc_ırštf
 
	`JEMALLOC_N
(
m®loc_ırštf
)

	)

323 
	#m®loc_mu‹x_as£¹_nÙ_owÃr
 
	`JEMALLOC_N
(
m®loc_mu‹x_as£¹_nÙ_owÃr
)

	)

324 
	#m®loc_mu‹x_as£¹_owÃr
 
	`JEMALLOC_N
(
m®loc_mu‹x_as£¹_owÃr
)

	)

325 
	#m®loc_mu‹x_boÙ
 
	`JEMALLOC_N
(
m®loc_mu‹x_boÙ
)

	)

326 
	#m®loc_mu‹x_š™
 
	`JEMALLOC_N
(
m®loc_mu‹x_š™
)

	)

327 
	#m®loc_mu‹x_lock
 
	`JEMALLOC_N
(
m®loc_mu‹x_lock
)

	)

328 
	#m®loc_mu‹x_po¡fÜk_chd
 
	`JEMALLOC_N
(
m®loc_mu‹x_po¡fÜk_chd
)

	)

329 
	#m®loc_mu‹x_po¡fÜk_·»Á
 
	`JEMALLOC_N
(
m®loc_mu‹x_po¡fÜk_·»Á
)

	)

330 
	#m®loc_mu‹x_´efÜk
 
	`JEMALLOC_N
(
m®loc_mu‹x_´efÜk
)

	)

331 
	#m®loc_mu‹x_uÆock
 
	`JEMALLOC_N
(
m®loc_mu‹x_uÆock
)

	)

332 
	#m®loc_´štf
 
	`JEMALLOC_N
(
m®loc_´štf
)

	)

333 
	#m®loc_¢´štf
 
	`JEMALLOC_N
(
m®loc_¢´štf
)

	)

334 
	#m®loc_¡¹oumax
 
	`JEMALLOC_N
(
m®loc_¡¹oumax
)

	)

335 
	#m®loc_tsd_boÙ0
 
	`JEMALLOC_N
(
m®loc_tsd_boÙ0
)

	)

336 
	#m®loc_tsd_boÙ1
 
	`JEMALLOC_N
(
m®loc_tsd_boÙ1
)

	)

337 
	#m®loc_tsd_ş—nup_»gi¡”
 
	`JEMALLOC_N
(
m®loc_tsd_ş—nup_»gi¡”
)

	)

338 
	#m®loc_tsd_d®loc
 
	`JEMALLOC_N
(
m®loc_tsd_d®loc
)

	)

339 
	#m®loc_tsd_m®loc
 
	`JEMALLOC_N
(
m®loc_tsd_m®loc
)

	)

340 
	#m®loc_tsd_no_ş—nup
 
	`JEMALLOC_N
(
m®loc_tsd_no_ş—nup
)

	)

341 
	#m®loc_vırštf
 
	`JEMALLOC_N
(
m®loc_vırštf
)

	)

342 
	#m®loc_v¢´štf
 
	`JEMALLOC_N
(
m®loc_v¢´štf
)

	)

343 
	#m®loc_wr™e
 
	`JEMALLOC_N
(
m®loc_wr™e
)

	)

344 
	#m­_bŸs
 
	`JEMALLOC_N
(
m­_bŸs
)

	)

345 
	#m­_misc_off£t
 
	`JEMALLOC_N
(
m­_misc_off£t
)

	)

346 
	#mb_wr™e
 
	`JEMALLOC_N
(
mb_wr™e
)

	)

347 
	#Ç»Çs_auto
 
	`JEMALLOC_N
(
Ç»Çs_auto
)

	)

348 
	#Ç»Çs_td©a_ş—nup
 
	`JEMALLOC_N
(
Ç»Çs_td©a_ş—nup
)

	)

349 
	#Ç»Çs_tÙ®_g‘
 
	`JEMALLOC_N
(
Ç»Çs_tÙ®_g‘
)

	)

350 
	#nıus
 
	`JEMALLOC_N
(
nıus
)

	)

351 
	#nhbšs
 
	`JEMALLOC_N
(
nhbšs
)

	)

352 
	#nhşas£s
 
	`JEMALLOC_N
(
nhşas£s
)

	)

353 
	#Æşas£s
 
	`JEMALLOC_N
(
Æşas£s
)

	)

354 
	#n¡ime_add
 
	`JEMALLOC_N
(
n¡ime_add
)

	)

355 
	#n¡ime_com·»
 
	`JEMALLOC_N
(
n¡ime_com·»
)

	)

356 
	#n¡ime_cİy
 
	`JEMALLOC_N
(
n¡ime_cİy
)

	)

357 
	#n¡ime_divide
 
	`JEMALLOC_N
(
n¡ime_divide
)

	)

358 
	#n¡ime_idivide
 
	`JEMALLOC_N
(
n¡ime_idivide
)

	)

359 
	#n¡ime_imuÉly
 
	`JEMALLOC_N
(
n¡ime_imuÉly
)

	)

360 
	#n¡ime_š™
 
	`JEMALLOC_N
(
n¡ime_š™
)

	)

361 
	#n¡ime_š™2
 
	`JEMALLOC_N
(
n¡ime_š™2
)

	)

362 
	#n¡ime_mÚÙÚic
 
	`JEMALLOC_N
(
n¡ime_mÚÙÚic
)

	)

363 
	#n¡ime_ns
 
	`JEMALLOC_N
(
n¡ime_ns
)

	)

364 
	#n¡ime_n£c
 
	`JEMALLOC_N
(
n¡ime_n£c
)

	)

365 
	#n¡ime_£c
 
	`JEMALLOC_N
(
n¡ime_£c
)

	)

366 
	#n¡ime_subŒaù
 
	`JEMALLOC_N
(
n¡ime_subŒaù
)

	)

367 
	#n¡ime_upd©e
 
	`JEMALLOC_N
(
n¡ime_upd©e
)

	)

368 
	#İt_abÜt
 
	`JEMALLOC_N
(
İt_abÜt
)

	)

369 
	#İt_deÿy_time
 
	`JEMALLOC_N
(
İt_deÿy_time
)

	)

370 
	#İt_dss
 
	`JEMALLOC_N
(
İt_dss
)

	)

371 
	#İt_junk
 
	`JEMALLOC_N
(
İt_junk
)

	)

372 
	#İt_junk_®loc
 
	`JEMALLOC_N
(
İt_junk_®loc
)

	)

373 
	#İt_junk_ä“
 
	`JEMALLOC_N
(
İt_junk_ä“
)

	)

374 
	#İt_lg_chunk
 
	`JEMALLOC_N
(
İt_lg_chunk
)

	)

375 
	#İt_lg_dœty_muÉ
 
	`JEMALLOC_N
(
İt_lg_dœty_muÉ
)

	)

376 
	#İt_lg_´of_š‹rv®
 
	`JEMALLOC_N
(
İt_lg_´of_š‹rv®
)

	)

377 
	#İt_lg_´of_§m¶e
 
	`JEMALLOC_N
(
İt_lg_´of_§m¶e
)

	)

378 
	#İt_lg_tÿche_max
 
	`JEMALLOC_N
(
İt_lg_tÿche_max
)

	)

379 
	#İt_Ç»Çs
 
	`JEMALLOC_N
(
İt_Ç»Çs
)

	)

380 
	#İt_´of
 
	`JEMALLOC_N
(
İt_´of
)

	)

381 
	#İt_´of_accum
 
	`JEMALLOC_N
(
İt_´of_accum
)

	)

382 
	#İt_´of_aùive
 
	`JEMALLOC_N
(
İt_´of_aùive
)

	)

383 
	#İt_´of_fš®
 
	`JEMALLOC_N
(
İt_´of_fš®
)

	)

384 
	#İt_´of_gdump
 
	`JEMALLOC_N
(
İt_´of_gdump
)

	)

385 
	#İt_´of_Ëak
 
	`JEMALLOC_N
(
İt_´of_Ëak
)

	)

386 
	#İt_´of_´efix
 
	`JEMALLOC_N
(
İt_´of_´efix
)

	)

387 
	#İt_´of_th»ad_aùive_š™
 
	`JEMALLOC_N
(
İt_´of_th»ad_aùive_š™
)

	)

388 
	#İt_purge
 
	`JEMALLOC_N
(
İt_purge
)

	)

389 
	#İt_qu¬ªtše
 
	`JEMALLOC_N
(
İt_qu¬ªtše
)

	)

390 
	#İt_»dzÚe
 
	`JEMALLOC_N
(
İt_»dzÚe
)

	)

391 
	#İt_¡©s_´št
 
	`JEMALLOC_N
(
İt_¡©s_´št
)

	)

392 
	#İt_tÿche
 
	`JEMALLOC_N
(
İt_tÿche
)

	)

393 
	#İt_uŒaû
 
	`JEMALLOC_N
(
İt_uŒaû
)

	)

394 
	#İt_xm®loc
 
	`JEMALLOC_N
(
İt_xm®loc
)

	)

395 
	#İt_z”o
 
	`JEMALLOC_N
(
İt_z”o
)

	)

396 
	#p2rz
 
	`JEMALLOC_N
(
p2rz
)

	)

397 
	#·ges_boÙ
 
	`JEMALLOC_N
(
·ges_boÙ
)

	)

398 
	#·ges_comm™
 
	`JEMALLOC_N
(
·ges_comm™
)

	)

399 
	#·ges_decomm™
 
	`JEMALLOC_N
(
·ges_decomm™
)

	)

400 
	#·ges_huge
 
	`JEMALLOC_N
(
·ges_huge
)

	)

401 
	#·ges_m­
 
	`JEMALLOC_N
(
·ges_m­
)

	)

402 
	#·ges_nohuge
 
	`JEMALLOC_N
(
·ges_nohuge
)

	)

403 
	#·ges_purge
 
	`JEMALLOC_N
(
·ges_purge
)

	)

404 
	#·ges_Œim
 
	`JEMALLOC_N
(
·ges_Œim
)

	)

405 
	#·ges_unm­
 
	`JEMALLOC_N
(
·ges_unm­
)

	)

406 
	#pšd2sz
 
	`JEMALLOC_N
(
pšd2sz
)

	)

407 
	#pšd2sz_compu‹
 
	`JEMALLOC_N
(
pšd2sz_compu‹
)

	)

408 
	#pšd2sz_lookup
 
	`JEMALLOC_N
(
pšd2sz_lookup
)

	)

409 
	#pšd2sz_b
 
	`JEMALLOC_N
(
pšd2sz_b
)

	)

410 
	#pow2_û_u32
 
	`JEMALLOC_N
(
pow2_û_u32
)

	)

411 
	#pow2_û_u64
 
	`JEMALLOC_N
(
pow2_û_u64
)

	)

412 
	#pow2_û_zu
 
	`JEMALLOC_N
(
pow2_û_zu
)

	)

413 
	#´ng_lg_¿nge_u32
 
	`JEMALLOC_N
(
´ng_lg_¿nge_u32
)

	)

414 
	#´ng_lg_¿nge_u64
 
	`JEMALLOC_N
(
´ng_lg_¿nge_u64
)

	)

415 
	#´ng_lg_¿nge_zu
 
	`JEMALLOC_N
(
´ng_lg_¿nge_zu
)

	)

416 
	#´ng_¿nge_u32
 
	`JEMALLOC_N
(
´ng_¿nge_u32
)

	)

417 
	#´ng_¿nge_u64
 
	`JEMALLOC_N
(
´ng_¿nge_u64
)

	)

418 
	#´ng_¿nge_zu
 
	`JEMALLOC_N
(
´ng_¿nge_zu
)

	)

419 
	#´ng_¡©e_Ãxt_u32
 
	`JEMALLOC_N
(
´ng_¡©e_Ãxt_u32
)

	)

420 
	#´ng_¡©e_Ãxt_u64
 
	`JEMALLOC_N
(
´ng_¡©e_Ãxt_u64
)

	)

421 
	#´ng_¡©e_Ãxt_zu
 
	`JEMALLOC_N
(
´ng_¡©e_Ãxt_zu
)

	)

422 
	#´of_aùive
 
	`JEMALLOC_N
(
´of_aùive
)

	)

423 
	#´of_aùive_g‘
 
	`JEMALLOC_N
(
´of_aùive_g‘
)

	)

424 
	#´of_aùive_g‘_uÆocked
 
	`JEMALLOC_N
(
´of_aùive_g‘_uÆocked
)

	)

425 
	#´of_aùive_£t
 
	`JEMALLOC_N
(
´of_aùive_£t
)

	)

426 
	#´of_®loc_´•
 
	`JEMALLOC_N
(
´of_®loc_´•
)

	)

427 
	#´of_®loc_rŞlback
 
	`JEMALLOC_N
(
´of_®loc_rŞlback
)

	)

428 
	#´of_backŒaû
 
	`JEMALLOC_N
(
´of_backŒaû
)

	)

429 
	#´of_boÙ0
 
	`JEMALLOC_N
(
´of_boÙ0
)

	)

430 
	#´of_boÙ1
 
	`JEMALLOC_N
(
´of_boÙ1
)

	)

431 
	#´of_boÙ2
 
	`JEMALLOC_N
(
´of_boÙ2
)

	)

432 
	#´of_bt_couÁ
 
	`JEMALLOC_N
(
´of_bt_couÁ
)

	)

433 
	#´of_dump_h—d”
 
	`JEMALLOC_N
(
´of_dump_h—d”
)

	)

434 
	#´of_dump_İ’
 
	`JEMALLOC_N
(
´of_dump_İ’
)

	)

435 
	#´of_ä“
 
	`JEMALLOC_N
(
´of_ä“
)

	)

436 
	#´of_ä“_§m¶ed_objeù
 
	`JEMALLOC_N
(
´of_ä“_§m¶ed_objeù
)

	)

437 
	#´of_gdump
 
	`JEMALLOC_N
(
´of_gdump
)

	)

438 
	#´of_gdump_g‘
 
	`JEMALLOC_N
(
´of_gdump_g‘
)

	)

439 
	#´of_gdump_g‘_uÆocked
 
	`JEMALLOC_N
(
´of_gdump_g‘_uÆocked
)

	)

440 
	#´of_gdump_£t
 
	`JEMALLOC_N
(
´of_gdump_£t
)

	)

441 
	#´of_gdump_v®
 
	`JEMALLOC_N
(
´of_gdump_v®
)

	)

442 
	#´of_idump
 
	`JEMALLOC_N
(
´of_idump
)

	)

443 
	#´of_š‹rv®
 
	`JEMALLOC_N
(
´of_š‹rv®
)

	)

444 
	#´of_lookup
 
	`JEMALLOC_N
(
´of_lookup
)

	)

445 
	#´of_m®loc
 
	`JEMALLOC_N
(
´of_m®loc
)

	)

446 
	#´of_m®loc_§m¶e_objeù
 
	`JEMALLOC_N
(
´of_m®loc_§m¶e_objeù
)

	)

447 
	#´of_mdump
 
	`JEMALLOC_N
(
´of_mdump
)

	)

448 
	#´of_po¡fÜk_chd
 
	`JEMALLOC_N
(
´of_po¡fÜk_chd
)

	)

449 
	#´of_po¡fÜk_·»Á
 
	`JEMALLOC_N
(
´of_po¡fÜk_·»Á
)

	)

450 
	#´of_´efÜk0
 
	`JEMALLOC_N
(
´of_´efÜk0
)

	)

451 
	#´of_´efÜk1
 
	`JEMALLOC_N
(
´of_´efÜk1
)

	)

452 
	#´of_»®loc
 
	`JEMALLOC_N
(
´of_»®loc
)

	)

453 
	#´of_»£t
 
	`JEMALLOC_N
(
´of_»£t
)

	)

454 
	#´of_§m¶e_accum_upd©e
 
	`JEMALLOC_N
(
´of_§m¶e_accum_upd©e
)

	)

455 
	#´of_§m¶e_th»shŞd_upd©e
 
	`JEMALLOC_N
(
´of_§m¶e_th»shŞd_upd©e
)

	)

456 
	#´of_tùx_g‘
 
	`JEMALLOC_N
(
´of_tùx_g‘
)

	)

457 
	#´of_tùx_»£t
 
	`JEMALLOC_N
(
´of_tùx_»£t
)

	)

458 
	#´of_tùx_£t
 
	`JEMALLOC_N
(
´of_tùx_£t
)

	)

459 
	#´of_td©a_ş—nup
 
	`JEMALLOC_N
(
´of_td©a_ş—nup
)

	)

460 
	#´of_td©a_couÁ
 
	`JEMALLOC_N
(
´of_td©a_couÁ
)

	)

461 
	#´of_td©a_g‘
 
	`JEMALLOC_N
(
´of_td©a_g‘
)

	)

462 
	#´of_td©a_š™
 
	`JEMALLOC_N
(
´of_td©a_š™
)

	)

463 
	#´of_td©a_»š™
 
	`JEMALLOC_N
(
´of_td©a_»š™
)

	)

464 
	#´of_th»ad_aùive_g‘
 
	`JEMALLOC_N
(
´of_th»ad_aùive_g‘
)

	)

465 
	#´of_th»ad_aùive_š™_g‘
 
	`JEMALLOC_N
(
´of_th»ad_aùive_š™_g‘
)

	)

466 
	#´of_th»ad_aùive_š™_£t
 
	`JEMALLOC_N
(
´of_th»ad_aùive_š™_£t
)

	)

467 
	#´of_th»ad_aùive_£t
 
	`JEMALLOC_N
(
´of_th»ad_aùive_£t
)

	)

468 
	#´of_th»ad_Çme_g‘
 
	`JEMALLOC_N
(
´of_th»ad_Çme_g‘
)

	)

469 
	#´of_th»ad_Çme_£t
 
	`JEMALLOC_N
(
´of_th»ad_Çme_£t
)

	)

470 
	#psz2šd
 
	`JEMALLOC_N
(
psz2šd
)

	)

471 
	#psz2u
 
	`JEMALLOC_N
(
psz2u
)

	)

472 
	#purge_mode_Çmes
 
	`JEMALLOC_N
(
purge_mode_Çmes
)

	)

473 
	#qu¬ªtše
 
	`JEMALLOC_N
(
qu¬ªtše
)

	)

474 
	#qu¬ªtše_®loc_hook
 
	`JEMALLOC_N
(
qu¬ªtše_®loc_hook
)

	)

475 
	#qu¬ªtše_®loc_hook_wÜk
 
	`JEMALLOC_N
(
qu¬ªtše_®loc_hook_wÜk
)

	)

476 
	#qu¬ªtše_ş—nup
 
	`JEMALLOC_N
(
qu¬ªtše_ş—nup
)

	)

477 
	#¹»e_chd_»ad
 
	`JEMALLOC_N
(
¹»e_chd_»ad
)

	)

478 
	#¹»e_chd_»ad_h¬d
 
	`JEMALLOC_N
(
¹»e_chd_»ad_h¬d
)

	)

479 
	#¹»e_chd_Œy»ad
 
	`JEMALLOC_N
(
¹»e_chd_Œy»ad
)

	)

480 
	#¹»e_d–‘e
 
	`JEMALLOC_N
(
¹»e_d–‘e
)

	)

481 
	#¹»e_g‘
 
	`JEMALLOC_N
(
¹»e_g‘
)

	)

482 
	#¹»e_Ãw
 
	`JEMALLOC_N
(
¹»e_Ãw
)

	)

483 
	#¹»e_node_v®id
 
	`JEMALLOC_N
(
¹»e_node_v®id
)

	)

484 
	#¹»e_£t
 
	`JEMALLOC_N
(
¹»e_£t
)

	)

485 
	#¹»e_¡¬t_Ëv–
 
	`JEMALLOC_N
(
¹»e_¡¬t_Ëv–
)

	)

486 
	#¹»e_subkey
 
	`JEMALLOC_N
(
¹»e_subkey
)

	)

487 
	#¹»e_subŒ“_»ad
 
	`JEMALLOC_N
(
¹»e_subŒ“_»ad
)

	)

488 
	#¹»e_subŒ“_»ad_h¬d
 
	`JEMALLOC_N
(
¹»e_subŒ“_»ad_h¬d
)

	)

489 
	#¹»e_subŒ“_Œy»ad
 
	`JEMALLOC_N
(
¹»e_subŒ“_Œy»ad
)

	)

490 
	#¹»e_v®_»ad
 
	`JEMALLOC_N
(
¹»e_v®_»ad
)

	)

491 
	#¹»e_v®_wr™e
 
	`JEMALLOC_N
(
¹»e_v®_wr™e
)

	)

492 
	#run_quªtize_û
 
	`JEMALLOC_N
(
run_quªtize_û
)

	)

493 
	#run_quªtize_æoÜ
 
	`JEMALLOC_N
(
run_quªtize_æoÜ
)

	)

494 
	#s2u
 
	`JEMALLOC_N
(
s2u
)

	)

495 
	#s2u_compu‹
 
	`JEMALLOC_N
(
s2u_compu‹
)

	)

496 
	#s2u_lookup
 
	`JEMALLOC_N
(
s2u_lookup
)

	)

497 
	#§2u
 
	`JEMALLOC_N
(
§2u
)

	)

498 
	#£t_”ºo
 
	`JEMALLOC_N
(
£t_”ºo
)

	)

499 
	#size2šdex
 
	`JEMALLOC_N
(
size2šdex
)

	)

500 
	#size2šdex_compu‹
 
	`JEMALLOC_N
(
size2šdex_compu‹
)

	)

501 
	#size2šdex_lookup
 
	`JEMALLOC_N
(
size2šdex_lookup
)

	)

502 
	#size2šdex_b
 
	`JEMALLOC_N
(
size2šdex_b
)

	)

503 
	#¥š_ad­tive
 
	`JEMALLOC_N
(
¥š_ad­tive
)

	)

504 
	#¥š_š™
 
	`JEMALLOC_N
(
¥š_š™
)

	)

505 
	#¡©s_ÿùive
 
	`JEMALLOC_N
(
¡©s_ÿùive
)

	)

506 
	#¡©s_ÿùive_add
 
	`JEMALLOC_N
(
¡©s_ÿùive_add
)

	)

507 
	#¡©s_ÿùive_g‘
 
	`JEMALLOC_N
(
¡©s_ÿùive_g‘
)

	)

508 
	#¡©s_ÿùive_sub
 
	`JEMALLOC_N
(
¡©s_ÿùive_sub
)

	)

509 
	#¡©s_´št
 
	`JEMALLOC_N
(
¡©s_´št
)

	)

510 
	#tÿche_®loc_—sy
 
	`JEMALLOC_N
(
tÿche_®loc_—sy
)

	)

511 
	#tÿche_®loc_Ïrge
 
	`JEMALLOC_N
(
tÿche_®loc_Ïrge
)

	)

512 
	#tÿche_®loc_sm®l
 
	`JEMALLOC_N
(
tÿche_®loc_sm®l
)

	)

513 
	#tÿche_®loc_sm®l_h¬d
 
	`JEMALLOC_N
(
tÿche_®loc_sm®l_h¬d
)

	)

514 
	#tÿche_¬’a_»assocŸ‹
 
	`JEMALLOC_N
(
tÿche_¬’a_»assocŸ‹
)

	)

515 
	#tÿche_bš_æush_Ïrge
 
	`JEMALLOC_N
(
tÿche_bš_æush_Ïrge
)

	)

516 
	#tÿche_bš_æush_sm®l
 
	`JEMALLOC_N
(
tÿche_bš_æush_sm®l
)

	)

517 
	#tÿche_bš_šfo
 
	`JEMALLOC_N
(
tÿche_bš_šfo
)

	)

518 
	#tÿche_boÙ
 
	`JEMALLOC_N
(
tÿche_boÙ
)

	)

519 
	#tÿche_ş—nup
 
	`JEMALLOC_N
(
tÿche_ş—nup
)

	)

520 
	#tÿche_ü—‹
 
	`JEMALLOC_N
(
tÿche_ü—‹
)

	)

521 
	#tÿche_d®loc_Ïrge
 
	`JEMALLOC_N
(
tÿche_d®loc_Ïrge
)

	)

522 
	#tÿche_d®loc_sm®l
 
	`JEMALLOC_N
(
tÿche_d®loc_sm®l
)

	)

523 
	#tÿche_’abËd_ş—nup
 
	`JEMALLOC_N
(
tÿche_’abËd_ş—nup
)

	)

524 
	#tÿche_’abËd_g‘
 
	`JEMALLOC_N
(
tÿche_’abËd_g‘
)

	)

525 
	#tÿche_’abËd_£t
 
	`JEMALLOC_N
(
tÿche_’abËd_£t
)

	)

526 
	#tÿche_ev’t
 
	`JEMALLOC_N
(
tÿche_ev’t
)

	)

527 
	#tÿche_ev’t_h¬d
 
	`JEMALLOC_N
(
tÿche_ev’t_h¬d
)

	)

528 
	#tÿche_æush
 
	`JEMALLOC_N
(
tÿche_æush
)

	)

529 
	#tÿche_g‘
 
	`JEMALLOC_N
(
tÿche_g‘
)

	)

530 
	#tÿche_g‘_h¬d
 
	`JEMALLOC_N
(
tÿche_g‘_h¬d
)

	)

531 
	#tÿche_maxşass
 
	`JEMALLOC_N
(
tÿche_maxşass
)

	)

532 
	#tÿche_§Îoc
 
	`JEMALLOC_N
(
tÿche_§Îoc
)

	)

533 
	#tÿche_¡©s_m”ge
 
	`JEMALLOC_N
(
tÿche_¡©s_m”ge
)

	)

534 
	#tÿches
 
	`JEMALLOC_N
(
tÿches
)

	)

535 
	#tÿches_ü—‹
 
	`JEMALLOC_N
(
tÿches_ü—‹
)

	)

536 
	#tÿches_de¡roy
 
	`JEMALLOC_N
(
tÿches_de¡roy
)

	)

537 
	#tÿches_æush
 
	`JEMALLOC_N
(
tÿches_æush
)

	)

538 
	#tÿches_g‘
 
	`JEMALLOC_N
(
tÿches_g‘
)

	)

539 
	#th»ad_®loÿ‹d_ş—nup
 
	`JEMALLOC_N
(
th»ad_®loÿ‹d_ş—nup
)

	)

540 
	#th»ad_d—Îoÿ‹d_ş—nup
 
	`JEMALLOC_N
(
th»ad_d—Îoÿ‹d_ş—nup
)

	)

541 
	#tick”_cİy
 
	`JEMALLOC_N
(
tick”_cİy
)

	)

542 
	#tick”_š™
 
	`JEMALLOC_N
(
tick”_š™
)

	)

543 
	#tick”_»ad
 
	`JEMALLOC_N
(
tick”_»ad
)

	)

544 
	#tick”_tick
 
	`JEMALLOC_N
(
tick”_tick
)

	)

545 
	#tick”_ticks
 
	`JEMALLOC_N
(
tick”_ticks
)

	)

546 
	#tsd_¬’a_g‘
 
	`JEMALLOC_N
(
tsd_¬’a_g‘
)

	)

547 
	#tsd_¬’a_£t
 
	`JEMALLOC_N
(
tsd_¬’a_£t
)

	)

548 
	#tsd_¬’­_g‘
 
	`JEMALLOC_N
(
tsd_¬’­_g‘
)

	)

549 
	#tsd_¬’as_td©a_by·ss_g‘
 
	`JEMALLOC_N
(
tsd_¬’as_td©a_by·ss_g‘
)

	)

550 
	#tsd_¬’as_td©a_by·ss_£t
 
	`JEMALLOC_N
(
tsd_¬’as_td©a_by·ss_£t
)

	)

551 
	#tsd_¬’as_td©a_by·s¥_g‘
 
	`JEMALLOC_N
(
tsd_¬’as_td©a_by·s¥_g‘
)

	)

552 
	#tsd_¬’as_td©a_g‘
 
	`JEMALLOC_N
(
tsd_¬’as_td©a_g‘
)

	)

553 
	#tsd_¬’as_td©a_£t
 
	`JEMALLOC_N
(
tsd_¬’as_td©a_£t
)

	)

554 
	#tsd_¬’as_td©­_g‘
 
	`JEMALLOC_N
(
tsd_¬’as_td©­_g‘
)

	)

555 
	#tsd_boÙ
 
	`JEMALLOC_N
(
tsd_boÙ
)

	)

556 
	#tsd_boÙ0
 
	`JEMALLOC_N
(
tsd_boÙ0
)

	)

557 
	#tsd_boÙ1
 
	`JEMALLOC_N
(
tsd_boÙ1
)

	)

558 
	#tsd_boÙed
 
	`JEMALLOC_N
(
tsd_boÙed
)

	)

559 
	#tsd_boÙed_g‘
 
	`JEMALLOC_N
(
tsd_boÙed_g‘
)

	)

560 
	#tsd_ş—nup
 
	`JEMALLOC_N
(
tsd_ş—nup
)

	)

561 
	#tsd_ş—nup_w¿µ”
 
	`JEMALLOC_N
(
tsd_ş—nup_w¿µ”
)

	)

562 
	#tsd_ãtch
 
	`JEMALLOC_N
(
tsd_ãtch
)

	)

563 
	#tsd_ãtch_im¶
 
	`JEMALLOC_N
(
tsd_ãtch_im¶
)

	)

564 
	#tsd_g‘
 
	`JEMALLOC_N
(
tsd_g‘
)

	)

565 
	#tsd_g‘_®loÿ‹s
 
	`JEMALLOC_N
(
tsd_g‘_®loÿ‹s
)

	)

566 
	#tsd_Ÿ»Ç_g‘
 
	`JEMALLOC_N
(
tsd_Ÿ»Ç_g‘
)

	)

567 
	#tsd_Ÿ»Ç_£t
 
	`JEMALLOC_N
(
tsd_Ÿ»Ç_£t
)

	)

568 
	#tsd_Ÿ»Çp_g‘
 
	`JEMALLOC_N
(
tsd_Ÿ»Çp_g‘
)

	)

569 
	#tsd_š™Ÿlized
 
	`JEMALLOC_N
(
tsd_š™Ÿlized
)

	)

570 
	#tsd_š™_check_»cursiÚ
 
	`JEMALLOC_N
(
tsd_š™_check_»cursiÚ
)

	)

571 
	#tsd_š™_fšish
 
	`JEMALLOC_N
(
tsd_š™_fšish
)

	)

572 
	#tsd_š™_h—d
 
	`JEMALLOC_N
(
tsd_š™_h—d
)

	)

573 
	#tsd_Ç»Çs_td©a_g‘
 
	`JEMALLOC_N
(
tsd_Ç»Çs_td©a_g‘
)

	)

574 
	#tsd_Ç»Çs_td©a_£t
 
	`JEMALLOC_N
(
tsd_Ç»Çs_td©a_£t
)

	)

575 
	#tsd_Ç»Çs_td©­_g‘
 
	`JEMALLOC_N
(
tsd_Ç»Çs_td©­_g‘
)

	)

576 
	#tsd_w¿µ”_g‘
 
	`JEMALLOC_N
(
tsd_w¿µ”_g‘
)

	)

577 
	#tsd_w¿µ”_£t
 
	`JEMALLOC_N
(
tsd_w¿µ”_£t
)

	)

578 
	#tsd_nomš®
 
	`JEMALLOC_N
(
tsd_nomš®
)

	)

579 
	#tsd_´of_td©a_g‘
 
	`JEMALLOC_N
(
tsd_´of_td©a_g‘
)

	)

580 
	#tsd_´of_td©a_£t
 
	`JEMALLOC_N
(
tsd_´of_td©a_£t
)

	)

581 
	#tsd_´of_td©­_g‘
 
	`JEMALLOC_N
(
tsd_´of_td©­_g‘
)

	)

582 
	#tsd_qu¬ªtše_g‘
 
	`JEMALLOC_N
(
tsd_qu¬ªtše_g‘
)

	)

583 
	#tsd_qu¬ªtše_£t
 
	`JEMALLOC_N
(
tsd_qu¬ªtše_£t
)

	)

584 
	#tsd_qu¬ªtš•_g‘
 
	`JEMALLOC_N
(
tsd_qu¬ªtš•_g‘
)

	)

585 
	#tsd_£t
 
	`JEMALLOC_N
(
tsd_£t
)

	)

586 
	#tsd_tÿche_’abËd_g‘
 
	`JEMALLOC_N
(
tsd_tÿche_’abËd_g‘
)

	)

587 
	#tsd_tÿche_’abËd_£t
 
	`JEMALLOC_N
(
tsd_tÿche_’abËd_£t
)

	)

588 
	#tsd_tÿche_’abËdp_g‘
 
	`JEMALLOC_N
(
tsd_tÿche_’abËdp_g‘
)

	)

589 
	#tsd_tÿche_g‘
 
	`JEMALLOC_N
(
tsd_tÿche_g‘
)

	)

590 
	#tsd_tÿche_£t
 
	`JEMALLOC_N
(
tsd_tÿche_£t
)

	)

591 
	#tsd_tÿch•_g‘
 
	`JEMALLOC_N
(
tsd_tÿch•_g‘
)

	)

592 
	#tsd_th»ad_®loÿ‹d_g‘
 
	`JEMALLOC_N
(
tsd_th»ad_®loÿ‹d_g‘
)

	)

593 
	#tsd_th»ad_®loÿ‹d_£t
 
	`JEMALLOC_N
(
tsd_th»ad_®loÿ‹d_£t
)

	)

594 
	#tsd_th»ad_®loÿ‹dp_g‘
 
	`JEMALLOC_N
(
tsd_th»ad_®loÿ‹dp_g‘
)

	)

595 
	#tsd_th»ad_d—Îoÿ‹d_g‘
 
	`JEMALLOC_N
(
tsd_th»ad_d—Îoÿ‹d_g‘
)

	)

596 
	#tsd_th»ad_d—Îoÿ‹d_£t
 
	`JEMALLOC_N
(
tsd_th»ad_d—Îoÿ‹d_£t
)

	)

597 
	#tsd_th»ad_d—Îoÿ‹dp_g‘
 
	`JEMALLOC_N
(
tsd_th»ad_d—Îoÿ‹dp_g‘
)

	)

598 
	#tsd_s
 
	`JEMALLOC_N
(
tsd_s
)

	)

599 
	#tsd_tsd
 
	`JEMALLOC_N
(
tsd_tsd
)

	)

600 
	#tsd_tsdn
 
	`JEMALLOC_N
(
tsd_tsdn
)

	)

601 
	#tsd_w™Ãss_fÜk_g‘
 
	`JEMALLOC_N
(
tsd_w™Ãss_fÜk_g‘
)

	)

602 
	#tsd_w™Ãss_fÜk_£t
 
	`JEMALLOC_N
(
tsd_w™Ãss_fÜk_£t
)

	)

603 
	#tsd_w™Ãss_fÜkp_g‘
 
	`JEMALLOC_N
(
tsd_w™Ãss_fÜkp_g‘
)

	)

604 
	#tsd_w™Ãs£s_g‘
 
	`JEMALLOC_N
(
tsd_w™Ãs£s_g‘
)

	)

605 
	#tsd_w™Ãs£s_£t
 
	`JEMALLOC_N
(
tsd_w™Ãs£s_£t
)

	)

606 
	#tsd_w™Ãs£¥_g‘
 
	`JEMALLOC_N
(
tsd_w™Ãs£¥_g‘
)

	)

607 
	#tsdn_ãtch
 
	`JEMALLOC_N
(
tsdn_ãtch
)

	)

608 
	#tsdn_nuÎ
 
	`JEMALLOC_N
(
tsdn_nuÎ
)

	)

609 
	#tsdn_tsd
 
	`JEMALLOC_N
(
tsdn_tsd
)

	)

610 
	#u2rz
 
	`JEMALLOC_N
(
u2rz
)

	)

611 
	#v®gršd_ä“like_block
 
	`JEMALLOC_N
(
v®gršd_ä“like_block
)

	)

612 
	#v®gršd_make_mem_defšed
 
	`JEMALLOC_N
(
v®gršd_make_mem_defšed
)

	)

613 
	#v®gršd_make_mem_nßcûss
 
	`JEMALLOC_N
(
v®gršd_make_mem_nßcûss
)

	)

614 
	#v®gršd_make_mem_undefšed
 
	`JEMALLOC_N
(
v®gršd_make_mem_undefšed
)

	)

615 
	#w™Ãss_as£¹_lockËss
 
	`JEMALLOC_N
(
w™Ãss_as£¹_lockËss
)

	)

616 
	#w™Ãss_as£¹_nÙ_owÃr
 
	`JEMALLOC_N
(
w™Ãss_as£¹_nÙ_owÃr
)

	)

617 
	#w™Ãss_as£¹_owÃr
 
	`JEMALLOC_N
(
w™Ãss_as£¹_owÃr
)

	)

618 
	#w™Ãss_fÜk_ş—nup
 
	`JEMALLOC_N
(
w™Ãss_fÜk_ş—nup
)

	)

619 
	#w™Ãss_š™
 
	`JEMALLOC_N
(
w™Ãss_š™
)

	)

620 
	#w™Ãss_lock
 
	`JEMALLOC_N
(
w™Ãss_lock
)

	)

621 
	#w™Ãss_lock_”rÜ
 
	`JEMALLOC_N
(
w™Ãss_lock_”rÜ
)

	)

622 
	#w™Ãss_lockËss_”rÜ
 
	`JEMALLOC_N
(
w™Ãss_lockËss_”rÜ
)

	)

623 
	#w™Ãss_nÙ_owÃr_”rÜ
 
	`JEMALLOC_N
(
w™Ãss_nÙ_owÃr_”rÜ
)

	)

624 
	#w™Ãss_owÃr
 
	`JEMALLOC_N
(
w™Ãss_owÃr
)

	)

625 
	#w™Ãss_owÃr_”rÜ
 
	`JEMALLOC_N
(
w™Ãss_owÃr_”rÜ
)

	)

626 
	#w™Ãss_po¡fÜk_chd
 
	`JEMALLOC_N
(
w™Ãss_po¡fÜk_chd
)

	)

627 
	#w™Ãss_po¡fÜk_·»Á
 
	`JEMALLOC_N
(
w™Ãss_po¡fÜk_·»Á
)

	)

628 
	#w™Ãss_´efÜk
 
	`JEMALLOC_N
(
w™Ãss_´efÜk
)

	)

629 
	#w™Ãss_uÆock
 
	`JEMALLOC_N
(
w™Ãss_uÆock
)

	)

630 
	#w™Ãs£s_ş—nup
 
	`JEMALLOC_N
(
w™Ãs£s_ş—nup
)

	)

631 
	#zÚe_»gi¡”
 
	`JEMALLOC_N
(
zÚe_»gi¡”
)

	)

	@deps/jemalloc/include/jemalloc/internal/private_unnamespace.h

1 #undeà
a0d®loc


2 #undeà
a0g‘


3 #undeà
a0m®loc


4 #undeà
¬’a_¯Îoc


5 #undeà
¬’a_®loc_junk_sm®l


6 #undeà
¬’a_basic_¡©s_m”ge


7 #undeà
¬’a_bš_šdex


8 #undeà
¬’a_bš_šfo


9 #undeà
¬’a_b™£lm_g‘_cÚ¡


10 #undeà
¬’a_b™£lm_g‘_mubË


11 #undeà
¬’a_boÙ


12 #undeà
¬’a_choo£


13 #undeà
¬’a_choo£_h¬d


14 #undeà
¬’a_choo£_im¶


15 #undeà
¬’a_chunk_®loc_huge


16 #undeà
¬’a_chunk_ÿche_maybe_š£¹


17 #undeà
¬’a_chunk_ÿche_maybe_»move


18 #undeà
¬’a_chunk_d®loc_huge


19 #undeà
¬’a_chunk_¿Îoc_huge_ex·nd


20 #undeà
¬’a_chunk_¿Îoc_huge_shršk


21 #undeà
¬’a_chunk_¿Îoc_huge_sim¬


22 #undeà
¬’a_ş—nup


23 #undeà
¬’a_d®loc


24 #undeà
¬’a_d®loc_bš


25 #undeà
¬’a_d®loc_bš_junked_locked


26 #undeà
¬’a_d®loc_junk_Ïrge


27 #undeà
¬’a_d®loc_junk_sm®l


28 #undeà
¬’a_d®loc_Ïrge


29 #undeà
¬’a_d®loc_Ïrge_junked_locked


30 #undeà
¬’a_d®loc_sm®l


31 #undeà
¬’a_deÿy_tick


32 #undeà
¬’a_deÿy_ticks


33 #undeà
¬’a_deÿy_time_deçuÉ_g‘


34 #undeà
¬’a_deÿy_time_deçuÉ_£t


35 #undeà
¬’a_deÿy_time_g‘


36 #undeà
¬’a_deÿy_time_£t


37 #undeà
¬’a_dss_´ec_g‘


38 #undeà
¬’a_dss_´ec_£t


39 #undeà
¬’a_ex‹Á_¢_Ãxt


40 #undeà
¬’a_g‘


41 #undeà
¬’a_ichoo£


42 #undeà
¬’a_š™


43 #undeà
¬’a_lg_dœty_muÉ_deçuÉ_g‘


44 #undeà
¬’a_lg_dœty_muÉ_deçuÉ_£t


45 #undeà
¬’a_lg_dœty_muÉ_g‘


46 #undeà
¬’a_lg_dœty_muÉ_£t


47 #undeà
¬’a_m®loc


48 #undeà
¬’a_m®loc_h¬d


49 #undeà
¬’a_m®loc_Ïrge


50 #undeà
¬’a_m­b™s_®loÿ‹d_g‘


51 #undeà
¬’a_m­b™s_bššd_g‘


52 #undeà
¬’a_m­b™s_decomm™‹d_g‘


53 #undeà
¬’a_m­b™s_dœty_g‘


54 #undeà
¬’a_m­b™s_g‘


55 #undeà
¬’a_m­b™s_š‹º®_£t


56 #undeà
¬’a_m­b™s_Ïrge_bššd_£t


57 #undeà
¬’a_m­b™s_Ïrge_g‘


58 #undeà
¬’a_m­b™s_Ïrge_£t


59 #undeà
¬’a_m­b™s_Ïrge_size_g‘


60 #undeà
¬’a_m­b™s_size_decode


61 #undeà
¬’a_m­b™s_size_’code


62 #undeà
¬’a_m­b™s_sm®l_runšd_g‘


63 #undeà
¬’a_m­b™s_sm®l_£t


64 #undeà
¬’a_m­b™s_uÇÎoÿ‹d_£t


65 #undeà
¬’a_m­b™s_uÇÎoÿ‹d_size_g‘


66 #undeà
¬’a_m­b™s_uÇÎoÿ‹d_size_£t


67 #undeà
¬’a_m­b™s_unz”Ûd_g‘


68 #undeà
¬’a_m­b™¥_g‘_cÚ¡


69 #undeà
¬’a_m­b™¥_g‘_mubË


70 #undeà
¬’a_m­b™¥_»ad


71 #undeà
¬’a_m­b™¥_wr™e


72 #undeà
¬’a_maxrun


73 #undeà
¬’a_maybe_purge


74 #undeà
¬’a_m‘ad©a_®loÿ‹d_add


75 #undeà
¬’a_m‘ad©a_®loÿ‹d_g‘


76 #undeà
¬’a_m‘ad©a_®loÿ‹d_sub


77 #undeà
¬’a_mig¿‹


78 #undeà
¬’a_misûlm_g‘_cÚ¡


79 #undeà
¬’a_misûlm_g‘_mubË


80 #undeà
¬’a_misûlm_to_·gešd


81 #undeà
¬’a_misûlm_to_½ages


82 #undeà
¬’a_Ãw


83 #undeà
¬’a_node_®loc


84 #undeà
¬’a_node_d®loc


85 #undeà
¬’a_Áh»ads_dec


86 #undeà
¬’a_Áh»ads_g‘


87 #undeà
¬’a_Áh»ads_šc


88 #undeà
¬’a_·Îoc


89 #undeà
¬’a_po¡fÜk_chd


90 #undeà
¬’a_po¡fÜk_·»Á


91 #undeà
¬’a_´efÜk0


92 #undeà
¬’a_´efÜk1


93 #undeà
¬’a_´efÜk2


94 #undeà
¬’a_´efÜk3


95 #undeà
¬’a_´of_accum


96 #undeà
¬’a_´of_accum_im¶


97 #undeà
¬’a_´of_accum_locked


98 #undeà
¬’a_´of_´omÙed


99 #undeà
¬’a_´of_tùx_g‘


100 #undeà
¬’a_´of_tùx_»£t


101 #undeà
¬’a_´of_tùx_£t


102 #undeà
¬’a_±r_sm®l_bššd_g‘


103 #undeà
¬’a_purge


104 #undeà
¬’a_qu¬ªtše_junk_sm®l


105 #undeà
¬’a_¿Îoc


106 #undeà
¬’a_¿Îoc_junk_Ïrge


107 #undeà
¬’a_¿Îoc_no_move


108 #undeà
¬’a_rd_to_misûlm


109 #undeà
¬’a_»dzÚe_cÜru±iÚ


110 #undeà
¬’a_»£t


111 #undeà
¬’a_run_»gšd


112 #undeà
¬’a_run_to_misûlm


113 #undeà
¬’a_§Îoc


114 #undeà
¬’a_sd®loc


115 #undeà
¬’a_¡©s_m”ge


116 #undeà
¬’a_tÿche_fl_sm®l


117 #undeà
¬’a_td©a_g‘


118 #undeà
¬’a_td©a_g‘_h¬d


119 #undeà
¬’as


120 #undeà
¬’as_td©a_by·ss_ş—nup


121 #undeà
¬’as_td©a_ş—nup


122 #undeà
©omic_add_p


123 #undeà
©omic_add_u


124 #undeà
©omic_add_ušt32


125 #undeà
©omic_add_ušt64


126 #undeà
©omic_add_z


127 #undeà
©omic_ÿs_p


128 #undeà
©omic_ÿs_u


129 #undeà
©omic_ÿs_ušt32


130 #undeà
©omic_ÿs_ušt64


131 #undeà
©omic_ÿs_z


132 #undeà
©omic_sub_p


133 #undeà
©omic_sub_u


134 #undeà
©omic_sub_ušt32


135 #undeà
©omic_sub_ušt64


136 #undeà
©omic_sub_z


137 #undeà
©omic_wr™e_p


138 #undeà
©omic_wr™e_u


139 #undeà
©omic_wr™e_ušt32


140 #undeà
©omic_wr™e_ušt64


141 #undeà
©omic_wr™e_z


142 #undeà
ba£_®loc


143 #undeà
ba£_boÙ


144 #undeà
ba£_po¡fÜk_chd


145 #undeà
ba£_po¡fÜk_·»Á


146 #undeà
ba£_´efÜk


147 #undeà
ba£_¡©s_g‘


148 #undeà
b™m­_fuÎ


149 #undeà
b™m­_g‘


150 #undeà
b™m­_šfo_š™


151 #undeà
b™m­_š™


152 #undeà
b™m­_£t


153 #undeà
b™m­_sfu


154 #undeà
b™m­_size


155 #undeà
b™m­_un£t


156 #undeà
boÙ¡¿p_ÿÎoc


157 #undeà
boÙ¡¿p_ä“


158 #undeà
boÙ¡¿p_m®loc


159 #undeà
bt_š™


160 #undeà
buã¼Ü


161 #undeà
chunk_®loc_ba£


162 #undeà
chunk_®loc_ÿche


163 #undeà
chunk_®loc_dss


164 #undeà
chunk_®loc_mm­


165 #undeà
chunk_®loc_w¿µ”


166 #undeà
chunk_boÙ


167 #undeà
chunk_d®loc_ÿche


168 #undeà
chunk_d®loc_mm­


169 #undeà
chunk_d®loc_w¿µ”


170 #undeà
chunk_d”egi¡”


171 #undeà
chunk_dss_boÙ


172 #undeà
chunk_dss_m”g—bË


173 #undeà
chunk_dss_´ec_g‘


174 #undeà
chunk_dss_´ec_£t


175 #undeà
chunk_hooks_deçuÉ


176 #undeà
chunk_hooks_g‘


177 #undeà
chunk_hooks_£t


178 #undeà
chunk_š_dss


179 #undeà
chunk_lookup


180 #undeà
chunk_Åages


181 #undeà
chunk_purge_w¿µ”


182 #undeà
chunk_»gi¡”


183 #undeà
chunks_¹»e


184 #undeà
chunksize


185 #undeà
chunksize_mask


186 #undeà
ckh_couÁ


187 #undeà
ckh_d–‘e


188 #undeà
ckh_š£¹


189 #undeà
ckh_™”


190 #undeà
ckh_Ãw


191 #undeà
ckh_poš‹r_hash


192 #undeà
ckh_poš‹r_keycomp


193 #undeà
ckh_»move


194 #undeà
ckh_£¬ch


195 #undeà
ckh_¡ršg_hash


196 #undeà
ckh_¡ršg_keycomp


197 #undeà
ùl_boÙ


198 #undeà
ùl_bymib


199 #undeà
ùl_byÇme


200 #undeà
ùl_Çm‘omib


201 #undeà
ùl_po¡fÜk_chd


202 #undeà
ùl_po¡fÜk_·»Á


203 #undeà
ùl_´efÜk


204 #undeà
deÿy_tick”_g‘


205 #undeà
dss_´ec_Çmes


206 #undeà
ex‹Á_node_achunk_g‘


207 #undeà
ex‹Á_node_achunk_£t


208 #undeà
ex‹Á_node_addr_g‘


209 #undeà
ex‹Á_node_addr_£t


210 #undeà
ex‹Á_node_¬’a_g‘


211 #undeà
ex‹Á_node_¬’a_£t


212 #undeà
ex‹Á_node_comm™‹d_g‘


213 #undeà
ex‹Á_node_comm™‹d_£t


214 #undeà
ex‹Á_node_dœty_š£¹


215 #undeà
ex‹Á_node_dœty_lškage_š™


216 #undeà
ex‹Á_node_dœty_»move


217 #undeà
ex‹Á_node_š™


218 #undeà
ex‹Á_node_´of_tùx_g‘


219 #undeà
ex‹Á_node_´of_tùx_£t


220 #undeà
ex‹Á_node_size_g‘


221 #undeà
ex‹Á_node_size_£t


222 #undeà
ex‹Á_node_¢_g‘


223 #undeà
ex‹Á_node_¢_£t


224 #undeà
ex‹Á_node_z”Ûd_g‘


225 #undeà
ex‹Á_node_z”Ûd_£t


226 #undeà
ex‹Á_Œ“_ad_de¡roy


227 #undeà
ex‹Á_Œ“_ad_de¡roy_»cur£


228 #undeà
ex‹Á_Œ“_ad_em±y


229 #undeà
ex‹Á_Œ“_ad_fœ¡


230 #undeà
ex‹Á_Œ“_ad_š£¹


231 #undeà
ex‹Á_Œ“_ad_™”


232 #undeà
ex‹Á_Œ“_ad_™”_»cur£


233 #undeà
ex‹Á_Œ“_ad_™”_¡¬t


234 #undeà
ex‹Á_Œ“_ad_Ï¡


235 #undeà
ex‹Á_Œ“_ad_Ãw


236 #undeà
ex‹Á_Œ“_ad_Ãxt


237 #undeà
ex‹Á_Œ“_ad_n£¬ch


238 #undeà
ex‹Á_Œ“_ad_´ev


239 #undeà
ex‹Á_Œ“_ad_p£¬ch


240 #undeà
ex‹Á_Œ“_ad_»move


241 #undeà
ex‹Á_Œ“_ad_»v”£_™”


242 #undeà
ex‹Á_Œ“_ad_»v”£_™”_»cur£


243 #undeà
ex‹Á_Œ“_ad_»v”£_™”_¡¬t


244 #undeà
ex‹Á_Œ“_ad_£¬ch


245 #undeà
ex‹Á_Œ“_sz¢ad_de¡roy


246 #undeà
ex‹Á_Œ“_sz¢ad_de¡roy_»cur£


247 #undeà
ex‹Á_Œ“_sz¢ad_em±y


248 #undeà
ex‹Á_Œ“_sz¢ad_fœ¡


249 #undeà
ex‹Á_Œ“_sz¢ad_š£¹


250 #undeà
ex‹Á_Œ“_sz¢ad_™”


251 #undeà
ex‹Á_Œ“_sz¢ad_™”_»cur£


252 #undeà
ex‹Á_Œ“_sz¢ad_™”_¡¬t


253 #undeà
ex‹Á_Œ“_sz¢ad_Ï¡


254 #undeà
ex‹Á_Œ“_sz¢ad_Ãw


255 #undeà
ex‹Á_Œ“_sz¢ad_Ãxt


256 #undeà
ex‹Á_Œ“_sz¢ad_n£¬ch


257 #undeà
ex‹Á_Œ“_sz¢ad_´ev


258 #undeà
ex‹Á_Œ“_sz¢ad_p£¬ch


259 #undeà
ex‹Á_Œ“_sz¢ad_»move


260 #undeà
ex‹Á_Œ“_sz¢ad_»v”£_™”


261 #undeà
ex‹Á_Œ“_sz¢ad_»v”£_™”_»cur£


262 #undeà
ex‹Á_Œ“_sz¢ad_»v”£_™”_¡¬t


263 #undeà
ex‹Á_Œ“_sz¢ad_£¬ch


264 #undeà
ffs_Îu


265 #undeà
ffs_lu


266 #undeà
ffs_u


267 #undeà
ffs_u32


268 #undeà
ffs_u64


269 #undeà
ffs_zu


270 #undeà
g‘_”ºo


271 #undeà
hash


272 #undeà
hash_fmix_32


273 #undeà
hash_fmix_64


274 #undeà
hash_g‘_block_32


275 #undeà
hash_g‘_block_64


276 #undeà
hash_rÙl_32


277 #undeà
hash_rÙl_64


278 #undeà
hash_x64_128


279 #undeà
hash_x86_128


280 #undeà
hash_x86_32


281 #undeà
huge_¯Îoc


282 #undeà
huge_d®loc


283 #undeà
huge_d®loc_junk


284 #undeà
huge_m®loc


285 #undeà
huge_·Îoc


286 #undeà
huge_´of_tùx_g‘


287 #undeà
huge_´of_tùx_»£t


288 #undeà
huge_´of_tùx_£t


289 #undeà
huge_¿Îoc


290 #undeà
huge_¿Îoc_no_move


291 #undeà
huge_§Îoc


292 #undeà
Ÿ®loc


293 #undeà
ŸÎoc


294 #undeà
ŸÎocztm


295 #undeà
Ÿ»Ç_ş—nup


296 #undeà
id®loc


297 #undeà
id®loùm


298 #undeà
š_v®gršd


299 #undeà
šdex2size


300 #undeà
šdex2size_compu‹


301 #undeà
šdex2size_lookup


302 #undeà
šdex2size_b


303 #undeà
®loc


304 #undeà
®loù


305 #undeà
®locztm


306 #undeà
iq®loc


307 #undeà
œ®loc


308 #undeà
œ®loù


309 #undeà
œ®loù_»®ign


310 #undeà
i§Îoc


311 #undeà
isd®loù


312 #undeà
isq®loc


313 #undeà
i¡h»aded


314 #undeà
iv§Îoc


315 #undeà
ix®loc


316 #undeà
jem®loc_po¡fÜk_chd


317 #undeà
jem®loc_po¡fÜk_·»Á


318 #undeà
jem®loc_´efÜk


319 #undeà
Ïrge_maxşass


320 #undeà
lg_æoÜ


321 #undeà
lg_´of_§m¶e


322 #undeà
m®loc_ırštf


323 #undeà
m®loc_mu‹x_as£¹_nÙ_owÃr


324 #undeà
m®loc_mu‹x_as£¹_owÃr


325 #undeà
m®loc_mu‹x_boÙ


326 #undeà
m®loc_mu‹x_š™


327 #undeà
m®loc_mu‹x_lock


328 #undeà
m®loc_mu‹x_po¡fÜk_chd


329 #undeà
m®loc_mu‹x_po¡fÜk_·»Á


330 #undeà
m®loc_mu‹x_´efÜk


331 #undeà
m®loc_mu‹x_uÆock


332 #undeà
m®loc_´štf


333 #undeà
m®loc_¢´štf


334 #undeà
m®loc_¡¹oumax


335 #undeà
m®loc_tsd_boÙ0


336 #undeà
m®loc_tsd_boÙ1


337 #undeà
m®loc_tsd_ş—nup_»gi¡”


338 #undeà
m®loc_tsd_d®loc


339 #undeà
m®loc_tsd_m®loc


340 #undeà
m®loc_tsd_no_ş—nup


341 #undeà
m®loc_vırštf


342 #undeà
m®loc_v¢´štf


343 #undeà
m®loc_wr™e


344 #undeà
m­_bŸs


345 #undeà
m­_misc_off£t


346 #undeà
mb_wr™e


347 #undeà
Ç»Çs_auto


348 #undeà
Ç»Çs_td©a_ş—nup


349 #undeà
Ç»Çs_tÙ®_g‘


350 #undeà
nıus


351 #undeà
nhbšs


352 #undeà
nhşas£s


353 #undeà
Æşas£s


354 #undeà
n¡ime_add


355 #undeà
n¡ime_com·»


356 #undeà
n¡ime_cİy


357 #undeà
n¡ime_divide


358 #undeà
n¡ime_idivide


359 #undeà
n¡ime_imuÉly


360 #undeà
n¡ime_š™


361 #undeà
n¡ime_š™2


362 #undeà
n¡ime_mÚÙÚic


363 #undeà
n¡ime_ns


364 #undeà
n¡ime_n£c


365 #undeà
n¡ime_£c


366 #undeà
n¡ime_subŒaù


367 #undeà
n¡ime_upd©e


368 #undeà
İt_abÜt


369 #undeà
İt_deÿy_time


370 #undeà
İt_dss


371 #undeà
İt_junk


372 #undeà
İt_junk_®loc


373 #undeà
İt_junk_ä“


374 #undeà
İt_lg_chunk


375 #undeà
İt_lg_dœty_muÉ


376 #undeà
İt_lg_´of_š‹rv®


377 #undeà
İt_lg_´of_§m¶e


378 #undeà
İt_lg_tÿche_max


379 #undeà
İt_Ç»Çs


380 #undeà
İt_´of


381 #undeà
İt_´of_accum


382 #undeà
İt_´of_aùive


383 #undeà
İt_´of_fš®


384 #undeà
İt_´of_gdump


385 #undeà
İt_´of_Ëak


386 #undeà
İt_´of_´efix


387 #undeà
İt_´of_th»ad_aùive_š™


388 #undeà
İt_purge


389 #undeà
İt_qu¬ªtše


390 #undeà
İt_»dzÚe


391 #undeà
İt_¡©s_´št


392 #undeà
İt_tÿche


393 #undeà
İt_uŒaû


394 #undeà
İt_xm®loc


395 #undeà
İt_z”o


396 #undeà
p2rz


397 #undeà
·ges_boÙ


398 #undeà
·ges_comm™


399 #undeà
·ges_decomm™


400 #undeà
·ges_huge


401 #undeà
·ges_m­


402 #undeà
·ges_nohuge


403 #undeà
·ges_purge


404 #undeà
·ges_Œim


405 #undeà
·ges_unm­


406 #undeà
pšd2sz


407 #undeà
pšd2sz_compu‹


408 #undeà
pšd2sz_lookup


409 #undeà
pšd2sz_b


410 #undeà
pow2_û_u32


411 #undeà
pow2_û_u64


412 #undeà
pow2_û_zu


413 #undeà
´ng_lg_¿nge_u32


414 #undeà
´ng_lg_¿nge_u64


415 #undeà
´ng_lg_¿nge_zu


416 #undeà
´ng_¿nge_u32


417 #undeà
´ng_¿nge_u64


418 #undeà
´ng_¿nge_zu


419 #undeà
´ng_¡©e_Ãxt_u32


420 #undeà
´ng_¡©e_Ãxt_u64


421 #undeà
´ng_¡©e_Ãxt_zu


422 #undeà
´of_aùive


423 #undeà
´of_aùive_g‘


424 #undeà
´of_aùive_g‘_uÆocked


425 #undeà
´of_aùive_£t


426 #undeà
´of_®loc_´•


427 #undeà
´of_®loc_rŞlback


428 #undeà
´of_backŒaû


429 #undeà
´of_boÙ0


430 #undeà
´of_boÙ1


431 #undeà
´of_boÙ2


432 #undeà
´of_bt_couÁ


433 #undeà
´of_dump_h—d”


434 #undeà
´of_dump_İ’


435 #undeà
´of_ä“


436 #undeà
´of_ä“_§m¶ed_objeù


437 #undeà
´of_gdump


438 #undeà
´of_gdump_g‘


439 #undeà
´of_gdump_g‘_uÆocked


440 #undeà
´of_gdump_£t


441 #undeà
´of_gdump_v®


442 #undeà
´of_idump


443 #undeà
´of_š‹rv®


444 #undeà
´of_lookup


445 #undeà
´of_m®loc


446 #undeà
´of_m®loc_§m¶e_objeù


447 #undeà
´of_mdump


448 #undeà
´of_po¡fÜk_chd


449 #undeà
´of_po¡fÜk_·»Á


450 #undeà
´of_´efÜk0


451 #undeà
´of_´efÜk1


452 #undeà
´of_»®loc


453 #undeà
´of_»£t


454 #undeà
´of_§m¶e_accum_upd©e


455 #undeà
´of_§m¶e_th»shŞd_upd©e


456 #undeà
´of_tùx_g‘


457 #undeà
´of_tùx_»£t


458 #undeà
´of_tùx_£t


459 #undeà
´of_td©a_ş—nup


460 #undeà
´of_td©a_couÁ


461 #undeà
´of_td©a_g‘


462 #undeà
´of_td©a_š™


463 #undeà
´of_td©a_»š™


464 #undeà
´of_th»ad_aùive_g‘


465 #undeà
´of_th»ad_aùive_š™_g‘


466 #undeà
´of_th»ad_aùive_š™_£t


467 #undeà
´of_th»ad_aùive_£t


468 #undeà
´of_th»ad_Çme_g‘


469 #undeà
´of_th»ad_Çme_£t


470 #undeà
psz2šd


471 #undeà
psz2u


472 #undeà
purge_mode_Çmes


473 #undeà
qu¬ªtše


474 #undeà
qu¬ªtše_®loc_hook


475 #undeà
qu¬ªtše_®loc_hook_wÜk


476 #undeà
qu¬ªtše_ş—nup


477 #undeà
¹»e_chd_»ad


478 #undeà
¹»e_chd_»ad_h¬d


479 #undeà
¹»e_chd_Œy»ad


480 #undeà
¹»e_d–‘e


481 #undeà
¹»e_g‘


482 #undeà
¹»e_Ãw


483 #undeà
¹»e_node_v®id


484 #undeà
¹»e_£t


485 #undeà
¹»e_¡¬t_Ëv–


486 #undeà
¹»e_subkey


487 #undeà
¹»e_subŒ“_»ad


488 #undeà
¹»e_subŒ“_»ad_h¬d


489 #undeà
¹»e_subŒ“_Œy»ad


490 #undeà
¹»e_v®_»ad


491 #undeà
¹»e_v®_wr™e


492 #undeà
run_quªtize_û


493 #undeà
run_quªtize_æoÜ


494 #undeà
s2u


495 #undeà
s2u_compu‹


496 #undeà
s2u_lookup


497 #undeà
§2u


498 #undeà
£t_”ºo


499 #undeà
size2šdex


500 #undeà
size2šdex_compu‹


501 #undeà
size2šdex_lookup


502 #undeà
size2šdex_b


503 #undeà
¥š_ad­tive


504 #undeà
¥š_š™


505 #undeà
¡©s_ÿùive


506 #undeà
¡©s_ÿùive_add


507 #undeà
¡©s_ÿùive_g‘


508 #undeà
¡©s_ÿùive_sub


509 #undeà
¡©s_´št


510 #undeà
tÿche_®loc_—sy


511 #undeà
tÿche_®loc_Ïrge


512 #undeà
tÿche_®loc_sm®l


513 #undeà
tÿche_®loc_sm®l_h¬d


514 #undeà
tÿche_¬’a_»assocŸ‹


515 #undeà
tÿche_bš_æush_Ïrge


516 #undeà
tÿche_bš_æush_sm®l


517 #undeà
tÿche_bš_šfo


518 #undeà
tÿche_boÙ


519 #undeà
tÿche_ş—nup


520 #undeà
tÿche_ü—‹


521 #undeà
tÿche_d®loc_Ïrge


522 #undeà
tÿche_d®loc_sm®l


523 #undeà
tÿche_’abËd_ş—nup


524 #undeà
tÿche_’abËd_g‘


525 #undeà
tÿche_’abËd_£t


526 #undeà
tÿche_ev’t


527 #undeà
tÿche_ev’t_h¬d


528 #undeà
tÿche_æush


529 #undeà
tÿche_g‘


530 #undeà
tÿche_g‘_h¬d


531 #undeà
tÿche_maxşass


532 #undeà
tÿche_§Îoc


533 #undeà
tÿche_¡©s_m”ge


534 #undeà
tÿches


535 #undeà
tÿches_ü—‹


536 #undeà
tÿches_de¡roy


537 #undeà
tÿches_æush


538 #undeà
tÿches_g‘


539 #undeà
th»ad_®loÿ‹d_ş—nup


540 #undeà
th»ad_d—Îoÿ‹d_ş—nup


541 #undeà
tick”_cİy


542 #undeà
tick”_š™


543 #undeà
tick”_»ad


544 #undeà
tick”_tick


545 #undeà
tick”_ticks


546 #undeà
tsd_¬’a_g‘


547 #undeà
tsd_¬’a_£t


548 #undeà
tsd_¬’­_g‘


549 #undeà
tsd_¬’as_td©a_by·ss_g‘


550 #undeà
tsd_¬’as_td©a_by·ss_£t


551 #undeà
tsd_¬’as_td©a_by·s¥_g‘


552 #undeà
tsd_¬’as_td©a_g‘


553 #undeà
tsd_¬’as_td©a_£t


554 #undeà
tsd_¬’as_td©­_g‘


555 #undeà
tsd_boÙ


556 #undeà
tsd_boÙ0


557 #undeà
tsd_boÙ1


558 #undeà
tsd_boÙed


559 #undeà
tsd_boÙed_g‘


560 #undeà
tsd_ş—nup


561 #undeà
tsd_ş—nup_w¿µ”


562 #undeà
tsd_ãtch


563 #undeà
tsd_ãtch_im¶


564 #undeà
tsd_g‘


565 #undeà
tsd_g‘_®loÿ‹s


566 #undeà
tsd_Ÿ»Ç_g‘


567 #undeà
tsd_Ÿ»Ç_£t


568 #undeà
tsd_Ÿ»Çp_g‘


569 #undeà
tsd_š™Ÿlized


570 #undeà
tsd_š™_check_»cursiÚ


571 #undeà
tsd_š™_fšish


572 #undeà
tsd_š™_h—d


573 #undeà
tsd_Ç»Çs_td©a_g‘


574 #undeà
tsd_Ç»Çs_td©a_£t


575 #undeà
tsd_Ç»Çs_td©­_g‘


576 #undeà
tsd_w¿µ”_g‘


577 #undeà
tsd_w¿µ”_£t


578 #undeà
tsd_nomš®


579 #undeà
tsd_´of_td©a_g‘


580 #undeà
tsd_´of_td©a_£t


581 #undeà
tsd_´of_td©­_g‘


582 #undeà
tsd_qu¬ªtše_g‘


583 #undeà
tsd_qu¬ªtše_£t


584 #undeà
tsd_qu¬ªtš•_g‘


585 #undeà
tsd_£t


586 #undeà
tsd_tÿche_’abËd_g‘


587 #undeà
tsd_tÿche_’abËd_£t


588 #undeà
tsd_tÿche_’abËdp_g‘


589 #undeà
tsd_tÿche_g‘


590 #undeà
tsd_tÿche_£t


591 #undeà
tsd_tÿch•_g‘


592 #undeà
tsd_th»ad_®loÿ‹d_g‘


593 #undeà
tsd_th»ad_®loÿ‹d_£t


594 #undeà
tsd_th»ad_®loÿ‹dp_g‘


595 #undeà
tsd_th»ad_d—Îoÿ‹d_g‘


596 #undeà
tsd_th»ad_d—Îoÿ‹d_£t


597 #undeà
tsd_th»ad_d—Îoÿ‹dp_g‘


598 #undeà
tsd_s


599 #undeà
tsd_tsd


600 #undeà
tsd_tsdn


601 #undeà
tsd_w™Ãss_fÜk_g‘


602 #undeà
tsd_w™Ãss_fÜk_£t


603 #undeà
tsd_w™Ãss_fÜkp_g‘


604 #undeà
tsd_w™Ãs£s_g‘


605 #undeà
tsd_w™Ãs£s_£t


606 #undeà
tsd_w™Ãs£¥_g‘


607 #undeà
tsdn_ãtch


608 #undeà
tsdn_nuÎ


609 #undeà
tsdn_tsd


610 #undeà
u2rz


611 #undeà
v®gršd_ä“like_block


612 #undeà
v®gršd_make_mem_defšed


613 #undeà
v®gršd_make_mem_nßcûss


614 #undeà
v®gršd_make_mem_undefšed


615 #undeà
w™Ãss_as£¹_lockËss


616 #undeà
w™Ãss_as£¹_nÙ_owÃr


617 #undeà
w™Ãss_as£¹_owÃr


618 #undeà
w™Ãss_fÜk_ş—nup


619 #undeà
w™Ãss_š™


620 #undeà
w™Ãss_lock


621 #undeà
w™Ãss_lock_”rÜ


622 #undeà
w™Ãss_lockËss_”rÜ


623 #undeà
w™Ãss_nÙ_owÃr_”rÜ


624 #undeà
w™Ãss_owÃr


625 #undeà
w™Ãss_owÃr_”rÜ


626 #undeà
w™Ãss_po¡fÜk_chd


627 #undeà
w™Ãss_po¡fÜk_·»Á


628 #undeà
w™Ãss_´efÜk


629 #undeà
w™Ãss_uÆock


630 #undeà
w™Ãs£s_ş—nup


631 #undeà
zÚe_»gi¡”


	@deps/jemalloc/include/jemalloc/internal/prng.h

2 #ifdeà
JEMALLOC_H_TYPES


23 
	#PRNG_A_32
 
	`UINT32_C
(1103515241)

	)

24 
	#PRNG_C_32
 
	`UINT32_C
(12347)

	)

26 
	#PRNG_A_64
 
	`UINT64_C
(6364136223846793005)

	)

27 
	#PRNG_C_64
 
	`UINT64_C
(1442695040888963407)

	)

31 #ifdeà
JEMALLOC_H_STRUCTS


35 #ifdeà
JEMALLOC_H_EXTERNS


39 #ifdeà
JEMALLOC_H_INLINES


41 #iâdeà
JEMALLOC_ENABLE_INLINE


42 
ušt32_t
 
´ng_¡©e_Ãxt_u32
(ušt32_ˆ
¡©e
);

43 
ušt64_t
 
´ng_¡©e_Ãxt_u64
(ušt64_ˆ
¡©e
);

44 
size_t
 
´ng_¡©e_Ãxt_zu
(size_ˆ
¡©e
);

46 
ušt32_t
 
´ng_lg_¿nge_u32
(ušt32_ˆ*
¡©e
, 
lg_¿nge
,

47 
boŞ
 
©omic
);

48 
ušt64_t
 
´ng_lg_¿nge_u64
(ušt64_ˆ*
¡©e
, 
lg_¿nge
);

49 
size_t
 
´ng_lg_¿nge_zu
(size_ˆ*
¡©e
, 
lg_¿nge
, 
boŞ
 
©omic
);

51 
ušt32_t
 
´ng_¿nge_u32
(ušt32_ˆ*
¡©e
, ušt32_ˆ
¿nge
, 
boŞ
 
©omic
);

52 
ušt64_t
 
´ng_¿nge_u64
(ušt64_ˆ*
¡©e
, ušt64_ˆ
¿nge
);

53 
size_t
 
´ng_¿nge_zu
(size_ˆ*
¡©e
, size_ˆ
¿nge
, 
boŞ
 
©omic
);

56 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_PRNG_C_
))

57 
JEMALLOC_ALWAYS_INLINE
 
ušt32_t


58 
	$´ng_¡©e_Ãxt_u32
(
ušt32_t
 
¡©e
)

61  ((
¡©e
 * 
PRNG_A_32
è+ 
PRNG_C_32
);

62 
	}
}

64 
JEMALLOC_ALWAYS_INLINE
 
ušt64_t


65 
	$´ng_¡©e_Ãxt_u64
(
ušt64_t
 
¡©e
)

68  ((
¡©e
 * 
PRNG_A_64
è+ 
PRNG_C_64
);

69 
	}
}

71 
JEMALLOC_ALWAYS_INLINE
 
size_t


72 
	$´ng_¡©e_Ãxt_zu
(
size_t
 
¡©e
)

75 #ià
LG_SIZEOF_PTR
 == 2

76  ((
¡©e
 * 
PRNG_A_32
è+ 
PRNG_C_32
);

77 #–ià
LG_SIZEOF_PTR
 == 3

78  ((
¡©e
 * 
PRNG_A_64
è+ 
PRNG_C_64
);

80 #”rÜ 
UnsuµÜ‹d
 
poš‹r
 
size


82 
	}
}

84 
JEMALLOC_ALWAYS_INLINE
 
ušt32_t


85 
	$´ng_lg_¿nge_u32
(
ušt32_t
 *
¡©e
, 
lg_¿nge
, 
boŞ
 
©omic
)

87 
ušt32_t
 
»t
, 
¡©e1
;

89 
	`as£¹
(
lg_¿nge
 > 0);

90 
	`as£¹
(
lg_¿nge
 <= 32);

92 ià(
©omic
) {

93 
ušt32_t
 
¡©e0
;

96 
¡©e0
 = 
	`©omic_»ad_ušt32
(
¡©e
);

97 
¡©e1
 = 
	`´ng_¡©e_Ãxt_u32
(
¡©e0
);

98 } 
	`©omic_ÿs_ušt32
(
¡©e
, 
¡©e0
, 
¡©e1
));

100 
¡©e1
 = 
	`´ng_¡©e_Ãxt_u32
(*
¡©e
);

101 *
¡©e
 = 
¡©e1
;

103 
»t
 = 
¡©e1
 >> (32 - 
lg_¿nge
);

105  (
»t
);

106 
	}
}

109 
JEMALLOC_ALWAYS_INLINE
 
ušt64_t


110 
	$´ng_lg_¿nge_u64
(
ušt64_t
 *
¡©e
, 
lg_¿nge
)

112 
ušt64_t
 
»t
, 
¡©e1
;

114 
	`as£¹
(
lg_¿nge
 > 0);

115 
	`as£¹
(
lg_¿nge
 <= 64);

117 
¡©e1
 = 
	`´ng_¡©e_Ãxt_u64
(*
¡©e
);

118 *
¡©e
 = 
¡©e1
;

119 
»t
 = 
¡©e1
 >> (64 - 
lg_¿nge
);

121  (
»t
);

122 
	}
}

124 
JEMALLOC_ALWAYS_INLINE
 
size_t


125 
	$´ng_lg_¿nge_zu
(
size_t
 *
¡©e
, 
lg_¿nge
, 
boŞ
 
©omic
)

127 
size_t
 
»t
, 
¡©e1
;

129 
	`as£¹
(
lg_¿nge
 > 0);

130 
	`as£¹
(
lg_¿nge
 <ğ
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
));

132 ià(
©omic
) {

133 
size_t
 
¡©e0
;

136 
¡©e0
 = 
	`©omic_»ad_z
(
¡©e
);

137 
¡©e1
 = 
	`´ng_¡©e_Ãxt_zu
(
¡©e0
);

138 } 
	`©omic_ÿs_z
(
¡©e
, 
¡©e0
, 
¡©e1
));

140 
¡©e1
 = 
	`´ng_¡©e_Ãxt_zu
(*
¡©e
);

141 *
¡©e
 = 
¡©e1
;

143 
»t
 = 
¡©e1
 >> ((
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
)è- 
lg_¿nge
);

145  (
»t
);

146 
	}
}

148 
JEMALLOC_ALWAYS_INLINE
 
ušt32_t


149 
	$´ng_¿nge_u32
(
ušt32_t
 *
¡©e
, ušt32_ˆ
¿nge
, 
boŞ
 
©omic
)

151 
ušt32_t
 
»t
;

152 
lg_¿nge
;

154 
	`as£¹
(
¿nge
 > 1);

157 
lg_¿nge
 = 
	`ffs_u32
(
	`pow2_û_u32
(
¿nge
)) - 1;

161 
»t
 = 
	`´ng_lg_¿nge_u32
(
¡©e
, 
lg_¿nge
, 
©omic
);

162 } 
»t
 >ğ
¿nge
);

164  (
»t
);

165 
	}
}

167 
JEMALLOC_ALWAYS_INLINE
 
ušt64_t


168 
	$´ng_¿nge_u64
(
ušt64_t
 *
¡©e
, ušt64_ˆ
¿nge
)

170 
ušt64_t
 
»t
;

171 
lg_¿nge
;

173 
	`as£¹
(
¿nge
 > 1);

176 
lg_¿nge
 = 
	`ffs_u64
(
	`pow2_û_u64
(
¿nge
)) - 1;

180 
»t
 = 
	`´ng_lg_¿nge_u64
(
¡©e
, 
lg_¿nge
);

181 } 
»t
 >ğ
¿nge
);

183  (
»t
);

184 
	}
}

186 
JEMALLOC_ALWAYS_INLINE
 
size_t


187 
	$´ng_¿nge_zu
(
size_t
 *
¡©e
, size_ˆ
¿nge
, 
boŞ
 
©omic
)

189 
size_t
 
»t
;

190 
lg_¿nge
;

192 
	`as£¹
(
¿nge
 > 1);

195 
lg_¿nge
 = 
	`ffs_u64
(
	`pow2_û_u64
(
¿nge
)) - 1;

199 
»t
 = 
	`´ng_lg_¿nge_zu
(
¡©e
, 
lg_¿nge
, 
©omic
);

200 } 
»t
 >ğ
¿nge
);

202  (
»t
);

203 
	}
}

	@deps/jemalloc/include/jemalloc/internal/prof.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
´of_bt_s
 
	t´of_bt_t
;

5 
´of_út_s
 
	t´of_út_t
;

6 
´of_tùx_s
 
	t´of_tùx_t
;

7 
´of_gùx_s
 
	t´of_gùx_t
;

8 
´of_td©a_s
 
	t´of_td©a_t
;

11 #ifdeà
JEMALLOC_PROF


12 
	#PROF_PREFIX_DEFAULT
 "j•rof"

	)

14 
	#PROF_PREFIX_DEFAULT
 ""

	)

16 
	#LG_PROF_SAMPLE_DEFAULT
 19

	)

17 
	#LG_PROF_INTERVAL_DEFAULT
 -1

	)

24 
	#PROF_BT_MAX
 128

	)

27 
	#PROF_CKH_MINITEMS
 64

	)

30 
	#PROF_DUMP_BUFSIZE
 65536

	)

33 
	#PROF_PRINTF_BUFSIZE
 128

	)

39 
	#PROF_NCTX_LOCKS
 1024

	)

45 
	#PROF_NTDATA_LOCKS
 256

	)

51 
	#PROF_TDATA_STATE_REINCARNATED
 ((
´of_td©a_t
 *)(
ušŒ_t
)1)

	)

52 
	#PROF_TDATA_STATE_PURGATORY
 ((
´of_td©a_t
 *)(
ušŒ_t
)2)

	)

53 
	#PROF_TDATA_STATE_MAX
 
PROF_TDATA_STATE_PURGATORY


	)

57 #ifdeà
JEMALLOC_H_STRUCTS


59 
	s´of_bt_s
 {

61 **
	mvec
;

62 
	mËn
;

65 #ifdeà
JEMALLOC_PROF_LIBGCC


68 
´of_bt_t
 *
	mbt
;

69 
	mmax
;

70 } 
	t´of_unwšd_d©a_t
;

73 
	s´of_út_s
 {

75 
ušt64_t
 
	mcurobjs
;

76 
ušt64_t
 
	mcurby‹s
;

77 
ušt64_t
 
	maccumobjs
;

78 
ušt64_t
 
	maccumby‹s
;

82 
	m´of_tùx_¡©e_š™Ÿlizšg
,

83 
	m´of_tùx_¡©e_nomš®
,

84 
	m´of_tùx_¡©e_dumpšg
,

85 
	m´of_tùx_¡©e_purg©Üy


86 } 
	t´of_tùx_¡©e_t
;

88 
	s´of_tùx_s
 {

90 
´of_td©a_t
 *
	mtd©a
;

96 
ušt64_t
 
	mthr_uid
;

97 
ušt64_t
 
	mthr_disüim
;

100 
´of_út_t
 
	múts
;

103 
´of_gùx_t
 *
	mgùx
;

118 
ušt64_t
 
	mtùx_uid
;

121 
rb_node
(
´of_tùx_t
è
	mtùx_lšk
;

127 
boŞ
 
	m´•¬ed
;

130 
´of_tùx_¡©e_t
 
	m¡©e
;

136 
´of_út_t
 
	mdump_úts
;

138 
	$rb_Œ“
(
	t´of_tùx_t
è
	t´of_tùx_Œ“_t
;

140 
	s´of_gùx_s
 {

142 
m®loc_mu‹x_t
 *
lock
;

154 
Æimbo
;

160 
´of_tùx_Œ“_t
 
tùxs
;

163 
	`rb_node
(
´of_gùx_t
è
dump_lšk
;

166 
´of_út_t
 
út_summed
;

169 
´of_bt_t
 
bt
;

172 *
vec
[1];

174 
	$rb_Œ“
(
	t´of_gùx_t
è
	t´of_gùx_Œ“_t
;

176 
	s´of_td©a_s
 {

177 
m®loc_mu‹x_t
 *
lock
;

180 
ušt64_t
 
thr_uid
;

186 
ušt64_t
 
thr_disüim
;

189 *
th»ad_Çme
;

191 
boŞ
 
©ched
;

192 
boŞ
 
expœed
;

194 
	`rb_node
(
´of_td©a_t
è
td©a_lšk
;

201 
ušt64_t
 
tùx_uid_Ãxt
;

209 
ckh_t
 
bt2tùx
;

212 
ušt64_t
 
´ng_¡©e
;

213 
ušt64_t
 
by‹s_uÁ_§m¶e
;

216 
boŞ
 
’q
;

217 
boŞ
 
’q_idump
;

218 
boŞ
 
’q_gdump
;

226 
boŞ
 
dumpšg
;

232 
boŞ
 
aùive
;

235 
´of_út_t
 
út_summed
;

238 *
vec
[
PROF_BT_MAX
];

240 
	$rb_Œ“
(
	t´of_td©a_t
è
	t´of_td©a_Œ“_t
;

244 #ifdeà
JEMALLOC_H_EXTERNS


246 
boŞ
 
İt_´of
;

247 
boŞ
 
İt_´of_aùive
;

248 
boŞ
 
İt_´of_th»ad_aùive_š™
;

249 
size_t
 
İt_lg_´of_§m¶e
;

250 
ssize_t
 
İt_lg_´of_š‹rv®
;

251 
boŞ
 
İt_´of_gdump
;

252 
boŞ
 
İt_´of_fš®
;

253 
boŞ
 
İt_´of_Ëak
;

254 
boŞ
 
İt_´of_accum
;

255 
İt_´of_´efix
[

257 #ifdeà
JEMALLOC_PROF


258 
PATH_MAX
 +

263 
boŞ
 
´of_aùive
;

266 
boŞ
 
´of_gdump_v®
;

275 
ušt64_t
 
´of_š‹rv®
;

281 
size_t
 
lg_´of_§m¶e
;

283 
	`´of_®loc_rŞlback
(
tsd_t
 *
tsd
, 
´of_tùx_t
 *
tùx
, 
boŞ
 
upd©ed
);

284 
	`´of_m®loc_§m¶e_objeù
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
,

285 
´of_tùx_t
 *
tùx
);

286 
	`´of_ä“_§m¶ed_objeù
(
tsd_t
 *
tsd
, 
size_t
 
usize
, 
´of_tùx_t
 *
tùx
);

287 
	`bt_š™
(
´of_bt_t
 *
bt
, **
vec
);

288 
	`´of_backŒaû
(
´of_bt_t
 *
bt
);

289 
´of_tùx_t
 *
	`´of_lookup
(
tsd_t
 *
tsd
, 
´of_bt_t
 *
bt
);

290 #ifdeà
JEMALLOC_JET


291 
size_t
 
	`´of_td©a_couÁ
();

292 
size_t
 
	`´of_bt_couÁ
();

293 cÚ¡ 
´of_út_t
 *
	`´of_út_®l
();

294 (
	t´of_dump_İ’_t
)(
	tboŞ
, const *);

295 
´of_dump_İ’_t
 *
´of_dump_İ’
;

296 
	$boŞ
 (
	t´of_dump_h—d”_t
)(
	ttsdn_t
 *, 
	tboŞ
, cÚ¡ 
	t´of_út_t
 *);

297 
´of_dump_h—d”_t
 *
´of_dump_h—d”
;

299 
	`´of_idump
(
tsdn_t
 *
tsdn
);

300 
boŞ
 
	`´of_mdump
(
tsd_t
 *
tsd
, cÚ¡ *
f’ame
);

301 
	`´of_gdump
(
tsdn_t
 *
tsdn
);

302 
´of_td©a_t
 *
	`´of_td©a_š™
(
tsd_t
 *
tsd
);

303 
´of_td©a_t
 *
	`´of_td©a_»š™
(
tsd_t
 *
tsd
,…rof_td©a_ˆ*
td©a
);

304 
	`´of_»£t
(
tsd_t
 *
tsd
, 
size_t
 
lg_§m¶e
);

305 
	`´of_td©a_ş—nup
(
tsd_t
 *
tsd
);

306 
boŞ
 
	`´of_aùive_g‘
(
tsdn_t
 *
tsdn
);

307 
boŞ
 
	`´of_aùive_£t
(
tsdn_t
 *
tsdn
, boŞ 
aùive
);

308 cÚ¡ *
	`´of_th»ad_Çme_g‘
(
tsd_t
 *
tsd
);

309 
	`´of_th»ad_Çme_£t
(
tsd_t
 *
tsd
, cÚ¡ *
th»ad_Çme
);

310 
boŞ
 
	`´of_th»ad_aùive_g‘
(
tsd_t
 *
tsd
);

311 
boŞ
 
	`´of_th»ad_aùive_£t
(
tsd_t
 *
tsd
, boŞ 
aùive
);

312 
boŞ
 
	`´of_th»ad_aùive_š™_g‘
(
tsdn_t
 *
tsdn
);

313 
boŞ
 
	`´of_th»ad_aùive_š™_£t
(
tsdn_t
 *
tsdn
, boŞ 
aùive_š™
);

314 
boŞ
 
	`´of_gdump_g‘
(
tsdn_t
 *
tsdn
);

315 
boŞ
 
	`´of_gdump_£t
(
tsdn_t
 *
tsdn
, boŞ 
aùive
);

316 
	`´of_boÙ0
();

317 
	`´of_boÙ1
();

318 
boŞ
 
	`´of_boÙ2
(
tsd_t
 *
tsd
);

319 
	`´of_´efÜk0
(
tsdn_t
 *
tsdn
);

320 
	`´of_´efÜk1
(
tsdn_t
 *
tsdn
);

321 
	`´of_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
);

322 
	`´of_po¡fÜk_chd
(
tsdn_t
 *
tsdn
);

323 
	`´of_§m¶e_th»shŞd_upd©e
(
´of_td©a_t
 *
td©a
);

327 #ifdeà
JEMALLOC_H_INLINES


329 #iâdeà
JEMALLOC_ENABLE_INLINE


330 
boŞ
 
	`´of_aùive_g‘_uÆocked
();

331 
boŞ
 
	`´of_gdump_g‘_uÆocked
();

332 
´of_td©a_t
 *
	`´of_td©a_g‘
(
tsd_t
 *
tsd
, 
boŞ
 
ü—‹
);

333 
´of_tùx_t
 *
	`´of_tùx_g‘
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
);

334 
	`´of_tùx_£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
,

335 
´of_tùx_t
 *
tùx
);

336 
	`´of_tùx_»£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
,

337 cÚ¡ *
Şd_±r
, 
´of_tùx_t
 *
tùx
);

338 
boŞ
 
	`´of_§m¶e_accum_upd©e
(
tsd_t
 *
tsd
, 
size_t
 
usize
, boŞ 
comm™
,

339 
´of_td©a_t
 **
td©a_out
);

340 
´of_tùx_t
 *
	`´of_®loc_´•
(
tsd_t
 *
tsd
, 
size_t
 
usize
, 
boŞ
 
´of_aùive
,

341 
boŞ
 
upd©e
);

342 
	`´of_m®loc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
,

343 
´of_tùx_t
 *
tùx
);

344 
	`´of_»®loc
(
tsd_t
 *
tsd
, cÚ¡ *
±r
, 
size_t
 
usize
,

345 
´of_tùx_t
 *
tùx
, 
boŞ
 
´of_aùive
, boŞ 
upd©ed
, cÚ¡ *
Şd_±r
,

346 
size_t
 
Şd_usize
, 
´of_tùx_t
 *
Şd_tùx
);

347 
	`´of_ä“
(
tsd_t
 *
tsd
, cÚ¡ *
±r
, 
size_t
 
usize
);

350 #ià(
	`defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_PROF_C_
))

351 
JEMALLOC_ALWAYS_INLINE
 
boŞ


352 
	$´of_aùive_g‘_uÆocked
()

361  (
´of_aùive
);

362 
	}
}

364 
JEMALLOC_ALWAYS_INLINE
 
boŞ


365 
	$´of_gdump_g‘_uÆocked
()

373  (
´of_gdump_v®
);

374 
	}
}

376 
JEMALLOC_ALWAYS_INLINE
 
´of_td©a_t
 *

377 
	$´of_td©a_g‘
(
tsd_t
 *
tsd
, 
boŞ
 
ü—‹
)

379 
´of_td©a_t
 *
td©a
;

381 
	`ÿs£¹
(
cÚfig_´of
);

383 
td©a
 = 
	`tsd_´of_td©a_g‘
(
tsd
);

384 ià(
ü—‹
) {

385 ià(
	`uÆik–y
(
td©a
 =ğ
NULL
)) {

386 ià(
	`tsd_nomš®
(
tsd
)) {

387 
td©a
 = 
	`´of_td©a_š™
(
tsd
);

388 
	`tsd_´of_td©a_£t
(
tsd
, 
td©a
);

390 } ià(
	`uÆik–y
(
td©a
->
expœed
)) {

391 
td©a
 = 
	`´of_td©a_»š™
(
tsd
,data);

392 
	`tsd_´of_td©a_£t
(
tsd
, 
td©a
);

394 
	`as£¹
(
td©a
 =ğ
NULL
 ||d©a->
©ched
);

397  (
td©a
);

398 
	}
}

400 
JEMALLOC_ALWAYS_INLINE
 
´of_tùx_t
 *

401 
	$´of_tùx_g‘
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
)

404 
	`ÿs£¹
(
cÚfig_´of
);

405 
	`as£¹
(
±r
 !ğ
NULL
);

407  (
	`¬’a_´of_tùx_g‘
(
tsdn
, 
±r
));

408 
	}
}

410 
JEMALLOC_ALWAYS_INLINE
 

411 
	$´of_tùx_£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
, 
´of_tùx_t
 *
tùx
)

414 
	`ÿs£¹
(
cÚfig_´of
);

415 
	`as£¹
(
±r
 !ğ
NULL
);

417 
	`¬’a_´of_tùx_£t
(
tsdn
, 
±r
, 
usize
, 
tùx
);

418 
	}
}

420 
JEMALLOC_ALWAYS_INLINE
 

421 
	$´of_tùx_»£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
, cÚ¡ *
Şd_±r
,

422 
´of_tùx_t
 *
Şd_tùx
)

425 
	`ÿs£¹
(
cÚfig_´of
);

426 
	`as£¹
(
±r
 !ğ
NULL
);

428 
	`¬’a_´of_tùx_»£t
(
tsdn
, 
±r
, 
usize
, 
Şd_±r
, 
Şd_tùx
);

429 
	}
}

431 
JEMALLOC_ALWAYS_INLINE
 
boŞ


432 
	$´of_§m¶e_accum_upd©e
(
tsd_t
 *
tsd
, 
size_t
 
usize
, 
boŞ
 
upd©e
,

433 
´of_td©a_t
 **
td©a_out
)

435 
´of_td©a_t
 *
td©a
;

437 
	`ÿs£¹
(
cÚfig_´of
);

439 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
Œue
);

440 ià(
	`uÆik–y
((
ušŒ_t
)
td©a
 <ğ(ušŒ_t)
PROF_TDATA_STATE_MAX
))

441 
td©a
 = 
NULL
;

443 ià(
td©a_out
 !ğ
NULL
)

444 *
td©a_out
 = 
td©a
;

446 ià(
	`uÆik–y
(
td©a
 =ğ
NULL
))

447  (
Œue
);

449 ià(
	`lik–y
(
td©a
->
by‹s_uÁ_§m¶e
 >ğ
usize
)) {

450 ià(
upd©e
)

451 
td©a
->
by‹s_uÁ_§m¶e
 -ğ
usize
;

452  (
Œue
);

455 ià(
upd©e
)

456 
	`´of_§m¶e_th»shŞd_upd©e
(
td©a
);

457  (!
td©a
->
aùive
);

459 
	}
}

461 
JEMALLOC_ALWAYS_INLINE
 
´of_tùx_t
 *

462 
	$´of_®loc_´•
(
tsd_t
 *
tsd
, 
size_t
 
usize
, 
boŞ
 
´of_aùive
, boŞ 
upd©e
)

464 
´of_tùx_t
 *
»t
;

465 
´of_td©a_t
 *
td©a
;

466 
´of_bt_t
 
bt
;

468 
	`as£¹
(
usize
 =ğ
	`s2u
(usize));

470 ià(!
´of_aùive
 || 
	`lik–y
(
	`´of_§m¶e_accum_upd©e
(
tsd
, 
usize
, 
upd©e
,

471 &
td©a
)))

472 
»t
 = (
´of_tùx_t
 *)(
ušŒ_t
)1U;

474 
	`bt_š™
(&
bt
, 
td©a
->
vec
);

475 
	`´of_backŒaû
(&
bt
);

476 
»t
 = 
	`´of_lookup
(
tsd
, &
bt
);

479  (
»t
);

480 
	}
}

482 
JEMALLOC_ALWAYS_INLINE
 

483 
	$´of_m®loc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
, 
´of_tùx_t
 *
tùx
)

486 
	`ÿs£¹
(
cÚfig_´of
);

487 
	`as£¹
(
±r
 !ğ
NULL
);

488 
	`as£¹
(
usize
 =ğ
	`i§Îoc
(
tsdn
, 
±r
, 
Œue
));

490 ià(
	`uÆik–y
((
ušŒ_t
)
tùx
 > (uintptr_t)1U))

491 
	`´of_m®loc_§m¶e_objeù
(
tsdn
, 
±r
, 
usize
, 
tùx
);

493 
	`´of_tùx_£t
(
tsdn
, 
±r
, 
usize
, (
´of_tùx_t
 *)(
ušŒ_t
)1U);

494 
	}
}

496 
JEMALLOC_ALWAYS_INLINE
 

497 
	$´of_»®loc
(
tsd_t
 *
tsd
, cÚ¡ *
±r
, 
size_t
 
usize
, 
´of_tùx_t
 *
tùx
,

498 
boŞ
 
´of_aùive
, boŞ 
upd©ed
, cÚ¡ *
Şd_±r
, 
size_t
 
Şd_usize
,

499 
´of_tùx_t
 *
Şd_tùx
)

501 
boŞ
 
§m¶ed
, 
Şd_§m¶ed
;

503 
	`ÿs£¹
(
cÚfig_´of
);

504 
	`as£¹
(
±r
 !ğ
NULL
 || (
ušŒ_t
)
tùx
 <= (uintptr_t)1U);

506 ià(
´of_aùive
 && !
upd©ed
 && 
±r
 !ğ
NULL
) {

507 
	`as£¹
(
usize
 =ğ
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
Œue
));

508 ià(
	`´of_§m¶e_accum_upd©e
(
tsd
, 
usize
, 
Œue
, 
NULL
)) {

516 
	`´of_®loc_rŞlback
(
tsd
, 
tùx
, 
Œue
);

517 
tùx
 = (
´of_tùx_t
 *)(
ušŒ_t
)1U;

521 
§m¶ed
 = ((
ušŒ_t
)
tùx
 > (uintptr_t)1U);

522 
Şd_§m¶ed
 = ((
ušŒ_t
)
Şd_tùx
 > (uintptr_t)1U);

524 ià(
	`uÆik–y
(
§m¶ed
))

525 
	`´of_m®loc_§m¶e_objeù
(
	`tsd_tsdn
(
tsd
), 
±r
, 
usize
, 
tùx
);

527 
	`´of_tùx_»£t
(
	`tsd_tsdn
(
tsd
), 
±r
, 
usize
, 
Şd_±r
, 
Şd_tùx
);

529 ià(
	`uÆik–y
(
Şd_§m¶ed
))

530 
	`´of_ä“_§m¶ed_objeù
(
tsd
, 
Şd_usize
, 
Şd_tùx
);

531 
	}
}

533 
JEMALLOC_ALWAYS_INLINE
 

534 
	$´of_ä“
(
tsd_t
 *
tsd
, cÚ¡ *
±r
, 
size_t
 
usize
)

536 
´of_tùx_t
 *
tùx
 = 
	`´of_tùx_g‘
(
	`tsd_tsdn
(
tsd
), 
±r
);

538 
	`ÿs£¹
(
cÚfig_´of
);

539 
	`as£¹
(
usize
 =ğ
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
Œue
));

541 ià(
	`uÆik–y
((
ušŒ_t
)
tùx
 > (uintptr_t)1U))

542 
	`´of_ä“_§m¶ed_objeù
(
tsd
, 
usize
, 
tùx
);

543 
	}
}

	@deps/jemalloc/include/jemalloc/internal/public_namespace.h

1 
	#je_m®loc_cÚf
 
	`JEMALLOC_N
(
m®loc_cÚf
)

	)

2 
	#je_m®loc_mes§ge
 
	`JEMALLOC_N
(
m®loc_mes§ge
)

	)

3 
	#je_m®loc
 
	`JEMALLOC_N
(
m®loc
)

	)

4 
	#je_ÿÎoc
 
	`JEMALLOC_N
(
ÿÎoc
)

	)

5 
	#je_posix_mem®ign
 
	`JEMALLOC_N
(
posix_mem®ign
)

	)

6 
	#je_®igÃd_®loc
 
	`JEMALLOC_N
(
®igÃd_®loc
)

	)

7 
	#je_»®loc
 
	`JEMALLOC_N
(
»®loc
)

	)

8 
	#je_ä“
 
	`JEMALLOC_N
(
ä“
)

	)

9 
	#je_m®locx
 
	`JEMALLOC_N
(
m®locx
)

	)

10 
	#je_¿Îocx
 
	`JEMALLOC_N
(
¿Îocx
)

	)

11 
	#je_x®locx
 
	`JEMALLOC_N
(
x®locx
)

	)

12 
	#je_§Îocx
 
	`JEMALLOC_N
(
§Îocx
)

	)

13 
	#je_d®locx
 
	`JEMALLOC_N
(
d®locx
)

	)

14 
	#je_sd®locx
 
	`JEMALLOC_N
(
sd®locx
)

	)

15 
	#je_ÇÎocx
 
	`JEMALLOC_N
(
ÇÎocx
)

	)

16 
	#je_m®lùl
 
	`JEMALLOC_N
(
m®lùl
)

	)

17 
	#je_m®lùÊam‘omib
 
	`JEMALLOC_N
(
m®lùÊam‘omib
)

	)

18 
	#je_m®lùlbymib
 
	`JEMALLOC_N
(
m®lùlbymib
)

	)

19 
	#je_m®loc_¡©s_´št
 
	`JEMALLOC_N
(
m®loc_¡©s_´št
)

	)

20 
	#je_m®loc_u§bË_size
 
	`JEMALLOC_N
(
m®loc_u§bË_size
)

	)

21 
	#je_mem®ign
 
	`JEMALLOC_N
(
mem®ign
)

	)

22 
	#je_v®loc
 
	`JEMALLOC_N
(
v®loc
)

	)

	@deps/jemalloc/include/jemalloc/internal/public_unnamespace.h

1 #undeà
je_m®loc_cÚf


2 #undeà
je_m®loc_mes§ge


3 #undeà
je_m®loc


4 #undeà
je_ÿÎoc


5 #undeà
je_posix_mem®ign


6 #undeà
je_®igÃd_®loc


7 #undeà
je_»®loc


8 #undeà
je_ä“


9 #undeà
je_m®locx


10 #undeà
je_¿Îocx


11 #undeà
je_x®locx


12 #undeà
je_§Îocx


13 #undeà
je_d®locx


14 #undeà
je_sd®locx


15 #undeà
je_ÇÎocx


16 #undeà
je_m®lùl


17 #undeà
je_m®lùÊam‘omib


18 #undeà
je_m®lùlbymib


19 #undeà
je_m®loc_¡©s_´št


20 #undeà
je_m®loc_u§bË_size


21 #undeà
je_mem®ign


22 #undeà
je_v®loc


	@deps/jemalloc/include/jemalloc/internal/ql.h

2 
	#ql_h—d
(
a_ty³
) \

4 
a_ty³
 *
qlh_fœ¡
; \

5 }

	)

7 
	#ql_h—d_š™Ÿliz”
(
a_h—d
è{
NULL
}

	)

9 
	#ql_–m
(
a_ty³
è
	`qr
×_ty³)

	)

12 
	#ql_Ãw
(
a_h—d
) do { \

13 (
a_h—d
)->
qlh_fœ¡
 = 
NULL
; \

14 } 0)

	)

16 
	#ql_–m_Ãw
(
a_–m
, 
a_f›ld
è
	`qr_Ãw
(×_–m),‡_f›ld)

	)

18 
	#ql_fœ¡
(
a_h—d
è(×_h—d)->
qlh_fœ¡
)

	)

20 
	#ql_Ï¡
(
a_h—d
, 
a_f›ld
) \

21 ((
	`ql_fœ¡
(
a_h—d
è!ğ
NULL
) \

22 ? 
	`qr_´ev
(
	`ql_fœ¡
(
a_h—d
), 
a_f›ld
è: 
NULL
)

	)

24 
	#ql_Ãxt
(
a_h—d
, 
a_–m
, 
a_f›ld
) \

25 ((
	`ql_Ï¡
(
a_h—d
, 
a_f›ld
è!ğ(
a_–m
)) \

26 ? 
	`qr_Ãxt
((
a_–m
), 
a_f›ld
è: 
NULL
)

	)

28 
	#ql_´ev
(
a_h—d
, 
a_–m
, 
a_f›ld
) \

29 ((
	`ql_fœ¡
(
a_h—d
è!ğ(
a_–m
)è? 
	`qr_´ev
(×_–m), 
a_f›ld
) \

30 : 
NULL
)

	)

32 
	#ql_befÜe_š£¹
(
a_h—d
, 
a_qËlm
, 
a_–m
, 
a_f›ld
) do { \

33 
	`qr_befÜe_š£¹
((
a_qËlm
), (
a_–m
), 
a_f›ld
); \

34 ià(
	`ql_fœ¡
(
a_h—d
è=ğ(
a_qËlm
)) { \

35 
	`ql_fœ¡
(
a_h—d
èğ(
a_–m
); \

37 } 0)

	)

39 
	#ql_aá”_š£¹
(
a_qËlm
, 
a_–m
, 
a_f›ld
) \

40 
	`qr_aá”_š£¹
((
a_qËlm
), (
a_–m
), 
a_f›ld
)

	)

42 
	#ql_h—d_š£¹
(
a_h—d
, 
a_–m
, 
a_f›ld
) do { \

43 ià(
	`ql_fœ¡
(
a_h—d
è!ğ
NULL
) { \

44 
	`qr_befÜe_š£¹
(
	`ql_fœ¡
(
a_h—d
), (
a_–m
), 
a_f›ld
); \

46 
	`ql_fœ¡
(
a_h—d
èğ(
a_–m
); \

47 } 0)

	)

49 
	#ql__š£¹
(
a_h—d
, 
a_–m
, 
a_f›ld
) do { \

50 ià(
	`ql_fœ¡
(
a_h—d
è!ğ
NULL
) { \

51 
	`qr_befÜe_š£¹
(
	`ql_fœ¡
(
a_h—d
), (
a_–m
), 
a_f›ld
); \

53 
	`ql_fœ¡
(
a_h—d
èğ
	`qr_Ãxt
((
a_–m
), 
a_f›ld
); \

54 } 0)

	)

56 
	#ql_»move
(
a_h—d
, 
a_–m
, 
a_f›ld
) do { \

57 ià(
	`ql_fœ¡
(
a_h—d
è=ğ(
a_–m
)) { \

58 
	`ql_fœ¡
(
a_h—d
èğ
	`qr_Ãxt
(ql_fœ¡×_h—d), 
a_f›ld
); \

60 ià(
	`ql_fœ¡
(
a_h—d
è!ğ(
a_–m
)) { \

61 
	`qr_»move
((
a_–m
), 
a_f›ld
); \

63 
	`ql_fœ¡
(
a_h—d
èğ
NULL
; \

65 } 0)

	)

67 
	#ql_h—d_»move
(
a_h—d
, 
a_ty³
, 
a_f›ld
) do { \

68 
a_ty³
 *
t
 = 
	`ql_fœ¡
(
a_h—d
); \

69 
	`ql_»move
((
a_h—d
), 
t
, 
a_f›ld
); \

70 } 0)

	)

72 
	#ql__»move
(
a_h—d
, 
a_ty³
, 
a_f›ld
) do { \

73 
a_ty³
 *
t
 = 
	`ql_Ï¡
(
a_h—d
, 
a_f›ld
); \

74 
	`ql_»move
((
a_h—d
), 
t
, 
a_f›ld
); \

75 } 0)

	)

77 
	#ql_fÜ—ch
(
a_v¬
, 
a_h—d
, 
a_f›ld
) \

78 
	`qr_fÜ—ch
((
a_v¬
), 
	`ql_fœ¡
(
a_h—d
), 
a_f›ld
)

	)

80 
	#ql_»v”£_fÜ—ch
(
a_v¬
, 
a_h—d
, 
a_f›ld
) \

81 
	`qr_»v”£_fÜ—ch
((
a_v¬
), 
	`ql_fœ¡
(
a_h—d
), 
a_f›ld
)

	)

	@deps/jemalloc/include/jemalloc/internal/qr.h

2 
	#qr
(
a_ty³
) \

4 
a_ty³
 *
q»_Ãxt
; \

5 
a_ty³
 *
q»_´ev
; \

6 }

	)

9 
	#qr_Ãw
(
a_qr
, 
a_f›ld
) do { \

10 (
a_qr
)->
a_f›ld
.
q»_Ãxt
 = (a_qr); \

11 (
a_qr
)->
a_f›ld
.
q»_´ev
 = (a_qr); \

12 } 0)

	)

14 
	#qr_Ãxt
(
a_qr
, 
a_f›ld
è(×_qr)->a_f›ld.
q»_Ãxt
)

	)

16 
	#qr_´ev
(
a_qr
, 
a_f›ld
è(×_qr)->a_f›ld.
q»_´ev
)

	)

18 
	#qr_befÜe_š£¹
(
a_q»lm
, 
a_qr
, 
a_f›ld
) do { \

19 (
a_qr
)->
a_f›ld
.
q»_´ev
 = (
a_q»lm
)->a_field.qre_prev; \

20 (
a_qr
)->
a_f›ld
.
q»_Ãxt
 = (
a_q»lm
); \

21 (
a_qr
)->
a_f›ld
.
q»_´ev
->a_f›ld.
q»_Ãxt
 = (a_qr); \

22 (
a_q»lm
)->
a_f›ld
.
q»_´ev
 = (
a_qr
); \

23 } 0)

	)

25 
	#qr_aá”_š£¹
(
a_q»lm
, 
a_qr
, 
a_f›ld
) \

28 (
a_qr
)->
a_f›ld
.
q»_Ãxt
 = (
a_q»lm
)->a_field.qre_next; \

29 (
a_qr
)->
a_f›ld
.
q»_´ev
 = (
a_q»lm
); \

30 (
a_qr
)->
a_f›ld
.
q»_Ãxt
->a_f›ld.
q»_´ev
 = (a_qr); \

31 (
a_q»lm
)->
a_f›ld
.
q»_Ãxt
 = (
a_qr
); \

32 } 0)

	)

34 
	#qr_m–d
(
a_qr_a
, 
a_qr_b
, 
a_f›ld
) do { \

35 *
t
; \

36 (
a_qr_a
)->
a_f›ld
.
q»_´ev
->a_f›ld.
q»_Ãxt
 = (
a_qr_b
); \

37 (
a_qr_b
)->
a_f›ld
.
q»_´ev
->a_f›ld.
q»_Ãxt
 = (
a_qr_a
); \

38 
t
 = (
a_qr_a
)->
a_f›ld
.
q»_´ev
; \

39 (
a_qr_a
)->
a_f›ld
.
q»_´ev
 = (
a_qr_b
)->a_field.qre_prev; \

40 (
a_qr_b
)->
a_f›ld
.
q»_´ev
 = 
t
; \

41 } 0)

	)

47 
	#qr_¥l™
(
a_qr_a
, 
a_qr_b
, 
a_f›ld
) \

48 
	`qr_m–d
((
a_qr_a
), (
a_qr_b
), 
a_f›ld
)

	)

50 
	#qr_»move
(
a_qr
, 
a_f›ld
) do { \

51 (
a_qr
)->
a_f›ld
.
q»_´ev
->a_f›ld.
q»_Ãxt
 \

52 ğ(
a_qr
)->
a_f›ld
.
q»_Ãxt
; \

53 (
a_qr
)->
a_f›ld
.
q»_Ãxt
->a_f›ld.
q»_´ev
 \

54 ğ(
a_qr
)->
a_f›ld
.
q»_´ev
; \

55 (
a_qr
)->
a_f›ld
.
q»_Ãxt
 = (a_qr); \

56 (
a_qr
)->
a_f›ld
.
q»_´ev
 = (a_qr); \

57 } 0)

	)

59 
	#qr_fÜ—ch
(
v¬
, 
a_qr
, 
a_f›ld
) \

60 (
v¬
èğ(
a_qr
); \

61 (
v¬
è!ğ
NULL
; \

62 (
v¬
èğ(((v¬)->
a_f›ld
.
q»_Ãxt
 !ğ(
a_qr
)) \

63 ? (
v¬
)->
a_f›ld
.
q»_Ãxt
 : 
NULL
))

	)

65 
	#qr_»v”£_fÜ—ch
(
v¬
, 
a_qr
, 
a_f›ld
) \

66 (
v¬
èğ((
a_qr
è!ğ
NULL
è? 
	`qr_´ev
×_qr, 
a_f›ld
) : NULL; \

67 (
v¬
è!ğ
NULL
; \

68 (
v¬
èğ(((v¬è!ğ(
a_qr
)) \

69 ? (
v¬
)->
a_f›ld
.
q»_´ev
 : 
NULL
))

	)

	@deps/jemalloc/include/jemalloc/internal/quarantine.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
qu¬ªtše_obj_s
 
	tqu¬ªtše_obj_t
;

5 
qu¬ªtše_s
 
	tqu¬ªtše_t
;

8 
	#JEMALLOC_VALGRIND_QUARANTINE_DEFAULT
 (
	`ZU
(1è<< 24)

	)

12 #ifdeà
JEMALLOC_H_STRUCTS


14 
	squ¬ªtše_obj_s
 {

15 *
	m±r
;

16 
size_t
 
	musize
;

19 
	squ¬ªtše_s
 {

20 
size_t
 
	mcurby‹s
;

21 
size_t
 
	mcurobjs
;

22 
size_t
 
	mfœ¡
;

23 
	#LG_MAXOBJS_INIT
 10

	)

24 
size_t
 
	mlg_maxobjs
;

25 
qu¬ªtše_obj_t
 
	mobjs
[1];

30 #ifdeà
JEMALLOC_H_EXTERNS


32 
qu¬ªtše_®loc_hook_wÜk
(
tsd_t
 *
tsd
);

33 
qu¬ªtše
(
tsd_t
 *
tsd
, *
±r
);

34 
qu¬ªtše_ş—nup
(
tsd_t
 *
tsd
);

38 #ifdeà
JEMALLOC_H_INLINES


40 #iâdeà
JEMALLOC_ENABLE_INLINE


41 
qu¬ªtše_®loc_hook
();

44 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_QUARANTINE_C_
))

45 
JEMALLOC_ALWAYS_INLINE
 

46 
	$qu¬ªtše_®loc_hook
()

48 
tsd_t
 *
tsd
;

50 
	`as£¹
(
cÚfig_fl
 && 
İt_qu¬ªtše
);

52 
tsd
 = 
	`tsd_ãtch
();

53 ià(
	`tsd_qu¬ªtše_g‘
(
tsd
è=ğ
NULL
)

54 
	`qu¬ªtše_®loc_hook_wÜk
(
tsd
);

55 
	}
}

	@deps/jemalloc/include/jemalloc/internal/rb.h

22 #iâdeà
RB_H_


23 
	#RB_H_


	)

25 #ifdeà
RB_COMPACT


27 
	#rb_node
(
a_ty³
) \

29 
a_ty³
 *
rbn_Ëá
; \

30 
a_ty³
 *
rbn_right_»d
; \

31 }

	)

33 
	#rb_node
(
a_ty³
) \

35 
a_ty³
 *
rbn_Ëá
; \

36 
a_ty³
 *
rbn_right
; \

37 
boŞ
 
rbn_»d
; \

38 }

	)

42 
	#rb_Œ“
(
a_ty³
) \

44 
a_ty³
 *
rbt_roÙ
; \

45 }

	)

48 
	#rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, 
a_node
) \

49 ((
a_node
)->
a_f›ld
.
rbn_Ëá
)

	)

50 
	#rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
a_node
, 
a_Ëá
) do { \

51 (
a_node
)->
a_f›ld
.
rbn_Ëá
 = 
a_Ëá
; \

52 } 0)

	)

54 #ifdeà
RB_COMPACT


56 
	#rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, 
a_node
) \

57 ((
a_ty³
 *è(((
šŒ_t
è(
a_node
)->
a_f›ld
.
rbn_right_»d
) \

58 & ((
ssize_t
)-2)))

	)

59 
	#rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
a_node
, 
a_right
) do { \

60 (
a_node
)->
a_f›ld
.
rbn_right_»d
 = (
a_ty³
 *è(((
ušŒ_t
è
a_right
) \

61 | (((
ušŒ_t
è(
a_node
)->
a_f›ld
.
rbn_right_»d
è& ((
size_t
)1))); \

62 } 0)

	)

65 
	#rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
a_node
) \

66 ((
boŞ
è(((
ušŒ_t
è(
a_node
)->
a_f›ld
.
rbn_right_»d
) \

67 & ((
size_t
)1)))

	)

68 
	#rbŠ_cŞÜ_£t
(
a_ty³
, 
a_f›ld
, 
a_node
, 
a_»d
) do { \

69 (
a_node
)->
a_f›ld
.
rbn_right_»d
 = (
a_ty³
 *è((((
šŒ_t
) \

70 (
a_node
)->
a_f›ld
.
rbn_right_»d
è& ((
ssize_t
)-2)) \

71 | ((
ssize_t
)
a_»d
)); \

72 } 0)

	)

73 
	#rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, 
a_node
) do { \

74 (
a_node
)->
a_f›ld
.
rbn_right_»d
 = (
a_ty³
 *è(((
ušŒ_t
) \

75 (
a_node
)->
a_f›ld
.
rbn_right_»d
è| ((
size_t
)1)); \

76 } 0)

	)

77 
	#rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
a_node
) do { \

78 (
a_node
)->
a_f›ld
.
rbn_right_»d
 = (
a_ty³
 *è(((
šŒ_t
) \

79 (
a_node
)->
a_f›ld
.
rbn_right_»d
è& ((
ssize_t
)-2)); \

80 } 0)

	)

83 
	#rbt_node_Ãw
(
a_ty³
, 
a_f›ld
, 
a_rbt
, 
a_node
) do { \

85 
	`as£¹
(((
ušŒ_t
)(
a_node
) & 0x1) == 0); \

86 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, (
a_node
), 
NULL
); \

87 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, (
a_node
), 
NULL
); \

88 
	`rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, (
a_node
)); \

89 } 0)

	)

92 
	#rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, 
a_node
) \

93 ((
a_node
)->
a_f›ld
.
rbn_right
)

	)

94 
	#rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
a_node
, 
a_right
) do { \

95 (
a_node
)->
a_f›ld
.
rbn_right
 = 
a_right
; \

96 } 0)

	)

99 
	#rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
a_node
) \

100 ((
a_node
)->
a_f›ld
.
rbn_»d
)

	)

101 
	#rbŠ_cŞÜ_£t
(
a_ty³
, 
a_f›ld
, 
a_node
, 
a_»d
) do { \

102 (
a_node
)->
a_f›ld
.
rbn_»d
 = (
a_»d
); \

103 } 0)

	)

104 
	#rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, 
a_node
) do { \

105 (
a_node
)->
a_f›ld
.
rbn_»d
 = 
Œue
; \

106 } 0)

	)

107 
	#rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
a_node
) do { \

108 (
a_node
)->
a_f›ld
.
rbn_»d
 = 
çl£
; \

109 } 0)

	)

112 
	#rbt_node_Ãw
(
a_ty³
, 
a_f›ld
, 
a_rbt
, 
a_node
) do { \

113 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, (
a_node
), 
NULL
); \

114 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, (
a_node
), 
NULL
); \

115 
	`rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, (
a_node
)); \

116 } 0)

	)

120 
	#rb_Ãw
(
a_ty³
, 
a_f›ld
, 
a_rbt
) do { \

121 (
a_rbt
)->
rbt_roÙ
 = 
NULL
; \

122 } 0)

	)

125 
	#rbŠ_fœ¡
(
a_ty³
, 
a_f›ld
, 
a_rbt
, 
a_roÙ
, 
r_node
) do { \

126 (
r_node
èğ(
a_roÙ
); \

127 ià((
r_node
è!ğ
NULL
) { \

129 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, (
r_node
)è!ğ
NULL
; \

130 (
r_node
èğ
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, (r_node))) { \

133 } 0)

	)

135 
	#rbŠ_Ï¡
(
a_ty³
, 
a_f›ld
, 
a_rbt
, 
a_roÙ
, 
r_node
) do { \

136 (
r_node
èğ(
a_roÙ
); \

137 ià((
r_node
è!ğ
NULL
) { \

138 ; 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, (
r_node
)è!ğ
NULL
; \

139 (
r_node
èğ
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, (r_node))) { \

142 } 0)

	)

144 
	#rbŠ_rÙ©e_Ëá
(
a_ty³
, 
a_f›ld
, 
a_node
, 
r_node
) do { \

145 (
r_node
èğ
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, (
a_node
)); \

146 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, (
a_node
), \

147 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, (
r_node
))); \

148 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, (
r_node
), (
a_node
)); \

149 } 0)

	)

151 
	#rbŠ_rÙ©e_right
(
a_ty³
, 
a_f›ld
, 
a_node
, 
r_node
) do { \

152 (
r_node
èğ
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, (
a_node
)); \

153 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, (
a_node
), \

154 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, (
r_node
))); \

155 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, (
r_node
), (
a_node
)); \

156 } 0)

	)

163 
	#rb_´Ùo
(
a_©Œ
, 
a_´efix
, 
a_rbt_ty³
, 
a_ty³
) \

164 
a_©Œ
 \

165 
a_´efix
##
	`Ãw
(
a_rbt_ty³
 *
rbŒ“
); \

166 
a_©Œ
 
boŞ
 \

167 
a_´efix
##
	`em±y
(
a_rbt_ty³
 *
rbŒ“
); \

168 
a_©Œ
 
a_ty³
 * \

169 
a_´efix
##
	`fœ¡
(
a_rbt_ty³
 *
rbŒ“
); \

170 
a_©Œ
 
a_ty³
 * \

171 
a_´efix
##
	`Ï¡
(
a_rbt_ty³
 *
rbŒ“
); \

172 
a_©Œ
 
a_ty³
 * \

173 
a_´efix
##
	`Ãxt
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
); \

174 
a_©Œ
 
a_ty³
 * \

175 
a_´efix
##
	`´ev
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
); \

176 
a_©Œ
 
a_ty³
 * \

177 
a_´efix
##
	`£¬ch
(
a_rbt_ty³
 *
rbŒ“
, cÚ¡ 
a_ty³
 *
key
); \

178 
a_©Œ
 
a_ty³
 * \

179 
a_´efix
##
	`n£¬ch
(
a_rbt_ty³
 *
rbŒ“
, cÚ¡ 
a_ty³
 *
key
); \

180 
a_©Œ
 
a_ty³
 * \

181 
a_´efix
##
	`p£¬ch
(
a_rbt_ty³
 *
rbŒ“
, cÚ¡ 
a_ty³
 *
key
); \

182 
a_©Œ
 \

183 
a_´efix
##
	`š£¹
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
); \

184 
a_©Œ
 \

185 
a_´efix
##
	`»move
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
); \

186 
a_©Œ
 
a_ty³
 * \

187 
a_´efix
##
	`™”
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
¡¬t
,‡_ty³ *(*
cb
)( \

188 
a_rbt_ty³
 *, 
a_ty³
 *, *), *
¬g
); \

189 
a_©Œ
 
a_ty³
 * \

190 
a_´efix
##
	`»v”£_™”
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
¡¬t
, \

191 
a_ty³
 *(*
cb
)(
a_rbt_ty³
 *,‡_ty³ *, *), *
¬g
); \

192 
a_©Œ
 \

193 
a_´efix
##
	`de¡roy
(
a_rbt_ty³
 *
rbŒ“
, (*
cb
)(
a_ty³
 *, *), \

194 *
¬g
);

	)

338 
	#rb_g’
(
a_©Œ
, 
a_´efix
, 
a_rbt_ty³
, 
a_ty³
, 
a_f›ld
, 
a_cmp
) \

339 
a_©Œ
 \

340 
a_´efix
##
	`Ãw
(
a_rbt_ty³
 *
rbŒ“
) { \

341 
	`rb_Ãw
(
a_ty³
, 
a_f›ld
, 
rbŒ“
); \

343 
a_©Œ
 
boŞ
 \

344 
a_´efix
##
	`em±y
(
a_rbt_ty³
 *
rbŒ“
) { \

345  (
rbŒ“
->
rbt_roÙ
 =ğ
NULL
); \

347 
a_©Œ
 
a_ty³
 * \

348 
a_´efix
##
	`fœ¡
(
a_rbt_ty³
 *
rbŒ“
) { \

349 
a_ty³
 *
»t
; \

350 
	`rbŠ_fœ¡
(
a_ty³
, 
a_f›ld
, 
rbŒ“
,„bŒ“->
rbt_roÙ
, 
»t
); \

351  (
»t
); \

353 
a_©Œ
 
a_ty³
 * \

354 
a_´efix
##
	`Ï¡
(
a_rbt_ty³
 *
rbŒ“
) { \

355 
a_ty³
 *
»t
; \

356 
	`rbŠ_Ï¡
(
a_ty³
, 
a_f›ld
, 
rbŒ“
,„bŒ“->
rbt_roÙ
, 
»t
); \

357  (
»t
); \

359 
a_©Œ
 
a_ty³
 * \

360 
a_´efix
##
	`Ãxt
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
) { \

361 
a_ty³
 *
»t
; \

362 ià(
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, 
node
è!ğ
NULL
) { \

363 
	`rbŠ_fœ¡
(
a_ty³
, 
a_f›ld
, 
rbŒ“
, 
	`rbŠ_right_g‘
(a_type, \

364 
a_f›ld
, 
node
), 
»t
); \

366 
a_ty³
 *
Šode
 = 
rbŒ“
->
rbt_roÙ
; \

367 
	`as£¹
(
Šode
 !ğ
NULL
); \

368 
»t
 = 
NULL
; \

369 
Œue
) { \

370 
cmp
 = (
a_cmp
)(
node
, 
Šode
); \

371 ià(
cmp
 < 0) { \

372 
»t
 = 
Šode
; \

373 
Šode
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
,node); \

374 } ià(
cmp
 > 0) { \

375 
Šode
 = 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
,node); \

379 
	`as£¹
(
Šode
 !ğ
NULL
); \

382  (
»t
); \

384 
a_©Œ
 
a_ty³
 * \

385 
a_´efix
##
	`´ev
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
) { \

386 
a_ty³
 *
»t
; \

387 ià(
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, 
node
è!ğ
NULL
) { \

388 
	`rbŠ_Ï¡
(
a_ty³
, 
a_f›ld
, 
rbŒ“
, 
	`rbŠ_Ëá_g‘
(a_type, \

389 
a_f›ld
, 
node
), 
»t
); \

391 
a_ty³
 *
Šode
 = 
rbŒ“
->
rbt_roÙ
; \

392 
	`as£¹
(
Šode
 !ğ
NULL
); \

393 
»t
 = 
NULL
; \

394 
Œue
) { \

395 
cmp
 = (
a_cmp
)(
node
, 
Šode
); \

396 ià(
cmp
 < 0) { \

397 
Šode
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
,node); \

398 } ià(
cmp
 > 0) { \

399 
»t
 = 
Šode
; \

400 
Šode
 = 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
,node); \

404 
	`as£¹
(
Šode
 !ğ
NULL
); \

407  (
»t
); \

409 
a_©Œ
 
a_ty³
 * \

410 
a_´efix
##
	`£¬ch
(
a_rbt_ty³
 *
rbŒ“
, cÚ¡ 
a_ty³
 *
key
) { \

411 
a_ty³
 *
»t
; \

412 
cmp
; \

413 
»t
 = 
rbŒ“
->
rbt_roÙ
; \

414 
»t
 !ğ
NULL
 \

415 && (
cmp
 = (
a_cmp
)(
key
, 
»t
)) != 0) { \

416 ià(
cmp
 < 0) { \

417 
»t
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
,„et); \

419 
»t
 = 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
,„et); \

422  (
»t
); \

424 
a_©Œ
 
a_ty³
 * \

425 
a_´efix
##
	`n£¬ch
(
a_rbt_ty³
 *
rbŒ“
, cÚ¡ 
a_ty³
 *
key
) { \

426 
a_ty³
 *
»t
; \

427 
a_ty³
 *
Šode
 = 
rbŒ“
->
rbt_roÙ
; \

428 
»t
 = 
NULL
; \

429 
Šode
 !ğ
NULL
) { \

430 
cmp
 = (
a_cmp
)(
key
, 
Šode
); \

431 ià(
cmp
 < 0) { \

432 
»t
 = 
Šode
; \

433 
Šode
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
,node); \

434 } ià(
cmp
 > 0) { \

435 
Šode
 = 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
,node); \

437 
»t
 = 
Šode
; \

441  (
»t
); \

443 
a_©Œ
 
a_ty³
 * \

444 
a_´efix
##
	`p£¬ch
(
a_rbt_ty³
 *
rbŒ“
, cÚ¡ 
a_ty³
 *
key
) { \

445 
a_ty³
 *
»t
; \

446 
a_ty³
 *
Šode
 = 
rbŒ“
->
rbt_roÙ
; \

447 
»t
 = 
NULL
; \

448 
Šode
 !ğ
NULL
) { \

449 
cmp
 = (
a_cmp
)(
key
, 
Šode
); \

450 ià(
cmp
 < 0) { \

451 
Šode
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
,node); \

452 } ià(
cmp
 > 0) { \

453 
»t
 = 
Šode
; \

454 
Šode
 = 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
,node); \

456 
»t
 = 
Šode
; \

460  (
»t
); \

462 
a_©Œ
 \

463 
a_´efix
##
	`š£¹
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
) { \

465 
a_ty³
 *
node
; \

466 
cmp
; \

467 } 
·th
[(*è<< 4], *
·thp
; \

468 
	`rbt_node_Ãw
(
a_ty³
, 
a_f›ld
, 
rbŒ“
, 
node
); \

470 
·th
->
node
 = 
rbŒ“
->
rbt_roÙ
; \

471 
·thp
 = 
·th
;…©hp->
node
 !ğ
NULL
;…athp++) { \

472 
cmp
 = 
·thp
->cm°ğ
	`a_cmp
(
node
,…athp->node); \

473 
	`as£¹
(
cmp
 != 0); \

474 ià(
cmp
 < 0) { \

475 
·thp
[1].
node
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, \

476 
·thp
->
node
); \

478 
·thp
[1].
node
 = 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, \

479 
·thp
->
node
); \

482 
·thp
->
node
 =‚ode; \

484 
·thp
--; (
ušŒ_t
í©h°>ğ(ušŒ_t)
·th
;…athp--) { \

485 
a_ty³
 *
úode
 = 
·thp
->
node
; \

486 ià(
·thp
->
cmp
 < 0) { \

487 
a_ty³
 *
Ëá
 = 
·thp
[1].
node
; \

488 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
úode
, 
Ëá
); \

489 ià(
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
Ëá
)) { \

490 
a_ty³
 *
ËáËá
 = 
	`rbŠ_Ëá_g‘
×_ty³, 
a_f›ld
, 
Ëá
);\

491 ià(
ËáËá
 !ğ
NULL
 && 
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, \

492 
ËáËá
)) { \

494 
a_ty³
 *
Šode
; \

495 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
ËáËá
); \

496 
	`rbŠ_rÙ©e_right
(
a_ty³
, 
a_f›ld
, 
úode
, 
Šode
); \

497 
úode
 = 
Šode
; \

503 
a_ty³
 *
right
 = 
·thp
[1].
node
; \

504 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
úode
, 
right
); \

505 ià(
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
right
)) { \

506 
a_ty³
 *
Ëá
 = 
	`rbŠ_Ëá_g‘
×_ty³, 
a_f›ld
, 
úode
); \

507 ià(
Ëá
 !ğ
NULL
 && 
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, \

508 
Ëá
)) { \

510 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
Ëá
); \

511 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
right
); \

512 
	`rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, 
úode
); \

515 
a_ty³
 *
Šode
; \

516 
boŞ
 
Œed
 = 
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
úode
); \

517 
	`rbŠ_rÙ©e_Ëá
(
a_ty³
, 
a_f›ld
, 
úode
, 
Šode
); \

518 
	`rbŠ_cŞÜ_£t
(
a_ty³
, 
a_f›ld
, 
Šode
, 
Œed
); \

519 
	`rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, 
úode
); \

520 
úode
 = 
Šode
; \

526 
·thp
->
node
 = 
úode
; \

529 
rbŒ“
->
rbt_roÙ
 = 
·th
->
node
; \

530 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
rbŒ“
->
rbt_roÙ
); \

532 
a_©Œ
 \

533 
a_´efix
##
	`»move
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
) { \

535 
a_ty³
 *
node
; \

536 
cmp
; \

537 } *
·thp
, *
nod•
, 
·th
[(*) << 4]; \

539 
nod•
 = 
NULL
; \

540 
·th
->
node
 = 
rbŒ“
->
rbt_roÙ
; \

541 
·thp
 = 
·th
;…©hp->
node
 !ğ
NULL
;…athp++) { \

542 
cmp
 = 
·thp
->cm°ğ
	`a_cmp
(
node
,…athp->node); \

543 ià(
cmp
 < 0) { \

544 
·thp
[1].
node
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, \

545 
·thp
->
node
); \

547 
·thp
[1].
node
 = 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, \

548 
·thp
->
node
); \

549 ià(
cmp
 == 0) { \

551 
·thp
->
cmp
 = 1; \

552 
nod•
 = 
·thp
; \

553 
·thp
++;…©hp->
node
 !ğ
NULL
; \

554 
·thp
++) { \

555 
·thp
->
cmp
 = -1; \

556 
·thp
[1].
node
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, \

557 
·thp
->
node
); \

563 
	`as£¹
(
nod•
->
node
 ==‚ode); \

564 
·thp
--; \

565 ià(
·thp
->
node
 !=‚ode) { \

567 
boŞ
 
Œed
 = 
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
); \

568 
	`rbŠ_cŞÜ_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

569 
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
node
)); \

570 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

571 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, 
node
)); \

576 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

577 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, 
node
)); \

578 
	`rbŠ_cŞÜ_£t
(
a_ty³
, 
a_f›ld
, 
node
, 
Œed
); \

581 
nod•
->
node
 = 
·thp
->node; \

582 
·thp
->
node
 =‚ode; \

583 ià(
nod•
 =ğ
·th
) { \

584 
rbŒ“
->
rbt_roÙ
 = 
nod•
->
node
; \

586 ià(
nod•
[-1].
cmp
 < 0) { \

587 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
nod•
[-1].
node
, \

588 
nod•
->
node
); \

590 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
nod•
[-1].
node
, \

591 
nod•
->
node
); \

595 
a_ty³
 *
Ëá
 = 
	`rbŠ_Ëá_g‘
×_ty³, 
a_f›ld
, 
node
); \

596 ià(
Ëá
 !ğ
NULL
) { \

599 
	`as£¹
(!
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
node
)); \

600 
	`as£¹
(
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
Ëá
)); \

601 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
Ëá
); \

602 ià(
·thp
 =ğ
·th
) { \

603 
rbŒ“
->
rbt_roÙ
 = 
Ëá
; \

605 ià(
·thp
[-1].
cmp
 < 0) { \

606 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
·thp
[-1].
node
, \

607 
Ëá
); \

609 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
·thp
[-1].
node
, \

610 
Ëá
); \

614 } ià(
·thp
 =ğ
·th
) { \

616 
rbŒ“
->
rbt_roÙ
 = 
NULL
; \

620 ià(
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
)) { \

622 
	`as£¹
(
·thp
[-1].
cmp
 < 0); \

623 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
·thp
[-1].
node
, 
NULL
); \

628 
·thp
->
node
 = 
NULL
; \

629 
·thp
--; (
ušŒ_t
í©h°>ğ(ušŒ_t)
·th
;…athp--) { \

630 
	`as£¹
(
·thp
->
cmp
 != 0); \

631 ià(
·thp
->
cmp
 < 0) { \

632 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

633 
·thp
[1].
node
); \

634 ià(
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
)) { \

635 
a_ty³
 *
right
 = 
	`rbŠ_right_g‘
×_ty³, 
a_f›ld
, \

636 
·thp
->
node
); \

637 
a_ty³
 *
righeá
 = 
	`rbŠ_Ëá_g‘
×_ty³, 
a_f›ld
, \

638 
right
); \

639 
a_ty³
 *
Šode
; \

640 ià(
righeá
 !ğ
NULL
 && 
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, \

641 
righeá
)) { \

652 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
); \

653 
	`rbŠ_rÙ©e_right
(
a_ty³
, 
a_f›ld
, 
right
, 
Šode
); \

654 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, 
Šode
);\

655 
	`rbŠ_rÙ©e_Ëá
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

656 
Šode
); \

665 
	`rbŠ_rÙ©e_Ëá
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

666 
Šode
); \

670 
	`as£¹
((
ušŒ_t
)
·thp
 > (ušŒ_t)
·th
); \

671 ià(
·thp
[-1].
cmp
 < 0) { \

672 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
·thp
[-1].
node
, \

673 
Šode
); \

675 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
·thp
[-1].
node
, \

676 
Šode
); \

680 
a_ty³
 *
right
 = 
	`rbŠ_right_g‘
×_ty³, 
a_f›ld
, \

681 
·thp
->
node
); \

682 
a_ty³
 *
righeá
 = 
	`rbŠ_Ëá_g‘
×_ty³, 
a_f›ld
, \

683 
right
); \

684 ià(
righeá
 !ğ
NULL
 && 
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, \

685 
righeá
)) { \

692 
a_ty³
 *
Šode
; \

693 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
righeá
); \

694 
	`rbŠ_rÙ©e_right
(
a_ty³
, 
a_f›ld
, 
right
, 
Šode
); \

695 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, 
Šode
);\

696 
	`rbŠ_rÙ©e_Ëá
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

697 
Šode
); \

701 ià(
·thp
 =ğ
·th
) { \

703 
rbŒ“
->
rbt_roÙ
 = 
Šode
; \

705 ià(
·thp
[-1].
cmp
 < 0) { \

706 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, \

707 
·thp
[-1].
node
, 
Šode
); \

709 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, \

710 
·thp
[-1].
node
, 
Šode
); \

721 
a_ty³
 *
Šode
; \

722 
	`rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
); \

723 
	`rbŠ_rÙ©e_Ëá
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

724 
Šode
); \

725 
·thp
->
node
 = 
Šode
; \

729 
a_ty³
 *
Ëá
; \

730 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

731 
·thp
[1].
node
); \

732 
Ëá
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
); \

733 ià(
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
Ëá
)) { \

734 
a_ty³
 *
Šode
; \

735 
a_ty³
 *
Ëáright
 = 
	`rbŠ_right_g‘
×_ty³, 
a_f›ld
, \

736 
Ëá
); \

737 
a_ty³
 *
Ëárigheá
 = 
	`rbŠ_Ëá_g‘
×_ty³, 
a_f›ld
, \

738 
Ëáright
); \

739 ià(
Ëárigheá
 !ğ
NULL
 && 
	`rbŠ_»d_g‘
(
a_ty³
, \

740 
a_f›ld
, 
Ëárigheá
)) { \

749 
a_ty³
 *
unode
; \

750 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
Ëárigheá
); \

751 
	`rbŠ_rÙ©e_right
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

752 
unode
); \

753 
	`rbŠ_rÙ©e_right
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

754 
Šode
); \

755 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
unode
, 
Šode
); \

756 
	`rbŠ_rÙ©e_Ëá
(
a_ty³
, 
a_f›ld
, 
unode
, 
Šode
); \

766 
	`as£¹
(
Ëáright
 !ğ
NULL
); \

767 
	`rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, 
Ëáright
); \

768 
	`rbŠ_rÙ©e_right
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

769 
Šode
); \

770 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
Šode
); \

774 ià(
·thp
 =ğ
·th
) { \

776 
rbŒ“
->
rbt_roÙ
 = 
Šode
; \

778 ià(
·thp
[-1].
cmp
 < 0) { \

779 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
·thp
[-1].
node
, \

780 
Šode
); \

782 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
·thp
[-1].
node
, \

783 
Šode
); \

787 } ià(
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
)) { \

788 
a_ty³
 *
ËáËá
 = 
	`rbŠ_Ëá_g‘
×_ty³, 
a_f›ld
, 
Ëá
);\

789 ià(
ËáËá
 !ğ
NULL
 && 
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, \

790 
ËáËá
)) { \

797 
a_ty³
 *
Šode
; \

798 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
); \

799 
	`rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, 
Ëá
); \

800 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
ËáËá
); \

801 
	`rbŠ_rÙ©e_right
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

802 
Šode
); \

805 
	`as£¹
((
ušŒ_t
)
·thp
 > (ušŒ_t)
·th
); \

806 ià(
·thp
[-1].
cmp
 < 0) { \

807 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, 
·thp
[-1].
node
, \

808 
Šode
); \

810 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, 
·thp
[-1].
node
, \

811 
Šode
); \

821 
	`rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, 
Ëá
); \

822 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
); \

827 
a_ty³
 *
ËáËá
 = 
	`rbŠ_Ëá_g‘
×_ty³, 
a_f›ld
, 
Ëá
);\

828 ià(
ËáËá
 !ğ
NULL
 && 
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, \

829 
ËáËá
)) { \

836 
a_ty³
 *
Šode
; \

837 
	`rbŠ_bÏck_£t
(
a_ty³
, 
a_f›ld
, 
ËáËá
); \

838 
	`rbŠ_rÙ©e_right
(
a_ty³
, 
a_f›ld
, 
·thp
->
node
, \

839 
Šode
); \

843 ià(
·thp
 =ğ
·th
) { \

845 
rbŒ“
->
rbt_roÙ
 = 
Šode
; \

847 ià(
·thp
[-1].
cmp
 < 0) { \

848 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, \

849 
·thp
[-1].
node
, 
Šode
); \

851 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, \

852 
·thp
[-1].
node
, 
Šode
); \

863 
	`rbŠ_»d_£t
(
a_ty³
, 
a_f›ld
, 
Ëá
); \

869 
rbŒ“
->
rbt_roÙ
 = 
·th
->
node
; \

870 
	`as£¹
(!
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
rbŒ“
->
rbt_roÙ
)); \

872 
a_©Œ
 
a_ty³
 * \

873 
a_´efix
##
	`™”_»cur£
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
, \

874 
a_ty³
 *(*
cb
)(
a_rbt_ty³
 *,‡_ty³ *, *), *
¬g
) { \

875 ià(
node
 =ğ
NULL
) { \

876  (
NULL
); \

878 
a_ty³
 *
»t
; \

879 ià((
»t
 = 
a_´efix
##
	`™”_»cur£
(
rbŒ“
, 
	`rbŠ_Ëá_g‘
(
a_ty³
, \

880 
a_f›ld
, 
node
), 
cb
, 
¬g
)è!ğ
NULL
 || (
»t
 = 
	`cb
(
rbŒ“
,‚ode, \

881 
¬g
)è!ğ
NULL
) { \

882  (
»t
); \

884  (
a_´efix
##
	`™”_»cur£
(
rbŒ“
, 
	`rbŠ_right_g‘
(
a_ty³
, \

885 
a_f›ld
, 
node
), 
cb
, 
¬g
)); \

888 
a_©Œ
 
a_ty³
 * \

889 
a_´efix
##
	`™”_¡¬t
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
¡¬t
,‡_ty³ *
node
, \

890 
a_ty³
 *(*
cb
)(
a_rbt_ty³
 *,‡_ty³ *, *), *
¬g
) { \

891 
cmp
 = 
	`a_cmp
(
¡¬t
, 
node
); \

892 ià(
cmp
 < 0) { \

893 
a_ty³
 *
»t
; \

894 ià((
»t
 = 
a_´efix
##
	`™”_¡¬t
(
rbŒ“
, 
¡¬t
, \

895 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, 
node
), 
cb
, 
¬g
)è!ğ
NULL
 || \

896 (
»t
 = 
	`cb
(
rbŒ“
, 
node
, 
¬g
)è!ğ
NULL
) { \

897  (
»t
); \

899  (
a_´efix
##
	`™”_»cur£
(
rbŒ“
, 
	`rbŠ_right_g‘
(
a_ty³
, \

900 
a_f›ld
, 
node
), 
cb
, 
¬g
)); \

901 } ià(
cmp
 > 0) { \

902  (
a_´efix
##
	`™”_¡¬t
(
rbŒ“
, 
¡¬t
, \

903 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, 
node
), 
cb
, 
¬g
)); \

905 
a_ty³
 *
»t
; \

906 ià((
»t
 = 
	`cb
(
rbŒ“
, 
node
, 
¬g
)è!ğ
NULL
) { \

907  (
»t
); \

909  (
a_´efix
##
	`™”_»cur£
(
rbŒ“
, 
	`rbŠ_right_g‘
(
a_ty³
, \

910 
a_f›ld
, 
node
), 
cb
, 
¬g
)); \

913 
a_©Œ
 
a_ty³
 * \

914 
a_´efix
##
	`™”
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
¡¬t
,‡_ty³ *(*
cb
)( \

915 
a_rbt_ty³
 *, 
a_ty³
 *, *), *
¬g
) { \

916 
a_ty³
 *
»t
; \

917 ià(
¡¬t
 !ğ
NULL
) { \

918 
»t
 = 
a_´efix
##
	`™”_¡¬t
(
rbŒ“
, 
¡¬t
,„bŒ“->
rbt_roÙ
, \

919 
cb
, 
¬g
); \

921 
»t
 = 
a_´efix
##
	`™”_»cur£
(
rbŒ“
,„bŒ“->
rbt_roÙ
, 
cb
, 
¬g
);\

923  (
»t
); \

925 
a_©Œ
 
a_ty³
 * \

926 
a_´efix
##
	`»v”£_™”_»cur£
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
, \

927 
a_ty³
 *(*
cb
)(
a_rbt_ty³
 *,‡_ty³ *, *), *
¬g
) { \

928 ià(
node
 =ğ
NULL
) { \

929  (
NULL
); \

931 
a_ty³
 *
»t
; \

932 ià((
»t
 = 
a_´efix
##
	`»v”£_™”_»cur£
(
rbŒ“
, \

933 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, 
node
), 
cb
, 
¬g
)è!ğ
NULL
 || \

934 (
»t
 = 
	`cb
(
rbŒ“
, 
node
, 
¬g
)è!ğ
NULL
) { \

935  (
»t
); \

937  (
a_´efix
##
	`»v”£_™”_»cur£
(
rbŒ“
, \

938 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, 
node
), 
cb
, 
¬g
)); \

941 
a_©Œ
 
a_ty³
 * \

942 
a_´efix
##
	`»v”£_™”_¡¬t
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
¡¬t
, \

943 
a_ty³
 *
node
,‡_ty³ *(*
cb
)(
a_rbt_ty³
 *,‡_type *, *), \

944 *
¬g
) { \

945 
cmp
 = 
	`a_cmp
(
¡¬t
, 
node
); \

946 ià(
cmp
 > 0) { \

947 
a_ty³
 *
»t
; \

948 ià((
»t
 = 
a_´efix
##
	`»v”£_™”_¡¬t
(
rbŒ“
, 
¡¬t
, \

949 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, 
node
), 
cb
, 
¬g
)è!ğ
NULL
 || \

950 (
»t
 = 
	`cb
(
rbŒ“
, 
node
, 
¬g
)è!ğ
NULL
) { \

951  (
»t
); \

953  (
a_´efix
##
	`»v”£_™”_»cur£
(
rbŒ“
, \

954 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, 
node
), 
cb
, 
¬g
)); \

955 } ià(
cmp
 < 0) { \

956  (
a_´efix
##
	`»v”£_™”_¡¬t
(
rbŒ“
, 
¡¬t
, \

957 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, 
node
), 
cb
, 
¬g
)); \

959 
a_ty³
 *
»t
; \

960 ià((
»t
 = 
	`cb
(
rbŒ“
, 
node
, 
¬g
)è!ğ
NULL
) { \

961  (
»t
); \

963  (
a_´efix
##
	`»v”£_™”_»cur£
(
rbŒ“
, \

964 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, 
node
), 
cb
, 
¬g
)); \

967 
a_©Œ
 
a_ty³
 * \

968 
a_´efix
##
	`»v”£_™”
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
¡¬t
, \

969 
a_ty³
 *(*
cb
)(
a_rbt_ty³
 *,‡_ty³ *, *), *
¬g
) { \

970 
a_ty³
 *
»t
; \

971 ià(
¡¬t
 !ğ
NULL
) { \

972 
»t
 = 
a_´efix
##
	`»v”£_™”_¡¬t
(
rbŒ“
, 
¡¬t
, \

973 
rbŒ“
->
rbt_roÙ
, 
cb
, 
¬g
); \

975 
»t
 = 
a_´efix
##
	`»v”£_™”_»cur£
(
rbŒ“
,„bŒ“->
rbt_roÙ
, \

976 
cb
, 
¬g
); \

978  (
»t
); \

980 
a_©Œ
 \

981 
a_´efix
##
	`de¡roy_»cur£
(
a_rbt_ty³
 *
rbŒ“
, 
a_ty³
 *
node
, (*
cb
)( \

982 
a_ty³
 *, *), *
¬g
) { \

983 ià(
node
 =ğ
NULL
) { \

986 
a_´efix
##
	`de¡roy_»cur£
(
rbŒ“
, 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
, \

987 
node
), 
cb
, 
¬g
); \

988 
	`rbŠ_Ëá_£t
(
a_ty³
, 
a_f›ld
, (
node
), 
NULL
); \

989 
a_´efix
##
	`de¡roy_»cur£
(
rbŒ“
, 
	`rbŠ_right_g‘
(
a_ty³
, 
a_f›ld
, \

990 
node
), 
cb
, 
¬g
); \

991 
	`rbŠ_right_£t
(
a_ty³
, 
a_f›ld
, (
node
), 
NULL
); \

992 ià(
cb
) { \

993 
	`cb
(
node
, 
¬g
); \

996 
a_©Œ
 \

997 
a_´efix
##
	`de¡roy
(
a_rbt_ty³
 *
rbŒ“
, (*
cb
)(
a_ty³
 *, *), \

998 *
¬g
) { \

999 
a_´efix
##
	`de¡roy_»cur£
(
rbŒ“
,„bŒ“->
rbt_roÙ
, 
cb
, 
¬g
); \

1000 
rbŒ“
->
rbt_roÙ
 = 
NULL
; \

1001 }

	)

	@deps/jemalloc/include/jemalloc/internal/rtree.h

7 #ifdeà
JEMALLOC_H_TYPES


9 
¹»e_node_–m_s
 
	t¹»e_node_–m_t
;

10 
¹»e_Ëv–_s
 
	t¹»e_Ëv–_t
;

11 
¹»e_s
 
	t¹»e_t
;

17 
	#LG_RTREE_BITS_PER_LEVEL
 4

	)

18 
	#RTREE_BITS_PER_LEVEL
 (1U << 
LG_RTREE_BITS_PER_LEVEL
)

	)

20 
	#RTREE_HEIGHT_MAX
 \

21 ((1U << (
LG_SIZEOF_PTR
+3)è/ 
RTREE_BITS_PER_LEVEL
)

	)

24 
	#RTREE_NODE_INITIALIZING
 ((
¹»e_node_–m_t
 *)0x1)

	)

31 
	g¹»e_node_–m_t
 *(
	t¹»e_node_®loc_t
)(
	tsize_t
);

32 (
	t¹»e_node_d®loc_t
)(
	t¹»e_node_–m_t
 *);

36 #ifdeà
JEMALLOC_H_STRUCTS


38 
	s¹»e_node_–m_s
 {

40 *
pun
;

41 
¹»e_node_–m_t
 *
chd
;

42 
ex‹Á_node_t
 *
v®
;

46 
	s¹»e_Ëv–_s
 {

70 *
subŒ“_pun
;

71 
¹»e_node_–m_t
 *
subŒ“
;

74 
b™s
;

79 
cumb™s
;

82 
	s¹»e_s
 {

83 
¹»e_node_®loc_t
 *
®loc
;

84 
¹»e_node_d®loc_t
 *
d®loc
;

85 
height
;

90 
¡¬t_Ëv–
[
RTREE_HEIGHT_MAX
];

91 
¹»e_Ëv–_t
 
Ëv–s
[
RTREE_HEIGHT_MAX
];

96 #ifdeà
JEMALLOC_H_EXTERNS


98 
boŞ
 
	`¹»e_Ãw
(
¹»e_t
 *
¹»e
, 
b™s
, 
¹»e_node_®loc_t
 *
®loc
,

99 
¹»e_node_d®loc_t
 *
d®loc
);

100 
	`¹»e_d–‘e
(
¹»e_t
 *
¹»e
);

101 
¹»e_node_–m_t
 *
	`¹»e_subŒ“_»ad_h¬d
(
¹»e_t
 *
¹»e
,

102 
Ëv–
);

103 
¹»e_node_–m_t
 *
	`¹»e_chd_»ad_h¬d
(
¹»e_t
 *
¹»e
,

104 
¹»e_node_–m_t
 *
–m
, 
Ëv–
);

108 #ifdeà
JEMALLOC_H_INLINES


110 #iâdeà
JEMALLOC_ENABLE_INLINE


111 
	`¹»e_¡¬t_Ëv–
(
¹»e_t
 *
¹»e
, 
ušŒ_t
 
key
);

112 
ušŒ_t
 
	`¹»e_subkey
(
¹»e_t
 *
¹»e
, ušŒ_ˆ
key
, 
Ëv–
);

114 
boŞ
 
	`¹»e_node_v®id
(
¹»e_node_–m_t
 *
node
);

115 
¹»e_node_–m_t
 *
	`¹»e_chd_Œy»ad
ÔŒ“_node_–m_ˆ*
–m
,

116 
boŞ
 
d•’d’t
);

117 
¹»e_node_–m_t
 *
	`¹»e_chd_»ad
(
¹»e_t
 *
¹»e
,„Œ“_node_–m_ˆ*
–m
,

118 
Ëv–
, 
boŞ
 
d•’d’t
);

119 
ex‹Á_node_t
 *
	`¹»e_v®_»ad
(
¹»e_t
 *
¹»e
, 
¹»e_node_–m_t
 *
–m
,

120 
boŞ
 
d•’d’t
);

121 
	`¹»e_v®_wr™e
(
¹»e_t
 *
¹»e
, 
¹»e_node_–m_t
 *
–m
,

122 cÚ¡ 
ex‹Á_node_t
 *
v®
);

123 
¹»e_node_–m_t
 *
	`¹»e_subŒ“_Œy»ad
(
¹»e_t
 *
¹»e
, 
Ëv–
,

124 
boŞ
 
d•’d’t
);

125 
¹»e_node_–m_t
 *
	`¹»e_subŒ“_»ad
(
¹»e_t
 *
¹»e
, 
Ëv–
,

126 
boŞ
 
d•’d’t
);

128 
ex‹Á_node_t
 *
	`¹»e_g‘
(
¹»e_t
 *
¹»e
, 
ušŒ_t
 
key
, 
boŞ
 
d•’d’t
);

129 
boŞ
 
	`¹»e_£t
(
¹»e_t
 *
¹»e
, 
ušŒ_t
 
key
, cÚ¡ 
ex‹Á_node_t
 *
v®
);

132 #ià(
	`defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_RTREE_C_
))

133 
JEMALLOC_ALWAYS_INLINE
 

134 
	$¹»e_¡¬t_Ëv–
(
¹»e_t
 *
¹»e
, 
ušŒ_t
 
key
)

136 
¡¬t_Ëv–
;

138 ià(
	`uÆik–y
(
key
 == 0))

139  (
¹»e
->
height
 - 1);

141 
¡¬t_Ëv–
 = 
¹»e
->¡¬t_Ëv–[
	`lg_æoÜ
(
key
) >>

142 
LG_RTREE_BITS_PER_LEVEL
];

143 
	`as£¹
(
¡¬t_Ëv–
 < 
¹»e
->
height
);

144  (
¡¬t_Ëv–
);

145 
	}
}

147 
JEMALLOC_ALWAYS_INLINE
 
ušŒ_t


148 
	$¹»e_subkey
(
¹»e_t
 *
¹»e
, 
ušŒ_t
 
key
, 
Ëv–
)

151  ((
key
 >> ((
	`ZU
(1è<< (
LG_SIZEOF_PTR
+3)) -

152 
¹»e
->
Ëv–s
[
Ëv–
].
cumb™s
)è& ((
	`ZU
(1) <<

153 
¹»e
->
Ëv–s
[
Ëv–
].
b™s
) - 1));

154 
	}
}

156 
JEMALLOC_ALWAYS_INLINE
 
boŞ


157 
	$¹»e_node_v®id
(
¹»e_node_–m_t
 *
node
)

160  ((
ušŒ_t
)
node
 > (ušŒ_t)
RTREE_NODE_INITIALIZING
);

161 
	}
}

163 
JEMALLOC_ALWAYS_INLINE
 
¹»e_node_–m_t
 *

164 
	$¹»e_chd_Œy»ad
(
¹»e_node_–m_t
 *
–m
, 
boŞ
 
d•’d’t
)

166 
¹»e_node_–m_t
 *
chd
;

169 
chd
 = 
–m
->child;

170 ià(!
d•’d’t
 && !
	`¹»e_node_v®id
(
chd
))

171 
chd
 = 
	`©omic_»ad_p
(&
–m
->
pun
);

172 
	`as£¹
(!
d•’d’t
 || 
chd
 !ğ
NULL
);

173  (
chd
);

174 
	}
}

176 
JEMALLOC_ALWAYS_INLINE
 
¹»e_node_–m_t
 *

177 
	$¹»e_chd_»ad
(
¹»e_t
 *
¹»e
, 
¹»e_node_–m_t
 *
–m
, 
Ëv–
,

178 
boŞ
 
d•’d’t
)

180 
¹»e_node_–m_t
 *
chd
;

182 
chd
 = 
	`¹»e_chd_Œy»ad
(
–m
, 
d•’d’t
);

183 ià(!
d•’d’t
 && 
	`uÆik–y
(!
	`¹»e_node_v®id
(
chd
)))

184 
chd
 = 
	`¹»e_chd_»ad_h¬d
(
¹»e
, 
–m
, 
Ëv–
);

185 
	`as£¹
(!
d•’d’t
 || 
chd
 !ğ
NULL
);

186  (
chd
);

187 
	}
}

189 
JEMALLOC_ALWAYS_INLINE
 
ex‹Á_node_t
 *

190 
	$¹»e_v®_»ad
(
¹»e_t
 *
¹»e
, 
¹»e_node_–m_t
 *
–m
, 
boŞ
 
d•’d’t
)

193 ià(
d•’d’t
) {

200  (
–m
->
v®
);

207  (
	`©omic_»ad_p
(&
–m
->
pun
));

209 
	}
}

211 
JEMALLOC_INLINE
 

212 
	$¹»e_v®_wr™e
(
¹»e_t
 *
¹»e
, 
¹»e_node_–m_t
 *
–m
, cÚ¡ 
ex‹Á_node_t
 *
v®
)

215 
	`©omic_wr™e_p
(&
–m
->
pun
, 
v®
);

216 
	}
}

218 
JEMALLOC_ALWAYS_INLINE
 
¹»e_node_–m_t
 *

219 
	$¹»e_subŒ“_Œy»ad
(
¹»e_t
 *
¹»e
, 
Ëv–
, 
boŞ
 
d•’d’t
)

221 
¹»e_node_–m_t
 *
subŒ“
;

224 
subŒ“
 = 
¹»e
->
Ëv–s
[
Ëv–
].subtree;

225 ià(!
d•’d’t
 && 
	`uÆik–y
(!
	`¹»e_node_v®id
(
subŒ“
)))

226 
subŒ“
 = 
	`©omic_»ad_p
(&
¹»e
->
Ëv–s
[
Ëv–
].
subŒ“_pun
);

227 
	`as£¹
(!
d•’d’t
 || 
subŒ“
 !ğ
NULL
);

228  (
subŒ“
);

229 
	}
}

231 
JEMALLOC_ALWAYS_INLINE
 
¹»e_node_–m_t
 *

232 
	$¹»e_subŒ“_»ad
(
¹»e_t
 *
¹»e
, 
Ëv–
, 
boŞ
 
d•’d’t
)

234 
¹»e_node_–m_t
 *
subŒ“
;

236 
subŒ“
 = 
	`¹»e_subŒ“_Œy»ad
(
¹»e
, 
Ëv–
, 
d•’d’t
);

237 ià(!
d•’d’t
 && 
	`uÆik–y
(!
	`¹»e_node_v®id
(
subŒ“
)))

238 
subŒ“
 = 
	`¹»e_subŒ“_»ad_h¬d
(
¹»e
, 
Ëv–
);

239 
	`as£¹
(!
d•’d’t
 || 
subŒ“
 !ğ
NULL
);

240  (
subŒ“
);

241 
	}
}

243 
JEMALLOC_ALWAYS_INLINE
 
ex‹Á_node_t
 *

244 
	$¹»e_g‘
(
¹»e_t
 *
¹»e
, 
ušŒ_t
 
key
, 
boŞ
 
d•’d’t
)

246 
ušŒ_t
 
subkey
;

247 
¡¬t_Ëv–
;

248 
¹»e_node_–m_t
 *
node
;

250 
¡¬t_Ëv–
 = 
	`¹»e_¡¬t_Ëv–
(
¹»e
, 
key
);

252 
node
 = 
	`¹»e_subŒ“_Œy»ad
(
¹»e
, 
¡¬t_Ëv–
, 
d•’d’t
);

253 
	#RTREE_GET_BIAS
 (
RTREE_HEIGHT_MAX
 - 
¹»e
->
height
)

	)

254 
¡¬t_Ëv–
 + 
RTREE_GET_BIAS
) {

255 
	#RTREE_GET_SUBTREE
(
Ëv–
) \

256 
Ëv–
: \

257 
	`as£¹
(
Ëv–
 < (
RTREE_HEIGHT_MAX
-1)); \

258 ià(!
d•’d’t
 && 
	`uÆik–y
(!
	`¹»e_node_v®id
(
node
))) \

259  (
NULL
); \

260 
subkey
 = 
	`¹»e_subkey
(
¹»e
, 
key
, 
Ëv–
 - \

261 
RTREE_GET_BIAS
); \

262 
node
 = 
	`¹»e_chd_Œy»ad
(&node[
subkey
], 
d•’d’t
); \

263 

	)

264 
	#RTREE_GET_LEAF
(
Ëv–
) \

265 
Ëv–
: \

266 
	`as£¹
(
Ëv–
 =ğ(
RTREE_HEIGHT_MAX
-1)); \

267 ià(!
d•’d’t
 && 
	`uÆik–y
(!
	`¹»e_node_v®id
(
node
))) \

268  (
NULL
); \

269 
subkey
 = 
	`¹»e_subkey
(
¹»e
, 
key
, 
Ëv–
 - \

270 
RTREE_GET_BIAS
); \

275  (
	`¹»e_v®_»ad
(
¹»e
, &
node
[
subkey
], \

276 
d•’d’t
));

	)

277 #ià
RTREE_HEIGHT_MAX
 > 1

278 
	`RTREE_GET_SUBTREE
(0)

280 #ià
RTREE_HEIGHT_MAX
 > 2

281 
	`RTREE_GET_SUBTREE
(1)

283 #ià
RTREE_HEIGHT_MAX
 > 3

284 
	`RTREE_GET_SUBTREE
(2)

286 #ià
RTREE_HEIGHT_MAX
 > 4

287 
	`RTREE_GET_SUBTREE
(3)

289 #ià
RTREE_HEIGHT_MAX
 > 5

290 
	`RTREE_GET_SUBTREE
(4)

292 #ià
RTREE_HEIGHT_MAX
 > 6

293 
	`RTREE_GET_SUBTREE
(5)

295 #ià
RTREE_HEIGHT_MAX
 > 7

296 
	`RTREE_GET_SUBTREE
(6)

298 #ià
RTREE_HEIGHT_MAX
 > 8

299 
	`RTREE_GET_SUBTREE
(7)

301 #ià
RTREE_HEIGHT_MAX
 > 9

302 
	`RTREE_GET_SUBTREE
(8)

304 #ià
RTREE_HEIGHT_MAX
 > 10

305 
	`RTREE_GET_SUBTREE
(9)

307 #ià
RTREE_HEIGHT_MAX
 > 11

308 
	`RTREE_GET_SUBTREE
(10)

310 #ià
RTREE_HEIGHT_MAX
 > 12

311 
	`RTREE_GET_SUBTREE
(11)

313 #ià
RTREE_HEIGHT_MAX
 > 13

314 
	`RTREE_GET_SUBTREE
(12)

316 #ià
RTREE_HEIGHT_MAX
 > 14

317 
	`RTREE_GET_SUBTREE
(13)

319 #ià
RTREE_HEIGHT_MAX
 > 15

320 
	`RTREE_GET_SUBTREE
(14)

322 #ià
RTREE_HEIGHT_MAX
 > 16

323 #”rÜ 
UnsuµÜ‹d
 
RTREE_HEIGHT_MAX


325 
	`RTREE_GET_LEAF
(
RTREE_HEIGHT_MAX
-1)

326 #undeà
RTREE_GET_SUBTREE


327 #undeà
RTREE_GET_LEAF


328 : 
	`nÙ_»ached
();

330 #undeà
RTREE_GET_BIAS


331 
	`nÙ_»ached
();

332 
	}
}

334 
JEMALLOC_INLINE
 
boŞ


335 
	$¹»e_£t
(
¹»e_t
 *
¹»e
, 
ušŒ_t
 
key
, cÚ¡ 
ex‹Á_node_t
 *
v®
)

337 
ušŒ_t
 
subkey
;

338 
i
, 
¡¬t_Ëv–
;

339 
¹»e_node_–m_t
 *
node
, *
chd
;

341 
¡¬t_Ëv–
 = 
	`¹»e_¡¬t_Ëv–
(
¹»e
, 
key
);

343 
node
 = 
	`¹»e_subŒ“_»ad
(
¹»e
, 
¡¬t_Ëv–
, 
çl£
);

344 ià(
node
 =ğ
NULL
)

345  (
Œue
);

346 
i
 = 
¡¬t_Ëv–
; ; i++, 
node
 = 
chd
) {

347 
subkey
 = 
	`¹»e_subkey
(
¹»e
, 
key
, 
i
);

348 ià(
i
 =ğ
¹»e
->
height
 - 1) {

353 
	`¹»e_v®_wr™e
(
¹»e
, &
node
[
subkey
], 
v®
);

354  (
çl£
);

356 
	`as£¹
(
i
 + 1 < 
¹»e
->
height
);

357 
chd
 = 
	`¹»e_chd_»ad
(
¹»e
, &
node
[
subkey
], 
i
, 
çl£
);

358 ià(
chd
 =ğ
NULL
)

359  (
Œue
);

361 
	`nÙ_»ached
();

362 
	}
}

	@deps/jemalloc/include/jemalloc/internal/size_classes.h

3 #ifdeà
JEMALLOC_H_TYPES


32 
	#LG_SIZE_CLASS_GROUP
 2

	)

34 #ià(
LG_SIZEOF_PTR
 =ğ2 && 
LG_TINY_MIN
 =ğ3 && 
LG_QUANTUM
 =ğ3 && 
LG_PAGE
 == 12)

35 
	#SIZE_CLASSES
 \

37 
	`SC
Ğ0, 3, 3, 0, 
no
, 
yes
, 3) \

38 
	`SC
Ğ1, 3, 3, 1, 
no
, 
yes
, 3) \

39 
	`SC
Ğ2, 3, 3, 2, 
no
, 
yes
, 3) \

40 
	`SC
Ğ3, 3, 3, 3, 
no
, 
yes
, 3) \

42 
	`SC
Ğ4, 5, 3, 1, 
no
, 
yes
, 3) \

43 
	`SC
Ğ5, 5, 3, 2, 
no
, 
yes
, 3) \

44 
	`SC
Ğ6, 5, 3, 3, 
no
, 
yes
, 3) \

45 
	`SC
Ğ7, 5, 3, 4, 
no
, 
yes
, 3) \

47 
	`SC
Ğ8, 6, 4, 1, 
no
, 
yes
, 4) \

48 
	`SC
Ğ9, 6, 4, 2, 
no
, 
yes
, 4) \

49 
	`SC
Ğ10, 6, 4, 3, 
no
, 
yes
, 4) \

50 
	`SC
Ğ11, 6, 4, 4, 
no
, 
yes
, 4) \

52 
	`SC
Ğ12, 7, 5, 1, 
no
, 
yes
, 5) \

53 
	`SC
Ğ13, 7, 5, 2, 
no
, 
yes
, 5) \

54 
	`SC
Ğ14, 7, 5, 3, 
no
, 
yes
, 5) \

55 
	`SC
Ğ15, 7, 5, 4, 
no
, 
yes
, 5) \

57 
	`SC
Ğ16, 8, 6, 1, 
no
, 
yes
, 6) \

58 
	`SC
Ğ17, 8, 6, 2, 
no
, 
yes
, 6) \

59 
	`SC
Ğ18, 8, 6, 3, 
no
, 
yes
, 6) \

60 
	`SC
Ğ19, 8, 6, 4, 
no
, 
yes
, 6) \

62 
	`SC
Ğ20, 9, 7, 1, 
no
, 
yes
, 7) \

63 
	`SC
Ğ21, 9, 7, 2, 
no
, 
yes
, 7) \

64 
	`SC
Ğ22, 9, 7, 3, 
no
, 
yes
, 7) \

65 
	`SC
Ğ23, 9, 7, 4, 
no
, 
yes
, 7) \

67 
	`SC
Ğ24, 10, 8, 1, 
no
, 
yes
, 8) \

68 
	`SC
Ğ25, 10, 8, 2, 
no
, 
yes
, 8) \

69 
	`SC
Ğ26, 10, 8, 3, 
no
, 
yes
, 8) \

70 
	`SC
Ğ27, 10, 8, 4, 
no
, 
yes
, 8) \

72 
	`SC
Ğ28, 11, 9, 1, 
no
, 
yes
, 9) \

73 
	`SC
Ğ29, 11, 9, 2, 
no
, 
yes
, 9) \

74 
	`SC
Ğ30, 11, 9, 3, 
no
, 
yes
, 9) \

75 
	`SC
Ğ31, 11, 9, 4, 
yes
, yes, 9) \

77 
	`SC
Ğ32, 12, 10, 1, 
no
, 
yes
,‚o) \

78 
	`SC
Ğ33, 12, 10, 2, 
no
, 
yes
,‚o) \

79 
	`SC
Ğ34, 12, 10, 3, 
no
, 
yes
,‚o) \

80 
	`SC
Ğ35, 12, 10, 4, 
yes
, yes, 
no
) \

82 
	`SC
Ğ36, 13, 11, 1, 
no
, 
yes
,‚o) \

83 
	`SC
Ğ37, 13, 11, 2, 
yes
, yes, 
no
) \

84 
	`SC
Ğ38, 13, 11, 3, 
no
, 
yes
,‚o) \

85 
	`SC
Ğ39, 13, 11, 4, 
yes
, 
no
,‚o) \

87 
	`SC
Ğ40, 14, 12, 1, 
yes
, 
no
,‚o) \

88 
	`SC
Ğ41, 14, 12, 2, 
yes
, 
no
,‚o) \

89 
	`SC
Ğ42, 14, 12, 3, 
yes
, 
no
,‚o) \

90 
	`SC
Ğ43, 14, 12, 4, 
yes
, 
no
,‚o) \

92 
	`SC
Ğ44, 15, 13, 1, 
yes
, 
no
,‚o) \

93 
	`SC
Ğ45, 15, 13, 2, 
yes
, 
no
,‚o) \

94 
	`SC
Ğ46, 15, 13, 3, 
yes
, 
no
,‚o) \

95 
	`SC
Ğ47, 15, 13, 4, 
yes
, 
no
,‚o) \

97 
	`SC
Ğ48, 16, 14, 1, 
yes
, 
no
,‚o) \

98 
	`SC
Ğ49, 16, 14, 2, 
yes
, 
no
,‚o) \

99 
	`SC
Ğ50, 16, 14, 3, 
yes
, 
no
,‚o) \

100 
	`SC
Ğ51, 16, 14, 4, 
yes
, 
no
,‚o) \

102 
	`SC
Ğ52, 17, 15, 1, 
yes
, 
no
,‚o) \

103 
	`SC
Ğ53, 17, 15, 2, 
yes
, 
no
,‚o) \

104 
	`SC
Ğ54, 17, 15, 3, 
yes
, 
no
,‚o) \

105 
	`SC
Ğ55, 17, 15, 4, 
yes
, 
no
,‚o) \

107 
	`SC
Ğ56, 18, 16, 1, 
yes
, 
no
,‚o) \

108 
	`SC
Ğ57, 18, 16, 2, 
yes
, 
no
,‚o) \

109 
	`SC
Ğ58, 18, 16, 3, 
yes
, 
no
,‚o) \

110 
	`SC
Ğ59, 18, 16, 4, 
yes
, 
no
,‚o) \

112 
	`SC
Ğ60, 19, 17, 1, 
yes
, 
no
,‚o) \

113 
	`SC
Ğ61, 19, 17, 2, 
yes
, 
no
,‚o) \

114 
	`SC
Ğ62, 19, 17, 3, 
yes
, 
no
,‚o) \

115 
	`SC
Ğ63, 19, 17, 4, 
yes
, 
no
,‚o) \

117 
	`SC
Ğ64, 20, 18, 1, 
yes
, 
no
,‚o) \

118 
	`SC
Ğ65, 20, 18, 2, 
yes
, 
no
,‚o) \

119 
	`SC
Ğ66, 20, 18, 3, 
yes
, 
no
,‚o) \

120 
	`SC
Ğ67, 20, 18, 4, 
yes
, 
no
,‚o) \

122 
	`SC
Ğ68, 21, 19, 1, 
yes
, 
no
,‚o) \

123 
	`SC
Ğ69, 21, 19, 2, 
yes
, 
no
,‚o) \

124 
	`SC
Ğ70, 21, 19, 3, 
yes
, 
no
,‚o) \

125 
	`SC
Ğ71, 21, 19, 4, 
yes
, 
no
,‚o) \

127 
	`SC
Ğ72, 22, 20, 1, 
yes
, 
no
,‚o) \

128 
	`SC
Ğ73, 22, 20, 2, 
yes
, 
no
,‚o) \

129 
	`SC
Ğ74, 22, 20, 3, 
yes
, 
no
,‚o) \

130 
	`SC
Ğ75, 22, 20, 4, 
yes
, 
no
,‚o) \

132 
	`SC
Ğ76, 23, 21, 1, 
yes
, 
no
,‚o) \

133 
	`SC
Ğ77, 23, 21, 2, 
yes
, 
no
,‚o) \

134 
	`SC
Ğ78, 23, 21, 3, 
yes
, 
no
,‚o) \

135 
	`SC
Ğ79, 23, 21, 4, 
yes
, 
no
,‚o) \

137 
	`SC
Ğ80, 24, 22, 1, 
yes
, 
no
,‚o) \

138 
	`SC
Ğ81, 24, 22, 2, 
yes
, 
no
,‚o) \

139 
	`SC
Ğ82, 24, 22, 3, 
yes
, 
no
,‚o) \

140 
	`SC
Ğ83, 24, 22, 4, 
yes
, 
no
,‚o) \

142 
	`SC
Ğ84, 25, 23, 1, 
yes
, 
no
,‚o) \

143 
	`SC
Ğ85, 25, 23, 2, 
yes
, 
no
,‚o) \

144 
	`SC
Ğ86, 25, 23, 3, 
yes
, 
no
,‚o) \

145 
	`SC
Ğ87, 25, 23, 4, 
yes
, 
no
,‚o) \

147 
	`SC
Ğ88, 26, 24, 1, 
yes
, 
no
,‚o) \

148 
	`SC
Ğ89, 26, 24, 2, 
yes
, 
no
,‚o) \

149 
	`SC
Ğ90, 26, 24, 3, 
yes
, 
no
,‚o) \

150 
	`SC
Ğ91, 26, 24, 4, 
yes
, 
no
,‚o) \

152 
	`SC
Ğ92, 27, 25, 1, 
yes
, 
no
,‚o) \

153 
	`SC
Ğ93, 27, 25, 2, 
yes
, 
no
,‚o) \

154 
	`SC
Ğ94, 27, 25, 3, 
yes
, 
no
,‚o) \

155 
	`SC
Ğ95, 27, 25, 4, 
yes
, 
no
,‚o) \

157 
	`SC
Ğ96, 28, 26, 1, 
yes
, 
no
,‚o) \

158 
	`SC
Ğ97, 28, 26, 2, 
yes
, 
no
,‚o) \

159 
	`SC
Ğ98, 28, 26, 3, 
yes
, 
no
,‚o) \

160 
	`SC
Ğ99, 28, 26, 4, 
yes
, 
no
,‚o) \

162 
	`SC
(100, 29, 27, 1, 
yes
, 
no
,‚o) \

163 
	`SC
(101, 29, 27, 2, 
yes
, 
no
,‚o) \

164 
	`SC
(102, 29, 27, 3, 
yes
, 
no
,‚o) \

165 
	`SC
(103, 29, 27, 4, 
yes
, 
no
,‚o) \

167 
	`SC
(104, 30, 28, 1, 
yes
, 
no
,‚o) \

168 
	`SC
(105, 30, 28, 2, 
yes
, 
no
,‚o) \

169 
	`SC
(106, 30, 28, 3, 
yes
, 
no
,‚o) \

170 

	)

171 
	#SIZE_CLASSES_DEFINED


	)

172 
	#NTBINS
 0

	)

173 
	#NLBINS
 32

	)

174 
	#NBINS
 39

	)

175 
	#NSIZES
 107

	)

176 
	#NPSIZES
 71

	)

177 
	#LG_TINY_MAXCLASS
 "NA"

	)

178 
	#LOOKUP_MAXCLASS
 ((((
size_t
)1è<< 11è+ (((size_t)4è<< 9))

	)

179 
	#SMALL_MAXCLASS
 ((((
size_t
)1è<< 13è+ (((size_t)3è<< 11))

	)

180 
	#LG_LARGE_MINCLASS
 14

	)

181 
	#HUGE_MAXCLASS
 ((((
size_t
)1è<< 30è+ (((size_t)3è<< 28))

	)

184 #ià(
LG_SIZEOF_PTR
 =ğ3 && 
LG_TINY_MIN
 =ğ3 && 
LG_QUANTUM
 =ğ3 && 
LG_PAGE
 == 12)

185 
	#SIZE_CLASSES
 \

187 
	`SC
Ğ0, 3, 3, 0, 
no
, 
yes
, 3) \

188 
	`SC
Ğ1, 3, 3, 1, 
no
, 
yes
, 3) \

189 
	`SC
Ğ2, 3, 3, 2, 
no
, 
yes
, 3) \

190 
	`SC
Ğ3, 3, 3, 3, 
no
, 
yes
, 3) \

192 
	`SC
Ğ4, 5, 3, 1, 
no
, 
yes
, 3) \

193 
	`SC
Ğ5, 5, 3, 2, 
no
, 
yes
, 3) \

194 
	`SC
Ğ6, 5, 3, 3, 
no
, 
yes
, 3) \

195 
	`SC
Ğ7, 5, 3, 4, 
no
, 
yes
, 3) \

197 
	`SC
Ğ8, 6, 4, 1, 
no
, 
yes
, 4) \

198 
	`SC
Ğ9, 6, 4, 2, 
no
, 
yes
, 4) \

199 
	`SC
Ğ10, 6, 4, 3, 
no
, 
yes
, 4) \

200 
	`SC
Ğ11, 6, 4, 4, 
no
, 
yes
, 4) \

202 
	`SC
Ğ12, 7, 5, 1, 
no
, 
yes
, 5) \

203 
	`SC
Ğ13, 7, 5, 2, 
no
, 
yes
, 5) \

204 
	`SC
Ğ14, 7, 5, 3, 
no
, 
yes
, 5) \

205 
	`SC
Ğ15, 7, 5, 4, 
no
, 
yes
, 5) \

207 
	`SC
Ğ16, 8, 6, 1, 
no
, 
yes
, 6) \

208 
	`SC
Ğ17, 8, 6, 2, 
no
, 
yes
, 6) \

209 
	`SC
Ğ18, 8, 6, 3, 
no
, 
yes
, 6) \

210 
	`SC
Ğ19, 8, 6, 4, 
no
, 
yes
, 6) \

212 
	`SC
Ğ20, 9, 7, 1, 
no
, 
yes
, 7) \

213 
	`SC
Ğ21, 9, 7, 2, 
no
, 
yes
, 7) \

214 
	`SC
Ğ22, 9, 7, 3, 
no
, 
yes
, 7) \

215 
	`SC
Ğ23, 9, 7, 4, 
no
, 
yes
, 7) \

217 
	`SC
Ğ24, 10, 8, 1, 
no
, 
yes
, 8) \

218 
	`SC
Ğ25, 10, 8, 2, 
no
, 
yes
, 8) \

219 
	`SC
Ğ26, 10, 8, 3, 
no
, 
yes
, 8) \

220 
	`SC
Ğ27, 10, 8, 4, 
no
, 
yes
, 8) \

222 
	`SC
Ğ28, 11, 9, 1, 
no
, 
yes
, 9) \

223 
	`SC
Ğ29, 11, 9, 2, 
no
, 
yes
, 9) \

224 
	`SC
Ğ30, 11, 9, 3, 
no
, 
yes
, 9) \

225 
	`SC
Ğ31, 11, 9, 4, 
yes
, yes, 9) \

227 
	`SC
Ğ32, 12, 10, 1, 
no
, 
yes
,‚o) \

228 
	`SC
Ğ33, 12, 10, 2, 
no
, 
yes
,‚o) \

229 
	`SC
Ğ34, 12, 10, 3, 
no
, 
yes
,‚o) \

230 
	`SC
Ğ35, 12, 10, 4, 
yes
, yes, 
no
) \

232 
	`SC
Ğ36, 13, 11, 1, 
no
, 
yes
,‚o) \

233 
	`SC
Ğ37, 13, 11, 2, 
yes
, yes, 
no
) \

234 
	`SC
Ğ38, 13, 11, 3, 
no
, 
yes
,‚o) \

235 
	`SC
Ğ39, 13, 11, 4, 
yes
, 
no
,‚o) \

237 
	`SC
Ğ40, 14, 12, 1, 
yes
, 
no
,‚o) \

238 
	`SC
Ğ41, 14, 12, 2, 
yes
, 
no
,‚o) \

239 
	`SC
Ğ42, 14, 12, 3, 
yes
, 
no
,‚o) \

240 
	`SC
Ğ43, 14, 12, 4, 
yes
, 
no
,‚o) \

242 
	`SC
Ğ44, 15, 13, 1, 
yes
, 
no
,‚o) \

243 
	`SC
Ğ45, 15, 13, 2, 
yes
, 
no
,‚o) \

244 
	`SC
Ğ46, 15, 13, 3, 
yes
, 
no
,‚o) \

245 
	`SC
Ğ47, 15, 13, 4, 
yes
, 
no
,‚o) \

247 
	`SC
Ğ48, 16, 14, 1, 
yes
, 
no
,‚o) \

248 
	`SC
Ğ49, 16, 14, 2, 
yes
, 
no
,‚o) \

249 
	`SC
Ğ50, 16, 14, 3, 
yes
, 
no
,‚o) \

250 
	`SC
Ğ51, 16, 14, 4, 
yes
, 
no
,‚o) \

252 
	`SC
Ğ52, 17, 15, 1, 
yes
, 
no
,‚o) \

253 
	`SC
Ğ53, 17, 15, 2, 
yes
, 
no
,‚o) \

254 
	`SC
Ğ54, 17, 15, 3, 
yes
, 
no
,‚o) \

255 
	`SC
Ğ55, 17, 15, 4, 
yes
, 
no
,‚o) \

257 
	`SC
Ğ56, 18, 16, 1, 
yes
, 
no
,‚o) \

258 
	`SC
Ğ57, 18, 16, 2, 
yes
, 
no
,‚o) \

259 
	`SC
Ğ58, 18, 16, 3, 
yes
, 
no
,‚o) \

260 
	`SC
Ğ59, 18, 16, 4, 
yes
, 
no
,‚o) \

262 
	`SC
Ğ60, 19, 17, 1, 
yes
, 
no
,‚o) \

263 
	`SC
Ğ61, 19, 17, 2, 
yes
, 
no
,‚o) \

264 
	`SC
Ğ62, 19, 17, 3, 
yes
, 
no
,‚o) \

265 
	`SC
Ğ63, 19, 17, 4, 
yes
, 
no
,‚o) \

267 
	`SC
Ğ64, 20, 18, 1, 
yes
, 
no
,‚o) \

268 
	`SC
Ğ65, 20, 18, 2, 
yes
, 
no
,‚o) \

269 
	`SC
Ğ66, 20, 18, 3, 
yes
, 
no
,‚o) \

270 
	`SC
Ğ67, 20, 18, 4, 
yes
, 
no
,‚o) \

272 
	`SC
Ğ68, 21, 19, 1, 
yes
, 
no
,‚o) \

273 
	`SC
Ğ69, 21, 19, 2, 
yes
, 
no
,‚o) \

274 
	`SC
Ğ70, 21, 19, 3, 
yes
, 
no
,‚o) \

275 
	`SC
Ğ71, 21, 19, 4, 
yes
, 
no
,‚o) \

277 
	`SC
Ğ72, 22, 20, 1, 
yes
, 
no
,‚o) \

278 
	`SC
Ğ73, 22, 20, 2, 
yes
, 
no
,‚o) \

279 
	`SC
Ğ74, 22, 20, 3, 
yes
, 
no
,‚o) \

280 
	`SC
Ğ75, 22, 20, 4, 
yes
, 
no
,‚o) \

282 
	`SC
Ğ76, 23, 21, 1, 
yes
, 
no
,‚o) \

283 
	`SC
Ğ77, 23, 21, 2, 
yes
, 
no
,‚o) \

284 
	`SC
Ğ78, 23, 21, 3, 
yes
, 
no
,‚o) \

285 
	`SC
Ğ79, 23, 21, 4, 
yes
, 
no
,‚o) \

287 
	`SC
Ğ80, 24, 22, 1, 
yes
, 
no
,‚o) \

288 
	`SC
Ğ81, 24, 22, 2, 
yes
, 
no
,‚o) \

289 
	`SC
Ğ82, 24, 22, 3, 
yes
, 
no
,‚o) \

290 
	`SC
Ğ83, 24, 22, 4, 
yes
, 
no
,‚o) \

292 
	`SC
Ğ84, 25, 23, 1, 
yes
, 
no
,‚o) \

293 
	`SC
Ğ85, 25, 23, 2, 
yes
, 
no
,‚o) \

294 
	`SC
Ğ86, 25, 23, 3, 
yes
, 
no
,‚o) \

295 
	`SC
Ğ87, 25, 23, 4, 
yes
, 
no
,‚o) \

297 
	`SC
Ğ88, 26, 24, 1, 
yes
, 
no
,‚o) \

298 
	`SC
Ğ89, 26, 24, 2, 
yes
, 
no
,‚o) \

299 
	`SC
Ğ90, 26, 24, 3, 
yes
, 
no
,‚o) \

300 
	`SC
Ğ91, 26, 24, 4, 
yes
, 
no
,‚o) \

302 
	`SC
Ğ92, 27, 25, 1, 
yes
, 
no
,‚o) \

303 
	`SC
Ğ93, 27, 25, 2, 
yes
, 
no
,‚o) \

304 
	`SC
Ğ94, 27, 25, 3, 
yes
, 
no
,‚o) \

305 
	`SC
Ğ95, 27, 25, 4, 
yes
, 
no
,‚o) \

307 
	`SC
Ğ96, 28, 26, 1, 
yes
, 
no
,‚o) \

308 
	`SC
Ğ97, 28, 26, 2, 
yes
, 
no
,‚o) \

309 
	`SC
Ğ98, 28, 26, 3, 
yes
, 
no
,‚o) \

310 
	`SC
Ğ99, 28, 26, 4, 
yes
, 
no
,‚o) \

312 
	`SC
(100, 29, 27, 1, 
yes
, 
no
,‚o) \

313 
	`SC
(101, 29, 27, 2, 
yes
, 
no
,‚o) \

314 
	`SC
(102, 29, 27, 3, 
yes
, 
no
,‚o) \

315 
	`SC
(103, 29, 27, 4, 
yes
, 
no
,‚o) \

317 
	`SC
(104, 30, 28, 1, 
yes
, 
no
,‚o) \

318 
	`SC
(105, 30, 28, 2, 
yes
, 
no
,‚o) \

319 
	`SC
(106, 30, 28, 3, 
yes
, 
no
,‚o) \

320 
	`SC
(107, 30, 28, 4, 
yes
, 
no
,‚o) \

322 
	`SC
(108, 31, 29, 1, 
yes
, 
no
,‚o) \

323 
	`SC
(109, 31, 29, 2, 
yes
, 
no
,‚o) \

324 
	`SC
(110, 31, 29, 3, 
yes
, 
no
,‚o) \

325 
	`SC
(111, 31, 29, 4, 
yes
, 
no
,‚o) \

327 
	`SC
(112, 32, 30, 1, 
yes
, 
no
,‚o) \

328 
	`SC
(113, 32, 30, 2, 
yes
, 
no
,‚o) \

329 
	`SC
(114, 32, 30, 3, 
yes
, 
no
,‚o) \

330 
	`SC
(115, 32, 30, 4, 
yes
, 
no
,‚o) \

332 
	`SC
(116, 33, 31, 1, 
yes
, 
no
,‚o) \

333 
	`SC
(117, 33, 31, 2, 
yes
, 
no
,‚o) \

334 
	`SC
(118, 33, 31, 3, 
yes
, 
no
,‚o) \

335 
	`SC
(119, 33, 31, 4, 
yes
, 
no
,‚o) \

337 
	`SC
(120, 34, 32, 1, 
yes
, 
no
,‚o) \

338 
	`SC
(121, 34, 32, 2, 
yes
, 
no
,‚o) \

339 
	`SC
(122, 34, 32, 3, 
yes
, 
no
,‚o) \

340 
	`SC
(123, 34, 32, 4, 
yes
, 
no
,‚o) \

342 
	`SC
(124, 35, 33, 1, 
yes
, 
no
,‚o) \

343 
	`SC
(125, 35, 33, 2, 
yes
, 
no
,‚o) \

344 
	`SC
(126, 35, 33, 3, 
yes
, 
no
,‚o) \

345 
	`SC
(127, 35, 33, 4, 
yes
, 
no
,‚o) \

347 
	`SC
(128, 36, 34, 1, 
yes
, 
no
,‚o) \

348 
	`SC
(129, 36, 34, 2, 
yes
, 
no
,‚o) \

349 
	`SC
(130, 36, 34, 3, 
yes
, 
no
,‚o) \

350 
	`SC
(131, 36, 34, 4, 
yes
, 
no
,‚o) \

352 
	`SC
(132, 37, 35, 1, 
yes
, 
no
,‚o) \

353 
	`SC
(133, 37, 35, 2, 
yes
, 
no
,‚o) \

354 
	`SC
(134, 37, 35, 3, 
yes
, 
no
,‚o) \

355 
	`SC
(135, 37, 35, 4, 
yes
, 
no
,‚o) \

357 
	`SC
(136, 38, 36, 1, 
yes
, 
no
,‚o) \

358 
	`SC
(137, 38, 36, 2, 
yes
, 
no
,‚o) \

359 
	`SC
(138, 38, 36, 3, 
yes
, 
no
,‚o) \

360 
	`SC
(139, 38, 36, 4, 
yes
, 
no
,‚o) \

362 
	`SC
(140, 39, 37, 1, 
yes
, 
no
,‚o) \

363 
	`SC
(141, 39, 37, 2, 
yes
, 
no
,‚o) \

364 
	`SC
(142, 39, 37, 3, 
yes
, 
no
,‚o) \

365 
	`SC
(143, 39, 37, 4, 
yes
, 
no
,‚o) \

367 
	`SC
(144, 40, 38, 1, 
yes
, 
no
,‚o) \

368 
	`SC
(145, 40, 38, 2, 
yes
, 
no
,‚o) \

369 
	`SC
(146, 40, 38, 3, 
yes
, 
no
,‚o) \

370 
	`SC
(147, 40, 38, 4, 
yes
, 
no
,‚o) \

372 
	`SC
(148, 41, 39, 1, 
yes
, 
no
,‚o) \

373 
	`SC
(149, 41, 39, 2, 
yes
, 
no
,‚o) \

374 
	`SC
(150, 41, 39, 3, 
yes
, 
no
,‚o) \

375 
	`SC
(151, 41, 39, 4, 
yes
, 
no
,‚o) \

377 
	`SC
(152, 42, 40, 1, 
yes
, 
no
,‚o) \

378 
	`SC
(153, 42, 40, 2, 
yes
, 
no
,‚o) \

379 
	`SC
(154, 42, 40, 3, 
yes
, 
no
,‚o) \

380 
	`SC
(155, 42, 40, 4, 
yes
, 
no
,‚o) \

382 
	`SC
(156, 43, 41, 1, 
yes
, 
no
,‚o) \

383 
	`SC
(157, 43, 41, 2, 
yes
, 
no
,‚o) \

384 
	`SC
(158, 43, 41, 3, 
yes
, 
no
,‚o) \

385 
	`SC
(159, 43, 41, 4, 
yes
, 
no
,‚o) \

387 
	`SC
(160, 44, 42, 1, 
yes
, 
no
,‚o) \

388 
	`SC
(161, 44, 42, 2, 
yes
, 
no
,‚o) \

389 
	`SC
(162, 44, 42, 3, 
yes
, 
no
,‚o) \

390 
	`SC
(163, 44, 42, 4, 
yes
, 
no
,‚o) \

392 
	`SC
(164, 45, 43, 1, 
yes
, 
no
,‚o) \

393 
	`SC
(165, 45, 43, 2, 
yes
, 
no
,‚o) \

394 
	`SC
(166, 45, 43, 3, 
yes
, 
no
,‚o) \

395 
	`SC
(167, 45, 43, 4, 
yes
, 
no
,‚o) \

397 
	`SC
(168, 46, 44, 1, 
yes
, 
no
,‚o) \

398 
	`SC
(169, 46, 44, 2, 
yes
, 
no
,‚o) \

399 
	`SC
(170, 46, 44, 3, 
yes
, 
no
,‚o) \

400 
	`SC
(171, 46, 44, 4, 
yes
, 
no
,‚o) \

402 
	`SC
(172, 47, 45, 1, 
yes
, 
no
,‚o) \

403 
	`SC
(173, 47, 45, 2, 
yes
, 
no
,‚o) \

404 
	`SC
(174, 47, 45, 3, 
yes
, 
no
,‚o) \

405 
	`SC
(175, 47, 45, 4, 
yes
, 
no
,‚o) \

407 
	`SC
(176, 48, 46, 1, 
yes
, 
no
,‚o) \

408 
	`SC
(177, 48, 46, 2, 
yes
, 
no
,‚o) \

409 
	`SC
(178, 48, 46, 3, 
yes
, 
no
,‚o) \

410 
	`SC
(179, 48, 46, 4, 
yes
, 
no
,‚o) \

412 
	`SC
(180, 49, 47, 1, 
yes
, 
no
,‚o) \

413 
	`SC
(181, 49, 47, 2, 
yes
, 
no
,‚o) \

414 
	`SC
(182, 49, 47, 3, 
yes
, 
no
,‚o) \

415 
	`SC
(183, 49, 47, 4, 
yes
, 
no
,‚o) \

417 
	`SC
(184, 50, 48, 1, 
yes
, 
no
,‚o) \

418 
	`SC
(185, 50, 48, 2, 
yes
, 
no
,‚o) \

419 
	`SC
(186, 50, 48, 3, 
yes
, 
no
,‚o) \

420 
	`SC
(187, 50, 48, 4, 
yes
, 
no
,‚o) \

422 
	`SC
(188, 51, 49, 1, 
yes
, 
no
,‚o) \

423 
	`SC
(189, 51, 49, 2, 
yes
, 
no
,‚o) \

424 
	`SC
(190, 51, 49, 3, 
yes
, 
no
,‚o) \

425 
	`SC
(191, 51, 49, 4, 
yes
, 
no
,‚o) \

427 
	`SC
(192, 52, 50, 1, 
yes
, 
no
,‚o) \

428 
	`SC
(193, 52, 50, 2, 
yes
, 
no
,‚o) \

429 
	`SC
(194, 52, 50, 3, 
yes
, 
no
,‚o) \

430 
	`SC
(195, 52, 50, 4, 
yes
, 
no
,‚o) \

432 
	`SC
(196, 53, 51, 1, 
yes
, 
no
,‚o) \

433 
	`SC
(197, 53, 51, 2, 
yes
, 
no
,‚o) \

434 
	`SC
(198, 53, 51, 3, 
yes
, 
no
,‚o) \

435 
	`SC
(199, 53, 51, 4, 
yes
, 
no
,‚o) \

437 
	`SC
(200, 54, 52, 1, 
yes
, 
no
,‚o) \

438 
	`SC
(201, 54, 52, 2, 
yes
, 
no
,‚o) \

439 
	`SC
(202, 54, 52, 3, 
yes
, 
no
,‚o) \

440 
	`SC
(203, 54, 52, 4, 
yes
, 
no
,‚o) \

442 
	`SC
(204, 55, 53, 1, 
yes
, 
no
,‚o) \

443 
	`SC
(205, 55, 53, 2, 
yes
, 
no
,‚o) \

444 
	`SC
(206, 55, 53, 3, 
yes
, 
no
,‚o) \

445 
	`SC
(207, 55, 53, 4, 
yes
, 
no
,‚o) \

447 
	`SC
(208, 56, 54, 1, 
yes
, 
no
,‚o) \

448 
	`SC
(209, 56, 54, 2, 
yes
, 
no
,‚o) \

449 
	`SC
(210, 56, 54, 3, 
yes
, 
no
,‚o) \

450 
	`SC
(211, 56, 54, 4, 
yes
, 
no
,‚o) \

452 
	`SC
(212, 57, 55, 1, 
yes
, 
no
,‚o) \

453 
	`SC
(213, 57, 55, 2, 
yes
, 
no
,‚o) \

454 
	`SC
(214, 57, 55, 3, 
yes
, 
no
,‚o) \

455 
	`SC
(215, 57, 55, 4, 
yes
, 
no
,‚o) \

457 
	`SC
(216, 58, 56, 1, 
yes
, 
no
,‚o) \

458 
	`SC
(217, 58, 56, 2, 
yes
, 
no
,‚o) \

459 
	`SC
(218, 58, 56, 3, 
yes
, 
no
,‚o) \

460 
	`SC
(219, 58, 56, 4, 
yes
, 
no
,‚o) \

462 
	`SC
(220, 59, 57, 1, 
yes
, 
no
,‚o) \

463 
	`SC
(221, 59, 57, 2, 
yes
, 
no
,‚o) \

464 
	`SC
(222, 59, 57, 3, 
yes
, 
no
,‚o) \

465 
	`SC
(223, 59, 57, 4, 
yes
, 
no
,‚o) \

467 
	`SC
(224, 60, 58, 1, 
yes
, 
no
,‚o) \

468 
	`SC
(225, 60, 58, 2, 
yes
, 
no
,‚o) \

469 
	`SC
(226, 60, 58, 3, 
yes
, 
no
,‚o) \

470 
	`SC
(227, 60, 58, 4, 
yes
, 
no
,‚o) \

472 
	`SC
(228, 61, 59, 1, 
yes
, 
no
,‚o) \

473 
	`SC
(229, 61, 59, 2, 
yes
, 
no
,‚o) \

474 
	`SC
(230, 61, 59, 3, 
yes
, 
no
,‚o) \

475 
	`SC
(231, 61, 59, 4, 
yes
, 
no
,‚o) \

477 
	`SC
(232, 62, 60, 1, 
yes
, 
no
,‚o) \

478 
	`SC
(233, 62, 60, 2, 
yes
, 
no
,‚o) \

479 
	`SC
(234, 62, 60, 3, 
yes
, 
no
,‚o) \

480 

	)

481 
	#SIZE_CLASSES_DEFINED


	)

482 
	#NTBINS
 0

	)

483 
	#NLBINS
 32

	)

484 
	#NBINS
 39

	)

485 
	#NSIZES
 235

	)

486 
	#NPSIZES
 199

	)

487 
	#LG_TINY_MAXCLASS
 "NA"

	)

488 
	#LOOKUP_MAXCLASS
 ((((
size_t
)1è<< 11è+ (((size_t)4è<< 9))

	)

489 
	#SMALL_MAXCLASS
 ((((
size_t
)1è<< 13è+ (((size_t)3è<< 11))

	)

490 
	#LG_LARGE_MINCLASS
 14

	)

491 
	#HUGE_MAXCLASS
 ((((
size_t
)1è<< 62è+ (((size_t)3è<< 60))

	)

494 #iâdeà
SIZE_CLASSES_DEFINED


497 #undeà
SIZE_CLASSES_DEFINED


504 #ià(
NBINS
 > 255)

510 #ifdeà
JEMALLOC_H_STRUCTS


515 #ifdeà
JEMALLOC_H_EXTERNS


520 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/smoothstep.h

6 #ifdeà
JEMALLOC_H_TYPES


24 
	#SMOOTHSTEP_VARIANT
 "smoÙh”"

	)

25 
	#SMOOTHSTEP_NSTEPS
 200

	)

26 
	#SMOOTHSTEP_BFP
 24

	)

27 
	#SMOOTHSTEP
 \

29 
	`STEP
Ğ1, 
	`UINT64_C
(0x0000000000000014), 0.005, 0.000001240643750) \

30 
	`STEP
Ğ2, 
	`UINT64_C
(0x00000000000000a5), 0.010, 0.000009850600000) \

31 
	`STEP
Ğ3, 
	`UINT64_C
(0x0000000000000229), 0.015, 0.000032995181250) \

32 
	`STEP
Ğ4, 
	`UINT64_C
(0x0000000000000516), 0.020, 0.000077619200000) \

33 
	`STEP
Ğ5, 
	`UINT64_C
(0x00000000000009dc), 0.025, 0.000150449218750) \

34 
	`STEP
Ğ6, 
	`UINT64_C
(0x00000000000010e8), 0.030, 0.000257995800000) \

35 
	`STEP
Ğ7, 
	`UINT64_C
(0x0000000000001aa4), 0.035, 0.000406555756250) \

36 
	`STEP
Ğ8, 
	`UINT64_C
(0x0000000000002777), 0.040, 0.000602214400000) \

37 
	`STEP
Ğ9, 
	`UINT64_C
(0x00000000000037c2), 0.045, 0.000850847793750) \

38 
	`STEP
Ğ10, 
	`UINT64_C
(0x0000000000004be6), 0.050, 0.001158125000000) \

39 
	`STEP
Ğ11, 
	`UINT64_C
(0x000000000000643c), 0.055, 0.001529510331250) \

40 
	`STEP
Ğ12, 
	`UINT64_C
(0x000000000000811f), 0.060, 0.001970265600000) \

41 
	`STEP
Ğ13, 
	`UINT64_C
(0x000000000000a2e2), 0.065, 0.002485452368750) \

42 
	`STEP
Ğ14, 
	`UINT64_C
(0x000000000000c9d8), 0.070, 0.003079934200000) \

43 
	`STEP
Ğ15, 
	`UINT64_C
(0x000000000000f64f), 0.075, 0.003758378906250) \

44 
	`STEP
Ğ16, 
	`UINT64_C
(0x0000000000012891), 0.080, 0.004525260800000) \

45 
	`STEP
Ğ17, 
	`UINT64_C
(0x00000000000160e7), 0.085, 0.005384862943750) \

46 
	`STEP
Ğ18, 
	`UINT64_C
(0x0000000000019f95), 0.090, 0.006341279400000) \

47 
	`STEP
Ğ19, 
	`UINT64_C
(0x000000000001e4dc), 0.095, 0.007398417481250) \

48 
	`STEP
Ğ20, 
	`UINT64_C
(0x00000000000230fc), 0.100, 0.008560000000000) \

49 
	`STEP
Ğ21, 
	`UINT64_C
(0x0000000000028430), 0.105, 0.009829567518750) \

50 
	`STEP
Ğ22, 
	`UINT64_C
(0x000000000002deb0), 0.110, 0.011210480600000) \

51 
	`STEP
Ğ23, 
	`UINT64_C
(0x00000000000340b1), 0.115, 0.012705922056250) \

52 
	`STEP
Ğ24, 
	`UINT64_C
(0x000000000003aa67), 0.120, 0.014318899200000) \

53 
	`STEP
Ğ25, 
	`UINT64_C
(0x0000000000041c00), 0.125, 0.016052246093750) \

54 
	`STEP
Ğ26, 
	`UINT64_C
(0x00000000000495a8), 0.130, 0.017908625800000) \

55 
	`STEP
Ğ27, 
	`UINT64_C
(0x000000000005178b), 0.135, 0.019890532631250) \

56 
	`STEP
Ğ28, 
	`UINT64_C
(0x000000000005a1cf), 0.140, 0.022000294400000) \

57 
	`STEP
Ğ29, 
	`UINT64_C
(0x0000000000063498), 0.145, 0.024240074668750) \

58 
	`STEP
Ğ30, 
	`UINT64_C
(0x000000000006d009), 0.150, 0.026611875000000) \

59 
	`STEP
Ğ31, 
	`UINT64_C
(0x000000000007743f), 0.155, 0.029117537206250) \

60 
	`STEP
Ğ32, 
	`UINT64_C
(0x0000000000082157), 0.160, 0.031758745600000) \

61 
	`STEP
Ğ33, 
	`UINT64_C
(0x000000000008d76b), 0.165, 0.034537029243750) \

62 
	`STEP
Ğ34, 
	`UINT64_C
(0x0000000000099691), 0.170, 0.037453764200000) \

63 
	`STEP
Ğ35, 
	`UINT64_C
(0x00000000000a5edf), 0.175, 0.040510175781250) \

64 
	`STEP
Ğ36, 
	`UINT64_C
(0x00000000000b3067), 0.180, 0.043707340800000) \

65 
	`STEP
Ğ37, 
	`UINT64_C
(0x00000000000c0b38), 0.185, 0.047046189818750) \

66 
	`STEP
Ğ38, 
	`UINT64_C
(0x00000000000cef5e), 0.190, 0.050527509400000) \

67 
	`STEP
Ğ39, 
	`UINT64_C
(0x00000000000ddce6), 0.195, 0.054151944356250) \

68 
	`STEP
Ğ40, 
	`UINT64_C
(0x00000000000ed3d8), 0.200, 0.057920000000000) \

69 
	`STEP
Ğ41, 
	`UINT64_C
(0x00000000000fd439), 0.205, 0.061832044393750) \

70 
	`STEP
Ğ42, 
	`UINT64_C
(0x000000000010de0e), 0.210, 0.065888310600000) \

71 
	`STEP
Ğ43, 
	`UINT64_C
(0x000000000011f158), 0.215, 0.070088898931250) \

72 
	`STEP
Ğ44, 
	`UINT64_C
(0x0000000000130e17), 0.220, 0.074433779200000) \

73 
	`STEP
Ğ45, 
	`UINT64_C
(0x0000000000143448), 0.225, 0.078922792968750) \

74 
	`STEP
Ğ46, 
	`UINT64_C
(0x00000000001563e7), 0.230, 0.083555655800000) \

75 
	`STEP
Ğ47, 
	`UINT64_C
(0x0000000000169cec), 0.235, 0.088331959506250) \

76 
	`STEP
Ğ48, 
	`UINT64_C
(0x000000000017df4f), 0.240, 0.093251174400000) \

77 
	`STEP
Ğ49, 
	`UINT64_C
(0x0000000000192b04), 0.245, 0.098312651543750) \

78 
	`STEP
Ğ50, 
	`UINT64_C
(0x00000000001a8000), 0.250, 0.103515625000000) \

79 
	`STEP
Ğ51, 
	`UINT64_C
(0x00000000001bde32), 0.255, 0.108859214081250) \

80 
	`STEP
Ğ52, 
	`UINT64_C
(0x00000000001d458b), 0.260, 0.114342425600000) \

81 
	`STEP
Ğ53, 
	`UINT64_C
(0x00000000001eb5f8), 0.265, 0.119964156118750) \

82 
	`STEP
Ğ54, 
	`UINT64_C
(0x0000000000202f65), 0.270, 0.125723194200000) \

83 
	`STEP
Ğ55, 
	`UINT64_C
(0x000000000021b1bb), 0.275, 0.131618222656250) \

84 
	`STEP
Ğ56, 
	`UINT64_C
(0x0000000000233ce3), 0.280, 0.137647820800000) \

85 
	`STEP
Ğ57, 
	`UINT64_C
(0x000000000024d0c3), 0.285, 0.143810466693750) \

86 
	`STEP
Ğ58, 
	`UINT64_C
(0x0000000000266d40), 0.290, 0.150104539400000) \

87 
	`STEP
Ğ59, 
	`UINT64_C
(0x000000000028123d), 0.295, 0.156528321231250) \

88 
	`STEP
Ğ60, 
	`UINT64_C
(0x000000000029bf9c), 0.300, 0.163080000000000) \

89 
	`STEP
Ğ61, 
	`UINT64_C
(0x00000000002b753d), 0.305, 0.169757671268750) \

90 
	`STEP
Ğ62, 
	`UINT64_C
(0x00000000002d32fe), 0.310, 0.176559340600000) \

91 
	`STEP
Ğ63, 
	`UINT64_C
(0x00000000002ef8bc), 0.315, 0.183482925806250) \

92 
	`STEP
Ğ64, 
	`UINT64_C
(0x000000000030c654), 0.320, 0.190526259200000) \

93 
	`STEP
Ğ65, 
	`UINT64_C
(0x0000000000329b9f), 0.325, 0.197687089843750) \

94 
	`STEP
Ğ66, 
	`UINT64_C
(0x0000000000347875), 0.330, 0.204963085800000) \

95 
	`STEP
Ğ67, 
	`UINT64_C
(0x0000000000365cb0), 0.335, 0.212351836381250) \

96 
	`STEP
Ğ68, 
	`UINT64_C
(0x0000000000384825), 0.340, 0.219850854400000) \

97 
	`STEP
Ğ69, 
	`UINT64_C
(0x00000000003a3aa8), 0.345, 0.227457578418750) \

98 
	`STEP
Ğ70, 
	`UINT64_C
(0x00000000003c340f), 0.350, 0.235169375000000) \

99 
	`STEP
Ğ71, 
	`UINT64_C
(0x00000000003e342b), 0.355, 0.242983540956250) \

100 
	`STEP
Ğ72, 
	`UINT64_C
(0x0000000000403ace), 0.360, 0.250897305600000) \

101 
	`STEP
Ğ73, 
	`UINT64_C
(0x00000000004247c8), 0.365, 0.258907832993750) \

102 
	`STEP
Ğ74, 
	`UINT64_C
(0x0000000000445ae9), 0.370, 0.267012224200000) \

103 
	`STEP
Ğ75, 
	`UINT64_C
(0x0000000000467400), 0.375, 0.275207519531250) \

104 
	`STEP
Ğ76, 
	`UINT64_C
(0x00000000004892d8), 0.380, 0.283490700800000) \

105 
	`STEP
Ğ77, 
	`UINT64_C
(0x00000000004ab740), 0.385, 0.291858693568750) \

106 
	`STEP
Ğ78, 
	`UINT64_C
(0x00000000004ce102), 0.390, 0.300308369400000) \

107 
	`STEP
Ğ79, 
	`UINT64_C
(0x00000000004f0fe9), 0.395, 0.308836548106250) \

108 
	`STEP
Ğ80, 
	`UINT64_C
(0x00000000005143bf), 0.400, 0.317440000000000) \

109 
	`STEP
Ğ81, 
	`UINT64_C
(0x0000000000537c4d), 0.405, 0.326115448143750) \

110 
	`STEP
Ğ82, 
	`UINT64_C
(0x000000000055b95b), 0.410, 0.334859570600000) \

111 
	`STEP
Ğ83, 
	`UINT64_C
(0x000000000057fab1), 0.415, 0.343669002681250) \

112 
	`STEP
Ğ84, 
	`UINT64_C
(0x00000000005a4015), 0.420, 0.352540339200000) \

113 
	`STEP
Ğ85, 
	`UINT64_C
(0x00000000005c894e), 0.425, 0.361470136718750) \

114 
	`STEP
Ğ86, 
	`UINT64_C
(0x00000000005ed622), 0.430, 0.370454915800000) \

115 
	`STEP
Ğ87, 
	`UINT64_C
(0x0000000000612655), 0.435, 0.379491163256250) \

116 
	`STEP
Ğ88, 
	`UINT64_C
(0x00000000006379ac), 0.440, 0.388575334400000) \

117 
	`STEP
Ğ89, 
	`UINT64_C
(0x000000000065cfeb), 0.445, 0.397703855293750) \

118 
	`STEP
Ğ90, 
	`UINT64_C
(0x00000000006828d6), 0.450, 0.406873125000000) \

119 
	`STEP
Ğ91, 
	`UINT64_C
(0x00000000006a842f), 0.455, 0.416079517831250) \

120 
	`STEP
Ğ92, 
	`UINT64_C
(0x00000000006ce1bb), 0.460, 0.425319385600000) \

121 
	`STEP
Ğ93, 
	`UINT64_C
(0x00000000006f413a), 0.465, 0.434589059868750) \

122 
	`STEP
Ğ94, 
	`UINT64_C
(0x000000000071a270), 0.470, 0.443884854200000) \

123 
	`STEP
Ğ95, 
	`UINT64_C
(0x000000000074051d), 0.475, 0.453203066406250) \

124 
	`STEP
Ğ96, 
	`UINT64_C
(0x0000000000766905), 0.480, 0.462539980800000) \

125 
	`STEP
Ğ97, 
	`UINT64_C
(0x000000000078cde7), 0.485, 0.471891870443750) \

126 
	`STEP
Ğ98, 
	`UINT64_C
(0x00000000007b3387), 0.490, 0.481254999400000) \

127 
	`STEP
Ğ99, 
	`UINT64_C
(0x00000000007d99a4), 0.495, 0.490625624981250) \

128 
	`STEP
Ğ100, 
	`UINT64_C
(0x0000000000800000), 0.500, 0.500000000000000) \

129 
	`STEP
Ğ101, 
	`UINT64_C
(0x000000000082665b), 0.505, 0.509374375018750) \

130 
	`STEP
Ğ102, 
	`UINT64_C
(0x000000000084cc78), 0.510, 0.518745000600000) \

131 
	`STEP
Ğ103, 
	`UINT64_C
(0x0000000000873218), 0.515, 0.528108129556250) \

132 
	`STEP
Ğ104, 
	`UINT64_C
(0x00000000008996fa), 0.520, 0.537460019200000) \

133 
	`STEP
Ğ105, 
	`UINT64_C
(0x00000000008bfae2), 0.525, 0.546796933593750) \

134 
	`STEP
Ğ106, 
	`UINT64_C
(0x00000000008e5d8f), 0.530, 0.556115145800000) \

135 
	`STEP
Ğ107, 
	`UINT64_C
(0x000000000090bec5), 0.535, 0.565410940131250) \

136 
	`STEP
Ğ108, 
	`UINT64_C
(0x0000000000931e44), 0.540, 0.574680614400000) \

137 
	`STEP
Ğ109, 
	`UINT64_C
(0x0000000000957bd0), 0.545, 0.583920482168750) \

138 
	`STEP
Ğ110, 
	`UINT64_C
(0x000000000097d729), 0.550, 0.593126875000000) \

139 
	`STEP
Ğ111, 
	`UINT64_C
(0x00000000009a3014), 0.555, 0.602296144706250) \

140 
	`STEP
Ğ112, 
	`UINT64_C
(0x00000000009c8653), 0.560, 0.611424665600000) \

141 
	`STEP
Ğ113, 
	`UINT64_C
(0x00000000009ed9aa), 0.565, 0.620508836743750) \

142 
	`STEP
Ğ114, 
	`UINT64_C
(0x0000000000a129dd), 0.570, 0.629545084200000) \

143 
	`STEP
Ğ115, 
	`UINT64_C
(0x0000000000a376b1), 0.575, 0.638529863281250) \

144 
	`STEP
Ğ116, 
	`UINT64_C
(0x0000000000a5bfea), 0.580, 0.647459660800000) \

145 
	`STEP
Ğ117, 
	`UINT64_C
(0x0000000000a8054e), 0.585, 0.656330997318750) \

146 
	`STEP
Ğ118, 
	`UINT64_C
(0x0000000000aa46a4), 0.590, 0.665140429400000) \

147 
	`STEP
Ğ119, 
	`UINT64_C
(0x0000000000ac83b2), 0.595, 0.673884551856250) \

148 
	`STEP
Ğ120, 
	`UINT64_C
(0x0000000000aebc40), 0.600, 0.682560000000000) \

149 
	`STEP
Ğ121, 
	`UINT64_C
(0x0000000000b0f016), 0.605, 0.691163451893750) \

150 
	`STEP
Ğ122, 
	`UINT64_C
(0x0000000000b31efd), 0.610, 0.699691630600000) \

151 
	`STEP
Ğ123, 
	`UINT64_C
(0x0000000000b548bf), 0.615, 0.708141306431250) \

152 
	`STEP
Ğ124, 
	`UINT64_C
(0x0000000000b76d27), 0.620, 0.716509299200000) \

153 
	`STEP
Ğ125, 
	`UINT64_C
(0x0000000000b98c00), 0.625, 0.724792480468750) \

154 
	`STEP
Ğ126, 
	`UINT64_C
(0x0000000000bba516), 0.630, 0.732987775800000) \

155 
	`STEP
Ğ127, 
	`UINT64_C
(0x0000000000bdb837), 0.635, 0.741092167006250) \

156 
	`STEP
Ğ128, 
	`UINT64_C
(0x0000000000bfc531), 0.640, 0.749102694400000) \

157 
	`STEP
Ğ129, 
	`UINT64_C
(0x0000000000c1cbd4), 0.645, 0.757016459043750) \

158 
	`STEP
Ğ130, 
	`UINT64_C
(0x0000000000c3cbf0), 0.650, 0.764830625000000) \

159 
	`STEP
Ğ131, 
	`UINT64_C
(0x0000000000c5c557), 0.655, 0.772542421581250) \

160 
	`STEP
Ğ132, 
	`UINT64_C
(0x0000000000c7b7da), 0.660, 0.780149145600000) \

161 
	`STEP
Ğ133, 
	`UINT64_C
(0x0000000000c9a34f), 0.665, 0.787648163618750) \

162 
	`STEP
Ğ134, 
	`UINT64_C
(0x0000000000cb878a), 0.670, 0.795036914200000) \

163 
	`STEP
Ğ135, 
	`UINT64_C
(0x0000000000cd6460), 0.675, 0.802312910156250) \

164 
	`STEP
Ğ136, 
	`UINT64_C
(0x0000000000cf39ab), 0.680, 0.809473740800000) \

165 
	`STEP
Ğ137, 
	`UINT64_C
(0x0000000000d10743), 0.685, 0.816517074193750) \

166 
	`STEP
Ğ138, 
	`UINT64_C
(0x0000000000d2cd01), 0.690, 0.823440659400000) \

167 
	`STEP
Ğ139, 
	`UINT64_C
(0x0000000000d48ac2), 0.695, 0.830242328731250) \

168 
	`STEP
Ğ140, 
	`UINT64_C
(0x0000000000d64063), 0.700, 0.836920000000000) \

169 
	`STEP
Ğ141, 
	`UINT64_C
(0x0000000000d7edc2), 0.705, 0.843471678768750) \

170 
	`STEP
Ğ142, 
	`UINT64_C
(0x0000000000d992bf), 0.710, 0.849895460600000) \

171 
	`STEP
Ğ143, 
	`UINT64_C
(0x0000000000db2f3c), 0.715, 0.856189533306250) \

172 
	`STEP
Ğ144, 
	`UINT64_C
(0x0000000000dcc31c), 0.720, 0.862352179200000) \

173 
	`STEP
Ğ145, 
	`UINT64_C
(0x0000000000de4e44), 0.725, 0.868381777343750) \

174 
	`STEP
Ğ146, 
	`UINT64_C
(0x0000000000dfd09a), 0.730, 0.874276805800000) \

175 
	`STEP
Ğ147, 
	`UINT64_C
(0x0000000000e14a07), 0.735, 0.880035843881250) \

176 
	`STEP
Ğ148, 
	`UINT64_C
(0x0000000000e2ba74), 0.740, 0.885657574400000) \

177 
	`STEP
Ğ149, 
	`UINT64_C
(0x0000000000e421cd), 0.745, 0.891140785918750) \

178 
	`STEP
Ğ150, 
	`UINT64_C
(0x0000000000e58000), 0.750, 0.896484375000000) \

179 
	`STEP
Ğ151, 
	`UINT64_C
(0x0000000000e6d4fb), 0.755, 0.901687348456250) \

180 
	`STEP
Ğ152, 
	`UINT64_C
(0x0000000000e820b0), 0.760, 0.906748825600000) \

181 
	`STEP
Ğ153, 
	`UINT64_C
(0x0000000000e96313), 0.765, 0.911668040493750) \

182 
	`STEP
Ğ154, 
	`UINT64_C
(0x0000000000ea9c18), 0.770, 0.916444344200000) \

183 
	`STEP
Ğ155, 
	`UINT64_C
(0x0000000000ebcbb7), 0.775, 0.921077207031250) \

184 
	`STEP
Ğ156, 
	`UINT64_C
(0x0000000000ecf1e8), 0.780, 0.925566220800000) \

185 
	`STEP
Ğ157, 
	`UINT64_C
(0x0000000000ee0ea7), 0.785, 0.929911101068750) \

186 
	`STEP
Ğ158, 
	`UINT64_C
(0x0000000000ef21f1), 0.790, 0.934111689400000) \

187 
	`STEP
Ğ159, 
	`UINT64_C
(0x0000000000f02bc6), 0.795, 0.938167955606250) \

188 
	`STEP
Ğ160, 
	`UINT64_C
(0x0000000000f12c27), 0.800, 0.942080000000000) \

189 
	`STEP
Ğ161, 
	`UINT64_C
(0x0000000000f22319), 0.805, 0.945848055643750) \

190 
	`STEP
Ğ162, 
	`UINT64_C
(0x0000000000f310a1), 0.810, 0.949472490600000) \

191 
	`STEP
Ğ163, 
	`UINT64_C
(0x0000000000f3f4c7), 0.815, 0.952953810181250) \

192 
	`STEP
Ğ164, 
	`UINT64_C
(0x0000000000f4cf98), 0.820, 0.956292659200000) \

193 
	`STEP
Ğ165, 
	`UINT64_C
(0x0000000000f5a120), 0.825, 0.959489824218750) \

194 
	`STEP
Ğ166, 
	`UINT64_C
(0x0000000000f6696e), 0.830, 0.962546235800000) \

195 
	`STEP
Ğ167, 
	`UINT64_C
(0x0000000000f72894), 0.835, 0.965462970756250) \

196 
	`STEP
Ğ168, 
	`UINT64_C
(0x0000000000f7dea8), 0.840, 0.968241254400000) \

197 
	`STEP
Ğ169, 
	`UINT64_C
(0x0000000000f88bc0), 0.845, 0.970882462793750) \

198 
	`STEP
Ğ170, 
	`UINT64_C
(0x0000000000f92ff6), 0.850, 0.973388125000000) \

199 
	`STEP
Ğ171, 
	`UINT64_C
(0x0000000000f9cb67), 0.855, 0.975759925331250) \

200 
	`STEP
Ğ172, 
	`UINT64_C
(0x0000000000fa5e30), 0.860, 0.977999705600000) \

201 
	`STEP
Ğ173, 
	`UINT64_C
(0x0000000000fae874), 0.865, 0.980109467368750) \

202 
	`STEP
Ğ174, 
	`UINT64_C
(0x0000000000fb6a57), 0.870, 0.982091374200000) \

203 
	`STEP
Ğ175, 
	`UINT64_C
(0x0000000000fbe400), 0.875, 0.983947753906250) \

204 
	`STEP
Ğ176, 
	`UINT64_C
(0x0000000000fc5598), 0.880, 0.985681100800000) \

205 
	`STEP
Ğ177, 
	`UINT64_C
(0x0000000000fcbf4e), 0.885, 0.987294077943750) \

206 
	`STEP
Ğ178, 
	`UINT64_C
(0x0000000000fd214f), 0.890, 0.988789519400000) \

207 
	`STEP
Ğ179, 
	`UINT64_C
(0x0000000000fd7bcf), 0.895, 0.990170432481250) \

208 
	`STEP
Ğ180, 
	`UINT64_C
(0x0000000000fdcf03), 0.900, 0.991440000000000) \

209 
	`STEP
Ğ181, 
	`UINT64_C
(0x0000000000fe1b23), 0.905, 0.992601582518750) \

210 
	`STEP
Ğ182, 
	`UINT64_C
(0x0000000000fe606a), 0.910, 0.993658720600000) \

211 
	`STEP
Ğ183, 
	`UINT64_C
(0x0000000000fe9f18), 0.915, 0.994615137056250) \

212 
	`STEP
Ğ184, 
	`UINT64_C
(0x0000000000fed76e), 0.920, 0.995474739200000) \

213 
	`STEP
Ğ185, 
	`UINT64_C
(0x0000000000ff09b0), 0.925, 0.996241621093750) \

214 
	`STEP
Ğ186, 
	`UINT64_C
(0x0000000000ff3627), 0.930, 0.996920065800000) \

215 
	`STEP
Ğ187, 
	`UINT64_C
(0x0000000000ff5d1d), 0.935, 0.997514547631250) \

216 
	`STEP
Ğ188, 
	`UINT64_C
(0x0000000000ff7ee0), 0.940, 0.998029734400000) \

217 
	`STEP
Ğ189, 
	`UINT64_C
(0x0000000000ff9bc3), 0.945, 0.998470489668750) \

218 
	`STEP
Ğ190, 
	`UINT64_C
(0x0000000000ffb419), 0.950, 0.998841875000000) \

219 
	`STEP
Ğ191, 
	`UINT64_C
(0x0000000000ffc83d), 0.955, 0.999149152206250) \

220 
	`STEP
Ğ192, 
	`UINT64_C
(0x0000000000ffd888), 0.960, 0.999397785600000) \

221 
	`STEP
Ğ193, 
	`UINT64_C
(0x0000000000ffe55b), 0.965, 0.999593444243750) \

222 
	`STEP
Ğ194, 
	`UINT64_C
(0x0000000000ffef17), 0.970, 0.999742004200000) \

223 
	`STEP
Ğ195, 
	`UINT64_C
(0x0000000000fff623), 0.975, 0.999849550781250) \

224 
	`STEP
Ğ196, 
	`UINT64_C
(0x0000000000fffae9), 0.980, 0.999922380800000) \

225 
	`STEP
Ğ197, 
	`UINT64_C
(0x0000000000fffdd6), 0.985, 0.999967004818750) \

226 
	`STEP
Ğ198, 
	`UINT64_C
(0x0000000000ffff5a), 0.990, 0.999990149400000) \

227 
	`STEP
Ğ199, 
	`UINT64_C
(0x0000000000ffffeb), 0.995, 0.999998759356250) \

228 
	`STEP
Ğ200, 
	`UINT64_C
(0x0000000001000000), 1.000, 1.000000000000000) \

229 

	)

232 #ifdeà
JEMALLOC_H_STRUCTS


237 #ifdeà
JEMALLOC_H_EXTERNS


242 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/spin.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
¥š_s
 
	t¥š_t
;

8 #ifdeà
JEMALLOC_H_STRUCTS


10 
	s¥š_s
 {

11 
	m™”©iÚ
;

16 #ifdeà
JEMALLOC_H_EXTERNS


20 #ifdeà
JEMALLOC_H_INLINES


22 #iâdeà
JEMALLOC_ENABLE_INLINE


23 
¥š_š™
(
¥š_t
 *
¥š
);

24 
¥š_ad­tive
(
¥š_t
 *
¥š
);

27 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_SPIN_C_
))

28 
JEMALLOC_INLINE
 

29 
	$¥š_š™
(
¥š_t
 *
¥š
)

32 
¥š
->
™”©iÚ
 = 0;

33 
	}
}

35 
JEMALLOC_INLINE
 

36 
	$¥š_ad­tive
(
¥š_t
 *
¥š
)

38 vŞ©
ušt64_t
 
i
;

40 
i
 = 0; i < (
	`KQU
(1è<< 
¥š
->
™”©iÚ
); i++)

41 
CPU_SPINWAIT
;

43 ià(
¥š
->
™”©iÚ
 < 63)

44 
¥š
->
™”©iÚ
++;

45 
	}
}

	@deps/jemalloc/include/jemalloc/internal/stats.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
tÿche_bš_¡©s_s
 
	ttÿche_bš_¡©s_t
;

5 
m®loc_bš_¡©s_s
 
	tm®loc_bš_¡©s_t
;

6 
m®loc_Ïrge_¡©s_s
 
	tm®loc_Ïrge_¡©s_t
;

7 
m®loc_huge_¡©s_s
 
	tm®loc_huge_¡©s_t
;

8 
¬’a_¡©s_s
 
	t¬’a_¡©s_t
;

9 
chunk_¡©s_s
 
	tchunk_¡©s_t
;

13 #ifdeà
JEMALLOC_H_STRUCTS


15 
	stÿche_bš_¡©s_s
 {

20 
ušt64_t
 
	mÄeque¡s
;

23 
	sm®loc_bš_¡©s_s
 {

30 
ušt64_t
 
	mnm®loc
;

31 
ušt64_t
 
	mnd®loc
;

38 
ušt64_t
 
	mÄeque¡s
;

44 
size_t
 
	mcu¼egs
;

47 
ušt64_t
 
	mnfls
;

50 
ušt64_t
 
	mnæushes
;

53 
ušt64_t
 
	mÄuns
;

59 
ušt64_t
 
	m»runs
;

62 
size_t
 
	mcu¼uns
;

65 
	sm®loc_Ïrge_¡©s_s
 {

72 
ušt64_t
 
	mnm®loc
;

73 
ušt64_t
 
	mnd®loc
;

80 
ušt64_t
 
	mÄeque¡s
;

86 
size_t
 
	mcu¼uns
;

89 
	sm®loc_huge_¡©s_s
 {

94 
ušt64_t
 
	mnm®loc
;

95 
ušt64_t
 
	mnd®loc
;

98 
size_t
 
	mcurhchunks
;

101 
	s¬’a_¡©s_s
 {

103 
size_t
 
	mm­³d
;

111 
size_t
 
	m»šed
;

118 
ušt64_t
 
	mÅurge
;

119 
ušt64_t
 
	mnmadvi£
;

120 
ušt64_t
 
	mpurged
;

126 
size_t
 
	mm‘ad©a_m­³d
;

127 
size_t
 
	mm‘ad©a_®loÿ‹d
;

130 
size_t
 
	m®loÿ‹d_Ïrge
;

131 
ušt64_t
 
	mnm®loc_Ïrge
;

132 
ušt64_t
 
	mnd®loc_Ïrge
;

133 
ušt64_t
 
	mÄeque¡s_Ïrge
;

135 
size_t
 
	m®loÿ‹d_huge
;

136 
ušt64_t
 
	mnm®loc_huge
;

137 
ušt64_t
 
	mnd®loc_huge
;

140 
m®loc_Ïrge_¡©s_t
 *
	ml¡©s
;

143 
m®loc_huge_¡©s_t
 *
	mh¡©s
;

148 #ifdeà
JEMALLOC_H_EXTERNS


150 
boŞ
 
İt_¡©s_´št
;

152 
size_t
 
¡©s_ÿùive
;

154 
¡©s_´št
((*
wr™e
)(*, cÚ¡ *), *
cbİaque
,

155 cÚ¡ *
İts
);

159 #ifdeà
JEMALLOC_H_INLINES


161 #iâdeà
JEMALLOC_ENABLE_INLINE


162 
size_t
 
	`¡©s_ÿùive_g‘
();

163 
	`¡©s_ÿùive_add
(
size_t
 
size
);

164 
	`¡©s_ÿùive_sub
(
size_t
 
size
);

167 #ià(
	`defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_STATS_C_
))

168 
JEMALLOC_INLINE
 
size_t


169 
	$¡©s_ÿùive_g‘
()

172  (
	`©omic_»ad_z
(&
¡©s_ÿùive
));

173 
	}
}

175 
JEMALLOC_INLINE
 

176 
	$¡©s_ÿùive_add
(
size_t
 
size
)

179 
	`as£¹
(
size
 > 0);

180 
	`as£¹
((
size
 & 
chunksize_mask
) == 0);

182 
	`©omic_add_z
(&
¡©s_ÿùive
, 
size
);

183 
	}
}

185 
JEMALLOC_INLINE
 

186 
	$¡©s_ÿùive_sub
(
size_t
 
size
)

189 
	`as£¹
(
size
 > 0);

190 
	`as£¹
((
size
 & 
chunksize_mask
) == 0);

192 
	`©omic_sub_z
(&
¡©s_ÿùive
, 
size
);

193 
	}
}

	@deps/jemalloc/include/jemalloc/internal/tcache.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
tÿche_bš_šfo_s
 
	ttÿche_bš_šfo_t
;

5 
tÿche_bš_s
 
	ttÿche_bš_t
;

6 
tÿche_s
 
	ttÿche_t
;

7 
tÿches_s
 
	ttÿches_t
;

14 
	#TCACHE_STATE_DISABLED
 ((
tÿche_t
 *)(
ušŒ_t
)1)

	)

15 
	#TCACHE_STATE_REINCARNATED
 ((
tÿche_t
 *)(
ušŒ_t
)2)

	)

16 
	#TCACHE_STATE_PURGATORY
 ((
tÿche_t
 *)(
ušŒ_t
)3)

	)

17 
	#TCACHE_STATE_MAX
 
TCACHE_STATE_PURGATORY


	)

22 
	#TCACHE_NSLOTS_SMALL_MIN
 20

	)

31 
	#TCACHE_NSLOTS_SMALL_MAX
 200

	)

34 
	#TCACHE_NSLOTS_LARGE
 20

	)

37 
	#LG_TCACHE_MAXCLASS_DEFAULT
 15

	)

44 
	#TCACHE_GC_SWEEP
 8192

	)

47 
	#TCACHE_GC_INCR
 \

48 ((
TCACHE_GC_SWEEP
 / 
NBINS
è+ ((TCACHE_GC_SWEEP / NBINS =ğ0è? 0 : 1))

	)

52 #ifdeà
JEMALLOC_H_STRUCTS


55 
	mtÿche_’abËd_çl£
 = 0,

56 
	mtÿche_’abËd_Œue
 = 1,

57 
	mtÿche_’abËd_deçuÉ
 = 2

58 } 
	ttÿche_’abËd_t
;

64 
	stÿche_bš_šfo_s
 {

65 
	mnÿched_max
;

68 
	stÿche_bš_s
 {

69 
tÿche_bš_¡©s_t
 
	mt¡©s
;

70 
	mlow_w©”
;

71 
	mlg_fl_div
;

72 
	mnÿched
;

80 **
	mava
;

83 
	stÿche_s
 {

84 
ql_–m
(
tÿche_t
è
	mlšk
;

85 
ušt64_t
 
	m´of_accumby‹s
;

86 
tick”_t
 
	mgc_tick”
;

87 
szšd_t
 
	mÃxt_gc_bš
;

88 
tÿche_bš_t
 
	mtbšs
[1];

98 
	stÿches_s
 {

100 
tÿche_t
 *
	mtÿche
;

101 
tÿches_t
 *
	mÃxt
;

107 #ifdeà
JEMALLOC_H_EXTERNS


109 
boŞ
 
İt_tÿche
;

110 
ssize_t
 
İt_lg_tÿche_max
;

112 
tÿche_bš_šfo_t
 *
tÿche_bš_šfo
;

118 
nhbšs
;

121 
size_t
 
tÿche_maxşass
;

131 
tÿches_t
 *
tÿches
;

133 
size_t
 
tÿche_§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
);

134 
tÿche_ev’t_h¬d
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
);

135 *
tÿche_®loc_sm®l_h¬d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
tÿche_t
 *
tÿche
,

136 
tÿche_bš_t
 *
tbš
, 
szšd_t
 
bššd
, 
boŞ
 *
tÿche_sucûss
);

137 
tÿche_bš_æush_sm®l
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
, 
tÿche_bš_t
 *
tbš
,

138 
szšd_t
 
bššd
, 
»m
);

139 
tÿche_bš_æush_Ïrge
(
tsd_t
 *
tsd
, 
tÿche_bš_t
 *
tbš
, 
szšd_t
 
bššd
,

140 
»m
, 
tÿche_t
 *
tÿche
);

141 
tÿche_¬’a_»assocŸ‹
(
tsdn_t
 *
tsdn
, 
tÿche_t
 *
tÿche
,

142 
¬’a_t
 *
Şd¬’a
,‡»Ç_ˆ*
Ãw¬’a
);

143 
tÿche_t
 *
tÿche_g‘_h¬d
(
tsd_t
 *
tsd
);

144 
tÿche_t
 *
tÿche_ü—‹
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
);

145 
tÿche_ş—nup
(
tsd_t
 *
tsd
);

146 
tÿche_’abËd_ş—nup
(
tsd_t
 *
tsd
);

147 
tÿche_¡©s_m”ge
(
tsdn_t
 *
tsdn
, 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
);

148 
boŞ
 
tÿches_ü—‹
(
tsd_t
 *
tsd
, *
r_šd
);

149 
tÿches_æush
(
tsd_t
 *
tsd
, 
šd
);

150 
tÿches_de¡roy
(
tsd_t
 *
tsd
, 
šd
);

151 
boŞ
 
tÿche_boÙ
(
tsdn_t
 *
tsdn
);

155 #ifdeà
JEMALLOC_H_INLINES


157 #iâdeà
JEMALLOC_ENABLE_INLINE


158 
tÿche_ev’t
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
);

159 
tÿche_æush
();

160 
boŞ
 
tÿche_’abËd_g‘
();

161 
tÿche_t
 *
tÿche_g‘
(
tsd_t
 *
tsd
, 
boŞ
 
ü—‹
);

162 
tÿche_’abËd_£t
(
boŞ
 
’abËd
);

163 *
tÿche_®loc_—sy
(
tÿche_bš_t
 *
tbš
, 
boŞ
 *
tÿche_sucûss
);

164 *
tÿche_®loc_sm®l
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, 
tÿche_t
 *
tÿche
,

165 
size_t
 
size
, 
szšd_t
 
šd
, 
boŞ
 
z”o
, boŞ 
¦ow_·th
);

166 *
tÿche_®loc_Ïrge
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, 
tÿche_t
 *
tÿche
,

167 
size_t
 
size
, 
szšd_t
 
šd
, 
boŞ
 
z”o
, boŞ 
¦ow_·th
);

168 
tÿche_d®loc_sm®l
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
, *
±r
,

169 
szšd_t
 
bššd
, 
boŞ
 
¦ow_·th
);

170 
tÿche_d®loc_Ïrge
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
, *
±r
,

171 
size_t
 
size
, 
boŞ
 
¦ow_·th
);

172 
tÿche_t
 *
tÿches_g‘
(
tsd_t
 *
tsd
, 
šd
);

175 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_TCACHE_C_
))

176 
JEMALLOC_INLINE
 

177 
	$tÿche_æush
()

179 
tsd_t
 *
tsd
;

181 
	`ÿs£¹
(
cÚfig_tÿche
);

183 
tsd
 = 
	`tsd_ãtch
();

184 
	`tÿche_ş—nup
(
tsd
);

185 
	}
}

187 
JEMALLOC_INLINE
 
boŞ


188 
	$tÿche_’abËd_g‘
()

190 
tsd_t
 *
tsd
;

191 
tÿche_’abËd_t
 
tÿche_’abËd
;

193 
	`ÿs£¹
(
cÚfig_tÿche
);

195 
tsd
 = 
	`tsd_ãtch
();

196 
tÿche_’abËd
 = 
	`tsd_tÿche_’abËd_g‘
(
tsd
);

197 ià(
tÿche_’abËd
 =ğ
tÿche_’abËd_deçuÉ
) {

198 
tÿche_’abËd
 = (
tÿche_’abËd_t
)
İt_tÿche
;

199 
	`tsd_tÿche_’abËd_£t
(
tsd
, 
tÿche_’abËd
);

202  ((
boŞ
)
tÿche_’abËd
);

203 
	}
}

205 
JEMALLOC_INLINE
 

206 
	$tÿche_’abËd_£t
(
boŞ
 
’abËd
)

208 
tsd_t
 *
tsd
;

209 
tÿche_’abËd_t
 
tÿche_’abËd
;

211 
	`ÿs£¹
(
cÚfig_tÿche
);

213 
tsd
 = 
	`tsd_ãtch
();

215 
tÿche_’abËd
 = (
tÿche_’abËd_t
)
’abËd
;

216 
	`tsd_tÿche_’abËd_£t
(
tsd
, 
tÿche_’abËd
);

218 ià(!
’abËd
)

219 
	`tÿche_ş—nup
(
tsd
);

220 
	}
}

222 
JEMALLOC_ALWAYS_INLINE
 
tÿche_t
 *

223 
	$tÿche_g‘
(
tsd_t
 *
tsd
, 
boŞ
 
ü—‹
)

225 
tÿche_t
 *
tÿche
;

227 ià(!
cÚfig_tÿche
)

228  (
NULL
);

230 
tÿche
 = 
	`tsd_tÿche_g‘
(
tsd
);

231 ià(!
ü—‹
)

232  (
tÿche
);

233 ià(
	`uÆik–y
(
tÿche
 =ğ
NULL
è&& 
	`tsd_nomš®
(
tsd
)) {

234 
tÿche
 = 
	`tÿche_g‘_h¬d
(
tsd
);

235 
	`tsd_tÿche_£t
(
tsd
, 
tÿche
);

238  (
tÿche
);

239 
	}
}

241 
JEMALLOC_ALWAYS_INLINE
 

242 
	$tÿche_ev’t
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
)

245 ià(
TCACHE_GC_INCR
 == 0)

248 ià(
	`uÆik–y
(
	`tick”_tick
(&
tÿche
->
gc_tick”
)))

249 
	`tÿche_ev’t_h¬d
(
tsd
, 
tÿche
);

250 
	}
}

252 
JEMALLOC_ALWAYS_INLINE
 *

253 
	$tÿche_®loc_—sy
(
tÿche_bš_t
 *
tbš
, 
boŞ
 *
tÿche_sucûss
)

255 *
»t
;

257 ià(
	`uÆik–y
(
tbš
->
nÿched
 == 0)) {

258 
tbš
->
low_w©”
 = -1;

259 *
tÿche_sucûss
 = 
çl£
;

260  (
NULL
);

269 *
tÿche_sucûss
 = 
Œue
;

270 
»t
 = *(
tbš
->
ava
 -bš->
nÿched
);

271 
tbš
->
nÿched
--;

273 ià(
	`uÆik–y
(()
tbš
->
nÿched
 <bš->
low_w©”
))

274 
tbš
->
low_w©”
 =bš->
nÿched
;

276  (
»t
);

277 
	}
}

279 
JEMALLOC_ALWAYS_INLINE
 *

280 
	$tÿche_®loc_sm®l
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, 
tÿche_t
 *
tÿche
, 
size_t
 
size
,

281 
szšd_t
 
bššd
, 
boŞ
 
z”o
, boŞ 
¦ow_·th
)

283 *
»t
;

284 
tÿche_bš_t
 *
tbš
;

285 
boŞ
 
tÿche_sucûss
;

286 
size_t
 
usize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

288 
	`as£¹
(
bššd
 < 
NBINS
);

289 
tbš
 = &
tÿche
->
tbšs
[
bššd
];

290 
»t
 = 
	`tÿche_®loc_—sy
(
tbš
, &
tÿche_sucûss
);

291 
	`as£¹
(
tÿche_sucûss
 =ğ(
»t
 !ğ
NULL
));

292 ià(
	`uÆik–y
(!
tÿche_sucûss
)) {

293 
boŞ
 
tÿche_h¬d_sucûss
;

294 
¬’a
 = 
	`¬’a_choo£
(
tsd
,‡rena);

295 ià(
	`uÆik–y
(
¬’a
 =ğ
NULL
))

296  (
NULL
);

298 
»t
 = 
	`tÿche_®loc_sm®l_h¬d
(
	`tsd_tsdn
(
tsd
), 
¬’a
, 
tÿche
,

299 
tbš
, 
bššd
, &
tÿche_h¬d_sucûss
);

300 ià(
tÿche_h¬d_sucûss
 =ğ
çl£
)

301  (
NULL
);

304 
	`as£¹
(
»t
);

309 ià(
cÚfig_´of
 || (
¦ow_·th
 && 
cÚfig_fl
è|| 
	`uÆik–y
(
z”o
)) {

310 
usize
 = 
	`šdex2size
(
bššd
);

311 
	`as£¹
(
	`tÿche_§Îoc
(
	`tsd_tsdn
(
tsd
), 
»t
è=ğ
usize
);

314 ià(
	`lik–y
(!
z”o
)) {

315 ià(
¦ow_·th
 && 
cÚfig_fl
) {

316 ià(
	`uÆik–y
(
İt_junk_®loc
)) {

317 
	`¬’a_®loc_junk_sm®l
(
»t
,

318 &
¬’a_bš_šfo
[
bššd
], 
çl£
);

319 } ià(
	`uÆik–y
(
İt_z”o
))

320 
	`mem£t
(
»t
, 0, 
usize
);

323 ià(
¦ow_·th
 && 
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_®loc
)) {

324 
	`¬’a_®loc_junk_sm®l
(
»t
, &
¬’a_bš_šfo
[
bššd
],

325 
Œue
);

327 
	`mem£t
(
»t
, 0, 
usize
);

330 ià(
cÚfig_¡©s
)

331 
tbš
->
t¡©s
.
Äeque¡s
++;

332 ià(
cÚfig_´of
)

333 
tÿche
->
´of_accumby‹s
 +ğ
usize
;

334 
	`tÿche_ev’t
(
tsd
, 
tÿche
);

335  (
»t
);

336 
	}
}

338 
JEMALLOC_ALWAYS_INLINE
 *

339 
	$tÿche_®loc_Ïrge
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, 
tÿche_t
 *
tÿche
, 
size_t
 
size
,

340 
szšd_t
 
bššd
, 
boŞ
 
z”o
, boŞ 
¦ow_·th
)

342 *
»t
;

343 
tÿche_bš_t
 *
tbš
;

344 
boŞ
 
tÿche_sucûss
;

346 
	`as£¹
(
bššd
 < 
nhbšs
);

347 
tbš
 = &
tÿche
->
tbšs
[
bššd
];

348 
»t
 = 
	`tÿche_®loc_—sy
(
tbš
, &
tÿche_sucûss
);

349 
	`as£¹
(
tÿche_sucûss
 =ğ(
»t
 !ğ
NULL
));

350 ià(
	`uÆik–y
(!
tÿche_sucûss
)) {

355 
¬’a
 = 
	`¬’a_choo£
(
tsd
,‡rena);

356 ià(
	`uÆik–y
(
¬’a
 =ğ
NULL
))

357  (
NULL
);

359 
»t
 = 
	`¬’a_m®loc_Ïrge
(
	`tsd_tsdn
(
tsd
), 
¬’a
, 
bššd
, 
z”o
);

360 ià(
»t
 =ğ
NULL
)

361  (
NULL
);

363 
size_t
 
usize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

366 ià(
cÚfig_´of
 || (
¦ow_·th
 && 
cÚfig_fl
) ||

367 
	`uÆik–y
(
z”o
)) {

368 
usize
 = 
	`šdex2size
(
bššd
);

369 
	`as£¹
(
usize
 <ğ
tÿche_maxşass
);

372 ià(
cÚfig_´of
 && 
usize
 =ğ
LARGE_MINCLASS
) {

373 
¬’a_chunk_t
 *
chunk
 =

374 (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
»t
);

375 
size_t
 
·gešd
 = (((
ušŒ_t
)
»t
 - (ušŒ_t)
chunk
) >>

376 
LG_PAGE
);

377 
	`¬’a_m­b™s_Ïrge_bššd_£t
(
chunk
, 
·gešd
,

378 
BININD_INVALID
);

380 ià(
	`lik–y
(!
z”o
)) {

381 ià(
¦ow_·th
 && 
cÚfig_fl
) {

382 ià(
	`uÆik–y
(
İt_junk_®loc
)) {

383 
	`mem£t
(
»t
, 
JEMALLOC_ALLOC_JUNK
,

384 
usize
);

385 } ià(
	`uÆik–y
(
İt_z”o
))

386 
	`mem£t
(
»t
, 0, 
usize
);

389 
	`mem£t
(
»t
, 0, 
usize
);

391 ià(
cÚfig_¡©s
)

392 
tbš
->
t¡©s
.
Äeque¡s
++;

393 ià(
cÚfig_´of
)

394 
tÿche
->
´of_accumby‹s
 +ğ
usize
;

397 
	`tÿche_ev’t
(
tsd
, 
tÿche
);

398  (
»t
);

399 
	}
}

401 
JEMALLOC_ALWAYS_INLINE
 

402 
	$tÿche_d®loc_sm®l
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
, *
±r
, 
szšd_t
 
bššd
,

403 
boŞ
 
¦ow_·th
)

405 
tÿche_bš_t
 *
tbš
;

406 
tÿche_bš_šfo_t
 *
tbš_šfo
;

408 
	`as£¹
(
	`tÿche_§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
è<ğ
SMALL_MAXCLASS
);

410 ià(
¦ow_·th
 && 
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_ä“
))

411 
	`¬’a_d®loc_junk_sm®l
(
±r
, &
¬’a_bš_šfo
[
bššd
]);

413 
tbš
 = &
tÿche
->
tbšs
[
bššd
];

414 
tbš_šfo
 = &
tÿche_bš_šfo
[
bššd
];

415 ià(
	`uÆik–y
(
tbš
->
nÿched
 =ğ
tbš_šfo
->
nÿched_max
)) {

416 
	`tÿche_bš_æush_sm®l
(
tsd
, 
tÿche
, 
tbš
, 
bššd
,

417 (
tbš_šfo
->
nÿched_max
 >> 1));

419 
	`as£¹
(
tbš
->
nÿched
 < 
tbš_šfo
->
nÿched_max
);

420 
tbš
->
nÿched
++;

421 *(
tbš
->
ava
 -bš->
nÿched
èğ
±r
;

423 
	`tÿche_ev’t
(
tsd
, 
tÿche
);

424 
	}
}

426 
JEMALLOC_ALWAYS_INLINE
 

427 
	$tÿche_d®loc_Ïrge
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
, *
±r
, 
size_t
 
size
,

428 
boŞ
 
¦ow_·th
)

430 
szšd_t
 
bššd
;

431 
tÿche_bš_t
 *
tbš
;

432 
tÿche_bš_šfo_t
 *
tbš_šfo
;

434 
	`as£¹
((
size
 & 
PAGE_MASK
) == 0);

435 
	`as£¹
(
	`tÿche_§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
è> 
SMALL_MAXCLASS
);

436 
	`as£¹
(
	`tÿche_§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
è<ğ
tÿche_maxşass
);

438 
bššd
 = 
	`size2šdex
(
size
);

440 ià(
¦ow_·th
 && 
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_ä“
))

441 
	`¬’a_d®loc_junk_Ïrge
(
±r
, 
size
);

443 
tbš
 = &
tÿche
->
tbšs
[
bššd
];

444 
tbš_šfo
 = &
tÿche_bš_šfo
[
bššd
];

445 ià(
	`uÆik–y
(
tbš
->
nÿched
 =ğ
tbš_šfo
->
nÿched_max
)) {

446 
	`tÿche_bš_æush_Ïrge
(
tsd
, 
tbš
, 
bššd
,

447 (
tbš_šfo
->
nÿched_max
 >> 1), 
tÿche
);

449 
	`as£¹
(
tbš
->
nÿched
 < 
tbš_šfo
->
nÿched_max
);

450 
tbš
->
nÿched
++;

451 *(
tbš
->
ava
 -bš->
nÿched
èğ
±r
;

453 
	`tÿche_ev’t
(
tsd
, 
tÿche
);

454 
	}
}

456 
JEMALLOC_ALWAYS_INLINE
 
tÿche_t
 *

457 
	$tÿches_g‘
(
tsd_t
 *
tsd
, 
šd
)

459 
tÿches_t
 *
–m
 = &
tÿches
[
šd
];

460 ià(
	`uÆik–y
(
–m
->
tÿche
 =ğ
NULL
)) {

461 
–m
->
tÿche
 = 
	`tÿche_ü—‹
(
	`tsd_tsdn
(
tsd
), 
	`¬’a_choo£
(tsd,

462 
NULL
));

464  (
–m
->
tÿche
);

465 
	}
}

	@deps/jemalloc/include/jemalloc/internal/ticker.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
tick”_s
 
	ttick”_t
;

8 #ifdeà
JEMALLOC_H_STRUCTS


10 
	stick”_s
 {

11 
št32_t
 
	mtick
;

12 
št32_t
 
	mÁicks
;

17 #ifdeà
JEMALLOC_H_EXTERNS


21 #ifdeà
JEMALLOC_H_INLINES


23 #iâdeà
JEMALLOC_ENABLE_INLINE


24 
tick”_š™
(
tick”_t
 *
tick”
, 
št32_t
 
Áicks
);

25 
tick”_cİy
(
tick”_t
 *
tick”
, cÚ¡ick”_ˆ*
Ùh”
);

26 
št32_t
 
tick”_»ad
(cÚ¡ 
tick”_t
 *
tick”
);

27 
boŞ
 
tick”_ticks
(
tick”_t
 *
tick”
, 
št32_t
 
Áicks
);

28 
boŞ
 
tick”_tick
(
tick”_t
 *
tick”
);

31 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_TICKER_C_
))

32 
JEMALLOC_INLINE
 

33 
	$tick”_š™
(
tick”_t
 *
tick”
, 
št32_t
 
Áicks
)

36 
tick”
->
tick
 = 
Áicks
;

37 
tick”
->
Áicks
 =‚ticks;

38 
	}
}

40 
JEMALLOC_INLINE
 

41 
	$tick”_cİy
(
tick”_t
 *
tick”
, cÚ¡ick”_ˆ*
Ùh”
)

44 *
tick”
 = *
Ùh”
;

45 
	}
}

47 
JEMALLOC_INLINE
 
št32_t


48 
	$tick”_»ad
(cÚ¡ 
tick”_t
 *
tick”
)

51  (
tick”
->
tick
);

52 
	}
}

54 
JEMALLOC_INLINE
 
boŞ


55 
	$tick”_ticks
(
tick”_t
 *
tick”
, 
št32_t
 
Áicks
)

58 ià(
	`uÆik–y
(
tick”
->
tick
 < 
Áicks
)) {

59 
tick”
->
tick
 =ick”->
Áicks
;

60  (
Œue
);

62 
tick”
->
tick
 -ğ
Áicks
;

63 (
çl£
);

64 
	}
}

66 
JEMALLOC_INLINE
 
boŞ


67 
	$tick”_tick
(
tick”_t
 *
tick”
)

70  (
	`tick”_ticks
(
tick”
, 1));

71 
	}
}

	@deps/jemalloc/include/jemalloc/internal/tsd.h

2 #ifdeà
JEMALLOC_H_TYPES


5 
	#MALLOC_TSD_CLEANUPS_MAX
 2

	)

7 
	$boŞ
 (*
	tm®loc_tsd_ş—nup_t
)();

9 #ià(!
	`defšed
(
JEMALLOC_MALLOC_THREAD_CLEANUP
è&& !defšed(
JEMALLOC_TLS
) && \

10 !
	$defšed
(
_WIN32
))

11 
tsd_š™_block_s
 
	ttsd_š™_block_t
;

12 
tsd_š™_h—d_s
 
	ttsd_š™_h—d_t
;

15 
tsd_s
 
	ttsd_t
;

16 
tsdn_s
 
	ttsdn_t
;

18 
	#TSDN_NULL
 ((
tsdn_t
 *)0)

	)

21 
tsd_¡©e_unš™Ÿlized
,

22 
tsd_¡©e_nomš®
,

23 
tsd_¡©e_purg©Üy
,

24 
tsd_¡©e_»šÿº©ed


25 } 
	ttsd_¡©e_t
;

79 #ifdeà
JEMALLOC_MALLOC_THREAD_CLEANUP


80 
	#m®loc_tsd_ty³s
(
a_Çme
, 
a_ty³
)

	)

81 #–ià(
	`defšed
(
JEMALLOC_TLS
))

82 
	#m®loc_tsd_ty³s
(
a_Çme
, 
a_ty³
)

	)

83 #–ià(
	`defšed
(
_WIN32
))

84 
	#m®loc_tsd_ty³s
(
a_Çme
, 
a_ty³
) \

86 
boŞ
 
š™Ÿlized
; \

87 
a_ty³
 
v®
; \

88 } 
	ta_Çme
##
	ttsd_w¿µ”_t
;

	)

90 
	#m®loc_tsd_ty³s
(
a_Çme
, 
a_ty³
) \

92 
boŞ
 
š™Ÿlized
; \

93 
a_ty³
 
v®
; \

94 } 
	ta_Çme
##
	ttsd_w¿µ”_t
;

	)

98 
	#m®loc_tsd_´Ùos
(
a_©Œ
, 
a_Çme
, 
a_ty³
) \

99 
a_©Œ
 
boŞ
 \

100 
a_Çme
##
	`tsd_boÙ0
(); \

101 
a_©Œ
 \

102 
a_Çme
##
	`tsd_boÙ1
(); \

103 
a_©Œ
 
boŞ
 \

104 
a_Çme
##
	`tsd_boÙ
(); \

105 
a_©Œ
 
boŞ
 \

106 
a_Çme
##
	`tsd_boÙed_g‘
(); \

107 
a_©Œ
 
a_ty³
 * \

108 
a_Çme
##
	`tsd_g‘
(
boŞ
 
š™
); \

109 
a_©Œ
 \

110 
a_Çme
##
	`tsd_£t
(
a_ty³
 *
v®
);

	)

113 #ifdeà
JEMALLOC_MALLOC_THREAD_CLEANUP


114 
	#m®loc_tsd_ex‹ºs
(
a_Çme
, 
a_ty³
) \

115 
__th»ad
 
a_ty³
 
a_Çme
##
tsd_s
; \

116 
__th»ad
 
boŞ
 
a_Çme
##
tsd_š™Ÿlized
; \

117 
boŞ
 
a_Çme
##
tsd_boÙed
;

	)

118 #–ià(
	`defšed
(
JEMALLOC_TLS
))

119 
	#m®loc_tsd_ex‹ºs
(
a_Çme
, 
a_ty³
) \

120 
__th»ad
 
a_ty³
 
a_Çme
##
tsd_s
; \

121 
±h»ad_key_t
 
a_Çme
##
tsd_tsd
; \

122 
boŞ
 
a_Çme
##
tsd_boÙed
;

	)

123 #–ià(
	`defšed
(
_WIN32
))

124 
	#m®loc_tsd_ex‹ºs
(
a_Çme
, 
a_ty³
) \

125 
DWORD
 
a_Çme
##
tsd_tsd
; \

126 
a_Çme
##
tsd_w¿µ”_t
‡_Çme##
tsd_boÙ_w¿µ”
; \

127 
boŞ
 
a_Çme
##
tsd_boÙed
;

	)

129 
	#m®loc_tsd_ex‹ºs
(
a_Çme
, 
a_ty³
) \

130 
±h»ad_key_t
 
a_Çme
##
tsd_tsd
; \

131 
tsd_š™_h—d_t
 
a_Çme
##
tsd_š™_h—d
; \

132 
a_Çme
##
tsd_w¿µ”_t
‡_Çme##
tsd_boÙ_w¿µ”
; \

133 
boŞ
 
a_Çme
##
tsd_boÙed
;

	)

137 #ifdeà
JEMALLOC_MALLOC_THREAD_CLEANUP


138 
	#m®loc_tsd_d©a
(
a_©Œ
, 
a_Çme
, 
a_ty³
, 
a_š™Ÿliz”
) \

139 
a_©Œ
 
__th»ad
 
a_ty³
 
JEMALLOC_TLS_MODEL
 \

140 
a_Çme
##
tsd_s
 = 
a_š™Ÿliz”
; \

141 
a_©Œ
 
__th»ad
 
boŞ
 
JEMALLOC_TLS_MODEL
 \

142 
a_Çme
##
tsd_š™Ÿlized
 = 
çl£
; \

143 
a_©Œ
 
boŞ
 
a_Çme
##
tsd_boÙed
 = 
çl£
;

	)

144 #–ià(
	`defšed
(
JEMALLOC_TLS
))

145 
	#m®loc_tsd_d©a
(
a_©Œ
, 
a_Çme
, 
a_ty³
, 
a_š™Ÿliz”
) \

146 
a_©Œ
 
__th»ad
 
a_ty³
 
JEMALLOC_TLS_MODEL
 \

147 
a_Çme
##
tsd_s
 = 
a_š™Ÿliz”
; \

148 
a_©Œ
 
±h»ad_key_t
 
a_Çme
##
tsd_tsd
; \

149 
a_©Œ
 
boŞ
 
a_Çme
##
tsd_boÙed
 = 
çl£
;

	)

150 #–ià(
	`defšed
(
_WIN32
))

151 
	#m®loc_tsd_d©a
(
a_©Œ
, 
a_Çme
, 
a_ty³
, 
a_š™Ÿliz”
) \

152 
a_©Œ
 
DWORD
 
a_Çme
##
tsd_tsd
; \

153 
a_©Œ
 
a_Çme
##
tsd_w¿µ”_t
‡_Çme##
tsd_boÙ_w¿µ”
 = { \

154 
çl£
, \

155 
a_š™Ÿliz”
 \

156 
	}
}; \

157 
a_©Œ
 
boŞ
 
a_Çme
##
tsd_boÙed
 = 
çl£
;

	)

159 
	#m®loc_tsd_d©a
(
a_©Œ
, 
a_Çme
, 
a_ty³
, 
a_š™Ÿliz”
) \

160 
a_©Œ
 
±h»ad_key_t
 
a_Çme
##
tsd_tsd
; \

161 
a_©Œ
 
tsd_š™_h—d_t
 
a_Çme
##
tsd_š™_h—d
 = { \

162 
	`ql_h—d_š™Ÿliz”
(
blocks
), \

163 
MALLOC_MUTEX_INITIALIZER
 \

165 
a_©Œ
 
a_Çme
##
tsd_w¿µ”_t
‡_Çme##
tsd_boÙ_w¿µ”
 = { \

166 
çl£
, \

167 
a_š™Ÿliz”
 \

169 
a_©Œ
 
boŞ
 
a_Çme
##
tsd_boÙed
 = 
çl£
;

	)

173 #ifdeà
JEMALLOC_MALLOC_THREAD_CLEANUP


174 
	#m®loc_tsd_funcs
(
a_©Œ
, 
a_Çme
, 
a_ty³
, 
a_š™Ÿliz”
, \

175 
a_ş—nup
) \

177 
a_©Œ
 
boŞ
 \

178 
a_Çme
##
	`tsd_ş—nup_w¿µ”
() \

181 ià(
a_Çme
##
tsd_š™Ÿlized
) { \

182 
a_Çme
##
tsd_š™Ÿlized
 = 
çl£
; \

183 
	`a_ş—nup
(&
a_Çme
##
tsd_s
); \

185  (
a_Çme
##
tsd_š™Ÿlized
); \

187 
a_©Œ
 
boŞ
 \

188 
a_Çme
##
	`tsd_boÙ0
() \

191 ià(
a_ş—nup
 !ğ
m®loc_tsd_no_ş—nup
) { \

192 
	`m®loc_tsd_ş—nup_»gi¡”
( \

193 &
a_Çme
##
tsd_ş—nup_w¿µ”
); \

195 
a_Çme
##
tsd_boÙed
 = 
Œue
; \

196  (
çl£
); \

198 
a_©Œ
 \

199 
a_Çme
##
	`tsd_boÙ1
() \

204 
a_©Œ
 
boŞ
 \

205 
a_Çme
##
	`tsd_boÙ
() \

208  (
a_Çme
##
	`tsd_boÙ0
()); \

210 
a_©Œ
 
boŞ
 \

211 
a_Çme
##
	`tsd_boÙed_g‘
() \

214  (
a_Çme
##
tsd_boÙed
); \

216 
a_©Œ
 
boŞ
 \

217 
a_Çme
##
	`tsd_g‘_®loÿ‹s
() \

220  (
çl£
); \

223 
a_©Œ
 
a_ty³
 * \

224 
a_Çme
##
	`tsd_g‘
(
boŞ
 
š™
) \

227 
	`as£¹
(
a_Çme
##
tsd_boÙed
); \

228  (&
a_Çme
##
tsd_s
); \

230 
a_©Œ
 \

231 
a_Çme
##
	`tsd_£t
(
a_ty³
 *
v®
) \

234 
	`as£¹
(
a_Çme
##
tsd_boÙed
); \

235 
a_Çme
##
tsd_s
 = (*
v®
); \

236 ià(
a_ş—nup
 !ğ
m®loc_tsd_no_ş—nup
) \

237 
a_Çme
##
tsd_š™Ÿlized
 = 
Œue
; \

238 }

	)

239 #–ià(
defšed
(
JEMALLOC_TLS
))

240 
	#m®loc_tsd_funcs
(
a_©Œ
, 
a_Çme
, 
a_ty³
, 
a_š™Ÿliz”
, \

241 
a_ş—nup
) \

243 
a_©Œ
 
boŞ
 \

244 
a_Çme
##
	`tsd_boÙ0
() \

247 ià(
a_ş—nup
 !ğ
m®loc_tsd_no_ş—nup
) { \

248 ià(
	`±h»ad_key_ü—‹
(&
a_Çme
##
tsd_tsd
, 
a_ş—nup
) != \

250  (
Œue
); \

252 
a_Çme
##
tsd_boÙed
 = 
Œue
; \

253  (
çl£
); \

255 
a_©Œ
 \

256 
a_Çme
##
	`tsd_boÙ1
() \

261 
a_©Œ
 
boŞ
 \

262 
a_Çme
##
	`tsd_boÙ
() \

265  (
a_Çme
##
	`tsd_boÙ0
()); \

267 
a_©Œ
 
boŞ
 \

268 
a_Çme
##
	`tsd_boÙed_g‘
() \

271  (
a_Çme
##
tsd_boÙed
); \

273 
a_©Œ
 
boŞ
 \

274 
a_Çme
##
	`tsd_g‘_®loÿ‹s
() \

277  (
çl£
); \

280 
a_©Œ
 
a_ty³
 * \

281 
a_Çme
##
	`tsd_g‘
(
boŞ
 
š™
) \

284 
	`as£¹
(
a_Çme
##
tsd_boÙed
); \

285  (&
a_Çme
##
tsd_s
); \

287 
a_©Œ
 \

288 
a_Çme
##
	`tsd_£t
(
a_ty³
 *
v®
) \

291 
	`as£¹
(
a_Çme
##
tsd_boÙed
); \

292 
a_Çme
##
tsd_s
 = (*
v®
); \

293 ià(
a_ş—nup
 !ğ
m®loc_tsd_no_ş—nup
) { \

294 ià(
	`±h»ad_£t¥ecific
(
a_Çme
##
tsd_tsd
, \

295 (*)(&
a_Çme
##
tsd_s
))) { \

296 
	`m®loc_wr™e
("<jemalloc>: Error" \

298 ià(
İt_abÜt
) \

299 
	`abÜt
(); \

302 }

	)

303 #–ià(
defšed
(
_WIN32
))

304 
	#m®loc_tsd_funcs
(
a_©Œ
, 
a_Çme
, 
a_ty³
, 
a_š™Ÿliz”
, \

305 
a_ş—nup
) \

307 
a_©Œ
 
boŞ
 \

308 
a_Çme
##
	`tsd_ş—nup_w¿µ”
() \

310 
DWORD
 
”rÜ
 = 
	`G‘La¡E¼Ü
(); \

311 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
 = (a_name##tsd_wrapper_t *) \

312 
	`TlsG‘V®ue
(
a_Çme
##
tsd_tsd
); \

313 
	`S‘La¡E¼Ü
(
”rÜ
); \

315 ià(
w¿µ”
 =ğ
NULL
) \

316  (
çl£
); \

317 ià(
a_ş—nup
 !ğ
m®loc_tsd_no_ş—nup
 && \

318 
w¿µ”
->
š™Ÿlized
) { \

319 
w¿µ”
->
š™Ÿlized
 = 
çl£
; \

320 
	`a_ş—nup
(&
w¿µ”
->
v®
); \

321 ià(
w¿µ”
->
š™Ÿlized
) { \

323  (
Œue
); \

326 
	`m®loc_tsd_d®loc
(
w¿µ”
); \

327  (
çl£
); \

329 
a_©Œ
 \

330 
a_Çme
##
	`tsd_w¿µ”_£t
×_Çme##
tsd_w¿µ”_t
 *
w¿µ”
) \

333 ià(!
	`TlsS‘V®ue
(
a_Çme
##
tsd_tsd
, (*)
w¿µ”
)) { \

334 
	`m®loc_wr™e
("<jemalloc>: Error setting" \

336 
	`abÜt
(); \

339 
a_©Œ
 
a_Çme
##
tsd_w¿µ”_t
 * \

340 
a_Çme
##
	`tsd_w¿µ”_g‘
(
boŞ
 
š™
) \

342 
DWORD
 
”rÜ
 = 
	`G‘La¡E¼Ü
(); \

343 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
 = (a_name##tsd_wrapper_t *) \

344 
	`TlsG‘V®ue
(
a_Çme
##
tsd_tsd
); \

345 
	`S‘La¡E¼Ü
(
”rÜ
); \

347 ià(
š™
 && 
	`uÆik–y
(
w¿µ”
 =ğ
NULL
)) { \

348 
w¿µ”
 = (
a_Çme
##
tsd_w¿µ”_t
 *) \

349 
	`m®loc_tsd_m®loc
((
a_Çme
##
tsd_w¿µ”_t
)); \

350 ià(
w¿µ”
 =ğ
NULL
) { \

351 
	`m®loc_wr™e
("<jemalloc>: Error‡llocating" \

353 
	`abÜt
(); \

355 
w¿µ”
->
š™Ÿlized
 = 
çl£
; \

356 
w¿µ”
->
v®
 = 
a_š™Ÿliz”
; \

358 
a_Çme
##
	`tsd_w¿µ”_£t
(
w¿µ”
); \

360  (
w¿µ”
); \

362 
a_©Œ
 
boŞ
 \

363 
a_Çme
##
	`tsd_boÙ0
() \

366 
a_Çme
##
tsd_tsd
 = 
	`TlsAÎoc
(); \

367 ià(
a_Çme
##
tsd_tsd
 =ğ
TLS_OUT_OF_INDEXES
) \

368  (
Œue
); \

369 ià(
a_ş—nup
 !ğ
m®loc_tsd_no_ş—nup
) { \

370 
	`m®loc_tsd_ş—nup_»gi¡”
( \

371 &
a_Çme
##
tsd_ş—nup_w¿µ”
); \

373 
a_Çme
##
	`tsd_w¿µ”_£t
(&a_Çme##
tsd_boÙ_w¿µ”
); \

374 
a_Çme
##
tsd_boÙed
 = 
Œue
; \

375  (
çl£
); \

377 
a_©Œ
 \

378 
a_Çme
##
	`tsd_boÙ1
() \

380 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
; \

381 
w¿µ”
 = (
a_Çme
##
tsd_w¿µ”_t
 *) \

382 
	`m®loc_tsd_m®loc
((
a_Çme
##
tsd_w¿µ”_t
)); \

383 ià(
w¿µ”
 =ğ
NULL
) { \

384 
	`m®loc_wr™e
("<jemalloc>: Error‡llocating" \

386 
	`abÜt
(); \

388 
	`memıy
(
w¿µ”
, &
a_Çme
##
tsd_boÙ_w¿µ”
, \

389 (
a_Çme
##
tsd_w¿µ”_t
)); \

390 
a_Çme
##
	`tsd_w¿µ”_£t
(
w¿µ”
); \

392 
a_©Œ
 
boŞ
 \

393 
a_Çme
##
	`tsd_boÙ
() \

396 ià(
a_Çme
##
	`tsd_boÙ0
()) \

397  (
Œue
); \

398 
a_Çme
##
	`tsd_boÙ1
(); \

399  (
çl£
); \

401 
a_©Œ
 
boŞ
 \

402 
a_Çme
##
	`tsd_boÙed_g‘
() \

405  (
a_Çme
##
tsd_boÙed
); \

407 
a_©Œ
 
boŞ
 \

408 
a_Çme
##
	`tsd_g‘_®loÿ‹s
() \

411  (
Œue
); \

414 
a_©Œ
 
a_ty³
 * \

415 
a_Çme
##
	`tsd_g‘
(
boŞ
 
š™
) \

417 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
; \

419 
	`as£¹
(
a_Çme
##
tsd_boÙed
); \

420 
w¿µ”
 = 
a_Çme
##
	`tsd_w¿µ”_g‘
(
š™
); \

421 ià(
a_Çme
##
	`tsd_g‘_®loÿ‹s
(è&& !
š™
 && 
w¿µ”
 =ğ
NULL
) \

422  (
NULL
); \

423  (&
w¿µ”
->
v®
); \

425 
a_©Œ
 \

426 
a_Çme
##
	`tsd_£t
(
a_ty³
 *
v®
) \

428 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
; \

430 
	`as£¹
(
a_Çme
##
tsd_boÙed
); \

431 
w¿µ”
 = 
a_Çme
##
	`tsd_w¿µ”_g‘
(
Œue
); \

432 
w¿µ”
->
v®
 = *(val); \

433 ià(
a_ş—nup
 !ğ
m®loc_tsd_no_ş—nup
) \

434 
w¿µ”
->
š™Ÿlized
 = 
Œue
; \

435 }

	)

437 
	#m®loc_tsd_funcs
(
a_©Œ
, 
a_Çme
, 
a_ty³
, 
a_š™Ÿliz”
, \

438 
a_ş—nup
) \

440 
a_©Œ
 \

441 
a_Çme
##
	`tsd_ş—nup_w¿µ”
(*
¬g
) \

443 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
 = (a_Çme##tsd_w¿µ”_ˆ*)
¬g
; \

445 ià(
a_ş—nup
 !ğ
m®loc_tsd_no_ş—nup
 && \

446 
w¿µ”
->
š™Ÿlized
) { \

447 
w¿µ”
->
š™Ÿlized
 = 
çl£
; \

448 
	`a_ş—nup
(&
w¿µ”
->
v®
); \

449 ià(
w¿µ”
->
š™Ÿlized
) { \

451 ià(
	`±h»ad_£t¥ecific
(
a_Çme
##
tsd_tsd
, \

452 (*)
w¿µ”
)) { \

453 
	`m®loc_wr™e
("<jemalloc>: Error" \

455 ià(
İt_abÜt
) \

456 
	`abÜt
(); \

461 
	`m®loc_tsd_d®loc
(
w¿µ”
); \

463 
a_©Œ
 \

464 
a_Çme
##
	`tsd_w¿µ”_£t
×_Çme##
tsd_w¿µ”_t
 *
w¿µ”
) \

467 ià(
	`±h»ad_£t¥ecific
(
a_Çme
##
tsd_tsd
, \

468 (*)
w¿µ”
)) { \

469 
	`m®loc_wr™e
("<jemalloc>: Error setting" \

471 
	`abÜt
(); \

474 
a_©Œ
 
a_Çme
##
tsd_w¿µ”_t
 * \

475 
a_Çme
##
	`tsd_w¿µ”_g‘
(
boŞ
 
š™
) \

477 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
 = (a_name##tsd_wrapper_t *) \

478 
	`±h»ad_g‘¥ecific
(
a_Çme
##
tsd_tsd
); \

480 ià(
š™
 && 
	`uÆik–y
(
w¿µ”
 =ğ
NULL
)) { \

481 
tsd_š™_block_t
 
block
; \

482 
w¿µ”
 = 
	`tsd_š™_check_»cursiÚ
( \

483 &
a_Çme
##
tsd_š™_h—d
, &
block
); \

484 ià(
w¿µ”
) \

485  (
w¿µ”
); \

486 
w¿µ”
 = (
a_Çme
##
tsd_w¿µ”_t
 *) \

487 
	`m®loc_tsd_m®loc
((
a_Çme
##
tsd_w¿µ”_t
)); \

488 
block
.
d©a
 = 
w¿µ”
; \

489 ià(
w¿µ”
 =ğ
NULL
) { \

490 
	`m®loc_wr™e
("<jemalloc>: Error‡llocating" \

492 
	`abÜt
(); \

494 
w¿µ”
->
š™Ÿlized
 = 
çl£
; \

495 
w¿µ”
->
v®
 = 
a_š™Ÿliz”
; \

497 
a_Çme
##
	`tsd_w¿µ”_£t
(
w¿µ”
); \

498 
	`tsd_š™_fšish
(&
a_Çme
##
tsd_š™_h—d
, &
block
); \

500  (
w¿µ”
); \

502 
a_©Œ
 
boŞ
 \

503 
a_Çme
##
	`tsd_boÙ0
() \

506 ià(
	`±h»ad_key_ü—‹
(&
a_Çme
##
tsd_tsd
, \

507 
a_Çme
##
tsd_ş—nup_w¿µ”
) != 0) \

508  (
Œue
); \

509 
a_Çme
##
	`tsd_w¿µ”_£t
(&a_Çme##
tsd_boÙ_w¿µ”
); \

510 
a_Çme
##
tsd_boÙed
 = 
Œue
; \

511  (
çl£
); \

513 
a_©Œ
 \

514 
a_Çme
##
	`tsd_boÙ1
() \

516 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
; \

517 
w¿µ”
 = (
a_Çme
##
tsd_w¿µ”_t
 *) \

518 
	`m®loc_tsd_m®loc
((
a_Çme
##
tsd_w¿µ”_t
)); \

519 ià(
w¿µ”
 =ğ
NULL
) { \

520 
	`m®loc_wr™e
("<jemalloc>: Error‡llocating" \

522 
	`abÜt
(); \

524 
	`memıy
(
w¿µ”
, &
a_Çme
##
tsd_boÙ_w¿µ”
, \

525 (
a_Çme
##
tsd_w¿µ”_t
)); \

526 
a_Çme
##
	`tsd_w¿µ”_£t
(
w¿µ”
); \

528 
a_©Œ
 
boŞ
 \

529 
a_Çme
##
	`tsd_boÙ
() \

532 ià(
a_Çme
##
	`tsd_boÙ0
()) \

533  (
Œue
); \

534 
a_Çme
##
	`tsd_boÙ1
(); \

535  (
çl£
); \

537 
a_©Œ
 
boŞ
 \

538 
a_Çme
##
	`tsd_boÙed_g‘
() \

541  (
a_Çme
##
tsd_boÙed
); \

543 
a_©Œ
 
boŞ
 \

544 
a_Çme
##
	`tsd_g‘_®loÿ‹s
() \

547  (
Œue
); \

550 
a_©Œ
 
a_ty³
 * \

551 
a_Çme
##
	`tsd_g‘
(
boŞ
 
š™
) \

553 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
; \

555 
	`as£¹
(
a_Çme
##
tsd_boÙed
); \

556 
w¿µ”
 = 
a_Çme
##
	`tsd_w¿µ”_g‘
(
š™
); \

557 ià(
a_Çme
##
	`tsd_g‘_®loÿ‹s
(è&& !
š™
 && 
w¿µ”
 =ğ
NULL
) \

558  (
NULL
); \

559  (&
w¿µ”
->
v®
); \

561 
a_©Œ
 \

562 
a_Çme
##
	`tsd_£t
(
a_ty³
 *
v®
) \

564 
a_Çme
##
tsd_w¿µ”_t
 *
w¿µ”
; \

566 
	`as£¹
(
a_Çme
##
tsd_boÙed
); \

567 
w¿µ”
 = 
a_Çme
##
	`tsd_w¿µ”_g‘
(
Œue
); \

568 
w¿µ”
->
v®
 = *(val); \

569 ià(
a_ş—nup
 !ğ
m®loc_tsd_no_ş—nup
) \

570 
w¿µ”
->
š™Ÿlized
 = 
Œue
; \

571 }

	)

576 #ifdeà
JEMALLOC_H_STRUCTS


578 #ià(!
defšed
(
JEMALLOC_MALLOC_THREAD_CLEANUP
è&& !defšed(
JEMALLOC_TLS
) && \

579 !
	$defšed
(
_WIN32
))

580 
	stsd_š™_block_s
 {

581 
	`ql_–m
(
tsd_š™_block_t
è
lšk
;

582 
±h»ad_t
 
th»ad
;

583 *
d©a
;

585 
	stsd_š™_h—d_s
 {

586 
	`ql_h—d
(
tsd_š™_block_t
è
blocks
;

587 
m®loc_mu‹x_t
 
lock
;

591 
	#MALLOC_TSD
 \

593 
	`O
(
tÿche
, 
tÿche_t
 *) \

594 
	`O
(
th»ad_®loÿ‹d
, 
ušt64_t
) \

595 
	`O
(
th»ad_d—Îoÿ‹d
, 
ušt64_t
) \

596 
	`O
(
´of_td©a
, 
´of_td©a_t
 *) \

597 
	`O
(
Ÿ»Ç
, 
¬’a_t
 *) \

598 
	`O
(
¬’a
, 
¬’a_t
 *) \

599 
	`O
(
¬’as_td©a
, 
¬’a_td©a_t
 *) \

600 
	`O
(
Ç»Çs_td©a
, ) \

601 
	`O
(
¬’as_td©a_by·ss
, 
boŞ
) \

602 
	`O
(
tÿche_’abËd
, 
tÿche_’abËd_t
) \

603 
	`O
(
qu¬ªtše
, 
qu¬ªtše_t
 *) \

604 
	`O
(
w™Ãs£s
, 
w™Ãss_li¡_t
) \

605 
	`O
(
w™Ãss_fÜk
, 
boŞ
) \

606 

	)

607 
	#TSD_INITIALIZER
 { \

608 
tsd_¡©e_unš™Ÿlized
, \

609 
NULL
, \

612 
NULL
, \

613 
NULL
, \

614 
NULL
, \

615 
NULL
, \

617 
çl£
, \

618 
tÿche_’abËd_deçuÉ
, \

619 
NULL
, \

620 
	`ql_h—d_š™Ÿliz”
(
w™Ãs£s
), \

621 
çl£
 \

622 
	}

	)
}

624 
	stsd_s
 {

625 
tsd_¡©e_t
 
	m¡©e
;

626 
	#O
(
n
, 
t
) \

627 
t
 
n
;

	)

628 
	mMALLOC_TSD


629 #undeà
O


637 
	stsdn_s
 {

638 
tsd_t
 
	mtsd
;

641 cÚ¡ 
tsd_t
 
	gtsd_š™Ÿliz”
 = 
TSD_INITIALIZER
;

643 
	$m®loc_tsd_ty³s
(, 
tsd_t
)

647 #ifdeà
JEMALLOC_H_EXTERNS


649 *
	`m®loc_tsd_m®loc
(
size_t
 
size
);

650 
	`m®loc_tsd_d®loc
(*
w¿µ”
);

651 
	`m®loc_tsd_no_ş—nup
(*
¬g
);

652 
	`m®loc_tsd_ş—nup_»gi¡”
(
	$boŞ
 (*
f
)());

653 
tsd_t
 *
	`m®loc_tsd_boÙ0
();

654 
	`m®loc_tsd_boÙ1
();

655 #ià(!
	`defšed
(
JEMALLOC_MALLOC_THREAD_CLEANUP
è&& !defšed(
JEMALLOC_TLS
) && \

656 !
	$defšed
(
_WIN32
))

657 *
	`tsd_š™_check_»cursiÚ
(
tsd_š™_h—d_t
 *
h—d
,

658 
tsd_š™_block_t
 *
block
);

659 
	`tsd_š™_fšish
(
tsd_š™_h—d_t
 *
h—d
, 
tsd_š™_block_t
 *
block
);

661 
	`tsd_ş—nup
(*
¬g
);

665 #ifdeà
JEMALLOC_H_INLINES


667 #iâdeà
JEMALLOC_ENABLE_INLINE


668 
	`m®loc_tsd_´Ùos
(
	`JEMALLOC_ATTR
(
unu£d
), , 
tsd_t
)

670 
tsd_t
 *
	`tsd_ãtch_im¶
(
boŞ
 
š™
);

671 
tsd_t
 *
	`tsd_ãtch
();

672 
tsdn_t
 *
	`tsd_tsdn
(
tsd_t
 *
tsd
);

673 
boŞ
 
	`tsd_nomš®
(
tsd_t
 *
tsd
);

674 
	#O
(
n
, 
t
) \

675 
t
 *
tsd_
##
n
##
	`p_g‘
(
tsd_t
 *
tsd
); \

676 
t
 
tsd_
##
n
##
	`_g‘
(
tsd_t
 *
tsd
); \

677 
tsd_
##
n
##
	`_£t
(
tsd_t
 *
tsd
, 
t
‚);

	)

678 
MALLOC_TSD


679 #undeà
O


680 
tsdn_t
 *
	`tsdn_ãtch
();

681 
boŞ
 
	`tsdn_nuÎ
(cÚ¡ 
tsdn_t
 *
tsdn
);

682 
tsd_t
 *
	`tsdn_tsd
(
tsdn_t
 *
tsdn
);

685 #ià(
	`defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_TSD_C_
))

686 
	$m®loc_tsd_ex‹ºs
(, 
tsd_t
)

687 
	$m®loc_tsd_funcs
(
JEMALLOC_ALWAYS_INLINE
, , 
tsd_t
, 
tsd_š™Ÿliz”
, 
tsd_ş—nup
)

689 
JEMALLOC_ALWAYS_INLINE
 
tsd_t
 *

690 
	$tsd_ãtch_im¶
(
boŞ
 
š™
)

692 
tsd_t
 *
tsd
 = 
	`tsd_g‘
(
š™
);

694 ià(!
š™
 && 
	`tsd_g‘_®loÿ‹s
(è&& 
tsd
 =ğ
NULL
)

695  (
NULL
);

696 
	`as£¹
(
tsd
 !ğ
NULL
);

698 ià(
	`uÆik–y
(
tsd
->
¡©e
 !ğ
tsd_¡©e_nomš®
)) {

699 ià(
tsd
->
¡©e
 =ğ
tsd_¡©e_unš™Ÿlized
) {

700 
tsd
->
¡©e
 = 
tsd_¡©e_nomš®
;

702 
	`tsd_£t
(
tsd
);

703 } ià(
tsd
->
¡©e
 =ğ
tsd_¡©e_purg©Üy
) {

704 
tsd
->
¡©e
 = 
tsd_¡©e_»šÿº©ed
;

705 
	`tsd_£t
(
tsd
);

707 
	`as£¹
(
tsd
->
¡©e
 =ğ
tsd_¡©e_»šÿº©ed
);

710  (
tsd
);

711 
	}
}

713 
JEMALLOC_ALWAYS_INLINE
 
tsd_t
 *

714 
	$tsd_ãtch
()

717  (
	`tsd_ãtch_im¶
(
Œue
));

718 
	}
}

720 
JEMALLOC_ALWAYS_INLINE
 
tsdn_t
 *

721 
	$tsd_tsdn
(
tsd_t
 *
tsd
)

724  ((
tsdn_t
 *)
tsd
);

725 
	}
}

727 
JEMALLOC_INLINE
 
boŞ


728 
	$tsd_nomš®
(
tsd_t
 *
tsd
)

731  (
tsd
->
¡©e
 =ğ
tsd_¡©e_nomš®
);

732 
	}
}

734 
	#O
(
n
, 
t
) \

735 
JEMALLOC_ALWAYS_INLINE
 
t
 * \

736 
tsd_
##
n
##
	`p_g‘
(
tsd_t
 *
tsd
) \

739  (&
tsd
->
n
); \

742 
JEMALLOC_ALWAYS_INLINE
 
t
 \

743 
tsd_
##
n
##
	`_g‘
(
tsd_t
 *
tsd
) \

746  (*
tsd_
##
n
##
	`p_g‘
(
tsd
)); \

749 
JEMALLOC_ALWAYS_INLINE
 \

750 
tsd_
##
n
##
	`_£t
(
tsd_t
 *
tsd
, 
t
‚) \

753 
	`as£¹
(
tsd
->
¡©e
 =ğ
tsd_¡©e_nomš®
); \

754 
tsd
->
n
 =‚; \

755 }

	)

756 
	gMALLOC_TSD


757 #undeà
O


759 
JEMALLOC_ALWAYS_INLINE
 
tsdn_t
 *

760 
	$tsdn_ãtch
()

763 ià(!
	`tsd_boÙed_g‘
())

764  (
NULL
);

766  (
	`tsd_tsdn
(
	`tsd_ãtch_im¶
(
çl£
)));

767 
	}
}

769 
JEMALLOC_ALWAYS_INLINE
 
boŞ


770 
	$tsdn_nuÎ
(cÚ¡ 
tsdn_t
 *
tsdn
)

773  (
tsdn
 =ğ
NULL
);

774 
	}
}

776 
JEMALLOC_ALWAYS_INLINE
 
tsd_t
 *

777 
	$tsdn_tsd
(
tsdn_t
 *
tsdn
)

780 
	`as£¹
(!
	`tsdn_nuÎ
(
tsdn
));

782  (&
tsdn
->
tsd
);

783 
	}
}

	@deps/jemalloc/include/jemalloc/internal/util.h

2 #ifdeà
JEMALLOC_H_TYPES


4 #ifdeà
_WIN32


5 #ifdeà
_WIN64


6 
	#FMT64_PREFIX
 "Î"

	)

7 
	#FMTPTR_PREFIX
 "Î"

	)

9 
	#FMT64_PREFIX
 "Î"

	)

10 
	#FMTPTR_PREFIX
 ""

	)

12 
	#FMTd32
 "d"

	)

13 
	#FMTu32
 "u"

	)

14 
	#FMTx32
 "x"

	)

15 
	#FMTd64
 
FMT64_PREFIX
 "d"

	)

16 
	#FMTu64
 
FMT64_PREFIX
 "u"

	)

17 
	#FMTx64
 
FMT64_PREFIX
 "x"

	)

18 
	#FMTdPTR
 
FMTPTR_PREFIX
 "d"

	)

19 
	#FMTuPTR
 
FMTPTR_PREFIX
 "u"

	)

20 
	#FMTxPTR
 
FMTPTR_PREFIX
 "x"

	)

22 
	~<š‰y³s.h
>

23 
	#FMTd32
 
PRId32


	)

24 
	#FMTu32
 
PRIu32


	)

25 
	#FMTx32
 
PRIx32


	)

26 
	#FMTd64
 
PRId64


	)

27 
	#FMTu64
 
PRIu64


	)

28 
	#FMTx64
 
PRIx64


	)

29 
	#FMTdPTR
 
PRIdPTR


	)

30 
	#FMTuPTR
 
PRIuPTR


	)

31 
	#FMTxPTR
 
PRIxPTR


	)

35 
	#BUFERROR_BUF
 64

	)

41 
	#MALLOC_PRINTF_BUFSIZE
 4096

	)

44 #iâdeà
JEMALLOC_ALLOC_JUNK


45 
	#JEMALLOC_ALLOC_JUNK
 ((
ušt8_t
)0xa5)

	)

47 #iâdeà
JEMALLOC_FREE_JUNK


48 
	#JEMALLOC_FREE_JUNK
 ((
ušt8_t
)0x5a)

	)

55 
	#JEMALLOC_ARG_CONCAT
(...è
__VA_ARGS__


	)

62 #ifdeà
JEMALLOC_CC_SILENCE


63 
	#JEMALLOC_CC_SILENCE_INIT
(
v
èğ
	)
v

65 
	#JEMALLOC_CC_SILENCE_INIT
(
v
)

	)

68 #ifdeà
__GNUC__


69 
	#lik–y
(
x
è
	`__butš_ex³ù
(!!(x), 1)

	)

70 
	#uÆik–y
(
x
è
	`__butš_ex³ù
(!!(x), 0)

	)

72 
	#lik–y
(
x
è!!(x)

	)

73 
	#uÆik–y
(
x
è!!(x)

	)

76 #ià!
defšed
(
JEMALLOC_INTERNAL_UNREACHABLE
)

77 #”rÜ 
JEMALLOC_INTERNAL_UNREACHABLE
 
should
 
have
 
b“n
 
defšed
 
by
 
cÚfigu»


80 
	#uÄ—chabË
(è
	`JEMALLOC_INTERNAL_UNREACHABLE
()

	)

82 
	~"jem®loc/š‹º®/as£¹.h
"

85 
	#ÿs£¹
(
c
) do { \

86 ià(
	`uÆik–y
(!(
c
))) \

87 
	`nÙ_»ached
(); \

88 } 0)

	)

92 #ifdeà
JEMALLOC_H_STRUCTS


96 #ifdeà
JEMALLOC_H_EXTERNS


98 
buã¼Ü
(
”r
, *
buf
, 
size_t
 
buæ’
);

99 
uštmax_t
 
m®loc_¡¹oumax
(cÚ¡ *
»¡riù
 
ÅŒ
,

100 **
»¡riù
 
’d±r
, 
ba£
);

101 
m®loc_wr™e
(cÚ¡ *
s
);

107 
size_t
 
m®loc_v¢´štf
(*
¡r
, size_ˆ
size
, cÚ¡ *
fÜm©
,

108 
va_li¡
 
­
);

109 
size_t
 
	$m®loc_¢´štf
(*
¡r
, 
size_t
 
size
, cÚ¡ *
fÜm©
, ...)

110 
	`JEMALLOC_FORMAT_PRINTF
(3, 4);

111 
	`m®loc_vırštf
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

112 cÚ¡ *
fÜm©
, 
va_li¡
 
­
);

113 
	$m®loc_ırštf
((*
wr™e
)(*, cÚ¡ *), *
cbİaque
,

114 cÚ¡ *
fÜm©
, ...è
	`JEMALLOC_FORMAT_PRINTF
(3, 4);

115 
	$m®loc_´štf
(cÚ¡ *
fÜm©
, ...è
	`JEMALLOC_FORMAT_PRINTF
(1, 2);

119 #ifdeà
JEMALLOC_H_INLINES


121 #iâdeà
JEMALLOC_ENABLE_INLINE


122 
	`ffs_Îu
(
b™m­
);

123 
	`ffs_lu
(
b™m­
);

124 
	`ffs_u
(
b™m­
);

125 
	`ffs_zu
(
size_t
 
b™m­
);

126 
	`ffs_u64
(
ušt64_t
 
b™m­
);

127 
	`ffs_u32
(
ušt32_t
 
b™m­
);

128 
ušt64_t
 
	`pow2_û_u64
(ušt64_ˆ
x
);

129 
ušt32_t
 
	`pow2_û_u32
(ušt32_ˆ
x
);

130 
size_t
 
	`pow2_û_zu
(size_ˆ
x
);

131 
	`lg_æoÜ
(
size_t
 
x
);

132 
	`£t_”ºo
(
”ºum
);

133 
	`g‘_”ºo
();

136 #ià(
	`defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_UTIL_C_
))

139 #ià!
	`defšed
(
JEMALLOC_INTERNAL_FFSLL
è|| !defšed(
JEMALLOC_INTERNAL_FFSL
) \

140 || !
	$defšed
(
JEMALLOC_INTERNAL_FFS
)

141 #”rÜ 
JEMALLOC_INTERNAL_FFS
{,
L
,
LL
} should havb“Àdefšed by cÚfigu»

144 
JEMALLOC_ALWAYS_INLINE
 

145 
	$ffs_Îu
(
b™m­
)

148  (
	`JEMALLOC_INTERNAL_FFSLL
(
b™m­
));

149 
	}
}

151 
JEMALLOC_ALWAYS_INLINE
 

152 
	$ffs_lu
(
b™m­
)

155  (
	`JEMALLOC_INTERNAL_FFSL
(
b™m­
));

156 
	}
}

158 
JEMALLOC_ALWAYS_INLINE
 

159 
	$ffs_u
(
b™m­
)

162  (
	`JEMALLOC_INTERNAL_FFS
(
b™m­
));

163 
	}
}

165 
JEMALLOC_ALWAYS_INLINE
 

166 
	$ffs_zu
(
size_t
 
b™m­
)

169 #ià
LG_SIZEOF_PTR
 =ğ
LG_SIZEOF_INT


170  (
	`ffs_u
(
b™m­
));

171 #–ià
LG_SIZEOF_PTR
 =ğ
LG_SIZEOF_LONG


172  (
	`ffs_lu
(
b™m­
));

173 #–ià
LG_SIZEOF_PTR
 =ğ
LG_SIZEOF_LONG_LONG


174  (
	`ffs_Îu
(
b™m­
));

176 #”rÜ 
No
 
im¶em’tiÚ
 
size_t
 
	`ffs
()

178 
	}
}

180 
JEMALLOC_ALWAYS_INLINE
 

181 
	$ffs_u64
(
ušt64_t
 
b™m­
)

184 #ià
LG_SIZEOF_LONG
 == 3

185  (
	`ffs_lu
(
b™m­
));

186 #–ià
LG_SIZEOF_LONG_LONG
 == 3

187  (
	`ffs_Îu
(
b™m­
));

189 #”rÜ 
No
 
im¶em’tiÚ
 64-
b™
 
	`ffs
()

191 
	}
}

193 
JEMALLOC_ALWAYS_INLINE
 

194 
	$ffs_u32
(
ušt32_t
 
b™m­
)

197 #ià
LG_SIZEOF_INT
 == 2

198  (
	`ffs_u
(
b™m­
));

200 #”rÜ 
No
 
im¶em’tiÚ
 32-
b™
 
	`ffs
()

202  (
	`ffs_u
(
b™m­
));

203 
	}
}

205 
JEMALLOC_INLINE
 
ušt64_t


206 
	$pow2_û_u64
(
ušt64_t
 
x
)

209 
x
--;

210 
x
 |= x >> 1;

211 
x
 |= x >> 2;

212 
x
 |= x >> 4;

213 
x
 |= x >> 8;

214 
x
 |= x >> 16;

215 
x
 |= x >> 32;

216 
x
++;

217  (
x
);

218 
	}
}

220 
JEMALLOC_INLINE
 
ušt32_t


221 
	$pow2_û_u32
(
ušt32_t
 
x
)

224 
x
--;

225 
x
 |= x >> 1;

226 
x
 |= x >> 2;

227 
x
 |= x >> 4;

228 
x
 |= x >> 8;

229 
x
 |= x >> 16;

230 
x
++;

231  (
x
);

232 
	}
}

235 
JEMALLOC_INLINE
 
size_t


236 
	$pow2_û_zu
(
size_t
 
x
)

239 #ià(
LG_SIZEOF_PTR
 == 3)

240  (
	`pow2_û_u64
(
x
));

242  (
	`pow2_û_u32
(
x
));

244 
	}
}

246 #ià(
defšed
(
__i386__
è|| defšed(
__amd64__
è|| defšed(
__x86_64__
))

247 
JEMALLOC_INLINE
 

248 
	$lg_æoÜ
(
size_t
 
x
)

250 
size_t
 
»t
;

252 
	`as£¹
(
x
 != 0);

254 
	`asm
 ("bsr %1, %0"

255 : "ô"(
»t
)

256 : "r"(
x
)

258 
	`as£¹
(
»t
 < 
UINT_MAX
);

259  (()
»t
);

260 
	}
}

261 #–ià(
defšed
(
_MSC_VER
))

262 
JEMALLOC_INLINE
 

263 
	$lg_æoÜ
(
size_t
 
x
)

265 
»t
;

267 
	`as£¹
(
x
 != 0);

269 #ià(
LG_SIZEOF_PTR
 == 3)

270 
	`_B™SÿnRev”£64
(&
»t
, 
x
);

271 #–ià(
LG_SIZEOF_PTR
 == 2)

272 
	`_B™SÿnRev”£
(&
»t
, 
x
);

276 
	`as£¹
(
»t
 < 
UINT_MAX
);

277  (()
»t
);

278 
	}
}

279 #–ià(
defšed
(
JEMALLOC_HAVE_BUILTIN_CLZ
))

280 
JEMALLOC_INLINE
 

281 
	$lg_æoÜ
(
size_t
 
x
)

284 
	`as£¹
(
x
 != 0);

286 #ià(
LG_SIZEOF_PTR
 =ğ
LG_SIZEOF_INT
)

287  (((8 << 
LG_SIZEOF_PTR
è- 1è- 
	`__butš_şz
(
x
));

288 #–ià(
LG_SIZEOF_PTR
 =ğ
LG_SIZEOF_LONG
)

289  (((8 << 
LG_SIZEOF_PTR
è- 1è- 
	`__butš_şzl
(
x
));

293 
	}
}

295 
JEMALLOC_INLINE
 

296 
	$lg_æoÜ
(
size_t
 
x
)

299 
	`as£¹
(
x
 != 0);

301 
x
 |= (x >> 1);

302 
x
 |= (x >> 2);

303 
x
 |= (x >> 4);

304 
x
 |= (x >> 8);

305 
x
 |= (x >> 16);

306 #ià(
LG_SIZEOF_PTR
 == 3)

307 
x
 |= (x >> 32);

309 ià(
x
 =ğ
SIZE_T_MAX
)

310  ((8 << 
LG_SIZEOF_PTR
) - 1);

311 
x
++;

312  (
	`ffs_zu
(
x
) - 2);

313 
	}
}

317 
JEMALLOC_INLINE
 

318 
	$£t_”ºo
(
”ºum
)

321 #ifdeà
_WIN32


322 
	`S‘La¡E¼Ü
(
”ºum
);

324 
”ºo
 = 
”ºum
;

326 
	}
}

329 
JEMALLOC_INLINE
 

330 
	$g‘_”ºo
()

333 #ifdeà
_WIN32


334  (
	`G‘La¡E¼Ü
());

336  (
”ºo
);

338 
	}
}

	@deps/jemalloc/include/jemalloc/internal/valgrind.h

2 #ifdeà
JEMALLOC_H_TYPES


4 #ifdeà
JEMALLOC_VALGRIND


5 
	~<v®gršd/v®gršd.h
>

16 
	#JEMALLOC_VALGRIND_MAKE_MEM_NOACCESS
(
±r
, 
usize
) do { \

17 ià(
	`uÆik–y
(
š_v®gršd
)) \

18 
	`v®gršd_make_mem_nßcûss
(
±r
, 
usize
); \

19 } 0)

	)

20 
	#JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
±r
, 
usize
) do { \

21 ià(
	`uÆik–y
(
š_v®gršd
)) \

22 
	`v®gršd_make_mem_undefšed
(
±r
, 
usize
); \

23 } 0)

	)

24 
	#JEMALLOC_VALGRIND_MAKE_MEM_DEFINED
(
±r
, 
usize
) do { \

25 ià(
	`uÆik–y
(
š_v®gršd
)) \

26 
	`v®gršd_make_mem_defšed
(
±r
, 
usize
); \

27 } 0)

	)

33 
	#JEMALLOC_VALGRIND_MALLOC
(
cÚd
, 
tsdn
, 
±r
, 
usize
, 
z”o
) do { \

34 ià(
	`uÆik–y
(
š_v®gršd
 && 
cÚd
)) { \

35 
	`VALGRIND_MALLOCLIKE_BLOCK
(
±r
, 
usize
, 
	`p2rz
(
tsdn
,…tr), \

36 
z”o
); \

38 } 0)

	)

39 
	#JEMALLOC_VALGRIND_REALLOC_MOVED_no
(
±r
, 
Şd_±r
) \

40 (
çl£
)

	)

41 
	#JEMALLOC_VALGRIND_REALLOC_MOVED_maybe
(
±r
, 
Şd_±r
) \

42 ((
±r
è!ğ(
Şd_±r
))

	)

43 
	#JEMALLOC_VALGRIND_REALLOC_PTR_NULL_no
(
±r
) \

44 (
çl£
)

	)

45 
	#JEMALLOC_VALGRIND_REALLOC_PTR_NULL_maybe
(
±r
) \

46 (
±r
 =ğ
NULL
)

	)

47 
	#JEMALLOC_VALGRIND_REALLOC_OLD_PTR_NULL_no
(
Şd_±r
) \

48 (
çl£
)

	)

49 
	#JEMALLOC_VALGRIND_REALLOC_OLD_PTR_NULL_maybe
(
Şd_±r
) \

50 (
Şd_±r
 =ğ
NULL
)

	)

51 
	#JEMALLOC_VALGRIND_REALLOC
(
moved
, 
tsdn
, 
±r
, 
usize
, 
±r_nuÎ
, \

52 
Şd_±r
, 
Şd_usize
, 
Şd_rzsize
, 
Şd_±r_nuÎ
, 
z”o
) do { \

53 ià(
	`uÆik–y
(
š_v®gršd
)) { \

54 
size_t
 
rzsize
 = 
	`p2rz
(
tsdn
, 
±r
); \

56 ià(!
JEMALLOC_VALGRIND_REALLOC_MOVED_
##
	`moved
(
±r
, \

57 
Şd_±r
)) { \

58 
	`VALGRIND_RESIZEINPLACE_BLOCK
(
±r
, 
Şd_usize
, \

59 
usize
, 
rzsize
); \

60 ià(
z”o
 && 
Şd_usize
 < 
usize
) { \

61 
	`v®gršd_make_mem_defšed
( \

62 (*)((
ušŒ_t
)
±r
 + \

63 
Şd_usize
), 
usize
 - old_usize); \

66 ià(!
JEMALLOC_VALGRIND_REALLOC_OLD_PTR_NULL_
## \

67 
	`Şd_±r_nuÎ
(
Şd_±r
)) { \

68 
	`v®gršd_ä“like_block
(
Şd_±r
, \

69 
Şd_rzsize
); \

71 ià(!
JEMALLOC_VALGRIND_REALLOC_PTR_NULL_
## \

72 
	`±r_nuÎ
(
±r
)) { \

73 
size_t
 
cİy_size
 = (
Şd_usize
 < 
usize
) \

74 ? 
Şd_usize
 : 
usize
; \

75 
size_t
 
_size
 = 
usize
 - 
cİy_size
; \

76 
	`VALGRIND_MALLOCLIKE_BLOCK
(
±r
, 
usize
, \

77 
rzsize
, 
çl£
); \

78 ià(
cİy_size
 > 0) { \

79 
	`v®gršd_make_mem_defšed
(
±r
, \

80 
cİy_size
); \

82 ià(
z”o
 && 
_size
 > 0) { \

83 
	`v®gršd_make_mem_defšed
( \

84 (*)((
ušŒ_t
)
±r
 + \

85 
cİy_size
), 
_size
); \

90 } 0)

	)

91 
	#JEMALLOC_VALGRIND_FREE
(
±r
, 
rzsize
) do { \

92 ià(
	`uÆik–y
(
š_v®gršd
)) \

93 
	`v®gršd_ä“like_block
(
±r
, 
rzsize
); \

94 } 0)

	)

96 
	#RUNNING_ON_VALGRIND
 (()0)

	)

97 
	#JEMALLOC_VALGRIND_MAKE_MEM_NOACCESS
(
±r
, 
usize
èdØ{} 0)

	)

98 
	#JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
±r
, 
usize
èdØ{} 0)

	)

99 
	#JEMALLOC_VALGRIND_MAKE_MEM_DEFINED
(
±r
, 
usize
èdØ{} 0)

	)

100 
	#JEMALLOC_VALGRIND_MALLOC
(
cÚd
, 
tsdn
, 
±r
, 
usize
, 
z”o
èdØ{} 0)

	)

101 
	#JEMALLOC_VALGRIND_REALLOC
(
maybe_moved
, 
tsdn
, 
±r
, 
usize
, \

102 
±r_maybe_nuÎ
, 
Şd_±r
, 
Şd_usize
, 
Şd_rzsize
, 
Şd_±r_maybe_nuÎ
, \

103 
z”o
èdØ{} 0)

	)

104 
	#JEMALLOC_VALGRIND_FREE
(
±r
, 
rzsize
èdØ{} 0)

	)

109 #ifdeà
JEMALLOC_H_STRUCTS


113 #ifdeà
JEMALLOC_H_EXTERNS


115 #ifdeà
JEMALLOC_VALGRIND


116 
v®gršd_make_mem_nßcûss
(*
±r
, 
size_t
 
usize
);

117 
v®gršd_make_mem_undefšed
(*
±r
, 
size_t
 
usize
);

118 
v®gršd_make_mem_defšed
(*
±r
, 
size_t
 
usize
);

119 
v®gršd_ä“like_block
(*
±r
, 
size_t
 
usize
);

124 #ifdeà
JEMALLOC_H_INLINES


	@deps/jemalloc/include/jemalloc/internal/witness.h

2 #ifdeà
JEMALLOC_H_TYPES


4 
w™Ãss_s
 
	tw™Ãss_t
;

5 
	tw™Ãss_¿nk_t
;

6 
	$ql_h—d
(
	tw™Ãss_t
è
	tw™Ãss_li¡_t
;

7 
	tw™Ãss_comp_t
 (cÚ¡ 
	tw™Ãss_t
 *, const witness_t *);

13 
	#WITNESS_RANK_OMIT
 0U

	)

15 
	#WITNESS_RANK_INIT
 1U

	)

16 
	#WITNESS_RANK_CTL
 1U

	)

17 
	#WITNESS_RANK_ARENAS
 2U

	)

19 
	#WITNESS_RANK_PROF_DUMP
 3U

	)

20 
	#WITNESS_RANK_PROF_BT2GCTX
 4U

	)

21 
	#WITNESS_RANK_PROF_TDATAS
 5U

	)

22 
	#WITNESS_RANK_PROF_TDATA
 6U

	)

23 
	#WITNESS_RANK_PROF_GCTX
 7U

	)

25 
	#WITNESS_RANK_ARENA
 8U

	)

26 
	#WITNESS_RANK_ARENA_CHUNKS
 9U

	)

27 
	#WITNESS_RANK_ARENA_NODE_CACHE
 10

	)

29 
	#WITNESS_RANK_BASE
 11U

	)

31 
	#WITNESS_RANK_LEAF
 0xffffffffU

	)

32 
	#WITNESS_RANK_ARENA_BIN
 
WITNESS_RANK_LEAF


	)

33 
	#WITNESS_RANK_ARENA_HUGE
 
WITNESS_RANK_LEAF


	)

34 
	#WITNESS_RANK_DSS
 
WITNESS_RANK_LEAF


	)

35 
	#WITNESS_RANK_PROF_ACTIVE
 
WITNESS_RANK_LEAF


	)

36 
	#WITNESS_RANK_PROF_DUMP_SEQ
 
WITNESS_RANK_LEAF


	)

37 
	#WITNESS_RANK_PROF_GDUMP
 
WITNESS_RANK_LEAF


	)

38 
	#WITNESS_RANK_PROF_NEXT_THR_UID
 
WITNESS_RANK_LEAF


	)

39 
	#WITNESS_RANK_PROF_THREAD_ACTIVE_INIT
 
WITNESS_RANK_LEAF


	)

41 
	#WITNESS_INITIALIZER
(
¿nk
è{"š™Ÿliz”",„ªk, 
NULL
, {NULL, NULL}
	}

	)
}

45 #ifdeà
JEMALLOC_H_STRUCTS


47 
	sw™Ãss_s
 {

49 cÚ¡ *
	mÇme
;

55 
w™Ãss_¿nk_t
 
	m¿nk
;

62 
w™Ãss_comp_t
 *
	mcomp
;

65 
ql_–m
(
w™Ãss_t
è
	mlšk
;

70 #ifdeà
JEMALLOC_H_EXTERNS


72 
w™Ãss_š™
(
w™Ãss_t
 *
w™Ãss
, cÚ¡ *
Çme
, 
w™Ãss_¿nk_t
 
¿nk
,

73 
w™Ãss_comp_t
 *
comp
);

74 #ifdeà
JEMALLOC_JET


75 (
	tw™Ãss_lock_”rÜ_t
)(cÚ¡ 
	tw™Ãss_li¡_t
 *, cÚ¡ 
	tw™Ãss_t
 *);

76 
w™Ãss_lock_”rÜ_t
 *
w™Ãss_lock_”rÜ
;

78 
	`w™Ãss_lock_”rÜ
(cÚ¡ 
w™Ãss_li¡_t
 *
w™Ãs£s
,

79 cÚ¡ 
w™Ãss_t
 *
w™Ãss
);

81 #ifdeà
JEMALLOC_JET


82 (
	tw™Ãss_owÃr_”rÜ_t
)(cÚ¡ 
	tw™Ãss_t
 *);

83 
w™Ãss_owÃr_”rÜ_t
 *
w™Ãss_owÃr_”rÜ
;

85 
	`w™Ãss_owÃr_”rÜ
(cÚ¡ 
w™Ãss_t
 *
w™Ãss
);

87 #ifdeà
JEMALLOC_JET


88 (
	tw™Ãss_nÙ_owÃr_”rÜ_t
)(cÚ¡ 
	tw™Ãss_t
 *);

89 
w™Ãss_nÙ_owÃr_”rÜ_t
 *
w™Ãss_nÙ_owÃr_”rÜ
;

91 
	`w™Ãss_nÙ_owÃr_”rÜ
(cÚ¡ 
w™Ãss_t
 *
w™Ãss
);

93 #ifdeà
JEMALLOC_JET


94 (
	tw™Ãss_lockËss_”rÜ_t
)(cÚ¡ 
	tw™Ãss_li¡_t
 *);

95 
w™Ãss_lockËss_”rÜ_t
 *
w™Ãss_lockËss_”rÜ
;

97 
	`w™Ãss_lockËss_”rÜ
(cÚ¡ 
w™Ãss_li¡_t
 *
w™Ãs£s
);

100 
	`w™Ãs£s_ş—nup
(
tsd_t
 *
tsd
);

101 
	`w™Ãss_fÜk_ş—nup
(
tsd_t
 *
tsd
);

102 
	`w™Ãss_´efÜk
(
tsd_t
 *
tsd
);

103 
	`w™Ãss_po¡fÜk_·»Á
(
tsd_t
 *
tsd
);

104 
	`w™Ãss_po¡fÜk_chd
(
tsd_t
 *
tsd
);

108 #ifdeà
JEMALLOC_H_INLINES


110 #iâdeà
JEMALLOC_ENABLE_INLINE


111 
boŞ
 
	`w™Ãss_owÃr
(
tsd_t
 *
tsd
, cÚ¡ 
w™Ãss_t
 *
w™Ãss
);

112 
	`w™Ãss_as£¹_owÃr
(
tsdn_t
 *
tsdn
, cÚ¡ 
w™Ãss_t
 *
w™Ãss
);

113 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn_t
 *
tsdn
, cÚ¡ 
w™Ãss_t
 *
w™Ãss
);

114 
	`w™Ãss_as£¹_lockËss
(
tsdn_t
 *
tsdn
);

115 
	`w™Ãss_lock
(
tsdn_t
 *
tsdn
, 
w™Ãss_t
 *
w™Ãss
);

116 
	`w™Ãss_uÆock
(
tsdn_t
 *
tsdn
, 
w™Ãss_t
 *
w™Ãss
);

119 #ià(
	`defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
JEMALLOC_MUTEX_C_
))

120 
JEMALLOC_INLINE
 
boŞ


121 
	$w™Ãss_owÃr
(
tsd_t
 *
tsd
, cÚ¡ 
w™Ãss_t
 *
w™Ãss
)

123 
w™Ãss_li¡_t
 *
w™Ãs£s
;

124 
w™Ãss_t
 *
w
;

126 
w™Ãs£s
 = 
	`tsd_w™Ãs£¥_g‘
(
tsd
);

127 
	`ql_fÜ—ch
(
w
, 
w™Ãs£s
, 
lšk
) {

128 ià(
w
 =ğ
w™Ãss
)

129  (
Œue
);

132  (
çl£
);

133 
	}
}

135 
JEMALLOC_INLINE
 

136 
	$w™Ãss_as£¹_owÃr
(
tsdn_t
 *
tsdn
, cÚ¡ 
w™Ãss_t
 *
w™Ãss
)

138 
tsd_t
 *
tsd
;

140 ià(!
cÚfig_debug
)

143 ià(
	`tsdn_nuÎ
(
tsdn
))

145 
tsd
 = 
	`tsdn_tsd
(
tsdn
);

146 ià(
w™Ãss
->
¿nk
 =ğ
WITNESS_RANK_OMIT
)

149 ià(
	`w™Ãss_owÃr
(
tsd
, 
w™Ãss
))

151 
	`w™Ãss_owÃr_”rÜ
(
w™Ãss
);

152 
	}
}

154 
JEMALLOC_INLINE
 

155 
	$w™Ãss_as£¹_nÙ_owÃr
(
tsdn_t
 *
tsdn
, cÚ¡ 
w™Ãss_t
 *
w™Ãss
)

157 
tsd_t
 *
tsd
;

158 
w™Ãss_li¡_t
 *
w™Ãs£s
;

159 
w™Ãss_t
 *
w
;

161 ià(!
cÚfig_debug
)

164 ià(
	`tsdn_nuÎ
(
tsdn
))

166 
tsd
 = 
	`tsdn_tsd
(
tsdn
);

167 ià(
w™Ãss
->
¿nk
 =ğ
WITNESS_RANK_OMIT
)

170 
w™Ãs£s
 = 
	`tsd_w™Ãs£¥_g‘
(
tsd
);

171 
	`ql_fÜ—ch
(
w
, 
w™Ãs£s
, 
lšk
) {

172 ià(
w
 =ğ
w™Ãss
)

173 
	`w™Ãss_nÙ_owÃr_”rÜ
(
w™Ãss
);

175 
	}
}

177 
JEMALLOC_INLINE
 

178 
	$w™Ãss_as£¹_lockËss
(
tsdn_t
 *
tsdn
)

180 
tsd_t
 *
tsd
;

181 
w™Ãss_li¡_t
 *
w™Ãs£s
;

182 
w™Ãss_t
 *
w
;

184 ià(!
cÚfig_debug
)

187 ià(
	`tsdn_nuÎ
(
tsdn
))

189 
tsd
 = 
	`tsdn_tsd
(
tsdn
);

191 
w™Ãs£s
 = 
	`tsd_w™Ãs£¥_g‘
(
tsd
);

192 
w
 = 
	`ql_Ï¡
(
w™Ãs£s
, 
lšk
);

193 ià(
w
 !ğ
NULL
)

194 
	`w™Ãss_lockËss_”rÜ
(
w™Ãs£s
);

195 
	}
}

197 
JEMALLOC_INLINE
 

198 
	$w™Ãss_lock
(
tsdn_t
 *
tsdn
, 
w™Ãss_t
 *
w™Ãss
)

200 
tsd_t
 *
tsd
;

201 
w™Ãss_li¡_t
 *
w™Ãs£s
;

202 
w™Ãss_t
 *
w
;

204 ià(!
cÚfig_debug
)

207 ià(
	`tsdn_nuÎ
(
tsdn
))

209 
tsd
 = 
	`tsdn_tsd
(
tsdn
);

210 ià(
w™Ãss
->
¿nk
 =ğ
WITNESS_RANK_OMIT
)

213 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn
, 
w™Ãss
);

215 
w™Ãs£s
 = 
	`tsd_w™Ãs£¥_g‘
(
tsd
);

216 
w
 = 
	`ql_Ï¡
(
w™Ãs£s
, 
lšk
);

217 ià(
w
 =ğ
NULL
) {

219 } ià(
	`tsd_w™Ãss_fÜk_g‘
(
tsd
è&& 
w
->
¿nk
 <ğ
w™Ãss
->rank) {

221 } ià(
w
->
¿nk
 > 
w™Ãss
->rank) {

223 
	`w™Ãss_lock_”rÜ
(
w™Ãs£s
, 
w™Ãss
);

224 } ià(
w
->
¿nk
 =ğ
w™Ãss
->¿nk && (w->
comp
 =ğ
NULL
 || w->comp !=

225 
w™Ãss
->
comp
 || 
w
->
	`comp
(w, witness) > 0)) {

230 
	`w™Ãss_lock_”rÜ
(
w™Ãs£s
, 
w™Ãss
);

233 
	`ql_–m_Ãw
(
w™Ãss
, 
lšk
);

234 
	`ql__š£¹
(
w™Ãs£s
, 
w™Ãss
, 
lšk
);

235 
	}
}

237 
JEMALLOC_INLINE
 

238 
	$w™Ãss_uÆock
(
tsdn_t
 *
tsdn
, 
w™Ãss_t
 *
w™Ãss
)

240 
tsd_t
 *
tsd
;

241 
w™Ãss_li¡_t
 *
w™Ãs£s
;

243 ià(!
cÚfig_debug
)

246 ià(
	`tsdn_nuÎ
(
tsdn
))

248 
tsd
 = 
	`tsdn_tsd
(
tsdn
);

249 ià(
w™Ãss
->
¿nk
 =ğ
WITNESS_RANK_OMIT
)

257 ià(
	`w™Ãss_owÃr
(
tsd
, 
w™Ãss
)) {

258 
w™Ãs£s
 = 
	`tsd_w™Ãs£¥_g‘
(
tsd
);

259 
	`ql_»move
(
w™Ãs£s
, 
w™Ãss
, 
lšk
);

261 
	`w™Ãss_as£¹_owÃr
(
tsdn
, 
w™Ãss
);

262 
	}
}

	@deps/jemalloc/include/jemalloc/jemalloc.h

1 #iâdeà
JEMALLOC_H_


2 
	#JEMALLOC_H_


	)

3 #ifdeà
__ılu¥lus


8 
	#JEMALLOC_HAVE_ATTR


	)

11 
	#JEMALLOC_HAVE_ATTR_ALLOC_SIZE


	)

14 
	#JEMALLOC_HAVE_ATTR_FORMAT_GNU_PRINTF


	)

17 
	#JEMALLOC_HAVE_ATTR_FORMAT_PRINTF


	)

23 
	#JEMALLOC_OVERRIDE_MEMALIGN


	)

24 
	#JEMALLOC_OVERRIDE_VALLOC


	)

33 
	#JEMALLOC_USABLE_SIZE_CONST


	)

40 
	#JEMALLOC_USE_CXX_THROW


	)

42 #ifdeà
_MSC_VER


43 #ifdeà
_WIN64


44 
	#LG_SIZEOF_PTR_WIN
 3

	)

46 
	#LG_SIZEOF_PTR_WIN
 2

	)

51 
	#LG_SIZEOF_PTR
 3

	)

58 #iâdeà
JEMALLOC_NO_RENAME


59 
	#je_m®loc_cÚf
 
je_m®loc_cÚf


	)

60 
	#je_m®loc_mes§ge
 
je_m®loc_mes§ge


	)

61 
	#je_m®loc
 
je_m®loc


	)

62 
	#je_ÿÎoc
 
je_ÿÎoc


	)

63 
	#je_posix_mem®ign
 
je_posix_mem®ign


	)

64 
	#je_®igÃd_®loc
 
je_®igÃd_®loc


	)

65 
	#je_»®loc
 
je_»®loc


	)

66 
	#je_ä“
 
je_ä“


	)

67 
	#je_m®locx
 
je_m®locx


	)

68 
	#je_¿Îocx
 
je_¿Îocx


	)

69 
	#je_x®locx
 
je_x®locx


	)

70 
	#je_§Îocx
 
je_§Îocx


	)

71 
	#je_d®locx
 
je_d®locx


	)

72 
	#je_sd®locx
 
je_sd®locx


	)

73 
	#je_ÇÎocx
 
je_ÇÎocx


	)

74 
	#je_m®lùl
 
je_m®lùl


	)

75 
	#je_m®lùÊam‘omib
 
je_m®lùÊam‘omib


	)

76 
	#je_m®lùlbymib
 
je_m®lùlbymib


	)

77 
	#je_m®loc_¡©s_´št
 
je_m®loc_¡©s_´št


	)

78 
	#je_m®loc_u§bË_size
 
je_m®loc_u§bË_size


	)

79 
	#je_mem®ign
 
je_mem®ign


	)

80 
	#je_v®loc
 
je_v®loc


	)

83 
	~<¡dlib.h
>

84 
	~<¡dboŞ.h
>

85 
	~<¡dšt.h
>

86 
	~<lim™s.h
>

87 
	~<¡ršgs.h
>

89 
	#JEMALLOC_VERSION
 "4.4.0-0-gf1f76357313e7dÿd7262f17a48ff0a2e005fcdc"

	)

90 
	#JEMALLOC_VERSION_MAJOR
 4

	)

91 
	#JEMALLOC_VERSION_MINOR
 4

	)

92 
	#JEMALLOC_VERSION_BUGFIX
 0

	)

93 
	#JEMALLOC_VERSION_NREV
 0

	)

94 
	#JEMALLOC_VERSION_GID
 "f1f76357313e7dÿd7262f17a48ff0a2e005fcdc"

	)

96 
	#MALLOCX_LG_ALIGN
(
Ï
è(()Öa))

	)

97 #ià
LG_SIZEOF_PTR
 == 2

98 
	#MALLOCX_ALIGN
(
a
è(()(
	`ffs
(()×))-1))

	)

100 
	#MALLOCX_ALIGN
(
a
) \

101 (()(((
size_t
)(
a
è< (size_t)
INT_MAX
è? 
	`ffs
(()(a))-1 : \

102 
	`ffs
(()(((
size_t
)(
a
))>>32))+31))

	)

104 
	#MALLOCX_ZERO
 (()0x40)

	)

109 
	#MALLOCX_TCACHE
(
tc
è(()((Ñc)+2è<< 8))

	)

110 
	#MALLOCX_TCACHE_NONE
 
	`MALLOCX_TCACHE
(-1)

	)

114 
	#MALLOCX_ARENA
(
a
è(((()×))+1è<< 20)

	)

116 #ià
defšed
(
__ılu¥lus
è&& defšed(
JEMALLOC_USE_CXX_THROW
)

117 
	#JEMALLOC_CXX_THROW
 
	`throw
()

	)

119 
	#JEMALLOC_CXX_THROW


	)

122 #ià
_MSC_VER


123 
	#JEMALLOC_ATTR
(
s
)

	)

124 
	#JEMALLOC_ALIGNED
(
s
è
	`__deş¥ec
(
	`®ign
(s))

	)

125 
	#JEMALLOC_ALLOC_SIZE
(
s
)

	)

126 
	#JEMALLOC_ALLOC_SIZE2
(
s1
, 
s2
)

	)

127 #iâdeà
JEMALLOC_EXPORT


128 #ifdeà
DLLEXPORT


129 
	#JEMALLOC_EXPORT
 
	`__deş¥ec
(
dÎexpÜt
)

	)

131 
	#JEMALLOC_EXPORT
 
	`__deş¥ec
(
dÎimpÜt
)

	)

134 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
)

	)

135 
	#JEMALLOC_NOINLINE
 
	`__deş¥ec
(
nošlše
)

	)

136 #ifdeà
__ılu¥lus


137 
	#JEMALLOC_NOTHROW
 
	`__deş¥ec
(
nÙhrow
)

	)

139 
	#JEMALLOC_NOTHROW


	)

141 
	#JEMALLOC_SECTION
(
s
è
	`__deş¥ec
(
	`®loÿ‹
(s))

	)

142 
	#JEMALLOC_RESTRICT_RETURN
 
	`__deş¥ec
(
»¡riù
)

	)

143 #ià
_MSC_VER
 >ğ1900 && !
defšed
(
__EDG__
)

144 
	#JEMALLOC_ALLOCATOR
 
	`__deş¥ec
(
®loÿtÜ
)

	)

146 
	#JEMALLOC_ALLOCATOR


	)

148 #–ià
defšed
(
JEMALLOC_HAVE_ATTR
)

149 
	#JEMALLOC_ATTR
(
s
è
	`__©Œibu‹__
((s))

	)

150 
	#JEMALLOC_ALIGNED
(
s
è
	`JEMALLOC_ATTR
(
	`®igÃd
(s))

	)

151 #ifdeà
JEMALLOC_HAVE_ATTR_ALLOC_SIZE


152 
	#JEMALLOC_ALLOC_SIZE
(
s
è
	`JEMALLOC_ATTR
(
	`®loc_size
(s))

	)

153 
	#JEMALLOC_ALLOC_SIZE2
(
s1
, 
s2
è
	`JEMALLOC_ATTR
(
	`®loc_size
(s1, s2))

	)

155 
	#JEMALLOC_ALLOC_SIZE
(
s
)

	)

156 
	#JEMALLOC_ALLOC_SIZE2
(
s1
, 
s2
)

	)

158 #iâdeà
JEMALLOC_EXPORT


159 
	#JEMALLOC_EXPORT
 
	`JEMALLOC_ATTR
(
	`visib™y
("deçuÉ"))

	)

161 #ifdeà
JEMALLOC_HAVE_ATTR_FORMAT_GNU_PRINTF


162 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
è
	`JEMALLOC_ATTR
(
	`fÜm©
(
gnu_´štf
, s, i))

	)

163 #–ià
defšed
(
JEMALLOC_HAVE_ATTR_FORMAT_PRINTF
)

164 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
è
	`JEMALLOC_ATTR
(
	`fÜm©
(
´štf
, s, i))

	)

166 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
)

	)

168 
	#JEMALLOC_NOINLINE
 
	`JEMALLOC_ATTR
(
nošlše
)

	)

169 
	#JEMALLOC_NOTHROW
 
	`JEMALLOC_ATTR
(
nÙhrow
)

	)

170 
	#JEMALLOC_SECTION
(
s
è
	`JEMALLOC_ATTR
(
	`£ùiÚ
(s))

	)

171 
	#JEMALLOC_RESTRICT_RETURN


	)

172 
	#JEMALLOC_ALLOCATOR


	)

174 
	#JEMALLOC_ATTR
(
s
)

	)

175 
	#JEMALLOC_ALIGNED
(
s
)

	)

176 
	#JEMALLOC_ALLOC_SIZE
(
s
)

	)

177 
	#JEMALLOC_ALLOC_SIZE2
(
s1
, 
s2
)

	)

178 
	#JEMALLOC_EXPORT


	)

179 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
)

	)

180 
	#JEMALLOC_NOINLINE


	)

181 
	#JEMALLOC_NOTHROW


	)

182 
	#JEMALLOC_SECTION
(
s
)

	)

183 
	#JEMALLOC_RESTRICT_RETURN


	)

184 
	#JEMALLOC_ALLOCATOR


	)

192 
JEMALLOC_EXPORT
 cÚ¡ *
je_m®loc_cÚf
;

193 
JEMALLOC_EXPORT
 (*
je_m®loc_mes§ge
)(*
cbİaque
,

194 cÚ¡ *
s
);

196 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


197 
JEMALLOC_NOTHROW
 *
je_m®loc
(
size_t
 
size
)

198 
JEMALLOC_CXX_THROW
 
JEMALLOC_ATTR
(
m®loc
è
JEMALLOC_ALLOC_SIZE
(1);

199 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


200 
JEMALLOC_NOTHROW
 *
je_ÿÎoc
(
size_t
 
num
, size_ˆ
size
)

201 
JEMALLOC_CXX_THROW
 
JEMALLOC_ATTR
(
m®loc
è
JEMALLOC_ALLOC_SIZE2
(1, 2);

202 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
je_posix_mem®ign
(**
mem±r
,

203 
size_t
 
®ignm’t
, size_ˆ
size
è
JEMALLOC_CXX_THROW
 
JEMALLOC_ATTR
(
nÚnuÎ
(1));

204 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


205 
JEMALLOC_NOTHROW
 *
je_®igÃd_®loc
(
size_t
 
®ignm’t
,

206 
size_t
 
size
è
JEMALLOC_CXX_THROW
 
JEMALLOC_ATTR
(
m®loc
)

207 
JEMALLOC_ALLOC_SIZE
(2);

208 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


209 
JEMALLOC_NOTHROW
 *
je_»®loc
(*
±r
, 
size_t
 
size
)

210 
JEMALLOC_CXX_THROW
 
JEMALLOC_ALLOC_SIZE
(2);

211 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
je_ä“
(*
±r
)

212 
	gJEMALLOC_CXX_THROW
;

214 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


215 
JEMALLOC_NOTHROW
 *
je_m®locx
(
size_t
 
size
, 
æags
)

216 
JEMALLOC_ATTR
(
m®loc
è
JEMALLOC_ALLOC_SIZE
(1);

217 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


218 
JEMALLOC_NOTHROW
 *
je_¿Îocx
(*
±r
, 
size_t
 
size
,

219 
æags
è
JEMALLOC_ALLOC_SIZE
(2);

220 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
je_x®locx
(*
±r
, size_ˆ
size
,

221 
size_t
 
exŒa
, 
æags
);

222 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
je_§Îocx
(cÚ¡ *
±r
,

223 
æags
è
JEMALLOC_ATTR
(
pu»
);

224 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
je_d®locx
(*
±r
, 
æags
);

225 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
je_sd®locx
(*
±r
, 
size_t
 
size
,

226 
æags
);

227 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
je_ÇÎocx
(size_ˆ
size
, 
æags
)

228 
JEMALLOC_ATTR
(
pu»
);

230 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
je_m®lùl
(cÚ¡ *
Çme
,

231 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
);

232 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
je_m®lùÊam‘omib
(cÚ¡ *
Çme
,

233 
size_t
 *
mibp
, size_ˆ*
mibËÅ
);

234 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
je_m®lùlbymib
(cÚ¡ 
size_t
 *
mib
,

235 
size_t
 
mibËn
, *
Şdp
, size_ˆ*
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
);

236 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
je_m®loc_¡©s_´št
(

237 (*
wr™e_cb
)(*, cÚ¡ *), *
je_cbİaque
,

238 cÚ¡ *
İts
);

239 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
je_m®loc_u§bË_size
(

240 
JEMALLOC_USABLE_SIZE_CONST
 *
±r
è
	gJEMALLOC_CXX_THROW
;

242 #ifdeà
JEMALLOC_OVERRIDE_MEMALIGN


243 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


244 
JEMALLOC_NOTHROW
 *
je_mem®ign
(
size_t
 
®ignm’t
, size_ˆ
size
)

245 
JEMALLOC_CXX_THROW
 
JEMALLOC_ATTR
(
m®loc
);

248 #ifdeà
JEMALLOC_OVERRIDE_VALLOC


249 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


250 
JEMALLOC_NOTHROW
 *
je_v®loc
(
size_t
 
size
è
JEMALLOC_CXX_THROW


251 
JEMALLOC_ATTR
(
m®loc
);

259 *(
	tchunk_®loc_t
)(*, 
	tsize_t
, size_t, 
	tboŞ
 *, bool *, );

265 
boŞ
 (
	tchunk_d®loc_t
)(*, 
	tsize_t
, 
	tboŞ
, );

272 
boŞ
 (
	tchunk_comm™_t
)(*, 
	tsize_t
, size_t, size_t, );

279 
boŞ
 (
	tchunk_decomm™_t
)(*, 
	tsize_t
, size_t, size_t, );

286 
boŞ
 (
	tchunk_purge_t
)(*, 
	tsize_t
, size_t, size_t, );

293 
boŞ
 (
	tchunk_¥l™_t
)(*, 
	tsize_t
, size_t, size_t, 
	tboŞ
, );

300 
boŞ
 (
	tchunk_m”ge_t
)(*, 
	tsize_t
, *, size_t, 
	tboŞ
, );

303 
chunk_®loc_t
 *
	g®loc
;

304 
chunk_d®loc_t
 *
	gd®loc
;

305 
chunk_comm™_t
 *
	gcomm™
;

306 
chunk_decomm™_t
 *
	gdecomm™
;

307 
chunk_purge_t
 *
	gpurge
;

308 
chunk_¥l™_t
 *
	g¥l™
;

309 
chunk_m”ge_t
 *
	gm”ge
;

310 } 
	tchunk_hooks_t
;

319 #ifdeà
JEMALLOC_MANGLE


320 #iâdeà
JEMALLOC_NO_DEMANGLE


321 
	#JEMALLOC_NO_DEMANGLE


	)

323 
	#m®loc_cÚf
 
je_m®loc_cÚf


	)

324 
	#m®loc_mes§ge
 
je_m®loc_mes§ge


	)

325 
	#m®loc
 
je_m®loc


	)

326 
	#ÿÎoc
 
je_ÿÎoc


	)

327 
	#posix_mem®ign
 
je_posix_mem®ign


	)

328 
	#®igÃd_®loc
 
je_®igÃd_®loc


	)

329 
	#»®loc
 
je_»®loc


	)

330 
	#ä“
 
je_ä“


	)

331 
	#m®locx
 
je_m®locx


	)

332 
	#¿Îocx
 
je_¿Îocx


	)

333 
	#x®locx
 
je_x®locx


	)

334 
	#§Îocx
 
je_§Îocx


	)

335 
	#d®locx
 
je_d®locx


	)

336 
	#sd®locx
 
je_sd®locx


	)

337 
	#ÇÎocx
 
je_ÇÎocx


	)

338 
	#m®lùl
 
je_m®lùl


	)

339 
	#m®lùÊam‘omib
 
je_m®lùÊam‘omib


	)

340 
	#m®lùlbymib
 
je_m®lùlbymib


	)

341 
	#m®loc_¡©s_´št
 
je_m®loc_¡©s_´št


	)

342 
	#m®loc_u§bË_size
 
je_m®loc_u§bË_size


	)

343 
	#mem®ign
 
je_mem®ign


	)

344 
	#v®loc
 
je_v®loc


	)

354 #iâdeà
JEMALLOC_NO_DEMANGLE


355 #undeà
je_m®loc_cÚf


356 #undeà
je_m®loc_mes§ge


357 #undeà
je_m®loc


358 #undeà
je_ÿÎoc


359 #undeà
je_posix_mem®ign


360 #undeà
je_®igÃd_®loc


361 #undeà
je_»®loc


362 #undeà
je_ä“


363 #undeà
je_m®locx


364 #undeà
je_¿Îocx


365 #undeà
je_x®locx


366 #undeà
je_§Îocx


367 #undeà
je_d®locx


368 #undeà
je_sd®locx


369 #undeà
je_ÇÎocx


370 #undeà
je_m®lùl


371 #undeà
je_m®lùÊam‘omib


372 #undeà
je_m®lùlbymib


373 #undeà
je_m®loc_¡©s_´št


374 #undeà
je_m®loc_u§bË_size


375 #undeà
je_mem®ign


376 #undeà
je_v®loc


379 #ifdeà
__ılu¥lus


	@deps/jemalloc/include/jemalloc/jemalloc_defs.h

3 
	#JEMALLOC_HAVE_ATTR


	)

6 
	#JEMALLOC_HAVE_ATTR_ALLOC_SIZE


	)

9 
	#JEMALLOC_HAVE_ATTR_FORMAT_GNU_PRINTF


	)

12 
	#JEMALLOC_HAVE_ATTR_FORMAT_PRINTF


	)

18 
	#JEMALLOC_OVERRIDE_MEMALIGN


	)

19 
	#JEMALLOC_OVERRIDE_VALLOC


	)

28 
	#JEMALLOC_USABLE_SIZE_CONST


	)

35 
	#JEMALLOC_USE_CXX_THROW


	)

37 #ifdeà
_MSC_VER


38 #ifdeà
_WIN64


39 
	#LG_SIZEOF_PTR_WIN
 3

	)

41 
	#LG_SIZEOF_PTR_WIN
 2

	)

46 
	#LG_SIZEOF_PTR
 3

	)

	@deps/jemalloc/include/jemalloc/jemalloc_macros.h

1 
	~<¡dlib.h
>

2 
	~<¡dboŞ.h
>

3 
	~<¡dšt.h
>

4 
	~<lim™s.h
>

5 
	~<¡ršgs.h
>

7 
	#JEMALLOC_VERSION
 "4.4.0-0-gf1f76357313e7dÿd7262f17a48ff0a2e005fcdc"

	)

8 
	#JEMALLOC_VERSION_MAJOR
 4

	)

9 
	#JEMALLOC_VERSION_MINOR
 4

	)

10 
	#JEMALLOC_VERSION_BUGFIX
 0

	)

11 
	#JEMALLOC_VERSION_NREV
 0

	)

12 
	#JEMALLOC_VERSION_GID
 "f1f76357313e7dÿd7262f17a48ff0a2e005fcdc"

	)

14 
	#MALLOCX_LG_ALIGN
(
Ï
è(()Öa))

	)

15 #ià
LG_SIZEOF_PTR
 == 2

16 
	#MALLOCX_ALIGN
(
a
è(()(
	`ffs
(()×))-1))

	)

18 
	#MALLOCX_ALIGN
(
a
) \

19 (()(((
size_t
)(
a
è< (size_t)
INT_MAX
è? 
	`ffs
(()(a))-1 : \

20 
	`ffs
(()(((
size_t
)(
a
))>>32))+31))

	)

22 
	#MALLOCX_ZERO
 (()0x40)

	)

27 
	#MALLOCX_TCACHE
(
tc
è(()((Ñc)+2è<< 8))

	)

28 
	#MALLOCX_TCACHE_NONE
 
	`MALLOCX_TCACHE
(-1)

	)

32 
	#MALLOCX_ARENA
(
a
è(((()×))+1è<< 20)

	)

34 #ià
defšed
(
__ılu¥lus
è&& defšed(
JEMALLOC_USE_CXX_THROW
)

35 
	#JEMALLOC_CXX_THROW
 
	`throw
()

	)

37 
	#JEMALLOC_CXX_THROW


	)

40 #ià
_MSC_VER


41 
	#JEMALLOC_ATTR
(
s
)

	)

42 
	#JEMALLOC_ALIGNED
(
s
è
	`__deş¥ec
(
	`®ign
(s))

	)

43 
	#JEMALLOC_ALLOC_SIZE
(
s
)

	)

44 
	#JEMALLOC_ALLOC_SIZE2
(
s1
, 
s2
)

	)

45 #iâdeà
JEMALLOC_EXPORT


46 #ifdeà
DLLEXPORT


47 
	#JEMALLOC_EXPORT
 
	`__deş¥ec
(
dÎexpÜt
)

	)

49 
	#JEMALLOC_EXPORT
 
	`__deş¥ec
(
dÎimpÜt
)

	)

52 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
)

	)

53 
	#JEMALLOC_NOINLINE
 
	`__deş¥ec
(
nošlše
)

	)

54 #ifdeà
__ılu¥lus


55 
	#JEMALLOC_NOTHROW
 
	`__deş¥ec
(
nÙhrow
)

	)

57 
	#JEMALLOC_NOTHROW


	)

59 
	#JEMALLOC_SECTION
(
s
è
	`__deş¥ec
(
	`®loÿ‹
(s))

	)

60 
	#JEMALLOC_RESTRICT_RETURN
 
	`__deş¥ec
(
»¡riù
)

	)

61 #ià
_MSC_VER
 >ğ1900 && !
defšed
(
__EDG__
)

62 
	#JEMALLOC_ALLOCATOR
 
	`__deş¥ec
(
®loÿtÜ
)

	)

64 
	#JEMALLOC_ALLOCATOR


	)

66 #–ià
defšed
(
JEMALLOC_HAVE_ATTR
)

67 
	#JEMALLOC_ATTR
(
s
è
	`__©Œibu‹__
((s))

	)

68 
	#JEMALLOC_ALIGNED
(
s
è
	`JEMALLOC_ATTR
(
	`®igÃd
(s))

	)

69 #ifdeà
JEMALLOC_HAVE_ATTR_ALLOC_SIZE


70 
	#JEMALLOC_ALLOC_SIZE
(
s
è
	`JEMALLOC_ATTR
(
	`®loc_size
(s))

	)

71 
	#JEMALLOC_ALLOC_SIZE2
(
s1
, 
s2
è
	`JEMALLOC_ATTR
(
	`®loc_size
(s1, s2))

	)

73 
	#JEMALLOC_ALLOC_SIZE
(
s
)

	)

74 
	#JEMALLOC_ALLOC_SIZE2
(
s1
, 
s2
)

	)

76 #iâdeà
JEMALLOC_EXPORT


77 
	#JEMALLOC_EXPORT
 
	`JEMALLOC_ATTR
(
	`visib™y
("deçuÉ"))

	)

79 #ifdeà
JEMALLOC_HAVE_ATTR_FORMAT_GNU_PRINTF


80 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
è
	`JEMALLOC_ATTR
(
	`fÜm©
(
gnu_´štf
, s, i))

	)

81 #–ià
defšed
(
JEMALLOC_HAVE_ATTR_FORMAT_PRINTF
)

82 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
è
	`JEMALLOC_ATTR
(
	`fÜm©
(
´štf
, s, i))

	)

84 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
)

	)

86 
	#JEMALLOC_NOINLINE
 
	`JEMALLOC_ATTR
(
nošlše
)

	)

87 
	#JEMALLOC_NOTHROW
 
	`JEMALLOC_ATTR
(
nÙhrow
)

	)

88 
	#JEMALLOC_SECTION
(
s
è
	`JEMALLOC_ATTR
(
	`£ùiÚ
(s))

	)

89 
	#JEMALLOC_RESTRICT_RETURN


	)

90 
	#JEMALLOC_ALLOCATOR


	)

92 
	#JEMALLOC_ATTR
(
s
)

	)

93 
	#JEMALLOC_ALIGNED
(
s
)

	)

94 
	#JEMALLOC_ALLOC_SIZE
(
s
)

	)

95 
	#JEMALLOC_ALLOC_SIZE2
(
s1
, 
s2
)

	)

96 
	#JEMALLOC_EXPORT


	)

97 
	#JEMALLOC_FORMAT_PRINTF
(
s
, 
i
)

	)

98 
	#JEMALLOC_NOINLINE


	)

99 
	#JEMALLOC_NOTHROW


	)

100 
	#JEMALLOC_SECTION
(
s
)

	)

101 
	#JEMALLOC_RESTRICT_RETURN


	)

102 
	#JEMALLOC_ALLOCATOR


	)

	@deps/jemalloc/include/jemalloc/jemalloc_mangle.h

8 #ifdeà
JEMALLOC_MANGLE


9 #iâdeà
JEMALLOC_NO_DEMANGLE


10 
	#JEMALLOC_NO_DEMANGLE


	)

12 
	#m®loc_cÚf
 
je_m®loc_cÚf


	)

13 
	#m®loc_mes§ge
 
je_m®loc_mes§ge


	)

14 
	#m®loc
 
je_m®loc


	)

15 
	#ÿÎoc
 
je_ÿÎoc


	)

16 
	#posix_mem®ign
 
je_posix_mem®ign


	)

17 
	#®igÃd_®loc
 
je_®igÃd_®loc


	)

18 
	#»®loc
 
je_»®loc


	)

19 
	#ä“
 
je_ä“


	)

20 
	#m®locx
 
je_m®locx


	)

21 
	#¿Îocx
 
je_¿Îocx


	)

22 
	#x®locx
 
je_x®locx


	)

23 
	#§Îocx
 
je_§Îocx


	)

24 
	#d®locx
 
je_d®locx


	)

25 
	#sd®locx
 
je_sd®locx


	)

26 
	#ÇÎocx
 
je_ÇÎocx


	)

27 
	#m®lùl
 
je_m®lùl


	)

28 
	#m®lùÊam‘omib
 
je_m®lùÊam‘omib


	)

29 
	#m®lùlbymib
 
je_m®lùlbymib


	)

30 
	#m®loc_¡©s_´št
 
je_m®loc_¡©s_´št


	)

31 
	#m®loc_u§bË_size
 
je_m®loc_u§bË_size


	)

32 
	#mem®ign
 
je_mem®ign


	)

33 
	#v®loc
 
je_v®loc


	)

43 #iâdeà
JEMALLOC_NO_DEMANGLE


44 #undeà
je_m®loc_cÚf


45 #undeà
je_m®loc_mes§ge


46 #undeà
je_m®loc


47 #undeà
je_ÿÎoc


48 #undeà
je_posix_mem®ign


49 #undeà
je_®igÃd_®loc


50 #undeà
je_»®loc


51 #undeà
je_ä“


52 #undeà
je_m®locx


53 #undeà
je_¿Îocx


54 #undeà
je_x®locx


55 #undeà
je_§Îocx


56 #undeà
je_d®locx


57 #undeà
je_sd®locx


58 #undeà
je_ÇÎocx


59 #undeà
je_m®lùl


60 #undeà
je_m®lùÊam‘omib


61 #undeà
je_m®lùlbymib


62 #undeà
je_m®loc_¡©s_´št


63 #undeà
je_m®loc_u§bË_size


64 #undeà
je_mem®ign


65 #undeà
je_v®loc


	@deps/jemalloc/include/jemalloc/jemalloc_mangle_jet.h

8 #ifdeà
JEMALLOC_MANGLE


9 #iâdeà
JEMALLOC_NO_DEMANGLE


10 
	#JEMALLOC_NO_DEMANGLE


	)

12 
	#m®loc_cÚf
 
j‘_m®loc_cÚf


	)

13 
	#m®loc_mes§ge
 
j‘_m®loc_mes§ge


	)

14 
	#m®loc
 
j‘_m®loc


	)

15 
	#ÿÎoc
 
j‘_ÿÎoc


	)

16 
	#posix_mem®ign
 
j‘_posix_mem®ign


	)

17 
	#®igÃd_®loc
 
j‘_®igÃd_®loc


	)

18 
	#»®loc
 
j‘_»®loc


	)

19 
	#ä“
 
j‘_ä“


	)

20 
	#m®locx
 
j‘_m®locx


	)

21 
	#¿Îocx
 
j‘_¿Îocx


	)

22 
	#x®locx
 
j‘_x®locx


	)

23 
	#§Îocx
 
j‘_§Îocx


	)

24 
	#d®locx
 
j‘_d®locx


	)

25 
	#sd®locx
 
j‘_sd®locx


	)

26 
	#ÇÎocx
 
j‘_ÇÎocx


	)

27 
	#m®lùl
 
j‘_m®lùl


	)

28 
	#m®lùÊam‘omib
 
j‘_m®lùÊam‘omib


	)

29 
	#m®lùlbymib
 
j‘_m®lùlbymib


	)

30 
	#m®loc_¡©s_´št
 
j‘_m®loc_¡©s_´št


	)

31 
	#m®loc_u§bË_size
 
j‘_m®loc_u§bË_size


	)

32 
	#mem®ign
 
j‘_mem®ign


	)

33 
	#v®loc
 
j‘_v®loc


	)

43 #iâdeà
JEMALLOC_NO_DEMANGLE


44 #undeà
j‘_m®loc_cÚf


45 #undeà
j‘_m®loc_mes§ge


46 #undeà
j‘_m®loc


47 #undeà
j‘_ÿÎoc


48 #undeà
j‘_posix_mem®ign


49 #undeà
j‘_®igÃd_®loc


50 #undeà
j‘_»®loc


51 #undeà
j‘_ä“


52 #undeà
j‘_m®locx


53 #undeà
j‘_¿Îocx


54 #undeà
j‘_x®locx


55 #undeà
j‘_§Îocx


56 #undeà
j‘_d®locx


57 #undeà
j‘_sd®locx


58 #undeà
j‘_ÇÎocx


59 #undeà
j‘_m®lùl


60 #undeà
j‘_m®lùÊam‘omib


61 #undeà
j‘_m®lùlbymib


62 #undeà
j‘_m®loc_¡©s_´št


63 #undeà
j‘_m®loc_u§bË_size


64 #undeà
j‘_mem®ign


65 #undeà
j‘_v®loc


	@deps/jemalloc/include/jemalloc/jemalloc_protos.h

6 
JEMALLOC_EXPORT
 cÚ¡ *
je_m®loc_cÚf
;

7 
JEMALLOC_EXPORT
 (*
je_m®loc_mes§ge
)(*
cbİaque
,

8 cÚ¡ *
s
);

10 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


11 
JEMALLOC_NOTHROW
 *
	$je_m®loc
(
size_t
 
size
)

12 
JEMALLOC_CXX_THROW
 
	$JEMALLOC_ATTR
(
m®loc
è
	`JEMALLOC_ALLOC_SIZE
(1);

13 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


14 
JEMALLOC_NOTHROW
 *
	$je_ÿÎoc
(
size_t
 
num
, size_ˆ
size
)

15 
JEMALLOC_CXX_THROW
 
	$JEMALLOC_ATTR
(
m®loc
è
	`JEMALLOC_ALLOC_SIZE2
(1, 2);

16 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	$je_posix_mem®ign
(**
mem±r
,

17 
size_t
 
®ignm’t
, size_ˆ
size
è
JEMALLOC_CXX_THROW
 
	`JEMALLOC_ATTR
(
	`nÚnuÎ
(1));

18 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


19 
JEMALLOC_NOTHROW
 *
	$je_®igÃd_®loc
(
size_t
 
®ignm’t
,

20 
size_t
 
size
è
JEMALLOC_CXX_THROW
 
	$JEMALLOC_ATTR
(
m®loc
)

21 
	`JEMALLOC_ALLOC_SIZE
(2);

22 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


23 
JEMALLOC_NOTHROW
 *
	$je_»®loc
(*
±r
, 
size_t
 
size
)

24 
JEMALLOC_CXX_THROW
 
	`JEMALLOC_ALLOC_SIZE
(2);

25 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	$je_ä“
(*
±r
)

26 
JEMALLOC_CXX_THROW
;

28 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


29 
JEMALLOC_NOTHROW
 *
	$je_m®locx
(
size_t
 
size
, 
æags
)

30 
	$JEMALLOC_ATTR
(
m®loc
è
	`JEMALLOC_ALLOC_SIZE
(1);

31 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


32 
JEMALLOC_NOTHROW
 *
	$je_¿Îocx
(*
±r
, 
size_t
 
size
,

33 
æags
è
	`JEMALLOC_ALLOC_SIZE
(2);

34 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
	`je_x®locx
(*
±r
, size_ˆ
size
,

35 
size_t
 
exŒa
, 
æags
);

36 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
	$je_§Îocx
(cÚ¡ *
±r
,

37 
æags
è
	`JEMALLOC_ATTR
(
pu»
);

38 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`je_d®locx
(*
±r
, 
æags
);

39 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`je_sd®locx
(*
±r
, 
size_t
 
size
,

40 
æags
);

41 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
	$je_ÇÎocx
(
size_t
 
size
, 
æags
)

42 
	`JEMALLOC_ATTR
(
pu»
);

44 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`je_m®lùl
(cÚ¡ *
Çme
,

45 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
);

46 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`je_m®lùÊam‘omib
(cÚ¡ *
Çme
,

47 
size_t
 *
mibp
, size_ˆ*
mibËÅ
);

48 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`je_m®lùlbymib
(cÚ¡ 
size_t
 *
mib
,

49 
size_t
 
mibËn
, *
Şdp
, size_ˆ*
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
);

50 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`je_m®loc_¡©s_´št
(

51 (*
wr™e_cb
)(*, cÚ¡ *), *
je_cbİaque
,

52 cÚ¡ *
İts
);

53 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
	$je_m®loc_u§bË_size
(

54 
JEMALLOC_USABLE_SIZE_CONST
 *
±r
è
JEMALLOC_CXX_THROW
;

56 #ifdeà
JEMALLOC_OVERRIDE_MEMALIGN


57 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


58 
JEMALLOC_NOTHROW
 *
	$je_mem®ign
(
size_t
 
®ignm’t
, size_ˆ
size
)

59 
JEMALLOC_CXX_THROW
 
	`JEMALLOC_ATTR
(
m®loc
);

62 #ifdeà
JEMALLOC_OVERRIDE_VALLOC


63 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


64 
JEMALLOC_NOTHROW
 *
	$je_v®loc
(
size_t
 
size
è
JEMALLOC_CXX_THROW


65 
	`JEMALLOC_ATTR
(
m®loc
);

	@deps/jemalloc/include/jemalloc/jemalloc_protos_jet.h

6 
JEMALLOC_EXPORT
 cÚ¡ *
j‘_m®loc_cÚf
;

7 
JEMALLOC_EXPORT
 (*
j‘_m®loc_mes§ge
)(*
cbİaque
,

8 cÚ¡ *
s
);

10 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


11 
JEMALLOC_NOTHROW
 *
	$j‘_m®loc
(
size_t
 
size
)

12 
JEMALLOC_CXX_THROW
 
	$JEMALLOC_ATTR
(
m®loc
è
	`JEMALLOC_ALLOC_SIZE
(1);

13 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


14 
JEMALLOC_NOTHROW
 *
	$j‘_ÿÎoc
(
size_t
 
num
, size_ˆ
size
)

15 
JEMALLOC_CXX_THROW
 
	$JEMALLOC_ATTR
(
m®loc
è
	`JEMALLOC_ALLOC_SIZE2
(1, 2);

16 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	$j‘_posix_mem®ign
(**
mem±r
,

17 
size_t
 
®ignm’t
, size_ˆ
size
è
JEMALLOC_CXX_THROW
 
	`JEMALLOC_ATTR
(
	`nÚnuÎ
(1));

18 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


19 
JEMALLOC_NOTHROW
 *
	$j‘_®igÃd_®loc
(
size_t
 
®ignm’t
,

20 
size_t
 
size
è
JEMALLOC_CXX_THROW
 
	$JEMALLOC_ATTR
(
m®loc
)

21 
	`JEMALLOC_ALLOC_SIZE
(2);

22 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


23 
JEMALLOC_NOTHROW
 *
	$j‘_»®loc
(*
±r
, 
size_t
 
size
)

24 
JEMALLOC_CXX_THROW
 
	`JEMALLOC_ALLOC_SIZE
(2);

25 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	$j‘_ä“
(*
±r
)

26 
JEMALLOC_CXX_THROW
;

28 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


29 
JEMALLOC_NOTHROW
 *
	$j‘_m®locx
(
size_t
 
size
, 
æags
)

30 
	$JEMALLOC_ATTR
(
m®loc
è
	`JEMALLOC_ALLOC_SIZE
(1);

31 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


32 
JEMALLOC_NOTHROW
 *
	$j‘_¿Îocx
(*
±r
, 
size_t
 
size
,

33 
æags
è
	`JEMALLOC_ALLOC_SIZE
(2);

34 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
	`j‘_x®locx
(*
±r
, size_ˆ
size
,

35 
size_t
 
exŒa
, 
æags
);

36 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
	$j‘_§Îocx
(cÚ¡ *
±r
,

37 
æags
è
	`JEMALLOC_ATTR
(
pu»
);

38 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`j‘_d®locx
(*
±r
, 
æags
);

39 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`j‘_sd®locx
(*
±r
, 
size_t
 
size
,

40 
æags
);

41 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
	$j‘_ÇÎocx
(
size_t
 
size
, 
æags
)

42 
	`JEMALLOC_ATTR
(
pu»
);

44 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`j‘_m®lùl
(cÚ¡ *
Çme
,

45 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
);

46 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`j‘_m®lùÊam‘omib
(cÚ¡ *
Çme
,

47 
size_t
 *
mibp
, size_ˆ*
mibËÅ
);

48 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`j‘_m®lùlbymib
(cÚ¡ 
size_t
 *
mib
,

49 
size_t
 
mibËn
, *
Şdp
, size_ˆ*
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
);

50 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW
 
	`j‘_m®loc_¡©s_´št
(

51 (*
wr™e_cb
)(*, cÚ¡ *), *
j‘_cbİaque
,

52 cÚ¡ *
İts
);

53 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW
 
	$j‘_m®loc_u§bË_size
(

54 
JEMALLOC_USABLE_SIZE_CONST
 *
±r
è
JEMALLOC_CXX_THROW
;

56 #ifdeà
JEMALLOC_OVERRIDE_MEMALIGN


57 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


58 
JEMALLOC_NOTHROW
 *
	$j‘_mem®ign
(
size_t
 
®ignm’t
, size_ˆ
size
)

59 
JEMALLOC_CXX_THROW
 
	`JEMALLOC_ATTR
(
m®loc
);

62 #ifdeà
JEMALLOC_OVERRIDE_VALLOC


63 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


64 
JEMALLOC_NOTHROW
 *
	$j‘_v®loc
(
size_t
 
size
è
JEMALLOC_CXX_THROW


65 
	`JEMALLOC_ATTR
(
m®loc
);

	@deps/jemalloc/include/jemalloc/jemalloc_rename.h

6 #iâdeà
JEMALLOC_NO_RENAME


7 
	#je_m®loc_cÚf
 
je_m®loc_cÚf


	)

8 
	#je_m®loc_mes§ge
 
je_m®loc_mes§ge


	)

9 
	#je_m®loc
 
je_m®loc


	)

10 
	#je_ÿÎoc
 
je_ÿÎoc


	)

11 
	#je_posix_mem®ign
 
je_posix_mem®ign


	)

12 
	#je_®igÃd_®loc
 
je_®igÃd_®loc


	)

13 
	#je_»®loc
 
je_»®loc


	)

14 
	#je_ä“
 
je_ä“


	)

15 
	#je_m®locx
 
je_m®locx


	)

16 
	#je_¿Îocx
 
je_¿Îocx


	)

17 
	#je_x®locx
 
je_x®locx


	)

18 
	#je_§Îocx
 
je_§Îocx


	)

19 
	#je_d®locx
 
je_d®locx


	)

20 
	#je_sd®locx
 
je_sd®locx


	)

21 
	#je_ÇÎocx
 
je_ÇÎocx


	)

22 
	#je_m®lùl
 
je_m®lùl


	)

23 
	#je_m®lùÊam‘omib
 
je_m®lùÊam‘omib


	)

24 
	#je_m®lùlbymib
 
je_m®lùlbymib


	)

25 
	#je_m®loc_¡©s_´št
 
je_m®loc_¡©s_´št


	)

26 
	#je_m®loc_u§bË_size
 
je_m®loc_u§bË_size


	)

27 
	#je_mem®ign
 
je_mem®ign


	)

28 
	#je_v®loc
 
je_v®loc


	)

	@deps/jemalloc/include/jemalloc/jemalloc_typedefs.h

6 *(
	tchunk_®loc_t
)(*, 
	tsize_t
, size_t, 
	tboŞ
 *, bool *, );

12 
	$boŞ
 (
	tchunk_d®loc_t
)(*, 
	tsize_t
, 
	tboŞ
, );

19 
	$boŞ
 (
	tchunk_comm™_t
)(*, 
	tsize_t
, size_t, size_t, );

26 
	$boŞ
 (
	tchunk_decomm™_t
)(*, 
	tsize_t
, size_t, size_t, );

33 
	$boŞ
 (
	tchunk_purge_t
)(*, 
	tsize_t
, size_t, size_t, );

40 
	$boŞ
 (
	tchunk_¥l™_t
)(*, 
	tsize_t
, size_t, size_t, 
	tboŞ
, );

47 
	$boŞ
 (
	tchunk_m”ge_t
)(*, 
	tsize_t
, *, size_t, 
	tboŞ
, );

50 
chunk_®loc_t
 *
®loc
;

51 
chunk_d®loc_t
 *
d®loc
;

52 
chunk_comm™_t
 *
comm™
;

53 
chunk_decomm™_t
 *
decomm™
;

54 
chunk_purge_t
 *
purge
;

55 
chunk_¥l™_t
 *
¥l™
;

56 
chunk_m”ge_t
 *
m”ge
;

57 } 
	tchunk_hooks_t
;

	@deps/jemalloc/include/msvc_compat/C99/stdbool.h

1 #iâdeà
¡dboŞ_h


2 
	#¡dboŞ_h


	)

4 
	~<wty³s.h
>

10 #iâdeà
__şªg__


11 
BOOL
 
	t_BoŞ
;

14 
	#boŞ
 
_BoŞ


	)

15 
	#Œue
 1

	)

16 
	#çl£
 0

	)

18 
	#__boŞ_Œue_çl£_¬e_defšed
 1

	)

	@deps/jemalloc/include/msvc_compat/C99/stdint.h

32 #iâdeà
_MSC_VER


36 #iâdeà
_MSC_STDINT_H_


37 
	#_MSC_STDINT_H_


	)

39 #ià
_MSC_VER
 > 1000

40 #´agm¨
Úû


43 
	~<lim™s.h
>

49 #ifdeà
__ılu¥lus


52 
	~<wch¬.h
>

53 #ifdeà
__ılu¥lus


58 #iâdeà
_W64


59 #ià!
defšed
(
__midl
è&& (defšed(
_X86_
è|| defšed(
_M_IX86
)è&& 
_MSC_VER
 >= 1300

60 
	#_W64
 
__w64


	)

62 
	#_W64


	)

74 #ià(
_MSC_VER
 < 1300)

75 sigÃd 
	tšt8_t
;

76 sigÃd 
	tšt16_t
;

77 sigÃd 
	tšt32_t
;

78 
	tušt8_t
;

79 
	tušt16_t
;

80 
	tušt32_t
;

82 sigÃd 
	t__št8
 
	tšt8_t
;

83 sigÃd 
	t__št16
 
	tšt16_t
;

84 sigÃd 
	t__št32
 
	tšt32_t
;

85 
	t__št8
 
	tušt8_t
;

86 
	t__št16
 
	tušt16_t
;

87 
	t__št32
 
	tušt32_t
;

89 sigÃd 
	t__št64
 
	tšt64_t
;

90 
	t__št64
 
	tušt64_t
;

94 
št8_t
 
	tšt_Ëa¡8_t
;

95 
št16_t
 
	tšt_Ëa¡16_t
;

96 
št32_t
 
	tšt_Ëa¡32_t
;

97 
št64_t
 
	tšt_Ëa¡64_t
;

98 
ušt8_t
 
	tušt_Ëa¡8_t
;

99 
ušt16_t
 
	tušt_Ëa¡16_t
;

100 
ušt32_t
 
	tušt_Ëa¡32_t
;

101 
ušt64_t
 
	tušt_Ëa¡64_t
;

104 
št8_t
 
	tšt_ç¡8_t
;

105 
št16_t
 
	tšt_ç¡16_t
;

106 
št32_t
 
	tšt_ç¡32_t
;

107 
št64_t
 
	tšt_ç¡64_t
;

108 
ušt8_t
 
	tušt_ç¡8_t
;

109 
ušt16_t
 
	tušt_ç¡16_t
;

110 
ušt32_t
 
	tušt_ç¡32_t
;

111 
ušt64_t
 
	tušt_ç¡64_t
;

114 #ifdeà
_WIN64


115 sigÃd 
	t__št64
 
	tšŒ_t
;

116 
	t__št64
 
	tušŒ_t
;

118 
_W64
 sigÃd 
	tšŒ_t
;

119 
_W64
 
	tušŒ_t
;

123 
št64_t
 
	tštmax_t
;

124 
ušt64_t
 
	tuštmax_t
;

129 #ià!
defšed
(
__ılu¥lus
è|| defšed(
__STDC_LIMIT_MACROS
)

132 
	#INT8_MIN
 ((
št8_t
)
_I8_MIN
)

	)

133 
	#INT8_MAX
 
_I8_MAX


	)

134 
	#INT16_MIN
 ((
št16_t
)
_I16_MIN
)

	)

135 
	#INT16_MAX
 
_I16_MAX


	)

136 
	#INT32_MIN
 ((
št32_t
)
_I32_MIN
)

	)

137 
	#INT32_MAX
 
_I32_MAX


	)

138 
	#INT64_MIN
 ((
št64_t
)
_I64_MIN
)

	)

139 
	#INT64_MAX
 
_I64_MAX


	)

140 
	#UINT8_MAX
 
_UI8_MAX


	)

141 
	#UINT16_MAX
 
_UI16_MAX


	)

142 
	#UINT32_MAX
 
_UI32_MAX


	)

143 
	#UINT64_MAX
 
_UI64_MAX


	)

146 
	#INT_LEAST8_MIN
 
INT8_MIN


	)

147 
	#INT_LEAST8_MAX
 
INT8_MAX


	)

148 
	#INT_LEAST16_MIN
 
INT16_MIN


	)

149 
	#INT_LEAST16_MAX
 
INT16_MAX


	)

150 
	#INT_LEAST32_MIN
 
INT32_MIN


	)

151 
	#INT_LEAST32_MAX
 
INT32_MAX


	)

152 
	#INT_LEAST64_MIN
 
INT64_MIN


	)

153 
	#INT_LEAST64_MAX
 
INT64_MAX


	)

154 
	#UINT_LEAST8_MAX
 
UINT8_MAX


	)

155 
	#UINT_LEAST16_MAX
 
UINT16_MAX


	)

156 
	#UINT_LEAST32_MAX
 
UINT32_MAX


	)

157 
	#UINT_LEAST64_MAX
 
UINT64_MAX


	)

160 
	#INT_FAST8_MIN
 
INT8_MIN


	)

161 
	#INT_FAST8_MAX
 
INT8_MAX


	)

162 
	#INT_FAST16_MIN
 
INT16_MIN


	)

163 
	#INT_FAST16_MAX
 
INT16_MAX


	)

164 
	#INT_FAST32_MIN
 
INT32_MIN


	)

165 
	#INT_FAST32_MAX
 
INT32_MAX


	)

166 
	#INT_FAST64_MIN
 
INT64_MIN


	)

167 
	#INT_FAST64_MAX
 
INT64_MAX


	)

168 
	#UINT_FAST8_MAX
 
UINT8_MAX


	)

169 
	#UINT_FAST16_MAX
 
UINT16_MAX


	)

170 
	#UINT_FAST32_MAX
 
UINT32_MAX


	)

171 
	#UINT_FAST64_MAX
 
UINT64_MAX


	)

174 #ifdeà
_WIN64


175 
	#INTPTR_MIN
 
INT64_MIN


	)

176 
	#INTPTR_MAX
 
INT64_MAX


	)

177 
	#UINTPTR_MAX
 
UINT64_MAX


	)

179 
	#INTPTR_MIN
 
INT32_MIN


	)

180 
	#INTPTR_MAX
 
INT32_MAX


	)

181 
	#UINTPTR_MAX
 
UINT32_MAX


	)

185 
	#INTMAX_MIN
 
INT64_MIN


	)

186 
	#INTMAX_MAX
 
INT64_MAX


	)

187 
	#UINTMAX_MAX
 
UINT64_MAX


	)

191 #ifdeà
_WIN64


192 
	#PTRDIFF_MIN
 
_I64_MIN


	)

193 
	#PTRDIFF_MAX
 
_I64_MAX


	)

195 
	#PTRDIFF_MIN
 
_I32_MIN


	)

196 
	#PTRDIFF_MAX
 
_I32_MAX


	)

199 
	#SIG_ATOMIC_MIN
 
INT_MIN


	)

200 
	#SIG_ATOMIC_MAX
 
INT_MAX


	)

202 #iâdeà
SIZE_MAX


203 #ifdeà
_WIN64


204 
	#SIZE_MAX
 
_UI64_MAX


	)

206 
	#SIZE_MAX
 
_UI32_MAX


	)

211 #iâdeà
WCHAR_MIN


212 
	#WCHAR_MIN
 0

	)

214 #iâdeà
WCHAR_MAX


215 
	#WCHAR_MAX
 
_UI16_MAX


	)

218 
	#WINT_MIN
 0

	)

219 
	#WINT_MAX
 
_UI16_MAX


	)

226 #ià!
defšed
(
__ılu¥lus
è|| defšed(
__STDC_CONSTANT_MACROS
)

230 
	#INT8_C
(
v®
èv®##
i8


	)

231 
	#INT16_C
(
v®
èv®##
i16


	)

232 
	#INT32_C
(
v®
èv®##
i32


	)

233 
	#INT64_C
(
v®
èv®##
i64


	)

235 
	#UINT8_C
(
v®
èv®##
ui8


	)

236 
	#UINT16_C
(
v®
èv®##
ui16


	)

237 
	#UINT32_C
(
v®
èv®##
ui32


	)

238 
	#UINT64_C
(
v®
èv®##
ui64


	)

241 
	#INTMAX_C
 
INT64_C


	)

242 
	#UINTMAX_C
 
UINT64_C


	)

	@deps/jemalloc/include/msvc_compat/strings.h

1 #iâdeà
¡ršgs_h


2 
	#¡ršgs_h


	)

6 #ifdeà
_MSC_VER


7 
	~<šŒš.h
>

8 #´agm¨
šŒšsic
(
_B™SÿnFÜw¬d
)

9 
__fÜûšlše
 
	$ff¦
(
x
)

11 
i
;

13 ià(
	`_B™SÿnFÜw¬d
(&
i
, 
x
))

14  (
i
 + 1);

16 
	}
}

18 
__fÜûšlše
 
	$ffs
(
x
)

21  (
	`ff¦
(
x
));

22 
	}
}

24 #ifdeà 
_M_X64


25 #´agm¨
šŒšsic
(
_B™SÿnFÜw¬d64
)

28 
__fÜûšlše
 
	$ff¦l
(
__št64
 
x
)

30 
i
;

31 #ifdeà 
_M_X64


32 ià(
	`_B™SÿnFÜw¬d64
(&
i
, 
x
))

33  (
i
 + 1);

39 
__št64
 
Î
;

40 
l
[2];

41 } 
s
;

43 
s
.
Î
 = 
x
;

45 ià(
	`_B™SÿnFÜw¬d
(&
i
, 
s
.
l
[0]))

46  (
i
 + 1);

47 if(
	`_B™SÿnFÜw¬d
(&
i
, 
s
.
l
[1]))

48  (
i
 + 33);

51 
	}
}

54 
	#ff¦l
(
x
è
	`__butš_ff¦l
(x)

	)

55 
	#ff¦
(
x
è
	`__butš_ff¦
(x)

	)

56 
	#ffs
(
x
è
	`__butš_ffs
(x)

	)

	@deps/jemalloc/include/msvc_compat/windows_extra.h

1 #iâdeà
MSVC_COMPAT_WINDOWS_EXTRA_H


2 
	#MSVC_COMPAT_WINDOWS_EXTRA_H


	)

4 
	~<”ºo.h
>

	@deps/jemalloc/msvc/projects/vc2015/test_threads/test_threads.cpp

5 
	~<©omic
>

6 
	~<funùiÚ®
>

7 
	~<futu»
>

8 
	~<¿ndom
>

9 
	~<th»ad
>

10 
	~<veùÜ
>

11 
	~<¡dio.h
>

12 
	~<jem®loc/jem®loc.h
>

14 
usšg
 
	g¡d
::
veùÜ
;

15 
usšg
 
	g¡d
::
th»ad
;

16 
usšg
 
	g¡d
::
unifÜm_št_di¡ributiÚ
;

17 
usšg
 
	g¡d
::
mš¡d_¿nd
;

19 
	$‹¡_th»ads
()

21 
je_m®loc_cÚf
 = "narenas:3";

22 
Ç»Çs
 = 0;

23 
size_t
 
sz
 = (
Ç»Çs
);

24 
	`je_m®lùl
("İt.Ç»Çs", (*)&
Ç»Çs
, &
sz
, 
NULL
, 0);

25 ià(
Ç»Çs
 != 3) {

26 
	`´štf
("E¼Ü: uÃx³ùed‚umb” oà¬’as: %d\n", 
Ç»Çs
);

29 cÚ¡ 
sizes
[] = { 7, 16, 32, 60, 91, 100, 120, 144, 169, 199, 255, 400, 670, 900, 917, 1025, 3333, 5190, 13131, 49192, 99999, 123123, 255265, 2333111 };

30 cÚ¡ 
numSizes
 = ()((
sizes
) / (sizes[0]));

31 
veùÜ
<
th»ad
> 
wÜk”s
;

32 cÚ¡ 
numTh»ads
 = 
Ç»Çs
 + 1, 
numAÎocsMax
 = 25, 
numI‹r1
 = 50, 
numI‹r2
 = 50;

33 
	`je_m®loc_¡©s_´št
(
NULL
, NULL, NULL);

34 
size_t
 
®loÿ‹d1
;

35 
size_t
 
sz1
 = (
®loÿ‹d1
);

36 
	`je_m®lùl
("¡©s.aùive", (*)&
®loÿ‹d1
, &
sz1
, 
NULL
, 0);

37 
	`´štf
("\nPress Entero starthreads...\n");

38 
	`g‘ch¬
();

39 
	`´štf
("S¹šg %dh»ad x %d x %d i‹¿tiÚs...\n", 
numTh»ads
, 
numI‹r1
, 
numI‹r2
);

40 
i
 = 0; i < 
numTh»ads
; i++) {

41 
wÜk”s
.
	`em¶aû_back
([
tid
=
i
]() {

42 
unifÜm_št_di¡ributiÚ
<> 
	`sizeDi¡
(0, 
numSizes
 - 1);

43 
mš¡d_¿nd
 
	`ºd
(
tid
 * 17);

44 
ušt8_t
* 
±rs
[
numAÎocsMax
];

45 
±rsz
[
numAÎocsMax
];

46 
i
 = 0; i < 
numI‹r1
; ++i) {

47 
th»ad
 
	`t
([&]() {

48 
i
 = 0; i < 
numI‹r2
; ++i) {

49 cÚ¡ 
numAÎocs
 = 
numAÎocsMax
 - 
	`sizeDi¡
(
ºd
);

50 
j
 = 0; j < 
numAÎocs
; j += 64) {

51 cÚ¡ 
x
 = 
	`sizeDi¡
(
ºd
);

52 cÚ¡ 
sz
 = 
sizes
[
x
];

53 
±rsz
[
j
] = 
sz
;

54 
±rs
[
j
] = (
ušt8_t
*)
	`je_m®loc
(
sz
);

55 ià(!
±rs
[
j
]) {

56 
	`´štf
("UÇbËØ®loÿ‹ %d by‹ šh»ad %d, i‹¸%d,‡Îoø%d. %d\n", 
sz
, 
tid
, 
i
, 
j
, 
x
);

57 
	`ex™
(1);

59 
k
 = 0; k < 
sz
; k++)

60 
±rs
[
j
][
k
] = 
tid
 + k;

62 
j
 = 0; j < 
numAÎocs
; j += 64) {

63 
k
 = 0, 
sz
 = 
±rsz
[
j
]; k < sz; k++)

64 ià(
±rs
[
j
][
k
] !ğ(
ušt8_t
)(
tid
 + k)) {

65 
	`´štf
("MemÜyƒ¼Ü iÀth»ad %d, i‹¸%d,‡Îoø%d @ %d : %02X!=%02X\n", 
tid
, 
i
, 
j
, 
k
, 
±rs
[j][k], (
ušt8_t
)(tid + k));

66 
	`ex™
(1);

68 
	`je_ä“
(
±rs
[
j
]);

72 
t
.
	`još
();

76 
th»ad
& 
t
 : 
wÜk”s
) {

77 
t
.
	`još
();

79 
	`je_m®loc_¡©s_´št
(
NULL
, NULL, NULL);

80 
size_t
 
®loÿ‹d2
;

81 
	`je_m®lùl
("¡©s.aùive", (*)&
®loÿ‹d2
, &
sz1
, 
NULL
, 0);

82 
size_t
 
Ëaked
 = 
®loÿ‹d2
 - 
®loÿ‹d1
;

83 
	`´štf
("\nDÚe. L—ked: %zd by‹s\n", 
Ëaked
);

84 
boŞ
 
çed
 = 
Ëaked
 > 65536;

85 
	`´štf
("\nTe¡ %s!\n", (
çed
 ? "FAILED" : "successful"));

86 
	`´štf
("\nPress Entero continue...\n");

87 
	`g‘ch¬
();

88  
çed
 ? 1 : 0;

89 
	}
}

	@deps/jemalloc/msvc/projects/vc2015/test_threads/test_threads.h

1 #´agm¨
Úû


3 
‹¡_th»ads
();

	@deps/jemalloc/msvc/projects/vc2015/test_threads/test_threads_main.cpp

1 
	~"‹¡_th»ads.h
"

2 
	~<futu»
>

3 
	~<funùiÚ®
>

4 
	~<chrÚo
>

6 
usšg
 
Çme¥aû
 
	g¡d
::
chrÚo_l™”®s
;

8 
	$maš
(
¬gc
, ** 
¬gv
)

10 
rc
 = 
	`‹¡_th»ads
();

11  
rc
;

12 
	}
}

	@deps/jemalloc/src/arena.c

1 
	#JEMALLOC_ARENA_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

7 
purge_mode_t
 
	gİt_purge
 = 
PURGE_DEFAULT
;

8 cÚ¡ *
	gpurge_mode_Çmes
[] = {

13 
ssize_t
 
	gİt_lg_dœty_muÉ
 = 
LG_DIRTY_MULT_DEFAULT
;

14 
ssize_t
 
	glg_dœty_muÉ_deçuÉ
;

15 
ssize_t
 
	gİt_deÿy_time
 = 
DECAY_TIME_DEFAULT
;

16 
ssize_t
 
	gdeÿy_time_deçuÉ
;

18 
¬’a_bš_šfo_t
 
	g¬’a_bš_šfo
[
NBINS
];

20 
size_t
 
	gm­_bŸs
;

21 
size_t
 
	gm­_misc_off£t
;

22 
size_t
 
	g¬’a_maxrun
;

23 
size_t
 
	gÏrge_maxşass
;

24 
	gÆşas£s
;

25 
	gnhşas£s
;

33 
¬’a_chunk_d®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

34 
¬’a_chunk_t
 *
chunk
);

35 
¬’a_purge_to_lim™
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

36 
size_t
 
ndœty_lim™
);

37 
¬’a_run_d®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_run_t
 *
run
,

38 
boŞ
 
dœty
, boŞ 
ş—Ãd
, boŞ 
decomm™‹d
);

39 
¬’a_d®loc_bš_run
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

40 
¬’a_chunk_t
 *
chunk
, 
¬’a_run_t
 *
run
, 
¬’a_bš_t
 *
bš
);

41 
¬’a_bš_low”_run
(
¬’a_t
 *
¬’a
, 
¬’a_run_t
 *
run
,

42 
¬’a_bš_t
 *
bš
);

46 
JEMALLOC_INLINE_C
 
size_t


47 
	$¬’a_misûlm_size_g‘
(cÚ¡ 
¬’a_chunk_m­_misc_t
 *
misûlm
)

49 
¬’a_chunk_t
 *
chunk
;

50 
size_t
 
·gešd
, 
m­b™s
;

52 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
misûlm
);

53 
·gešd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

54 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

55  (
	`¬’a_m­b™s_size_decode
(
m­b™s
));

56 
	}
}

58 
JEMALLOC_INLINE_C
 cÚ¡ 
ex‹Á_node_t
 *

59 
	$¬’a_misûlm_ex‹Á_g‘
(cÚ¡ 
¬’a_chunk_m­_misc_t
 *
misûlm
)

61 
¬’a_chunk_t
 *
chunk
;

63 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
misûlm
);

64  (&
chunk
->
node
);

65 
	}
}

67 
JEMALLOC_INLINE_C
 

68 
	$¬’a_¢_comp
(cÚ¡ 
¬’a_chunk_m­_misc_t
 *
a
, cÚ¡‡»Ç_chunk_m­_misc_ˆ*
b
)

70 
size_t
 
a_¢
, 
b_¢
;

72 
	`as£¹
(
a
 !ğ
NULL
);

73 
	`as£¹
(
b
 !ğ
NULL
);

75 
a_¢
 = 
	`ex‹Á_node_¢_g‘
(
	`¬’a_misûlm_ex‹Á_g‘
(
a
));

76 
b_¢
 = 
	`ex‹Á_node_¢_g‘
(
	`¬’a_misûlm_ex‹Á_g‘
(
b
));

78  ((
a_¢
 > 
b_¢
) - (a_sn < b_sn));

79 
	}
}

81 
JEMALLOC_INLINE_C
 

82 
	$¬’a_ad_comp
(cÚ¡ 
¬’a_chunk_m­_misc_t
 *
a
,

83 cÚ¡ 
¬’a_chunk_m­_misc_t
 *
b
)

85 
ušŒ_t
 
a_misûlm
 = (ušŒ_t)
a
;

86 
ušŒ_t
 
b_misûlm
 = (ušŒ_t)
b
;

88 
	`as£¹
(
a
 !ğ
NULL
);

89 
	`as£¹
(
b
 !ğ
NULL
);

91  ((
a_misûlm
 > 
b_misûlm
) - (a_miscelm < b_miscelm));

92 
	}
}

94 
JEMALLOC_INLINE_C
 

95 
	$¬’a_¢ad_comp
(cÚ¡ 
¬’a_chunk_m­_misc_t
 *
a
,

96 cÚ¡ 
¬’a_chunk_m­_misc_t
 *
b
)

98 
»t
;

100 
	`as£¹
(
a
 !ğ
NULL
);

101 
	`as£¹
(
b
 !ğ
NULL
);

103 
»t
 = 
	`¬’a_¢_comp
(
a
, 
b
);

104 ià(
»t
 != 0)

105  (
»t
);

107 
»t
 = 
	`¬’a_ad_comp
(
a
, 
b
);

108  (
»t
);

109 
	}
}

112 
	$ph_g’
(
UNUSED
, 
¬’a_run_h—p_
, 
¬’a_run_h—p_t
, 
¬’a_chunk_m­_misc_t
,

113 
ph_lšk
, 
¬’a_¢ad_comp
)

115 #ifdeà
JEMALLOC_JET


116 #undeà
run_quªtize_æoÜ


117 
	#run_quªtize_æoÜ
 
	`JEMALLOC_N
(
n_run_quªtize_æoÜ
)

	)

119 
size_t


120 
	$run_quªtize_æoÜ
(
size_t
 
size
)

122 
size_t
 
»t
;

123 
pszšd_t
 
pšd
;

125 
	`as£¹
(
size
 > 0);

126 
	`as£¹
(
size
 <ğ
HUGE_MAXCLASS
);

127 
	`as£¹
((
size
 & 
PAGE_MASK
) == 0);

129 
	`as£¹
(
size
 != 0);

130 
	`as£¹
(
size
 =ğ
	`PAGE_CEILING
(size));

132 
pšd
 = 
	`psz2šd
(
size
 - 
Ïrge_·d
 + 1);

133 ià(
pšd
 == 0) {

140  (
size
);

142 
»t
 = 
	`pšd2sz
(
pšd
 - 1è+ 
Ïrge_·d
;

143 
	`as£¹
(
»t
 <ğ
size
);

144  (
»t
);

145 
	}
}

146 #ifdeà
JEMALLOC_JET


147 #undeà
run_quªtize_æoÜ


148 
	#run_quªtize_æoÜ
 
	`JEMALLOC_N
(
run_quªtize_æoÜ
)

	)

149 
run_quªtize_t
 *
	grun_quªtize_æoÜ
 = 
JEMALLOC_N
(
n_run_quªtize_æoÜ
);

152 #ifdeà
JEMALLOC_JET


153 #undeà
run_quªtize_û


154 
	#run_quªtize_û
 
	`JEMALLOC_N
(
n_run_quªtize_û
)

	)

156 
size_t


157 
	$run_quªtize_û
(
size_t
 
size
)

159 
size_t
 
»t
;

161 
	`as£¹
(
size
 > 0);

162 
	`as£¹
(
size
 <ğ
HUGE_MAXCLASS
);

163 
	`as£¹
((
size
 & 
PAGE_MASK
) == 0);

165 
»t
 = 
	`run_quªtize_æoÜ
(
size
);

166 ià(
»t
 < 
size
) {

175 
»t
 = 
	`pšd2sz
(
	`psz2šd
Ô‘ - 
Ïrge_·d
 + 1)) +†arge_pad;

177  (
»t
);

178 
	}
}

179 #ifdeà
JEMALLOC_JET


180 #undeà
run_quªtize_û


181 
	#run_quªtize_û
 
	`JEMALLOC_N
(
run_quªtize_û
)

	)

182 
run_quªtize_t
 *
	grun_quªtize_û
 = 
JEMALLOC_N
(
n_run_quªtize_û
);

186 
	$¬’a_ava_š£¹
(
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

187 
size_t
 
Åages
)

189 
pszšd_t
 
pšd
 = 
	`psz2šd
(
	`run_quªtize_æoÜ
(
	`¬’a_misûlm_size_g‘
(

190 
	`¬’a_misûlm_g‘_cÚ¡
(
chunk
, 
·gešd
))));

191 
	`as£¹
(
Åages
 =ğ(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
·gešd
) >>

192 
LG_PAGE
));

193 
	`as£¹
((
Åages
 << 
LG_PAGE
è< 
chunksize
);

194 
	`as£¹
(
	`pšd2sz
(
pšd
è<ğ
chunksize
);

195 
	`¬’a_run_h—p_š£¹
(&
¬’a
->
runs_ava
[
pšd
],

196 
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
·gešd
));

197 
	}
}

200 
	$¬’a_ava_»move
(
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

201 
size_t
 
Åages
)

203 
pszšd_t
 
pšd
 = 
	`psz2šd
(
	`run_quªtize_æoÜ
(
	`¬’a_misûlm_size_g‘
(

204 
	`¬’a_misûlm_g‘_cÚ¡
(
chunk
, 
·gešd
))));

205 
	`as£¹
(
Åages
 =ğ(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
·gešd
) >>

206 
LG_PAGE
));

207 
	`as£¹
((
Åages
 << 
LG_PAGE
è< 
chunksize
);

208 
	`as£¹
(
	`pšd2sz
(
pšd
è<ğ
chunksize
);

209 
	`¬’a_run_h—p_»move
(&
¬’a
->
runs_ava
[
pšd
],

210 
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
·gešd
));

211 
	}
}

214 
	$¬’a_run_dœty_š£¹
(
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

215 
size_t
 
Åages
)

217 
¬’a_chunk_m­_misc_t
 *
misûlm
 = 
	`¬’a_misûlm_g‘_mubË
(
chunk
,

218 
·gešd
);

220 
	`as£¹
(
Åages
 =ğ(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
·gešd
) >>

221 
LG_PAGE
));

222 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
è=ğ
CHUNK_MAP_DIRTY
);

223 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
+
Åages
-1) ==

224 
CHUNK_MAP_DIRTY
);

226 
	`qr_Ãw
(&
misûlm
->
rd
, 
rd_lšk
);

227 
	`qr_m–d
(&
¬’a
->
runs_dœty
, &
misûlm
->
rd
, 
rd_lšk
);

228 
¬’a
->
ndœty
 +ğ
Åages
;

229 
	}
}

232 
	$¬’a_run_dœty_»move
(
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
, 
size_t
 
·gešd
,

233 
size_t
 
Åages
)

235 
¬’a_chunk_m­_misc_t
 *
misûlm
 = 
	`¬’a_misûlm_g‘_mubË
(
chunk
,

236 
·gešd
);

238 
	`as£¹
(
Åages
 =ğ(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
·gešd
) >>

239 
LG_PAGE
));

240 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
è=ğ
CHUNK_MAP_DIRTY
);

241 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
+
Åages
-1) ==

242 
CHUNK_MAP_DIRTY
);

244 
	`qr_»move
(&
misûlm
->
rd
, 
rd_lšk
);

245 
	`as£¹
(
¬’a
->
ndœty
 >ğ
Åages
);

246 
¬’a
->
ndœty
 -ğ
Åages
;

247 
	}
}

249 
size_t


250 
	$¬’a_chunk_dœty_Åages
(cÚ¡ 
ex‹Á_node_t
 *
node
)

253  (
	`ex‹Á_node_size_g‘
(
node
è>> 
LG_PAGE
);

254 
	}
}

257 
	$¬’a_chunk_ÿche_maybe_š£¹
(
¬’a_t
 *
¬’a
, 
ex‹Á_node_t
 *
node
, 
boŞ
 
ÿche
)

260 ià(
ÿche
) {

261 
	`ex‹Á_node_dœty_lškage_š™
(
node
);

262 
	`ex‹Á_node_dœty_š£¹
(
node
, &
¬’a
->
runs_dœty
,

263 &
¬’a
->
chunks_ÿche
);

264 
¬’a
->
ndœty
 +ğ
	`¬’a_chunk_dœty_Åages
(
node
);

266 
	}
}

269 
	$¬’a_chunk_ÿche_maybe_»move
(
¬’a_t
 *
¬’a
, 
ex‹Á_node_t
 *
node
, 
boŞ
 
dœty
)

272 ià(
dœty
) {

273 
	`ex‹Á_node_dœty_»move
(
node
);

274 
	`as£¹
(
¬’a
->
ndœty
 >ğ
	`¬’a_chunk_dœty_Åages
(
node
));

275 
¬’a
->
ndœty
 -ğ
	`¬’a_chunk_dœty_Åages
(
node
);

277 
	}
}

279 
JEMALLOC_INLINE_C
 *

280 
	$¬’a_run_»g_®loc
(
¬’a_run_t
 *
run
, 
¬’a_bš_šfo_t
 *
bš_šfo
)

282 *
»t
;

283 
size_t
 
»gšd
;

284 
¬’a_chunk_m­_misc_t
 *
misûlm
;

285 *
½ages
;

287 
	`as£¹
(
run
->
nä“
 > 0);

288 
	`as£¹
(!
	`b™m­_fuÎ
(
run
->
b™m­
, &
bš_šfo
->
b™m­_šfo
));

290 
»gšd
 = ()
	`b™m­_sfu
(
run
->
b™m­
, &
bš_šfo
->
b™m­_šfo
);

291 
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

292 
½ages
 = 
	`¬’a_misûlm_to_½ages
(
misûlm
);

293 
»t
 = (*)((
ušŒ_t
)
½ages
 + (ušŒ_t)
bš_šfo
->
»g0_off£t
 +

294 (
ušŒ_t
)(
bš_šfo
->
»g_š‹rv®
 * 
»gšd
));

295 
run
->
nä“
--;

296  (
»t
);

297 
	}
}

299 
JEMALLOC_INLINE_C
 

300 
	$¬’a_run_»g_d®loc
(
¬’a_run_t
 *
run
, *
±r
)

302 
¬’a_chunk_t
 *
chunk
 = (¬’a_chunk_ˆ*)
	`CHUNK_ADDR2BASE
(
run
);

303 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

304 
size_t
 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

305 
szšd_t
 
bššd
 = 
	`¬’a_±r_sm®l_bššd_g‘
(
±r
, 
m­b™s
);

306 
¬’a_bš_šfo_t
 *
bš_šfo
 = &
¬’a_bš_šfo
[
bššd
];

307 
size_t
 
»gšd
 = 
	`¬’a_run_»gšd
(
run
, 
bš_šfo
, 
±r
);

309 
	`as£¹
(
run
->
nä“
 < 
bš_šfo
->
Äegs
);

311 
	`as£¹
(((
ušŒ_t
)
±r
 -

312 ((
ušŒ_t
)
	`¬’a_misûlm_to_½ages
(
	`¬’a_run_to_misûlm
(
run
)) +

313 (
ušŒ_t
)
bš_šfo
->
»g0_off£t
)) %

314 (
ušŒ_t
)
bš_šfo
->
»g_š‹rv®
 == 0);

315 
	`as£¹
((
ušŒ_t
)
±r
 >=

316 (
ušŒ_t
)
	`¬’a_misûlm_to_½ages
(
	`¬’a_run_to_misûlm
(
run
)) +

317 (
ušŒ_t
)
bš_šfo
->
»g0_off£t
);

319 
	`as£¹
(
	`b™m­_g‘
(
run
->
b™m­
, &
bš_šfo
->
b™m­_šfo
, 
»gšd
));

321 
	`b™m­_un£t
(
run
->
b™m­
, &
bš_šfo
->
b™m­_šfo
, 
»gšd
);

322 
run
->
nä“
++;

323 
	}
}

325 
JEMALLOC_INLINE_C
 

326 
	$¬’a_run_z”o
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
run_šd
, size_ˆ
Åages
)

329 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
((*)((
ušŒ_t
)
chunk
 +

330 (
run_šd
 << 
LG_PAGE
)), (
Åages
 << LG_PAGE));

331 
	`mem£t
((*)((
ušŒ_t
)
chunk
 + (
run_šd
 << 
LG_PAGE
)), 0,

332 (
Åages
 << 
LG_PAGE
));

333 
	}
}

335 
JEMALLOC_INLINE_C
 

336 
	$¬’a_run_·ge_m¬k_z”Ûd
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
run_šd
)

339 
	`JEMALLOC_VALGRIND_MAKE_MEM_DEFINED
((*)((
ušŒ_t
)
chunk
 + (
run_šd


340 << 
LG_PAGE
)), 
PAGE
);

341 
	}
}

343 
JEMALLOC_INLINE_C
 

344 
	$¬’a_run_·ge_v®id©e_z”Ûd
(
¬’a_chunk_t
 *
chunk
, 
size_t
 
run_šd
)

346 
size_t
 
i
;

347 
UNUSED
 
size_t
 *
p
 = (size_ˆ*)((
ušŒ_t
)
chunk
 + (
run_šd
 << 
LG_PAGE
));

349 
	`¬’a_run_·ge_m¬k_z”Ûd
(
chunk
, 
run_šd
);

350 
i
 = 0; i < 
PAGE
 / (
size_t
); i++)

351 
	`as£¹
(
p
[
i
] == 0);

352 
	}
}

355 
	$¬’a_Çùive_add
(
¬’a_t
 *
¬’a
, 
size_t
 
add_·ges
)

358 ià(
cÚfig_¡©s
) {

359 
size_t
 
ÿùive_add
 = 
	`CHUNK_CEILING
((
¬’a
->
Çùive
 +

360 
add_·ges
è<< 
LG_PAGE
è- 
	`CHUNK_CEILING
(
¬’a
->
Çùive
 <<

361 
LG_PAGE
);

362 ià(
ÿùive_add
 != 0)

363 
	`¡©s_ÿùive_add
(
ÿùive_add
);

365 
¬’a
->
Çùive
 +ğ
add_·ges
;

366 
	}
}

369 
	$¬’a_Çùive_sub
(
¬’a_t
 *
¬’a
, 
size_t
 
sub_·ges
)

372 ià(
cÚfig_¡©s
) {

373 
size_t
 
ÿùive_sub
 = 
	`CHUNK_CEILING
(
¬’a
->
Çùive
 << 
LG_PAGE
) -

374 
	`CHUNK_CEILING
((
¬’a
->
Çùive
 - 
sub_·ges
è<< 
LG_PAGE
);

375 ià(
ÿùive_sub
 != 0)

376 
	`¡©s_ÿùive_sub
(
ÿùive_sub
);

378 
¬’a
->
Çùive
 -ğ
sub_·ges
;

379 
	}
}

382 
	$¬’a_run_¥l™_»move
(
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
, 
size_t
 
run_šd
,

383 
size_t
 
æag_dœty
, size_ˆ
æag_decomm™‹d
, size_ˆ
Ãed_·ges
)

385 
size_t
 
tÙ®_·ges
, 
»m_·ges
;

387 
	`as£¹
(
æag_dœty
 =ğ0 || 
æag_decomm™‹d
 == 0);

389 
tÙ®_·ges
 = 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
run_šd
) >>

390 
LG_PAGE
;

391 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
+
tÙ®_·ges
-1) ==

392 
æag_dœty
);

393 
	`as£¹
(
Ãed_·ges
 <ğ
tÙ®_·ges
);

394 
»m_·ges
 = 
tÙ®_·ges
 - 
Ãed_·ges
;

396 
	`¬’a_ava_»move
(
¬’a
, 
chunk
, 
run_šd
, 
tÙ®_·ges
);

397 ià(
æag_dœty
 != 0)

398 
	`¬’a_run_dœty_»move
(
¬’a
, 
chunk
, 
run_šd
, 
tÙ®_·ges
);

399 
	`¬’a_Çùive_add
(
¬’a
, 
Ãed_·ges
);

402 ià(
»m_·ges
 > 0) {

403 
size_t
 
æags
 = 
æag_dœty
 | 
æag_decomm™‹d
;

404 
size_t
 
æag_unz”Ûd_mask
 = (
æags
 =ğ0è? 
CHUNK_MAP_UNZEROED
 :

407 
	`¬’a_m­b™s_uÇÎoÿ‹d_£t
(
chunk
, 
run_šd
+
Ãed_·ges
,

408 (
»m_·ges
 << 
LG_PAGE
), 
æags
 |

409 (
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
run_šd
+
Ãed_·ges
) &

410 
æag_unz”Ûd_mask
));

411 
	`¬’a_m­b™s_uÇÎoÿ‹d_£t
(
chunk
, 
run_šd
+
tÙ®_·ges
-1,

412 (
»m_·ges
 << 
LG_PAGE
), 
æags
 |

413 (
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
run_šd
+
tÙ®_·ges
-1) &

414 
æag_unz”Ûd_mask
));

415 ià(
æag_dœty
 != 0) {

416 
	`¬’a_run_dœty_š£¹
(
¬’a
, 
chunk
, 
run_šd
+
Ãed_·ges
,

417 
»m_·ges
);

419 
	`¬’a_ava_š£¹
(
¬’a
, 
chunk
, 
run_šd
+
Ãed_·ges
, 
»m_·ges
);

421 
	}
}

423 
boŞ


424 
	$¬’a_run_¥l™_Ïrge_h–³r
(
¬’a_t
 *
¬’a
, 
¬’a_run_t
 *
run
, 
size_t
 
size
,

425 
boŞ
 
»move
, boŞ 
z”o
)

427 
¬’a_chunk_t
 *
chunk
;

428 
¬’a_chunk_m­_misc_t
 *
misûlm
;

429 
size_t
 
æag_dœty
, 
æag_decomm™‹d
, 
run_šd
, 
Ãed_·ges
;

430 
size_t
 
æag_unz”Ûd_mask
;

432 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
run
);

433 
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

434 
run_šd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

435 
æag_dœty
 = 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
);

436 
æag_decomm™‹d
 = 
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
run_šd
);

437 
Ãed_·ges
 = (
size
 >> 
LG_PAGE
);

438 
	`as£¹
(
Ãed_·ges
 > 0);

440 ià(
æag_decomm™‹d
 !ğ0 && 
¬’a
->
chunk_hooks
.
	`comm™
(
chunk
, 
chunksize
,

441 
run_šd
 << 
LG_PAGE
, 
size
, 
¬’a
->
šd
))

442  (
Œue
);

444 ià(
»move
) {

445 
	`¬’a_run_¥l™_»move
(
¬’a
, 
chunk
, 
run_šd
, 
æag_dœty
,

446 
æag_decomm™‹d
, 
Ãed_·ges
);

449 ià(
z”o
) {

450 ià(
æag_decomm™‹d
 != 0) {

452 
	`JEMALLOC_VALGRIND_MAKE_MEM_DEFINED
((

453 *)((
ušŒ_t
)
chunk
 + (
run_šd
 << 
LG_PAGE
)),

454 (
Ãed_·ges
 << 
LG_PAGE
));

455 } ià(
æag_dœty
 != 0) {

457 
	`¬’a_run_z”o
(
chunk
, 
run_šd
, 
Ãed_·ges
);

463 
size_t
 
i
;

464 
i
 = 0; i < 
Ãed_·ges
; i++) {

465 ià(
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
run_šd
+
i
)

467 
	`¬’a_run_z”o
(
chunk
, 
run_šd
+
i
, 1);

468 ià(
cÚfig_debug
) {

469 
	`¬’a_run_·ge_v®id©e_z”Ûd
(
chunk
,

470 
run_šd
+
i
);

472 
	`¬’a_run_·ge_m¬k_z”Ûd
(
chunk
,

473 
run_šd
+
i
);

478 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
((*)((
ušŒ_t
)
chunk
 +

479 (
run_šd
 << 
LG_PAGE
)), (
Ãed_·ges
 << LG_PAGE));

486 
æag_unz”Ûd_mask
 = (
æag_dœty
 | 
æag_decomm™‹d
) == 0 ?

487 
CHUNK_MAP_UNZEROED
 : 0;

488 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
run_šd
+
Ãed_·ges
-1, 0, 
æag_dœty
 |

489 (
æag_unz”Ûd_mask
 & 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
,

490 
run_šd
+
Ãed_·ges
-1)));

491 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
run_šd
, 
size
, 
æag_dœty
 |

492 (
æag_unz”Ûd_mask
 & 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
run_šd
)));

493  (
çl£
);

494 
	}
}

496 
boŞ


497 
	$¬’a_run_¥l™_Ïrge
(
¬’a_t
 *
¬’a
, 
¬’a_run_t
 *
run
, 
size_t
 
size
, 
boŞ
 
z”o
)

500  (
	`¬’a_run_¥l™_Ïrge_h–³r
(
¬’a
, 
run
, 
size
, 
Œue
, 
z”o
));

501 
	}
}

503 
boŞ


504 
	$¬’a_run_š™_Ïrge
(
¬’a_t
 *
¬’a
, 
¬’a_run_t
 *
run
, 
size_t
 
size
, 
boŞ
 
z”o
)

507  (
	`¬’a_run_¥l™_Ïrge_h–³r
(
¬’a
, 
run
, 
size
, 
çl£
, 
z”o
));

508 
	}
}

510 
boŞ


511 
	$¬’a_run_¥l™_sm®l
(
¬’a_t
 *
¬’a
, 
¬’a_run_t
 *
run
, 
size_t
 
size
,

512 
szšd_t
 
bššd
)

514 
¬’a_chunk_t
 *
chunk
;

515 
¬’a_chunk_m­_misc_t
 *
misûlm
;

516 
size_t
 
æag_dœty
, 
æag_decomm™‹d
, 
run_šd
, 
Ãed_·ges
, 
i
;

518 
	`as£¹
(
bššd
 !ğ
BININD_INVALID
);

520 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
run
);

521 
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

522 
run_šd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

523 
æag_dœty
 = 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
);

524 
æag_decomm™‹d
 = 
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
run_šd
);

525 
Ãed_·ges
 = (
size
 >> 
LG_PAGE
);

526 
	`as£¹
(
Ãed_·ges
 > 0);

528 ià(
æag_decomm™‹d
 !ğ0 && 
¬’a
->
chunk_hooks
.
	`comm™
(
chunk
, 
chunksize
,

529 
run_šd
 << 
LG_PAGE
, 
size
, 
¬’a
->
šd
))

530  (
Œue
);

532 
	`¬’a_run_¥l™_»move
(
¬’a
, 
chunk
, 
run_šd
, 
æag_dœty
,

533 
æag_decomm™‹d
, 
Ãed_·ges
);

535 
i
 = 0; i < 
Ãed_·ges
; i++) {

536 
size_t
 
æag_unz”Ûd
 = 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
,

537 
run_šd
+
i
);

538 
	`¬’a_m­b™s_sm®l_£t
(
chunk
, 
run_šd
+
i
, i, 
bššd
,

539 
æag_unz”Ûd
);

540 ià(
cÚfig_debug
 && 
æag_dœty
 =ğ0 && 
æag_unz”Ûd
 == 0)

541 
	`¬’a_run_·ge_v®id©e_z”Ûd
(
chunk
, 
run_šd
+
i
);

543 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
((*)((
ušŒ_t
)
chunk
 +

544 (
run_šd
 << 
LG_PAGE
)), (
Ãed_·ges
 << LG_PAGE));

545  (
çl£
);

546 
	}
}

548 
¬’a_chunk_t
 *

549 
	$¬’a_chunk_š™_¥¬e
(
¬’a_t
 *
¬’a
)

551 
¬’a_chunk_t
 *
chunk
;

553 
	`as£¹
(
¬’a
->
¥¬e
 !ğ
NULL
);

555 
chunk
 = 
¬’a
->
¥¬e
;

556 
¬’a
->
¥¬e
 = 
NULL
;

558 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
m­_bŸs
) == 0);

559 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
chunk_Åages
-1) == 0);

560 
	`as£¹
(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
m­_bŸs
) ==

561 
¬’a_maxrun
);

562 
	`as£¹
(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
chunk_Åages
-1) ==

563 
¬’a_maxrun
);

564 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
m­_bŸs
) ==

565 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
chunk_Åages
-1));

567  (
chunk
);

568 
	}
}

570 
boŞ


571 
	$¬’a_chunk_»gi¡”
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

572 
size_t
 
¢
, 
boŞ
 
z”o
)

581 
	`ex‹Á_node_š™
(&
chunk
->
node
, 
¬’a
, chunk, 
chunksize
, 
¢
, 
z”o
, 
Œue
);

582 
	`ex‹Á_node_achunk_£t
(&
chunk
->
node
, 
Œue
);

583  (
	`chunk_»gi¡”
(
tsdn
, 
chunk
, &chunk->
node
));

584 
	}
}

586 
¬’a_chunk_t
 *

587 
	$¬’a_chunk_®loc_š‹º®_h¬d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

588 
chunk_hooks_t
 *
chunk_hooks
, 
boŞ
 *
z”o
, boŞ *
comm™
)

590 
¬’a_chunk_t
 *
chunk
;

591 
size_t
 
¢
;

593 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

595 
chunk
 = (
¬’a_chunk_t
 *)
	`chunk_®loc_w¿µ”
(
tsdn
, 
¬’a
, 
chunk_hooks
,

596 
NULL
, 
chunksize
, chunksize, &
¢
, 
z”o
, 
comm™
);

597 ià(
chunk
 !ğ
NULL
 && !*
comm™
) {

599 ià(
chunk_hooks
->
	`comm™
(
chunk
, 
chunksize
, 0, 
m­_bŸs
 <<

600 
LG_PAGE
, 
¬’a
->
šd
)) {

601 
	`chunk_d®loc_w¿µ”
(
tsdn
, 
¬’a
, 
chunk_hooks
,

602 (*)
chunk
, 
chunksize
, 
¢
, *
z”o
, *
comm™
);

603 
chunk
 = 
NULL
;

606 ià(
chunk
 !ğ
NULL
 && 
	`¬’a_chunk_»gi¡”
(
tsdn
, 
¬’a
, chunk, 
¢
,

607 *
z”o
)) {

608 ià(!*
comm™
) {

610 
chunk_hooks
->
	`decomm™
(
chunk
, 
chunksize
, 0, 
m­_bŸs
 <<

611 
LG_PAGE
, 
¬’a
->
šd
);

613 
	`chunk_d®loc_w¿µ”
(
tsdn
, 
¬’a
, 
chunk_hooks
, (*)
chunk
,

614 
chunksize
, 
¢
, *
z”o
, *
comm™
);

615 
chunk
 = 
NULL
;

618 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

619  (
chunk
);

620 
	}
}

622 
¬’a_chunk_t
 *

623 
	$¬’a_chunk_®loc_š‹º®
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
boŞ
 *
z”o
,

624 
boŞ
 *
comm™
)

626 
¬’a_chunk_t
 *
chunk
;

627 
chunk_hooks_t
 
chunk_hooks
 = 
CHUNK_HOOKS_INITIALIZER
;

628 
size_t
 
¢
;

630 
chunk
 = 
	`chunk_®loc_ÿche
(
tsdn
, 
¬’a
, &
chunk_hooks
, 
NULL
, 
chunksize
,

631 
chunksize
, &
¢
, 
z”o
, 
comm™
, 
Œue
);

632 ià(
chunk
 !ğ
NULL
) {

633 ià(
	`¬’a_chunk_»gi¡”
(
tsdn
, 
¬’a
, 
chunk
, 
¢
, *
z”o
)) {

634 
	`chunk_d®loc_ÿche
(
tsdn
, 
¬’a
, &
chunk_hooks
, 
chunk
,

635 
chunksize
, 
¢
, 
Œue
);

636  (
NULL
);

639 ià(
chunk
 =ğ
NULL
) {

640 
chunk
 = 
	`¬’a_chunk_®loc_š‹º®_h¬d
(
tsdn
, 
¬’a
,

641 &
chunk_hooks
, 
z”o
, 
comm™
);

644 ià(
cÚfig_¡©s
 && 
chunk
 !ğ
NULL
) {

645 
¬’a
->
¡©s
.
m­³d
 +ğ
chunksize
;

646 
¬’a
->
¡©s
.
m‘ad©a_m­³d
 +ğ(
m­_bŸs
 << 
LG_PAGE
);

649  (
chunk
);

650 
	}
}

652 
¬’a_chunk_t
 *

653 
	$¬’a_chunk_š™_h¬d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

655 
¬’a_chunk_t
 *
chunk
;

656 
boŞ
 
z”o
, 
comm™
;

657 
size_t
 
æag_unz”Ûd
, 
æag_decomm™‹d
, 
i
;

659 
	`as£¹
(
¬’a
->
¥¬e
 =ğ
NULL
);

661 
z”o
 = 
çl£
;

662 
comm™
 = 
çl£
;

663 
chunk
 = 
	`¬’a_chunk_®loc_š‹º®
(
tsdn
, 
¬’a
, &
z”o
, &
comm™
);

664 ià(
chunk
 =ğ
NULL
)

665  (
NULL
);

667 
chunk
->
hug•age
 = 
Œue
;

674 
æag_unz”Ûd
 = (
z”o
 || !
comm™
è? 0 : 
CHUNK_MAP_UNZEROED
;

675 
æag_decomm™‹d
 = 
comm™
 ? 0 : 
CHUNK_MAP_DECOMMITTED
;

676 
	`¬’a_m­b™s_uÇÎoÿ‹d_£t
(
chunk
, 
m­_bŸs
, 
¬’a_maxrun
,

677 
æag_unz”Ûd
 | 
æag_decomm™‹d
);

682 ià(!
z”o
) {

683 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(

684 (*)
	`¬’a_b™£lm_g‘_cÚ¡
(
chunk
, 
m­_bŸs
+1),

685 (
size_t
)((
ušŒ_t
)
	`¬’a_b™£lm_g‘_cÚ¡
(
chunk
,

686 
chunk_Åages
-1) -

687 (
ušŒ_t
)
	`¬’a_b™£lm_g‘_cÚ¡
(
chunk
, 
m­_bŸs
+1)));

688 
i
 = 
m­_bŸs
+1; i < 
chunk_Åages
-1; i++)

689 
	`¬’a_m­b™s_š‹º®_£t
(
chunk
, 
i
, 
æag_unz”Ûd
);

691 
	`JEMALLOC_VALGRIND_MAKE_MEM_DEFINED
((

692 *)
	`¬’a_b™£lm_g‘_cÚ¡
(
chunk
, 
m­_bŸs
+1),

693 (
size_t
)((
ušŒ_t
)
	`¬’a_b™£lm_g‘_cÚ¡
(
chunk
,

694 
chunk_Åages
-1) -

695 (
ušŒ_t
)
	`¬’a_b™£lm_g‘_cÚ¡
(
chunk
, 
m­_bŸs
+1)));

696 ià(
cÚfig_debug
) {

697 
i
 = 
m­_bŸs
+1; i < 
chunk_Åages
-1; i++) {

698 
	`as£¹
(
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
i
) ==

699 
æag_unz”Ûd
);

703 
	`¬’a_m­b™s_uÇÎoÿ‹d_£t
(
chunk
, 
chunk_Åages
-1, 
¬’a_maxrun
,

704 
æag_unz”Ûd
);

706  (
chunk
);

707 
	}
}

709 
¬’a_chunk_t
 *

710 
	$¬’a_chunk_®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

712 
¬’a_chunk_t
 *
chunk
;

714 ià(
¬’a
->
¥¬e
 !ğ
NULL
)

715 
chunk
 = 
	`¬’a_chunk_š™_¥¬e
(
¬’a
);

717 
chunk
 = 
	`¬’a_chunk_š™_h¬d
(
tsdn
, 
¬’a
);

718 ià(
chunk
 =ğ
NULL
)

719  (
NULL
);

722 
	`ql_–m_Ãw
(&
chunk
->
node
, 
ql_lšk
);

723 
	`ql__š£¹
(&
¬’a
->
achunks
, &
chunk
->
node
, 
ql_lšk
);

724 
	`¬’a_ava_š£¹
(
¬’a
, 
chunk
, 
m­_bŸs
, 
chunk_Åages
-map_bias);

726  (
chunk
);

727 
	}
}

730 
	$¬’a_chunk_disÿrd
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
)

732 
size_t
 
¢
, 
hug•age
;

733 
boŞ
 
comm™‹d
;

734 
chunk_hooks_t
 
chunk_hooks
 = 
CHUNK_HOOKS_INITIALIZER
;

736 
	`chunk_d”egi¡”
(
chunk
, &chunk->
node
);

738 
¢
 = 
	`ex‹Á_node_¢_g‘
(&
chunk
->
node
);

739 
hug•age
 = 
chunk
->hugepage;

740 
comm™‹d
 = (
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
m­_bŸs
) == 0);

741 ià(!
comm™‹d
) {

748 
chunk_hooks
 = 
	`chunk_hooks_g‘
(
tsdn
, 
¬’a
);

749 
chunk_hooks
.
	`decomm™
(
chunk
, 
chunksize
, 0, 
m­_bŸs
 << 
LG_PAGE
,

750 
¬’a
->
šd
);

752 ià(!
hug•age
) {

758 
	`·ges_huge
(
chunk
, 
chunksize
);

761 
	`chunk_d®loc_ÿche
(
tsdn
, 
¬’a
, &
chunk_hooks
, (*)
chunk
, 
chunksize
,

762 
¢
, 
comm™‹d
);

764 ià(
cÚfig_¡©s
) {

765 
¬’a
->
¡©s
.
m­³d
 -ğ
chunksize
;

766 
¬’a
->
¡©s
.
m‘ad©a_m­³d
 -ğ(
m­_bŸs
 << 
LG_PAGE
);

768 
	}
}

771 
	$¬’a_¥¬e_disÿrd
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
¥¬e
)

774 
	`as£¹
(
¬’a
->
¥¬e
 != spare);

776 ià(
	`¬’a_m­b™s_dœty_g‘
(
¥¬e
, 
m­_bŸs
) != 0) {

777 
	`¬’a_run_dœty_»move
(
¬’a
, 
¥¬e
, 
m­_bŸs
,

778 
chunk_Åages
-
m­_bŸs
);

781 
	`¬’a_chunk_disÿrd
(
tsdn
, 
¬’a
, 
¥¬e
);

782 
	}
}

785 
	$¬’a_chunk_d®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
)

787 
¬’a_chunk_t
 *
¥¬e
;

789 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
m­_bŸs
) == 0);

790 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
chunk_Åages
-1) == 0);

791 
	`as£¹
(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
m­_bŸs
) ==

792 
¬’a_maxrun
);

793 
	`as£¹
(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
chunk_Åages
-1) ==

794 
¬’a_maxrun
);

795 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
m­_bŸs
) ==

796 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
chunk_Åages
-1));

797 
	`as£¹
(
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
m­_bŸs
) ==

798 
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
chunk_Åages
-1));

801 
	`¬’a_ava_»move
(
¬’a
, 
chunk
, 
m­_bŸs
, 
chunk_Åages
-map_bias);

803 
	`ql_»move
(&
¬’a
->
achunks
, &
chunk
->
node
, 
ql_lšk
);

804 
¥¬e
 = 
¬’a
->spare;

805 
¬’a
->
¥¬e
 = 
chunk
;

806 ià(
¥¬e
 !ğ
NULL
)

807 
	`¬’a_¥¬e_disÿrd
(
tsdn
, 
¬’a
, 
¥¬e
);

808 
	}
}

811 
	$¬’a_huge_m®loc_¡©s_upd©e
(
¬’a_t
 *
¬’a
, 
size_t
 
usize
)

813 
szšd_t
 
šdex
 = 
	`size2šdex
(
usize
è- 
Æşas£s
 - 
NBINS
;

815 
	`ÿs£¹
(
cÚfig_¡©s
);

817 
¬’a
->
¡©s
.
nm®loc_huge
++;

818 
¬’a
->
¡©s
.
®loÿ‹d_huge
 +ğ
usize
;

819 
¬’a
->
¡©s
.
h¡©s
[
šdex
].
nm®loc
++;

820 
¬’a
->
¡©s
.
h¡©s
[
šdex
].
curhchunks
++;

821 
	}
}

824 
	$¬’a_huge_m®loc_¡©s_upd©e_undo
(
¬’a_t
 *
¬’a
, 
size_t
 
usize
)

826 
szšd_t
 
šdex
 = 
	`size2šdex
(
usize
è- 
Æşas£s
 - 
NBINS
;

828 
	`ÿs£¹
(
cÚfig_¡©s
);

830 
¬’a
->
¡©s
.
nm®loc_huge
--;

831 
¬’a
->
¡©s
.
®loÿ‹d_huge
 -ğ
usize
;

832 
¬’a
->
¡©s
.
h¡©s
[
šdex
].
nm®loc
--;

833 
¬’a
->
¡©s
.
h¡©s
[
šdex
].
curhchunks
--;

834 
	}
}

837 
	$¬’a_huge_d®loc_¡©s_upd©e
(
¬’a_t
 *
¬’a
, 
size_t
 
usize
)

839 
szšd_t
 
šdex
 = 
	`size2šdex
(
usize
è- 
Æşas£s
 - 
NBINS
;

841 
	`ÿs£¹
(
cÚfig_¡©s
);

843 
¬’a
->
¡©s
.
nd®loc_huge
++;

844 
¬’a
->
¡©s
.
®loÿ‹d_huge
 -ğ
usize
;

845 
¬’a
->
¡©s
.
h¡©s
[
šdex
].
nd®loc
++;

846 
¬’a
->
¡©s
.
h¡©s
[
šdex
].
curhchunks
--;

847 
	}
}

850 
	$¬’a_huge_»£t_¡©s_ÿnûl
(
¬’a_t
 *
¬’a
, 
size_t
 
usize
)

852 
szšd_t
 
šdex
 = 
	`size2šdex
(
usize
è- 
Æşas£s
 - 
NBINS
;

854 
	`ÿs£¹
(
cÚfig_¡©s
);

856 
¬’a
->
¡©s
.
nd®loc_huge
++;

857 
¬’a
->
¡©s
.
h¡©s
[
šdex
].
nd®loc
--;

858 
	}
}

861 
	$¬’a_huge_d®loc_¡©s_upd©e_undo
(
¬’a_t
 *
¬’a
, 
size_t
 
usize
)

863 
szšd_t
 
šdex
 = 
	`size2šdex
(
usize
è- 
Æşas£s
 - 
NBINS
;

865 
	`ÿs£¹
(
cÚfig_¡©s
);

867 
¬’a
->
¡©s
.
nd®loc_huge
--;

868 
¬’a
->
¡©s
.
®loÿ‹d_huge
 +ğ
usize
;

869 
¬’a
->
¡©s
.
h¡©s
[
šdex
].
nd®loc
--;

870 
¬’a
->
¡©s
.
h¡©s
[
šdex
].
curhchunks
++;

871 
	}
}

874 
	$¬’a_huge_¿Îoc_¡©s_upd©e
(
¬’a_t
 *
¬’a
, 
size_t
 
Şdsize
, size_ˆ
usize
)

877 
	`¬’a_huge_d®loc_¡©s_upd©e
(
¬’a
, 
Şdsize
);

878 
	`¬’a_huge_m®loc_¡©s_upd©e
(
¬’a
, 
usize
);

879 
	}
}

882 
	$¬’a_huge_¿Îoc_¡©s_upd©e_undo
(
¬’a_t
 *
¬’a
, 
size_t
 
Şdsize
,

883 
size_t
 
usize
)

886 
	`¬’a_huge_d®loc_¡©s_upd©e_undo
(
¬’a
, 
Şdsize
);

887 
	`¬’a_huge_m®loc_¡©s_upd©e_undo
(
¬’a
, 
usize
);

888 
	}
}

890 
ex‹Á_node_t
 *

891 
	$¬’a_node_®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

893 
ex‹Á_node_t
 *
node
;

895 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
node_ÿche_mtx
);

896 
node
 = 
	`ql_Ï¡
(&
¬’a
->
node_ÿche
, 
ql_lšk
);

897 ià(
node
 =ğ
NULL
) {

898 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
node_ÿche_mtx
);

899  (
	`ba£_®loc
(
tsdn
, (
ex‹Á_node_t
)));

901 
	`ql__»move
(&
¬’a
->
node_ÿche
, 
ex‹Á_node_t
, 
ql_lšk
);

902 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
node_ÿche_mtx
);

903  (
node
);

904 
	}
}

907 
	$¬’a_node_d®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
ex‹Á_node_t
 *
node
)

910 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
node_ÿche_mtx
);

911 
	`ql_–m_Ãw
(
node
, 
ql_lšk
);

912 
	`ql__š£¹
(&
¬’a
->
node_ÿche
, 
node
, 
ql_lšk
);

913 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
node_ÿche_mtx
);

914 
	}
}

917 
	$¬’a_chunk_®loc_huge_h¬d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

918 
chunk_hooks_t
 *
chunk_hooks
, 
size_t
 
usize
, size_ˆ
®ignm’t
, size_ˆ*
¢
,

919 
boŞ
 *
z”o
, 
size_t
 
csize
)

921 *
»t
;

922 
boŞ
 
comm™
 = 
Œue
;

924 
»t
 = 
	`chunk_®loc_w¿µ”
(
tsdn
, 
¬’a
, 
chunk_hooks
, 
NULL
, 
csize
,

925 
®ignm’t
, 
¢
, 
z”o
, &
comm™
);

926 ià(
»t
 =ğ
NULL
) {

928 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

929 ià(
cÚfig_¡©s
) {

930 
	`¬’a_huge_m®loc_¡©s_upd©e_undo
(
¬’a
, 
usize
);

931 
¬’a
->
¡©s
.
m­³d
 -ğ
usize
;

933 
	`¬’a_Çùive_sub
(
¬’a
, 
usize
 >> 
LG_PAGE
);

934 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

937  (
»t
);

938 
	}
}

941 
	$¬’a_chunk_®loc_huge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
,

942 
size_t
 
®ignm’t
, size_ˆ*
¢
, 
boŞ
 *
z”o
)

944 *
»t
;

945 
chunk_hooks_t
 
chunk_hooks
 = 
CHUNK_HOOKS_INITIALIZER
;

946 
size_t
 
csize
 = 
	`CHUNK_CEILING
(
usize
);

947 
boŞ
 
comm™
 = 
Œue
;

949 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

952 ià(
cÚfig_¡©s
) {

953 
	`¬’a_huge_m®loc_¡©s_upd©e
(
¬’a
, 
usize
);

954 
¬’a
->
¡©s
.
m­³d
 +ğ
usize
;

956 
	`¬’a_Çùive_add
(
¬’a
, 
usize
 >> 
LG_PAGE
);

958 
»t
 = 
	`chunk_®loc_ÿche
(
tsdn
, 
¬’a
, &
chunk_hooks
, 
NULL
, 
csize
,

959 
®ignm’t
, 
¢
, 
z”o
, &
comm™
, 
Œue
);

960 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

961 ià(
»t
 =ğ
NULL
) {

962 
»t
 = 
	`¬’a_chunk_®loc_huge_h¬d
(
tsdn
, 
¬’a
, &
chunk_hooks
,

963 
usize
, 
®ignm’t
, 
¢
, 
z”o
, 
csize
);

966  (
»t
);

967 
	}
}

970 
	$¬’a_chunk_d®loc_huge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
chunk
, 
size_t
 
usize
,

971 
size_t
 
¢
)

973 
chunk_hooks_t
 
chunk_hooks
 = 
CHUNK_HOOKS_INITIALIZER
;

974 
size_t
 
csize
;

976 
csize
 = 
	`CHUNK_CEILING
(
usize
);

977 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

978 ià(
cÚfig_¡©s
) {

979 
	`¬’a_huge_d®loc_¡©s_upd©e
(
¬’a
, 
usize
);

980 
¬’a
->
¡©s
.
m­³d
 -ğ
usize
;

982 
	`¬’a_Çùive_sub
(
¬’a
, 
usize
 >> 
LG_PAGE
);

984 
	`chunk_d®loc_ÿche
(
tsdn
, 
¬’a
, &
chunk_hooks
, 
chunk
, 
csize
, 
¢
, 
Œue
);

985 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

986 
	}
}

989 
	$¬’a_chunk_¿Îoc_huge_sim¬
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
chunk
,

990 
size_t
 
Şdsize
, size_ˆ
usize
)

993 
	`as£¹
(
	`CHUNK_CEILING
(
Şdsize
è=ğCHUNK_CEILING(
usize
));

994 
	`as£¹
(
Şdsize
 !ğ
usize
);

996 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

997 ià(
cÚfig_¡©s
)

998 
	`¬’a_huge_¿Îoc_¡©s_upd©e
(
¬’a
, 
Şdsize
, 
usize
);

999 ià(
Şdsize
 < 
usize
)

1000 
	`¬’a_Çùive_add
(
¬’a
, (
usize
 - 
Şdsize
è>> 
LG_PAGE
);

1002 
	`¬’a_Çùive_sub
(
¬’a
, (
Şdsize
 - 
usize
è>> 
LG_PAGE
);

1003 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1004 
	}
}

1007 
	$¬’a_chunk_¿Îoc_huge_shršk
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
chunk
,

1008 
size_t
 
Şdsize
, size_ˆ
usize
, size_ˆ
¢
)

1010 
size_t
 
udiff
 = 
Şdsize
 - 
usize
;

1011 
size_t
 
cdiff
 = 
	`CHUNK_CEILING
(
Şdsize
è- CHUNK_CEILING(
usize
);

1013 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1014 ià(
cÚfig_¡©s
) {

1015 
	`¬’a_huge_¿Îoc_¡©s_upd©e
(
¬’a
, 
Şdsize
, 
usize
);

1016 ià(
cdiff
 != 0)

1017 
¬’a
->
¡©s
.
m­³d
 -ğ
cdiff
;

1019 
	`¬’a_Çùive_sub
(
¬’a
, 
udiff
 >> 
LG_PAGE
);

1021 ià(
cdiff
 != 0) {

1022 
chunk_hooks_t
 
chunk_hooks
 = 
CHUNK_HOOKS_INITIALIZER
;

1023 *
nchunk
 = (*)((
ušŒ_t
)
chunk
 +

1024 
	`CHUNK_CEILING
(
usize
));

1026 
	`chunk_d®loc_ÿche
(
tsdn
, 
¬’a
, &
chunk_hooks
, 
nchunk
, 
cdiff
,

1027 
¢
, 
Œue
);

1029 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1030 
	}
}

1032 
boŞ


1033 
	$¬’a_chunk_¿Îoc_huge_ex·nd_h¬d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

1034 
chunk_hooks_t
 *
chunk_hooks
, *
chunk
, 
size_t
 
Şdsize
, size_ˆ
usize
,

1035 
size_t
 *
¢
, 
boŞ
 *
z”o
, *
nchunk
, size_ˆ
udiff
, size_ˆ
cdiff
)

1037 
boŞ
 
”r
;

1038 
boŞ
 
comm™
 = 
Œue
;

1040 
”r
 = (
	`chunk_®loc_w¿µ”
(
tsdn
, 
¬’a
, 
chunk_hooks
, 
nchunk
, 
cdiff
,

1041 
chunksize
, 
¢
, 
z”o
, &
comm™
è=ğ
NULL
);

1042 ià(
”r
) {

1044 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1045 ià(
cÚfig_¡©s
) {

1046 
	`¬’a_huge_¿Îoc_¡©s_upd©e_undo
(
¬’a
, 
Şdsize
,

1047 
usize
);

1048 
¬’a
->
¡©s
.
m­³d
 -ğ
cdiff
;

1050 
	`¬’a_Çùive_sub
(
¬’a
, 
udiff
 >> 
LG_PAGE
);

1051 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1052 } ià(
chunk_hooks
->
	`m”ge
(
chunk
, 
	`CHUNK_CEILING
(
Şdsize
), 
nchunk
,

1053 
cdiff
, 
Œue
, 
¬’a
->
šd
)) {

1054 
	`chunk_d®loc_w¿µ”
(
tsdn
, 
¬’a
, 
chunk_hooks
, 
nchunk
, 
cdiff
,

1055 *
¢
, *
z”o
, 
Œue
);

1056 
”r
 = 
Œue
;

1058  (
”r
);

1059 
	}
}

1061 
boŞ


1062 
	$¬’a_chunk_¿Îoc_huge_ex·nd
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
chunk
,

1063 
size_t
 
Şdsize
, size_ˆ
usize
, 
boŞ
 *
z”o
)

1065 
boŞ
 
”r
;

1066 
chunk_hooks_t
 
chunk_hooks
 = 
	`chunk_hooks_g‘
(
tsdn
, 
¬’a
);

1067 *
nchunk
 = (*)((
ušŒ_t
)
chunk
 + 
	`CHUNK_CEILING
(
Şdsize
));

1068 
size_t
 
udiff
 = 
usize
 - 
Şdsize
;

1069 
size_t
 
cdiff
 = 
	`CHUNK_CEILING
(
usize
è- CHUNK_CEILING(
Şdsize
);

1070 
size_t
 
¢
;

1071 
boŞ
 
comm™
 = 
Œue
;

1073 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1076 ià(
cÚfig_¡©s
) {

1077 
	`¬’a_huge_¿Îoc_¡©s_upd©e
(
¬’a
, 
Şdsize
, 
usize
);

1078 
¬’a
->
¡©s
.
m­³d
 +ğ
cdiff
;

1080 
	`¬’a_Çùive_add
(
¬’a
, 
udiff
 >> 
LG_PAGE
);

1082 
”r
 = (
	`chunk_®loc_ÿche
(
tsdn
, 
¬’a
, &
chunk_hooks
, 
nchunk
, 
cdiff
,

1083 
chunksize
, &
¢
, 
z”o
, &
comm™
, 
Œue
è=ğ
NULL
);

1084 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1085 ià(
”r
) {

1086 
”r
 = 
	`¬’a_chunk_¿Îoc_huge_ex·nd_h¬d
(
tsdn
, 
¬’a
,

1087 &
chunk_hooks
, 
chunk
, 
Şdsize
, 
usize
, &
¢
, 
z”o
, 
nchunk
,

1088 
udiff
, 
cdiff
);

1089 } ià(
chunk_hooks
.
	`m”ge
(
chunk
, 
	`CHUNK_CEILING
(
Şdsize
), 
nchunk
,

1090 
cdiff
, 
Œue
, 
¬’a
->
šd
)) {

1091 
	`chunk_d®loc_w¿µ”
(
tsdn
, 
¬’a
, &
chunk_hooks
, 
nchunk
, 
cdiff
,

1092 
¢
, *
z”o
, 
Œue
);

1093 
”r
 = 
Œue
;

1096  (
”r
);

1097 
	}
}

1104 
¬’a_run_t
 *

1105 
	$¬’a_run_fœ¡_be¡_f™
(
¬’a_t
 *
¬’a
, 
size_t
 
size
)

1107 
pszšd_t
 
pšd
, 
i
;

1109 
pšd
 = 
	`psz2šd
(
	`run_quªtize_û
(
size
));

1111 
i
 = 
pšd
; 
	`pšd2sz
(iè<ğ
chunksize
; i++) {

1112 
¬’a_chunk_m­_misc_t
 *
misûlm
 = 
	`¬’a_run_h—p_fœ¡
(

1113 &
¬’a
->
runs_ava
[
i
]);

1114 ià(
misûlm
 !ğ
NULL
)

1115  (&
misûlm
->
run
);

1118  (
NULL
);

1119 
	}
}

1121 
¬’a_run_t
 *

1122 
	$¬’a_run_®loc_Ïrge_h–³r
(
¬’a_t
 *
¬’a
, 
size_t
 
size
, 
boŞ
 
z”o
)

1124 
¬’a_run_t
 *
run
 = 
	`¬’a_run_fœ¡_be¡_f™
(
¬’a
, 
size
);

1125 ià(
run
 !ğ
NULL
) {

1126 ià(
	`¬’a_run_¥l™_Ïrge
(
¬’a
, 
run
, 
size
, 
z”o
))

1127 
run
 = 
NULL
;

1129  (
run
);

1130 
	}
}

1132 
¬’a_run_t
 *

1133 
	$¬’a_run_®loc_Ïrge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
size
, 
boŞ
 
z”o
)

1135 
¬’a_chunk_t
 *
chunk
;

1136 
¬’a_run_t
 *
run
;

1138 
	`as£¹
(
size
 <ğ
¬’a_maxrun
);

1139 
	`as£¹
(
size
 =ğ
	`PAGE_CEILING
(size));

1142 
run
 = 
	`¬’a_run_®loc_Ïrge_h–³r
(
¬’a
, 
size
, 
z”o
);

1143 ià(
run
 !ğ
NULL
)

1144  (
run
);

1149 
chunk
 = 
	`¬’a_chunk_®loc
(
tsdn
, 
¬’a
);

1150 ià(
chunk
 !ğ
NULL
) {

1151 
run
 = &
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
m­_bŸs
)->run;

1152 ià(
	`¬’a_run_¥l™_Ïrge
(
¬’a
, 
run
, 
size
, 
z”o
))

1153 
run
 = 
NULL
;

1154  (
run
);

1162  (
	`¬’a_run_®loc_Ïrge_h–³r
(
¬’a
, 
size
, 
z”o
));

1163 
	}
}

1165 
¬’a_run_t
 *

1166 
	$¬’a_run_®loc_sm®l_h–³r
(
¬’a_t
 *
¬’a
, 
size_t
 
size
, 
szšd_t
 
bššd
)

1168 
¬’a_run_t
 *
run
 = 
	`¬’a_run_fœ¡_be¡_f™
(
¬’a
, 
size
);

1169 ià(
run
 !ğ
NULL
) {

1170 ià(
	`¬’a_run_¥l™_sm®l
(
¬’a
, 
run
, 
size
, 
bššd
))

1171 
run
 = 
NULL
;

1173  (
run
);

1174 
	}
}

1176 
¬’a_run_t
 *

1177 
	$¬’a_run_®loc_sm®l
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
size
, 
szšd_t
 
bššd
)

1179 
¬’a_chunk_t
 *
chunk
;

1180 
¬’a_run_t
 *
run
;

1182 
	`as£¹
(
size
 <ğ
¬’a_maxrun
);

1183 
	`as£¹
(
size
 =ğ
	`PAGE_CEILING
(size));

1184 
	`as£¹
(
bššd
 !ğ
BININD_INVALID
);

1187 
run
 = 
	`¬’a_run_®loc_sm®l_h–³r
(
¬’a
, 
size
, 
bššd
);

1188 ià(
run
 !ğ
NULL
)

1189  (
run
);

1194 
chunk
 = 
	`¬’a_chunk_®loc
(
tsdn
, 
¬’a
);

1195 ià(
chunk
 !ğ
NULL
) {

1196 
run
 = &
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
m­_bŸs
)->run;

1197 ià(
	`¬’a_run_¥l™_sm®l
(
¬’a
, 
run
, 
size
, 
bššd
))

1198 
run
 = 
NULL
;

1199  (
run
);

1207  (
	`¬’a_run_®loc_sm®l_h–³r
(
¬’a
, 
size
, 
bššd
));

1208 
	}
}

1210 
boŞ


1211 
	$¬’a_lg_dœty_muÉ_v®id
(
ssize_t
 
lg_dœty_muÉ
)

1214  (
lg_dœty_muÉ
 >ğ-1 &&†g_dœty_muÉ < (
ssize_t
)((
size_t
)

1216 
	}
}

1218 
ssize_t


1219 
	$¬’a_lg_dœty_muÉ_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

1221 
ssize_t
 
lg_dœty_muÉ
;

1223 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1224 
lg_dœty_muÉ
 = 
¬’a
->lg_dirty_mult;

1225 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1227  (
lg_dœty_muÉ
);

1228 
	}
}

1230 
boŞ


1231 
	$¬’a_lg_dœty_muÉ_£t
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
ssize_t
 
lg_dœty_muÉ
)

1234 ià(!
	`¬’a_lg_dœty_muÉ_v®id
(
lg_dœty_muÉ
))

1235  (
Œue
);

1237 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1238 
¬’a
->
lg_dœty_muÉ
 =†g_dirty_mult;

1239 
	`¬’a_maybe_purge
(
tsdn
, 
¬’a
);

1240 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1242  (
çl£
);

1243 
	}
}

1246 
	$¬’a_deÿy_d—dlše_š™
(
¬’a_t
 *
¬’a
)

1249 
	`as£¹
(
İt_purge
 =ğ
purge_mode_deÿy
);

1255 
	`n¡ime_cİy
(&
¬’a
->
deÿy
.
d—dlše
, &¬’a->deÿy.
•och
);

1256 
	`n¡ime_add
(&
¬’a
->
deÿy
.
d—dlše
, &¬’a->deÿy.
š‹rv®
);

1257 ià(
¬’a
->
deÿy
.
time
 > 0) {

1258 
n¡ime_t
 
j™‹r
;

1260 
	`n¡ime_š™
(&
j™‹r
, 
	`´ng_¿nge_u64
(&
¬’a
->
deÿy
.
j™‹r_¡©e
,

1261 
	`n¡ime_ns
(&
¬’a
->
deÿy
.
š‹rv®
)));

1262 
	`n¡ime_add
(&
¬’a
->
deÿy
.
d—dlše
, &
j™‹r
);

1264 
	}
}

1266 
boŞ


1267 
	$¬’a_deÿy_d—dlše_»ached
(cÚ¡ 
¬’a_t
 *
¬’a
, cÚ¡ 
n¡ime_t
 *
time
)

1270 
	`as£¹
(
İt_purge
 =ğ
purge_mode_deÿy
);

1272  (
	`n¡ime_com·»
(&
¬’a
->
deÿy
.
d—dlše
, 
time
) <= 0);

1273 
	}
}

1275 
size_t


1276 
	$¬’a_deÿy_backlog_Åages_lim™
(cÚ¡ 
¬’a_t
 *
¬’a
)

1278 cÚ¡ 
ušt64_t
 
h_¡•s
[] = {

1279 
	#STEP
(
¡•
, 
h
, 
x
, 
y
) \

1280 
h
,

	)

1281 
SMOOTHSTEP


1282 #undeà
STEP


1284 
ušt64_t
 
sum
;

1285 
size_t
 
Åages_lim™_backlog
;

1286 
i
;

1288 
	`as£¹
(
İt_purge
 =ğ
purge_mode_deÿy
);

1295 
sum
 = 0;

1296 
i
 = 0; i < 
SMOOTHSTEP_NSTEPS
; i++)

1297 
sum
 +ğ
¬’a
->
deÿy
.
backlog
[
i
] * 
h_¡•s
[i];

1298 
Åages_lim™_backlog
 = (
size_t
)(
sum
 >> 
SMOOTHSTEP_BFP
);

1300  (
Åages_lim™_backlog
);

1301 
	}
}

1304 
	$¬’a_deÿy_backlog_upd©e_Ï¡
(
¬’a_t
 *
¬’a
)

1306 
size_t
 
ndœty_d–
 = (
¬’a
->
ndœty
 >‡»Ç->
deÿy
.ndirty) ?

1307 
¬’a
->
ndœty
 -‡»Ç->
deÿy
.ndirty : 0;

1308 
¬’a
->
deÿy
.
backlog
[
SMOOTHSTEP_NSTEPS
-1] = 
ndœty_d–
;

1309 
	}
}

1312 
	$¬’a_deÿy_backlog_upd©e
(
¬’a_t
 *
¬’a
, 
ušt64_t
 
Çdvªû_u64
)

1315 ià(
Çdvªû_u64
 >ğ
SMOOTHSTEP_NSTEPS
) {

1316 
	`mem£t
(
¬’a
->
deÿy
.
backlog
, 0, (
SMOOTHSTEP_NSTEPS
-1) *

1317 (
size_t
));

1319 
size_t
 
Çdvªû_z
 = (size_t)
Çdvªû_u64
;

1321 
	`as£¹
((
ušt64_t
)
Çdvªû_z
 =ğ
Çdvªû_u64
);

1323 
	`memmove
(
¬’a
->
deÿy
.
backlog
, &¬’a->deÿy.backlog[
Çdvªû_z
],

1324 (
SMOOTHSTEP_NSTEPS
 - 
Çdvªû_z
è* (
size_t
));

1325 ià(
Çdvªû_z
 > 1) {

1326 
	`mem£t
(&
¬’a
->
deÿy
.
backlog
[
SMOOTHSTEP_NSTEPS
 -

1327 
Çdvªû_z
], 0, (Çdvªû_z-1è* (
size_t
));

1331 
	`¬’a_deÿy_backlog_upd©e_Ï¡
(
¬’a
);

1332 
	}
}

1335 
	$¬’a_deÿy_•och_advªû_h–³r
(
¬’a_t
 *
¬’a
, cÚ¡ 
n¡ime_t
 *
time
)

1337 
ušt64_t
 
Çdvªû_u64
;

1338 
n¡ime_t
 
d–
;

1340 
	`as£¹
(
İt_purge
 =ğ
purge_mode_deÿy
);

1341 
	`as£¹
(
	`¬’a_deÿy_d—dlše_»ached
(
¬’a
, 
time
));

1343 
	`n¡ime_cİy
(&
d–
, 
time
);

1344 
	`n¡ime_subŒaù
(&
d–
, &
¬’a
->
deÿy
.
•och
);

1345 
Çdvªû_u64
 = 
	`n¡ime_divide
(&
d–
, &
¬’a
->
deÿy
.
š‹rv®
);

1346 
	`as£¹
(
Çdvªû_u64
 > 0);

1349 
	`n¡ime_cİy
(&
d–
, &
¬’a
->
deÿy
.
š‹rv®
);

1350 
	`n¡ime_imuÉly
(&
d–
, 
Çdvªû_u64
);

1351 
	`n¡ime_add
(&
¬’a
->
deÿy
.
•och
, &
d–
);

1354 
	`¬’a_deÿy_d—dlše_š™
(
¬’a
);

1357 
	`¬’a_deÿy_backlog_upd©e
(
¬’a
, 
Çdvªû_u64
);

1358 
	}
}

1361 
	$¬’a_deÿy_•och_advªû_purge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

1363 
size_t
 
ndœty_lim™
 = 
	`¬’a_deÿy_backlog_Åages_lim™
(
¬’a
);

1365 ià(
¬’a
->
ndœty
 > 
ndœty_lim™
)

1366 
	`¬’a_purge_to_lim™
(
tsdn
, 
¬’a
, 
ndœty_lim™
);

1367 
¬’a
->
deÿy
.
ndœty
 =‡rena->ndirty;

1368 
	}
}

1371 
	$¬’a_deÿy_•och_advªû
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, cÚ¡ 
n¡ime_t
 *
time
)

1374 
	`¬’a_deÿy_•och_advªû_h–³r
(
¬’a
, 
time
);

1375 
	`¬’a_deÿy_•och_advªû_purge
(
tsdn
, 
¬’a
);

1376 
	}
}

1379 
	$¬’a_deÿy_š™
(
¬’a_t
 *
¬’a
, 
ssize_t
 
deÿy_time
)

1382 
¬’a
->
deÿy
.
time
 = 
deÿy_time
;

1383 ià(
deÿy_time
 > 0) {

1384 
	`n¡ime_š™2
(&
¬’a
->
deÿy
.
š‹rv®
, 
deÿy_time
, 0);

1385 
	`n¡ime_idivide
(&
¬’a
->
deÿy
.
š‹rv®
, 
SMOOTHSTEP_NSTEPS
);

1388 
	`n¡ime_š™
(&
¬’a
->
deÿy
.
•och
, 0);

1389 
	`n¡ime_upd©e
(&
¬’a
->
deÿy
.
•och
);

1390 
¬’a
->
deÿy
.
j™‹r_¡©e
 = (
ušt64_t
)(
ušŒ_t
)arena;

1391 
	`¬’a_deÿy_d—dlše_š™
(
¬’a
);

1392 
¬’a
->
deÿy
.
ndœty
 =‡rena->ndirty;

1393 
	`mem£t
(
¬’a
->
deÿy
.
backlog
, 0, 
SMOOTHSTEP_NSTEPS
 * (
size_t
));

1394 
	}
}

1396 
boŞ


1397 
	$¬’a_deÿy_time_v®id
(
ssize_t
 
deÿy_time
)

1400 ià(
deÿy_time
 < -1)

1401  (
çl£
);

1402 ià(
deÿy_time
 =ğ-1 || (
ušt64_t
)deÿy_tim<ğ
NSTIME_SEC_MAX
)

1403  (
Œue
);

1404  (
çl£
);

1405 
	}
}

1407 
ssize_t


1408 
	$¬’a_deÿy_time_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

1410 
ssize_t
 
deÿy_time
;

1412 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1413 
deÿy_time
 = 
¬’a
->
deÿy
.
time
;

1414 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1416  (
deÿy_time
);

1417 
	}
}

1419 
boŞ


1420 
	$¬’a_deÿy_time_£t
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
ssize_t
 
deÿy_time
)

1423 ià(!
	`¬’a_deÿy_time_v®id
(
deÿy_time
))

1424  (
Œue
);

1426 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1435 
	`¬’a_deÿy_š™
(
¬’a
, 
deÿy_time
);

1436 
	`¬’a_maybe_purge
(
tsdn
, 
¬’a
);

1437 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1439  (
çl£
);

1440 
	}
}

1443 
	$¬’a_maybe_purge_¿tio
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

1446 
	`as£¹
(
İt_purge
 =ğ
purge_mode_¿tio
);

1449 ià(
¬’a
->
lg_dœty_muÉ
 < 0)

1456 
Œue
) {

1457 
size_t
 
th»shŞd
 = (
¬’a
->
Çùive
 >>‡»Ç->
lg_dœty_muÉ
);

1458 ià(
th»shŞd
 < 
chunk_Åages
)

1459 
th»shŞd
 = 
chunk_Åages
;

1464 ià(
¬’a
->
ndœty
 <ğ
th»shŞd
)

1466 
	`¬’a_purge_to_lim™
(
tsdn
, 
¬’a
, 
th»shŞd
);

1468 
	}
}

1471 
	$¬’a_maybe_purge_deÿy
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

1473 
n¡ime_t
 
time
;

1475 
	`as£¹
(
İt_purge
 =ğ
purge_mode_deÿy
);

1478 ià(
¬’a
->
deÿy
.
time
 <= 0) {

1479 ià(
¬’a
->
deÿy
.
time
 == 0)

1480 
	`¬’a_purge_to_lim™
(
tsdn
, 
¬’a
, 0);

1484 
	`n¡ime_š™
(&
time
, 0);

1485 
	`n¡ime_upd©e
(&
time
);

1486 ià(
	`uÆik–y
(!
	`n¡ime_mÚÙÚic
(è&& 
	`n¡ime_com·»
(&
¬’a
->
deÿy
.
•och
,

1487 &
time
) > 0)) {

1497 
	`n¡ime_cİy
(&
¬’a
->
deÿy
.
•och
, &
time
);

1498 
	`¬’a_deÿy_d—dlše_š™
(
¬’a
);

1501 
	`as£¹
(
	`n¡ime_com·»
(&
¬’a
->
deÿy
.
•och
, &
time
) <= 0);

1510 ià(
	`¬’a_deÿy_d—dlše_»ached
(
¬’a
, &
time
))

1511 
	`¬’a_deÿy_•och_advªû
(
tsdn
, 
¬’a
, &
time
);

1512 
	}
}

1515 
	$¬’a_maybe_purge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

1519 ià(
¬’a
->
purgšg
)

1522 ià(
İt_purge
 =ğ
purge_mode_¿tio
)

1523 
	`¬’a_maybe_purge_¿tio
(
tsdn
, 
¬’a
);

1525 
	`¬’a_maybe_purge_deÿy
(
tsdn
, 
¬’a
);

1526 
	}
}

1528 
size_t


1529 
	$¬’a_dœty_couÁ
(
¬’a_t
 *
¬’a
)

1531 
size_t
 
ndœty
 = 0;

1532 
¬’a_runs_dœty_lšk_t
 *
rd–m
;

1533 
ex‹Á_node_t
 *
chunk£lm
;

1535 
rd–m
 = 
	`qr_Ãxt
(&
¬’a
->
runs_dœty
, 
rd_lšk
),

1536 
chunk£lm
 = 
	`qr_Ãxt
(&
¬’a
->
chunks_ÿche
, 
cc_lšk
);

1537 
rd–m
 !ğ&
¬’a
->
runs_dœty
;„d–m = 
	`qr_Ãxt
Ôd–m, 
rd_lšk
)) {

1538 
size_t
 
Åages
;

1540 ià(
rd–m
 =ğ&
chunk£lm
->
rd
) {

1541 
Åages
 = 
	`ex‹Á_node_size_g‘
(
chunk£lm
è>> 
LG_PAGE
;

1542 
chunk£lm
 = 
	`qr_Ãxt
(chunk£lm, 
cc_lšk
);

1544 
¬’a_chunk_t
 *
chunk
 = (¬’a_chunk_ˆ*)
	`CHUNK_ADDR2BASE
(

1545 
rd–m
);

1546 
¬’a_chunk_m­_misc_t
 *
misûlm
 =

1547 
	`¬’a_rd_to_misûlm
(
rd–m
);

1548 
size_t
 
·gešd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

1549 
	`as£¹
(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
·gešd
) ==

1551 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
·gešd
) == 0);

1552 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
) != 0);

1553 
Åages
 = 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
,

1554 
·gešd
è>> 
LG_PAGE
;

1556 
ndœty
 +ğ
Åages
;

1559  (
ndœty
);

1560 
	}
}

1562 
size_t


1563 
	$¬’a_¡ash_dœty
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

1564 
size_t
 
ndœty_lim™
, 
¬’a_runs_dœty_lšk_t
 *
purge_runs_£Áš–
,

1565 
ex‹Á_node_t
 *
purge_chunks_£Áš–
)

1567 
¬’a_runs_dœty_lšk_t
 *
rd–m
, *
rd–m_Ãxt
;

1568 
ex‹Á_node_t
 *
chunk£lm
;

1569 
size_t
 
n¡ashed
 = 0;

1572 
rd–m
 = 
	`qr_Ãxt
(&
¬’a
->
runs_dœty
, 
rd_lšk
),

1573 
chunk£lm
 = 
	`qr_Ãxt
(&
¬’a
->
chunks_ÿche
, 
cc_lšk
);

1574 
rd–m
 !ğ&
¬’a
->
runs_dœty
;„d–m = 
rd–m_Ãxt
) {

1575 
size_t
 
Åages
;

1576 
rd–m_Ãxt
 = 
	`qr_Ãxt
(
rd–m
, 
rd_lšk
);

1578 ià(
rd–m
 =ğ&
chunk£lm
->
rd
) {

1579 
ex‹Á_node_t
 *
chunk£lm_Ãxt
;

1580 
size_t
 
¢
;

1581 
boŞ
 
z”o
, 
comm™
;

1582 
UNUSED
 *
chunk
;

1584 
Åages
 = 
	`ex‹Á_node_size_g‘
(
chunk£lm
è>> 
LG_PAGE
;

1585 ià(
İt_purge
 =ğ
purge_mode_deÿy
 && 
¬’a
->
ndœty
 -

1586 (
n¡ashed
 + 
Åages
è< 
ndœty_lim™
)

1589 
chunk£lm_Ãxt
 = 
	`qr_Ãxt
(
chunk£lm
, 
cc_lšk
);

1594 
z”o
 = 
çl£
;

1595 
comm™
 = 
çl£
;

1596 
chunk
 = 
	`chunk_®loc_ÿche
(
tsdn
, 
¬’a
, 
chunk_hooks
,

1597 
	`ex‹Á_node_addr_g‘
(
chunk£lm
),

1598 
	`ex‹Á_node_size_g‘
(
chunk£lm
), 
chunksize
, &
¢
,

1599 &
z”o
, &
comm™
, 
çl£
);

1600 
	`as£¹
(
chunk
 =ğ
	`ex‹Á_node_addr_g‘
(
chunk£lm
));

1601 
	`as£¹
(
z”o
 =ğ
	`ex‹Á_node_z”Ûd_g‘
(
chunk£lm
));

1602 
	`ex‹Á_node_dœty_š£¹
(
chunk£lm
, 
purge_runs_£Áš–
,

1603 
purge_chunks_£Áš–
);

1604 
	`as£¹
(
Åages
 =ğ(
	`ex‹Á_node_size_g‘
(
chunk£lm
) >>

1605 
LG_PAGE
));

1606 
chunk£lm
 = 
chunk£lm_Ãxt
;

1608 
¬’a_chunk_t
 *
chunk
 =

1609 (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
rd–m
);

1610 
¬’a_chunk_m­_misc_t
 *
misûlm
 =

1611 
	`¬’a_rd_to_misûlm
(
rd–m
);

1612 
size_t
 
·gešd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

1613 
¬’a_run_t
 *
run
 = &
misûlm
->run;

1614 
size_t
 
run_size
 =

1615 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
·gešd
);

1617 
Åages
 = 
run_size
 >> 
LG_PAGE
;

1618 ià(
İt_purge
 =ğ
purge_mode_deÿy
 && 
¬’a
->
ndœty
 -

1619 (
n¡ashed
 + 
Åages
è< 
ndœty_lim™
)

1622 
	`as£¹
(
·gešd
 + 
Åages
 <ğ
chunk_Åages
);

1623 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
) ==

1624 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
+
Åages
-1));

1630 ià(
chunk
 =ğ
¬’a
->
¥¬e
)

1631 
	`¬’a_chunk_®loc
(
tsdn
, 
¬’a
);

1634 
	`¬’a_run_¥l™_Ïrge
(
¬’a
, 
run
, 
run_size
, 
çl£
);

1636 ià(
çl£
)

1637 
	`qr_Ãw
(
rd–m
, 
rd_lšk
);

1639 
	`as£¹
(
	`qr_Ãxt
(
rd–m
, 
rd_lšk
) ==„delm);

1640 
	`as£¹
(
	`qr_´ev
(
rd–m
, 
rd_lšk
) ==„delm);

1642 
	`qr_m–d
(
purge_runs_£Áš–
, 
rd–m
, 
rd_lšk
);

1645 
n¡ashed
 +ğ
Åages
;

1646 ià(
İt_purge
 =ğ
purge_mode_¿tio
 && 
¬’a
->
ndœty
 - 
n¡ashed
 <=

1647 
ndœty_lim™
)

1651  (
n¡ashed
);

1652 
	}
}

1654 
size_t


1655 
	$¬’a_purge_¡ashed
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

1656 
¬’a_runs_dœty_lšk_t
 *
purge_runs_£Áš–
,

1657 
ex‹Á_node_t
 *
purge_chunks_£Áš–
)

1659 
size_t
 
Åurged
, 
nmadvi£
;

1660 
¬’a_runs_dœty_lšk_t
 *
rd–m
;

1661 
ex‹Á_node_t
 *
chunk£lm
;

1663 ià(
cÚfig_¡©s
)

1664 
nmadvi£
 = 0;

1665 
Åurged
 = 0;

1667 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1668 
rd–m
 = 
	`qr_Ãxt
(
purge_runs_£Áš–
, 
rd_lšk
),

1669 
chunk£lm
 = 
	`qr_Ãxt
(
purge_chunks_£Áš–
, 
cc_lšk
);

1670 
rd–m
 !ğ
purge_runs_£Áš–
;„d–m = 
	`qr_Ãxt
Ôd–m, 
rd_lšk
)) {

1671 
size_t
 
Åages
;

1673 ià(
rd–m
 =ğ&
chunk£lm
->
rd
) {

1682 
size_t
 
size
 = 
	`ex‹Á_node_size_g‘
(
chunk£lm
);

1683 
Åages
 = 
size
 >> 
LG_PAGE
;

1684 
chunk£lm
 = 
	`qr_Ãxt
(chunk£lm, 
cc_lšk
);

1686 
size_t
 
·gešd
, 
run_size
, 
æag_unz”Ûd
, 
æags
, 
i
;

1687 
boŞ
 
decomm™‹d
;

1688 
¬’a_chunk_t
 *
chunk
 =

1689 (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
rd–m
);

1690 
¬’a_chunk_m­_misc_t
 *
misûlm
 =

1691 
	`¬’a_rd_to_misûlm
(
rd–m
);

1692 
·gešd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

1693 
run_size
 = 
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
, 
·gešd
);

1694 
Åages
 = 
run_size
 >> 
LG_PAGE
;

1702 ià(
chunk
->
hug•age
) {

1703 
	`·ges_nohuge
(
chunk
, 
chunksize
);

1704 
chunk
->
hug•age
 = 
çl£
;

1707 
	`as£¹
(
·gešd
 + 
Åages
 <ğ
chunk_Åages
);

1708 
	`as£¹
(!
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
·gešd
));

1709 
	`as£¹
(!
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
,

1710 
·gešd
+
Åages
-1));

1711 
decomm™‹d
 = !
chunk_hooks
->
	`decomm™
(
chunk
, 
chunksize
,

1712 
·gešd
 << 
LG_PAGE
, 
Åages
 << LG_PAGE, 
¬’a
->
šd
);

1713 ià(
decomm™‹d
) {

1714 
æag_unz”Ûd
 = 0;

1715 
æags
 = 
CHUNK_MAP_DECOMMITTED
;

1717 
æag_unz”Ûd
 = 
	`chunk_purge_w¿µ”
(
tsdn
, 
¬’a
,

1718 
chunk_hooks
, 
chunk
, 
chunksize
, 
·gešd
 <<

1719 
LG_PAGE
, 
run_size
è? 
CHUNK_MAP_UNZEROED
 : 0;

1720 
æags
 = 
æag_unz”Ûd
;

1722 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
+
Åages
-1, 0,

1723 
æags
);

1724 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
, 
run_size
,

1725 
æags
);

1738 
i
 = 1; i < 
Åages
-1; i++) {

1739 
	`¬’a_m­b™s_š‹º®_£t
(
chunk
, 
·gešd
+
i
,

1740 
æag_unz”Ûd
);

1744 
Åurged
 +ğ
Åages
;

1745 ià(
cÚfig_¡©s
)

1746 
nmadvi£
++;

1748 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1750 ià(
cÚfig_¡©s
) {

1751 
¬’a
->
¡©s
.
nmadvi£
 +=‚madvise;

1752 
¬’a
->
¡©s
.
purged
 +ğ
Åurged
;

1755  (
Åurged
);

1756 
	}
}

1759 
	$¬’a_un¡ash_purged
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

1760 
¬’a_runs_dœty_lšk_t
 *
purge_runs_£Áš–
,

1761 
ex‹Á_node_t
 *
purge_chunks_£Áš–
)

1763 
¬’a_runs_dœty_lšk_t
 *
rd–m
, *
rd–m_Ãxt
;

1764 
ex‹Á_node_t
 *
chunk£lm
;

1767 
rd–m
 = 
	`qr_Ãxt
(
purge_runs_£Áš–
, 
rd_lšk
),

1768 
chunk£lm
 = 
	`qr_Ãxt
(
purge_chunks_£Áš–
, 
cc_lšk
);

1769 
rd–m
 !ğ
purge_runs_£Áš–
;„d–m = 
rd–m_Ãxt
) {

1770 
rd–m_Ãxt
 = 
	`qr_Ãxt
(
rd–m
, 
rd_lšk
);

1771 ià(
rd–m
 =ğ&
chunk£lm
->
rd
) {

1772 
ex‹Á_node_t
 *
chunk£lm_Ãxt
 = 
	`qr_Ãxt
(
chunk£lm
,

1773 
cc_lšk
);

1774 *
addr
 = 
	`ex‹Á_node_addr_g‘
(
chunk£lm
);

1775 
size_t
 
size
 = 
	`ex‹Á_node_size_g‘
(
chunk£lm
);

1776 
size_t
 
¢
 = 
	`ex‹Á_node_¢_g‘
(
chunk£lm
);

1777 
boŞ
 
z”Ûd
 = 
	`ex‹Á_node_z”Ûd_g‘
(
chunk£lm
);

1778 
boŞ
 
comm™‹d
 = 
	`ex‹Á_node_comm™‹d_g‘
(
chunk£lm
);

1779 
	`ex‹Á_node_dœty_»move
(
chunk£lm
);

1780 
	`¬’a_node_d®loc
(
tsdn
, 
¬’a
, 
chunk£lm
);

1781 
chunk£lm
 = 
chunk£lm_Ãxt
;

1782 
	`chunk_d®loc_w¿µ”
(
tsdn
, 
¬’a
, 
chunk_hooks
, 
addr
,

1783 
size
, 
¢
, 
z”Ûd
, 
comm™‹d
);

1785 
¬’a_chunk_t
 *
chunk
 =

1786 (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
rd–m
);

1787 
¬’a_chunk_m­_misc_t
 *
misûlm
 =

1788 
	`¬’a_rd_to_misûlm
(
rd–m
);

1789 
size_t
 
·gešd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

1790 
boŞ
 
decomm™‹d
 = (
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
,

1791 
·gešd
) != 0);

1792 
¬’a_run_t
 *
run
 = &
misûlm
->run;

1793 
	`qr_»move
(
rd–m
, 
rd_lšk
);

1794 
	`¬’a_run_d®loc
(
tsdn
, 
¬’a
, 
run
, 
çl£
, 
Œue
,

1795 
decomm™‹d
);

1798 
	}
}

1810 
	$¬’a_purge_to_lim™
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
ndœty_lim™
)

1812 
chunk_hooks_t
 
chunk_hooks
 = 
	`chunk_hooks_g‘
(
tsdn
, 
¬’a
);

1813 
size_t
 
Åurge
, 
Åurged
;

1814 
¬’a_runs_dœty_lšk_t
 
purge_runs_£Áš–
;

1815 
ex‹Á_node_t
 
purge_chunks_£Áš–
;

1817 
¬’a
->
purgšg
 = 
Œue
;

1823 ià(
çl£
 && 
cÚfig_debug
) {

1824 
size_t
 
ndœty
 = 
	`¬’a_dœty_couÁ
(
¬’a
);

1825 
	`as£¹
(
ndœty
 =ğ
¬’a
->ndirty);

1827 
	`as£¹
(
İt_purge
 !ğ
purge_mode_¿tio
 || (
¬’a
->
Çùive
 >>

1828 
¬’a
->
lg_dœty_muÉ
è<‡»Ç->
ndœty
 || 
ndœty_lim™
 == 0);

1830 
	`qr_Ãw
(&
purge_runs_£Áš–
, 
rd_lšk
);

1831 
	`ex‹Á_node_dœty_lškage_š™
(&
purge_chunks_£Áš–
);

1833 
Åurge
 = 
	`¬’a_¡ash_dœty
(
tsdn
, 
¬’a
, &
chunk_hooks
, 
ndœty_lim™
,

1834 &
purge_runs_£Áš–
, &
purge_chunks_£Áš–
);

1835 ià(
Åurge
 == 0)

1836 
Ïb–_»tuº
;

1837 
Åurged
 = 
	`¬’a_purge_¡ashed
(
tsdn
, 
¬’a
, &
chunk_hooks
,

1838 &
purge_runs_£Áš–
, &
purge_chunks_£Áš–
);

1839 
	`as£¹
(
Åurged
 =ğ
Åurge
);

1840 
	`¬’a_un¡ash_purged
(
tsdn
, 
¬’a
, &
chunk_hooks
, &
purge_runs_£Áš–
,

1841 &
purge_chunks_£Áš–
);

1843 ià(
cÚfig_¡©s
)

1844 
¬’a
->
¡©s
.
Åurge
++;

1846 
Ïb–_»tuº
:

1847 
¬’a
->
purgšg
 = 
çl£
;

1848 
	}
}

1851 
	$¬’a_purge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
boŞ
 
®l
)

1854 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

1855 ià(
®l
)

1856 
	`¬’a_purge_to_lim™
(
tsdn
, 
¬’a
, 0);

1858 
	`¬’a_maybe_purge
(
tsdn
, 
¬’a
);

1859 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

1860 
	}
}

1863 
	$¬’a_achunk_´of_»£t
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
)

1865 
size_t
 
·gešd
, 
Åages
;

1867 
	`ÿs£¹
(
cÚfig_´of
);

1868 
	`as£¹
(
İt_´of
);

1874 
·gešd
 = 
m­_bŸs
;…agešd < 
chunk_Åages
;…agešd +ğ
Åages
) {

1875 ià(
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
·gešd
) != 0) {

1876 ià(
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
·gešd
) != 0) {

1877 *
±r
 = (*)((
ušŒ_t
)
chunk
 + (
·gešd


1878 << 
LG_PAGE
));

1879 
size_t
 
usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
,

1880 
cÚfig_´of
);

1882 
	`´of_ä“
(
tsd
, 
±r
, 
usize
);

1883 
Åages
 = 
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
,

1884 
·gešd
è>> 
LG_PAGE
;

1887 
size_t
 
bššd
 = 
	`¬’a_m­b™s_bššd_g‘
(
chunk
,

1888 
·gešd
);

1889 
¬’a_bš_šfo_t
 *
bš_šfo
 =

1890 &
¬’a_bš_šfo
[
bššd
];

1891 
Åages
 = 
bš_šfo
->
run_size
 >> 
LG_PAGE
;

1895 
Åages
 = 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
,

1896 
·gešd
è>> 
LG_PAGE
;

1898 
	`as£¹
(
·gešd
 + 
Åages
 <ğ
chunk_Åages
);

1900 
	}
}

1903 
	$¬’a_»£t
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
)

1905 
i
;

1906 
ex‹Á_node_t
 *
node
;

1923 ià(
cÚfig_´of
 && 
İt_´of
) {

1924 
	`ql_fÜ—ch
(
node
, &
¬’a
->
achunks
, 
ql_lšk
) {

1925 
	`¬’a_achunk_´of_»£t
(
tsd
, 
¬’a
,

1926 
	`ex‹Á_node_addr_g‘
(
node
));

1931 ià(
cÚfig_¡©s
) {

1932 
i
 = 0; i < 
Æşas£s
; i++)

1933 
¬’a
->
¡©s
.
l¡©s
[
i
].
cu¼uns
 = 0;

1937 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
huge_mtx
);

1938 
node
 = 
	`ql_Ï¡
(&
¬’a
->
huge
, 
ql_lšk
);‚od!ğ
NULL
;‚ode =

1939 
	`ql_Ï¡
(&
¬’a
->
huge
, 
ql_lšk
)) {

1940 *
±r
 = 
	`ex‹Á_node_addr_g‘
(
node
);

1941 
size_t
 
usize
;

1943 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
huge_mtx
);

1944 ià(
cÚfig_¡©s
 || (
cÚfig_´of
 && 
İt_´of
))

1945 
usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
cÚfig_´of
);

1947 ià(
cÚfig_´of
 && 
İt_´of
)

1948 
	`´of_ä“
(
tsd
, 
±r
, 
usize
);

1949 
	`huge_d®loc
(
	`tsd_tsdn
(
tsd
), 
±r
);

1950 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
huge_mtx
);

1952 ià(
cÚfig_¡©s
)

1953 
	`¬’a_huge_»£t_¡©s_ÿnûl
(
¬’a
, 
usize
);

1955 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
huge_mtx
);

1957 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
lock
);

1960 
i
 = 0; i < 
NBINS
; i++) {

1961 
¬’a_bš_t
 *
bš
 = &
¬’a
->
bšs
[
i
];

1962 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

1963 
bš
->
runcur
 = 
NULL
;

1964 
	`¬’a_run_h—p_Ãw
(&
bš
->
runs
);

1965 ià(
cÚfig_¡©s
) {

1966 
bš
->
¡©s
.
cu¼egs
 = 0;

1967 
bš
->
¡©s
.
cu¼uns
 = 0;

1969 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

1976 
	`qr_Ãw
(&
¬’a
->
runs_dœty
, 
rd_lšk
);

1977 
node
 = 
	`qr_Ãxt
(&
¬’a
->
chunks_ÿche
, 
cc_lšk
);

1978 
node
 !ğ&
¬’a
->
chunks_ÿche
;‚odğ
	`qr_Ãxt
Òode, 
cc_lšk
)) {

1979 
	`qr_Ãw
(&
node
->
rd
, 
rd_lšk
);

1980 
	`qr_m–d
(&
¬’a
->
runs_dœty
, &
node
->
rd
, 
rd_lšk
);

1984 
node
 = 
	`ql_Ï¡
(&
¬’a
->
achunks
, 
ql_lšk
);‚od!ğ
NULL
;‚ode =

1985 
	`ql_Ï¡
(&
¬’a
->
achunks
, 
ql_lšk
)) {

1986 
	`ql_»move
(&
¬’a
->
achunks
, 
node
, 
ql_lšk
);

1987 
	`¬’a_chunk_disÿrd
(
	`tsd_tsdn
(
tsd
), 
¬’a
,

1988 
	`ex‹Á_node_addr_g‘
(
node
));

1992 ià(
¬’a
->
¥¬e
 !ğ
NULL
) {

1993 
	`¬’a_chunk_disÿrd
(
	`tsd_tsdn
(
tsd
), 
¬’a
,‡»Ç->
¥¬e
);

1994 
¬’a
->
¥¬e
 = 
NULL
;

1997 
	`as£¹
(!
¬’a
->
purgšg
);

1998 
¬’a
->
Çùive
 = 0;

2000 
i
 = 0; i < 
NPSIZES
; i++)

2001 
	`¬’a_run_h—p_Ãw
(&
¬’a
->
runs_ava
[
i
]);

2003 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
lock
);

2004 
	}
}

2007 
	$¬’a_run_cßËsû
(
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
, 
size_t
 *
p_size
,

2008 
size_t
 *
p_run_šd
, size_ˆ*
p_run_·ges
, size_ˆ
æag_dœty
,

2009 
size_t
 
æag_decomm™‹d
)

2011 
size_t
 
size
 = *
p_size
;

2012 
size_t
 
run_šd
 = *
p_run_šd
;

2013 
size_t
 
run_·ges
 = *
p_run_·ges
;

2016 ià(
run_šd
 + 
run_·ges
 < 
chunk_Åages
 &&

2017 
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
, 
run_šd
+
run_·ges
) == 0 &&

2018 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
+
run_·ges
è=ğ
æag_dœty
 &&

2019 
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
run_šd
+
run_·ges
) ==

2020 
æag_decomm™‹d
) {

2021 
size_t
 
Äun_size
 = 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
,

2022 
run_šd
+
run_·ges
);

2023 
size_t
 
Äun_·ges
 = 
Äun_size
 >> 
LG_PAGE
;

2029 
	`as£¹
(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
,

2030 
run_šd
+
run_·ges
+
Äun_·ges
-1è=ğ
Äun_size
);

2031 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
,

2032 
run_šd
+
run_·ges
+
Äun_·ges
-1è=ğ
æag_dœty
);

2033 
	`as£¹
(
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
,

2034 
run_šd
+
run_·ges
+
Äun_·ges
-1è=ğ
æag_decomm™‹d
);

2035 
	`¬’a_ava_»move
(
¬’a
, 
chunk
, 
run_šd
+
run_·ges
, 
Äun_·ges
);

2041 ià(
æag_dœty
 != 0) {

2042 
	`¬’a_run_dœty_»move
(
¬’a
, 
chunk
, 
run_šd
+
run_·ges
,

2043 
Äun_·ges
);

2046 
size
 +ğ
Äun_size
;

2047 
run_·ges
 +ğ
Äun_·ges
;

2049 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_£t
(
chunk
, 
run_šd
, 
size
);

2050 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_£t
(
chunk
, 
run_šd
+
run_·ges
-1,

2051 
size
);

2055 ià(
run_šd
 > 
m­_bŸs
 && 
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
,

2056 
run_šd
-1è=ğ0 && 
	`¬’a_m­b™s_dœty_g‘
(
chunk
,„un_ind-1) ==

2057 
æag_dœty
 && 
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
run_šd
-1) ==

2058 
æag_decomm™‹d
) {

2059 
size_t
 
´un_size
 = 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
,

2060 
run_šd
-1);

2061 
size_t
 
´un_·ges
 = 
´un_size
 >> 
LG_PAGE
;

2063 
run_šd
 -ğ
´un_·ges
;

2069 
	`as£¹
(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
run_šd
) ==

2070 
´un_size
);

2071 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
è=ğ
æag_dœty
);

2072 
	`as£¹
(
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
run_šd
) ==

2073 
æag_decomm™‹d
);

2074 
	`¬’a_ava_»move
(
¬’a
, 
chunk
, 
run_šd
, 
´un_·ges
);

2080 ià(
æag_dœty
 != 0) {

2081 
	`¬’a_run_dœty_»move
(
¬’a
, 
chunk
, 
run_šd
,

2082 
´un_·ges
);

2085 
size
 +ğ
´un_size
;

2086 
run_·ges
 +ğ
´un_·ges
;

2088 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_£t
(
chunk
, 
run_šd
, 
size
);

2089 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_£t
(
chunk
, 
run_šd
+
run_·ges
-1,

2090 
size
);

2093 *
p_size
 = 
size
;

2094 *
p_run_šd
 = 
run_šd
;

2095 *
p_run_·ges
 = 
run_·ges
;

2096 
	}
}

2098 
size_t


2099 
	$¬’a_run_size_g‘
(
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
, 
¬’a_run_t
 *
run
,

2100 
size_t
 
run_šd
)

2102 
size_t
 
size
;

2104 
	`as£¹
(
run_šd
 >ğ
m­_bŸs
);

2105 
	`as£¹
(
run_šd
 < 
chunk_Åages
);

2107 ià(
	`¬’a_m­b™s_Ïrge_g‘
(
chunk
, 
run_šd
) != 0) {

2108 
size
 = 
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
, 
run_šd
);

2109 
	`as£¹
(
size
 =ğ
PAGE
 || 
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
,

2110 
run_šd
+(
size
>>
LG_PAGE
)-1) == 0);

2112 
¬’a_bš_šfo_t
 *
bš_šfo
 = &
¬’a_bš_šfo
[
run
->
bššd
];

2113 
size
 = 
bš_šfo
->
run_size
;

2116  (
size
);

2117 
	}
}

2120 
	$¬’a_run_d®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_run_t
 *
run
, 
boŞ
 
dœty
,

2121 
boŞ
 
ş—Ãd
, boŞ 
decomm™‹d
)

2123 
¬’a_chunk_t
 *
chunk
;

2124 
¬’a_chunk_m­_misc_t
 *
misûlm
;

2125 
size_t
 
size
, 
run_šd
, 
run_·ges
, 
æag_dœty
, 
æag_decomm™‹d
;

2127 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
run
);

2128 
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

2129 
run_šd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

2130 
	`as£¹
(
run_šd
 >ğ
m­_bŸs
);

2131 
	`as£¹
(
run_šd
 < 
chunk_Åages
);

2132 
size
 = 
	`¬’a_run_size_g‘
(
¬’a
, 
chunk
, 
run
, 
run_šd
);

2133 
run_·ges
 = (
size
 >> 
LG_PAGE
);

2134 
	`¬’a_Çùive_sub
(
¬’a
, 
run_·ges
);

2141 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
) ==

2142 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
+
run_·ges
-1));

2143 ià(!
ş—Ãd
 && !
decomm™‹d
 && 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
)

2145 
dœty
 = 
Œue
;

2146 
æag_dœty
 = 
dœty
 ? 
CHUNK_MAP_DIRTY
 : 0;

2147 
æag_decomm™‹d
 = 
decomm™‹d
 ? 
CHUNK_MAP_DECOMMITTED
 : 0;

2150 ià(
dœty
 || 
decomm™‹d
) {

2151 
size_t
 
æags
 = 
æag_dœty
 | 
æag_decomm™‹d
;

2152 
	`¬’a_m­b™s_uÇÎoÿ‹d_£t
(
chunk
, 
run_šd
, 
size
, 
æags
);

2153 
	`¬’a_m­b™s_uÇÎoÿ‹d_£t
(
chunk
, 
run_šd
+
run_·ges
-1, 
size
,

2154 
æags
);

2156 
	`¬’a_m­b™s_uÇÎoÿ‹d_£t
(
chunk
, 
run_šd
, 
size
,

2157 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
run_šd
));

2158 
	`¬’a_m­b™s_uÇÎoÿ‹d_£t
(
chunk
, 
run_šd
+
run_·ges
-1, 
size
,

2159 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
run_šd
+
run_·ges
-1));

2162 
	`¬’a_run_cßËsû
(
¬’a
, 
chunk
, &
size
, &
run_šd
, &
run_·ges
,

2163 
æag_dœty
, 
æag_decomm™‹d
);

2166 
	`as£¹
(
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
run_šd
) ==

2167 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
run_šd
+
run_·ges
-1));

2168 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
) ==

2169 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
+
run_·ges
-1));

2170 
	`as£¹
(
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
run_šd
) ==

2171 
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
run_šd
+
run_·ges
-1));

2172 
	`¬’a_ava_š£¹
(
¬’a
, 
chunk
, 
run_šd
, 
run_·ges
);

2174 ià(
dœty
)

2175 
	`¬’a_run_dœty_š£¹
(
¬’a
, 
chunk
, 
run_šd
, 
run_·ges
);

2178 ià(
size
 =ğ
¬’a_maxrun
) {

2179 
	`as£¹
(
run_šd
 =ğ
m­_bŸs
);

2180 
	`as£¹
(
run_·ges
 =ğ(
¬’a_maxrun
 >> 
LG_PAGE
));

2181 
	`¬’a_chunk_d®loc
(
tsdn
, 
¬’a
, 
chunk
);

2191 ià(
dœty
)

2192 
	`¬’a_maybe_purge
(
tsdn
, 
¬’a
);

2193 
	}
}

2196 
	$¬’a_run_Œim_h—d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

2197 
¬’a_run_t
 *
run
, 
size_t
 
Şdsize
, size_ˆ
Ãwsize
)

2199 
¬’a_chunk_m­_misc_t
 *
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

2200 
size_t
 
·gešd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

2201 
size_t
 
h—d_Åages
 = (
Şdsize
 - 
Ãwsize
è>> 
LG_PAGE
;

2202 
size_t
 
æag_dœty
 = 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
);

2203 
size_t
 
æag_decomm™‹d
 = 
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
·gešd
);

2204 
size_t
 
æag_unz”Ûd_mask
 = (
æag_dœty
 | 
æag_decomm™‹d
) == 0 ?

2205 
CHUNK_MAP_UNZEROED
 : 0;

2207 
	`as£¹
(
Şdsize
 > 
Ãwsize
);

2214 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
, 
·gešd
è=ğ
Şdsize
);

2215 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
+
h—d_Åages
-1, 0, 
æag_dœty
 |

2216 (
æag_unz”Ûd_mask
 & 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
,

2217 
·gešd
+
h—d_Åages
-1)));

2218 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
, 
Şdsize
-
Ãwsize
, 
æag_dœty
 |

2219 (
æag_unz”Ûd_mask
 & 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
·gešd
)));

2221 ià(
cÚfig_debug
) {

2222 
UNUSED
 
size_t
 
_Åages
 = 
Ãwsize
 >> 
LG_PAGE
;

2223 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
,

2224 
·gešd
+
h—d_Åages
+
_Åages
-1) == 0);

2225 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
,

2226 
·gešd
+
h—d_Åages
+
_Åages
-1è=ğ
æag_dœty
);

2228 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
+
h—d_Åages
, 
Ãwsize
,

2229 
æag_dœty
 | (
æag_unz”Ûd_mask
 & 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
,

2230 
·gešd
+
h—d_Åages
)));

2232 
	`¬’a_run_d®loc
(
tsdn
, 
¬’a
, 
run
, 
çl£
, f®£, (
æag_decomm™‹d
 !=

2234 
	}
}

2237 
	$¬’a_run_Œim_
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

2238 
¬’a_run_t
 *
run
, 
size_t
 
Şdsize
, size_ˆ
Ãwsize
, 
boŞ
 
dœty
)

2240 
¬’a_chunk_m­_misc_t
 *
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

2241 
size_t
 
·gešd
 = 
	`¬’a_misûlm_to_·gešd
(
misûlm
);

2242 
size_t
 
h—d_Åages
 = 
Ãwsize
 >> 
LG_PAGE
;

2243 
size_t
 
æag_dœty
 = 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
);

2244 
size_t
 
æag_decomm™‹d
 = 
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
, 
·gešd
);

2245 
size_t
 
æag_unz”Ûd_mask
 = (
æag_dœty
 | 
æag_decomm™‹d
) == 0 ?

2246 
CHUNK_MAP_UNZEROED
 : 0;

2247 
¬’a_chunk_m­_misc_t
 *
_misûlm
;

2248 
¬’a_run_t
 *
_run
;

2250 
	`as£¹
(
Şdsize
 > 
Ãwsize
);

2257 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
, 
·gešd
è=ğ
Şdsize
);

2258 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
+
h—d_Åages
-1, 0, 
æag_dœty
 |

2259 (
æag_unz”Ûd_mask
 & 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
,

2260 
·gešd
+
h—d_Åages
-1)));

2261 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
, 
Ãwsize
, 
æag_dœty
 |

2262 (
æag_unz”Ûd_mask
 & 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
·gešd
)));

2264 ià(
cÚfig_debug
) {

2265 
UNUSED
 
size_t
 
_Åages
 = (
Şdsize
 - 
Ãwsize
è>> 
LG_PAGE
;

2266 
	`as£¹
(
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
,

2267 
·gešd
+
h—d_Åages
+
_Åages
-1) == 0);

2268 
	`as£¹
(
	`¬’a_m­b™s_dœty_g‘
(
chunk
,

2269 
·gešd
+
h—d_Åages
+
_Åages
-1è=ğ
æag_dœty
);

2271 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
+
h—d_Åages
, 
Şdsize
-
Ãwsize
,

2272 
æag_dœty
 | (
æag_unz”Ûd_mask
 & 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
,

2273 
·gešd
+
h—d_Åages
)));

2275 
_misûlm
 = 
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
·gešd
 + 
h—d_Åages
);

2276 
_run
 = &
_misûlm
->
run
;

2277 
	`¬’a_run_d®loc
(
tsdn
, 
¬’a
, 
_run
, 
dœty
, 
çl£
, (
æag_decomm™‹d


2279 
	}
}

2282 
	$¬’a_bš_runs_š£¹
(
¬’a_bš_t
 *
bš
, 
¬’a_run_t
 *
run
)

2284 
¬’a_chunk_m­_misc_t
 *
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

2286 
	`¬’a_run_h—p_š£¹
(&
bš
->
runs
, 
misûlm
);

2287 
	}
}

2289 
¬’a_run_t
 *

2290 
	$¬’a_bš_nÚfuÎ_run_Œyg‘
(
¬’a_bš_t
 *
bš
)

2292 
¬’a_chunk_m­_misc_t
 *
misûlm
;

2294 
misûlm
 = 
	`¬’a_run_h—p_»move_fœ¡
(&
bš
->
runs
);

2295 ià(
misûlm
 =ğ
NULL
)

2296  (
NULL
);

2297 ià(
cÚfig_¡©s
)

2298 
bš
->
¡©s
.
»runs
++;

2300  (&
misûlm
->
run
);

2301 
	}
}

2303 
¬’a_run_t
 *

2304 
	$¬’a_bš_nÚfuÎ_run_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_bš_t
 *
bš
)

2306 
¬’a_run_t
 *
run
;

2307 
szšd_t
 
bššd
;

2308 
¬’a_bš_šfo_t
 *
bš_šfo
;

2311 
run
 = 
	`¬’a_bš_nÚfuÎ_run_Œyg‘
(
bš
);

2312 ià(
run
 !ğ
NULL
)

2313  (
run
);

2316 
bššd
 = 
	`¬’a_bš_šdex
(
¬’a
, 
bš
);

2317 
bš_šfo
 = &
¬’a_bš_šfo
[
bššd
];

2320 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
bš
->
lock
);

2322 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

2323 
run
 = 
	`¬’a_run_®loc_sm®l
(
tsdn
, 
¬’a
, 
bš_šfo
->
run_size
, 
bššd
);

2324 ià(
run
 !ğ
NULL
) {

2326 
run
->
bššd
 = binind;

2327 
run
->
nä“
 = 
bš_šfo
->
Äegs
;

2328 
	`b™m­_š™
(
run
->
b™m­
, &
bš_šfo
->
b™m­_šfo
);

2330 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

2332 
	`m®loc_mu‹x_lock
(
tsdn
, &
bš
->
lock
);

2333 ià(
run
 !ğ
NULL
) {

2334 ià(
cÚfig_¡©s
) {

2335 
bš
->
¡©s
.
Äuns
++;

2336 
bš
->
¡©s
.
cu¼uns
++;

2338  (
run
);

2346 
run
 = 
	`¬’a_bš_nÚfuÎ_run_Œyg‘
(
bš
);

2347 ià(
run
 !ğ
NULL
)

2348  (
run
);

2350  (
NULL
);

2351 
	}
}

2355 
	$¬’a_bš_m®loc_h¬d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_bš_t
 *
bš
)

2357 
szšd_t
 
bššd
;

2358 
¬’a_bš_šfo_t
 *
bš_šfo
;

2359 
¬’a_run_t
 *
run
;

2361 
bššd
 = 
	`¬’a_bš_šdex
(
¬’a
, 
bš
);

2362 
bš_šfo
 = &
¬’a_bš_šfo
[
bššd
];

2363 
bš
->
runcur
 = 
NULL
;

2364 
run
 = 
	`¬’a_bš_nÚfuÎ_run_g‘
(
tsdn
, 
¬’a
, 
bš
);

2365 ià(
bš
->
runcur
 !ğ
NULL
 && bš->runcur->
nä“
 > 0) {

2370 *
»t
;

2371 
	`as£¹
(
bš
->
runcur
->
nä“
 > 0);

2372 
»t
 = 
	`¬’a_run_»g_®loc
(
bš
->
runcur
, 
bš_šfo
);

2373 ià(
run
 !ğ
NULL
) {

2374 
¬’a_chunk_t
 *
chunk
;

2384 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
run
);

2385 ià(
run
->
nä“
 =ğ
bš_šfo
->
Äegs
) {

2386 
	`¬’a_d®loc_bš_run
(
tsdn
, 
¬’a
, 
chunk
, 
run
,

2387 
bš
);

2389 
	`¬’a_bš_low”_run
(
¬’a
, 
run
, 
bš
);

2391  (
»t
);

2394 ià(
run
 =ğ
NULL
)

2395  (
NULL
);

2397 
bš
->
runcur
 = 
run
;

2399 
	`as£¹
(
bš
->
runcur
->
nä“
 > 0);

2401  (
	`¬’a_run_»g_®loc
(
bš
->
runcur
, 
bš_šfo
));

2402 
	}
}

2405 
	$¬’a_tÿche_fl_sm®l
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
tÿche_bš_t
 *
tbš
,

2406 
szšd_t
 
bššd
, 
ušt64_t
 
´of_accumby‹s
)

2408 
i
, 
nfl
;

2409 
¬’a_bš_t
 *
bš
;

2411 
	`as£¹
(
tbš
->
nÿched
 == 0);

2413 ià(
cÚfig_´of
 && 
	`¬’a_´of_accum
(
tsdn
, 
¬’a
, 
´of_accumby‹s
))

2414 
	`´of_idump
(
tsdn
);

2415 
bš
 = &
¬’a
->
bšs
[
bššd
];

2416 
	`m®loc_mu‹x_lock
(
tsdn
, &
bš
->
lock
);

2417 
i
 = 0, 
nfl
 = (
tÿche_bš_šfo
[
bššd
].
nÿched_max
 >>

2418 
tbš
->
lg_fl_div
); 
i
 < 
nfl
; i++) {

2419 
¬’a_run_t
 *
run
;

2420 *
±r
;

2421 ià((
run
 = 
bš
->
runcur
è!ğ
NULL
 &&„un->
nä“
 > 0)

2422 
±r
 = 
	`¬’a_run_»g_®loc
(
run
, &
¬’a_bš_šfo
[
bššd
]);

2424 
±r
 = 
	`¬’a_bš_m®loc_h¬d
(
tsdn
, 
¬’a
, 
bš
);

2425 ià(
±r
 =ğ
NULL
) {

2431 ià(
i
 > 0) {

2432 
	`memmove
(
tbš
->
ava
 - 
i
,bš->ava - 
nfl
,

2433 
i
 * (*));

2437 ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_®loc
)) {

2438 
	`¬’a_®loc_junk_sm®l
(
±r
, &
¬’a_bš_šfo
[
bššd
],

2439 
Œue
);

2442 *(
tbš
->
ava
 - 
nfl
 + 
i
èğ
±r
;

2444 ià(
cÚfig_¡©s
) {

2445 
bš
->
¡©s
.
nm®loc
 +ğ
i
;

2446 
bš
->
¡©s
.
Äeque¡s
 +ğ
tbš
->
t¡©s
.nrequests;

2447 
bš
->
¡©s
.
cu¼egs
 +ğ
i
;

2448 
bš
->
¡©s
.
nfls
++;

2449 
tbš
->
t¡©s
.
Äeque¡s
 = 0;

2451 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
bš
->
lock
);

2452 
tbš
->
nÿched
 = 
i
;

2453 
	`¬’a_deÿy_tick
(
tsdn
, 
¬’a
);

2454 
	}
}

2457 
	$¬’a_®loc_junk_sm®l
(*
±r
, 
¬’a_bš_šfo_t
 *
bš_šfo
, 
boŞ
 
z”o
)

2460 
size_t
 
»dzÚe_size
 = 
bš_šfo
->redzone_size;

2462 ià(
z”o
) {

2463 
	`mem£t
((*)((
ušŒ_t
)
±r
 - 
»dzÚe_size
),

2464 
JEMALLOC_ALLOC_JUNK
, 
»dzÚe_size
);

2465 
	`mem£t
((*)((
ušŒ_t
)
±r
 + 
bš_šfo
->
»g_size
),

2466 
JEMALLOC_ALLOC_JUNK
, 
»dzÚe_size
);

2468 
	`mem£t
((*)((
ušŒ_t
)
±r
 - 
»dzÚe_size
),

2469 
JEMALLOC_ALLOC_JUNK
, 
bš_šfo
->
»g_š‹rv®
);

2471 
	}
}

2473 #ifdeà
JEMALLOC_JET


2474 #undeà
¬’a_»dzÚe_cÜru±iÚ


2475 
	#¬’a_»dzÚe_cÜru±iÚ
 
	`JEMALLOC_N
(
n_¬’a_»dzÚe_cÜru±iÚ
)

	)

2478 
	$¬’a_»dzÚe_cÜru±iÚ
(*
±r
, 
size_t
 
usize
, 
boŞ
 
aá”
,

2479 
size_t
 
off£t
, 
ušt8_t
 
by‹
)

2482 
	`m®loc_´štf
("<jemalloc>: Corrupt„edzone %zu byte%s %s %p "

2483 "(siz%zu), by‹=%#x\n", 
off£t
, (offset == 1) ? "" : "s",

2484 
aá”
 ? "aá”" : "befÜe", 
±r
, 
usize
, 
by‹
);

2485 
	}
}

2486 #ifdeà
JEMALLOC_JET


2487 #undeà
¬’a_»dzÚe_cÜru±iÚ


2488 
	#¬’a_»dzÚe_cÜru±iÚ
 
	`JEMALLOC_N
(
¬’a_»dzÚe_cÜru±iÚ
)

	)

2489 
¬’a_»dzÚe_cÜru±iÚ_t
 *
	g¬’a_»dzÚe_cÜru±iÚ
 =

2490 
JEMALLOC_N
(
n_¬’a_»dzÚe_cÜru±iÚ
);

2494 
	$¬’a_»dzÚes_v®id©e
(*
±r
, 
¬’a_bš_šfo_t
 *
bš_šfo
, 
boŞ
 
»£t
)

2496 
boŞ
 
”rÜ
 = 
çl£
;

2498 ià(
İt_junk_®loc
) {

2499 
size_t
 
size
 = 
bš_šfo
->
»g_size
;

2500 
size_t
 
»dzÚe_size
 = 
bš_šfo
->redzone_size;

2501 
size_t
 
i
;

2503 
i
 = 1; i <ğ
»dzÚe_size
; i++) {

2504 
ušt8_t
 *
by‹
 = (ušt8_ˆ*)((
ušŒ_t
)
±r
 - 
i
);

2505 ià(*
by‹
 !ğ
JEMALLOC_ALLOC_JUNK
) {

2506 
”rÜ
 = 
Œue
;

2507 
	`¬’a_»dzÚe_cÜru±iÚ
(
±r
, 
size
, 
çl£
, 
i
,

2508 *
by‹
);

2509 ià(
»£t
)

2510 *
by‹
 = 
JEMALLOC_ALLOC_JUNK
;

2513 
i
 = 0; i < 
»dzÚe_size
; i++) {

2514 
ušt8_t
 *
by‹
 = (ušt8_ˆ*)((
ušŒ_t
)
±r
 + 
size
 + 
i
);

2515 ià(*
by‹
 !ğ
JEMALLOC_ALLOC_JUNK
) {

2516 
”rÜ
 = 
Œue
;

2517 
	`¬’a_»dzÚe_cÜru±iÚ
(
±r
, 
size
, 
Œue
, 
i
,

2518 *
by‹
);

2519 ià(
»£t
)

2520 *
by‹
 = 
JEMALLOC_ALLOC_JUNK
;

2525 ià(
İt_abÜt
 && 
”rÜ
)

2526 
	`abÜt
();

2527 
	}
}

2529 #ifdeà
JEMALLOC_JET


2530 #undeà
¬’a_d®loc_junk_sm®l


2531 
	#¬’a_d®loc_junk_sm®l
 
	`JEMALLOC_N
(
n_¬’a_d®loc_junk_sm®l
)

	)

2534 
	$¬’a_d®loc_junk_sm®l
(*
±r
, 
¬’a_bš_šfo_t
 *
bš_šfo
)

2536 
size_t
 
»dzÚe_size
 = 
bš_šfo
->redzone_size;

2538 
	`¬’a_»dzÚes_v®id©e
(
±r
, 
bš_šfo
, 
çl£
);

2539 
	`mem£t
((*)((
ušŒ_t
)
±r
 - 
»dzÚe_size
), 
JEMALLOC_FREE_JUNK
,

2540 
bš_šfo
->
»g_š‹rv®
);

2541 
	}
}

2542 #ifdeà
JEMALLOC_JET


2543 #undeà
¬’a_d®loc_junk_sm®l


2544 
	#¬’a_d®loc_junk_sm®l
 
	`JEMALLOC_N
(
¬’a_d®loc_junk_sm®l
)

	)

2545 
¬’a_d®loc_junk_sm®l_t
 *
	g¬’a_d®loc_junk_sm®l
 =

2546 
JEMALLOC_N
(
n_¬’a_d®loc_junk_sm®l
);

2550 
	$¬’a_qu¬ªtše_junk_sm®l
(*
±r
, 
size_t
 
usize
)

2552 
szšd_t
 
bššd
;

2553 
¬’a_bš_šfo_t
 *
bš_šfo
;

2554 
	`ÿs£¹
(
cÚfig_fl
);

2555 
	`as£¹
(
İt_junk_ä“
);

2556 
	`as£¹
(
İt_qu¬ªtše
);

2557 
	`as£¹
(
usize
 <ğ
SMALL_MAXCLASS
);

2559 
bššd
 = 
	`size2šdex
(
usize
);

2560 
bš_šfo
 = &
¬’a_bš_šfo
[
bššd
];

2561 
	`¬’a_»dzÚes_v®id©e
(
±r
, 
bš_šfo
, 
Œue
);

2562 
	}
}

2565 
	$¬’a_m®loc_sm®l
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
szšd_t
 
bššd
, 
boŞ
 
z”o
)

2567 *
»t
;

2568 
¬’a_bš_t
 *
bš
;

2569 
size_t
 
usize
;

2570 
¬’a_run_t
 *
run
;

2572 
	`as£¹
(
bššd
 < 
NBINS
);

2573 
bš
 = &
¬’a
->
bšs
[
bššd
];

2574 
usize
 = 
	`šdex2size
(
bššd
);

2576 
	`m®loc_mu‹x_lock
(
tsdn
, &
bš
->
lock
);

2577 ià((
run
 = 
bš
->
runcur
è!ğ
NULL
 &&„un->
nä“
 > 0)

2578 
»t
 = 
	`¬’a_run_»g_®loc
(
run
, &
¬’a_bš_šfo
[
bššd
]);

2580 
»t
 = 
	`¬’a_bš_m®loc_h¬d
(
tsdn
, 
¬’a
, 
bš
);

2582 ià(
»t
 =ğ
NULL
) {

2583 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
bš
->
lock
);

2584  (
NULL
);

2587 ià(
cÚfig_¡©s
) {

2588 
bš
->
¡©s
.
nm®loc
++;

2589 
bš
->
¡©s
.
Äeque¡s
++;

2590 
bš
->
¡©s
.
cu¼egs
++;

2592 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
bš
->
lock
);

2593 ià(
cÚfig_´of
 && !
i¡h»aded
 && 
	`¬’a_´of_accum
(
tsdn
, 
¬’a
, 
usize
))

2594 
	`´of_idump
(
tsdn
);

2596 ià(!
z”o
) {

2597 ià(
cÚfig_fl
) {

2598 ià(
	`uÆik–y
(
İt_junk_®loc
)) {

2599 
	`¬’a_®loc_junk_sm®l
(
»t
,

2600 &
¬’a_bš_šfo
[
bššd
], 
çl£
);

2601 } ià(
	`uÆik–y
(
İt_z”o
))

2602 
	`mem£t
(
»t
, 0, 
usize
);

2604 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
»t
, 
usize
);

2606 ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_®loc
)) {

2607 
	`¬’a_®loc_junk_sm®l
(
»t
, &
¬’a_bš_šfo
[
bššd
],

2608 
Œue
);

2610 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
»t
, 
usize
);

2611 
	`mem£t
(
»t
, 0, 
usize
);

2614 
	`¬’a_deÿy_tick
(
tsdn
, 
¬’a
);

2615  (
»t
);

2616 
	}
}

2619 
	$¬’a_m®loc_Ïrge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
szšd_t
 
bššd
, 
boŞ
 
z”o
)

2621 *
»t
;

2622 
size_t
 
usize
;

2623 
ušŒ_t
 
¿ndom_off£t
;

2624 
¬’a_run_t
 *
run
;

2625 
¬’a_chunk_m­_misc_t
 *
misûlm
;

2626 
UNUSED
 
boŞ
 
idump
 
	`JEMALLOC_CC_SILENCE_INIT
(
çl£
);

2629 
usize
 = 
	`šdex2size
(
bššd
);

2630 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

2631 ià(
cÚfig_ÿche_oblivious
) {

2632 
ušt64_t
 
r
;

2639 
r
 = 
	`´ng_lg_¿nge_zu
(&
¬’a
->
off£t_¡©e
, 
LG_PAGE
 -

2640 
LG_CACHELINE
, 
çl£
);

2641 
¿ndom_off£t
 = ((
ušŒ_t
)
r
è<< 
LG_CACHELINE
;

2643 
¿ndom_off£t
 = 0;

2644 
run
 = 
	`¬’a_run_®loc_Ïrge
(
tsdn
, 
¬’a
, 
usize
 + 
Ïrge_·d
, 
z”o
);

2645 ià(
run
 =ğ
NULL
) {

2646 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

2647  (
NULL
);

2649 
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

2650 
»t
 = (*)((
ušŒ_t
)
	`¬’a_misûlm_to_½ages
(
misûlm
) +

2651 
¿ndom_off£t
);

2652 ià(
cÚfig_¡©s
) {

2653 
szšd_t
 
šdex
 = 
bššd
 - 
NBINS
;

2655 
¬’a
->
¡©s
.
nm®loc_Ïrge
++;

2656 
¬’a
->
¡©s
.
Äeque¡s_Ïrge
++;

2657 
¬’a
->
¡©s
.
®loÿ‹d_Ïrge
 +ğ
usize
;

2658 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
nm®loc
++;

2659 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
Äeque¡s
++;

2660 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
cu¼uns
++;

2662 ià(
cÚfig_´of
)

2663 
idump
 = 
	`¬’a_´of_accum_locked
(
¬’a
, 
usize
);

2664 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

2665 ià(
cÚfig_´of
 && 
idump
)

2666 
	`´of_idump
(
tsdn
);

2668 ià(!
z”o
) {

2669 ià(
cÚfig_fl
) {

2670 ià(
	`uÆik–y
(
İt_junk_®loc
))

2671 
	`mem£t
(
»t
, 
JEMALLOC_ALLOC_JUNK
, 
usize
);

2672 ià(
	`uÆik–y
(
İt_z”o
))

2673 
	`mem£t
(
»t
, 0, 
usize
);

2677 
	`¬’a_deÿy_tick
(
tsdn
, 
¬’a
);

2678  (
»t
);

2679 
	}
}

2682 
	$¬’a_m®loc_h¬d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
size
, 
szšd_t
 
šd
,

2683 
boŞ
 
z”o
)

2686 
	`as£¹
(!
	`tsdn_nuÎ
(
tsdn
è|| 
¬’a
 !ğ
NULL
);

2688 ià(
	`lik–y
(!
	`tsdn_nuÎ
(
tsdn
)))

2689 
¬’a
 = 
	`¬’a_choo£
(
	`tsdn_tsd
(
tsdn
),‡rena);

2690 ià(
	`uÆik–y
(
¬’a
 =ğ
NULL
))

2691  (
NULL
);

2693 ià(
	`lik–y
(
size
 <ğ
SMALL_MAXCLASS
))

2694  (
	`¬’a_m®loc_sm®l
(
tsdn
, 
¬’a
, 
šd
, 
z”o
));

2695 ià(
	`lik–y
(
size
 <ğ
Ïrge_maxşass
))

2696  (
	`¬’a_m®loc_Ïrge
(
tsdn
, 
¬’a
, 
šd
, 
z”o
));

2697  (
	`huge_m®loc
(
tsdn
, 
¬’a
, 
	`šdex2size
(
šd
), 
z”o
));

2698 
	}
}

2702 
	$¬’a_·Îoc_Ïrge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
, size_ˆ
®ignm’t
,

2703 
boŞ
 
z”o
)

2705 *
»t
;

2706 
size_t
 
®loc_size
, 
Ëadsize
, 
Œasize
;

2707 
¬’a_run_t
 *
run
;

2708 
¬’a_chunk_t
 *
chunk
;

2709 
¬’a_chunk_m­_misc_t
 *
misûlm
;

2710 *
½ages
;

2712 
	`as£¹
(!
	`tsdn_nuÎ
(
tsdn
è|| 
¬’a
 !ğ
NULL
);

2713 
	`as£¹
(
usize
 =ğ
	`PAGE_CEILING
(usize));

2715 ià(
	`lik–y
(!
	`tsdn_nuÎ
(
tsdn
)))

2716 
¬’a
 = 
	`¬’a_choo£
(
	`tsdn_tsd
(
tsdn
),‡rena);

2717 ià(
	`uÆik–y
(
¬’a
 =ğ
NULL
))

2718  (
NULL
);

2720 
®ignm’t
 = 
	`PAGE_CEILING
(alignment);

2721 
®loc_size
 = 
usize
 + 
Ïrge_·d
 + 
®ignm’t
 - 
PAGE
;

2723 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

2724 
run
 = 
	`¬’a_run_®loc_Ïrge
(
tsdn
, 
¬’a
, 
®loc_size
, 
çl£
);

2725 ià(
run
 =ğ
NULL
) {

2726 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

2727  (
NULL
);

2729 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
run
);

2730 
misûlm
 = 
	`¬’a_run_to_misûlm
(
run
);

2731 
½ages
 = 
	`¬’a_misûlm_to_½ages
(
misûlm
);

2733 
Ëadsize
 = 
	`ALIGNMENT_CEILING
((
ušŒ_t
)
½ages
, 
®ignm’t
) -

2734 (
ušŒ_t
)
½ages
;

2735 
	`as£¹
(
®loc_size
 >ğ
Ëadsize
 + 
usize
);

2736 
Œasize
 = 
®loc_size
 - 
Ëadsize
 - 
usize
 - 
Ïrge_·d
;

2737 ià(
Ëadsize
 != 0) {

2738 
¬’a_chunk_m­_misc_t
 *
h—d_misûlm
 = 
misûlm
;

2739 
¬’a_run_t
 *
h—d_run
 = 
run
;

2741 
misûlm
 = 
	`¬’a_misûlm_g‘_mubË
(
chunk
,

2742 
	`¬’a_misûlm_to_·gešd
(
h—d_misûlm
è+ (
Ëadsize
 >>

2743 
LG_PAGE
));

2744 
run
 = &
misûlm
->run;

2746 
	`¬’a_run_Œim_h—d
(
tsdn
, 
¬’a
, 
chunk
, 
h—d_run
, 
®loc_size
,

2747 
®loc_size
 - 
Ëadsize
);

2749 ià(
Œasize
 != 0) {

2750 
	`¬’a_run_Œim_
(
tsdn
, 
¬’a
, 
chunk
, 
run
, 
usize
 + 
Ïrge_·d
 +

2751 
Œasize
, 
usize
 + 
Ïrge_·d
, 
çl£
);

2753 ià(
	`¬’a_run_š™_Ïrge
(
¬’a
, 
run
, 
usize
 + 
Ïrge_·d
, 
z”o
)) {

2754 
size_t
 
run_šd
 =

2755 
	`¬’a_misûlm_to_·gešd
(
	`¬’a_run_to_misûlm
(
run
));

2756 
boŞ
 
dœty
 = (
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
run_šd
) != 0);

2757 
boŞ
 
decomm™‹d
 = (
	`¬’a_m­b™s_decomm™‹d_g‘
(
chunk
,

2758 
run_šd
) != 0);

2760 
	`as£¹
(
decomm™‹d
);

2761 
	`¬’a_run_d®loc
(
tsdn
, 
¬’a
, 
run
, 
dœty
, 
çl£
, 
decomm™‹d
);

2762 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

2763  (
NULL
);

2765 
»t
 = 
	`¬’a_misûlm_to_½ages
(
misûlm
);

2767 ià(
cÚfig_¡©s
) {

2768 
szšd_t
 
šdex
 = 
	`size2šdex
(
usize
è- 
NBINS
;

2770 
¬’a
->
¡©s
.
nm®loc_Ïrge
++;

2771 
¬’a
->
¡©s
.
Äeque¡s_Ïrge
++;

2772 
¬’a
->
¡©s
.
®loÿ‹d_Ïrge
 +ğ
usize
;

2773 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
nm®loc
++;

2774 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
Äeque¡s
++;

2775 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
cu¼uns
++;

2777 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

2779 ià(
cÚfig_fl
 && !
z”o
) {

2780 ià(
	`uÆik–y
(
İt_junk_®loc
))

2781 
	`mem£t
(
»t
, 
JEMALLOC_ALLOC_JUNK
, 
usize
);

2782 ià(
	`uÆik–y
(
İt_z”o
))

2783 
	`mem£t
(
»t
, 0, 
usize
);

2785 
	`¬’a_deÿy_tick
(
tsdn
, 
¬’a
);

2786  (
»t
);

2787 
	}
}

2790 
	$¬’a_·Îoc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
, size_ˆ
®ignm’t
,

2791 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
)

2793 *
»t
;

2795 ià(
usize
 <ğ
SMALL_MAXCLASS
 && (
®ignm’t
 < 
PAGE
 || (alignment == PAGE

2796 && (
usize
 & 
PAGE_MASK
) == 0))) {

2798 
»t
 = 
	`¬’a_m®loc
(
tsdn
, 
¬’a
, 
usize
, 
	`size2šdex
(usize), 
z”o
,

2799 
tÿche
, 
Œue
);

2800 } ià(
usize
 <ğ
Ïrge_maxşass
 && 
®ignm’t
 <ğ
PAGE
) {

2807 
»t
 = 
	`¬’a_m®loc
(
tsdn
, 
¬’a
, 
usize
, 
	`size2šdex
(usize), 
z”o
,

2808 
tÿche
, 
Œue
);

2809 ià(
cÚfig_ÿche_oblivious
)

2810 
»t
 = (*)((
ušŒ_t
ì‘ & ~
PAGE_MASK
);

2812 ià(
	`lik–y
(
usize
 <ğ
Ïrge_maxşass
)) {

2813 
»t
 = 
	`¬’a_·Îoc_Ïrge
(
tsdn
, 
¬’a
, 
usize
, 
®ignm’t
,

2814 
z”o
);

2815 } ià(
	`lik–y
(
®ignm’t
 <ğ
chunksize
))

2816 
»t
 = 
	`huge_m®loc
(
tsdn
, 
¬’a
, 
usize
, 
z”o
);

2818 
»t
 = 
	`huge_·Îoc
(
tsdn
, 
¬’a
, 
usize
, 
®ignm’t
, 
z”o
);

2821  (
»t
);

2822 
	}
}

2825 
	$¬’a_´of_´omÙed
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
size
)

2827 
¬’a_chunk_t
 *
chunk
;

2828 
size_t
 
·gešd
;

2829 
szšd_t
 
bššd
;

2831 
	`ÿs£¹
(
cÚfig_´of
);

2832 
	`as£¹
(
±r
 !ğ
NULL
);

2833 
	`as£¹
(
	`CHUNK_ADDR2BASE
(
±r
) !=…tr);

2834 
	`as£¹
(
	`i§Îoc
(
tsdn
, 
±r
, 
çl£
è=ğ
LARGE_MINCLASS
);

2835 
	`as£¹
(
	`i§Îoc
(
tsdn
, 
±r
, 
Œue
è=ğ
LARGE_MINCLASS
);

2836 
	`as£¹
(
size
 <ğ
SMALL_MAXCLASS
);

2838 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

2839 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

2840 
bššd
 = 
	`size2šdex
(
size
);

2841 
	`as£¹
(
bššd
 < 
NBINS
);

2842 
	`¬’a_m­b™s_Ïrge_bššd_£t
(
chunk
, 
·gešd
, 
bššd
);

2844 
	`as£¹
(
	`i§Îoc
(
tsdn
, 
±r
, 
çl£
è=ğ
LARGE_MINCLASS
);

2845 
	`as£¹
(
	`i§Îoc
(
tsdn
, 
±r
, 
Œue
è=ğ
size
);

2846 
	}
}

2849 
	$¬’a_dissocŸ‹_bš_run
(
¬’a_chunk_t
 *
chunk
, 
¬’a_run_t
 *
run
,

2850 
¬’a_bš_t
 *
bš
)

2854 ià(
run
 =ğ
bš
->
runcur
)

2855 
bš
->
runcur
 = 
NULL
;

2857 
szšd_t
 
bššd
 = 
	`¬’a_bš_šdex
(
	`ex‹Á_node_¬’a_g‘
(

2858 &
chunk
->
node
), 
bš
);

2859 
¬’a_bš_šfo_t
 *
bš_šfo
 = &
¬’a_bš_šfo
[
bššd
];

2866 ià(
bš_šfo
->
Äegs
 != 1) {

2867 
¬’a_chunk_m­_misc_t
 *
misûlm
 =

2868 
	`¬’a_run_to_misûlm
(
run
);

2870 
	`¬’a_run_h—p_»move
(&
bš
->
runs
, 
misûlm
);

2873 
	}
}

2876 
	$¬’a_d®loc_bš_run
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

2877 
¬’a_run_t
 *
run
, 
¬’a_bš_t
 *
bš
)

2880 
	`as£¹
(
run
 !ğ
bš
->
runcur
);

2882 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
bš
->
lock
);

2884 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

2885 
	`¬’a_run_d®loc
(
tsdn
, 
¬’a
, 
run
, 
Œue
, 
çl£
, false);

2886 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

2888 
	`m®loc_mu‹x_lock
(
tsdn
, &
bš
->
lock
);

2889 ià(
cÚfig_¡©s
)

2890 
bš
->
¡©s
.
cu¼uns
--;

2891 
	}
}

2894 
	$¬’a_bš_low”_run
(
¬’a_t
 *
¬’a
, 
¬’a_run_t
 *
run
, 
¬’a_bš_t
 *
bš
)

2903 ià(
bš
->
runcur
 !ğ
NULL
 &&

2904 
	`¬’a_¢ad_comp
(
	`¬’a_run_to_misûlm
(
bš
->
runcur
),

2905 
	`¬’a_run_to_misûlm
(
run
)) > 0) {

2907 ià(
bš
->
runcur
->
nä“
 > 0)

2908 
	`¬’a_bš_runs_š£¹
(
bš
, bš->
runcur
);

2909 
bš
->
runcur
 = 
run
;

2910 ià(
cÚfig_¡©s
)

2911 
bš
->
¡©s
.
»runs
++;

2913 
	`¬’a_bš_runs_š£¹
(
bš
, 
run
);

2914 
	}
}

2917 
	$¬’a_d®loc_bš_locked_im¶
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

2918 *
±r
, 
¬’a_chunk_m­_b™s_t
 *
b™£lm
, 
boŞ
 
junked
)

2920 
size_t
 
·gešd
, 
½ages_šd
;

2921 
¬’a_run_t
 *
run
;

2922 
¬’a_bš_t
 *
bš
;

2923 
¬’a_bš_šfo_t
 *
bš_šfo
;

2924 
szšd_t
 
bššd
;

2926 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

2927 
½ages_šd
 = 
·gešd
 - 
	`¬’a_m­b™s_sm®l_runšd_g‘
(
chunk
,…ageind);

2928 
run
 = &
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
½ages_šd
)->run;

2929 
bššd
 = 
run
->binind;

2930 
bš
 = &
¬’a
->
bšs
[
bššd
];

2931 
bš_šfo
 = &
¬’a_bš_šfo
[
bššd
];

2933 ià(!
junked
 && 
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_ä“
))

2934 
	`¬’a_d®loc_junk_sm®l
(
±r
, 
bš_šfo
);

2936 
	`¬’a_run_»g_d®loc
(
run
, 
±r
);

2937 ià(
run
->
nä“
 =ğ
bš_šfo
->
Äegs
) {

2938 
	`¬’a_dissocŸ‹_bš_run
(
chunk
, 
run
, 
bš
);

2939 
	`¬’a_d®loc_bš_run
(
tsdn
, 
¬’a
, 
chunk
, 
run
, 
bš
);

2940 } ià(
run
->
nä“
 =ğ1 &&„uÀ!ğ
bš
->
runcur
)

2941 
	`¬’a_bš_low”_run
(
¬’a
, 
run
, 
bš
);

2943 ià(
cÚfig_¡©s
) {

2944 
bš
->
¡©s
.
nd®loc
++;

2945 
bš
->
¡©s
.
cu¼egs
--;

2947 
	}
}

2950 
	$¬’a_d®loc_bš_junked_locked
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

2951 
¬’a_chunk_t
 *
chunk
, *
±r
, 
¬’a_chunk_m­_b™s_t
 *
b™£lm
)

2954 
	`¬’a_d®loc_bš_locked_im¶
(
tsdn
, 
¬’a
, 
chunk
, 
±r
, 
b™£lm
, 
Œue
);

2955 
	}
}

2958 
	$¬’a_d®loc_bš
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
, *
±r
,

2959 
size_t
 
·gešd
, 
¬’a_chunk_m­_b™s_t
 *
b™£lm
)

2961 
¬’a_run_t
 *
run
;

2962 
¬’a_bš_t
 *
bš
;

2963 
size_t
 
½ages_šd
;

2965 
½ages_šd
 = 
·gešd
 - 
	`¬’a_m­b™s_sm®l_runšd_g‘
(
chunk
,…ageind);

2966 
run
 = &
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
½ages_šd
)->run;

2967 
bš
 = &
¬’a
->
bšs
[
run
->
bššd
];

2968 
	`m®loc_mu‹x_lock
(
tsdn
, &
bš
->
lock
);

2969 
	`¬’a_d®loc_bš_locked_im¶
(
tsdn
, 
¬’a
, 
chunk
, 
±r
, 
b™£lm
, 
çl£
);

2970 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
bš
->
lock
);

2971 
	}
}

2974 
	$¬’a_d®loc_sm®l
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

2975 *
±r
, 
size_t
 
·gešd
)

2977 
¬’a_chunk_m­_b™s_t
 *
b™£lm
;

2979 ià(
cÚfig_debug
) {

2981 
	`as£¹
(
	`¬’a_±r_sm®l_bššd_g‘
(
±r
, 
	`¬’a_m­b™s_g‘
(
chunk
,

2982 
·gešd
)è!ğ
BININD_INVALID
);

2984 
b™£lm
 = 
	`¬’a_b™£lm_g‘_mubË
(
chunk
, 
·gešd
);

2985 
	`¬’a_d®loc_bš
(
tsdn
, 
¬’a
, 
chunk
, 
±r
, 
·gešd
, 
b™£lm
);

2986 
	`¬’a_deÿy_tick
(
tsdn
, 
¬’a
);

2987 
	}
}

2989 #ifdeà
JEMALLOC_JET


2990 #undeà
¬’a_d®loc_junk_Ïrge


2991 
	#¬’a_d®loc_junk_Ïrge
 
	`JEMALLOC_N
(
n_¬’a_d®loc_junk_Ïrge
)

	)

2994 
	$¬’a_d®loc_junk_Ïrge
(*
±r
, 
size_t
 
usize
)

2997 ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_ä“
))

2998 
	`mem£t
(
±r
, 
JEMALLOC_FREE_JUNK
, 
usize
);

2999 
	}
}

3000 #ifdeà
JEMALLOC_JET


3001 #undeà
¬’a_d®loc_junk_Ïrge


3002 
	#¬’a_d®loc_junk_Ïrge
 
	`JEMALLOC_N
(
¬’a_d®loc_junk_Ïrge
)

	)

3003 
¬’a_d®loc_junk_Ïrge_t
 *
	g¬’a_d®loc_junk_Ïrge
 =

3004 
JEMALLOC_N
(
n_¬’a_d®loc_junk_Ïrge
);

3008 
	$¬’a_d®loc_Ïrge_locked_im¶
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

3009 
¬’a_chunk_t
 *
chunk
, *
±r
, 
boŞ
 
junked
)

3011 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

3012 
¬’a_chunk_m­_misc_t
 *
misûlm
 = 
	`¬’a_misûlm_g‘_mubË
(
chunk
,

3013 
·gešd
);

3014 
¬’a_run_t
 *
run
 = &
misûlm
->run;

3016 ià(
cÚfig_fl
 || 
cÚfig_¡©s
) {

3017 
size_t
 
usize
 = 
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
, 
·gešd
) -

3018 
Ïrge_·d
;

3020 ià(!
junked
)

3021 
	`¬’a_d®loc_junk_Ïrge
(
±r
, 
usize
);

3022 ià(
cÚfig_¡©s
) {

3023 
szšd_t
 
šdex
 = 
	`size2šdex
(
usize
è- 
NBINS
;

3025 
¬’a
->
¡©s
.
nd®loc_Ïrge
++;

3026 
¬’a
->
¡©s
.
®loÿ‹d_Ïrge
 -ğ
usize
;

3027 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
nd®loc
++;

3028 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
cu¼uns
--;

3032 
	`¬’a_run_d®loc
(
tsdn
, 
¬’a
, 
run
, 
Œue
, 
çl£
, false);

3033 
	}
}

3036 
	$¬’a_d®loc_Ïrge_junked_locked
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

3037 
¬’a_chunk_t
 *
chunk
, *
±r
)

3040 
	`¬’a_d®loc_Ïrge_locked_im¶
(
tsdn
, 
¬’a
, 
chunk
, 
±r
, 
Œue
);

3041 
	}
}

3044 
	$¬’a_d®loc_Ïrge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

3045 *
±r
)

3048 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

3049 
	`¬’a_d®loc_Ïrge_locked_im¶
(
tsdn
, 
¬’a
, 
chunk
, 
±r
, 
çl£
);

3050 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

3051 
	`¬’a_deÿy_tick
(
tsdn
, 
¬’a
);

3052 
	}
}

3055 
	$¬’a_¿Îoc_Ïrge_shršk
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

3056 *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
)

3058 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

3059 
¬’a_chunk_m­_misc_t
 *
misûlm
 = 
	`¬’a_misûlm_g‘_mubË
(
chunk
,

3060 
·gešd
);

3061 
¬’a_run_t
 *
run
 = &
misûlm
->run;

3063 
	`as£¹
(
size
 < 
Şdsize
);

3069 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

3070 
	`¬’a_run_Œim_
(
tsdn
, 
¬’a
, 
chunk
, 
run
, 
Şdsize
 + 
Ïrge_·d
, 
size
 +

3071 
Ïrge_·d
, 
Œue
);

3072 ià(
cÚfig_¡©s
) {

3073 
szšd_t
 
Şdšdex
 = 
	`size2šdex
(
Şdsize
è- 
NBINS
;

3074 
szšd_t
 
šdex
 = 
	`size2šdex
(
size
è- 
NBINS
;

3076 
¬’a
->
¡©s
.
nd®loc_Ïrge
++;

3077 
¬’a
->
¡©s
.
®loÿ‹d_Ïrge
 -ğ
Şdsize
;

3078 
¬’a
->
¡©s
.
l¡©s
[
Şdšdex
].
nd®loc
++;

3079 
¬’a
->
¡©s
.
l¡©s
[
Şdšdex
].
cu¼uns
--;

3081 
¬’a
->
¡©s
.
nm®loc_Ïrge
++;

3082 
¬’a
->
¡©s
.
Äeque¡s_Ïrge
++;

3083 
¬’a
->
¡©s
.
®loÿ‹d_Ïrge
 +ğ
size
;

3084 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
nm®loc
++;

3085 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
Äeque¡s
++;

3086 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
cu¼uns
++;

3088 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

3089 
	}
}

3091 
boŞ


3092 
	$¬’a_¿Îoc_Ïrge_grow
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
¬’a_chunk_t
 *
chunk
,

3093 *
±r
, 
size_t
 
Şdsize
, size_ˆ
usize_mš
, size_ˆ
usize_max
, 
boŞ
 
z”o
)

3095 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

3096 
size_t
 
Åages
 = (
Şdsize
 + 
Ïrge_·d
è>> 
LG_PAGE
;

3097 
size_t
 
fŞlowsize
;

3099 
	`as£¹
(
Şdsize
 =ğ
	`¬’a_m­b™s_Ïrge_size_g‘
(
chunk
, 
·gešd
) -

3100 
Ïrge_·d
);

3103 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

3104 ià(
·gešd
+
Åages
 >ğ
chunk_Åages
 || 
	`¬’a_m­b™s_®loÿ‹d_g‘
(
chunk
,

3105 
·gešd
+
Åages
) != 0)

3106 
Ïb–_ç
;

3107 
fŞlowsize
 = 
	`¬’a_m­b™s_uÇÎoÿ‹d_size_g‘
(
chunk
, 
·gešd
+
Åages
);

3108 ià(
Şdsize
 + 
fŞlowsize
 >ğ
usize_mš
) {

3114 
¬’a_run_t
 *
run
;

3115 
size_t
 
usize
, 
¥l™size
, 
size
, 
æag_dœty
, 
æag_unz”Ûd_mask
;

3117 
usize
 = 
usize_max
;

3118 
Şdsize
 + 
fŞlowsize
 < 
usize
)

3119 
usize
 = 
	`šdex2size
(
	`size2šdex
(usize)-1);

3120 
	`as£¹
(
usize
 >ğ
usize_mš
);

3121 
	`as£¹
(
usize
 >ğ
Şdsize
);

3122 
¥l™size
 = 
usize
 - 
Şdsize
;

3123 ià(
¥l™size
 == 0)

3124 
Ïb–_ç
;

3126 
run
 = &
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
·gešd
+
Åages
)->run;

3127 ià(
	`¬’a_run_¥l™_Ïrge
(
¬’a
, 
run
, 
¥l™size
, 
z”o
))

3128 
Ïb–_ç
;

3130 ià(
cÚfig_ÿche_oblivious
 && 
z”o
) {

3138 *
zba£
 = (*)((
ušŒ_t
)
±r
 + 
Şdsize
);

3139 *
z·¡
 = 
	`PAGE_ADDR2BASE
((*)((
ušŒ_t
)
zba£
 +

3140 
PAGE
));

3141 
size_t
 
nz”o
 = (
ušŒ_t
)
z·¡
 - (ušŒ_t)
zba£
;

3142 
	`as£¹
(
nz”o
 > 0);

3143 
	`mem£t
(
zba£
, 0, 
nz”o
);

3146 
size
 = 
Şdsize
 + 
¥l™size
;

3147 
Åages
 = (
size
 + 
Ïrge_·d
è>> 
LG_PAGE
;

3157 
æag_dœty
 = 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
) |

3158 
	`¬’a_m­b™s_dœty_g‘
(
chunk
, 
·gešd
+
Åages
-1);

3159 
æag_unz”Ûd_mask
 = 
æag_dœty
 =ğ0 ? 
CHUNK_MAP_UNZEROED
 : 0;

3160 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
, 
size
 + 
Ïrge_·d
,

3161 
æag_dœty
 | (
æag_unz”Ûd_mask
 &

3162 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
, 
·gešd
)));

3163 
	`¬’a_m­b™s_Ïrge_£t
(
chunk
, 
·gešd
+
Åages
-1, 0, 
æag_dœty
 |

3164 (
æag_unz”Ûd_mask
 & 
	`¬’a_m­b™s_unz”Ûd_g‘
(
chunk
,

3165 
·gešd
+
Åages
-1)));

3167 ià(
cÚfig_¡©s
) {

3168 
szšd_t
 
Şdšdex
 = 
	`size2šdex
(
Şdsize
è- 
NBINS
;

3169 
szšd_t
 
šdex
 = 
	`size2šdex
(
size
è- 
NBINS
;

3171 
¬’a
->
¡©s
.
nd®loc_Ïrge
++;

3172 
¬’a
->
¡©s
.
®loÿ‹d_Ïrge
 -ğ
Şdsize
;

3173 
¬’a
->
¡©s
.
l¡©s
[
Şdšdex
].
nd®loc
++;

3174 
¬’a
->
¡©s
.
l¡©s
[
Şdšdex
].
cu¼uns
--;

3176 
¬’a
->
¡©s
.
nm®loc_Ïrge
++;

3177 
¬’a
->
¡©s
.
Äeque¡s_Ïrge
++;

3178 
¬’a
->
¡©s
.
®loÿ‹d_Ïrge
 +ğ
size
;

3179 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
nm®loc
++;

3180 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
Äeque¡s
++;

3181 
¬’a
->
¡©s
.
l¡©s
[
šdex
].
cu¼uns
++;

3183 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

3184  (
çl£
);

3186 
Ïb–_ç
:

3187 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

3188  (
Œue
);

3189 
	}
}

3191 #ifdeà
JEMALLOC_JET


3192 #undeà
¬’a_¿Îoc_junk_Ïrge


3193 
	#¬’a_¿Îoc_junk_Ïrge
 
	`JEMALLOC_N
(
n_¬’a_¿Îoc_junk_Ïrge
)

	)

3196 
	$¬’a_¿Îoc_junk_Ïrge
(*
±r
, 
size_t
 
Şd_usize
, size_ˆ
usize
)

3199 ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_ä“
)) {

3200 
	`mem£t
((*)((
ušŒ_t
)
±r
 + 
usize
), 
JEMALLOC_FREE_JUNK
,

3201 
Şd_usize
 - 
usize
);

3203 
	}
}

3204 #ifdeà
JEMALLOC_JET


3205 #undeà
¬’a_¿Îoc_junk_Ïrge


3206 
	#¬’a_¿Îoc_junk_Ïrge
 
	`JEMALLOC_N
(
¬’a_¿Îoc_junk_Ïrge
)

	)

3207 
¬’a_¿Îoc_junk_Ïrge_t
 *
	g¬’a_¿Îoc_junk_Ïrge
 =

3208 
JEMALLOC_N
(
n_¬’a_¿Îoc_junk_Ïrge
);

3215 
boŞ


3216 
	$¬’a_¿Îoc_Ïrge
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
usize_mš
,

3217 
size_t
 
usize_max
, 
boŞ
 
z”o
)

3219 
¬’a_chunk_t
 *
chunk
;

3220 
¬’a_t
 *
¬’a
;

3222 ià(
Şdsize
 =ğ
usize_max
) {

3224  (
çl£
);

3227 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

3228 
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
);

3230 ià(
Şdsize
 < 
usize_max
) {

3231 
boŞ
 
»t
 = 
	`¬’a_¿Îoc_Ïrge_grow
(
tsdn
, 
¬’a
, 
chunk
, 
±r
,

3232 
Şdsize
, 
usize_mš
, 
usize_max
, 
z”o
);

3233 ià(
cÚfig_fl
 && !
»t
 && !
z”o
) {

3234 ià(
	`uÆik–y
(
İt_junk_®loc
)) {

3235 
	`mem£t
((*)((
ušŒ_t
)
±r
 + 
Şdsize
),

3236 
JEMALLOC_ALLOC_JUNK
,

3237 
	`i§Îoc
(
tsdn
, 
±r
, 
cÚfig_´of
è- 
Şdsize
);

3238 } ià(
	`uÆik–y
(
İt_z”o
)) {

3239 
	`mem£t
((*)((
ušŒ_t
)
±r
 + 
Şdsize
), 0,

3240 
	`i§Îoc
(
tsdn
, 
±r
, 
cÚfig_´of
è- 
Şdsize
);

3243  (
»t
);

3246 
	`as£¹
(
Şdsize
 > 
usize_max
);

3248 
	`¬’a_¿Îoc_junk_Ïrge
(
±r
, 
Şdsize
, 
usize_max
);

3249 
	`¬’a_¿Îoc_Ïrge_shršk
(
tsdn
, 
¬’a
, 
chunk
, 
±r
, 
Şdsize
, 
usize_max
);

3250  (
çl£
);

3251 
	}
}

3253 
boŞ


3254 
	$¬’a_¿Îoc_no_move
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
,

3255 
size_t
 
exŒa
, 
boŞ
 
z”o
)

3257 
size_t
 
usize_mš
, 
usize_max
;

3260 
	`as£¹
(
exŒa
 =ğ0 || 
size
 +ƒxŒ¨<ğ
HUGE_MAXCLASS
);

3262 ià(
	`uÆik–y
(
size
 > 
HUGE_MAXCLASS
))

3263  (
Œue
);

3265 
usize_mš
 = 
	`s2u
(
size
);

3266 
usize_max
 = 
	`s2u
(
size
 + 
exŒa
);

3267 ià(
	`lik–y
(
Şdsize
 <ğ
Ïrge_maxşass
 && 
usize_mš
 <=†arge_maxclass)) {

3268 
¬’a_chunk_t
 *
chunk
;

3274 ià(
Şdsize
 <ğ
SMALL_MAXCLASS
) {

3275 
	`as£¹
(
¬’a_bš_šfo
[
	`size2šdex
(
Şdsize
)].
»g_size
 ==

3276 
Şdsize
);

3277 ià((
usize_max
 > 
SMALL_MAXCLASS
 ||

3278 
	`size2šdex
(
usize_max
è!ğsize2šdex(
Şdsize
)) &&

3279 (
size
 > 
Şdsize
 || 
usize_max
 < oldsize))

3280  (
Œue
);

3282 ià(
usize_max
 <ğ
SMALL_MAXCLASS
)

3283  (
Œue
);

3284 ià(
	`¬’a_¿Îoc_Ïrge
(
tsdn
, 
±r
, 
Şdsize
, 
usize_mš
,

3285 
usize_max
, 
z”o
))

3286  (
Œue
);

3289 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

3290 
	`¬’a_deÿy_tick
(
tsdn
, 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
));

3291  (
çl£
);

3293  (
	`huge_¿Îoc_no_move
(
tsdn
, 
±r
, 
Şdsize
, 
usize_mš
,

3294 
usize_max
, 
z”o
));

3296 
	}
}

3299 
	$¬’a_¿Îoc_move_h–³r
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
,

3300 
size_t
 
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
)

3303 ià(
®ignm’t
 == 0)

3304  (
	`¬’a_m®loc
(
tsdn
, 
¬’a
, 
usize
, 
	`size2šdex
(usize),

3305 
z”o
, 
tÿche
, 
Œue
));

3306 
usize
 = 
	`§2u
(usize, 
®ignm’t
);

3307 ià(
	`uÆik–y
(
usize
 =ğ0 || usiz> 
HUGE_MAXCLASS
))

3308  (
NULL
);

3309  (
	`®loù
(
tsdn
, 
usize
, 
®ignm’t
, 
z”o
, 
tÿche
, 
¬’a
));

3310 
	}
}

3313 
	$¬’a_¿Îoc
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
size
,

3314 
size_t
 
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
)

3316 *
»t
;

3317 
size_t
 
usize
;

3319 
usize
 = 
	`s2u
(
size
);

3320 ià(
	`uÆik–y
(
usize
 =ğ0 || 
size
 > 
HUGE_MAXCLASS
))

3321  (
NULL
);

3323 ià(
	`lik–y
(
usize
 <ğ
Ïrge_maxşass
)) {

3324 
size_t
 
cİysize
;

3327 ià(!
	`¬’a_¿Îoc_no_move
(
	`tsd_tsdn
(
tsd
), 
±r
, 
Şdsize
, 
usize
, 0,

3328 
z”o
))

3329  (
±r
);

3336 
»t
 = 
	`¬’a_¿Îoc_move_h–³r
(
	`tsd_tsdn
(
tsd
), 
¬’a
, 
usize
,

3337 
®ignm’t
, 
z”o
, 
tÿche
);

3338 ià(
»t
 =ğ
NULL
)

3339  (
NULL
);

3346 
cİysize
 = (
usize
 < 
Şdsize
) ? usize : oldsize;

3347 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
»t
, 
cİysize
);

3348 
	`memıy
(
»t
, 
±r
, 
cİysize
);

3349 
	`isq®loc
(
tsd
, 
±r
, 
Şdsize
, 
tÿche
, 
Œue
);

3351 
»t
 = 
	`huge_¿Îoc
(
tsd
, 
¬’a
, 
±r
, 
Şdsize
, 
usize
, 
®ignm’t
,

3352 
z”o
, 
tÿche
);

3354  (
»t
);

3355 
	}
}

3357 
dss_´ec_t


3358 
	$¬’a_dss_´ec_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

3360 
dss_´ec_t
 
»t
;

3362 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

3363 
»t
 = 
¬’a
->
dss_´ec
;

3364 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

3365  (
»t
);

3366 
	}
}

3368 
boŞ


3369 
	$¬’a_dss_´ec_£t
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
dss_´ec_t
 
dss_´ec
)

3372 ià(!
have_dss
)

3373  (
dss_´ec
 !ğ
dss_´ec_di§bËd
);

3374 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

3375 
¬’a
->
dss_´ec
 = dss_prec;

3376 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

3377  (
çl£
);

3378 
	}
}

3380 
ssize_t


3381 
	$¬’a_lg_dœty_muÉ_deçuÉ_g‘
()

3384  ((
ssize_t
)
	`©omic_»ad_z
((
size_t
 *)&
lg_dœty_muÉ_deçuÉ
));

3385 
	}
}

3387 
boŞ


3388 
	$¬’a_lg_dœty_muÉ_deçuÉ_£t
(
ssize_t
 
lg_dœty_muÉ
)

3391 ià(
İt_purge
 !ğ
purge_mode_¿tio
)

3392  (
Œue
);

3393 ià(!
	`¬’a_lg_dœty_muÉ_v®id
(
lg_dœty_muÉ
))

3394  (
Œue
);

3395 
	`©omic_wr™e_z
((
size_t
 *)&
lg_dœty_muÉ_deçuÉ
, (size_t)
lg_dœty_muÉ
);

3396  (
çl£
);

3397 
	}
}

3399 
ssize_t


3400 
	$¬’a_deÿy_time_deçuÉ_g‘
()

3403  ((
ssize_t
)
	`©omic_»ad_z
((
size_t
 *)&
deÿy_time_deçuÉ
));

3404 
	}
}

3406 
boŞ


3407 
	$¬’a_deÿy_time_deçuÉ_£t
(
ssize_t
 
deÿy_time
)

3410 ià(
İt_purge
 !ğ
purge_mode_deÿy
)

3411  (
Œue
);

3412 ià(!
	`¬’a_deÿy_time_v®id
(
deÿy_time
))

3413  (
Œue
);

3414 
	`©omic_wr™e_z
((
size_t
 *)&
deÿy_time_deçuÉ
, (size_t)
deÿy_time
);

3415  (
çl£
);

3416 
	}
}

3419 
	$¬’a_basic_¡©s_m”ge_locked
(
¬’a_t
 *
¬’a
, *
Áh»ads
,

3420 cÚ¡ **
dss
, 
ssize_t
 *
lg_dœty_muÉ
, ssize_ˆ*
deÿy_time
,

3421 
size_t
 *
Çùive
, size_ˆ*
ndœty
)

3424 *
Áh»ads
 +ğ
	`¬’a_Áh»ads_g‘
(
¬’a
, 
çl£
);

3425 *
dss
 = 
dss_´ec_Çmes
[
¬’a
->
dss_´ec
];

3426 *
lg_dœty_muÉ
 = 
¬’a
->lg_dirty_mult;

3427 *
deÿy_time
 = 
¬’a
->
deÿy
.
time
;

3428 *
Çùive
 +ğ
¬’a
->nactive;

3429 *
ndœty
 +ğ
¬’a
->ndirty;

3430 
	}
}

3433 
	$¬’a_basic_¡©s_m”ge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
Áh»ads
,

3434 cÚ¡ **
dss
, 
ssize_t
 *
lg_dœty_muÉ
, ssize_ˆ*
deÿy_time
,

3435 
size_t
 *
Çùive
, size_ˆ*
ndœty
)

3438 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

3439 
	`¬’a_basic_¡©s_m”ge_locked
(
¬’a
, 
Áh»ads
, 
dss
, 
lg_dœty_muÉ
,

3440 
deÿy_time
, 
Çùive
, 
ndœty
);

3441 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

3442 
	}
}

3445 
	$¬’a_¡©s_m”ge
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
Áh»ads
,

3446 cÚ¡ **
dss
, 
ssize_t
 *
lg_dœty_muÉ
, ssize_ˆ*
deÿy_time
,

3447 
size_t
 *
Çùive
, size_ˆ*
ndœty
, 
¬’a_¡©s_t
 *
a¡©s
,

3448 
m®loc_bš_¡©s_t
 *
b¡©s
, 
m®loc_Ïrge_¡©s_t
 *
l¡©s
,

3449 
m®loc_huge_¡©s_t
 *
h¡©s
)

3451 
i
;

3453 
	`ÿs£¹
(
cÚfig_¡©s
);

3455 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

3456 
	`¬’a_basic_¡©s_m”ge_locked
(
¬’a
, 
Áh»ads
, 
dss
, 
lg_dœty_muÉ
,

3457 
deÿy_time
, 
Çùive
, 
ndœty
);

3459 
a¡©s
->
m­³d
 +ğ
¬’a
->
¡©s
.mapped;

3460 
a¡©s
->
»šed
 +ğ
¬’a
->
¡©s
.retained;

3461 
a¡©s
->
Åurge
 +ğ
¬’a
->
¡©s
.npurge;

3462 
a¡©s
->
nmadvi£
 +ğ
¬’a
->
¡©s
.nmadvise;

3463 
a¡©s
->
purged
 +ğ
¬’a
->
¡©s
.purged;

3464 
a¡©s
->
m‘ad©a_m­³d
 +ğ
¬’a
->
¡©s
.metadata_mapped;

3465 
a¡©s
->
m‘ad©a_®loÿ‹d
 +ğ
	`¬’a_m‘ad©a_®loÿ‹d_g‘
(
¬’a
);

3466 
a¡©s
->
®loÿ‹d_Ïrge
 +ğ
¬’a
->
¡©s
.allocated_large;

3467 
a¡©s
->
nm®loc_Ïrge
 +ğ
¬’a
->
¡©s
.nmalloc_large;

3468 
a¡©s
->
nd®loc_Ïrge
 +ğ
¬’a
->
¡©s
.ndalloc_large;

3469 
a¡©s
->
Äeque¡s_Ïrge
 +ğ
¬’a
->
¡©s
.nrequests_large;

3470 
a¡©s
->
®loÿ‹d_huge
 +ğ
¬’a
->
¡©s
.allocated_huge;

3471 
a¡©s
->
nm®loc_huge
 +ğ
¬’a
->
¡©s
.nmalloc_huge;

3472 
a¡©s
->
nd®loc_huge
 +ğ
¬’a
->
¡©s
.ndalloc_huge;

3474 
i
 = 0; i < 
Æşas£s
; i++) {

3475 
l¡©s
[
i
].
nm®loc
 +ğ
¬’a
->
¡©s
.lstats[i].nmalloc;

3476 
l¡©s
[
i
].
nd®loc
 +ğ
¬’a
->
¡©s
.lstats[i].ndalloc;

3477 
l¡©s
[
i
].
Äeque¡s
 +ğ
¬’a
->
¡©s
.lstats[i].nrequests;

3478 
l¡©s
[
i
].
cu¼uns
 +ğ
¬’a
->
¡©s
.lstats[i].curruns;

3481 
i
 = 0; i < 
nhşas£s
; i++) {

3482 
h¡©s
[
i
].
nm®loc
 +ğ
¬’a
->
¡©s
.hstats[i].nmalloc;

3483 
h¡©s
[
i
].
nd®loc
 +ğ
¬’a
->
¡©s
.hstats[i].ndalloc;

3484 
h¡©s
[
i
].
curhchunks
 +ğ
¬’a
->
¡©s
.hstats[i].curhchunks;

3486 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

3488 
i
 = 0; i < 
NBINS
; i++) {

3489 
¬’a_bš_t
 *
bš
 = &
¬’a
->
bšs
[
i
];

3491 
	`m®loc_mu‹x_lock
(
tsdn
, &
bš
->
lock
);

3492 
b¡©s
[
i
].
nm®loc
 +ğ
bš
->
¡©s
.nmalloc;

3493 
b¡©s
[
i
].
nd®loc
 +ğ
bš
->
¡©s
.ndalloc;

3494 
b¡©s
[
i
].
Äeque¡s
 +ğ
bš
->
¡©s
.nrequests;

3495 
b¡©s
[
i
].
cu¼egs
 +ğ
bš
->
¡©s
.curregs;

3496 ià(
cÚfig_tÿche
) {

3497 
b¡©s
[
i
].
nfls
 +ğ
bš
->
¡©s
.nfills;

3498 
b¡©s
[
i
].
næushes
 +ğ
bš
->
¡©s
.nflushes;

3500 
b¡©s
[
i
].
Äuns
 +ğ
bš
->
¡©s
.nruns;

3501 
b¡©s
[
i
].
»runs
 +ğ
bš
->
¡©s
.reruns;

3502 
b¡©s
[
i
].
cu¼uns
 +ğ
bš
->
¡©s
.curruns;

3503 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
bš
->
lock
);

3505 
	}
}

3508 
	$¬’a_Áh»ads_g‘
(
¬’a_t
 *
¬’a
, 
boŞ
 
š‹º®
)

3511  (
	`©omic_»ad_u
(&
¬’a
->
Áh»ads
[
š‹º®
]));

3512 
	}
}

3515 
	$¬’a_Áh»ads_šc
(
¬’a_t
 *
¬’a
, 
boŞ
 
š‹º®
)

3518 
	`©omic_add_u
(&
¬’a
->
Áh»ads
[
š‹º®
], 1);

3519 
	}
}

3522 
	$¬’a_Áh»ads_dec
(
¬’a_t
 *
¬’a
, 
boŞ
 
š‹º®
)

3525 
	`©omic_sub_u
(&
¬’a
->
Áh»ads
[
š‹º®
], 1);

3526 
	}
}

3528 
size_t


3529 
	$¬’a_ex‹Á_¢_Ãxt
(
¬’a_t
 *
¬’a
)

3532  (
	`©omic_add_z
(&
¬’a
->
ex‹Á_¢_Ãxt
, 1) - 1);

3533 
	}
}

3535 
¬’a_t
 *

3536 
	$¬’a_Ãw
(
tsdn_t
 *
tsdn
, 
šd
)

3538 
¬’a_t
 *
¬’a
;

3539 
i
;

3545 ià(
cÚfig_¡©s
) {

3546 
¬’a
 = (
¬’a_t
 *)
	`ba£_®loc
(
tsdn
,

3547 
	`CACHELINE_CEILING
((
¬’a_t
)) +

3548 
	`QUANTUM_CEILING
((
Æşas£s
 * (
m®loc_Ïrge_¡©s_t
)))

3549 + (
nhşas£s
 * (
m®loc_huge_¡©s_t
)));

3551 
¬’a
 = (
¬’a_t
 *)
	`ba£_®loc
(
tsdn
, (arena_t));

3552 ià(
¬’a
 =ğ
NULL
)

3553  (
NULL
);

3555 
¬’a
->
šd
 = ind;

3556 
¬’a
->
Áh»ads
[0] =‡rena->nthreads[1] = 0;

3557 ià(
	`m®loc_mu‹x_š™
(&
¬’a
->
lock
, "¬’a", 
WITNESS_RANK_ARENA
))

3558  (
NULL
);

3560 ià(
cÚfig_¡©s
) {

3561 
	`mem£t
(&
¬’a
->
¡©s
, 0, (
¬’a_¡©s_t
));

3562 
¬’a
->
¡©s
.
l¡©s
 = (
m®loc_Ïrge_¡©s_t
 *)((
ušŒ_t
)arena

3563 + 
	`CACHELINE_CEILING
((
¬’a_t
)));

3564 
	`mem£t
(
¬’a
->
¡©s
.
l¡©s
, 0, 
Æşas£s
 *

3565 (
m®loc_Ïrge_¡©s_t
));

3566 
¬’a
->
¡©s
.
h¡©s
 = (
m®loc_huge_¡©s_t
 *)((
ušŒ_t
)arena

3567 + 
	`CACHELINE_CEILING
((
¬’a_t
)) +

3568 
	`QUANTUM_CEILING
(
Æşas£s
 * (
m®loc_Ïrge_¡©s_t
)));

3569 
	`mem£t
(
¬’a
->
¡©s
.
h¡©s
, 0, 
nhşas£s
 *

3570 (
m®loc_huge_¡©s_t
));

3571 ià(
cÚfig_tÿche
)

3572 
	`ql_Ãw
(&
¬’a
->
tÿche_ql
);

3575 ià(
cÚfig_´of
)

3576 
¬’a
->
´of_accumby‹s
 = 0;

3578 ià(
cÚfig_ÿche_oblivious
) {

3586 
¬’a
->
off£t_¡©e
 = 
cÚfig_debug
 ? 
šd
 :

3587 (
size_t
)(
ušŒ_t
)
¬’a
;

3590 
¬’a
->
dss_´ec
 = 
	`chunk_dss_´ec_g‘
();

3592 
	`ql_Ãw
(&
¬’a
->
achunks
);

3594 
¬’a
->
ex‹Á_¢_Ãxt
 = 0;

3596 
¬’a
->
¥¬e
 = 
NULL
;

3598 
¬’a
->
lg_dœty_muÉ
 = 
	`¬’a_lg_dœty_muÉ_deçuÉ_g‘
();

3599 
¬’a
->
purgšg
 = 
çl£
;

3600 
¬’a
->
Çùive
 = 0;

3601 
¬’a
->
ndœty
 = 0;

3603 
i
 = 0; i < 
NPSIZES
; i++)

3604 
	`¬’a_run_h—p_Ãw
(&
¬’a
->
runs_ava
[
i
]);

3606 
	`qr_Ãw
(&
¬’a
->
runs_dœty
, 
rd_lšk
);

3607 
	`qr_Ãw
(&
¬’a
->
chunks_ÿche
, 
cc_lšk
);

3609 ià(
İt_purge
 =ğ
purge_mode_deÿy
)

3610 
	`¬’a_deÿy_š™
(
¬’a
, 
	`¬’a_deÿy_time_deçuÉ_g‘
());

3612 
	`ql_Ãw
(&
¬’a
->
huge
);

3613 ià(
	`m®loc_mu‹x_š™
(&
¬’a
->
huge_mtx
, "arena_huge",

3614 
WITNESS_RANK_ARENA_HUGE
))

3615  (
NULL
);

3617 
	`ex‹Á_Œ“_sz¢ad_Ãw
(&
¬’a
->
chunks_sz¢ad_ÿched
);

3618 
	`ex‹Á_Œ“_ad_Ãw
(&
¬’a
->
chunks_ad_ÿched
);

3619 
	`ex‹Á_Œ“_sz¢ad_Ãw
(&
¬’a
->
chunks_sz¢ad_»šed
);

3620 
	`ex‹Á_Œ“_ad_Ãw
(&
¬’a
->
chunks_ad_»šed
);

3621 ià(
	`m®loc_mu‹x_š™
(&
¬’a
->
chunks_mtx
, "arena_chunks",

3622 
WITNESS_RANK_ARENA_CHUNKS
))

3623  (
NULL
);

3624 
	`ql_Ãw
(&
¬’a
->
node_ÿche
);

3625 ià(
	`m®loc_mu‹x_š™
(&
¬’a
->
node_ÿche_mtx
, "arena_node_cache",

3626 
WITNESS_RANK_ARENA_NODE_CACHE
))

3627  (
NULL
);

3629 
¬’a
->
chunk_hooks
 = 
chunk_hooks_deçuÉ
;

3632 
i
 = 0; i < 
NBINS
; i++) {

3633 
¬’a_bš_t
 *
bš
 = &
¬’a
->
bšs
[
i
];

3634 ià(
	`m®loc_mu‹x_š™
(&
bš
->
lock
, "arena_bin",

3635 
WITNESS_RANK_ARENA_BIN
))

3636  (
NULL
);

3637 
bš
->
runcur
 = 
NULL
;

3638 
	`¬’a_run_h—p_Ãw
(&
bš
->
runs
);

3639 ià(
cÚfig_¡©s
)

3640 
	`mem£t
(&
bš
->
¡©s
, 0, (
m®loc_bš_¡©s_t
));

3643  (
¬’a
);

3644 
	}
}

3656 
	$bš_šfo_run_size_ÿlc
(
¬’a_bš_šfo_t
 *
bš_šfo
)

3658 
size_t
 
·d_size
;

3659 
size_t
 
Œy_run_size
, 
³rãù_run_size
, 
aùu®_run_size
;

3660 
ušt32_t
 
Œy_Äegs
, 
³rãù_Äegs
, 
aùu®_Äegs
;

3669 ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_»dzÚe
)) {

3670 
size_t
 
®ign_mš
 = 
	`ZU
(1è<< (
	`ffs_zu
(
bš_šfo
->
»g_size
) - 1);

3671 ià(
®ign_mš
 <ğ
REDZONE_MINSIZE
) {

3672 
bš_šfo
->
»dzÚe_size
 = 
REDZONE_MINSIZE
;

3673 
·d_size
 = 0;

3675 
bš_šfo
->
»dzÚe_size
 = 
®ign_mš
 >> 1;

3676 
·d_size
 = 
bš_šfo
->
»dzÚe_size
;

3679 
bš_šfo
->
»dzÚe_size
 = 0;

3680 
·d_size
 = 0;

3682 
bš_šfo
->
»g_š‹rv®
 = bš_šfo->
»g_size
 +

3683 (
bš_šfo
->
»dzÚe_size
 << 1);

3689 
Œy_run_size
 = 
PAGE
;

3690 
Œy_Äegs
 = (
ušt32_t
)(
Œy_run_size
 / 
bš_šfo
->
»g_size
);

3692 
³rãù_run_size
 = 
Œy_run_size
;

3693 
³rãù_Äegs
 = 
Œy_Äegs
;

3695 
Œy_run_size
 +ğ
PAGE
;

3696 
Œy_Äegs
 = (
ušt32_t
)(
Œy_run_size
 / 
bš_šfo
->
»g_size
);

3697 } 
³rãù_run_size
 !ğ
³rãù_Äegs
 * 
bš_šfo
->
»g_size
);

3698 
	`as£¹
(
³rãù_Äegs
 <ğ
RUN_MAXREGS
);

3700 
aùu®_run_size
 = 
³rãù_run_size
;

3701 
aùu®_Äegs
 = (
ušt32_t
)((
aùu®_run_size
 - 
·d_size
) /

3702 
bš_šfo
->
»g_š‹rv®
);

3710 
aùu®_Äegs
 == 0) {

3711 
	`as£¹
(
cÚfig_fl
 && 
	`uÆik–y
(
İt_»dzÚe
));

3713 
aùu®_run_size
 +ğ
PAGE
;

3714 
aùu®_Äegs
 = (
ušt32_t
)((
aùu®_run_size
 - 
·d_size
) /

3715 
bš_šfo
->
»g_š‹rv®
);

3721 
aùu®_run_size
 > 
¬’a_maxrun
) {

3722 
aùu®_run_size
 -ğ
PAGE
;

3723 
aùu®_Äegs
 = (
ušt32_t
)((
aùu®_run_size
 - 
·d_size
) /

3724 
bš_šfo
->
»g_š‹rv®
);

3726 
	`as£¹
(
aùu®_Äegs
 > 0);

3727 
	`as£¹
(
aùu®_run_size
 =ğ
	`s2u
(actual_run_size));

3730 
bš_šfo
->
run_size
 = 
aùu®_run_size
;

3731 
bš_šfo
->
Äegs
 = 
aùu®_Äegs
;

3732 
bš_šfo
->
»g0_off£t
 = (
ušt32_t
)(
aùu®_run_size
 - (
aùu®_Äegs
 *

3733 
bš_šfo
->
»g_š‹rv®
è- 
·d_size
 + bš_šfo->
»dzÚe_size
);

3735 
	`as£¹
(
bš_šfo
->
»g0_off£t
 - bš_šfo->
»dzÚe_size
 + (bš_šfo->
Äegs


3736 * 
bš_šfo
->
»g_š‹rv®
è+ 
·d_size
 =ğbš_šfo->
run_size
);

3737 
	}
}

3740 
	$bš_šfo_š™
()

3742 
¬’a_bš_šfo_t
 *
bš_šfo
;

3744 
	#BIN_INFO_INIT_bš_yes
(
šdex
, 
size
) \

3745 
bš_šfo
 = &
¬’a_bš_šfo
[
šdex
]; \

3746 
bš_šfo
->
»g_size
 = 
size
; \

3747 
	`bš_šfo_run_size_ÿlc
(
bš_šfo
); \

3748 
	`b™m­_šfo_š™
(&
bš_šfo
->
b™m­_šfo
, bš_šfo->
Äegs
);

	)

3749 
	#BIN_INFO_INIT_bš_no
(
šdex
, 
size
)

	)

3750 
	#SC
(
šdex
, 
lg_g½
, 
lg_d–
, 
nd–
, 
psz
, 
bš
, 
lg_d–_lookup
) \

3751 
BIN_INFO_INIT_bš_
##
	`bš
(
šdex
, (
	`ZU
(1)<<
lg_g½
è+ (ZU(
nd–
)<<
lg_d–
))

	)

3752 
SIZE_CLASSES


3753 #undeà
BIN_INFO_INIT_bš_yes


3754 #undeà
BIN_INFO_INIT_bš_no


3755 #undeà
SC


3756 
	}
}

3759 
	$¬’a_boÙ
()

3761 
i
;

3763 
	`¬’a_lg_dœty_muÉ_deçuÉ_£t
(
İt_lg_dœty_muÉ
);

3764 
	`¬’a_deÿy_time_deçuÉ_£t
(
İt_deÿy_time
);

3778 
m­_bŸs
 = 0;

3779 
i
 = 0; i < 3; i++) {

3780 
size_t
 
h—d”_size
 = 
	`off£tof
(
¬’a_chunk_t
, 
m­_b™s
) +

3781 (((
¬’a_chunk_m­_b™s_t
) +

3782 (
¬’a_chunk_m­_misc_t
)è* (
chunk_Åages
-
m­_bŸs
));

3783 
m­_bŸs
 = (
h—d”_size
 + 
PAGE_MASK
è>> 
LG_PAGE
;

3785 
	`as£¹
(
m­_bŸs
 > 0);

3787 
m­_misc_off£t
 = 
	`off£tof
(
¬’a_chunk_t
, 
m­_b™s
) +

3788 (
¬’a_chunk_m­_b™s_t
è* (
chunk_Åages
-
m­_bŸs
);

3790 
¬’a_maxrun
 = 
chunksize
 - (
m­_bŸs
 << 
LG_PAGE
);

3791 
	`as£¹
(
¬’a_maxrun
 > 0);

3792 
Ïrge_maxşass
 = 
	`šdex2size
(
	`size2šdex
(
chunksize
)-1);

3793 ià(
Ïrge_maxşass
 > 
¬’a_maxrun
) {

3799 
Ïrge_maxşass
 = 
¬’a_maxrun
;

3801 
	`as£¹
(
Ïrge_maxşass
 > 0);

3802 
Æşas£s
 = 
	`size2šdex
(
Ïrge_maxşass
è- size2šdex(
SMALL_MAXCLASS
);

3803 
nhşas£s
 = 
NSIZES
 - 
Æşas£s
 - 
NBINS
;

3805 
	`bš_šfo_š™
();

3806 
	}
}

3809 
	$¬’a_´efÜk0
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

3812 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
¬’a
->
lock
);

3813 
	}
}

3816 
	$¬’a_´efÜk1
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

3819 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
¬’a
->
chunks_mtx
);

3820 
	}
}

3823 
	$¬’a_´efÜk2
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

3826 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
¬’a
->
node_ÿche_mtx
);

3827 
	}
}

3830 
	$¬’a_´efÜk3
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

3832 
i
;

3834 
i
 = 0; i < 
NBINS
; i++)

3835 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
¬’a
->
bšs
[
i
].
lock
);

3836 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
¬’a
->
huge_mtx
);

3837 
	}
}

3840 
	$¬’a_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

3842 
i
;

3844 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
¬’a
->
huge_mtx
);

3845 
i
 = 0; i < 
NBINS
; i++)

3846 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
¬’a
->
bšs
[
i
].
lock
);

3847 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
¬’a
->
node_ÿche_mtx
);

3848 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
¬’a
->
chunks_mtx
);

3849 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
¬’a
->
lock
);

3850 
	}
}

3853 
	$¬’a_po¡fÜk_chd
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

3855 
i
;

3857 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
¬’a
->
huge_mtx
);

3858 
i
 = 0; i < 
NBINS
; i++)

3859 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
¬’a
->
bšs
[
i
].
lock
);

3860 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
¬’a
->
node_ÿche_mtx
);

3861 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
¬’a
->
chunks_mtx
);

3862 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
¬’a
->
lock
);

3863 
	}
}

	@deps/jemalloc/src/atomic.c

1 
	#JEMALLOC_ATOMIC_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

	@deps/jemalloc/src/base.c

1 
	#JEMALLOC_BASE_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

7 
m®loc_mu‹x_t
 
	gba£_mtx
;

8 
size_t
 
	gba£_ex‹Á_¢_Ãxt
;

9 
ex‹Á_Œ“_t
 
	gba£_ava_sz¢ad
;

10 
ex‹Á_node_t
 *
	gba£_nodes
;

11 
size_t
 
	gba£_®loÿ‹d
;

12 
size_t
 
	gba£_»sid’t
;

13 
size_t
 
	gba£_m­³d
;

17 
ex‹Á_node_t
 *

18 
	$ba£_node_Œy_®loc
(
tsdn_t
 *
tsdn
)

20 
ex‹Á_node_t
 *
node
;

22 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, &
ba£_mtx
);

24 ià(
ba£_nodes
 =ğ
NULL
)

25  (
NULL
);

26 
node
 = 
ba£_nodes
;

27 
ba£_nodes
 = *(
ex‹Á_node_t
 **)
node
;

28 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
node
, (
ex‹Á_node_t
));

29  (
node
);

30 
	}
}

33 
	$ba£_node_d®loc
(
tsdn_t
 *
tsdn
, 
ex‹Á_node_t
 *
node
)

36 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, &
ba£_mtx
);

38 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
node
, (
ex‹Á_node_t
));

39 *(
ex‹Á_node_t
 **)
node
 = 
ba£_nodes
;

40 
ba£_nodes
 = 
node
;

41 
	}
}

44 
	$ba£_ex‹Á_node_š™
(
ex‹Á_node_t
 *
node
, *
addr
, 
size_t
 
size
)

46 
size_t
 
¢
 = 
	`©omic_add_z
(&
ba£_ex‹Á_¢_Ãxt
, 1) - 1;

48 
	`ex‹Á_node_š™
(
node
, 
NULL
, 
addr
, 
size
, 
¢
, 
Œue
,rue);

49 
	}
}

51 
ex‹Á_node_t
 *

52 
	$ba£_chunk_®loc
(
tsdn_t
 *
tsdn
, 
size_t
 
mšsize
)

54 
ex‹Á_node_t
 *
node
;

55 
size_t
 
csize
, 
nsize
;

56 *
addr
;

58 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, &
ba£_mtx
);

59 
	`as£¹
(
mšsize
 != 0);

60 
node
 = 
	`ba£_node_Œy_®loc
(
tsdn
);

62 
nsize
 = (
node
 =ğ
NULL
è? 
	`CACHELINE_CEILING
((
ex‹Á_node_t
)) : 0;

63 
csize
 = 
	`CHUNK_CEILING
(
mšsize
 + 
nsize
);

64 
addr
 = 
	`chunk_®loc_ba£
(
csize
);

65 ià(
addr
 =ğ
NULL
) {

66 ià(
node
 !ğ
NULL
)

67 
	`ba£_node_d®loc
(
tsdn
, 
node
);

68  (
NULL
);

70 
ba£_m­³d
 +ğ
csize
;

71 ià(
node
 =ğ
NULL
) {

72 
node
 = (
ex‹Á_node_t
 *)
addr
;

73 
addr
 = (*)((
ušŒ_t
ïdd¸+ 
nsize
);

74 
csize
 -ğ
nsize
;

75 ià(
cÚfig_¡©s
) {

76 
ba£_®loÿ‹d
 +ğ
nsize
;

77 
ba£_»sid’t
 +ğ
	`PAGE_CEILING
(
nsize
);

80 
	`ba£_ex‹Á_node_š™
(
node
, 
addr
, 
csize
);

81  (
node
);

82 
	}
}

90 
	$ba£_®loc
(
tsdn_t
 *
tsdn
, 
size_t
 
size
)

92 *
»t
;

93 
size_t
 
csize
, 
usize
;

94 
ex‹Á_node_t
 *
node
;

95 
ex‹Á_node_t
 
key
;

101 
csize
 = 
	`CACHELINE_CEILING
(
size
);

103 
usize
 = 
	`s2u
(
csize
);

104 
	`ex‹Á_node_š™
(&
key
, 
NULL
, NULL, 
usize
, 0, 
çl£
, false);

105 
	`m®loc_mu‹x_lock
(
tsdn
, &
ba£_mtx
);

106 
node
 = 
	`ex‹Á_Œ“_sz¢ad_n£¬ch
(&
ba£_ava_sz¢ad
, &
key
);

107 ià(
node
 !ğ
NULL
) {

109 
	`ex‹Á_Œ“_sz¢ad_»move
(&
ba£_ava_sz¢ad
, 
node
);

112 
node
 = 
	`ba£_chunk_®loc
(
tsdn
, 
csize
);

114 ià(
node
 =ğ
NULL
) {

115 
»t
 = 
NULL
;

116 
Ïb–_»tuº
;

119 
»t
 = 
	`ex‹Á_node_addr_g‘
(
node
);

120 ià(
	`ex‹Á_node_size_g‘
(
node
è> 
csize
) {

121 
	`ex‹Á_node_addr_£t
(
node
, (*)((
ušŒ_t
)
»t
 + 
csize
));

122 
	`ex‹Á_node_size_£t
(
node
, 
	`ex‹Á_node_size_g‘
Òodeè- 
csize
);

123 
	`ex‹Á_Œ“_sz¢ad_š£¹
(&
ba£_ava_sz¢ad
, 
node
);

125 
	`ba£_node_d®loc
(
tsdn
, 
node
);

126 ià(
cÚfig_¡©s
) {

127 
ba£_®loÿ‹d
 +ğ
csize
;

132 
ba£_»sid’t
 +ğ
	`PAGE_CEILING
((
ušŒ_t
)
»t
 + 
csize
) -

133 
	`PAGE_CEILING
((
ušŒ_t
)
»t
);

135 
	`JEMALLOC_VALGRIND_MAKE_MEM_DEFINED
(
»t
, 
csize
);

136 
Ïb–_»tuº
:

137 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
ba£_mtx
);

138  (
»t
);

139 
	}
}

142 
	$ba£_¡©s_g‘
(
tsdn_t
 *
tsdn
, 
size_t
 *
®loÿ‹d
, size_ˆ*
»sid’t
,

143 
size_t
 *
m­³d
)

146 
	`m®loc_mu‹x_lock
(
tsdn
, &
ba£_mtx
);

147 
	`as£¹
(
ba£_®loÿ‹d
 <ğ
ba£_»sid’t
);

148 
	`as£¹
(
ba£_»sid’t
 <ğ
ba£_m­³d
);

149 *
®loÿ‹d
 = 
ba£_®loÿ‹d
;

150 *
»sid’t
 = 
ba£_»sid’t
;

151 *
m­³d
 = 
ba£_m­³d
;

152 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
ba£_mtx
);

153 
	}
}

155 
boŞ


156 
	$ba£_boÙ
()

159 ià(
	`m®loc_mu‹x_š™
(&
ba£_mtx
, "ba£", 
WITNESS_RANK_BASE
))

160  (
Œue
);

161 
ba£_ex‹Á_¢_Ãxt
 = 0;

162 
	`ex‹Á_Œ“_sz¢ad_Ãw
(&
ba£_ava_sz¢ad
);

163 
ba£_nodes
 = 
NULL
;

165  (
çl£
);

166 
	}
}

169 
	$ba£_´efÜk
(
tsdn_t
 *
tsdn
)

172 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
ba£_mtx
);

173 
	}
}

176 
	$ba£_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
)

179 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
ba£_mtx
);

180 
	}
}

183 
	$ba£_po¡fÜk_chd
(
tsdn_t
 *
tsdn
)

186 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
ba£_mtx
);

187 
	}
}

	@deps/jemalloc/src/bitmap.c

1 
	#JEMALLOC_BITMAP_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

6 #ifdeà
USE_TREE


9 
	$b™m­_šfo_š™
(
b™m­_šfo_t
 *
bšfo
, 
size_t
 
nb™s
)

11 
i
;

12 
size_t
 
group_couÁ
;

14 
	`as£¹
(
nb™s
 > 0);

15 
	`as£¹
(
nb™s
 <ğ(
	`ZU
(1è<< 
LG_BITMAP_MAXBITS
));

22 
bšfo
->
Ëv–s
[0].
group_off£t
 = 0;

23 
group_couÁ
 = 
	`BITMAP_BITS2GROUPS
(
nb™s
);

24 
i
 = 1; 
group_couÁ
 > 1; i++) {

25 
	`as£¹
(
i
 < 
BITMAP_MAX_LEVELS
);

26 
bšfo
->
Ëv–s
[
i
].
group_off£t
 = binfo->levels[i-1].group_offset

27 + 
group_couÁ
;

28 
group_couÁ
 = 
	`BITMAP_BITS2GROUPS
(group_count);

30 
bšfo
->
Ëv–s
[
i
].
group_off£t
 = binfo->levels[i-1].group_offset

31 + 
group_couÁ
;

32 
	`as£¹
(
bšfo
->
Ëv–s
[
i
].
group_off£t
 <ğ
BITMAP_GROUPS_MAX
);

33 
bšfo
->
Æev–s
 = 
i
;

34 
bšfo
->
nb™s
 =‚bits;

35 
	}
}

37 
size_t


38 
	$b™m­_šfo_ngroups
(cÚ¡ 
b™m­_šfo_t
 *
bšfo
)

41  (
bšfo
->
Ëv–s
[bšfo->
Æev–s
].
group_off£t
);

42 
	}
}

45 
	$b™m­_š™
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
)

47 
size_t
 
exŒa
;

48 
i
;

57 
	`mem£t
(
b™m­
, 0xffU, 
	`b™m­_size
(
bšfo
));

58 
exŒa
 = (
BITMAP_GROUP_NBITS
 - (
bšfo
->
nb™s
 & 
BITMAP_GROUP_NBITS_MASK
))

59 & 
BITMAP_GROUP_NBITS_MASK
;

60 ià(
exŒa
 != 0)

61 
b™m­
[
bšfo
->
Ëv–s
[1].
group_off£t
 - 1] >>ğ
exŒa
;

62 
i
 = 1; i < 
bšfo
->
Æev–s
; i++) {

63 
size_t
 
group_couÁ
 = 
bšfo
->
Ëv–s
[
i
].
group_off£t
 -

64 
bšfo
->
Ëv–s
[
i
-1].
group_off£t
;

65 
exŒa
 = (
BITMAP_GROUP_NBITS
 - (
group_couÁ
 &

66 
BITMAP_GROUP_NBITS_MASK
)) & BITMAP_GROUP_NBITS_MASK;

67 ià(
exŒa
 != 0)

68 
b™m­
[
bšfo
->
Ëv–s
[
i
+1].
group_off£t
 - 1] >>ğ
exŒa
;

70 
	}
}

75 
	$b™m­_šfo_š™
(
b™m­_šfo_t
 *
bšfo
, 
size_t
 
nb™s
)

78 
	`as£¹
(
nb™s
 > 0);

79 
	`as£¹
(
nb™s
 <ğ(
	`ZU
(1è<< 
LG_BITMAP_MAXBITS
));

81 
bšfo
->
ngroups
 = 
	`BITMAP_BITS2GROUPS
(
nb™s
);

82 
bšfo
->
nb™s
 =‚bits;

83 
	}
}

85 
size_t


86 
	$b™m­_šfo_ngroups
(cÚ¡ 
b™m­_šfo_t
 *
bšfo
)

89  (
bšfo
->
ngroups
);

90 
	}
}

93 
	$b™m­_š™
(
b™m­_t
 *
b™m­
, cÚ¡ 
b™m­_šfo_t
 *
bšfo
)

95 
size_t
 
exŒa
;

97 
	`mem£t
(
b™m­
, 0xffU, 
	`b™m­_size
(
bšfo
));

98 
exŒa
 = (
BITMAP_GROUP_NBITS
 - (
bšfo
->
nb™s
 & 
BITMAP_GROUP_NBITS_MASK
))

99 & 
BITMAP_GROUP_NBITS_MASK
;

100 ià(
exŒa
 != 0)

101 
b™m­
[
bšfo
->
ngroups
 - 1] >>ğ
exŒa
;

102 
	}
}

106 
size_t


107 
	$b™m­_size
(cÚ¡ 
b™m­_šfo_t
 *
bšfo
)

110  (
	`b™m­_šfo_ngroups
(
bšfo
è<< 
LG_SIZEOF_BITMAP
);

111 
	}
}

	@deps/jemalloc/src/chunk.c

1 
	#JEMALLOC_CHUNK_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

7 cÚ¡ *
	gİt_dss
 = 
DSS_DEFAULT
;

8 
size_t
 
	gİt_lg_chunk
 = 0;

11 
size_t
 
	gcurchunks
;

12 
size_t
 
	ghighchunks
;

14 
¹»e_t
 
	gchunks_¹»e
;

17 
size_t
 
	gchunksize
;

18 
size_t
 
	gchunksize_mask
;

19 
size_t
 
	gchunk_Åages
;

21 *
chunk_®loc_deçuÉ
(*
Ãw_addr
, 
size_t
 
size
,

22 
size_t
 
®ignm’t
, 
boŞ
 *
z”o
, boŞ *
comm™
, 
¬’a_šd
);

23 
boŞ
 
chunk_d®loc_deçuÉ
(*
chunk
, 
size_t
 
size
, boŞ 
comm™‹d
,

24 
¬’a_šd
);

25 
boŞ
 
chunk_comm™_deçuÉ
(*
chunk
, 
size_t
 
size
, size_ˆ
off£t
,

26 
size_t
 
Ëngth
, 
¬’a_šd
);

27 
boŞ
 
chunk_decomm™_deçuÉ
(*
chunk
, 
size_t
 
size
, size_ˆ
off£t
,

28 
size_t
 
Ëngth
, 
¬’a_šd
);

29 
boŞ
 
chunk_purge_deçuÉ
(*
chunk
, 
size_t
 
size
, size_ˆ
off£t
,

30 
size_t
 
Ëngth
, 
¬’a_šd
);

31 
boŞ
 
chunk_¥l™_deçuÉ
(*
chunk
, 
size_t
 
size
, size_ˆ
size_a
,

32 
size_t
 
size_b
, 
boŞ
 
comm™‹d
, 
¬’a_šd
);

33 
boŞ
 
chunk_m”ge_deçuÉ
(*
chunk_a
, 
size_t
 
size_a
, *
chunk_b
,

34 
size_t
 
size_b
, 
boŞ
 
comm™‹d
, 
¬’a_šd
);

36 cÚ¡ 
chunk_hooks_t
 
	gchunk_hooks_deçuÉ
 = {

37 
chunk_®loc_deçuÉ
,

38 
chunk_d®loc_deçuÉ
,

39 
chunk_comm™_deçuÉ
,

40 
chunk_decomm™_deçuÉ
,

41 
chunk_purge_deçuÉ
,

42 
chunk_¥l™_deçuÉ
,

43 
chunk_m”ge_deçuÉ


52 
chunk_»cÜd
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

53 
chunk_hooks_t
 *
chunk_hooks
, 
ex‹Á_Œ“_t
 *
chunks_sz¢ad
,

54 
ex‹Á_Œ“_t
 *
chunks_ad
, 
boŞ
 
ÿche
, *
chunk
, 
size_t
 
size
, size_ˆ
¢
,

55 
boŞ
 
z”Ûd
, boŞ 
comm™‹d
);

59 
chunk_hooks_t


60 
	$chunk_hooks_g‘_locked
(
¬’a_t
 *
¬’a
)

63  (
¬’a
->
chunk_hooks
);

64 
	}
}

66 
chunk_hooks_t


67 
	$chunk_hooks_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

69 
chunk_hooks_t
 
chunk_hooks
;

71 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
chunks_mtx
);

72 
chunk_hooks
 = 
	`chunk_hooks_g‘_locked
(
¬’a
);

73 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
chunks_mtx
);

75  (
chunk_hooks
);

76 
	}
}

78 
chunk_hooks_t


79 
	$chunk_hooks_£t
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, cÚ¡ 
chunk_hooks_t
 *
chunk_hooks
)

81 
chunk_hooks_t
 
Şd_chunk_hooks
;

83 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
chunks_mtx
);

84 
Şd_chunk_hooks
 = 
¬’a
->
chunk_hooks
;

92 
	#ATOMIC_COPY_HOOK
(
n
) do { \

94 
chunk_
##
n
##
_t
 **n; \

95 **
v
; \

96 } 
u
; \

97 
u
.
n
 = &
¬’a
->
chunk_hooks
.n; \

98 
	`©omic_wr™e_p
(
u
.
v
, 
chunk_hooks
->
n
); \

99 } 0)

	)

100 
	`ATOMIC_COPY_HOOK
(
®loc
);

101 
	`ATOMIC_COPY_HOOK
(
d®loc
);

102 
	`ATOMIC_COPY_HOOK
(
comm™
);

103 
	`ATOMIC_COPY_HOOK
(
decomm™
);

104 
	`ATOMIC_COPY_HOOK
(
purge
);

105 
	`ATOMIC_COPY_HOOK
(
¥l™
);

106 
	`ATOMIC_COPY_HOOK
(
m”ge
);

107 #undeà
ATOMIC_COPY_HOOK


108 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
chunks_mtx
);

110  (
Şd_chunk_hooks
);

111 
	}
}

114 
	$chunk_hooks_assu»_š™Ÿlized_im¶
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

115 
chunk_hooks_t
 *
chunk_hooks
, 
boŞ
 
locked
)

117 cÚ¡ 
chunk_hooks_t
 
unš™Ÿlized_hooks
 =

118 
CHUNK_HOOKS_INITIALIZER
;

120 ià(
	`memcmp
(
chunk_hooks
, &
unš™Ÿlized_hooks
, (
chunk_hooks_t
)) ==

122 *
chunk_hooks
 = 
locked
 ? 
	`chunk_hooks_g‘_locked
(
¬’a
) :

123 
	`chunk_hooks_g‘
(
tsdn
, 
¬’a
);

125 
	}
}

128 
	$chunk_hooks_assu»_š™Ÿlized_locked
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

129 
chunk_hooks_t
 *
chunk_hooks
)

132 
	`chunk_hooks_assu»_š™Ÿlized_im¶
(
tsdn
, 
¬’a
, 
chunk_hooks
, 
Œue
);

133 
	}
}

136 
	$chunk_hooks_assu»_š™Ÿlized
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
,

137 
chunk_hooks_t
 *
chunk_hooks
)

140 
	`chunk_hooks_assu»_š™Ÿlized_im¶
(
tsdn
, 
¬’a
, 
chunk_hooks
, 
çl£
);

141 
	}
}

143 
boŞ


144 
	$chunk_»gi¡”
(
tsdn_t
 *
tsdn
, cÚ¡ *
chunk
, cÚ¡ 
ex‹Á_node_t
 *
node
)

147 
	`as£¹
(
	`ex‹Á_node_addr_g‘
(
node
è=ğ
chunk
);

149 ià(
	`¹»e_£t
(&
chunks_¹»e
, (
ušŒ_t
)
chunk
, 
node
))

150  (
Œue
);

151 ià(
cÚfig_´of
 && 
İt_´of
) {

152 
size_t
 
size
 = 
	`ex‹Á_node_size_g‘
(
node
);

153 
size_t
 
Çdd
 = (
size
 =ğ0è? 1 : siz/ 
chunksize
;

154 
size_t
 
cur
 = 
	`©omic_add_z
(&
curchunks
, 
Çdd
);

155 
size_t
 
high
 = 
	`©omic_»ad_z
(&
highchunks
);

156 
cur
 > 
high
 && 
	`©omic_ÿs_z
(&
highchunks
, high, cur)) {

161 
high
 = 
	`©omic_»ad_z
(&
highchunks
);

163 ià(
cur
 > 
high
 && 
	`´of_gdump_g‘_uÆocked
())

164 
	`´of_gdump
(
tsdn
);

167  (
çl£
);

168 
	}
}

171 
	$chunk_d”egi¡”
(cÚ¡ *
chunk
, cÚ¡ 
ex‹Á_node_t
 *
node
)

173 
boŞ
 
”r
;

175 
”r
 = 
	`¹»e_£t
(&
chunks_¹»e
, (
ušŒ_t
)
chunk
, 
NULL
);

176 
	`as£¹
(!
”r
);

177 ià(
cÚfig_´of
 && 
İt_´of
) {

178 
size_t
 
size
 = 
	`ex‹Á_node_size_g‘
(
node
);

179 
size_t
 
nsub
 = (
size
 =ğ0è? 1 : siz/ 
chunksize
;

180 
	`as£¹
(
	`©omic_»ad_z
(&
curchunks
è>ğ
nsub
);

181 
	`©omic_sub_z
(&
curchunks
, 
nsub
);

183 
	}
}

189 
ex‹Á_node_t
 *

190 
	$chunk_fœ¡_be¡_f™
(
¬’a_t
 *
¬’a
, 
ex‹Á_Œ“_t
 *
chunks_sz¢ad
, 
size_t
 
size
)

192 
ex‹Á_node_t
 
key
;

194 
	`as£¹
(
size
 =ğ
	`CHUNK_CEILING
(size));

196 
	`ex‹Á_node_š™
(&
key
, 
¬’a
, 
NULL
, 
size
, 0, 
çl£
, false);

197  (
	`ex‹Á_Œ“_sz¢ad_n£¬ch
(
chunks_sz¢ad
, &
key
));

198 
	}
}

201 
	$chunk_»cyşe
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

202 
ex‹Á_Œ“_t
 *
chunks_sz¢ad
,ƒx‹Á_Œ“_ˆ*
chunks_ad
, 
boŞ
 
ÿche
,

203 *
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
, size_ˆ*
¢
, 
boŞ
 *
z”o
,

204 
boŞ
 *
comm™
, boŞ 
d®loc_node
)

206 *
»t
;

207 
ex‹Á_node_t
 *
node
;

208 
size_t
 
®loc_size
, 
Ëadsize
, 
Œasize
;

209 
boŞ
 
z”Ûd
, 
comm™‹d
;

211 
	`as£¹
(
	`CHUNK_CEILING
(
size
) == size);

212 
	`as£¹
(
®ignm’t
 > 0);

213 
	`as£¹
(
Ãw_addr
 =ğ
NULL
 || 
®ignm’t
 =ğ
chunksize
);

214 
	`as£¹
(
	`CHUNK_ADDR2BASE
(
Ãw_addr
) ==‚ew_addr);

220 
	`as£¹
(
d®loc_node
 || 
Ãw_addr
 !ğ
NULL
);

222 
®loc_size
 = 
size
 + 
	`CHUNK_CEILING
(
®ignm’t
è- 
chunksize
;

224 ià(
®loc_size
 < 
size
)

225  (
NULL
);

226 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
chunks_mtx
);

227 
	`chunk_hooks_assu»_š™Ÿlized_locked
(
tsdn
, 
¬’a
, 
chunk_hooks
);

228 ià(
Ãw_addr
 !ğ
NULL
) {

229 
ex‹Á_node_t
 
key
;

230 
	`ex‹Á_node_š™
(&
key
, 
¬’a
, 
Ãw_addr
, 
®loc_size
, 0, 
çl£
,

231 
çl£
);

232 
node
 = 
	`ex‹Á_Œ“_ad_£¬ch
(
chunks_ad
, &
key
);

234 
node
 = 
	`chunk_fœ¡_be¡_f™
(
¬’a
, 
chunks_sz¢ad
, 
®loc_size
);

236 ià(
node
 =ğ
NULL
 || (
Ãw_addr
 !ğNULL && 
	`ex‹Á_node_size_g‘
(node) <

237 
size
)) {

238 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
chunks_mtx
);

239  (
NULL
);

241 
Ëadsize
 = 
	`ALIGNMENT_CEILING
((
ušŒ_t
)
	`ex‹Á_node_addr_g‘
(
node
),

242 
®ignm’t
è- (
ušŒ_t
)
	`ex‹Á_node_addr_g‘
(
node
);

243 
	`as£¹
(
Ãw_addr
 =ğ
NULL
 || 
Ëadsize
 == 0);

244 
	`as£¹
(
	`ex‹Á_node_size_g‘
(
node
è>ğ
Ëadsize
 + 
size
);

245 
Œasize
 = 
	`ex‹Á_node_size_g‘
(
node
è- 
Ëadsize
 - 
size
;

246 
»t
 = (*)((
ušŒ_t
)
	`ex‹Á_node_addr_g‘
(
node
è+ 
Ëadsize
);

247 *
¢
 = 
	`ex‹Á_node_¢_g‘
(
node
);

248 
z”Ûd
 = 
	`ex‹Á_node_z”Ûd_g‘
(
node
);

249 ià(
z”Ûd
)

250 *
z”o
 = 
Œue
;

251 
comm™‹d
 = 
	`ex‹Á_node_comm™‹d_g‘
(
node
);

252 ià(
comm™‹d
)

253 *
comm™
 = 
Œue
;

255 ià(
Ëadsize
 != 0 &&

256 
chunk_hooks
->
	`¥l™
(
	`ex‹Á_node_addr_g‘
(
node
),

257 
	`ex‹Á_node_size_g‘
(
node
), 
Ëadsize
, 
size
, 
çl£
, 
¬’a
->
šd
)) {

258 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
chunks_mtx
);

259  (
NULL
);

262 
	`ex‹Á_Œ“_sz¢ad_»move
(
chunks_sz¢ad
, 
node
);

263 
	`ex‹Á_Œ“_ad_»move
(
chunks_ad
, 
node
);

264 
	`¬’a_chunk_ÿche_maybe_»move
(
¬’a
, 
node
, 
ÿche
);

265 ià(
Ëadsize
 != 0) {

267 
	`ex‹Á_node_size_£t
(
node
, 
Ëadsize
);

268 
	`ex‹Á_Œ“_sz¢ad_š£¹
(
chunks_sz¢ad
, 
node
);

269 
	`ex‹Á_Œ“_ad_š£¹
(
chunks_ad
, 
node
);

270 
	`¬’a_chunk_ÿche_maybe_š£¹
(
¬’a
, 
node
, 
ÿche
);

271 
node
 = 
NULL
;

273 ià(
Œasize
 != 0) {

275 ià(
chunk_hooks
->
	`¥l™
(
»t
, 
size
 + 
Œasize
, size,

276 
Œasize
, 
çl£
, 
¬’a
->
šd
)) {

277 ià(
d®loc_node
 && 
node
 !ğ
NULL
)

278 
	`¬’a_node_d®loc
(
tsdn
, 
¬’a
, 
node
);

279 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
chunks_mtx
);

280 
	`chunk_»cÜd
(
tsdn
, 
¬’a
, 
chunk_hooks
, 
chunks_sz¢ad
,

281 
chunks_ad
, 
ÿche
, 
»t
, 
size
 + 
Œasize
, *
¢
,

282 
z”Ûd
, 
comm™‹d
);

283  (
NULL
);

286 ià(
node
 =ğ
NULL
) {

287 
node
 = 
	`¬’a_node_®loc
(
tsdn
, 
¬’a
);

288 ià(
node
 =ğ
NULL
) {

289 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
chunks_mtx
);

290 
	`chunk_»cÜd
(
tsdn
, 
¬’a
, 
chunk_hooks
,

291 
chunks_sz¢ad
, 
chunks_ad
, 
ÿche
, 
»t
, 
size


292 + 
Œasize
, *
¢
, 
z”Ûd
, 
comm™‹d
);

293  (
NULL
);

296 
	`ex‹Á_node_š™
(
node
, 
¬’a
, (*)((
ušŒ_t
)(
»t
è+ 
size
),

297 
Œasize
, *
¢
, 
z”Ûd
, 
comm™‹d
);

298 
	`ex‹Á_Œ“_sz¢ad_š£¹
(
chunks_sz¢ad
, 
node
);

299 
	`ex‹Á_Œ“_ad_š£¹
(
chunks_ad
, 
node
);

300 
	`¬’a_chunk_ÿche_maybe_š£¹
(
¬’a
, 
node
, 
ÿche
);

301 
node
 = 
NULL
;

303 ià(!
comm™‹d
 && 
chunk_hooks
->
	`comm™
(
»t
, 
size
, 0, size, 
¬’a
->
šd
)) {

304 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
chunks_mtx
);

305 
	`chunk_»cÜd
(
tsdn
, 
¬’a
, 
chunk_hooks
, 
chunks_sz¢ad
, 
chunks_ad
,

306 
ÿche
, 
»t
, 
size
, *
¢
, 
z”Ûd
, 
comm™‹d
);

307  (
NULL
);

309 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
chunks_mtx
);

311 
	`as£¹
(
d®loc_node
 || 
node
 !ğ
NULL
);

312 ià(
d®loc_node
 && 
node
 !ğ
NULL
)

313 
	`¬’a_node_d®loc
(
tsdn
, 
¬’a
, 
node
);

314 ià(*
z”o
) {

315 ià(!
z”Ûd
)

316 
	`mem£t
(
»t
, 0, 
size
);

317 ià(
cÚfig_debug
) {

318 
size_t
 
i
;

319 
size_t
 *
p
 = (size_ˆ*)(
ušŒ_t
)
»t
;

321 
i
 = 0; i < 
size
 / (
size_t
); i++)

322 
	`as£¹
(
p
[
i
] == 0);

324 ià(
cÚfig_v®gršd
)

325 
	`JEMALLOC_VALGRIND_MAKE_MEM_DEFINED
(
»t
, 
size
);

327  (
»t
);

328 
	}
}

337 
	$chunk_®loc_cÜe
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
Ãw_addr
, 
size_t
 
size
,

338 
size_t
 
®ignm’t
, 
boŞ
 *
z”o
, boŞ *
comm™
, 
dss_´ec_t
 
dss_´ec
)

340 *
»t
;

342 
	`as£¹
(
size
 != 0);

343 
	`as£¹
((
size
 & 
chunksize_mask
) == 0);

344 
	`as£¹
(
®ignm’t
 != 0);

345 
	`as£¹
((
®ignm’t
 & 
chunksize_mask
) == 0);

348 ià(
have_dss
 && 
dss_´ec
 =ğ
dss_´ec_´im¬y
 && (
»t
 =

349 
	`chunk_®loc_dss
(
tsdn
, 
¬’a
, 
Ãw_addr
, 
size
, 
®ignm’t
, 
z”o
,

350 
comm™
)è!ğ
NULL
)

351  (
»t
);

353 ià((
»t
 = 
	`chunk_®loc_mm­
(
Ãw_addr
, 
size
, 
®ignm’t
, 
z”o
, 
comm™
)) !=

354 
NULL
)

355  (
»t
);

357 ià(
have_dss
 && 
dss_´ec
 =ğ
dss_´ec_£cÚd¬y
 && (
»t
 =

358 
	`chunk_®loc_dss
(
tsdn
, 
¬’a
, 
Ãw_addr
, 
size
, 
®ignm’t
, 
z”o
,

359 
comm™
)è!ğ
NULL
)

360  (
»t
);

363  (
NULL
);

364 
	}
}

367 
	$chunk_®loc_ba£
(
size_t
 
size
)

369 *
»t
;

370 
boŞ
 
z”o
, 
comm™
;

377 
z”o
 = 
Œue
;

378 
comm™
 = 
Œue
;

379 
»t
 = 
	`chunk_®loc_mm­
(
NULL
, 
size
, 
chunksize
, &
z”o
, &
comm™
);

380 ià(
»t
 =ğ
NULL
)

381  (
NULL
);

382 ià(
cÚfig_v®gršd
)

383 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
»t
, 
size
);

385  (
»t
);

386 
	}
}

389 
	$chunk_®loc_ÿche
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

390 *
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
, size_ˆ*
¢
, 
boŞ
 *
z”o
,

391 
boŞ
 *
comm™
, boŞ 
d®loc_node
)

393 *
»t
;

395 
	`as£¹
(
size
 != 0);

396 
	`as£¹
((
size
 & 
chunksize_mask
) == 0);

397 
	`as£¹
(
®ignm’t
 != 0);

398 
	`as£¹
((
®ignm’t
 & 
chunksize_mask
) == 0);

400 
»t
 = 
	`chunk_»cyşe
(
tsdn
, 
¬’a
, 
chunk_hooks
,

401 &
¬’a
->
chunks_sz¢ad_ÿched
, &¬’a->
chunks_ad_ÿched
, 
Œue
,

402 
Ãw_addr
, 
size
, 
®ignm’t
, 
¢
, 
z”o
, 
comm™
, 
d®loc_node
);

403 ià(
»t
 =ğ
NULL
)

404  (
NULL
);

405 ià(
cÚfig_v®gršd
)

406 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
»t
, 
size
);

407  (
»t
);

408 
	}
}

410 
¬’a_t
 *

411 
	$chunk_¬’a_g‘
(
tsdn_t
 *
tsdn
, 
¬’a_šd
)

413 
¬’a_t
 *
¬’a
;

415 
¬’a
 = 
	`¬’a_g‘
(
tsdn
, 
¬’a_šd
, 
çl£
);

420 
	`as£¹
(
¬’a
 !ğ
NULL
);

421  (
¬’a
);

422 
	}
}

425 
	$chunk_®loc_deçuÉ_im¶
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
Ãw_addr
,

426 
size_t
 
size
, size_ˆ
®ignm’t
, 
boŞ
 *
z”o
, boŞ *
comm™
)

428 *
»t
;

430 
»t
 = 
	`chunk_®loc_cÜe
(
tsdn
, 
¬’a
, 
Ãw_addr
, 
size
, 
®ignm’t
, 
z”o
,

431 
comm™
, 
¬’a
->
dss_´ec
);

432 ià(
»t
 =ğ
NULL
)

433  (
NULL
);

434 ià(
cÚfig_v®gršd
)

435 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
»t
, 
size
);

437  (
»t
);

438 
	}
}

441 
	$chunk_®loc_deçuÉ
(*
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
, 
boŞ
 *
z”o
,

442 
boŞ
 *
comm™
, 
¬’a_šd
)

444 
tsdn_t
 *
tsdn
;

445 
¬’a_t
 *
¬’a
;

447 
tsdn
 = 
	`tsdn_ãtch
();

448 
¬’a
 = 
	`chunk_¬’a_g‘
(
tsdn
, 
¬’a_šd
);

450  (
	`chunk_®loc_deçuÉ_im¶
(
tsdn
, 
¬’a
, 
Ãw_addr
, 
size
, 
®ignm’t
,

451 
z”o
, 
comm™
));

452 
	}
}

455 
	$chunk_®loc_»šed
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

456 *
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
, size_ˆ*
¢
, 
boŞ
 *
z”o
,

457 
boŞ
 *
comm™
)

459 *
»t
;

461 
	`as£¹
(
size
 != 0);

462 
	`as£¹
((
size
 & 
chunksize_mask
) == 0);

463 
	`as£¹
(
®ignm’t
 != 0);

464 
	`as£¹
((
®ignm’t
 & 
chunksize_mask
) == 0);

466 
»t
 = 
	`chunk_»cyşe
(
tsdn
, 
¬’a
, 
chunk_hooks
,

467 &
¬’a
->
chunks_sz¢ad_»šed
, &¬’a->
chunks_ad_»šed
, 
çl£
,

468 
Ãw_addr
, 
size
, 
®ignm’t
, 
¢
, 
z”o
, 
comm™
, 
Œue
);

470 ià(
cÚfig_¡©s
 && 
»t
 !ğ
NULL
)

471 
¬’a
->
¡©s
.
»šed
 -ğ
size
;

473  (
»t
);

474 
	}
}

477 
	$chunk_®loc_w¿µ”
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

478 *
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
, size_ˆ*
¢
, 
boŞ
 *
z”o
,

479 
boŞ
 *
comm™
)

481 *
»t
;

483 
	`chunk_hooks_assu»_š™Ÿlized
(
tsdn
, 
¬’a
, 
chunk_hooks
);

485 
»t
 = 
	`chunk_®loc_»šed
(
tsdn
, 
¬’a
, 
chunk_hooks
, 
Ãw_addr
, 
size
,

486 
®ignm’t
, 
¢
, 
z”o
, 
comm™
);

487 ià(
»t
 =ğ
NULL
) {

488 ià(
chunk_hooks
->
®loc
 =ğ
chunk_®loc_deçuÉ
) {

490 
»t
 = 
	`chunk_®loc_deçuÉ_im¶
(
tsdn
, 
¬’a
, 
Ãw_addr
,

491 
size
, 
®ignm’t
, 
z”o
, 
comm™
);

493 
»t
 = 
chunk_hooks
->
	`®loc
(
Ãw_addr
, 
size
, 
®ignm’t
,

494 
z”o
, 
comm™
, 
¬’a
->
šd
);

497 ià(
»t
 =ğ
NULL
)

498  (
NULL
);

500 *
¢
 = 
	`¬’a_ex‹Á_¢_Ãxt
(
¬’a
);

502 ià(
cÚfig_v®gršd
 && 
chunk_hooks
->
®loc
 !=

503 
chunk_®loc_deçuÉ
)

504 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(
»t
, 
chunksize
);

507  (
»t
);

508 
	}
}

511 
	$chunk_»cÜd
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

512 
ex‹Á_Œ“_t
 *
chunks_sz¢ad
,ƒx‹Á_Œ“_ˆ*
chunks_ad
, 
boŞ
 
ÿche
,

513 *
chunk
, 
size_t
 
size
, size_ˆ
¢
, 
boŞ
 
z”Ûd
, boŞ 
comm™‹d
)

515 
boŞ
 
unz”Ûd
;

516 
ex‹Á_node_t
 *
node
, *
´ev
;

517 
ex‹Á_node_t
 
key
;

519 
	`as£¹
(!
ÿche
 || !
z”Ûd
);

520 
unz”Ûd
 = 
ÿche
 || !
z”Ûd
;

521 
	`JEMALLOC_VALGRIND_MAKE_MEM_NOACCESS
(
chunk
, 
size
);

523 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
chunks_mtx
);

524 
	`chunk_hooks_assu»_š™Ÿlized_locked
(
tsdn
, 
¬’a
, 
chunk_hooks
);

525 
	`ex‹Á_node_š™
(&
key
, 
¬’a
, (*)((
ušŒ_t
)
chunk
 + 
size
), 0, 0,

526 
çl£
, false);

527 
node
 = 
	`ex‹Á_Œ“_ad_n£¬ch
(
chunks_ad
, &
key
);

529 ià(
node
 !ğ
NULL
 && 
	`ex‹Á_node_addr_g‘
(node) ==

530 
	`ex‹Á_node_addr_g‘
(&
key
è&& 
	`ex‹Á_node_comm™‹d_g‘
(
node
) ==

531 
comm™‹d
 && !
chunk_hooks
->
	`m”ge
(
chunk
, 
size
,

532 
	`ex‹Á_node_addr_g‘
(
node
), 
	`ex‹Á_node_size_g‘
Òode), 
çl£
,

533 
¬’a
->
šd
)) {

539 
	`ex‹Á_Œ“_sz¢ad_»move
(
chunks_sz¢ad
, 
node
);

540 
	`¬’a_chunk_ÿche_maybe_»move
(
¬’a
, 
node
, 
ÿche
);

541 
	`ex‹Á_node_addr_£t
(
node
, 
chunk
);

542 
	`ex‹Á_node_size_£t
(
node
, 
size
 + 
	`ex‹Á_node_size_g‘
(node));

543 ià(
¢
 < 
	`ex‹Á_node_¢_g‘
(
node
))

544 
	`ex‹Á_node_¢_£t
(
node
, 
¢
);

545 
	`ex‹Á_node_z”Ûd_£t
(
node
, 
	`ex‹Á_node_z”Ûd_g‘
(node) &&

546 !
unz”Ûd
);

547 
	`ex‹Á_Œ“_sz¢ad_š£¹
(
chunks_sz¢ad
, 
node
);

548 
	`¬’a_chunk_ÿche_maybe_š£¹
(
¬’a
, 
node
, 
ÿche
);

551 
node
 = 
	`¬’a_node_®loc
(
tsdn
, 
¬’a
);

552 ià(
node
 =ğ
NULL
) {

559 ià(
ÿche
) {

560 
	`chunk_purge_w¿µ”
(
tsdn
, 
¬’a
, 
chunk_hooks
,

561 
chunk
, 
size
, 0, size);

563 
Ïb–_»tuº
;

565 
	`ex‹Á_node_š™
(
node
, 
¬’a
, 
chunk
, 
size
, 
¢
, !
unz”Ûd
,

566 
comm™‹d
);

567 
	`ex‹Á_Œ“_ad_š£¹
(
chunks_ad
, 
node
);

568 
	`ex‹Á_Œ“_sz¢ad_š£¹
(
chunks_sz¢ad
, 
node
);

569 
	`¬’a_chunk_ÿche_maybe_š£¹
(
¬’a
, 
node
, 
ÿche
);

573 
´ev
 = 
	`ex‹Á_Œ“_ad_´ev
(
chunks_ad
, 
node
);

574 ià(
´ev
 !ğ
NULL
 && (*)((
ušŒ_t
)
	`ex‹Á_node_addr_g‘
(prev) +

575 
	`ex‹Á_node_size_g‘
(
´ev
)è=ğ
chunk
 &&

576 
	`ex‹Á_node_comm™‹d_g‘
(
´ev
è=ğ
comm™‹d
 &&

577 !
chunk_hooks
->
	`m”ge
(
	`ex‹Á_node_addr_g‘
(
´ev
),

578 
	`ex‹Á_node_size_g‘
(
´ev
), 
chunk
, 
size
, 
çl£
, 
¬’a
->
šd
)) {

584 
	`ex‹Á_Œ“_sz¢ad_»move
(
chunks_sz¢ad
, 
´ev
);

585 
	`ex‹Á_Œ“_ad_»move
(
chunks_ad
, 
´ev
);

586 
	`¬’a_chunk_ÿche_maybe_»move
(
¬’a
, 
´ev
, 
ÿche
);

587 
	`ex‹Á_Œ“_sz¢ad_»move
(
chunks_sz¢ad
, 
node
);

588 
	`¬’a_chunk_ÿche_maybe_»move
(
¬’a
, 
node
, 
ÿche
);

589 
	`ex‹Á_node_addr_£t
(
node
, 
	`ex‹Á_node_addr_g‘
(
´ev
));

590 
	`ex‹Á_node_size_£t
(
node
, 
	`ex‹Á_node_size_g‘
(
´ev
) +

591 
	`ex‹Á_node_size_g‘
(
node
));

592 ià(
	`ex‹Á_node_¢_g‘
(
´ev
è<ƒx‹Á_node_¢_g‘(
node
))

593 
	`ex‹Á_node_¢_£t
(
node
, 
	`ex‹Á_node_¢_g‘
(
´ev
));

594 
	`ex‹Á_node_z”Ûd_£t
(
node
, 
	`ex‹Á_node_z”Ûd_g‘
(
´ev
) &&

595 
	`ex‹Á_node_z”Ûd_g‘
(
node
));

596 
	`ex‹Á_Œ“_sz¢ad_š£¹
(
chunks_sz¢ad
, 
node
);

597 
	`¬’a_chunk_ÿche_maybe_š£¹
(
¬’a
, 
node
, 
ÿche
);

599 
	`¬’a_node_d®loc
(
tsdn
, 
¬’a
, 
´ev
);

602 
Ïb–_»tuº
:

603 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
chunks_mtx
);

604 
	}
}

607 
	$chunk_d®loc_ÿche
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

608 *
chunk
, 
size_t
 
size
, size_ˆ
¢
, 
boŞ
 
comm™‹d
)

611 
	`as£¹
(
chunk
 !ğ
NULL
);

612 
	`as£¹
(
	`CHUNK_ADDR2BASE
(
chunk
) == chunk);

613 
	`as£¹
(
size
 != 0);

614 
	`as£¹
((
size
 & 
chunksize_mask
) == 0);

616 
	`chunk_»cÜd
(
tsdn
, 
¬’a
, 
chunk_hooks
, &¬’a->
chunks_sz¢ad_ÿched
,

617 &
¬’a
->
chunks_ad_ÿched
, 
Œue
, 
chunk
, 
size
, 
¢
, 
çl£
,

618 
comm™‹d
);

619 
	`¬’a_maybe_purge
(
tsdn
, 
¬’a
);

620 
	}
}

622 
boŞ


623 
	$chunk_d®loc_deçuÉ_im¶
(*
chunk
, 
size_t
 
size
)

626 ià(!
have_dss
 || !
	`chunk_š_dss
(
chunk
))

627  (
	`chunk_d®loc_mm­
(
chunk
, 
size
));

628  (
Œue
);

629 
	}
}

631 
boŞ


632 
	$chunk_d®loc_deçuÉ
(*
chunk
, 
size_t
 
size
, 
boŞ
 
comm™‹d
,

633 
¬’a_šd
)

636  (
	`chunk_d®loc_deçuÉ_im¶
(
chunk
, 
size
));

637 
	}
}

640 
	$chunk_d®loc_w¿µ”
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

641 *
chunk
, 
size_t
 
size
, size_ˆ
¢
, 
boŞ
 
z”Ûd
, boŞ 
comm™‹d
)

643 
boŞ
 
”r
;

645 
	`as£¹
(
chunk
 !ğ
NULL
);

646 
	`as£¹
(
	`CHUNK_ADDR2BASE
(
chunk
) == chunk);

647 
	`as£¹
(
size
 != 0);

648 
	`as£¹
((
size
 & 
chunksize_mask
) == 0);

650 
	`chunk_hooks_assu»_š™Ÿlized
(
tsdn
, 
¬’a
, 
chunk_hooks
);

652 ià(
chunk_hooks
->
d®loc
 =ğ
chunk_d®loc_deçuÉ
) {

654 
”r
 = 
	`chunk_d®loc_deçuÉ_im¶
(
chunk
, 
size
);

656 
”r
 = 
chunk_hooks
->
	`d®loc
(
chunk
, 
size
, 
comm™‹d
, 
¬’a
->
šd
);

658 ià(!
”r
)

661 ià(
comm™‹d
) {

662 
comm™‹d
 = 
chunk_hooks
->
	`decomm™
(
chunk
, 
size
, 0, size,

663 
¬’a
->
šd
);

665 
z”Ûd
 = !
comm™‹d
 || !
chunk_hooks
->
	`purge
(
chunk
, 
size
, 0, size,

666 
¬’a
->
šd
);

667 
	`chunk_»cÜd
(
tsdn
, 
¬’a
, 
chunk_hooks
, &¬’a->
chunks_sz¢ad_»šed
,

668 &
¬’a
->
chunks_ad_»šed
, 
çl£
, 
chunk
, 
size
, 
¢
, 
z”Ûd
,

669 
comm™‹d
);

671 ià(
cÚfig_¡©s
)

672 
¬’a
->
¡©s
.
»šed
 +ğ
size
;

673 
	}
}

675 
boŞ


676 
	$chunk_comm™_deçuÉ
(*
chunk
, 
size_t
 
size
, size_ˆ
off£t
, size_ˆ
Ëngth
,

677 
¬’a_šd
)

680  (
	`·ges_comm™
((*)((
ušŒ_t
)
chunk
 + (ušŒ_t)
off£t
),

681 
Ëngth
));

682 
	}
}

684 
boŞ


685 
	$chunk_decomm™_deçuÉ
(*
chunk
, 
size_t
 
size
, size_ˆ
off£t
, size_ˆ
Ëngth
,

686 
¬’a_šd
)

689  (
	`·ges_decomm™
((*)((
ušŒ_t
)
chunk
 + (ušŒ_t)
off£t
),

690 
Ëngth
));

691 
	}
}

693 
boŞ


694 
	$chunk_purge_deçuÉ
(*
chunk
, 
size_t
 
size
, size_ˆ
off£t
, size_ˆ
Ëngth
,

695 
¬’a_šd
)

698 
	`as£¹
(
chunk
 !ğ
NULL
);

699 
	`as£¹
(
	`CHUNK_ADDR2BASE
(
chunk
) == chunk);

700 
	`as£¹
((
off£t
 & 
PAGE_MASK
) == 0);

701 
	`as£¹
(
Ëngth
 != 0);

702 
	`as£¹
((
Ëngth
 & 
PAGE_MASK
) == 0);

704  (
	`·ges_purge
((*)((
ušŒ_t
)
chunk
 + (ušŒ_t)
off£t
),

705 
Ëngth
));

706 
	}
}

708 
boŞ


709 
	$chunk_purge_w¿µ”
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
chunk_hooks_t
 *
chunk_hooks
,

710 *
chunk
, 
size_t
 
size
, size_ˆ
off£t
, size_ˆ
Ëngth
)

713 
	`chunk_hooks_assu»_š™Ÿlized
(
tsdn
, 
¬’a
, 
chunk_hooks
);

714  (
chunk_hooks
->
	`purge
(
chunk
, 
size
, 
off£t
, 
Ëngth
, 
¬’a
->
šd
));

715 
	}
}

717 
boŞ


718 
	$chunk_¥l™_deçuÉ
(*
chunk
, 
size_t
 
size
, size_ˆ
size_a
, size_ˆ
size_b
,

719 
boŞ
 
comm™‹d
, 
¬’a_šd
)

722 ià(!
m­s_cßËsû
)

723  (
Œue
);

724  (
çl£
);

725 
	}
}

727 
boŞ


728 
	$chunk_m”ge_deçuÉ_im¶
(*
chunk_a
, *
chunk_b
)

731 ià(!
m­s_cßËsû
)

732  (
Œue
);

733 ià(
have_dss
 && !
	`chunk_dss_m”g—bË
(
chunk_a
, 
chunk_b
))

734  (
Œue
);

736  (
çl£
);

737 
	}
}

739 
boŞ


740 
	$chunk_m”ge_deçuÉ
(*
chunk_a
, 
size_t
 
size_a
, *
chunk_b
, size_ˆ
size_b
,

741 
boŞ
 
comm™‹d
, 
¬’a_šd
)

744  (
	`chunk_m”ge_deçuÉ_im¶
(
chunk_a
, 
chunk_b
));

745 
	}
}

747 
¹»e_node_–m_t
 *

748 
	$chunks_¹»e_node_®loc
(
size_t
 
Ãlms
)

751  ((
¹»e_node_–m_t
 *)
	`ba£_®loc
(
TSDN_NULL
, 
Ãlms
 *

752 (
¹»e_node_–m_t
)));

753 
	}
}

755 
boŞ


756 
	$chunk_boÙ
()

758 #ifdeà
_WIN32


759 
SYSTEM_INFO
 
šfo
;

760 
	`G‘Sy¡emInfo
(&
šfo
);

766 ià(
šfo
.
dwPageSize
 & ((1U << 
LG_PAGE
) - 1))

767  (
Œue
);

773 ià(!
İt_lg_chunk
) {

774 
İt_lg_chunk
 = 
	`ffs_u
(()
šfo
.
dwAÎoÿtiÚG¿nuÏr™y
)

778 ià(!
İt_lg_chunk
)

779 
İt_lg_chunk
 = 
LG_CHUNK_DEFAULT
;

783 
chunksize
 = (
	`ZU
(1è<< 
İt_lg_chunk
);

784 
	`as£¹
(
chunksize
 >ğ
PAGE
);

785 
chunksize_mask
 = 
chunksize
 - 1;

786 
chunk_Åages
 = (
chunksize
 >> 
LG_PAGE
);

788 ià(
have_dss
)

789 
	`chunk_dss_boÙ
();

790 ià(
	`¹»e_Ãw
(&
chunks_¹»e
, ()((
	`ZU
(1è<< (
LG_SIZEOF_PTR
+3)) -

791 
İt_lg_chunk
), 
chunks_¹»e_node_®loc
, 
NULL
))

792  (
Œue
);

794  (
çl£
);

795 
	}
}

	@deps/jemalloc/src/chunk_dss.c

1 
	#JEMALLOC_CHUNK_DSS_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

6 cÚ¡ *
	gdss_´ec_Çmes
[] = {

19 
	gdss_´ec_deçuÉ
 = ()
DSS_PREC_DEFAULT
;

22 *
	gdss_ba£
;

24 
	gdss_exhau¡ed
;

26 *
	gdss_max
;

31 
	$chunk_dss_sbrk
(
šŒ_t
 
šüem’t
)

34 #ifdeà
JEMALLOC_DSS


35  (
	`sbrk
(
šüem’t
));

37 
	`nÙ_im¶em’‹d
();

38  (
NULL
);

40 
	}
}

42 
dss_´ec_t


43 
	$chunk_dss_´ec_g‘
()

45 
dss_´ec_t
 
»t
;

47 ià(!
have_dss
)

48  (
dss_´ec_di§bËd
);

49 
»t
 = (
dss_´ec_t
)
	`©omic_»ad_u
(&
dss_´ec_deçuÉ
);

50  (
»t
);

51 
	}
}

53 
boŞ


54 
	$chunk_dss_´ec_£t
(
dss_´ec_t
 
dss_´ec
)

57 ià(!
have_dss
)

58  (
dss_´ec
 !ğ
dss_´ec_di§bËd
);

59 
	`©omic_wr™e_u
(&
dss_´ec_deçuÉ
, ()
dss_´ec
);

60  (
çl£
);

61 
	}
}

64 
	$chunk_dss_max_upd©e
(*
Ãw_addr
)

66 *
max_cur
;

67 
¥š_t
 
¥šÃr
;

73 
	`¥š_š™
(&
¥šÃr
);

74 
Œue
) {

75 *
max_´ev
 = 
	`©omic_»ad_p
(&
dss_max
);

77 
max_cur
 = 
	`chunk_dss_sbrk
(0);

78 ià((
ušŒ_t
)
max_´ev
 > (ušŒ_t)
max_cur
) {

83 
	`¥š_ad­tive
(&
¥šÃr
);

86 ià(!
	`©omic_ÿs_p
(&
dss_max
, 
max_´ev
, 
max_cur
))

90 ià(
Ãw_addr
 !ğ
NULL
 && 
max_cur
 !=‚ew_addr)

91  (
NULL
);

93  (
max_cur
);

94 
	}
}

97 
	$chunk_®loc_dss
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, *
Ãw_addr
, 
size_t
 
size
,

98 
size_t
 
®ignm’t
, 
boŞ
 *
z”o
, boŞ *
comm™
)

100 
	`ÿs£¹
(
have_dss
);

101 
	`as£¹
(
size
 > 0 && (siz& 
chunksize_mask
) == 0);

102 
	`as£¹
(
®ignm’t
 > 0 && (®ignm’ˆ& 
chunksize_mask
) == 0);

108 ià((
šŒ_t
)
size
 < 0)

109  (
NULL
);

111 ià(!
	`©omic_»ad_u
(&
dss_exhau¡ed
)) {

117 
Œue
) {

118 *
»t
, *
ıad
, *
max_cur
, *
dss_Ãxt
, *
dss_´ev
;

119 
size_t
 
g­_size
, 
ıad_size
;

120 
šŒ_t
 
šü
;

122 
max_cur
 = 
	`chunk_dss_max_upd©e
(
Ãw_addr
);

123 ià(
max_cur
 =ğ
NULL
)

124 
Ïb–_oom
;

130 
g­_size
 = (
chunksize
 - 
	`CHUNK_ADDR2OFFSET
(
dss_max
)) &

131 
chunksize_mask
;

137 
ıad
 = (*)((
ušŒ_t
)
dss_max
 + 
g­_size
);

138 
»t
 = (*)
	`ALIGNMENT_CEILING
((
ušŒ_t
)
dss_max
,

139 
®ignm’t
);

140 
ıad_size
 = (
ušŒ_t
)
»t
 - (ušŒ_t)
ıad
;

141 
dss_Ãxt
 = (*)((
ušŒ_t
)
»t
 + 
size
);

142 ià((
ušŒ_t
)
»t
 < (ušŒ_t)
dss_max
 ||

143 (
ušŒ_t
)
dss_Ãxt
 < (ušŒ_t)
dss_max
)

144 
Ïb–_oom
;

145 
šü
 = 
g­_size
 + 
ıad_size
 + 
size
;

153 ià(
	`©omic_ÿs_p
(&
dss_max
, 
max_cur
, 
dss_Ãxt
))

157 
dss_´ev
 = 
	`chunk_dss_sbrk
(
šü
);

158 ià(
dss_´ev
 =ğ
max_cur
) {

160 ià(
ıad_size
 != 0) {

161 
chunk_hooks_t
 
chunk_hooks
 =

162 
CHUNK_HOOKS_INITIALIZER
;

163 
	`chunk_d®loc_w¿µ”
(
tsdn
, 
¬’a
,

164 &
chunk_hooks
, 
ıad
, 
ıad_size
,

165 
	`¬’a_ex‹Á_¢_Ãxt
(
¬’a
), 
çl£
,

166 
Œue
);

168 ià(*
z”o
) {

169 
	`JEMALLOC_VALGRIND_MAKE_MEM_UNDEFINED
(

170 
»t
, 
size
);

171 
	`mem£t
(
»t
, 0, 
size
);

173 ià(!*
comm™
)

174 *
comm™
 = 
	`·ges_decomm™
(
»t
, 
size
);

175  (
»t
);

186 
	`©omic_ÿs_p
(&
dss_max
, 
dss_Ãxt
, 
max_cur
);

187 ià(
dss_´ev
 == (*)-1) {

189 
	`©omic_wr™e_u
(&
dss_exhau¡ed
, ()
Œue
);

190 
Ïb–_oom
;

194 
Ïb–_oom
:

195  (
NULL
);

196 
	}
}

198 
boŞ


199 
	$chunk_š_dss_h–³r
(*
chunk
, *
max
)

202  ((
ušŒ_t
)
chunk
 >ğ(ušŒ_t)
dss_ba£
 && (uintptr_t)chunk <

203 (
ušŒ_t
)
max
);

204 
	}
}

206 
boŞ


207 
	$chunk_š_dss
(*
chunk
)

210 
	`ÿs£¹
(
have_dss
);

212  (
	`chunk_š_dss_h–³r
(
chunk
, 
	`©omic_»ad_p
(&
dss_max
)));

213 
	}
}

215 
boŞ


216 
	$chunk_dss_m”g—bË
(*
chunk_a
, *
chunk_b
)

218 *
max
;

220 
	`ÿs£¹
(
have_dss
);

222 
max
 = 
	`©omic_»ad_p
(&
dss_max
);

223  (
	`chunk_š_dss_h–³r
(
chunk_a
, 
max
) ==

224 
	`chunk_š_dss_h–³r
(
chunk_b
, 
max
));

225 
	}
}

228 
	$chunk_dss_boÙ
()

231 
	`ÿs£¹
(
have_dss
);

233 
dss_ba£
 = 
	`chunk_dss_sbrk
(0);

234 
dss_exhau¡ed
 = ()(
dss_ba£
 == (*)-1);

235 
dss_max
 = 
dss_ba£
;

236 
	}
}

	@deps/jemalloc/src/chunk_mmap.c

1 
	#JEMALLOC_CHUNK_MMAP_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

7 
	$chunk_®loc_mm­_¦ow
(
size_t
 
size
, size_ˆ
®ignm’t
, 
boŞ
 *
z”o
, boŞ *
comm™
)

9 *
»t
;

10 
size_t
 
®loc_size
;

12 
®loc_size
 = 
size
 + 
®ignm’t
 - 
PAGE
;

14 ià(
®loc_size
 < 
size
)

15  (
NULL
);

17 *
·ges
;

18 
size_t
 
Ëadsize
;

19 
·ges
 = 
	`·ges_m­
(
NULL
, 
®loc_size
, 
comm™
);

20 ià(
·ges
 =ğ
NULL
)

21  (
NULL
);

22 
Ëadsize
 = 
	`ALIGNMENT_CEILING
((
ušŒ_t
)
·ges
, 
®ignm’t
) -

23 (
ušŒ_t
)
·ges
;

24 
»t
 = 
	`·ges_Œim
(
·ges
, 
®loc_size
, 
Ëadsize
, 
size
, 
comm™
);

25 } 
»t
 =ğ
NULL
);

27 
	`as£¹
(
»t
 !ğ
NULL
);

28 *
z”o
 = 
Œue
;

29  (
»t
);

30 
	}
}

33 
	$chunk_®loc_mm­
(*
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
, 
boŞ
 *
z”o
,

34 
boŞ
 *
comm™
)

36 *
»t
;

37 
size_t
 
off£t
;

52 
	`as£¹
(
®ignm’t
 != 0);

53 
	`as£¹
((
®ignm’t
 & 
chunksize_mask
) == 0);

55 
»t
 = 
	`·ges_m­
(
Ãw_addr
, 
size
, 
comm™
);

56 ià(
»t
 =ğ
NULL
 ||„‘ =ğ
Ãw_addr
)

57  (
»t
);

58 
	`as£¹
(
Ãw_addr
 =ğ
NULL
);

59 
off£t
 = 
	`ALIGNMENT_ADDR2OFFSET
(
»t
, 
®ignm’t
);

60 ià(
off£t
 != 0) {

61 
	`·ges_unm­
(
»t
, 
size
);

62  (
	`chunk_®loc_mm­_¦ow
(
size
, 
®ignm’t
, 
z”o
, 
comm™
));

65 
	`as£¹
(
»t
 !ğ
NULL
);

66 *
z”o
 = 
Œue
;

67  (
»t
);

68 
	}
}

70 
boŞ


71 
	$chunk_d®loc_mm­
(*
chunk
, 
size_t
 
size
)

74 ià(
cÚfig_munm­
)

75 
	`·ges_unm­
(
chunk
, 
size
);

77  (!
cÚfig_munm­
);

78 
	}
}

	@deps/jemalloc/src/ckh.c

37 
	#JEMALLOC_CKH_C_


	)

38 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

43 
boŞ
 
ckh_grow
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
);

44 
ckh_shršk
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
);

52 
JEMALLOC_INLINE_C
 
size_t


53 
	$ckh_buck‘_£¬ch
(
ckh_t
 *
ckh
, 
size_t
 
buck‘
, cÚ¡ *
key
)

55 
ckhc_t
 *
ûÎ
;

56 
i
;

58 
i
 = 0; i < (
	`ZU
(1è<< 
LG_CKH_BUCKET_CELLS
); i++) {

59 
ûÎ
 = &
ckh
->
b
[(
buck‘
 << 
LG_CKH_BUCKET_CELLS
è+ 
i
];

60 ià(
ûÎ
->
key
 !ğ
NULL
 && 
ckh
->
	`keycomp
(key, cell->key))

61  ((
buck‘
 << 
LG_CKH_BUCKET_CELLS
è+ 
i
);

64  (
SIZE_T_MAX
);

65 
	}
}

70 
JEMALLOC_INLINE_C
 
size_t


71 
	$ckh_i£¬ch
(
ckh_t
 *
ckh
, cÚ¡ *
key
)

73 
size_t
 
hashes
[2], 
buck‘
, 
ûÎ
;

75 
	`as£¹
(
ckh
 !ğ
NULL
);

77 
ckh
->
	`hash
(
key
, 
hashes
);

80 
buck‘
 = 
hashes
[0] & ((
	`ZU
(1è<< 
ckh
->
lg_curbuck‘s
) - 1);

81 
ûÎ
 = 
	`ckh_buck‘_£¬ch
(
ckh
, 
buck‘
, 
key
);

82 ià(
ûÎ
 !ğ
SIZE_T_MAX
)

83  (
ûÎ
);

86 
buck‘
 = 
hashes
[1] & ((
	`ZU
(1è<< 
ckh
->
lg_curbuck‘s
) - 1);

87 
ûÎ
 = 
	`ckh_buck‘_£¬ch
(
ckh
, 
buck‘
, 
key
);

88  (
ûÎ
);

89 
	}
}

91 
JEMALLOC_INLINE_C
 
boŞ


92 
	$ckh_Œy_buck‘_š£¹
(
ckh_t
 *
ckh
, 
size_t
 
buck‘
, cÚ¡ *
key
,

93 cÚ¡ *
d©a
)

95 
ckhc_t
 *
ûÎ
;

96 
off£t
, 
i
;

102 
off£t
 = ()
	`´ng_lg_¿nge_u64
(&
ckh
->
´ng_¡©e
,

103 
LG_CKH_BUCKET_CELLS
);

104 
i
 = 0; i < (
	`ZU
(1è<< 
LG_CKH_BUCKET_CELLS
); i++) {

105 
ûÎ
 = &
ckh
->
b
[(
buck‘
 << 
LG_CKH_BUCKET_CELLS
) +

106 ((
i
 + 
off£t
è& ((
	`ZU
(1è<< 
LG_CKH_BUCKET_CELLS
) - 1))];

107 ià(
ûÎ
->
key
 =ğ
NULL
) {

108 
ûÎ
->
key
 = key;

109 
ûÎ
->
d©a
 = data;

110 
ckh
->
couÁ
++;

111  (
çl£
);

115  (
Œue
);

116 
	}
}

124 
JEMALLOC_INLINE_C
 
boŞ


125 
	$ckh_eviù_»loc_š£¹
(
ckh_t
 *
ckh
, 
size_t
 
¬gbuck‘
, cÚ¡ **
¬gkey
,

126 cÚ¡ **
¬gd©a
)

128 cÚ¡ *
key
, *
d©a
, *
tkey
, *
td©a
;

129 
ckhc_t
 *
ûÎ
;

130 
size_t
 
hashes
[2], 
buck‘
, 
tbuck‘
;

131 
i
;

133 
buck‘
 = 
¬gbuck‘
;

134 
key
 = *
¬gkey
;

135 
d©a
 = *
¬gd©a
;

136 
Œue
) {

145 
i
 = ()
	`´ng_lg_¿nge_u64
(&
ckh
->
´ng_¡©e
,

146 
LG_CKH_BUCKET_CELLS
);

147 
ûÎ
 = &
ckh
->
b
[(
buck‘
 << 
LG_CKH_BUCKET_CELLS
è+ 
i
];

148 
	`as£¹
(
ûÎ
->
key
 !ğ
NULL
);

151 
tkey
 = 
ûÎ
->
key
; 
td©a
 = c–l->
d©a
;

152 
ûÎ
->
key
 = key; c–l->
d©a
 = data;

153 
key
 = 
tkey
; 
d©a
 = 
td©a
;

155 #ifdeà
CKH_COUNT


156 
ckh
->
Ä–ocs
++;

160 
ckh
->
	`hash
(
key
, 
hashes
);

161 
tbuck‘
 = 
hashes
[1] & ((
	`ZU
(1è<< 
ckh
->
lg_curbuck‘s
) - 1);

162 ià(
tbuck‘
 =ğ
buck‘
) {

163 
tbuck‘
 = 
hashes
[0] & ((
	`ZU
(1è<< 
ckh
->
lg_curbuck‘s
)

183 ià(
tbuck‘
 =ğ
¬gbuck‘
) {

184 *
¬gkey
 = 
key
;

185 *
¬gd©a
 = 
d©a
;

186  (
Œue
);

189 
buck‘
 = 
tbuck‘
;

190 ià(!
	`ckh_Œy_buck‘_š£¹
(
ckh
, 
buck‘
, 
key
, 
d©a
))

191  (
çl£
);

193 
	}
}

195 
JEMALLOC_INLINE_C
 
boŞ


196 
	$ckh_Œy_š£¹
(
ckh_t
 *
ckh
, cÚ¡**
¬gkey
, cÚ¡**
¬gd©a
)

198 
size_t
 
hashes
[2], 
buck‘
;

199 cÚ¡ *
key
 = *
¬gkey
;

200 cÚ¡ *
d©a
 = *
¬gd©a
;

202 
ckh
->
	`hash
(
key
, 
hashes
);

205 
buck‘
 = 
hashes
[0] & ((
	`ZU
(1è<< 
ckh
->
lg_curbuck‘s
) - 1);

206 ià(!
	`ckh_Œy_buck‘_š£¹
(
ckh
, 
buck‘
, 
key
, 
d©a
))

207  (
çl£
);

210 
buck‘
 = 
hashes
[1] & ((
	`ZU
(1è<< 
ckh
->
lg_curbuck‘s
) - 1);

211 ià(!
	`ckh_Œy_buck‘_š£¹
(
ckh
, 
buck‘
, 
key
, 
d©a
))

212  (
çl£
);

217  (
	`ckh_eviù_»loc_š£¹
(
ckh
, 
buck‘
, 
¬gkey
, 
¬gd©a
));

218 
	}
}

224 
JEMALLOC_INLINE_C
 
boŞ


225 
	$ckh_»bud
(
ckh_t
 *
ckh
, 
ckhc_t
 *
aTab
)

227 
size_t
 
couÁ
, 
i
, 
nšs
;

228 cÚ¡ *
key
, *
d©a
;

230 
couÁ
 = 
ckh
->count;

231 
ckh
->
couÁ
 = 0;

232 
i
 = 
nšs
 = 0;‚š < 
couÁ
; i++) {

233 ià(
aTab
[
i
].
key
 !ğ
NULL
) {

234 
key
 = 
aTab
[
i
].key;

235 
d©a
 = 
aTab
[
i
].data;

236 ià(
	`ckh_Œy_š£¹
(
ckh
, &
key
, &
d©a
)) {

237 
ckh
->
couÁ
 = count;

238  (
Œue
);

240 
nšs
++;

244  (
çl£
);

245 
	}
}

247 
boŞ


248 
	$ckh_grow
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
)

250 
boŞ
 
»t
;

251 
ckhc_t
 *
b
, *
‰ab
;

252 
lg_´evbuck‘s
, 
lg_curûÎs
;

254 #ifdeà
CKH_COUNT


255 
ckh
->
ngrows
++;

263 
lg_´evbuck‘s
 = 
ckh
->
lg_curbuck‘s
;

264 
lg_curûÎs
 = 
ckh
->
lg_curbuck‘s
 + 
LG_CKH_BUCKET_CELLS
;

265 
Œue
) {

266 
size_t
 
usize
;

268 
lg_curûÎs
++;

269 
usize
 = 
	`§2u
((
ckhc_t
è<< 
lg_curûÎs
, 
CACHELINE
);

270 ià(
	`uÆik–y
(
usize
 =ğ0 || usiz> 
HUGE_MAXCLASS
)) {

271 
»t
 = 
Œue
;

272 
Ïb–_»tuº
;

274 
b
 = (
ckhc_t
 *)
	`®locztm
(
	`tsd_tsdn
(
tsd
), 
usize
, 
CACHELINE
,

275 
Œue
, 
NULL
,rue, 
	`¬’a_ichoo£
(
tsd
, NULL));

276 ià(
b
 =ğ
NULL
) {

277 
»t
 = 
Œue
;

278 
Ïb–_»tuº
;

281 
‰ab
 = 
ckh
->
b
;

282 
ckh
->
b
 =ab;

283 
b
 = 
‰ab
;

284 
ckh
->
lg_curbuck‘s
 = 
lg_curûÎs
 - 
LG_CKH_BUCKET_CELLS
;

286 ià(!
	`ckh_»bud
(
ckh
, 
b
)) {

287 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
b
, 
NULL
, 
Œue
,rue);

292 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
ckh
->
b
, 
NULL
, 
Œue
,rue);

293 
ckh
->
b
 =ab;

294 
ckh
->
lg_curbuck‘s
 = 
lg_´evbuck‘s
;

297 
»t
 = 
çl£
;

298 
Ïb–_»tuº
:

299  (
»t
);

300 
	}
}

303 
	$ckh_shršk
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
)

305 
ckhc_t
 *
b
, *
‰ab
;

306 
size_t
 
usize
;

307 
lg_´evbuck‘s
, 
lg_curûÎs
;

313 
lg_´evbuck‘s
 = 
ckh
->
lg_curbuck‘s
;

314 
lg_curûÎs
 = 
ckh
->
lg_curbuck‘s
 + 
LG_CKH_BUCKET_CELLS
 - 1;

315 
usize
 = 
	`§2u
((
ckhc_t
è<< 
lg_curûÎs
, 
CACHELINE
);

316 ià(
	`uÆik–y
(
usize
 =ğ0 || usiz> 
HUGE_MAXCLASS
))

318 
b
 = (
ckhc_t
 *)
	`®locztm
(
	`tsd_tsdn
(
tsd
), 
usize
, 
CACHELINE
, 
Œue
, 
NULL
,

319 
Œue
, 
	`¬’a_ichoo£
(
tsd
, 
NULL
));

320 ià(
b
 =ğ
NULL
) {

328 
‰ab
 = 
ckh
->
b
;

329 
ckh
->
b
 =ab;

330 
b
 = 
‰ab
;

331 
ckh
->
lg_curbuck‘s
 = 
lg_curûÎs
 - 
LG_CKH_BUCKET_CELLS
;

333 ià(!
	`ckh_»bud
(
ckh
, 
b
)) {

334 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
b
, 
NULL
, 
Œue
,rue);

335 #ifdeà
CKH_COUNT


336 
ckh
->
nshršks
++;

342 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
ckh
->
b
, 
NULL
, 
Œue
,rue);

343 
ckh
->
b
 =ab;

344 
ckh
->
lg_curbuck‘s
 = 
lg_´evbuck‘s
;

345 #ifdeà
CKH_COUNT


346 
ckh
->
nshrškçs
++;

348 
	}
}

350 
boŞ


351 
	$ckh_Ãw
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
, 
size_t
 
mš™ems
, 
ckh_hash_t
 *
hash
,

352 
ckh_keycomp_t
 *
keycomp
)

354 
boŞ
 
»t
;

355 
size_t
 
mšûÎs
, 
usize
;

356 
lg_mšûÎs
;

358 
	`as£¹
(
mš™ems
 > 0);

359 
	`as£¹
(
hash
 !ğ
NULL
);

360 
	`as£¹
(
keycomp
 !ğ
NULL
);

362 #ifdeà
CKH_COUNT


363 
ckh
->
ngrows
 = 0;

364 
ckh
->
nshršks
 = 0;

365 
ckh
->
nshrškçs
 = 0;

366 
ckh
->
nš£¹s
 = 0;

367 
ckh
->
Ä–ocs
 = 0;

369 
ckh
->
´ng_¡©e
 = 42;

370 
ckh
->
couÁ
 = 0;

379 
	`as£¹
(
LG_CKH_BUCKET_CELLS
 > 0);

380 
mšûÎs
 = ((
mš™ems
 + (3 - (minitems % 3))) / 3) << 2;

381 
lg_mšûÎs
 = 
LG_CKH_BUCKET_CELLS
;

382 (
	`ZU
(1è<< 
lg_mšûÎs
è< 
mšûÎs
;

383 
lg_mšûÎs
++)

385 
ckh
->
lg_mšbuck‘s
 = 
lg_mšûÎs
 - 
LG_CKH_BUCKET_CELLS
;

386 
ckh
->
lg_curbuck‘s
 = 
lg_mšûÎs
 - 
LG_CKH_BUCKET_CELLS
;

387 
ckh
->
hash
 = hash;

388 
ckh
->
keycomp
 = keycomp;

390 
usize
 = 
	`§2u
((
ckhc_t
è<< 
lg_mšûÎs
, 
CACHELINE
);

391 ià(
	`uÆik–y
(
usize
 =ğ0 || usiz> 
HUGE_MAXCLASS
)) {

392 
»t
 = 
Œue
;

393 
Ïb–_»tuº
;

395 
ckh
->
b
 = (
ckhc_t
 *)
	`®locztm
(
	`tsd_tsdn
(
tsd
), 
usize
, 
CACHELINE
, 
Œue
,

396 
NULL
, 
Œue
, 
	`¬’a_ichoo£
(
tsd
, NULL));

397 ià(
ckh
->
b
 =ğ
NULL
) {

398 
»t
 = 
Œue
;

399 
Ïb–_»tuº
;

402 
»t
 = 
çl£
;

403 
Ïb–_»tuº
:

404  (
»t
);

405 
	}
}

408 
	$ckh_d–‘e
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
)

411 
	`as£¹
(
ckh
 !ğ
NULL
);

413 #ifdeà
CKH_VERBOSE


414 
	`m®loc_´štf
(

415 "%s(%p):‚grows: %"
FMTu64
",‚shrinks: %"FMTu64","

416 "‚shrškçs: %"
FMTu64
",‚inserts: %"FMTu64","

417 "‚»locs: %"
FMTu64
"\n", 
__func__
, 
ckh
,

418 ()
ckh
->
ngrows
,

419 ()
ckh
->
nshršks
,

420 ()
ckh
->
nshrškçs
,

421 ()
ckh
->
nš£¹s
,

422 ()
ckh
->
Ä–ocs
);

425 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
ckh
->
b
, 
NULL
, 
Œue
,rue);

426 ià(
cÚfig_debug
)

427 
	`mem£t
(
ckh
, 
JEMALLOC_FREE_JUNK
, (
ckh_t
));

428 
	}
}

430 
size_t


431 
	$ckh_couÁ
(
ckh_t
 *
ckh
)

434 
	`as£¹
(
ckh
 !ğ
NULL
);

436  (
ckh
->
couÁ
);

437 
	}
}

439 
boŞ


440 
	$ckh_™”
(
ckh_t
 *
ckh
, 
size_t
 *
bšd
, **
key
, **
d©a
)

442 
size_t
 
i
, 
nûÎs
;

444 
i
 = *
bšd
, 
nûÎs
 = (
	`ZU
(1è<< (
ckh
->
lg_curbuck‘s
 +

445 
LG_CKH_BUCKET_CELLS
)); 
i
 < 
nûÎs
; i++) {

446 ià(
ckh
->
b
[
i
].
key
 !ğ
NULL
) {

447 ià(
key
 !ğ
NULL
)

448 *
key
 = (*)
ckh
->
b
[
i
].key;

449 ià(
d©a
 !ğ
NULL
)

450 *
d©a
 = (*)
ckh
->
b
[
i
].data;

451 *
bšd
 = 
i
 + 1;

452  (
çl£
);

456  (
Œue
);

457 
	}
}

459 
boŞ


460 
	$ckh_š£¹
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
, cÚ¡ *
key
, cÚ¡ *
d©a
)

462 
boŞ
 
»t
;

464 
	`as£¹
(
ckh
 !ğ
NULL
);

465 
	`as£¹
(
	`ckh_£¬ch
(
ckh
, 
key
, 
NULL
, NULL));

467 #ifdeà
CKH_COUNT


468 
ckh
->
nš£¹s
++;

471 
	`ckh_Œy_š£¹
(
ckh
, &
key
, &
d©a
)) {

472 ià(
	`ckh_grow
(
tsd
, 
ckh
)) {

473 
»t
 = 
Œue
;

474 
Ïb–_»tuº
;

478 
»t
 = 
çl£
;

479 
Ïb–_»tuº
:

480  (
»t
);

481 
	}
}

483 
boŞ


484 
	$ckh_»move
(
tsd_t
 *
tsd
, 
ckh_t
 *
ckh
, cÚ¡ *
£¬chkey
, **
key
,

485 **
d©a
)

487 
size_t
 
ûÎ
;

489 
	`as£¹
(
ckh
 !ğ
NULL
);

491 
ûÎ
 = 
	`ckh_i£¬ch
(
ckh
, 
£¬chkey
);

492 ià(
ûÎ
 !ğ
SIZE_T_MAX
) {

493 ià(
key
 !ğ
NULL
)

494 *
key
 = (*)
ckh
->
b
[
ûÎ
].key;

495 ià(
d©a
 !ğ
NULL
)

496 *
d©a
 = (*)
ckh
->
b
[
ûÎ
].data;

497 
ckh
->
b
[
ûÎ
].
key
 = 
NULL
;

498 
ckh
->
b
[
ûÎ
].
d©a
 = 
NULL
;

500 
ckh
->
couÁ
--;

502 ià(
ckh
->
couÁ
 < (
	`ZU
(1è<< (ckh->
lg_curbuck‘s


503 + 
LG_CKH_BUCKET_CELLS
 - 2)è&& 
ckh
->
lg_curbuck‘s


504 > 
ckh
->
lg_mšbuck‘s
) {

506 
	`ckh_shršk
(
tsd
, 
ckh
);

509  (
çl£
);

512  (
Œue
);

513 
	}
}

515 
boŞ


516 
	$ckh_£¬ch
(
ckh_t
 *
ckh
, cÚ¡ *
£¬chkey
, **
key
, **
d©a
)

518 
size_t
 
ûÎ
;

520 
	`as£¹
(
ckh
 !ğ
NULL
);

522 
ûÎ
 = 
	`ckh_i£¬ch
(
ckh
, 
£¬chkey
);

523 ià(
ûÎ
 !ğ
SIZE_T_MAX
) {

524 ià(
key
 !ğ
NULL
)

525 *
key
 = (*)
ckh
->
b
[
ûÎ
].key;

526 ià(
d©a
 !ğ
NULL
)

527 *
d©a
 = (*)
ckh
->
b
[
ûÎ
].data;

528  (
çl£
);

531  (
Œue
);

532 
	}
}

535 
	$ckh_¡ršg_hash
(cÚ¡ *
key
, 
size_t
 
r_hash
[2])

538 
	`hash
(
key
, 
	`¡¾’
((cÚ¡ *)key), 0x94122f33U, 
r_hash
);

539 
	}
}

541 
boŞ


542 
	$ckh_¡ršg_keycomp
(cÚ¡ *
k1
, cÚ¡ *
k2
)

545 
	`as£¹
(
k1
 !ğ
NULL
);

546 
	`as£¹
(
k2
 !ğ
NULL
);

548  (
	`¡rcmp
((*)
k1
, (*)
k2
è? 
çl£
 : 
Œue
);

549 
	}
}

552 
	$ckh_poš‹r_hash
(cÚ¡ *
key
, 
size_t
 
r_hash
[2])

555 cÚ¡ *
v
;

556 
size_t
 
i
;

557 } 
u
;

559 
	`as£¹
((
u
.
v
è=ğ(u.
i
));

560 
u
.
v
 = 
key
;

561 
	`hash
(&
u
.
i
, (u.i), 0xd983396eU, 
r_hash
);

562 
	}
}

564 
boŞ


565 
	$ckh_poš‹r_keycomp
(cÚ¡ *
k1
, cÚ¡ *
k2
)

568  ((
k1
 =ğ
k2
è? 
Œue
 : 
çl£
);

569 
	}
}

	@deps/jemalloc/src/ctl.c

1 
	#JEMALLOC_CTL_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

11 
m®loc_mu‹x_t
 
	gùl_mtx
;

12 
boŞ
 
	gùl_š™Ÿlized
;

13 
ušt64_t
 
	gùl_•och
;

14 
ùl_¡©s_t
 
	gùl_¡©s
;

19 
JEMALLOC_INLINE_C
 cÚ¡ 
ùl_Çmed_node_t
 *

20 
	$ùl_Çmed_node
(cÚ¡ 
ùl_node_t
 *
node
)

23  ((
node
->
Çmed
è? (cÚ¡ 
ùl_Çmed_node_t
 *êod: 
NULL
);

24 
	}
}

26 
JEMALLOC_INLINE_C
 cÚ¡ 
ùl_Çmed_node_t
 *

27 
	$ùl_Çmed_chd»n
(cÚ¡ 
ùl_Çmed_node_t
 *
node
, 
size_t
 
šdex
)

29 cÚ¡ 
ùl_Çmed_node_t
 *
chd»n
 = 
	`ùl_Çmed_node
(
node
->children);

31  (
chd»n
 ? &chd»n[
šdex
] : 
NULL
);

32 
	}
}

34 
JEMALLOC_INLINE_C
 cÚ¡ 
ùl_šdexed_node_t
 *

35 
	$ùl_šdexed_node
(cÚ¡ 
ùl_node_t
 *
node
)

38  (!
node
->
Çmed
 ? (cÚ¡ 
ùl_šdexed_node_t
 *êod: 
NULL
);

39 
	}
}

44 
	#CTL_PROTO
(
n
) \

45 
n
##
	`_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, \

46 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
);

	)

48 
	#INDEX_PROTO
(
n
) \

49 cÚ¡ 
ùl_Çmed_node_t
 *
n
##
	`_šdex
(
tsdn_t
 *
tsdn
, \

50 cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, size_ˆ
i
);

	)

52 
boŞ
 
ùl_¬’a_š™
(
ùl_¬’a_¡©s_t
 *
a¡©s
);

53 
ùl_¬’a_ş—r
(
ùl_¬’a_¡©s_t
 *
a¡©s
);

54 
ùl_¬’a_¡©s_am”ge
(
tsdn_t
 *
tsdn
, 
ùl_¬’a_¡©s_t
 *
c¡©s
,

55 
¬’a_t
 *
¬’a
);

56 
ùl_¬’a_¡©s_sm”ge
(
ùl_¬’a_¡©s_t
 *
s¡©s
,

57 
ùl_¬’a_¡©s_t
 *
a¡©s
);

58 
ùl_¬’a_»äesh
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
i
);

59 
boŞ
 
ùl_grow
(
tsdn_t
 *
tsdn
);

60 
ùl_»äesh
(
tsdn_t
 *
tsdn
);

61 
boŞ
 
ùl_š™
(
tsdn_t
 *
tsdn
);

62 
ùl_lookup
(
tsdn_t
 *
tsdn
, cÚ¡ *
Çme
,

63 
ùl_node_t
 cÚ¡ **
node¥
, 
size_t
 *
mibp
, size_ˆ*
d•thp
);

65 
	$CTL_PROTO
(
v”siÚ
)

66 
	$CTL_PROTO
(
•och
)

67 
	$CTL_PROTO
(
th»ad_tÿche_’abËd
)

68 
	$CTL_PROTO
(
th»ad_tÿche_æush
)

69 
	$CTL_PROTO
(
th»ad_´of_Çme
)

70 
	$CTL_PROTO
(
th»ad_´of_aùive
)

71 
	$CTL_PROTO
(
th»ad_¬’a
)

72 
	$CTL_PROTO
(
th»ad_®loÿ‹d
)

73 
	$CTL_PROTO
(
th»ad_®loÿ‹dp
)

74 
	$CTL_PROTO
(
th»ad_d—Îoÿ‹d
)

75 
	$CTL_PROTO
(
th»ad_d—Îoÿ‹dp
)

76 
	$CTL_PROTO
(
cÚfig_ÿche_oblivious
)

77 
	$CTL_PROTO
(
cÚfig_debug
)

78 
	$CTL_PROTO
(
cÚfig_fl
)

79 
	$CTL_PROTO
(
cÚfig_Ïzy_lock
)

80 
	$CTL_PROTO
(
cÚfig_m®loc_cÚf
)

81 
	$CTL_PROTO
(
cÚfig_munm­
)

82 
	$CTL_PROTO
(
cÚfig_´of
)

83 
	$CTL_PROTO
(
cÚfig_´of_libgcc
)

84 
	$CTL_PROTO
(
cÚfig_´of_libunwšd
)

85 
	$CTL_PROTO
(
cÚfig_¡©s
)

86 
	$CTL_PROTO
(
cÚfig_tÿche
)

87 
	$CTL_PROTO
(
cÚfig_s
)

88 
	$CTL_PROTO
(
cÚfig_uŒaû
)

89 
	$CTL_PROTO
(
cÚfig_v®gršd
)

90 
	$CTL_PROTO
(
cÚfig_xm®loc
)

91 
	$CTL_PROTO
(
İt_abÜt
)

92 
	$CTL_PROTO
(
İt_dss
)

93 
	$CTL_PROTO
(
İt_lg_chunk
)

94 
	$CTL_PROTO
(
İt_Ç»Çs
)

95 
	$CTL_PROTO
(
İt_purge
)

96 
	$CTL_PROTO
(
İt_lg_dœty_muÉ
)

97 
	$CTL_PROTO
(
İt_deÿy_time
)

98 
	$CTL_PROTO
(
İt_¡©s_´št
)

99 
	$CTL_PROTO
(
İt_junk
)

100 
	$CTL_PROTO
(
İt_z”o
)

101 
	$CTL_PROTO
(
İt_qu¬ªtše
)

102 
	$CTL_PROTO
(
İt_»dzÚe
)

103 
	$CTL_PROTO
(
İt_uŒaû
)

104 
	$CTL_PROTO
(
İt_xm®loc
)

105 
	$CTL_PROTO
(
İt_tÿche
)

106 
	$CTL_PROTO
(
İt_lg_tÿche_max
)

107 
	$CTL_PROTO
(
İt_´of
)

108 
	$CTL_PROTO
(
İt_´of_´efix
)

109 
	$CTL_PROTO
(
İt_´of_aùive
)

110 
	$CTL_PROTO
(
İt_´of_th»ad_aùive_š™
)

111 
	$CTL_PROTO
(
İt_lg_´of_§m¶e
)

112 
	$CTL_PROTO
(
İt_lg_´of_š‹rv®
)

113 
	$CTL_PROTO
(
İt_´of_gdump
)

114 
	$CTL_PROTO
(
İt_´of_fš®
)

115 
	$CTL_PROTO
(
İt_´of_Ëak
)

116 
	$CTL_PROTO
(
İt_´of_accum
)

117 
	$CTL_PROTO
(
tÿche_ü—‹
)

118 
	$CTL_PROTO
(
tÿche_æush
)

119 
	$CTL_PROTO
(
tÿche_de¡roy
)

120 
	`¬’a_i_purge
(
tsdn_t
 *
tsdn
, 
¬’a_šd
, 
boŞ
 
®l
);

121 
	$CTL_PROTO
(
¬’a_i_purge
)

122 
	$CTL_PROTO
(
¬’a_i_deÿy
)

123 
	$CTL_PROTO
(
¬’a_i_»£t
)

124 
	$CTL_PROTO
(
¬’a_i_dss
)

125 
	$CTL_PROTO
(
¬’a_i_lg_dœty_muÉ
)

126 
	$CTL_PROTO
(
¬’a_i_deÿy_time
)

127 
	$CTL_PROTO
(
¬’a_i_chunk_hooks
)

128 
	$INDEX_PROTO
(
¬’a_i
)

129 
	$CTL_PROTO
(
¬’as_bš_i_size
)

130 
	$CTL_PROTO
(
¬’as_bš_i_Äegs
)

131 
	$CTL_PROTO
(
¬’as_bš_i_run_size
)

132 
	$INDEX_PROTO
(
¬’as_bš_i
)

133 
	$CTL_PROTO
(
¬’as_Ìun_i_size
)

134 
	$INDEX_PROTO
(
¬’as_Ìun_i
)

135 
	$CTL_PROTO
(
¬’as_hchunk_i_size
)

136 
	$INDEX_PROTO
(
¬’as_hchunk_i
)

137 
	$CTL_PROTO
(
¬’as_Ç»Çs
)

138 
	$CTL_PROTO
(
¬’as_š™Ÿlized
)

139 
	$CTL_PROTO
(
¬’as_lg_dœty_muÉ
)

140 
	$CTL_PROTO
(
¬’as_deÿy_time
)

141 
	$CTL_PROTO
(
¬’as_quªtum
)

142 
	$CTL_PROTO
(
¬’as_·ge
)

143 
	$CTL_PROTO
(
¬’as_tÿche_max
)

144 
	$CTL_PROTO
(
¬’as_nbšs
)

145 
	$CTL_PROTO
(
¬’as_nhbšs
)

146 
	$CTL_PROTO
(
¬’as_Æruns
)

147 
	$CTL_PROTO
(
¬’as_nhchunks
)

148 
	$CTL_PROTO
(
¬’as_ex‹nd
)

149 
	$CTL_PROTO
(
´of_th»ad_aùive_š™
)

150 
	$CTL_PROTO
(
´of_aùive
)

151 
	$CTL_PROTO
(
´of_dump
)

152 
	$CTL_PROTO
(
´of_gdump
)

153 
	$CTL_PROTO
(
´of_»£t
)

154 
	$CTL_PROTO
(
´of_š‹rv®
)

155 
	$CTL_PROTO
(
lg_´of_§m¶e
)

156 
	$CTL_PROTO
(
¡©s_¬’as_i_sm®l_®loÿ‹d
)

157 
	$CTL_PROTO
(
¡©s_¬’as_i_sm®l_nm®loc
)

158 
	$CTL_PROTO
(
¡©s_¬’as_i_sm®l_nd®loc
)

159 
	$CTL_PROTO
(
¡©s_¬’as_i_sm®l_Äeque¡s
)

160 
	$CTL_PROTO
(
¡©s_¬’as_i_Ïrge_®loÿ‹d
)

161 
	$CTL_PROTO
(
¡©s_¬’as_i_Ïrge_nm®loc
)

162 
	$CTL_PROTO
(
¡©s_¬’as_i_Ïrge_nd®loc
)

163 
	$CTL_PROTO
(
¡©s_¬’as_i_Ïrge_Äeque¡s
)

164 
	$CTL_PROTO
(
¡©s_¬’as_i_huge_®loÿ‹d
)

165 
	$CTL_PROTO
(
¡©s_¬’as_i_huge_nm®loc
)

166 
	$CTL_PROTO
(
¡©s_¬’as_i_huge_nd®loc
)

167 
	$CTL_PROTO
(
¡©s_¬’as_i_huge_Äeque¡s
)

168 
	$CTL_PROTO
(
¡©s_¬’as_i_bšs_j_nm®loc
)

169 
	$CTL_PROTO
(
¡©s_¬’as_i_bšs_j_nd®loc
)

170 
	$CTL_PROTO
(
¡©s_¬’as_i_bšs_j_Äeque¡s
)

171 
	$CTL_PROTO
(
¡©s_¬’as_i_bšs_j_cu¼egs
)

172 
	$CTL_PROTO
(
¡©s_¬’as_i_bšs_j_nfls
)

173 
	$CTL_PROTO
(
¡©s_¬’as_i_bšs_j_næushes
)

174 
	$CTL_PROTO
(
¡©s_¬’as_i_bšs_j_Äuns
)

175 
	$CTL_PROTO
(
¡©s_¬’as_i_bšs_j_Ä”uns
)

176 
	$CTL_PROTO
(
¡©s_¬’as_i_bšs_j_cu¼uns
)

177 
	$INDEX_PROTO
(
¡©s_¬’as_i_bšs_j
)

178 
	$CTL_PROTO
(
¡©s_¬’as_i_Ìuns_j_nm®loc
)

179 
	$CTL_PROTO
(
¡©s_¬’as_i_Ìuns_j_nd®loc
)

180 
	$CTL_PROTO
(
¡©s_¬’as_i_Ìuns_j_Äeque¡s
)

181 
	$CTL_PROTO
(
¡©s_¬’as_i_Ìuns_j_cu¼uns
)

182 
	$INDEX_PROTO
(
¡©s_¬’as_i_Ìuns_j
)

183 
	$CTL_PROTO
(
¡©s_¬’as_i_hchunks_j_nm®loc
)

184 
	$CTL_PROTO
(
¡©s_¬’as_i_hchunks_j_nd®loc
)

185 
	$CTL_PROTO
(
¡©s_¬’as_i_hchunks_j_Äeque¡s
)

186 
	$CTL_PROTO
(
¡©s_¬’as_i_hchunks_j_curhchunks
)

187 
	$INDEX_PROTO
(
¡©s_¬’as_i_hchunks_j
)

188 
	$CTL_PROTO
(
¡©s_¬’as_i_Áh»ads
)

189 
	$CTL_PROTO
(
¡©s_¬’as_i_dss
)

190 
	$CTL_PROTO
(
¡©s_¬’as_i_lg_dœty_muÉ
)

191 
	$CTL_PROTO
(
¡©s_¬’as_i_deÿy_time
)

192 
	$CTL_PROTO
(
¡©s_¬’as_i_·ùive
)

193 
	$CTL_PROTO
(
¡©s_¬’as_i_pdœty
)

194 
	$CTL_PROTO
(
¡©s_¬’as_i_m­³d
)

195 
	$CTL_PROTO
(
¡©s_¬’as_i_»šed
)

196 
	$CTL_PROTO
(
¡©s_¬’as_i_Åurge
)

197 
	$CTL_PROTO
(
¡©s_¬’as_i_nmadvi£
)

198 
	$CTL_PROTO
(
¡©s_¬’as_i_purged
)

199 
	$CTL_PROTO
(
¡©s_¬’as_i_m‘ad©a_m­³d
)

200 
	$CTL_PROTO
(
¡©s_¬’as_i_m‘ad©a_®loÿ‹d
)

201 
	$INDEX_PROTO
(
¡©s_¬’as_i
)

202 
	$CTL_PROTO
(
¡©s_ÿùive
)

203 
	$CTL_PROTO
(
¡©s_®loÿ‹d
)

204 
	$CTL_PROTO
(
¡©s_aùive
)

205 
	$CTL_PROTO
(
¡©s_m‘ad©a
)

206 
	$CTL_PROTO
(
¡©s_»sid’t
)

207 
	$CTL_PROTO
(
¡©s_m­³d
)

208 
	$CTL_PROTO
(
¡©s_»šed
)

214 
	#CTL_MAX_DEPTH
 6

	)

216 
	#NAME
(
n
è{
Œue
},‚

217 
	#CHILD
(
t
, 
c
) \

218 (
c
##
_node
è/ (
ùl_
##
t
##
_node_t
), \

219 (
ùl_node_t
 *)
c
##
_node
, \

220 
NULL


	)

221 
	#CTL
(
c
è0, 
NULL
, c##
_ùl


	)

227 
	#INDEX
(
i
è{
çl£
}, i##
_šdex


	)

229 cÚ¡ 
ùl_Çmed_node_t
 
	gth»ad_tÿche_node
[] = {

230 {
NAME
("’abËd"), 
CTL
(
th»ad_tÿche_’abËd
)},

231 {
NAME
("æush"), 
CTL
(
th»ad_tÿche_æush
)}

234 cÚ¡ 
ùl_Çmed_node_t
 
	gth»ad_´of_node
[] = {

235 {
NAME
("Çme"), 
CTL
(
th»ad_´of_Çme
)},

236 {
NAME
("aùive"), 
CTL
(
th»ad_´of_aùive
)}

239 cÚ¡ 
ùl_Çmed_node_t
 
	gth»ad_node
[] = {

240 {
NAME
("¬’a"), 
CTL
(
th»ad_¬’a
)},

241 {
NAME
("®loÿ‹d"), 
CTL
(
th»ad_®loÿ‹d
)},

242 {
NAME
("®loÿ‹dp"), 
CTL
(
th»ad_®loÿ‹dp
)},

243 {
NAME
("d—Îoÿ‹d"), 
CTL
(
th»ad_d—Îoÿ‹d
)},

244 {
NAME
("d—Îoÿ‹dp"), 
CTL
(
th»ad_d—Îoÿ‹dp
)},

245 {
NAME
("tÿche"), 
CHILD
(
Çmed
, 
th»ad_tÿche
)},

246 {
NAME
("´of"), 
CHILD
(
Çmed
, 
th»ad_´of
)}

249 cÚ¡ 
ùl_Çmed_node_t
 
	gcÚfig_node
[] = {

250 {
NAME
("ÿche_oblivious"), 
CTL
(
cÚfig_ÿche_oblivious
)},

251 {
NAME
("debug"), 
CTL
(
cÚfig_debug
)},

252 {
NAME
("fl"), 
CTL
(
cÚfig_fl
)},

253 {
NAME
("Ïzy_lock"), 
CTL
(
cÚfig_Ïzy_lock
)},

254 {
NAME
("m®loc_cÚf"), 
CTL
(
cÚfig_m®loc_cÚf
)},

255 {
NAME
("munm­"), 
CTL
(
cÚfig_munm­
)},

256 {
NAME
("´of"), 
CTL
(
cÚfig_´of
)},

257 {
NAME
("´of_libgcc"), 
CTL
(
cÚfig_´of_libgcc
)},

258 {
NAME
("´of_libunwšd"), 
CTL
(
cÚfig_´of_libunwšd
)},

259 {
NAME
("¡©s"), 
CTL
(
cÚfig_¡©s
)},

260 {
NAME
("tÿche"), 
CTL
(
cÚfig_tÿche
)},

261 {
NAME
("s"), 
CTL
(
cÚfig_s
)},

262 {
NAME
("uŒaû"), 
CTL
(
cÚfig_uŒaû
)},

263 {
NAME
("v®gršd"), 
CTL
(
cÚfig_v®gršd
)},

264 {
NAME
("xm®loc"), 
CTL
(
cÚfig_xm®loc
)}

267 cÚ¡ 
ùl_Çmed_node_t
 
	gİt_node
[] = {

268 {
NAME
("abÜt"), 
CTL
(
İt_abÜt
)},

269 {
NAME
("dss"), 
CTL
(
İt_dss
)},

270 {
NAME
("lg_chunk"), 
CTL
(
İt_lg_chunk
)},

271 {
NAME
("Ç»Çs"), 
CTL
(
İt_Ç»Çs
)},

272 {
NAME
("purge"), 
CTL
(
İt_purge
)},

273 {
NAME
("lg_dœty_muÉ"), 
CTL
(
İt_lg_dœty_muÉ
)},

274 {
NAME
("deÿy_time"), 
CTL
(
İt_deÿy_time
)},

275 {
NAME
("¡©s_´št"), 
CTL
(
İt_¡©s_´št
)},

276 {
NAME
("junk"), 
CTL
(
İt_junk
)},

277 {
NAME
("z”o"), 
CTL
(
İt_z”o
)},

278 {
NAME
("qu¬ªtše"), 
CTL
(
İt_qu¬ªtše
)},

279 {
NAME
("»dzÚe"), 
CTL
(
İt_»dzÚe
)},

280 {
NAME
("uŒaû"), 
CTL
(
İt_uŒaû
)},

281 {
NAME
("xm®loc"), 
CTL
(
İt_xm®loc
)},

282 {
NAME
("tÿche"), 
CTL
(
İt_tÿche
)},

283 {
NAME
("lg_tÿche_max"), 
CTL
(
İt_lg_tÿche_max
)},

284 {
NAME
("´of"), 
CTL
(
İt_´of
)},

285 {
NAME
("´of_´efix"), 
CTL
(
İt_´of_´efix
)},

286 {
NAME
("´of_aùive"), 
CTL
(
İt_´of_aùive
)},

287 {
NAME
("´of_th»ad_aùive_š™"), 
CTL
(
İt_´of_th»ad_aùive_š™
)},

288 {
NAME
("lg_´of_§m¶e"), 
CTL
(
İt_lg_´of_§m¶e
)},

289 {
NAME
("lg_´of_š‹rv®"), 
CTL
(
İt_lg_´of_š‹rv®
)},

290 {
NAME
("´of_gdump"), 
CTL
(
İt_´of_gdump
)},

291 {
NAME
("´of_fš®"), 
CTL
(
İt_´of_fš®
)},

292 {
NAME
("´of_Ëak"), 
CTL
(
İt_´of_Ëak
)},

293 {
NAME
("´of_accum"), 
CTL
(
İt_´of_accum
)}

296 cÚ¡ 
ùl_Çmed_node_t
 
	gtÿche_node
[] = {

297 {
NAME
("ü—‹"), 
CTL
(
tÿche_ü—‹
)},

298 {
NAME
("æush"), 
CTL
(
tÿche_æush
)},

299 {
NAME
("de¡roy"), 
CTL
(
tÿche_de¡roy
)}

302 cÚ¡ 
ùl_Çmed_node_t
 
	g¬’a_i_node
[] = {

303 {
NAME
("purge"), 
CTL
(
¬’a_i_purge
)},

304 {
NAME
("deÿy"), 
CTL
(
¬’a_i_deÿy
)},

305 {
NAME
("»£t"), 
CTL
(
¬’a_i_»£t
)},

306 {
NAME
("dss"), 
CTL
(
¬’a_i_dss
)},

307 {
NAME
("lg_dœty_muÉ"), 
CTL
(
¬’a_i_lg_dœty_muÉ
)},

308 {
NAME
("deÿy_time"), 
CTL
(
¬’a_i_deÿy_time
)},

309 {
NAME
("chunk_hooks"), 
CTL
(
¬’a_i_chunk_hooks
)}

311 cÚ¡ 
ùl_Çmed_node_t
 
	gsu³r_¬’a_i_node
[] = {

312 {
NAME
(""), 
CHILD
(
Çmed
, 
¬’a_i
)}

315 cÚ¡ 
ùl_šdexed_node_t
 
	g¬’a_node
[] = {

316 {
INDEX
(
¬’a_i
)}

319 cÚ¡ 
ùl_Çmed_node_t
 
	g¬’as_bš_i_node
[] = {

320 {
NAME
("size"), 
CTL
(
¬’as_bš_i_size
)},

321 {
NAME
("Äegs"), 
CTL
(
¬’as_bš_i_Äegs
)},

322 {
NAME
("run_size"), 
CTL
(
¬’as_bš_i_run_size
)}

324 cÚ¡ 
ùl_Çmed_node_t
 
	gsu³r_¬’as_bš_i_node
[] = {

325 {
NAME
(""), 
CHILD
(
Çmed
, 
¬’as_bš_i
)}

328 cÚ¡ 
ùl_šdexed_node_t
 
	g¬’as_bš_node
[] = {

329 {
INDEX
(
¬’as_bš_i
)}

332 cÚ¡ 
ùl_Çmed_node_t
 
	g¬’as_Ìun_i_node
[] = {

333 {
NAME
("size"), 
CTL
(
¬’as_Ìun_i_size
)}

335 cÚ¡ 
ùl_Çmed_node_t
 
	gsu³r_¬’as_Ìun_i_node
[] = {

336 {
NAME
(""), 
CHILD
(
Çmed
, 
¬’as_Ìun_i
)}

339 cÚ¡ 
ùl_šdexed_node_t
 
	g¬’as_Ìun_node
[] = {

340 {
INDEX
(
¬’as_Ìun_i
)}

343 cÚ¡ 
ùl_Çmed_node_t
 
	g¬’as_hchunk_i_node
[] = {

344 {
NAME
("size"), 
CTL
(
¬’as_hchunk_i_size
)}

346 cÚ¡ 
ùl_Çmed_node_t
 
	gsu³r_¬’as_hchunk_i_node
[] = {

347 {
NAME
(""), 
CHILD
(
Çmed
, 
¬’as_hchunk_i
)}

350 cÚ¡ 
ùl_šdexed_node_t
 
	g¬’as_hchunk_node
[] = {

351 {
INDEX
(
¬’as_hchunk_i
)}

354 cÚ¡ 
ùl_Çmed_node_t
 
	g¬’as_node
[] = {

355 {
NAME
("Ç»Çs"), 
CTL
(
¬’as_Ç»Çs
)},

356 {
NAME
("š™Ÿlized"), 
CTL
(
¬’as_š™Ÿlized
)},

357 {
NAME
("lg_dœty_muÉ"), 
CTL
(
¬’as_lg_dœty_muÉ
)},

358 {
NAME
("deÿy_time"), 
CTL
(
¬’as_deÿy_time
)},

359 {
NAME
("quªtum"), 
CTL
(
¬’as_quªtum
)},

360 {
NAME
("·ge"), 
CTL
(
¬’as_·ge
)},

361 {
NAME
("tÿche_max"), 
CTL
(
¬’as_tÿche_max
)},

362 {
NAME
("nbšs"), 
CTL
(
¬’as_nbšs
)},

363 {
NAME
("nhbšs"), 
CTL
(
¬’as_nhbšs
)},

364 {
NAME
("bš"), 
CHILD
(
šdexed
, 
¬’as_bš
)},

365 {
NAME
("Æruns"), 
CTL
(
¬’as_Æruns
)},

366 {
NAME
("Ìun"), 
CHILD
(
šdexed
, 
¬’as_Ìun
)},

367 {
NAME
("nhchunks"), 
CTL
(
¬’as_nhchunks
)},

368 {
NAME
("hchunk"), 
CHILD
(
šdexed
, 
¬’as_hchunk
)},

369 {
NAME
("ex‹nd"), 
CTL
(
¬’as_ex‹nd
)}

372 cÚ¡ 
ùl_Çmed_node_t
 
	g´of_node
[] = {

373 {
NAME
("th»ad_aùive_š™"), 
CTL
(
´of_th»ad_aùive_š™
)},

374 {
NAME
("aùive"), 
CTL
(
´of_aùive
)},

375 {
NAME
("dump"), 
CTL
(
´of_dump
)},

376 {
NAME
("gdump"), 
CTL
(
´of_gdump
)},

377 {
NAME
("»£t"), 
CTL
(
´of_»£t
)},

378 {
NAME
("š‹rv®"), 
CTL
(
´of_š‹rv®
)},

379 {
NAME
("lg_§m¶e"), 
CTL
(
lg_´of_§m¶e
)}

382 cÚ¡ 
ùl_Çmed_node_t
 
	g¡©s_¬’as_i_m‘ad©a_node
[] = {

383 {
NAME
("m­³d"), 
CTL
(
¡©s_¬’as_i_m‘ad©a_m­³d
)},

384 {
NAME
("®loÿ‹d"), 
CTL
(
¡©s_¬’as_i_m‘ad©a_®loÿ‹d
)}

387 cÚ¡ 
ùl_Çmed_node_t
 
	g¡©s_¬’as_i_sm®l_node
[] = {

388 {
NAME
("®loÿ‹d"), 
CTL
(
¡©s_¬’as_i_sm®l_®loÿ‹d
)},

389 {
NAME
("nm®loc"), 
CTL
(
¡©s_¬’as_i_sm®l_nm®loc
)},

390 {
NAME
("nd®loc"), 
CTL
(
¡©s_¬’as_i_sm®l_nd®loc
)},

391 {
NAME
("Äeque¡s"), 
CTL
(
¡©s_¬’as_i_sm®l_Äeque¡s
)}

394 cÚ¡ 
ùl_Çmed_node_t
 
	g¡©s_¬’as_i_Ïrge_node
[] = {

395 {
NAME
("®loÿ‹d"), 
CTL
(
¡©s_¬’as_i_Ïrge_®loÿ‹d
)},

396 {
NAME
("nm®loc"), 
CTL
(
¡©s_¬’as_i_Ïrge_nm®loc
)},

397 {
NAME
("nd®loc"), 
CTL
(
¡©s_¬’as_i_Ïrge_nd®loc
)},

398 {
NAME
("Äeque¡s"), 
CTL
(
¡©s_¬’as_i_Ïrge_Äeque¡s
)}

401 cÚ¡ 
ùl_Çmed_node_t
 
	g¡©s_¬’as_i_huge_node
[] = {

402 {
NAME
("®loÿ‹d"), 
CTL
(
¡©s_¬’as_i_huge_®loÿ‹d
)},

403 {
NAME
("nm®loc"), 
CTL
(
¡©s_¬’as_i_huge_nm®loc
)},

404 {
NAME
("nd®loc"), 
CTL
(
¡©s_¬’as_i_huge_nd®loc
)},

405 {
NAME
("Äeque¡s"), 
CTL
(
¡©s_¬’as_i_huge_Äeque¡s
)}

408 cÚ¡ 
ùl_Çmed_node_t
 
	g¡©s_¬’as_i_bšs_j_node
[] = {

409 {
NAME
("nm®loc"), 
CTL
(
¡©s_¬’as_i_bšs_j_nm®loc
)},

410 {
NAME
("nd®loc"), 
CTL
(
¡©s_¬’as_i_bšs_j_nd®loc
)},

411 {
NAME
("Äeque¡s"), 
CTL
(
¡©s_¬’as_i_bšs_j_Äeque¡s
)},

412 {
NAME
("cu¼egs"), 
CTL
(
¡©s_¬’as_i_bšs_j_cu¼egs
)},

413 {
NAME
("nfls"), 
CTL
(
¡©s_¬’as_i_bšs_j_nfls
)},

414 {
NAME
("næushes"), 
CTL
(
¡©s_¬’as_i_bšs_j_næushes
)},

415 {
NAME
("Äuns"), 
CTL
(
¡©s_¬’as_i_bšs_j_Äuns
)},

416 {
NAME
("Ä”uns"), 
CTL
(
¡©s_¬’as_i_bšs_j_Ä”uns
)},

417 {
NAME
("cu¼uns"), 
CTL
(
¡©s_¬’as_i_bšs_j_cu¼uns
)}

419 cÚ¡ 
ùl_Çmed_node_t
 
	gsu³r_¡©s_¬’as_i_bšs_j_node
[] = {

420 {
NAME
(""), 
CHILD
(
Çmed
, 
¡©s_¬’as_i_bšs_j
)}

423 cÚ¡ 
ùl_šdexed_node_t
 
	g¡©s_¬’as_i_bšs_node
[] = {

424 {
INDEX
(
¡©s_¬’as_i_bšs_j
)}

427 cÚ¡ 
ùl_Çmed_node_t
 
	g¡©s_¬’as_i_Ìuns_j_node
[] = {

428 {
NAME
("nm®loc"), 
CTL
(
¡©s_¬’as_i_Ìuns_j_nm®loc
)},

429 {
NAME
("nd®loc"), 
CTL
(
¡©s_¬’as_i_Ìuns_j_nd®loc
)},

430 {
NAME
("Äeque¡s"), 
CTL
(
¡©s_¬’as_i_Ìuns_j_Äeque¡s
)},

431 {
NAME
("cu¼uns"), 
CTL
(
¡©s_¬’as_i_Ìuns_j_cu¼uns
)}

433 cÚ¡ 
ùl_Çmed_node_t
 
	gsu³r_¡©s_¬’as_i_Ìuns_j_node
[] = {

434 {
NAME
(""), 
CHILD
(
Çmed
, 
¡©s_¬’as_i_Ìuns_j
)}

437 cÚ¡ 
ùl_šdexed_node_t
 
	g¡©s_¬’as_i_Ìuns_node
[] = {

438 {
INDEX
(
¡©s_¬’as_i_Ìuns_j
)}

441 cÚ¡ 
ùl_Çmed_node_t
 
	g¡©s_¬’as_i_hchunks_j_node
[] = {

442 {
NAME
("nm®loc"), 
CTL
(
¡©s_¬’as_i_hchunks_j_nm®loc
)},

443 {
NAME
("nd®loc"), 
CTL
(
¡©s_¬’as_i_hchunks_j_nd®loc
)},

444 {
NAME
("Äeque¡s"), 
CTL
(
¡©s_¬’as_i_hchunks_j_Äeque¡s
)},

445 {
NAME
("curhchunks"), 
CTL
(
¡©s_¬’as_i_hchunks_j_curhchunks
)}

447 cÚ¡ 
ùl_Çmed_node_t
 
	gsu³r_¡©s_¬’as_i_hchunks_j_node
[] = {

448 {
NAME
(""), 
CHILD
(
Çmed
, 
¡©s_¬’as_i_hchunks_j
)}

451 cÚ¡ 
ùl_šdexed_node_t
 
	g¡©s_¬’as_i_hchunks_node
[] = {

452 {
INDEX
(
¡©s_¬’as_i_hchunks_j
)}

455 cÚ¡ 
ùl_Çmed_node_t
 
	g¡©s_¬’as_i_node
[] = {

456 {
NAME
("Áh»ads"), 
CTL
(
¡©s_¬’as_i_Áh»ads
)},

457 {
NAME
("dss"), 
CTL
(
¡©s_¬’as_i_dss
)},

458 {
NAME
("lg_dœty_muÉ"), 
CTL
(
¡©s_¬’as_i_lg_dœty_muÉ
)},

459 {
NAME
("deÿy_time"), 
CTL
(
¡©s_¬’as_i_deÿy_time
)},

460 {
NAME
("·ùive"), 
CTL
(
¡©s_¬’as_i_·ùive
)},

461 {
NAME
("pdœty"), 
CTL
(
¡©s_¬’as_i_pdœty
)},

462 {
NAME
("m­³d"), 
CTL
(
¡©s_¬’as_i_m­³d
)},

463 {
NAME
("»šed"), 
CTL
(
¡©s_¬’as_i_»šed
)},

464 {
NAME
("Åurge"), 
CTL
(
¡©s_¬’as_i_Åurge
)},

465 {
NAME
("nmadvi£"), 
CTL
(
¡©s_¬’as_i_nmadvi£
)},

466 {
NAME
("purged"), 
CTL
(
¡©s_¬’as_i_purged
)},

467 {
NAME
("m‘ad©a"), 
CHILD
(
Çmed
, 
¡©s_¬’as_i_m‘ad©a
)},

468 {
NAME
("sm®l"), 
CHILD
(
Çmed
, 
¡©s_¬’as_i_sm®l
)},

469 {
NAME
("Ïrge"), 
CHILD
(
Çmed
, 
¡©s_¬’as_i_Ïrge
)},

470 {
NAME
("huge"), 
CHILD
(
Çmed
, 
¡©s_¬’as_i_huge
)},

471 {
NAME
("bšs"), 
CHILD
(
šdexed
, 
¡©s_¬’as_i_bšs
)},

472 {
NAME
("Ìuns"), 
CHILD
(
šdexed
, 
¡©s_¬’as_i_Ìuns
)},

473 {
NAME
("hchunks"), 
CHILD
(
šdexed
, 
¡©s_¬’as_i_hchunks
)}

475 cÚ¡ 
ùl_Çmed_node_t
 
	gsu³r_¡©s_¬’as_i_node
[] = {

476 {
NAME
(""), 
CHILD
(
Çmed
, 
¡©s_¬’as_i
)}

479 cÚ¡ 
ùl_šdexed_node_t
 
	g¡©s_¬’as_node
[] = {

480 {
INDEX
(
¡©s_¬’as_i
)}

483 cÚ¡ 
ùl_Çmed_node_t
 
	g¡©s_node
[] = {

484 {
NAME
("ÿùive"), 
CTL
(
¡©s_ÿùive
)},

485 {
NAME
("®loÿ‹d"), 
CTL
(
¡©s_®loÿ‹d
)},

486 {
NAME
("aùive"), 
CTL
(
¡©s_aùive
)},

487 {
NAME
("m‘ad©a"), 
CTL
(
¡©s_m‘ad©a
)},

488 {
NAME
("»sid’t"), 
CTL
(
¡©s_»sid’t
)},

489 {
NAME
("m­³d"), 
CTL
(
¡©s_m­³d
)},

490 {
NAME
("»šed"), 
CTL
(
¡©s_»šed
)},

491 {
NAME
("¬’as"), 
CHILD
(
šdexed
, 
¡©s_¬’as
)}

494 cÚ¡ 
ùl_Çmed_node_t
 
	groÙ_node
[] = {

495 {
NAME
("v”siÚ"), 
CTL
(
v”siÚ
)},

496 {
NAME
("•och"), 
CTL
(
•och
)},

497 {
NAME
("th»ad"), 
CHILD
(
Çmed
, 
th»ad
)},

498 {
NAME
("cÚfig"), 
CHILD
(
Çmed
, 
cÚfig
)},

499 {
NAME
("İt"), 
CHILD
(
Çmed
, 
İt
)},

500 {
NAME
("tÿche"), 
CHILD
(
Çmed
, 
tÿche
)},

501 {
NAME
("¬’a"), 
CHILD
(
šdexed
, 
¬’a
)},

502 {
NAME
("¬’as"), 
CHILD
(
Çmed
, 
¬’as
)},

503 {
NAME
("´of"), 
CHILD
(
Çmed
, 
´of
)},

504 {
NAME
("¡©s"), 
CHILD
(
Çmed
, 
¡©s
)}

506 cÚ¡ 
ùl_Çmed_node_t
 
	gsu³r_roÙ_node
[] = {

507 {
NAME
(""), 
CHILD
(
Çmed
, 
roÙ
)}

510 #undeà
NAME


511 #undeà
CHILD


512 #undeà
CTL


513 #undeà
INDEX


517 
boŞ


518 
	$ùl_¬’a_š™
(
ùl_¬’a_¡©s_t
 *
a¡©s
)

521 ià(
a¡©s
->
l¡©s
 =ğ
NULL
) {

522 
a¡©s
->
l¡©s
 = (
m®loc_Ïrge_¡©s_t
 *)
	`a0m®loc
(
Æşas£s
 *

523 (
m®loc_Ïrge_¡©s_t
));

524 ià(
a¡©s
->
l¡©s
 =ğ
NULL
)

525  (
Œue
);

528 ià(
a¡©s
->
h¡©s
 =ğ
NULL
) {

529 
a¡©s
->
h¡©s
 = (
m®loc_huge_¡©s_t
 *)
	`a0m®loc
(
nhşas£s
 *

530 (
m®loc_huge_¡©s_t
));

531 ià(
a¡©s
->
h¡©s
 =ğ
NULL
)

532  (
Œue
);

535  (
çl£
);

536 
	}
}

539 
	$ùl_¬’a_ş—r
(
ùl_¬’a_¡©s_t
 *
a¡©s
)

542 
a¡©s
->
Áh»ads
 = 0;

543 
a¡©s
->
dss
 = 
dss_´ec_Çmes
[
dss_´ec_lim™
];

544 
a¡©s
->
lg_dœty_muÉ
 = -1;

545 
a¡©s
->
deÿy_time
 = -1;

546 
a¡©s
->
·ùive
 = 0;

547 
a¡©s
->
pdœty
 = 0;

548 ià(
cÚfig_¡©s
) {

549 
	`mem£t
(&
a¡©s
->a¡©s, 0, (
¬’a_¡©s_t
));

550 
a¡©s
->
®loÿ‹d_sm®l
 = 0;

551 
a¡©s
->
nm®loc_sm®l
 = 0;

552 
a¡©s
->
nd®loc_sm®l
 = 0;

553 
a¡©s
->
Äeque¡s_sm®l
 = 0;

554 
	`mem£t
(
a¡©s
->
b¡©s
, 0, 
NBINS
 * (
m®loc_bš_¡©s_t
));

555 
	`mem£t
(
a¡©s
->
l¡©s
, 0, 
Æşas£s
 *

556 (
m®loc_Ïrge_¡©s_t
));

557 
	`mem£t
(
a¡©s
->
h¡©s
, 0, 
nhşas£s
 *

558 (
m®loc_huge_¡©s_t
));

560 
	}
}

563 
	$ùl_¬’a_¡©s_am”ge
(
tsdn_t
 *
tsdn
, 
ùl_¬’a_¡©s_t
 *
c¡©s
, 
¬’a_t
 *
¬’a
)

565 
i
;

567 ià(
cÚfig_¡©s
) {

568 
	`¬’a_¡©s_m”ge
(
tsdn
, 
¬’a
, &
c¡©s
->
Áh»ads
, &c¡©s->
dss
,

569 &
c¡©s
->
lg_dœty_muÉ
, &c¡©s->
deÿy_time
,

570 &
c¡©s
->
·ùive
, &c¡©s->
pdœty
, &c¡©s->
a¡©s
,

571 
c¡©s
->
b¡©s
, c¡©s->
l¡©s
, c¡©s->
h¡©s
);

573 
i
 = 0; i < 
NBINS
; i++) {

574 
c¡©s
->
®loÿ‹d_sm®l
 +ğc¡©s->
b¡©s
[
i
].
cu¼egs
 *

575 
	`šdex2size
(
i
);

576 
c¡©s
->
nm®loc_sm®l
 +ğc¡©s->
b¡©s
[
i
].
nm®loc
;

577 
c¡©s
->
nd®loc_sm®l
 +ğc¡©s->
b¡©s
[
i
].
nd®loc
;

578 
c¡©s
->
Äeque¡s_sm®l
 +ğc¡©s->
b¡©s
[
i
].
Äeque¡s
;

581 
	`¬’a_basic_¡©s_m”ge
(
tsdn
, 
¬’a
, &
c¡©s
->
Áh»ads
,

582 &
c¡©s
->
dss
, &c¡©s->
lg_dœty_muÉ
, &c¡©s->
deÿy_time
,

583 &
c¡©s
->
·ùive
, &c¡©s->
pdœty
);

585 
	}
}

588 
	$ùl_¬’a_¡©s_sm”ge
(
ùl_¬’a_¡©s_t
 *
s¡©s
, c_¬’a_¡©s_ˆ*
a¡©s
)

590 
i
;

592 
s¡©s
->
Áh»ads
 +ğ
a¡©s
->nthreads;

593 
s¡©s
->
·ùive
 +ğ
a¡©s
->pactive;

594 
s¡©s
->
pdœty
 +ğ
a¡©s
->pdirty;

596 ià(
cÚfig_¡©s
) {

597 
s¡©s
->
a¡©s
.
m­³d
 +=‡stats->astats.mapped;

598 
s¡©s
->
a¡©s
.
»šed
 +=‡stats->astats.retained;

599 
s¡©s
->
a¡©s
.
Åurge
 +=‡stats->astats.npurge;

600 
s¡©s
->
a¡©s
.
nmadvi£
 +=‡stats->astats.nmadvise;

601 
s¡©s
->
a¡©s
.
purged
 +=‡stats->astats.purged;

603 
s¡©s
->
a¡©s
.
m‘ad©a_m­³d
 +=

604 
a¡©s
->a¡©s.
m‘ad©a_m­³d
;

605 
s¡©s
->
a¡©s
.
m‘ad©a_®loÿ‹d
 +=

606 
a¡©s
->a¡©s.
m‘ad©a_®loÿ‹d
;

608 
s¡©s
->
®loÿ‹d_sm®l
 +ğ
a¡©s
->allocated_small;

609 
s¡©s
->
nm®loc_sm®l
 +ğ
a¡©s
->nmalloc_small;

610 
s¡©s
->
nd®loc_sm®l
 +ğ
a¡©s
->ndalloc_small;

611 
s¡©s
->
Äeque¡s_sm®l
 +ğ
a¡©s
->nrequests_small;

613 
s¡©s
->
a¡©s
.
®loÿ‹d_Ïrge
 +=

614 
a¡©s
->a¡©s.
®loÿ‹d_Ïrge
;

615 
s¡©s
->
a¡©s
.
nm®loc_Ïrge
 +=‡stats->astats.nmalloc_large;

616 
s¡©s
->
a¡©s
.
nd®loc_Ïrge
 +=‡stats->astats.ndalloc_large;

617 
s¡©s
->
a¡©s
.
Äeque¡s_Ïrge
 +=

618 
a¡©s
->a¡©s.
Äeque¡s_Ïrge
;

620 
s¡©s
->
a¡©s
.
®loÿ‹d_huge
 +=‡stats->astats.allocated_huge;

621 
s¡©s
->
a¡©s
.
nm®loc_huge
 +=‡stats->astats.nmalloc_huge;

622 
s¡©s
->
a¡©s
.
nd®loc_huge
 +=‡stats->astats.ndalloc_huge;

624 
i
 = 0; i < 
NBINS
; i++) {

625 
s¡©s
->
b¡©s
[
i
].
nm®loc
 +ğ
a¡©s
->bstats[i].nmalloc;

626 
s¡©s
->
b¡©s
[
i
].
nd®loc
 +ğ
a¡©s
->bstats[i].ndalloc;

627 
s¡©s
->
b¡©s
[
i
].
Äeque¡s
 +=

628 
a¡©s
->
b¡©s
[
i
].
Äeque¡s
;

629 
s¡©s
->
b¡©s
[
i
].
cu¼egs
 +ğ
a¡©s
->bstats[i].curregs;

630 ià(
cÚfig_tÿche
) {

631 
s¡©s
->
b¡©s
[
i
].
nfls
 +=

632 
a¡©s
->
b¡©s
[
i
].
nfls
;

633 
s¡©s
->
b¡©s
[
i
].
næushes
 +=

634 
a¡©s
->
b¡©s
[
i
].
næushes
;

636 
s¡©s
->
b¡©s
[
i
].
Äuns
 +ğ
a¡©s
->bstats[i].nruns;

637 
s¡©s
->
b¡©s
[
i
].
»runs
 +ğ
a¡©s
->bstats[i].reruns;

638 
s¡©s
->
b¡©s
[
i
].
cu¼uns
 +ğ
a¡©s
->bstats[i].curruns;

641 
i
 = 0; i < 
Æşas£s
; i++) {

642 
s¡©s
->
l¡©s
[
i
].
nm®loc
 +ğ
a¡©s
->lstats[i].nmalloc;

643 
s¡©s
->
l¡©s
[
i
].
nd®loc
 +ğ
a¡©s
->lstats[i].ndalloc;

644 
s¡©s
->
l¡©s
[
i
].
Äeque¡s
 +=

645 
a¡©s
->
l¡©s
[
i
].
Äeque¡s
;

646 
s¡©s
->
l¡©s
[
i
].
cu¼uns
 +ğ
a¡©s
->lstats[i].curruns;

649 
i
 = 0; i < 
nhşas£s
; i++) {

650 
s¡©s
->
h¡©s
[
i
].
nm®loc
 +ğ
a¡©s
->hstats[i].nmalloc;

651 
s¡©s
->
h¡©s
[
i
].
nd®loc
 +ğ
a¡©s
->hstats[i].ndalloc;

652 
s¡©s
->
h¡©s
[
i
].
curhchunks
 +=

653 
a¡©s
->
h¡©s
[
i
].
curhchunks
;

656 
	}
}

659 
	$ùl_¬’a_»äesh
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
i
)

661 
ùl_¬’a_¡©s_t
 *
a¡©s
 = &
ùl_¡©s
.
¬’as
[
i
];

662 
ùl_¬’a_¡©s_t
 *
s¡©s
 = &
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
];

664 
	`ùl_¬’a_ş—r
(
a¡©s
);

665 
	`ùl_¬’a_¡©s_am”ge
(
tsdn
, 
a¡©s
, 
¬’a
);

667 
	`ùl_¬’a_¡©s_sm”ge
(
s¡©s
, 
a¡©s
);

668 
	}
}

670 
boŞ


671 
	$ùl_grow
(
tsdn_t
 *
tsdn
)

673 
ùl_¬’a_¡©s_t
 *
a¡©s
;

676 ià(
	`¬’a_š™
(
tsdn
, 
ùl_¡©s
.
Ç»Çs
è=ğ
NULL
)

677  (
Œue
);

680 
a¡©s
 = (
ùl_¬’a_¡©s_t
 *)
	`a0m®loc
((
ùl_¡©s
.
Ç»Çs
 + 2) *

681 (
ùl_¬’a_¡©s_t
));

682 ià(
a¡©s
 =ğ
NULL
)

683  (
Œue
);

686 
	`memıy
(
a¡©s
, 
ùl_¡©s
.
¬’as
, (ùl_¡©s.
Ç»Çs
 + 1) *

687 (
ùl_¬’a_¡©s_t
));

688 
	`mem£t
(&
a¡©s
[
ùl_¡©s
.
Ç»Çs
 + 1], 0, (
ùl_¬’a_¡©s_t
));

689 ià(
	`ùl_¬’a_š™
(&
a¡©s
[
ùl_¡©s
.
Ç»Çs
 + 1])) {

690 
	`a0d®loc
(
a¡©s
);

691  (
Œue
);

695 
ùl_¬’a_¡©s_t
 
t¡©s
;

696 
	`memıy
(&
t¡©s
, &
a¡©s
[
ùl_¡©s
.
Ç»Çs
],

697 (
ùl_¬’a_¡©s_t
));

698 
	`memıy
(&
a¡©s
[
ùl_¡©s
.
Ç»Çs
],

699 &
a¡©s
[
ùl_¡©s
.
Ç»Çs
 + 1], (
ùl_¬’a_¡©s_t
));

700 
	`memıy
(&
a¡©s
[
ùl_¡©s
.
Ç»Çs
 + 1], &
t¡©s
,

701 (
ùl_¬’a_¡©s_t
));

703 
	`a0d®loc
(
ùl_¡©s
.
¬’as
);

704 
ùl_¡©s
.
¬’as
 = 
a¡©s
;

705 
ùl_¡©s
.
Ç»Çs
++;

707  (
çl£
);

708 
	}
}

711 
	$ùl_»äesh
(
tsdn_t
 *
tsdn
)

713 
i
;

714 
	`VARIABLE_ARRAY
(
¬’a_t
 *, 
»Çs
, 
ùl_¡©s
.
Ç»Çs
);

720 
	`ùl_¬’a_ş—r
(&
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
]);

722 
i
 = 0; i < 
ùl_¡©s
.
Ç»Çs
; i++)

723 
»Çs
[
i
] = 
	`¬’a_g‘
(
tsdn
, i, 
çl£
);

725 
i
 = 0; i < 
ùl_¡©s
.
Ç»Çs
; i++) {

726 
boŞ
 
š™Ÿlized
 = (
»Çs
[
i
] !ğ
NULL
);

728 
ùl_¡©s
.
¬’as
[
i
].
š™Ÿlized
 = initialized;

729 ià(
š™Ÿlized
)

730 
	`ùl_¬’a_»äesh
(
tsdn
, 
»Çs
[
i
], i);

733 ià(
cÚfig_¡©s
) {

734 
size_t
 
ba£_®loÿ‹d
, 
ba£_»sid’t
, 
ba£_m­³d
;

735 
	`ba£_¡©s_g‘
(
tsdn
, &
ba£_®loÿ‹d
, &
ba£_»sid’t
,

736 &
ba£_m­³d
);

737 
ùl_¡©s
.
®loÿ‹d
 =

738 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
®loÿ‹d_sm®l
 +

739 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
a¡©s
.
®loÿ‹d_Ïrge
 +

740 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
a¡©s
.
®loÿ‹d_huge
;

741 
ùl_¡©s
.
aùive
 =

742 (
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
·ùive
 << 
LG_PAGE
);

743 
ùl_¡©s
.
m‘ad©a
 = 
ba£_®loÿ‹d
 +

744 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
a¡©s
.
m‘ad©a_m­³d
 +

745 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
a¡©s


746 .
m‘ad©a_®loÿ‹d
;

747 
ùl_¡©s
.
»sid’t
 = 
ba£_»sid’t
 +

748 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
a¡©s
.
m‘ad©a_m­³d
 +

749 ((
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
·ùive
 +

750 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
pdœty
è<< 
LG_PAGE
);

751 
ùl_¡©s
.
m­³d
 = 
ba£_m­³d
 +

752 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
a¡©s
.
m­³d
;

753 
ùl_¡©s
.
»šed
 =

754 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
a¡©s
.
»šed
;

757 
ùl_•och
++;

758 
	}
}

760 
boŞ


761 
	$ùl_š™
(
tsdn_t
 *
tsdn
)

763 
boŞ
 
»t
;

765 
	`m®loc_mu‹x_lock
(
tsdn
, &
ùl_mtx
);

766 ià(!
ùl_š™Ÿlized
) {

771 
ùl_¡©s
.
Ç»Çs
 = 
	`Ç»Çs_tÙ®_g‘
();

772 
ùl_¡©s
.
¬’as
 = (
ùl_¬’a_¡©s_t
 *)
	`a0m®loc
(

773 (
ùl_¡©s
.
Ç»Çs
 + 1è* (
ùl_¬’a_¡©s_t
));

774 ià(
ùl_¡©s
.
¬’as
 =ğ
NULL
) {

775 
»t
 = 
Œue
;

776 
Ïb–_»tuº
;

778 
	`mem£t
(
ùl_¡©s
.
¬’as
, 0, (ùl_¡©s.
Ç»Çs
 + 1) *

779 (
ùl_¬’a_¡©s_t
));

786 ià(
cÚfig_¡©s
) {

787 
i
;

788 
i
 = 0; i <ğ
ùl_¡©s
.
Ç»Çs
; i++) {

789 ià(
	`ùl_¬’a_š™
(&
ùl_¡©s
.
¬’as
[
i
])) {

790 
j
;

791 
j
 = 0; j < 
i
; j++) {

792 
	`a0d®loc
(

793 
ùl_¡©s
.
¬’as
[
j
].
l¡©s
);

794 
	`a0d®loc
(

795 
ùl_¡©s
.
¬’as
[
j
].
h¡©s
);

797 
	`a0d®loc
(
ùl_¡©s
.
¬’as
);

798 
ùl_¡©s
.
¬’as
 = 
NULL
;

799 
»t
 = 
Œue
;

800 
Ïb–_»tuº
;

804 
ùl_¡©s
.
¬’as
[ùl_¡©s.
Ç»Çs
].
š™Ÿlized
 = 
Œue
;

806 
ùl_•och
 = 0;

807 
	`ùl_»äesh
(
tsdn
);

808 
ùl_š™Ÿlized
 = 
Œue
;

811 
»t
 = 
çl£
;

812 
Ïb–_»tuº
:

813 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
ùl_mtx
);

814  (
»t
);

815 
	}
}

818 
	$ùl_lookup
(
tsdn_t
 *
tsdn
, cÚ¡ *
Çme
, 
ùl_node_t
 cÚ¡ **
node¥
,

819 
size_t
 *
mibp
, size_ˆ*
d•thp
)

821 
»t
;

822 cÚ¡ *
–m
, *
tdÙ
, *
dÙ
;

823 
size_t
 
–’
, 
i
, 
j
;

824 cÚ¡ 
ùl_Çmed_node_t
 *
node
;

826 
–m
 = 
Çme
;

828 
dÙ
 = ((
tdÙ
 = 
	`¡rchr
(
–m
, '.')è!ğ
NULL
) ?dot : strchr(elm, '\0');

829 
–’
 = (
size_t
)((
ušŒ_t
)
dÙ
 - (ušŒ_t)
–m
);

830 ià(
–’
 == 0) {

831 
»t
 = 
ENOENT
;

832 
Ïb–_»tuº
;

834 
node
 = 
su³r_roÙ_node
;

835 
i
 = 0; i < *
d•thp
; i++) {

836 
	`as£¹
(
node
);

837 
	`as£¹
(
node
->
nchd»n
 > 0);

838 ià(
	`ùl_Çmed_node
(
node
->
chd»n
è!ğ
NULL
) {

839 cÚ¡ 
ùl_Çmed_node_t
 *
²ode
 = 
node
;

842 
j
 = 0; j < 
node
->
nchd»n
; j++) {

843 cÚ¡ 
ùl_Çmed_node_t
 *
chd
 =

844 
	`ùl_Çmed_chd»n
(
node
, 
j
);

845 ià(
	`¡¾’
(
chd
->
Çme
è=ğ
–’
 &&

846 
	`¡ºcmp
(
–m
, 
chd
->
Çme
, 
–’
) == 0) {

847 
node
 = 
chd
;

848 ià(
node¥
 !ğ
NULL
)

849 
node¥
[
i
] =

850 (cÚ¡ 
ùl_node_t
 *)
node
;

851 
mibp
[
i
] = 
j
;

855 ià(
node
 =ğ
²ode
) {

856 
»t
 = 
ENOENT
;

857 
Ïb–_»tuº
;

860 
uštmax_t
 
šdex
;

861 cÚ¡ 
ùl_šdexed_node_t
 *
šode
;

864 
šdex
 = 
	`m®loc_¡¹oumax
(
–m
, 
NULL
, 10);

865 ià(
šdex
 =ğ
UINTMAX_MAX
 || index > 
SIZE_T_MAX
) {

866 
»t
 = 
ENOENT
;

867 
Ïb–_»tuº
;

870 
šode
 = 
	`ùl_šdexed_node
(
node
->
chd»n
);

871 
node
 = 
šode
->
	`šdex
(
tsdn
, 
mibp
, *
d•thp
, (
size_t
)
šdex
);

872 ià(
node
 =ğ
NULL
) {

873 
»t
 = 
ENOENT
;

874 
Ïb–_»tuº
;

877 ià(
node¥
 !ğ
NULL
)

878 
node¥
[
i
] = (cÚ¡ 
ùl_node_t
 *)
node
;

879 
mibp
[
i
] = (
size_t
)
šdex
;

882 ià(
node
->
ùl
 !ğ
NULL
) {

884 ià(*
dÙ
 != '\0') {

889 
»t
 = 
ENOENT
;

890 
Ïb–_»tuº
;

893 *
d•thp
 = 
i
 + 1;

898 ià(*
dÙ
 == '\0') {

900 
»t
 = 
ENOENT
;

901 
Ïb–_»tuº
;

903 
–m
 = &
dÙ
[1];

904 
dÙ
 = ((
tdÙ
 = 
	`¡rchr
(
–m
, '.')è!ğ
NULL
) ?dot :

905 
	`¡rchr
(
–m
, '\0');

906 
–’
 = (
size_t
)((
ušŒ_t
)
dÙ
 - (ušŒ_t)
–m
);

909 
»t
 = 0;

910 
Ïb–_»tuº
:

911  (
»t
);

912 
	}
}

915 
	$ùl_byÇme
(
tsd_t
 *
tsd
, cÚ¡ *
Çme
, *
Şdp
, 
size_t
 *
ŞdËÅ
,

916 *
Ãwp
, 
size_t
 
ÃwËn
)

918 
»t
;

919 
size_t
 
d•th
;

920 
ùl_node_t
 cÚ¡ *
nodes
[
CTL_MAX_DEPTH
];

921 
size_t
 
mib
[
CTL_MAX_DEPTH
];

922 cÚ¡ 
ùl_Çmed_node_t
 *
node
;

924 ià(!
ùl_š™Ÿlized
 && 
	`ùl_š™
(
	`tsd_tsdn
(
tsd
))) {

925 
»t
 = 
EAGAIN
;

926 
Ïb–_»tuº
;

929 
d•th
 = 
CTL_MAX_DEPTH
;

930 
»t
 = 
	`ùl_lookup
(
	`tsd_tsdn
(
tsd
), 
Çme
, 
nodes
, 
mib
, &
d•th
);

931 ià(
»t
 != 0)

932 
Ïb–_»tuº
;

934 
node
 = 
	`ùl_Çmed_node
(
nodes
[
d•th
-1]);

935 ià(
node
 !ğ
NULL
 &&‚ode->
ùl
)

936 
»t
 = 
node
->
	`ùl
(
tsd
, 
mib
, 
d•th
, 
Şdp
, 
ŞdËÅ
, 
Ãwp
, 
ÃwËn
);

939 
»t
 = 
ENOENT
;

942 
Ïb–_»tuº
:

943 (
»t
);

944 
	}
}

947 
	$ùl_Çm‘omib
(
tsdn_t
 *
tsdn
, cÚ¡ *
Çme
, 
size_t
 *
mibp
, size_ˆ*
mibËÅ
)

949 
»t
;

951 ià(!
ùl_š™Ÿlized
 && 
	`ùl_š™
(
tsdn
)) {

952 
»t
 = 
EAGAIN
;

953 
Ïb–_»tuº
;

956 
»t
 = 
	`ùl_lookup
(
tsdn
, 
Çme
, 
NULL
, 
mibp
, 
mibËÅ
);

957 
Ïb–_»tuº
:

958 (
»t
);

959 
	}
}

962 
	$ùl_bymib
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

963 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

965 
»t
;

966 cÚ¡ 
ùl_Çmed_node_t
 *
node
;

967 
size_t
 
i
;

969 ià(!
ùl_š™Ÿlized
 && 
	`ùl_š™
(
	`tsd_tsdn
(
tsd
))) {

970 
»t
 = 
EAGAIN
;

971 
Ïb–_»tuº
;

975 
node
 = 
su³r_roÙ_node
;

976 
i
 = 0; i < 
mibËn
; i++) {

977 
	`as£¹
(
node
);

978 
	`as£¹
(
node
->
nchd»n
 > 0);

979 ià(
	`ùl_Çmed_node
(
node
->
chd»n
è!ğ
NULL
) {

981 ià(
node
->
nchd»n
 <ğ()
mib
[
i
]) {

982 
»t
 = 
ENOENT
;

983 
Ïb–_»tuº
;

985 
node
 = 
	`ùl_Çmed_chd»n
Òode, 
mib
[
i
]);

987 cÚ¡ 
ùl_šdexed_node_t
 *
šode
;

990 
šode
 = 
	`ùl_šdexed_node
(
node
->
chd»n
);

991 
node
 = 
šode
->
	`šdex
(
	`tsd_tsdn
(
tsd
), 
mib
, 
mibËn
, mib[
i
]);

992 ià(
node
 =ğ
NULL
) {

993 
»t
 = 
ENOENT
;

994 
Ïb–_»tuº
;

1000 ià(
node
 &&‚ode->
ùl
)

1001 
»t
 = 
node
->
	`ùl
(
tsd
, 
mib
, 
mibËn
, 
Şdp
, 
ŞdËÅ
, 
Ãwp
, 
ÃwËn
);

1004 
»t
 = 
ENOENT
;

1007 
Ïb–_»tuº
:

1008 (
»t
);

1009 
	}
}

1011 
boŞ


1012 
	$ùl_boÙ
()

1015 ià(
	`m®loc_mu‹x_š™
(&
ùl_mtx
, "ùl", 
WITNESS_RANK_CTL
))

1016  (
Œue
);

1018 
ùl_š™Ÿlized
 = 
çl£
;

1020  (
çl£
);

1021 
	}
}

1024 
	$ùl_´efÜk
(
tsdn_t
 *
tsdn
)

1027 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
ùl_mtx
);

1028 
	}
}

1031 
	$ùl_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
)

1034 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
ùl_mtx
);

1035 
	}
}

1038 
	$ùl_po¡fÜk_chd
(
tsdn_t
 *
tsdn
)

1041 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
ùl_mtx
);

1042 
	}
}

1047 
	#READONLY
() do { \

1048 ià(
Ãwp
 !ğ
NULL
 || 
ÃwËn
 != 0) { \

1049 
»t
 = 
EPERM
; \

1050 
Ïb–_»tuº
; \

1052 } 0)

	)

1054 
	#WRITEONLY
() do { \

1055 ià(
Şdp
 !ğ
NULL
 || 
ŞdËÅ
 != NULL) { \

1056 
»t
 = 
EPERM
; \

1057 
Ïb–_»tuº
; \

1059 } 0)

	)

1061 
	#READ_XOR_WRITE
() do { \

1062 ià((
Şdp
 !ğ
NULL
 && 
ŞdËÅ
 !ğNULLè&& (
Ãwp
 != NULL || \

1063 
ÃwËn
 != 0)) { \

1064 
»t
 = 
EPERM
; \

1065 
Ïb–_»tuº
; \

1067 } 0)

	)

1069 
	#READ
(
v
, 
t
) do { \

1070 ià(
Şdp
 !ğ
NULL
 && 
ŞdËÅ
 != NULL) { \

1071 ià(*
ŞdËÅ
 !ğ(
t
)) { \

1072 
size_t
 
cİyËn
 = ((
t
è<ğ*
ŞdËÅ
) \

1073 ? (
t
è: *
ŞdËÅ
; \

1074 
	`memıy
(
Şdp
, (*)&(
v
), 
cİyËn
); \

1075 
»t
 = 
EINVAL
; \

1076 
Ïb–_»tuº
; \

1078 *(
t
 *)
Şdp
 = (
v
); \

1080 } 0)

	)

1082 
	#WRITE
(
v
, 
t
) do { \

1083 ià(
Ãwp
 !ğ
NULL
) { \

1084 ià(
ÃwËn
 !ğ(
t
)) { \

1085 
»t
 = 
EINVAL
; \

1086 
Ïb–_»tuº
; \

1088 (
v
èğ*(
t
 *)
Ãwp
; \

1090 } 0)

	)

1096 
	#CTL_RO_CLGEN
(
c
, 
l
, 
n
, 
v
, 
t
) \

1098 
n
##
	`_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
, \

1099 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
) \

1101 
»t
; \

1102 
t
 
Şdv®
; \

1104 ià(!(
c
)) \

1105  (
ENOENT
); \

1106 ià(
l
) \

1107 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
); \

1108 
	`READONLY
(); \

1109 
Şdv®
 = (
v
); \

1110 
	`READ
(
Şdv®
, 
t
); \

1112 
»t
 = 0; \

1113 
Ïb–_»tuº
: \

1114 ià(
l
) \

1115 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
); \

1116  (
»t
); \

1117 }

	)

1119 
	#CTL_RO_CGEN
(
c
, 
n
, 
v
, 
t
) \

1121 
n
##
	`_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
, \

1122 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
) \

1124 
»t
; \

1125 
t
 
Şdv®
; \

1127 ià(!(
c
)) \

1128  (
ENOENT
); \

1129 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
); \

1130 
	`READONLY
(); \

1131 
Şdv®
 = (
v
); \

1132 
	`READ
(
Şdv®
, 
t
); \

1134 
»t
 = 0; \

1135 
Ïb–_»tuº
: \

1136 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
); \

1137  (
»t
); \

1138 }

	)

1140 
	#CTL_RO_GEN
(
n
, 
v
, 
t
) \

1142 
n
##
	`_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
, \

1143 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
) \

1145 
»t
; \

1146 
t
 
Şdv®
; \

1148 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
); \

1149 
	`READONLY
(); \

1150 
Şdv®
 = (
v
); \

1151 
	`READ
(
Şdv®
, 
t
); \

1153 
»t
 = 0; \

1154 
Ïb–_»tuº
: \

1155 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
); \

1156  (
»t
); \

1157 }

	)

1163 
	#CTL_RO_NL_CGEN
(
c
, 
n
, 
v
, 
t
) \

1165 
n
##
	`_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
, \

1166 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
) \

1168 
»t
; \

1169 
t
 
Şdv®
; \

1171 ià(!(
c
)) \

1172  (
ENOENT
); \

1173 
	`READONLY
(); \

1174 
Şdv®
 = (
v
); \

1175 
	`READ
(
Şdv®
, 
t
); \

1177 
»t
 = 0; \

1178 
Ïb–_»tuº
: \

1179  (
»t
); \

1180 }

	)

1182 
	#CTL_RO_NL_GEN
(
n
, 
v
, 
t
) \

1184 
n
##
	`_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
, \

1185 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
) \

1187 
»t
; \

1188 
t
 
Şdv®
; \

1190 
	`READONLY
(); \

1191 
Şdv®
 = (
v
); \

1192 
	`READ
(
Şdv®
, 
t
); \

1194 
»t
 = 0; \

1195 
Ïb–_»tuº
: \

1196  (
»t
); \

1197 }

	)

1199 
	#CTL_TSD_RO_NL_CGEN
(
c
, 
n
, 
m
, 
t
) \

1201 
n
##
	`_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
, \

1202 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
) \

1204 
»t
; \

1205 
t
 
Şdv®
; \

1207 ià(!(
c
)) \

1208  (
ENOENT
); \

1209 
	`READONLY
(); \

1210 
Şdv®
 = (
	`m
(
tsd
)); \

1211 
	`READ
(
Şdv®
, 
t
); \

1213 
»t
 = 0; \

1214 
Ïb–_»tuº
: \

1215  (
»t
); \

1216 }

	)

1218 
	#CTL_RO_CONFIG_GEN
(
n
, 
t
) \

1220 
n
##
	`_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
, \

1221 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
) \

1223 
»t
; \

1224 
t
 
Şdv®
; \

1226 
	`READONLY
(); \

1227 
Şdv®
 = 
n
; \

1228 
	`READ
(
Şdv®
, 
t
); \

1230 
»t
 = 0; \

1231 
Ïb–_»tuº
: \

1232  (
»t
); \

1233 }

	)

1237 
	$CTL_RO_NL_GEN
(
v”siÚ
, 
JEMALLOC_VERSION
, const *)

1240 
	$•och_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1241 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1243 
»t
;

1244 
UNUSED
 
ušt64_t
 
Ãwv®
;

1246 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1247 
	`WRITE
(
Ãwv®
, 
ušt64_t
);

1248 ià(
Ãwp
 !ğ
NULL
)

1249 
	`ùl_»äesh
(
	`tsd_tsdn
(
tsd
));

1250 
	`READ
(
ùl_•och
, 
ušt64_t
);

1252 
»t
 = 0;

1253 
Ïb–_»tuº
:

1254 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1255  (
»t
);

1256 
	}
}

1260 
	$CTL_RO_CONFIG_GEN
(
cÚfig_ÿche_oblivious
, 
boŞ
)

1261 
	$CTL_RO_CONFIG_GEN
(
cÚfig_debug
, 
boŞ
)

1262 
	$CTL_RO_CONFIG_GEN
(
cÚfig_fl
, 
boŞ
)

1263 
	$CTL_RO_CONFIG_GEN
(
cÚfig_Ïzy_lock
, 
boŞ
)

1264 
	$CTL_RO_CONFIG_GEN
(
cÚfig_m®loc_cÚf
, const *)

1265 
	$CTL_RO_CONFIG_GEN
(
cÚfig_munm­
, 
boŞ
)

1266 
	$CTL_RO_CONFIG_GEN
(
cÚfig_´of
, 
boŞ
)

1267 
	$CTL_RO_CONFIG_GEN
(
cÚfig_´of_libgcc
, 
boŞ
)

1268 
	$CTL_RO_CONFIG_GEN
(
cÚfig_´of_libunwšd
, 
boŞ
)

1269 
	$CTL_RO_CONFIG_GEN
(
cÚfig_¡©s
, 
boŞ
)

1270 
	$CTL_RO_CONFIG_GEN
(
cÚfig_tÿche
, 
boŞ
)

1271 
	$CTL_RO_CONFIG_GEN
(
cÚfig_s
, 
boŞ
)

1272 
	$CTL_RO_CONFIG_GEN
(
cÚfig_uŒaû
, 
boŞ
)

1273 
	$CTL_RO_CONFIG_GEN
(
cÚfig_v®gršd
, 
boŞ
)

1274 
	$CTL_RO_CONFIG_GEN
(
cÚfig_xm®loc
, 
boŞ
)

1278 
	$CTL_RO_NL_GEN
(
İt_abÜt
, o±_abÜt, 
boŞ
)

1279 
	$CTL_RO_NL_GEN
(
İt_dss
, opt_dss, const *)

1280 
	$CTL_RO_NL_GEN
(
İt_lg_chunk
, o±_lg_chunk, 
size_t
)

1281 
	$CTL_RO_NL_GEN
(
İt_Ç»Çs
, opt_narenas, )

1282 
	$CTL_RO_NL_GEN
(
İt_purge
, 
purge_mode_Çmes
[opt_purge], const *)

1283 
	$CTL_RO_NL_GEN
(
İt_lg_dœty_muÉ
, o±_lg_dœty_muÉ, 
ssize_t
)

1284 
	$CTL_RO_NL_GEN
(
İt_deÿy_time
, o±_deÿy_time, 
ssize_t
)

1285 
	$CTL_RO_NL_GEN
(
İt_¡©s_´št
, o±_¡©s_´št, 
boŞ
)

1286 
	$CTL_RO_NL_CGEN
(
cÚfig_fl
, 
İt_junk
, opt_junk, const *)

1287 
	$CTL_RO_NL_CGEN
(
cÚfig_fl
, 
İt_qu¬ªtše
, o±_qu¬ªtše, 
size_t
)

1288 
	$CTL_RO_NL_CGEN
(
cÚfig_fl
, 
İt_»dzÚe
, o±_»dzÚe, 
boŞ
)

1289 
	$CTL_RO_NL_CGEN
(
cÚfig_fl
, 
İt_z”o
, o±_z”o, 
boŞ
)

1290 
	$CTL_RO_NL_CGEN
(
cÚfig_uŒaû
, 
İt_uŒaû
, o±_uŒaû, 
boŞ
)

1291 
	$CTL_RO_NL_CGEN
(
cÚfig_xm®loc
, 
İt_xm®loc
, o±_xm®loc, 
boŞ
)

1292 
	$CTL_RO_NL_CGEN
(
cÚfig_tÿche
, 
İt_tÿche
, o±_tÿche, 
boŞ
)

1293 
	$CTL_RO_NL_CGEN
(
cÚfig_tÿche
, 
İt_lg_tÿche_max
, o±_lg_tÿche_max, 
ssize_t
)

1294 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_´of
, o±_´of, 
boŞ
)

1295 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_´of_´efix
, opt_prof_prefix, const *)

1296 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_´of_aùive
, o±_´of_aùive, 
boŞ
)

1297 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_´of_th»ad_aùive_š™
,

1298 
İt_´of_th»ad_aùive_š™
, 
boŞ
)

1299 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_lg_´of_§m¶e
, o±_lg_´of_§m¶e, 
size_t
)

1300 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_´of_accum
, o±_´of_accum, 
boŞ
)

1301 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_lg_´of_š‹rv®
, o±_lg_´of_š‹rv®, 
ssize_t
)

1302 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_´of_gdump
, o±_´of_gdump, 
boŞ
)

1303 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_´of_fš®
, o±_´of_fš®, 
boŞ
)

1304 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
İt_´of_Ëak
, o±_´of_Ëak, 
boŞ
)

1309 
	$th»ad_¬’a_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1310 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1312 
»t
;

1313 
¬’a_t
 *
Şd¬’a
;

1314 
Ãwšd
, 
Şdšd
;

1316 
Şd¬’a
 = 
	`¬’a_choo£
(
tsd
, 
NULL
);

1317 ià(
Şd¬’a
 =ğ
NULL
)

1318  (
EAGAIN
);

1320 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1321 
Ãwšd
 = 
Şdšd
 = 
Şd¬’a
->
šd
;

1322 
	`WRITE
(
Ãwšd
, );

1323 
	`READ
(
Şdšd
, );

1324 ià(
Ãwšd
 !ğ
Şdšd
) {

1325 
¬’a_t
 *
Ãw¬’a
;

1327 ià(
Ãwšd
 >ğ
ùl_¡©s
.
Ç»Çs
) {

1329 
»t
 = 
EFAULT
;

1330 
Ïb–_»tuº
;

1334 
Ãw¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
Ãwšd
, 
Œue
);

1335 ià(
Ãw¬’a
 =ğ
NULL
) {

1336 
»t
 = 
EAGAIN
;

1337 
Ïb–_»tuº
;

1340 
	`¬’a_mig¿‹
(
tsd
, 
Şdšd
, 
Ãwšd
);

1341 ià(
cÚfig_tÿche
) {

1342 
tÿche_t
 *
tÿche
 = 
	`tsd_tÿche_g‘
(
tsd
);

1343 ià(
tÿche
 !ğ
NULL
) {

1344 
	`tÿche_¬’a_»assocŸ‹
(
	`tsd_tsdn
(
tsd
), 
tÿche
,

1345 
Şd¬’a
, 
Ãw¬’a
);

1350 
»t
 = 0;

1351 
Ïb–_»tuº
:

1352 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1353  (
»t
);

1354 
	}
}

1356 
	$CTL_TSD_RO_NL_CGEN
(
cÚfig_¡©s
, 
th»ad_®loÿ‹d
, 
tsd_th»ad_®loÿ‹d_g‘
,

1357 
ušt64_t
)

1358 
	$CTL_TSD_RO_NL_CGEN
(
cÚfig_¡©s
, 
th»ad_®loÿ‹dp
, 
tsd_th»ad_®loÿ‹dp_g‘
,

1359 
ušt64_t
 *)

1360 
	$CTL_TSD_RO_NL_CGEN
(
cÚfig_¡©s
, 
th»ad_d—Îoÿ‹d
, 
tsd_th»ad_d—Îoÿ‹d_g‘
,

1361 
ušt64_t
)

1362 
	$CTL_TSD_RO_NL_CGEN
(
cÚfig_¡©s
, 
th»ad_d—Îoÿ‹dp
,

1363 
tsd_th»ad_d—Îoÿ‹dp_g‘
, 
ušt64_t
 *)

1366 
	$th»ad_tÿche_’abËd_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
,

1367 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1369 
»t
;

1370 
boŞ
 
Şdv®
;

1372 ià(!
cÚfig_tÿche
)

1373  (
ENOENT
);

1375 
Şdv®
 = 
	`tÿche_’abËd_g‘
();

1376 ià(
Ãwp
 !ğ
NULL
) {

1377 ià(
ÃwËn
 !ğ(
boŞ
)) {

1378 
»t
 = 
EINVAL
;

1379 
Ïb–_»tuº
;

1381 
	`tÿche_’abËd_£t
(*(
boŞ
 *)
Ãwp
);

1383 
	`READ
(
Şdv®
, 
boŞ
);

1385 
»t
 = 0;

1386 
Ïb–_»tuº
:

1387  (
»t
);

1388 
	}
}

1391 
	$th»ad_tÿche_æush_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
,

1392 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1394 
»t
;

1396 ià(!
cÚfig_tÿche
)

1397  (
ENOENT
);

1399 
	`READONLY
();

1400 
	`WRITEONLY
();

1402 
	`tÿche_æush
();

1404 
»t
 = 0;

1405 
Ïb–_»tuº
:

1406  (
»t
);

1407 
	}
}

1410 
	$th»ad_´of_Çme_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1411 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1413 
»t
;

1415 ià(!
cÚfig_´of
)

1416  (
ENOENT
);

1418 
	`READ_XOR_WRITE
();

1420 ià(
Ãwp
 !ğ
NULL
) {

1421 ià(
ÃwËn
 != (const *)) {

1422 
»t
 = 
EINVAL
;

1423 
Ïb–_»tuº
;

1426 ià((
»t
 = 
	`´of_th»ad_Çme_£t
(
tsd
, *(cÚ¡ **)
Ãwp
)) !=

1428 
Ïb–_»tuº
;

1430 cÚ¡ *
ŞdÇme
 = 
	`´of_th»ad_Çme_g‘
(
tsd
);

1431 
	`READ
(
ŞdÇme
, const *);

1434 
»t
 = 0;

1435 
Ïb–_»tuº
:

1436  (
»t
);

1437 
	}
}

1440 
	$th»ad_´of_aùive_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1441 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1443 
»t
;

1444 
boŞ
 
Şdv®
;

1446 ià(!
cÚfig_´of
)

1447  (
ENOENT
);

1449 
Şdv®
 = 
	`´of_th»ad_aùive_g‘
(
tsd
);

1450 ià(
Ãwp
 !ğ
NULL
) {

1451 ià(
ÃwËn
 !ğ(
boŞ
)) {

1452 
»t
 = 
EINVAL
;

1453 
Ïb–_»tuº
;

1455 ià(
	`´of_th»ad_aùive_£t
(
tsd
, *(
boŞ
 *)
Ãwp
)) {

1456 
»t
 = 
EAGAIN
;

1457 
Ïb–_»tuº
;

1460 
	`READ
(
Şdv®
, 
boŞ
);

1462 
»t
 = 0;

1463 
Ïb–_»tuº
:

1464  (
»t
);

1465 
	}
}

1470 
	$tÿche_ü—‹_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1471 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1473 
»t
;

1474 
tÿche_šd
;

1476 ià(!
cÚfig_tÿche
)

1477  (
ENOENT
);

1479 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1480 
	`READONLY
();

1481 ià(
	`tÿches_ü—‹
(
tsd
, &
tÿche_šd
)) {

1482 
»t
 = 
EFAULT
;

1483 
Ïb–_»tuº
;

1485 
	`READ
(
tÿche_šd
, );

1487 
»t
 = 0;

1488 
Ïb–_»tuº
:

1489 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1490  (
»t
);

1491 
	}
}

1494 
	$tÿche_æush_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1495 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1497 
»t
;

1498 
tÿche_šd
;

1500 ià(!
cÚfig_tÿche
)

1501  (
ENOENT
);

1503 
	`WRITEONLY
();

1504 
tÿche_šd
 = 
UINT_MAX
;

1505 
	`WRITE
(
tÿche_šd
, );

1506 ià(
tÿche_šd
 =ğ
UINT_MAX
) {

1507 
»t
 = 
EFAULT
;

1508 
Ïb–_»tuº
;

1510 
	`tÿches_æush
(
tsd
, 
tÿche_šd
);

1512 
»t
 = 0;

1513 
Ïb–_»tuº
:

1514  (
»t
);

1515 
	}
}

1518 
	$tÿche_de¡roy_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1519 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1521 
»t
;

1522 
tÿche_šd
;

1524 ià(!
cÚfig_tÿche
)

1525  (
ENOENT
);

1527 
	`WRITEONLY
();

1528 
tÿche_šd
 = 
UINT_MAX
;

1529 
	`WRITE
(
tÿche_šd
, );

1530 ià(
tÿche_šd
 =ğ
UINT_MAX
) {

1531 
»t
 = 
EFAULT
;

1532 
Ïb–_»tuº
;

1534 
	`tÿches_de¡roy
(
tsd
, 
tÿche_šd
);

1536 
»t
 = 0;

1537 
Ïb–_»tuº
:

1538  (
»t
);

1539 
	}
}

1544 
	$¬’a_i_purge
(
tsdn_t
 *
tsdn
, 
¬’a_šd
, 
boŞ
 
®l
)

1547 
	`m®loc_mu‹x_lock
(
tsdn
, &
ùl_mtx
);

1549 
Ç»Çs
 = 
ùl_¡©s
.narenas;

1551 ià(
¬’a_šd
 =ğ
Ç»Çs
) {

1552 
i
;

1553 
	`VARIABLE_ARRAY
(
¬’a_t
 *, 
»Çs
, 
Ç»Çs
);

1555 
i
 = 0; i < 
Ç»Çs
; i++)

1556 
»Çs
[
i
] = 
	`¬’a_g‘
(
tsdn
, i, 
çl£
);

1562 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
ùl_mtx
);

1564 
i
 = 0; i < 
Ç»Çs
; i++) {

1565 ià(
»Çs
[
i
] !ğ
NULL
)

1566 
	`¬’a_purge
(
tsdn
, 
»Çs
[
i
], 
®l
);

1569 
¬’a_t
 *
»Ç
;

1571 
	`as£¹
(
¬’a_šd
 < 
Ç»Çs
);

1573 
»Ç
 = 
	`¬’a_g‘
(
tsdn
, 
¬’a_šd
, 
çl£
);

1576 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
ùl_mtx
);

1578 ià(
»Ç
 !ğ
NULL
)

1579 
	`¬’a_purge
(
tsdn
, 
»Ç
, 
®l
);

1582 
	}
}

1585 
	$¬’a_i_purge_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1586 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1588 
»t
;

1590 
	`READONLY
();

1591 
	`WRITEONLY
();

1592 
	`¬’a_i_purge
(
	`tsd_tsdn
(
tsd
), ()
mib
[1], 
Œue
);

1594 
»t
 = 0;

1595 
Ïb–_»tuº
:

1596  (
»t
);

1597 
	}
}

1600 
	$¬’a_i_deÿy_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1601 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1603 
»t
;

1605 
	`READONLY
();

1606 
	`WRITEONLY
();

1607 
	`¬’a_i_purge
(
	`tsd_tsdn
(
tsd
), ()
mib
[1], 
çl£
);

1609 
»t
 = 0;

1610 
Ïb–_»tuº
:

1611  (
»t
);

1612 
	}
}

1615 
	$¬’a_i_»£t_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1616 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1618 
»t
;

1619 
¬’a_šd
;

1620 
¬’a_t
 *
¬’a
;

1622 
	`READONLY
();

1623 
	`WRITEONLY
();

1625 ià((
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
)è|| (
cÚfig_fl
 &&

1626 
	`uÆik–y
(
İt_qu¬ªtše
))) {

1627 
»t
 = 
EFAULT
;

1628 
Ïb–_»tuº
;

1631 
¬’a_šd
 = ()
mib
[1];

1632 ià(
cÚfig_debug
) {

1633 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1634 
	`as£¹
(
¬’a_šd
 < 
ùl_¡©s
.
Ç»Çs
);

1635 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1637 
	`as£¹
(
¬’a_šd
 >ğ
İt_Ç»Çs
);

1639 
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a_šd
, 
çl£
);

1641 
	`¬’a_»£t
(
tsd
, 
¬’a
);

1643 
»t
 = 0;

1644 
Ïb–_»tuº
:

1645  (
»t
);

1646 
	}
}

1649 
	$¬’a_i_dss_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1650 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1652 
»t
;

1653 cÚ¡ *
dss
 = 
NULL
;

1654 
¬’a_šd
 = ()
mib
[1];

1655 
dss_´ec_t
 
dss_´ec_Şd
 = 
dss_´ec_lim™
;

1656 
dss_´ec_t
 
dss_´ec
 = 
dss_´ec_lim™
;

1658 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1659 
	`WRITE
(
dss
, const *);

1660 ià(
dss
 !ğ
NULL
) {

1661 
i
;

1662 
boŞ
 
m©ch
 = 
çl£
;

1664 
i
 = 0; i < 
dss_´ec_lim™
; i++) {

1665 ià(
	`¡rcmp
(
dss_´ec_Çmes
[
i
], 
dss
) == 0) {

1666 
dss_´ec
 = 
i
;

1667 
m©ch
 = 
Œue
;

1672 ià(!
m©ch
) {

1673 
»t
 = 
EINVAL
;

1674 
Ïb–_»tuº
;

1678 ià(
¬’a_šd
 < 
ùl_¡©s
.
Ç»Çs
) {

1679 
¬’a_t
 *
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a_šd
, 
çl£
);

1680 ià(
¬’a
 =ğ
NULL
 || (
dss_´ec
 !ğ
dss_´ec_lim™
 &&

1681 
	`¬’a_dss_´ec_£t
(
	`tsd_tsdn
(
tsd
), 
¬’a
, 
dss_´ec
))) {

1682 
»t
 = 
EFAULT
;

1683 
Ïb–_»tuº
;

1685 
dss_´ec_Şd
 = 
	`¬’a_dss_´ec_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

1687 ià(
dss_´ec
 !ğ
dss_´ec_lim™
 &&

1688 
	`chunk_dss_´ec_£t
(
dss_´ec
)) {

1689 
»t
 = 
EFAULT
;

1690 
Ïb–_»tuº
;

1692 
dss_´ec_Şd
 = 
	`chunk_dss_´ec_g‘
();

1695 
dss
 = 
dss_´ec_Çmes
[
dss_´ec_Şd
];

1696 
	`READ
(
dss
, const *);

1698 
»t
 = 0;

1699 
Ïb–_»tuº
:

1700 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1701  (
»t
);

1702 
	}
}

1705 
	$¬’a_i_lg_dœty_muÉ_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
,

1706 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1708 
»t
;

1709 
¬’a_šd
 = ()
mib
[1];

1710 
¬’a_t
 *
¬’a
;

1712 
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a_šd
, 
çl£
);

1713 ià(
¬’a
 =ğ
NULL
) {

1714 
»t
 = 
EFAULT
;

1715 
Ïb–_»tuº
;

1718 ià(
Şdp
 !ğ
NULL
 && 
ŞdËÅ
 != NULL) {

1719 
size_t
 
Şdv®
 = 
	`¬’a_lg_dœty_muÉ_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

1720 
	`READ
(
Şdv®
, 
ssize_t
);

1722 ià(
Ãwp
 !ğ
NULL
) {

1723 ià(
ÃwËn
 !ğ(
ssize_t
)) {

1724 
»t
 = 
EINVAL
;

1725 
Ïb–_»tuº
;

1727 ià(
	`¬’a_lg_dœty_muÉ_£t
(
	`tsd_tsdn
(
tsd
), 
¬’a
,

1728 *(
ssize_t
 *)
Ãwp
)) {

1729 
»t
 = 
EFAULT
;

1730 
Ïb–_»tuº
;

1734 
»t
 = 0;

1735 
Ïb–_»tuº
:

1736  (
»t
);

1737 
	}
}

1740 
	$¬’a_i_deÿy_time_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1741 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1743 
»t
;

1744 
¬’a_šd
 = ()
mib
[1];

1745 
¬’a_t
 *
¬’a
;

1747 
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a_šd
, 
çl£
);

1748 ià(
¬’a
 =ğ
NULL
) {

1749 
»t
 = 
EFAULT
;

1750 
Ïb–_»tuº
;

1753 ià(
Şdp
 !ğ
NULL
 && 
ŞdËÅ
 != NULL) {

1754 
size_t
 
Şdv®
 = 
	`¬’a_deÿy_time_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

1755 
	`READ
(
Şdv®
, 
ssize_t
);

1757 ià(
Ãwp
 !ğ
NULL
) {

1758 ià(
ÃwËn
 !ğ(
ssize_t
)) {

1759 
»t
 = 
EINVAL
;

1760 
Ïb–_»tuº
;

1762 ià(
	`¬’a_deÿy_time_£t
(
	`tsd_tsdn
(
tsd
), 
¬’a
,

1763 *(
ssize_t
 *)
Ãwp
)) {

1764 
»t
 = 
EFAULT
;

1765 
Ïb–_»tuº
;

1769 
»t
 = 0;

1770 
Ïb–_»tuº
:

1771  (
»t
);

1772 
	}
}

1775 
	$¬’a_i_chunk_hooks_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
,

1776 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1778 
»t
;

1779 
¬’a_šd
 = ()
mib
[1];

1780 
¬’a_t
 *
¬’a
;

1782 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1783 ià(
¬’a_šd
 < 
	`Ç»Çs_tÙ®_g‘
(è&& (
¬’a
 =

1784 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a_šd
, 
çl£
)è!ğ
NULL
) {

1785 ià(
Ãwp
 !ğ
NULL
) {

1786 
chunk_hooks_t
 
Şd_chunk_hooks
, 
Ãw_chunk_hooks
;

1787 
	`WRITE
(
Ãw_chunk_hooks
, 
chunk_hooks_t
);

1788 
Şd_chunk_hooks
 = 
	`chunk_hooks_£t
(
	`tsd_tsdn
(
tsd
), 
¬’a
,

1789 &
Ãw_chunk_hooks
);

1790 
	`READ
(
Şd_chunk_hooks
, 
chunk_hooks_t
);

1792 
chunk_hooks_t
 
Şd_chunk_hooks
 =

1793 
	`chunk_hooks_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

1794 
	`READ
(
Şd_chunk_hooks
, 
chunk_hooks_t
);

1797 
»t
 = 
EFAULT
;

1798 
Ïb–_»tuº
;

1800 
»t
 = 0;

1801 
Ïb–_»tuº
:

1802 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1803  (
»t
);

1804 
	}
}

1806 cÚ¡ 
ùl_Çmed_node_t
 *

1807 
	$¬’a_i_šdex
(
tsdn_t
 *
tsdn
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, size_ˆ
i
)

1809 cÚ¡ 
ùl_Çmed_node_t
 *
»t
;

1811 
	`m®loc_mu‹x_lock
(
tsdn
, &
ùl_mtx
);

1812 ià(
i
 > 
ùl_¡©s
.
Ç»Çs
) {

1813 
»t
 = 
NULL
;

1814 
Ïb–_»tuº
;

1817 
»t
 = 
su³r_¬’a_i_node
;

1818 
Ïb–_»tuº
:

1819 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
ùl_mtx
);

1820  (
»t
);

1821 
	}
}

1826 
	$¬’as_Ç»Çs_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1827 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1829 
»t
;

1830 
Ç»Çs
;

1832 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1833 
	`READONLY
();

1834 ià(*
ŞdËÅ
 != ()) {

1835 
»t
 = 
EINVAL
;

1836 
Ïb–_»tuº
;

1838 
Ç»Çs
 = 
ùl_¡©s
.narenas;

1839 
	`READ
(
Ç»Çs
, );

1841 
»t
 = 0;

1842 
Ïb–_»tuº
:

1843 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1844  (
»t
);

1845 
	}
}

1848 
	$¬’as_š™Ÿlized_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1849 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1851 
»t
;

1852 
Ä—d
, 
i
;

1854 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1855 
	`READONLY
();

1856 ià(*
ŞdËÅ
 !ğ
ùl_¡©s
.
Ç»Çs
 * (
boŞ
)) {

1857 
»t
 = 
EINVAL
;

1858 
Ä—d
 = (*
ŞdËÅ
 < 
ùl_¡©s
.
Ç»Çs
 * (
boŞ
))

1859 ? ()(*
ŞdËÅ
 / (
boŞ
)è: 
ùl_¡©s
.
Ç»Çs
;

1861 
»t
 = 0;

1862 
Ä—d
 = 
ùl_¡©s
.
Ç»Çs
;

1865 
i
 = 0; i < 
Ä—d
; i++)

1866 ((
boŞ
 *)
Şdp
)[
i
] = 
ùl_¡©s
.
¬’as
[i].
š™Ÿlized
;

1868 
Ïb–_»tuº
:

1869 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1870  (
»t
);

1871 
	}
}

1874 
	$¬’as_lg_dœty_muÉ_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
,

1875 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1877 
»t
;

1879 ià(
Şdp
 !ğ
NULL
 && 
ŞdËÅ
 != NULL) {

1880 
size_t
 
Şdv®
 = 
	`¬’a_lg_dœty_muÉ_deçuÉ_g‘
();

1881 
	`READ
(
Şdv®
, 
ssize_t
);

1883 ià(
Ãwp
 !ğ
NULL
) {

1884 ià(
ÃwËn
 !ğ(
ssize_t
)) {

1885 
»t
 = 
EINVAL
;

1886 
Ïb–_»tuº
;

1888 ià(
	`¬’a_lg_dœty_muÉ_deçuÉ_£t
(*(
ssize_t
 *)
Ãwp
)) {

1889 
»t
 = 
EFAULT
;

1890 
Ïb–_»tuº
;

1894 
»t
 = 0;

1895 
Ïb–_»tuº
:

1896  (
»t
);

1897 
	}
}

1900 
	$¬’as_deÿy_time_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1901 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1903 
»t
;

1905 ià(
Şdp
 !ğ
NULL
 && 
ŞdËÅ
 != NULL) {

1906 
size_t
 
Şdv®
 = 
	`¬’a_deÿy_time_deçuÉ_g‘
();

1907 
	`READ
(
Şdv®
, 
ssize_t
);

1909 ià(
Ãwp
 !ğ
NULL
) {

1910 ià(
ÃwËn
 !ğ(
ssize_t
)) {

1911 
»t
 = 
EINVAL
;

1912 
Ïb–_»tuº
;

1914 ià(
	`¬’a_deÿy_time_deçuÉ_£t
(*(
ssize_t
 *)
Ãwp
)) {

1915 
»t
 = 
EFAULT
;

1916 
Ïb–_»tuº
;

1920 
»t
 = 0;

1921 
Ïb–_»tuº
:

1922  (
»t
);

1923 
	}
}

1925 
	$CTL_RO_NL_GEN
(
¬’as_quªtum
, 
QUANTUM
, 
size_t
)

1926 
	$CTL_RO_NL_GEN
(
¬’as_·ge
, 
PAGE
, 
size_t
)

1927 
	$CTL_RO_NL_CGEN
(
cÚfig_tÿche
, 
¬’as_tÿche_max
, 
tÿche_maxşass
, 
size_t
)

1928 
	$CTL_RO_NL_GEN
(
¬’as_nbšs
, 
NBINS
, )

1929 
	$CTL_RO_NL_CGEN
(
cÚfig_tÿche
, 
¬’as_nhbšs
, 
nhbšs
, )

1930 
	$CTL_RO_NL_GEN
(
¬’as_bš_i_size
, 
¬’a_bš_šfo
[
mib
[2]].
»g_size
, 
size_t
)

1931 
	$CTL_RO_NL_GEN
(
¬’as_bš_i_Äegs
, 
¬’a_bš_šfo
[
mib
[2]].
Äegs
, 
ušt32_t
)

1932 
	$CTL_RO_NL_GEN
(
¬’as_bš_i_run_size
, 
¬’a_bš_šfo
[
mib
[2]].
run_size
, 
size_t
)

1933 cÚ¡ 
ùl_Çmed_node_t
 *

1934 
	$¬’as_bš_i_šdex
(
tsdn_t
 *
tsdn
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, size_ˆ
i
)

1937 ià(
i
 > 
NBINS
)

1938  (
NULL
);

1939  (
su³r_¬’as_bš_i_node
);

1940 
	}
}

1942 
	$CTL_RO_NL_GEN
(
¬’as_Æruns
, 
Æşas£s
, )

1943 
	`CTL_RO_NL_GEN
(
¬’as_Ìun_i_size
, 
	`šdex2size
(
NBINS
+(
szšd_t
)
mib
[2]), 
size_t
)

1944 cÚ¡ 
ùl_Çmed_node_t
 *

1945 
	$¬’as_Ìun_i_šdex
(
tsdn_t
 *
tsdn
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, size_ˆ
i
)

1948 ià(
i
 > 
Æşas£s
)

1949  (
NULL
);

1950  (
su³r_¬’as_Ìun_i_node
);

1951 
	}
}

1953 
	$CTL_RO_NL_GEN
(
¬’as_nhchunks
, 
nhşas£s
, )

1954 
	`CTL_RO_NL_GEN
(
¬’as_hchunk_i_size
, 
	`šdex2size
(
NBINS
+
Æşas£s
+(
szšd_t
)
mib
[2]),

1955 
size_t
)

1956 cÚ¡ 
ùl_Çmed_node_t
 *

1957 
	$¬’as_hchunk_i_šdex
(
tsdn_t
 *
tsdn
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, size_ˆ
i
)

1960 ià(
i
 > 
nhşas£s
)

1961  (
NULL
);

1962  (
su³r_¬’as_hchunk_i_node
);

1963 
	}
}

1966 
	$¬’as_ex‹nd_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

1967 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1969 
»t
;

1970 
Ç»Çs
;

1972 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1973 
	`READONLY
();

1974 ià(
	`ùl_grow
(
	`tsd_tsdn
(
tsd
))) {

1975 
»t
 = 
EAGAIN
;

1976 
Ïb–_»tuº
;

1978 
Ç»Çs
 = 
ùl_¡©s
.narenas - 1;

1979 
	`READ
(
Ç»Çs
, );

1981 
»t
 = 0;

1982 
Ïb–_»tuº
:

1983 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
ùl_mtx
);

1984  (
»t
);

1985 
	}
}

1990 
	$´of_th»ad_aùive_š™_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
,

1991 *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

1993 
»t
;

1994 
boŞ
 
Şdv®
;

1996 ià(!
cÚfig_´of
)

1997  (
ENOENT
);

1999 ià(
Ãwp
 !ğ
NULL
) {

2000 ià(
ÃwËn
 !ğ(
boŞ
)) {

2001 
»t
 = 
EINVAL
;

2002 
Ïb–_»tuº
;

2004 
Şdv®
 = 
	`´of_th»ad_aùive_š™_£t
(
	`tsd_tsdn
(
tsd
),

2005 *(
boŞ
 *)
Ãwp
);

2007 
Şdv®
 = 
	`´of_th»ad_aùive_š™_g‘
(
	`tsd_tsdn
(
tsd
));

2008 
	`READ
(
Şdv®
, 
boŞ
);

2010 
»t
 = 0;

2011 
Ïb–_»tuº
:

2012  (
»t
);

2013 
	}
}

2016 
	$´of_aùive_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

2017 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

2019 
»t
;

2020 
boŞ
 
Şdv®
;

2022 ià(!
cÚfig_´of
)

2023  (
ENOENT
);

2025 ià(
Ãwp
 !ğ
NULL
) {

2026 ià(
ÃwËn
 !ğ(
boŞ
)) {

2027 
»t
 = 
EINVAL
;

2028 
Ïb–_»tuº
;

2030 
Şdv®
 = 
	`´of_aùive_£t
(
	`tsd_tsdn
(
tsd
), *(
boŞ
 *)
Ãwp
);

2032 
Şdv®
 = 
	`´of_aùive_g‘
(
	`tsd_tsdn
(
tsd
));

2033 
	`READ
(
Şdv®
, 
boŞ
);

2035 
»t
 = 0;

2036 
Ïb–_»tuº
:

2037  (
»t
);

2038 
	}
}

2041 
	$´of_dump_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

2042 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

2044 
»t
;

2045 cÚ¡ *
f’ame
 = 
NULL
;

2047 ià(!
cÚfig_´of
)

2048  (
ENOENT
);

2050 
	`WRITEONLY
();

2051 
	`WRITE
(
f’ame
, const *);

2053 ià(
	`´of_mdump
(
tsd
, 
f’ame
)) {

2054 
»t
 = 
EFAULT
;

2055 
Ïb–_»tuº
;

2058 
»t
 = 0;

2059 
Ïb–_»tuº
:

2060  (
»t
);

2061 
	}
}

2064 
	$´of_gdump_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

2065 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

2067 
»t
;

2068 
boŞ
 
Şdv®
;

2070 ià(!
cÚfig_´of
)

2071  (
ENOENT
);

2073 ià(
Ãwp
 !ğ
NULL
) {

2074 ià(
ÃwËn
 !ğ(
boŞ
)) {

2075 
»t
 = 
EINVAL
;

2076 
Ïb–_»tuº
;

2078 
Şdv®
 = 
	`´of_gdump_£t
(
	`tsd_tsdn
(
tsd
), *(
boŞ
 *)
Ãwp
);

2080 
Şdv®
 = 
	`´of_gdump_g‘
(
	`tsd_tsdn
(
tsd
));

2081 
	`READ
(
Şdv®
, 
boŞ
);

2083 
»t
 = 0;

2084 
Ïb–_»tuº
:

2085  (
»t
);

2086 
	}
}

2089 
	$´of_»£t_ùl
(
tsd_t
 *
tsd
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
,

2090 
size_t
 *
ŞdËÅ
, *
Ãwp
, size_ˆ
ÃwËn
)

2092 
»t
;

2093 
size_t
 
lg_§m¶e
 = 
lg_´of_§m¶e
;

2095 ià(!
cÚfig_´of
)

2096  (
ENOENT
);

2098 
	`WRITEONLY
();

2099 
	`WRITE
(
lg_§m¶e
, 
size_t
);

2100 ià(
lg_§m¶e
 >ğ((
ušt64_t
) << 3))

2101 
lg_§m¶e
 = ((
ušt64_t
) << 3) - 1;

2103 
	`´of_»£t
(
tsd
, 
lg_§m¶e
);

2105 
»t
 = 0;

2106 
Ïb–_»tuº
:

2107  (
»t
);

2108 
	}
}

2110 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
´of_š‹rv®
,…rof_š‹rv®, 
ušt64_t
)

2111 
	$CTL_RO_NL_CGEN
(
cÚfig_´of
, 
lg_´of_§m¶e
,†g_´of_§m¶e, 
size_t
)

2115 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_ÿùive
, &¡©s_ÿùive, 
size_t
 *)

2116 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_®loÿ‹d
, 
ùl_¡©s
.
®loÿ‹d
, 
size_t
)

2117 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_aùive
, 
ùl_¡©s
.
aùive
, 
size_t
)

2118 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_m‘ad©a
, 
ùl_¡©s
.
m‘ad©a
, 
size_t
)

2119 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_»sid’t
, 
ùl_¡©s
.
»sid’t
, 
size_t
)

2120 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_m­³d
, 
ùl_¡©s
.
m­³d
, 
size_t
)

2121 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_»šed
, 
ùl_¡©s
.
»šed
, 
size_t
)

2123 
	$CTL_RO_GEN
(
¡©s_¬’as_i_dss
, 
ùl_¡©s
.
¬’as
[
mib
[2]].
dss
, const *)

2124 
	$CTL_RO_GEN
(
¡©s_¬’as_i_lg_dœty_muÉ
, 
ùl_¡©s
.
¬’as
[
mib
[2]].
lg_dœty_muÉ
,

2125 
ssize_t
)

2126 
	$CTL_RO_GEN
(
¡©s_¬’as_i_deÿy_time
, 
ùl_¡©s
.
¬’as
[
mib
[2]].
deÿy_time
,

2127 
ssize_t
)

2128 
	$CTL_RO_GEN
(
¡©s_¬’as_i_Áh»ads
, 
ùl_¡©s
.
¬’as
[
mib
[2]].
Áh»ads
, )

2129 
	$CTL_RO_GEN
(
¡©s_¬’as_i_·ùive
, 
ùl_¡©s
.
¬’as
[
mib
[2]].
·ùive
, 
size_t
)

2130 
	$CTL_RO_GEN
(
¡©s_¬’as_i_pdœty
, 
ùl_¡©s
.
¬’as
[
mib
[2]].
pdœty
, 
size_t
)

2131 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_m­³d
,

2132 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
m­³d
, 
size_t
)

2133 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_»šed
,

2134 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
»šed
, 
size_t
)

2135 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_Åurge
,

2136 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
Åurge
, 
ušt64_t
)

2137 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_nmadvi£
,

2138 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
nmadvi£
, 
ušt64_t
)

2139 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_purged
,

2140 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
purged
, 
ušt64_t
)

2141 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_m‘ad©a_m­³d
,

2142 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
m‘ad©a_m­³d
, 
size_t
)

2143 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_m‘ad©a_®loÿ‹d
,

2144 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
m‘ad©a_®loÿ‹d
, 
size_t
)

2146 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_sm®l_®loÿ‹d
,

2147 
ùl_¡©s
.
¬’as
[
mib
[2]].
®loÿ‹d_sm®l
, 
size_t
)

2148 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_sm®l_nm®loc
,

2149 
ùl_¡©s
.
¬’as
[
mib
[2]].
nm®loc_sm®l
, 
ušt64_t
)

2150 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_sm®l_nd®loc
,

2151 
ùl_¡©s
.
¬’as
[
mib
[2]].
nd®loc_sm®l
, 
ušt64_t
)

2152 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_sm®l_Äeque¡s
,

2153 
ùl_¡©s
.
¬’as
[
mib
[2]].
Äeque¡s_sm®l
, 
ušt64_t
)

2154 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_Ïrge_®loÿ‹d
,

2155 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
®loÿ‹d_Ïrge
, 
size_t
)

2156 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_Ïrge_nm®loc
,

2157 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
nm®loc_Ïrge
, 
ušt64_t
)

2158 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_Ïrge_nd®loc
,

2159 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
nd®loc_Ïrge
, 
ušt64_t
)

2160 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_Ïrge_Äeque¡s
,

2161 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
Äeque¡s_Ïrge
, 
ušt64_t
)

2162 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_huge_®loÿ‹d
,

2163 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
®loÿ‹d_huge
, 
size_t
)

2164 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_huge_nm®loc
,

2165 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
nm®loc_huge
, 
ušt64_t
)

2166 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_huge_nd®loc
,

2167 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
nd®loc_huge
, 
ušt64_t
)

2168 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_huge_Äeque¡s
,

2169 
ùl_¡©s
.
¬’as
[
mib
[2]].
a¡©s
.
nm®loc_huge
, 
ušt64_t
)

2171 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_bšs_j_nm®loc
,

2172 
ùl_¡©s
.
¬’as
[
mib
[2]].
b¡©s
[mib[4]].
nm®loc
, 
ušt64_t
)

2173 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_bšs_j_nd®loc
,

2174 
ùl_¡©s
.
¬’as
[
mib
[2]].
b¡©s
[mib[4]].
nd®loc
, 
ušt64_t
)

2175 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_bšs_j_Äeque¡s
,

2176 
ùl_¡©s
.
¬’as
[
mib
[2]].
b¡©s
[mib[4]].
Äeque¡s
, 
ušt64_t
)

2177 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_bšs_j_cu¼egs
,

2178 
ùl_¡©s
.
¬’as
[
mib
[2]].
b¡©s
[mib[4]].
cu¼egs
, 
size_t
)

2179 
	$CTL_RO_CGEN
(
cÚfig_¡©s
 && 
cÚfig_tÿche
, 
¡©s_¬’as_i_bšs_j_nfls
,

2180 
ùl_¡©s
.
¬’as
[
mib
[2]].
b¡©s
[mib[4]].
nfls
, 
ušt64_t
)

2181 
	$CTL_RO_CGEN
(
cÚfig_¡©s
 && 
cÚfig_tÿche
, 
¡©s_¬’as_i_bšs_j_næushes
,

2182 
ùl_¡©s
.
¬’as
[
mib
[2]].
b¡©s
[mib[4]].
næushes
, 
ušt64_t
)

2183 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_bšs_j_Äuns
,

2184 
ùl_¡©s
.
¬’as
[
mib
[2]].
b¡©s
[mib[4]].
Äuns
, 
ušt64_t
)

2185 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_bšs_j_Ä”uns
,

2186 
ùl_¡©s
.
¬’as
[
mib
[2]].
b¡©s
[mib[4]].
»runs
, 
ušt64_t
)

2187 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_bšs_j_cu¼uns
,

2188 
ùl_¡©s
.
¬’as
[
mib
[2]].
b¡©s
[mib[4]].
cu¼uns
, 
size_t
)

2190 cÚ¡ 
ùl_Çmed_node_t
 *

2191 
	$¡©s_¬’as_i_bšs_j_šdex
(
tsdn_t
 *
tsdn
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
,

2192 
size_t
 
j
)

2195 ià(
j
 > 
NBINS
)

2196  (
NULL
);

2197  (
su³r_¡©s_¬’as_i_bšs_j_node
);

2198 
	}
}

2200 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_Ìuns_j_nm®loc
,

2201 
ùl_¡©s
.
¬’as
[
mib
[2]].
l¡©s
[mib[4]].
nm®loc
, 
ušt64_t
)

2202 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_Ìuns_j_nd®loc
,

2203 
ùl_¡©s
.
¬’as
[
mib
[2]].
l¡©s
[mib[4]].
nd®loc
, 
ušt64_t
)

2204 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_Ìuns_j_Äeque¡s
,

2205 
ùl_¡©s
.
¬’as
[
mib
[2]].
l¡©s
[mib[4]].
Äeque¡s
, 
ušt64_t
)

2206 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_Ìuns_j_cu¼uns
,

2207 
ùl_¡©s
.
¬’as
[
mib
[2]].
l¡©s
[mib[4]].
cu¼uns
, 
size_t
)

2209 cÚ¡ 
ùl_Çmed_node_t
 *

2210 
	$¡©s_¬’as_i_Ìuns_j_šdex
(
tsdn_t
 *
tsdn
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
,

2211 
size_t
 
j
)

2214 ià(
j
 > 
Æşas£s
)

2215  (
NULL
);

2216  (
su³r_¡©s_¬’as_i_Ìuns_j_node
);

2217 
	}
}

2219 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_hchunks_j_nm®loc
,

2220 
ùl_¡©s
.
¬’as
[
mib
[2]].
h¡©s
[mib[4]].
nm®loc
, 
ušt64_t
)

2221 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_hchunks_j_nd®loc
,

2222 
ùl_¡©s
.
¬’as
[
mib
[2]].
h¡©s
[mib[4]].
nd®loc
, 
ušt64_t
)

2223 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_hchunks_j_Äeque¡s
,

2224 
ùl_¡©s
.
¬’as
[
mib
[2]].
h¡©s
[mib[4]].
nm®loc
,

2225 
ušt64_t
)

2226 
	$CTL_RO_CGEN
(
cÚfig_¡©s
, 
¡©s_¬’as_i_hchunks_j_curhchunks
,

2227 
ùl_¡©s
.
¬’as
[
mib
[2]].
h¡©s
[mib[4]].
curhchunks
, 
size_t
)

2229 cÚ¡ 
ùl_Çmed_node_t
 *

2230 
	$¡©s_¬’as_i_hchunks_j_šdex
(
tsdn_t
 *
tsdn
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
,

2231 
size_t
 
j
)

2234 ià(
j
 > 
nhşas£s
)

2235  (
NULL
);

2236  (
su³r_¡©s_¬’as_i_hchunks_j_node
);

2237 
	}
}

2239 cÚ¡ 
ùl_Çmed_node_t
 *

2240 
	$¡©s_¬’as_i_šdex
(
tsdn_t
 *
tsdn
, cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, size_ˆ
i
)

2242 cÚ¡ 
ùl_Çmed_node_t
 * 
»t
;

2244 
	`m®loc_mu‹x_lock
(
tsdn
, &
ùl_mtx
);

2245 ià(
i
 > 
ùl_¡©s
.
Ç»Çs
 || !ùl_¡©s.
¬’as
[i].
š™Ÿlized
) {

2246 
»t
 = 
NULL
;

2247 
Ïb–_»tuº
;

2250 
»t
 = 
su³r_¡©s_¬’as_i_node
;

2251 
Ïb–_»tuº
:

2252 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
ùl_mtx
);

2253  (
»t
);

2254 
	}
}

	@deps/jemalloc/src/extent.c

1 
	#JEMALLOC_EXTENT_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

10 
JEMALLOC_INLINE_C
 
size_t


11 
	$ex‹Á_quªtize
(
size_t
 
size
)

13 
size_t
 
»t
;

14 
szšd_t
 
šd
;

16 
	`as£¹
(
size
 > 0);

18 
šd
 = 
	`size2šdex
(
size
 + 1);

19 ià(
šd
 == 0) {

21  (
	`šdex2size
(0));

23 
»t
 = 
	`šdex2size
(
šd
 - 1);

24 
	`as£¹
(
»t
 <ğ
size
);

25  (
»t
);

26 
	}
}

28 
JEMALLOC_INLINE_C
 

29 
	$ex‹Á_sz_comp
(cÚ¡ 
ex‹Á_node_t
 *
a
, cÚ¡ƒx‹Á_node_ˆ*
b
)

31 
size_t
 
a_qsize
 = 
	`ex‹Á_quªtize
(
	`ex‹Á_node_size_g‘
(
a
));

32 
size_t
 
b_qsize
 = 
	`ex‹Á_quªtize
(
	`ex‹Á_node_size_g‘
(
b
));

34  ((
a_qsize
 > 
b_qsize
) - (a_qsize < b_qsize));

35 
	}
}

37 
JEMALLOC_INLINE_C
 

38 
	$ex‹Á_¢_comp
(cÚ¡ 
ex‹Á_node_t
 *
a
, cÚ¡ƒx‹Á_node_ˆ*
b
)

40 
size_t
 
a_¢
 = 
	`ex‹Á_node_¢_g‘
(
a
);

41 
size_t
 
b_¢
 = 
	`ex‹Á_node_¢_g‘
(
b
);

43  ((
a_¢
 > 
b_¢
) - (a_sn < b_sn));

44 
	}
}

46 
JEMALLOC_INLINE_C
 

47 
	$ex‹Á_ad_comp
(cÚ¡ 
ex‹Á_node_t
 *
a
, cÚ¡ƒx‹Á_node_ˆ*
b
)

49 
ušŒ_t
 
a_addr
 = (ušŒ_t)
	`ex‹Á_node_addr_g‘
(
a
);

50 
ušŒ_t
 
b_addr
 = (ušŒ_t)
	`ex‹Á_node_addr_g‘
(
b
);

52  ((
a_addr
 > 
b_addr
) - (a_addr < b_addr));

53 
	}
}

55 
JEMALLOC_INLINE_C
 

56 
	$ex‹Á_sz¢ad_comp
(cÚ¡ 
ex‹Á_node_t
 *
a
, cÚ¡ƒx‹Á_node_ˆ*
b
)

58 
»t
;

60 
»t
 = 
	`ex‹Á_sz_comp
(
a
, 
b
);

61 ià(
»t
 != 0)

62  (
»t
);

64 
»t
 = 
	`ex‹Á_¢_comp
(
a
, 
b
);

65 ià(
»t
 != 0)

66  (
»t
);

68 
»t
 = 
	`ex‹Á_ad_comp
(
a
, 
b
);

69  (
»t
);

70 
	}
}

73 
	$rb_g’
(, 
ex‹Á_Œ“_sz¢ad_
, 
ex‹Á_Œ“_t
, 
ex‹Á_node_t
, 
sz¢ad_lšk
,

74 
ex‹Á_sz¢ad_comp
)

77 
	`rb_g’
(, 
ex‹Á_Œ“_ad_
, 
ex‹Á_Œ“_t
, 
ex‹Á_node_t
, 
ad_lšk
, 
ex‹Á_ad_comp
)

	@deps/jemalloc/src/hash.c

1 
	#JEMALLOC_HASH_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

	@deps/jemalloc/src/huge.c

1 
	#JEMALLOC_HUGE_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

6 
ex‹Á_node_t
 *

7 
	$huge_node_g‘
(cÚ¡ *
±r
)

9 
ex‹Á_node_t
 *
node
;

11 
node
 = 
	`chunk_lookup
(
±r
, 
Œue
);

12 
	`as£¹
(!
	`ex‹Á_node_achunk_g‘
(
node
));

14  (
node
);

15 
	}
}

17 
boŞ


18 
	$huge_node_£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
ex‹Á_node_t
 *
node
)

21 
	`as£¹
(
	`ex‹Á_node_addr_g‘
(
node
è=ğ
±r
);

22 
	`as£¹
(!
	`ex‹Á_node_achunk_g‘
(
node
));

23  (
	`chunk_»gi¡”
(
tsdn
, 
±r
, 
node
));

24 
	}
}

27 
	$huge_node_»£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
ex‹Á_node_t
 *
node
)

29 
boŞ
 
”r
;

31 
”r
 = 
	`huge_node_£t
(
tsdn
, 
±r
, 
node
);

32 
	`as£¹
(!
”r
);

33 
	}
}

36 
	$huge_node_un£t
(cÚ¡ *
±r
, cÚ¡ 
ex‹Á_node_t
 *
node
)

39 
	`chunk_d”egi¡”
(
±r
, 
node
);

40 
	}
}

43 
	$huge_m®loc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
, 
boŞ
 
z”o
)

46 
	`as£¹
(
usize
 =ğ
	`s2u
(usize));

48  (
	`huge_·Îoc
(
tsdn
, 
¬’a
, 
usize
, 
chunksize
, 
z”o
));

49 
	}
}

52 
	$huge_·Îoc
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
, size_ˆ
®ignm’t
,

53 
boŞ
 
z”o
)

55 *
»t
;

56 
size_t
 
ausize
;

57 
¬’a_t
 *
Ÿ»Ç
;

58 
ex‹Á_node_t
 *
node
;

59 
size_t
 
¢
;

60 
boŞ
 
is_z”Ûd
;

64 
	`as£¹
(!
	`tsdn_nuÎ
(
tsdn
è|| 
¬’a
 !ğ
NULL
);

66 
ausize
 = 
	`§2u
(
usize
, 
®ignm’t
);

67 ià(
	`uÆik–y
(
ausize
 =ğ0 ||‡usiz> 
HUGE_MAXCLASS
))

68  (
NULL
);

69 
	`as£¹
(
ausize
 >ğ
chunksize
);

72 
Ÿ»Ç
 = (!
	`tsdn_nuÎ
(
tsdn
)è? 
	`¬’a_ichoo£
(
	`tsdn_tsd
Ñsdn), 
NULL
) :

73 
	`a0g‘
();

74 
node
 = 
	`®locztm
(
tsdn
, 
	`CACHELINE_CEILING
((
ex‹Á_node_t
)),

75 
CACHELINE
, 
çl£
, 
NULL
, 
Œue
, 
Ÿ»Ç
);

76 ià(
node
 =ğ
NULL
)

77  (
NULL
);

83 
is_z”Ûd
 = 
z”o
;

84 ià(
	`lik–y
(!
	`tsdn_nuÎ
(
tsdn
)))

85 
¬’a
 = 
	`¬’a_choo£
(
	`tsdn_tsd
(
tsdn
),‡rena);

86 ià(
	`uÆik–y
(
¬’a
 =ğ
NULL
è|| (
»t
 = 
	`¬’a_chunk_®loc_huge
(
tsdn
,

87 
¬’a
, 
usize
, 
®ignm’t
, &
¢
, &
is_z”Ûd
)è=ğ
NULL
) {

88 
	`id®loùm
(
tsdn
, 
node
, 
NULL
, 
Œue
,rue);

89  (
NULL
);

92 
	`ex‹Á_node_š™
(
node
, 
¬’a
, 
»t
, 
usize
, 
¢
, 
is_z”Ûd
, 
Œue
);

94 ià(
	`huge_node_£t
(
tsdn
, 
»t
, 
node
)) {

95 
	`¬’a_chunk_d®loc_huge
(
tsdn
, 
¬’a
, 
»t
, 
usize
, 
¢
);

96 
	`id®loùm
(
tsdn
, 
node
, 
NULL
, 
Œue
,rue);

97  (
NULL
);

101 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
huge_mtx
);

102 
	`ql_–m_Ãw
(
node
, 
ql_lšk
);

103 
	`ql__š£¹
(&
¬’a
->
huge
, 
node
, 
ql_lšk
);

104 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
huge_mtx
);

106 ià(
z”o
 || (
cÚfig_fl
 && 
	`uÆik–y
(
İt_z”o
))) {

107 ià(!
is_z”Ûd
)

108 
	`mem£t
(
»t
, 0, 
usize
);

109 } ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_®loc
))

110 
	`mem£t
(
»t
, 
JEMALLOC_ALLOC_JUNK
, 
usize
);

112 
	`¬’a_deÿy_tick
(
tsdn
, 
¬’a
);

113  (
»t
);

114 
	}
}

116 #ifdeà
JEMALLOC_JET


117 #undeà
huge_d®loc_junk


118 
	#huge_d®loc_junk
 
	`JEMALLOC_N
(
huge_d®loc_junk_im¶
)

	)

121 
	$huge_d®loc_junk
(*
±r
, 
size_t
 
usize
)

124 ià(
cÚfig_fl
 && 
have_dss
 && 
	`uÆik–y
(
İt_junk_ä“
)) {

129 ià(!
cÚfig_munm­
 || (
have_dss
 && 
	`chunk_š_dss
(
±r
)))

130 
	`mem£t
(
±r
, 
JEMALLOC_FREE_JUNK
, 
usize
);

132 
	}
}

133 #ifdeà
JEMALLOC_JET


134 #undeà
huge_d®loc_junk


135 
	#huge_d®loc_junk
 
	`JEMALLOC_N
(
huge_d®loc_junk
)

	)

136 
huge_d®loc_junk_t
 *
	ghuge_d®loc_junk
 = 
JEMALLOC_N
(
huge_d®loc_junk_im¶
);

140 
	$huge_¿Îoc_no_move_sim¬
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
,

141 
size_t
 
usize_mš
, size_ˆ
usize_max
, 
boŞ
 
z”o
)

143 
size_t
 
usize
, 
usize_Ãxt
;

144 
ex‹Á_node_t
 *
node
;

145 
¬’a_t
 *
¬’a
;

146 
chunk_hooks_t
 
chunk_hooks
 = 
CHUNK_HOOKS_INITIALIZER
;

147 
boŞ
 
´e_z”Ûd
, 
po¡_z”Ûd
;

150 
usize
 = 
usize_mš
; usiz< 
usize_max
 && (
usize_Ãxt
 = 
	`s2u
(usize+1))

151 <ğ
Şdsize
; 
usize
 = 
usize_Ãxt
)

154 ià(
Şdsize
 =ğ
usize
)

157 
node
 = 
	`huge_node_g‘
(
±r
);

158 
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(
node
);

159 
´e_z”Ûd
 = 
	`ex‹Á_node_z”Ûd_g‘
(
node
);

162 ià(
Şdsize
 > 
usize
) {

163 
size_t
 
sdiff
 = 
Şdsize
 - 
usize
;

164 ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_ä“
)) {

165 
	`mem£t
((*)((
ušŒ_t
)
±r
 + 
usize
),

166 
JEMALLOC_FREE_JUNK
, 
sdiff
);

167 
po¡_z”Ûd
 = 
çl£
;

169 
po¡_z”Ûd
 = !
	`chunk_purge_w¿µ”
(
tsdn
, 
¬’a
,

170 &
chunk_hooks
, 
±r
, 
	`CHUNK_CEILING
(
Şdsize
), 
usize
,

171 
sdiff
);

174 
po¡_z”Ûd
 = 
´e_z”Ûd
;

176 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
huge_mtx
);

178 
	`huge_node_un£t
(
±r
, 
node
);

179 
	`as£¹
(
	`ex‹Á_node_size_g‘
(
node
è!ğ
usize
);

180 
	`ex‹Á_node_size_£t
(
node
, 
usize
);

181 
	`huge_node_»£t
(
tsdn
, 
±r
, 
node
);

183 
	`ex‹Á_node_z”Ûd_£t
(
node
, 
po¡_z”Ûd
);

184 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
huge_mtx
);

186 
	`¬’a_chunk_¿Îoc_huge_sim¬
(
tsdn
, 
¬’a
, 
±r
, 
Şdsize
, 
usize
);

189 ià(
Şdsize
 < 
usize
) {

190 ià(
z”o
 || (
cÚfig_fl
 && 
	`uÆik–y
(
İt_z”o
))) {

191 ià(!
´e_z”Ûd
) {

192 
	`mem£t
((*)((
ušŒ_t
)
±r
 + 
Şdsize
), 0,

193 
usize
 - 
Şdsize
);

195 } ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_®loc
)) {

196 
	`mem£t
((*)((
ušŒ_t
)
±r
 + 
Şdsize
),

197 
JEMALLOC_ALLOC_JUNK
, 
usize
 - 
Şdsize
);

200 
	}
}

202 
boŞ


203 
	$huge_¿Îoc_no_move_shršk
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
,

204 
size_t
 
usize
)

206 
ex‹Á_node_t
 *
node
;

207 
¬’a_t
 *
¬’a
;

208 
chunk_hooks_t
 
chunk_hooks
;

209 
size_t
 
cdiff
;

210 
boŞ
 
´e_z”Ûd
, 
po¡_z”Ûd
;

212 
node
 = 
	`huge_node_g‘
(
±r
);

213 
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(
node
);

214 
´e_z”Ûd
 = 
	`ex‹Á_node_z”Ûd_g‘
(
node
);

215 
chunk_hooks
 = 
	`chunk_hooks_g‘
(
tsdn
, 
¬’a
);

217 
	`as£¹
(
Şdsize
 > 
usize
);

220 
cdiff
 = 
	`CHUNK_CEILING
(
Şdsize
è- CHUNK_CEILING(
usize
);

221 ià(
cdiff
 !ğ0 && 
chunk_hooks
.
	`¥l™
(
±r
, 
	`CHUNK_CEILING
(
Şdsize
),

222 
	`CHUNK_CEILING
(
usize
), 
cdiff
, 
Œue
, 
¬’a
->
šd
))

223  (
Œue
);

225 ià(
Şdsize
 > 
usize
) {

226 
size_t
 
sdiff
 = 
Şdsize
 - 
usize
;

227 ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_ä“
)) {

228 
	`huge_d®loc_junk
((*)((
ušŒ_t
)
±r
 + 
usize
),

229 
sdiff
);

230 
po¡_z”Ûd
 = 
çl£
;

232 
po¡_z”Ûd
 = !
	`chunk_purge_w¿µ”
(
tsdn
, 
¬’a
,

233 &
chunk_hooks
, 
	`CHUNK_ADDR2BASE
((
ušŒ_t
)
±r
 +

234 
usize
), 
	`CHUNK_CEILING
(
Şdsize
),

235 
	`CHUNK_ADDR2OFFSET
((
ušŒ_t
)
±r
 + 
usize
), 
sdiff
);

238 
po¡_z”Ûd
 = 
´e_z”Ûd
;

240 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
huge_mtx
);

242 
	`huge_node_un£t
(
±r
, 
node
);

243 
	`ex‹Á_node_size_£t
(
node
, 
usize
);

244 
	`huge_node_»£t
(
tsdn
, 
±r
, 
node
);

246 
	`ex‹Á_node_z”Ûd_£t
(
node
, 
po¡_z”Ûd
);

247 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
huge_mtx
);

250 
	`¬’a_chunk_¿Îoc_huge_shršk
(
tsdn
, 
¬’a
, 
±r
, 
Şdsize
, 
usize
,

251 
	`ex‹Á_node_¢_g‘
(
node
));

253  (
çl£
);

254 
	}
}

256 
boŞ


257 
	$huge_¿Îoc_no_move_ex·nd
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
,

258 
size_t
 
usize
, 
boŞ
 
z”o
) {

259 
ex‹Á_node_t
 *
node
;

260 
¬’a_t
 *
¬’a
;

261 
boŞ
 
is_z”Ûd_subchunk
, 
is_z”Ûd_chunk
;

263 
node
 = 
	`huge_node_g‘
(
±r
);

264 
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(
node
);

265 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
huge_mtx
);

266 
is_z”Ûd_subchunk
 = 
	`ex‹Á_node_z”Ûd_g‘
(
node
);

267 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
huge_mtx
);

273 
is_z”Ûd_chunk
 = 
çl£
;

274 ià(
	`¬’a_chunk_¿Îoc_huge_ex·nd
(
tsdn
, 
¬’a
, 
±r
, 
Şdsize
, 
usize
,

275 &
is_z”Ûd_chunk
))

276  (
Œue
);

278 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
huge_mtx
);

279 
	`huge_node_un£t
(
±r
, 
node
);

280 
	`ex‹Á_node_size_£t
(
node
, 
usize
);

281 
	`ex‹Á_node_z”Ûd_£t
(
node
, 
	`ex‹Á_node_z”Ûd_g‘
(node) &&

282 
is_z”Ûd_chunk
);

283 
	`huge_node_»£t
(
tsdn
, 
±r
, 
node
);

284 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
huge_mtx
);

286 ià(
z”o
 || (
cÚfig_fl
 && 
	`uÆik–y
(
İt_z”o
))) {

287 ià(!
is_z”Ûd_subchunk
) {

288 
	`mem£t
((*)((
ušŒ_t
)
±r
 + 
Şdsize
), 0,

289 
	`CHUNK_CEILING
(
Şdsize
) - oldsize);

291 ià(!
is_z”Ûd_chunk
) {

292 
	`mem£t
((*)((
ušŒ_t
)
±r
 +

293 
	`CHUNK_CEILING
(
Şdsize
)), 0, 
usize
 -

294 
	`CHUNK_CEILING
(
Şdsize
));

296 } ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_®loc
)) {

297 
	`mem£t
((*)((
ušŒ_t
)
±r
 + 
Şdsize
), 
JEMALLOC_ALLOC_JUNK
,

298 
usize
 - 
Şdsize
);

301  (
çl£
);

302 
	}
}

304 
boŞ


305 
	$huge_¿Îoc_no_move
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şdsize
, size_ˆ
usize_mš
,

306 
size_t
 
usize_max
, 
boŞ
 
z”o
)

309 
	`as£¹
(
	`s2u
(
Şdsize
) == oldsize);

311 
	`as£¹
(
usize_mš
 > 0 && 
usize_max
 <ğ
HUGE_MAXCLASS
);

314 ià(
Şdsize
 < 
chunksize
 || 
usize_max
 < chunksize)

315  (
Œue
);

317 ià(
	`CHUNK_CEILING
(
usize_max
è> CHUNK_CEILING(
Şdsize
)) {

319 ià(!
	`huge_¿Îoc_no_move_ex·nd
(
tsdn
, 
±r
, 
Şdsize
, 
usize_max
,

320 
z”o
)) {

321 
	`¬’a_deÿy_tick
(
tsdn
, 
	`huge_¯Îoc
(
±r
));

322  (
çl£
);

325 ià(
usize_mš
 < 
usize_max
 && 
	`CHUNK_CEILING
(usize_min) >

326 
	`CHUNK_CEILING
(
Şdsize
è&& 
	`huge_¿Îoc_no_move_ex·nd
(
tsdn
,

327 
±r
, 
Şdsize
, 
usize_mš
, 
z”o
)) {

328 
	`¬’a_deÿy_tick
(
tsdn
, 
	`huge_¯Îoc
(
±r
));

329  (
çl£
);

337 ià(
	`CHUNK_CEILING
(
Şdsize
è>ğCHUNK_CEILING(
usize_mš
)

338 && 
	`CHUNK_CEILING
(
Şdsize
è<ğCHUNK_CEILING(
usize_max
)) {

339 
	`huge_¿Îoc_no_move_sim¬
(
tsdn
, 
±r
, 
Şdsize
, 
usize_mš
,

340 
usize_max
, 
z”o
);

341 
	`¬’a_deÿy_tick
(
tsdn
, 
	`huge_¯Îoc
(
±r
));

342  (
çl£
);

346 ià(
	`CHUNK_CEILING
(
Şdsize
è> CHUNK_CEILING(
usize_max
)) {

347 ià(!
	`huge_¿Îoc_no_move_shršk
(
tsdn
, 
±r
, 
Şdsize
,

348 
usize_max
)) {

349 
	`¬’a_deÿy_tick
(
tsdn
, 
	`huge_¯Îoc
(
±r
));

350  (
çl£
);

353  (
Œue
);

354 
	}
}

357 
	$huge_¿Îoc_move_h–³r
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
size_t
 
usize
,

358 
size_t
 
®ignm’t
, 
boŞ
 
z”o
)

361 ià(
®ignm’t
 <ğ
chunksize
)

362  (
	`huge_m®loc
(
tsdn
, 
¬’a
, 
usize
, 
z”o
));

363  (
	`huge_·Îoc
(
tsdn
, 
¬’a
, 
usize
, 
®ignm’t
, 
z”o
));

364 
	}
}

367 
	$huge_¿Îoc
(
tsd_t
 *
tsd
, 
¬’a_t
 *
¬’a
, *
±r
, 
size_t
 
Şdsize
,

368 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
)

370 *
»t
;

371 
size_t
 
cİysize
;

374 
	`as£¹
(
usize
 > 0 && usiz<ğ
HUGE_MAXCLASS
);

377 ià(!
	`huge_¿Îoc_no_move
(
	`tsd_tsdn
(
tsd
), 
±r
, 
Şdsize
, 
usize
, usize,

378 
z”o
))

379  (
±r
);

386 
»t
 = 
	`huge_¿Îoc_move_h–³r
(
	`tsd_tsdn
(
tsd
), 
¬’a
, 
usize
, 
®ignm’t
,

387 
z”o
);

388 ià(
»t
 =ğ
NULL
)

389  (
NULL
);

391 
cİysize
 = (
usize
 < 
Şdsize
) ? usize : oldsize;

392 
	`memıy
(
»t
, 
±r
, 
cİysize
);

393 
	`isq®loc
(
tsd
, 
±r
, 
Şdsize
, 
tÿche
, 
Œue
);

394  (
»t
);

395 
	}
}

398 
	$huge_d®loc
(
tsdn_t
 *
tsdn
, *
±r
)

400 
ex‹Á_node_t
 *
node
;

401 
¬’a_t
 *
¬’a
;

403 
node
 = 
	`huge_node_g‘
(
±r
);

404 
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(
node
);

405 
	`huge_node_un£t
(
±r
, 
node
);

406 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
huge_mtx
);

407 
	`ql_»move
(&
¬’a
->
huge
, 
node
, 
ql_lšk
);

408 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
huge_mtx
);

410 
	`huge_d®loc_junk
(
	`ex‹Á_node_addr_g‘
(
node
),

411 
	`ex‹Á_node_size_g‘
(
node
));

412 
	`¬’a_chunk_d®loc_huge
(
tsdn
, 
	`ex‹Á_node_¬’a_g‘
(
node
),

413 
	`ex‹Á_node_addr_g‘
(
node
), 
	`ex‹Á_node_size_g‘
(node),

414 
	`ex‹Á_node_¢_g‘
(
node
));

415 
	`id®loùm
(
tsdn
, 
node
, 
NULL
, 
Œue
,rue);

417 
	`¬’a_deÿy_tick
(
tsdn
, 
¬’a
);

418 
	}
}

420 
¬’a_t
 *

421 
	$huge_¯Îoc
(cÚ¡ *
±r
)

424  (
	`ex‹Á_node_¬’a_g‘
(
	`huge_node_g‘
(
±r
)));

425 
	}
}

427 
size_t


428 
	$huge_§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
)

430 
size_t
 
size
;

431 
ex‹Á_node_t
 *
node
;

432 
¬’a_t
 *
¬’a
;

434 
node
 = 
	`huge_node_g‘
(
±r
);

435 
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(
node
);

436 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
huge_mtx
);

437 
size
 = 
	`ex‹Á_node_size_g‘
(
node
);

438 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
huge_mtx
);

440  (
size
);

441 
	}
}

443 
´of_tùx_t
 *

444 
	$huge_´of_tùx_g‘
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
)

446 
´of_tùx_t
 *
tùx
;

447 
ex‹Á_node_t
 *
node
;

448 
¬’a_t
 *
¬’a
;

450 
node
 = 
	`huge_node_g‘
(
±r
);

451 
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(
node
);

452 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
huge_mtx
);

453 
tùx
 = 
	`ex‹Á_node_´of_tùx_g‘
(
node
);

454 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
huge_mtx
);

456  (
tùx
);

457 
	}
}

460 
	$huge_´of_tùx_£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
´of_tùx_t
 *
tùx
)

462 
ex‹Á_node_t
 *
node
;

463 
¬’a_t
 *
¬’a
;

465 
node
 = 
	`huge_node_g‘
(
±r
);

466 
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(
node
);

467 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
huge_mtx
);

468 
	`ex‹Á_node_´of_tùx_£t
(
node
, 
tùx
);

469 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
huge_mtx
);

470 
	}
}

473 
	$huge_´of_tùx_»£t
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
)

476 
	`huge_´of_tùx_£t
(
tsdn
, 
±r
, (
´of_tùx_t
 *)(
ušŒ_t
)1U);

477 
	}
}

	@deps/jemalloc/src/jemalloc.c

1 
	#JEMALLOC_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

8 cÚ¡ *
	gje_m®loc_cÚf


9 #iâdeà
_WIN32


10 
	$JEMALLOC_ATTR
(
w—k
)

13 
boŞ
 
İt_abÜt
 =

14 #ifdeà
JEMALLOC_DEBUG


15 
Œue


17 
çl£


20 cÚ¡ *
İt_junk
 =

21 #ià(
	`defšed
(
JEMALLOC_DEBUG
è&& defšed(
JEMALLOC_FILL
))

27 
boŞ
 
İt_junk_®loc
 =

28 #ià(
	`defšed
(
JEMALLOC_DEBUG
è&& defšed(
JEMALLOC_FILL
))

29 
Œue


31 
çl£


34 
boŞ
 
İt_junk_ä“
 =

35 #ià(
	`defšed
(
JEMALLOC_DEBUG
è&& defšed(
JEMALLOC_FILL
))

36 
Œue


38 
çl£


42 
size_t
 
İt_qu¬ªtše
 = 
	`ZU
(0);

43 
boŞ
 
İt_»dzÚe
 = 
çl£
;

44 
boŞ
 
İt_uŒaû
 = 
çl£
;

45 
boŞ
 
İt_xm®loc
 = 
çl£
;

46 
boŞ
 
İt_z”o
 = 
çl£
;

47 
İt_Ç»Çs
 = 0;

50 
boŞ
 
š_v®gršd
;

52 
nıus
;

55 
m®loc_mu‹x_t
 
¬’as_lock
;

64 
¬’a_t
 **
¬’as
;

65 
Ç»Çs_tÙ®
;

66 
¬’a_t
 *
a0
;

67 
Ç»Çs_auto
;

70 
m®loc_š™_unš™Ÿlized
 = 3,

71 
m®loc_š™_a0_š™Ÿlized
 = 2,

72 
m®loc_š™_»cursibË
 = 1,

73 
m®loc_š™_š™Ÿlized
 = 0

74 } 
	tm®loc_š™_t
;

75 
m®loc_š™_t
 
m®loc_š™_¡©e
 = 
m®loc_š™_unš™Ÿlized
;

78 
boŞ
 
m®loc_¦ow
 = 
Œue
;

82 
æag_İt_junk_®loc
 = (1U),

83 
æag_İt_junk_ä“
 = (1U << 1),

84 
æag_İt_qu¬ªtše
 = (1U << 2),

85 
æag_İt_z”o
 = (1U << 3),

86 
æag_İt_uŒaû
 = (1U << 4),

87 
æag_š_v®gršd
 = (1U << 5),

88 
æag_İt_xm®loc
 = (1U << 6)

90 
ušt8_t
 
m®loc_¦ow_æags
;

92 
	$JEMALLOC_ALIGNED
(
CACHELINE
)

93 cÚ¡ 
size_t
 
pšd2sz_b
[
NPSIZES
] = {

94 
	#PSZ_yes
(
lg_g½
, 
nd–
, 
lg_d–
) \

95 (((
	`ZU
(1)<<
lg_g½
è+ (ZU(
nd–
)<<
lg_d–
))),

	)

96 
	#PSZ_no
(
lg_g½
, 
nd–
, 
lg_d–
)

	)

97 
	#SC
(
šdex
, 
lg_g½
, 
lg_d–
, 
nd–
, 
psz
, 
bš
, 
lg_d–_lookup
) \

98 
PSZ_
##
	`psz
(
lg_g½
, 
nd–
, 
lg_d–
)

	)

99 
SIZE_CLASSES


100 #undeà
PSZ_yes


101 #undeà
PSZ_no


102 #undeà
SC


103 
	}
};

105 
	$JEMALLOC_ALIGNED
(
CACHELINE
)

106 cÚ¡ 
size_t
 
šdex2size_b
[
NSIZES
] = {

107 
	#SC
(
šdex
, 
lg_g½
, 
lg_d–
, 
nd–
, 
psz
, 
bš
, 
lg_d–_lookup
) \

108 ((
	`ZU
(1)<<
lg_g½
è+ (ZU(
nd–
)<<
lg_d–
)),

	)

109 
SIZE_CLASSES


110 #undeà
SC


111 
	}
};

113 
	$JEMALLOC_ALIGNED
(
CACHELINE
)

114 cÚ¡ 
ušt8_t
 
size2šdex_b
[] = {

115 #ià
LG_TINY_MIN
 == 0

117 
	#S2B_0
(
i
èi,

	)

118 #–ià
LG_TINY_MIN
 == 1

120 
	#S2B_1
(
i
èi,

	)

121 #–ià
LG_TINY_MIN
 == 2

123 
	#S2B_2
(
i
èi,

	)

124 #–ià
LG_TINY_MIN
 == 3

125 
	#S2B_3
(
i
èi,

	)

126 #–ià
LG_TINY_MIN
 == 4

127 
	#S2B_4
(
i
èi,

	)

128 #–ià
LG_TINY_MIN
 == 5

129 
	#S2B_5
(
i
èi,

	)

130 #–ià
LG_TINY_MIN
 == 6

131 
	#S2B_6
(
i
èi,

	)

132 #–ià
LG_TINY_MIN
 == 7

133 
	#S2B_7
(
i
èi,

	)

134 #–ià
LG_TINY_MIN
 == 8

135 
	#S2B_8
(
i
èi,

	)

136 #–ià
LG_TINY_MIN
 == 9

137 
	#S2B_9
(
i
èi,

	)

138 #–ià
LG_TINY_MIN
 == 10

139 
	#S2B_10
(
i
èi,

	)

140 #–ià
LG_TINY_MIN
 == 11

141 
	#S2B_11
(
i
èi,

	)

145 #ià
LG_TINY_MIN
 < 1

146 
	#S2B_1
(
i
è
	`S2B_0
(ièS2B_0(i)

	)

148 #ià
LG_TINY_MIN
 < 2

149 
	#S2B_2
(
i
è
	`S2B_1
(ièS2B_1(i)

	)

151 #ià
LG_TINY_MIN
 < 3

152 
	#S2B_3
(
i
è
	`S2B_2
(ièS2B_2(i)

	)

154 #ià
LG_TINY_MIN
 < 4

155 
	#S2B_4
(
i
è
	`S2B_3
(ièS2B_3(i)

	)

157 #ià
LG_TINY_MIN
 < 5

158 
	#S2B_5
(
i
è
	`S2B_4
(ièS2B_4(i)

	)

160 #ià
LG_TINY_MIN
 < 6

161 
	#S2B_6
(
i
è
	`S2B_5
(ièS2B_5(i)

	)

163 #ià
LG_TINY_MIN
 < 7

164 
	#S2B_7
(
i
è
	`S2B_6
(ièS2B_6(i)

	)

166 #ià
LG_TINY_MIN
 < 8

167 
	#S2B_8
(
i
è
	`S2B_7
(ièS2B_7(i)

	)

169 #ià
LG_TINY_MIN
 < 9

170 
	#S2B_9
(
i
è
	`S2B_8
(ièS2B_8(i)

	)

172 #ià
LG_TINY_MIN
 < 10

173 
	#S2B_10
(
i
è
	`S2B_9
(ièS2B_9(i)

	)

175 #ià
LG_TINY_MIN
 < 11

176 
	#S2B_11
(
i
è
	`S2B_10
(ièS2B_10(i)

	)

178 
	#S2B_no
(
i
)

	)

179 
	#SC
(
šdex
, 
lg_g½
, 
lg_d–
, 
nd–
, 
psz
, 
bš
, 
lg_d–_lookup
) \

180 
S2B_
##
	`lg_d–_lookup
(
šdex
)

	)

181 
SIZE_CLASSES


182 #undeà
S2B_3


183 #undeà
S2B_4


184 #undeà
S2B_5


185 #undeà
S2B_6


186 #undeà
S2B_7


187 #undeà
S2B_8


188 #undeà
S2B_9


189 #undeà
S2B_10


190 #undeà
S2B_11


191 #undeà
S2B_no


192 #undeà
SC


193 
	}
};

195 #ifdeà
JEMALLOC_THREADED_INIT


197 
	#NO_INITIALIZER
 (()0)

	)

198 
	#INITIALIZER
 
	`±h»ad_£lf
()

	)

199 
	#IS_INITIALIZER
 (
m®loc_š™Ÿliz”
 =ğ
	`±h»ad_£lf
())

	)

200 
±h»ad_t
 
	gm®loc_š™Ÿliz”
 = 
NO_INITIALIZER
;

202 
	#NO_INITIALIZER
 
çl£


	)

203 
	#INITIALIZER
 
Œue


	)

204 
	#IS_INITIALIZER
 
m®loc_š™Ÿliz”


	)

205 
boŞ
 
	gm®loc_š™Ÿliz”
 = 
NO_INITIALIZER
;

209 #ifdeà
_WIN32


210 #ià
_WIN32_WINNT
 >= 0x0600

211 
m®loc_mu‹x_t
 
	gš™_lock
 = 
SRWLOCK_INIT
;

213 
m®loc_mu‹x_t
 
	gš™_lock
;

214 
boŞ
 
	gš™_lock_š™Ÿlized
 = 
çl£
;

216 
	$JEMALLOC_ATTR
(
cÚ¡ruùÜ
)

217 
WINAPI


218 
	$_š™_š™_lock
()

229 ià(!
š™_lock_š™Ÿlized
)

230 
	`m®loc_mu‹x_š™
(&
š™_lock
, "š™", 
WITNESS_RANK_INIT
);

231 
š™_lock_š™Ÿlized
 = 
Œue
;

232 
	}
}

234 #ifdeà
_MSC_VER


235 #´agm¨
£ùiÚ
(".CRT$XCU", 
»ad
)

236 
JEMALLOC_SECTION
(".CRT$XCU"è
	$JEMALLOC_ATTR
(
u£d
)

237 cÚ¡ (
WINAPI
 *
š™_š™_lock
)(èğ
_š™_š™_lock
;

241 
m®loc_mu‹x_t
 
š™_lock
 = 
MALLOC_MUTEX_INITIALIZER
;

245 *
p
;

246 
size_t
 
s
;

247 *
r
;

248 } 
	tm®loc_uŒaû_t
;

250 #ifdeà
JEMALLOC_UTRACE


251 
	#UTRACE
(
a
, 
b
, 
c
) do { \

252 ià(
	`uÆik–y
(
İt_uŒaû
)) { \

253 
uŒaû_£¼no
 = 
”ºo
; \

254 
m®loc_uŒaû_t
 
ut
; \

255 
ut
.
p
 = (
a
); \

256 
ut
.
s
 = (
b
); \

257 
ut
.
r
 = (
c
); \

258 
	`uŒaû
(&
ut
, (ut)); \

259 
”ºo
 = 
uŒaû_£¼no
; \

261 
	}
} 0)

	)

263 
	#UTRACE
(
a
, 
b
, 
c
)

	)

272 
boŞ
 
m®loc_š™_h¬d_a0
();

273 
boŞ
 
m®loc_š™_h¬d
();

280 
JEMALLOC_ALWAYS_INLINE_C
 
boŞ


281 
	$m®loc_š™Ÿlized
()

284  (
m®loc_š™_¡©e
 =ğ
m®loc_š™_š™Ÿlized
);

285 
	}
}

287 
JEMALLOC_ALWAYS_INLINE_C
 

288 
	$m®loc_th»ad_š™
()

300 ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_qu¬ªtše
))

301 
	`qu¬ªtše_®loc_hook
();

302 
	}
}

304 
JEMALLOC_ALWAYS_INLINE_C
 
boŞ


305 
	$m®loc_š™_a0
()

308 ià(
	`uÆik–y
(
m®loc_š™_¡©e
 =ğ
m®loc_š™_unš™Ÿlized
))

309  (
	`m®loc_š™_h¬d_a0
());

310  (
çl£
);

311 
	}
}

313 
JEMALLOC_ALWAYS_INLINE_C
 
boŞ


314 
	$m®loc_š™
()

317 ià(
	`uÆik–y
(!
	`m®loc_š™Ÿlized
()è&& 
	`m®loc_š™_h¬d
())

318  (
Œue
);

319 
	`m®loc_th»ad_š™
();

321  (
çl£
);

322 
	}
}

330 
	$a0ŸÎoc
(
size_t
 
size
, 
boŞ
 
z”o
, boŞ 
is_m‘ad©a
)

333 ià(
	`uÆik–y
(
	`m®loc_š™_a0
()))

334  (
NULL
);

336  (
	`ŸÎocztm
(
TSDN_NULL
, 
size
, 
	`size2šdex
(size), 
z”o
, 
NULL
,

337 
is_m‘ad©a
, 
	`¬’a_g‘
(
TSDN_NULL
, 0, 
Œue
),rue));

338 
	}
}

341 
	$a0id®loc
(*
±r
, 
boŞ
 
is_m‘ad©a
)

344 
	`id®loùm
(
TSDN_NULL
, 
±r
, 
çl£
, 
is_m‘ad©a
, 
Œue
);

345 
	}
}

347 
¬’a_t
 *

348 
	$a0g‘
()

351  (
a0
);

352 
	}
}

355 
	$a0m®loc
(
size_t
 
size
)

358  (
	`a0ŸÎoc
(
size
, 
çl£
, 
Œue
));

359 
	}
}

362 
	$a0d®loc
(*
±r
)

365 
	`a0id®loc
(
±r
, 
Œue
);

366 
	}
}

375 
	$boÙ¡¿p_m®loc
(
size_t
 
size
)

378 ià(
	`uÆik–y
(
size
 == 0))

379 
size
 = 1;

381  (
	`a0ŸÎoc
(
size
, 
çl£
, false));

382 
	}
}

385 
	$boÙ¡¿p_ÿÎoc
(
size_t
 
num
, size_ˆ
size
)

387 
size_t
 
num_size
;

389 
num_size
 = 
num
 * 
size
;

390 ià(
	`uÆik–y
(
num_size
 == 0)) {

391 
	`as£¹
(
num
 =ğ0 || 
size
 == 0);

392 
num_size
 = 1;

395  (
	`a0ŸÎoc
(
num_size
, 
Œue
, 
çl£
));

396 
	}
}

399 
	$boÙ¡¿p_ä“
(*
±r
)

402 ià(
	`uÆik–y
(
±r
 =ğ
NULL
))

405 
	`a0id®loc
(
±r
, 
çl£
);

406 
	}
}

409 
	$¬’a_£t
(
šd
, 
¬’a_t
 *
¬’a
)

412 
	`©omic_wr™e_p
((**)&
¬’as
[
šd
], 
¬’a
);

413 
	}
}

416 
	$Ç»Çs_tÙ®_£t
(
Ç»Çs
)

419 
	`©omic_wr™e_u
(&
Ç»Çs_tÙ®
, 
Ç»Çs
);

420 
	}
}

423 
	$Ç»Çs_tÙ®_šc
()

426 
	`©omic_add_u
(&
Ç»Çs_tÙ®
, 1);

427 
	}
}

430 
	$Ç»Çs_tÙ®_g‘
()

433  (
	`©omic_»ad_u
(&
Ç»Çs_tÙ®
));

434 
	}
}

437 
¬’a_t
 *

438 
	$¬’a_š™_locked
(
tsdn_t
 *
tsdn
, 
šd
)

440 
¬’a_t
 *
¬’a
;

442 
	`as£¹
(
šd
 <ğ
	`Ç»Çs_tÙ®_g‘
());

443 ià(
šd
 > 
MALLOCX_ARENA_MAX
)

444  (
NULL
);

445 ià(
šd
 =ğ
	`Ç»Çs_tÙ®_g‘
())

446 
	`Ç»Çs_tÙ®_šc
();

452 
¬’a
 = 
	`¬’a_g‘
(
tsdn
, 
šd
, 
çl£
);

453 ià(
¬’a
 !ğ
NULL
) {

454 
	`as£¹
(
šd
 < 
Ç»Çs_auto
);

455  (
¬’a
);

459 
¬’a
 = 
	`¬’a_Ãw
(
tsdn
, 
šd
);

460 
	`¬’a_£t
(
šd
, 
¬’a
);

461  (
¬’a
);

462 
	}
}

464 
¬’a_t
 *

465 
	$¬’a_š™
(
tsdn_t
 *
tsdn
, 
šd
)

467 
¬’a_t
 *
¬’a
;

469 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’as_lock
);

470 
¬’a
 = 
	`¬’a_š™_locked
(
tsdn
, 
šd
);

471 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’as_lock
);

472  (
¬’a
);

473 
	}
}

476 
	$¬’a_bšd
(
tsd_t
 *
tsd
, 
šd
, 
boŞ
 
š‹º®
)

478 
¬’a_t
 *
¬’a
;

480 ià(!
	`tsd_nomš®
(
tsd
))

483 
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
šd
, 
çl£
);

484 
	`¬’a_Áh»ads_šc
(
¬’a
, 
š‹º®
);

486 ià(
š‹º®
)

487 
	`tsd_Ÿ»Ç_£t
(
tsd
, 
¬’a
);

489 
	`tsd_¬’a_£t
(
tsd
, 
¬’a
);

490 
	}
}

493 
	$¬’a_mig¿‹
(
tsd_t
 *
tsd
, 
Şdšd
, 
Ãwšd
)

495 
¬’a_t
 *
Şd¬’a
, *
Ãw¬’a
;

497 
Şd¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
Şdšd
, 
çl£
);

498 
Ãw¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
Ãwšd
, 
çl£
);

499 
	`¬’a_Áh»ads_dec
(
Şd¬’a
, 
çl£
);

500 
	`¬’a_Áh»ads_šc
(
Ãw¬’a
, 
çl£
);

501 
	`tsd_¬’a_£t
(
tsd
, 
Ãw¬’a
);

502 
	}
}

505 
	$¬’a_unbšd
(
tsd_t
 *
tsd
, 
šd
, 
boŞ
 
š‹º®
)

507 
¬’a_t
 *
¬’a
;

509 
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
šd
, 
çl£
);

510 
	`¬’a_Áh»ads_dec
(
¬’a
, 
š‹º®
);

511 ià(
š‹º®
)

512 
	`tsd_Ÿ»Ç_£t
(
tsd
, 
NULL
);

514 
	`tsd_¬’a_£t
(
tsd
, 
NULL
);

515 
	}
}

517 
¬’a_td©a_t
 *

518 
	$¬’a_td©a_g‘_h¬d
(
tsd_t
 *
tsd
, 
šd
)

520 
¬’a_td©a_t
 *
td©a
, *
¬’as_td©a_Şd
;

521 
¬’a_td©a_t
 *
¬’as_td©a
 = 
	`tsd_¬’as_td©a_g‘
(
tsd
);

522 
Ç»Çs_td©a_Şd
, 
i
;

523 
Ç»Çs_td©a
 = 
	`tsd_Ç»Çs_td©a_g‘
(
tsd
);

524 
Ç»Çs_aùu®
 = 
	`Ç»Çs_tÙ®_g‘
();

530 ià(
¬’as_td©a
 !ğ
NULL
 && 
Ç»Çs_td©a
 < 
Ç»Çs_aùu®
) {

531 
¬’as_td©a_Şd
 = 
¬’as_td©a
;

532 
Ç»Çs_td©a_Şd
 = 
Ç»Çs_td©a
;

533 
¬’as_td©a
 = 
NULL
;

534 
Ç»Çs_td©a
 = 0;

535 
	`tsd_¬’as_td©a_£t
(
tsd
, 
¬’as_td©a
);

536 
	`tsd_Ç»Çs_td©a_£t
(
tsd
, 
Ç»Çs_td©a
);

538 
¬’as_td©a_Şd
 = 
NULL
;

539 
Ç»Çs_td©a_Şd
 = 0;

543 ià(
¬’as_td©a
 =ğ
NULL
) {

544 
boŞ
 *
¬’as_td©a_by·s¥
 = 
	`tsd_¬’as_td©a_by·s¥_g‘
(
tsd
);

545 
Ç»Çs_td©a
 = (
šd
 < 
Ç»Çs_aùu®
) ?‚arenas_actual : ind+1;

547 ià(
	`tsd_nomš®
(
tsd
è&& !*
¬’as_td©a_by·s¥
) {

548 *
¬’as_td©a_by·s¥
 = 
Œue
;

549 
¬’as_td©a
 = (
¬’a_td©a_t
 *)
	`a0m®loc
(

550 (
¬’a_td©a_t
è* 
Ç»Çs_td©a
);

551 *
¬’as_td©a_by·s¥
 = 
çl£
;

553 ià(
¬’as_td©a
 =ğ
NULL
) {

554 
td©a
 = 
NULL
;

555 
Ïb–_»tuº
;

557 
	`as£¹
(
	`tsd_nomš®
(
tsd
è&& !*
¬’as_td©a_by·s¥
);

558 
	`tsd_¬’as_td©a_£t
(
tsd
, 
¬’as_td©a
);

559 
	`tsd_Ç»Çs_td©a_£t
(
tsd
, 
Ç»Çs_td©a
);

571 
i
 = 0; i < 
Ç»Çs_aùu®
; i++) {

572 ià(
i
 < 
Ç»Çs_td©a_Şd
) {

573 
	`tick”_cİy
(&
¬’as_td©a
[
i
].
deÿy_tick”
,

574 &
¬’as_td©a_Şd
[
i
].
deÿy_tick”
);

576 
	`tick”_š™
(&
¬’as_td©a
[
i
].
deÿy_tick”
,

577 
DECAY_NTICKS_PER_UPDATE
);

580 ià(
Ç»Çs_td©a
 > 
Ç»Çs_aùu®
) {

581 
	`mem£t
(&
¬’as_td©a
[
Ç»Çs_aùu®
], 0, (
¬’a_td©a_t
)

582 * (
Ç»Çs_td©a
 - 
Ç»Çs_aùu®
));

586 
td©a
 = &
¬’as_td©a
[
šd
];

587 
Ïb–_»tuº
:

588 ià(
¬’as_td©a_Şd
 !ğ
NULL
)

589 
	`a0d®loc
(
¬’as_td©a_Şd
);

590  (
td©a
);

591 
	}
}

594 
¬’a_t
 *

595 
	$¬’a_choo£_h¬d
(
tsd_t
 *
tsd
, 
boŞ
 
š‹º®
)

597 
¬’a_t
 *
»t
 
	`JEMALLOC_CC_SILENCE_INIT
(
NULL
);

599 ià(
Ç»Çs_auto
 > 1) {

600 
i
, 
j
, 
choo£
[2], 
fœ¡_nuÎ
;

610 
j
 = 0; j < 2; j++)

611 
choo£
[
j
] = 0;

613 
fœ¡_nuÎ
 = 
Ç»Çs_auto
;

614 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
¬’as_lock
);

615 
	`as£¹
(
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 0, 
çl£
è!ğ
NULL
);

616 
i
 = 1; i < 
Ç»Çs_auto
; i++) {

617 ià(
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
i
, 
çl£
è!ğ
NULL
) {

622 
j
 = 0; j < 2; j++) {

623 ià(
	`¬’a_Áh»ads_g‘
(
	`¬’a_g‘
(

624 
	`tsd_tsdn
(
tsd
), 
i
, 
çl£
), !!
j
) <

625 
	`¬’a_Áh»ads_g‘
(
	`¬’a_g‘
(

626 
	`tsd_tsdn
(
tsd
), 
choo£
[
j
], 
çl£
),

627 !!
j
))

628 
choo£
[
j
] = 
i
;

630 } ià(
fœ¡_nuÎ
 =ğ
Ç»Çs_auto
) {

640 
fœ¡_nuÎ
 = 
i
;

644 
j
 = 0; j < 2; j++) {

645 ià(
	`¬’a_Áh»ads_g‘
(
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
),

646 
choo£
[
j
], 
çl£
), !!jè=ğ0 || 
fœ¡_nuÎ
 ==

647 
Ç»Çs_auto
) {

652 ià(!!
j
 =ğ
š‹º®
) {

653 
»t
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
),

654 
choo£
[
j
], 
çl£
);

657 
¬’a_t
 *
¬’a
;

660 
choo£
[
j
] = 
fœ¡_nuÎ
;

661 
¬’a
 = 
	`¬’a_š™_locked
(
	`tsd_tsdn
(
tsd
),

662 
choo£
[
j
]);

663 ià(
¬’a
 =ğ
NULL
) {

664 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
),

665 &
¬’as_lock
);

666  (
NULL
);

668 ià(!!
j
 =ğ
š‹º®
)

669 
»t
 = 
¬’a
;

671 
	`¬’a_bšd
(
tsd
, 
choo£
[
j
], !!j);

673 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
¬’as_lock
);

675 
»t
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 0, 
çl£
);

676 
	`¬’a_bšd
(
tsd
, 0, 
çl£
);

677 
	`¬’a_bšd
(
tsd
, 0, 
Œue
);

680  (
»t
);

681 
	}
}

684 
	$th»ad_®loÿ‹d_ş—nup
(
tsd_t
 *
tsd
)

688 
	}
}

691 
	$th»ad_d—Îoÿ‹d_ş—nup
(
tsd_t
 *
tsd
)

695 
	}
}

698 
	$Ÿ»Ç_ş—nup
(
tsd_t
 *
tsd
)

700 
¬’a_t
 *
Ÿ»Ç
;

702 
Ÿ»Ç
 = 
	`tsd_Ÿ»Ç_g‘
(
tsd
);

703 ià(
Ÿ»Ç
 !ğ
NULL
)

704 
	`¬’a_unbšd
(
tsd
, 
Ÿ»Ç
->
šd
, 
Œue
);

705 
	}
}

708 
	$¬’a_ş—nup
(
tsd_t
 *
tsd
)

710 
¬’a_t
 *
¬’a
;

712 
¬’a
 = 
	`tsd_¬’a_g‘
(
tsd
);

713 ià(
¬’a
 !ğ
NULL
)

714 
	`¬’a_unbšd
(
tsd
, 
¬’a
->
šd
, 
çl£
);

715 
	}
}

718 
	$¬’as_td©a_ş—nup
(
tsd_t
 *
tsd
)

720 
¬’a_td©a_t
 *
¬’as_td©a
;

723 *
	`tsd_¬’as_td©a_by·s¥_g‘
(
tsd
èğ
Œue
;

725 
¬’as_td©a
 = 
	`tsd_¬’as_td©a_g‘
(
tsd
);

726 ià(
¬’as_td©a
 !ğ
NULL
) {

727 
	`tsd_¬’as_td©a_£t
(
tsd
, 
NULL
);

728 
	`a0d®loc
(
¬’as_td©a
);

730 
	}
}

733 
	$Ç»Çs_td©a_ş—nup
(
tsd_t
 *
tsd
)

737 
	}
}

740 
	$¬’as_td©a_by·ss_ş—nup
(
tsd_t
 *
tsd
)

744 
	}
}

747 
	$¡©s_´št_©ex™
()

750 ià(
cÚfig_tÿche
 && 
cÚfig_¡©s
) {

751 
tsdn_t
 *
tsdn
;

752 
Ç»Çs
, 
i
;

754 
tsdn
 = 
	`tsdn_ãtch
();

763 
i
 = 0, 
Ç»Çs
 = 
	`Ç»Çs_tÙ®_g‘
(); i <‚arenas; i++) {

764 
¬’a_t
 *
¬’a
 = 
	`¬’a_g‘
(
tsdn
, 
i
, 
çl£
);

765 ià(
¬’a
 !ğ
NULL
) {

766 
tÿche_t
 *
tÿche
;

774 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

775 
	`ql_fÜ—ch
(
tÿche
, &
¬’a
->
tÿche_ql
, 
lšk
) {

776 
	`tÿche_¡©s_m”ge
(
tsdn
, 
tÿche
, 
¬’a
);

778 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

782 
	`je_m®loc_¡©s_´št
(
NULL
, NULL, NULL);

783 
	}
}

793 #iâdeà
JEMALLOC_HAVE_SECURE_GETENV


795 
	$£cu»_g‘’v
(cÚ¡ *
Çme
)

798 #ifdeà
JEMALLOC_HAVE_ISSETUGID


799 ià(
	`is£tugid
() != 0)

800  (
NULL
);

802  (
	`g‘’v
(
Çme
));

803 
	}
}

807 
	$m®loc_nıus
()

809 
»suÉ
;

811 #ifdeà
_WIN32


812 
SYSTEM_INFO
 
si
;

813 
	`G‘Sy¡emInfo
(&
si
);

814 
»suÉ
 = 
si
.
dwNumb”OfProûssÜs
;

815 #–ià
	`defšed
(
JEMALLOC_GLIBC_MALLOC_HOOK
è&& defšed(
CPU_COUNT
)

824 
ıu_£t_t
 
£t
;

826 
	`±h»ad_g‘affš™y_Å
(
	`±h»ad_£lf
(), (
£t
), &set);

827 
»suÉ
 = 
	`CPU_COUNT
(&
£t
);

830 
»suÉ
 = 
	`syscÚf
(
_SC_NPROCESSORS_ONLN
);

832  ((
»suÉ
 == -1) ? 1 : ()result);

833 
	}
}

835 
boŞ


836 
	$m®loc_cÚf_Ãxt
(cÚ¡ **
İts_p
, cÚ¡ **
k_p
, 
size_t
 *
kËn_p
,

837 cÚ¡ **
v_p
, 
size_t
 *
vËn_p
)

839 
boŞ
 
acû±
;

840 cÚ¡ *
İts
 = *
İts_p
;

842 *
k_p
 = 
İts
;

844 
acû±
 = 
çl£
; !accept;) {

845 *
İts
) {

859 
İts
++;

862 
İts
++;

863 *
kËn_p
 = (
ušŒ_t
)
İts
 - 1 - (ušŒ_t)*
k_p
;

864 *
v_p
 = 
İts
;

865 
acû±
 = 
Œue
;

868 ià(
İts
 !ğ*
İts_p
) {

869 
	`m®loc_wr™e
("<jemalloc>: Conf stringƒnds "

872  (
Œue
);

874 
	`m®loc_wr™e
("<jemalloc>: Malformed conf string\n");

875  (
Œue
);

879 
acû±
 = 
çl£
; !accept;) {

880 *
İts
) {

882 
İts
++;

890 ià(*
İts
 == '\0') {

891 
	`m®loc_wr™e
("<jemalloc>: Conf stringƒnds "

894 *
vËn_p
 = (
ušŒ_t
)
İts
 - 1 - (ušŒ_t)*
v_p
;

895 
acû±
 = 
Œue
;

898 *
vËn_p
 = (
ušŒ_t
)
İts
 - (ušŒ_t)*
v_p
;

899 
acû±
 = 
Œue
;

902 
İts
++;

907 *
İts_p
 = 
İts
;

908  (
çl£
);

909 
	}
}

912 
	$m®loc_cÚf_”rÜ
(cÚ¡ *
msg
, cÚ¡ *
k
, 
size_t
 
kËn
, cÚ¡ *
v
,

913 
size_t
 
vËn
)

916 
	`m®loc_´štf
("<jem®loc>: %s: %.*s:%.*s\n", 
msg
, ()
kËn
, 
k
,

917 ()
vËn
, 
v
);

918 
	}
}

921 
	$m®loc_¦ow_æag_š™
()

927 
m®loc_¦ow_æags
 |ğ(
İt_junk_®loc
 ? 
æag_İt_junk_®loc
 : 0)

928 | (
İt_junk_ä“
 ? 
æag_İt_junk_ä“
 : 0)

929 | (
İt_qu¬ªtše
 ? 
æag_İt_qu¬ªtše
 : 0)

930 | (
İt_z”o
 ? 
æag_İt_z”o
 : 0)

931 | (
İt_uŒaû
 ? 
æag_İt_uŒaû
 : 0)

932 | (
İt_xm®loc
 ? 
æag_İt_xm®loc
 : 0);

934 ià(
cÚfig_v®gršd
)

935 
m®loc_¦ow_æags
 |ğ(
š_v®gršd
 ? 
æag_š_v®gršd
 : 0);

937 
m®loc_¦ow
 = (
m®loc_¦ow_æags
 != 0);

938 
	}
}

941 
	$m®loc_cÚf_š™
()

943 
i
;

944 
buf
[
PATH_MAX
 + 1];

945 cÚ¡ *
İts
, *
k
, *
v
;

946 
size_t
 
kËn
, 
vËn
;

952 ià(
cÚfig_v®gršd
) {

953 
š_v®gršd
 = (
RUNNING_ON_VALGRIND
 !ğ0è? 
Œue
 : 
çl£
;

954 ià(
cÚfig_fl
 && 
	`uÆik–y
(
š_v®gršd
)) {

955 
İt_junk
 = "false";

956 
İt_junk_®loc
 = 
çl£
;

957 
İt_junk_ä“
 = 
çl£
;

958 
	`as£¹
(!
İt_z”o
);

959 
İt_qu¬ªtše
 = 
JEMALLOC_VALGRIND_QUARANTINE_DEFAULT
;

960 
İt_»dzÚe
 = 
Œue
;

962 ià(
cÚfig_tÿche
 && 
	`uÆik–y
(
š_v®gršd
))

963 
İt_tÿche
 = 
çl£
;

966 
i
 = 0; i < 4; i++) {

968 
i
) {

970 
İts
 = 
cÚfig_m®loc_cÚf
;

973 ià(
je_m®loc_cÚf
 !ğ
NULL
) {

978 
İts
 = 
je_m®loc_cÚf
;

981 
buf
[0] = '\0';

982 
İts
 = 
buf
;

986 
ssize_t
 
lškËn
 = 0;

987 #iâdeà
_WIN32


988 
§ved_”ºo
 = 
”ºo
;

989 cÚ¡ *
lškÇme
 =

990 #ifdeà
JEMALLOC_PREFIX


991 "/‘c/"
JEMALLOC_PREFIX
"malloc.conf"

1001 
lškËn
 = 
	`»adlšk
(
lškÇme
, 
buf
, (buf) - 1);

1002 ià(
lškËn
 == -1) {

1004 
lškËn
 = 0;

1006 
	`£t_”ºo
(
§ved_”ºo
);

1009 
buf
[
lškËn
] = '\0';

1010 
İts
 = 
buf
;

1013 cÚ¡ *
’vÇme
 =

1014 #ifdeà
JEMALLOC_PREFIX


1015 
JEMALLOC_CPREFIX
"MALLOC_CONF"

1021 ià((
İts
 = 
	`£cu»_g‘’v
(
’vÇme
)è!ğ
NULL
) {

1029 
buf
[0] = '\0';

1030 
İts
 = 
buf
;

1034 
	`nÙ_»ached
();

1035 
buf
[0] = '\0';

1036 
İts
 = 
buf
;

1039 *
İts
 !ğ'\0' && !
	`m®loc_cÚf_Ãxt
(&İts, &
k
, &
kËn
, &
v
,

1040 &
vËn
)) {

1041 
	#CONF_MATCH
(
n
) \

1042 ((
n
)-1 =ğ
kËn
 && 
	`¡ºcmp
Ò, 
k
, kËnè=ğ0)

	)

1043 
	#CONF_MATCH_VALUE
(
n
) \

1044 ((
n
)-1 =ğ
vËn
 && 
	`¡ºcmp
Ò, 
v
, vËnè=ğ0)

	)

1045 
	#CONF_HANDLE_BOOL
(
o
, 
n
, 
cÚt
) \

1046 ià(
	`CONF_MATCH
(
n
)) { \

1047 ià(
	`CONF_MATCH_VALUE
("true")) \

1048 
o
 = 
Œue
; \

1049 ià(
	`CONF_MATCH_VALUE
("false")) \

1050 
o
 = 
çl£
; \

1052 
	`m®loc_cÚf_”rÜ
( \

1054 
k
, 
kËn
, 
v
, 
vËn
); \

1056 ià(
cÚt
) \

1058 }

	)

1059 
	#CONF_MIN_no
(
um
, 
mš
è
çl£


	)

1060 
	#CONF_MIN_yes
(
um
, 
mš
è((umè< (mš))

	)

1061 
	#CONF_MAX_no
(
um
, 
max
è
çl£


	)

1062 
	#CONF_MAX_yes
(
um
, 
max
è((umè> (max))

	)

1063 
	#CONF_HANDLE_T_U
(
t
, 
o
, 
n
, 
mš
, 
max
, 
check_mš
, 
check_max
, 
ş
) \

1064 ià(
	`CONF_MATCH
(
n
)) { \

1065 
uštmax_t
 
um
; \

1066 *
’d
; \

1068 
	`£t_”ºo
(0); \

1069 
um
 = 
	`m®loc_¡¹oumax
(
v
, &
’d
, 0); \

1070 ià(
	`g‘_”ºo
(è!ğ0 || (
ušŒ_t
)
’d
 -\

1071 (
ušŒ_t
)
v
 !ğ
vËn
) { \

1072 
	`m®loc_cÚf_”rÜ
( \

1074 
k
, 
kËn
, 
v
, 
vËn
); \

1075 } ià(
ş
) { \

1076 ià(
CONF_MIN_
##
	`check_mš
(
um
, \

1077 (
mš
))) \

1078 
o
 = (
t
)(
mš
); \

1079 ià(
CONF_MAX_
##
	`check_max
( \

1080 
um
, (
max
))) \

1081 
o
 = (
t
)(
max
); \

1083 
o
 = (
t
)
um
; \

1085 ià(
CONF_MIN_
##
	`check_mš
(
um
, \

1086 (
mš
)) || \

1087 
CONF_MAX_
##
	`check_max
(
um
, \

1088 (
max
))) { \

1089 
	`m®loc_cÚf_”rÜ
( \

1092 
k
, 
kËn
, 
v
, 
vËn
); \

1094 
o
 = (
t
)
um
; \

1097 }

	)

1098 
	#CONF_HANDLE_UNSIGNED
(
o
, 
n
, 
mš
, 
max
, 
check_mš
, 
check_max
, \

1099 
ş
) \

1100 
	`CONF_HANDLE_T_U
(, 
o
, 
n
, 
mš
, 
max
, \

1101 
check_mš
, 
check_max
, 
ş
)

	)

1102 
	#CONF_HANDLE_SIZE_T
(
o
, 
n
, 
mš
, 
max
, 
check_mš
, 
check_max
, 
ş
) \

1103 
	`CONF_HANDLE_T_U
(
size_t
, 
o
, 
n
, 
mš
, 
max
, \

1104 
check_mš
, 
check_max
, 
ş
)

	)

1105 
	#CONF_HANDLE_SSIZE_T
(
o
, 
n
, 
mš
, 
max
) \

1106 ià(
	`CONF_MATCH
(
n
)) { \

1107 
l
; \

1108 *
’d
; \

1110 
	`£t_”ºo
(0); \

1111 
l
 = 
	`¡¹Ş
(
v
, &
’d
, 0); \

1112 ià(
	`g‘_”ºo
(è!ğ0 || (
ušŒ_t
)
’d
 -\

1113 (
ušŒ_t
)
v
 !ğ
vËn
) { \

1114 
	`m®loc_cÚf_”rÜ
( \

1116 
k
, 
kËn
, 
v
, 
vËn
); \

1117 } ià(
l
 < (
ssize_t
)(
mš
) ||† > \

1118 (
ssize_t
)(
max
)) { \

1119 
	`m®loc_cÚf_”rÜ
( \

1121 
k
, 
kËn
, 
v
, 
vËn
); \

1123 
o
 = 
l
; \

1125 }

	)

1126 
	#CONF_HANDLE_CHAR_P
(
o
, 
n
, 
d
) \

1127 ià(
	`CONF_MATCH
(
n
)) { \

1128 
size_t
 
ıyËn
 = (
vËn
 <= \

1129 (
o
)-1è? 
vËn
 : \

1130 (
o
)-1; \

1131 
	`¡ºıy
(
o
, 
v
, 
ıyËn
); \

1132 
o
[
ıyËn
] = '\0'; \

1134 }

	)

1136 
	`CONF_HANDLE_BOOL
(
İt_abÜt
, "abÜt", 
Œue
)

1145 
	`CONF_HANDLE_SIZE_T
(
İt_lg_chunk
, "lg_chunk", 
LG_PAGE
 +

1146 
LG_SIZE_CLASS_GROUP
 + (
cÚfig_fl
 ? 2 : 1),

1147 ((
size_t
è<< 3è- 1, 
yes
, yes, 
Œue
)

1148 ià(
	`¡ºcmp
("dss", 
k
, 
kËn
) == 0) {

1149 
i
;

1150 
boŞ
 
m©ch
 = 
çl£
;

1151 
i
 = 0; i < 
dss_´ec_lim™
; i++) {

1152 ià(
	`¡ºcmp
(
dss_´ec_Çmes
[
i
], 
v
, 
vËn
)

1154 ià(
	`chunk_dss_´ec_£t
(
i
)) {

1155 
	`m®loc_cÚf_”rÜ
(

1157 
k
, 
kËn
, 
v
, 
vËn
);

1159 
İt_dss
 =

1160 
dss_´ec_Çmes
[
i
];

1161 
m©ch
 = 
Œue
;

1166 ià(!
m©ch
) {

1167 
	`m®loc_cÚf_”rÜ
("Invalid conf value",

1168 
k
, 
kËn
, 
v
, 
vËn
);

1172 
	`CONF_HANDLE_UNSIGNED
(
İt_Ç»Çs
, "narenas", 1,

1173 
UINT_MAX
, 
yes
, 
no
, 
çl£
)

1174 ià(
	`¡ºcmp
("purge", 
k
, 
kËn
) == 0) {

1175 
i
;

1176 
boŞ
 
m©ch
 = 
çl£
;

1177 
i
 = 0; i < 
purge_mode_lim™
; i++) {

1178 ià(
	`¡ºcmp
(
purge_mode_Çmes
[
i
], 
v
,

1179 
vËn
) == 0) {

1180 
İt_purge
 = (
purge_mode_t
)
i
;

1181 
m©ch
 = 
Œue
;

1185 ià(!
m©ch
) {

1186 
	`m®loc_cÚf_”rÜ
("Invalid conf value",

1187 
k
, 
kËn
, 
v
, 
vËn
);

1191 
	`CONF_HANDLE_SSIZE_T
(
İt_lg_dœty_muÉ
, "lg_dirty_mult",

1192 -1, ((
size_t
) << 3) - 1)

1193 
	`CONF_HANDLE_SSIZE_T
(
İt_deÿy_time
, "decay_time", -1,

1194 
NSTIME_SEC_MAX
);

1195 
	`CONF_HANDLE_BOOL
(
İt_¡©s_´št
, "¡©s_´št", 
Œue
)

1196 ià(
cÚfig_fl
) {

1197 ià(
	`CONF_MATCH
("junk")) {

1198 ià(
	`CONF_MATCH_VALUE
("true")) {

1199 ià(
cÚfig_v®gršd
 &&

1200 
	`uÆik–y
(
š_v®gršd
)) {

1201 
	`m®loc_cÚf_”rÜ
(

1206 "V®gršd", 
k
, 
kËn
, 
v
,

1207 
vËn
);

1209 
İt_junk
 = "true";

1210 
İt_junk_®loc
 = 
Œue
;

1211 
İt_junk_ä“
 = 
Œue
;

1213 } ià(
	`CONF_MATCH_VALUE
("false")) {

1214 
İt_junk
 = "false";

1215 
İt_junk_®loc
 = 
İt_junk_ä“
 =

1216 
çl£
;

1217 } ià(
	`CONF_MATCH_VALUE
("alloc")) {

1218 
İt_junk
 = "alloc";

1219 
İt_junk_®loc
 = 
Œue
;

1220 
İt_junk_ä“
 = 
çl£
;

1221 } ià(
	`CONF_MATCH_VALUE
("free")) {

1222 ià(
cÚfig_v®gršd
 &&

1223 
	`uÆik–y
(
š_v®gršd
)) {

1224 
	`m®loc_cÚf_”rÜ
(

1229 "V®gršd", 
k
, 
kËn
, 
v
,

1230 
vËn
);

1232 
İt_junk
 = "free";

1233 
İt_junk_®loc
 = 
çl£
;

1234 
İt_junk_ä“
 = 
Œue
;

1237 
	`m®loc_cÚf_”rÜ
(

1238 "Inv®id cÚàv®ue", 
k
,

1239 
kËn
, 
v
, 
vËn
);

1243 
	`CONF_HANDLE_SIZE_T
(
İt_qu¬ªtše
, "quarantine",

1244 0, 
SIZE_T_MAX
, 
no
,‚o, 
çl£
)

1245 
	`CONF_HANDLE_BOOL
(
İt_»dzÚe
, "»dzÚe", 
Œue
)

1246 
	`CONF_HANDLE_BOOL
(
İt_z”o
, "z”o", 
Œue
)

1248 ià(
cÚfig_uŒaû
) {

1249 
	`CONF_HANDLE_BOOL
(
İt_uŒaû
, "uŒaû", 
Œue
)

1251 ià(
cÚfig_xm®loc
) {

1252 
	`CONF_HANDLE_BOOL
(
İt_xm®loc
, "xm®loc", 
Œue
)

1254 ià(
cÚfig_tÿche
) {

1255 
	`CONF_HANDLE_BOOL
(
İt_tÿche
, "tcache",

1256 !
cÚfig_v®gršd
 || !
š_v®gršd
)

1257 ià(
	`CONF_MATCH
("tcache")) {

1258 
	`as£¹
(
cÚfig_v®gršd
 && 
š_v®gršd
);

1259 ià(
İt_tÿche
) {

1260 
İt_tÿche
 = 
çl£
;

1261 
	`m®loc_cÚf_”rÜ
(

1264 
k
, 
kËn
, 
v
, 
vËn
);

1268 
	`CONF_HANDLE_SSIZE_T
(
İt_lg_tÿche_max
,

1270 ((
size_t
) << 3) - 1)

1272 ià(
cÚfig_´of
) {

1273 
	`CONF_HANDLE_BOOL
(
İt_´of
, "´of", 
Œue
)

1274 
	`CONF_HANDLE_CHAR_P
(
İt_´of_´efix
,

1276 
	`CONF_HANDLE_BOOL
(
İt_´of_aùive
, "prof_active",

1277 
Œue
)

1278 
	`CONF_HANDLE_BOOL
(
İt_´of_th»ad_aùive_š™
,

1279 "´of_th»ad_aùive_š™", 
Œue
)

1280 
	`CONF_HANDLE_SIZE_T
(
İt_lg_´of_§m¶e
,

1281 "lg_´of_§m¶e", 0, ((
ušt64_t
) << 3)

1282 - 1, 
no
, 
yes
, 
Œue
)

1283 
	`CONF_HANDLE_BOOL
(
İt_´of_accum
, "prof_accum",

1284 
Œue
)

1285 
	`CONF_HANDLE_SSIZE_T
(
İt_lg_´of_š‹rv®
,

1287 ((
ušt64_t
) << 3) - 1)

1288 
	`CONF_HANDLE_BOOL
(
İt_´of_gdump
, "prof_gdump",

1289 
Œue
)

1290 
	`CONF_HANDLE_BOOL
(
İt_´of_fš®
, "prof_final",

1291 
Œue
)

1292 
	`CONF_HANDLE_BOOL
(
İt_´of_Ëak
, "prof_leak",

1293 
Œue
)

1295 
	`m®loc_cÚf_”rÜ
("Inv®id cÚà·œ", 
k
, 
kËn
, 
v
,

1296 
vËn
);

1297 #undeà
CONF_MATCH


1298 #undeà
CONF_MATCH_VALUE


1299 #undeà
CONF_HANDLE_BOOL


1300 #undeà
CONF_MIN_no


1301 #undeà
CONF_MIN_yes


1302 #undeà
CONF_MAX_no


1303 #undeà
CONF_MAX_yes


1304 #undeà
CONF_HANDLE_T_U


1305 #undeà
CONF_HANDLE_UNSIGNED


1306 #undeà
CONF_HANDLE_SIZE_T


1307 #undeà
CONF_HANDLE_SSIZE_T


1308 #undeà
CONF_HANDLE_CHAR_P


1311 
	}
}

1313 
boŞ


1314 
	$m®loc_š™_h¬d_Ãeded
()

1317 ià(
	`m®loc_š™Ÿlized
(è|| (
IS_INITIALIZER
 && 
m®loc_š™_¡©e
 ==

1318 
m®loc_š™_»cursibË
)) {

1324  (
çl£
);

1326 #ifdeà
JEMALLOC_THREADED_INIT


1327 ià(
m®loc_š™Ÿliz”
 !ğ
NO_INITIALIZER
 && !
IS_INITIALIZER
) {

1328 
¥š_t
 
¥šÃr
;

1331 
	`¥š_š™
(&
¥šÃr
);

1333 
	`m®loc_mu‹x_uÆock
(
TSDN_NULL
, &
š™_lock
);

1334 
	`¥š_ad­tive
(&
¥šÃr
);

1335 
	`m®loc_mu‹x_lock
(
TSDN_NULL
, &
š™_lock
);

1336 } !
	`m®loc_š™Ÿlized
());

1337  (
çl£
);

1340  (
Œue
);

1341 
	}
}

1343 
boŞ


1344 
	$m®loc_š™_h¬d_a0_locked
()

1347 
m®loc_š™Ÿliz”
 = 
INITIALIZER
;

1349 ià(
cÚfig_´of
)

1350 
	`´of_boÙ0
();

1351 
	`m®loc_cÚf_š™
();

1352 ià(
İt_¡©s_´št
) {

1354 ià(
	`©ex™
(
¡©s_´št_©ex™
) != 0) {

1355 
	`m®loc_wr™e
("<jemalloc>: Error in‡texit()\n");

1356 ià(
İt_abÜt
)

1357 
	`abÜt
();

1360 
	`·ges_boÙ
();

1361 ià(
	`ba£_boÙ
())

1362  (
Œue
);

1363 ià(
	`chunk_boÙ
())

1364  (
Œue
);

1365 ià(
	`ùl_boÙ
())

1366  (
Œue
);

1367 ià(
cÚfig_´of
)

1368 
	`´of_boÙ1
();

1369 
	`¬’a_boÙ
();

1370 ià(
cÚfig_tÿche
 && 
	`tÿche_boÙ
(
TSDN_NULL
))

1371  (
Œue
);

1372 ià(
	`m®loc_mu‹x_š™
(&
¬’as_lock
, "¬’as", 
WITNESS_RANK_ARENAS
))

1373  (
Œue
);

1378 
Ç»Çs_auto
 = 1;

1379 
	`Ç»Çs_tÙ®_£t
(
Ç»Çs_auto
);

1380 
¬’as
 = &
a0
;

1381 
	`mem£t
(
¬’as
, 0, (
¬’a_t
 *è* 
Ç»Çs_auto
);

1386 ià(
	`¬’a_š™
(
TSDN_NULL
, 0è=ğ
NULL
)

1387  (
Œue
);

1389 
m®loc_š™_¡©e
 = 
m®loc_š™_a0_š™Ÿlized
;

1391  (
çl£
);

1392 
	}
}

1394 
boŞ


1395 
	$m®loc_š™_h¬d_a0
()

1397 
boŞ
 
»t
;

1399 
	`m®loc_mu‹x_lock
(
TSDN_NULL
, &
š™_lock
);

1400 
»t
 = 
	`m®loc_š™_h¬d_a0_locked
();

1401 
	`m®loc_mu‹x_uÆock
(
TSDN_NULL
, &
š™_lock
);

1402  (
»t
);

1403 
	}
}

1406 
boŞ


1407 
	$m®loc_š™_h¬d_»cursibË
()

1410 
m®loc_š™_¡©e
 = 
m®loc_š™_»cursibË
;

1412 
nıus
 = 
	`m®loc_nıus
();

1414 #ià(
	`defšed
(
JEMALLOC_HAVE_PTHREAD_ATFORK
è&& !defšed(
JEMALLOC_MUTEX_INIT_CB
) \

1415 && !
	`defšed
(
JEMALLOC_ZONE
è&& !defšed(
_WIN32
) && \

1416 !
	`defšed
(
__Çtive_ş›Á__
))

1418 ià(
	`±h»ad_©fÜk
(
jem®loc_´efÜk
, 
jem®loc_po¡fÜk_·»Á
,

1419 
jem®loc_po¡fÜk_chd
) != 0) {

1420 
	`m®loc_wr™e
("<jemalloc>: Error in…thread_atfork()\n");

1421 ià(
İt_abÜt
)

1422 
	`abÜt
();

1423  (
Œue
);

1427  (
çl£
);

1428 
	}
}

1430 
boŞ


1431 
	$m®loc_š™_h¬d_fšish
(
tsdn_t
 *
tsdn
)

1434 ià(
	`m®loc_mu‹x_boÙ
())

1435  (
Œue
);

1437 ià(
İt_Ç»Çs
 == 0) {

1442 ià(
nıus
 > 1)

1443 
İt_Ç»Çs
 = 
nıus
 << 2;

1445 
İt_Ç»Çs
 = 1;

1447 
Ç»Çs_auto
 = 
İt_Ç»Çs
;

1451 ià(
Ç»Çs_auto
 > 
MALLOCX_ARENA_MAX
) {

1452 
Ç»Çs_auto
 = 
MALLOCX_ARENA_MAX
;

1453 
	`m®loc_´štf
("<jemalloc>: Reducing‚arenaso†imit (%d)\n",

1454 
Ç»Çs_auto
);

1456 
	`Ç»Çs_tÙ®_£t
(
Ç»Çs_auto
);

1459 
¬’as
 = (
¬’a_t
 **)
	`ba£_®loc
(
tsdn
, (arena_t *) *

1460 (
MALLOCX_ARENA_MAX
+1));

1461 ià(
¬’as
 =ğ
NULL
)

1462  (
Œue
);

1464 
	`¬’a_£t
(0, 
a0
);

1466 
m®loc_š™_¡©e
 = 
m®loc_š™_š™Ÿlized
;

1467 
	`m®loc_¦ow_æag_š™
();

1469  (
çl£
);

1470 
	}
}

1472 
boŞ


1473 
	$m®loc_š™_h¬d
()

1475 
tsd_t
 *
tsd
;

1477 #ià
	`defšed
(
_WIN32
è&& 
_WIN32_WINNT
 < 0x0600

1478 
	`_š™_š™_lock
();

1480 
	`m®loc_mu‹x_lock
(
TSDN_NULL
, &
š™_lock
);

1481 ià(!
	`m®loc_š™_h¬d_Ãeded
()) {

1482 
	`m®loc_mu‹x_uÆock
(
TSDN_NULL
, &
š™_lock
);

1483  (
çl£
);

1486 ià(
m®loc_š™_¡©e
 !ğ
m®loc_š™_a0_š™Ÿlized
 &&

1487 
	`m®loc_š™_h¬d_a0_locked
()) {

1488 
	`m®loc_mu‹x_uÆock
(
TSDN_NULL
, &
š™_lock
);

1489  (
Œue
);

1492 
	`m®loc_mu‹x_uÆock
(
TSDN_NULL
, &
š™_lock
);

1494 
tsd
 = 
	`m®loc_tsd_boÙ0
();

1495 ià(
tsd
 =ğ
NULL
)

1496  (
Œue
);

1497 ià(
	`m®loc_š™_h¬d_»cursibË
())

1498  (
Œue
);

1499 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
š™_lock
);

1501 ià(
cÚfig_´of
 && 
	`´of_boÙ2
(
tsd
)) {

1502 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
š™_lock
);

1503  (
Œue
);

1506 ià(
	`m®loc_š™_h¬d_fšish
(
	`tsd_tsdn
(
tsd
))) {

1507 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
š™_lock
);

1508  (
Œue
);

1511 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
š™_lock
);

1512 
	`m®loc_tsd_boÙ1
();

1513  (
çl£
);

1514 
	}
}

1525 
	$ŸÎoc_´of_§m¶e
(
tsd_t
 *
tsd
, 
size_t
 
usize
, 
szšd_t
 
šd
, 
boŞ
 
z”o
,

1526 
´of_tùx_t
 *
tùx
, 
boŞ
 
¦ow_·th
)

1528 *
p
;

1530 ià(
tùx
 =ğ
NULL
)

1531  (
NULL
);

1532 ià(
usize
 <ğ
SMALL_MAXCLASS
) {

1533 
szšd_t
 
šd_Ïrge
 = 
	`size2šdex
(
LARGE_MINCLASS
);

1534 
p
 = 
	`ŸÎoc
(
tsd
, 
LARGE_MINCLASS
, 
šd_Ïrge
, 
z”o
, 
¦ow_·th
);

1535 ià(
p
 =ğ
NULL
)

1536  (
NULL
);

1537 
	`¬’a_´of_´omÙed
(
	`tsd_tsdn
(
tsd
), 
p
, 
usize
);

1539 
p
 = 
	`ŸÎoc
(
tsd
, 
usize
, 
šd
, 
z”o
, 
¦ow_·th
);

1541  (
p
);

1542 
	}
}

1544 
JEMALLOC_ALWAYS_INLINE_C
 *

1545 
	$ŸÎoc_´of
(
tsd_t
 *
tsd
, 
size_t
 
usize
, 
szšd_t
 
šd
, 
boŞ
 
z”o
, boŞ 
¦ow_·th
)

1547 *
p
;

1548 
´of_tùx_t
 *
tùx
;

1550 
tùx
 = 
	`´of_®loc_´•
(
tsd
, 
usize
, 
	`´of_aùive_g‘_uÆocked
(), 
Œue
);

1551 ià(
	`uÆik–y
((
ušŒ_t
)
tùx
 != (uintptr_t)1U))

1552 
p
 = 
	`ŸÎoc_´of_§m¶e
(
tsd
, 
usize
, 
šd
, 
z”o
, 
tùx
, 
¦ow_·th
);

1554 
p
 = 
	`ŸÎoc
(
tsd
, 
usize
, 
šd
, 
z”o
, 
¦ow_·th
);

1555 ià(
	`uÆik–y
(
p
 =ğ
NULL
)) {

1556 
	`´of_®loc_rŞlback
(
tsd
, 
tùx
, 
Œue
);

1557  (
NULL
);

1559 
	`´of_m®loc
(
	`tsd_tsdn
(
tsd
), 
p
, 
usize
, 
tùx
);

1561  (
p
);

1562 
	}
}

1570 
JEMALLOC_ALWAYS_INLINE_C
 *

1571 
	$ŸÎoc_body
(
size_t
 
size
, 
boŞ
 
z”o
, 
tsdn_t
 **
tsdn
, size_ˆ*
usize
,

1572 
boŞ
 
¦ow_·th
)

1574 
tsd_t
 *
tsd
;

1575 
szšd_t
 
šd
;

1577 ià(
¦ow_·th
 && 
	`uÆik–y
(
	`m®loc_š™
())) {

1578 *
tsdn
 = 
NULL
;

1579  (
NULL
);

1582 
tsd
 = 
	`tsd_ãtch
();

1583 *
tsdn
 = 
	`tsd_tsdn
(
tsd
);

1584 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

1586 
šd
 = 
	`size2šdex
(
size
);

1587 ià(
	`uÆik–y
(
šd
 >ğ
NSIZES
))

1588  (
NULL
);

1590 ià(
cÚfig_¡©s
 || (
cÚfig_´of
 && 
İt_´of
è|| (
¦ow_·th
 &&

1591 
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
))) {

1592 *
usize
 = 
	`šdex2size
(
šd
);

1593 
	`as£¹
(*
usize
 > 0 && *usiz<ğ
HUGE_MAXCLASS
);

1596 ià(
cÚfig_´of
 && 
İt_´of
)

1597  (
	`ŸÎoc_´of
(
tsd
, *
usize
, 
šd
, 
z”o
, 
¦ow_·th
));

1599  (
	`ŸÎoc
(
tsd
, 
size
, 
šd
, 
z”o
, 
¦ow_·th
));

1600 
	}
}

1602 
JEMALLOC_ALWAYS_INLINE_C
 

1603 
	$ŸÎoc_po¡_check
(*
»t
, 
tsdn_t
 *
tsdn
, 
size_t
 
usize
, cÚ¡ *
func
,

1604 
boŞ
 
upd©e_”ºo
, boŞ 
¦ow_·th
)

1607 
	`as£¹
(!
	`tsdn_nuÎ
(
tsdn
è|| 
»t
 =ğ
NULL
);

1609 ià(
	`uÆik–y
(
»t
 =ğ
NULL
)) {

1610 ià(
¦ow_·th
 && 
cÚfig_xm®loc
 && 
	`uÆik–y
(
İt_xm®loc
)) {

1611 
	`m®loc_´štf
("<jemalloc>: Error in %s(): out of "

1612 "memÜy\n", 
func
);

1613 
	`abÜt
();

1615 ià(
upd©e_”ºo
)

1616 
	`£t_”ºo
(
ENOMEM
);

1618 ià(
cÚfig_¡©s
 && 
	`lik–y
(
»t
 !ğ
NULL
)) {

1619 
	`as£¹
(
usize
 =ğ
	`i§Îoc
(
tsdn
, 
»t
, 
cÚfig_´of
));

1620 *
	`tsd_th»ad_®loÿ‹dp_g‘
(
	`tsdn_tsd
(
tsdn
)è+ğ
usize
;

1622 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

1623 
	}
}

1625 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


1626 
JEMALLOC_NOTHROW
 *

1627 
	$JEMALLOC_ATTR
(
m®loc
è
	$JEMALLOC_ALLOC_SIZE
(1)

1628 
	$je_m®loc
(
size_t
 
size
)

1630 *
»t
;

1631 
tsdn_t
 *
tsdn
;

1632 
size_t
 
usize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

1634 ià(
size
 == 0)

1635 
size
 = 1;

1637 ià(
	`lik–y
(!
m®loc_¦ow
)) {

1638 
»t
 = 
	`ŸÎoc_body
(
size
, 
çl£
, &
tsdn
, &
usize
, false);

1639 
	`ŸÎoc_po¡_check
(
»t
, 
tsdn
, 
usize
, "m®loc", 
Œue
, 
çl£
);

1641 
»t
 = 
	`ŸÎoc_body
(
size
, 
çl£
, &
tsdn
, &
usize
, 
Œue
);

1642 
	`ŸÎoc_po¡_check
(
»t
, 
tsdn
, 
usize
, "m®loc", 
Œue
,rue);

1643 
	`UTRACE
(0, 
size
, 
»t
);

1644 
	`JEMALLOC_VALGRIND_MALLOC
(
»t
 !ğ
NULL
, 
tsdn
,„‘, 
usize
, 
çl£
);

1647  (
»t
);

1648 
	}
}

1651 
	$imem®ign_´of_§m¶e
(
tsd_t
 *
tsd
, 
size_t
 
®ignm’t
, size_ˆ
usize
,

1652 
´of_tùx_t
 *
tùx
)

1654 *
p
;

1656 ià(
tùx
 =ğ
NULL
)

1657  (
NULL
);

1658 ià(
usize
 <ğ
SMALL_MAXCLASS
) {

1659 
	`as£¹
(
	`§2u
(
LARGE_MINCLASS
, 
®ignm’t
) == LARGE_MINCLASS);

1660 
p
 = 
	`®loc
(
tsd
, 
LARGE_MINCLASS
, 
®ignm’t
, 
çl£
);

1661 ià(
p
 =ğ
NULL
)

1662  (
NULL
);

1663 
	`¬’a_´of_´omÙed
(
	`tsd_tsdn
(
tsd
), 
p
, 
usize
);

1665 
p
 = 
	`®loc
(
tsd
, 
usize
, 
®ignm’t
, 
çl£
);

1667  (
p
);

1668 
	}
}

1670 
JEMALLOC_ALWAYS_INLINE_C
 *

1671 
	$imem®ign_´of
(
tsd_t
 *
tsd
, 
size_t
 
®ignm’t
, size_ˆ
usize
)

1673 *
p
;

1674 
´of_tùx_t
 *
tùx
;

1676 
tùx
 = 
	`´of_®loc_´•
(
tsd
, 
usize
, 
	`´of_aùive_g‘_uÆocked
(), 
Œue
);

1677 ià(
	`uÆik–y
((
ušŒ_t
)
tùx
 != (uintptr_t)1U))

1678 
p
 = 
	`imem®ign_´of_§m¶e
(
tsd
, 
®ignm’t
, 
usize
, 
tùx
);

1680 
p
 = 
	`®loc
(
tsd
, 
usize
, 
®ignm’t
, 
çl£
);

1681 ià(
	`uÆik–y
(
p
 =ğ
NULL
)) {

1682 
	`´of_®loc_rŞlback
(
tsd
, 
tùx
, 
Œue
);

1683  (
NULL
);

1685 
	`´of_m®loc
(
	`tsd_tsdn
(
tsd
), 
p
, 
usize
, 
tùx
);

1687  (
p
);

1688 
	}
}

1690 
JEMALLOC_ATTR
(
	$nÚnuÎ
(1))

1692 
	$imem®ign
(**
mem±r
, 
size_t
 
®ignm’t
, size_ˆ
size
, size_ˆ
mš_®ignm’t
)

1694 
»t
;

1695 
tsd_t
 *
tsd
;

1696 
size_t
 
usize
;

1697 *
»suÉ
;

1699 
	`as£¹
(
mš_®ignm’t
 != 0);

1701 ià(
	`uÆik–y
(
	`m®loc_š™
())) {

1702 
tsd
 = 
NULL
;

1703 
»suÉ
 = 
NULL
;

1704 
Ïb–_oom
;

1706 
tsd
 = 
	`tsd_ãtch
();

1707 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

1708 ià(
size
 == 0)

1709 
size
 = 1;

1712 ià(
	`uÆik–y
(((
®ignm’t
 - 1) &‡lignment) != 0

1713 || (
®ignm’t
 < 
mš_®ignm’t
))) {

1714 ià(
cÚfig_xm®loc
 && 
	`uÆik–y
(
İt_xm®loc
)) {

1715 
	`m®loc_wr™e
("<jemalloc>: Error‡llocating "

1717 
	`abÜt
();

1719 
»suÉ
 = 
NULL
;

1720 
»t
 = 
EINVAL
;

1721 
Ïb–_»tuº
;

1724 
usize
 = 
	`§2u
(
size
, 
®ignm’t
);

1725 ià(
	`uÆik–y
(
usize
 =ğ0 || usiz> 
HUGE_MAXCLASS
)) {

1726 
»suÉ
 = 
NULL
;

1727 
Ïb–_oom
;

1730 ià(
cÚfig_´of
 && 
İt_´of
)

1731 
»suÉ
 = 
	`imem®ign_´of
(
tsd
, 
®ignm’t
, 
usize
);

1733 
»suÉ
 = 
	`®loc
(
tsd
, 
usize
, 
®ignm’t
, 
çl£
);

1734 ià(
	`uÆik–y
(
»suÉ
 =ğ
NULL
))

1735 
Ïb–_oom
;

1736 
	`as£¹
(((
ušŒ_t
)
»suÉ
 & (
®ignm’t
 - 1)è=ğ
	`ZU
(0));

1738 *
mem±r
 = 
»suÉ
;

1739 
»t
 = 0;

1740 
Ïb–_»tuº
:

1741 ià(
cÚfig_¡©s
 && 
	`lik–y
(
»suÉ
 !ğ
NULL
)) {

1742 
	`as£¹
(
usize
 =ğ
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
»suÉ
, 
cÚfig_´of
));

1743 *
	`tsd_th»ad_®loÿ‹dp_g‘
(
tsd
è+ğ
usize
;

1745 
	`UTRACE
(0, 
size
, 
»suÉ
);

1746 
	`JEMALLOC_VALGRIND_MALLOC
(
»suÉ
 !ğ
NULL
, 
	`tsd_tsdn
(
tsd
),„esuÉ, 
usize
,

1747 
çl£
);

1748 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

1749  (
»t
);

1750 
Ïb–_oom
:

1751 
	`as£¹
(
»suÉ
 =ğ
NULL
);

1752 ià(
cÚfig_xm®loc
 && 
	`uÆik–y
(
İt_xm®loc
)) {

1753 
	`m®loc_wr™e
("<jemalloc>: Error‡llocating‡ligned memory: "

1755 
	`abÜt
();

1757 
»t
 = 
ENOMEM
;

1758 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

1759 
Ïb–_»tuº
;

1760 
	}
}

1762 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW


1763 
JEMALLOC_ATTR
(
	$nÚnuÎ
(1))

1764 
	$je_posix_mem®ign
(**
mem±r
, 
size_t
 
®ignm’t
, size_ˆ
size
)

1766 
»t
;

1768 
»t
 = 
	`imem®ign
(
mem±r
, 
®ignm’t
, 
size
, (*));

1770  (
»t
);

1771 
	}
}

1773 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


1774 
JEMALLOC_NOTHROW
 *

1775 
	$JEMALLOC_ATTR
(
m®loc
è
	$JEMALLOC_ALLOC_SIZE
(2)

1776 
	$je_®igÃd_®loc
(
size_t
 
®ignm’t
, size_ˆ
size
)

1778 *
»t
;

1779 
”r
;

1781 ià(
	`uÆik–y
((
”r
 = 
	`imem®ign
(&
»t
, 
®ignm’t
, 
size
, 1)) != 0)) {

1782 
»t
 = 
NULL
;

1783 
	`£t_”ºo
(
”r
);

1786  (
»t
);

1787 
	}
}

1789 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


1790 
JEMALLOC_NOTHROW
 *

1791 
	$JEMALLOC_ATTR
(
m®loc
è
	$JEMALLOC_ALLOC_SIZE2
(1, 2)

1792 
	$je_ÿÎoc
(
size_t
 
num
, size_ˆ
size
)

1794 *
»t
;

1795 
tsdn_t
 *
tsdn
;

1796 
size_t
 
num_size
;

1797 
size_t
 
usize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

1799 
num_size
 = 
num
 * 
size
;

1800 ià(
	`uÆik–y
(
num_size
 == 0)) {

1801 ià(
num
 =ğ0 || 
size
 == 0)

1802 
num_size
 = 1;

1804 
num_size
 = 
HUGE_MAXCLASS
 + 1;

1810 } ià(
	`uÆik–y
(((
num
 | 
size
è& (
SIZE_T_MAX
 << ((
size_t
) <<

1811 2))è&& (
num_size
 / 
size
 !ğ
num
)))

1812 
num_size
 = 
HUGE_MAXCLASS
 + 1;

1814 ià(
	`lik–y
(!
m®loc_¦ow
)) {

1815 
»t
 = 
	`ŸÎoc_body
(
num_size
, 
Œue
, &
tsdn
, &
usize
, 
çl£
);

1816 
	`ŸÎoc_po¡_check
(
»t
, 
tsdn
, 
usize
, "ÿÎoc", 
Œue
, 
çl£
);

1818 
»t
 = 
	`ŸÎoc_body
(
num_size
, 
Œue
, &
tsdn
, &
usize
,rue);

1819 
	`ŸÎoc_po¡_check
(
»t
, 
tsdn
, 
usize
, "ÿÎoc", 
Œue
,rue);

1820 
	`UTRACE
(0, 
num_size
, 
»t
);

1821 
	`JEMALLOC_VALGRIND_MALLOC
(
»t
 !ğ
NULL
, 
tsdn
,„‘, 
usize
, 
Œue
);

1824  (
»t
);

1825 
	}
}

1828 
	$œ—Îoc_´of_§m¶e
(
tsd_t
 *
tsd
, *
Şd_±r
, 
size_t
 
Şd_usize
, size_ˆ
usize
,

1829 
´of_tùx_t
 *
tùx
)

1831 *
p
;

1833 ià(
tùx
 =ğ
NULL
)

1834  (
NULL
);

1835 ià(
usize
 <ğ
SMALL_MAXCLASS
) {

1836 
p
 = 
	`œ®loc
(
tsd
, 
Şd_±r
, 
Şd_usize
, 
LARGE_MINCLASS
, 0, 
çl£
);

1837 ià(
p
 =ğ
NULL
)

1838  (
NULL
);

1839 
	`¬’a_´of_´omÙed
(
	`tsd_tsdn
(
tsd
), 
p
, 
usize
);

1841 
p
 = 
	`œ®loc
(
tsd
, 
Şd_±r
, 
Şd_usize
, 
usize
, 0, 
çl£
);

1843  (
p
);

1844 
	}
}

1846 
JEMALLOC_ALWAYS_INLINE_C
 *

1847 
	$œ—Îoc_´of
(
tsd_t
 *
tsd
, *
Şd_±r
, 
size_t
 
Şd_usize
, size_ˆ
usize
)

1849 *
p
;

1850 
boŞ
 
´of_aùive
;

1851 
´of_tùx_t
 *
Şd_tùx
, *
tùx
;

1853 
´of_aùive
 = 
	`´of_aùive_g‘_uÆocked
();

1854 
Şd_tùx
 = 
	`´of_tùx_g‘
(
	`tsd_tsdn
(
tsd
), 
Şd_±r
);

1855 
tùx
 = 
	`´of_®loc_´•
(
tsd
, 
usize
, 
´of_aùive
, 
Œue
);

1856 ià(
	`uÆik–y
((
ušŒ_t
)
tùx
 != (uintptr_t)1U))

1857 
p
 = 
	`œ—Îoc_´of_§m¶e
(
tsd
, 
Şd_±r
, 
Şd_usize
, 
usize
, 
tùx
);

1859 
p
 = 
	`œ®loc
(
tsd
, 
Şd_±r
, 
Şd_usize
, 
usize
, 0, 
çl£
);

1860 ià(
	`uÆik–y
(
p
 =ğ
NULL
)) {

1861 
	`´of_®loc_rŞlback
(
tsd
, 
tùx
, 
Œue
);

1862  (
NULL
);

1864 
	`´of_»®loc
(
tsd
, 
p
, 
usize
, 
tùx
, 
´of_aùive
, 
Œue
, 
Şd_±r
, 
Şd_usize
,

1865 
Şd_tùx
);

1867  (
p
);

1868 
	}
}

1870 
JEMALLOC_INLINE_C
 

1871 
	$iä“
(
tsd_t
 *
tsd
, *
±r
, 
tÿche_t
 *
tÿche
, 
boŞ
 
¦ow_·th
)

1873 
size_t
 
usize
;

1874 
UNUSED
 
size_t
 
rzsize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

1876 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

1878 
	`as£¹
(
±r
 !ğ
NULL
);

1879 
	`as£¹
(
	`m®loc_š™Ÿlized
(è|| 
IS_INITIALIZER
);

1881 ià(
cÚfig_´of
 && 
İt_´of
) {

1882 
usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
cÚfig_´of
);

1883 
	`´of_ä“
(
tsd
, 
±r
, 
usize
);

1884 } ià(
cÚfig_¡©s
 || 
cÚfig_v®gršd
)

1885 
usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
cÚfig_´of
);

1886 ià(
cÚfig_¡©s
)

1887 *
	`tsd_th»ad_d—Îoÿ‹dp_g‘
(
tsd
è+ğ
usize
;

1889 ià(
	`lik–y
(!
¦ow_·th
))

1890 
	`iq®loc
(
tsd
, 
±r
, 
tÿche
, 
çl£
);

1892 ià(
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
))

1893 
rzsize
 = 
	`p2rz
(
	`tsd_tsdn
(
tsd
), 
±r
);

1894 
	`iq®loc
(
tsd
, 
±r
, 
tÿche
, 
Œue
);

1895 
	`JEMALLOC_VALGRIND_FREE
(
±r
, 
rzsize
);

1897 
	}
}

1899 
JEMALLOC_INLINE_C
 

1900 
	$isä“
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
usize
, 
tÿche_t
 *
tÿche
, 
boŞ
 
¦ow_·th
)

1902 
UNUSED
 
size_t
 
rzsize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

1904 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

1906 
	`as£¹
(
±r
 !ğ
NULL
);

1907 
	`as£¹
(
	`m®loc_š™Ÿlized
(è|| 
IS_INITIALIZER
);

1909 ià(
cÚfig_´of
 && 
İt_´of
)

1910 
	`´of_ä“
(
tsd
, 
±r
, 
usize
);

1911 ià(
cÚfig_¡©s
)

1912 *
	`tsd_th»ad_d—Îoÿ‹dp_g‘
(
tsd
è+ğ
usize
;

1913 ià(
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
))

1914 
rzsize
 = 
	`p2rz
(
	`tsd_tsdn
(
tsd
), 
±r
);

1915 
	`isq®loc
(
tsd
, 
±r
, 
usize
, 
tÿche
, 
¦ow_·th
);

1916 
	`JEMALLOC_VALGRIND_FREE
(
±r
, 
rzsize
);

1917 
	}
}

1919 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


1920 
JEMALLOC_NOTHROW
 *

1921 
	$JEMALLOC_ALLOC_SIZE
(2)

1922 
	$je_»®loc
(*
±r
, 
size_t
 
size
)

1924 *
»t
;

1925 
tsdn_t
 *
tsdn
 
	`JEMALLOC_CC_SILENCE_INIT
(
NULL
);

1926 
size_t
 
usize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

1927 
size_t
 
Şd_usize
 = 0;

1928 
UNUSED
 
size_t
 
Şd_rzsize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

1930 ià(
	`uÆik–y
(
size
 == 0)) {

1931 ià(
±r
 !ğ
NULL
) {

1932 
tsd_t
 *
tsd
;

1935 
	`UTRACE
(
±r
, 0, 0);

1936 
tsd
 = 
	`tsd_ãtch
();

1937 
	`iä“
(
tsd
, 
±r
, 
	`tÿche_g‘
Ñsd, 
çl£
), 
Œue
);

1938  (
NULL
);

1940 
size
 = 1;

1943 ià(
	`lik–y
(
±r
 !ğ
NULL
)) {

1944 
tsd_t
 *
tsd
;

1946 
	`as£¹
(
	`m®loc_š™Ÿlized
(è|| 
IS_INITIALIZER
);

1947 
	`m®loc_th»ad_š™
();

1948 
tsd
 = 
	`tsd_ãtch
();

1950 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

1952 
Şd_usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
cÚfig_´of
);

1953 ià(
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
)) {

1954 
Şd_rzsize
 = 
cÚfig_´of
 ? 
	`p2rz
(
	`tsd_tsdn
(
tsd
), 
±r
) :

1955 
	`u2rz
(
Şd_usize
);

1958 ià(
cÚfig_´of
 && 
İt_´of
) {

1959 
usize
 = 
	`s2u
(
size
);

1960 
»t
 = 
	`uÆik–y
(
usize
 =ğ0 || usiz> 
HUGE_MAXCLASS
) ?

1961 
NULL
 : 
	`œ—Îoc_´of
(
tsd
, 
±r
, 
Şd_usize
, 
usize
);

1963 ià(
cÚfig_¡©s
 || (
cÚfig_v®gršd
 &&

1964 
	`uÆik–y
(
š_v®gršd
)))

1965 
usize
 = 
	`s2u
(
size
);

1966 
»t
 = 
	`œ®loc
(
tsd
, 
±r
, 
Şd_usize
, 
size
, 0, 
çl£
);

1968 
tsdn
 = 
	`tsd_tsdn
(
tsd
);

1971 ià(
	`lik–y
(!
m®loc_¦ow
))

1972 
»t
 = 
	`ŸÎoc_body
(
size
, 
çl£
, &
tsdn
, &
usize
, false);

1974 
»t
 = 
	`ŸÎoc_body
(
size
, 
çl£
, &
tsdn
, &
usize
, 
Œue
);

1975 
	`as£¹
(!
	`tsdn_nuÎ
(
tsdn
è|| 
»t
 =ğ
NULL
);

1978 ià(
	`uÆik–y
(
»t
 =ğ
NULL
)) {

1979 ià(
cÚfig_xm®loc
 && 
	`uÆik–y
(
İt_xm®loc
)) {

1980 
	`m®loc_wr™e
("<jemalloc>: Error in„ealloc(): "

1982 
	`abÜt
();

1984 
	`£t_”ºo
(
ENOMEM
);

1986 ià(
cÚfig_¡©s
 && 
	`lik–y
(
»t
 !ğ
NULL
)) {

1987 
tsd_t
 *
tsd
;

1989 
	`as£¹
(
usize
 =ğ
	`i§Îoc
(
tsdn
, 
»t
, 
cÚfig_´of
));

1990 
tsd
 = 
	`tsdn_tsd
(
tsdn
);

1991 *
	`tsd_th»ad_®loÿ‹dp_g‘
(
tsd
è+ğ
usize
;

1992 *
	`tsd_th»ad_d—Îoÿ‹dp_g‘
(
tsd
è+ğ
Şd_usize
;

1994 
	`UTRACE
(
±r
, 
size
, 
»t
);

1995 
	`JEMALLOC_VALGRIND_REALLOC
(
maybe
, 
tsdn
, 
»t
, 
usize
, maybe, 
±r
,

1996 
Şd_usize
, 
Şd_rzsize
, 
maybe
, 
çl£
);

1997 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

1998  (
»t
);

1999 
	}
}

2001 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW


2002 
	$je_ä“
(*
±r
)

2005 
	`UTRACE
(
±r
, 0, 0);

2006 ià(
	`lik–y
(
±r
 !ğ
NULL
)) {

2007 
tsd_t
 *
tsd
 = 
	`tsd_ãtch
();

2008 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2009 ià(
	`lik–y
(!
m®loc_¦ow
))

2010 
	`iä“
(
tsd
, 
±r
, 
	`tÿche_g‘
Ñsd, 
çl£
), false);

2012 
	`iä“
(
tsd
, 
±r
, 
	`tÿche_g‘
Ñsd, 
çl£
), 
Œue
);

2013 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2015 
	}
}

2025 #ifdeà
JEMALLOC_OVERRIDE_MEMALIGN


2026 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


2027 
JEMALLOC_NOTHROW
 *

2028 
	$JEMALLOC_ATTR
(
m®loc
)

2029 
	$je_mem®ign
(
size_t
 
®ignm’t
, size_ˆ
size
)

2031 *
»t
 
	`JEMALLOC_CC_SILENCE_INIT
(
NULL
);

2032 ià(
	`uÆik–y
(
	`imem®ign
(&
»t
, 
®ignm’t
, 
size
, 1) != 0))

2033 
»t
 = 
NULL
;

2034  (
»t
);

2035 
	}
}

2038 #ifdeà
JEMALLOC_OVERRIDE_VALLOC


2039 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


2040 
JEMALLOC_NOTHROW
 *

2041 
	$JEMALLOC_ATTR
(
m®loc
)

2042 
	$je_v®loc
(
size_t
 
size
)

2044 *
»t
 
	`JEMALLOC_CC_SILENCE_INIT
(
NULL
);

2045 ià(
	`uÆik–y
(
	`imem®ign
(&
»t
, 
PAGE
, 
size
, 1) != 0))

2046 
»t
 = 
NULL
;

2047  (
»t
);

2048 
	}
}

2055 
	#m®loc_is_m®loc
 1

	)

2056 
	#is_m®loc_
(
a
è
m®loc_is_
 ## 
	)
a

2057 
	#is_m®loc
(
a
è
	`is_m®loc_
×)

	)

2059 #ià((
is_m®loc
(
je_m®loc
è=ğ1è&& 
defšed
(
JEMALLOC_GLIBC_MALLOC_HOOK
))

2069 
JEMALLOC_EXPORT
 (*
__ä“_hook
)(*
±r
èğ
je_ä“
;

2070 
JEMALLOC_EXPORT
 *(*
__m®loc_hook
)(
size_t
 
size
èğ
je_m®loc
;

2071 
JEMALLOC_EXPORT
 *(*
__»®loc_hook
)(*
±r
, 
size_t
 
size
èğ
je_»®loc
;

2072 #ifdeà
JEMALLOC_GLIBC_MEMALIGN_HOOK


2073 
JEMALLOC_EXPORT
 *(*
__mem®ign_hook
)(
size_t
 
®ignm’t
, size_ˆ
size
) =

2074 
je_mem®ign
;

2077 #ifdeà
CPU_COUNT


2083 
	#ALIAS
(
je_â
è
	`__©Œibu‹__
((
	`®Ÿs
 (#je_â), 
u£d
))

	)

2085 
	#PREALIAS
(
je_â
è
	`ALIAS
(je_â)

	)

2086 *
	$__libc_m®loc
(
size_t
 
size
è
	`PREALIAS
(
je_m®loc
);

2087 
	$__libc_ä“
(* 
±r
è
	`PREALIAS
(
je_ä“
);

2088 *
	$__libc_»®loc
(* 
±r
, 
size_t
 
size
è
	`PREALIAS
(
je_»®loc
);

2089 *
	$__libc_ÿÎoc
(
size_t
 
n
, size_ˆ
size
è
	`PREALIAS
(
je_ÿÎoc
);

2090 *
	$__libc_mem®ign
(
size_t
 
®ign
, size_ˆ
s
è
	`PREALIAS
(
je_mem®ign
);

2091 *
	$__libc_v®loc
(
size_t
 
size
è
	`PREALIAS
(
je_v®loc
);

2092 
	$__posix_mem®ign
(** 
r
, 
size_t
 
a
, size_ˆ
s
)

2093 
	`PREALIAS
(
je_posix_mem®ign
);

2094 #undeà
PREALIAS


2095 #undeà
ALIAS


2109 
JEMALLOC_ALWAYS_INLINE_C
 
boŞ


2110 
	$im®locx_æags_decode
(
tsd_t
 *
tsd
, 
size_t
 
size
, 
æags
, size_ˆ*
usize
,

2111 
size_t
 *
®ignm’t
, 
boŞ
 *
z”o
, 
tÿche_t
 **
tÿche
, 
¬’a_t
 **
¬’a
)

2114 ià((
æags
 & 
MALLOCX_LG_ALIGN_MASK
) == 0) {

2115 *
®ignm’t
 = 0;

2116 *
usize
 = 
	`s2u
(
size
);

2118 *
®ignm’t
 = 
	`MALLOCX_ALIGN_GET_SPECIFIED
(
æags
);

2119 *
usize
 = 
	`§2u
(
size
, *
®ignm’t
);

2121 ià(
	`uÆik–y
(*
usize
 =ğ0 || *usiz> 
HUGE_MAXCLASS
))

2122  (
Œue
);

2123 *
z”o
 = 
	`MALLOCX_ZERO_GET
(
æags
);

2124 ià((
æags
 & 
MALLOCX_TCACHE_MASK
) != 0) {

2125 ià((
æags
 & 
MALLOCX_TCACHE_MASK
è=ğ
MALLOCX_TCACHE_NONE
)

2126 *
tÿche
 = 
NULL
;

2128 *
tÿche
 = 
	`tÿches_g‘
(
tsd
, 
	`MALLOCX_TCACHE_GET
(
æags
));

2130 *
tÿche
 = 
	`tÿche_g‘
(
tsd
, 
Œue
);

2131 ià((
æags
 & 
MALLOCX_ARENA_MASK
) != 0) {

2132 
¬’a_šd
 = 
	`MALLOCX_ARENA_GET
(
æags
);

2133 *
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a_šd
, 
Œue
);

2134 ià(
	`uÆik–y
(*
¬’a
 =ğ
NULL
))

2135  (
Œue
);

2137 *
¬’a
 = 
NULL
;

2138  (
çl£
);

2139 
	}
}

2141 
JEMALLOC_ALWAYS_INLINE_C
 *

2142 
	$im®locx_æags
(
tsdn_t
 *
tsdn
, 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
,

2143 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
, 
boŞ
 
¦ow_·th
)

2145 
szšd_t
 
šd
;

2147 ià(
	`uÆik–y
(
®ignm’t
 != 0))

2148  (
	`®loù
(
tsdn
, 
usize
, 
®ignm’t
, 
z”o
, 
tÿche
, 
¬’a
));

2149 
šd
 = 
	`size2šdex
(
usize
);

2150 
	`as£¹
(
šd
 < 
NSIZES
);

2151  (
	`ŸÎocztm
(
tsdn
, 
usize
, 
šd
, 
z”o
, 
tÿche
, 
çl£
, 
¬’a
,

2152 
¦ow_·th
));

2153 
	}
}

2156 
	$im®locx_´of_§m¶e
(
tsdn_t
 *
tsdn
, 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
,

2157 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
, 
boŞ
 
¦ow_·th
)

2159 *
p
;

2161 ià(
usize
 <ğ
SMALL_MAXCLASS
) {

2162 
	`as£¹
(((
®ignm’t
 =ğ0è? 
	`s2u
(
LARGE_MINCLASS
) :

2163 
	`§2u
(
LARGE_MINCLASS
, 
®ignm’t
)) == LARGE_MINCLASS);

2164 
p
 = 
	`im®locx_æags
(
tsdn
, 
LARGE_MINCLASS
, 
®ignm’t
, 
z”o
,

2165 
tÿche
, 
¬’a
, 
¦ow_·th
);

2166 ià(
p
 =ğ
NULL
)

2167  (
NULL
);

2168 
	`¬’a_´of_´omÙed
(
tsdn
, 
p
, 
usize
);

2170 
p
 = 
	`im®locx_æags
(
tsdn
, 
usize
, 
®ignm’t
, 
z”o
, 
tÿche
, 
¬’a
,

2171 
¦ow_·th
);

2174  (
p
);

2175 
	}
}

2177 
JEMALLOC_ALWAYS_INLINE_C
 *

2178 
	$im®locx_´of
(
tsd_t
 *
tsd
, 
size_t
 
size
, 
æags
, size_ˆ*
usize
, 
boŞ
 
¦ow_·th
)

2180 *
p
;

2181 
size_t
 
®ignm’t
;

2182 
boŞ
 
z”o
;

2183 
tÿche_t
 *
tÿche
;

2184 
¬’a_t
 *
¬’a
;

2185 
´of_tùx_t
 *
tùx
;

2187 ià(
	`uÆik–y
(
	`im®locx_æags_decode
(
tsd
, 
size
, 
æags
, 
usize
, &
®ignm’t
,

2188 &
z”o
, &
tÿche
, &
¬’a
)))

2189  (
NULL
);

2190 
tùx
 = 
	`´of_®loc_´•
(
tsd
, *
usize
, 
	`´of_aùive_g‘_uÆocked
(), 
Œue
);

2191 ià(
	`lik–y
((
ušŒ_t
)
tùx
 == (uintptr_t)1U)) {

2192 
p
 = 
	`im®locx_æags
(
	`tsd_tsdn
(
tsd
), *
usize
, 
®ignm’t
, 
z”o
,

2193 
tÿche
, 
¬’a
, 
¦ow_·th
);

2194 } ià((
ušŒ_t
)
tùx
 > (uintptr_t)1U) {

2195 
p
 = 
	`im®locx_´of_§m¶e
(
	`tsd_tsdn
(
tsd
), *
usize
, 
®ignm’t
, 
z”o
,

2196 
tÿche
, 
¬’a
, 
¦ow_·th
);

2198 
p
 = 
NULL
;

2199 ià(
	`uÆik–y
(
p
 =ğ
NULL
)) {

2200 
	`´of_®loc_rŞlback
(
tsd
, 
tùx
, 
Œue
);

2201  (
NULL
);

2203 
	`´of_m®loc
(
	`tsd_tsdn
(
tsd
), 
p
, *
usize
, 
tùx
);

2205 
	`as£¹
(
®ignm’t
 =ğ0 || ((
ušŒ_t
)
p
 & (®ignm’ˆ- 1)è=ğ
	`ZU
(0));

2206  (
p
);

2207 
	}
}

2209 
JEMALLOC_ALWAYS_INLINE_C
 *

2210 
	$im®locx_no_´of
(
tsd_t
 *
tsd
, 
size_t
 
size
, 
æags
, size_ˆ*
usize
,

2211 
boŞ
 
¦ow_·th
)

2213 *
p
;

2214 
size_t
 
®ignm’t
;

2215 
boŞ
 
z”o
;

2216 
tÿche_t
 *
tÿche
;

2217 
¬’a_t
 *
¬’a
;

2219 ià(
	`uÆik–y
(
	`im®locx_æags_decode
(
tsd
, 
size
, 
æags
, 
usize
, &
®ignm’t
,

2220 &
z”o
, &
tÿche
, &
¬’a
)))

2221  (
NULL
);

2222 
p
 = 
	`im®locx_æags
(
	`tsd_tsdn
(
tsd
), *
usize
, 
®ignm’t
, 
z”o
, 
tÿche
,

2223 
¬’a
, 
¦ow_·th
);

2224 
	`as£¹
(
®ignm’t
 =ğ0 || ((
ušŒ_t
)
p
 & (®ignm’ˆ- 1)è=ğ
	`ZU
(0));

2225  (
p
);

2226 
	}
}

2229 
JEMALLOC_ALWAYS_INLINE_C
 *

2230 
	$im®locx_body
(
size_t
 
size
, 
æags
, 
tsdn_t
 **
tsdn
, size_ˆ*
usize
,

2231 
boŞ
 
¦ow_·th
)

2233 
tsd_t
 *
tsd
;

2235 ià(
¦ow_·th
 && 
	`uÆik–y
(
	`m®loc_š™
())) {

2236 *
tsdn
 = 
NULL
;

2237  (
NULL
);

2240 
tsd
 = 
	`tsd_ãtch
();

2241 *
tsdn
 = 
	`tsd_tsdn
(
tsd
);

2242 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2244 ià(
	`lik–y
(
æags
 == 0)) {

2245 
szšd_t
 
šd
 = 
	`size2šdex
(
size
);

2246 ià(
	`uÆik–y
(
šd
 >ğ
NSIZES
))

2247  (
NULL
);

2248 ià(
cÚfig_¡©s
 || (
cÚfig_´of
 && 
İt_´of
è|| (
¦ow_·th
 &&

2249 
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
))) {

2250 *
usize
 = 
	`šdex2size
(
šd
);

2251 
	`as£¹
(*
usize
 > 0 && *usiz<ğ
HUGE_MAXCLASS
);

2254 ià(
cÚfig_´of
 && 
İt_´of
) {

2255  (
	`ŸÎoc_´of
(
tsd
, *
usize
, 
šd
, 
çl£
,

2256 
¦ow_·th
));

2259  (
	`ŸÎoc
(
tsd
, 
size
, 
šd
, 
çl£
, 
¦ow_·th
));

2262 ià(
cÚfig_´of
 && 
İt_´of
)

2263  (
	`im®locx_´of
(
tsd
, 
size
, 
æags
, 
usize
, 
¦ow_·th
));

2265  (
	`im®locx_no_´of
(
tsd
, 
size
, 
æags
, 
usize
, 
¦ow_·th
));

2266 
	}
}

2268 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


2269 
JEMALLOC_NOTHROW
 *

2270 
	$JEMALLOC_ATTR
(
m®loc
è
	$JEMALLOC_ALLOC_SIZE
(1)

2271 
	$je_m®locx
(
size_t
 
size
, 
æags
)

2273 
tsdn_t
 *
tsdn
;

2274 *
p
;

2275 
size_t
 
usize
;

2277 
	`as£¹
(
size
 != 0);

2279 ià(
	`lik–y
(!
m®loc_¦ow
)) {

2280 
p
 = 
	`im®locx_body
(
size
, 
æags
, &
tsdn
, &
usize
, 
çl£
);

2281 
	`ŸÎoc_po¡_check
(
p
, 
tsdn
, 
usize
, "m®locx", 
çl£
, false);

2283 
p
 = 
	`im®locx_body
(
size
, 
æags
, &
tsdn
, &
usize
, 
Œue
);

2284 
	`ŸÎoc_po¡_check
(
p
, 
tsdn
, 
usize
, "m®locx", 
çl£
, 
Œue
);

2285 
	`UTRACE
(0, 
size
, 
p
);

2286 
	`JEMALLOC_VALGRIND_MALLOC
(
p
 !ğ
NULL
, 
tsdn
,…, 
usize
,

2287 
	`MALLOCX_ZERO_GET
(
æags
));

2290  (
p
);

2291 
	}
}

2294 
	$œ®locx_´of_§m¶e
(
tsd_t
 *
tsd
, *
Şd_±r
, 
size_t
 
Şd_usize
,

2295 
size_t
 
usize
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
,

2296 
´of_tùx_t
 *
tùx
)

2298 *
p
;

2300 ià(
tùx
 =ğ
NULL
)

2301  (
NULL
);

2302 ià(
usize
 <ğ
SMALL_MAXCLASS
) {

2303 
p
 = 
	`œ®loù
(
tsd
, 
Şd_±r
, 
Şd_usize
, 
LARGE_MINCLASS
, 
®ignm’t
,

2304 
z”o
, 
tÿche
, 
¬’a
);

2305 ià(
p
 =ğ
NULL
)

2306  (
NULL
);

2307 
	`¬’a_´of_´omÙed
(
	`tsd_tsdn
(
tsd
), 
p
, 
usize
);

2309 
p
 = 
	`œ®loù
(
tsd
, 
Şd_±r
, 
Şd_usize
, 
usize
, 
®ignm’t
, 
z”o
,

2310 
tÿche
, 
¬’a
);

2313  (
p
);

2314 
	}
}

2316 
JEMALLOC_ALWAYS_INLINE_C
 *

2317 
	$œ®locx_´of
(
tsd_t
 *
tsd
, *
Şd_±r
, 
size_t
 
Şd_usize
, size_ˆ
size
,

2318 
size_t
 
®ignm’t
, size_ˆ*
usize
, 
boŞ
 
z”o
, 
tÿche_t
 *
tÿche
,

2319 
¬’a_t
 *
¬’a
)

2321 *
p
;

2322 
boŞ
 
´of_aùive
;

2323 
´of_tùx_t
 *
Şd_tùx
, *
tùx
;

2325 
´of_aùive
 = 
	`´of_aùive_g‘_uÆocked
();

2326 
Şd_tùx
 = 
	`´of_tùx_g‘
(
	`tsd_tsdn
(
tsd
), 
Şd_±r
);

2327 
tùx
 = 
	`´of_®loc_´•
(
tsd
, *
usize
, 
´of_aùive
, 
çl£
);

2328 ià(
	`uÆik–y
((
ušŒ_t
)
tùx
 != (uintptr_t)1U)) {

2329 
p
 = 
	`œ®locx_´of_§m¶e
(
tsd
, 
Şd_±r
, 
Şd_usize
, *
usize
,

2330 
®ignm’t
, 
z”o
, 
tÿche
, 
¬’a
, 
tùx
);

2332 
p
 = 
	`œ®loù
(
tsd
, 
Şd_±r
, 
Şd_usize
, 
size
, 
®ignm’t
, 
z”o
,

2333 
tÿche
, 
¬’a
);

2335 ià(
	`uÆik–y
(
p
 =ğ
NULL
)) {

2336 
	`´of_®loc_rŞlback
(
tsd
, 
tùx
, 
çl£
);

2337  (
NULL
);

2340 ià(
p
 =ğ
Şd_±r
 && 
®ignm’t
 != 0) {

2349 *
usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
p
, 
cÚfig_´of
);

2351 
	`´of_»®loc
(
tsd
, 
p
, *
usize
, 
tùx
, 
´of_aùive
, 
çl£
, 
Şd_±r
,

2352 
Şd_usize
, 
Şd_tùx
);

2354  (
p
);

2355 
	}
}

2357 
JEMALLOC_EXPORT
 
JEMALLOC_ALLOCATOR
 
JEMALLOC_RESTRICT_RETURN


2358 
JEMALLOC_NOTHROW
 *

2359 
	$JEMALLOC_ALLOC_SIZE
(2)

2360 
	$je_¿Îocx
(*
±r
, 
size_t
 
size
, 
æags
)

2362 *
p
;

2363 
tsd_t
 *
tsd
;

2364 
size_t
 
usize
;

2365 
size_t
 
Şd_usize
;

2366 
UNUSED
 
size_t
 
Şd_rzsize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

2367 
size_t
 
®ignm’t
 = 
	`MALLOCX_ALIGN_GET
(
æags
);

2368 
boŞ
 
z”o
 = 
æags
 & 
MALLOCX_ZERO
;

2369 
¬’a_t
 *
¬’a
;

2370 
tÿche_t
 *
tÿche
;

2372 
	`as£¹
(
±r
 !ğ
NULL
);

2373 
	`as£¹
(
size
 != 0);

2374 
	`as£¹
(
	`m®loc_š™Ÿlized
(è|| 
IS_INITIALIZER
);

2375 
	`m®loc_th»ad_š™
();

2376 
tsd
 = 
	`tsd_ãtch
();

2377 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2379 ià(
	`uÆik–y
((
æags
 & 
MALLOCX_ARENA_MASK
) != 0)) {

2380 
¬’a_šd
 = 
	`MALLOCX_ARENA_GET
(
æags
);

2381 
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
¬’a_šd
, 
Œue
);

2382 ià(
	`uÆik–y
(
¬’a
 =ğ
NULL
))

2383 
Ïb–_oom
;

2385 
¬’a
 = 
NULL
;

2387 ià(
	`uÆik–y
((
æags
 & 
MALLOCX_TCACHE_MASK
) != 0)) {

2388 ià((
æags
 & 
MALLOCX_TCACHE_MASK
è=ğ
MALLOCX_TCACHE_NONE
)

2389 
tÿche
 = 
NULL
;

2391 
tÿche
 = 
	`tÿches_g‘
(
tsd
, 
	`MALLOCX_TCACHE_GET
(
æags
));

2393 
tÿche
 = 
	`tÿche_g‘
(
tsd
, 
Œue
);

2395 
Şd_usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
cÚfig_´of
);

2396 ià(
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
))

2397 
Şd_rzsize
 = 
	`u2rz
(
Şd_usize
);

2399 ià(
cÚfig_´of
 && 
İt_´of
) {

2400 
usize
 = (
®ignm’t
 =ğ0è? 
	`s2u
(
size
è: 
	`§2u
(size,‡lignment);

2401 ià(
	`uÆik–y
(
usize
 =ğ0 || usiz> 
HUGE_MAXCLASS
))

2402 
Ïb–_oom
;

2403 
p
 = 
	`œ®locx_´of
(
tsd
, 
±r
, 
Şd_usize
, 
size
, 
®ignm’t
, &
usize
,

2404 
z”o
, 
tÿche
, 
¬’a
);

2405 ià(
	`uÆik–y
(
p
 =ğ
NULL
))

2406 
Ïb–_oom
;

2408 
p
 = 
	`œ®loù
(
tsd
, 
±r
, 
Şd_usize
, 
size
, 
®ignm’t
, 
z”o
,

2409 
tÿche
, 
¬’a
);

2410 ià(
	`uÆik–y
(
p
 =ğ
NULL
))

2411 
Ïb–_oom
;

2412 ià(
cÚfig_¡©s
 || (
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
)))

2413 
usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
p
, 
cÚfig_´of
);

2415 
	`as£¹
(
®ignm’t
 =ğ0 || ((
ušŒ_t
)
p
 & (®ignm’ˆ- 1)è=ğ
	`ZU
(0));

2417 ià(
cÚfig_¡©s
) {

2418 *
	`tsd_th»ad_®loÿ‹dp_g‘
(
tsd
è+ğ
usize
;

2419 *
	`tsd_th»ad_d—Îoÿ‹dp_g‘
(
tsd
è+ğ
Şd_usize
;

2421 
	`UTRACE
(
±r
, 
size
, 
p
);

2422 
	`JEMALLOC_VALGRIND_REALLOC
(
maybe
, 
	`tsd_tsdn
(
tsd
), 
p
, 
usize
, 
no
, 
±r
,

2423 
Şd_usize
, 
Şd_rzsize
, 
no
, 
z”o
);

2424 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2425  (
p
);

2426 
Ïb–_oom
:

2427 ià(
cÚfig_xm®loc
 && 
	`uÆik–y
(
İt_xm®loc
)) {

2428 
	`m®loc_wr™e
("<jemalloc>: Error in„allocx(): out of memory\n");

2429 
	`abÜt
();

2431 
	`UTRACE
(
±r
, 
size
, 0);

2432 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2433  (
NULL
);

2434 
	}
}

2436 
JEMALLOC_ALWAYS_INLINE_C
 
size_t


2437 
	$ix®locx_h–³r
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şd_usize
, size_ˆ
size
,

2438 
size_t
 
exŒa
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
)

2440 
size_t
 
usize
;

2442 ià(
	`ix®loc
(
tsdn
, 
±r
, 
Şd_usize
, 
size
, 
exŒa
, 
®ignm’t
, 
z”o
))

2443  (
Şd_usize
);

2444 
usize
 = 
	`i§Îoc
(
tsdn
, 
±r
, 
cÚfig_´of
);

2446  (
usize
);

2447 
	}
}

2449 
size_t


2450 
	$ix®locx_´of_§m¶e
(
tsdn_t
 *
tsdn
, *
±r
, 
size_t
 
Şd_usize
, size_ˆ
size
,

2451 
size_t
 
exŒa
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
, 
´of_tùx_t
 *
tùx
)

2453 
size_t
 
usize
;

2455 ià(
tùx
 =ğ
NULL
)

2456  (
Şd_usize
);

2457 
usize
 = 
	`ix®locx_h–³r
(
tsdn
, 
±r
, 
Şd_usize
, 
size
, 
exŒa
, 
®ignm’t
,

2458 
z”o
);

2460  (
usize
);

2461 
	}
}

2463 
JEMALLOC_ALWAYS_INLINE_C
 
size_t


2464 
	$ix®locx_´of
(
tsd_t
 *
tsd
, *
±r
, 
size_t
 
Şd_usize
, size_ˆ
size
,

2465 
size_t
 
exŒa
, size_ˆ
®ignm’t
, 
boŞ
 
z”o
)

2467 
size_t
 
usize_max
, 
usize
;

2468 
boŞ
 
´of_aùive
;

2469 
´of_tùx_t
 *
Şd_tùx
, *
tùx
;

2471 
´of_aùive
 = 
	`´of_aùive_g‘_uÆocked
();

2472 
Şd_tùx
 = 
	`´of_tùx_g‘
(
	`tsd_tsdn
(
tsd
), 
±r
);

2479 ià(
®ignm’t
 == 0) {

2480 
usize_max
 = 
	`s2u
(
size
+
exŒa
);

2481 
	`as£¹
(
usize_max
 > 0 && usize_max <ğ
HUGE_MAXCLASS
);

2483 
usize_max
 = 
	`§2u
(
size
+
exŒa
, 
®ignm’t
);

2484 ià(
	`uÆik–y
(
usize_max
 =ğ0 || usize_max > 
HUGE_MAXCLASS
)) {

2491 
usize_max
 = 
HUGE_MAXCLASS
;

2494 
tùx
 = 
	`´of_®loc_´•
(
tsd
, 
usize_max
, 
´of_aùive
, 
çl£
);

2496 ià(
	`uÆik–y
((
ušŒ_t
)
tùx
 != (uintptr_t)1U)) {

2497 
usize
 = 
	`ix®locx_´of_§m¶e
(
	`tsd_tsdn
(
tsd
), 
±r
, 
Şd_usize
,

2498 
size
, 
exŒa
, 
®ignm’t
, 
z”o
, 
tùx
);

2500 
usize
 = 
	`ix®locx_h–³r
(
	`tsd_tsdn
(
tsd
), 
±r
, 
Şd_usize
, 
size
,

2501 
exŒa
, 
®ignm’t
, 
z”o
);

2503 ià(
usize
 =ğ
Şd_usize
) {

2504 
	`´of_®loc_rŞlback
(
tsd
, 
tùx
, 
çl£
);

2505  (
usize
);

2507 
	`´of_»®loc
(
tsd
, 
±r
, 
usize
, 
tùx
, 
´of_aùive
, 
çl£
,…Œ, 
Şd_usize
,

2508 
Şd_tùx
);

2510  (
usize
);

2511 
	}
}

2513 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW


2514 
	$je_x®locx
(*
±r
, 
size_t
 
size
, size_ˆ
exŒa
, 
æags
)

2516 
tsd_t
 *
tsd
;

2517 
size_t
 
usize
, 
Şd_usize
;

2518 
UNUSED
 
size_t
 
Şd_rzsize
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

2519 
size_t
 
®ignm’t
 = 
	`MALLOCX_ALIGN_GET
(
æags
);

2520 
boŞ
 
z”o
 = 
æags
 & 
MALLOCX_ZERO
;

2522 
	`as£¹
(
±r
 !ğ
NULL
);

2523 
	`as£¹
(
size
 != 0);

2524 
	`as£¹
(
SIZE_T_MAX
 - 
size
 >ğ
exŒa
);

2525 
	`as£¹
(
	`m®loc_š™Ÿlized
(è|| 
IS_INITIALIZER
);

2526 
	`m®loc_th»ad_š™
();

2527 
tsd
 = 
	`tsd_ãtch
();

2528 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2530 
Şd_usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
cÚfig_´of
);

2541 ià(
	`uÆik–y
(
size
 > 
HUGE_MAXCLASS
)) {

2542 
usize
 = 
Şd_usize
;

2543 
Ïb–_nÙ_»sized
;

2545 ià(
	`uÆik–y
(
HUGE_MAXCLASS
 - 
size
 < 
exŒa
))

2546 
exŒa
 = 
HUGE_MAXCLASS
 - 
size
;

2548 ià(
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
))

2549 
Şd_rzsize
 = 
	`u2rz
(
Şd_usize
);

2551 ià(
cÚfig_´of
 && 
İt_´of
) {

2552 
usize
 = 
	`ix®locx_´of
(
tsd
, 
±r
, 
Şd_usize
, 
size
, 
exŒa
,

2553 
®ignm’t
, 
z”o
);

2555 
usize
 = 
	`ix®locx_h–³r
(
	`tsd_tsdn
(
tsd
), 
±r
, 
Şd_usize
, 
size
,

2556 
exŒa
, 
®ignm’t
, 
z”o
);

2558 ià(
	`uÆik–y
(
usize
 =ğ
Şd_usize
))

2559 
Ïb–_nÙ_»sized
;

2561 ià(
cÚfig_¡©s
) {

2562 *
	`tsd_th»ad_®loÿ‹dp_g‘
(
tsd
è+ğ
usize
;

2563 *
	`tsd_th»ad_d—Îoÿ‹dp_g‘
(
tsd
è+ğ
Şd_usize
;

2565 
	`JEMALLOC_VALGRIND_REALLOC
(
no
, 
	`tsd_tsdn
(
tsd
), 
±r
, 
usize
,‚o,…tr,

2566 
Şd_usize
, 
Şd_rzsize
, 
no
, 
z”o
);

2567 
Ïb–_nÙ_»sized
:

2568 
	`UTRACE
(
±r
, 
size
,…tr);

2569 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2570  (
usize
);

2571 
	}
}

2573 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW


2574 
	$JEMALLOC_ATTR
(
pu»
)

2575 
	$je_§Îocx
(cÚ¡ *
±r
, 
æags
)

2577 
size_t
 
usize
;

2578 
tsdn_t
 *
tsdn
;

2580 
	`as£¹
(
	`m®loc_š™Ÿlized
(è|| 
IS_INITIALIZER
);

2581 
	`m®loc_th»ad_š™
();

2583 
tsdn
 = 
	`tsdn_ãtch
();

2584 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2586 ià(
cÚfig_iv§Îoc
)

2587 
usize
 = 
	`iv§Îoc
(
tsdn
, 
±r
, 
cÚfig_´of
);

2589 
usize
 = 
	`i§Îoc
(
tsdn
, 
±r
, 
cÚfig_´of
);

2591 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2592  (
usize
);

2593 
	}
}

2595 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW


2596 
	$je_d®locx
(*
±r
, 
æags
)

2598 
tsd_t
 *
tsd
;

2599 
tÿche_t
 *
tÿche
;

2601 
	`as£¹
(
±r
 !ğ
NULL
);

2602 
	`as£¹
(
	`m®loc_š™Ÿlized
(è|| 
IS_INITIALIZER
);

2604 
tsd
 = 
	`tsd_ãtch
();

2605 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2606 ià(
	`uÆik–y
((
æags
 & 
MALLOCX_TCACHE_MASK
) != 0)) {

2607 ià((
æags
 & 
MALLOCX_TCACHE_MASK
è=ğ
MALLOCX_TCACHE_NONE
)

2608 
tÿche
 = 
NULL
;

2610 
tÿche
 = 
	`tÿches_g‘
(
tsd
, 
	`MALLOCX_TCACHE_GET
(
æags
));

2612 
tÿche
 = 
	`tÿche_g‘
(
tsd
, 
çl£
);

2614 
	`UTRACE
(
±r
, 0, 0);

2615 ià(
	`lik–y
(!
m®loc_¦ow
))

2616 
	`iä“
(
tsd
, 
±r
, 
tÿche
, 
çl£
);

2618 
	`iä“
(
tsd
, 
±r
, 
tÿche
, 
Œue
);

2619 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2620 
	}
}

2622 
JEMALLOC_ALWAYS_INLINE_C
 
size_t


2623 
	$š®locx
(
tsdn_t
 *
tsdn
, 
size_t
 
size
, 
æags
)

2625 
size_t
 
usize
;

2627 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2629 ià(
	`lik–y
((
æags
 & 
MALLOCX_LG_ALIGN_MASK
) == 0))

2630 
usize
 = 
	`s2u
(
size
);

2632 
usize
 = 
	`§2u
(
size
, 
	`MALLOCX_ALIGN_GET_SPECIFIED
(
æags
));

2633 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2634  (
usize
);

2635 
	}
}

2637 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW


2638 
	$je_sd®locx
(*
±r
, 
size_t
 
size
, 
æags
)

2640 
tsd_t
 *
tsd
;

2641 
tÿche_t
 *
tÿche
;

2642 
size_t
 
usize
;

2644 
	`as£¹
(
±r
 !ğ
NULL
);

2645 
	`as£¹
(
	`m®loc_š™Ÿlized
(è|| 
IS_INITIALIZER
);

2646 
tsd
 = 
	`tsd_ãtch
();

2647 
usize
 = 
	`š®locx
(
	`tsd_tsdn
(
tsd
), 
size
, 
æags
);

2648 
	`as£¹
(
usize
 =ğ
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
cÚfig_´of
));

2650 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2651 ià(
	`uÆik–y
((
æags
 & 
MALLOCX_TCACHE_MASK
) != 0)) {

2652 ià((
æags
 & 
MALLOCX_TCACHE_MASK
è=ğ
MALLOCX_TCACHE_NONE
)

2653 
tÿche
 = 
NULL
;

2655 
tÿche
 = 
	`tÿches_g‘
(
tsd
, 
	`MALLOCX_TCACHE_GET
(
æags
));

2657 
tÿche
 = 
	`tÿche_g‘
(
tsd
, 
çl£
);

2659 
	`UTRACE
(
±r
, 0, 0);

2660 ià(
	`lik–y
(!
m®loc_¦ow
))

2661 
	`isä“
(
tsd
, 
±r
, 
usize
, 
tÿche
, 
çl£
);

2663 
	`isä“
(
tsd
, 
±r
, 
usize
, 
tÿche
, 
Œue
);

2664 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2665 
	}
}

2667 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW


2668 
	$JEMALLOC_ATTR
(
pu»
)

2669 
	$je_ÇÎocx
(
size_t
 
size
, 
æags
)

2671 
size_t
 
usize
;

2672 
tsdn_t
 *
tsdn
;

2674 
	`as£¹
(
size
 != 0);

2676 ià(
	`uÆik–y
(
	`m®loc_š™
()))

2679 
tsdn
 = 
	`tsdn_ãtch
();

2680 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2682 
usize
 = 
	`š®locx
(
tsdn
, 
size
, 
æags
);

2683 ià(
	`uÆik–y
(
usize
 > 
HUGE_MAXCLASS
))

2686 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2687  (
usize
);

2688 
	}
}

2690 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW


2691 
	$je_m®lùl
(cÚ¡ *
Çme
, *
Şdp
, 
size_t
 *
ŞdËÅ
, *
Ãwp
,

2692 
size_t
 
ÃwËn
)

2694 
»t
;

2695 
tsd_t
 *
tsd
;

2697 ià(
	`uÆik–y
(
	`m®loc_š™
()))

2698  (
EAGAIN
);

2700 
tsd
 = 
	`tsd_ãtch
();

2701 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2702 
»t
 = 
	`ùl_byÇme
(
tsd
, 
Çme
, 
Şdp
, 
ŞdËÅ
, 
Ãwp
, 
ÃwËn
);

2703 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2704  (
»t
);

2705 
	}
}

2707 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW


2708 
	$je_m®lùÊam‘omib
(cÚ¡ *
Çme
, 
size_t
 *
mibp
, size_ˆ*
mibËÅ
)

2710 
»t
;

2711 
tsdn_t
 *
tsdn
;

2713 ià(
	`uÆik–y
(
	`m®loc_š™
()))

2714  (
EAGAIN
);

2716 
tsdn
 = 
	`tsdn_ãtch
();

2717 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2718 
»t
 = 
	`ùl_Çm‘omib
(
tsdn
, 
Çme
, 
mibp
, 
mibËÅ
);

2719 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2720  (
»t
);

2721 
	}
}

2723 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW


2724 
	$je_m®lùlbymib
(cÚ¡ 
size_t
 *
mib
, size_ˆ
mibËn
, *
Şdp
, size_ˆ*
ŞdËÅ
,

2725 *
Ãwp
, 
size_t
 
ÃwËn
)

2727 
»t
;

2728 
tsd_t
 *
tsd
;

2730 ià(
	`uÆik–y
(
	`m®loc_š™
()))

2731  (
EAGAIN
);

2733 
tsd
 = 
	`tsd_ãtch
();

2734 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2735 
»t
 = 
	`ùl_bymib
(
tsd
, 
mib
, 
mibËn
, 
Şdp
, 
ŞdËÅ
, 
Ãwp
, 
ÃwËn
);

2736 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

2737  (
»t
);

2738 
	}
}

2740 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW


2741 
	$je_m®loc_¡©s_´št
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

2742 cÚ¡ *
İts
)

2744 
tsdn_t
 *
tsdn
;

2746 
tsdn
 = 
	`tsdn_ãtch
();

2747 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2748 
	`¡©s_´št
(
wr™e_cb
, 
cbİaque
, 
İts
);

2749 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2750 
	}
}

2752 
JEMALLOC_EXPORT
 
size_t
 
JEMALLOC_NOTHROW


2753 
	$je_m®loc_u§bË_size
(
JEMALLOC_USABLE_SIZE_CONST
 *
±r
)

2755 
size_t
 
»t
;

2756 
tsdn_t
 *
tsdn
;

2758 
	`as£¹
(
	`m®loc_š™Ÿlized
(è|| 
IS_INITIALIZER
);

2759 
	`m®loc_th»ad_š™
();

2761 
tsdn
 = 
	`tsdn_ãtch
();

2762 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2764 ià(
cÚfig_iv§Îoc
)

2765 
»t
 = 
	`iv§Îoc
(
tsdn
, 
±r
, 
cÚfig_´of
);

2767 
»t
 = (
±r
 =ğ
NULL
è? 0 : 
	`i§Îoc
(
tsdn
,…Œ, 
cÚfig_´of
);

2769 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

2770  (
»t
);

2771 
	}
}

2795 #iâdeà
JEMALLOC_JET


2796 
	$JEMALLOC_ATTR
(
cÚ¡ruùÜ
)

2798 
	$jem®loc_cÚ¡ruùÜ
()

2801 
	`m®loc_š™
();

2802 
	}
}

2805 #iâdeà
JEMALLOC_MUTEX_INIT_CB


2807 
	$jem®loc_´efÜk
()

2809 
JEMALLOC_EXPORT
 

2810 
	$_m®loc_´efÜk
()

2813 
tsd_t
 *
tsd
;

2814 
i
, 
j
, 
Ç»Çs
;

2815 
¬’a_t
 *
¬’a
;

2817 #ifdeà
JEMALLOC_MUTEX_INIT_CB


2818 ià(!
	`m®loc_š™Ÿlized
())

2821 
	`as£¹
(
	`m®loc_š™Ÿlized
());

2823 
tsd
 = 
	`tsd_ãtch
();

2825 
Ç»Çs
 = 
	`Ç»Çs_tÙ®_g‘
();

2827 
	`w™Ãss_´efÜk
(
tsd
);

2829 
	`ùl_´efÜk
(
	`tsd_tsdn
(
tsd
));

2830 
	`m®loc_mu‹x_´efÜk
(
	`tsd_tsdn
(
tsd
), &
¬’as_lock
);

2831 
	`´of_´efÜk0
(
	`tsd_tsdn
(
tsd
));

2832 
i
 = 0; i < 3; i++) {

2833 
j
 = 0; j < 
Ç»Çs
; j++) {

2834 ià((
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
j
, 
çl£
)) !=

2835 
NULL
) {

2836 
i
) {

2838 
	`¬’a_´efÜk0
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

2841 
	`¬’a_´efÜk1
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

2844 
	`¬’a_´efÜk2
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

2846 : 
	`nÙ_»ached
();

2851 
	`ba£_´efÜk
(
	`tsd_tsdn
(
tsd
));

2852 
i
 = 0; i < 
Ç»Çs
; i++) {

2853 ià((
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
i
, 
çl£
)è!ğ
NULL
)

2854 
	`¬’a_´efÜk3
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

2856 
	`´of_´efÜk1
(
	`tsd_tsdn
(
tsd
));

2857 
	}
}

2859 #iâdeà
JEMALLOC_MUTEX_INIT_CB


2861 
	$jem®loc_po¡fÜk_·»Á
()

2863 
JEMALLOC_EXPORT
 

2864 
	$_m®loc_po¡fÜk
()

2867 
tsd_t
 *
tsd
;

2868 
i
, 
Ç»Çs
;

2870 #ifdeà
JEMALLOC_MUTEX_INIT_CB


2871 ià(!
	`m®loc_š™Ÿlized
())

2874 
	`as£¹
(
	`m®loc_š™Ÿlized
());

2876 
tsd
 = 
	`tsd_ãtch
();

2878 
	`w™Ãss_po¡fÜk_·»Á
(
tsd
);

2880 
	`ba£_po¡fÜk_·»Á
(
	`tsd_tsdn
(
tsd
));

2881 
i
 = 0, 
Ç»Çs
 = 
	`Ç»Çs_tÙ®_g‘
(); i <‚arenas; i++) {

2882 
¬’a_t
 *
¬’a
;

2884 ià((
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
i
, 
çl£
)è!ğ
NULL
)

2885 
	`¬’a_po¡fÜk_·»Á
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

2887 
	`´of_po¡fÜk_·»Á
(
	`tsd_tsdn
(
tsd
));

2888 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
	`tsd_tsdn
(
tsd
), &
¬’as_lock
);

2889 
	`ùl_po¡fÜk_·»Á
(
	`tsd_tsdn
(
tsd
));

2890 
	}
}

2893 
	$jem®loc_po¡fÜk_chd
()

2895 
tsd_t
 *
tsd
;

2896 
i
, 
Ç»Çs
;

2898 
	`as£¹
(
	`m®loc_š™Ÿlized
());

2900 
tsd
 = 
	`tsd_ãtch
();

2902 
	`w™Ãss_po¡fÜk_chd
(
tsd
);

2904 
	`ba£_po¡fÜk_chd
(
	`tsd_tsdn
(
tsd
));

2905 
i
 = 0, 
Ç»Çs
 = 
	`Ç»Çs_tÙ®_g‘
(); i <‚arenas; i++) {

2906 
¬’a_t
 *
¬’a
;

2908 ià((
¬’a
 = 
	`¬’a_g‘
(
	`tsd_tsdn
(
tsd
), 
i
, 
çl£
)è!ğ
NULL
)

2909 
	`¬’a_po¡fÜk_chd
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

2911 
	`´of_po¡fÜk_chd
(
	`tsd_tsdn
(
tsd
));

2912 
	`m®loc_mu‹x_po¡fÜk_chd
(
	`tsd_tsdn
(
tsd
), &
¬’as_lock
);

2913 
	`ùl_po¡fÜk_chd
(
	`tsd_tsdn
(
tsd
));

2914 
	}
}

2923 
JEMALLOC_EXPORT
 
JEMALLOC_NOTHROW


2924 
	$je_g‘_deäag_hšt
(* 
±r
, *
bš_ut
, *
run_ut
) {

2925 
deäag
 = 0;

2926 
¬’a_chunk_t
 *
chunk
 = (¬’a_chunk_ˆ*)
	`CHUNK_ADDR2BASE
(
±r
);

2927 ià(
	`lik–y
(
chunk
 !ğ
±r
)) {

2928 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 - (ušŒ_t)
chunk
è>> 
LG_PAGE
;

2929 
size_t
 
m­b™s
 = 
	`¬’a_m­b™s_g‘
(
chunk
, 
·gešd
);

2930 ià(
	`lik–y
((
m­b™s
 & 
CHUNK_MAP_LARGE
) == 0)) {

2931 
¬’a_t
 *
¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
);

2932 
size_t
 
½ages_šd
 = 
·gešd
 - 
	`¬’a_m­b™s_sm®l_runšd_g‘
(
chunk
,…ageind);

2933 
¬’a_run_t
 *
run
 = &
	`¬’a_misûlm_g‘_mubË
(
chunk
, 
½ages_šd
)->run;

2934 
¬’a_bš_t
 *
bš
 = &
¬’a
->
bšs
[
run
->
bššd
];

2935 
tsd_t
 *
tsd
 = 
	`tsd_ãtch
();

2936 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

2938 ià(
chunk
 !ğ(
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
bš
->
runcur
)) {

2939 
¬’a_bš_šfo_t
 *
bš_šfo
 = &
¬’a_bš_šfo
[
run
->
bššd
];

2940 
size_t
 
ava»gs
 = 
bš_šfo
->
Äegs
 * 
bš
->
¡©s
.
cu¼uns
;

2941 *
bš_ut
 = (
bš
->
¡©s
.
cu¼egs
<<16è/ 
ava»gs
;

2942 *
run_ut
 = ((
bš_šfo
->
Äegs
 - 
run
->
nä“
)<<16) / bin_info->nregs;

2943 
deäag
 = 1;

2945 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

2948  
deäag
;

2949 
	}
}

	@deps/jemalloc/src/mb.c

1 
	#JEMALLOC_MB_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

	@deps/jemalloc/src/mutex.c

1 
	#JEMALLOC_MUTEX_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

4 #ià
defšed
(
JEMALLOC_LAZY_LOCK
è&& !defšed(
_WIN32
)

5 
	~<dlfú.h
>

8 #iâdeà
_CRT_SPINCOUNT


9 
	#_CRT_SPINCOUNT
 4000

	)

15 #ifdeà
JEMALLOC_LAZY_LOCK


16 
boŞ
 
	gi¡h»aded
 = 
çl£
;

18 #ifdeà
JEMALLOC_MUTEX_INIT_CB


19 
boŞ
 
	gpo¡pÚe_š™
 = 
Œue
;

20 
m®loc_mu‹x_t
 *
	gpo¡pÚed_mu‹xes
 = 
NULL
;

23 #ià
defšed
(
JEMALLOC_LAZY_LOCK
è&& !defšed(
_WIN32
)

24 
±h»ad_ü—‹_Úû
();

33 #ià
defšed
(
JEMALLOC_LAZY_LOCK
è&& !defšed(
_WIN32
)

34 (*
±h»ad_ü—‹_åŒ
)(
±h»ad_t
 *
__»¡riù
, cÚ¡ 
±h»ad_©Œ_t
 *,

35 *(*)(*), *
__»¡riù
);

38 
	$±h»ad_ü—‹_Úû
()

41 
±h»ad_ü—‹_åŒ
 = 
	`dlsym
(
RTLD_NEXT
, "pthread_create");

42 ià(
±h»ad_ü—‹_åŒ
 =ğ
NULL
) {

43 
	`m®loc_wr™e
("<jemalloc>: Error in dlsym(RTLD_NEXT, "

45 
	`abÜt
();

48 
i¡h»aded
 = 
Œue
;

49 
	}
}

51 
JEMALLOC_EXPORT
 

52 
	$±h»ad_ü—‹
(
±h»ad_t
 *
__»¡riù
 
th»ad
,

53 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
©Œ
, *(*
¡¬t_routše
)(*),

54 *
__»¡riù
 
¬g
)

56 
±h»ad_Úû_t
 
Úû_cÚŒŞ
 = 
PTHREAD_ONCE_INIT
;

58 
	`±h»ad_Úû
(&
Úû_cÚŒŞ
, 
±h»ad_ü—‹_Úû
);

60  (
	`±h»ad_ü—‹_åŒ
(
th»ad
, 
©Œ
, 
¡¬t_routše
, 
¬g
));

61 
	}
}

66 #ifdeà
JEMALLOC_MUTEX_INIT_CB


67 
JEMALLOC_EXPORT
 
_±h»ad_mu‹x_š™_ÿÎoc_cb
(
±h»ad_mu‹x_t
 *
mu‹x
,

68 *(
ÿÎoc_cb
)(
size_t
, size_t));

71 
boŞ


72 
	$m®loc_mu‹x_š™
(
m®loc_mu‹x_t
 *
mu‹x
, cÚ¡ *
Çme
, 
w™Ãss_¿nk_t
 
¿nk
)

75 #ifdeà
_WIN32


76 #ià
_WIN32_WINNT
 >= 0x0600

77 
	`In™ŸlizeSRWLock
(&
mu‹x
->
lock
);

79 ià(!
	`In™ŸlizeCr™iÿlSeùiÚAndSpšCouÁ
(&
mu‹x
->
lock
,

80 
_CRT_SPINCOUNT
))

81  (
Œue
);

83 #–ià(
	`defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

84 
mu‹x
->
lock
 = 
OS_UNFAIR_LOCK_INIT
;

85 #–ià(
	`defšed
(
JEMALLOC_OSSPIN
))

86 
mu‹x
->
lock
 = 0;

87 #–ià(
	`defšed
(
JEMALLOC_MUTEX_INIT_CB
))

88 ià(
po¡pÚe_š™
) {

89 
mu‹x
->
po¡pÚed_Ãxt
 = 
po¡pÚed_mu‹xes
;

90 
po¡pÚed_mu‹xes
 = 
mu‹x
;

92 ià(
	`_±h»ad_mu‹x_š™_ÿÎoc_cb
(&
mu‹x
->
lock
,

93 
boÙ¡¿p_ÿÎoc
) != 0)

94  (
Œue
);

97 
±h»ad_mu‹x©Œ_t
 
©Œ
;

99 ià(
	`±h»ad_mu‹x©Œ_š™
(&
©Œ
) != 0)

100  (
Œue
);

101 
	`±h»ad_mu‹x©Œ_£‰y³
(&
©Œ
, 
MALLOC_MUTEX_TYPE
);

102 ià(
	`±h»ad_mu‹x_š™
(&
mu‹x
->
lock
, &
©Œ
) != 0) {

103 
	`±h»ad_mu‹x©Œ_de¡roy
(&
©Œ
);

104  (
Œue
);

106 
	`±h»ad_mu‹x©Œ_de¡roy
(&
©Œ
);

108 ià(
cÚfig_debug
)

109 
	`w™Ãss_š™
(&
mu‹x
->
w™Ãss
, 
Çme
, 
¿nk
, 
NULL
);

110  (
çl£
);

111 
	}
}

114 
	$m®loc_mu‹x_´efÜk
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
)

117 
	`m®loc_mu‹x_lock
(
tsdn
, 
mu‹x
);

118 
	}
}

121 
	$m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
)

124 
	`m®loc_mu‹x_uÆock
(
tsdn
, 
mu‹x
);

125 
	}
}

128 
	$m®loc_mu‹x_po¡fÜk_chd
(
tsdn_t
 *
tsdn
, 
m®loc_mu‹x_t
 *
mu‹x
)

131 #ifdeà
JEMALLOC_MUTEX_INIT_CB


132 
	`m®loc_mu‹x_uÆock
(
tsdn
, 
mu‹x
);

134 ià(
	`m®loc_mu‹x_š™
(
mu‹x
, mu‹x->
w™Ãss
.
Çme
,

135 
mu‹x
->
w™Ãss
.
¿nk
)) {

136 
	`m®loc_´štf
("<jemalloc>: Error„e-initializing mutex in "

138 ià(
İt_abÜt
)

139 
	`abÜt
();

142 
	}
}

144 
boŞ


145 
	$m®loc_mu‹x_boÙ
()

148 #ifdeà
JEMALLOC_MUTEX_INIT_CB


149 
po¡pÚe_š™
 = 
çl£
;

150 
po¡pÚed_mu‹xes
 !ğ
NULL
) {

151 ià(
	`_±h»ad_mu‹x_š™_ÿÎoc_cb
(&
po¡pÚed_mu‹xes
->
lock
,

152 
boÙ¡¿p_ÿÎoc
) != 0)

153  (
Œue
);

154 
po¡pÚed_mu‹xes
 =…o¡pÚed_mu‹xes->
po¡pÚed_Ãxt
;

157  (
çl£
);

158 
	}
}

	@deps/jemalloc/src/nstime.c

1 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

3 
	#BILLION
 
	`UINT64_C
(1000000000)

	)

6 
	$n¡ime_š™
(
n¡ime_t
 *
time
, 
ušt64_t
 
ns
)

9 
time
->
ns
 =‚s;

10 
	}
}

13 
	$n¡ime_š™2
(
n¡ime_t
 *
time
, 
ušt64_t
 
£c
, ušt64_ˆ
n£c
)

16 
time
->
ns
 = 
£c
 * 
BILLION
 + 
n£c
;

17 
	}
}

19 
ušt64_t


20 
	$n¡ime_ns
(cÚ¡ 
n¡ime_t
 *
time
)

23  (
time
->
ns
);

24 
	}
}

26 
ušt64_t


27 
	$n¡ime_£c
(cÚ¡ 
n¡ime_t
 *
time
)

30  (
time
->
ns
 / 
BILLION
);

31 
	}
}

33 
ušt64_t


34 
	$n¡ime_n£c
(cÚ¡ 
n¡ime_t
 *
time
)

37  (
time
->
ns
 % 
BILLION
);

38 
	}
}

41 
	$n¡ime_cİy
(
n¡ime_t
 *
time
, cÚ¡‚¡ime_ˆ*
sourû
)

44 *
time
 = *
sourû
;

45 
	}
}

48 
	$n¡ime_com·»
(cÚ¡ 
n¡ime_t
 *
a
, cÚ¡‚¡ime_ˆ*
b
)

51  ((
a
->
ns
 > 
b
->ns) - (a->ns < b->ns));

52 
	}
}

55 
	$n¡ime_add
(
n¡ime_t
 *
time
, cÚ¡‚¡ime_ˆ*
add’d
)

58 
	`as£¹
(
UINT64_MAX
 - 
time
->
ns
 >ğ
add’d
->ns);

60 
time
->
ns
 +ğ
add’d
->ns;

61 
	}
}

64 
	$n¡ime_subŒaù
(
n¡ime_t
 *
time
, cÚ¡‚¡ime_ˆ*
subŒah’d
)

67 
	`as£¹
(
	`n¡ime_com·»
(
time
, 
subŒah’d
) >= 0);

69 
time
->
ns
 -ğ
subŒah’d
->ns;

70 
	}
}

73 
	$n¡ime_imuÉly
(
n¡ime_t
 *
time
, 
ušt64_t
 
muÉl›r
)

76 
	`as£¹
((((
time
->
ns
 | 
muÉl›r
è& (
UINT64_MAX
 << ((
ušt64_t
) <<

77 2))è=ğ0è|| ((
time
->
ns
 * 
muÉl›r
) / multiplier ==ime->ns));

79 
time
->
ns
 *ğ
muÉl›r
;

80 
	}
}

83 
	$n¡ime_idivide
(
n¡ime_t
 *
time
, 
ušt64_t
 
divisÜ
)

86 
	`as£¹
(
divisÜ
 != 0);

88 
time
->
ns
 /ğ
divisÜ
;

89 
	}
}

91 
ušt64_t


92 
	$n¡ime_divide
(cÚ¡ 
n¡ime_t
 *
time
, cÚ¡‚¡ime_ˆ*
divisÜ
)

95 
	`as£¹
(
divisÜ
->
ns
 != 0);

97  (
time
->
ns
 / 
divisÜ
->ns);

98 
	}
}

100 #ifdeà
_WIN32


101 
	#NSTIME_MONOTONIC
 
Œue


	)

103 
	$n¡ime_g‘
(
n¡ime_t
 *
time
)

105 
FILETIME
 
á
;

106 
ušt64_t
 
ticks_100ns
;

108 
	`G‘Sy¡emTimeAsFeTime
(&
á
);

109 
ticks_100ns
 = (((
ušt64_t
)
á
.
dwHighD©eTime
è<< 32è| ft.
dwLowD©eTime
;

111 
	`n¡ime_š™
(
time
, 
ticks_100ns
 * 100);

112 
	}
}

113 #–ià
JEMALLOC_HAVE_CLOCK_MONOTONIC_COARSE


114 
	#NSTIME_MONOTONIC
 
Œue


	)

116 
	$n¡ime_g‘
(
n¡ime_t
 *
time
)

118 
time¥ec
 
ts
;

120 
	`şock_g‘time
(
CLOCK_MONOTONIC_COARSE
, &
ts
);

121 
	`n¡ime_š™2
(
time
, 
ts
.
tv_£c
,s.
tv_n£c
);

122 
	}
}

123 #–ià
JEMALLOC_HAVE_CLOCK_MONOTONIC


124 
	#NSTIME_MONOTONIC
 
Œue


	)

126 
	$n¡ime_g‘
(
n¡ime_t
 *
time
)

128 
time¥ec
 
ts
;

130 
	`şock_g‘time
(
CLOCK_MONOTONIC
, &
ts
);

131 
	`n¡ime_š™2
(
time
, 
ts
.
tv_£c
,s.
tv_n£c
);

132 
	}
}

133 #–ià
JEMALLOC_HAVE_MACH_ABSOLUTE_TIME


134 
	#NSTIME_MONOTONIC
 
Œue


	)

136 
	$n¡ime_g‘
(
n¡ime_t
 *
time
)

139 
	`n¡ime_š™
(
time
, 
	`mach_absŞu‹_time
());

140 
	}
}

142 
	#NSTIME_MONOTONIC
 
çl£


	)

144 
	$n¡ime_g‘
(
n¡ime_t
 *
time
)

146 
timev®
 
tv
;

148 
	`g‘timeofday
(&
tv
, 
NULL
);

149 
	`n¡ime_š™2
(
time
, 
tv
.
tv_£c
,v.
tv_u£c
 * 1000);

150 
	}
}

153 #ifdeà
JEMALLOC_JET


154 #undeà
n¡ime_mÚÙÚic


155 
	#n¡ime_mÚÙÚic
 
	`JEMALLOC_N
(
n_n¡ime_mÚÙÚic
)

	)

157 
boŞ


158 
	$n¡ime_mÚÙÚic
()

161  (
NSTIME_MONOTONIC
);

162 #undeà
NSTIME_MONOTONIC


163 
	}
}

164 #ifdeà
JEMALLOC_JET


165 #undeà
n¡ime_mÚÙÚic


166 
	#n¡ime_mÚÙÚic
 
	`JEMALLOC_N
(
n¡ime_mÚÙÚic
)

	)

167 
n¡ime_mÚÙÚic_t
 *
	gn¡ime_mÚÙÚic
 = 
JEMALLOC_N
(
n_n¡ime_mÚÙÚic
);

170 #ifdeà
JEMALLOC_JET


171 #undeà
n¡ime_upd©e


172 
	#n¡ime_upd©e
 
	`JEMALLOC_N
(
n_n¡ime_upd©e
)

	)

174 
boŞ


175 
	$n¡ime_upd©e
(
n¡ime_t
 *
time
)

177 
n¡ime_t
 
Şd_time
;

179 
	`n¡ime_cİy
(&
Şd_time
, 
time
);

180 
	`n¡ime_g‘
(
time
);

183 ià(
	`uÆik–y
(
	`n¡ime_com·»
(&
Şd_time
, 
time
) > 0)) {

184 
	`n¡ime_cİy
(
time
, &
Şd_time
);

185  (
Œue
);

188  (
çl£
);

189 
	}
}

190 #ifdeà
JEMALLOC_JET


191 #undeà
n¡ime_upd©e


192 
	#n¡ime_upd©e
 
	`JEMALLOC_N
(
n¡ime_upd©e
)

	)

193 
n¡ime_upd©e_t
 *
	gn¡ime_upd©e
 = 
JEMALLOC_N
(
n_n¡ime_upd©e
);

	@deps/jemalloc/src/pages.c

1 
	#JEMALLOC_PAGES_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

4 #ifdeà
JEMALLOC_SYSCTL_VM_OVERCOMMIT


5 
	~<sys/sysùl.h
>

11 #iâdeà
_WIN32


12 
	#PAGES_PROT_COMMIT
 (
PROT_READ
 | 
PROT_WRITE
)

	)

13 
	#PAGES_PROT_DECOMMIT
 (
PROT_NONE
)

	)

14 
	gmm­_æags
;

16 
boŞ
 
	gos_ov”comm™s
;

21 
	$·ges_m­
(*
addr
, 
size_t
 
size
, 
boŞ
 *
comm™
)

23 *
»t
;

25 
	`as£¹
(
size
 != 0);

27 ià(
os_ov”comm™s
)

28 *
comm™
 = 
Œue
;

30 #ifdeà
_WIN32


35 
»t
 = 
	`Vœtu®AÎoc
(
addr
, 
size
, 
MEM_RESERVE
 | (*
comm™
 ? 
MEM_COMMIT
 : 0),

36 
PAGE_READWRITE
);

43 
´Ù
 = *
comm™
 ? 
PAGES_PROT_COMMIT
 : 
PAGES_PROT_DECOMMIT
;

45 
»t
 = 
	`mm­
(
addr
, 
size
, 
´Ù
, 
mm­_æags
, -1, 0);

47 
	`as£¹
(
»t
 !ğ
NULL
);

49 ià(
»t
 =ğ
MAP_FAILED
)

50 
»t
 = 
NULL
;

51 ià(
addr
 !ğ
NULL
 && 
»t
 !=‡ddr) {

55 
	`·ges_unm­
(
»t
, 
size
);

56 
»t
 = 
NULL
;

59 
	`as£¹
(
»t
 =ğ
NULL
 || (
addr
 == NULL &&„et !=‡ddr)

60 || (
addr
 !ğ
NULL
 && 
»t
 ==‡ddr));

61  (
»t
);

62 
	}
}

65 
	$·ges_unm­
(*
addr
, 
size_t
 
size
)

68 #ifdeà
_WIN32


69 ià(
	`Vœtu®F»e
(
addr
, 0, 
MEM_RELEASE
) == 0)

71 ià(
	`munm­
(
addr
, 
size
) == -1)

74 
buf
[
BUFERROR_BUF
];

76 
	`buã¼Ü
(
	`g‘_”ºo
(), 
buf
, (buf));

77 
	`m®loc_´štf
("<jemalloc>: Error in "

78 #ifdeà
_WIN32


83 "(): %s\n", 
buf
);

84 ià(
İt_abÜt
)

85 
	`abÜt
();

87 
	}
}

90 
	$·ges_Œim
(*
addr
, 
size_t
 
®loc_size
, size_ˆ
Ëadsize
, size_ˆ
size
,

91 
boŞ
 *
comm™
)

93 *
»t
 = (*)((
ušŒ_t
)
addr
 + 
Ëadsize
);

95 
	`as£¹
(
®loc_size
 >ğ
Ëadsize
 + 
size
);

96 #ifdeà
_WIN32


98 *
Ãw_addr
;

100 
	`·ges_unm­
(
addr
, 
®loc_size
);

101 
Ãw_addr
 = 
	`·ges_m­
(
»t
, 
size
, 
comm™
);

102 ià(
Ãw_addr
 =ğ
»t
)

103  (
»t
);

104 ià(
Ãw_addr
)

105 
	`·ges_unm­
(
Ãw_addr
, 
size
);

106  (
NULL
);

110 
size_t
 
Œasize
 = 
®loc_size
 - 
Ëadsize
 - 
size
;

112 ià(
Ëadsize
 != 0)

113 
	`·ges_unm­
(
addr
, 
Ëadsize
);

114 ià(
Œasize
 != 0)

115 
	`·ges_unm­
((*)((
ušŒ_t
)
»t
 + 
size
), 
Œasize
);

116  (
»t
);

119 
	}
}

121 
boŞ


122 
	$·ges_comm™_im¶
(*
addr
, 
size_t
 
size
, 
boŞ
 
comm™
)

125 ià(
os_ov”comm™s
)

126  (
Œue
);

128 #ifdeà
_WIN32


129  (
comm™
 ? (
addr
 !ğ
	`Vœtu®AÎoc
×ddr, 
size
, 
MEM_COMMIT
,

130 
PAGE_READWRITE
)è: (!
	`Vœtu®F»e
(
addr
, 
size
, 
MEM_DECOMMIT
)));

133 
´Ù
 = 
comm™
 ? 
PAGES_PROT_COMMIT
 : 
PAGES_PROT_DECOMMIT
;

134 *
»suÉ
 = 
	`mm­
(
addr
, 
size
, 
´Ù
, 
mm­_æags
 | 
MAP_FIXED
,

136 ià(
»suÉ
 =ğ
MAP_FAILED
)

137  (
Œue
);

138 ià(
»suÉ
 !ğ
addr
) {

143 
	`·ges_unm­
(
»suÉ
, 
size
);

144  (
Œue
);

146  (
çl£
);

149 
	}
}

151 
boŞ


152 
	$·ges_comm™
(*
addr
, 
size_t
 
size
)

155  (
	`·ges_comm™_im¶
(
addr
, 
size
, 
Œue
));

156 
	}
}

158 
boŞ


159 
	$·ges_decomm™
(*
addr
, 
size_t
 
size
)

162  (
	`·ges_comm™_im¶
(
addr
, 
size
, 
çl£
));

163 
	}
}

165 
boŞ


166 
	$·ges_purge
(*
addr
, 
size_t
 
size
)

168 
boŞ
 
unz”Ûd
;

170 #ifdeà
_WIN32


171 
	`Vœtu®AÎoc
(
addr
, 
size
, 
MEM_RESET
, 
PAGE_READWRITE
);

172 
unz”Ûd
 = 
Œue
;

173 #–ià(
	`defšed
(
JEMALLOC_PURGE_MADVISE_FREE
) || \

174 
	`defšed
(
JEMALLOC_PURGE_MADVISE_DONTNEED
))

175 #ià
	`defšed
(
JEMALLOC_PURGE_MADVISE_FREE
)

176 
	#JEMALLOC_MADV_PURGE
 
MADV_FREE


	)

177 
	#JEMALLOC_MADV_ZEROS
 
çl£


	)

178 #–ià
	`defšed
(
JEMALLOC_PURGE_MADVISE_DONTNEED
)

179 
	#JEMALLOC_MADV_PURGE
 
MADV_DONTNEED


	)

180 
	#JEMALLOC_MADV_ZEROS
 
Œue


	)

182 #”rÜ 
No
 
	`madvi£
(2è
æag
 
defšed
 
purgšg
 
unu£d
 
dœty
 
·ges


184 
”r
 = 
	`madvi£
(
addr
, 
size
, 
JEMALLOC_MADV_PURGE
);

185 
unz”Ûd
 = (!
JEMALLOC_MADV_ZEROS
 || 
”r
 != 0);

186 #undeà
JEMALLOC_MADV_PURGE


187 #undeà
JEMALLOC_MADV_ZEROS


190 
unz”Ûd
 = 
Œue
;

192  (
unz”Ûd
);

193 
	}
}

195 
boŞ


196 
	$·ges_huge
(*
addr
, 
size_t
 
size
)

199 
	`as£¹
(
	`PAGE_ADDR2BASE
(
addr
) ==‡ddr);

200 
	`as£¹
(
	`PAGE_CEILING
(
size
) == size);

202 #ifdeà
JEMALLOC_THP


203  (
	`madvi£
(
addr
, 
size
, 
MADV_HUGEPAGE
) != 0);

205  (
çl£
);

207 
	}
}

209 
boŞ


210 
	$·ges_nohuge
(*
addr
, 
size_t
 
size
)

213 
	`as£¹
(
	`PAGE_ADDR2BASE
(
addr
) ==‡ddr);

214 
	`as£¹
(
	`PAGE_CEILING
(
size
) == size);

216 #ifdeà
JEMALLOC_THP


217  (
	`madvi£
(
addr
, 
size
, 
MADV_NOHUGEPAGE
) != 0);

219  (
çl£
);

221 
	}
}

223 #ifdeà
JEMALLOC_SYSCTL_VM_OVERCOMMIT


224 
boŞ


225 
	$os_ov”comm™s_sysùl
()

227 
vm_ov”comm™
;

228 
size_t
 
sz
;

230 
sz
 = (
vm_ov”comm™
);

231 ià(
	`sysùlbyÇme
("vm.ov”comm™", &
vm_ov”comm™
, &
sz
, 
NULL
, 0) != 0)

232  (
çl£
);

234  ((
vm_ov”comm™
 & 0x3) == 0);

235 
	}
}

238 #ifdeà
JEMALLOC_PROC_SYS_VM_OVERCOMMIT_MEMORY


244 
boŞ


245 
	$os_ov”comm™s_´oc
()

247 
fd
;

248 
buf
[1];

249 
ssize_t
 
Ä—d
;

251 #ià
	`defšed
(
JEMALLOC_USE_SYSCALL
è&& defšed(
SYS_İ’
)

252 
fd
 = ()
	`sysÿÎ
(
SYS_İ’
, "/´oc/sys/vm/ov”comm™_memÜy", 
O_RDONLY
);

254 
fd
 = 
	`İ’
("/´oc/sys/vm/ov”comm™_memÜy", 
O_RDONLY
);

256 ià(
fd
 == -1)

257  (
çl£
);

259 #ià
	`defšed
(
JEMALLOC_USE_SYSCALL
è&& defšed(
SYS_»ad
)

260 
Ä—d
 = (
ssize_t
)
	`sysÿÎ
(
SYS_»ad
, 
fd
, &
buf
, (buf));

262 
Ä—d
 = 
	`»ad
(
fd
, &
buf
, (buf));

265 #ià
	`defšed
(
JEMALLOC_USE_SYSCALL
è&& defšed(
SYS_şo£
)

266 
	`sysÿÎ
(
SYS_şo£
, 
fd
);

268 
	`şo£
(
fd
);

271 ià(
Ä—d
 < 1)

272  (
çl£
);

279  (
buf
[0] == '0' || buf[0] == '1');

280 
	}
}

284 
	$·ges_boÙ
()

287 #iâdeà
_WIN32


288 
mm­_æags
 = 
MAP_PRIVATE
 | 
MAP_ANON
;

291 #ifdeà
JEMALLOC_SYSCTL_VM_OVERCOMMIT


292 
os_ov”comm™s
 = 
	`os_ov”comm™s_sysùl
();

293 #–ià
	`defšed
(
JEMALLOC_PROC_SYS_VM_OVERCOMMIT_MEMORY
)

294 
os_ov”comm™s
 = 
	`os_ov”comm™s_´oc
();

295 #ifdeà
MAP_NORESERVE


296 ià(
os_ov”comm™s
)

297 
mm­_æags
 |ğ
MAP_NORESERVE
;

300 
os_ov”comm™s
 = 
çl£
;

302 
	}
}

	@deps/jemalloc/src/prng.c

1 
	#JEMALLOC_PRNG_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

	@deps/jemalloc/src/prof.c

1 
	#JEMALLOC_PROF_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

5 #ifdeà
JEMALLOC_PROF_LIBUNWIND


6 
	#UNW_LOCAL_ONLY


	)

7 
	~<libunwšd.h
>

10 #ifdeà
JEMALLOC_PROF_LIBGCC


11 
	~<unwšd.h
>

17 
boŞ
 
	gİt_´of
 = 
çl£
;

18 
boŞ
 
	gİt_´of_aùive
 = 
Œue
;

19 
boŞ
 
	gİt_´of_th»ad_aùive_š™
 = 
Œue
;

20 
size_t
 
	gİt_lg_´of_§m¶e
 = 
LG_PROF_SAMPLE_DEFAULT
;

21 
ssize_t
 
	gİt_lg_´of_š‹rv®
 = 
LG_PROF_INTERVAL_DEFAULT
;

22 
boŞ
 
	gİt_´of_gdump
 = 
çl£
;

23 
boŞ
 
	gİt_´of_fš®
 = 
çl£
;

24 
boŞ
 
	gİt_´of_Ëak
 = 
çl£
;

25 
boŞ
 
	gİt_´of_accum
 = 
çl£
;

26 
	gİt_´of_´efix
[

28 #ifdeà
JEMALLOC_PROF


29 
PATH_MAX
 +

37 
boŞ
 
	g´of_aùive
;

38 
m®loc_mu‹x_t
 
	g´of_aùive_mtx
;

44 
boŞ
 
	g´of_th»ad_aùive_š™
;

45 
m®loc_mu‹x_t
 
	g´of_th»ad_aùive_š™_mtx
;

51 
boŞ
 
	g´of_gdump_v®
;

52 
m®loc_mu‹x_t
 
	g´of_gdump_mtx
;

54 
ušt64_t
 
	g´of_š‹rv®
 = 0;

56 
size_t
 
	glg_´of_§m¶e
;

65 
m®loc_mu‹x_t
 *
	ggùx_locks
;

66 
	gcum_gùxs
;

74 
m®loc_mu‹x_t
 *
	gtd©a_locks
;

80 
ckh_t
 
	gbt2gùx
;

81 
m®loc_mu‹x_t
 
	gbt2gùx_mtx
;

87 
´of_td©a_Œ“_t
 
	gtd©as
;

88 
m®loc_mu‹x_t
 
	gtd©as_mtx
;

90 
ušt64_t
 
	gÃxt_thr_uid
;

91 
m®loc_mu‹x_t
 
	gÃxt_thr_uid_mtx
;

93 
m®loc_mu‹x_t
 
	g´of_dump_£q_mtx
;

94 
ušt64_t
 
	g´of_dump_£q
;

95 
ušt64_t
 
	g´of_dump_i£q
;

96 
ušt64_t
 
	g´of_dump_m£q
;

97 
ušt64_t
 
	g´of_dump_u£q
;

103 
m®loc_mu‹x_t
 
	g´of_dump_mtx
;

104 
	g´of_dump_buf
[

106 #ifdeà
JEMALLOC_PROF


107 
PROF_DUMP_BUFSIZE


112 
size_t
 
	g´of_dump_buf_’d
;

113 
	g´of_dump_fd
;

116 
boŞ
 
	g´of_boÙed
 = 
çl£
;

124 
boŞ
 
´of_tùx_should_de¡roy
(
tsdn_t
 *
tsdn
, 
´of_tùx_t
 *
tùx
);

125 
´of_tùx_de¡roy
(
tsd_t
 *
tsd
, 
´of_tùx_t
 *
tùx
);

126 
boŞ
 
´of_td©a_should_de¡roy
(
tsdn_t
 *
tsdn
, 
´of_td©a_t
 *
td©a
,

127 
boŞ
 
ev’_if_©ched
);

128 
´of_td©a_de¡roy
(
tsd_t
 *
tsd
, 
´of_td©a_t
 *
td©a
,

129 
boŞ
 
ev’_if_©ched
);

130 *
´of_th»ad_Çme_®loc
(
tsdn_t
 *
tsdn
, cÚ¡ *
th»ad_Çme
);

135 
JEMALLOC_INLINE_C
 

136 
	$´of_tùx_comp
(cÚ¡ 
´of_tùx_t
 *
a
, cÚ¡…rof_tùx_ˆ*
b
)

138 
ušt64_t
 
a_thr_uid
 = 
a
->
thr_uid
;

139 
ušt64_t
 
b_thr_uid
 = 
b
->
thr_uid
;

140 
»t
 = (
a_thr_uid
 > 
b_thr_uid
) - (a_thr_uid < b_thr_uid);

141 ià(
»t
 == 0) {

142 
ušt64_t
 
a_thr_disüim
 = 
a
->
thr_disüim
;

143 
ušt64_t
 
b_thr_disüim
 = 
b
->
thr_disüim
;

144 
»t
 = (
a_thr_disüim
 > 
b_thr_disüim
) - (a_thr_discrim <

145 
b_thr_disüim
);

146 ià(
»t
 == 0) {

147 
ušt64_t
 
a_tùx_uid
 = 
a
->
tùx_uid
;

148 
ušt64_t
 
b_tùx_uid
 = 
b
->
tùx_uid
;

149 
»t
 = (
a_tùx_uid
 > 
b_tùx_uid
) - (a_tctx_uid <

150 
b_tùx_uid
);

153  (
»t
);

154 
	}
}

156 
	$rb_g’
(
UNUSED
, 
tùx_Œ“_
, 
´of_tùx_Œ“_t
, 
´of_tùx_t
,

157 
tùx_lšk
, 
´of_tùx_comp
)

159 
JEMALLOC_INLINE_C
 

160 
	$´of_gùx_comp
(cÚ¡ 
´of_gùx_t
 *
a
, cÚ¡…rof_gùx_ˆ*
b
)

162 
a_Ën
 = 
a
->
bt
.
Ën
;

163 
b_Ën
 = 
b
->
bt
.
Ën
;

164 
comp_Ën
 = (
a_Ën
 < 
b_Ën
) ?‡_len : b_len;

165 
»t
 = 
	`memcmp
(
a
->
bt
.
vec
, 
b
->bt.vec, 
comp_Ën
 * (*));

166 ià(
»t
 == 0)

167 
»t
 = (
a_Ën
 > 
b_Ën
) - (a_len < b_len);

168  (
»t
);

169 
	}
}

171 
	$rb_g’
(
UNUSED
, 
gùx_Œ“_
, 
´of_gùx_Œ“_t
, 
´of_gùx_t
, 
dump_lšk
,

172 
´of_gùx_comp
)

174 
JEMALLOC_INLINE_C
 

175 
	$´of_td©a_comp
(cÚ¡ 
´of_td©a_t
 *
a
, cÚ¡…rof_td©a_ˆ*
b
)

177 
»t
;

178 
ušt64_t
 
a_uid
 = 
a
->
thr_uid
;

179 
ušt64_t
 
b_uid
 = 
b
->
thr_uid
;

181 
»t
 = ((
a_uid
 > 
b_uid
) - (a_uid < b_uid));

182 ià(
»t
 == 0) {

183 
ušt64_t
 
a_disüim
 = 
a
->
thr_disüim
;

184 
ušt64_t
 
b_disüim
 = 
b
->
thr_disüim
;

186 
»t
 = ((
a_disüim
 > 
b_disüim
) - (a_discrim < b_discrim));

188  (
»t
);

189 
	}
}

191 
	$rb_g’
(
UNUSED
, 
td©a_Œ“_
, 
´of_td©a_Œ“_t
, 
´of_td©a_t
, 
td©a_lšk
,

192 
´of_td©a_comp
)

197 
	$´of_®loc_rŞlback
(
tsd_t
 *
tsd
, 
´of_tùx_t
 *
tùx
, 
boŞ
 
upd©ed
)

199 
´of_td©a_t
 *
td©a
;

201 
	`ÿs£¹
(
cÚfig_´of
);

203 ià(
upd©ed
) {

210 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
Œue
);

211 ià(
td©a
 !ğ
NULL
)

212 
	`´of_§m¶e_th»shŞd_upd©e
(
td©a
);

215 ià((
ušŒ_t
)
tùx
 > (uintptr_t)1U) {

216 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
tùx
->
td©a
->
lock
);

217 
tùx
->
´•¬ed
 = 
çl£
;

218 ià(
	`´of_tùx_should_de¡roy
(
	`tsd_tsdn
(
tsd
), 
tùx
))

219 
	`´of_tùx_de¡roy
(
tsd
, 
tùx
);

221 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
tùx
->
td©a
->
lock
);

223 
	}
}

226 
	$´of_m®loc_§m¶e_objeù
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
, 
size_t
 
usize
,

227 
´of_tùx_t
 *
tùx
)

230 
	`´of_tùx_£t
(
tsdn
, 
±r
, 
usize
, 
tùx
);

232 
	`m®loc_mu‹x_lock
(
tsdn
, 
tùx
->
td©a
->
lock
);

233 
tùx
->
úts
.
curobjs
++;

234 
tùx
->
úts
.
curby‹s
 +ğ
usize
;

235 ià(
İt_´of_accum
) {

236 
tùx
->
úts
.
accumobjs
++;

237 
tùx
->
úts
.
accumby‹s
 +ğ
usize
;

239 
tùx
->
´•¬ed
 = 
çl£
;

240 
	`m®loc_mu‹x_uÆock
(
tsdn
, 
tùx
->
td©a
->
lock
);

241 
	}
}

244 
	$´of_ä“_§m¶ed_objeù
(
tsd_t
 *
tsd
, 
size_t
 
usize
, 
´of_tùx_t
 *
tùx
)

247 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
tùx
->
td©a
->
lock
);

248 
	`as£¹
(
tùx
->
úts
.
curobjs
 > 0);

249 
	`as£¹
(
tùx
->
úts
.
curby‹s
 >ğ
usize
);

250 
tùx
->
úts
.
curobjs
--;

251 
tùx
->
úts
.
curby‹s
 -ğ
usize
;

253 ià(
	`´of_tùx_should_de¡roy
(
	`tsd_tsdn
(
tsd
), 
tùx
))

254 
	`´of_tùx_de¡roy
(
tsd
, 
tùx
);

256 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
tùx
->
td©a
->
lock
);

257 
	}
}

260 
	$bt_š™
(
´of_bt_t
 *
bt
, **
vec
)

263 
	`ÿs£¹
(
cÚfig_´of
);

265 
bt
->
vec
 = vec;

266 
bt
->
Ën
 = 0;

267 
	}
}

269 
JEMALLOC_INLINE_C
 

270 
	$´of_’‹r
(
tsd_t
 *
tsd
, 
´of_td©a_t
 *
td©a
)

273 
	`ÿs£¹
(
cÚfig_´of
);

274 
	`as£¹
(
td©a
 =ğ
	`´of_td©a_g‘
(
tsd
, 
çl£
));

276 ià(
td©a
 !ğ
NULL
) {

277 
	`as£¹
(!
td©a
->
’q
);

278 
td©a
->
’q
 = 
Œue
;

281 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
bt2gùx_mtx
);

282 
	}
}

284 
JEMALLOC_INLINE_C
 

285 
	$´of_Ëave
(
tsd_t
 *
tsd
, 
´of_td©a_t
 *
td©a
)

288 
	`ÿs£¹
(
cÚfig_´of
);

289 
	`as£¹
(
td©a
 =ğ
	`´of_td©a_g‘
(
tsd
, 
çl£
));

291 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
bt2gùx_mtx
);

293 ià(
td©a
 !ğ
NULL
) {

294 
boŞ
 
idump
, 
gdump
;

296 
	`as£¹
(
td©a
->
’q
);

297 
td©a
->
’q
 = 
çl£
;

298 
idump
 = 
td©a
->
’q_idump
;

299 
td©a
->
’q_idump
 = 
çl£
;

300 
gdump
 = 
td©a
->
’q_gdump
;

301 
td©a
->
’q_gdump
 = 
çl£
;

303 ià(
idump
)

304 
	`´of_idump
(
	`tsd_tsdn
(
tsd
));

305 ià(
gdump
)

306 
	`´of_gdump
(
	`tsd_tsdn
(
tsd
));

308 
	}
}

310 #ifdeà
JEMALLOC_PROF_LIBUNWIND


312 
	$´of_backŒaû
(
´of_bt_t
 *
bt
)

314 
näames
;

316 
	`ÿs£¹
(
cÚfig_´of
);

317 
	`as£¹
(
bt
->
Ën
 == 0);

318 
	`as£¹
(
bt
->
vec
 !ğ
NULL
);

320 
näames
 = 
	`unw_backŒaû
(
bt
->
vec
, 
PROF_BT_MAX
);

321 ià(
näames
 <= 0)

323 
bt
->
Ën
 = 
näames
;

324 
	}
}

325 #–ià(
defšed
(
JEMALLOC_PROF_LIBGCC
))

326 
_Unwšd_R—sÚ_Code


327 
	$´of_unwšd_š™_ÿÎback
(
_Unwšd_CÚ‹xt
 *
cÚ‹xt
, *
¬g
)

330 
	`ÿs£¹
(
cÚfig_´of
);

332  (
_URC_NO_REASON
);

333 
	}
}

335 
_Unwšd_R—sÚ_Code


336 
	$´of_unwšd_ÿÎback
(
_Unwšd_CÚ‹xt
 *
cÚ‹xt
, *
¬g
)

338 
´of_unwšd_d©a_t
 *
d©a
 = (´of_unwšd_d©a_ˆ*)
¬g
;

339 *

;

341 
	`ÿs£¹
(
cÚfig_´of
);

343 

 = (*)
	`_Unwšd_G‘IP
(
cÚ‹xt
);

344 ià(

 =ğ
NULL
)

345  (
_URC_END_OF_STACK
);

346 
d©a
->
bt
->
vec
[d©a->bt->
Ën
] = 

;

347 
d©a
->
bt
->
Ën
++;

348 ià(
d©a
->
bt
->
Ën
 =ğd©a->
max
)

349  (
_URC_END_OF_STACK
);

351  (
_URC_NO_REASON
);

352 
	}
}

355 
	$´of_backŒaû
(
´of_bt_t
 *
bt
)

357 
´of_unwšd_d©a_t
 
d©a
 = {
bt
, 
PROF_BT_MAX
};

359 
	`ÿs£¹
(
cÚfig_´of
);

361 
	`_Unwšd_BackŒaû
(
´of_unwšd_ÿÎback
, &
d©a
);

362 
	}
}

363 #–ià(
defšed
(
JEMALLOC_PROF_GCC
))

365 
	$´of_backŒaû
(
´of_bt_t
 *
bt
)

367 
	#BT_FRAME
(
i
) \

368 ià((
i
è< 
PROF_BT_MAX
) { \

369 *
p
; \

370 ià(
	`__butš_äame_add»ss
(
i
) == 0) \

372 
p
 = 
	`__butš_»tuº_add»ss
(
i
); \

373 ià(
p
 =ğ
NULL
) \

375 
bt
->
vec
[(
i
)] = 
p
; \

376 
bt
->
Ën
 = (
i
) + 1; \

378 ;

	)

380 
	`ÿs£¹
(
cÚfig_´of
);

382 
	`BT_FRAME
(0)

383 
	`BT_FRAME
(1)

384 
	`BT_FRAME
(2)

385 
	`BT_FRAME
(3)

386 
	`BT_FRAME
(4)

387 
	`BT_FRAME
(5)

388 
	`BT_FRAME
(6)

389 
	`BT_FRAME
(7)

390 
	`BT_FRAME
(8)

391 
	`BT_FRAME
(9)

393 
	`BT_FRAME
(10)

394 
	`BT_FRAME
(11)

395 
	`BT_FRAME
(12)

396 
	`BT_FRAME
(13)

397 
	`BT_FRAME
(14)

398 
	`BT_FRAME
(15)

399 
	`BT_FRAME
(16)

400 
	`BT_FRAME
(17)

401 
	`BT_FRAME
(18)

402 
	`BT_FRAME
(19)

404 
	`BT_FRAME
(20)

405 
	`BT_FRAME
(21)

406 
	`BT_FRAME
(22)

407 
	`BT_FRAME
(23)

408 
	`BT_FRAME
(24)

409 
	`BT_FRAME
(25)

410 
	`BT_FRAME
(26)

411 
	`BT_FRAME
(27)

412 
	`BT_FRAME
(28)

413 
	`BT_FRAME
(29)

415 
	`BT_FRAME
(30)

416 
	`BT_FRAME
(31)

417 
	`BT_FRAME
(32)

418 
	`BT_FRAME
(33)

419 
	`BT_FRAME
(34)

420 
	`BT_FRAME
(35)

421 
	`BT_FRAME
(36)

422 
	`BT_FRAME
(37)

423 
	`BT_FRAME
(38)

424 
	`BT_FRAME
(39)

426 
	`BT_FRAME
(40)

427 
	`BT_FRAME
(41)

428 
	`BT_FRAME
(42)

429 
	`BT_FRAME
(43)

430 
	`BT_FRAME
(44)

431 
	`BT_FRAME
(45)

432 
	`BT_FRAME
(46)

433 
	`BT_FRAME
(47)

434 
	`BT_FRAME
(48)

435 
	`BT_FRAME
(49)

437 
	`BT_FRAME
(50)

438 
	`BT_FRAME
(51)

439 
	`BT_FRAME
(52)

440 
	`BT_FRAME
(53)

441 
	`BT_FRAME
(54)

442 
	`BT_FRAME
(55)

443 
	`BT_FRAME
(56)

444 
	`BT_FRAME
(57)

445 
	`BT_FRAME
(58)

446 
	`BT_FRAME
(59)

448 
	`BT_FRAME
(60)

449 
	`BT_FRAME
(61)

450 
	`BT_FRAME
(62)

451 
	`BT_FRAME
(63)

452 
	`BT_FRAME
(64)

453 
	`BT_FRAME
(65)

454 
	`BT_FRAME
(66)

455 
	`BT_FRAME
(67)

456 
	`BT_FRAME
(68)

457 
	`BT_FRAME
(69)

459 
	`BT_FRAME
(70)

460 
	`BT_FRAME
(71)

461 
	`BT_FRAME
(72)

462 
	`BT_FRAME
(73)

463 
	`BT_FRAME
(74)

464 
	`BT_FRAME
(75)

465 
	`BT_FRAME
(76)

466 
	`BT_FRAME
(77)

467 
	`BT_FRAME
(78)

468 
	`BT_FRAME
(79)

470 
	`BT_FRAME
(80)

471 
	`BT_FRAME
(81)

472 
	`BT_FRAME
(82)

473 
	`BT_FRAME
(83)

474 
	`BT_FRAME
(84)

475 
	`BT_FRAME
(85)

476 
	`BT_FRAME
(86)

477 
	`BT_FRAME
(87)

478 
	`BT_FRAME
(88)

479 
	`BT_FRAME
(89)

481 
	`BT_FRAME
(90)

482 
	`BT_FRAME
(91)

483 
	`BT_FRAME
(92)

484 
	`BT_FRAME
(93)

485 
	`BT_FRAME
(94)

486 
	`BT_FRAME
(95)

487 
	`BT_FRAME
(96)

488 
	`BT_FRAME
(97)

489 
	`BT_FRAME
(98)

490 
	`BT_FRAME
(99)

492 
	`BT_FRAME
(100)

493 
	`BT_FRAME
(101)

494 
	`BT_FRAME
(102)

495 
	`BT_FRAME
(103)

496 
	`BT_FRAME
(104)

497 
	`BT_FRAME
(105)

498 
	`BT_FRAME
(106)

499 
	`BT_FRAME
(107)

500 
	`BT_FRAME
(108)

501 
	`BT_FRAME
(109)

503 
	`BT_FRAME
(110)

504 
	`BT_FRAME
(111)

505 
	`BT_FRAME
(112)

506 
	`BT_FRAME
(113)

507 
	`BT_FRAME
(114)

508 
	`BT_FRAME
(115)

509 
	`BT_FRAME
(116)

510 
	`BT_FRAME
(117)

511 
	`BT_FRAME
(118)

512 
	`BT_FRAME
(119)

514 
	`BT_FRAME
(120)

515 
	`BT_FRAME
(121)

516 
	`BT_FRAME
(122)

517 
	`BT_FRAME
(123)

518 
	`BT_FRAME
(124)

519 
	`BT_FRAME
(125)

520 
	`BT_FRAME
(126)

521 
	`BT_FRAME
(127)

522 #undeà
BT_FRAME


523 
	}
}

526 
	$´of_backŒaû
(
´of_bt_t
 *
bt
)

529 
	`ÿs£¹
(
cÚfig_´of
);

530 
	`nÙ_»ached
();

531 
	}
}

534 
m®loc_mu‹x_t
 *

535 
	$´of_gùx_mu‹x_choo£
()

537 
ngùxs
 = 
	`©omic_add_u
(&
cum_gùxs
, 1);

539  (&
gùx_locks
[(
ngùxs
 - 1è% 
PROF_NCTX_LOCKS
]);

540 
	}
}

542 
m®loc_mu‹x_t
 *

543 
	$´of_td©a_mu‹x_choo£
(
ušt64_t
 
thr_uid
)

546  (&
td©a_locks
[
thr_uid
 % 
PROF_NTDATA_LOCKS
]);

547 
	}
}

549 
´of_gùx_t
 *

550 
	$´of_gùx_ü—‹
(
tsdn_t
 *
tsdn
, 
´of_bt_t
 *
bt
)

555 
size_t
 
size
 = 
	`off£tof
(
´of_gùx_t
, 
vec
è+ (
bt
->
Ën
 * (*));

556 
´of_gùx_t
 *
gùx
 = (´of_gùx_ˆ*)
	`ŸÎocztm
(
tsdn
, 
size
,

557 
	`size2šdex
(
size
), 
çl£
, 
NULL
, 
Œue
, 
	`¬’a_g‘
(
TSDN_NULL
, 0,rue),

558 
Œue
);

559 ià(
gùx
 =ğ
NULL
)

560  (
NULL
);

561 
gùx
->
lock
 = 
	`´of_gùx_mu‹x_choo£
();

566 
gùx
->
Æimbo
 = 1;

567 
	`tùx_Œ“_Ãw
(&
gùx
->
tùxs
);

569 
	`memıy
(
gùx
->
vec
, 
bt
->vec, bt->
Ën
 * (*));

570 
gùx
->
bt
.
vec
 = gctx->vec;

571 
gùx
->
bt
.
Ën
 = bt->len;

572  (
gùx
);

573 
	}
}

576 
	$´of_gùx_Œy_de¡roy
(
tsd_t
 *
tsd
, 
´of_td©a_t
 *
td©a_£lf
, 
´of_gùx_t
 *
gùx
,

577 
´of_td©a_t
 *
td©a
)

580 
	`ÿs£¹
(
cÚfig_´of
);

589 
	`´of_’‹r
(
tsd
, 
td©a_£lf
);

590 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

591 
	`as£¹
(
gùx
->
Æimbo
 != 0);

592 ià(
	`tùx_Œ“_em±y
(&
gùx
->
tùxs
è&& gùx->
Æimbo
 == 1) {

594 ià(
	`ckh_»move
(
tsd
, &
bt2gùx
, &
gùx
->
bt
, 
NULL
, NULL))

595 
	`nÙ_»ached
();

596 
	`´of_Ëave
(
tsd
, 
td©a_£lf
);

598 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

599 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
gùx
, 
NULL
, 
Œue
,rue);

605 
gùx
->
Æimbo
--;

606 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

607 
	`´of_Ëave
(
tsd
, 
td©a_£lf
);

609 
	}
}

611 
boŞ


612 
	$´of_tùx_should_de¡roy
(
tsdn_t
 *
tsdn
, 
´of_tùx_t
 *
tùx
)

615 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, 
tùx
->
td©a
->
lock
);

617 ià(
İt_´of_accum
)

618  (
çl£
);

619 ià(
tùx
->
úts
.
curobjs
 != 0)

620  (
çl£
);

621 ià(
tùx
->
´•¬ed
)

622  (
çl£
);

623  (
Œue
);

624 
	}
}

626 
boŞ


627 
	$´of_gùx_should_de¡roy
(
´of_gùx_t
 *
gùx
)

630 ià(
İt_´of_accum
)

631  (
çl£
);

632 ià(!
	`tùx_Œ“_em±y
(&
gùx
->
tùxs
))

633  (
çl£
);

634 ià(
gùx
->
Æimbo
 != 0)

635  (
çl£
);

636  (
Œue
);

637 
	}
}

640 
	$´of_tùx_de¡roy
(
tsd_t
 *
tsd
, 
´of_tùx_t
 *
tùx
)

642 
´of_td©a_t
 *
td©a
 = 
tùx
->tdata;

643 
´of_gùx_t
 *
gùx
 = 
tùx
->gctx;

644 
boŞ
 
de¡roy_td©a
, 
de¡roy_tùx
, 
de¡roy_gùx
;

646 
	`m®loc_mu‹x_as£¹_owÃr
(
	`tsd_tsdn
(
tsd
), 
tùx
->
td©a
->
lock
);

648 
	`as£¹
(
tùx
->
úts
.
curobjs
 == 0);

649 
	`as£¹
(
tùx
->
úts
.
curby‹s
 == 0);

650 
	`as£¹
(!
İt_´of_accum
);

651 
	`as£¹
(
tùx
->
úts
.
accumobjs
 == 0);

652 
	`as£¹
(
tùx
->
úts
.
accumby‹s
 == 0);

654 
	`ckh_»move
(
tsd
, &
td©a
->
bt2tùx
, &
gùx
->
bt
, 
NULL
, NULL);

655 
de¡roy_td©a
 = 
	`´of_td©a_should_de¡roy
(
	`tsd_tsdn
(
tsd
), 
td©a
, 
çl£
);

656 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
td©a
->
lock
);

658 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

659 
tùx
->
¡©e
) {

660 
´of_tùx_¡©e_nomš®
:

661 
	`tùx_Œ“_»move
(&
gùx
->
tùxs
, 
tùx
);

662 
de¡roy_tùx
 = 
Œue
;

663 ià(
	`´of_gùx_should_de¡roy
(
gùx
)) {

678 
gùx
->
Æimbo
++;

679 
de¡roy_gùx
 = 
Œue
;

681 
de¡roy_gùx
 = 
çl£
;

683 
´of_tùx_¡©e_dumpšg
:

689 
tùx
->
¡©e
 = 
´of_tùx_¡©e_purg©Üy
;

690 
de¡roy_tùx
 = 
çl£
;

691 
de¡roy_gùx
 = 
çl£
;

694 
	`nÙ_»ached
();

695 
de¡roy_tùx
 = 
çl£
;

696 
de¡roy_gùx
 = 
çl£
;

698 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

699 ià(
de¡roy_gùx
) {

700 
	`´of_gùx_Œy_de¡roy
(
tsd
, 
	`´of_td©a_g‘
Ñsd, 
çl£
), 
gùx
,

701 
td©a
);

704 
	`m®loc_mu‹x_as£¹_nÙ_owÃr
(
	`tsd_tsdn
(
tsd
), 
tùx
->
td©a
->
lock
);

706 ià(
de¡roy_td©a
)

707 
	`´of_td©a_de¡roy
(
tsd
, 
td©a
, 
çl£
);

709 ià(
de¡roy_tùx
)

710 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
tùx
, 
NULL
, 
Œue
,rue);

711 
	}
}

713 
boŞ


714 
	$´of_lookup_glob®
(
tsd_t
 *
tsd
, 
´of_bt_t
 *
bt
, 
´of_td©a_t
 *
td©a
,

715 **
p_btkey
, 
´of_gùx_t
 **
p_gùx
, 
boŞ
 *
p_Ãw_gùx
)

718 
´of_gùx_t
 *
p
;

719 *
v
;

720 } 
gùx
;

722 
´of_bt_t
 *
p
;

723 *
v
;

724 } 
btkey
;

725 
boŞ
 
Ãw_gùx
;

727 
	`´of_’‹r
(
tsd
, 
td©a
);

728 ià(
	`ckh_£¬ch
(&
bt2gùx
, 
bt
, &
btkey
.
v
, &
gùx
.v)) {

730 
gùx
.
p
 = 
	`´of_gùx_ü—‹
(
	`tsd_tsdn
(
tsd
), 
bt
);

731 ià(
gùx
.
v
 =ğ
NULL
) {

732 
	`´of_Ëave
(
tsd
, 
td©a
);

733  (
Œue
);

735 
btkey
.
p
 = &
gùx
.p->
bt
;

736 ià(
	`ckh_š£¹
(
tsd
, &
bt2gùx
, 
btkey
.
v
, 
gùx
.v)) {

738 
	`´of_Ëave
(
tsd
, 
td©a
);

739 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
gùx
.
v
, 
NULL
, 
Œue
,rue);

740  (
Œue
);

742 
Ãw_gùx
 = 
Œue
;

748 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
gùx
.
p
->
lock
);

749 
gùx
.
p
->
Æimbo
++;

750 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
gùx
.
p
->
lock
);

751 
Ãw_gùx
 = 
çl£
;

753 
	`´of_Ëave
(
tsd
, 
td©a
);

755 *
p_btkey
 = 
btkey
.
v
;

756 *
p_gùx
 = 
gùx
.
p
;

757 *
p_Ãw_gùx
 = 
Ãw_gùx
;

758  (
çl£
);

759 
	}
}

761 
´of_tùx_t
 *

762 
	$´of_lookup
(
tsd_t
 *
tsd
, 
´of_bt_t
 *
bt
)

765 
´of_tùx_t
 *
p
;

766 *
v
;

767 } 
»t
;

768 
´of_td©a_t
 *
td©a
;

769 
boŞ
 
nÙ_found
;

771 
	`ÿs£¹
(
cÚfig_´of
);

773 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
çl£
);

774 ià(
td©a
 =ğ
NULL
)

775  (
NULL
);

777 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
td©a
->
lock
);

778 
nÙ_found
 = 
	`ckh_£¬ch
(&
td©a
->
bt2tùx
, 
bt
, 
NULL
, &
»t
.
v
);

779 ià(!
nÙ_found
)

780 
»t
.
p
->
´•¬ed
 = 
Œue
;

781 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
td©a
->
lock
);

782 ià(
nÙ_found
) {

783 *
btkey
;

784 
´of_gùx_t
 *
gùx
;

785 
boŞ
 
Ãw_gùx
, 
”rÜ
;

791 ià(
	`´of_lookup_glob®
(
tsd
, 
bt
, 
td©a
, &
btkey
, &
gùx
,

792 &
Ãw_gùx
))

793  (
NULL
);

796 
»t
.
v
 = 
	`ŸÎocztm
(
	`tsd_tsdn
(
tsd
), (
´of_tùx_t
),

797 
	`size2šdex
((
´of_tùx_t
)), 
çl£
, 
NULL
, 
Œue
,

798 
	`¬’a_ichoo£
(
tsd
, 
NULL
), 
Œue
);

799 ià(
»t
.
p
 =ğ
NULL
) {

800 ià(
Ãw_gùx
)

801 
	`´of_gùx_Œy_de¡roy
(
tsd
, 
td©a
, 
gùx
,data);

802  (
NULL
);

804 
»t
.
p
->
td©a
 =data;

805 
»t
.
p
->
thr_uid
 = 
td©a
->thr_uid;

806 
»t
.
p
->
thr_disüim
 = 
td©a
->thr_discrim;

807 
	`mem£t
(&
»t
.
p
->
úts
, 0, (
´of_út_t
));

808 
»t
.
p
->
gùx
 = gctx;

809 
»t
.
p
->
tùx_uid
 = 
td©a
->
tùx_uid_Ãxt
++;

810 
»t
.
p
->
´•¬ed
 = 
Œue
;

811 
»t
.
p
->
¡©e
 = 
´of_tùx_¡©e_š™Ÿlizšg
;

812 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
td©a
->
lock
);

813 
”rÜ
 = 
	`ckh_š£¹
(
tsd
, &
td©a
->
bt2tùx
, 
btkey
, 
»t
.
v
);

814 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
td©a
->
lock
);

815 ià(
”rÜ
) {

816 ià(
Ãw_gùx
)

817 
	`´of_gùx_Œy_de¡roy
(
tsd
, 
td©a
, 
gùx
,data);

818 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
»t
.
v
, 
NULL
, 
Œue
,rue);

819  (
NULL
);

821 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

822 
»t
.
p
->
¡©e
 = 
´of_tùx_¡©e_nomš®
;

823 
	`tùx_Œ“_š£¹
(&
gùx
->
tùxs
, 
»t
.
p
);

824 
gùx
->
Æimbo
--;

825 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

828  (
»t
.
p
);

829 
	}
}

845 
	$´of_§m¶e_th»shŞd_upd©e
(
´of_td©a_t
 *
td©a
)

847 #ifdeà
JEMALLOC_PROF


848 
ušt64_t
 
r
;

849 
u
;

851 ià(!
cÚfig_´of
)

854 ià(
lg_´of_§m¶e
 == 0) {

855 
td©a
->
by‹s_uÁ_§m¶e
 = 0;

877 
r
 = 
	`´ng_lg_¿nge_u64
(&
td©a
->
´ng_¡©e
, 53);

878 
u
 = ()
r
 * (1.0/9007199254740992.0L);

879 
td©a
->
by‹s_uÁ_§m¶e
 = (
ušt64_t
)(
	`log
(
u
) /

880 
	`log
(1.0 - (1.0 / ()((
ušt64_t
)1U << 
lg_´of_§m¶e
))))

881 + (
ušt64_t
)1U;

883 
	}
}

885 #ifdeà
JEMALLOC_JET


886 
´of_td©a_t
 *

887 
	$´of_td©a_couÁ_™”
(
´of_td©a_Œ“_t
 *
td©as
, 
´of_td©a_t
 *
td©a
, *
¬g
)

889 
size_t
 *
td©a_couÁ
 = (size_ˆ*)
¬g
;

891 (*
td©a_couÁ
)++;

893  (
NULL
);

894 
	}
}

896 
size_t


897 
	$´of_td©a_couÁ
()

899 
size_t
 
td©a_couÁ
 = 0;

900 
tsdn_t
 *
tsdn
;

902 
tsdn
 = 
	`tsdn_ãtch
();

903 
	`m®loc_mu‹x_lock
(
tsdn
, &
td©as_mtx
);

904 
	`td©a_Œ“_™”
(&
td©as
, 
NULL
, 
´of_td©a_couÁ_™”
,

905 (*)&
td©a_couÁ
);

906 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
td©as_mtx
);

908  (
td©a_couÁ
);

909 
	}
}

912 #ifdeà
JEMALLOC_JET


913 
size_t


914 
	$´of_bt_couÁ
()

916 
size_t
 
bt_couÁ
;

917 
tsd_t
 *
tsd
;

918 
´of_td©a_t
 *
td©a
;

920 
tsd
 = 
	`tsd_ãtch
();

921 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
çl£
);

922 ià(
td©a
 =ğ
NULL
)

925 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
bt2gùx_mtx
);

926 
bt_couÁ
 = 
	`ckh_couÁ
(&
bt2gùx
);

927 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
bt2gùx_mtx
);

929  (
bt_couÁ
);

930 
	}
}

933 #ifdeà
JEMALLOC_JET


934 #undeà
´of_dump_İ’


935 
	#´of_dump_İ’
 
	`JEMALLOC_N
(
´of_dump_İ’_im¶
)

	)

938 
	$´of_dump_İ’
(
boŞ
 
´İag©e_”r
, cÚ¡ *
f’ame
)

940 
fd
;

942 
fd
 = 
	`ü—t
(
f’ame
, 0644);

943 ià(
fd
 =ğ-1 && !
´İag©e_”r
) {

944 
	`m®loc_´štf
("<jemalloc>: creat(\"%s\"), 0644) failed\n",

945 
f’ame
);

946 ià(
İt_abÜt
)

947 
	`abÜt
();

950  (
fd
);

951 
	}
}

952 #ifdeà
JEMALLOC_JET


953 #undeà
´of_dump_İ’


954 
	#´of_dump_İ’
 
	`JEMALLOC_N
(
´of_dump_İ’
)

	)

955 
´of_dump_İ’_t
 *
	g´of_dump_İ’
 = 
JEMALLOC_N
(
´of_dump_İ’_im¶
);

958 
boŞ


959 
	$´of_dump_æush
(
boŞ
 
´İag©e_”r
)

961 
boŞ
 
»t
 = 
çl£
;

962 
ssize_t
 
”r
;

964 
	`ÿs£¹
(
cÚfig_´of
);

966 
”r
 = 
	`wr™e
(
´of_dump_fd
, 
´of_dump_buf
, 
´of_dump_buf_’d
);

967 ià(
”r
 == -1) {

968 ià(!
´İag©e_”r
) {

969 
	`m®loc_wr™e
("<jemalloc>: write() failed during heap "

971 ià(
İt_abÜt
)

972 
	`abÜt
();

974 
»t
 = 
Œue
;

976 
´of_dump_buf_’d
 = 0;

978  (
»t
);

979 
	}
}

981 
boŞ


982 
	$´of_dump_şo£
(
boŞ
 
´İag©e_”r
)

984 
boŞ
 
»t
;

986 
	`as£¹
(
´of_dump_fd
 != -1);

987 
»t
 = 
	`´of_dump_æush
(
´İag©e_”r
);

988 
	`şo£
(
´of_dump_fd
);

989 
´of_dump_fd
 = -1;

991  (
»t
);

992 
	}
}

994 
boŞ


995 
	$´of_dump_wr™e
(
boŞ
 
´İag©e_”r
, cÚ¡ *
s
)

997 
size_t
 
i
, 
¦’
, 
n
;

999 
	`ÿs£¹
(
cÚfig_´of
);

1001 
i
 = 0;

1002 
¦’
 = 
	`¡¾’
(
s
);

1003 
i
 < 
¦’
) {

1005 ià(
´of_dump_buf_’d
 =ğ
PROF_DUMP_BUFSIZE
)

1006 ià(
	`´of_dump_æush
(
´İag©e_”r
) &&…ropagate_err)

1007  (
Œue
);

1009 ià(
´of_dump_buf_’d
 + 
¦’
 <ğ
PROF_DUMP_BUFSIZE
) {

1011 
n
 = 
¦’
 - 
i
;

1014 
n
 = 
PROF_DUMP_BUFSIZE
 - 
´of_dump_buf_’d
;

1016 
	`memıy
(&
´of_dump_buf
[
´of_dump_buf_’d
], &
s
[
i
], 
n
);

1017 
´of_dump_buf_’d
 +ğ
n
;

1018 
i
 +ğ
n
;

1021  (
çl£
);

1022 
	}
}

1024 
	$JEMALLOC_FORMAT_PRINTF
(2, 3)

1025 
boŞ


1026 
	$´of_dump_´štf
(
boŞ
 
´İag©e_”r
, cÚ¡ *
fÜm©
, ...)

1028 
boŞ
 
»t
;

1029 
va_li¡
 
­
;

1030 
buf
[
PROF_PRINTF_BUFSIZE
];

1032 
	`va_¡¬t
(
­
, 
fÜm©
);

1033 
	`m®loc_v¢´štf
(
buf
, (buf), 
fÜm©
, 
­
);

1034 
	`va_’d
(
­
);

1035 
»t
 = 
	`´of_dump_wr™e
(
´İag©e_”r
, 
buf
);

1037  (
»t
);

1038 
	}
}

1041 
	$´of_tùx_m”ge_td©a
(
tsdn_t
 *
tsdn
, 
´of_tùx_t
 *
tùx
, 
´of_td©a_t
 *
td©a
)

1044 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, 
tùx
->
td©a
->
lock
);

1046 
	`m®loc_mu‹x_lock
(
tsdn
, 
tùx
->
gùx
->
lock
);

1048 
tùx
->
¡©e
) {

1049 
´of_tùx_¡©e_š™Ÿlizšg
:

1050 
	`m®loc_mu‹x_uÆock
(
tsdn
, 
tùx
->
gùx
->
lock
);

1052 
´of_tùx_¡©e_nomš®
:

1053 
tùx
->
¡©e
 = 
´of_tùx_¡©e_dumpšg
;

1054 
	`m®loc_mu‹x_uÆock
(
tsdn
, 
tùx
->
gùx
->
lock
);

1056 
	`memıy
(&
tùx
->
dump_úts
, &tùx->
úts
, (
´of_út_t
));

1058 
td©a
->
út_summed
.
curobjs
 +ğ
tùx
->
dump_úts
.curobjs;

1059 
td©a
->
út_summed
.
curby‹s
 +ğ
tùx
->
dump_úts
.curbytes;

1060 ià(
İt_´of_accum
) {

1061 
td©a
->
út_summed
.
accumobjs
 +=

1062 
tùx
->
dump_úts
.
accumobjs
;

1063 
td©a
->
út_summed
.
accumby‹s
 +=

1064 
tùx
->
dump_úts
.
accumby‹s
;

1067 
´of_tùx_¡©e_dumpšg
:

1068 
´of_tùx_¡©e_purg©Üy
:

1069 
	`nÙ_»ached
();

1071 
	}
}

1074 
	$´of_tùx_m”ge_gùx
(
tsdn_t
 *
tsdn
, 
´of_tùx_t
 *
tùx
, 
´of_gùx_t
 *
gùx
)

1077 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, 
gùx
->
lock
);

1079 
gùx
->
út_summed
.
curobjs
 +ğ
tùx
->
dump_úts
.curobjs;

1080 
gùx
->
út_summed
.
curby‹s
 +ğ
tùx
->
dump_úts
.curbytes;

1081 ià(
İt_´of_accum
) {

1082 
gùx
->
út_summed
.
accumobjs
 +ğ
tùx
->
dump_úts
.accumobjs;

1083 
gùx
->
út_summed
.
accumby‹s
 +ğ
tùx
->
dump_úts
.accumbytes;

1085 
	}
}

1087 
´of_tùx_t
 *

1088 
	$´of_tùx_m”ge_™”
(
´of_tùx_Œ“_t
 *
tùxs
, 
´of_tùx_t
 *
tùx
, *
¬g
)

1090 
tsdn_t
 *
tsdn
 = (tsdn_ˆ*)
¬g
;

1092 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, 
tùx
->
gùx
->
lock
);

1094 
tùx
->
¡©e
) {

1095 
´of_tùx_¡©e_nomš®
:

1098 
´of_tùx_¡©e_dumpšg
:

1099 
´of_tùx_¡©e_purg©Üy
:

1100 
	`´of_tùx_m”ge_gùx
(
tsdn
, 
tùx
,ùx->
gùx
);

1103 
	`nÙ_»ached
();

1106  (
NULL
);

1107 
	}
}

1109 
	s´of_tùx_dump_™”_¬g_s
 {

1110 
tsdn_t
 *
	mtsdn
;

1111 
boŞ
 
	m´İag©e_”r
;

1114 
´of_tùx_t
 *

1115 
	$´of_tùx_dump_™”
(
´of_tùx_Œ“_t
 *
tùxs
, 
´of_tùx_t
 *
tùx
, *
İaque
)

1117 
´of_tùx_dump_™”_¬g_s
 *
¬g
 =

1118 (
´of_tùx_dump_™”_¬g_s
 *)
İaque
;

1120 
	`m®loc_mu‹x_as£¹_owÃr
(
¬g
->
tsdn
, 
tùx
->
gùx
->
lock
);

1122 
tùx
->
¡©e
) {

1123 
´of_tùx_¡©e_š™Ÿlizšg
:

1124 
´of_tùx_¡©e_nomš®
:

1127 
´of_tùx_¡©e_dumpšg
:

1128 
´of_tùx_¡©e_purg©Üy
:

1129 ià(
	`´of_dump_´štf
(
¬g
->
´İag©e_”r
,

1130 "%"
FMTu64
": %"FMTu64": %"FMTu64" [%"FMTu64": "

1131 "%"
FMTu64
"]\n", 
tùx
->
thr_uid
,ùx->
dump_úts
.
curobjs
,

1132 
tùx
->
dump_úts
.
curby‹s
,ùx->dump_úts.
accumobjs
,

1133 
tùx
->
dump_úts
.
accumby‹s
))

1134  (
tùx
);

1137 
	`nÙ_»ached
();

1139  (
NULL
);

1140 
	}
}

1142 
´of_tùx_t
 *

1143 
	$´of_tùx_fšish_™”
(
´of_tùx_Œ“_t
 *
tùxs
, 
´of_tùx_t
 *
tùx
, *
¬g
)

1145 
tsdn_t
 *
tsdn
 = (tsdn_ˆ*)
¬g
;

1146 
´of_tùx_t
 *
»t
;

1148 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, 
tùx
->
gùx
->
lock
);

1150 
tùx
->
¡©e
) {

1151 
´of_tùx_¡©e_nomš®
:

1154 
´of_tùx_¡©e_dumpšg
:

1155 
tùx
->
¡©e
 = 
´of_tùx_¡©e_nomš®
;

1157 
´of_tùx_¡©e_purg©Üy
:

1158 
»t
 = 
tùx
;

1159 
Ïb–_»tuº
;

1161 
	`nÙ_»ached
();

1164 
»t
 = 
NULL
;

1165 
Ïb–_»tuº
:

1166  (
»t
);

1167 
	}
}

1170 
	$´of_dump_gùx_´•
(
tsdn_t
 *
tsdn
, 
´of_gùx_t
 *
gùx
, 
´of_gùx_Œ“_t
 *
gùxs
)

1173 
	`ÿs£¹
(
cÚfig_´of
);

1175 
	`m®loc_mu‹x_lock
(
tsdn
, 
gùx
->
lock
);

1182 
gùx
->
Æimbo
++;

1183 
	`gùx_Œ“_š£¹
(
gùxs
, 
gùx
);

1185 
	`mem£t
(&
gùx
->
út_summed
, 0, (
´of_út_t
));

1187 
	`m®loc_mu‹x_uÆock
(
tsdn
, 
gùx
->
lock
);

1188 
	}
}

1190 
	s´of_gùx_m”ge_™”_¬g_s
 {

1191 
tsdn_t
 *
	mtsdn
;

1192 
size_t
 
	mËak_ngùx
;

1195 
´of_gùx_t
 *

1196 
	$´of_gùx_m”ge_™”
(
´of_gùx_Œ“_t
 *
gùxs
, 
´of_gùx_t
 *
gùx
, *
İaque
)

1198 
´of_gùx_m”ge_™”_¬g_s
 *
¬g
 =

1199 (
´of_gùx_m”ge_™”_¬g_s
 *)
İaque
;

1201 
	`m®loc_mu‹x_lock
(
¬g
->
tsdn
, 
gùx
->
lock
);

1202 
	`tùx_Œ“_™”
(&
gùx
->
tùxs
, 
NULL
, 
´of_tùx_m”ge_™”
,

1203 (*)
¬g
->
tsdn
);

1204 ià(
gùx
->
út_summed
.
curobjs
 != 0)

1205 
¬g
->
Ëak_ngùx
++;

1206 
	`m®loc_mu‹x_uÆock
(
¬g
->
tsdn
, 
gùx
->
lock
);

1208  (
NULL
);

1209 
	}
}

1212 
	$´of_gùx_fšish
(
tsd_t
 *
tsd
, 
´of_gùx_Œ“_t
 *
gùxs
)

1214 
´of_td©a_t
 *
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
çl£
);

1215 
´of_gùx_t
 *
gùx
;

1223 (
gùx
 = 
	`gùx_Œ“_fœ¡
(
gùxs
)è!ğ
NULL
) {

1224 
	`gùx_Œ“_»move
(
gùxs
, 
gùx
);

1225 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

1227 
´of_tùx_t
 *
Ãxt
;

1229 
Ãxt
 = 
NULL
;

1231 
´of_tùx_t
 *
to_de¡roy
 =

1232 
	`tùx_Œ“_™”
(&
gùx
->
tùxs
, 
Ãxt
,

1233 
´of_tùx_fšish_™”
,

1234 (*)
	`tsd_tsdn
(
tsd
));

1235 ià(
to_de¡roy
 !ğ
NULL
) {

1236 
Ãxt
 = 
	`tùx_Œ“_Ãxt
(&
gùx
->
tùxs
,

1237 
to_de¡roy
);

1238 
	`tùx_Œ“_»move
(&
gùx
->
tùxs
,

1239 
to_de¡roy
);

1240 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
to_de¡roy
,

1241 
NULL
, 
Œue
,rue);

1243 
Ãxt
 = 
NULL
;

1244 } 
Ãxt
 !ğ
NULL
);

1246 
gùx
->
Æimbo
--;

1247 ià(
	`´of_gùx_should_de¡roy
(
gùx
)) {

1248 
gùx
->
Æimbo
++;

1249 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

1250 
	`´of_gùx_Œy_de¡roy
(
tsd
, 
td©a
, 
gùx
,data);

1252 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
gùx
->
lock
);

1254 
	}
}

1256 
	s´of_td©a_m”ge_™”_¬g_s
 {

1257 
tsdn_t
 *
	mtsdn
;

1258 
´of_út_t
 
	mút_®l
;

1261 
´of_td©a_t
 *

1262 
	$´of_td©a_m”ge_™”
(
´of_td©a_Œ“_t
 *
td©as
, 
´of_td©a_t
 *
td©a
,

1263 *
İaque
)

1265 
´of_td©a_m”ge_™”_¬g_s
 *
¬g
 =

1266 (
´of_td©a_m”ge_™”_¬g_s
 *)
İaque
;

1268 
	`m®loc_mu‹x_lock
(
¬g
->
tsdn
, 
td©a
->
lock
);

1269 ià(!
td©a
->
expœed
) {

1270 
size_t
 
bšd
;

1272 
´of_tùx_t
 *
p
;

1273 *
v
;

1274 } 
tùx
;

1276 
td©a
->
dumpšg
 = 
Œue
;

1277 
	`mem£t
(&
td©a
->
út_summed
, 0, (
´of_út_t
));

1278 
bšd
 = 0; !
	`ckh_™”
(&
td©a
->
bt2tùx
, &bšd, 
NULL
,

1279 &
tùx
.
v
);)

1280 
	`´of_tùx_m”ge_td©a
(
¬g
->
tsdn
, 
tùx
.
p
, 
td©a
);

1282 
¬g
->
út_®l
.
curobjs
 +ğ
td©a
->
út_summed
.curobjs;

1283 
¬g
->
út_®l
.
curby‹s
 +ğ
td©a
->
út_summed
.curbytes;

1284 ià(
İt_´of_accum
) {

1285 
¬g
->
út_®l
.
accumobjs
 +ğ
td©a
->
út_summed
.accumobjs;

1286 
¬g
->
út_®l
.
accumby‹s
 +ğ
td©a
->
út_summed
.accumbytes;

1289 
td©a
->
dumpšg
 = 
çl£
;

1290 
	`m®loc_mu‹x_uÆock
(
¬g
->
tsdn
, 
td©a
->
lock
);

1292  (
NULL
);

1293 
	}
}

1295 
´of_td©a_t
 *

1296 
	$´of_td©a_dump_™”
(
´of_td©a_Œ“_t
 *
td©as
, 
´of_td©a_t
 *
td©a
, *
¬g
)

1298 
boŞ
 
´İag©e_”r
 = *(boŞ *)
¬g
;

1300 ià(!
td©a
->
dumpšg
)

1301  (
NULL
);

1303 ià(
	`´of_dump_´štf
(
´İag©e_”r
,

1304 "%"
FMTu64
": %"FMTu64": %"FMTu64" [%"FMTu64": %"FMTu64"]%s%s\n",

1305 
td©a
->
thr_uid
,d©a->
út_summed
.
curobjs
,

1306 
td©a
->
út_summed
.
curby‹s
,d©a->út_summed.
accumobjs
,

1307 
td©a
->
út_summed
.
accumby‹s
,

1308 (
td©a
->
th»ad_Çme
 !ğ
NULL
) ? " " : "",

1309 (
td©a
->
th»ad_Çme
 !ğ
NULL
) ?data->thread_name : ""))

1310  (
td©a
);

1311  (
NULL
);

1312 
	}
}

1314 #ifdeà
JEMALLOC_JET


1315 #undeà
´of_dump_h—d”


1316 
	#´of_dump_h—d”
 
	`JEMALLOC_N
(
´of_dump_h—d”_im¶
)

	)

1318 
boŞ


1319 
	$´of_dump_h—d”
(
tsdn_t
 *
tsdn
, 
boŞ
 
´İag©e_”r
, cÚ¡ 
´of_út_t
 *
út_®l
)

1321 
boŞ
 
»t
;

1323 ià(
	`´of_dump_´štf
(
´İag©e_”r
,

1324 "h—p_v2/%"
FMTu64
"\n"

1325 "*: %"
FMTu64
": %"FMTu64" [%"FMTu64": %"FMTu64"]\n",

1326 ((
ušt64_t
)1U << 
lg_´of_§m¶e
), 
út_®l
->
curobjs
,

1327 
út_®l
->
curby‹s
, cÁ_®l->
accumobjs
, cÁ_®l->
accumby‹s
))

1328  (
Œue
);

1330 
	`m®loc_mu‹x_lock
(
tsdn
, &
td©as_mtx
);

1331 
»t
 = (
	`td©a_Œ“_™”
(&
td©as
, 
NULL
, 
´of_td©a_dump_™”
,

1332 (*)&
´İag©e_”r
è!ğ
NULL
);

1333 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
td©as_mtx
);

1334  (
»t
);

1335 
	}
}

1336 #ifdeà
JEMALLOC_JET


1337 #undeà
´of_dump_h—d”


1338 
	#´of_dump_h—d”
 
	`JEMALLOC_N
(
´of_dump_h—d”
)

	)

1339 
´of_dump_h—d”_t
 *
	g´of_dump_h—d”
 = 
JEMALLOC_N
(
´of_dump_h—d”_im¶
);

1342 
boŞ


1343 
	$´of_dump_gùx
(
tsdn_t
 *
tsdn
, 
boŞ
 
´İag©e_”r
, 
´of_gùx_t
 *
gùx
,

1344 cÚ¡ 
´of_bt_t
 *
bt
, 
´of_gùx_Œ“_t
 *
gùxs
)

1346 
boŞ
 
»t
;

1347 
i
;

1348 
´of_tùx_dump_™”_¬g_s
 
´of_tùx_dump_™”_¬g
;

1350 
	`ÿs£¹
(
cÚfig_´of
);

1351 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, 
gùx
->
lock
);

1354 ià((!
İt_´of_accum
 && 
gùx
->
út_summed
.
curobjs
 == 0) ||

1355 (
İt_´of_accum
 && 
gùx
->
út_summed
.
accumobjs
 == 0)) {

1356 
	`as£¹
(
gùx
->
út_summed
.
curobjs
 == 0);

1357 
	`as£¹
(
gùx
->
út_summed
.
curby‹s
 == 0);

1358 
	`as£¹
(
gùx
->
út_summed
.
accumobjs
 == 0);

1359 
	`as£¹
(
gùx
->
út_summed
.
accumby‹s
 == 0);

1360 
»t
 = 
çl£
;

1361 
Ïb–_»tuº
;

1364 ià(
	`´of_dump_´štf
(
´İag©e_”r
, "@")) {

1365 
»t
 = 
Œue
;

1366 
Ïb–_»tuº
;

1368 
i
 = 0; i < 
bt
->
Ën
; i++) {

1369 ià(
	`´of_dump_´štf
(
´İag©e_”r
, " %#"
FMTxPTR
,

1370 (
ušŒ_t
)
bt
->
vec
[
i
])) {

1371 
»t
 = 
Œue
;

1372 
Ïb–_»tuº
;

1376 ià(
	`´of_dump_´štf
(
´İag©e_”r
,

1378 "*: %"
FMTu64
": %"FMTu64" [%"FMTu64": %"FMTu64"]\n",

1379 
gùx
->
út_summed
.
curobjs
, gùx->út_summed.
curby‹s
,

1380 
gùx
->
út_summed
.
accumobjs
, gùx->út_summed.
accumby‹s
)) {

1381 
»t
 = 
Œue
;

1382 
Ïb–_»tuº
;

1385 
´of_tùx_dump_™”_¬g
.
tsdn
 =sdn;

1386 
´of_tùx_dump_™”_¬g
.
´İag©e_”r
 =…ropagate_err;

1387 ià(
	`tùx_Œ“_™”
(&
gùx
->
tùxs
, 
NULL
, 
´of_tùx_dump_™”
,

1388 (*)&
´of_tùx_dump_™”_¬g
è!ğ
NULL
) {

1389 
»t
 = 
Œue
;

1390 
Ïb–_»tuº
;

1393 
»t
 = 
çl£
;

1394 
Ïb–_»tuº
:

1395  (
»t
);

1396 
	}
}

1398 #iâdeà
_WIN32


1399 
	$JEMALLOC_FORMAT_PRINTF
(1, 2)

1401 
	$´of_İ’_m­s
(cÚ¡ *
fÜm©
, ...)

1403 
mfd
;

1404 
va_li¡
 
­
;

1405 
f’ame
[
PATH_MAX
 + 1];

1407 
	`va_¡¬t
(
­
, 
fÜm©
);

1408 
	`m®loc_v¢´štf
(
f’ame
, (f’ame), 
fÜm©
, 
­
);

1409 
	`va_’d
(
­
);

1410 
mfd
 = 
	`İ’
(
f’ame
, 
O_RDONLY
);

1412  (
mfd
);

1413 
	}
}

1417 
	$´of_g‘pid
()

1420 #ifdeà
_WIN32


1421  (
	`G‘Cu¼’tProûssId
());

1423  (
	`g‘pid
());

1425 
	}
}

1427 
boŞ


1428 
	$´of_dump_m­s
(
boŞ
 
´İag©e_”r
)

1430 
boŞ
 
»t
;

1431 
mfd
;

1433 
	`ÿs£¹
(
cÚfig_´of
);

1434 #ifdeà
__F»eBSD__


1435 
mfd
 = 
	`´of_İ’_m­s
("/proc/curproc/map");

1436 #–ià
	`defšed
(
_WIN32
)

1437 
mfd
 = -1;

1440 
pid
 = 
	`´of_g‘pid
();

1442 
mfd
 = 
	`´of_İ’_m­s
("/´oc/%d/sk/%d/m­s", 
pid
,…id);

1443 ià(
mfd
 == -1)

1444 
mfd
 = 
	`´of_İ’_m­s
("/´oc/%d/m­s", 
pid
);

1447 ià(
mfd
 != -1) {

1448 
ssize_t
 
Ä—d
;

1450 ià(
	`´of_dump_wr™e
(
´İag©e_”r
, "\nMAPPED_LIBRARIES:\n") &&

1451 
´İag©e_”r
) {

1452 
»t
 = 
Œue
;

1453 
Ïb–_»tuº
;

1455 
Ä—d
 = 0;

1457 
´of_dump_buf_’d
 +ğ
Ä—d
;

1458 ià(
´of_dump_buf_’d
 =ğ
PROF_DUMP_BUFSIZE
) {

1460 ià(
	`´of_dump_æush
(
´İag©e_”r
) &&

1461 
´İag©e_”r
) {

1462 
»t
 = 
Œue
;

1463 
Ïb–_»tuº
;

1466 
Ä—d
 = 
	`»ad
(
mfd
, &
´of_dump_buf
[
´of_dump_buf_’d
],

1467 
PROF_DUMP_BUFSIZE
 - 
´of_dump_buf_’d
);

1468 } 
Ä—d
 > 0);

1470 
»t
 = 
Œue
;

1471 
Ïb–_»tuº
;

1474 
»t
 = 
çl£
;

1475 
Ïb–_»tuº
:

1476 ià(
mfd
 != -1)

1477 
	`şo£
(
mfd
);

1478  (
»t
);

1479 
	}
}

1486 
	$´of_Ëakcheck
(cÚ¡ 
´of_út_t
 *
út_®l
, 
size_t
 
Ëak_ngùx
,

1487 cÚ¡ *
f’ame
)

1490 #ifdeà
JEMALLOC_PROF


1497 ià(
út_®l
->
curby‹s
 != 0) {

1498 
§m¶e_³riod
 = ()((
ušt64_t
)1 << 
lg_´of_§m¶e
);

1499 
¿tio
 = ((()
út_®l
->
curby‹s
) /

1500 ()
út_®l
->
curobjs
è/ 
§m¶e_³riod
;

1501 
sÿË_çùÜ
 = 1.0 / (1.0 - 
	`exp
(-
¿tio
));

1502 
ušt64_t
 
curby‹s
 = (ušt64_t)
	`round
((()
út_®l
->curbytes)

1503 * 
sÿË_çùÜ
);

1504 
ušt64_t
 
curobjs
 = (ušt64_t)
	`round
((()
út_®l
->curobjs) *

1505 
sÿË_çùÜ
);

1507 
	`m®loc_´štf
("<jem®loc>: L—k‡µroxim©iÚ summ¬y: ~%"
FMTu64


1508 " by‹%s, ~%"
FMTu64
" object%s, >= %zu context%s\n",

1509 
curby‹s
, (curby‹ !ğ1è? "s" : "", 
curobjs
, (curobjs !=

1510 1è? "s" : "", 
Ëak_ngùx
, (leak_ngctx != 1) ? "s" : "");

1511 
	`m®loc_´štf
(

1513 
f’ame
);

1516 
	}
}

1518 
	s´of_gùx_dump_™”_¬g_s
 {

1519 
tsdn_t
 *
	mtsdn
;

1520 
boŞ
 
	m´İag©e_”r
;

1523 
´of_gùx_t
 *

1524 
	$´of_gùx_dump_™”
(
´of_gùx_Œ“_t
 *
gùxs
, 
´of_gùx_t
 *
gùx
, *
İaque
)

1526 
´of_gùx_t
 *
»t
;

1527 
´of_gùx_dump_™”_¬g_s
 *
¬g
 =

1528 (
´of_gùx_dump_™”_¬g_s
 *)
İaque
;

1530 
	`m®loc_mu‹x_lock
(
¬g
->
tsdn
, 
gùx
->
lock
);

1532 ià(
	`´of_dump_gùx
(
¬g
->
tsdn
,‡rg->
´İag©e_”r
, 
gùx
, &gùx->
bt
,

1533 
gùxs
)) {

1534 
»t
 = 
gùx
;

1535 
Ïb–_»tuº
;

1538 
»t
 = 
NULL
;

1539 
Ïb–_»tuº
:

1540 
	`m®loc_mu‹x_uÆock
(
¬g
->
tsdn
, 
gùx
->
lock
);

1541  (
»t
);

1542 
	}
}

1544 
boŞ


1545 
	$´of_dump
(
tsd_t
 *
tsd
, 
boŞ
 
´İag©e_”r
, cÚ¡ *
f’ame
, boŞ 
Ëakcheck
)

1547 
´of_td©a_t
 *
td©a
;

1548 
´of_td©a_m”ge_™”_¬g_s
 
´of_td©a_m”ge_™”_¬g
;

1549 
size_t
 
bšd
;

1551 
´of_gùx_t
 *
p
;

1552 *
v
;

1553 } 
gùx
;

1554 
´of_gùx_m”ge_™”_¬g_s
 
´of_gùx_m”ge_™”_¬g
;

1555 
´of_gùx_dump_™”_¬g_s
 
´of_gùx_dump_™”_¬g
;

1556 
´of_gùx_Œ“_t
 
gùxs
;

1558 
	`ÿs£¹
(
cÚfig_´of
);

1560 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
Œue
);

1561 ià(
td©a
 =ğ
NULL
)

1562  (
Œue
);

1564 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_mtx
);

1565 
	`´of_’‹r
(
tsd
, 
td©a
);

1571 
	`gùx_Œ“_Ãw
(&
gùxs
);

1572 
bšd
 = 0; !
	`ckh_™”
(&
bt2gùx
, &bšd, 
NULL
, &
gùx
.
v
);)

1573 
	`´of_dump_gùx_´•
(
	`tsd_tsdn
(
tsd
), 
gùx
.
p
, &
gùxs
);

1579 
´of_td©a_m”ge_™”_¬g
.
tsdn
 = 
	`tsd_tsdn
(
tsd
);

1580 
	`mem£t
(&
´of_td©a_m”ge_™”_¬g
.
út_®l
, 0, (
´of_út_t
));

1581 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
td©as_mtx
);

1582 
	`td©a_Œ“_™”
(&
td©as
, 
NULL
, 
´of_td©a_m”ge_™”
,

1583 (*)&
´of_td©a_m”ge_™”_¬g
);

1584 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
td©as_mtx
);

1587 
´of_gùx_m”ge_™”_¬g
.
tsdn
 = 
	`tsd_tsdn
(
tsd
);

1588 
´of_gùx_m”ge_™”_¬g
.
Ëak_ngùx
 = 0;

1589 
	`gùx_Œ“_™”
(&
gùxs
, 
NULL
, 
´of_gùx_m”ge_™”
,

1590 (*)&
´of_gùx_m”ge_™”_¬g
);

1592 
	`´of_Ëave
(
tsd
, 
td©a
);

1595 ià((
´of_dump_fd
 = 
	`´of_dump_İ’
(
´İag©e_”r
, 
f’ame
)) == -1)

1596 
Ïb–_İ’_şo£_”rÜ
;

1599 ià(
	`´of_dump_h—d”
(
	`tsd_tsdn
(
tsd
), 
´İag©e_”r
,

1600 &
´of_td©a_m”ge_™”_¬g
.
út_®l
))

1601 
Ïb–_wr™e_”rÜ
;

1604 
´of_gùx_dump_™”_¬g
.
tsdn
 = 
	`tsd_tsdn
(
tsd
);

1605 
´of_gùx_dump_™”_¬g
.
´İag©e_”r
 =…ropagate_err;

1606 ià(
	`gùx_Œ“_™”
(&
gùxs
, 
NULL
, 
´of_gùx_dump_™”
,

1607 (*)&
´of_gùx_dump_™”_¬g
è!ğ
NULL
)

1608 
Ïb–_wr™e_”rÜ
;

1611 ià(
	`´of_dump_m­s
(
´İag©e_”r
))

1612 
Ïb–_wr™e_”rÜ
;

1614 ià(
	`´of_dump_şo£
(
´İag©e_”r
))

1615 
Ïb–_İ’_şo£_”rÜ
;

1617 
	`´of_gùx_fšish
(
tsd
, &
gùxs
);

1618 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_mtx
);

1620 ià(
Ëakcheck
) {

1621 
	`´of_Ëakcheck
(&
´of_td©a_m”ge_™”_¬g
.
út_®l
,

1622 
´of_gùx_m”ge_™”_¬g
.
Ëak_ngùx
, 
f’ame
);

1624  (
çl£
);

1625 
Ïb–_wr™e_”rÜ
:

1626 
	`´of_dump_şo£
(
´İag©e_”r
);

1627 
Ïb–_İ’_şo£_”rÜ
:

1628 
	`´of_gùx_fšish
(
tsd
, &
gùxs
);

1629 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_mtx
);

1630  (
Œue
);

1631 
	}
}

1633 
	#DUMP_FILENAME_BUFSIZE
 (
PATH_MAX
 + 1)

	)

1634 
	#VSEQ_INVALID
 
	`UINT64_C
(0xffffffffffffffff)

	)

1636 
	$´of_dump_f’ame
(*
f’ame
, 
v
, 
ušt64_t
 
v£q
)

1639 
	`ÿs£¹
(
cÚfig_´of
);

1641 ià(
v£q
 !ğ
VSEQ_INVALID
) {

1643 
	`m®loc_¢´štf
(
f’ame
, 
DUMP_FILENAME_BUFSIZE
,

1644 "%s.%d.%"
FMTu64
".%c%"FMTu64".heap",

1645 
İt_´of_´efix
, 
	`´of_g‘pid
(), 
´of_dump_£q
, 
v
, 
v£q
);

1648 
	`m®loc_¢´štf
(
f’ame
, 
DUMP_FILENAME_BUFSIZE
,

1649 "%s.%d.%"
FMTu64
".%c.heap",

1650 
İt_´of_´efix
, 
	`´of_g‘pid
(), 
´of_dump_£q
, 
v
);

1652 
´of_dump_£q
++;

1653 
	}
}

1656 
	$´of_fdump
()

1658 
tsd_t
 *
tsd
;

1659 
f’ame
[
DUMP_FILENAME_BUFSIZE
];

1661 
	`ÿs£¹
(
cÚfig_´of
);

1662 
	`as£¹
(
İt_´of_fš®
);

1663 
	`as£¹
(
İt_´of_´efix
[0] != '\0');

1665 ià(!
´of_boÙed
)

1667 
tsd
 = 
	`tsd_ãtch
();

1669 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_£q_mtx
);

1670 
	`´of_dump_f’ame
(
f’ame
, 'f', 
VSEQ_INVALID
);

1671 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_£q_mtx
);

1672 
	`´of_dump
(
tsd
, 
çl£
, 
f’ame
, 
İt_´of_Ëak
);

1673 
	}
}

1676 
	$´of_idump
(
tsdn_t
 *
tsdn
)

1678 
tsd_t
 *
tsd
;

1679 
´of_td©a_t
 *
td©a
;

1681 
	`ÿs£¹
(
cÚfig_´of
);

1683 ià(!
´of_boÙed
 || 
	`tsdn_nuÎ
(
tsdn
))

1685 
tsd
 = 
	`tsdn_tsd
(
tsdn
);

1686 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
çl£
);

1687 ià(
td©a
 =ğ
NULL
)

1689 ià(
td©a
->
’q
) {

1690 
td©a
->
’q_idump
 = 
Œue
;

1694 ià(
İt_´of_´efix
[0] != '\0') {

1695 
f’ame
[
PATH_MAX
 + 1];

1696 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_£q_mtx
);

1697 
	`´of_dump_f’ame
(
f’ame
, 'i', 
´of_dump_i£q
);

1698 
´of_dump_i£q
++;

1699 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_£q_mtx
);

1700 
	`´of_dump
(
tsd
, 
çl£
, 
f’ame
, false);

1702 
	}
}

1704 
boŞ


1705 
	$´of_mdump
(
tsd_t
 *
tsd
, cÚ¡ *
f’ame
)

1707 
f’ame_buf
[
DUMP_FILENAME_BUFSIZE
];

1709 
	`ÿs£¹
(
cÚfig_´of
);

1711 ià(!
İt_´of
 || !
´of_boÙed
)

1712  (
Œue
);

1714 ià(
f’ame
 =ğ
NULL
) {

1716 ià(
İt_´of_´efix
[0] == '\0')

1717  (
Œue
);

1718 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_£q_mtx
);

1719 
	`´of_dump_f’ame
(
f’ame_buf
, 'm', 
´of_dump_m£q
);

1720 
´of_dump_m£q
++;

1721 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_£q_mtx
);

1722 
f’ame
 = 
f’ame_buf
;

1724  (
	`´of_dump
(
tsd
, 
Œue
, 
f’ame
, 
çl£
));

1725 
	}
}

1728 
	$´of_gdump
(
tsdn_t
 *
tsdn
)

1730 
tsd_t
 *
tsd
;

1731 
´of_td©a_t
 *
td©a
;

1733 
	`ÿs£¹
(
cÚfig_´of
);

1735 ià(!
´of_boÙed
 || 
	`tsdn_nuÎ
(
tsdn
))

1737 
tsd
 = 
	`tsdn_tsd
(
tsdn
);

1738 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
çl£
);

1739 ià(
td©a
 =ğ
NULL
)

1741 ià(
td©a
->
’q
) {

1742 
td©a
->
’q_gdump
 = 
Œue
;

1746 ià(
İt_´of_´efix
[0] != '\0') {

1747 
f’ame
[
DUMP_FILENAME_BUFSIZE
];

1748 
	`m®loc_mu‹x_lock
(
tsdn
, &
´of_dump_£q_mtx
);

1749 
	`´of_dump_f’ame
(
f’ame
, 'u', 
´of_dump_u£q
);

1750 
´of_dump_u£q
++;

1751 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
´of_dump_£q_mtx
);

1752 
	`´of_dump
(
tsd
, 
çl£
, 
f’ame
, false);

1754 
	}
}

1757 
	$´of_bt_hash
(cÚ¡ *
key
, 
size_t
 
r_hash
[2])

1759 
´of_bt_t
 *
bt
 = (´of_bt_ˆ*)
key
;

1761 
	`ÿs£¹
(
cÚfig_´of
);

1763 
	`hash
(
bt
->
vec
, bt->
Ën
 * (*), 0x94122f33U, 
r_hash
);

1764 
	}
}

1766 
boŞ


1767 
	$´of_bt_keycomp
(cÚ¡ *
k1
, cÚ¡ *
k2
)

1769 cÚ¡ 
´of_bt_t
 *
bt1
 = (´of_bt_ˆ*)
k1
;

1770 cÚ¡ 
´of_bt_t
 *
bt2
 = (´of_bt_ˆ*)
k2
;

1772 
	`ÿs£¹
(
cÚfig_´of
);

1774 ià(
bt1
->
Ën
 !ğ
bt2
->len)

1775  (
çl£
);

1776  (
	`memcmp
(
bt1
->
vec
, 
bt2
->vec, bt1->
Ën
 * (*)) == 0);

1777 
	}
}

1779 
JEMALLOC_INLINE_C
 
ušt64_t


1780 
	$´of_thr_uid_®loc
(
tsdn_t
 *
tsdn
)

1782 
ušt64_t
 
thr_uid
;

1784 
	`m®loc_mu‹x_lock
(
tsdn
, &
Ãxt_thr_uid_mtx
);

1785 
thr_uid
 = 
Ãxt_thr_uid
;

1786 
Ãxt_thr_uid
++;

1787 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
Ãxt_thr_uid_mtx
);

1789  (
thr_uid
);

1790 
	}
}

1792 
´of_td©a_t
 *

1793 
	$´of_td©a_š™_im¶
(
tsd_t
 *
tsd
, 
ušt64_t
 
thr_uid
, ušt64_ˆ
thr_disüim
,

1794 *
th»ad_Çme
, 
boŞ
 
aùive
)

1796 
´of_td©a_t
 *
td©a
;

1798 
	`ÿs£¹
(
cÚfig_´of
);

1801 
td©a
 = (
´of_td©a_t
 *)
	`ŸÎocztm
(
	`tsd_tsdn
(
tsd
), (prof_tdata_t),

1802 
	`size2šdex
((
´of_td©a_t
)), 
çl£
, 
NULL
, 
Œue
,

1803 
	`¬’a_g‘
(
TSDN_NULL
, 0, 
Œue
),rue);

1804 ià(
td©a
 =ğ
NULL
)

1805  (
NULL
);

1807 
td©a
->
lock
 = 
	`´of_td©a_mu‹x_choo£
(
thr_uid
);

1808 
td©a
->
thr_uid
 =hr_uid;

1809 
td©a
->
thr_disüim
 =hr_discrim;

1810 
td©a
->
th»ad_Çme
 =hread_name;

1811 
td©a
->
©ched
 = 
Œue
;

1812 
td©a
->
expœed
 = 
çl£
;

1813 
td©a
->
tùx_uid_Ãxt
 = 0;

1815 ià(
	`ckh_Ãw
(
tsd
, &
td©a
->
bt2tùx
, 
PROF_CKH_MINITEMS
, 
´of_bt_hash
,

1816 
´of_bt_keycomp
)) {

1817 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
td©a
, 
NULL
, 
Œue
,rue);

1818  (
NULL
);

1821 
td©a
->
´ng_¡©e
 = (
ušt64_t
)(
ušŒ_t
)tdata;

1822 
	`´of_§m¶e_th»shŞd_upd©e
(
td©a
);

1824 
td©a
->
’q
 = 
çl£
;

1825 
td©a
->
’q_idump
 = 
çl£
;

1826 
td©a
->
’q_gdump
 = 
çl£
;

1828 
td©a
->
dumpšg
 = 
çl£
;

1829 
td©a
->
aùive
 =‡ctive;

1831 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
td©as_mtx
);

1832 
	`td©a_Œ“_š£¹
(&
td©as
, 
td©a
);

1833 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
td©as_mtx
);

1835  (
td©a
);

1836 
	}
}

1838 
´of_td©a_t
 *

1839 
	$´of_td©a_š™
(
tsd_t
 *
tsd
)

1842  (
	`´of_td©a_š™_im¶
(
tsd
, 
	`´of_thr_uid_®loc
(
	`tsd_tsdn
(tsd)), 0,

1843 
NULL
, 
	`´of_th»ad_aùive_š™_g‘
(
	`tsd_tsdn
(
tsd
))));

1844 
	}
}

1846 
boŞ


1847 
	$´of_td©a_should_de¡roy_uÆocked
(
´of_td©a_t
 *
td©a
, 
boŞ
 
ev’_if_©ched
)

1850 ià(
td©a
->
©ched
 && !
ev’_if_©ched
)

1851  (
çl£
);

1852 ià(
	`ckh_couÁ
(&
td©a
->
bt2tùx
) != 0)

1853  (
çl£
);

1854  (
Œue
);

1855 
	}
}

1857 
boŞ


1858 
	$´of_td©a_should_de¡roy
(
tsdn_t
 *
tsdn
, 
´of_td©a_t
 *
td©a
,

1859 
boŞ
 
ev’_if_©ched
)

1862 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, 
td©a
->
lock
);

1864  (
	`´of_td©a_should_de¡roy_uÆocked
(
td©a
, 
ev’_if_©ched
));

1865 
	}
}

1868 
	$´of_td©a_de¡roy_locked
(
tsd_t
 *
tsd
, 
´of_td©a_t
 *
td©a
,

1869 
boŞ
 
ev’_if_©ched
)

1872 
	`m®loc_mu‹x_as£¹_owÃr
(
	`tsd_tsdn
(
tsd
), &
td©as_mtx
);

1874 
	`td©a_Œ“_»move
(&
td©as
, 
td©a
);

1876 
	`as£¹
(
	`´of_td©a_should_de¡roy_uÆocked
(
td©a
, 
ev’_if_©ched
));

1878 ià(
td©a
->
th»ad_Çme
 !ğ
NULL
)

1879 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
td©a
->
th»ad_Çme
, 
NULL
, 
Œue
,rue);

1880 
	`ckh_d–‘e
(
tsd
, &
td©a
->
bt2tùx
);

1881 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
td©a
, 
NULL
, 
Œue
,rue);

1882 
	}
}

1885 
	$´of_td©a_de¡roy
(
tsd_t
 *
tsd
, 
´of_td©a_t
 *
td©a
, 
boŞ
 
ev’_if_©ched
)

1888 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
td©as_mtx
);

1889 
	`´of_td©a_de¡roy_locked
(
tsd
, 
td©a
, 
ev’_if_©ched
);

1890 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
td©as_mtx
);

1891 
	}
}

1894 
	$´of_td©a_d‘ach
(
tsd_t
 *
tsd
, 
´of_td©a_t
 *
td©a
)

1896 
boŞ
 
de¡roy_td©a
;

1898 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), 
td©a
->
lock
);

1899 ià(
td©a
->
©ched
) {

1900 
de¡roy_td©a
 = 
	`´of_td©a_should_de¡roy
(
	`tsd_tsdn
(
tsd
), 
td©a
,

1901 
Œue
);

1906 ià(!
de¡roy_td©a
)

1907 
td©a
->
©ched
 = 
çl£
;

1908 
	`tsd_´of_td©a_£t
(
tsd
, 
NULL
);

1910 
de¡roy_td©a
 = 
çl£
;

1911 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), 
td©a
->
lock
);

1912 ià(
de¡roy_td©a
)

1913 
	`´of_td©a_de¡roy
(
tsd
, 
td©a
, 
Œue
);

1914 
	}
}

1916 
´of_td©a_t
 *

1917 
	$´of_td©a_»š™
(
tsd_t
 *
tsd
, 
´of_td©a_t
 *
td©a
)

1919 
ušt64_t
 
thr_uid
 = 
td©a
->thr_uid;

1920 
ušt64_t
 
thr_disüim
 = 
td©a
->thr_discrim + 1;

1921 *
th»ad_Çme
 = (
td©a
->th»ad_Çm!ğ
NULL
) ?

1922 
	`´of_th»ad_Çme_®loc
(
	`tsd_tsdn
(
tsd
), 
td©a
->
th»ad_Çme
è: 
NULL
;

1923 
boŞ
 
aùive
 = 
td©a
->active;

1925 
	`´of_td©a_d‘ach
(
tsd
, 
td©a
);

1926  (
	`´of_td©a_š™_im¶
(
tsd
, 
thr_uid
, 
thr_disüim
, 
th»ad_Çme
,

1927 
aùive
));

1928 
	}
}

1930 
boŞ


1931 
	$´of_td©a_expœe
(
tsdn_t
 *
tsdn
, 
´of_td©a_t
 *
td©a
)

1933 
boŞ
 
de¡roy_td©a
;

1935 
	`m®loc_mu‹x_lock
(
tsdn
, 
td©a
->
lock
);

1936 ià(!
td©a
->
expœed
) {

1937 
td©a
->
expœed
 = 
Œue
;

1938 
de¡roy_td©a
 = 
td©a
->
©ched
 ? 
çl£
 :

1939 
	`´of_td©a_should_de¡roy
(
tsdn
, 
td©a
, 
çl£
);

1941 
de¡roy_td©a
 = 
çl£
;

1942 
	`m®loc_mu‹x_uÆock
(
tsdn
, 
td©a
->
lock
);

1944  (
de¡roy_td©a
);

1945 
	}
}

1947 
´of_td©a_t
 *

1948 
	$´of_td©a_»£t_™”
(
´of_td©a_Œ“_t
 *
td©as
, 
´of_td©a_t
 *
td©a
, *
¬g
)

1950 
tsdn_t
 *
tsdn
 = (tsdn_ˆ*)
¬g
;

1952  (
	`´of_td©a_expœe
(
tsdn
, 
td©a
è?d©¨: 
NULL
);

1953 
	}
}

1956 
	$´of_»£t
(
tsd_t
 *
tsd
, 
size_t
 
lg_§m¶e
)

1958 
´of_td©a_t
 *
Ãxt
;

1960 
	`as£¹
(
lg_§m¶e
 < ((
ušt64_t
) << 3));

1962 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_mtx
);

1963 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
td©as_mtx
);

1965 
lg_´of_§m¶e
 = 
lg_§m¶e
;

1967 
Ãxt
 = 
NULL
;

1969 
´of_td©a_t
 *
to_de¡roy
 = 
	`td©a_Œ“_™”
(&
td©as
, 
Ãxt
,

1970 
´of_td©a_»£t_™”
, (*)
tsd
);

1971 ià(
to_de¡roy
 !ğ
NULL
) {

1972 
Ãxt
 = 
	`td©a_Œ“_Ãxt
(&
td©as
, 
to_de¡roy
);

1973 
	`´of_td©a_de¡roy_locked
(
tsd
, 
to_de¡roy
, 
çl£
);

1975 
Ãxt
 = 
NULL
;

1976 } 
Ãxt
 !ğ
NULL
);

1978 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
td©as_mtx
);

1979 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
´of_dump_mtx
);

1980 
	}
}

1983 
	$´of_td©a_ş—nup
(
tsd_t
 *
tsd
)

1985 
´of_td©a_t
 *
td©a
;

1987 ià(!
cÚfig_´of
)

1990 
td©a
 = 
	`tsd_´of_td©a_g‘
(
tsd
);

1991 ià(
td©a
 !ğ
NULL
)

1992 
	`´of_td©a_d‘ach
(
tsd
, 
td©a
);

1993 
	}
}

1995 
boŞ


1996 
	$´of_aùive_g‘
(
tsdn_t
 *
tsdn
)

1998 
boŞ
 
´of_aùive_cu¼’t
;

2000 
	`m®loc_mu‹x_lock
(
tsdn
, &
´of_aùive_mtx
);

2001 
´of_aùive_cu¼’t
 = 
´of_aùive
;

2002 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
´of_aùive_mtx
);

2003  (
´of_aùive_cu¼’t
);

2004 
	}
}

2006 
boŞ


2007 
	$´of_aùive_£t
(
tsdn_t
 *
tsdn
, 
boŞ
 
aùive
)

2009 
boŞ
 
´of_aùive_Şd
;

2011 
	`m®loc_mu‹x_lock
(
tsdn
, &
´of_aùive_mtx
);

2012 
´of_aùive_Şd
 = 
´of_aùive
;

2013 
´of_aùive
 = 
aùive
;

2014 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
´of_aùive_mtx
);

2015  (
´of_aùive_Şd
);

2016 
	}
}

2019 
	$´of_th»ad_Çme_g‘
(
tsd_t
 *
tsd
)

2021 
´of_td©a_t
 *
td©a
;

2023 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
Œue
);

2024 ià(
td©a
 =ğ
NULL
)

2026  (
td©a
->
th»ad_Çme
 !ğ
NULL
 ?data->thread_name : "");

2027 
	}
}

2030 
	$´of_th»ad_Çme_®loc
(
tsdn_t
 *
tsdn
, cÚ¡ *
th»ad_Çme
)

2032 *
»t
;

2033 
size_t
 
size
;

2035 ià(
th»ad_Çme
 =ğ
NULL
)

2036  (
NULL
);

2038 
size
 = 
	`¡¾’
(
th»ad_Çme
) + 1;

2039 ià(
size
 == 1)

2042 
»t
 = 
	`ŸÎocztm
(
tsdn
, 
size
, 
	`size2šdex
(size), 
çl£
, 
NULL
, 
Œue
,

2043 
	`¬’a_g‘
(
TSDN_NULL
, 0, 
Œue
),rue);

2044 ià(
»t
 =ğ
NULL
)

2045  (
NULL
);

2046 
	`memıy
(
»t
, 
th»ad_Çme
, 
size
);

2047  (
»t
);

2048 
	}
}

2051 
	$´of_th»ad_Çme_£t
(
tsd_t
 *
tsd
, cÚ¡ *
th»ad_Çme
)

2053 
´of_td©a_t
 *
td©a
;

2054 
i
;

2055 *
s
;

2057 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
Œue
);

2058 ià(
td©a
 =ğ
NULL
)

2059  (
EAGAIN
);

2062 ià(
th»ad_Çme
 =ğ
NULL
)

2063  (
EFAULT
);

2064 
i
 = 0; 
th»ad_Çme
[i] != '\0'; i++) {

2065 
c
 = 
th»ad_Çme
[
i
];

2066 ià(!
	`isg¿ph
(
c
è&& !
	`isbÏnk
(c))

2067  (
EFAULT
);

2070 
s
 = 
	`´of_th»ad_Çme_®loc
(
	`tsd_tsdn
(
tsd
), 
th»ad_Çme
);

2071 ià(
s
 =ğ
NULL
)

2072  (
EAGAIN
);

2074 ià(
td©a
->
th»ad_Çme
 !ğ
NULL
) {

2075 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
td©a
->
th»ad_Çme
, 
NULL
, 
Œue
,rue);

2076 
td©a
->
th»ad_Çme
 = 
NULL
;

2078 ià(
	`¡¾’
(
s
) > 0)

2079 
td©a
->
th»ad_Çme
 = 
s
;

2081 
	}
}

2083 
boŞ


2084 
	$´of_th»ad_aùive_g‘
(
tsd_t
 *
tsd
)

2086 
´of_td©a_t
 *
td©a
;

2088 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
Œue
);

2089 ià(
td©a
 =ğ
NULL
)

2090  (
çl£
);

2091  (
td©a
->
aùive
);

2092 
	}
}

2094 
boŞ


2095 
	$´of_th»ad_aùive_£t
(
tsd_t
 *
tsd
, 
boŞ
 
aùive
)

2097 
´of_td©a_t
 *
td©a
;

2099 
td©a
 = 
	`´of_td©a_g‘
(
tsd
, 
Œue
);

2100 ià(
td©a
 =ğ
NULL
)

2101  (
Œue
);

2102 
td©a
->
aùive
 =‡ctive;

2103  (
çl£
);

2104 
	}
}

2106 
boŞ


2107 
	$´of_th»ad_aùive_š™_g‘
(
tsdn_t
 *
tsdn
)

2109 
boŞ
 
aùive_š™
;

2111 
	`m®loc_mu‹x_lock
(
tsdn
, &
´of_th»ad_aùive_š™_mtx
);

2112 
aùive_š™
 = 
´of_th»ad_aùive_š™
;

2113 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
´of_th»ad_aùive_š™_mtx
);

2114  (
aùive_š™
);

2115 
	}
}

2117 
boŞ


2118 
	$´of_th»ad_aùive_š™_£t
(
tsdn_t
 *
tsdn
, 
boŞ
 
aùive_š™
)

2120 
boŞ
 
aùive_š™_Şd
;

2122 
	`m®loc_mu‹x_lock
(
tsdn
, &
´of_th»ad_aùive_š™_mtx
);

2123 
aùive_š™_Şd
 = 
´of_th»ad_aùive_š™
;

2124 
´of_th»ad_aùive_š™
 = 
aùive_š™
;

2125 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
´of_th»ad_aùive_š™_mtx
);

2126  (
aùive_š™_Şd
);

2127 
	}
}

2129 
boŞ


2130 
	$´of_gdump_g‘
(
tsdn_t
 *
tsdn
)

2132 
boŞ
 
´of_gdump_cu¼’t
;

2134 
	`m®loc_mu‹x_lock
(
tsdn
, &
´of_gdump_mtx
);

2135 
´of_gdump_cu¼’t
 = 
´of_gdump_v®
;

2136 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
´of_gdump_mtx
);

2137  (
´of_gdump_cu¼’t
);

2138 
	}
}

2140 
boŞ


2141 
	$´of_gdump_£t
(
tsdn_t
 *
tsdn
, 
boŞ
 
gdump
)

2143 
boŞ
 
´of_gdump_Şd
;

2145 
	`m®loc_mu‹x_lock
(
tsdn
, &
´of_gdump_mtx
);

2146 
´of_gdump_Şd
 = 
´of_gdump_v®
;

2147 
´of_gdump_v®
 = 
gdump
;

2148 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
´of_gdump_mtx
);

2149  (
´of_gdump_Şd
);

2150 
	}
}

2153 
	$´of_boÙ0
()

2156 
	`ÿs£¹
(
cÚfig_´of
);

2158 
	`memıy
(
İt_´of_´efix
, 
PROF_PREFIX_DEFAULT
,

2159 (
PROF_PREFIX_DEFAULT
));

2160 
	}
}

2163 
	$´of_boÙ1
()

2166 
	`ÿs£¹
(
cÚfig_´of
);

2173 ià(
İt_´of_Ëak
 && !
İt_´of
) {

2178 
İt_´of
 = 
Œue
;

2179 
İt_´of_gdump
 = 
çl£
;

2180 } ià(
İt_´of
) {

2181 ià(
İt_lg_´of_š‹rv®
 >= 0) {

2182 
´of_š‹rv®
 = (((
ušt64_t
)1U) <<

2183 
İt_lg_´of_š‹rv®
);

2186 
	}
}

2188 
boŞ


2189 
	$´of_boÙ2
(
tsd_t
 *
tsd
)

2192 
	`ÿs£¹
(
cÚfig_´of
);

2194 ià(
İt_´of
) {

2195 
i
;

2197 
lg_´of_§m¶e
 = 
İt_lg_´of_§m¶e
;

2199 
´of_aùive
 = 
İt_´of_aùive
;

2200 ià(
	`m®loc_mu‹x_š™
(&
´of_aùive_mtx
, "prof_active",

2201 
WITNESS_RANK_PROF_ACTIVE
))

2202  (
Œue
);

2204 
´of_gdump_v®
 = 
İt_´of_gdump
;

2205 ià(
	`m®loc_mu‹x_š™
(&
´of_gdump_mtx
, "prof_gdump",

2206 
WITNESS_RANK_PROF_GDUMP
))

2207  (
Œue
);

2209 
´of_th»ad_aùive_š™
 = 
İt_´of_th»ad_aùive_š™
;

2210 ià(
	`m®loc_mu‹x_š™
(&
´of_th»ad_aùive_š™_mtx
,

2212 
WITNESS_RANK_PROF_THREAD_ACTIVE_INIT
))

2213  (
Œue
);

2215 ià(
	`ckh_Ãw
(
tsd
, &
bt2gùx
, 
PROF_CKH_MINITEMS
, 
´of_bt_hash
,

2216 
´of_bt_keycomp
))

2217  (
Œue
);

2218 ià(
	`m®loc_mu‹x_š™
(&
bt2gùx_mtx
, "prof_bt2gctx",

2219 
WITNESS_RANK_PROF_BT2GCTX
))

2220  (
Œue
);

2222 
	`td©a_Œ“_Ãw
(&
td©as
);

2223 ià(
	`m®loc_mu‹x_š™
(&
td©as_mtx
, "prof_tdatas",

2224 
WITNESS_RANK_PROF_TDATAS
))

2225  (
Œue
);

2227 
Ãxt_thr_uid
 = 0;

2228 ià(
	`m®loc_mu‹x_š™
(&
Ãxt_thr_uid_mtx
, "prof_next_thr_uid",

2229 
WITNESS_RANK_PROF_NEXT_THR_UID
))

2230  (
Œue
);

2232 ià(
	`m®loc_mu‹x_š™
(&
´of_dump_£q_mtx
, "prof_dump_seq",

2233 
WITNESS_RANK_PROF_DUMP_SEQ
))

2234  (
Œue
);

2235 ià(
	`m®loc_mu‹x_š™
(&
´of_dump_mtx
, "prof_dump",

2236 
WITNESS_RANK_PROF_DUMP
))

2237  (
Œue
);

2239 ià(
İt_´of_fš®
 && 
İt_´of_´efix
[0] != '\0' &&

2240 
	`©ex™
(
´of_fdump
) != 0) {

2241 
	`m®loc_wr™e
("<jemalloc>: Error in‡texit()\n");

2242 ià(
İt_abÜt
)

2243 
	`abÜt
();

2246 
gùx_locks
 = (
m®loc_mu‹x_t
 *)
	`ba£_®loc
(
	`tsd_tsdn
(
tsd
),

2247 
PROF_NCTX_LOCKS
 * (
m®loc_mu‹x_t
));

2248 ià(
gùx_locks
 =ğ
NULL
)

2249  (
Œue
);

2250 
i
 = 0; i < 
PROF_NCTX_LOCKS
; i++) {

2251 ià(
	`m®loc_mu‹x_š™
(&
gùx_locks
[
i
], "prof_gctx",

2252 
WITNESS_RANK_PROF_GCTX
))

2253  (
Œue
);

2256 
td©a_locks
 = (
m®loc_mu‹x_t
 *)
	`ba£_®loc
(
	`tsd_tsdn
(
tsd
),

2257 
PROF_NTDATA_LOCKS
 * (
m®loc_mu‹x_t
));

2258 ià(
td©a_locks
 =ğ
NULL
)

2259  (
Œue
);

2260 
i
 = 0; i < 
PROF_NTDATA_LOCKS
; i++) {

2261 ià(
	`m®loc_mu‹x_š™
(&
td©a_locks
[
i
], "prof_tdata",

2262 
WITNESS_RANK_PROF_TDATA
))

2263  (
Œue
);

2267 #ifdeà
JEMALLOC_PROF_LIBGCC


2272 
	`_Unwšd_BackŒaû
(
´of_unwšd_š™_ÿÎback
, 
NULL
);

2275 
´of_boÙed
 = 
Œue
;

2277  (
çl£
);

2278 
	}
}

2281 
	$´of_´efÜk0
(
tsdn_t
 *
tsdn
)

2284 ià(
İt_´of
) {

2285 
i
;

2287 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
´of_dump_mtx
);

2288 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
bt2gùx_mtx
);

2289 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
td©as_mtx
);

2290 
i
 = 0; i < 
PROF_NTDATA_LOCKS
; i++)

2291 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
td©a_locks
[
i
]);

2292 
i
 = 0; i < 
PROF_NCTX_LOCKS
; i++)

2293 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
gùx_locks
[
i
]);

2295 
	}
}

2298 
	$´of_´efÜk1
(
tsdn_t
 *
tsdn
)

2301 ià(
İt_´of
) {

2302 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
´of_aùive_mtx
);

2303 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
´of_dump_£q_mtx
);

2304 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
´of_gdump_mtx
);

2305 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
Ãxt_thr_uid_mtx
);

2306 
	`m®loc_mu‹x_´efÜk
(
tsdn
, &
´of_th»ad_aùive_š™_mtx
);

2308 
	}
}

2311 
	$´of_po¡fÜk_·»Á
(
tsdn_t
 *
tsdn
)

2314 ià(
İt_´of
) {

2315 
i
;

2317 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
,

2318 &
´of_th»ad_aùive_š™_mtx
);

2319 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
Ãxt_thr_uid_mtx
);

2320 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
´of_gdump_mtx
);

2321 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
´of_dump_£q_mtx
);

2322 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
´of_aùive_mtx
);

2323 
i
 = 0; i < 
PROF_NCTX_LOCKS
; i++)

2324 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
gùx_locks
[
i
]);

2325 
i
 = 0; i < 
PROF_NTDATA_LOCKS
; i++)

2326 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
td©a_locks
[
i
]);

2327 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
td©as_mtx
);

2328 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
bt2gùx_mtx
);

2329 
	`m®loc_mu‹x_po¡fÜk_·»Á
(
tsdn
, &
´of_dump_mtx
);

2331 
	}
}

2334 
	$´of_po¡fÜk_chd
(
tsdn_t
 *
tsdn
)

2337 ià(
İt_´of
) {

2338 
i
;

2340 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
´of_th»ad_aùive_š™_mtx
);

2341 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
Ãxt_thr_uid_mtx
);

2342 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
´of_gdump_mtx
);

2343 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
´of_dump_£q_mtx
);

2344 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
´of_aùive_mtx
);

2345 
i
 = 0; i < 
PROF_NCTX_LOCKS
; i++)

2346 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
gùx_locks
[
i
]);

2347 
i
 = 0; i < 
PROF_NTDATA_LOCKS
; i++)

2348 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
td©a_locks
[
i
]);

2349 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
td©as_mtx
);

2350 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
bt2gùx_mtx
);

2351 
	`m®loc_mu‹x_po¡fÜk_chd
(
tsdn
, &
´of_dump_mtx
);

2353 
	}
}

	@deps/jemalloc/src/quarantine.c

1 
	#JEMALLOC_QUARANTINE_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

8 
	#QUARANTINE_STATE_REINCARNATED
 ((
qu¬ªtše_t
 *)(
ušŒ_t
)1)

	)

9 
	#QUARANTINE_STATE_PURGATORY
 ((
qu¬ªtše_t
 *)(
ušŒ_t
)2)

	)

10 
	#QUARANTINE_STATE_MAX
 
QUARANTINE_STATE_PURGATORY


	)

15 
qu¬ªtše_t
 *
qu¬ªtše_grow
(
tsd_t
 *
tsd
, qu¬ªtše_ˆ*
qu¬ªtše
);

16 
qu¬ªtše_d¿š_Úe
(
tsdn_t
 *
tsdn
, 
qu¬ªtše_t
 *
qu¬ªtše
);

17 
qu¬ªtše_d¿š
(
tsdn_t
 *
tsdn
, 
qu¬ªtše_t
 *
qu¬ªtše
,

18 
size_t
 
uµ”_bound
);

22 
qu¬ªtše_t
 *

23 
	$qu¬ªtše_š™
(
tsdn_t
 *
tsdn
, 
size_t
 
lg_maxobjs
)

25 
qu¬ªtše_t
 *
qu¬ªtše
;

26 
size_t
 
size
;

28 
size
 = 
	`off£tof
(
qu¬ªtše_t
, 
objs
è+ ((
	`ZU
(1è<< 
lg_maxobjs
) *

29 (
qu¬ªtše_obj_t
));

30 
qu¬ªtše
 = (
qu¬ªtše_t
 *)
	`ŸÎocztm
(
tsdn
, 
size
, 
	`size2šdex
(size),

31 
çl£
, 
NULL
, 
Œue
, 
	`¬’a_g‘
(
TSDN_NULL
, 0,rue),rue);

32 ià(
qu¬ªtše
 =ğ
NULL
)

33  (
NULL
);

34 
qu¬ªtše
->
curby‹s
 = 0;

35 
qu¬ªtše
->
curobjs
 = 0;

36 
qu¬ªtše
->
fœ¡
 = 0;

37 
qu¬ªtše
->
lg_maxobjs
 =†g_maxobjs;

39  (
qu¬ªtše
);

40 
	}
}

43 
	$qu¬ªtše_®loc_hook_wÜk
(
tsd_t
 *
tsd
)

45 
qu¬ªtše_t
 *
qu¬ªtše
;

47 ià(!
	`tsd_nomš®
(
tsd
))

50 
qu¬ªtše
 = 
	`qu¬ªtše_š™
(
	`tsd_tsdn
(
tsd
), 
LG_MAXOBJS_INIT
);

55 ià(
	`tsd_qu¬ªtše_g‘
(
tsd
è=ğ
NULL
)

56 
	`tsd_qu¬ªtše_£t
(
tsd
, 
qu¬ªtše
);

58 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
qu¬ªtše
, 
NULL
, 
Œue
,rue);

59 
	}
}

61 
qu¬ªtše_t
 *

62 
	$qu¬ªtše_grow
(
tsd_t
 *
tsd
, 
qu¬ªtše_t
 *
qu¬ªtše
)

64 
qu¬ªtše_t
 *
»t
;

66 
»t
 = 
	`qu¬ªtše_š™
(
	`tsd_tsdn
(
tsd
), 
qu¬ªtše
->
lg_maxobjs
 + 1);

67 ià(
»t
 =ğ
NULL
) {

68 
	`qu¬ªtše_d¿š_Úe
(
	`tsd_tsdn
(
tsd
), 
qu¬ªtše
);

69  (
qu¬ªtše
);

72 
»t
->
curby‹s
 = 
qu¬ªtše
->curbytes;

73 
»t
->
curobjs
 = 
qu¬ªtše
->curobjs;

74 ià(
qu¬ªtše
->
fœ¡
 + qu¬ªtše->
curobjs
 <ğ(
	`ZU
(1) <<

75 
qu¬ªtše
->
lg_maxobjs
)) {

77 
	`memıy
(
»t
->
objs
, &
qu¬ªtše
->objs[qu¬ªtše->
fœ¡
],

78 
qu¬ªtše
->
curobjs
 * (
qu¬ªtše_obj_t
));

81 
size_t
 
ncİy_a
 = (
	`ZU
(1è<< 
qu¬ªtše
->
lg_maxobjs
) -

82 
qu¬ªtše
->
fœ¡
;

83 
size_t
 
ncİy_b
 = 
qu¬ªtše
->
curobjs
 - 
ncİy_a
;

85 
	`memıy
(
»t
->
objs
, &
qu¬ªtše
->objs[qu¬ªtše->
fœ¡
], 
ncİy_a


86 * (
qu¬ªtše_obj_t
));

87 
	`memıy
(&
»t
->
objs
[
ncİy_a
], 
qu¬ªtše
->objs, 
ncİy_b
 *

88 (
qu¬ªtše_obj_t
));

90 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
qu¬ªtše
, 
NULL
, 
Œue
,rue);

92 
	`tsd_qu¬ªtše_£t
(
tsd
, 
»t
);

93  (
»t
);

94 
	}
}

97 
	$qu¬ªtše_d¿š_Úe
(
tsdn_t
 *
tsdn
, 
qu¬ªtše_t
 *
qu¬ªtše
)

99 
qu¬ªtše_obj_t
 *
obj
 = &
qu¬ªtše
->
objs
[qu¬ªtše->
fœ¡
];

100 
	`as£¹
(
obj
->
usize
 =ğ
	`i§Îoc
(
tsdn
, obj->
±r
, 
cÚfig_´of
));

101 
	`id®loùm
(
tsdn
, 
obj
->
±r
, 
NULL
, 
çl£
, 
Œue
);

102 
qu¬ªtše
->
curby‹s
 -ğ
obj
->
usize
;

103 
qu¬ªtše
->
curobjs
--;

104 
qu¬ªtše
->
fœ¡
 = (qu¬ªtše->fœ¡ + 1è& ((
	`ZU
(1) <<

105 
qu¬ªtše
->
lg_maxobjs
) - 1);

106 
	}
}

109 
	$qu¬ªtše_d¿š
(
tsdn_t
 *
tsdn
, 
qu¬ªtše_t
 *
qu¬ªtše
, 
size_t
 
uµ”_bound
)

112 
qu¬ªtše
->
curby‹s
 > 
uµ”_bound
 && qu¬ªtše->
curobjs
 > 0)

113 
	`qu¬ªtše_d¿š_Úe
(
tsdn
, 
qu¬ªtše
);

114 
	}
}

117 
	$qu¬ªtše
(
tsd_t
 *
tsd
, *
±r
)

119 
qu¬ªtše_t
 *
qu¬ªtše
;

120 
size_t
 
usize
 = 
	`i§Îoc
(
	`tsd_tsdn
(
tsd
), 
±r
, 
cÚfig_´of
);

122 
	`ÿs£¹
(
cÚfig_fl
);

123 
	`as£¹
(
İt_qu¬ªtše
);

125 ià((
qu¬ªtše
 = 
	`tsd_qu¬ªtše_g‘
(
tsd
)è=ğ
NULL
) {

126 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
±r
, 
NULL
, 
çl£
, 
Œue
);

133 ià(
qu¬ªtše
->
curby‹s
 + 
usize
 > 
İt_qu¬ªtše
) {

134 
size_t
 
uµ”_bound
 = (
İt_qu¬ªtše
 >ğ
usize
) ? opt_quarantine

135 - 
usize
 : 0;

136 
	`qu¬ªtše_d¿š
(
	`tsd_tsdn
(
tsd
), 
qu¬ªtše
, 
uµ”_bound
);

139 ià(
qu¬ªtše
->
curobjs
 =ğ(
	`ZU
(1è<< qu¬ªtše->
lg_maxobjs
))

140 
qu¬ªtše
 = 
	`qu¬ªtše_grow
(
tsd
, quarantine);

142 
	`as£¹
(
qu¬ªtše
->
curobjs
 < (
	`ZU
(1è<< qu¬ªtše->
lg_maxobjs
));

144 ià(
qu¬ªtše
->
curby‹s
 + 
usize
 <ğ
İt_qu¬ªtše
) {

145 
size_t
 
off£t
 = (
qu¬ªtše
->
fœ¡
 + qu¬ªtše->
curobjs
) &

146 ((
	`ZU
(1è<< 
qu¬ªtše
->
lg_maxobjs
) - 1);

147 
qu¬ªtše_obj_t
 *
obj
 = &
qu¬ªtše
->
objs
[
off£t
];

148 
obj
->
±r
 =…tr;

149 
obj
->
usize
 = usize;

150 
qu¬ªtše
->
curby‹s
 +ğ
usize
;

151 
qu¬ªtše
->
curobjs
++;

152 ià(
cÚfig_fl
 && 
	`uÆik–y
(
İt_junk_ä“
)) {

157 ià((!
cÚfig_v®gršd
 || 
	`lik–y
(!
š_v®gršd
))

158 && 
usize
 <ğ
SMALL_MAXCLASS
)

159 
	`¬’a_qu¬ªtše_junk_sm®l
(
±r
, 
usize
);

161 
	`mem£t
(
±r
, 
JEMALLOC_FREE_JUNK
, 
usize
);

164 
	`as£¹
(
qu¬ªtše
->
curby‹s
 == 0);

165 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
±r
, 
NULL
, 
çl£
, 
Œue
);

167 
	}
}

170 
	$qu¬ªtše_ş—nup
(
tsd_t
 *
tsd
)

172 
qu¬ªtše_t
 *
qu¬ªtše
;

174 ià(!
cÚfig_fl
)

177 
qu¬ªtše
 = 
	`tsd_qu¬ªtše_g‘
(
tsd
);

178 ià(
qu¬ªtše
 !ğ
NULL
) {

179 
	`qu¬ªtše_d¿š
(
	`tsd_tsdn
(
tsd
), 
qu¬ªtše
, 0);

180 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
qu¬ªtše
, 
NULL
, 
Œue
,rue);

181 
	`tsd_qu¬ªtše_£t
(
tsd
, 
NULL
);

183 
	}
}

	@deps/jemalloc/src/rtree.c

1 
	#JEMALLOC_RTREE_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

5 
	$hmš
(
ha
, 
hb
)

8  (
ha
 < 
hb
 ? ha : hb);

9 
	}
}

12 
boŞ


13 
	$¹»e_Ãw
(
¹»e_t
 *
¹»e
, 
b™s
, 
¹»e_node_®loc_t
 *
®loc
,

14 
¹»e_node_d®loc_t
 *
d®loc
)

16 
b™s_š_Ëaf
, 
height
, 
i
;

18 
	`as£¹
(
RTREE_HEIGHT_MAX
 =ğ((
	`ZU
(1è<< (
LG_SIZEOF_PTR
+3)) /

19 
RTREE_BITS_PER_LEVEL
));

20 
	`as£¹
(
b™s
 > 0 && b™ <ğ((
ušŒ_t
) << 3));

22 
b™s_š_Ëaf
 = (
b™s
 % 
RTREE_BITS_PER_LEVEL
) == 0 ? RTREE_BITS_PER_LEVEL

23 : (
b™s
 % 
RTREE_BITS_PER_LEVEL
);

24 ià(
b™s
 > 
b™s_š_Ëaf
) {

25 
height
 = 1 + (
b™s
 - 
b™s_š_Ëaf
è/ 
RTREE_BITS_PER_LEVEL
;

26 ià((
height
-1è* 
RTREE_BITS_PER_LEVEL
 + 
b™s_š_Ëaf
 !ğ
b™s
)

27 
height
++;

29 
height
 = 1;

30 
	`as£¹
((
height
-1è* 
RTREE_BITS_PER_LEVEL
 + 
b™s_š_Ëaf
 =ğ
b™s
);

32 
¹»e
->
®loc
 =‡lloc;

33 
¹»e
->
d®loc
 = dalloc;

34 
¹»e
->
height
 = height;

37 
¹»e
->
Ëv–s
[0].
subŒ“
 = 
NULL
;

38 
¹»e
->
Ëv–s
[0].
b™s
 = (
height
 > 1è? 
RTREE_BITS_PER_LEVEL
 :

39 
b™s_š_Ëaf
;

40 
¹»e
->
Ëv–s
[0].
cumb™s
 =„Œ“->Ëv–s[0].
b™s
;

42 
i
 = 1; i < 
height
-1; i++) {

43 
¹»e
->
Ëv–s
[
i
].
subŒ“
 = 
NULL
;

44 
¹»e
->
Ëv–s
[
i
].
b™s
 = 
RTREE_BITS_PER_LEVEL
;

45 
¹»e
->
Ëv–s
[
i
].
cumb™s
 =„tree->levels[i-1].cumbits +

46 
RTREE_BITS_PER_LEVEL
;

49 ià(
height
 > 1) {

50 
¹»e
->
Ëv–s
[
height
-1].
subŒ“
 = 
NULL
;

51 
¹»e
->
Ëv–s
[
height
-1].
b™s
 = 
b™s_š_Ëaf
;

52 
¹»e
->
Ëv–s
[
height
-1].
cumb™s
 = 
b™s
;

56 
i
 = 0; i < 
RTREE_HEIGHT_MAX
; i++) {

57 
¹»e
->
¡¬t_Ëv–
[
i
] = 
	`hmš
(
RTREE_HEIGHT_MAX
 - 1 - i, 
height
 -

61  (
çl£
);

62 
	}
}

65 
	$¹»e_d–‘e_subŒ“
(
¹»e_t
 *
¹»e
, 
¹»e_node_–m_t
 *
node
, 
Ëv–
)

68 ià(
Ëv–
 + 1 < 
¹»e
->
height
) {

69 
size_t
 
nchd»n
, 
i
;

71 
nchd»n
 = 
	`ZU
(1è<< 
¹»e
->
Ëv–s
[
Ëv–
].
b™s
;

72 
i
 = 0; i < 
nchd»n
; i++) {

73 
¹»e_node_–m_t
 *
chd
 = 
node
[
i
].child;

74 ià(
chd
 !ğ
NULL
)

75 
	`¹»e_d–‘e_subŒ“
(
¹»e
, 
chd
, 
Ëv–
 + 1);

78 
¹»e
->
	`d®loc
(
node
);

79 
	}
}

82 
	$¹»e_d–‘e
(
¹»e_t
 *
¹»e
)

84 
i
;

86 
i
 = 0; i < 
¹»e
->
height
; i++) {

87 
¹»e_node_–m_t
 *
subŒ“
 = 
¹»e
->
Ëv–s
[
i
].subtree;

88 ià(
subŒ“
 !ğ
NULL
)

89 
	`¹»e_d–‘e_subŒ“
(
¹»e
, 
subŒ“
, 
i
);

91 
	}
}

93 
¹»e_node_–m_t
 *

94 
	$¹»e_node_š™
(
¹»e_t
 *
¹»e
, 
Ëv–
, 
¹»e_node_–m_t
 **
–mp
)

96 
¹»e_node_–m_t
 *
node
;

98 ià(
	`©omic_ÿs_p
((**)
–mp
, 
NULL
, 
RTREE_NODE_INITIALIZING
)) {

99 
¥š_t
 
¥šÃr
;

105 
	`¥š_š™
(&
¥šÃr
);

107 
	`¥š_ad­tive
(&
¥šÃr
);

108 
node
 = 
	`©omic_»ad_p
((**)
–mp
);

109 } 
node
 =ğ
RTREE_NODE_INITIALIZING
);

111 
node
 = 
¹»e
->
	`®loc
(
	`ZU
(1è<<„Œ“->
Ëv–s
[
Ëv–
].
b™s
);

112 ià(
node
 =ğ
NULL
)

113  (
NULL
);

114 
	`©omic_wr™e_p
((**)
–mp
, 
node
);

117  (
node
);

118 
	}
}

120 
¹»e_node_–m_t
 *

121 
	$¹»e_subŒ“_»ad_h¬d
(
¹»e_t
 *
¹»e
, 
Ëv–
)

124  (
	`¹»e_node_š™
(
¹»e
, 
Ëv–
, &¹»e->
Ëv–s
[Ëv–].
subŒ“
));

125 
	}
}

127 
¹»e_node_–m_t
 *

128 
	$¹»e_chd_»ad_h¬d
(
¹»e_t
 *
¹»e
, 
¹»e_node_–m_t
 *
–m
, 
Ëv–
)

131  (
	`¹»e_node_š™
(
¹»e
, 
Ëv–
+1, &
–m
->
chd
));

132 
	}
}

	@deps/jemalloc/src/spin.c

1 
	#JEMALLOC_SPIN_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

	@deps/jemalloc/src/stats.c

1 
	#JEMALLOC_STATS_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

4 
	#CTL_GET
(
n
, 
v
, 
t
) do { \

5 
size_t
 
sz
 = (
t
); \

6 
	`xm®lùl
(
n
, (*)
v
, &
sz
, 
NULL
, 0); \

7 } 0)

	)

9 
	#CTL_M2_GET
(
n
, 
i
, 
v
, 
t
) do { \

10 
size_t
 
mib
[6]; \

11 
size_t
 
mibËn
 = (
mib
) / (size_t); \

12 
size_t
 
sz
 = (
t
); \

13 
	`xm®lùÊam‘omib
(
n
, 
mib
, &
mibËn
); \

14 
mib
[2] = (
i
); \

15 
	`xm®lùlbymib
(
mib
, 
mibËn
, (*)
v
, &
sz
, 
NULL
, 0); \

16 } 0)

	)

18 
	#CTL_M2_M4_GET
(
n
, 
i
, 
j
, 
v
, 
t
) do { \

19 
size_t
 
mib
[6]; \

20 
size_t
 
mibËn
 = (
mib
) / (size_t); \

21 
size_t
 
sz
 = (
t
); \

22 
	`xm®lùÊam‘omib
(
n
, 
mib
, &
mibËn
); \

23 
mib
[2] = (
i
); \

24 
mib
[4] = (
j
); \

25 
	`xm®lùlbymib
(
mib
, 
mibËn
, (*)
v
, &
sz
, 
NULL
, 0); \

26 } 0)

	)

31 
boŞ
 
	gİt_¡©s_´št
 = 
çl£
;

33 
size_t
 
	g¡©s_ÿùive
 = 0;

38 
	$¡©s_¬’a_bšs_´št
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

39 
boŞ
 
jsÚ
, boŞ 
Ïrge
, boŞ 
huge
, 
i
)

41 
size_t
 
·ge
;

42 
boŞ
 
cÚfig_tÿche
, 
š_g­
, 
š_g­_´ev
;

43 
nbšs
, 
j
;

45 
	`CTL_GET
("¬’as.·ge", &
·ge
, 
size_t
);

47 
	`CTL_GET
("¬’as.nbšs", &
nbšs
, );

48 ià(
jsÚ
) {

49 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

52 
	`CTL_GET
("cÚfig.tÿche", &
cÚfig_tÿche
, 
boŞ
);

53 ià(
cÚfig_tÿche
) {

54 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

60 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

67 
j
 = 0, 
š_g­
 = 
çl£
; j < 
nbšs
; j++) {

68 
ušt64_t
 
Äuns
;

69 
size_t
 
»g_size
, 
run_size
, 
cu¼egs
;

70 
size_t
 
cu¼uns
;

71 
ušt32_t
 
Äegs
;

72 
ušt64_t
 
nm®loc
, 
nd®loc
, 
Äeque¡s
, 
nfls
, 
næushes
;

73 
ušt64_t
 
Ä”uns
;

75 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.bšs.0.Äuns", 
i
, 
j
, &
Äuns
,

76 
ušt64_t
);

77 
š_g­_´ev
 = 
š_g­
;

78 
š_g­
 = (
Äuns
 == 0);

80 ià(!
jsÚ
 && 
š_g­_´ev
 && !
š_g­
) {

81 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

85 
	`CTL_M2_GET
("¬’as.bš.0.size", 
j
, &
»g_size
, 
size_t
);

86 
	`CTL_M2_GET
("¬’as.bš.0.Äegs", 
j
, &
Äegs
, 
ušt32_t
);

87 
	`CTL_M2_GET
("¬’as.bš.0.run_size", 
j
, &
run_size
, 
size_t
);

89 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.bšs.0.nm®loc", 
i
, 
j
, &
nm®loc
,

90 
ušt64_t
);

91 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.bšs.0.nd®loc", 
i
, 
j
, &
nd®loc
,

92 
ušt64_t
);

93 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.bšs.0.cu¼egs", 
i
, 
j
, &
cu¼egs
,

94 
size_t
);

95 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.bšs.0.Äeque¡s", 
i
, 
j
,

96 &
Äeque¡s
, 
ušt64_t
);

97 ià(
cÚfig_tÿche
) {

98 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.bšs.0.nfls", 
i
, 
j
,

99 &
nfls
, 
ušt64_t
);

100 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.bšs.0.næushes", 
i
, 
j
,

101 &
næushes
, 
ušt64_t
);

103 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.bšs.0.Ä”uns", 
i
, 
j
, &
Ä”uns
,

104 
ušt64_t
);

105 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.bšs.0.cu¼uns", 
i
, 
j
, &
cu¼uns
,

106 
size_t
);

108 ià(
jsÚ
) {

109 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

111 "\t\t\t\t\t\t\"nm®loc\": %"
FMTu64
",\n"

112 "\t\t\t\t\t\t\"nd®loc\": %"
FMTu64
",\n"

114 "\t\t\t\t\t\t\"Äeque¡s\": %"
FMTu64
",\n",

115 
nm®loc
,

116 
nd®loc
,

117 
cu¼egs
,

118 
Äeque¡s
);

119 ià(
cÚfig_tÿche
) {

120 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

121 "\t\t\t\t\t\t\"nfls\": %"
FMTu64
",\n"

122 "\t\t\t\t\t\t\"næushes\": %"
FMTu64
",\n",

123 
nfls
,

124 
næushes
);

126 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

127 "\t\t\t\t\t\t\"Ä”uns\": %"
FMTu64
",\n"

130 
Ä”uns
,

131 
cu¼uns
,

132 (
j
 + 1 < 
nbšs
) ? "," : "");

133 } ià(!
š_g­
) {

134 
size_t
 
ava»gs
, 
mli
;

135 
ut
[6];

137 
ava»gs
 = 
Äegs
 * 
cu¼uns
;

138 
mli
 = (
ava»gs
 !ğ0è? (1000 * 
cu¼egs
) /‡vailregs

140 
	`as£¹
(
mli
 <= 1000);

141 ià(
mli
 < 10) {

142 
	`m®loc_¢´štf
(
ut
, (util),

143 "0.00%zu", 
mli
);

144 } ià(
mli
 < 100) {

145 
	`m®loc_¢´štf
(
ut
, (util), "0.0%zu",

146 
mli
);

147 } ià(
mli
 < 1000) {

148 
	`m®loc_¢´štf
(
ut
, (util), "0.%zu",

149 
mli
);

151 
	`m®loc_¢´štf
(
ut
, (util), "1");

153 ià(
cÚfig_tÿche
) {

154 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

155 "%20zu %3u %12zu %12"
FMTu64


156 " %12"
FMTu64
" %12"FMTu64" %12zu"

157 " %12zu %4u %3zu %-5 %12"
FMTu64


158 " %12"
FMTu64
" %12"FMTu64" %12"FMTu64"\n",

159 
»g_size
, 
j
, 
cu¼egs
 *„eg_size, 
nm®loc
,

160 
nd®loc
, 
Äeque¡s
, 
cu¼egs
, 
cu¼uns
, 
Äegs
,

161 
run_size
 / 
·ge
, 
ut
, 
nfls
, 
næushes
,

162 
Äuns
, 
Ä”uns
);

164 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

165 "%20zu %3u %12zu %12"
FMTu64


166 " %12"
FMTu64
" %12"FMTu64" %12zu"

167 " %12zu %4u %3zu %-5 %12"
FMTu64


168 " %12"
FMTu64
"\n",

169 
»g_size
, 
j
, 
cu¼egs
 *„eg_size, 
nm®loc
,

170 
nd®loc
, 
Äeque¡s
, 
cu¼egs
, 
cu¼uns
, 
Äegs
,

171 
run_size
 / 
·ge
, 
ut
, 
Äuns
, 
Ä”uns
);

175 ià(
jsÚ
) {

176 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

177 "\t\t\t\t]%s\n", (
Ïrge
 || 
huge
) ? "," : "");

179 ià(
š_g­
) {

180 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

184 
	}
}

187 
	$¡©s_¬’a_Ìuns_´št
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

188 
boŞ
 
jsÚ
, boŞ 
huge
, 
i
)

190 
nbšs
, 
Æruns
, 
j
;

191 
boŞ
 
š_g­
, 
š_g­_´ev
;

193 
	`CTL_GET
("¬’as.nbšs", &
nbšs
, );

194 
	`CTL_GET
("¬’as.Æruns", &
Æruns
, );

195 ià(
jsÚ
) {

196 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

199 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

203 
j
 = 0, 
š_g­
 = 
çl£
; j < 
Æruns
; j++) {

204 
ušt64_t
 
nm®loc
, 
nd®loc
, 
Äeque¡s
;

205 
size_t
 
run_size
, 
cu¼uns
;

207 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.Ìuns.0.nm®loc", 
i
, 
j
, &
nm®loc
,

208 
ušt64_t
);

209 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.Ìuns.0.nd®loc", 
i
, 
j
, &
nd®loc
,

210 
ušt64_t
);

211 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.Ìuns.0.Äeque¡s", 
i
, 
j
,

212 &
Äeque¡s
, 
ušt64_t
);

213 
š_g­_´ev
 = 
š_g­
;

214 
š_g­
 = (
Äeque¡s
 == 0);

216 ià(!
jsÚ
 && 
š_g­_´ev
 && !
š_g­
) {

217 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

221 
	`CTL_M2_GET
("¬’as.Ìun.0.size", 
j
, &
run_size
, 
size_t
);

222 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.Ìuns.0.cu¼uns", 
i
, 
j
, &
cu¼uns
,

223 
size_t
);

224 ià(
jsÚ
) {

225 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

229 
cu¼uns
,

230 (
j
 + 1 < 
Æruns
) ? "," : "");

231 } ià(!
š_g­
) {

232 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

233 "%20zu %3u %12zu %12"
FMTu64
" %12"FMTu64

234 " %12"
FMTu64
" %12zu\n",

235 
run_size
, 
nbšs
 + 
j
, 
cu¼uns
 *„un_size, 
nm®loc
,

236 
nd®loc
, 
Äeque¡s
, 
cu¼uns
);

239 ià(
jsÚ
) {

240 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

241 "\t\t\t\t]%s\n", 
huge
 ? "," : "");

243 ià(
š_g­
) {

244 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

248 
	}
}

251 
	$¡©s_¬’a_hchunks_´št
((*
wr™e_cb
)(*, const *),

252 *
cbİaque
, 
boŞ
 
jsÚ
, 
i
)

254 
nbšs
, 
Æruns
, 
nhchunks
, 
j
;

255 
boŞ
 
š_g­
, 
š_g­_´ev
;

257 
	`CTL_GET
("¬’as.nbšs", &
nbšs
, );

258 
	`CTL_GET
("¬’as.Æruns", &
Æruns
, );

259 
	`CTL_GET
("¬’as.nhchunks", &
nhchunks
, );

260 ià(
jsÚ
) {

261 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

264 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

268 
j
 = 0, 
š_g­
 = 
çl£
; j < 
nhchunks
; j++) {

269 
ušt64_t
 
nm®loc
, 
nd®loc
, 
Äeque¡s
;

270 
size_t
 
hchunk_size
, 
curhchunks
;

272 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.hchunks.0.nm®loc", 
i
, 
j
,

273 &
nm®loc
, 
ušt64_t
);

274 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.hchunks.0.nd®loc", 
i
, 
j
,

275 &
nd®loc
, 
ušt64_t
);

276 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.hchunks.0.Äeque¡s", 
i
, 
j
,

277 &
Äeque¡s
, 
ušt64_t
);

278 
š_g­_´ev
 = 
š_g­
;

279 
š_g­
 = (
Äeque¡s
 == 0);

281 ià(!
jsÚ
 && 
š_g­_´ev
 && !
š_g­
) {

282 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

286 
	`CTL_M2_GET
("¬’as.hchunk.0.size", 
j
, &
hchunk_size
, 
size_t
);

287 
	`CTL_M2_M4_GET
("¡©s.¬’as.0.hchunks.0.curhchunks", 
i
, 
j
,

288 &
curhchunks
, 
size_t
);

289 ià(
jsÚ
) {

290 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

294 
curhchunks
,

295 (
j
 + 1 < 
nhchunks
) ? "," : "");

296 } ià(!
š_g­
) {

297 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

298 "%20zu %3u %12zu %12"
FMTu64
" %12"FMTu64

299 " %12"
FMTu64
" %12zu\n",

300 
hchunk_size
, 
nbšs
 + 
Æruns
 + 
j
,

301 
curhchunks
 * 
hchunk_size
, 
nm®loc
, 
nd®loc
,

302 
Äeque¡s
, 
curhchunks
);

305 ià(
jsÚ
) {

306 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

309 ià(
š_g­
) {

310 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

314 
	}
}

317 
	$¡©s_¬’a_´št
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

318 
boŞ
 
jsÚ
, 
i
, boŞ 
bšs
, boŞ 
Ïrge
, boŞ 
huge
)

320 
Áh»ads
;

321 cÚ¡ *
dss
;

322 
ssize_t
 
lg_dœty_muÉ
, 
deÿy_time
;

323 
size_t
 
·ge
, 
·ùive
, 
pdœty
, 
m­³d
, 
»šed
;

324 
size_t
 
m‘ad©a_m­³d
, 
m‘ad©a_®loÿ‹d
;

325 
ušt64_t
 
Åurge
, 
nmadvi£
, 
purged
;

326 
size_t
 
sm®l_®loÿ‹d
;

327 
ušt64_t
 
sm®l_nm®loc
, 
sm®l_nd®loc
, 
sm®l_Äeque¡s
;

328 
size_t
 
Ïrge_®loÿ‹d
;

329 
ušt64_t
 
Ïrge_nm®loc
, 
Ïrge_nd®loc
, 
Ïrge_Äeque¡s
;

330 
size_t
 
huge_®loÿ‹d
;

331 
ušt64_t
 
huge_nm®loc
, 
huge_nd®loc
, 
huge_Äeque¡s
;

333 
	`CTL_GET
("¬’as.·ge", &
·ge
, 
size_t
);

335 
	`CTL_M2_GET
("¡©s.¬’as.0.Áh»ads", 
i
, &
Áh»ads
, );

336 ià(
jsÚ
) {

337 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

338 "\t\t\t\t\"Áh»ads\": %u,\n", 
Áh»ads
);

340 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

341 "assigÃdh»ads: %u\n", 
Áh»ads
);

344 
	`CTL_M2_GET
("¡©s.¬’as.0.dss", 
i
, &
dss
, const *);

345 ià(
jsÚ
) {

346 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

347 "\t\t\t\t\"dss\": \"%s\",\n", 
dss
);

349 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

350 "ds ®loÿtiÚ…»ûd’û: %s\n", 
dss
);

353 
	`CTL_M2_GET
("¡©s.¬’as.0.lg_dœty_muÉ", 
i
, &
lg_dœty_muÉ
, 
ssize_t
);

354 ià(
jsÚ
) {

355 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

356 "\t\t\t\t\"lg_dœty_muÉ\": %zd,\n", 
lg_dœty_muÉ
);

358 ià(
İt_purge
 =ğ
purge_mode_¿tio
) {

359 ià(
lg_dœty_muÉ
 >= 0) {

360 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

362 (1U << 
lg_dœty_muÉ
));

364 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

370 
	`CTL_M2_GET
("¡©s.¬’as.0.deÿy_time", 
i
, &
deÿy_time
, 
ssize_t
);

371 ià(
jsÚ
) {

372 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

373 "\t\t\t\t\"deÿy_time\": %zd,\n", 
deÿy_time
);

375 ià(
İt_purge
 =ğ
purge_mode_deÿy
) {

376 ià(
deÿy_time
 >= 0) {

377 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

378 "deÿyime: %zd\n", 
deÿy_time
);

380 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

386 
	`CTL_M2_GET
("¡©s.¬’as.0.·ùive", 
i
, &
·ùive
, 
size_t
);

387 
	`CTL_M2_GET
("¡©s.¬’as.0.pdœty", 
i
, &
pdœty
, 
size_t
);

388 
	`CTL_M2_GET
("¡©s.¬’as.0.Åurge", 
i
, &
Åurge
, 
ušt64_t
);

389 
	`CTL_M2_GET
("¡©s.¬’as.0.nmadvi£", 
i
, &
nmadvi£
, 
ušt64_t
);

390 
	`CTL_M2_GET
("¡©s.¬’as.0.purged", 
i
, &
purged
, 
ušt64_t
);

391 ià(
jsÚ
) {

392 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

393 "\t\t\t\t\"·ùive\": %zu,\n", 
·ùive
);

394 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

395 "\t\t\t\t\"pdœty\": %zu,\n", 
pdœty
);

396 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

397 "\t\t\t\t\"Åurge\": %"
FMTu64
",\n", 
Åurge
);

398 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

399 "\t\t\t\t\"nmadvi£\": %"
FMTu64
",\n", 
nmadvi£
);

400 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

401 "\t\t\t\t\"purged\": %"
FMTu64
",\n", 
purged
);

403 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

404 "purgšg: dœty: %zu, sw“ps: %"
FMTu64
", madvises: %"FMTu64

405 ",…urged: %"
FMTu64
"\n", 
pdœty
, 
Åurge
, 
nmadvi£
, 
purged
);

408 
	`CTL_M2_GET
("¡©s.¬’as.0.sm®l.®loÿ‹d", 
i
, &
sm®l_®loÿ‹d
,

409 
size_t
);

410 
	`CTL_M2_GET
("¡©s.¬’as.0.sm®l.nm®loc", 
i
, &
sm®l_nm®loc
, 
ušt64_t
);

411 
	`CTL_M2_GET
("¡©s.¬’as.0.sm®l.nd®loc", 
i
, &
sm®l_nd®loc
, 
ušt64_t
);

412 
	`CTL_M2_GET
("¡©s.¬’as.0.sm®l.Äeque¡s", 
i
, &
sm®l_Äeque¡s
,

413 
ušt64_t
);

414 ià(
jsÚ
) {

415 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

418 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

419 "\t\t\t\t\t\"®loÿ‹d\": %zu,\n", 
sm®l_®loÿ‹d
);

420 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

421 "\t\t\t\t\t\"nm®loc\": %"
FMTu64
",\n", 
sm®l_nm®loc
);

422 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

423 "\t\t\t\t\t\"nd®loc\": %"
FMTu64
",\n", 
sm®l_nd®loc
);

424 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

425 "\t\t\t\t\t\"Äeque¡s\": %"
FMTu64
"\n", 
sm®l_Äeque¡s
);

427 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

430 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

433 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

434 "sm®l: %12zu %12"
FMTu64
" %12"FMTu64

435 " %12"
FMTu64
"\n",

436 
sm®l_®loÿ‹d
, 
sm®l_nm®loc
, 
sm®l_nd®loc
,

437 
sm®l_Äeque¡s
);

440 
	`CTL_M2_GET
("¡©s.¬’as.0.Ïrge.®loÿ‹d", 
i
, &
Ïrge_®loÿ‹d
,

441 
size_t
);

442 
	`CTL_M2_GET
("¡©s.¬’as.0.Ïrge.nm®loc", 
i
, &
Ïrge_nm®loc
, 
ušt64_t
);

443 
	`CTL_M2_GET
("¡©s.¬’as.0.Ïrge.nd®loc", 
i
, &
Ïrge_nd®loc
, 
ušt64_t
);

444 
	`CTL_M2_GET
("¡©s.¬’as.0.Ïrge.Äeque¡s", 
i
, &
Ïrge_Äeque¡s
,

445 
ušt64_t
);

446 ià(
jsÚ
) {

447 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

450 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

451 "\t\t\t\t\t\"®loÿ‹d\": %zu,\n", 
Ïrge_®loÿ‹d
);

452 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

453 "\t\t\t\t\t\"nm®loc\": %"
FMTu64
",\n", 
Ïrge_nm®loc
);

454 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

455 "\t\t\t\t\t\"nd®loc\": %"
FMTu64
",\n", 
Ïrge_nd®loc
);

456 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

457 "\t\t\t\t\t\"Äeque¡s\": %"
FMTu64
"\n", 
Ïrge_Äeque¡s
);

459 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

462 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

463 "Ïrge: %12zu %12"
FMTu64
" %12"FMTu64

464 " %12"
FMTu64
"\n",

465 
Ïrge_®loÿ‹d
, 
Ïrge_nm®loc
, 
Ïrge_nd®loc
,

466 
Ïrge_Äeque¡s
);

469 
	`CTL_M2_GET
("¡©s.¬’as.0.huge.®loÿ‹d", 
i
, &
huge_®loÿ‹d
, 
size_t
);

470 
	`CTL_M2_GET
("¡©s.¬’as.0.huge.nm®loc", 
i
, &
huge_nm®loc
, 
ušt64_t
);

471 
	`CTL_M2_GET
("¡©s.¬’as.0.huge.nd®loc", 
i
, &
huge_nd®loc
, 
ušt64_t
);

472 
	`CTL_M2_GET
("¡©s.¬’as.0.huge.Äeque¡s", 
i
, &
huge_Äeque¡s
,

473 
ušt64_t
);

474 ià(
jsÚ
) {

475 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

478 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

479 "\t\t\t\t\t\"®loÿ‹d\": %zu,\n", 
huge_®loÿ‹d
);

480 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

481 "\t\t\t\t\t\"nm®loc\": %"
FMTu64
",\n", 
huge_nm®loc
);

482 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

483 "\t\t\t\t\t\"nd®loc\": %"
FMTu64
",\n", 
huge_nd®loc
);

484 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

485 "\t\t\t\t\t\"Äeque¡s\": %"
FMTu64
"\n", 
huge_Äeque¡s
);

487 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

490 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

491 "huge: %12zu %12"
FMTu64
" %12"FMTu64

492 " %12"
FMTu64
"\n",

493 
huge_®loÿ‹d
, 
huge_nm®loc
, 
huge_nd®loc
, 
huge_Äeque¡s
);

494 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

495 "tÙ®: %12zu %12"
FMTu64
" %12"FMTu64

496 " %12"
FMTu64
"\n",

497 
sm®l_®loÿ‹d
 + 
Ïrge_®loÿ‹d
 + 
huge_®loÿ‹d
,

498 
sm®l_nm®loc
 + 
Ïrge_nm®loc
 + 
huge_nm®loc
,

499 
sm®l_nd®loc
 + 
Ïrge_nd®loc
 + 
huge_nd®loc
,

500 
sm®l_Äeque¡s
 + 
Ïrge_Äeque¡s
 + 
huge_Äeque¡s
);

502 ià(!
jsÚ
) {

503 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

504 "aùive: %12zu\n", 
·ùive
 * 
·ge
);

507 
	`CTL_M2_GET
("¡©s.¬’as.0.m­³d", 
i
, &
m­³d
, 
size_t
);

508 ià(
jsÚ
) {

509 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

510 "\t\t\t\t\"m­³d\": %zu,\n", 
m­³d
);

512 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

513 "m­³d: %12zu\n", 
m­³d
);

516 
	`CTL_M2_GET
("¡©s.¬’as.0.»šed", 
i
, &
»šed
, 
size_t
);

517 ià(
jsÚ
) {

518 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

519 "\t\t\t\t\"»šed\": %zu,\n", 
»šed
);

521 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

522 "»šed: %12zu\n", 
»šed
);

525 
	`CTL_M2_GET
("¡©s.¬’as.0.m‘ad©a.m­³d", 
i
, &
m‘ad©a_m­³d
,

526 
size_t
);

527 
	`CTL_M2_GET
("¡©s.¬’as.0.m‘ad©a.®loÿ‹d", 
i
, &
m‘ad©a_®loÿ‹d
,

528 
size_t
);

529 ià(
jsÚ
) {

530 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

533 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

534 "\t\t\t\t\t\"m­³d\": %zu,\n", 
m‘ad©a_m­³d
);

535 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

536 "\t\t\t\t\t\"®loÿ‹d\": %zu\n", 
m‘ad©a_®loÿ‹d
);

538 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

541 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

543 
m‘ad©a_m­³d
, 
m‘ad©a_®loÿ‹d
);

546 ià(
bšs
) {

547 
	`¡©s_¬’a_bšs_´št
(
wr™e_cb
, 
cbİaque
, 
jsÚ
, 
Ïrge
, 
huge
,

548 
i
);

550 ià(
Ïrge
)

551 
	`¡©s_¬’a_Ìuns_´št
(
wr™e_cb
, 
cbİaque
, 
jsÚ
, 
huge
, 
i
);

552 ià(
huge
)

553 
	`¡©s_¬’a_hchunks_´št
(
wr™e_cb
, 
cbİaque
, 
jsÚ
, 
i
);

554 
	}
}

557 
	$¡©s_g’”®_´št
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

558 
boŞ
 
jsÚ
, boŞ 
m”ged
, boŞ 
unm”ged
)

560 cÚ¡ *
ıv
;

561 
boŞ
 
bv
;

562 
uv
;

563 
ušt32_t
 
u32v
;

564 
ušt64_t
 
u64v
;

565 
ssize_t
 
ssv
;

566 
size_t
 
sv
, 
bsz
, 
usz
, 
ssz
, 
sssz
, 
ısz
;

568 
bsz
 = (
boŞ
);

569 
usz
 = ();

570 
ssz
 = (
size_t
);

571 
sssz
 = (
ssize_t
);

572 
ısz
 = (const *);

574 
	`CTL_GET
("v”siÚ", &
ıv
, const *);

575 ià(
jsÚ
) {

576 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

577 "\t\t\"v”siÚ\": \"%s\",\n", 
ıv
);

579 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, "V”siÚ: %s\n", 
ıv
);

582 
	#CONFIG_WRITE_BOOL_JSON
(
n
, 
c
) \

583 ià(
jsÚ
) { \

584 
	`CTL_GET
("cÚfig."#n, &
bv
, 
boŞ
); \

585 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

586 "\t\t\t\""#n"\": %s%s\n", 
bv
 ? "true" : "false", \

587 (
c
)); \

588 }

	)

590 ià(
jsÚ
) {

591 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

595 
	`CONFIG_WRITE_BOOL_JSON
(
ÿche_oblivious
, ",")

597 
	`CTL_GET
("cÚfig.debug", &
bv
, 
boŞ
);

598 ià(
jsÚ
) {

599 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

600 "\t\t\t\"debug\": %s,\n", 
bv
 ? "true" : "false");

602 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, "Assertions %s\n",

603 
bv
 ? "enabled" : "disabled");

606 
	`CONFIG_WRITE_BOOL_JSON
(
fl
, ",")

607 
	`CONFIG_WRITE_BOOL_JSON
(
Ïzy_lock
, ",")

609 ià(
jsÚ
) {

610 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

612 
cÚfig_m®loc_cÚf
);

614 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

615 "cÚfig.m®loc_cÚf: \"%s\"\n", 
cÚfig_m®loc_cÚf
);

618 
	`CONFIG_WRITE_BOOL_JSON
(
munm­
, ",")

619 
	`CONFIG_WRITE_BOOL_JSON
(
´of
, ",")

620 
	`CONFIG_WRITE_BOOL_JSON
(
´of_libgcc
, ",")

621 
	`CONFIG_WRITE_BOOL_JSON
(
´of_libunwšd
, ",")

622 
	`CONFIG_WRITE_BOOL_JSON
(
¡©s
, ",")

623 
	`CONFIG_WRITE_BOOL_JSON
(
tÿche
, ",")

624 
	`CONFIG_WRITE_BOOL_JSON
(
s
, ",")

625 
	`CONFIG_WRITE_BOOL_JSON
(
uŒaû
, ",")

626 
	`CONFIG_WRITE_BOOL_JSON
(
v®gršd
, ",")

627 
	`CONFIG_WRITE_BOOL_JSON
(
xm®loc
, "")

629 ià(
jsÚ
) {

630 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

633 #undeà
CONFIG_WRITE_BOOL_JSON


636 
	#OPT_WRITE_BOOL
(
n
, 
c
) \

637 ià(
	`je_m®lùl
("İt."#n, (*)&
bv
, &
bsz
, 
NULL
, 0) == 0) { \

638 ià(
jsÚ
) { \

639 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

640 "\t\t\t\""#n"\": %s%s\n", 
bv
 ? "true" : \

641 "çl£", (
c
)); \

643 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

644 " o±."#n": %s\n", 
bv
 ? "true" : "false"); \

646 }

	)

647 
	#OPT_WRITE_BOOL_MUTABLE
(
n
, 
m
, 
c
) { \

648 
boŞ
 
bv2
; \

649 ià(
	`je_m®lùl
("İt."#n, (*)&
bv
, &
bsz
, 
NULL
, 0) == 0 && \

650 
	`je_m®lùl
(#m, &
bv2
, (*)&
bsz
, 
NULL
, 0) == 0) { \

651 ià(
jsÚ
) { \

652 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

653 "\t\t\t\""#n"\": %s%s\n", 
bv
 ? "true" : \

654 "çl£", (
c
)); \

656 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

657 " o±."#n": % ("#m": %s)\n", 
bv
 ? "true" \

658 : "çl£", 
bv2
 ? "true" : "false"); \

661 }

	)

662 
	#OPT_WRITE_UNSIGNED
(
n
, 
c
) \

663 ià(
	`je_m®lùl
("İt."#n, (*)&
uv
, &
usz
, 
NULL
, 0) == 0) { \

664 ià(
jsÚ
) { \

665 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

666 "\t\t\t\""#n"\": %u%s\n", 
uv
, (
c
)); \

668 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

669 " o±."#n": %u\n", 
uv
); \

671 }

	)

672 
	#OPT_WRITE_SIZE_T
(
n
, 
c
) \

673 ià(
	`je_m®lùl
("İt."#n, (*)&
sv
, &
ssz
, 
NULL
, 0) == 0) { \

674 ià(
jsÚ
) { \

675 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

676 "\t\t\t\""#n"\": %zu%s\n", 
sv
, (
c
)); \

678 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

679 " o±."#n": %zu\n", 
sv
); \

681 }

	)

682 
	#OPT_WRITE_SSIZE_T
(
n
, 
c
) \

683 ià(
	`je_m®lùl
("İt."#n, (*)&
ssv
, &
sssz
, 
NULL
, 0) == 0) { \

684 ià(
jsÚ
) { \

685 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

686 "\t\t\t\""#n"\": %zd%s\n", 
ssv
, (
c
)); \

688 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

689 " o±."#n": %zd\n", 
ssv
); \

691 }

	)

692 
	#OPT_WRITE_SSIZE_T_MUTABLE
(
n
, 
m
, 
c
) { \

693 
ssize_t
 
ssv2
; \

694 ià(
	`je_m®lùl
("İt."#n, (*)&
ssv
, &
sssz
, 
NULL
, 0) == 0 && \

695 
	`je_m®lùl
(#m, (*)&
ssv2
, &
sssz
, 
NULL
, 0) == 0) { \

696 ià(
jsÚ
) { \

697 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

698 "\t\t\t\""#n"\": %zd%s\n", 
ssv
, (
c
)); \

700 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

702 
ssv
, 
ssv2
); \

705 }

	)

706 
	#OPT_WRITE_CHAR_P
(
n
, 
c
) \

707 ià(
	`je_m®lùl
("İt."#n, (*)&
ıv
, &
ısz
, 
NULL
, 0) == 0) { \

708 ià(
jsÚ
) { \

709 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

710 "\t\t\t\""#n"\": \"%s\"%s\n", 
ıv
, (
c
)); \

712 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, \

713 " o±."#n": \"%s\"\n", 
ıv
); \

715 }

	)

717 ià(
jsÚ
) {

718 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

721 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

724 
	`OPT_WRITE_BOOL
(
abÜt
, ",")

725 
	`OPT_WRITE_SIZE_T
(
lg_chunk
, ",")

726 
	`OPT_WRITE_CHAR_P
(
dss
, ",")

727 
	`OPT_WRITE_UNSIGNED
(
Ç»Çs
, ",")

728 
	`OPT_WRITE_CHAR_P
(
purge
, ",")

729 ià(
jsÚ
 || 
İt_purge
 =ğ
purge_mode_¿tio
) {

730 
	`OPT_WRITE_SSIZE_T_MUTABLE
(
lg_dœty_muÉ
,

731 
¬’as
.
lg_dœty_muÉ
, ",")

733 ià(
jsÚ
 || 
İt_purge
 =ğ
purge_mode_deÿy
) {

734 
	`OPT_WRITE_SSIZE_T_MUTABLE
(
deÿy_time
, 
¬’as
.decay_time, ",")

736 
	`OPT_WRITE_CHAR_P
(
junk
, ",")

737 
	`OPT_WRITE_SIZE_T
(
qu¬ªtše
, ",")

738 
	`OPT_WRITE_BOOL
(
»dzÚe
, ",")

739 
	`OPT_WRITE_BOOL
(
z”o
, ",")

740 
	`OPT_WRITE_BOOL
(
uŒaû
, ",")

741 
	`OPT_WRITE_BOOL
(
xm®loc
, ",")

742 
	`OPT_WRITE_BOOL
(
tÿche
, ",")

743 
	`OPT_WRITE_SSIZE_T
(
lg_tÿche_max
, ",")

744 
	`OPT_WRITE_BOOL
(
´of
, ",")

745 
	`OPT_WRITE_CHAR_P
(
´of_´efix
, ",")

746 
	`OPT_WRITE_BOOL_MUTABLE
(
´of_aùive
, 
´of
.
aùive
, ",")

747 
	`OPT_WRITE_BOOL_MUTABLE
(
´of_th»ad_aùive_š™
, 
´of
.
th»ad_aùive_š™
,

749 
	`OPT_WRITE_SSIZE_T_MUTABLE
(
lg_´of_§m¶e
, 
´of
.
lg_§m¶e
, ",")

750 
	`OPT_WRITE_BOOL
(
´of_accum
, ",")

751 
	`OPT_WRITE_SSIZE_T
(
lg_´of_š‹rv®
, ",")

752 
	`OPT_WRITE_BOOL
(
´of_gdump
, ",")

753 
	`OPT_WRITE_BOOL
(
´of_fš®
, ",")

754 
	`OPT_WRITE_BOOL
(
´of_Ëak
, ",")

760 
	`OPT_WRITE_BOOL
(
¡©s_´št
, "")

761 ià(
jsÚ
) {

762 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

766 #undeà
OPT_WRITE_BOOL


767 #undeà
OPT_WRITE_BOOL_MUTABLE


768 #undeà
OPT_WRITE_SIZE_T


769 #undeà
OPT_WRITE_SSIZE_T


770 #undeà
OPT_WRITE_CHAR_P


773 ià(
jsÚ
) {

774 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

778 
	`CTL_GET
("¬’as.Ç»Çs", &
uv
, );

779 ià(
jsÚ
) {

780 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

781 "\t\t\t\"Ç»Çs\": %u,\n", 
uv
);

783 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, "A»Çs: %u\n", 
uv
);

785 
	`CTL_GET
("¬’as.lg_dœty_muÉ", &
ssv
, 
ssize_t
);

786 ià(
jsÚ
) {

787 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

788 "\t\t\t\"lg_dœty_muÉ\": %zd,\n", 
ssv
);

789 } ià(
İt_purge
 =ğ
purge_mode_¿tio
) {

790 ià(
ssv
 >= 0) {

791 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

793 "%u:1\n", (1U << 
ssv
));

795 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

800 
	`CTL_GET
("¬’as.deÿy_time", &
ssv
, 
ssize_t
);

801 ià(
jsÚ
) {

802 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

803 "\t\t\t\"deÿy_time\": %zd,\n", 
ssv
);

804 } ià(
İt_purge
 =ğ
purge_mode_deÿy
) {

805 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

807 
ssv
, (ssv < 0) ? " (no decay)" : "");

810 
	`CTL_GET
("¬’as.quªtum", &
sv
, 
size_t
);

811 ià(
jsÚ
) {

812 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

813 "\t\t\t\"quªtum\": %zu,\n", 
sv
);

815 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, "Quªtum size: %zu\n", 
sv
);

817 
	`CTL_GET
("¬’as.·ge", &
sv
, 
size_t
);

818 ià(
jsÚ
) {

819 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

820 "\t\t\t\"·ge\": %zu,\n", 
sv
);

822 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
, "Pagsize: %zu\n", 
sv
);

824 ià(
	`je_m®lùl
("¬’as.tÿche_max", (*)&
sv
, &
ssz
, 
NULL
, 0) == 0) {

825 ià(
jsÚ
) {

826 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

827 "\t\t\t\"tÿche_max\": %zu,\n", 
sv
);

829 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

830 "Maximumh»ad-ÿched sizşass: %zu\n", 
sv
);

834 ià(
jsÚ
) {

835 
nbšs
, 
Æruns
, 
nhchunks
, 
i
;

837 
	`CTL_GET
("¬’as.nbšs", &
nbšs
, );

838 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

839 "\t\t\t\"nbšs\": %u,\n", 
nbšs
);

841 
	`CTL_GET
("¬’as.nhbšs", &
uv
, );

842 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

843 "\t\t\t\"nhbšs\": %u,\n", 
uv
);

845 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

847 
i
 = 0; i < 
nbšs
; i++) {

848 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

851 
	`CTL_M2_GET
("¬’as.bš.0.size", 
i
, &
sv
, 
size_t
);

852 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

853 "\t\t\t\t\t\"size\": %zu,\n", 
sv
);

855 
	`CTL_M2_GET
("¬’as.bš.0.Äegs", 
i
, &
u32v
, 
ušt32_t
);

856 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

857 "\t\t\t\t\t\"Äegs\": %"
FMTu32
",\n", 
u32v
);

859 
	`CTL_M2_GET
("¬’as.bš.0.run_size", 
i
, &
sv
, 
size_t
);

860 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

861 "\t\t\t\t\t\"run_size\": %zu\n", 
sv
);

863 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

864 "\t\t\t\t}%s\n", (
i
 + 1 < 
nbšs
) ? "," : "");

866 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

869 
	`CTL_GET
("¬’as.Æruns", &
Æruns
, );

870 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

871 "\t\t\t\"Æruns\": %u,\n", 
Æruns
);

873 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

875 
i
 = 0; i < 
Æruns
; i++) {

876 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

879 
	`CTL_M2_GET
("¬’as.Ìun.0.size", 
i
, &
sv
, 
size_t
);

880 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

881 "\t\t\t\t\t\"size\": %zu\n", 
sv
);

883 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

884 "\t\t\t\t}%s\n", (
i
 + 1 < 
Æruns
) ? "," : "");

886 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

889 
	`CTL_GET
("¬’as.nhchunks", &
nhchunks
, );

890 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

891 "\t\t\t\"nhchunks\": %u,\n", 
nhchunks
);

893 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

895 
i
 = 0; i < 
nhchunks
; i++) {

896 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

899 
	`CTL_M2_GET
("¬’as.hchunk.0.size", 
i
, &
sv
, 
size_t
);

900 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

901 "\t\t\t\t\t\"size\": %zu\n", 
sv
);

903 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

904 "\t\t\t\t}%s\n", (
i
 + 1 < 
nhchunks
) ? "," : "");

906 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

909 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

914 ià(
jsÚ
) {

915 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

918 
	`CTL_GET
("´of.th»ad_aùive_š™", &
bv
, 
boŞ
);

919 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

920 "\t\t\t\"th»ad_aùive_š™\": %s,\n", 
bv
 ? "true" :

923 
	`CTL_GET
("´of.aùive", &
bv
, 
boŞ
);

924 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

925 "\t\t\t\"aùive\": %s,\n", 
bv
 ? "true" : "false");

927 
	`CTL_GET
("´of.gdump", &
bv
, 
boŞ
);

928 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

929 "\t\t\t\"gdump\": %s,\n", 
bv
 ? "true" : "false");

931 
	`CTL_GET
("´of.š‹rv®", &
u64v
, 
ušt64_t
);

932 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

933 "\t\t\t\"š‹rv®\": %"
FMTu64
",\n", 
u64v
);

935 
	`CTL_GET
("´of.lg_§m¶e", &
ssv
, 
ssize_t
);

936 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

937 "\t\t\t\"lg_§m¶e\": %zd\n", 
ssv
);

939 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

940 "\t\t}%s\n", (
cÚfig_¡©s
 || 
m”ged
 || 
unm”ged
) ? "," :

943 
	}
}

946 
	$¡©s_´št_h–³r
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

947 
boŞ
 
jsÚ
, boŞ 
m”ged
, boŞ 
unm”ged
, boŞ 
bšs
, boŞ 
Ïrge
, boŞ 
huge
)

949 
size_t
 *
ÿùive
;

950 
size_t
 
®loÿ‹d
, 
aùive
, 
m‘ad©a
, 
»sid’t
, 
m­³d
, 
»šed
;

952 
	`CTL_GET
("¡©s.ÿùive", &
ÿùive
, 
size_t
 *);

953 
	`CTL_GET
("¡©s.®loÿ‹d", &
®loÿ‹d
, 
size_t
);

954 
	`CTL_GET
("¡©s.aùive", &
aùive
, 
size_t
);

955 
	`CTL_GET
("¡©s.m‘ad©a", &
m‘ad©a
, 
size_t
);

956 
	`CTL_GET
("¡©s.»sid’t", &
»sid’t
, 
size_t
);

957 
	`CTL_GET
("¡©s.m­³d", &
m­³d
, 
size_t
);

958 
	`CTL_GET
("¡©s.»šed", &
»šed
, 
size_t
);

959 ià(
jsÚ
) {

960 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

963 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

964 "\t\t\t\"ÿùive\": %zu,\n", 
	`©omic_»ad_z
(
ÿùive
));

965 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

966 "\t\t\t\"®loÿ‹d\": %zu,\n", 
®loÿ‹d
);

967 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

968 "\t\t\t\"aùive\": %zu,\n", 
aùive
);

969 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

970 "\t\t\t\"m‘ad©a\": %zu,\n", 
m‘ad©a
);

971 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

972 "\t\t\t\"»sid’t\": %zu,\n", 
»sid’t
);

973 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

974 "\t\t\t\"m­³d\": %zu,\n", 
m­³d
);

975 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

976 "\t\t\t\"»šed\": %zu\n", 
»šed
);

978 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

979 "\t\t}%s\n", (
m”ged
 || 
unm”ged
) ? "," : "");

981 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

984 
®loÿ‹d
, 
aùive
, 
m‘ad©a
, 
»sid’t
, 
m­³d
, 
»šed
);

985 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

987 
	`©omic_»ad_z
(
ÿùive
));

990 ià(
m”ged
 || 
unm”ged
) {

991 
Ç»Çs
;

993 ià(
jsÚ
) {

994 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

998 
	`CTL_GET
("¬’as.Ç»Çs", &
Ç»Çs
, );

1000 
	`VARIABLE_ARRAY
(
boŞ
, 
š™Ÿlized
, 
Ç»Çs
);

1001 
size_t
 
isz
;

1002 
i
, 
j
, 
nš™Ÿlized
;

1004 
isz
 = (
boŞ
è* 
Ç»Çs
;

1005 
	`xm®lùl
("¬’as.š™Ÿlized", (*)
š™Ÿlized
,

1006 &
isz
, 
NULL
, 0);

1007 
i
 = 
nš™Ÿlized
 = 0; i < 
Ç»Çs
; i++) {

1008 ià(
š™Ÿlized
[
i
])

1009 
nš™Ÿlized
++;

1013 ià(
m”ged
 && (
nš™Ÿlized
 > 1 || !
unm”ged
)) {

1015 ià(
jsÚ
) {

1016 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

1019 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

1022 
	`¡©s_¬’a_´št
(
wr™e_cb
, 
cbİaque
, 
jsÚ
,

1023 
Ç»Çs
, 
bšs
, 
Ïrge
, 
huge
);

1024 ià(
jsÚ
) {

1025 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

1026 "\t\t\t}%s\n", (
nš™Ÿlized
 > 1) ?

1032 
i
 = 
j
 = 0; i < 
Ç»Çs
; i++) {

1033 ià(
š™Ÿlized
[
i
]) {

1034 ià(
jsÚ
) {

1035 
j
++;

1036 
	`m®loc_ırštf
(
wr™e_cb
,

1037 
cbİaque
,

1038 "\t\t\t\"%u\": {\n", 
i
);

1040 
	`m®loc_ırštf
(
wr™e_cb
,

1041 
cbİaque
, "\narenas[%u]:\n",

1042 
i
);

1044 
	`¡©s_¬’a_´št
(
wr™e_cb
, 
cbİaque
,

1045 
jsÚ
, 
i
, 
bšs
, 
Ïrge
, 
huge
);

1046 ià(
jsÚ
) {

1047 
	`m®loc_ırštf
(
wr™e_cb
,

1048 
cbİaque
,

1049 "\t\t\t}%s\n", (
j
 <

1050 
nš™Ÿlized
) ? "," : "");

1056 ià(
jsÚ
) {

1057 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

1061 
	}
}

1064 
	$¡©s_´št
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

1065 cÚ¡ *
İts
)

1067 
”r
;

1068 
ušt64_t
 
•och
;

1069 
size_t
 
u64sz
;

1070 
boŞ
 
jsÚ
 = 
çl£
;

1071 
boŞ
 
g’”®
 = 
Œue
;

1072 
boŞ
 
m”ged
 = 
Œue
;

1073 
boŞ
 
unm”ged
 = 
Œue
;

1074 
boŞ
 
bšs
 = 
Œue
;

1075 
boŞ
 
Ïrge
 = 
Œue
;

1076 
boŞ
 
huge
 = 
Œue
;

1085 
•och
 = 1;

1086 
u64sz
 = (
ušt64_t
);

1087 
”r
 = 
	`je_m®lùl
("•och", (*)&
•och
, &
u64sz
, (*)&epoch,

1088 (
ušt64_t
));

1089 ià(
”r
 != 0) {

1090 ià(
”r
 =ğ
EAGAIN
) {

1091 
	`m®loc_wr™e
("<jemalloc>: Memory‡llocation failure in "

1095 
	`m®loc_wr™e
("<jemalloc>: Failure in mallctl(\"epoch\", "

1097 
	`abÜt
();

1100 ià(
İts
 !ğ
NULL
) {

1101 
i
;

1103 
i
 = 0; 
İts
[i] != '\0'; i++) {

1104 
İts
[
i
]) {

1106 
jsÚ
 = 
Œue
;

1109 
g’”®
 = 
çl£
;

1112 
m”ged
 = 
çl£
;

1115 
unm”ged
 = 
çl£
;

1118 
bšs
 = 
çl£
;

1121 
Ïrge
 = 
çl£
;

1124 
huge
 = 
çl£
;

1131 ià(
jsÚ
) {

1132 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

1136 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

1140 ià(
g’”®
)

1141 
	`¡©s_g’”®_´št
(
wr™e_cb
, 
cbİaque
, 
jsÚ
, 
m”ged
, 
unm”ged
);

1142 ià(
cÚfig_¡©s
) {

1143 
	`¡©s_´št_h–³r
(
wr™e_cb
, 
cbİaque
, 
jsÚ
, 
m”ged
, 
unm”ged
,

1144 
bšs
, 
Ïrge
, 
huge
);

1146 ià(
jsÚ
) {

1147 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

1151 
	`m®loc_ırštf
(
wr™e_cb
, 
cbİaque
,

1154 
	}
}

	@deps/jemalloc/src/tcache.c

1 
	#JEMALLOC_TCACHE_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

7 
boŞ
 
	gİt_tÿche
 = 
Œue
;

8 
ssize_t
 
	gİt_lg_tÿche_max
 = 
LG_TCACHE_MAXCLASS_DEFAULT
;

10 
tÿche_bš_šfo_t
 *
	gtÿche_bš_šfo
;

11 
	g¡ack_Ãlms
;

13 
	gnhbšs
;

14 
size_t
 
	gtÿche_maxşass
;

16 
tÿches_t
 *
	gtÿches
;

19 
	gtÿches_·¡
;

22 
tÿches_t
 *
	gtÿches_ava
;

26 
size_t


27 
	$tÿche_§Îoc
(
tsdn_t
 *
tsdn
, cÚ¡ *
±r
)

30  (
	`¬’a_§Îoc
(
tsdn
, 
±r
, 
çl£
));

31 
	}
}

34 
	$tÿche_ev’t_h¬d
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
)

36 
szšd_t
 
bššd
 = 
tÿche
->
Ãxt_gc_bš
;

37 
tÿche_bš_t
 *
tbš
 = &
tÿche
->
tbšs
[
bššd
];

38 
tÿche_bš_šfo_t
 *
tbš_šfo
 = &
tÿche_bš_šfo
[
bššd
];

40 ià(
tbš
->
low_w©”
 > 0) {

44 ià(
bššd
 < 
NBINS
) {

45 
	`tÿche_bš_æush_sm®l
(
tsd
, 
tÿche
, 
tbš
, 
bššd
,

46 
tbš
->
nÿched
 -bš->
low_w©”
 + (tbin->low_water

49 
	`tÿche_bš_æush_Ïrge
(
tsd
, 
tbš
, 
bššd
,bš->
nÿched


50 - 
tbš
->
low_w©”
 + (tbš->low_w©” >> 2), 
tÿche
);

56 ià((
tbš_šfo
->
nÿched_max
 >> (
tbš
->
lg_fl_div
+1)) >= 1)

57 
tbš
->
lg_fl_div
++;

58 } ià(
tbš
->
low_w©”
 < 0) {

63 ià(
tbš
->
lg_fl_div
 > 1)

64 
tbš
->
lg_fl_div
--;

66 
tbš
->
low_w©”
 =bš->
nÿched
;

68 
tÿche
->
Ãxt_gc_bš
++;

69 ià(
tÿche
->
Ãxt_gc_bš
 =ğ
nhbšs
)

70 
tÿche
->
Ãxt_gc_bš
 = 0;

71 
	}
}

74 
	$tÿche_®loc_sm®l_h¬d
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
, 
tÿche_t
 *
tÿche
,

75 
tÿche_bš_t
 *
tbš
, 
szšd_t
 
bššd
, 
boŞ
 *
tÿche_sucûss
)

77 *
»t
;

79 
	`¬’a_tÿche_fl_sm®l
(
tsdn
, 
¬’a
, 
tbš
, 
bššd
, 
cÚfig_´of
 ?

80 
tÿche
->
´of_accumby‹s
 : 0);

81 ià(
cÚfig_´of
)

82 
tÿche
->
´of_accumby‹s
 = 0;

83 
»t
 = 
	`tÿche_®loc_—sy
(
tbš
, 
tÿche_sucûss
);

85  (
»t
);

86 
	}
}

89 
	$tÿche_bš_æush_sm®l
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
, 
tÿche_bš_t
 *
tbš
,

90 
szšd_t
 
bššd
, 
»m
)

92 
¬’a_t
 *
¬’a
;

93 *
±r
;

94 
i
, 
næush
, 
ndeã¼ed
;

95 
boŞ
 
m”ged_¡©s
 = 
çl£
;

97 
	`as£¹
(
bššd
 < 
NBINS
);

98 
	`as£¹
(
»m
 <ğ
tbš
->
nÿched
);

100 
¬’a
 = 
	`¬’a_choo£
(
tsd
, 
NULL
);

101 
	`as£¹
(
¬’a
 !ğ
NULL
);

102 
næush
 = 
tbš
->
nÿched
 - 
»m
;‚æush > 0;‚æush = 
ndeã¼ed
) {

104 
¬’a_chunk_t
 *
chunk
 = (¬’a_chunk_ˆ*)
	`CHUNK_ADDR2BASE
(

105 *(
tbš
->
ava
 - 1));

106 
¬’a_t
 *
bš_¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
);

107 
¬’a_bš_t
 *
bš
 = &
bš_¬’a
->
bšs
[
bššd
];

109 ià(
cÚfig_´of
 && 
bš_¬’a
 =ğ
¬’a
) {

110 ià(
	`¬’a_´of_accum
(
	`tsd_tsdn
(
tsd
), 
¬’a
,

111 
tÿche
->
´of_accumby‹s
))

112 
	`´of_idump
(
	`tsd_tsdn
(
tsd
));

113 
tÿche
->
´of_accumby‹s
 = 0;

116 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

117 ià(
cÚfig_¡©s
 && 
bš_¬’a
 =ğ
¬’a
) {

118 
	`as£¹
(!
m”ged_¡©s
);

119 
m”ged_¡©s
 = 
Œue
;

120 
bš
->
¡©s
.
næushes
++;

121 
bš
->
¡©s
.
Äeque¡s
 +ğ
tbš
->
t¡©s
.nrequests;

122 
tbš
->
t¡©s
.
Äeque¡s
 = 0;

124 
ndeã¼ed
 = 0;

125 
i
 = 0; i < 
næush
; i++) {

126 
±r
 = *(
tbš
->
ava
 - 1 - 
i
);

127 
	`as£¹
(
±r
 !ğ
NULL
);

128 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

129 ià(
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
è=ğ
bš_¬’a
) {

130 
size_t
 
·gešd
 = ((
ušŒ_t
)
±r
 -

131 (
ušŒ_t
)
chunk
è>> 
LG_PAGE
;

132 
¬’a_chunk_m­_b™s_t
 *
b™£lm
 =

133 
	`¬’a_b™£lm_g‘_mubË
(
chunk
, 
·gešd
);

134 
	`¬’a_d®loc_bš_junked_locked
(
	`tsd_tsdn
(
tsd
),

135 
bš_¬’a
, 
chunk
, 
±r
, 
b™£lm
);

143 *(
tbš
->
ava
 - 1 - 
ndeã¼ed
èğ
±r
;

144 
ndeã¼ed
++;

147 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

148 
	`¬’a_deÿy_ticks
(
	`tsd_tsdn
(
tsd
), 
bš_¬’a
, 
næush
 - 
ndeã¼ed
);

150 ià(
cÚfig_¡©s
 && !
m”ged_¡©s
) {

155 
¬’a_bš_t
 *
bš
 = &
¬’a
->
bšs
[
bššd
];

156 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

157 
bš
->
¡©s
.
næushes
++;

158 
bš
->
¡©s
.
Äeque¡s
 +ğ
tbš
->
t¡©s
.nrequests;

159 
tbš
->
t¡©s
.
Äeque¡s
 = 0;

160 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

163 
	`memmove
(
tbš
->
ava
 - 
»m
,bš->ava -bš->
nÿched
,„em *

165 
tbš
->
nÿched
 = 
»m
;

166 ià(()
tbš
->
nÿched
 <bš->
low_w©”
)

167 
tbš
->
low_w©”
 =bš->
nÿched
;

168 
	}
}

171 
	$tÿche_bš_æush_Ïrge
(
tsd_t
 *
tsd
, 
tÿche_bš_t
 *
tbš
, 
szšd_t
 
bššd
,

172 
»m
, 
tÿche_t
 *
tÿche
)

174 
¬’a_t
 *
¬’a
;

175 *
±r
;

176 
i
, 
næush
, 
ndeã¼ed
;

177 
boŞ
 
m”ged_¡©s
 = 
çl£
;

179 
	`as£¹
(
bššd
 < 
nhbšs
);

180 
	`as£¹
(
»m
 <ğ
tbš
->
nÿched
);

182 
¬’a
 = 
	`¬’a_choo£
(
tsd
, 
NULL
);

183 
	`as£¹
(
¬’a
 !ğ
NULL
);

184 
næush
 = 
tbš
->
nÿched
 - 
»m
;‚æush > 0;‚æush = 
ndeã¼ed
) {

186 
¬’a_chunk_t
 *
chunk
 = (¬’a_chunk_ˆ*)
	`CHUNK_ADDR2BASE
(

187 *(
tbš
->
ava
 - 1));

188 
¬’a_t
 *
locked_¬’a
 = 
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
);

189 
UNUSED
 
boŞ
 
idump
;

191 ià(
cÚfig_´of
)

192 
idump
 = 
çl£
;

193 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
locked_¬’a
->
lock
);

194 ià((
cÚfig_´of
 || 
cÚfig_¡©s
è&& 
locked_¬’a
 =ğ
¬’a
) {

195 ià(
cÚfig_´of
) {

196 
idump
 = 
	`¬’a_´of_accum_locked
(
¬’a
,

197 
tÿche
->
´of_accumby‹s
);

198 
tÿche
->
´of_accumby‹s
 = 0;

200 ià(
cÚfig_¡©s
) {

201 
m”ged_¡©s
 = 
Œue
;

202 
¬’a
->
¡©s
.
Äeque¡s_Ïrge
 +=

203 
tbš
->
t¡©s
.
Äeque¡s
;

204 
¬’a
->
¡©s
.
l¡©s
[
bššd
 - 
NBINS
].
Äeque¡s
 +=

205 
tbš
->
t¡©s
.
Äeque¡s
;

206 
tbš
->
t¡©s
.
Äeque¡s
 = 0;

209 
ndeã¼ed
 = 0;

210 
i
 = 0; i < 
næush
; i++) {

211 
±r
 = *(
tbš
->
ava
 - 1 - 
i
);

212 
	`as£¹
(
±r
 !ğ
NULL
);

213 
chunk
 = (
¬’a_chunk_t
 *)
	`CHUNK_ADDR2BASE
(
±r
);

214 ià(
	`ex‹Á_node_¬’a_g‘
(&
chunk
->
node
) ==

215 
locked_¬’a
) {

216 
	`¬’a_d®loc_Ïrge_junked_locked
(
	`tsd_tsdn
(
tsd
),

217 
locked_¬’a
, 
chunk
, 
±r
);

225 *(
tbš
->
ava
 - 1 - 
ndeã¼ed
èğ
±r
;

226 
ndeã¼ed
++;

229 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
locked_¬’a
->
lock
);

230 ià(
cÚfig_´of
 && 
idump
)

231 
	`´of_idump
(
	`tsd_tsdn
(
tsd
));

232 
	`¬’a_deÿy_ticks
(
	`tsd_tsdn
(
tsd
), 
locked_¬’a
, 
næush
 -

233 
ndeã¼ed
);

235 ià(
cÚfig_¡©s
 && !
m”ged_¡©s
) {

240 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
lock
);

241 
¬’a
->
¡©s
.
Äeque¡s_Ïrge
 +ğ
tbš
->
t¡©s
.
Äeque¡s
;

242 
¬’a
->
¡©s
.
l¡©s
[
bššd
 - 
NBINS
].
Äeque¡s
 +=

243 
tbš
->
t¡©s
.
Äeque¡s
;

244 
tbš
->
t¡©s
.
Äeque¡s
 = 0;

245 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
lock
);

248 
	`memmove
(
tbš
->
ava
 - 
»m
,bš->ava -bš->
nÿched
,„em *

250 
tbš
->
nÿched
 = 
»m
;

251 ià(()
tbš
->
nÿched
 <bš->
low_w©”
)

252 
tbš
->
low_w©”
 =bš->
nÿched
;

253 
	}
}

256 
	$tÿche_¬’a_assocŸ‹
(
tsdn_t
 *
tsdn
, 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
)

259 ià(
cÚfig_¡©s
) {

261 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

262 
	`ql_–m_Ãw
(
tÿche
, 
lšk
);

263 
	`ql__š£¹
(&
¬’a
->
tÿche_ql
, 
tÿche
, 
lšk
);

264 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

266 
	}
}

269 
	$tÿche_¬’a_dissocŸ‹
(
tsdn_t
 *
tsdn
, 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
)

272 ià(
cÚfig_¡©s
) {

274 
	`m®loc_mu‹x_lock
(
tsdn
, &
¬’a
->
lock
);

275 ià(
cÚfig_debug
) {

276 
boŞ
 
š_ql
 = 
çl£
;

277 
tÿche_t
 *
™”
;

278 
	`ql_fÜ—ch
(
™”
, &
¬’a
->
tÿche_ql
, 
lšk
) {

279 ià(
™”
 =ğ
tÿche
) {

280 
š_ql
 = 
Œue
;

284 
	`as£¹
(
š_ql
);

286 
	`ql_»move
(&
¬’a
->
tÿche_ql
, 
tÿche
, 
lšk
);

287 
	`tÿche_¡©s_m”ge
(
tsdn
, 
tÿche
, 
¬’a
);

288 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
¬’a
->
lock
);

290 
	}
}

293 
	$tÿche_¬’a_»assocŸ‹
(
tsdn_t
 *
tsdn
, 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
Şd¬’a
,

294 
¬’a_t
 *
Ãw¬’a
)

297 
	`tÿche_¬’a_dissocŸ‹
(
tsdn
, 
tÿche
, 
Şd¬’a
);

298 
	`tÿche_¬’a_assocŸ‹
(
tsdn
, 
tÿche
, 
Ãw¬’a
);

299 
	}
}

301 
tÿche_t
 *

302 
	$tÿche_g‘_h¬d
(
tsd_t
 *
tsd
)

304 
¬’a_t
 *
¬’a
;

306 ià(!
	`tÿche_’abËd_g‘
()) {

307 ià(
	`tsd_nomš®
(
tsd
))

308 
	`tÿche_’abËd_£t
(
çl£
);

309  (
NULL
);

311 
¬’a
 = 
	`¬’a_choo£
(
tsd
, 
NULL
);

312 ià(
	`uÆik–y
(
¬’a
 =ğ
NULL
))

313  (
NULL
);

314  (
	`tÿche_ü—‹
(
	`tsd_tsdn
(
tsd
), 
¬’a
));

315 
	}
}

317 
tÿche_t
 *

318 
	$tÿche_ü—‹
(
tsdn_t
 *
tsdn
, 
¬’a_t
 *
¬’a
)

320 
tÿche_t
 *
tÿche
;

321 
size_t
 
size
, 
¡ack_off£t
;

322 
i
;

324 
size
 = 
	`off£tof
(
tÿche_t
, 
tbšs
è+ ((
tÿche_bš_t
è* 
nhbšs
);

326 
size
 = 
	`PTR_CEILING
(size);

327 
¡ack_off£t
 = 
size
;

328 
size
 +ğ
¡ack_Ãlms
 * (*);

330 
size
 = 
	`§2u
(size, 
CACHELINE
);

332 
tÿche
 = 
	`®locztm
(
tsdn
, 
size
, 
CACHELINE
, 
Œue
, 
NULL
,rue,

333 
	`¬’a_g‘
(
TSDN_NULL
, 0, 
Œue
));

334 ià(
tÿche
 =ğ
NULL
)

335  (
NULL
);

337 
	`tÿche_¬’a_assocŸ‹
(
tsdn
, 
tÿche
, 
¬’a
);

339 
	`tick”_š™
(&
tÿche
->
gc_tick”
, 
TCACHE_GC_INCR
);

341 
	`as£¹
((
TCACHE_NSLOTS_SMALL_MAX
 & 1U) == 0);

342 
i
 = 0; i < 
nhbšs
; i++) {

343 
tÿche
->
tbšs
[
i
].
lg_fl_div
 = 1;

344 
¡ack_off£t
 +ğ
tÿche_bš_šfo
[
i
].
nÿched_max
 * (*);

350 
tÿche
->
tbšs
[
i
].
ava
 = (**)((
ušŒ_t
)tcache +

351 (
ušŒ_t
)
¡ack_off£t
);

354  (
tÿche
);

355 
	}
}

358 
	$tÿche_de¡roy
(
tsd_t
 *
tsd
, 
tÿche_t
 *
tÿche
)

360 
¬’a_t
 *
¬’a
;

361 
i
;

363 
¬’a
 = 
	`¬’a_choo£
(
tsd
, 
NULL
);

364 
	`tÿche_¬’a_dissocŸ‹
(
	`tsd_tsdn
(
tsd
), 
tÿche
, 
¬’a
);

366 
i
 = 0; i < 
NBINS
; i++) {

367 
tÿche_bš_t
 *
tbš
 = &
tÿche
->
tbšs
[
i
];

368 
	`tÿche_bš_æush_sm®l
(
tsd
, 
tÿche
, 
tbš
, 
i
, 0);

370 ià(
cÚfig_¡©s
 && 
tbš
->
t¡©s
.
Äeque¡s
 != 0) {

371 
¬’a_bš_t
 *
bš
 = &
¬’a
->
bšs
[
i
];

372 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

373 
bš
->
¡©s
.
Äeque¡s
 +ğ
tbš
->
t¡©s
.nrequests;

374 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
bš
->
lock
);

378 ; 
i
 < 
nhbšs
; i++) {

379 
tÿche_bš_t
 *
tbš
 = &
tÿche
->
tbšs
[
i
];

380 
	`tÿche_bš_æush_Ïrge
(
tsd
, 
tbš
, 
i
, 0, 
tÿche
);

382 ià(
cÚfig_¡©s
 && 
tbš
->
t¡©s
.
Äeque¡s
 != 0) {

383 
	`m®loc_mu‹x_lock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
lock
);

384 
¬’a
->
¡©s
.
Äeque¡s_Ïrge
 +ğ
tbš
->
t¡©s
.
Äeque¡s
;

385 
¬’a
->
¡©s
.
l¡©s
[
i
 - 
NBINS
].
Äeque¡s
 +=

386 
tbš
->
t¡©s
.
Äeque¡s
;

387 
	`m®loc_mu‹x_uÆock
(
	`tsd_tsdn
(
tsd
), &
¬’a
->
lock
);

391 ià(
cÚfig_´of
 && 
tÿche
->
´of_accumby‹s
 > 0 &&

392 
	`¬’a_´of_accum
(
	`tsd_tsdn
(
tsd
), 
¬’a
, 
tÿche
->
´of_accumby‹s
))

393 
	`´of_idump
(
	`tsd_tsdn
(
tsd
));

395 
	`id®loùm
(
	`tsd_tsdn
(
tsd
), 
tÿche
, 
NULL
, 
Œue
,rue);

396 
	}
}

399 
	$tÿche_ş—nup
(
tsd_t
 *
tsd
)

401 
tÿche_t
 *
tÿche
;

403 ià(!
cÚfig_tÿche
)

406 ià((
tÿche
 = 
	`tsd_tÿche_g‘
(
tsd
)è!ğ
NULL
) {

407 
	`tÿche_de¡roy
(
tsd
, 
tÿche
);

408 
	`tsd_tÿche_£t
(
tsd
, 
NULL
);

410 
	}
}

413 
	$tÿche_’abËd_ş—nup
(
tsd_t
 *
tsd
)

417 
	}
}

420 
	$tÿche_¡©s_m”ge
(
tsdn_t
 *
tsdn
, 
tÿche_t
 *
tÿche
, 
¬’a_t
 *
¬’a
)

422 
i
;

424 
	`ÿs£¹
(
cÚfig_¡©s
);

426 
	`m®loc_mu‹x_as£¹_owÃr
(
tsdn
, &
¬’a
->
lock
);

429 
i
 = 0; i < 
NBINS
; i++) {

430 
¬’a_bš_t
 *
bš
 = &
¬’a
->
bšs
[
i
];

431 
tÿche_bš_t
 *
tbš
 = &
tÿche
->
tbšs
[
i
];

432 
	`m®loc_mu‹x_lock
(
tsdn
, &
bš
->
lock
);

433 
bš
->
¡©s
.
Äeque¡s
 +ğ
tbš
->
t¡©s
.nrequests;

434 
	`m®loc_mu‹x_uÆock
(
tsdn
, &
bš
->
lock
);

435 
tbš
->
t¡©s
.
Äeque¡s
 = 0;

438 ; 
i
 < 
nhbšs
; i++) {

439 
m®loc_Ïrge_¡©s_t
 *
l¡©s
 = &
¬’a
->
¡©s
.l¡©s[
i
 - 
NBINS
];

440 
tÿche_bš_t
 *
tbš
 = &
tÿche
->
tbšs
[
i
];

441 
¬’a
->
¡©s
.
Äeque¡s_Ïrge
 +ğ
tbš
->
t¡©s
.
Äeque¡s
;

442 
l¡©s
->
Äeque¡s
 +ğ
tbš
->
t¡©s
.nrequests;

443 
tbš
->
t¡©s
.
Äeque¡s
 = 0;

445 
	}
}

447 
boŞ


448 
	$tÿches_ü—‹
(
tsd_t
 *
tsd
, *
r_šd
)

450 
¬’a_t
 *
¬’a
;

451 
tÿche_t
 *
tÿche
;

452 
tÿches_t
 *
–m
;

454 ià(
tÿches
 =ğ
NULL
) {

455 
tÿches
 = 
	`ba£_®loc
(
	`tsd_tsdn
(
tsd
), (
tÿche_t
 *) *

456 (
MALLOCX_TCACHE_MAX
+1));

457 ià(
tÿches
 =ğ
NULL
)

458  (
Œue
);

461 ià(
tÿches_ava
 =ğ
NULL
 && 
tÿches_·¡
 > 
MALLOCX_TCACHE_MAX
)

462  (
Œue
);

463 
¬’a
 = 
	`¬’a_ichoo£
(
tsd
, 
NULL
);

464 ià(
	`uÆik–y
(
¬’a
 =ğ
NULL
))

465  (
Œue
);

466 
tÿche
 = 
	`tÿche_ü—‹
(
	`tsd_tsdn
(
tsd
), 
¬’a
);

467 ià(
tÿche
 =ğ
NULL
)

468  (
Œue
);

470 ià(
tÿches_ava
 !ğ
NULL
) {

471 
–m
 = 
tÿches_ava
;

472 
tÿches_ava
 =ÿches_ava->
Ãxt
;

473 
–m
->
tÿche
 =cache;

474 *
r_šd
 = ()(
–m
 - 
tÿches
);

476 
–m
 = &
tÿches
[
tÿches_·¡
];

477 
–m
->
tÿche
 =cache;

478 *
r_šd
 = 
tÿches_·¡
;

479 
tÿches_·¡
++;

482  (
çl£
);

483 
	}
}

486 
	$tÿches_–m_æush
(
tsd_t
 *
tsd
, 
tÿches_t
 *
–m
)

489 ià(
–m
->
tÿche
 =ğ
NULL
)

491 
	`tÿche_de¡roy
(
tsd
, 
–m
->
tÿche
);

492 
–m
->
tÿche
 = 
NULL
;

493 
	}
}

496 
	$tÿches_æush
(
tsd_t
 *
tsd
, 
šd
)

499 
	`tÿches_–m_æush
(
tsd
, &
tÿches
[
šd
]);

500 
	}
}

503 
	$tÿches_de¡roy
(
tsd_t
 *
tsd
, 
šd
)

505 
tÿches_t
 *
–m
 = &
tÿches
[
šd
];

506 
	`tÿches_–m_æush
(
tsd
, 
–m
);

507 
–m
->
Ãxt
 = 
tÿches_ava
;

508 
tÿches_ava
 = 
–m
;

509 
	}
}

511 
boŞ


512 
	$tÿche_boÙ
(
tsdn_t
 *
tsdn
)

514 
i
;

520 ià(
İt_lg_tÿche_max
 < 0 || (
	`ZU
(1è<< o±_lg_tÿche_maxè< 
SMALL_MAXCLASS
)

521 
tÿche_maxşass
 = 
SMALL_MAXCLASS
;

522 ià((
	`ZU
(1è<< 
İt_lg_tÿche_max
è> 
Ïrge_maxşass
)

523 
tÿche_maxşass
 = 
Ïrge_maxşass
;

525 
tÿche_maxşass
 = (
	`ZU
(1è<< 
İt_lg_tÿche_max
);

527 
nhbšs
 = 
	`size2šdex
(
tÿche_maxşass
) + 1;

530 
tÿche_bš_šfo
 = (
tÿche_bš_šfo_t
 *)
	`ba£_®loc
(
tsdn
, 
nhbšs
 *

531 (
tÿche_bš_šfo_t
));

532 ià(
tÿche_bš_šfo
 =ğ
NULL
)

533  (
Œue
);

534 
¡ack_Ãlms
 = 0;

535 
i
 = 0; i < 
NBINS
; i++) {

536 ià((
¬’a_bš_šfo
[
i
].
Äegs
 << 1è<ğ
TCACHE_NSLOTS_SMALL_MIN
) {

537 
tÿche_bš_šfo
[
i
].
nÿched_max
 =

538 
TCACHE_NSLOTS_SMALL_MIN
;

539 } ià((
¬’a_bš_šfo
[
i
].
Äegs
 << 1) <=

540 
TCACHE_NSLOTS_SMALL_MAX
) {

541 
tÿche_bš_šfo
[
i
].
nÿched_max
 =

542 (
¬’a_bš_šfo
[
i
].
Äegs
 << 1);

544 
tÿche_bš_šfo
[
i
].
nÿched_max
 =

545 
TCACHE_NSLOTS_SMALL_MAX
;

547 
¡ack_Ãlms
 +ğ
tÿche_bš_šfo
[
i
].
nÿched_max
;

549 ; 
i
 < 
nhbšs
; i++) {

550 
tÿche_bš_šfo
[
i
].
nÿched_max
 = 
TCACHE_NSLOTS_LARGE
;

551 
¡ack_Ãlms
 +ğ
tÿche_bš_šfo
[
i
].
nÿched_max
;

554  (
çl£
);

555 
	}
}

	@deps/jemalloc/src/ticker.c

1 
	#JEMALLOC_TICKER_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

	@deps/jemalloc/src/tsd.c

1 
	#JEMALLOC_TSD_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

7 
	gnş—nups
;

8 
m®loc_tsd_ş—nup_t
 
	gş—nups
[
MALLOC_TSD_CLEANUPS_MAX
];

10 
	$m®loc_tsd_d©a
(, , 
tsd_t
, 
TSD_INITIALIZER
)

15 
	$m®loc_tsd_m®loc
(
size_t
 
size
)

18  (
	`a0m®loc
(
	`CACHELINE_CEILING
(
size
)));

19 
	}
}

22 
	$m®loc_tsd_d®loc
(*
w¿µ”
)

25 
	`a0d®loc
(
w¿µ”
);

26 
	}
}

29 
	$m®loc_tsd_no_ş—nup
(*
¬g
)

32 
	`nÙ_»ached
();

33 
	}
}

35 #ià
defšed
(
JEMALLOC_MALLOC_THREAD_CLEANUP
è|| defšed(
_WIN32
)

36 #iâdeà
_WIN32


37 
	gJEMALLOC_EXPORT


40 
	$_m®loc_th»ad_ş—nup
()

42 
boŞ
 
³ndšg
[
MALLOC_TSD_CLEANUPS_MAX
], 
agaš
;

43 
i
;

45 
i
 = 0; i < 
nş—nups
; i++)

46 
³ndšg
[
i
] = 
Œue
;

49 
agaš
 = 
çl£
;

50 
i
 = 0; i < 
nş—nups
; i++) {

51 ià(
³ndšg
[
i
]) {

52 
³ndšg
[
i
] = 
ş—nups
[i]();

53 ià(
³ndšg
[
i
])

54 
agaš
 = 
Œue
;

57 } 
agaš
);

58 
	}
}

62 
	$m®loc_tsd_ş—nup_»gi¡”
(
	$boŞ
 (*
f
)())

65 
	`as£¹
(
nş—nups
 < 
MALLOC_TSD_CLEANUPS_MAX
);

66 
ş—nups
[
nş—nups
] = 
f
;

67 
nş—nups
++;

68 
	}
}

71 
	$tsd_ş—nup
(*
¬g
)

73 
tsd_t
 *
tsd
 = (tsd_ˆ*)
¬g
;

75 
tsd
->
¡©e
) {

76 
tsd_¡©e_unš™Ÿlized
:

79 
tsd_¡©e_nomš®
:

80 
	#O
(
n
, 
t
) \

81 
n
##
	`_ş—nup
(
tsd
);

	)

82 
MALLOC_TSD


83 #undeà
O


84 
tsd
->
¡©e
 = 
tsd_¡©e_purg©Üy
;

85 
	`tsd_£t
(
tsd
);

87 
tsd_¡©e_purg©Üy
:

95 
tsd_¡©e_»šÿº©ed
:

101 
tsd
->
¡©e
 = 
tsd_¡©e_purg©Üy
;

102 
	`tsd_£t
(
tsd
);

105 
	`nÙ_»ached
();

107 
	}
}

109 
tsd_t
 *

110 
	$m®loc_tsd_boÙ0
()

112 
tsd_t
 *
tsd
;

114 
nş—nups
 = 0;

115 ià(
	`tsd_boÙ0
())

116  (
NULL
);

117 
tsd
 = 
	`tsd_ãtch
();

118 *
	`tsd_¬’as_td©a_by·s¥_g‘
(
tsd
èğ
Œue
;

119  (
tsd
);

120 
	}
}

123 
	$m®loc_tsd_boÙ1
()

126 
	`tsd_boÙ1
();

127 *
	`tsd_¬’as_td©a_by·s¥_g‘
(
	`tsd_ãtch
()èğ
çl£
;

128 
	}
}

130 #ifdeà
_WIN32


131 
BOOL
 
WINAPI


132 
	$_s_ÿÎback
(
HINSTANCE
 
hš¡DLL
, 
DWORD
 
fdwR—sÚ
, 
LPVOID
 
ÍvRe£rved
)

135 
fdwR—sÚ
) {

136 #ifdeà
JEMALLOC_LAZY_LOCK


137 
DLL_THREAD_ATTACH
:

138 
i¡h»aded
 = 
Œue
;

141 
DLL_THREAD_DETACH
:

142 
	`_m®loc_th»ad_ş—nup
();

147  (
Œue
);

148 
	}
}

150 #ifdeà
_MSC_VER


151 #ifdeà
_M_IX86


152 #´agm¨
comm’t
(
lšk”
, "/INCLUDE:__tls_used")

153 #´agm¨
comm’t
(
lšk”
, "/INCLUDE:_tls_callback")

155 #´agm¨
comm’t
(
lšk”
, "/INCLUDE:_tls_used")

156 #´agm¨
comm’t
(
lšk”
, "/INCLUDE:tls_callback")

158 #´agm¨
£ùiÚ
(".CRT$XLY",,
»ad
)

160 
JEMALLOC_SECTION
(".CRT$XLY"è
	$JEMALLOC_ATTR
(
u£d
)

161 
	$BOOL
 (
WINAPI
 *cÚ¡ 
s_ÿÎback
)(
HINSTANCE
 
hš¡DLL
,

162 
DWORD
 
fdwR—sÚ
, 
LPVOID
 
ÍvRe£rved
èğ
_s_ÿÎback
;

165 #ià(!
	`defšed
(
JEMALLOC_MALLOC_THREAD_CLEANUP
è&& !defšed(
JEMALLOC_TLS
) && \

166 !
	$defšed
(
_WIN32
))

168 
	$tsd_š™_check_»cursiÚ
(
tsd_š™_h—d_t
 *
h—d
, 
tsd_š™_block_t
 *
block
)

170 
±h»ad_t
 
£lf
 = 
	`±h»ad_£lf
();

171 
tsd_š™_block_t
 *
™”
;

174 
	`m®loc_mu‹x_lock
(
TSDN_NULL
, &
h—d
->
lock
);

175 
	`ql_fÜ—ch
(
™”
, &
h—d
->
blocks
, 
lšk
) {

176 ià(
™”
->
th»ad
 =ğ
£lf
) {

177 
	`m®loc_mu‹x_uÆock
(
TSDN_NULL
, &
h—d
->
lock
);

178  (
™”
->
d©a
);

182 
	`ql_–m_Ãw
(
block
, 
lšk
);

183 
block
->
th»ad
 = 
£lf
;

184 
	`ql__š£¹
(&
h—d
->
blocks
, 
block
, 
lšk
);

185 
	`m®loc_mu‹x_uÆock
(
TSDN_NULL
, &
h—d
->
lock
);

186  (
NULL
);

187 
	}
}

190 
	$tsd_š™_fšish
(
tsd_š™_h—d_t
 *
h—d
, 
tsd_š™_block_t
 *
block
)

193 
	`m®loc_mu‹x_lock
(
TSDN_NULL
, &
h—d
->
lock
);

194 
	`ql_»move
(&
h—d
->
blocks
, 
block
, 
lšk
);

195 
	`m®loc_mu‹x_uÆock
(
TSDN_NULL
, &
h—d
->
lock
);

196 
	}
}

	@deps/jemalloc/src/util.c

5 
	#as£¹
(
e
) do { \

6 ià(
cÚfig_debug
 && !(
e
)) { \

7 
	`m®loc_wr™e
("<jemalloc>: Failed‡ssertion\n"); \

8 
	`abÜt
(); \

10 } 0)

	)

12 
	#nÙ_»ached
() do { \

13 ià(
cÚfig_debug
) { \

14 
	`m®loc_wr™e
("<jemalloc>: Unreachable code„eached\n"); \

15 
	`abÜt
(); \

17 
	`uÄ—chabË
(); \

18 } 0)

	)

20 
	#nÙ_im¶em’‹d
() do { \

21 ià(
cÚfig_debug
) { \

22 
	`m®loc_wr™e
("<jemalloc>: Not implemented\n"); \

23 
	`abÜt
(); \

25 } 0)

	)

27 
	#JEMALLOC_UTIL_C_


	)

28 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

33 
w¹mes§ge
(*
cbİaque
, cÚ¡ *
s
);

34 
	#U2S_BUFSIZE
 ((1U << (
LG_SIZEOF_INTMAX_T
 + 3)è+ 1)

	)

35 *
u2s
(
uštmax_t
 
x
, 
ba£
, 
boŞ
 
uµ”ÿ£
, *
s
,

36 
size_t
 *
¦’_p
);

37 
	#D2S_BUFSIZE
 (1 + 
U2S_BUFSIZE
)

	)

38 *
d2s
(
štmax_t
 
x
, 
sign
, *
s
, 
size_t
 *
¦’_p
);

39 
	#O2S_BUFSIZE
 (1 + 
U2S_BUFSIZE
)

	)

40 *
o2s
(
uštmax_t
 
x
, 
boŞ
 
®t_fÜm
, *
s
, 
size_t
 *
¦’_p
);

41 
	#X2S_BUFSIZE
 (2 + 
U2S_BUFSIZE
)

	)

42 *
x2s
(
uštmax_t
 
x
, 
boŞ
 
®t_fÜm
, boŞ 
uµ”ÿ£
, *
s
,

43 
size_t
 *
¦’_p
);

49 
	$w¹mes§ge
(*
cbİaque
, cÚ¡ *
s
)

52 #ià
	`defšed
(
JEMALLOC_USE_SYSCALL
è&& defšed(
SYS_wr™e
)

62 
UNUSED
 
»suÉ
 = 
	`sysÿÎ
(
SYS_wr™e
, 
STDERR_FILENO
, 
s
, 
	`¡¾’
(s));

64 
UNUSED
 
ssize_t
 
»suÉ
 = 
	`wr™e
(
STDERR_FILENO
, 
s
, 
	`¡¾’
(s));

66 
	}
}

68 
JEMALLOC_EXPORT
 (*
je_m®loc_mes§ge
)(*, cÚ¡ *
s
);

75 
	$m®loc_wr™e
(cÚ¡ *
s
)

78 ià(
je_m®loc_mes§ge
 !ğ
NULL
)

79 
	`je_m®loc_mes§ge
(
NULL
, 
s
);

81 
	`w¹mes§ge
(
NULL
, 
s
);

82 
	}
}

89 
	$buã¼Ü
(
”r
, *
buf
, 
size_t
 
buæ’
)

92 #ifdeà
_WIN32


93 
	`FÜm©Mes§geA
(
FORMAT_MESSAGE_FROM_SYSTEM
, 
NULL
, 
”r
, 0,

94 (
LPSTR
)
buf
, (
DWORD
)
buæ’
, 
NULL
);

96 #–ià
	`defšed
(
__GLIBC__
è&& defšed(
_GNU_SOURCE
)

97 *
b
 = 
	`¡»¼Ü_r
(
”r
, 
buf
, 
buæ’
);

98 ià(
b
 !ğ
buf
) {

99 
	`¡ºıy
(
buf
, 
b
, 
buæ’
);

100 
buf
[
buæ’
-1] = '\0';

104  (
	`¡»¼Ü_r
(
”r
, 
buf
, 
buæ’
));

106 
	}
}

108 
uštmax_t


109 
	$m®loc_¡¹oumax
(cÚ¡ *
»¡riù
 
ÅŒ
, **»¡riù 
’d±r
, 
ba£
)

111 
uštmax_t
 
»t
, 
dig™
;

112 
b
;

113 
boŞ
 
Ãg
;

114 cÚ¡ *
p
, *
ns
;

116 
p
 = 
ÅŒ
;

117 ià(
ba£
 < 0 || base == 1 || base > 36) {

118 
ns
 = 
p
;

119 
	`£t_”ºo
(
EINVAL
);

120 
»t
 = 
UINTMAX_MAX
;

121 
Ïb–_»tuº
;

123 
b
 = 
ba£
;

126 
Ãg
 = 
çl£
;

127 
Œue
) {

128 *
p
) {

130 
p
++;

133 
Ãg
 = 
Œue
;

136 
p
++;

139 
Ïb–_´efix
;

144 
Ïb–_´efix
:

150 
ns
 = 
p
;

151 ià(*
p
 == '0') {

152 
p
[1]) {

155 ià(
b
 == 0)

156 
b
 = 8;

157 ià(
b
 == 8)

158 
p
++;

161 
p
[2]) {

168 ià(
b
 == 0)

169 
b
 = 16;

170 ià(
b
 == 16)

171 
p
 += 2;

178 
p
++;

179 
»t
 = 0;

180 
Ïb–_»tuº
;

183 ià(
b
 == 0)

184 
b
 = 10;

187 
»t
 = 0;

188 (*
p
 >ğ'0' && *°<ğ'9' && (
dig™
 = *°- '0'è< 
b
)

189 || (*
p
 >ğ'A' && *°<ğ'Z' && (
dig™
 = 10 + *°- 'A'è< 
b
)

190 || (*
p
 >ğ'a' && *°<ğ'z' && (
dig™
 = 10 + *°- 'a'è< 
b
)) {

191 
uštmax_t
 
´‘
 = 
»t
;

192 
»t
 *ğ
b
;

193 
»t
 +ğ
dig™
;

194 ià(
»t
 < 
´‘
) {

196 
	`£t_”ºo
(
ERANGE
);

197 
»t
 = 
UINTMAX_MAX
;

198 
Ïb–_»tuº
;

200 
p
++;

202 ià(
Ãg
)

203 
»t
 = (
uštmax_t
)(-((
štmax_t
)ret));

205 ià(
p
 =ğ
ns
) {

207 
	`£t_”ºo
(
EINVAL
);

208 
»t
 = 
UINTMAX_MAX
;

209 
Ïb–_»tuº
;

212 
Ïb–_»tuº
:

213 ià(
’d±r
 !ğ
NULL
) {

214 ià(
p
 =ğ
ns
) {

216 *
’d±r
 = (*)
ÅŒ
;

218 *
’d±r
 = (*)
p
;

220  (
»t
);

221 
	}
}

224 
	$u2s
(
uštmax_t
 
x
, 
ba£
, 
boŞ
 
uµ”ÿ£
, *
s
, 
size_t
 *
¦’_p
)

226 
i
;

228 
i
 = 
U2S_BUFSIZE
 - 1;

229 
s
[
i
] = '\0';

230 
ba£
) {

233 
i
--;

234 
s
[
i
] = "0123456789"[
x
 % (
ušt64_t
)10];

235 
x
 /ğ(
ušt64_t
)10;

236 } 
x
 > 0);

239 cÚ¡ *
dig™s
 = (
uµ”ÿ£
)

244 
i
--;

245 
s
[
i
] = 
dig™s
[
x
 & 0xf];

246 
x
 >>= 4;

247 } 
x
 > 0);

250 cÚ¡ *
dig™s
 = (
uµ”ÿ£
)

254 
	`as£¹
(
ba£
 >= 2 && base <= 36);

256 
i
--;

257 
s
[
i
] = 
dig™s
[
x
 % (
ušt64_t
)
ba£
];

258 
x
 /ğ(
ušt64_t
)
ba£
;

259 } 
x
 > 0);

262 *
¦’_p
 = 
U2S_BUFSIZE
 - 1 - 
i
;

263  (&
s
[
i
]);

264 
	}
}

267 
	$d2s
(
štmax_t
 
x
, 
sign
, *
s
, 
size_t
 *
¦’_p
)

269 
boŞ
 
Ãg
;

271 ià((
Ãg
 = (
x
 < 0)))

272 
x
 = -x;

273 
s
 = 
	`u2s
(
x
, 10, 
çl£
, s, 
¦’_p
);

274 ià(
Ãg
)

275 
sign
 = '-';

276 
sign
) {

278 ià(!
Ãg
)

283 
s
--;

284 (*
¦’_p
)++;

285 *
s
 = 
sign
;

287 : 
	`nÙ_»ached
();

289  (
s
);

290 
	}
}

293 
	$o2s
(
uštmax_t
 
x
, 
boŞ
 
®t_fÜm
, *
s
, 
size_t
 *
¦’_p
)

296 
s
 = 
	`u2s
(
x
, 8, 
çl£
, s, 
¦’_p
);

297 ià(
®t_fÜm
 && *
s
 != '0') {

298 
s
--;

299 (*
¦’_p
)++;

300 *
s
 = '0';

302  (
s
);

303 
	}
}

306 
	$x2s
(
uštmax_t
 
x
, 
boŞ
 
®t_fÜm
, boŞ 
uµ”ÿ£
, *
s
, 
size_t
 *
¦’_p
)

309 
s
 = 
	`u2s
(
x
, 16, 
uµ”ÿ£
, s, 
¦’_p
);

310 ià(
®t_fÜm
) {

311 
s
 -= 2;

312 (*
¦’_p
) += 2;

313 
	`memıy
(
s
, 
uµ”ÿ£
 ? "0X" : "0x", 2);

315  (
s
);

316 
	}
}

318 
size_t


319 
	$m®loc_v¢´štf
(*
¡r
, 
size_t
 
size
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
)

321 
size_t
 
i
;

322 cÚ¡ *
f
;

324 
	#APPEND_C
(
c
) do { \

325 ià(
i
 < 
size
) \

326 
¡r
[
i
] = (
c
); \

327 
i
++; \

328 } 0)

	)

329 
	#APPEND_S
(
s
, 
¦’
) do { \

330 ià(
i
 < 
size
) { \

331 
size_t
 
ıyËn
 = (
¦’
 <ğ
size
 - 
i
) ? slen : size - i; \

332 
	`memıy
(&
¡r
[
i
], 
s
, 
ıyËn
); \

334 
i
 +ğ
¦’
; \

335 } 0)

	)

336 
	#APPEND_PADDED_S
(
s
, 
¦’
, 
width
, 
Ëá_ju¡ify
) do { \

338 
size_t
 
·d_Ën
 = (
width
 =ğ-1è? 0 : ((
¦’
 < (size_t)width) ? \

339 (
size_t
)
width
 - 
¦’
 : 0); \

340 ià(!
Ëá_ju¡ify
 && 
·d_Ën
 != 0) { \

341 
size_t
 
j
; \

342 
j
 = 0; j < 
·d_Ën
; j++) \

343 
	`APPEND_C
(' '); \

346 
	`APPEND_S
(
s
, 
¦’
); \

348 ià(
Ëá_ju¡ify
 && 
·d_Ën
 != 0) { \

349 
size_t
 
j
; \

350 
j
 = 0; j < 
·d_Ën
; j++) \

351 
	`APPEND_C
(' '); \

353 } 0)

	)

354 
	#GET_ARG_NUMERIC
(
v®
, 
Ën
) do { \

355 
Ën
) { \

357 
v®
 = 
	`va_¬g
(
­
, ); \

360 
v®
 = 
	`va_¬g
(
­
, ); \

363 
v®
 = 
	`va_¬g
(
­
, ); \

366 
v®
 = 
	`va_¬g
(
­
, ); \

369 
v®
 = 
	`va_¬g
(
­
, ); \

372 
v®
 = 
	`va_¬g
(
­
, ); \

375 
v®
 = 
	`va_¬g
(
­
, 
štmax_t
); \

378 
v®
 = 
	`va_¬g
(
­
, 
uštmax_t
); \

381 
v®
 = 
	`va_¬g
(
­
, 
±rdiff_t
); \

384 
v®
 = 
	`va_¬g
(
­
, 
ssize_t
); \

387 
v®
 = 
	`va_¬g
(
­
, 
size_t
); \

390 
v®
 = 
	`va_¬g
(
­
, 
ušŒ_t
); \

393 
	`nÙ_»ached
(); \

394 
v®
 = 0; \

396 } 0)

	)

398 
i
 = 0;

399 
f
 = 
fÜm©
;

400 
Œue
) {

401 *
f
) {

402 '\0': 
Ïb–_out
;

404 
boŞ
 
®t_fÜm
 = 
çl£
;

405 
boŞ
 
Ëá_ju¡ify
 = 
çl£
;

406 
boŞ
 
¶us_¥aû
 = 
çl£
;

407 
boŞ
 
¶us_¶us
 = 
çl£
;

408 
´ec
 = -1;

409 
width
 = -1;

410 
Ën
 = '?';

411 *
s
;

412 
size_t
 
¦’
;

414 
f
++;

416 
Œue
) {

417 *
f
) {

419 
	`as£¹
(!
®t_fÜm
);

420 
®t_fÜm
 = 
Œue
;

423 
	`as£¹
(!
Ëá_ju¡ify
);

424 
Ëá_ju¡ify
 = 
Œue
;

427 
	`as£¹
(!
¶us_¥aû
);

428 
¶us_¥aû
 = 
Œue
;

431 
	`as£¹
(!
¶us_¶us
);

432 
¶us_¶us
 = 
Œue
;

434 : 
Ïb–_width
;

436 
f
++;

439 
Ïb–_width
:

440 *
f
) {

442 
width
 = 
	`va_¬g
(
­
, );

443 
f
++;

444 ià(
width
 < 0) {

445 
Ëá_ju¡ify
 = 
Œue
;

446 
width
 = -width;

451 
uštmax_t
 
uwidth
;

452 
	`£t_”ºo
(0);

453 
uwidth
 = 
	`m®loc_¡¹oumax
(
f
, (**)&f, 10);

454 
	`as£¹
(
uwidth
 !ğ
UINTMAX_MAX
 || 
	`g‘_”ºo
() !=

455 
ERANGE
);

456 
width
 = ()
uwidth
;

462 ià(*
f
 == '.')

463 
f
++;

465 
Ïb–_Ëngth
;

467 *
f
) {

469 
´ec
 = 
	`va_¬g
(
­
, );

470 
f
++;

474 
uštmax_t
 
u´ec
;

475 
	`£t_”ºo
(0);

476 
u´ec
 = 
	`m®loc_¡¹oumax
(
f
, (**)&f, 10);

477 
	`as£¹
(
u´ec
 !ğ
UINTMAX_MAX
 || 
	`g‘_”ºo
() !=

478 
ERANGE
);

479 
´ec
 = ()
u´ec
;

485 
Ïb–_Ëngth
:

486 *
f
) {

488 
f
++;

489 ià(*
f
 == 'l') {

490 
Ën
 = 'q';

491 
f
++;

493 
Ën
 = 'l';

496 
Ën
 = *
f
;

497 
f
++;

502 *
f
) {

505 
	`APPEND_C
(*
f
);

506 
f
++;

509 
štmax_t
 
v®
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

510 
buf
[
D2S_BUFSIZE
];

512 
	`GET_ARG_NUMERIC
(
v®
, 
Ën
);

513 
s
 = 
	`d2s
(
v®
, (
¶us_¶us
 ? '+' : (
¶us_¥aû
 ?

514 ' ' : '-')), 
buf
, &
¦’
);

515 
	`APPEND_PADDED_S
(
s
, 
¦’
, 
width
, 
Ëá_ju¡ify
);

516 
f
++;

519 
uštmax_t
 
v®
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

520 
buf
[
O2S_BUFSIZE
];

522 
	`GET_ARG_NUMERIC
(
v®
, 
Ën
 | 0x80);

523 
s
 = 
	`o2s
(
v®
, 
®t_fÜm
, 
buf
, &
¦’
);

524 
	`APPEND_PADDED_S
(
s
, 
¦’
, 
width
, 
Ëá_ju¡ify
);

525 
f
++;

528 
uštmax_t
 
v®
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

529 
buf
[
U2S_BUFSIZE
];

531 
	`GET_ARG_NUMERIC
(
v®
, 
Ën
 | 0x80);

532 
s
 = 
	`u2s
(
v®
, 10, 
çl£
, 
buf
, &
¦’
);

533 
	`APPEND_PADDED_S
(
s
, 
¦’
, 
width
, 
Ëá_ju¡ify
);

534 
f
++;

537 
uštmax_t
 
v®
 
	`JEMALLOC_CC_SILENCE_INIT
(0);

538 
buf
[
X2S_BUFSIZE
];

540 
	`GET_ARG_NUMERIC
(
v®
, 
Ën
 | 0x80);

541 
s
 = 
	`x2s
(
v®
, 
®t_fÜm
, *
f
 =ğ'X', 
buf
, &
¦’
);

542 
	`APPEND_PADDED_S
(
s
, 
¦’
, 
width
, 
Ëá_ju¡ify
);

543 
f
++;

546 
v®
;

547 
buf
[2];

549 
	`as£¹
(
Ën
 == '?' ||†en == 'l');

550 
	`as£¹_nÙ_im¶em’‹d
(
Ën
 != 'l');

551 
v®
 = 
	`va_¬g
(
­
, );

552 
buf
[0] = 
v®
;

553 
buf
[1] = '\0';

554 
	`APPEND_PADDED_S
(
buf
, 1, 
width
, 
Ëá_ju¡ify
);

555 
f
++;

558 
	`as£¹
(
Ën
 == '?' ||†en == 'l');

559 
	`as£¹_nÙ_im¶em’‹d
(
Ën
 != 'l');

560 
s
 = 
	`va_¬g
(
­
, *);

561 
¦’
 = (
´ec
 < 0è? 
	`¡¾’
(
s
è: (
size_t
)prec;

562 
	`APPEND_PADDED_S
(
s
, 
¦’
, 
width
, 
Ëá_ju¡ify
);

563 
f
++;

566 
uštmax_t
 
v®
;

567 
buf
[
X2S_BUFSIZE
];

569 
	`GET_ARG_NUMERIC
(
v®
, 'p');

570 
s
 = 
	`x2s
(
v®
, 
Œue
, 
çl£
, 
buf
, &
¦’
);

571 
	`APPEND_PADDED_S
(
s
, 
¦’
, 
width
, 
Ëá_ju¡ify
);

572 
f
++;

574 } : 
	`nÙ_»ached
();

578 
	`APPEND_C
(*
f
);

579 
f
++;

583 
Ïb–_out
:

584 ià(
i
 < 
size
)

585 
¡r
[
i
] = '\0';

587 
¡r
[
size
 - 1] = '\0';

589 #undeà
APPEND_C


590 #undeà
APPEND_S


591 #undeà
APPEND_PADDED_S


592 #undeà
GET_ARG_NUMERIC


593  (
i
);

594 
	}
}

596 
	$JEMALLOC_FORMAT_PRINTF
(3, 4)

597 
size_t


598 
	$m®loc_¢´štf
(*
¡r
, 
size_t
 
size
, cÚ¡ *
fÜm©
, ...)

600 
size_t
 
»t
;

601 
va_li¡
 
­
;

603 
	`va_¡¬t
(
­
, 
fÜm©
);

604 
»t
 = 
	`m®loc_v¢´štf
(
¡r
, 
size
, 
fÜm©
, 
­
);

605 
	`va_’d
(
­
);

607  (
»t
);

608 
	}
}

611 
	$m®loc_vırštf
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

612 cÚ¡ *
fÜm©
, 
va_li¡
 
­
)

614 
buf
[
MALLOC_PRINTF_BUFSIZE
];

616 ià(
wr™e_cb
 =ğ
NULL
) {

622 
wr™e_cb
 = (
je_m®loc_mes§ge
 !ğ
NULL
) ? je_malloc_message :

623 
w¹mes§ge
;

624 
cbİaque
 = 
NULL
;

627 
	`m®loc_v¢´štf
(
buf
, (buf), 
fÜm©
, 
­
);

628 
	`wr™e_cb
(
cbİaque
, 
buf
);

629 
	}
}

635 
	$JEMALLOC_FORMAT_PRINTF
(3, 4)

637 
	$m®loc_ırštf
((*
wr™e_cb
)(*, cÚ¡ *), *
cbİaque
,

638 cÚ¡ *
fÜm©
, ...)

640 
va_li¡
 
­
;

642 
	`va_¡¬t
(
­
, 
fÜm©
);

643 
	`m®loc_vırštf
(
wr™e_cb
, 
cbİaque
, 
fÜm©
, 
­
);

644 
	`va_’d
(
­
);

645 
	}
}

648 
	$JEMALLOC_FORMAT_PRINTF
(1, 2)

650 
	$m®loc_´štf
(cÚ¡ *
fÜm©
, ...)

652 
va_li¡
 
­
;

654 
	`va_¡¬t
(
­
, 
fÜm©
);

655 
	`m®loc_vırštf
(
NULL
, NULL, 
fÜm©
, 
­
);

656 
	`va_’d
(
­
);

657 
	}
}

663 #undeà
as£¹


664 #undeà
nÙ_»ached


665 #undeà
nÙ_im¶em’‹d


666 
	~"jem®loc/š‹º®/as£¹.h
"

	@deps/jemalloc/src/valgrind.c

1 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

2 #iâdeà
JEMALLOC_VALGRIND


6 
	~<v®gršd/memcheck.h
>

9 
	$v®gršd_make_mem_nßcûss
(*
±r
, 
size_t
 
usize
)

12 
	`VALGRIND_MAKE_MEM_NOACCESS
(
±r
, 
usize
);

13 
	}
}

16 
	$v®gršd_make_mem_undefšed
(*
±r
, 
size_t
 
usize
)

19 
	`VALGRIND_MAKE_MEM_UNDEFINED
(
±r
, 
usize
);

20 
	}
}

23 
	$v®gršd_make_mem_defšed
(*
±r
, 
size_t
 
usize
)

26 
	`VALGRIND_MAKE_MEM_DEFINED
(
±r
, 
usize
);

27 
	}
}

30 
	$v®gršd_ä“like_block
(*
±r
, 
size_t
 
usize
)

33 
	`VALGRIND_FREELIKE_BLOCK
(
±r
, 
usize
);

34 
	}
}

	@deps/jemalloc/src/witness.c

1 
	#JEMALLOC_WITNESS_C_


	)

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

5 
	$w™Ãss_š™
(
w™Ãss_t
 *
w™Ãss
, cÚ¡ *
Çme
, 
w™Ãss_¿nk_t
 
¿nk
,

6 
w™Ãss_comp_t
 *
comp
)

9 
w™Ãss
->
Çme
 =‚ame;

10 
w™Ãss
->
¿nk
 =„ank;

11 
w™Ãss
->
comp
 = comp;

12 
	}
}

14 #ifdeà
JEMALLOC_JET


15 #undeà
w™Ãss_lock_”rÜ


16 
	#w™Ãss_lock_”rÜ
 
	`JEMALLOC_N
(
n_w™Ãss_lock_”rÜ
)

	)

19 
	$w™Ãss_lock_”rÜ
(cÚ¡ 
w™Ãss_li¡_t
 *
w™Ãs£s
, cÚ¡ 
w™Ãss_t
 *
w™Ãss
)

21 
w™Ãss_t
 *
w
;

23 
	`m®loc_´štf
("<jemalloc>: Lock„ank order„eversal:");

24 
	`ql_fÜ—ch
(
w
, 
w™Ãs£s
, 
lšk
) {

25 
	`m®loc_´štf
(" %s(%u)", 
w
->
Çme
, w->
¿nk
);

27 
	`m®loc_´štf
(" %s(%u)\n", 
w™Ãss
->
Çme
, w™Ãss->
¿nk
);

28 
	`abÜt
();

29 
	}
}

30 #ifdeà
JEMALLOC_JET


31 #undeà
w™Ãss_lock_”rÜ


32 
	#w™Ãss_lock_”rÜ
 
	`JEMALLOC_N
(
w™Ãss_lock_”rÜ
)

	)

33 
w™Ãss_lock_”rÜ_t
 *
	gw™Ãss_lock_”rÜ
 = 
JEMALLOC_N
(
n_w™Ãss_lock_”rÜ
);

36 #ifdeà
JEMALLOC_JET


37 #undeà
w™Ãss_owÃr_”rÜ


38 
	#w™Ãss_owÃr_”rÜ
 
	`JEMALLOC_N
(
n_w™Ãss_owÃr_”rÜ
)

	)

41 
	$w™Ãss_owÃr_”rÜ
(cÚ¡ 
w™Ãss_t
 *
w™Ãss
)

44 
	`m®loc_´štf
("<jem®loc>: Should owÀ%s(%u)\n", 
w™Ãss
->
Çme
,

45 
w™Ãss
->
¿nk
);

46 
	`abÜt
();

47 
	}
}

48 #ifdeà
JEMALLOC_JET


49 #undeà
w™Ãss_owÃr_”rÜ


50 
	#w™Ãss_owÃr_”rÜ
 
	`JEMALLOC_N
(
w™Ãss_owÃr_”rÜ
)

	)

51 
w™Ãss_owÃr_”rÜ_t
 *
	gw™Ãss_owÃr_”rÜ
 = 
JEMALLOC_N
(
n_w™Ãss_owÃr_”rÜ
);

54 #ifdeà
JEMALLOC_JET


55 #undeà
w™Ãss_nÙ_owÃr_”rÜ


56 
	#w™Ãss_nÙ_owÃr_”rÜ
 
	`JEMALLOC_N
(
n_w™Ãss_nÙ_owÃr_”rÜ
)

	)

59 
	$w™Ãss_nÙ_owÃr_”rÜ
(cÚ¡ 
w™Ãss_t
 *
w™Ãss
)

62 
	`m®loc_´štf
("<jem®loc>: Should‚Ù owÀ%s(%u)\n", 
w™Ãss
->
Çme
,

63 
w™Ãss
->
¿nk
);

64 
	`abÜt
();

65 
	}
}

66 #ifdeà
JEMALLOC_JET


67 #undeà
w™Ãss_nÙ_owÃr_”rÜ


68 
	#w™Ãss_nÙ_owÃr_”rÜ
 
	`JEMALLOC_N
(
w™Ãss_nÙ_owÃr_”rÜ
)

	)

69 
w™Ãss_nÙ_owÃr_”rÜ_t
 *
	gw™Ãss_nÙ_owÃr_”rÜ
 =

70 
JEMALLOC_N
(
n_w™Ãss_nÙ_owÃr_”rÜ
);

73 #ifdeà
JEMALLOC_JET


74 #undeà
w™Ãss_lockËss_”rÜ


75 
	#w™Ãss_lockËss_”rÜ
 
	`JEMALLOC_N
(
n_w™Ãss_lockËss_”rÜ
)

	)

78 
	$w™Ãss_lockËss_”rÜ
(cÚ¡ 
w™Ãss_li¡_t
 *
w™Ãs£s
)

80 
w™Ãss_t
 *
w
;

82 
	`m®loc_´štf
("<jemalloc>: Should‚ot own‡ny†ocks:");

83 
	`ql_fÜ—ch
(
w
, 
w™Ãs£s
, 
lšk
) {

84 
	`m®loc_´štf
(" %s(%u)", 
w
->
Çme
, w->
¿nk
);

86 
	`m®loc_´štf
("\n");

87 
	`abÜt
();

88 
	}
}

89 #ifdeà
JEMALLOC_JET


90 #undeà
w™Ãss_lockËss_”rÜ


91 
	#w™Ãss_lockËss_”rÜ
 
	`JEMALLOC_N
(
w™Ãss_lockËss_”rÜ
)

	)

92 
w™Ãss_lockËss_”rÜ_t
 *
	gw™Ãss_lockËss_”rÜ
 =

93 
JEMALLOC_N
(
n_w™Ãss_lockËss_”rÜ
);

97 
	$w™Ãs£s_ş—nup
(
tsd_t
 *
tsd
)

100 
	`w™Ãss_as£¹_lockËss
(
	`tsd_tsdn
(
tsd
));

103 
	}
}

106 
	$w™Ãss_fÜk_ş—nup
(
tsd_t
 *
tsd
)

110 
	}
}

113 
	$w™Ãss_´efÜk
(
tsd_t
 *
tsd
)

116 
	`tsd_w™Ãss_fÜk_£t
(
tsd
, 
Œue
);

117 
	}
}

120 
	$w™Ãss_po¡fÜk_·»Á
(
tsd_t
 *
tsd
)

123 
	`tsd_w™Ãss_fÜk_£t
(
tsd
, 
çl£
);

124 
	}
}

127 
	$w™Ãss_po¡fÜk_chd
(
tsd_t
 *
tsd
)

129 #iâdeà
JEMALLOC_MUTEX_INIT_CB


130 
w™Ãss_li¡_t
 *
w™Ãs£s
;

132 
w™Ãs£s
 = 
	`tsd_w™Ãs£¥_g‘
(
tsd
);

133 
	`ql_Ãw
(
w™Ãs£s
);

135 
	`tsd_w™Ãss_fÜk_£t
(
tsd
, 
çl£
);

136 
	}
}

	@deps/jemalloc/src/zone.c

1 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

2 #iâdeà
JEMALLOC_ZONE


10 
m®loc_zÚe_t
 *
	$m®loc_deçuÉ_purg—bË_zÚe
()

11 
	`JEMALLOC_ATTR
(
w—k_impÜt
);

16 
m®loc_zÚe_t
 *
deçuÉ_zÚe
, *
purg—bË_zÚe
;

17 
m®loc_zÚe_t
 
jem®loc_zÚe
;

18 
m®loc_šŒo¥eùiÚ_t
 
jem®loc_zÚe_šŒo¥eù
;

23 
size_t
 
	`zÚe_size
(
m®loc_zÚe_t
 *
zÚe
, *
±r
);

24 *
	`zÚe_m®loc
(
m®loc_zÚe_t
 *
zÚe
, 
size_t
 
size
);

25 *
	`zÚe_ÿÎoc
(
m®loc_zÚe_t
 *
zÚe
, 
size_t
 
num
, size_ˆ
size
);

26 *
	`zÚe_v®loc
(
m®loc_zÚe_t
 *
zÚe
, 
size_t
 
size
);

27 
	`zÚe_ä“
(
m®loc_zÚe_t
 *
zÚe
, *
±r
);

28 *
	`zÚe_»®loc
(
m®loc_zÚe_t
 *
zÚe
, *
±r
, 
size_t
 
size
);

29 #ià(
JEMALLOC_ZONE_VERSION
 >= 5)

30 *
	`zÚe_mem®ign
(
m®loc_zÚe_t
 *
zÚe
, 
size_t
 
®ignm’t
,

32 #ià(
JEMALLOC_ZONE_VERSION
 >= 6)

33 
size_t
 
size
);

34 
	`zÚe_ä“_defš™e_size
(
m®loc_zÚe_t
 *
zÚe
, *
±r
,

35 
size_t
 
size
);

37 *
	`zÚe_de¡roy
(
m®loc_zÚe_t
 *
zÚe
);

38 
size_t
 
	`zÚe_good_size
(
m®loc_zÚe_t
 *
zÚe
, size_ˆ
size
);

39 
	`zÚe_fÜû_lock
(
m®loc_zÚe_t
 *
zÚe
);

40 
	`zÚe_fÜû_uÆock
(
m®loc_zÚe_t
 *
zÚe
);

47 
size_t


48 
	$zÚe_size
(
m®loc_zÚe_t
 *
zÚe
, *
±r
)

60  (
	`iv§Îoc
(
	`tsdn_ãtch
(), 
±r
, 
cÚfig_´of
));

61 
	}
}

64 
	$zÚe_m®loc
(
m®loc_zÚe_t
 *
zÚe
, 
size_t
 
size
)

67  (
	`je_m®loc
(
size
));

68 
	}
}

71 
	$zÚe_ÿÎoc
(
m®loc_zÚe_t
 *
zÚe
, 
size_t
 
num
, size_ˆ
size
)

74  (
	`je_ÿÎoc
(
num
, 
size
));

75 
	}
}

78 
	$zÚe_v®loc
(
m®loc_zÚe_t
 *
zÚe
, 
size_t
 
size
)

80 *
»t
 = 
NULL
;

82 
	`je_posix_mem®ign
(&
»t
, 
PAGE
, 
size
);

84  (
»t
);

85 
	}
}

88 
	$zÚe_ä“
(
m®loc_zÚe_t
 *
zÚe
, *
±r
)

91 ià(
	`iv§Îoc
(
	`tsdn_ãtch
(), 
±r
, 
cÚfig_´of
) != 0) {

92 
	`je_ä“
(
±r
);

96 
	`ä“
(
±r
);

97 
	}
}

100 
	$zÚe_»®loc
(
m®loc_zÚe_t
 *
zÚe
, *
±r
, 
size_t
 
size
)

103 ià(
	`iv§Îoc
(
	`tsdn_ãtch
(), 
±r
, 
cÚfig_´of
) != 0)

104  (
	`je_»®loc
(
±r
, 
size
));

106  (
	`»®loc
(
±r
, 
size
));

107 
	}
}

109 #ià(
JEMALLOC_ZONE_VERSION
 >= 5)

111 
	$zÚe_mem®ign
(
m®loc_zÚe_t
 *
zÚe
, 
size_t
 
®ignm’t
, size_ˆ
size
)

113 *
»t
 = 
NULL
;

115 
	`je_posix_mem®ign
(&
»t
, 
®ignm’t
, 
size
);

117  (
»t
);

118 
	}
}

121 #ià(
JEMALLOC_ZONE_VERSION
 >= 6)

123 
	$zÚe_ä“_defš™e_size
(
m®loc_zÚe_t
 *
zÚe
, *
±r
, 
size_t
 
size
)

125 
size_t
 
®loc_size
;

127 
®loc_size
 = 
	`iv§Îoc
(
	`tsdn_ãtch
(), 
±r
, 
cÚfig_´of
);

128 ià(
®loc_size
 != 0) {

129 
	`as£¹
(
®loc_size
 =ğ
size
);

130 
	`je_ä“
(
±r
);

134 
	`ä“
(
±r
);

135 
	}
}

139 
	$zÚe_de¡roy
(
m®loc_zÚe_t
 *
zÚe
)

143 
	`nÙ_»ached
();

144  (
NULL
);

145 
	}
}

147 
size_t


148 
	$zÚe_good_size
(
m®loc_zÚe_t
 *
zÚe
, 
size_t
 
size
)

151 ià(
size
 == 0)

152 
size
 = 1;

153  (
	`s2u
(
size
));

154 
	}
}

157 
	$zÚe_fÜû_lock
(
m®loc_zÚe_t
 *
zÚe
)

160 ià(
i¡h»aded
)

161 
	`jem®loc_´efÜk
();

162 
	}
}

165 
	$zÚe_fÜû_uÆock
(
m®loc_zÚe_t
 *
zÚe
)

175 ià(
i¡h»aded
)

176 
	`jem®loc_po¡fÜk_chd
();

177 
	}
}

180 
	$zÚe_š™
()

183 
jem®loc_zÚe
.
size
 = (*)
zÚe_size
;

184 
jem®loc_zÚe
.
m®loc
 = (*)
zÚe_m®loc
;

185 
jem®loc_zÚe
.
ÿÎoc
 = (*)
zÚe_ÿÎoc
;

186 
jem®loc_zÚe
.
v®loc
 = (*)
zÚe_v®loc
;

187 
jem®loc_zÚe
.
ä“
 = (*)
zÚe_ä“
;

188 
jem®loc_zÚe
.
»®loc
 = (*)
zÚe_»®loc
;

189 
jem®loc_zÚe
.
de¡roy
 = (*)
zÚe_de¡roy
;

190 
jem®loc_zÚe
.
zÚe_Çme
 = "jemalloc_zone";

191 
jem®loc_zÚe
.
b©ch_m®loc
 = 
NULL
;

192 
jem®loc_zÚe
.
b©ch_ä“
 = 
NULL
;

193 
jem®loc_zÚe
.
šŒo¥eù
 = &
jem®loc_zÚe_šŒo¥eù
;

194 
jem®loc_zÚe
.
v”siÚ
 = 
JEMALLOC_ZONE_VERSION
;

195 #ià(
JEMALLOC_ZONE_VERSION
 >= 5)

196 
jem®loc_zÚe
.
mem®ign
 = 
zÚe_mem®ign
;

198 #ià(
JEMALLOC_ZONE_VERSION
 >= 6)

199 
jem®loc_zÚe
.
ä“_defš™e_size
 = 
zÚe_ä“_defš™e_size
;

201 #ià(
JEMALLOC_ZONE_VERSION
 >= 8)

202 
jem®loc_zÚe
.
´essu»_»l›f
 = 
NULL
;

205 
jem®loc_zÚe_šŒo¥eù
.
’um”©Ü
 = 
NULL
;

206 
jem®loc_zÚe_šŒo¥eù
.
good_size
 = (*)
zÚe_good_size
;

207 
jem®loc_zÚe_šŒo¥eù
.
check
 = 
NULL
;

208 
jem®loc_zÚe_šŒo¥eù
.
´št
 = 
NULL
;

209 
jem®loc_zÚe_šŒo¥eù
.
log
 = 
NULL
;

210 
jem®loc_zÚe_šŒo¥eù
.
fÜû_lock
 = (*)
zÚe_fÜû_lock
;

211 
jem®loc_zÚe_šŒo¥eù
.
fÜû_uÆock
 = (*)
zÚe_fÜû_uÆock
;

212 
jem®loc_zÚe_šŒo¥eù
.
¡©i¡ics
 = 
NULL
;

213 #ià(
JEMALLOC_ZONE_VERSION
 >= 6)

214 
jem®loc_zÚe_šŒo¥eù
.
zÚe_locked
 = 
NULL
;

216 #ià(
JEMALLOC_ZONE_VERSION
 >= 7)

217 
jem®loc_zÚe_šŒo¥eù
.
’abË_disch¬ge_checkšg
 = 
NULL
;

218 
jem®loc_zÚe_šŒo¥eù
.
di§bË_disch¬ge_checkšg
 = 
NULL
;

219 
jem®loc_zÚe_šŒo¥eù
.
disch¬ge
 = 
NULL
;

220 #ifdeà
__BLOCKS__


221 
jem®loc_zÚe_šŒo¥eù
.
’um”©e_disch¬ged_poš‹rs
 = 
NULL
;

223 
jem®loc_zÚe_šŒo¥eù
.
’um”©e_uÇvaabË_w™hout_blocks
 = 
NULL
;

226 
	}
}

228 
m®loc_zÚe_t
 *

229 
	$zÚe_deçuÉ_g‘
()

231 
m®loc_zÚe_t
 **
zÚes
 = 
NULL
;

232 
num_zÚes
 = 0;

243 ià(
KERN_SUCCESS
 !ğ
	`m®loc_g‘_®l_zÚes
(0, 
NULL
,

244 (
vm_add»ss_t
**)&
zÚes
, &
num_zÚes
)) {

249 
num_zÚes
 = 0;

252 ià(
num_zÚes
)

253  (
zÚes
[0]);

255  (
	`m®loc_deçuÉ_zÚe
());

256 
	}
}

260 
	$zÚe_´omÙe
()

262 
m®loc_zÚe_t
 *
zÚe
;

273 
	`m®loc_zÚe_uÄegi¡”
(
deçuÉ_zÚe
);

274 
	`m®loc_zÚe_»gi¡”
(
deçuÉ_zÚe
);

287 ià(
purg—bË_zÚe
 !ğ
NULL
) {

288 
	`m®loc_zÚe_uÄegi¡”
(
purg—bË_zÚe
);

289 
	`m®loc_zÚe_»gi¡”
(
purg—bË_zÚe
);

292 
zÚe
 = 
	`zÚe_deçuÉ_g‘
();

293 } 
zÚe
 !ğ&
jem®loc_zÚe
);

294 
	}
}

296 
	$JEMALLOC_ATTR
(
cÚ¡ruùÜ
)

298 
	$zÚe_»gi¡”
()

305 
deçuÉ_zÚe
 = 
	`zÚe_deçuÉ_g‘
();

306 ià(!
deçuÉ_zÚe
->
zÚe_Çme
 || 
	`¡rcmp
(default_zone->zone_name,

321 
purg—bË_zÚe
 = (
m®loc_deçuÉ_purg—bË_zÚe
 =ğ
NULL
) ? NULL :

322 
	`m®loc_deçuÉ_purg—bË_zÚe
();

325 
	`zÚe_š™
();

326 
	`m®loc_zÚe_»gi¡”
(&
jem®loc_zÚe
);

329 
	`zÚe_´omÙe
();

330 
	}
}

	@deps/jemalloc/test/include/test/SFMT-alti.h

52 #iâdeà
SFMT_ALTI_H


53 
	#SFMT_ALTI_H


	)

63 
JEMALLOC_ALWAYS_INLINE


64 
veùÜ
 
	$vec_»cursiÚ
(
veùÜ
 
a
,

65 
veùÜ
 
b
,

66 
veùÜ
 
c
,

67 
veùÜ
 
d
) {

69 cÚ¡ 
veùÜ
 
¦1
 = 
ALTI_SL1
;

70 cÚ¡ 
veùÜ
 
¤1
 = 
ALTI_SR1
;

71 #ifdeà
ONLY64


72 cÚ¡ 
veùÜ
 
mask
 = 
ALTI_MSK64
;

73 cÚ¡ 
veùÜ
 
³rm_¦
 = 
ALTI_SL2_PERM64
;

74 cÚ¡ 
veùÜ
 
³rm_¤
 = 
ALTI_SR2_PERM64
;

76 cÚ¡ 
veùÜ
 
mask
 = 
ALTI_MSK
;

77 cÚ¡ 
veùÜ
 
³rm_¦
 = 
ALTI_SL2_PERM
;

78 cÚ¡ 
veùÜ
 
³rm_¤
 = 
ALTI_SR2_PERM
;

80 
veùÜ
 
v
, 
w
, 
x
, 
y
, 
z
;

81 
x
 = 
	`vec_³rm
(
a
, (
veùÜ
 )
³rm_¦
,…erm_sl);

82 
v
 = 
a
;

83 
y
 = 
	`vec_¤
(
b
, 
¤1
);

84 
z
 = 
	`vec_³rm
(
c
, (
veùÜ
 )
³rm_¤
,…erm_sr);

85 
w
 = 
	`vec_¦
(
d
, 
¦1
);

86 
z
 = 
	`vec_xÜ
(z, 
w
);

87 
y
 = 
	`vec_ªd
(y, 
mask
);

88 
v
 = 
	`vec_xÜ
(v, 
x
);

89 
z
 = 
	`vec_xÜ
(z, 
y
);

90 
z
 = 
	`vec_xÜ
(z, 
v
);

91  
z
;

92 
	}
}

98 
JEMALLOC_INLINE
 
	$g’_¿nd_®l
(
sfmt_t
 *
ùx
) {

99 
i
;

100 
veùÜ
 
r
, 
r1
, 
r2
;

102 
r1
 = 
ùx
->
sfmt
[
N
 - 2].
s
;

103 
r2
 = 
ùx
->
sfmt
[
N
 - 1].
s
;

104 
i
 = 0; i < 
N
 - 
POS1
; i++) {

105 
r
 = 
	`vec_»cursiÚ
(
ùx
->
sfmt
[
i
].
s
, ctx->sfmt[˜+ 
POS1
].s, 
r1
, 
r2
);

106 
ùx
->
sfmt
[
i
].
s
 = 
r
;

107 
r1
 = 
r2
;

108 
r2
 = 
r
;

110 ; 
i
 < 
N
; i++) {

111 
r
 = 
	`vec_»cursiÚ
(
ùx
->
sfmt
[
i
].
s
, ctx->sfmt[˜+ 
POS1
 - 
N
].s, 
r1
, 
r2
);

112 
ùx
->
sfmt
[
i
].
s
 = 
r
;

113 
r1
 = 
r2
;

114 
r2
 = 
r
;

116 
	}
}

125 
JEMALLOC_INLINE
 
	$g’_¿nd_¬¿y
(
sfmt_t
 *
ùx
, 
w128_t
 *
¬¿y
, 
size
) {

126 
i
, 
j
;

127 
veùÜ
 
r
, 
r1
, 
r2
;

129 
r1
 = 
ùx
->
sfmt
[
N
 - 2].
s
;

130 
r2
 = 
ùx
->
sfmt
[
N
 - 1].
s
;

131 
i
 = 0; i < 
N
 - 
POS1
; i++) {

132 
r
 = 
	`vec_»cursiÚ
(
ùx
->
sfmt
[
i
].
s
, ctx->sfmt[˜+ 
POS1
].s, 
r1
, 
r2
);

133 
¬¿y
[
i
].
s
 = 
r
;

134 
r1
 = 
r2
;

135 
r2
 = 
r
;

137 ; 
i
 < 
N
; i++) {

138 
r
 = 
	`vec_»cursiÚ
(
ùx
->
sfmt
[
i
].
s
, 
¬¿y
[˜+ 
POS1
 - 
N
].s, 
r1
, 
r2
);

139 
¬¿y
[
i
].
s
 = 
r
;

140 
r1
 = 
r2
;

141 
r2
 = 
r
;

144 ; 
i
 < 
size
 - 
N
; i++) {

145 
r
 = 
	`vec_»cursiÚ
(
¬¿y
[
i
 - 
N
].
s
,‡¼ay[˜+ 
POS1
 - N].s, 
r1
, 
r2
);

146 
¬¿y
[
i
].
s
 = 
r
;

147 
r1
 = 
r2
;

148 
r2
 = 
r
;

150 
j
 = 0; j < 2 * 
N
 - 
size
; j++) {

151 
ùx
->
sfmt
[
j
].
s
 = 
¬¿y
[j + 
size
 - 
N
].s;

153 ; 
i
 < 
size
; i++) {

154 
r
 = 
	`vec_»cursiÚ
(
¬¿y
[
i
 - 
N
].
s
,‡¼ay[˜+ 
POS1
 - N].s, 
r1
, 
r2
);

155 
¬¿y
[
i
].
s
 = 
r
;

156 
ùx
->
sfmt
[
j
++].
s
 = 
r
;

157 
r1
 = 
r2
;

158 
r2
 = 
r
;

160 
	}
}

162 #iâdeà
ONLY64


163 #ià
defšed
(
__APPLE__
)

164 
	#ALTI_SWAP
 (
veùÜ
 ) \

165 (4, 5, 6, 7, 0, 1, 2, 3, 12, 13, 14, 15, 8, 9, 10, 11)

	)

167 
	#ALTI_SWAP
 {4, 5, 6, 7, 0, 1, 2, 3, 12, 13, 14, 15, 8, 9, 10, 11}

	)

176 
JEMALLOC_INLINE
 
	$sw­
(
w128_t
 *
¬¿y
, 
size
) {

177 
i
;

178 cÚ¡ 
veùÜ
 
³rm
 = 
ALTI_SWAP
;

180 
i
 = 0; i < 
size
; i++) {

181 
¬¿y
[
i
].
s
 = 
	`vec_³rm
×¼ay[i].s, (
veùÜ
 )
³rm
,…erm);

183 
	}
}

	@deps/jemalloc/test/include/test/SFMT-params.h

36 #iâdeà
SFMT_PARAMS_H


37 
	#SFMT_PARAMS_H


	)

39 #ià!
defšed
(
MEXP
)

40 #ifdeà
__GNUC__


43 
	#MEXP
 19937

	)

53 
	#N
 (
MEXP
 / 128 + 1)

	)

56 
	#N32
 (
N
 * 4)

	)

59 
	#N64
 (
N
 * 2)

	)

102 #ià
MEXP
 == 607

103 
	~"‹¡/SFMT-·¿ms607.h
"

104 #–ià
MEXP
 == 1279

105 
	~"‹¡/SFMT-·¿ms1279.h
"

106 #–ià
MEXP
 == 2281

107 
	~"‹¡/SFMT-·¿ms2281.h
"

108 #–ià
MEXP
 == 4253

109 
	~"‹¡/SFMT-·¿ms4253.h
"

110 #–ià
MEXP
 == 11213

111 
	~"‹¡/SFMT-·¿ms11213.h
"

112 #–ià
MEXP
 == 19937

113 
	~"‹¡/SFMT-·¿ms19937.h
"

114 #–ià
MEXP
 == 44497

115 
	~"‹¡/SFMT-·¿ms44497.h
"

116 #–ià
MEXP
 == 86243

117 
	~"‹¡/SFMT-·¿ms86243.h
"

118 #–ià
MEXP
 == 132049

119 
	~"‹¡/SFMT-·¿ms132049.h
"

120 #–ià
MEXP
 == 216091

121 
	~"‹¡/SFMT-·¿ms216091.h
"

123 #ifdeà
__GNUC__


125 #undeà
MEXP


127 #undeà
MEXP


	@deps/jemalloc/test/include/test/SFMT-params11213.h

36 #iâdeà
SFMT_PARAMS11213_H


37 
	#SFMT_PARAMS11213_H


	)

39 
	#POS1
 68

	)

40 
	#SL1
 14

	)

41 
	#SL2
 3

	)

42 
	#SR1
 7

	)

43 
	#SR2
 3

	)

44 
	#MSK1
 0xeffff7fbU

	)

45 
	#MSK2
 0xfffffãfU

	)

46 
	#MSK3
 0xdfdfbfffU

	)

47 
	#MSK4
 0x7fffdbfdU

	)

48 
	#PARITY1
 0x00000001U

	)

49 
	#PARITY2
 0x00000000U

	)

50 
	#PARITY3
 0xe8148000U

	)

51 
	#PARITY4
 0xd0c7aç3U

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(5,6,7,0,9,10,11,4,13,14,15,8,19,19,19,12)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(13,14,15,0,1,2,3,4,19,19,19,8,9,10,11,12)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10}

	)

75 
	#ALTI_SL2_PERM64
 {3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2}

	)

76 
	#ALTI_SR2_PERM
 {5,6,7,0,9,10,11,4,13,14,15,8,19,19,19,12}

	)

77 
	#ALTI_SR2_PERM64
 {13,14,15,0,1,2,3,4,19,19,19,8,9,10,11,12}

	)

79 
	#IDSTR
 "SFMT-11213:68-14-3-7-3:effff7fb-fffffãf-dfdfbfff-7fffdbfd"

	)

	@deps/jemalloc/test/include/test/SFMT-params1279.h

36 #iâdeà
SFMT_PARAMS1279_H


37 
	#SFMT_PARAMS1279_H


	)

39 
	#POS1
 7

	)

40 
	#SL1
 14

	)

41 
	#SL2
 3

	)

42 
	#SR1
 5

	)

43 
	#SR2
 1

	)

44 
	#MSK1
 0xf7ãfffdU

	)

45 
	#MSK2
 0x7ãfcfffU

	)

46 
	#MSK3
 0xaff3ef3fU

	)

47 
	#MSK4
 0xb5ffff7fU

	)

48 
	#PARITY1
 0x00000001U

	)

49 
	#PARITY2
 0x00000000U

	)

50 
	#PARITY3
 0x00000000U

	)

51 
	#PARITY4
 0x20000000U

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10}

	)

75 
	#ALTI_SL2_PERM64
 {3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2}

	)

76 
	#ALTI_SR2_PERM
 {7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14}

	)

77 
	#ALTI_SR2_PERM64
 {15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14}

	)

79 
	#IDSTR
 "SFMT-1279:7-14-3-5-1:f7ãfffd-7ãfcfff-aff3ef3f-b5ffff7f"

	)

	@deps/jemalloc/test/include/test/SFMT-params132049.h

36 #iâdeà
SFMT_PARAMS132049_H


37 
	#SFMT_PARAMS132049_H


	)

39 
	#POS1
 110

	)

40 
	#SL1
 19

	)

41 
	#SL2
 1

	)

42 
	#SR1
 21

	)

43 
	#SR2
 1

	)

44 
	#MSK1
 0xffffbb5fU

	)

45 
	#MSK2
 0xfb6ebf95U

	)

46 
	#MSK3
 0xffãffçU

	)

47 
	#MSK4
 0xcff77fffU

	)

48 
	#PARITY1
 0x00000001U

	)

49 
	#PARITY2
 0x00000000U

	)

50 
	#PARITY3
 0xcb520000U

	)

51 
	#PARITY4
 0xc7e91c7dU

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(1,2,3,23,5,6,7,0,9,10,11,4,13,14,15,8)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(1,2,3,4,5,6,7,31,9,10,11,12,13,14,15,0)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {1,2,3,23,5,6,7,0,9,10,11,4,13,14,15,8}

	)

75 
	#ALTI_SL2_PERM64
 {1,2,3,4,5,6,7,31,9,10,11,12,13,14,15,0}

	)

76 
	#ALTI_SR2_PERM
 {7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14}

	)

77 
	#ALTI_SR2_PERM64
 {15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14}

	)

79 
	#IDSTR
 "SFMT-132049:110-19-1-21-1:ffffbb5f-fb6ebf95-ffãffç-cff77fff"

	)

	@deps/jemalloc/test/include/test/SFMT-params19937.h

36 #iâdeà
SFMT_PARAMS19937_H


37 
	#SFMT_PARAMS19937_H


	)

39 
	#POS1
 122

	)

40 
	#SL1
 18

	)

41 
	#SL2
 1

	)

42 
	#SR1
 11

	)

43 
	#SR2
 1

	)

44 
	#MSK1
 0xdffffãfU

	)

45 
	#MSK2
 0xddãcb7fU

	)

46 
	#MSK3
 0xbfçffffU

	)

47 
	#MSK4
 0xbffffff6U

	)

48 
	#PARITY1
 0x00000001U

	)

49 
	#PARITY2
 0x00000000U

	)

50 
	#PARITY3
 0x00000000U

	)

51 
	#PARITY4
 0x13c9e684U

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(1,2,3,23,5,6,7,0,9,10,11,4,13,14,15,8)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(1,2,3,4,5,6,7,31,9,10,11,12,13,14,15,0)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {1,2,3,23,5,6,7,0,9,10,11,4,13,14,15,8}

	)

75 
	#ALTI_SL2_PERM64
 {1,2,3,4,5,6,7,31,9,10,11,12,13,14,15,0}

	)

76 
	#ALTI_SR2_PERM
 {7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14}

	)

77 
	#ALTI_SR2_PERM64
 {15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14}

	)

79 
	#IDSTR
 "SFMT-19937:122-18-1-11-1:dffffãf-ddãcb7f-bfçffff-bffffff6"

	)

	@deps/jemalloc/test/include/test/SFMT-params216091.h

36 #iâdeà
SFMT_PARAMS216091_H


37 
	#SFMT_PARAMS216091_H


	)

39 
	#POS1
 627

	)

40 
	#SL1
 11

	)

41 
	#SL2
 3

	)

42 
	#SR1
 10

	)

43 
	#SR2
 1

	)

44 
	#MSK1
 0xbff7bff7U

	)

45 
	#MSK2
 0xbfffffffU

	)

46 
	#MSK3
 0xbfffç7fU

	)

47 
	#MSK4
 0xffddfbfbU

	)

48 
	#PARITY1
 0xf8000001U

	)

49 
	#PARITY2
 0x89e80709U

	)

50 
	#PARITY3
 0x3bd2b64bU

	)

51 
	#PARITY4
 0x0c64b1e4U

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10}

	)

75 
	#ALTI_SL2_PERM64
 {3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2}

	)

76 
	#ALTI_SR2_PERM
 {7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14}

	)

77 
	#ALTI_SR2_PERM64
 {15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14}

	)

79 
	#IDSTR
 "SFMT-216091:627-11-3-10-1:bff7bff7-bfffffff-bfffç7f-ffddfbfb"

	)

	@deps/jemalloc/test/include/test/SFMT-params2281.h

36 #iâdeà
SFMT_PARAMS2281_H


37 
	#SFMT_PARAMS2281_H


	)

39 
	#POS1
 12

	)

40 
	#SL1
 19

	)

41 
	#SL2
 1

	)

42 
	#SR1
 5

	)

43 
	#SR2
 1

	)

44 
	#MSK1
 0xbff7ffbfU

	)

45 
	#MSK2
 0xfdffffãU

	)

46 
	#MSK3
 0xf7fãf7fU

	)

47 
	#MSK4
 0xf2f7cbbfU

	)

48 
	#PARITY1
 0x00000001U

	)

49 
	#PARITY2
 0x00000000U

	)

50 
	#PARITY3
 0x00000000U

	)

51 
	#PARITY4
 0x41dç600U

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(1,2,3,23,5,6,7,0,9,10,11,4,13,14,15,8)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(1,2,3,4,5,6,7,31,9,10,11,12,13,14,15,0)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {1,2,3,23,5,6,7,0,9,10,11,4,13,14,15,8}

	)

75 
	#ALTI_SL2_PERM64
 {1,2,3,4,5,6,7,31,9,10,11,12,13,14,15,0}

	)

76 
	#ALTI_SR2_PERM
 {7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14}

	)

77 
	#ALTI_SR2_PERM64
 {15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14}

	)

79 
	#IDSTR
 "SFMT-2281:12-19-1-5-1:bff7ffbf-fdffffã-f7fãf7f-f2f7cbbf"

	)

	@deps/jemalloc/test/include/test/SFMT-params4253.h

36 #iâdeà
SFMT_PARAMS4253_H


37 
	#SFMT_PARAMS4253_H


	)

39 
	#POS1
 17

	)

40 
	#SL1
 20

	)

41 
	#SL2
 1

	)

42 
	#SR1
 7

	)

43 
	#SR2
 1

	)

44 
	#MSK1
 0x9f7bffffU

	)

45 
	#MSK2
 0x9fffff5fU

	)

46 
	#MSK3
 0x3efffffbU

	)

47 
	#MSK4
 0xfffff7bbU

	)

48 
	#PARITY1
 0xa8000001U

	)

49 
	#PARITY2
 0xaf5390a3U

	)

50 
	#PARITY3
 0xb740b3f8U

	)

51 
	#PARITY4
 0x6c11486dU

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(1,2,3,23,5,6,7,0,9,10,11,4,13,14,15,8)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(1,2,3,4,5,6,7,31,9,10,11,12,13,14,15,0)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {1,2,3,23,5,6,7,0,9,10,11,4,13,14,15,8}

	)

75 
	#ALTI_SL2_PERM64
 {1,2,3,4,5,6,7,31,9,10,11,12,13,14,15,0}

	)

76 
	#ALTI_SR2_PERM
 {7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14}

	)

77 
	#ALTI_SR2_PERM64
 {15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14}

	)

79 
	#IDSTR
 "SFMT-4253:17-20-1-7-1:9f7bffff-9fffff5f-3efffffb-fffff7bb"

	)

	@deps/jemalloc/test/include/test/SFMT-params44497.h

36 #iâdeà
SFMT_PARAMS44497_H


37 
	#SFMT_PARAMS44497_H


	)

39 
	#POS1
 330

	)

40 
	#SL1
 5

	)

41 
	#SL2
 3

	)

42 
	#SR1
 9

	)

43 
	#SR2
 3

	)

44 
	#MSK1
 0xeffffffbU

	)

45 
	#MSK2
 0xdfbebfffU

	)

46 
	#MSK3
 0xbfbf7befU

	)

47 
	#MSK4
 0x9ffd7bffU

	)

48 
	#PARITY1
 0x00000001U

	)

49 
	#PARITY2
 0x00000000U

	)

50 
	#PARITY3
 0xa3ac4000U

	)

51 
	#PARITY4
 0xecc1327aU

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(5,6,7,0,9,10,11,4,13,14,15,8,19,19,19,12)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(13,14,15,0,1,2,3,4,19,19,19,8,9,10,11,12)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10}

	)

75 
	#ALTI_SL2_PERM64
 {3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2}

	)

76 
	#ALTI_SR2_PERM
 {5,6,7,0,9,10,11,4,13,14,15,8,19,19,19,12}

	)

77 
	#ALTI_SR2_PERM64
 {13,14,15,0,1,2,3,4,19,19,19,8,9,10,11,12}

	)

79 
	#IDSTR
 "SFMT-44497:330-5-3-9-3:effffffb-dfbebfff-bfbf7bef-9ffd7bff"

	)

	@deps/jemalloc/test/include/test/SFMT-params607.h

36 #iâdeà
SFMT_PARAMS607_H


37 
	#SFMT_PARAMS607_H


	)

39 
	#POS1
 2

	)

40 
	#SL1
 15

	)

41 
	#SL2
 3

	)

42 
	#SR1
 13

	)

43 
	#SR2
 3

	)

44 
	#MSK1
 0xfdff37ffU

	)

45 
	#MSK2
 0xef7f3f7dU

	)

46 
	#MSK3
 0xff777b7dU

	)

47 
	#MSK4
 0x7ff7fb2fU

	)

48 
	#PARITY1
 0x00000001U

	)

49 
	#PARITY2
 0x00000000U

	)

50 
	#PARITY3
 0x00000000U

	)

51 
	#PARITY4
 0x5986f054U

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(5,6,7,0,9,10,11,4,13,14,15,8,19,19,19,12)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(13,14,15,0,1,2,3,4,19,19,19,8,9,10,11,12)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {3,21,21,21,7,0,1,2,11,4,5,6,15,8,9,10}

	)

75 
	#ALTI_SL2_PERM64
 {3,4,5,6,7,29,29,29,11,12,13,14,15,0,1,2}

	)

76 
	#ALTI_SR2_PERM
 {5,6,7,0,9,10,11,4,13,14,15,8,19,19,19,12}

	)

77 
	#ALTI_SR2_PERM64
 {13,14,15,0,1,2,3,4,19,19,19,8,9,10,11,12}

	)

79 
	#IDSTR
 "SFMT-607:2-15-3-13-3:fdff37ff-ef7f3f7d-ff777b7d-7ff7fb2f"

	)

	@deps/jemalloc/test/include/test/SFMT-params86243.h

36 #iâdeà
SFMT_PARAMS86243_H


37 
	#SFMT_PARAMS86243_H


	)

39 
	#POS1
 366

	)

40 
	#SL1
 6

	)

41 
	#SL2
 7

	)

42 
	#SR1
 19

	)

43 
	#SR2
 1

	)

44 
	#MSK1
 0xfdbffbffU

	)

45 
	#MSK2
 0xbff7ff3fU

	)

46 
	#MSK3
 0xfd77efffU

	)

47 
	#MSK4
 0xbf9ff3ffU

	)

48 
	#PARITY1
 0x00000001U

	)

49 
	#PARITY2
 0x00000000U

	)

50 
	#PARITY3
 0x00000000U

	)

51 
	#PARITY4
 0xe9528d85U

	)

55 #ià
defšed
(
__APPLE__
)

56 
	#ALTI_SL1
 (
veùÜ
 )(
SL1
, SL1, SL1, SL1)

	)

57 
	#ALTI_SR1
 (
veùÜ
 )(
SR1
, SR1, SR1, SR1)

	)

58 
	#ALTI_MSK
 (
veùÜ
 )(
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
)

	)

59 
	#ALTI_MSK64
 \

60 (
veùÜ
 )(
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
)

	)

61 
	#ALTI_SL2_PERM
 \

62 (
veùÜ
 )(25,25,25,25,3,25,25,25,7,0,1,2,11,4,5,6)

	)

63 
	#ALTI_SL2_PERM64
 \

64 (
veùÜ
 )(7,25,25,25,25,25,25,25,15,0,1,2,3,4,5,6)

	)

65 
	#ALTI_SR2_PERM
 \

66 (
veùÜ
 )(7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14)

	)

67 
	#ALTI_SR2_PERM64
 \

68 (
veùÜ
 )(15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14)

	)

70 
	#ALTI_SL1
 {
SL1
, SL1, SL1, SL1}

	)

71 
	#ALTI_SR1
 {
SR1
, SR1, SR1, SR1}

	)

72 
	#ALTI_MSK
 {
MSK1
, 
MSK2
, 
MSK3
, 
MSK4
}

	)

73 
	#ALTI_MSK64
 {
MSK2
, 
MSK1
, 
MSK4
, 
MSK3
}

	)

74 
	#ALTI_SL2_PERM
 {25,25,25,25,3,25,25,25,7,0,1,2,11,4,5,6}

	)

75 
	#ALTI_SL2_PERM64
 {7,25,25,25,25,25,25,25,15,0,1,2,3,4,5,6}

	)

76 
	#ALTI_SR2_PERM
 {7,0,1,2,11,4,5,6,15,8,9,10,17,12,13,14}

	)

77 
	#ALTI_SR2_PERM64
 {15,0,1,2,3,4,5,6,17,8,9,10,11,12,13,14}

	)

79 
	#IDSTR
 "SFMT-86243:366-6-7-19-1:fdbffbff-bff7ff3f-fd77efff-bf9ff3ff"

	)

	@deps/jemalloc/test/include/test/SFMT-sse2.h

51 #iâdeà
SFMT_SSE2_H


52 
	#SFMT_SSE2_H


	)

63 
JEMALLOC_ALWAYS_INLINE
 
__m128i
 
	$mm_»cursiÚ
(
__m128i
 *
a
, __m128˜*
b
,

64 
__m128i
 
c
, __m128˜
d
, __m128˜
mask
) {

65 
__m128i
 
v
, 
x
, 
y
, 
z
;

67 
x
 = 
	`_mm_lßd_si128
(
a
);

68 
y
 = 
	`_mm_¤li_•i32
(*
b
, 
SR1
);

69 
z
 = 
	`_mm_¤li_si128
(
c
, 
SR2
);

70 
v
 = 
	`_mm_¦li_•i32
(
d
, 
SL1
);

71 
z
 = 
	`_mm_xÜ_si128
(z, 
x
);

72 
z
 = 
	`_mm_xÜ_si128
(z, 
v
);

73 
x
 = 
	`_mm_¦li_si128
(x, 
SL2
);

74 
y
 = 
	`_mm_ªd_si128
(y, 
mask
);

75 
z
 = 
	`_mm_xÜ_si128
(z, 
x
);

76 
z
 = 
	`_mm_xÜ_si128
(z, 
y
);

77  
z
;

78 
	}
}

84 
JEMALLOC_INLINE
 
	$g’_¿nd_®l
(
sfmt_t
 *
ùx
) {

85 
i
;

86 
__m128i
 
r
, 
r1
, 
r2
, 
mask
;

87 
mask
 = 
	`_mm_£t_•i32
(
MSK4
, 
MSK3
, 
MSK2
, 
MSK1
);

89 
r1
 = 
	`_mm_lßd_si128
(&
ùx
->
sfmt
[
N
 - 2].
si
);

90 
r2
 = 
	`_mm_lßd_si128
(&
ùx
->
sfmt
[
N
 - 1].
si
);

91 
i
 = 0; i < 
N
 - 
POS1
; i++) {

92 
r
 = 
	`mm_»cursiÚ
(&
ùx
->
sfmt
[
i
].
si
, &ùx->sfmt[˜+ 
POS1
].si, 
r1
, 
r2
,

93 
mask
);

94 
	`_mm_¡Üe_si128
(&
ùx
->
sfmt
[
i
].
si
, 
r
);

95 
r1
 = 
r2
;

96 
r2
 = 
r
;

98 ; 
i
 < 
N
; i++) {

99 
r
 = 
	`mm_»cursiÚ
(&
ùx
->
sfmt
[
i
].
si
, &ùx->sfmt[˜+ 
POS1
 - 
N
].si, 
r1
, 
r2
,

100 
mask
);

101 
	`_mm_¡Üe_si128
(&
ùx
->
sfmt
[
i
].
si
, 
r
);

102 
r1
 = 
r2
;

103 
r2
 = 
r
;

105 
	}
}

114 
JEMALLOC_INLINE
 
	$g’_¿nd_¬¿y
(
sfmt_t
 *
ùx
, 
w128_t
 *
¬¿y
, 
size
) {

115 
i
, 
j
;

116 
__m128i
 
r
, 
r1
, 
r2
, 
mask
;

117 
mask
 = 
	`_mm_£t_•i32
(
MSK4
, 
MSK3
, 
MSK2
, 
MSK1
);

119 
r1
 = 
	`_mm_lßd_si128
(&
ùx
->
sfmt
[
N
 - 2].
si
);

120 
r2
 = 
	`_mm_lßd_si128
(&
ùx
->
sfmt
[
N
 - 1].
si
);

121 
i
 = 0; i < 
N
 - 
POS1
; i++) {

122 
r
 = 
	`mm_»cursiÚ
(&
ùx
->
sfmt
[
i
].
si
, &ùx->sfmt[˜+ 
POS1
].si, 
r1
, 
r2
,

123 
mask
);

124 
	`_mm_¡Üe_si128
(&
¬¿y
[
i
].
si
, 
r
);

125 
r1
 = 
r2
;

126 
r2
 = 
r
;

128 ; 
i
 < 
N
; i++) {

129 
r
 = 
	`mm_»cursiÚ
(&
ùx
->
sfmt
[
i
].
si
, &
¬¿y
[˜+ 
POS1
 - 
N
].si, 
r1
, 
r2
,

130 
mask
);

131 
	`_mm_¡Üe_si128
(&
¬¿y
[
i
].
si
, 
r
);

132 
r1
 = 
r2
;

133 
r2
 = 
r
;

136 ; 
i
 < 
size
 - 
N
; i++) {

137 
r
 = 
	`mm_»cursiÚ
(&
¬¿y
[
i
 - 
N
].
si
, &¬¿y[˜+ 
POS1
 - N].si, 
r1
, 
r2
,

138 
mask
);

139 
	`_mm_¡Üe_si128
(&
¬¿y
[
i
].
si
, 
r
);

140 
r1
 = 
r2
;

141 
r2
 = 
r
;

143 
j
 = 0; j < 2 * 
N
 - 
size
; j++) {

144 
r
 = 
	`_mm_lßd_si128
(&
¬¿y
[
j
 + 
size
 - 
N
].
si
);

145 
	`_mm_¡Üe_si128
(&
ùx
->
sfmt
[
j
].
si
, 
r
);

147 ; 
i
 < 
size
; i++) {

148 
r
 = 
	`mm_»cursiÚ
(&
¬¿y
[
i
 - 
N
].
si
, &¬¿y[˜+ 
POS1
 - N].si, 
r1
, 
r2
,

149 
mask
);

150 
	`_mm_¡Üe_si128
(&
¬¿y
[
i
].
si
, 
r
);

151 
	`_mm_¡Üe_si128
(&
ùx
->
sfmt
[
j
++].
si
, 
r
);

152 
r1
 = 
r2
;

153 
r2
 = 
r
;

155 
	}
}

	@deps/jemalloc/test/include/test/SFMT.h

66 #iâdeà
SFMT_H


67 
	#SFMT_H


	)

69 
sfmt_s
 
	tsfmt_t
;

71 
ušt32_t
 
g’_¿nd32
(
sfmt_t
 *
ùx
);

72 
ušt32_t
 
g’_¿nd32_¿nge
(
sfmt_t
 *
ùx
, ušt32_ˆ
lim™
);

73 
ušt64_t
 
g’_¿nd64
(
sfmt_t
 *
ùx
);

74 
ušt64_t
 
g’_¿nd64_¿nge
(
sfmt_t
 *
ùx
, ušt64_ˆ
lim™
);

75 
fl_¬¿y32
(
sfmt_t
 *
ùx
, 
ušt32_t
 *
¬¿y
, 
size
);

76 
fl_¬¿y64
(
sfmt_t
 *
ùx
, 
ušt64_t
 *
¬¿y
, 
size
);

77 
sfmt_t
 *
š™_g’_¿nd
(
ušt32_t
 
£ed
);

78 
sfmt_t
 *
š™_by_¬¿y
(
ušt32_t
 *
š™_key
, 
key_Ëngth
);

79 
fši_g’_¿nd
(
sfmt_t
 *
ùx
);

80 cÚ¡ *
g‘_id¡ršg
();

81 
g‘_mš_¬¿y_size32
();

82 
g‘_mš_¬¿y_size64
();

84 #iâdeà
JEMALLOC_ENABLE_INLINE


85 
to_»®1
(
ušt32_t
 
v
);

86 
g’¿nd_»®1
(
sfmt_t
 *
ùx
);

87 
to_»®2
(
ušt32_t
 
v
);

88 
g’¿nd_»®2
(
sfmt_t
 *
ùx
);

89 
to_»®3
(
ušt32_t
 
v
);

90 
g’¿nd_»®3
(
sfmt_t
 *
ùx
);

91 
to_»s53
(
ušt64_t
 
v
);

92 
to_»s53_mix
(
ušt32_t
 
x
, ušt32_ˆ
y
);

93 
g’¿nd_»s53
(
sfmt_t
 *
ùx
);

94 
g’¿nd_»s53_mix
(
sfmt_t
 *
ùx
);

97 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
SFMT_C_
))

100 
JEMALLOC_INLINE
 
	$to_»®1
(
ušt32_t
 
v
)

102  
v
 * (1.0/4294967295.0);

104 
	}
}

107 
JEMALLOC_INLINE
 
	$g’¿nd_»®1
(
sfmt_t
 *
ùx
)

109  
	`to_»®1
(
	`g’_¿nd32
(
ùx
));

110 
	}
}

113 
JEMALLOC_INLINE
 
	$to_»®2
(
ušt32_t
 
v
)

115  
v
 * (1.0/4294967296.0);

117 
	}
}

120 
JEMALLOC_INLINE
 
	$g’¿nd_»®2
(
sfmt_t
 *
ùx
)

122  
	`to_»®2
(
	`g’_¿nd32
(
ùx
));

123 
	}
}

126 
JEMALLOC_INLINE
 
	$to_»®3
(
ušt32_t
 
v
)

128  ((()
v
) + 0.5)*(1.0/4294967296.0);

130 
	}
}

133 
JEMALLOC_INLINE
 
	$g’¿nd_»®3
(
sfmt_t
 *
ùx
)

135  
	`to_»®3
(
	`g’_¿nd32
(
ùx
));

136 
	}
}

140 
JEMALLOC_INLINE
 
	$to_»s53
(
ušt64_t
 
v
)

142  
v
 * (1.0/18446744073709551616.0L);

143 
	}
}

147 
JEMALLOC_INLINE
 
	$to_»s53_mix
(
ušt32_t
 
x
, ušt32_ˆ
y
)

149  
	`to_»s53
(
x
 | ((
ušt64_t
)
y
 << 32));

150 
	}
}

154 
JEMALLOC_INLINE
 
	$g’¿nd_»s53
(
sfmt_t
 *
ùx
)

156  
	`to_»s53
(
	`g’_¿nd64
(
ùx
));

157 
	}
}

162 
JEMALLOC_INLINE
 
	$g’¿nd_»s53_mix
(
sfmt_t
 *
ùx
)

164 
ušt32_t
 
x
, 
y
;

166 
x
 = 
	`g’_¿nd32
(
ùx
);

167 
y
 = 
	`g’_¿nd32
(
ùx
);

168  
	`to_»s53_mix
(
x
, 
y
);

169 
	}
}

	@deps/jemalloc/test/include/test/btalloc.h

2 *
bÎoc
(
size_t
 
size
, 
b™s
);

4 
	#bÎoc_n_´Ùo
(
n
) \

5 *
bÎoc_
##
	`n
(
size_t
 
size
, 
b™s
);

	)

6 
	$bÎoc_n_´Ùo
(0)

7 
	$bÎoc_n_´Ùo
(1)

9 
	#bÎoc_n_g’
(
n
) \

11 
bÎoc_
##
	`n
(
size_t
 
size
, 
b™s
) \

13 *
p
; \

15 ià(
b™s
 == 0) \

16 
p
 = 
	`m®locx
(
size
, 0); \

18 
b™s
 & 0x1U) { \

20 
p
 = (
	`bÎoc_0
(
size
, 
b™s
 >> 1)); \

23 
p
 = (
	`bÎoc_1
(
size
, 
b™s
 >> 1)); \

25 : 
	`nÙ_»ached
(); \

29 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure"); \

30  (
p
); \

31 
	}

	)
}

	@deps/jemalloc/test/include/test/jemalloc_test.h

1 
	~<lim™s.h
>

2 #iâdeà
SIZE_T_MAX


3 
	#SIZE_T_MAX
 
SIZE_MAX


	)

5 
	~<¡dlib.h
>

6 
	~<¡d¬g.h
>

7 
	~<¡dboŞ.h
>

8 
	~<”ºo.h
>

9 
	~<m©h.h
>

10 
	~<¡ršg.h
>

11 #ifdeà
_WIN32


12 
	~"msvc_com·t/¡ršgs.h
"

15 #ifdeà
_WIN32


16 
	~<wšdows.h
>

17 
	~"msvc_com·t/wšdows_exŒa.h
"

19 
	~<±h»ad.h
>

22 
	~"‹¡/jem®loc_‹¡_defs.h
"

24 #ifdeà
JEMALLOC_OSSPIN


25 
	~<libk”n/OSAtomic.h
>

28 #ià
defšed
(
HAVE_ALTIVEC
è&& !defšed(
__APPLE__
)

29 
	~<®tivec.h
>

31 #ifdeà
HAVE_SSE2


32 
	~<emmšŒš.h
>

39 #ifdeà
JEMALLOC_UNIT_TEST


40 
	#JEMALLOC_JET


	)

41 
	#JEMALLOC_MANGLE


	)

42 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

50 #–ià
defšed
(
JEMALLOC_INTEGRATION_TEST
)

51 
	#JEMALLOC_MANGLE


	)

52 
	~"jem®loc/jem®loc.h
"

53 
	~"jem®loc/š‹º®/jem®loc_š‹º®_defs.h
"

54 
	~"jem®loc/š‹º®/jem®loc_š‹º®_maüos.h
"

56 cÚ¡ 
boŞ
 
	gcÚfig_debug
 =

57 #ifdeà
JEMALLOC_DEBUG


58 
Œue


60 
çl£


64 
	#JEMALLOC_N
(
n
è
je_
##
	)
n

65 
	~"jem®loc/š‹º®/´iv©e_Çme¥aû.h
"

67 
	#JEMALLOC_H_TYPES


	)

68 
	#JEMALLOC_H_STRUCTS


	)

69 
	#JEMALLOC_H_EXTERNS


	)

70 
	#JEMALLOC_H_INLINES


	)

71 
	~"jem®loc/š‹º®/n¡ime.h
"

72 
	~"jem®loc/š‹º®/ut.h
"

73 
	~"jem®loc/š‹º®/qr.h
"

74 
	~"jem®loc/š‹º®/ql.h
"

75 #undeà
JEMALLOC_H_TYPES


76 #undeà
JEMALLOC_H_STRUCTS


77 #undeà
JEMALLOC_H_EXTERNS


78 #undeà
JEMALLOC_H_INLINES


87 #–ià
defšed
(
JEMALLOC_STRESS_TEST
)

88 
	~"jem®loc/jem®loc.h
"

90 
	~"jem®loc/jem®loc_´Ùos_j‘.h
"

92 
	#JEMALLOC_JET


	)

93 
	~"jem®loc/š‹º®/jem®loc_š‹º®.h
"

94 
	~"jem®loc/š‹º®/public_uÂame¥aû.h
"

95 #undeà
JEMALLOC_JET


97 
	~"jem®loc/jem®loc_»Çme.h
"

98 
	#JEMALLOC_MANGLE


	)

99 #ifdeà
JEMALLOC_STRESS_TESTLIB


100 
	~"jem®loc/jem®loc_mªgË_j‘.h
"

102 
	~"jem®loc/jem®loc_mªgË.h
"

118 
	~"‹¡/bÎoc.h
"

119 
	~"‹¡/m©h.h
"

120 
	~"‹¡/mtx.h
"

121 
	~"‹¡/mq.h
"

122 
	~"‹¡/‹¡.h
"

123 
	~"‹¡/tim”.h
"

124 
	~"‹¡/thd.h
"

125 
	#MEXP
 19937

	)

126 
	~"‹¡/SFMT.h
"

133 #undeà
as£¹


134 #undeà
nÙ_»ached


135 #undeà
nÙ_im¶em’‹d


136 #undeà
as£¹_nÙ_im¶em’‹d


138 
	#as£¹
(
e
) do { \

139 ià(!(
e
)) { \

140 
	`m®loc_´štf
( \

142 
__FILE__
, 
__LINE__
, #e); \

143 
	`abÜt
(); \

145 } 0)

	)

147 
	#nÙ_»ached
() do { \

148 
	`m®loc_´štf
( \

150 
__FILE__
, 
__LINE__
); \

151 
	`abÜt
(); \

152 } 0)

	)

154 
	#nÙ_im¶em’‹d
() do { \

155 
	`m®loc_´štf
("<jemalloc>: %s:%d: Not implemented\n", \

156 
__FILE__
, 
__LINE__
); \

157 
	`abÜt
(); \

158 } 0)

	)

160 
	#as£¹_nÙ_im¶em’‹d
(
e
) do { \

161 ià(!(
e
)) \

162 
	`nÙ_im¶em’‹d
(); \

163 } 0)

	)

	@deps/jemalloc/test/include/test/jemalloc_test_defs.h

2 
	~"jem®loc/š‹º®/jem®loc_š‹º®_defs.h
"

3 
	~"jem®loc/š‹º®/jem®loc_š‹º®_deşs.h
"

	@deps/jemalloc/test/include/test/math.h

1 #iâdeà
JEMALLOC_ENABLE_INLINE


2 
Ê_gamma
(
x
);

3 
i_gamma
(
x
, 
p
, 
Ê_gamma_p
);

4 
±_nÜm
(
p
);

5 
±_chi2
(
p
, 
df
, 
Ê_gamma_df_2
);

6 
±_gamma
(
p
, 
sh­e
, 
sÿË
, 
Ê_gamma_sh­e
);

9 #ià(
defšed
(
JEMALLOC_ENABLE_INLINE
è|| defšed(
MATH_C_
))

18 
JEMALLOC_INLINE
 

19 
	$Ê_gamma
(
x
)

21 
f
, 
z
;

23 
	`as£¹
(
x
 > 0.0);

25 ià(
x
 < 7.0) {

26 
f
 = 1.0;

27 
z
 = 
x
;

28 
z
 < 7.0) {

29 
f
 *ğ
z
;

30 
z
 += 1.0;

32 
x
 = 
z
;

33 
f
 = -
	`log
(f);

35 
f
 = 0.0;

37 
z
 = 1.0 / (
x
 * x);

39  (
f
 + (
x
-0.5è* 
	`log
(x) - x + 0.918938533204673 +

40 (((-0.000595238095238 * 
z
 + 0.000793650793651) * z -

41 0.002777777777778è* 
z
 + 0.083333333333333è/ 
x
);

42 
	}
}

53 
JEMALLOC_INLINE
 

54 
	$i_gamma
(
x
, 
p
, 
Ê_gamma_p
)

56 
acu
, 
çùÜ
, 
oæo
, 
gš
, 
‹rm
, 
º
, 
a
, 
b
, 
ª
, 
dif
;

57 
²
[6];

58 
i
;

60 
	`as£¹
(
p
 > 0.0);

61 
	`as£¹
(
x
 >= 0.0);

63 ià(
x
 == 0.0)

66 
acu
 = 1.0e-10;

67 
oæo
 = 1.0e30;

68 
gš
 = 0.0;

69 
çùÜ
 = 
	`exp
(
p
 * 
	`log
(
x
è- x - 
Ê_gamma_p
);

71 ià(
x
 <ğ1.0 || x < 
p
) {

73 
gš
 = 1.0;

74 
‹rm
 = 1.0;

75 
º
 = 
p
;

77 
Œue
) {

78 
º
 += 1.0;

79 
‹rm
 *ğ
x
 / 
º
;

80 
gš
 +ğ
‹rm
;

81 ià(
‹rm
 <ğ
acu
) {

82 
gš
 *ğ
çùÜ
 / 
p
;

83  (
gš
);

88 
a
 = 1.0 - 
p
;

89 
b
 = 
a
 + 
x
 + 1.0;

90 
‹rm
 = 0.0;

91 
²
[0] = 1.0;

92 
²
[1] = 
x
;

93 
²
[2] = 
x
 + 1.0;

94 
²
[3] = 
x
 * 
b
;

95 
gš
 = 
²
[2] /…n[3];

97 
Œue
) {

98 
a
 += 1.0;

99 
b
 += 2.0;

100 
‹rm
 += 1.0;

101 
ª
 = 
a
 * 
‹rm
;

102 
i
 = 0; i < 2; i++)

103 
²
[
i
+4] = 
b
 *…n[i+2] - 
ª
 *…n[i];

104 ià(
²
[5] != 0.0) {

105 
º
 = 
²
[4] /…n[5];

106 
dif
 = 
	`çbs
(
gš
 - 
º
);

107 ià(
dif
 <ğ
acu
 && dià<ğacu * 
º
) {

108 
gš
 = 1.0 - 
çùÜ
 * gin;

109  (
gš
);

111 
gš
 = 
º
;

113 
i
 = 0; i < 4; i++)

114 
²
[
i
] =…n[i+2];

116 ià(
	`çbs
(
²
[4]è>ğ
oæo
) {

117 
i
 = 0; i < 4; i++)

118 
²
[
i
] /ğ
oæo
;

122 
	}
}

134 
JEMALLOC_INLINE
 

135 
	$±_nÜm
(
p
)

137 
q
, 
r
, 
»t
;

139 
	`as£¹
(
p
 > 0.0 &&… < 1.0);

141 
q
 = 
p
 - 0.5;

142 ià(
	`çbs
(
q
) <= 0.425) {

144 
r
 = 0.180625 - 
q
 * q;

145  (
q
 * (((((((2.5090809287301226727e3 * 
r
 +

146 3.3430575583588128105e4è* 
r
 + 6.7265770927008700853e4) *„

147 + 4.5921953931549871457e4è* 
r
 + 1.3731693765509461125e4) *

148 
r
 + 1.9715909503065514427e3) *„ + 1.3314166789178437745e2)

149 * 
r
 + 3.3871328727963666080e0) /

150 (((((((5.2264952788528545610e3 * 
r
 +

151 2.8729085735721942674e4è* 
r
 + 3.9307895800092710610e4) *„

152 + 2.1213794301586595867e4è* 
r
 + 5.3941960214247511077e3) *

153 
r
 + 6.8718700749205790830e2) *„ + 4.2313330701600911252e1)

154 * 
r
 + 1.0));

156 ià(
q
 < 0.0)

157 
r
 = 
p
;

159 
r
 = 1.0 - 
p
;

160 
	`as£¹
(
r
 > 0.0);

162 
r
 = 
	`sq¹
(-
	`log
(r));

163 ià(
r
 <= 5.0) {

165 
r
 -= 1.6;

166 
»t
 = ((((((((7.74545014278341407640e-4 * 
r
 +

167 2.27238449892691845833e-2è* 
r
 +

168 2.41780725177450611770e-1è* 
r
 +

169 1.27045825245236838258e0è* 
r
 +

170 3.64784832476320460504e0è* 
r
 +

171 5.76949722146069140550e0è* 
r
 +

172 4.63033784615654529590e0è* 
r
 +

174 (((((((1.05075007164441684324e-9 * 
r
 +

175 5.47593808499534494600e-4è* 
r
 +

177 * 
r
 + 1.48103976427480074590e-1) *„ +

178 6.89767334985100004550e-1è* 
r
 +

179 1.67638483018380384940e0è* 
r
 +

180 2.05319162663775882187e0è* 
r
 + 1.0));

183 
r
 -= 5.0;

184 
»t
 = ((((((((2.01033439929228813265e-7 * 
r
 +

185 2.71155556874348757815e-5è* 
r
 +

186 1.24266094738807843860e-3è* 
r
 +

187 2.65321895265761230930e-2è* 
r
 +

188 2.96560571828504891230e-1è* 
r
 +

189 1.78482653991729133580e0è* 
r
 +

190 5.46378491116411436990e0è* 
r
 +

192 (((((((2.04426310338993978564e-15 * 
r
 +

193 1.42151175831644588870e-7è* 
r
 +

194 1.84631831751005468180e-5è* 
r
 +

195 7.86869131145613259100e-4è* 
r
 +

196 1.48753612908506148525e-2è* 
r
 +

197 1.36929880922735805310e-1è* 
r
 +

199 * 
r
 + 1.0));

201 ià(
q
 < 0.0)

202 
»t
 = -ret;

203  (
»t
);

205 
	}
}

221 
JEMALLOC_INLINE
 

222 
	$±_chi2
(
p
, 
df
, 
Ê_gamma_df_2
)

224 
e
, 
¯
, 
xx
, 
c
, 
ch
, 
a
, 
q
, 
p1
, 
p2
, 
t
, 
x
, 
b
, 
s1
, 
s2
, 
s3
, 
s4
, 
s5
, 
s6
;

225 
i
;

227 
	`as£¹
(
p
 >= 0.0 &&… < 1.0);

228 
	`as£¹
(
df
 > 0.0);

230 
e
 = 5.0e-7;

231 
¯
 = 0.6931471805;

233 
xx
 = 0.5 * 
df
;

234 
c
 = 
xx
 - 1.0;

236 ià(
df
 < -1.24 * 
	`log
(
p
)) {

238 
ch
 = 
	`pow
(
p
 * 
xx
 * 
	`exp
(
Ê_gamma_df_2
 + xx * 
¯
), 1.0 / xx);

239 ià(
ch
 - 
e
 < 0.0)

240  (
ch
);

242 ià(
df
 > 0.32) {

243 
x
 = 
	`±_nÜm
(
p
);

248 
p1
 = 0.222222 / 
df
;

249 
ch
 = 
df
 * 
	`pow
(
x
 * 
	`sq¹
(
p1
) + 1.0 -…1, 3.0);

251 ià(
ch
 > 2.2 * 
df
 + 6.0) {

252 
ch
 = -2.0 * (
	`log
(1.0 - 
p
è- 
c
 *†og(0.5 * ch) +

253 
Ê_gamma_df_2
);

256 
ch
 = 0.4;

257 
a
 = 
	`log
(1.0 - 
p
);

258 
Œue
) {

259 
q
 = 
ch
;

260 
p1
 = 1.0 + 
ch
 * (4.67 + ch);

261 
p2
 = 
ch
 * (6.73 + ch * (6.66 + ch));

262 
t
 = -0.5 + (4.67 + 2.0 * 
ch
è/ 
p1
 - (6.73 + ch

263 * (13.32 + 3.0 * 
ch
)è/ 
p2
;

264 
ch
 -ğ(1.0 - 
	`exp
(
a
 + 
Ê_gamma_df_2
 + 0.5 * ch +

265 
c
 * 
¯
è* 
p2
 / 
p1
è/ 
t
;

266 ià(
	`çbs
(
q
 / 
ch
 - 1.0) - 0.01 <= 0.0)

272 
i
 = 0; i < 20; i++) {

274 
q
 = 
ch
;

275 
p1
 = 0.5 * 
ch
;

276 ià(
p1
 < 0.0)

278 
p2
 = 
p
 - 
	`i_gamma
(
p1
, 
xx
, 
Ê_gamma_df_2
);

279 
t
 = 
p2
 * 
	`exp
(
xx
 * 
¯
 + 
Ê_gamma_df_2
 + 
p1
 - 
c
 * 
	`log
(
ch
));

280 
b
 = 
t
 / 
ch
;

281 
a
 = 0.5 * 
t
 - 
b
 * 
c
;

282 
s1
 = (210.0 + 
a
 * (140.0 +‡ * (105.0 +‡ * (84.0 +‡ * (70.0 +

283 60.0 * 
a
))))) / 420.0;

284 
s2
 = (420.0 + 
a
 * (735.0 +‡ * (966.0 +‡ * (1141.0 + 1278.0 *

285 
a
)))) / 2520.0;

286 
s3
 = (210.0 + 
a
 * (462.0 +‡ * (707.0 + 932.0 *‡))) / 2520.0;

287 
s4
 = (252.0 + 
a
 * (672.0 + 1182.0 *‡è+ 
c
 * (294.0 +‡ *

288 (889.0 + 1740.0 * 
a
))) / 5040.0;

289 
s5
 = (84.0 + 264.0 * 
a
 + 
c
 * (175.0 + 606.0 *‡)) / 2520.0;

290 
s6
 = (120.0 + 
c
 * (346.0 + 127.0 * c)) / 5040.0;

291 
ch
 +ğ
t
 * (1.0 + 0.5 * * 
s1
 - 
b
 * 
c
 * (s1 - b * (
s2
 - b * (
s3


292 - 
b
 * (
s4
 - b * (
s5
 - b * 
s6
))))));

293 ià(
	`çbs
(
q
 / 
ch
 - 1.0è<ğ
e
)

297  (
ch
);

298 
	}
}

305 
JEMALLOC_INLINE
 

306 
	$±_gamma
(
p
, 
sh­e
, 
sÿË
, 
Ê_gamma_sh­e
)

309  (
	`±_chi2
(
p
, 
sh­e
 * 2.0, 
Ê_gamma_sh­e
è* 0.5 * 
sÿË
);

310 
	}
}

	@deps/jemalloc/test/include/test/mq.h

1 
mq_Çno¦“p
(
ns
);

29 
	#mq_msg
(
a_mq_msg_ty³
è
	`ql_–m
×_mq_msg_ty³)

	)

31 
	#mq_g’
(
a_©Œ
, 
a_´efix
, 
a_mq_ty³
, 
a_mq_msg_ty³
, 
a_f›ld
) \

33 
mtx_t
 
lock
; \

34 
	`ql_h—d
(
a_mq_msg_ty³
è
msgs
; \

35 
couÁ
; \

36 } 
	ta_mq_ty³
; \

37 
a_©Œ
 
boŞ
 \

38 
a_´efix
##
	`š™
(
a_mq_ty³
 *
mq
) { \

40 ià(
	`mtx_š™
(&
mq
->
lock
)) \

41  (
Œue
); \

42 
	`ql_Ãw
(&
mq
->
msgs
); \

43 
mq
->
couÁ
 = 0; \

44  (
çl£
); \

46 
a_©Œ
 \

47 
a_´efix
##
	`fši
(
a_mq_ty³
 *
mq
) \

50 
	`mtx_fši
(&
mq
->
lock
); \

52 
a_©Œ
 \

53 
a_´efix
##
	`couÁ
(
a_mq_ty³
 *
mq
) \

55 
couÁ
; \

57 
	`mtx_lock
(&
mq
->
lock
); \

58 
couÁ
 = 
mq
->count; \

59 
	`mtx_uÆock
(&
mq
->
lock
); \

60  (
couÁ
); \

62 
a_©Œ
 
a_mq_msg_ty³
 * \

63 
a_´efix
##
	`Œyg‘
(
a_mq_ty³
 *
mq
) \

65 
a_mq_msg_ty³
 *
msg
; \

67 
	`mtx_lock
(&
mq
->
lock
); \

68 
msg
 = 
	`ql_fœ¡
(&
mq
->
msgs
); \

69 ià(
msg
 !ğ
NULL
) { \

70 
	`ql_h—d_»move
(&
mq
->
msgs
, 
a_mq_msg_ty³
, 
a_f›ld
); \

71 
mq
->
couÁ
--; \

73 
	`mtx_uÆock
(&
mq
->
lock
); \

74  (
msg
); \

76 
a_©Œ
 
a_mq_msg_ty³
 * \

77 
a_´efix
##
	`g‘
(
a_mq_ty³
 *
mq
) \

79 
a_mq_msg_ty³
 *
msg
; \

80 
ns
; \

82 
msg
 = 
a_´efix
##
	`Œyg‘
(
mq
); \

83 ià(
msg
 !ğ
NULL
) \

84  (
msg
); \

86 
ns
 = 1; \

87 
Œue
) { \

88 
	`mq_Çno¦“p
(
ns
); \

89 
msg
 = 
a_´efix
##
	`Œyg‘
(
mq
); \

90 ià(
msg
 !ğ
NULL
) \

91  (
msg
); \

92 ià(
ns
 < 1000*1000*1000) { \

94 
ns
 <<= 1; \

95 ià(
ns
 > 1000*1000*1000) \

96 
ns
 = 1000*1000*1000; \

100 
a_©Œ
 \

101 
a_´efix
##
	`put
(
a_mq_ty³
 *
mq
, 
a_mq_msg_ty³
 *
msg
) \

104 
	`mtx_lock
(&
mq
->
lock
); \

105 
	`ql_–m_Ãw
(
msg
, 
a_f›ld
); \

106 
	`ql__š£¹
(&
mq
->
msgs
, 
msg
, 
a_f›ld
); \

107 
mq
->
couÁ
++; \

108 
	`mtx_uÆock
(&
mq
->
lock
); \

109 }

	)

	@deps/jemalloc/test/include/test/mtx.h

9 #ifdeà
_WIN32


10 
CRITICAL_SECTION
 
	mlock
;

11 #–ià(
defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

12 
os_unçœ_lock
 
	mlock
;

13 #–ià(
defšed
(
JEMALLOC_OSSPIN
))

14 
OSSpšLock
 
	mlock
;

16 
±h»ad_mu‹x_t
 
	mlock
;

18 } 
	tmtx_t
;

20 
boŞ
 
mtx_š™
(
mtx_t
 *
mtx
);

21 
mtx_fši
(
mtx_t
 *
mtx
);

22 
mtx_lock
(
mtx_t
 *
mtx
);

23 
mtx_uÆock
(
mtx_t
 *
mtx
);

	@deps/jemalloc/test/include/test/test.h

1 
	#ASSERT_BUFSIZE
 256

	)

3 
	#as£¹_cmp
(
t
, 
a
, 
b
, 
cmp
, 
Ãg_cmp
, 
´i
, ...) do { \

4 
t
 
a_
 = (
a
); \

5 
t
 
b_
 = (
b
); \

6 ià(!(
a_
 
cmp
 
b_
)) { \

7 
´efix
[
ASSERT_BUFSIZE
]; \

8 
mes§ge
[
ASSERT_BUFSIZE
]; \

9 
	`m®loc_¢´štf
(
´efix
, (prefix), \

12 "%"
´i
" "#neg_cmp" %"pri": ", \

13 
__func__
, 
__FILE__
, 
__LINE__
, \

14 #a, #b, 
a_
, 
b_
); \

15 
	`m®loc_¢´štf
(
mes§ge
, (mes§ge), 
__VA_ARGS__
); \

16 
	`p_‹¡_ç
(
´efix
, 
mes§ge
); \

18 } 0)

	)

20 
	#as£¹_±r_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(*,‡, b, ==, \

21 !=, "p", 
__VA_ARGS__
)

	)

22 
	#as£¹_±r_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(*,‡, b, !=, \

23 ==, "p", 
__VA_ARGS__
)

	)

24 
	#as£¹_±r_nuÎ
(
a
, ...è
	`as£¹_cmp
(*,‡, 
NULL
, ==, \

25 !=, "p", 
__VA_ARGS__
)

	)

26 
	#as£¹_±r_nÙ_nuÎ
(
a
, ...è
	`as£¹_cmp
(*,‡, 
NULL
, !=, \

27 ==, "p", 
__VA_ARGS__
)

	)

29 
	#as£¹_c_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, ==, !=, "c", 
__VA_ARGS__
)

	)

30 
	#as£¹_c_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, !=, ==, "c", 
__VA_ARGS__
)

	)

31 
	#as£¹_c_É
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <, >=, "c", 
__VA_ARGS__
)

	)

32 
	#as£¹_c_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <=, >, "c", 
__VA_ARGS__
)

	)

33 
	#as£¹_c_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >=, <, "c", 
__VA_ARGS__
)

	)

34 
	#as£¹_c_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >, <=, "c", 
__VA_ARGS__
)

	)

36 
	#as£¹_x_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, ==, !=, "#x", 
__VA_ARGS__
)

	)

37 
	#as£¹_x_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, !=, ==, "#x", 
__VA_ARGS__
)

	)

38 
	#as£¹_x_É
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <, >=, "#x", 
__VA_ARGS__
)

	)

39 
	#as£¹_x_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <=, >, "#x", 
__VA_ARGS__
)

	)

40 
	#as£¹_x_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >=, <, "#x", 
__VA_ARGS__
)

	)

41 
	#as£¹_x_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >, <=, "#x", 
__VA_ARGS__
)

	)

43 
	#as£¹_d_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, ==, !=, "d", 
__VA_ARGS__
)

	)

44 
	#as£¹_d_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, !=, ==, "d", 
__VA_ARGS__
)

	)

45 
	#as£¹_d_É
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <, >=, "d", 
__VA_ARGS__
)

	)

46 
	#as£¹_d_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <=, >, "d", 
__VA_ARGS__
)

	)

47 
	#as£¹_d_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >=, <, "d", 
__VA_ARGS__
)

	)

48 
	#as£¹_d_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >, <=, "d", 
__VA_ARGS__
)

	)

50 
	#as£¹_u_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, ==, !=, "u", 
__VA_ARGS__
)

	)

51 
	#as£¹_u_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, !=, ==, "u", 
__VA_ARGS__
)

	)

52 
	#as£¹_u_É
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <, >=, "u", 
__VA_ARGS__
)

	)

53 
	#as£¹_u_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <=, >, "u", 
__VA_ARGS__
)

	)

54 
	#as£¹_u_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >=, <, "u", 
__VA_ARGS__
)

	)

55 
	#as£¹_u_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >, <=, "u", 
__VA_ARGS__
)

	)

57 
	#as£¹_ld_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, ==, \

58 !=, "ld", 
__VA_ARGS__
)

	)

59 
	#as£¹_ld_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, !=, \

60 ==, "ld", 
__VA_ARGS__
)

	)

61 
	#as£¹_ld_É
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <, \

62 >=, "ld", 
__VA_ARGS__
)

	)

63 
	#as£¹_ld_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <=, \

64 >, "ld", 
__VA_ARGS__
)

	)

65 
	#as£¹_ld_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >=, \

66 <, "ld", 
__VA_ARGS__
)

	)

67 
	#as£¹_ld_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >, \

68 <=, "ld", 
__VA_ARGS__
)

	)

70 
	#as£¹_lu_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

71 
a
, 
b
, ==, !=, "lu", 
__VA_ARGS__
)

	)

72 
	#as£¹_lu_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

73 
a
, 
b
, !=, ==, "lu", 
__VA_ARGS__
)

	)

74 
	#as£¹_lu_É
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

75 
a
, 
b
, <, >=, "lu", 
__VA_ARGS__
)

	)

76 
	#as£¹_lu_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

77 
a
, 
b
, <=, >, "lu", 
__VA_ARGS__
)

	)

78 
	#as£¹_lu_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

79 
a
, 
b
, >=, <, "lu", 
__VA_ARGS__
)

	)

80 
	#as£¹_lu_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

81 
a
, 
b
, >, <=, "lu", 
__VA_ARGS__
)

	)

83 
	#as£¹_qd_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, ==, \

84 !=, "qd", 
__VA_ARGS__
)

	)

85 
	#as£¹_qd_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, !=, \

86 ==, "qd", 
__VA_ARGS__
)

	)

87 
	#as£¹_qd_É
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <, \

88 >=, "qd", 
__VA_ARGS__
)

	)

89 
	#as£¹_qd_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, <=, \

90 >, "qd", 
__VA_ARGS__
)

	)

91 
	#as£¹_qd_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >=, \

92 <, "qd", 
__VA_ARGS__
)

	)

93 
	#as£¹_qd_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(,‡, b, >, \

94 <=, "qd", 
__VA_ARGS__
)

	)

96 
	#as£¹_qu_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

97 
a
, 
b
, ==, !=, "qu", 
__VA_ARGS__
)

	)

98 
	#as£¹_qu_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

99 
a
, 
b
, !=, ==, "qu", 
__VA_ARGS__
)

	)

100 
	#as£¹_qu_É
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

101 
a
, 
b
, <, >=, "qu", 
__VA_ARGS__
)

	)

102 
	#as£¹_qu_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

103 
a
, 
b
, <=, >, "qu", 
__VA_ARGS__
)

	)

104 
	#as£¹_qu_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

105 
a
, 
b
, >=, <, "qu", 
__VA_ARGS__
)

	)

106 
	#as£¹_qu_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(, \

107 
a
, 
b
, >, <=, "qu", 
__VA_ARGS__
)

	)

109 
	#as£¹_jd_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(
štmax_t
,‡, b, ==, \

110 !=, "jd", 
__VA_ARGS__
)

	)

111 
	#as£¹_jd_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(
štmax_t
,‡, b, !=, \

112 ==, "jd", 
__VA_ARGS__
)

	)

113 
	#as£¹_jd_É
(
a
, 
b
, ...è
	`as£¹_cmp
(
štmax_t
,‡, b, <, \

114 >=, "jd", 
__VA_ARGS__
)

	)

115 
	#as£¹_jd_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(
štmax_t
,‡, b, <=, \

116 >, "jd", 
__VA_ARGS__
)

	)

117 
	#as£¹_jd_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(
štmax_t
,‡, b, >=, \

118 <, "jd", 
__VA_ARGS__
)

	)

119 
	#as£¹_jd_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(
štmax_t
,‡, b, >, \

120 <=, "jd", 
__VA_ARGS__
)

	)

122 
	#as£¹_ju_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(
uštmax_t
,‡, b, ==, \

123 !=, "ju", 
__VA_ARGS__
)

	)

124 
	#as£¹_ju_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(
uštmax_t
,‡, b, !=, \

125 ==, "ju", 
__VA_ARGS__
)

	)

126 
	#as£¹_ju_É
(
a
, 
b
, ...è
	`as£¹_cmp
(
uštmax_t
,‡, b, <, \

127 >=, "ju", 
__VA_ARGS__
)

	)

128 
	#as£¹_ju_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(
uštmax_t
,‡, b, <=, \

129 >, "ju", 
__VA_ARGS__
)

	)

130 
	#as£¹_ju_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(
uštmax_t
,‡, b, >=, \

131 <, "ju", 
__VA_ARGS__
)

	)

132 
	#as£¹_ju_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(
uštmax_t
,‡, b, >, \

133 <=, "ju", 
__VA_ARGS__
)

	)

135 
	#as£¹_zd_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(
ssize_t
,‡, b, ==, \

136 !=, "zd", 
__VA_ARGS__
)

	)

137 
	#as£¹_zd_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(
ssize_t
,‡, b, !=, \

138 ==, "zd", 
__VA_ARGS__
)

	)

139 
	#as£¹_zd_É
(
a
, 
b
, ...è
	`as£¹_cmp
(
ssize_t
,‡, b, <, \

140 >=, "zd", 
__VA_ARGS__
)

	)

141 
	#as£¹_zd_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(
ssize_t
,‡, b, <=, \

142 >, "zd", 
__VA_ARGS__
)

	)

143 
	#as£¹_zd_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(
ssize_t
,‡, b, >=, \

144 <, "zd", 
__VA_ARGS__
)

	)

145 
	#as£¹_zd_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(
ssize_t
,‡, b, >, \

146 <=, "zd", 
__VA_ARGS__
)

	)

148 
	#as£¹_zu_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(
size_t
,‡, b, ==, \

149 !=, "zu", 
__VA_ARGS__
)

	)

150 
	#as£¹_zu_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(
size_t
,‡, b, !=, \

151 ==, "zu", 
__VA_ARGS__
)

	)

152 
	#as£¹_zu_É
(
a
, 
b
, ...è
	`as£¹_cmp
(
size_t
,‡, b, <, \

153 >=, "zu", 
__VA_ARGS__
)

	)

154 
	#as£¹_zu_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(
size_t
,‡, b, <=, \

155 >, "zu", 
__VA_ARGS__
)

	)

156 
	#as£¹_zu_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(
size_t
,‡, b, >=, \

157 <, "zu", 
__VA_ARGS__
)

	)

158 
	#as£¹_zu_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(
size_t
,‡, b, >, \

159 <=, "zu", 
__VA_ARGS__
)

	)

161 
	#as£¹_d32_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(
št32_t
,‡, b, ==, \

162 !=, 
FMTd32
, 
__VA_ARGS__
)

	)

163 
	#as£¹_d32_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(
št32_t
,‡, b, !=, \

164 ==, 
FMTd32
, 
__VA_ARGS__
)

	)

165 
	#as£¹_d32_É
(
a
, 
b
, ...è
	`as£¹_cmp
(
št32_t
,‡, b, <, \

166 >=, 
FMTd32
, 
__VA_ARGS__
)

	)

167 
	#as£¹_d32_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(
št32_t
,‡, b, <=, \

168 >, 
FMTd32
, 
__VA_ARGS__
)

	)

169 
	#as£¹_d32_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(
št32_t
,‡, b, >=, \

170 <, 
FMTd32
, 
__VA_ARGS__
)

	)

171 
	#as£¹_d32_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(
št32_t
,‡, b, >, \

172 <=, 
FMTd32
, 
__VA_ARGS__
)

	)

174 
	#as£¹_u32_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt32_t
,‡, b, ==, \

175 !=, 
FMTu32
, 
__VA_ARGS__
)

	)

176 
	#as£¹_u32_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt32_t
,‡, b, !=, \

177 ==, 
FMTu32
, 
__VA_ARGS__
)

	)

178 
	#as£¹_u32_É
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt32_t
,‡, b, <, \

179 >=, 
FMTu32
, 
__VA_ARGS__
)

	)

180 
	#as£¹_u32_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt32_t
,‡, b, <=, \

181 >, 
FMTu32
, 
__VA_ARGS__
)

	)

182 
	#as£¹_u32_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt32_t
,‡, b, >=, \

183 <, 
FMTu32
, 
__VA_ARGS__
)

	)

184 
	#as£¹_u32_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt32_t
,‡, b, >, \

185 <=, 
FMTu32
, 
__VA_ARGS__
)

	)

187 
	#as£¹_d64_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(
št64_t
,‡, b, ==, \

188 !=, 
FMTd64
, 
__VA_ARGS__
)

	)

189 
	#as£¹_d64_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(
št64_t
,‡, b, !=, \

190 ==, 
FMTd64
, 
__VA_ARGS__
)

	)

191 
	#as£¹_d64_É
(
a
, 
b
, ...è
	`as£¹_cmp
(
št64_t
,‡, b, <, \

192 >=, 
FMTd64
, 
__VA_ARGS__
)

	)

193 
	#as£¹_d64_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(
št64_t
,‡, b, <=, \

194 >, 
FMTd64
, 
__VA_ARGS__
)

	)

195 
	#as£¹_d64_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(
št64_t
,‡, b, >=, \

196 <, 
FMTd64
, 
__VA_ARGS__
)

	)

197 
	#as£¹_d64_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(
št64_t
,‡, b, >, \

198 <=, 
FMTd64
, 
__VA_ARGS__
)

	)

200 
	#as£¹_u64_eq
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt64_t
,‡, b, ==, \

201 !=, 
FMTu64
, 
__VA_ARGS__
)

	)

202 
	#as£¹_u64_Ã
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt64_t
,‡, b, !=, \

203 ==, 
FMTu64
, 
__VA_ARGS__
)

	)

204 
	#as£¹_u64_É
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt64_t
,‡, b, <, \

205 >=, 
FMTu64
, 
__VA_ARGS__
)

	)

206 
	#as£¹_u64_Ë
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt64_t
,‡, b, <=, \

207 >, 
FMTu64
, 
__VA_ARGS__
)

	)

208 
	#as£¹_u64_ge
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt64_t
,‡, b, >=, \

209 <, 
FMTu64
, 
__VA_ARGS__
)

	)

210 
	#as£¹_u64_gt
(
a
, 
b
, ...è
	`as£¹_cmp
(
ušt64_t
,‡, b, >, \

211 <=, 
FMTu64
, 
__VA_ARGS__
)

	)

213 
	#as£¹_b_eq
(
a
, 
b
, ...) do { \

214 
boŞ
 
a_
 = (
a
); \

215 
boŞ
 
b_
 = (
b
); \

216 ià(!(
a_
 =ğ
b_
)) { \

217 
´efix
[
ASSERT_BUFSIZE
]; \

218 
mes§ge
[
ASSERT_BUFSIZE
]; \

219 
	`m®loc_¢´štf
(
´efix
, (prefix), \

222 
__func__
, 
__FILE__
, 
__LINE__
, \

223 #a, #b, 
a_
 ? "true" : "false", \

224 
b_
 ? "true" : "false"); \

225 
	`m®loc_¢´štf
(
mes§ge
, (mes§ge), 
__VA_ARGS__
); \

226 
	`p_‹¡_ç
(
´efix
, 
mes§ge
); \

228 } 0)

	)

229 
	#as£¹_b_Ã
(
a
, 
b
, ...) do { \

230 
boŞ
 
a_
 = (
a
); \

231 
boŞ
 
b_
 = (
b
); \

232 ià(!(
a_
 !ğ
b_
)) { \

233 
´efix
[
ASSERT_BUFSIZE
]; \

234 
mes§ge
[
ASSERT_BUFSIZE
]; \

235 
	`m®loc_¢´štf
(
´efix
, (prefix), \

238 
__func__
, 
__FILE__
, 
__LINE__
, \

239 #a, #b, 
a_
 ? "true" : "false", \

240 
b_
 ? "true" : "false"); \

241 
	`m®loc_¢´štf
(
mes§ge
, (mes§ge), 
__VA_ARGS__
); \

242 
	`p_‹¡_ç
(
´efix
, 
mes§ge
); \

244 } 0)

	)

245 
	#as£¹_Œue
(
a
, ...è
	`as£¹_b_eq
×, 
Œue
, 
__VA_ARGS__
)

	)

246 
	#as£¹_çl£
(
a
, ...è
	`as£¹_b_eq
×, 
çl£
, 
__VA_ARGS__
)

	)

248 
	#as£¹_¡r_eq
(
a
, 
b
, ...) do { \

249 ià(
	`¡rcmp
((
a
), (
b
))) { \

250 
´efix
[
ASSERT_BUFSIZE
]; \

251 
mes§ge
[
ASSERT_BUFSIZE
]; \

252 
	`m®loc_¢´štf
(
´efix
, (prefix), \

256 
__func__
, 
__FILE__
, 
__LINE__
, #a, #b, 
a
, 
b
); \

257 
	`m®loc_¢´štf
(
mes§ge
, (mes§ge), 
__VA_ARGS__
); \

258 
	`p_‹¡_ç
(
´efix
, 
mes§ge
); \

260 } 0)

	)

261 
	#as£¹_¡r_Ã
(
a
, 
b
, ...) do { \

262 ià(!
	`¡rcmp
((
a
), (
b
))) { \

263 
´efix
[
ASSERT_BUFSIZE
]; \

264 
mes§ge
[
ASSERT_BUFSIZE
]; \

265 
	`m®loc_¢´štf
(
´efix
, (prefix), \

269 
__func__
, 
__FILE__
, 
__LINE__
, #a, #b, 
a
, 
b
); \

270 
	`m®loc_¢´štf
(
mes§ge
, (mes§ge), 
__VA_ARGS__
); \

271 
	`p_‹¡_ç
(
´efix
, 
mes§ge
); \

273 } 0)

	)

275 
	#as£¹_nÙ_»ached
(...) do { \

276 
´efix
[
ASSERT_BUFSIZE
]; \

277 
mes§ge
[
ASSERT_BUFSIZE
]; \

278 
	`m®loc_¢´štf
(
´efix
, (prefix), \

280 
__func__
, 
__FILE__
, 
__LINE__
); \

281 
	`m®loc_¢´štf
(
mes§ge
, (mes§ge), 
__VA_ARGS__
); \

282 
	`p_‹¡_ç
(
´efix
, 
mes§ge
); \

283 } 0)

	)

290 
	m‹¡_¡©us_·ss
 = 0,

291 
	m‹¡_¡©us_sk
 = 1,

292 
	m‹¡_¡©us_ç
 = 2,

294 
	m‹¡_¡©us_couÁ
 = 3

295 } 
	t‹¡_¡©us_t
;

297 (
	t‹¡_t
)();

299 
	#TEST_BEGIN
(
f
) \

301 
	`f
() \

303 
	`p_‹¡_š™
(#f);

	)

305 
	#TEST_END
 \

306 
Ïb–_‹¡_’d
; \

307 
Ïb–_‹¡_’d
: \

308 
	`p_‹¡_fši
(); \

309 
	}

	)
}

311 
	#‹¡
(...) \

312 
	`p_‹¡
(
__VA_ARGS__
, 
NULL
)

	)

314 
	#‹¡_no_m®loc_š™
(...) \

315 
	`p_‹¡_no_m®loc_š™
(
__VA_ARGS__
, 
NULL
)

	)

317 
	#‹¡_sk_if
(
e
) do { \

318 ià(
e
) { \

319 
	`‹¡_sk
("%s:%s:%d: Test skipped: (%s)", \

320 
__func__
, 
__FILE__
, 
__LINE__
, #e); \

321 
Ïb–_‹¡_’d
; \

323 } 0)

	)

325 
	$‹¡_sk
(cÚ¡ *
fÜm©
, ...è
	`JEMALLOC_FORMAT_PRINTF
(1, 2);

326 
	$‹¡_ç
(cÚ¡ *
fÜm©
, ...è
	`JEMALLOC_FORMAT_PRINTF
(1, 2);

329 
‹¡_¡©us_t
 
	`p_‹¡
(
‹¡_t
 *
t
, ...);

330 
‹¡_¡©us_t
 
	`p_‹¡_no_m®loc_š™
(
‹¡_t
 *
t
, ...);

331 
	`p_‹¡_š™
(cÚ¡ *
Çme
);

332 
	`p_‹¡_fši
();

333 
	`p_‹¡_ç
(cÚ¡ *
´efix
, cÚ¡ *
mes§ge
);

	@deps/jemalloc/test/include/test/thd.h

2 #ifdeà
_WIN32


3 
HANDLE
 
	tthd_t
;

5 
±h»ad_t
 
	tthd_t
;

8 
thd_ü—‹
(
thd_t
 *
thd
, *(*
´oc
)(*), *
¬g
);

9 
thd_još
(
thd_t
 
thd
, **
»t
);

	@deps/jemalloc/test/include/test/timer.h

4 
n¡ime_t
 
	mt0
;

5 
n¡ime_t
 
	mt1
;

6 } 
	ttimed–_t
;

8 
tim”_¡¬t
(
timed–_t
 *
tim”
);

9 
tim”_¡İ
(
timed–_t
 *
tim”
);

10 
ušt64_t
 
tim”_u£c
(cÚ¡ 
timed–_t
 *
tim”
);

11 
tim”_¿tio
(
timed–_t
 *
a
,imed–_ˆ*
b
, *
buf
, 
size_t
 
buæ’
);

	@deps/jemalloc/test/integration/MALLOCX_ARENA.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#NTHREADS
 10

	)

5 
boŞ
 
	ghave_dss
 =

6 #ifdeà
JEMALLOC_DSS


7 
Œue


9 
çl£


14 
	$thd_¡¬t
(*
¬g
)

16 
th»ad_šd
 = ()(
ušŒ_t
)
¬g
;

17 
¬’a_šd
;

18 *
p
;

19 
size_t
 
sz
;

21 
sz
 = (
¬’a_šd
);

22 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.ex‹nd", (*)&
¬’a_šd
, &
sz
, 
NULL
, 0),

25 ià(
th»ad_šd
 % 4 != 3) {

26 
size_t
 
mib
[3];

27 
size_t
 
mibËn
 = (
mib
) / (size_t);

28 cÚ¡ *
dss_´ecs
[] = {"disabled", "primary", "secondary"};

29 
´ec_šd
 = 
th»ad_šd
 %

30 ((
dss_´ecs
)/(*));

31 cÚ¡ *
dss
 = 
dss_´ecs
[
´ec_šd
];

32 
ex³ùed_”r
 = (
have_dss
 || 
´ec_šd
 =ğ0è? 0 : 
EFAULT
;

33 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’a.0.dss", 
mib
, &
mibËn
), 0,

35 
mib
[1] = 
¬’a_šd
;

36 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, 
NULL
, NULL, (*)&
dss
,

37 (cÚ¡ *)), 
ex³ùed_”r
,

41 
p
 = 
	`m®locx
(1, 
	`MALLOCX_ARENA
(
¬’a_šd
));

42 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

43 
	`d®locx
(
p
, 0);

45  (
NULL
);

46 
	}
}

48 
	$TEST_BEGIN
(
‹¡_MALLOCX_ARENA
)

50 
thd_t
 
thds
[
NTHREADS
];

51 
i
;

53 
i
 = 0; i < 
NTHREADS
; i++) {

54 
	`thd_ü—‹
(&
thds
[
i
], 
thd_¡¬t
,

55 (*)(
ušŒ_t
)
i
);

58 
i
 = 0; i < 
NTHREADS
; i++)

59 
	`thd_još
(
thds
[
i
], 
NULL
);

60 
	}
}

61 
TEST_END


64 
	$maš
()

67  (
	`‹¡
(

68 
‹¡_MALLOCX_ARENA
));

69 
	}
}

	@deps/jemalloc/test/integration/aligned_alloc.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#CHUNK
 0x400000

	)

4 
	#MAXALIGN
 (((
size_t
)1è<< 23)

	)

12 
	$purge
()

15 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.purge", 
NULL
, NULL, NULL, 0), 0,

17 
	}
}

19 
	$TEST_BEGIN
(
‹¡_®ignm’t_”rÜs
)

21 
size_t
 
®ignm’t
;

22 *
p
;

24 
®ignm’t
 = 0;

25 
	`£t_”ºo
(0);

26 
p
 = 
	`®igÃd_®loc
(
®ignm’t
, 1);

27 
	`as£¹_çl£
(
p
 !ğ
NULL
 || 
	`g‘_”ºo
(è!ğ
EINVAL
,

28 "Ex³ùedƒ¼Ü fÜ inv®id‡lignm’ˆ%zu", 
®ignm’t
);

30 
®ignm’t
 = (
size_t
);‡lignm’ˆ< 
MAXALIGN
;

31 
®ignm’t
 <<= 1) {

32 
	`£t_”ºo
(0);

33 
p
 = 
	`®igÃd_®loc
(
®ignm’t
 + 1, 1);

34 
	`as£¹_çl£
(
p
 !ğ
NULL
 || 
	`g‘_”ºo
(è!ğ
EINVAL
,

36 
®ignm’t
 + 1);

38 
	}
}

39 
TEST_END


41 
	$TEST_BEGIN
(
‹¡_oom_”rÜs
)

43 
size_t
 
®ignm’t
, 
size
;

44 *
p
;

46 #ià
LG_SIZEOF_PTR
 == 3

47 
®ignm’t
 = 
	`UINT64_C
(0x8000000000000000);

48 
size
 = 
	`UINT64_C
(0x8000000000000000);

50 
®ignm’t
 = 0x80000000LU;

51 
size
 = 0x80000000LU;

53 
	`£t_”ºo
(0);

54 
p
 = 
	`®igÃd_®loc
(
®ignm’t
, 
size
);

55 
	`as£¹_çl£
(
p
 !ğ
NULL
 || 
	`g‘_”ºo
(è!ğ
ENOMEM
,

57 
®ignm’t
, 
size
);

59 #ià
LG_SIZEOF_PTR
 == 3

60 
®ignm’t
 = 
	`UINT64_C
(0x4000000000000000);

61 
size
 = 
	`UINT64_C
(0xc000000000000001);

63 
®ignm’t
 = 0x40000000LU;

64 
size
 = 0xc0000001LU;

66 
	`£t_”ºo
(0);

67 
p
 = 
	`®igÃd_®loc
(
®ignm’t
, 
size
);

68 
	`as£¹_çl£
(
p
 !ğ
NULL
 || 
	`g‘_”ºo
(è!ğ
ENOMEM
,

70 
®ignm’t
, 
size
);

72 
®ignm’t
 = 0x10LU;

73 #ià
LG_SIZEOF_PTR
 == 3

74 
size
 = 
	`UINT64_C
(0xfffffffffffffff0);

76 
size
 = 0xfffffff0LU;

78 
	`£t_”ºo
(0);

79 
p
 = 
	`®igÃd_®loc
(
®ignm’t
, 
size
);

80 
	`as£¹_çl£
(
p
 !ğ
NULL
 || 
	`g‘_”ºo
(è!ğ
ENOMEM
,

82 
®ignm’t
, 
size
);

83 
	}
}

84 
TEST_END


86 
	$TEST_BEGIN
(
‹¡_®ignm’t_ªd_size
)

88 
	#NITER
 4

	)

89 
size_t
 
®ignm’t
, 
size
, 
tÙ®
;

90 
i
;

91 *
ps
[
NITER
];

93 
i
 = 0; i < 
NITER
; i++)

94 
ps
[
i
] = 
NULL
;

96 
®ignm’t
 = 8;

97 
®ignm’t
 <ğ
MAXALIGN
;

98 
®ignm’t
 <<= 1) {

99 
tÙ®
 = 0;

100 
size
 = 1;

101 
size
 < 3 * 
®ignm’t
 && size < (1U << 31);

102 
size
 +ğ(
®ignm’t
 >> (
LG_SIZEOF_PTR
-1)) - 1) {

103 
i
 = 0; i < 
NITER
; i++) {

104 
ps
[
i
] = 
	`®igÃd_®loc
(
®ignm’t
, 
size
);

105 ià(
ps
[
i
] =ğ
NULL
) {

106 
buf
[
BUFERROR_BUF
];

108 
	`buã¼Ü
(
	`g‘_”ºo
(), 
buf
, (buf));

109 
	`‹¡_ç
(

112 
®ignm’t
, 
size
, size, 
buf
);

114 
tÙ®
 +ğ
	`m®loc_u§bË_size
(
ps
[
i
]);

115 ià(
tÙ®
 >ğ(
MAXALIGN
 << 1))

118 
i
 = 0; i < 
NITER
; i++) {

119 ià(
ps
[
i
] !ğ
NULL
) {

120 
	`ä“
(
ps
[
i
]);

121 
ps
[
i
] = 
NULL
;

125 
	`purge
();

127 #undeà
NITER


128 
	}
}

129 
TEST_END


132 
	$maš
()

135  (
	`‹¡
(

136 
‹¡_®ignm’t_”rÜs
,

137 
‹¡_oom_”rÜs
,

138 
‹¡_®ignm’t_ªd_size
));

139 
	}
}

	@deps/jemalloc/test/integration/allocated.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 cÚ¡ 
boŞ
 
	gcÚfig_¡©s
 =

4 #ifdeà
JEMALLOC_STATS


5 
Œue


7 
çl£


12 
	$thd_¡¬t
(*
¬g
)

14 
”r
;

15 *
p
;

16 
ušt64_t
 
a0
, 
a1
, 
d0
, 
d1
;

17 
ušt64_t
 *
­0
, *
­1
, *
dp0
, *
dp1
;

18 
size_t
 
sz
, 
usize
;

20 
sz
 = (
a0
);

21 ià((
”r
 = 
	`m®lùl
("th»ad.®loÿ‹d", (*)&
a0
, &
sz
, 
NULL
, 0))) {

22 ià(
”r
 =ğ
ENOENT
)

23 
Ïb–_ENOENT
;

24 
	`‹¡_ç
("%s(): E¼Ü iÀm®lùl(): %s", 
__func__
,

25 
	`¡»¼Ü
(
”r
));

27 
sz
 = (
­0
);

28 ià((
”r
 = 
	`m®lùl
("th»ad.®loÿ‹dp", (*)&
­0
, &
sz
, 
NULL
, 0))) {

29 ià(
”r
 =ğ
ENOENT
)

30 
Ïb–_ENOENT
;

31 
	`‹¡_ç
("%s(): E¼Ü iÀm®lùl(): %s", 
__func__
,

32 
	`¡»¼Ü
(
”r
));

34 
	`as£¹_u64_eq
(*
­0
, 
a0
,

38 
sz
 = (
d0
);

39 ià((
”r
 = 
	`m®lùl
("th»ad.d—Îoÿ‹d", (*)&
d0
, &
sz
, 
NULL
, 0))) {

40 ià(
”r
 =ğ
ENOENT
)

41 
Ïb–_ENOENT
;

42 
	`‹¡_ç
("%s(): E¼Ü iÀm®lùl(): %s", 
__func__
,

43 
	`¡»¼Ü
(
”r
));

45 
sz
 = (
dp0
);

46 ià((
”r
 = 
	`m®lùl
("th»ad.d—Îoÿ‹dp", (*)&
dp0
, &
sz
, 
NULL
,

48 ià(
”r
 =ğ
ENOENT
)

49 
Ïb–_ENOENT
;

50 
	`‹¡_ç
("%s(): E¼Ü iÀm®lùl(): %s", 
__func__
,

51 
	`¡»¼Ü
(
”r
));

53 
	`as£¹_u64_eq
(*
dp0
, 
d0
,

57 
p
 = 
	`m®loc
(1);

58 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected malloc()ƒrror");

60 
sz
 = (
a1
);

61 
	`m®lùl
("th»ad.®loÿ‹d", (*)&
a1
, &
sz
, 
NULL
, 0);

62 
sz
 = (
­1
);

63 
	`m®lùl
("th»ad.®loÿ‹dp", (*)&
­1
, &
sz
, 
NULL
, 0);

64 
	`as£¹_u64_eq
(*
­1
, 
a1
,

67 
	`as£¹_±r_eq
(
­0
, 
­1
,

70 
usize
 = 
	`m®loc_u§bË_size
(
p
);

71 
	`as£¹_u64_Ë
(
a0
 + 
usize
, 
a1
,

75 
	`ä“
(
p
);

77 
sz
 = (
d1
);

78 
	`m®lùl
("th»ad.d—Îoÿ‹d", (*)&
d1
, &
sz
, 
NULL
, 0);

79 
sz
 = (
dp1
);

80 
	`m®lùl
("th»ad.d—Îoÿ‹dp", (*)&
dp1
, &
sz
, 
NULL
, 0);

81 
	`as£¹_u64_eq
(*
dp1
, 
d1
,

84 
	`as£¹_±r_eq
(
dp0
, 
dp1
,

87 
	`as£¹_u64_Ë
(
d0
 + 
usize
, 
d1
,

91  (
NULL
);

92 
Ïb–_ENOENT
:

93 
	`as£¹_çl£
(
cÚfig_¡©s
,

95 
	`‹¡_sk
("\"thread.allocated\" mallctl‚ot‡vailable");

96  (
NULL
);

97 
	}
}

99 
	$TEST_BEGIN
(
‹¡_maš_th»ad
)

102 
	`thd_¡¬t
(
NULL
);

103 
	}
}

104 
TEST_END


106 
	$TEST_BEGIN
(
‹¡_subth»ad
)

108 
thd_t
 
thd
;

110 
	`thd_ü—‹
(&
thd
, 
thd_¡¬t
, 
NULL
);

111 
	`thd_još
(
thd
, 
NULL
);

112 
	}
}

113 
TEST_END


116 
	$maš
()

120  (
	`‹¡
(

121 
‹¡_maš_th»ad
,

122 
‹¡_subth»ad
,

123 
‹¡_maš_th»ad
,

124 
‹¡_subth»ad
,

125 
‹¡_maš_th»ad
));

126 
	}
}

	@deps/jemalloc/test/integration/chunk.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_FILL


4 cÚ¡ *
	gm®loc_cÚf
 = "junk:false";

7 
chunk_hooks_t
 
	gÜig_hooks
;

8 
chunk_hooks_t
 
	gŞd_hooks
;

10 
boŞ
 
	gdo_d®loc
 = 
Œue
;

11 
boŞ
 
	gdo_decomm™
;

13 
boŞ
 
	gdid_®loc
;

14 
boŞ
 
	gdid_d®loc
;

15 
boŞ
 
	gdid_comm™
;

16 
boŞ
 
	gdid_decomm™
;

17 
boŞ
 
	gdid_purge
;

18 
boŞ
 
	gdid_¥l™
;

19 
boŞ
 
	gdid_m”ge
;

22 
	#TRACE_HOOK
(
fmt
, ...è
	`m®loc_´štf
(fmt, 
__VA_ARGS__
)

	)

24 
	#TRACE_HOOK
(
fmt
, ...)

	)

28 
	$chunk_®loc
(*
Ãw_addr
, 
size_t
 
size
, size_ˆ
®ignm’t
, 
boŞ
 *
z”o
,

29 
boŞ
 *
comm™
, 
¬’a_šd
)

32 
	`TRACE_HOOK
("%s(new_addr=%p, size=%zu,‡lignment=%zu, *zero=%s, "

33 "*comm™=%s,‡»Ç_šd=%u)\n", 
__func__
, 
Ãw_addr
, 
size
, 
®ignm’t
,

34 *
z”o
 ? "Œue" : "çl£", *
comm™
 ? "Œue" : "çl£", 
¬’a_šd
);

35 
did_®loc
 = 
Œue
;

36  (
Şd_hooks
.
	`®loc
(
Ãw_addr
, 
size
, 
®ignm’t
, 
z”o
, 
comm™
,

37 
¬’a_šd
));

38 
	}
}

40 
boŞ


41 
	$chunk_d®loc
(*
chunk
, 
size_t
 
size
, 
boŞ
 
comm™‹d
, 
¬’a_šd
)

44 
	`TRACE_HOOK
("%s(chunk=%p, size=%zu, committed=%s,‡rena_ind=%u)\n",

45 
__func__
, 
chunk
, 
size
, 
comm™‹d
 ? "Œue" : "çl£", 
¬’a_šd
);

46 
did_d®loc
 = 
Œue
;

47 ià(!
do_d®loc
)

48  (
Œue
);

49  (
Şd_hooks
.
	`d®loc
(
chunk
, 
size
, 
comm™‹d
, 
¬’a_šd
));

50 
	}
}

52 
boŞ


53 
	$chunk_comm™
(*
chunk
, 
size_t
 
size
, size_ˆ
off£t
, size_ˆ
Ëngth
,

54 
¬’a_šd
)

56 
boŞ
 
”r
;

58 
	`TRACE_HOOK
("%s(chunk=%p, size=%zu, offset=%zu,†ength=%zu, "

59 "¬’a_šd=%u)\n", 
__func__
, 
chunk
, 
size
, 
off£t
, 
Ëngth
,

60 
¬’a_šd
);

61 
”r
 = 
Şd_hooks
.
	`comm™
(
chunk
, 
size
, 
off£t
, 
Ëngth
, 
¬’a_šd
);

62 
did_comm™
 = !
”r
;

63  (
”r
);

64 
	}
}

66 
boŞ


67 
	$chunk_decomm™
(*
chunk
, 
size_t
 
size
, size_ˆ
off£t
, size_ˆ
Ëngth
,

68 
¬’a_šd
)

70 
boŞ
 
”r
;

72 
	`TRACE_HOOK
("%s(chunk=%p, size=%zu, offset=%zu,†ength=%zu, "

73 "¬’a_šd=%u)\n", 
__func__
, 
chunk
, 
size
, 
off£t
, 
Ëngth
,

74 
¬’a_šd
);

75 ià(!
do_decomm™
)

76  (
Œue
);

77 
”r
 = 
Şd_hooks
.
	`decomm™
(
chunk
, 
size
, 
off£t
, 
Ëngth
, 
¬’a_šd
);

78 
did_decomm™
 = !
”r
;

79  (
”r
);

80 
	}
}

82 
boŞ


83 
	$chunk_purge
(*
chunk
, 
size_t
 
size
, size_ˆ
off£t
, size_ˆ
Ëngth
,

84 
¬’a_šd
)

87 
	`TRACE_HOOK
("%s(chunk=%p, size=%zu, offset=%zu,†ength=%zu "

88 "¬’a_šd=%u)\n", 
__func__
, 
chunk
, 
size
, 
off£t
, 
Ëngth
,

89 
¬’a_šd
);

90 
did_purge
 = 
Œue
;

91  (
Şd_hooks
.
	`purge
(
chunk
, 
size
, 
off£t
, 
Ëngth
, 
¬’a_šd
));

92 
	}
}

94 
boŞ


95 
	$chunk_¥l™
(*
chunk
, 
size_t
 
size
, size_ˆ
size_a
, size_ˆ
size_b
,

96 
boŞ
 
comm™‹d
, 
¬’a_šd
)

99 
	`TRACE_HOOK
("%s(chunk=%p, size=%zu, size_a=%zu, size_b=%zu, "

100 "comm™‹d=%s,‡»Ç_šd=%u)\n", 
__func__
, 
chunk
, 
size
, 
size_a
,

101 
size_b
, 
comm™‹d
 ? "Œue" : "çl£", 
¬’a_šd
);

102 
did_¥l™
 = 
Œue
;

103  (
Şd_hooks
.
	`¥l™
(
chunk
, 
size
, 
size_a
, 
size_b
, 
comm™‹d
,

104 
¬’a_šd
));

105 
	}
}

107 
boŞ


108 
	$chunk_m”ge
(*
chunk_a
, 
size_t
 
size_a
, *
chunk_b
, size_ˆ
size_b
,

109 
boŞ
 
comm™‹d
, 
¬’a_šd
)

112 
	`TRACE_HOOK
("%s(chunk_a=%p, size_a=%zu, chunk_b=%p size_b=%zu, "

113 "comm™‹d=%s,‡»Ç_šd=%u)\n", 
__func__
, 
chunk_a
, 
size_a
, 
chunk_b
,

114 
size_b
, 
comm™‹d
 ? "Œue" : "çl£", 
¬’a_šd
);

115 
did_m”ge
 = 
Œue
;

116  (
Şd_hooks
.
	`m”ge
(
chunk_a
, 
size_a
, 
chunk_b
, 
size_b
,

117 
comm™‹d
, 
¬’a_šd
));

118 
	}
}

120 
	$TEST_BEGIN
(
‹¡_chunk
)

122 *
p
;

123 
size_t
 
Şd_size
, 
Ãw_size
, 
Ïrge0
, 
Ïrge1
, 
huge0
, 
huge1
, 
huge2
, 
sz
;

124 
¬’a_šd
;

125 
æags
;

126 
size_t
 
hooks_mib
[3], 
purge_mib
[3];

127 
size_t
 
hooks_mibËn
, 
purge_mibËn
;

128 
chunk_hooks_t
 
Ãw_hooks
 = {

129 
chunk_®loc
,

130 
chunk_d®loc
,

131 
chunk_comm™
,

132 
chunk_decomm™
,

133 
chunk_purge
,

134 
chunk_¥l™
,

135 
chunk_m”ge


137 
boŞ
 
x®locx_sucûss_a
, 
x®locx_sucûss_b
, 
x®locx_sucûss_c
;

139 
sz
 = ();

140 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.ex‹nd", (*)&
¬’a_šd
, &
sz
, 
NULL
, 0),

142 
æags
 = 
	`MALLOCX_ARENA
(
¬’a_šd
è| 
MALLOCX_TCACHE_NONE
;

145 
hooks_mibËn
 = (
hooks_mib
)/(
size_t
);

146 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’a.0.chunk_hooks", 
hooks_mib
,

147 &
hooks_mibËn
), 0, "Unexpected mallctlnametomib() failure");

148 
hooks_mib
[1] = (
size_t
)
¬’a_šd
;

149 
Şd_size
 = (
chunk_hooks_t
);

150 
Ãw_size
 = (
chunk_hooks_t
);

151 
	`as£¹_d_eq
(
	`m®lùlbymib
(
hooks_mib
, 
hooks_mibËn
, (*)&
Şd_hooks
,

152 &
Şd_size
, (*)&
Ãw_hooks
, 
Ãw_size
), 0,

154 
Üig_hooks
 = 
Şd_hooks
;

155 
	`as£¹_±r_Ã
(
Şd_hooks
.
®loc
, 
chunk_®loc
, "Unexpected‡llocƒrror");

156 
	`as£¹_±r_Ã
(
Şd_hooks
.
d®loc
, 
chunk_d®loc
,

158 
	`as£¹_±r_Ã
(
Şd_hooks
.
comm™
, 
chunk_comm™
,

160 
	`as£¹_±r_Ã
(
Şd_hooks
.
decomm™
, 
chunk_decomm™
,

162 
	`as£¹_±r_Ã
(
Şd_hooks
.
purge
, 
chunk_purge
, "Unexpected…urgeƒrror");

163 
	`as£¹_±r_Ã
(
Şd_hooks
.
¥l™
, 
chunk_¥l™
, "Unexpected splitƒrror");

164 
	`as£¹_±r_Ã
(
Şd_hooks
.
m”ge
, 
chunk_m”ge
, "Unexpected mergeƒrror");

167 
sz
 = (
size_t
);

168 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ìun.0.size", (*)&
Ïrge0
, &
sz
, 
NULL
,

170 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ìun.1.size", (*)&
Ïrge1
, &
sz
, 
NULL
,

174 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.hchunk.0.size", (*)&
huge0
, &
sz
, 
NULL
,

176 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.hchunk.1.size", (*)&
huge1
, &
sz
, 
NULL
,

178 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.hchunk.2.size", (*)&
huge2
, &
sz
, 
NULL
,

182 
purge_mibËn
 = (
purge_mib
)/(
size_t
);

183 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’a.0.purge", 
purge_mib
, &
purge_mibËn
),

185 
purge_mib
[1] = (
size_t
)
¬’a_šd
;

186 
do_d®loc
 = 
çl£
;

187 
do_decomm™
 = 
çl£
;

188 
p
 = 
	`m®locx
(
huge0
 * 2, 
æags
);

189 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

190 
did_d®loc
 = 
çl£
;

191 
did_decomm™
 = 
çl£
;

192 
did_purge
 = 
çl£
;

193 
did_¥l™
 = 
çl£
;

194 
x®locx_sucûss_a
 = (
	`x®locx
(
p
, 
huge0
, 0, 
æags
) == huge0);

195 
	`as£¹_d_eq
(
	`m®lùlbymib
(
purge_mib
, 
purge_mibËn
, 
NULL
, NULL, NULL, 0),

196 0, "UÃx³ùed‡»Ç.%u.purg”rÜ", 
¬’a_šd
);

197 ià(
x®locx_sucûss_a
) {

198 
	`as£¹_Œue
(
did_d®loc
, "Expected dalloc");

199 
	`as£¹_çl£
(
did_decomm™
, "Unexpected decommit");

200 
	`as£¹_Œue
(
did_purge
, "Expected…urge");

202 
	`as£¹_Œue
(
did_¥l™
, "Expected split");

203 
	`d®locx
(
p
, 
æags
);

204 
do_d®loc
 = 
Œue
;

207 
do_d®loc
 = 
çl£
;

208 
do_decomm™
 = 
Œue
;

209 
p
 = 
	`m®locx
(
huge0
 * 2, 
æags
);

210 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

211 
did_decomm™
 = 
çl£
;

212 
did_comm™
 = 
çl£
;

213 
did_¥l™
 = 
çl£
;

214 
did_m”ge
 = 
çl£
;

215 
x®locx_sucûss_b
 = (
	`x®locx
(
p
, 
huge0
, 0, 
æags
) == huge0);

216 
	`as£¹_d_eq
(
	`m®lùlbymib
(
purge_mib
, 
purge_mibËn
, 
NULL
, NULL, NULL, 0),

217 0, "UÃx³ùed‡»Ç.%u.purg”rÜ", 
¬’a_šd
);

218 ià(
x®locx_sucûss_b
)

219 
	`as£¹_Œue
(
did_¥l™
, "Expected split");

220 
x®locx_sucûss_c
 = (
	`x®locx
(
p
, 
huge0
 * 2, 0, 
æags
) == huge0 * 2);

221 
	`as£¹_b_eq
(
did_decomm™
, 
did_comm™
, "Expected decommit/commit match");

222 ià(
x®locx_sucûss_b
 && 
x®locx_sucûss_c
)

223 
	`as£¹_Œue
(
did_m”ge
, "Expected merge");

224 
	`d®locx
(
p
, 
æags
);

225 
do_d®loc
 = 
Œue
;

226 
do_decomm™
 = 
çl£
;

229 ià(
huge0
 * 2 > 
huge2
) {

235 
p
 = 
	`m®locx
(
huge2
, 
æags
);

236 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

237 
did_purge
 = 
çl£
;

238 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
huge1
, 0, 
æags
), huge1,

240 
	`as£¹_Œue
(
did_purge
, "Expected…urge");

241 
	`d®locx
(
p
, 
æags
);

245 
do_decomm™
 = 
Œue
;

246 
p
 = 
	`m®locx
(
Ïrge1
, 
æags
);

247 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

248 
	`as£¹_d_eq
(
	`m®lùlbymib
(
purge_mib
, 
purge_mibËn
, 
NULL
, NULL, NULL, 0),

249 0, "UÃx³ùed‡»Ç.%u.purg”rÜ", 
¬’a_šd
);

250 
did_decomm™
 = 
çl£
;

251 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge0
, 0, 
æags
),†arge0,

253 
	`as£¹_d_eq
(
	`m®lùlbymib
(
purge_mib
, 
purge_mibËn
, 
NULL
, NULL, NULL, 0),

254 0, "UÃx³ùed‡»Ç.%u.purg”rÜ", 
¬’a_šd
);

255 
did_comm™
 = 
çl£
;

256 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge1
, 0, 
æags
),†arge1,

258 
	`as£¹_b_eq
(
did_decomm™
, 
did_comm™
, "Expected decommit/commit match");

259 
	`d®locx
(
p
, 
æags
);

260 
do_decomm™
 = 
çl£
;

263 
p
 = 
	`m®locx
(42, 
æags
);

264 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

265 
	`d®locx
(
p
, 
æags
);

268 
	`as£¹_d_eq
(
	`m®lùlbymib
(
hooks_mib
, 
hooks_mibËn
, 
NULL
, NULL,

269 (*)&
Şd_hooks
, 
Ãw_size
), 0, "Unexpected chunk_hooksƒrror");

270 
	`as£¹_d_eq
(
	`m®lùlbymib
(
hooks_mib
, 
hooks_mibËn
, (*)&
Şd_hooks
,

271 &
Şd_size
, 
NULL
, 0), 0, "Unexpected chunk_hooksƒrror");

272 
	`as£¹_±r_eq
(
Şd_hooks
.
®loc
, 
Üig_hooks
.alloc,

274 
	`as£¹_±r_eq
(
Şd_hooks
.
d®loc
, 
Üig_hooks
.dalloc,

276 
	`as£¹_±r_eq
(
Şd_hooks
.
comm™
, 
Üig_hooks
.commit,

278 
	`as£¹_±r_eq
(
Şd_hooks
.
decomm™
, 
Üig_hooks
.decommit,

280 
	`as£¹_±r_eq
(
Şd_hooks
.
purge
, 
Üig_hooks
.purge,

282 
	`as£¹_±r_eq
(
Şd_hooks
.
¥l™
, 
Üig_hooks
.split,

284 
	`as£¹_±r_eq
(
Şd_hooks
.
m”ge
, 
Üig_hooks
.merge,

286 
	}
}

287 
TEST_END


290 
	$maš
()

293  (
	`‹¡
(
‹¡_chunk
));

294 
	}
}

	@deps/jemalloc/test/integration/mallocx.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_FILL


4 cÚ¡ *
	gm®loc_cÚf
 = "junk:false";

8 
	$g‘_nsizes_im¶
(cÚ¡ *
cmd
)

10 
»t
;

11 
size_t
 
z
;

13 
z
 = ();

14 
	`as£¹_d_eq
(
	`m®lùl
(
cmd
, (*)&
»t
, &
z
, 
NULL
, 0), 0,

15 "UÃx³ùed m®lùl(\"%s\", ...èçu»", 
cmd
);

17  (
»t
);

18 
	}
}

21 
	$g‘_nhuge
()

24  (
	`g‘_nsizes_im¶
("arenas.nhchunks"));

25 
	}
}

27 
size_t


28 
	$g‘_size_im¶
(cÚ¡ *
cmd
, 
size_t
 
šd
)

30 
size_t
 
»t
;

31 
size_t
 
z
;

32 
size_t
 
mib
[4];

33 
size_t
 
mibËn
 = 4;

35 
z
 = (
size_t
);

36 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
(
cmd
, 
mib
, &
mibËn
),

37 0, "UÃx³ùed m®lùÊam‘omib(\"%s\", ...èçu»", 
cmd
);

38 
mib
[2] = 
šd
;

39 
z
 = (
size_t
);

40 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
»t
, &
z
, 
NULL
, 0),

41 0, "UÃx³ùed m®lùlbymib([\"%s\", %zu], ...èçu»", 
cmd
, 
šd
);

43  (
»t
);

44 
	}
}

46 
size_t


47 
	$g‘_huge_size
(
size_t
 
šd
)

50  (
	`g‘_size_im¶
("¬’as.hchunk.0.size", 
šd
));

51 
	}
}

59 
	$purge
()

62 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.purge", 
NULL
, NULL, NULL, 0), 0,

64 
	}
}

66 
	$TEST_BEGIN
(
‹¡_ov”æow
)

68 
size_t
 
hugemax
;

70 
hugemax
 = 
	`g‘_huge_size
(
	`g‘_nhuge
()-1);

72 
	`as£¹_±r_nuÎ
(
	`m®locx
(
hugemax
+1, 0),

73 "Ex³ùed OOM fÜ m®locx(size=%#zx, 0)", 
hugemax
+1);

75 
	`as£¹_±r_nuÎ
(
	`m®locx
(
	`ZU
(
PTRDIFF_MAX
)+1, 0),

76 "Ex³ùed OOM fÜ m®locx(size=%#zx, 0)", 
	`ZU
(
PTRDIFF_MAX
)+1);

78 
	`as£¹_±r_nuÎ
(
	`m®locx
(
SIZE_T_MAX
, 0),

79 "Ex³ùed OOM fÜ m®locx(size=%#zx, 0)", 
SIZE_T_MAX
);

81 
	`as£¹_±r_nuÎ
(
	`m®locx
(1, 
	`MALLOCX_ALIGN
(
	`ZU
(
PTRDIFF_MAX
)+1)),

83 
	`ZU
(
PTRDIFF_MAX
)+1);

84 
	}
}

85 
TEST_END


87 
	$TEST_BEGIN
(
‹¡_oom
)

89 
size_t
 
hugemax
;

90 
boŞ
 
oom
;

91 *
±rs
[3];

92 
i
;

98 
hugemax
 = 
	`g‘_huge_size
(
	`g‘_nhuge
()-1);

99 
oom
 = 
çl£
;

100 
i
 = 0; i < (
±rs
) / (*); i++) {

101 
±rs
[
i
] = 
	`m®locx
(
hugemax
, 0);

102 ià(
±rs
[
i
] =ğ
NULL
)

103 
oom
 = 
Œue
;

105 
	`as£¹_Œue
(
oom
,

107 
hugemax
);

108 
i
 = 0; i < (
±rs
) / (*); i++) {

109 ià(
±rs
[
i
] !ğ
NULL
)

110 
	`d®locx
(
±rs
[
i
], 0);

112 
	`purge
();

114 #ià
LG_SIZEOF_PTR
 == 3

115 
	`as£¹_±r_nuÎ
(
	`m®locx
(0x8000000000000000ULL,

116 
	`MALLOCX_ALIGN
(0x8000000000000000ULL)),

118 
	`as£¹_±r_nuÎ
(
	`m®locx
(0x8000000000000000ULL,

119 
	`MALLOCX_ALIGN
(0x80000000)),

122 
	`as£¹_±r_nuÎ
(
	`m®locx
(0x80000000UL, 
	`MALLOCX_ALIGN
(0x80000000UL)),

125 
	}
}

126 
TEST_END


128 
	$TEST_BEGIN
(
‹¡_basic
)

130 
	#MAXSZ
 (((
size_t
)1è<< 23)

	)

131 
size_t
 
sz
;

133 
sz
 = 1; sz < 
MAXSZ
; sz = 
	`ÇÎocx
(sz, 0) + 1) {

134 
size_t
 
nsz
, 
rsz
;

135 *
p
;

136 
nsz
 = 
	`ÇÎocx
(
sz
, 0);

137 
	`as£¹_zu_Ã
(
nsz
, 0, "Unexpected‚allocx()ƒrror");

138 
p
 = 
	`m®locx
(
sz
, 0);

139 
	`as£¹_±r_nÙ_nuÎ
(
p
,

140 "UÃx³ùed m®locx(size=%zx, fÏgs=0è”rÜ", 
sz
);

141 
rsz
 = 
	`§Îocx
(
p
, 0);

142 
	`as£¹_zu_ge
(
rsz
, 
sz
, "Real size smallerhanƒxpected");

143 
	`as£¹_zu_eq
(
nsz
, 
rsz
, "nallocx()/sallocx() size mismatch");

144 
	`d®locx
(
p
, 0);

146 
p
 = 
	`m®locx
(
sz
, 0);

147 
	`as£¹_±r_nÙ_nuÎ
(
p
,

148 "UÃx³ùed m®locx(size=%zx, fÏgs=0è”rÜ", 
sz
);

149 
	`d®locx
(
p
, 0);

151 
nsz
 = 
	`ÇÎocx
(
sz
, 
MALLOCX_ZERO
);

152 
	`as£¹_zu_Ã
(
nsz
, 0, "Unexpected‚allocx()ƒrror");

153 
p
 = 
	`m®locx
(
sz
, 
MALLOCX_ZERO
);

154 
	`as£¹_±r_nÙ_nuÎ
(
p
,

156 
nsz
);

157 
rsz
 = 
	`§Îocx
(
p
, 0);

158 
	`as£¹_zu_eq
(
nsz
, 
rsz
, "nallocx()/sallocx()„size mismatch");

159 
	`d®locx
(
p
, 0);

160 
	`purge
();

162 #undeà
MAXSZ


163 
	}
}

164 
TEST_END


166 
	$TEST_BEGIN
(
‹¡_®ignm’t_ªd_size
)

168 
	#MAXALIGN
 (((
size_t
)1è<< 23)

	)

169 
	#NITER
 4

	)

170 
size_t
 
nsz
, 
rsz
, 
sz
, 
®ignm’t
, 
tÙ®
;

171 
i
;

172 *
ps
[
NITER
];

174 
i
 = 0; i < 
NITER
; i++)

175 
ps
[
i
] = 
NULL
;

177 
®ignm’t
 = 8;

178 
®ignm’t
 <ğ
MAXALIGN
;

179 
®ignm’t
 <<= 1) {

180 
tÙ®
 = 0;

181 
sz
 = 1;

182 
sz
 < 3 * 
®ignm’t
 && sz < (1U << 31);

183 
sz
 +ğ(
®ignm’t
 >> (
LG_SIZEOF_PTR
-1)) - 1) {

184 
i
 = 0; i < 
NITER
; i++) {

185 
nsz
 = 
	`ÇÎocx
(
sz
, 
	`MALLOCX_ALIGN
(
®ignm’t
) |

186 
MALLOCX_ZERO
);

187 
	`as£¹_zu_Ã
(
nsz
, 0,

189 "size=%zu (%#zx)", 
®ignm’t
, 
sz
, sz);

190 
ps
[
i
] = 
	`m®locx
(
sz
, 
	`MALLOCX_ALIGN
(
®ignm’t
) |

191 
MALLOCX_ZERO
);

192 
	`as£¹_±r_nÙ_nuÎ
(
ps
[
i
],

194 "size=%zu (%#zx)", 
®ignm’t
, 
sz
, sz);

195 
rsz
 = 
	`§Îocx
(
ps
[
i
], 0);

196 
	`as£¹_zu_ge
(
rsz
, 
sz
,

198 "®ignm’t=%zu, size=%zu", 
®ignm’t
, 
sz
);

199 
	`as£¹_zu_eq
(
nsz
, 
rsz
,

201 "®ignm’t=%zu, size=%zu", 
®ignm’t
, 
sz
);

202 
	`as£¹_±r_nuÎ
(

203 (*)((
ušŒ_t
)
ps
[
i
] & (
®ignm’t
-1)),

205 "‡lignm’t=%zu, size=%zu", 
ps
[
i
],

206 
®ignm’t
, 
sz
);

207 
tÙ®
 +ğ
rsz
;

208 ià(
tÙ®
 >ğ(
MAXALIGN
 << 1))

211 
i
 = 0; i < 
NITER
; i++) {

212 ià(
ps
[
i
] !ğ
NULL
) {

213 
	`d®locx
(
ps
[
i
], 0);

214 
ps
[
i
] = 
NULL
;

218 
	`purge
();

220 #undeà
MAXALIGN


221 #undeà
NITER


222 
	}
}

223 
TEST_END


226 
	$maš
()

229  (
	`‹¡
(

230 
‹¡_ov”æow
,

231 
‹¡_oom
,

232 
‹¡_basic
,

233 
‹¡_®ignm’t_ªd_size
));

234 
	}
}

	@deps/jemalloc/test/integration/overflow.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	$TEST_BEGIN
(
‹¡_ov”æow
)

5 
nhchunks
;

6 
size_t
 
mib
[4];

7 
size_t
 
sz
, 
mibËn
, 
max_size_şass
;

8 *
p
;

10 
sz
 = ();

11 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.nhchunks", (*)&
nhchunks
, &
sz
, 
NULL
, 0),

14 
mibËn
 = (
mib
è/ (
size_t
);

15 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’as.hchunk.0.size", 
mib
, &
mibËn
), 0,

17 
mib
[2] = 
nhchunks
 - 1;

19 
sz
 = (
size_t
);

20 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
max_size_şass
, &
sz
,

21 
NULL
, 0), 0, "Unexpected mallctlbymib()ƒrror");

23 
	`as£¹_±r_nuÎ
(
	`m®loc
(
max_size_şass
 + 1),

25 
	`as£¹_±r_nuÎ
(
	`m®loc
(
SIZE_T_MAX
),

28 
	`as£¹_±r_nuÎ
(
	`ÿÎoc
(1, 
max_size_şass
 + 1),

30 
	`as£¹_±r_nuÎ
(
	`ÿÎoc
(1, 
SIZE_T_MAX
),

33 
p
 = 
	`m®loc
(1);

34 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected malloc() OOM");

35 
	`as£¹_±r_nuÎ
(
	`»®loc
(
p
, 
max_size_şass
 + 1),

37 
	`as£¹_±r_nuÎ
(
	`»®loc
(
p
, 
SIZE_T_MAX
),

39 
	`ä“
(
p
);

40 
	}
}

41 
TEST_END


44 
	$maš
()

47  (
	`‹¡
(

48 
‹¡_ov”æow
));

49 
	}
}

	@deps/jemalloc/test/integration/posix_memalign.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#CHUNK
 0x400000

	)

4 
	#MAXALIGN
 (((
size_t
)1è<< 23)

	)

12 
	$purge
()

15 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.purge", 
NULL
, NULL, NULL, 0), 0,

17 
	}
}

19 
	$TEST_BEGIN
(
‹¡_®ignm’t_”rÜs
)

21 
size_t
 
®ignm’t
;

22 *
p
;

24 
®ignm’t
 = 0;‡lignment < (*);‡lignment++) {

25 
	`as£¹_d_eq
(
	`posix_mem®ign
(&
p
, 
®ignm’t
, 1), 
EINVAL
,

27 
®ignm’t
);

30 
®ignm’t
 = (
size_t
);‡lignm’ˆ< 
MAXALIGN
;

31 
®ignm’t
 <<= 1) {

32 
	`as£¹_d_Ã
(
	`posix_mem®ign
(&
p
, 
®ignm’t
 + 1, 1), 0,

34 
®ignm’t
 + 1);

36 
	}
}

37 
TEST_END


39 
	$TEST_BEGIN
(
‹¡_oom_”rÜs
)

41 
size_t
 
®ignm’t
, 
size
;

42 *
p
;

44 #ià
LG_SIZEOF_PTR
 == 3

45 
®ignm’t
 = 
	`UINT64_C
(0x8000000000000000);

46 
size
 = 
	`UINT64_C
(0x8000000000000000);

48 
®ignm’t
 = 0x80000000LU;

49 
size
 = 0x80000000LU;

51 
	`as£¹_d_Ã
(
	`posix_mem®ign
(&
p
, 
®ignm’t
, 
size
), 0,

53 
®ignm’t
, 
size
);

55 #ià
LG_SIZEOF_PTR
 == 3

56 
®ignm’t
 = 
	`UINT64_C
(0x4000000000000000);

57 
size
 = 
	`UINT64_C
(0xc000000000000001);

59 
®ignm’t
 = 0x40000000LU;

60 
size
 = 0xc0000001LU;

62 
	`as£¹_d_Ã
(
	`posix_mem®ign
(&
p
, 
®ignm’t
, 
size
), 0,

64 
®ignm’t
, 
size
);

66 
®ignm’t
 = 0x10LU;

67 #ià
LG_SIZEOF_PTR
 == 3

68 
size
 = 
	`UINT64_C
(0xfffffffffffffff0);

70 
size
 = 0xfffffff0LU;

72 
	`as£¹_d_Ã
(
	`posix_mem®ign
(&
p
, 
®ignm’t
, 
size
), 0,

74 
®ignm’t
, 
size
);

75 
	}
}

76 
TEST_END


78 
	$TEST_BEGIN
(
‹¡_®ignm’t_ªd_size
)

80 
	#NITER
 4

	)

81 
size_t
 
®ignm’t
, 
size
, 
tÙ®
;

82 
i
;

83 
”r
;

84 *
ps
[
NITER
];

86 
i
 = 0; i < 
NITER
; i++)

87 
ps
[
i
] = 
NULL
;

89 
®ignm’t
 = 8;

90 
®ignm’t
 <ğ
MAXALIGN
;

91 
®ignm’t
 <<= 1) {

92 
tÙ®
 = 0;

93 
size
 = 1;

94 
size
 < 3 * 
®ignm’t
 && size < (1U << 31);

95 
size
 +ğ(
®ignm’t
 >> (
LG_SIZEOF_PTR
-1)) - 1) {

96 
i
 = 0; i < 
NITER
; i++) {

97 
”r
 = 
	`posix_mem®ign
(&
ps
[
i
],

98 
®ignm’t
, 
size
);

99 ià(
”r
) {

100 
buf
[
BUFERROR_BUF
];

102 
	`buã¼Ü
(
	`g‘_”ºo
(), 
buf
, (buf));

103 
	`‹¡_ç
(

106 
®ignm’t
, 
size
, size, 
buf
);

108 
tÙ®
 +ğ
	`m®loc_u§bË_size
(
ps
[
i
]);

109 ià(
tÙ®
 >ğ(
MAXALIGN
 << 1))

112 
i
 = 0; i < 
NITER
; i++) {

113 ià(
ps
[
i
] !ğ
NULL
) {

114 
	`ä“
(
ps
[
i
]);

115 
ps
[
i
] = 
NULL
;

119 
	`purge
();

121 #undeà
NITER


122 
	}
}

123 
TEST_END


126 
	$maš
()

129  (
	`‹¡
(

130 
‹¡_®ignm’t_”rÜs
,

131 
‹¡_oom_”rÜs
,

132 
‹¡_®ignm’t_ªd_size
));

133 
	}
}

	@deps/jemalloc/test/integration/rallocx.c

1 
	~"‹¡/jem®loc_‹¡.h
"

4 
	$g‘_nsizes_im¶
(cÚ¡ *
cmd
)

6 
»t
;

7 
size_t
 
z
;

9 
z
 = ();

10 
	`as£¹_d_eq
(
	`m®lùl
(
cmd
, (*)&
»t
, &
z
, 
NULL
, 0), 0,

11 "UÃx³ùed m®lùl(\"%s\", ...èçu»", 
cmd
);

13  (
»t
);

14 
	}
}

17 
	$g‘_nhuge
()

20  (
	`g‘_nsizes_im¶
("arenas.nhchunks"));

21 
	}
}

23 
size_t


24 
	$g‘_size_im¶
(cÚ¡ *
cmd
, 
size_t
 
šd
)

26 
size_t
 
»t
;

27 
size_t
 
z
;

28 
size_t
 
mib
[4];

29 
size_t
 
mibËn
 = 4;

31 
z
 = (
size_t
);

32 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
(
cmd
, 
mib
, &
mibËn
),

33 0, "UÃx³ùed m®lùÊam‘omib(\"%s\", ...èçu»", 
cmd
);

34 
mib
[2] = 
šd
;

35 
z
 = (
size_t
);

36 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
»t
, &
z
, 
NULL
, 0),

37 0, "UÃx³ùed m®lùlbymib([\"%s\", %zu], ...èçu»", 
cmd
, 
šd
);

39  (
»t
);

40 
	}
}

42 
size_t


43 
	$g‘_huge_size
(
size_t
 
šd
)

46  (
	`g‘_size_im¶
("¬’as.hchunk.0.size", 
šd
));

47 
	}
}

49 
	$TEST_BEGIN
(
‹¡_grow_ªd_shršk
)

51 *
p
, *
q
;

52 
size_t
 
tsz
;

53 
	#NCYCLES
 3

	)

54 
i
, 
j
;

55 
	#NSZS
 2500

	)

56 
size_t
 
szs
[
NSZS
];

57 
	#MAXSZ
 
	`ZU
(12 * 1024 * 1024)

	)

59 
p
 = 
	`m®locx
(1, 0);

60 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

61 
szs
[0] = 
	`§Îocx
(
p
, 0);

63 
i
 = 0; i < 
NCYCLES
; i++) {

64 
j
 = 1; j < 
NSZS
 && 
szs
[j-1] < 
MAXSZ
; j++) {

65 
q
 = 
	`¿Îocx
(
p
, 
szs
[
j
-1]+1, 0);

66 
	`as£¹_±r_nÙ_nuÎ
(
q
,

68 
szs
[
j
-1], szs[j-1]+1);

69 
szs
[
j
] = 
	`§Îocx
(
q
, 0);

70 
	`as£¹_zu_Ã
(
szs
[
j
], szs[j-1]+1,

71 "Ex³ùed siztØb©†—¡: %zu", 
szs
[
j
-1]+1);

72 
p
 = 
q
;

75 
j
--; j > 0; j--) {

76 
q
 = 
	`¿Îocx
(
p
, 
szs
[
j
-1], 0);

77 
	`as£¹_±r_nÙ_nuÎ
(
q
,

79 
szs
[
j
], szs[j-1]);

80 
tsz
 = 
	`§Îocx
(
q
, 0);

81 
	`as£¹_zu_eq
(
tsz
, 
szs
[
j
-1],

82 "Ex³ùed size=%zu, gÙ size=%zu", 
szs
[
j
-1], 
tsz
);

83 
p
 = 
q
;

87 
	`d®locx
(
p
, 0);

88 #undeà
MAXSZ


89 #undeà
NSZS


90 #undeà
NCYCLES


91 
	}
}

92 
TEST_END


94 
boŞ


95 
	$v®id©e_fl
(cÚ¡ *
p
, 
ušt8_t
 
c
, 
size_t
 
off£t
, size_ˆ
Ën
)

97 
boŞ
 
»t
 = 
çl£
;

98 cÚ¡ 
ušt8_t
 *
buf
 = (cÚ¡ ušt8_ˆ*)
p
;

99 
size_t
 
i
;

101 
i
 = 0; i < 
Ën
; i++) {

102 
ušt8_t
 
b
 = 
buf
[
off£t
+
i
];

103 ià(
b
 !ğ
c
) {

104 
	`‹¡_ç
("Allocation‡t %p (len=%zu) contains %#x "

105 "¿th”hª %#x‡ˆoff£ˆ%zu", 
p
, 
Ën
, 
b
, 
c
,

106 
off£t
+
i
);

107 
»t
 = 
Œue
;

111  (
»t
);

112 
	}
}

114 
	$TEST_BEGIN
(
‹¡_z”o
)

116 *
p
, *
q
;

117 
size_t
 
psz
, 
qsz
, 
i
, 
j
;

118 
size_t
 
¡¬t_sizes
[] = {1, 3*1024, 63*1024, 4095*1024};

119 
	#FILL_BYTE
 0x¯U

	)

120 
	#RANGE
 2048

	)

122 
i
 = 0; i < (
¡¬t_sizes
)/(
size_t
); i++) {

123 
size_t
 
¡¬t_size
 = 
¡¬t_sizes
[
i
];

124 
p
 = 
	`m®locx
(
¡¬t_size
, 
MALLOCX_ZERO
);

125 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

126 
psz
 = 
	`§Îocx
(
p
, 0);

128 
	`as£¹_çl£
(
	`v®id©e_fl
(
p
, 0, 0, 
psz
),

130 
	`mem£t
(
p
, 
FILL_BYTE
, 
psz
);

131 
	`as£¹_çl£
(
	`v®id©e_fl
(
p
, 
FILL_BYTE
, 0, 
psz
),

134 
j
 = 1; j < 
RANGE
; j++) {

135 
q
 = 
	`¿Îocx
(
p
, 
¡¬t_size
+
j
, 
MALLOCX_ZERO
);

136 
	`as£¹_±r_nÙ_nuÎ
(
q
, "Unexpected„allocx()ƒrror");

137 
qsz
 = 
	`§Îocx
(
q
, 0);

138 ià(
q
 !ğ
p
 || 
qsz
 !ğ
psz
) {

139 
	`as£¹_çl£
(
	`v®id©e_fl
(
q
, 
FILL_BYTE
, 0,

140 
psz
), "Expected filled memory");

141 
	`as£¹_çl£
(
	`v®id©e_fl
(
q
, 0, 
psz
, 
qsz
-psz),

144 ià(
psz
 !ğ
qsz
) {

145 
	`mem£t
((*)((
ušŒ_t
)
q
+
psz
), 
FILL_BYTE
,

146 
qsz
-
psz
);

147 
psz
 = 
qsz
;

149 
p
 = 
q
;

151 
	`as£¹_çl£
(
	`v®id©e_fl
(
p
, 
FILL_BYTE
, 0, 
psz
),

153 
	`d®locx
(
p
, 0);

155 #undeà
FILL_BYTE


156 
	}
}

157 
TEST_END


159 
	$TEST_BEGIN
(
‹¡_®ign
)

161 *
p
, *
q
;

162 
size_t
 
®ign
;

163 
	#MAX_ALIGN
 (
	`ZU
(1è<< 25)

	)

165 
®ign
 = 
	`ZU
(1);

166 
p
 = 
	`m®locx
(1, 
	`MALLOCX_ALIGN
(
®ign
));

167 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

169 
®ign
 <<ğ1;‡ligÀ<ğ
MAX_ALIGN
;‡lign <<= 1) {

170 
q
 = 
	`¿Îocx
(
p
, 1, 
	`MALLOCX_ALIGN
(
®ign
));

171 
	`as£¹_±r_nÙ_nuÎ
(
q
,

172 "UÃx³ùed„®locx(è”rÜ fÜ‡lign=%zu", 
®ign
);

173 
	`as£¹_±r_nuÎ
(

174 (*)((
ušŒ_t
)
q
 & (
®ign
-1)),

176 
q
, 
®ign
);

177 
p
 = 
q
;

179 
	`d®locx
(
p
, 0);

180 #undeà
MAX_ALIGN


181 
	}
}

182 
TEST_END


184 
	$TEST_BEGIN
(
‹¡_lg_®ign_ªd_z”o
)

186 *
p
, *
q
;

187 
lg_®ign
;

188 
size_t
 
sz
;

189 
	#MAX_LG_ALIGN
 25

	)

190 
	#MAX_VALIDATE
 (
	`ZU
(1è<< 22)

	)

192 
lg_®ign
 = 0;

193 
p
 = 
	`m®locx
(1, 
	`MALLOCX_LG_ALIGN
(
lg_®ign
)|
MALLOCX_ZERO
);

194 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

196 
lg_®ign
++;†g_®igÀ<ğ
MAX_LG_ALIGN
;†g_align++) {

197 
q
 = 
	`¿Îocx
(
p
, 1, 
	`MALLOCX_LG_ALIGN
(
lg_®ign
)|
MALLOCX_ZERO
);

198 
	`as£¹_±r_nÙ_nuÎ
(
q
,

199 "UÃx³ùed„®locx(è”rÜ fÜ†g_®ign=%u", 
lg_®ign
);

200 
	`as£¹_±r_nuÎ
(

201 (*)((
ušŒ_t
)
q
 & ((
	`ZU
(1è<< 
lg_®ign
)-1)),

202 "%°šadequ©–y‡ligÃd fÜ†g_®ign=%u", 
q
, 
lg_®ign
);

203 
sz
 = 
	`§Îocx
(
q
, 0);

204 ià((
sz
 << 1è<ğ
MAX_VALIDATE
) {

205 
	`as£¹_çl£
(
	`v®id©e_fl
(
q
, 0, 0, 
sz
),

208 
	`as£¹_çl£
(
	`v®id©e_fl
(
q
, 0, 0, 
MAX_VALIDATE
),

210 
	`as£¹_çl£
(
	`v®id©e_fl
(

211 (*)((
ušŒ_t
)
q
+
sz
-
MAX_VALIDATE
),

212 0, 0, 
MAX_VALIDATE
), "Expected zeroed memory");

214 
p
 = 
q
;

216 
	`d®locx
(
p
, 0);

217 #undeà
MAX_VALIDATE


218 #undeà
MAX_LG_ALIGN


219 
	}
}

220 
TEST_END


222 
	$TEST_BEGIN
(
‹¡_ov”æow
)

224 
size_t
 
hugemax
;

225 *
p
;

227 
hugemax
 = 
	`g‘_huge_size
(
	`g‘_nhuge
()-1);

229 
p
 = 
	`m®locx
(1, 0);

230 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

232 
	`as£¹_±r_nuÎ
(
	`¿Îocx
(
p
, 
hugemax
+1, 0),

233 "Ex³ùed OOM fÜ„®locxÕ, size=%#zx, 0)", 
hugemax
+1);

235 
	`as£¹_±r_nuÎ
(
	`¿Îocx
(
p
, 
	`ZU
(
PTRDIFF_MAX
)+1, 0),

236 "Ex³ùed OOM fÜ„®locxÕ, size=%#zx, 0)", 
	`ZU
(
PTRDIFF_MAX
)+1);

238 
	`as£¹_±r_nuÎ
(
	`¿Îocx
(
p
, 
SIZE_T_MAX
, 0),

239 "Ex³ùed OOM fÜ„®locxÕ, size=%#zx, 0)", 
SIZE_T_MAX
);

241 
	`as£¹_±r_nuÎ
(
	`¿Îocx
(
p
, 1, 
	`MALLOCX_ALIGN
(
	`ZU
(
PTRDIFF_MAX
)+1)),

243 
	`ZU
(
PTRDIFF_MAX
)+1);

245 
	`d®locx
(
p
, 0);

246 
	}
}

247 
TEST_END


250 
	$maš
()

253  (
	`‹¡
(

254 
‹¡_grow_ªd_shršk
,

255 
‹¡_z”o
,

256 
‹¡_®ign
,

257 
‹¡_lg_®ign_ªd_z”o
,

258 
‹¡_ov”æow
));

259 
	}
}

	@deps/jemalloc/test/integration/sdallocx.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#MAXALIGN
 (((
size_t
)1è<< 22)

	)

4 
	#NITER
 3

	)

6 
	$TEST_BEGIN
(
‹¡_basic
)

8 *
±r
 = 
	`m®locx
(64, 0);

9 
	`sd®locx
(
±r
, 64, 0);

10 
	}
}

11 
TEST_END


13 
	$TEST_BEGIN
(
‹¡_®ignm’t_ªd_size
)

15 
size_t
 
nsz
, 
sz
, 
®ignm’t
, 
tÙ®
;

16 
i
;

17 *
ps
[
NITER
];

19 
i
 = 0; i < 
NITER
; i++)

20 
ps
[
i
] = 
NULL
;

22 
®ignm’t
 = 8;

23 
®ignm’t
 <ğ
MAXALIGN
;

24 
®ignm’t
 <<= 1) {

25 
tÙ®
 = 0;

26 
sz
 = 1;

27 
sz
 < 3 * 
®ignm’t
 && sz < (1U << 31);

28 
sz
 +ğ(
®ignm’t
 >> (
LG_SIZEOF_PTR
-1)) - 1) {

29 
i
 = 0; i < 
NITER
; i++) {

30 
nsz
 = 
	`ÇÎocx
(
sz
, 
	`MALLOCX_ALIGN
(
®ignm’t
) |

31 
MALLOCX_ZERO
);

32 
ps
[
i
] = 
	`m®locx
(
sz
, 
	`MALLOCX_ALIGN
(
®ignm’t
) |

33 
MALLOCX_ZERO
);

34 
tÙ®
 +ğ
nsz
;

35 ià(
tÙ®
 >ğ(
MAXALIGN
 << 1))

38 
i
 = 0; i < 
NITER
; i++) {

39 ià(
ps
[
i
] !ğ
NULL
) {

40 
	`sd®locx
(
ps
[
i
], 
sz
,

41 
	`MALLOCX_ALIGN
(
®ignm’t
));

42 
ps
[
i
] = 
NULL
;

47 
	}
}

48 
TEST_END


51 
	$maš
()

54  (
	`‹¡
(

55 
‹¡_basic
,

56 
‹¡_®ignm’t_ªd_size
));

57 
	}
}

	@deps/jemalloc/test/integration/thread_arena.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#NTHREADS
 10

	)

6 
	$thd_¡¬t
(*
¬g
)

8 
maš_¬’a_šd
 = *(*)
¬g
;

9 *
p
;

10 
¬’a_šd
;

11 
size_t
 
size
;

12 
”r
;

14 
p
 = 
	`m®loc
(1);

15 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Error in malloc()");

16 
	`ä“
(
p
);

18 
size
 = (
¬’a_šd
);

19 ià((
”r
 = 
	`m®lùl
("th»ad.¬’a", (*)&
¬’a_šd
, &
size
,

20 (*)&
maš_¬’a_šd
, (main_arena_ind)))) {

21 
buf
[
BUFERROR_BUF
];

23 
	`buã¼Ü
(
”r
, 
buf
, (buf));

24 
	`‹¡_ç
("E¼Ü iÀm®lùl(): %s", 
buf
);

27 
size
 = (
¬’a_šd
);

28 ià((
”r
 = 
	`m®lùl
("th»ad.¬’a", (*)&
¬’a_šd
, &
size
, 
NULL
,

30 
buf
[
BUFERROR_BUF
];

32 
	`buã¼Ü
(
”r
, 
buf
, (buf));

33 
	`‹¡_ç
("E¼Ü iÀm®lùl(): %s", 
buf
);

35 
	`as£¹_u_eq
(
¬’a_šd
, 
maš_¬’a_šd
,

38  (
NULL
);

39 
	}
}

41 
	$TEST_BEGIN
(
‹¡_th»ad_¬’a
)

43 *
p
;

44 
¬’a_šd
;

45 
size_t
 
size
;

46 
”r
;

47 
thd_t
 
thds
[
NTHREADS
];

48 
i
;

50 
p
 = 
	`m®loc
(1);

51 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Error in malloc()");

53 
size
 = (
¬’a_šd
);

54 ià((
”r
 = 
	`m®lùl
("th»ad.¬’a", (*)&
¬’a_šd
, &
size
, 
NULL
,

56 
buf
[
BUFERROR_BUF
];

58 
	`buã¼Ü
(
”r
, 
buf
, (buf));

59 
	`‹¡_ç
("E¼Ü iÀm®lùl(): %s", 
buf
);

62 
i
 = 0; i < 
NTHREADS
; i++) {

63 
	`thd_ü—‹
(&
thds
[
i
], 
thd_¡¬t
,

64 (*)&
¬’a_šd
);

67 
i
 = 0; i < 
NTHREADS
; i++) {

68 
šŒ_t
 
još_»t
;

69 
	`thd_još
(
thds
[
i
], (*)&
još_»t
);

70 
	`as£¹_zd_eq
(
još_»t
, 0, "Unexpectedhread joinƒrror");

72 
	}
}

73 
TEST_END


76 
	$maš
()

79  (
	`‹¡
(

80 
‹¡_th»ad_¬’a
));

81 
	}
}

	@deps/jemalloc/test/integration/thread_tcache_enabled.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 cÚ¡ 
boŞ
 
	gcÚfig_tÿche
 =

4 #ifdeà
JEMALLOC_TCACHE


5 
Œue


7 
çl£


12 
	$thd_¡¬t
(*
¬g
)

14 
”r
;

15 
size_t
 
sz
;

16 
boŞ
 
e0
, 
e1
;

18 
sz
 = (
boŞ
);

19 ià((
”r
 = 
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
, 
NULL
,

21 ià(
”r
 =ğ
ENOENT
) {

22 
	`as£¹_çl£
(
cÚfig_tÿche
,

26 
Ïb–_ENOENT
;

29 ià(
e0
) {

30 
e1
 = 
çl£
;

31 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
,

32 (*)&
e1
, 
sz
), 0, "Unexpected mallctl()ƒrror");

33 
	`as£¹_Œue
(
e0
, "tcache should beƒnabled");

36 
e1
 = 
Œue
;

37 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
,

38 (*)&
e1
, 
sz
), 0, "Unexpected mallctl()ƒrror");

39 
	`as£¹_çl£
(
e0
, "tcache should be disabled");

41 
e1
 = 
Œue
;

42 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
,

43 (*)&
e1
, 
sz
), 0, "Unexpected mallctl()ƒrror");

44 
	`as£¹_Œue
(
e0
, "tcache should beƒnabled");

46 
e1
 = 
çl£
;

47 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
,

48 (*)&
e1
, 
sz
), 0, "Unexpected mallctl()ƒrror");

49 
	`as£¹_Œue
(
e0
, "tcache should beƒnabled");

51 
e1
 = 
çl£
;

52 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
,

53 (*)&
e1
, 
sz
), 0, "Unexpected mallctl()ƒrror");

54 
	`as£¹_çl£
(
e0
, "tcache should be disabled");

56 
	`ä“
(
	`m®loc
(1));

57 
e1
 = 
Œue
;

58 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
,

59 (*)&
e1
, 
sz
), 0, "Unexpected mallctl()ƒrror");

60 
	`as£¹_çl£
(
e0
, "tcache should be disabled");

62 
	`ä“
(
	`m®loc
(1));

63 
e1
 = 
Œue
;

64 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
,

65 (*)&
e1
, 
sz
), 0, "Unexpected mallctl()ƒrror");

66 
	`as£¹_Œue
(
e0
, "tcache should beƒnabled");

68 
	`ä“
(
	`m®loc
(1));

69 
e1
 = 
çl£
;

70 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
,

71 (*)&
e1
, 
sz
), 0, "Unexpected mallctl()ƒrror");

72 
	`as£¹_Œue
(
e0
, "tcache should beƒnabled");

74 
	`ä“
(
	`m®loc
(1));

75 
e1
 = 
çl£
;

76 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.’abËd", (*)&
e0
, &
sz
,

77 (*)&
e1
, 
sz
), 0, "Unexpected mallctl()ƒrror");

78 
	`as£¹_çl£
(
e0
, "tcache should be disabled");

80 
	`ä“
(
	`m®loc
(1));

81  (
NULL
);

82 
Ïb–_ENOENT
:

83 
	`‹¡_sk
("\"thread.tcache.enabled\" mallctl‚ot‡vailable");

84  (
NULL
);

85 
	}
}

87 
	$TEST_BEGIN
(
‹¡_maš_th»ad
)

90 
	`thd_¡¬t
(
NULL
);

91 
	}
}

92 
TEST_END


94 
	$TEST_BEGIN
(
‹¡_subth»ad
)

96 
thd_t
 
thd
;

98 
	`thd_ü—‹
(&
thd
, 
thd_¡¬t
, 
NULL
);

99 
	`thd_još
(
thd
, 
NULL
);

100 
	}
}

101 
TEST_END


104 
	$maš
()

108  (
	`‹¡
(

109 
‹¡_maš_th»ad
,

110 
‹¡_subth»ad
,

111 
‹¡_maš_th»ad
,

112 
‹¡_subth»ad
,

113 
‹¡_maš_th»ad
));

114 
	}
}

	@deps/jemalloc/test/integration/xallocx.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_FILL


4 cÚ¡ *
	gm®loc_cÚf
 = "junk:false";

13 
	$¬’a_šd
()

15 
šd
 = 0;

17 ià(
šd
 == 0) {

18 
size_t
 
sz
 = (
šd
);

19 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.ex‹nd", (*)&
šd
, &
sz
, 
NULL
,

23  (
šd
);

24 
	}
}

26 
	$TEST_BEGIN
(
‹¡_§me_size
)

28 *
p
;

29 
size_t
 
sz
, 
tsz
;

31 
p
 = 
	`m®locx
(42, 0);

32 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

33 
sz
 = 
	`§Îocx
(
p
, 0);

35 
tsz
 = 
	`x®locx
(
p
, 
sz
, 0, 0);

36 
	`as£¹_zu_eq
(
tsz
, 
sz
, "Unexpected size change: %zu --> %zu", sz,sz);

38 
	`d®locx
(
p
, 0);

39 
	}
}

40 
TEST_END


42 
	$TEST_BEGIN
(
‹¡_exŒa_no_move
)

44 *
p
;

45 
size_t
 
sz
, 
tsz
;

47 
p
 = 
	`m®locx
(42, 0);

48 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

49 
sz
 = 
	`§Îocx
(
p
, 0);

51 
tsz
 = 
	`x®locx
(
p
, 
sz
, sz-42, 0);

52 
	`as£¹_zu_eq
(
tsz
, 
sz
, "Unexpected size change: %zu --> %zu", sz,sz);

54 
	`d®locx
(
p
, 0);

55 
	}
}

56 
TEST_END


58 
	$TEST_BEGIN
(
‹¡_no_move_ç
)

60 *
p
;

61 
size_t
 
sz
, 
tsz
;

63 
p
 = 
	`m®locx
(42, 0);

64 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

65 
sz
 = 
	`§Îocx
(
p
, 0);

67 
tsz
 = 
	`x®locx
(
p
, 
sz
 + 5, 0, 0);

68 
	`as£¹_zu_eq
(
tsz
, 
sz
, "Unexpected size change: %zu --> %zu", sz,sz);

70 
	`d®locx
(
p
, 0);

71 
	}
}

72 
TEST_END


75 
	$g‘_nsizes_im¶
(cÚ¡ *
cmd
)

77 
»t
;

78 
size_t
 
z
;

80 
z
 = ();

81 
	`as£¹_d_eq
(
	`m®lùl
(
cmd
, (*)&
»t
, &
z
, 
NULL
, 0), 0,

82 "UÃx³ùed m®lùl(\"%s\", ...èçu»", 
cmd
);

84  (
»t
);

85 
	}
}

88 
	$g‘_nsm®l
()

91  (
	`g‘_nsizes_im¶
("arenas.nbins"));

92 
	}
}

95 
	$g‘_Æ¬ge
()

98  (
	`g‘_nsizes_im¶
("arenas.nlruns"));

99 
	}
}

102 
	$g‘_nhuge
()

105  (
	`g‘_nsizes_im¶
("arenas.nhchunks"));

106 
	}
}

108 
size_t


109 
	$g‘_size_im¶
(cÚ¡ *
cmd
, 
size_t
 
šd
)

111 
size_t
 
»t
;

112 
size_t
 
z
;

113 
size_t
 
mib
[4];

114 
size_t
 
mibËn
 = 4;

116 
z
 = (
size_t
);

117 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
(
cmd
, 
mib
, &
mibËn
),

118 0, "UÃx³ùed m®lùÊam‘omib(\"%s\", ...èçu»", 
cmd
);

119 
mib
[2] = 
šd
;

120 
z
 = (
size_t
);

121 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
»t
, &
z
, 
NULL
, 0),

122 0, "UÃx³ùed m®lùlbymib([\"%s\", %zu], ...èçu»", 
cmd
, 
šd
);

124  (
»t
);

125 
	}
}

127 
size_t


128 
	$g‘_sm®l_size
(
size_t
 
šd
)

131  (
	`g‘_size_im¶
("¬’as.bš.0.size", 
šd
));

132 
	}
}

134 
size_t


135 
	$g‘_Ïrge_size
(
size_t
 
šd
)

138  (
	`g‘_size_im¶
("¬’as.Ìun.0.size", 
šd
));

139 
	}
}

141 
size_t


142 
	$g‘_huge_size
(
size_t
 
šd
)

145  (
	`g‘_size_im¶
("¬’as.hchunk.0.size", 
šd
));

146 
	}
}

148 
	$TEST_BEGIN
(
‹¡_size
)

150 
size_t
 
sm®l0
, 
hugemax
;

151 *
p
;

154 
sm®l0
 = 
	`g‘_sm®l_size
(0);

155 
hugemax
 = 
	`g‘_huge_size
(
	`g‘_nhuge
()-1);

157 
p
 = 
	`m®locx
(
sm®l0
, 0);

158 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

161 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 1, 0, 0), 
sm®l0
,

165 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
hugemax
, 0, 0), hugemax,

169 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
hugemax
+1, 0, 0), hugemax,

171 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
SIZE_T_MAX
, 0, 0), 
hugemax
,

174 
	`d®locx
(
p
, 0);

175 
	}
}

176 
TEST_END


178 
	$TEST_BEGIN
(
‹¡_size_exŒa_ov”æow
)

180 
size_t
 
sm®l0
, 
hugemax
;

181 *
p
;

184 
sm®l0
 = 
	`g‘_sm®l_size
(0);

185 
hugemax
 = 
	`g‘_huge_size
(
	`g‘_nhuge
()-1);

187 
p
 = 
	`m®locx
(
sm®l0
, 0);

188 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

191 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
hugemax
-1, 2, 0), hugemax,

193 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
hugemax
, 1, 0), hugemax,

197 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
hugemax
+1, 2, 0), hugemax,

199 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
hugemax
+2, 3, 0), hugemax,

201 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
SIZE_T_MAX
-2, 2, 0), 
hugemax
,

203 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
SIZE_T_MAX
-1, 1, 0), 
hugemax
,

206 
	`d®locx
(
p
, 0);

207 
	}
}

208 
TEST_END


210 
	$TEST_BEGIN
(
‹¡_exŒa_sm®l
)

212 
size_t
 
sm®l0
, 
sm®l1
, 
hugemax
;

213 *
p
;

216 
sm®l0
 = 
	`g‘_sm®l_size
(0);

217 
sm®l1
 = 
	`g‘_sm®l_size
(1);

218 
hugemax
 = 
	`g‘_huge_size
(
	`g‘_nhuge
()-1);

220 
p
 = 
	`m®locx
(
sm®l0
, 0);

221 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

223 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sm®l1
, 0, 0), 
sm®l0
,

226 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sm®l1
, 0, 0), 
sm®l0
,

229 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sm®l0
, 
sm®l1
 - small0, 0), small0,

233 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sm®l0
, 
hugemax
 - small0 + 1, 0), small0,

235 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sm®l0
, 
SIZE_T_MAX
 - small0, 0), small0,

238 
	`d®locx
(
p
, 0);

239 
	}
}

240 
TEST_END


242 
	$TEST_BEGIN
(
‹¡_exŒa_Ïrge
)

244 
æags
 = 
	`MALLOCX_ARENA
(
	`¬’a_šd
());

245 
size_t
 
sm®lmax
, 
Ïrge0
, 
Ïrge1
, 
Ïrge2
, 
huge0
, 
hugemax
;

246 *
p
;

249 
sm®lmax
 = 
	`g‘_sm®l_size
(
	`g‘_nsm®l
()-1);

250 
Ïrge0
 = 
	`g‘_Ïrge_size
(0);

251 
Ïrge1
 = 
	`g‘_Ïrge_size
(1);

252 
Ïrge2
 = 
	`g‘_Ïrge_size
(2);

253 
huge0
 = 
	`g‘_huge_size
(0);

254 
hugemax
 = 
	`g‘_huge_size
(
	`g‘_nhuge
()-1);

256 
p
 = 
	`m®locx
(
Ïrge2
, 
æags
);

257 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

259 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge2
, 0, 
æags
),†arge2,

262 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge0
, 0, 
æags
),†arge0,

264 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sm®lmax
, 0, 
æags
), 
Ïrge0
,

267 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge2
, 0, 
æags
),†arge2,

270 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge0
, 
Ïrge2
 -†¬ge0, 
æags
),†arge2,

272 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge1
, 
Ïrge2
 -†¬ge1, 
æags
),†arge2,

274 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge0
, 
Ïrge1
 -†¬ge0, 
æags
),†arge1,

276 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sm®lmax
, 
Ïrge0
 - sm®lmax, 
æags
),†arge0,

279 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge0
, 0, 
æags
),†arge0,

282 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge2
, 0, 
æags
),†arge2,

284 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
huge0
, 0, 
æags
), 
Ïrge2
,

287 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge0
, 0, 
æags
),†arge0,

290 
	`as£¹_zu_É
(
	`x®locx
(
p
, 
Ïrge0
, 
huge0
 -†¬ge0, 
æags
), huge0,

293 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge0
, 0, 
æags
),†arge0,

296 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge0
, 
Ïrge2
 -†¬ge0, 
æags
),†arge2,

299 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
Ïrge2
, 0, 
æags
),†arge2,

302 
	`as£¹_zu_É
(
	`x®locx
(
p
, 
Ïrge2
, 
hugemax
 -†¬ge2 + 1, 
æags
), 
huge0
,

305 
	`d®locx
(
p
, 
æags
);

306 
	}
}

307 
TEST_END


309 
	$TEST_BEGIN
(
‹¡_exŒa_huge
)

311 
æags
 = 
	`MALLOCX_ARENA
(
	`¬’a_šd
());

312 
size_t
 
Ïrgemax
, 
huge1
, 
huge2
, 
huge3
, 
hugemax
;

313 *
p
;

316 
Ïrgemax
 = 
	`g‘_Ïrge_size
(
	`g‘_Æ¬ge
()-1);

317 
huge1
 = 
	`g‘_huge_size
(1);

318 
huge2
 = 
	`g‘_huge_size
(2);

319 
huge3
 = 
	`g‘_huge_size
(3);

320 
hugemax
 = 
	`g‘_huge_size
(
	`g‘_nhuge
()-1);

322 
p
 = 
	`m®locx
(
huge3
, 
æags
);

323 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

325 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
huge3
, 0, 
æags
), huge3,

328 
	`as£¹_zu_ge
(
	`x®locx
(
p
, 
huge1
, 0, 
æags
), huge1,

330 
	`as£¹_zu_ge
(
	`x®locx
(
p
, 
Ïrgemax
, 0, 
æags
), 
huge1
,

333 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
huge3
, 0, 
æags
), huge3,

336 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
huge1
, 
huge3
 - huge1, 
æags
), huge3,

338 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
huge2
, 
huge3
 - huge2, 
æags
), huge3,

340 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
huge1
, 
huge2
 - huge1, 
æags
), huge2,

342 
	`as£¹_zu_ge
(
	`x®locx
(
p
, 
Ïrgemax
, 
huge1
 -†¬gemax, 
æags
), huge1,

345 
	`as£¹_zu_ge
(
	`x®locx
(
p
, 
huge1
, 0, 
æags
), huge1,

348 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
huge3
, 0, 
æags
), huge3,

350 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
hugemax
+1, 0, 
æags
), 
huge3
,

353 
	`as£¹_zu_ge
(
	`x®locx
(
p
, 
huge1
, 0, 
æags
), huge1,

356 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
huge1
, 
SIZE_T_MAX
 - huge1, 
æags
), 
hugemax
,

359 
	`as£¹_zu_ge
(
	`x®locx
(
p
, 
huge1
, 0, 
æags
), huge1,

362 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
huge1
, 
huge3
 - huge1, 
æags
), huge3,

365 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
huge3
, 0, 
æags
), huge3,

368 
	`as£¹_zu_Ë
(
	`x®locx
(
p
, 
huge3
, 
hugemax
 - huge3 + 1, 
æags
), hugemax,

371 
	`d®locx
(
p
, 
æags
);

372 
	}
}

373 
TEST_END


376 
	$´št_fËd_ex‹Ás
(cÚ¡ *
p
, 
ušt8_t
 
c
, 
size_t
 
Ën
)

378 cÚ¡ 
ušt8_t
 *
pc
 = (cÚ¡ ušt8_ˆ*)
p
;

379 
size_t
 
i
, 
¿nge0
;

380 
ušt8_t
 
c0
;

382 
	`m®loc_´štf
("…=%p, c=%#x,†’=%zu:", 
p
, 
c
, 
Ën
);

383 
¿nge0
 = 0;

384 
c0
 = 
pc
[0];

385 
i
 = 0; i < 
Ën
; i++) {

386 ià(
pc
[
i
] !ğ
c0
) {

387 
	`m®loc_´štf
(" %#x[%zu..%zu)", 
c0
, 
¿nge0
, 
i
);

388 
¿nge0
 = 
i
;

389 
c0
 = 
pc
[
i
];

392 
	`m®loc_´štf
(" %#x[%zu..%zu)\n", 
c0
, 
¿nge0
, 
i
);

393 
	}
}

395 
boŞ


396 
	$v®id©e_fl
(cÚ¡ *
p
, 
ušt8_t
 
c
, 
size_t
 
off£t
, size_ˆ
Ën
)

398 cÚ¡ 
ušt8_t
 *
pc
 = (cÚ¡ ušt8_ˆ*)
p
;

399 
boŞ
 
”r
;

400 
size_t
 
i
;

402 
i
 = 
off£t
, 
”r
 = 
çl£
; i < off£t+
Ën
; i++) {

403 ià(
pc
[
i
] !ğ
c
)

404 
”r
 = 
Œue
;

407 ià(
”r
)

408 
	`´št_fËd_ex‹Ás
(
p
, 
c
, 
off£t
 + 
Ën
);

410  (
”r
);

411 
	}
}

414 
	$‹¡_z”o
(
size_t
 
szmš
, size_ˆ
szmax
)

416 
æags
 = 
	`MALLOCX_ARENA
(
	`¬’a_šd
()è| 
MALLOCX_ZERO
;

417 
size_t
 
sz
, 
nsz
;

418 *
p
;

419 
	#FILL_BYTE
 0x7aU

	)

421 
sz
 = 
szmax
;

422 
p
 = 
	`m®locx
(
sz
, 
æags
);

423 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx()ƒrror");

424 
	`as£¹_çl£
(
	`v®id©e_fl
(
p
, 0x00, 0, 
sz
), "Memory‚ot filled: sz=%zu",

425 
sz
);

431 
	`mem£t
(
p
, 
FILL_BYTE
, 
sz
);

432 
	`as£¹_çl£
(
	`v®id©e_fl
(
p
, 
FILL_BYTE
, 0, 
sz
),

433 "MemÜy‚Ù fËd: sz=%zu", 
sz
);

436 
sz
 = 
szmš
;

437 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sz
, 0, 
æags
), sz,

439 
	`as£¹_çl£
(
	`v®id©e_fl
(
p
, 
FILL_BYTE
, 0, 
sz
),

440 "MemÜy‚Ù fËd: sz=%zu", 
sz
);

442 
sz
 = 
szmš
; sz < 
szmax
; sz = 
nsz
) {

443 
nsz
 = 
	`ÇÎocx
(
sz
+1, 
æags
);

444 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sz
+1, 0, 
æags
), 
nsz
,

446 
	`as£¹_çl£
(
	`v®id©e_fl
(
p
, 
FILL_BYTE
, 0, 
sz
),

447 "MemÜy‚Ù fËd: sz=%zu", 
sz
);

448 
	`as£¹_çl£
(
	`v®id©e_fl
(
p
, 0x00, 
sz
, 
nsz
-sz),

449 "MemÜy‚Ù fËd: sz=%zu,‚sz-sz=%zu", 
sz
, 
nsz
-sz);

450 
	`mem£t
((*)((
ušŒ_t
)
p
 + 
sz
), 
FILL_BYTE
, 
nsz
-sz);

451 
	`as£¹_çl£
(
	`v®id©e_fl
(
p
, 
FILL_BYTE
, 0, 
nsz
),

452 "MemÜy‚Ù fËd:‚sz=%zu", 
nsz
);

455 
	`d®locx
(
p
, 
æags
);

456 
	}
}

458 
	$TEST_BEGIN
(
‹¡_z”o_Ïrge
)

460 
size_t
 
Ïrge0
, 
Ïrgemax
;

463 
Ïrge0
 = 
	`g‘_Ïrge_size
(0);

464 
Ïrgemax
 = 
	`g‘_Ïrge_size
(
	`g‘_Æ¬ge
()-1);

466 
	`‹¡_z”o
(
Ïrge0
, 
Ïrgemax
);

467 
	}
}

468 
TEST_END


470 
	$TEST_BEGIN
(
‹¡_z”o_huge
)

472 
size_t
 
huge0
, 
huge1
;

475 
huge0
 = 
	`g‘_huge_size
(0);

476 
huge1
 = 
	`g‘_huge_size
(1);

478 
	`‹¡_z”o
(
huge1
, 
huge0
 * 2);

479 
	}
}

480 
TEST_END


483 
	$maš
()

486  (
	`‹¡
(

487 
‹¡_§me_size
,

488 
‹¡_exŒa_no_move
,

489 
‹¡_no_move_ç
,

490 
‹¡_size
,

491 
‹¡_size_exŒa_ov”æow
,

492 
‹¡_exŒa_sm®l
,

493 
‹¡_exŒa_Ïrge
,

494 
‹¡_exŒa_huge
,

495 
‹¡_z”o_Ïrge
,

496 
‹¡_z”o_huge
));

497 
	}
}

	@deps/jemalloc/test/src/SFMT.c

48 
	#SFMT_C_


	)

49 
	~"‹¡/jem®loc_‹¡.h
"

50 
	~"‹¡/SFMT-·¿ms.h
"

52 #ià
defšed
(
JEMALLOC_BIG_ENDIAN
è&& !defšed(
BIG_ENDIAN64
)

53 
	#BIG_ENDIAN64
 1

	)

55 #ià
defšed
(
__BIG_ENDIAN__
è&& !defšed(
__amd64
è&& !defšed(
BIG_ENDIAN64
)

56 
	#BIG_ENDIAN64
 1

	)

58 #ià
defšed
(
HAVE_ALTIVEC
è&& !defšed(
BIG_ENDIAN64
)

59 
	#BIG_ENDIAN64
 1

	)

61 #ià
defšed
(
ONLY64
è&& !defšed(
BIG_ENDIAN64
)

62 #ià
defšed
(
__GNUC__
)

65 #undeà
ONLY64


70 #ià
defšed
(
HAVE_ALTIVEC
)

72 
	uW128_T
 {

73 
veùÜ
 
	ms
;

74 
ušt32_t
 
	mu
[4];

77 
W128_T
 
	tw128_t
;

79 #–ià
defšed
(
HAVE_SSE2
)

81 
	uW128_T
 {

82 
__m128i
 
	msi
;

83 
ušt32_t
 
	mu
[4];

86 
W128_T
 
	tw128_t
;

91 
	sW128_T
 {

92 
ušt32_t
 
	mu
[4];

95 
W128_T
 
	tw128_t
;

99 
	ssfmt_s
 {

101 
w128_t
 
	msfmt
[
N
];

103 
	midx
;

106 
	mš™Ÿlized
;

115 
ušt32_t
 
	g·r™y
[4] = {
PARITY1
, 
PARITY2
, 
PARITY3
, 
PARITY4
};

120 
JEMALLOC_INLINE_C
 
idxof
(
i
);

121 #ià(!
defšed
(
HAVE_ALTIVEC
)è&& (!defšed(
HAVE_SSE2
))

122 
JEMALLOC_INLINE_C
 
rshiá128
(
w128_t
 *
out
, w128_ˆcÚ¡ *
š
, 
shiá
);

123 
JEMALLOC_INLINE_C
 
lshiá128
(
w128_t
 *
out
, w128_ˆcÚ¡ *
š
, 
shiá
);

125 
JEMALLOC_INLINE_C
 
g’_¿nd_®l
(
sfmt_t
 *
ùx
);

126 
JEMALLOC_INLINE_C
 
g’_¿nd_¬¿y
(
sfmt_t
 *
ùx
, 
w128_t
 *
¬¿y
, 
size
);

127 
JEMALLOC_INLINE_C
 
ušt32_t
 
func1
(ušt32_ˆ
x
);

128 
JEMALLOC_INLINE_C
 
ušt32_t
 
func2
(ušt32_ˆ
x
);

129 
³riod_û¹ifiÿtiÚ
(
sfmt_t
 *
ùx
);

130 #ià
defšed
(
BIG_ENDIAN64
è&& !defšed(
ONLY64
)

131 
JEMALLOC_INLINE_C
 
sw­
(
w128_t
 *
¬¿y
, 
size
);

134 #ià
defšed
(
HAVE_ALTIVEC
)

135 
	~"‹¡/SFMT-®ti.h
"

136 #–ià
defšed
(
HAVE_SSE2
)

137 
	~"‹¡/SFMT-s£2.h
"

144 #ifdeà
ONLY64


145 
JEMALLOC_INLINE_C
 
	$idxof
(
i
) {

146  
i
 ^ 1;

147 
	}
}

149 
JEMALLOC_INLINE_C
 
	$idxof
(
i
) {

150  
i
;

151 
	}
}

161 #ià(!
defšed
(
HAVE_ALTIVEC
)è&& (!defšed(
HAVE_SSE2
))

162 #ifdeà
ONLY64


163 
JEMALLOC_INLINE_C
 
	$rshiá128
(
w128_t
 *
out
, w128_ˆcÚ¡ *
š
, 
shiá
) {

164 
ušt64_t
 
th
, 

, 
oh
, 
Ş
;

166 
th
 = ((
ušt64_t
)
š
->
u
[2] << 32) | ((uint64_t)in->u[3]);

167 

 = ((
ušt64_t
)
š
->
u
[0] << 32) | ((uint64_t)in->u[1]);

169 
oh
 = 
th
 >> (
shiá
 * 8);

170 
Ş
 = 

 >> (
shiá
 * 8);

171 
Ş
 |ğ
th
 << (64 - 
shiá
 * 8);

172 
out
->
u
[0] = (
ušt32_t
)(
Ş
 >> 32);

173 
out
->
u
[1] = (
ušt32_t
)
Ş
;

174 
out
->
u
[2] = (
ušt32_t
)(
oh
 >> 32);

175 
out
->
u
[3] = (
ušt32_t
)
oh
;

176 
	}
}

178 
JEMALLOC_INLINE_C
 
	$rshiá128
(
w128_t
 *
out
, w128_ˆcÚ¡ *
š
, 
shiá
) {

179 
ušt64_t
 
th
, 

, 
oh
, 
Ş
;

181 
th
 = ((
ušt64_t
)
š
->
u
[3] << 32) | ((uint64_t)in->u[2]);

182 

 = ((
ušt64_t
)
š
->
u
[1] << 32) | ((uint64_t)in->u[0]);

184 
oh
 = 
th
 >> (
shiá
 * 8);

185 
Ş
 = 

 >> (
shiá
 * 8);

186 
Ş
 |ğ
th
 << (64 - 
shiá
 * 8);

187 
out
->
u
[1] = (
ušt32_t
)(
Ş
 >> 32);

188 
out
->
u
[0] = (
ušt32_t
)
Ş
;

189 
out
->
u
[3] = (
ušt32_t
)(
oh
 >> 32);

190 
out
->
u
[2] = (
ušt32_t
)
oh
;

191 
	}
}

201 #ifdeà
ONLY64


202 
JEMALLOC_INLINE_C
 
	$lshiá128
(
w128_t
 *
out
, w128_ˆcÚ¡ *
š
, 
shiá
) {

203 
ušt64_t
 
th
, 

, 
oh
, 
Ş
;

205 
th
 = ((
ušt64_t
)
š
->
u
[2] << 32) | ((uint64_t)in->u[3]);

206 

 = ((
ušt64_t
)
š
->
u
[0] << 32) | ((uint64_t)in->u[1]);

208 
oh
 = 
th
 << (
shiá
 * 8);

209 
Ş
 = 

 << (
shiá
 * 8);

210 
oh
 |ğ

 >> (64 - 
shiá
 * 8);

211 
out
->
u
[0] = (
ušt32_t
)(
Ş
 >> 32);

212 
out
->
u
[1] = (
ušt32_t
)
Ş
;

213 
out
->
u
[2] = (
ušt32_t
)(
oh
 >> 32);

214 
out
->
u
[3] = (
ušt32_t
)
oh
;

215 
	}
}

217 
JEMALLOC_INLINE_C
 
	$lshiá128
(
w128_t
 *
out
, w128_ˆcÚ¡ *
š
, 
shiá
) {

218 
ušt64_t
 
th
, 

, 
oh
, 
Ş
;

220 
th
 = ((
ušt64_t
)
š
->
u
[3] << 32) | ((uint64_t)in->u[2]);

221 

 = ((
ušt64_t
)
š
->
u
[1] << 32) | ((uint64_t)in->u[0]);

223 
oh
 = 
th
 << (
shiá
 * 8);

224 
Ş
 = 

 << (
shiá
 * 8);

225 
oh
 |ğ

 >> (64 - 
shiá
 * 8);

226 
out
->
u
[1] = (
ušt32_t
)(
Ş
 >> 32);

227 
out
->
u
[0] = (
ušt32_t
)
Ş
;

228 
out
->
u
[3] = (
ušt32_t
)(
oh
 >> 32);

229 
out
->
u
[2] = (
ušt32_t
)
oh
;

230 
	}
}

242 #ià(!
defšed
(
HAVE_ALTIVEC
)è&& (!defšed(
HAVE_SSE2
))

243 #ifdeà
ONLY64


244 
JEMALLOC_INLINE_C
 
	$do_»cursiÚ
(
w128_t
 *
r
, w128_ˆ*
a
, w128_ˆ*
b
, w128_ˆ*
c
,

245 
w128_t
 *
d
) {

246 
w128_t
 
x
;

247 
w128_t
 
y
;

249 
	`lshiá128
(&
x
, 
a
, 
SL2
);

250 
	`rshiá128
(&
y
, 
c
, 
SR2
);

251 
r
->
u
[0] = 
a
->u[0] ^ 
x
.u[0] ^ ((
b
->u[0] >> 
SR1
è& 
MSK2
è^ 
y
.u[0]

252 ^ (
d
->
u
[0] << 
SL1
);

253 
r
->
u
[1] = 
a
->u[1] ^ 
x
.u[1] ^ ((
b
->u[1] >> 
SR1
è& 
MSK1
è^ 
y
.u[1]

254 ^ (
d
->
u
[1] << 
SL1
);

255 
r
->
u
[2] = 
a
->u[2] ^ 
x
.u[2] ^ ((
b
->u[2] >> 
SR1
è& 
MSK4
è^ 
y
.u[2]

256 ^ (
d
->
u
[2] << 
SL1
);

257 
r
->
u
[3] = 
a
->u[3] ^ 
x
.u[3] ^ ((
b
->u[3] >> 
SR1
è& 
MSK3
è^ 
y
.u[3]

258 ^ (
d
->
u
[3] << 
SL1
);

259 
	}
}

261 
JEMALLOC_INLINE_C
 
	$do_»cursiÚ
(
w128_t
 *
r
, w128_ˆ*
a
, w128_ˆ*
b
, w128_ˆ*
c
,

262 
w128_t
 *
d
) {

263 
w128_t
 
x
;

264 
w128_t
 
y
;

266 
	`lshiá128
(&
x
, 
a
, 
SL2
);

267 
	`rshiá128
(&
y
, 
c
, 
SR2
);

268 
r
->
u
[0] = 
a
->u[0] ^ 
x
.u[0] ^ ((
b
->u[0] >> 
SR1
è& 
MSK1
è^ 
y
.u[0]

269 ^ (
d
->
u
[0] << 
SL1
);

270 
r
->
u
[1] = 
a
->u[1] ^ 
x
.u[1] ^ ((
b
->u[1] >> 
SR1
è& 
MSK2
è^ 
y
.u[1]

271 ^ (
d
->
u
[1] << 
SL1
);

272 
r
->
u
[2] = 
a
->u[2] ^ 
x
.u[2] ^ ((
b
->u[2] >> 
SR1
è& 
MSK3
è^ 
y
.u[2]

273 ^ (
d
->
u
[2] << 
SL1
);

274 
r
->
u
[3] = 
a
->u[3] ^ 
x
.u[3] ^ ((
b
->u[3] >> 
SR1
è& 
MSK4
è^ 
y
.u[3]

275 ^ (
d
->
u
[3] << 
SL1
);

276 
	}
}

280 #ià(!
defšed
(
HAVE_ALTIVEC
)è&& (!defšed(
HAVE_SSE2
))

285 
JEMALLOC_INLINE_C
 
	$g’_¿nd_®l
(
sfmt_t
 *
ùx
) {

286 
i
;

287 
w128_t
 *
r1
, *
r2
;

289 
r1
 = &
ùx
->
sfmt
[
N
 - 2];

290 
r2
 = &
ùx
->
sfmt
[
N
 - 1];

291 
i
 = 0; i < 
N
 - 
POS1
; i++) {

292 
	`do_»cursiÚ
(&
ùx
->
sfmt
[
i
], &ùx->sfmt[i], &ùx->sfmt[˜+ 
POS1
], 
r1
,

293 
r2
);

294 
r1
 = 
r2
;

295 
r2
 = &
ùx
->
sfmt
[
i
];

297 ; 
i
 < 
N
; i++) {

298 
	`do_»cursiÚ
(&
ùx
->
sfmt
[
i
], &ùx->sfmt[i], &ùx->sfmt[˜+ 
POS1
 - 
N
], 
r1
,

299 
r2
);

300 
r1
 = 
r2
;

301 
r2
 = &
ùx
->
sfmt
[
i
];

303 
	}
}

312 
JEMALLOC_INLINE_C
 
	$g’_¿nd_¬¿y
(
sfmt_t
 *
ùx
, 
w128_t
 *
¬¿y
, 
size
) {

313 
i
, 
j
;

314 
w128_t
 *
r1
, *
r2
;

316 
r1
 = &
ùx
->
sfmt
[
N
 - 2];

317 
r2
 = &
ùx
->
sfmt
[
N
 - 1];

318 
i
 = 0; i < 
N
 - 
POS1
; i++) {

319 
	`do_»cursiÚ
(&
¬¿y
[
i
], &
ùx
->
sfmt
[i], &ùx->sfmt[˜+ 
POS1
], 
r1
, 
r2
);

320 
r1
 = 
r2
;

321 
r2
 = &
¬¿y
[
i
];

323 ; 
i
 < 
N
; i++) {

324 
	`do_»cursiÚ
(&
¬¿y
[
i
], &
ùx
->
sfmt
[i], &¬¿y[˜+ 
POS1
 - 
N
], 
r1
, 
r2
);

325 
r1
 = 
r2
;

326 
r2
 = &
¬¿y
[
i
];

328 ; 
i
 < 
size
 - 
N
; i++) {

329 
	`do_»cursiÚ
(&
¬¿y
[
i
], &¬¿y[˜- 
N
], &¬¿y[˜+ 
POS1
 - N], 
r1
, 
r2
);

330 
r1
 = 
r2
;

331 
r2
 = &
¬¿y
[
i
];

333 
j
 = 0; j < 2 * 
N
 - 
size
; j++) {

334 
ùx
->
sfmt
[
j
] = 
¬¿y
[j + 
size
 - 
N
];

336 ; 
i
 < 
size
; i++, 
j
++) {

337 
	`do_»cursiÚ
(&
¬¿y
[
i
], &¬¿y[˜- 
N
], &¬¿y[˜+ 
POS1
 - N], 
r1
, 
r2
);

338 
r1
 = 
r2
;

339 
r2
 = &
¬¿y
[
i
];

340 
ùx
->
sfmt
[
j
] = 
¬¿y
[
i
];

342 
	}
}

345 #ià
defšed
(
BIG_ENDIAN64
è&& !defšed(
ONLY64
è&& !defšed(
HAVE_ALTIVEC
)

346 
JEMALLOC_INLINE_C
 
	$sw­
(
w128_t
 *
¬¿y
, 
size
) {

347 
i
;

348 
ušt32_t
 
x
, 
y
;

350 
i
 = 0; i < 
size
; i++) {

351 
x
 = 
¬¿y
[
i
].
u
[0];

352 
y
 = 
¬¿y
[
i
].
u
[2];

353 
¬¿y
[
i
].
u
[0] =‡rray[i].u[1];

354 
¬¿y
[
i
].
u
[2] =‡rray[i].u[3];

355 
¬¿y
[
i
].
u
[1] = 
x
;

356 
¬¿y
[
i
].
u
[3] = 
y
;

358 
	}
}

366 
ušt32_t
 
	$func1
(
ušt32_t
 
x
) {

367  (
x
 ^ (x >> 27)è* (
ušt32_t
)1664525UL;

368 
	}
}

376 
ušt32_t
 
	$func2
(
ušt32_t
 
x
) {

377  (
x
 ^ (x >> 27)è* (
ušt32_t
)1566083941UL;

378 
	}
}

383 
	$³riod_û¹ifiÿtiÚ
(
sfmt_t
 *
ùx
) {

384 
šÃr
 = 0;

385 
i
, 
j
;

386 
ušt32_t
 
wÜk
;

387 
ušt32_t
 *
psfmt32
 = &
ùx
->
sfmt
[0].
u
[0];

389 
i
 = 0; i < 4; i++)

390 
šÃr
 ^ğ
psfmt32
[
	`idxof
(
i
)] & 
·r™y
[i];

391 
i
 = 16; i > 0; i >>= 1)

392 
šÃr
 ^ğšÃ¸>> 
i
;

393 
šÃr
 &= 1;

395 ià(
šÃr
 == 1) {

399 
i
 = 0; i < 4; i++) {

400 
wÜk
 = 1;

401 
j
 = 0; j < 32; j++) {

402 ià((
wÜk
 & 
·r™y
[
i
]) != 0) {

403 
psfmt32
[
	`idxof
(
i
)] ^ğ
wÜk
;

406 
wÜk
 = work << 1;

409 
	}
}

419 cÚ¡ *
	$g‘_id¡ršg
() {

420  
IDSTR
;

421 
	}
}

428 
	$g‘_mš_¬¿y_size32
() {

429  
N32
;

430 
	}
}

437 
	$g‘_mš_¬¿y_size64
() {

438  
N64
;

439 
	}
}

441 #iâdeà
ONLY64


447 
ušt32_t
 
	$g’_¿nd32
(
sfmt_t
 *
ùx
) {

448 
ušt32_t
 
r
;

449 
ušt32_t
 *
psfmt32
 = &
ùx
->
sfmt
[0].
u
[0];

451 
	`as£¹
(
ùx
->
š™Ÿlized
);

452 ià(
ùx
->
idx
 >ğ
N32
) {

453 
	`g’_¿nd_®l
(
ùx
);

454 
ùx
->
idx
 = 0;

456 
r
 = 
psfmt32
[
ùx
->
idx
++];

457  
r
;

458 
	}
}

461 
ušt32_t
 
	$g’_¿nd32_¿nge
(
sfmt_t
 *
ùx
, 
ušt32_t
 
lim™
) {

462 
ušt32_t
 
»t
, 
above
;

464 
above
 = 0xffffffffU - (0xffffffffU % 
lim™
);

466 
»t
 = 
	`g’_¿nd32
(
ùx
);

467 ià(
»t
 < 
above
) {

468 
»t
 %ğ
lim™
;

472  
»t
;

473 
	}
}

482 
ušt64_t
 
	$g’_¿nd64
(
sfmt_t
 *
ùx
) {

483 #ià
	`defšed
(
BIG_ENDIAN64
è&& !defšed(
ONLY64
)

484 
ušt32_t
 
r1
, 
r2
;

485 
ušt32_t
 *
psfmt32
 = &
ùx
->
sfmt
[0].
u
[0];

487 
ušt64_t
 
r
;

488 
ušt64_t
 *
psfmt64
 = (ušt64_ˆ*)&
ùx
->
sfmt
[0].
u
[0];

491 
	`as£¹
(
ùx
->
š™Ÿlized
);

492 
	`as£¹
(
ùx
->
idx
 % 2 == 0);

494 ià(
ùx
->
idx
 >ğ
N32
) {

495 
	`g’_¿nd_®l
(
ùx
);

496 
ùx
->
idx
 = 0;

498 #ià
	`defšed
(
BIG_ENDIAN64
è&& !defšed(
ONLY64
)

499 
r1
 = 
psfmt32
[
ùx
->
idx
];

500 
r2
 = 
psfmt32
[
ùx
->
idx
 + 1];

501 
ùx
->
idx
 += 2;

502  ((
ušt64_t
)
r2
 << 32è| 
r1
;

504 
r
 = 
psfmt64
[
ùx
->
idx
 / 2];

505 
ùx
->
idx
 += 2;

506  
r
;

508 
	}
}

511 
ušt64_t
 
	$g’_¿nd64_¿nge
(
sfmt_t
 *
ùx
, 
ušt64_t
 
lim™
) {

512 
ušt64_t
 
»t
, 
above
;

514 
above
 = 
	`KQU
(0xffffffffffffffffè- (KQU(0xffffffffffffffffè% 
lim™
);

516 
»t
 = 
	`g’_¿nd64
(
ùx
);

517 ià(
»t
 < 
above
) {

518 
»t
 %ğ
lim™
;

522  
»t
;

523 
	}
}

525 #iâdeà
ONLY64


551 
	$fl_¬¿y32
(
sfmt_t
 *
ùx
, 
ušt32_t
 *
¬¿y
, 
size
) {

552 
	`as£¹
(
ùx
->
š™Ÿlized
);

553 
	`as£¹
(
ùx
->
idx
 =ğ
N32
);

554 
	`as£¹
(
size
 % 4 == 0);

555 
	`as£¹
(
size
 >ğ
N32
);

557 
	`g’_¿nd_¬¿y
(
ùx
, (
w128_t
 *)
¬¿y
, 
size
 / 4);

558 
ùx
->
idx
 = 
N32
;

559 
	}
}

587 
	$fl_¬¿y64
(
sfmt_t
 *
ùx
, 
ušt64_t
 *
¬¿y
, 
size
) {

588 
	`as£¹
(
ùx
->
š™Ÿlized
);

589 
	`as£¹
(
ùx
->
idx
 =ğ
N32
);

590 
	`as£¹
(
size
 % 2 == 0);

591 
	`as£¹
(
size
 >ğ
N64
);

593 
	`g’_¿nd_¬¿y
(
ùx
, (
w128_t
 *)
¬¿y
, 
size
 / 2);

594 
ùx
->
idx
 = 
N32
;

596 #ià
	`defšed
(
BIG_ENDIAN64
è&& !defšed(
ONLY64
)

597 
	`sw­
((
w128_t
 *)
¬¿y
, 
size
 /2);

599 
	}
}

607 
sfmt_t
 *
	$š™_g’_¿nd
(
ušt32_t
 
£ed
) {

608 *
p
;

609 
sfmt_t
 *
ùx
;

610 
i
;

611 
ušt32_t
 *
psfmt32
;

613 ià(
	`posix_mem®ign
(&
p
, (
w128_t
), (
sfmt_t
)) != 0) {

614  
NULL
;

616 
ùx
 = (
sfmt_t
 *)
p
;

617 
psfmt32
 = &
ùx
->
sfmt
[0].
u
[0];

619 
psfmt32
[
	`idxof
(0)] = 
£ed
;

620 
i
 = 1; i < 
N32
; i++) {

621 
psfmt32
[
	`idxof
(
i
)] = 1812433253UL * (psfmt32[idxof(i - 1)]

622 ^ (
psfmt32
[
	`idxof
(
i
 - 1)] >> 30))

623 + 
i
;

625 
ùx
->
idx
 = 
N32
;

626 
	`³riod_û¹ifiÿtiÚ
(
ùx
);

627 
ùx
->
š™Ÿlized
 = 1;

629  
ùx
;

630 
	}
}

638 
sfmt_t
 *
	$š™_by_¬¿y
(
ušt32_t
 *
š™_key
, 
key_Ëngth
) {

639 *
p
;

640 
sfmt_t
 *
ùx
;

641 
i
, 
j
, 
couÁ
;

642 
ušt32_t
 
r
;

643 
Ïg
;

644 
mid
;

645 
size
 = 
N
 * 4;

646 
ušt32_t
 *
psfmt32
;

648 ià(
	`posix_mem®ign
(&
p
, (
w128_t
), (
sfmt_t
)) != 0) {

649  
NULL
;

651 
ùx
 = (
sfmt_t
 *)
p
;

652 
psfmt32
 = &
ùx
->
sfmt
[0].
u
[0];

654 ià(
size
 >= 623) {

655 
Ïg
 = 11;

656 } ià(
size
 >= 68) {

657 
Ïg
 = 7;

658 } ià(
size
 >= 39) {

659 
Ïg
 = 5;

661 
Ïg
 = 3;

663 
mid
 = (
size
 - 
Ïg
) / 2;

665 
	`mem£t
(
ùx
->
sfmt
, 0x8b, (ctx->sfmt));

666 ià(
key_Ëngth
 + 1 > 
N32
) {

667 
couÁ
 = 
key_Ëngth
 + 1;

669 
couÁ
 = 
N32
;

671 
r
 = 
	`func1
(
psfmt32
[
	`idxof
(0)] ^…sfmt32[idxof(
mid
)]

672 ^ 
psfmt32
[
	`idxof
(
N32
 - 1)]);

673 
psfmt32
[
	`idxof
(
mid
)] +ğ
r
;

674 
r
 +ğ
key_Ëngth
;

675 
psfmt32
[
	`idxof
(
mid
 + 
Ïg
)] +ğ
r
;

676 
psfmt32
[
	`idxof
(0)] = 
r
;

678 
couÁ
--;

679 
i
 = 1, 
j
 = 0; (j < 
couÁ
è&& (j < 
key_Ëngth
); j++) {

680 
r
 = 
	`func1
(
psfmt32
[
	`idxof
(
i
)] ^…sfmt32[idxof((˜+ 
mid
è% 
N32
)]

681 ^ 
psfmt32
[
	`idxof
((
i
 + 
N32
 - 1) % N32)]);

682 
psfmt32
[
	`idxof
((
i
 + 
mid
è% 
N32
)] +ğ
r
;

683 
r
 +ğ
š™_key
[
j
] + 
i
;

684 
psfmt32
[
	`idxof
((
i
 + 
mid
 + 
Ïg
è% 
N32
)] +ğ
r
;

685 
psfmt32
[
	`idxof
(
i
)] = 
r
;

686 
i
 = (˜+ 1è% 
N32
;

688 ; 
j
 < 
couÁ
; j++) {

689 
r
 = 
	`func1
(
psfmt32
[
	`idxof
(
i
)] ^…sfmt32[idxof((˜+ 
mid
è% 
N32
)]

690 ^ 
psfmt32
[
	`idxof
((
i
 + 
N32
 - 1) % N32)]);

691 
psfmt32
[
	`idxof
((
i
 + 
mid
è% 
N32
)] +ğ
r
;

692 
r
 +ğ
i
;

693 
psfmt32
[
	`idxof
((
i
 + 
mid
 + 
Ïg
è% 
N32
)] +ğ
r
;

694 
psfmt32
[
	`idxof
(
i
)] = 
r
;

695 
i
 = (˜+ 1è% 
N32
;

697 
j
 = 0; j < 
N32
; j++) {

698 
r
 = 
	`func2
(
psfmt32
[
	`idxof
(
i
)] +…sfmt32[idxof((˜+ 
mid
è% 
N32
)]

699 + 
psfmt32
[
	`idxof
((
i
 + 
N32
 - 1) % N32)]);

700 
psfmt32
[
	`idxof
((
i
 + 
mid
è% 
N32
)] ^ğ
r
;

701 
r
 -ğ
i
;

702 
psfmt32
[
	`idxof
((
i
 + 
mid
 + 
Ïg
è% 
N32
)] ^ğ
r
;

703 
psfmt32
[
	`idxof
(
i
)] = 
r
;

704 
i
 = (˜+ 1è% 
N32
;

707 
ùx
->
idx
 = 
N32
;

708 
	`³riod_û¹ifiÿtiÚ
(
ùx
);

709 
ùx
->
š™Ÿlized
 = 1;

711  
ùx
;

712 
	}
}

714 
	$fši_g’_¿nd
(
sfmt_t
 *
ùx
) {

715 
	`as£¹
(
ùx
 !ğ
NULL
);

717 
ùx
->
š™Ÿlized
 = 0;

718 
	`ä“
(
ùx
);

719 
	}
}

	@deps/jemalloc/test/src/btalloc.c

1 
	~"‹¡/jem®loc_‹¡.h
"

4 
	$bÎoc
(
size_t
 
size
, 
b™s
)

7  (
	`bÎoc_0
(
size
, 
b™s
));

8 
	}
}

	@deps/jemalloc/test/src/btalloc_0.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
bÎoc_n_g’
(0)

	@deps/jemalloc/test/src/btalloc_1.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
bÎoc_n_g’
(1)

	@deps/jemalloc/test/src/math.c

1 
	#MATH_C_


	)

2 
	~"‹¡/jem®loc_‹¡.h
"

	@deps/jemalloc/test/src/mq.c

1 
	~"‹¡/jem®loc_‹¡.h
"

8 
	$mq_Çno¦“p
(
ns
)

11 
	`as£¹
(
ns
 <= 1000*1000*1000);

13 #ifdeà
_WIN32


14 
	`SË•
(
ns
 / 1000);

17 
time¥ec
 
timeout
;

19 ià(
ns
 < 1000*1000*1000) {

20 
timeout
.
tv_£c
 = 0;

21 
timeout
.
tv_n£c
 = 
ns
;

23 
timeout
.
tv_£c
 = 1;

24 
timeout
.
tv_n£c
 = 0;

26 
	`Çno¦“p
(&
timeout
, 
NULL
);

29 
	}
}

	@deps/jemalloc/test/src/mtx.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #iâdeà
_CRT_SPINCOUNT


4 
	#_CRT_SPINCOUNT
 4000

	)

7 
boŞ


8 
	$mtx_š™
(
mtx_t
 *
mtx
)

11 #ifdeà
_WIN32


12 ià(!
	`In™ŸlizeCr™iÿlSeùiÚAndSpšCouÁ
(&
mtx
->
lock
, 
_CRT_SPINCOUNT
))

13  (
Œue
);

14 #–ià(
	`defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

15 
mtx
->
lock
 = 
OS_UNFAIR_LOCK_INIT
;

16 #–ià(
	`defšed
(
JEMALLOC_OSSPIN
))

17 
mtx
->
lock
 = 0;

19 
±h»ad_mu‹x©Œ_t
 
©Œ
;

21 ià(
	`±h»ad_mu‹x©Œ_š™
(&
©Œ
) != 0)

22  (
Œue
);

23 
	`±h»ad_mu‹x©Œ_£‰y³
(&
©Œ
, 
PTHREAD_MUTEX_DEFAULT
);

24 ià(
	`±h»ad_mu‹x_š™
(&
mtx
->
lock
, &
©Œ
) != 0) {

25 
	`±h»ad_mu‹x©Œ_de¡roy
(&
©Œ
);

26  (
Œue
);

28 
	`±h»ad_mu‹x©Œ_de¡roy
(&
©Œ
);

30  (
çl£
);

31 
	}
}

34 
	$mtx_fši
(
mtx_t
 *
mtx
)

37 #ifdeà
_WIN32


38 #–ià(
	`defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

39 #–ià(
	`defšed
(
JEMALLOC_OSSPIN
))

41 
	`±h»ad_mu‹x_de¡roy
(&
mtx
->
lock
);

43 
	}
}

46 
	$mtx_lock
(
mtx_t
 *
mtx
)

49 #ifdeà
_WIN32


50 
	`EÁ”Cr™iÿlSeùiÚ
(&
mtx
->
lock
);

51 #–ià(
	`defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

52 
	`os_unçœ_lock_lock
(&
mtx
->
lock
);

53 #–ià(
	`defšed
(
JEMALLOC_OSSPIN
))

54 
	`OSSpšLockLock
(&
mtx
->
lock
);

56 
	`±h»ad_mu‹x_lock
(&
mtx
->
lock
);

58 
	}
}

61 
	$mtx_uÆock
(
mtx_t
 *
mtx
)

64 #ifdeà
_WIN32


65 
	`L—veCr™iÿlSeùiÚ
(&
mtx
->
lock
);

66 #–ià(
	`defšed
(
JEMALLOC_OS_UNFAIR_LOCK
))

67 
	`os_unçœ_lock_uÆock
(&
mtx
->
lock
);

68 #–ià(
	`defšed
(
JEMALLOC_OSSPIN
))

69 
	`OSSpšLockUÆock
(&
mtx
->
lock
);

71 
	`±h»ad_mu‹x_uÆock
(&
mtx
->
lock
);

73 
	}
}

	@deps/jemalloc/test/src/test.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	g‹¡_couÁ
 = 0;

4 
‹¡_¡©us_t
 
	g‹¡_couÁs
[
‹¡_¡©us_couÁ
] = {0, 0, 0};

5 
‹¡_¡©us_t
 
	g‹¡_¡©us
 = 
‹¡_¡©us_·ss
;

6 cÚ¡ * 
	g‹¡_Çme
 = "";

8 
	$JEMALLOC_FORMAT_PRINTF
(1, 2)

10 
	$‹¡_sk
(cÚ¡ *
fÜm©
, ...)

12 
va_li¡
 
­
;

14 
	`va_¡¬t
(
­
, 
fÜm©
);

15 
	`m®loc_vırštf
(
NULL
, NULL, 
fÜm©
, 
­
);

16 
	`va_’d
(
­
);

17 
	`m®loc_´štf
("\n");

18 
‹¡_¡©us
 = 
‹¡_¡©us_sk
;

19 
	}
}

21 
	$JEMALLOC_FORMAT_PRINTF
(1, 2)

23 
	$‹¡_ç
(cÚ¡ *
fÜm©
, ...)

25 
va_li¡
 
­
;

27 
	`va_¡¬t
(
­
, 
fÜm©
);

28 
	`m®loc_vırštf
(
NULL
, NULL, 
fÜm©
, 
­
);

29 
	`va_’d
(
­
);

30 
	`m®loc_´štf
("\n");

31 
‹¡_¡©us
 = 
‹¡_¡©us_ç
;

32 
	}
}

35 
	$‹¡_¡©us_¡ršg
(
‹¡_¡©us_t
 
‹¡_¡©us
)

38 
‹¡_¡©us
) {

39 
‹¡_¡©us_·ss
:  "pass";

40 
‹¡_¡©us_sk
:  "skip";

41 
‹¡_¡©us_ç
:  "fail";

42 : 
	`nÙ_»ached
();

44 
	}
}

47 
	$p_‹¡_š™
(cÚ¡ *
Çme
)

50 
‹¡_couÁ
++;

51 
‹¡_¡©us
 = 
‹¡_¡©us_·ss
;

52 
‹¡_Çme
 = 
Çme
;

53 
	}
}

56 
	$p_‹¡_fši
()

59 
‹¡_couÁs
[
‹¡_¡©us
]++;

60 
	`m®loc_´štf
("%s: %s\n", 
‹¡_Çme
, 
	`‹¡_¡©us_¡ršg
(
‹¡_¡©us
));

61 
	}
}

63 
‹¡_¡©us_t


64 
	$p_‹¡_im¶
(
boŞ
 
do_m®loc_š™
, 
‹¡_t
 *
t
, 
va_li¡
 
­
)

66 
‹¡_¡©us_t
 
»t
;

68 ià(
do_m®loc_š™
) {

75 ià(
	`ÇÎocx
(1, 0) == 0) {

76 
	`m®loc_´štf
("Initializationƒrror");

77  (
‹¡_¡©us_ç
);

81 
»t
 = 
‹¡_¡©us_·ss
;

82 ; 
t
 !ğ
NULL
; = 
	`va_¬g
(
­
, 
‹¡_t
 *)) {

83 
	`t
();

84 ià(
‹¡_¡©us
 > 
»t
)

85 
»t
 = 
‹¡_¡©us
;

88 
	`m®loc_´štf
("--- %s: %u/%u, %s: %u/%u, %s: %u/%u ---\n",

89 
	`‹¡_¡©us_¡ršg
(
‹¡_¡©us_·ss
),

90 
‹¡_couÁs
[
‹¡_¡©us_·ss
], 
‹¡_couÁ
,

91 
	`‹¡_¡©us_¡ršg
(
‹¡_¡©us_sk
),

92 
‹¡_couÁs
[
‹¡_¡©us_sk
], 
‹¡_couÁ
,

93 
	`‹¡_¡©us_¡ršg
(
‹¡_¡©us_ç
),

94 
‹¡_couÁs
[
‹¡_¡©us_ç
], 
‹¡_couÁ
);

96  (
»t
);

97 
	}
}

99 
‹¡_¡©us_t


100 
	$p_‹¡
(
‹¡_t
 *
t
, ...)

102 
‹¡_¡©us_t
 
»t
;

103 
va_li¡
 
­
;

105 
»t
 = 
‹¡_¡©us_·ss
;

106 
	`va_¡¬t
(
­
, 
t
);

107 
»t
 = 
	`p_‹¡_im¶
(
Œue
, 
t
, 
­
);

108 
	`va_’d
(
­
);

110  (
»t
);

111 
	}
}

113 
‹¡_¡©us_t


114 
	$p_‹¡_no_m®loc_š™
(
‹¡_t
 *
t
, ...)

116 
‹¡_¡©us_t
 
»t
;

117 
va_li¡
 
­
;

119 
»t
 = 
‹¡_¡©us_·ss
;

120 
	`va_¡¬t
(
­
, 
t
);

121 
»t
 = 
	`p_‹¡_im¶
(
çl£
, 
t
, 
­
);

122 
	`va_’d
(
­
);

124  (
»t
);

125 
	}
}

128 
	$p_‹¡_ç
(cÚ¡ *
´efix
, cÚ¡ *
mes§ge
)

131 
	`m®loc_ırštf
(
NULL
, NULL, "%s%s\n", 
´efix
, 
mes§ge
);

132 
‹¡_¡©us
 = 
‹¡_¡©us_ç
;

133 
	}
}

	@deps/jemalloc/test/src/thd.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
_WIN32


5 
	$thd_ü—‹
(
thd_t
 *
thd
, *(*
´oc
)(*), *
¬g
)

7 
LPTHREAD_START_ROUTINE
 
routše
 = (LPTHREAD_START_ROUTINE)
´oc
;

8 *
thd
 = 
	`C»©eTh»ad
(
NULL
, 0, 
routše
, 
¬g
, 0, NULL);

9 ià(*
thd
 =ğ
NULL
)

10 
	`‹¡_ç
("Error in CreateThread()\n");

11 
	}
}

14 
	$thd_još
(
thd_t
 
thd
, **
»t
)

17 ià(
	`Wa™FÜSšgËObjeù
(
thd
, 
INFINITE
è=ğ
WAIT_OBJECT_0
 && 
»t
) {

18 
DWORD
 
ex™_code
;

19 
	`G‘Ex™CodeTh»ad
(
thd
, (
LPDWORD
è&
ex™_code
);

20 *
»t
 = (*)(
ušŒ_t
)
ex™_code
;

22 
	}
}

26 
	$thd_ü—‹
(
thd_t
 *
thd
, *(*
´oc
)(*), *
¬g
)

29 ià(
	`±h»ad_ü—‹
(
thd
, 
NULL
, 
´oc
, 
¬g
) != 0)

30 
	`‹¡_ç
("Error in…thread_create()\n");

31 
	}
}

34 
	$thd_još
(
thd_t
 
thd
, **
»t
)

37 
	`±h»ad_još
(
thd
, 
»t
);

38 
	}
}

	@deps/jemalloc/test/src/timer.c

1 
	~"‹¡/jem®loc_‹¡.h
"

4 
	$tim”_¡¬t
(
timed–_t
 *
tim”
)

7 
	`n¡ime_š™
(&
tim”
->
t0
, 0);

8 
	`n¡ime_upd©e
(&
tim”
->
t0
);

9 
	}
}

12 
	$tim”_¡İ
(
timed–_t
 *
tim”
)

15 
	`n¡ime_cİy
(&
tim”
->
t1
, &tim”->
t0
);

16 
	`n¡ime_upd©e
(&
tim”
->
t1
);

17 
	}
}

19 
ušt64_t


20 
	$tim”_u£c
(cÚ¡ 
timed–_t
 *
tim”
)

22 
n¡ime_t
 
d–
;

24 
	`n¡ime_cİy
(&
d–
, &
tim”
->
t1
);

25 
	`n¡ime_subŒaù
(&
d–
, &
tim”
->
t0
);

26  (
	`n¡ime_ns
(&
d–
) / 1000);

27 
	}
}

30 
	$tim”_¿tio
(
timed–_t
 *
a
,imed–_ˆ*
b
, *
buf
, 
size_t
 
buæ’
)

32 
ušt64_t
 
t0
 = 
	`tim”_u£c
(
a
);

33 
ušt64_t
 
t1
 = 
	`tim”_u£c
(
b
);

34 
ušt64_t
 
muÉ
;

35 
size_t
 
i
 = 0;

36 
size_t
 
j
, 
n
;

39 
n
 = 
	`m®loc_¢´štf
(&
buf
[
i
], 
buæ’
-i, "%"
FMTu64
, 
t0
 / 
t1
);

40 
i
 +ğ
n
;

41 ià(
i
 >ğ
buæ’
)

43 
muÉ
 = 1;

44 
j
 = 0; j < 
n
; j++)

45 
muÉ
 *= 10;

48 
n
 = 
	`m®loc_¢´štf
(&
buf
[
i
], 
buæ’
-i, ".");

49 
i
 +ğ
n
;

52 
i
 < 
buæ’
-1) {

53 
ušt64_t
 
round
 = (
i
+1 =ğ
buæ’
-1 && ((
t0
 * 
muÉ
 * 10 / 
t1
) % 10

55 
n
 = 
	`m®loc_¢´štf
(&
buf
[
i
], 
buæ’
-i,

56 "%"
FMTu64
, (
t0
 * 
muÉ
 / 
t1
è% 10 + 
round
);

57 
i
 +ğ
n
;

58 
muÉ
 *= 10;

60 
	}
}

	@deps/jemalloc/test/stress/microbench.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
JEMALLOC_INLINE_C
 

4 
	$time_func
(
timed–_t
 *
tim”
, 
ušt64_t
 
nw¬mup
, ušt64_ˆ
n™”
,

5 (*
func
)())

7 
ušt64_t
 
i
;

9 
i
 = 0; i < 
nw¬mup
; i++)

10 
	`func
();

11 
	`tim”_¡¬t
(
tim”
);

12 
i
 = 0; i < 
n™”
; i++)

13 
	`func
();

14 
	`tim”_¡İ
(
tim”
);

15 
	}
}

18 
com·»_funcs
(
ušt64_t
 
nw¬mup
, ušt64_ˆ
n™”
, cÚ¡ *
Çme_a
,

19 (*
func_a
), cÚ¡ *
Çme_b
, (*
func_b
))

21 
timed–_t
 
tim”_a
, 
tim”_b
;

22 
¿tio_buf
[6];

23 *
p
;

25 
p
 = 
	`m®locx
(1, 0);

26 ià(
p
 =ğ
NULL
) {

27 
	`‹¡_ç
("Unexpected mallocx() failure");

31 
	`time_func
(&
tim”_a
, 
nw¬mup
, 
n™”
, 
func_a
);

32 
	`time_func
(&
tim”_b
, 
nw¬mup
, 
n™”
, 
func_b
);

34 
	`tim”_¿tio
(&
tim”_a
, &
tim”_b
, 
¿tio_buf
, (ratio_buf));

35 
	`m®loc_´štf
("%"
FMTu64
" iterations, %s=%"FMTu64"us, "

36 "%s=%"
FMTu64
"us,„atio=1:%s\n",

37 
n™”
, 
Çme_a
, 
	`tim”_u£c
(&
tim”_a
), 
Çme_b
,im”_u£c(&
tim”_b
),

38 
¿tio_buf
);

40 
	`d®locx
(
p
, 0);

41 
	}
}

44 
	$m®loc_ä“
()

47 *
p
 = 
	`m®loc
(1);

48 ià(
p
 =ğ
NULL
) {

49 
	`‹¡_ç
("Unexpected malloc() failure");

52 
	`ä“
(
p
);

53 
	}
}

56 
	$m®locx_ä“
()

58 *
p
 = 
	`m®locx
(1, 0);

59 ià(
p
 =ğ
NULL
) {

60 
	`‹¡_ç
("Unexpected mallocx() failure");

63 
	`ä“
(
p
);

64 
	}
}

66 
	$TEST_BEGIN
(
‹¡_m®loc_vs_m®locx
)

69 
	`com·»_funcs
(10*1000*1000, 100*1000*1000, "malloc",

70 
m®loc_ä“
, "m®locx", 
m®locx_ä“
);

71 
	}
}

72 
TEST_END


75 
	$m®loc_d®locx
()

77 *
p
 = 
	`m®loc
(1);

78 ià(
p
 =ğ
NULL
) {

79 
	`‹¡_ç
("Unexpected malloc() failure");

82 
	`d®locx
(
p
, 0);

83 
	}
}

86 
	$m®loc_sd®locx
()

88 *
p
 = 
	`m®loc
(1);

89 ià(
p
 =ğ
NULL
) {

90 
	`‹¡_ç
("Unexpected malloc() failure");

93 
	`sd®locx
(
p
, 1, 0);

94 
	}
}

96 
	$TEST_BEGIN
(
‹¡_ä“_vs_d®locx
)

99 
	`com·»_funcs
(10*1000*1000, 100*1000*1000, "ä“", 
m®loc_ä“
,

100 "d®locx", 
m®loc_d®locx
);

101 
	}
}

102 
TEST_END


104 
	$TEST_BEGIN
(
‹¡_d®locx_vs_sd®locx
)

107 
	`com·»_funcs
(10*1000*1000, 100*1000*1000, "d®locx", 
m®loc_d®locx
,

108 "sd®locx", 
m®loc_sd®locx
);

109 
	}
}

110 
TEST_END


113 
	$m®loc_mus_ä“
()

115 *
p
;

117 
p
 = 
	`m®loc
(1);

118 ià(
p
 =ğ
NULL
) {

119 
	`‹¡_ç
("Unexpected malloc() failure");

122 
	`m®loc_u§bË_size
(
p
);

123 
	`ä“
(
p
);

124 
	}
}

127 
	$m®loc_§Îocx_ä“
()

129 *
p
;

131 
p
 = 
	`m®loc
(1);

132 ià(
p
 =ğ
NULL
) {

133 
	`‹¡_ç
("Unexpected malloc() failure");

136 ià(
	`§Îocx
(
p
, 0) < 1)

137 
	`‹¡_ç
("Unexpected sallocx() failure");

138 
	`ä“
(
p
);

139 
	}
}

141 
	$TEST_BEGIN
(
‹¡_mus_vs_§Îocx
)

144 
	`com·»_funcs
(10*1000*1000, 100*1000*1000, "malloc_usable_size",

145 
m®loc_mus_ä“
, "§Îocx", 
m®loc_§Îocx_ä“
);

146 
	}
}

147 
TEST_END


150 
	$m®loc_ÇÎocx_ä“
()

152 *
p
;

154 
p
 = 
	`m®loc
(1);

155 ià(
p
 =ğ
NULL
) {

156 
	`‹¡_ç
("Unexpected malloc() failure");

159 ià(
	`ÇÎocx
(1, 0) < 1)

160 
	`‹¡_ç
("Unexpected‚allocx() failure");

161 
	`ä“
(
p
);

162 
	}
}

164 
	$TEST_BEGIN
(
‹¡_§Îocx_vs_ÇÎocx
)

167 
	`com·»_funcs
(10*1000*1000, 100*1000*1000, "sallocx",

168 
m®loc_§Îocx_ä“
, "ÇÎocx", 
m®loc_ÇÎocx_ä“
);

169 
	}
}

170 
TEST_END


173 
	$maš
()

176  (
	`‹¡
(

177 
‹¡_m®loc_vs_m®locx
,

178 
‹¡_ä“_vs_d®locx
,

179 
‹¡_d®locx_vs_sd®locx
,

180 
‹¡_mus_vs_§Îocx
,

181 
‹¡_§Îocx_vs_ÇÎocx
));

182 
	}
}

	@deps/jemalloc/test/unit/SFMT.c

36 
	~"‹¡/jem®loc_‹¡.h
"

38 
	#BLOCK_SIZE
 10000

	)

39 
	#BLOCK_SIZE64
 (
BLOCK_SIZE
 / 2)

	)

40 
	#COUNT_1
 1000

	)

41 
	#COUNT_2
 700

	)

43 cÚ¡ 
ušt32_t
 
	gš™_g’_¿nd_32_ex³ùed
[] = {

245 cÚ¡ 
ušt32_t
 
	gš™_by_¬¿y_32_ex³ùed
[] = {

447 cÚ¡ 
ušt64_t
 
	gš™_g’_¿nd_64_ex³ùed
[] = {

448 
KQU
(16924766246869039260), KQU( 8201438687333352714),

449 
KQU
( 2265290287015001750), KQU(18397264611805473832),

450 
KQU
( 3375255223302384358), KQU( 6345559975416828796),

451 
KQU
(18229739242790328073), KQU( 7596792742098800905),

452 
KQU
( 255338647169685981), KQU( 2052747240048610300),

453 
KQU
(18328151576097299343), KQU(12472905421133796567),

454 
KQU
(11315245349717600863), KQU(16594110197775871209),

455 
KQU
(15708751964632456450), KQU(10452031272054632535),

456 
KQU
(11097646720811454386), KQU( 4556090668445745441),

457 
KQU
(17116187693090663106), KQU(14931526836144510645),

458 
KQU
( 9190752218020552591), KQU( 9625800285771901401),

459 
KQU
(13995141077659972832), KQU( 5194209094927829625),

460 
KQU
( 4156788379151063303), KQU( 8523452593770139494),

461 
KQU
(14082382103049296727), KQU( 2462601863986088483),

462 
KQU
( 3030583461592840678), KQU( 5221622077872827681),

463 
KQU
( 3084210671228981236), KQU(13956758381389953823),

464 
KQU
(13503889856213423831), KQU(15696904024189836170),

465 
KQU
( 4612584152877036206), KQU( 6231135538447867881),

466 
KQU
(10172457294158869468), KQU( 6452258628466708150),

467 
KQU
(14044432824917330221), KQU( 370168364480044279),

468 
KQU
(10102144686427193359), KQU( 667870489994776076),

469 
KQU
( 2732271956925885858), KQU(18027788905977284151),

470 
KQU
(15009842788582923859), KQU( 7136357960180199542),

471 
KQU
(15901736243475578127), KQU(16951293785352615701),

472 
KQU
(10551492125243691632), KQU(17668869969146434804),

473 
KQU
(13646002971174390445), KQU( 9804471050759613248),

474 
KQU
( 5511670439655935493), KQU(18103342091070400926),

475 
KQU
(17224512747665137533), KQU(15534627482992618168),

476 
KQU
( 1423813266186582647), KQU(15821176807932930024),

477 
KQU
( 30323369733607156), KQU(11599382494723479403),

478 
KQU
( 653856076586810062), KQU( 3176437395144899659),

479 
KQU
(14028076268147963917), KQU(16156398271809666195),

480 
KQU
( 3166955484848201676), KQU( 5746805620136919390),

481 
KQU
(17297845208891256593), KQU(11691653183226428483),

482 
KQU
(17900026146506981577), KQU(15387382115755971042),

483 
KQU
(16923567681040845943), KQU( 8039057517199388606),

484 
KQU
(11748409241468629263), KQU( 794358245539076095),

485 
KQU
(13438501964693401242), KQU(14036803236515618962),

486 
KQU
( 5252311215205424721), KQU(17806589612915509081),

487 
KQU
( 6802767092397596006), KQU(14212120431184557140),

488 
KQU
( 1072951366761385712), KQU(13098491780722836296),

489 
KQU
( 9466676828710797353), KQU(12673056849042830081),

490 
KQU
(12763726623645357580), KQU(16468961652999309493),

491 
KQU
(15305979875636438926), KQU(17444713151223449734),

492 
KQU
( 5692214267627883674), KQU(13049589139196151505),

493 
KQU
( 880115207831670745), KQU( 1776529075789695498),

494 
KQU
(16695225897801466485), KQU(10666901778795346845),

495 
KQU
( 6164389346722833869), KQU( 2863817793264300475),

496 
KQU
( 9464049921886304754), KQU( 3993566636740015468),

497 
KQU
( 9983749692528514136), KQU(16375286075057755211),

498 
KQU
(16042643417005440820), KQU(11445419662923489877),

499 
KQU
( 7999038846885158836), KQU( 6721913661721511535),

500 
KQU
( 5363052654139357320), KQU( 1817788761173584205),

501 
KQU
(13290974386445856444), KQU( 4650350818937984680),

502 
KQU
( 8219183528102484836), KQU( 1569862923500819899),

503 
KQU
( 4189359732136641860), KQU(14202822961683148583),

504 
KQU
( 4457498315309429058), KQU(13089067387019074834),

505 
KQU
(11075517153328927293), KQU(10277016248336668389),

506 
KQU
( 7070509725324401122), KQU(17808892017780289380),

507 
KQU
(13143367339909287349), KQU( 1377743745360085151),

508 
KQU
( 5749341807421286485), KQU(14832814616770931325),

509 
KQU
( 7688820635324359492), KQU(10960474011539770045),

510 
KQU
( 81970066653179790), KQU(12619476072607878022),

511 
KQU
( 4419566616271201744), KQU(15147917311750568503),

512 
KQU
( 5549739182852706345), KQU( 7308198397975204770),

513 
KQU
(13580425496671289278), KQU(17070764785210130301),

514 
KQU
( 8202832846285604405), KQU( 6873046287640887249),

515 
KQU
( 6927424434308206114), KQU( 6139014645937224874),

516 
KQU
(10290373645978487639), KQU(15904261291701523804),

517 
KQU
( 9628743442057826883), KQU(18383429096255546714),

518 
KQU
( 4977413265753686967), KQU( 7714317492425012869),

519 
KQU
( 9025232586309926193), KQU(14627338359776709107),

520 
KQU
(14759849896467790763), KQU(10931129435864423252),

521 
KQU
( 4588456988775014359), KQU(10699388531797056724),

522 
KQU
( 468652268869238792), KQU( 5755943035328078086),

523 
KQU
( 2102437379988580216), KQU( 9986312786506674028),

524 
KQU
( 2654207180040945604), KQU( 8726634790559960062),

525 
KQU
( 100497234871808137), KQU( 2800137176951425819),

526 
KQU
( 6076627612918553487), KQU( 5780186919186152796),

527 
KQU
( 8179183595769929098), KQU( 6009426283716221169),

528 
KQU
( 2796662551397449358), KQU( 1756961367041986764),

529 
KQU
( 6972897917355606205), KQU(14524774345368968243),

530 
KQU
( 2773529684745706940), KQU( 4853632376213075959),

531 
KQU
( 4198177923731358102), KQU( 8271224913084139776),

532 
KQU
( 2741753121611092226), KQU(16782366145996731181),

533 
KQU
(15426125238972640790), KQU(13595497100671260342),

534 
KQU
( 3173531022836259898), KQU( 6573264560319511662),

535 
KQU
(18041111951511157441), KQU( 2351433581833135952),

536 
KQU
( 3113255578908173487), KQU( 1739371330877858784),

537 
KQU
(16046126562789165480), KQU( 8072101652214192925),

538 
KQU
(15267091584090664910), KQU( 9309579200403648940),

539 
KQU
( 5218892439752408722), KQU(14492477246004337115),

540 
KQU
(17431037586679770619), KQU( 7385248135963250480),

541 
KQU
( 9580144956565560660), KQU( 4919546228040008720),

542 
KQU
(15261542469145035584), KQU(18233297270822253102),

543 
KQU
( 5453248417992302857), KQU( 9309519155931460285),

544 
KQU
(10342813012345291756), KQU(15676085186784762381),

545 
KQU
(15912092950691300645), KQU( 9371053121499003195),

546 
KQU
( 9897186478226866746), KQU(14061858287188196327),

547 
KQU
( 122575971620788119), KQU(12146750969116317754),

548 
KQU
( 4438317272813245201), KQU( 8332576791009527119),

549 
KQU
(13907785691786542057), KQU(10374194887283287467),

550 
KQU
( 2098798755649059566), KQU( 3416235197748288894),

551 
KQU
( 8688269957320773484), KQU( 7503964602397371571),

552 
KQU
(16724977015147478236), KQU( 9461512855439858184),

553 
KQU
(13259049744534534727), KQU( 3583094952542899294),

554 
KQU
( 8764245731305528292), KQU(13240823595462088985),

555 
KQU
(13716141617617910448), KQU(18114969519935960955),

556 
KQU
( 2297553615798302206), KQU( 4585521442944663362),

557 
KQU
(17776858680630198686), KQU( 4685873229192163363),

558 
KQU
( 152558080671135627), KQU(15424900540842670088),

559 
KQU
(13229630297130024108), KQU(17530268788245718717),

560 
KQU
(16675633913065714144), KQU( 3158912717897568068),

561 
KQU
(15399132185380087288), KQU( 7401418744515677872),

562 
KQU
(13135412922344398535), KQU( 6385314346100509511),

563 
KQU
(13962867001134161139), KQU(10272780155442671999),

564 
KQU
(12894856086597769142), KQU(13340877795287554994),

565 
KQU
(12913630602094607396), KQU(12543167911119793857),

566 
KQU
(17343570372251873096), KQU(10959487764494150545),

567 
KQU
( 6966737953093821128), KQU(13780699135496988601),

568 
KQU
( 4405070719380142046), KQU(14923788365607284982),

569 
KQU
( 2869487678905148380), KQU( 6416272754197188403),

570 
KQU
(15017380475943612591), KQU( 1995636220918429487),

571 
KQU
( 3402016804620122716), KQU(15800188663407057080),

572 
KQU
(11362369990390932882), KQU(15262183501637986147),

573 
KQU
(10239175385387371494), KQU( 9352042420365748334),

574 
KQU
( 1682457034285119875), KQU( 1724710651376289644),

575 
KQU
( 2038157098893817966), KQU( 9897825558324608773),

576 
KQU
( 1477666236519164736), KQU(16835397314511233640),

577 
KQU
(10370866327005346508), KQU(10157504370660621982),

578 
KQU
(12113904045335882069), KQU(13326444439742783008),

579 
KQU
(11302769043000765804), KQU(13594979923955228484),

580 
KQU
(11779351762613475968), KQU( 3786101619539298383),

581 
KQU
( 8021122969180846063), KQU(15745904401162500495),

582 
KQU
(10762168465993897267), KQU(13552058957896319026),

583 
KQU
(11200228655252462013), KQU( 5035370357337441226),

584 
KQU
( 7593918984545500013), KQU( 5418554918361528700),

585 
KQU
( 4858270799405446371), KQU( 9974659566876282544),

586 
KQU
(18227595922273957859), KQU( 2772778443635656220),

587 
KQU
(14285143053182085385), KQU( 9939700992429600469),

588 
KQU
(12756185904545598068), KQU( 2020783375367345262),

589 
KQU
( 57026775058331227), KQU( 950827867930065454),

590 
KQU
( 6602279670145371217), KQU( 2291171535443566929),

591 
KQU
( 5832380724425010313), KQU( 1220343904715982285),

592 
KQU
(17045542598598037633), KQU(15460481779702820971),

593 
KQU
(13948388779949365130), KQU(13975040175430829518),

594 
KQU
(17477538238425541763), KQU(11104663041851745725),

595 
KQU
(15860992957141157587), KQU(14529434633012950138),

596 
KQU
( 2504838019075394203), KQU( 7512113882611121886),

597 
KQU
( 4859973559980886617), KQU( 1258601555703250219),

598 
KQU
(15594548157514316394), KQU( 4516730171963773048),

599 
KQU
(11380103193905031983), KQU( 6809282239982353344),

600 
KQU
(18045256930420065002), KQU( 2453702683108791859),

601 
KQU
( 977214582986981460), KQU( 2006410402232713466),

602 
KQU
( 6192236267216378358), KQU( 3429468402195675253),

603 
KQU
(18146933153017348921), KQU(17369978576367231139),

604 
KQU
( 1246940717230386603), KQU(11335758870083327110),

605 
KQU
(14166488801730353682), KQU( 9008573127269635732),

606 
KQU
(10776025389820643815), KQU(15087605441903942962),

607 
KQU
( 1359542462712147922), KQU(13898874411226454206),

608 
KQU
(17911176066536804411), KQU( 9435590428600085274),

609 
KQU
( 294488509967864007), KQU( 8890111397567922046),

610 
KQU
( 7987823476034328778), KQU(13263827582440967651),

611 
KQU
( 7503774813106751573), KQU(14974747296185646837),

612 
KQU
( 8504765037032103375), KQU(17340303357444536213),

613 
KQU
( 7704610912964485743), KQU( 8107533670327205061),

614 
KQU
( 9062969835083315985), KQU(16968963142126734184),

615 
KQU
(12958041214190810180), KQU( 2720170147759570200),

616 
KQU
( 2986358963942189566), KQU(14884226322219356580),

617 
KQU
( 286224325144368520), KQU(11313800433154279797),

618 
KQU
(18366849528439673248), KQU(17899725929482368789),

619 
KQU
( 3730004284609106799), KQU( 1654474302052767205),

620 
KQU
( 5006698007047077032), KQU( 8196893913601182838),

621 
KQU
(15214541774425211640), KQU(17391346045606626073),

622 
KQU
( 8369003584076969089), KQU( 3939046733368550293),

623 
KQU
(10178639720308707785), KQU( 2180248669304388697),

624 
KQU
( 62894391300126322), KQU( 9205708961736223191),

625 
KQU
( 6837431058165360438), KQU( 3150743890848308214),

626 
KQU
(17849330658111464583), KQU(12214815643135450865),

627 
KQU
(13410713840519603402), KQU( 3200778126692046802),

628 
KQU
(13354780043041779313), KQU( 800850022756886036),

629 
KQU
(15660052933953067433), KQU( 6572823544154375676),

630 
KQU
(11030281857015819266), KQU(12682241941471433835),

631 
KQU
(11654136407300274693), KQU( 4517795492388641109),

632 
KQU
( 9757017371504524244), KQU(17833043400781889277),

633 
KQU
(12685085201747792227), KQU(10408057728835019573),

634 
KQU
( 98370418513455221), KQU( 6732663555696848598),

635 
KQU
(13248530959948529780), KQU( 3530441401230622826),

636 
KQU
(18188251992895660615), KQU( 1847918354186383756),

637 
KQU
( 1127392190402660921), KQU(11293734643143819463),

638 
KQU
( 3015506344578682982), KQU(13852645444071153329),

639 
KQU
( 2121359659091349142), KQU( 1294604376116677694),

640 
KQU
( 5616576231286352318), KQU( 7112502442954235625),

641 
KQU
(11676228199551561689), KQU(12925182803007305359),

642 
KQU
( 7852375518160493082), KQU( 1136513130539296154),

643 
KQU
( 5636923900916593195), KQU( 3221077517612607747),

644 
KQU
(17784790465798152513), KQU( 3554210049056995938),

645 
KQU
(17476839685878225874), KQU( 3206836372585575732),

646 
KQU
( 2765333945644823430), KQU(10080070903718799528),

647 
KQU
( 5412370818878286353), KQU( 9689685887726257728),

648 
KQU
( 8236117509123533998), KQU( 1951139137165040214),

649 
KQU
( 4492205209227980349), KQU(16541291230861602967),

650 
KQU
( 1424371548301437940), KQU( 9117562079669206794),

651 
KQU
(14374681563251691625), KQU(13873164030199921303),

652 
KQU
( 6680317946770936731), KQU(15586334026918276214),

653 
KQU
(10896213950976109802), KQU( 9506261949596413689),

654 
KQU
( 9903949574308040616), KQU( 6038397344557204470),

655 
KQU
( 174601465422373648), KQU(15946141191338238030),

656 
KQU
(17142225620992044937), KQU( 7552030283784477064),

657 
KQU
( 2947372384532947997), KQU( 510797021688197711),

658 
KQU
( 4962499439249363461), KQU( 23770320158385357),

659 
KQU
( 959774499105138124), KQU( 1468396011518788276),

660 
KQU
( 2015698006852312308), KQU( 4149400718489980136),

661 
KQU
( 5992916099522371188), KQU(10819182935265531076),

662 
KQU
(16189787999192351131), KQU( 342833961790261950),

663 
KQU
(12470830319550495336), KQU(18128495041912812501),

664 
KQU
( 1193600899723524337), KQU( 9056793666590079770),

665 
KQU
( 2154021227041669041), KQU( 4963570213951235735),

666 
KQU
( 4865075960209211409), KQU( 2097724599039942963),

667 
KQU
( 2024080278583179845), KQU(11527054549196576736),

668 
KQU
(10650256084182390252), KQU( 4808408648695766755),

669 
KQU
( 1642839215013788844), KQU(10607187948250398390),

670 
KQU
( 7076868166085913508), KQU( 730522571106887032),

671 
KQU
(12500579240208524895), KQU( 4484390097311355324),

672 
KQU
(15145801330700623870), KQU( 8055827661392944028),

673 
KQU
( 5865092976832712268), KQU(15159212508053625143),

674 
KQU
( 3560964582876483341), KQU( 4070052741344438280),

675 
KQU
( 6032585709886855634), KQU(15643262320904604873),

676 
KQU
( 2565119772293371111), KQU( 318314293065348260),

677 
KQU
(15047458749141511872), KQU( 7772788389811528730),

678 
KQU
( 7081187494343801976), KQU( 6465136009467253947),

679 
KQU
(10425940692543362069), KQU( 554608190318339115),

680 
KQU
(14796699860302125214), KQU( 1638153134431111443),

681 
KQU
(10336967447052276248), KQU( 8412308070396592958),

682 
KQU
( 4004557277152051226), KQU( 8143598997278774834),

683 
KQU
(16413323996508783221), KQU(13139418758033994949),

684 
KQU
( 9772709138335006667), KQU( 2818167159287157659),

685 
KQU
(17091740573832523669), KQU(14629199013130751608),

686 
KQU
(18268322711500338185), KQU( 8290963415675493063),

687 
KQU
( 8830864907452542588), KQU( 1614839084637494849),

688 
KQU
(14855358500870422231), KQU( 3472996748392519937),

689 
KQU
(15317151166268877716), KQU( 5825895018698400362),

690 
KQU
(16730208429367544129), KQU(10481156578141202800),

691 
KQU
( 4746166512382823750), KQU(12720876014472464998),

692 
KQU
( 8825177124486735972), KQU(13733447296837467838),

693 
KQU
( 6412293741681359625), KQU( 8313213138756135033),

694 
KQU
(11421481194803712517), KQU( 7997007691544174032),

695 
KQU
( 6812963847917605930), KQU( 9683091901227558641),

696 
KQU
(14703594165860324713), KQU( 1775476144519618309),

697 
KQU
( 2724283288516469519), KQU( 717642555185856868),

698 
KQU
( 8736402192215092346), KQU(11878800336431381021),

699 
KQU
( 4348816066017061293), KQU( 6115112756583631307),

700 
KQU
( 9176597239667142976), KQU(12615622714894259204),

701 
KQU
(10283406711301385987), KQU( 5111762509485379420),

702 
KQU
( 3118290051198688449), KQU( 7345123071632232145),

703 
KQU
( 9176423451688682359), KQU( 4843865456157868971),

704 
KQU
(12008036363752566088), KQU(12058837181919397720),

705 
KQU
( 2145073958457347366), KQU( 1526504881672818067),

706 
KQU
( 3488830105567134848), KQU(13208362960674805143),

707 
KQU
( 4077549672899572192), KQU( 7770995684693818365),

708 
KQU
( 1398532341546313593), KQU(12711859908703927840),

709 
KQU
( 1417561172594446813), KQU(17045191024194170604),

710 
KQU
( 4101933177604931713), KQU(14708428834203480320),

711 
KQU
(17447509264469407724), KQU(14314821973983434255),

712 
KQU
(17990472271061617265), KQU( 5087756685841673942),

713 
KQU
(12797820586893859939), KQU( 1778128952671092879),

714 
KQU
( 3535918530508665898), KQU( 9035729701042481301),

715 
KQU
(14808661568277079962), KQU(14587345077537747914),

716 
KQU
(11920080002323122708), KQU( 6426515805197278753),

717 
KQU
( 3295612216725984831), KQU(11040722532100876120),

718 
KQU
(12305952936387598754), KQU(16097391899742004253),

719 
KQU
( 4908537335606182208), KQU(12446674552196795504),

720 
KQU
(16010497855816895177), KQU( 9194378874788615551),

721 
KQU
( 3382957529567613384), KQU( 5154647600754974077),

722 
KQU
( 9801822865328396141), KQU( 9023662173919288143),

723 
KQU
(17623115353825147868), KQU( 8238115767443015816),

724 
KQU
(15811444159859002560), KQU( 9085612528904059661),

725 
KQU
( 6888601089398614254), KQU( 258252992894160189),

726 
KQU
( 6704363880792428622), KQU( 6114966032147235763),

727 
KQU
(11075393882690261875), KQU( 8797664238933620407),

728 
KQU
( 5901892006476726920), KQU( 5309780159285518958),

729 
KQU
(14940808387240817367), KQU(14642032021449656698),

730 
KQU
( 9808256672068504139), KQU( 3670135111380607658),

731 
KQU
(11211211097845960152), KQU( 1474304506716695808),

732 
KQU
(15843166204506876239), KQU( 7661051252471780561),

733 
KQU
(10170905502249418476), KQU( 7801416045582028589),

734 
KQU
( 2763981484737053050), KQU( 9491377905499253054),

735 
KQU
(16201395896336915095), KQU( 9256513756442782198),

736 
KQU
( 5411283157972456034), KQU( 5059433122288321676),

737 
KQU
( 4327408006721123357), KQU( 9278544078834433377),

738 
KQU
( 7601527110882281612), KQU(11848295896975505251),

739 
KQU
(12096998801094735560), KQU(14773480339823506413),

740 
KQU
(15586227433895802149), KQU(12786541257830242872),

741 
KQU
( 6904692985140503067), KQU( 5309011515263103959),

742 
KQU
(12105257191179371066), KQU(14654380212442225037),

743 
KQU
( 2556774974190695009), KQU( 4461297399927600261),

744 
KQU
(14888225660915118646), KQU(14915459341148291824),

745 
KQU
( 2738802166252327631), KQU( 6047155789239131512),

746 
KQU
(12920545353217010338), KQU(10697617257007840205),

747 
KQU
( 2751585253158203504), KQU(13252729159780047496),

748 
KQU
(14700326134672815469), KQU(14082527904374600529),

749 
KQU
(16852962273496542070), KQU(17446675504235853907),

750 
KQU
(15019600398527572311), KQU(12312781346344081551),

751 
KQU
(14524667935039810450), KQU( 5634005663377195738),

752 
KQU
(11375574739525000569), KQU( 2423665396433260040),

753 
KQU
( 5222836914796015410), KQU( 4397666386492647387),

754 
KQU
( 4619294441691707638), KQU( 665088602354770716),

755 
KQU
(13246495665281593610), KQU( 6564144270549729409),

756 
KQU
(10223216188145661688), KQU( 3961556907299230585),

757 
KQU
(11543262515492439914), KQU(16118031437285993790),

758 
KQU
( 7143417964520166465), KQU(13295053515909486772),

759 
KQU
( 40434666004899675), KQU(17127804194038347164),

760 
KQU
( 8599165966560586269), KQU( 8214016749011284903),

761 
KQU
(13725130352140465239), KQU( 5467254474431726291),

762 
KQU
( 7748584297438219877), KQU(16933551114829772472),

763 
KQU
( 2169618439506799400), KQU( 2169787627665113463),

764 
KQU
(17314493571267943764), KQU(18053575102911354912),

765 
KQU
(11928303275378476973), KQU(11593850925061715550),

766 
KQU
(17782269923473589362), KQU( 3280235307704747039),

767 
KQU
( 6145343578598685149), KQU(17080117031114086090),

768 
KQU
(18066839902983594755), KQU( 6517508430331020706),

769 
KQU
( 8092908893950411541), KQU(12558378233386153732),

770 
KQU
( 4476532167973132976), KQU(16081642430367025016),

771 
KQU
( 4233154094369139361), KQU( 8693630486693161027),

772 
KQU
(11244959343027742285), KQU(12273503967768513508),

773 
KQU
(14108978636385284876), KQU( 7242414665378826984),

774 
KQU
( 6561316938846562432), KQU( 8601038474994665795),

775 
KQU
(17532942353612365904), KQU(17940076637020912186),

776 
KQU
( 7340260368823171304), KQU( 7061807613916067905),

777 
KQU
(10561734935039519326), KQU(17990796503724650862),

778 
KQU
( 6208732943911827159), KQU( 359077562804090617),

779 
KQU
(14177751537784403113), KQU(10659599444915362902),

780 
KQU
(15081727220615085833), KQU(13417573895659757486),

781 
KQU
(15513842342017811524), KQU(11814141516204288231),

782 
KQU
( 1827312513875101814), KQU( 2804611699894603103),

783 
KQU
(17116500469975602763), KQU(12270191815211952087),

784 
KQU
(12256358467786024988), KQU(18435021722453971267),

785 
KQU
( 671330264390865618), KQU( 476504300460286050),

786 
KQU
(16465470901027093441), KQU( 4047724406247136402),

787 
KQU
( 1322305451411883346), KQU( 1388308688834322280),

788 
KQU
( 7303989085269758176), KQU( 9323792664765233642),

789 
KQU
( 4542762575316368936), KQU(17342696132794337618),

790 
KQU
( 4588025054768498379), KQU(13415475057390330804),

791 
KQU
(17880279491733405570), KQU(10610553400618620353),

792 
KQU
( 3180842072658960139), KQU(13002966655454270120),

793 
KQU
( 1665301181064982826), KQU( 7083673946791258979),

794 
KQU
( 190522247122496820), KQU(17388280237250677740),

795 
KQU
( 8430770379923642945), KQU(12987180971921668584),

796 
KQU
( 2311086108365390642), KQU( 2870984383579822345),

797 
KQU
(14014682609164653318), KQU(14467187293062251484),

798 
KQU
( 192186361147413298), KQU(15171951713531796524),

799 
KQU
( 9900305495015948728), KQU(17958004775615466344),

800 
KQU
(14346380954498606514), KQU(18040047357617407096),

801 
KQU
( 5035237584833424532), KQU(15089555460613972287),

802 
KQU
( 4131411873749729831), KQU( 1329013581168250330),

803 
KQU
(10095353333051193949), KQU(10749518561022462716),

804 
KQU
( 9050611429810755847), KQU(15022028840236655649),

805 
KQU
( 8775554279239748298), KQU(13105754025489230502),

806 
KQU
(15471300118574167585), KQU( 89864764002355628),

807 
KQU
( 8776416323420466637), KQU( 5280258630612040891),

808 
KQU
( 2719174488591862912), KQU( 7599309137399661994),

809 
KQU
(15012887256778039979), KQU(14062981725630928925),

810 
KQU
(12038536286991689603), KQU( 7089756544681775245),

811 
KQU
(10376661532744718039), KQU( 1265198725901533130),

812 
KQU
(13807996727081142408), KQU( 2935019626765036403),

813 
KQU
( 7651672460680700141), KQU( 3644093016200370795),

814 
KQU
( 2840982578090080674), KQU(17956262740157449201),

815 
KQU
(18267979450492880548), KQU(11799503659796848070),

816 
KQU
( 9942537025669672388), KQU(11886606816406990297),

817 
KQU
( 5488594946437447576), KQU( 7226714353282744302),

818 
KQU
( 3784851653123877043), KQU( 878018453244803041),

819 
KQU
(12110022586268616085), KQU( 734072179404675123),

820 
KQU
(11869573627998248542), KQU( 469150421297783998),

821 
KQU
( 260151124912803804), KQU(11639179410120968649),

822 
KQU
( 9318165193840846253), KQU(12795671722734758075),

823 
KQU
(15318410297267253933), KQU( 691524703570062620),

824 
KQU
( 5837129010576994601), KQU(15045963859726941052),

825 
KQU
( 5850056944932238169), KQU(12017434144750943807),

826 
KQU
( 7447139064928956574), KQU( 3101711812658245019),

827 
KQU
(16052940704474982954), KQU(18195745945986994042),

828 
KQU
( 8932252132785575659), KQU(13390817488106794834),

829 
KQU
(11582771836502517453), KQU( 4964411326683611686),

830 
KQU
( 2195093981702694011), KQU(14145229538389675669),

831 
KQU
(16459605532062271798), KQU( 866316924816482864),

832 
KQU
( 4593041209937286377), KQU( 8415491391910972138),

833 
KQU
( 4171236715600528969), KQU(16637569303336782889),

834 
KQU
( 2002011073439212680), KQU(17695124661097601411),

835 
KQU
( 4627687053598611702), KQU( 7895831936020190403),

836 
KQU
( 8455951300917267802), KQU( 2923861649108534854),

837 
KQU
( 8344557563927786255), KQU( 6408671940373352556),

838 
KQU
(12210227354536675772), KQU(14294804157294222295),

839 
KQU
(10103022425071085127), KQU(10092959489504123771),

840 
KQU
( 6554774405376736268), KQU(12629917718410641774),

841 
KQU
( 6260933257596067126), KQU( 2460827021439369673),

842 
KQU
( 2541962996717103668), KQU( 597377203127351475),

843 
KQU
( 5316984203117315309), KQU( 4811211393563241961),

844 
KQU
(13119698597255811641), KQU( 8048691512862388981),

845 
KQU
(10216818971194073842), KQU( 4612229970165291764),

846 
KQU
(10000980798419974770), KQU( 6877640812402540687),

847 
KQU
( 1488727563290436992), KQU( 2227774069895697318),

848 
KQU
(11237754507523316593), KQU(13478948605382290972),

849 
KQU
( 1963583846976858124), KQU( 5512309205269276457),

850 
KQU
( 3972770164717652347), KQU( 3841751276198975037),

851 
KQU
(10283343042181903117), KQU( 8564001259792872199),

852 
KQU
(16472187244722489221), KQU( 8953493499268945921),

853 
KQU
( 3518747340357279580), KQU( 4003157546223963073),

854 
KQU
( 3270305958289814590), KQU( 3966704458129482496),

855 
KQU
( 8122141865926661939), KQU(14627734748099506653),

856 
KQU
(13064426990862560568), KQU( 2414079187889870829),

857 
KQU
( 5378461209354225306), KQU(10841985740128255566),

858 
KQU
( 538582442885401738), KQU( 7535089183482905946),

859 
KQU
(16117559957598879095), KQU( 8477890721414539741),

860 
KQU
( 1459127491209533386), KQU(17035126360733620462),

861 
KQU
( 8517668552872379126), KQU(10292151468337355014),

862 
KQU
(17081267732745344157), KQU(13751455337946087178),

863 
KQU
(14026945459523832966), KQU( 6653278775061723516),

864 
KQU
(10619085543856390441), KQU( 2196343631481122885),

865 
KQU
(10045966074702826136), KQU(10082317330452718282),

866 
KQU
( 5920859259504831242), KQU( 9951879073426540617),

867 
KQU
( 7074696649151414158), KQU(15808193543879464318),

868 
KQU
( 7385247772746953374), KQU( 3192003544283864292),

869 
KQU
(18153684490917593847), KQU(12423498260668568905),

870 
KQU
(10957758099756378169), KQU(11488762179911016040),

871 
KQU
( 2099931186465333782), KQU(11180979581250294432),

872 
KQU
( 8098916250668367933), KQU( 3529200436790763465),

873 
KQU
(12988418908674681745), KQU( 6147567275954808580),

874 
KQU
( 3207503344604030989), KQU(10761592604898615360),

875 
KQU
( 229854861031893504), KQU( 8809853962667144291),

876 
KQU
(13957364469005693860), KQU( 7634287665224495886),

877 
KQU
(12353487366976556874), KQU( 1134423796317152034),

878 
KQU
( 2088992471334107068), KQU( 7393372127190799698),

879 
KQU
( 1845367839871058391), KQU( 207922563987322884),

880 
KQU
(11960870813159944976), KQU(12182120053317317363),

881 
KQU
(17307358132571709283), KQU(13871081155552824936),

882 
KQU
(18304446751741566262), KQU( 7178705220184302849),

883 
KQU
(10929605677758824425), KQU(16446976977835806844),

884 
KQU
(13723874412159769044), KQU( 6942854352100915216),

885 
KQU
( 1726308474365729390), KQU( 2150078766445323155),

886 
KQU
(15345558947919656626), KQU(12145453828874527201),

887 
KQU
( 2054448620739726849), KQU( 2740102003352628137),

888 
KQU
(11294462163577610655), KQU( 756164283387413743),

889 
KQU
(17841144758438810880), KQU(10802406021185415861),

890 
KQU
( 8716455530476737846), KQU( 6321788834517649606),

891 
KQU
(14681322910577468426), KQU(17330043563884336387),

892 
KQU
(12701802180050071614), KQU(14695105111079727151),

893 
KQU
( 5112098511654172830), KQU( 4957505496794139973),

894 
KQU
( 8270979451952045982), KQU(12307685939199120969),

895 
KQU
(12425799408953443032), KQU( 8376410143634796588),

896 
KQU
(16621778679680060464), KQU( 3580497854566660073),

897 
KQU
( 1122515747803382416), KQU( 857664980960597599),

898 
KQU
( 6343640119895925918), KQU(12878473260854462891),

899 
KQU
(10036813920765722626), KQU(14451335468363173812),

900 
KQU
( 5476809692401102807), KQU(16442255173514366342),

901 
KQU
(13060203194757167104), KQU(14354124071243177715),

902 
KQU
(15961249405696125227), KQU(13703893649690872584),

903 
KQU
( 363907326340340064), KQU( 6247455540491754842),

904 
KQU
(12242249332757832361), KQU( 156065475679796717),

905 
KQU
( 9351116235749732355), KQU( 4590350628677701405),

906 
KQU
( 1671195940982350389), KQU(13501398458898451905),

907 
KQU
( 6526341991225002255), KQU( 1689782913778157592),

908 
KQU
( 7439222350869010334), KQU(13975150263226478308),

909 
KQU
(11411961169932682710), KQU(17204271834833847277),

910 
KQU
( 541534742544435367), KQU( 6591191931218949684),

911 
KQU
( 2645454775478232486), KQU( 4322857481256485321),

912 
KQU
( 8477416487553065110), KQU(12902505428548435048),

913 
KQU
( 971445777981341415), KQU(14995104682744976712),

914 
KQU
( 4243341648807158063), KQU( 8695061252721927661),

915 
KQU
( 5028202003270177222), KQU( 2289257340915567840),

916 
KQU
(13870416345121866007), KQU(13994481698072092233),

917 
KQU
( 6912785400753196481), KQU( 2278309315841980139),

918 
KQU
( 4329765449648304839), KQU( 5963108095785485298),

919 
KQU
( 4880024847478722478), KQU(16015608779890240947),

920 
KQU
( 1866679034261393544), KQU( 914821179919731519),

921 
KQU
( 9643404035648760131), KQU( 2418114953615593915),

922 
KQU
( 944756836073702374), KQU(15186388048737296834),

923 
KQU
( 7723355336128442206), KQU( 7500747479679599691),

924 
KQU
(18013961306453293634), KQU( 2315274808095756456),

925 
KQU
(13655308255424029566), KQU(17203800273561677098),

926 
KQU
( 1382158694422087756), KQU( 5090390250309588976),

927 
KQU
( 517170818384213989), KQU( 1612709252627729621),

928 
KQU
( 1330118955572449606), KQU( 300922478056709885),

929 
KQU
(18115693291289091987), KQU(13491407109725238321),

930 
KQU
(15293714633593827320), KQU( 5151539373053314504),

931 
KQU
( 5951523243743139207), KQU(14459112015249527975),

932 
KQU
( 5456113959000700739), KQU( 3877918438464873016),

933 
KQU
(12534071654260163555), KQU(15871678376893555041),

934 
KQU
(11005484805712025549), KQU(16353066973143374252),

935 
KQU
( 4358331472063256685), KQU( 8268349332210859288),

936 
KQU
(12485161590939658075), KQU(13955993592854471343),

937 
KQU
( 5911446886848367039), KQU(14925834086813706974),

938 
KQU
( 6590362597857994805), KQU( 1280544923533661875),

939 
KQU
( 1637756018947988164), KQU( 4734090064512686329),

940 
KQU
(16693705263131485912), KQU( 6834882340494360958),

941 
KQU
( 8120732176159658505), KQU( 2244371958905329346),

942 
KQU
(10447499707729734021), KQU( 7318742361446942194),

943 
KQU
( 8032857516355555296), KQU(14023605983059313116),

944 
KQU
( 1032336061815461376), KQU( 9840995337876562612),

945 
KQU
( 9869256223029203587), KQU(12227975697177267636),

946 
KQU
(12728115115844186033), KQU( 7752058479783205470),

947 
KQU
( 729733219713393087), KQU(12954017801239007622)

949 cÚ¡ 
ušt64_t
 
	gš™_by_¬¿y_64_ex³ùed
[] = {

950 
KQU
( 2100341266307895239), KQU( 8344256300489757943),

951 
KQU
(15687933285484243894), KQU( 8268620370277076319),

952 
KQU
(12371852309826545459), KQU( 8800491541730110238),

953 
KQU
(18113268950100835773), KQU( 2886823658884438119),

954 
KQU
( 3293667307248180724), KQU( 9307928143300172731),

955 
KQU
( 7688082017574293629), KQU( 900986224735166665),

956 
KQU
( 9977972710722265039), KQU( 6008205004994830552),

957 
KQU
( 546909104521689292), KQU( 7428471521869107594),

958 
KQU
(14777563419314721179), KQU(16116143076567350053),

959 
KQU
( 5322685342003142329), KQU( 4200427048445863473),

960 
KQU
( 4693092150132559146), KQU(13671425863759338582),

961 
KQU
( 6747117460737639916), KQU( 4732666080236551150),

962 
KQU
( 5912839950611941263), KQU( 3903717554504704909),

963 
KQU
( 2615667650256786818), KQU(10844129913887006352),

964 
KQU
(13786467861810997820), KQU(14267853002994021570),

965 
KQU
(13767807302847237439), KQU(16407963253707224617),

966 
KQU
( 4802498363698583497), KQU( 2523802839317209764),

967 
KQU
( 3822579397797475589), KQU( 8950320572212130610),

968 
KQU
( 3745623504978342534), KQU(16092609066068482806),

969 
KQU
( 9817016950274642398), KQU(10591660660323829098),

970 
KQU
(11751606650792815920), KQU( 5122873818577122211),

971 
KQU
(17209553764913936624), KQU( 6249057709284380343),

972 
KQU
(15088791264695071830), KQU(15344673071709851930),

973 
KQU
( 4345751415293646084), KQU( 2542865750703067928),

974 
KQU
(13520525127852368784), KQU(18294188662880997241),

975 
KQU
( 3871781938044881523), KQU( 2873487268122812184),

976 
KQU
(15099676759482679005), KQU(15442599127239350490),

977 
KQU
( 6311893274367710888), KQU( 3286118760484672933),

978 
KQU
( 4146067961333542189), KQU(13303942567897208770),

979 
KQU
( 8196013722255630418), KQU( 4437815439340979989),

980 
KQU
(15433791533450605135), KQU( 4254828956815687049),

981 
KQU
( 1310903207708286015), KQU(10529182764462398549),

982 
KQU
(14900231311660638810), KQU( 9727017277104609793),

983 
KQU
( 1821308310948199033), KQU(11628861435066772084),

984 
KQU
( 9469019138491546924), KQU( 3145812670532604988),

985 
KQU
( 9938468915045491919), KQU( 1562447430672662142),

986 
KQU
(13963995266697989134), KQU( 3356884357625028695),

987 
KQU
( 4499850304584309747), KQU( 8456825817023658122),

988 
KQU
(10859039922814285279), KQU( 8099512337972526555),

989 
KQU
( 348006375109672149), KQU(11919893998241688603),

990 
KQU
( 1104199577402948826), KQU(16689191854356060289),

991 
KQU
(10992552041730168078), KQU( 7243733172705465836),

992 
KQU
( 5668075606180319560), KQU(18182847037333286970),

993 
KQU
( 4290215357664631322), KQU( 4061414220791828613),

994 
KQU
(13006291061652989604), KQU( 7140491178917128798),

995 
KQU
(12703446217663283481), KQU( 5500220597564558267),

996 
KQU
(10330551509971296358), KQU(15958554768648714492),

997 
KQU
( 5174555954515360045), KQU( 1731318837687577735),

998 
KQU
( 3557700801048354857), KQU(13764012341928616198),

999 
KQU
(13115166194379119043), KQU( 7989321021560255519),

1000 
KQU
( 2103584280905877040), KQU( 9230788662155228488),

1001 
KQU
(16396629323325547654), KQU( 657926409811318051),

1002 
KQU
(15046700264391400727), KQU( 5120132858771880830),

1003 
KQU
( 7934160097989028561), KQU( 6963121488531976245),

1004 
KQU
(17412329602621742089), KQU(15144843053931774092),

1005 
KQU
(17204176651763054532), KQU(13166595387554065870),

1006 
KQU
( 8590377810513960213), KQU( 5834365135373991938),

1007 
KQU
( 7640913007182226243), KQU( 3479394703859418425),

1008 
KQU
(16402784452644521040), KQU( 4993979809687083980),

1009 
KQU
(13254522168097688865), KQU(15643659095244365219),

1010 
KQU
( 5881437660538424982), KQU(11174892200618987379),

1011 
KQU
( 254409966159711077), KQU(17158413043140549909),

1012 
KQU
( 3638048789290376272), KQU( 1376816930299489190),

1013 
KQU
( 4622462095217761923), KQU(15086407973010263515),

1014 
KQU
(13253971772784692238), KQU( 5270549043541649236),

1015 
KQU
(11182714186805411604), KQU(12283846437495577140),

1016 
KQU
( 5297647149908953219), KQU(10047451738316836654),

1017 
KQU
( 4938228100367874746), KQU(12328523025304077923),

1018 
KQU
( 3601049438595312361), KQU( 9313624118352733770),

1019 
KQU
(13322966086117661798), KQU(16660005705644029394),

1020 
KQU
(11337677526988872373), KQU(13869299102574417795),

1021 
KQU
(15642043183045645437), KQU( 3021755569085880019),

1022 
KQU
( 4979741767761188161), KQU(13679979092079279587),

1023 
KQU
( 3344685842861071743), KQU(13947960059899588104),

1024 
KQU
( 305806934293368007), KQU( 5749173929201650029),

1025 
KQU
(11123724852118844098), KQU(15128987688788879802),

1026 
KQU
(15251651211024665009), KQU( 7689925933816577776),

1027 
KQU
(16732804392695859449), KQU(17087345401014078468),

1028 
KQU
(14315108589159048871), KQU( 4820700266619778917),

1029 
KQU
(16709637539357958441), KQU( 4936227875177351374),

1030 
KQU
( 2137907697912987247), KQU(11628565601408395420),

1031 
KQU
( 2333250549241556786), KQU( 5711200379577778637),

1032 
KQU
( 5170680131529031729), KQU(12620392043061335164),

1033 
KQU
( 95363390101096078), KQU( 5487981914081709462),

1034 
KQU
( 1763109823981838620), KQU( 3395861271473224396),

1035 
KQU
( 1300496844282213595), KQU( 6894316212820232902),

1036 
KQU
(10673859651135576674), KQU( 5911839658857903252),

1037 
KQU
(17407110743387299102), KQU( 8257427154623140385),

1038 
KQU
(11389003026741800267), KQU( 4070043211095013717),

1039 
KQU
(11663806997145259025), KQU(15265598950648798210),

1040 
KQU
( 630585789434030934), KQU( 3524446529213587334),

1041 
KQU
( 7186424168495184211), KQU(10806585451386379021),

1042 
KQU
(11120017753500499273), KQU( 1586837651387701301),

1043 
KQU
(17530454400954415544), KQU( 9991670045077880430),

1044 
KQU
( 7550997268990730180), KQU( 8640249196597379304),

1045 
KQU
( 3522203892786893823), KQU(10401116549878854788),

1046 
KQU
(13690285544733124852), KQU( 8295785675455774586),

1047 
KQU
(15535716172155117603), KQU( 3112108583723722511),

1048 
KQU
(17633179955339271113), KQU(18154208056063759375),

1049 
KQU
( 1866409236285815666), KQU(13326075895396412882),

1050 
KQU
( 8756261842948020025), KQU( 6281852999868439131),

1051 
KQU
(15087653361275292858), KQU(10333923911152949397),

1052 
KQU
( 5265567645757408500), KQU(12728041843210352184),

1053 
KQU
( 6347959327507828759), KQU( 154112802625564758),

1054 
KQU
(18235228308679780218), KQU( 3253805274673352418),

1055 
KQU
( 4849171610689031197), KQU(17948529398340432518),

1056 
KQU
(13803510475637409167), KQU(13506570190409883095),

1057 
KQU
(15870801273282960805), KQU( 8451286481299170773),

1058 
KQU
( 9562190620034457541), KQU( 8518905387449138364),

1059 
KQU
(12681306401363385655), KQU( 3788073690559762558),

1060 
KQU
( 5256820289573487769), KQU( 2752021372314875467),

1061 
KQU
( 6354035166862520716), KQU( 4328956378309739069),

1062 
KQU
( 449087441228269600), KQU( 5533508742653090868),

1063 
KQU
( 1260389420404746988), KQU(18175394473289055097),

1064 
KQU
( 1535467109660399420), KQU( 8818894282874061442),

1065 
KQU
(12140873243824811213), KQU(15031386653823014946),

1066 
KQU
( 1286028221456149232), KQU( 6329608889367858784),

1067 
KQU
( 9419654354945132725), KQU( 6094576547061672379),

1068 
KQU
(17706217251847450255), KQU( 1733495073065878126),

1069 
KQU
(16918923754607552663), KQU( 8881949849954945044),

1070 
KQU
(12938977706896313891), KQU(14043628638299793407),

1071 
KQU
(18393874581723718233), KQU( 6886318534846892044),

1072 
KQU
(14577870878038334081), KQU(13541558383439414119),

1073 
KQU
(13570472158807588273), KQU(18300760537910283361),

1074 
KQU
( 818368572800609205), KQU( 1417000585112573219),

1075 
KQU
(12337533143867683655), KQU(12433180994702314480),

1076 
KQU
( 778190005829189083), KQU(13667356216206524711),

1077 
KQU
( 9866149895295225230), KQU(11043240490417111999),

1078 
KQU
( 1123933826541378598), KQU( 6469631933605123610),

1079 
KQU
(14508554074431980040), KQU(13918931242962026714),

1080 
KQU
( 2870785929342348285), KQU(14786362626740736974),

1081 
KQU
(13176680060902695786), KQU( 9591778613541679456),

1082 
KQU
( 9097662885117436706), KQU( 749262234240924947),

1083 
KQU
( 1944844067793307093), KQU( 4339214904577487742),

1084 
KQU
( 8009584152961946551), KQU(16073159501225501777),

1085 
KQU
( 3335870590499306217), KQU(17088312653151202847),

1086 
KQU
( 3108893142681931848), KQU(16636841767202792021),

1087 
KQU
(10423316431118400637), KQU( 8008357368674443506),

1088 
KQU
(11340015231914677875), KQU(17687896501594936090),

1089 
KQU
(15173627921763199958), KQU( 542569482243721959),

1090 
KQU
(15071714982769812975), KQU( 4466624872151386956),

1091 
KQU
( 1901780715602332461), KQU( 9822227742154351098),

1092 
KQU
( 1479332892928648780), KQU( 6981611948382474400),

1093 
KQU
( 7620824924456077376), KQU(14095973329429406782),

1094 
KQU
( 7902744005696185404), KQU(15830577219375036920),

1095 
KQU
(10287076667317764416), KQU(12334872764071724025),

1096 
KQU
( 4419302088133544331), KQU(14455842851266090520),

1097 
KQU
(12488077416504654222), KQU( 7953892017701886766),

1098 
KQU
( 6331484925529519007), KQU( 4902145853785030022),

1099 
KQU
(17010159216096443073), KQU(11945354668653886087),

1100 
KQU
(15112022728645230829), KQU(17363484484522986742),

1101 
KQU
( 4423497825896692887), KQU( 8155489510809067471),

1102 
KQU
( 258966605622576285), KQU( 5462958075742020534),

1103 
KQU
( 6763710214913276228), KQU( 2368935183451109054),

1104 
KQU
(14209506165246453811), KQU( 2646257040978514881),

1105 
KQU
( 3776001911922207672), KQU( 1419304601390147631),

1106 
KQU
(14987366598022458284), KQU( 3977770701065815721),

1107 
KQU
( 730820417451838898), KQU( 3982991703612885327),

1108 
KQU
( 2803544519671388477), KQU(17067667221114424649),

1109 
KQU
( 2922555119737867166), KQU( 1989477584121460932),

1110 
KQU
(15020387605892337354), KQU( 9293277796427533547),

1111 
KQU
(10722181424063557247), KQU(16704542332047511651),

1112 
KQU
( 5008286236142089514), KQU(16174732308747382540),

1113 
KQU
(17597019485798338402), KQU(13081745199110622093),

1114 
KQU
( 8850305883842258115), KQU(12723629125624589005),

1115 
KQU
( 8140566453402805978), KQU(15356684607680935061),

1116 
KQU
(14222190387342648650), KQU(11134610460665975178),

1117 
KQU
( 1259799058620984266), KQU(13281656268025610041),

1118 
KQU
( 298262561068153992), KQU(12277871700239212922),

1119 
KQU
(13911297774719779438), KQU(16556727962761474934),

1120 
KQU
(17903010316654728010), KQU( 9682617699648434744),

1121 
KQU
(14757681836838592850), KQU( 1327242446558524473),

1122 
KQU
(11126645098780572792), KQU( 1883602329313221774),

1123 
KQU
( 2543897783922776873), KQU(15029168513767772842),

1124 
KQU
(12710270651039129878), KQU(16118202956069604504),

1125 
KQU
(15010759372168680524), KQU( 2296827082251923948),

1126 
KQU
(10793729742623518101), KQU(13829764151845413046),

1127 
KQU
(17769301223184451213), KQU( 3118268169210783372),

1128 
KQU
(17626204544105123127), KQU( 7416718488974352644),

1129 
KQU
(10450751996212925994), KQU( 9352529519128770586),

1130 
KQU
( 259347569641110140), KQU( 8048588892269692697),

1131 
KQU
( 1774414152306494058), KQU(10669548347214355622),

1132 
KQU
(13061992253816795081), KQU(18432677803063861659),

1133 
KQU
( 8879191055593984333), KQU(12433753195199268041),

1134 
KQU
(14919392415439730602), KQU( 6612848378595332963),

1135 
KQU
( 6320986812036143628), KQU(10465592420226092859),

1136 
KQU
( 4196009278962570808), KQU( 3747816564473572224),

1137 
KQU
(17941203486133732898), KQU( 2350310037040505198),

1138 
KQU
( 5811779859134370113), KQU(10492109599506195126),

1139 
KQU
( 7699650690179541274), KQU( 1954338494306022961),

1140 
KQU
(14095816969027231152), KQU( 5841346919964852061),

1141 
KQU
(14945969510148214735), KQU( 3680200305887550992),

1142 
KQU
( 6218047466131695792), KQU( 8242165745175775096),

1143 
KQU
(11021371934053307357), KQU( 1265099502753169797),

1144 
KQU
( 4644347436111321718), KQU( 3609296916782832859),

1145 
KQU
( 8109807992218521571), KQU(18387884215648662020),

1146 
KQU
(14656324896296392902), KQU(17386819091238216751),

1147 
KQU
(17788300878582317152), KQU( 7919446259742399591),

1148 
KQU
( 4466613134576358004), KQU(12928181023667938509),

1149 
KQU
(13147446154454932030), KQU(16552129038252734620),

1150 
KQU
( 8395299403738822450), KQU(11313817655275361164),

1151 
KQU
( 434258809499511718), KQU( 2074882104954788676),

1152 
KQU
( 7929892178759395518), KQU( 9006461629105745388),

1153 
KQU
( 5176475650000323086), KQU(11128357033468341069),

1154 
KQU
(12026158851559118955), KQU(14699716249471156500),

1155 
KQU
( 448982497120206757), KQU( 4156475356685519900),

1156 
KQU
( 6063816103417215727), KQU(10073289387954971479),

1157 
KQU
( 8174466846138590962), KQU( 2675777452363449006),

1158 
KQU
( 9090685420572474281), KQU( 6659652652765562060),

1159 
KQU
(12923120304018106621), KQU(11117480560334526775),

1160 
KQU
( 937910473424587511), KQU( 1838692113502346645),

1161 
KQU
(11133914074648726180), KQU( 7922600945143884053),

1162 
KQU
(13435287702700959550), KQU( 5287964921251123332),

1163 
KQU
(11354875374575318947), KQU(17955724760748238133),

1164 
KQU
(13728617396297106512), KQU( 4107449660118101255),

1165 
KQU
( 1210269794886589623), KQU(11408687205733456282),

1166 
KQU
( 4538354710392677887), KQU(13566803319341319267),

1167 
KQU
(17870798107734050771), KQU( 3354318982568089135),

1168 
KQU
( 9034450839405133651), KQU(13087431795753424314),

1169 
KQU
( 950333102820688239), KQU( 1968360654535604116),

1170 
KQU
(16840551645563314995), KQU( 8867501803892924995),

1171 
KQU
(11395388644490626845), KQU( 1529815836300732204),

1172 
KQU
(13330848522996608842), KQU( 1813432878817504265),

1173 
KQU
( 2336867432693429560), KQU(15192805445973385902),

1174 
KQU
( 2528593071076407877), KQU( 128459777936689248),

1175 
KQU
( 9976345382867214866), KQU( 6208885766767996043),

1176 
KQU
(14982349522273141706), KQU( 3099654362410737822),

1177 
KQU
(13776700761947297661), KQU( 8806185470684925550),

1178 
KQU
( 8151717890410585321), KQU( 640860591588072925),

1179 
KQU
(14592096303937307465), KQU( 9056472419613564846),

1180 
KQU
(14861544647742266352), KQU(12703771500398470216),

1181 
KQU
( 3142372800384138465), KQU( 6201105606917248196),

1182 
KQU
(18337516409359270184), KQU(15042268695665115339),

1183 
KQU
(15188246541383283846), KQU(12800028693090114519),

1184 
KQU
( 5992859621101493472), KQU(18278043971816803521),

1185 
KQU
( 9002773075219424560), KQU( 7325707116943598353),

1186 
KQU
( 7930571931248040822), KQU( 5645275869617023448),

1187 
KQU
( 7266107455295958487), KQU( 4363664528273524411),

1188 
KQU
(14313875763787479809), KQU(17059695613553486802),

1189 
KQU
( 9247761425889940932), KQU(13704726459237593128),

1190 
KQU
( 2701312427328909832), KQU(17235532008287243115),

1191 
KQU
(14093147761491729538), KQU( 6247352273768386516),

1192 
KQU
( 8268710048153268415), KQU( 7985295214477182083),

1193 
KQU
(15624495190888896807), KQU( 3772753430045262788),

1194 
KQU
( 9133991620474991698), KQU( 5665791943316256028),

1195 
KQU
( 7551996832462193473), KQU(13163729206798953877),

1196 
KQU
( 9263532074153846374), KQU( 1015460703698618353),

1197 
KQU
(17929874696989519390), KQU(18257884721466153847),

1198 
KQU
(16271867543011222991), KQU( 3905971519021791941),

1199 
KQU
(16814488397137052085), KQU( 1321197685504621613),

1200 
KQU
( 2870359191894002181), KQU(14317282970323395450),

1201 
KQU
(13663920845511074366), KQU( 2052463995796539594),

1202 
KQU
(14126345686431444337), KQU( 1727572121947022534),

1203 
KQU
(17793552254485594241), KQU( 6738857418849205750),

1204 
KQU
( 1282987123157442952), KQU(16655480021581159251),

1205 
KQU
( 6784587032080183866), KQU(14726758805359965162),

1206 
KQU
( 7577995933961987349), KQU(12539609320311114036),

1207 
KQU
(10789773033385439494), KQU( 8517001497411158227),

1208 
KQU
(10075543932136339710), KQU(14838152340938811081),

1209 
KQU
( 9560840631794044194), KQU(17445736541454117475),

1210 
KQU
(10633026464336393186), KQU(15705729708242246293),

1211 
KQU
( 1117517596891411098), KQU( 4305657943415886942),

1212 
KQU
( 4948856840533979263), KQU(16071681989041789593),

1213 
KQU
(13723031429272486527), KQU( 7639567622306509462),

1214 
KQU
(12670424537483090390), KQU( 9715223453097197134),

1215 
KQU
( 5457173389992686394), KQU( 289857129276135145),

1216 
KQU
(17048610270521972512), KQU( 692768013309835485),

1217 
KQU
(14823232360546632057), KQU(18218002361317895936),

1218 
KQU
( 3281724260212650204), KQU(16453957266549513795),

1219 
KQU
( 8592711109774511881), KQU( 929825123473369579),

1220 
KQU
(15966784769764367791), KQU( 9627344291450607588),

1221 
KQU
(10849555504977813287), KQU( 9234566913936339275),

1222 
KQU
( 6413807690366911210), KQU(10862389016184219267),

1223 
KQU
(13842504799335374048), KQU( 1531994113376881174),

1224 
KQU
( 2081314867544364459), KQU(16430628791616959932),

1225 
KQU
( 8314714038654394368), KQU( 9155473892098431813),

1226 
KQU
(12577843786670475704), KQU( 4399161106452401017),

1227 
KQU
( 1668083091682623186), KQU( 1741383777203714216),

1228 
KQU
( 2162597285417794374), KQU(15841980159165218736),

1229 
KQU
( 1971354603551467079), KQU( 1206714764913205968),

1230 
KQU
( 4790860439591272330), KQU(14699375615594055799),

1231 
KQU
( 8374423871657449988), KQU(10950685736472937738),

1232 
KQU
( 697344331343267176), KQU(10084998763118059810),

1233 
KQU
(12897369539795983124), KQU(12351260292144383605),

1234 
KQU
( 1268810970176811234), KQU( 7406287800414582768),

1235 
KQU
( 516169557043807831), KQU( 5077568278710520380),

1236 
KQU
( 3828791738309039304), KQU( 7721974069946943610),

1237 
KQU
( 3534670260981096460), KQU( 4865792189600584891),

1238 
KQU
(16892578493734337298), KQU( 9161499464278042590),

1239 
KQU
(11976149624067055931), KQU(13219479887277343990),

1240 
KQU
(14161556738111500680), KQU(14670715255011223056),

1241 
KQU
( 4671205678403576558), KQU(12633022931454259781),

1242 
KQU
(14821376219869187646), KQU( 751181776484317028),

1243 
KQU
( 2192211308839047070), KQU(11787306362361245189),

1244 
KQU
(10672375120744095707), KQU( 4601972328345244467),

1245 
KQU
(15457217788831125879), KQU( 8464345256775460809),

1246 
KQU
(10191938789487159478), KQU( 6184348739615197613),

1247 
KQU
(11425436778806882100), KQU( 2739227089124319793),

1248 
KQU
( 461464518456000551), KQU( 4689850170029177442),

1249 
KQU
( 6120307814374078625), KQU(11153579230681708671),

1250 
KQU
( 7891721473905347926), KQU(10281646937824872400),

1251 
KQU
( 3026099648191332248), KQU( 8666750296953273818),

1252 
KQU
(14978499698844363232), KQU(13303395102890132065),

1253 
KQU
( 8182358205292864080), KQU(10560547713972971291),

1254 
KQU
(11981635489418959093), KQU( 3134621354935288409),

1255 
KQU
(11580681977404383968), KQU(14205530317404088650),

1256 
KQU
( 5997789011854923157), KQU(13659151593432238041),

1257 
KQU
(11664332114338865086), KQU( 7490351383220929386),

1258 
KQU
( 7189290499881530378), KQU(15039262734271020220),

1259 
KQU
( 2057217285976980055), KQU( 555570804905355739),

1260 
KQU
(11235311968348555110), KQU(13824557146269603217),

1261 
KQU
(16906788840653099693), KQU( 7222878245455661677),

1262 
KQU
( 5245139444332423756), KQU( 4723748462805674292),

1263 
KQU
(12216509815698568612), KQU(17402362976648951187),

1264 
KQU
(17389614836810366768), KQU( 4880936484146667711),

1265 
KQU
( 9085007839292639880), KQU(13837353458498535449),

1266 
KQU
(11914419854360366677), KQU(16595890135313864103),

1267 
KQU
( 6313969847197627222), KQU(18296909792163910431),

1268 
KQU
(10041780113382084042), KQU( 2499478551172884794),

1269 
KQU
(11057894246241189489), KQU( 9742243032389068555),

1270 
KQU
(12838934582673196228), KQU(13437023235248490367),

1271 
KQU
(13372420669446163240), KQU( 6752564244716909224),

1272 
KQU
( 7157333073400313737), KQU(12230281516370654308),

1273 
KQU
( 1182884552219419117), KQU( 2955125381312499218),

1274 
KQU
(10308827097079443249), KQU( 1337648572986534958),

1275 
KQU
(16378788590020343939), KQU( 108619126514420935),

1276 
KQU
( 3990981009621629188), KQU( 5460953070230946410),

1277 
KQU
( 9703328329366531883), KQU(13166631489188077236),

1278 
KQU
( 1104768831213675170), KQU( 3447930458553877908),

1279 
KQU
( 8067172487769945676), KQU( 5445802098190775347),

1280 
KQU
( 3244840981648973873), KQU(17314668322981950060),

1281 
KQU
( 5006812527827763807), KQU(18158695070225526260),

1282 
KQU
( 2824536478852417853), KQU(13974775809127519886),

1283 
KQU
( 9814362769074067392), KQU(17276205156374862128),

1284 
KQU
(11361680725379306967), KQU( 3422581970382012542),

1285 
KQU
(11003189603753241266), KQU(11194292945277862261),

1286 
KQU
( 6839623313908521348), KQU(11935326462707324634),

1287 
KQU
( 1611456788685878444), KQU(13112620989475558907),

1288 
KQU
( 517659108904450427), KQU(13558114318574407624),

1289 
KQU
(15699089742731633077), KQU( 4988979278862685458),

1290 
KQU
( 8111373583056521297), KQU( 3891258746615399627),

1291 
KQU
( 8137298251469718086), KQU(12748663295624701649),

1292 
KQU
( 4389835683495292062), KQU( 5775217872128831729),

1293 
KQU
( 9462091896405534927), KQU( 8498124108820263989),

1294 
KQU
( 8059131278842839525), KQU(10503167994254090892),

1295 
KQU
(11613153541070396656), KQU(18069248738504647790),

1296 
KQU
( 570657419109768508), KQU( 3950574167771159665),

1297 
KQU
( 5514655599604313077), KQU( 2908460854428484165),

1298 
KQU
(10777722615935663114), KQU(12007363304839279486),

1299 
KQU
( 9800646187569484767), KQU( 8795423564889864287),

1300 
KQU
(14257396680131028419), KQU( 6405465117315096498),

1301 
KQU
( 7939411072208774878), KQU(17577572378528990006),

1302 
KQU
(14785873806715994850), KQU(16770572680854747390),

1303 
KQU
(18127549474419396481), KQU(11637013449455757750),

1304 
KQU
(14371851933996761086), KQU( 3601181063650110280),

1305 
KQU
( 4126442845019316144), KQU(10198287239244320669),

1306 
KQU
(18000169628555379659), KQU(18392482400739978269),

1307 
KQU
( 6219919037686919957), KQU( 3610085377719446052),

1308 
KQU
( 2513925039981776336), KQU(16679413537926716955),

1309 
KQU
(12903302131714909434), KQU( 5581145789762985009),

1310 
KQU
(12325955044293303233), KQU(17216111180742141204),

1311 
KQU
( 6321919595276545740), KQU( 3507521147216174501),

1312 
KQU
( 9659194593319481840), KQU(11473976005975358326),

1313 
KQU
(14742730101435987026), KQU( 492845897709954780),

1314 
KQU
(16976371186162599676), KQU(17712703422837648655),

1315 
KQU
( 9881254778587061697), KQU( 8413223156302299551),

1316 
KQU
( 1563841828254089168), KQU( 9996032758786671975),

1317 
KQU
( 138877700583772667), KQU(13003043368574995989),

1318 
KQU
( 4390573668650456587), KQU( 8610287390568126755),

1319 
KQU
(15126904974266642199), KQU( 6703637238986057662),

1320 
KQU
( 2873075592956810157), KQU( 6035080933946049418),

1321 
KQU
(13382846581202353014), KQU( 7303971031814642463),

1322 
KQU
(18418024405307444267), KQU( 5847096731675404647),

1323 
KQU
( 4035880699639842500), KQU(11525348625112218478),

1324 
KQU
( 3041162365459574102), KQU( 2604734487727986558),

1325 
KQU
(15526341771636983145), KQU(14556052310697370254),

1326 
KQU
(12997787077930808155), KQU( 9601806501755554499),

1327 
KQU
(11349677952521423389), KQU(14956777807644899350),

1328 
KQU
(16559736957742852721), KQU(12360828274778140726),

1329 
KQU
( 6685373272009662513), KQU(16932258748055324130),

1330 
KQU
(15918051131954158508), KQU( 1692312913140790144),

1331 
KQU
( 546653826801637367), KQU( 5341587076045986652),

1332 
KQU
(14975057236342585662), KQU(12374976357340622412),

1333 
KQU
(10328833995181940552), KQU(12831807101710443149),

1334 
KQU
(10548514914382545716), KQU( 2217806727199715993),

1335 
KQU
(12627067369242845138), KQU( 4598965364035438158),

1336 
KQU
( 150923352751318171), KQU(14274109544442257283),

1337 
KQU
( 4696661475093863031), KQU( 1505764114384654516),

1338 
KQU
(10699185831891495147), KQU( 2392353847713620519),

1339 
KQU
( 3652870166711788383), KQU( 8640653276221911108),

1340 
KQU
( 3894077592275889704), KQU( 4918592872135964845),

1341 
KQU
(16379121273281400789), KQU(12058465483591683656),

1342 
KQU
(11250106829302924945), KQU( 1147537556296983005),

1343 
KQU
( 6376342756004613268), KQU(14967128191709280506),

1344 
KQU
(18007449949790627628), KQU( 9497178279316537841),

1345 
KQU
( 7920174844809394893), KQU(10037752595255719907),

1346 
KQU
(15875342784985217697), KQU(15311615921712850696),

1347 
KQU
( 9552902652110992950), KQU(14054979450099721140),

1348 
KQU
( 5998709773566417349), KQU(18027910339276320187),

1349 
KQU
( 8223099053868585554), KQU( 7842270354824999767),

1350 
KQU
( 4896315688770080292), KQU(12969320296569787895),

1351 
KQU
( 2674321489185759961), KQU( 4053615936864718439),

1352 
KQU
(11349775270588617578), KQU( 4743019256284553975),

1353 
KQU
( 5602100217469723769), KQU(14398995691411527813),

1354 
KQU
( 7412170493796825470), KQU( 836262406131744846),

1355 
KQU
( 8231086633845153022), KQU( 5161377920438552287),

1356 
KQU
( 8828731196169924949), KQU(16211142246465502680),

1357 
KQU
( 3307990879253687818), KQU( 5193405406899782022),

1358 
KQU
( 8510842117467566693), KQU( 6070955181022405365),

1359 
KQU
(14482950231361409799), KQU(12585159371331138077),

1360 
KQU
( 3511537678933588148), KQU( 2041849474531116417),

1361 
KQU
(10944936685095345792), KQU(18303116923079107729),

1362 
KQU
( 2720566371239725320), KQU( 4958672473562397622),

1363 
KQU
( 3032326668253243412), KQU(13689418691726908338),

1364 
KQU
( 1895205511728843996), KQU( 8146303515271990527),

1365 
KQU
(16507343500056113480), KQU( 473996939105902919),

1366 
KQU
( 9897686885246881481), KQU(14606433762712790575),

1367 
KQU
( 6732796251605566368), KQU( 1399778120855368916),

1368 
KQU
( 935023885182833777), KQU(16066282816186753477),

1369 
KQU
( 7291270991820612055), KQU(17530230393129853844),

1370 
KQU
(10223493623477451366), KQU(15841725630495676683),

1371 
KQU
(17379567246435515824), KQU( 8588251429375561971),

1372 
KQU
(18339511210887206423), KQU(17349587430725976100),

1373 
KQU
(12244876521394838088), KQU( 6382187714147161259),

1374 
KQU
(12335807181848950831), KQU(16948885622305460665),

1375 
KQU
(13755097796371520506), KQU(14806740373324947801),

1376 
KQU
( 4828699633859287703), KQU( 8209879281452301604),

1377 
KQU
(12435716669553736437), KQU(13970976859588452131),

1378 
KQU
( 6233960842566773148), KQU(12507096267900505759),

1379 
KQU
( 1198713114381279421), KQU(14989862731124149015),

1380 
KQU
(15932189508707978949), KQU( 2526406641432708722),

1381 
KQU
( 29187427817271982), KQU( 1499802773054556353),

1382 
KQU
(10816638187021897173), KQU( 5436139270839738132),

1383 
KQU
( 6659882287036010082), KQU( 2154048955317173697),

1384 
KQU
(10887317019333757642), KQU(16281091802634424955),

1385 
KQU
(10754549879915384901), KQU(10760611745769249815),

1386 
KQU
( 2161505946972504002), KQU( 5243132808986265107),

1387 
KQU
(10129852179873415416), KQU( 710339480008649081),

1388 
KQU
( 7802129453068808528), KQU(17967213567178907213),

1389 
KQU
(15730859124668605599), KQU(13058356168962376502),

1390 
KQU
( 3701224985413645909), KQU(14464065869149109264),

1391 
KQU
( 9959272418844311646), KQU(10157426099515958752),

1392 
KQU
(14013736814538268528), KQU(17797456992065653951),

1393 
KQU
(17418878140257344806), KQU(15457429073540561521),

1394 
KQU
( 2184426881360949378), KQU( 2062193041154712416),

1395 
KQU
( 8553463347406931661), KQU( 4913057625202871854),

1396 
KQU
( 2668943682126618425), KQU(17064444737891172288),

1397 
KQU
( 4997115903913298637), KQU(12019402608892327416),

1398 
KQU
(17603584559765897352), KQU(11367529582073647975),

1399 
KQU
( 8211476043518436050), KQU( 8676849804070323674),

1400 
KQU
(18431829230394475730), KQU(10490177861361247904),

1401 
KQU
( 9508720602025651349), KQU( 7409627448555722700),

1402 
KQU
( 5804047018862729008), KQU(11943858176893142594),

1403 
KQU
(11908095418933847092), KQU( 5415449345715887652),

1404 
KQU
( 1554022699166156407), KQU( 9073322106406017161),

1405 
KQU
( 7080630967969047082), KQU(18049736940860732943),

1406 
KQU
(12748714242594196794), KQU( 1226992415735156741),

1407 
KQU
(17900981019609531193), KQU(11720739744008710999),

1408 
KQU
( 3006400683394775434), KQU(11347974011751996028),

1409 
KQU
( 3316999628257954608), KQU( 8384484563557639101),

1410 
KQU
(18117794685961729767), KQU( 1900145025596618194),

1411 
KQU
(17459527840632892676), KQU( 5634784101865710994),

1412 
KQU
( 7918619300292897158), KQU( 3146577625026301350),

1413 
KQU
( 9955212856499068767), KQU( 1873995843681746975),

1414 
KQU
( 1561487759967972194), KQU( 8322718804375878474),

1415 
KQU
(11300284215327028366), KQU( 4667391032508998982),

1416 
KQU
( 9820104494306625580), KQU(17922397968599970610),

1417 
KQU
( 1784690461886786712), KQU(14940365084341346821),

1418 
KQU
( 5348719575594186181), KQU(10720419084507855261),

1419 
KQU
(14210394354145143274), KQU( 2426468692164000131),

1420 
KQU
(16271062114607059202), KQU(14851904092357070247),

1421 
KQU
( 6524493015693121897), KQU( 9825473835127138531),

1422 
KQU
(14222500616268569578), KQU(15521484052007487468),

1423 
KQU
(14462579404124614699), KQU(11012375590820665520),

1424 
KQU
(11625327350536084927), KQU(14452017765243785417),

1425 
KQU
( 9989342263518766305), KQU( 3640105471101803790),

1426 
KQU
( 4749866455897513242), KQU(13963064946736312044),

1427 
KQU
(10007416591973223791), KQU(18314132234717431115),

1428 
KQU
( 3286596588617483450), KQU( 7726163455370818765),

1429 
KQU
( 7575454721115379328), KQU( 5308331576437663422),

1430 
KQU
(18288821894903530934), KQU( 8028405805410554106),

1431 
KQU
(15744019832103296628), KQU( 149765559630932100),

1432 
KQU
( 6137705557200071977), KQU(14513416315434803615),

1433 
KQU
(11665702820128984473), KQU( 218926670505601386),

1434 
KQU
( 6868675028717769519), KQU(15282016569441512302),

1435 
KQU
( 5707000497782960236), KQU( 6671120586555079567),

1436 
KQU
( 2194098052618985448), KQU(16849577895477330978),

1437 
KQU
(12957148471017466283), KQU( 1997805535404859393),

1438 
KQU
( 1180721060263860490), KQU(13206391310193756958),

1439 
KQU
(12980208674461861797), KQU( 3825967775058875366),

1440 
KQU
(17543433670782042631), KQU( 1518339070120322730),

1441 
KQU
(16344584340890991669), KQU( 2611327165318529819),

1442 
KQU
(11265022723283422529), KQU( 4001552800373196817),

1443 
KQU
(14509595890079346161), KQU( 3528717165416234562),

1444 
KQU
(18153222571501914072), KQU( 9387182977209744425),

1445 
KQU
(10064342315985580021), KQU(11373678413215253977),

1446 
KQU
( 2308457853228798099), KQU( 9729042942839545302),

1447 
KQU
( 7833785471140127746), KQU( 6351049900319844436),

1448 
KQU
(14454610627133496067), KQU(12533175683634819111),

1449 
KQU
(15570163926716513029), KQU(13356980519185762498)

1452 
	$TEST_BEGIN
(
‹¡_g’_¿nd_32
)

1454 
ušt32_t
 
¬¿y32
[
BLOCK_SIZE
] 
	`JEMALLOC_ATTR
(
	`®igÃd
(16));

1455 
ušt32_t
 
¬¿y32_2
[
BLOCK_SIZE
] 
	`JEMALLOC_ATTR
(
	`®igÃd
(16));

1456 
i
;

1457 
ušt32_t
 
r32
;

1458 
sfmt_t
 *
ùx
;

1460 
	`as£¹_d_Ë
(
	`g‘_mš_¬¿y_size32
(), 
BLOCK_SIZE
,

1462 
ùx
 = 
	`š™_g’_¿nd
(1234);

1463 
	`fl_¬¿y32
(
ùx
, 
¬¿y32
, 
BLOCK_SIZE
);

1464 
	`fl_¬¿y32
(
ùx
, 
¬¿y32_2
, 
BLOCK_SIZE
);

1465 
	`fši_g’_¿nd
(
ùx
);

1467 
ùx
 = 
	`š™_g’_¿nd
(1234);

1468 
i
 = 0; i < 
BLOCK_SIZE
; i++) {

1469 ià(
i
 < 
COUNT_1
) {

1470 
	`as£¹_u32_eq
(
¬¿y32
[
i
], 
š™_g’_¿nd_32_ex³ùed
[i],

1471 "Ouuˆmism©ch fÜ i=%d", 
i
);

1473 
r32
 = 
	`g’_¿nd32
(
ùx
);

1474 
	`as£¹_u32_eq
(
r32
, 
¬¿y32
[
i
],

1475 "Mism©ch‡ˆ¬¿y32[%d]=%x, g’=%x", 
i
, 
¬¿y32
[i], 
r32
);

1477 
i
 = 0; i < 
COUNT_2
; i++) {

1478 
r32
 = 
	`g’_¿nd32
(
ùx
);

1479 
	`as£¹_u32_eq
(
r32
, 
¬¿y32_2
[
i
],

1480 "Mism©ch‡ˆ¬¿y32_2[%d]=%x, g’=%x", 
i
, 
¬¿y32_2
[i],

1481 
r32
);

1483 
	`fši_g’_¿nd
(
ùx
);

1484 
	}
}

1485 
TEST_END


1487 
	$TEST_BEGIN
(
‹¡_by_¬¿y_32
)

1489 
ušt32_t
 
¬¿y32
[
BLOCK_SIZE
] 
	`JEMALLOC_ATTR
(
	`®igÃd
(16));

1490 
ušt32_t
 
¬¿y32_2
[
BLOCK_SIZE
] 
	`JEMALLOC_ATTR
(
	`®igÃd
(16));

1491 
i
;

1492 
ušt32_t
 
ši
[4] = {0x1234, 0x5678, 0x9abc, 0xdef0};

1493 
ušt32_t
 
r32
;

1494 
sfmt_t
 *
ùx
;

1496 
	`as£¹_d_Ë
(
	`g‘_mš_¬¿y_size32
(), 
BLOCK_SIZE
,

1498 
ùx
 = 
	`š™_by_¬¿y
(
ši
, 4);

1499 
	`fl_¬¿y32
(
ùx
, 
¬¿y32
, 
BLOCK_SIZE
);

1500 
	`fl_¬¿y32
(
ùx
, 
¬¿y32_2
, 
BLOCK_SIZE
);

1501 
	`fši_g’_¿nd
(
ùx
);

1503 
ùx
 = 
	`š™_by_¬¿y
(
ši
, 4);

1504 
i
 = 0; i < 
BLOCK_SIZE
; i++) {

1505 ià(
i
 < 
COUNT_1
) {

1506 
	`as£¹_u32_eq
(
¬¿y32
[
i
], 
š™_by_¬¿y_32_ex³ùed
[i],

1507 "Ouuˆmism©ch fÜ i=%d", 
i
);

1509 
r32
 = 
	`g’_¿nd32
(
ùx
);

1510 
	`as£¹_u32_eq
(
r32
, 
¬¿y32
[
i
],

1511 "Mism©ch‡ˆ¬¿y32[%d]=%x, g’=%x", 
i
, 
¬¿y32
[i], 
r32
);

1513 
i
 = 0; i < 
COUNT_2
; i++) {

1514 
r32
 = 
	`g’_¿nd32
(
ùx
);

1515 
	`as£¹_u32_eq
(
r32
, 
¬¿y32_2
[
i
],

1516 "Mism©ch‡ˆ¬¿y32_2[%d]=%x, g’=%x", 
i
, 
¬¿y32_2
[i],

1517 
r32
);

1519 
	`fši_g’_¿nd
(
ùx
);

1520 
	}
}

1521 
TEST_END


1523 
	$TEST_BEGIN
(
‹¡_g’_¿nd_64
)

1525 
ušt64_t
 
¬¿y64
[
BLOCK_SIZE64
] 
	`JEMALLOC_ATTR
(
	`®igÃd
(16));

1526 
ušt64_t
 
¬¿y64_2
[
BLOCK_SIZE64
] 
	`JEMALLOC_ATTR
(
	`®igÃd
(16));

1527 
i
;

1528 
ušt64_t
 
r
;

1529 
sfmt_t
 *
ùx
;

1531 
	`as£¹_d_Ë
(
	`g‘_mš_¬¿y_size64
(), 
BLOCK_SIZE64
,

1533 
ùx
 = 
	`š™_g’_¿nd
(4321);

1534 
	`fl_¬¿y64
(
ùx
, 
¬¿y64
, 
BLOCK_SIZE64
);

1535 
	`fl_¬¿y64
(
ùx
, 
¬¿y64_2
, 
BLOCK_SIZE64
);

1536 
	`fši_g’_¿nd
(
ùx
);

1538 
ùx
 = 
	`š™_g’_¿nd
(4321);

1539 
i
 = 0; i < 
BLOCK_SIZE64
; i++) {

1540 ià(
i
 < 
COUNT_1
) {

1541 
	`as£¹_u64_eq
(
¬¿y64
[
i
], 
š™_g’_¿nd_64_ex³ùed
[i],

1542 "Ouuˆmism©ch fÜ i=%d", 
i
);

1544 
r
 = 
	`g’_¿nd64
(
ùx
);

1545 
	`as£¹_u64_eq
(
r
, 
¬¿y64
[
i
],

1546 "Mism©ch‡ˆ¬¿y64[%d]=%"
FMTx64
", g’=%"FMTx64, 
i
,

1547 
¬¿y64
[
i
], 
r
);

1549 
i
 = 0; i < 
COUNT_2
; i++) {

1550 
r
 = 
	`g’_¿nd64
(
ùx
);

1551 
	`as£¹_u64_eq
(
r
, 
¬¿y64_2
[
i
],

1552 "Mism©ch‡ˆ¬¿y64_2[%d]=%"
FMTx64
" g’=%"FMTx64"", 
i
,

1553 
¬¿y64_2
[
i
], 
r
);

1555 
	`fši_g’_¿nd
(
ùx
);

1556 
	}
}

1557 
TEST_END


1559 
	$TEST_BEGIN
(
‹¡_by_¬¿y_64
)

1561 
ušt64_t
 
¬¿y64
[
BLOCK_SIZE64
] 
	`JEMALLOC_ATTR
(
	`®igÃd
(16));

1562 
ušt64_t
 
¬¿y64_2
[
BLOCK_SIZE64
] 
	`JEMALLOC_ATTR
(
	`®igÃd
(16));

1563 
i
;

1564 
ušt64_t
 
r
;

1565 
ušt32_t
 
ši
[] = {5, 4, 3, 2, 1};

1566 
sfmt_t
 *
ùx
;

1568 
	`as£¹_d_Ë
(
	`g‘_mš_¬¿y_size64
(), 
BLOCK_SIZE64
,

1570 
ùx
 = 
	`š™_by_¬¿y
(
ši
, 5);

1571 
	`fl_¬¿y64
(
ùx
, 
¬¿y64
, 
BLOCK_SIZE64
);

1572 
	`fl_¬¿y64
(
ùx
, 
¬¿y64_2
, 
BLOCK_SIZE64
);

1573 
	`fši_g’_¿nd
(
ùx
);

1575 
ùx
 = 
	`š™_by_¬¿y
(
ši
, 5);

1576 
i
 = 0; i < 
BLOCK_SIZE64
; i++) {

1577 ià(
i
 < 
COUNT_1
) {

1578 
	`as£¹_u64_eq
(
¬¿y64
[
i
], 
š™_by_¬¿y_64_ex³ùed
[i],

1579 "Ouuˆmism©ch fÜ i=%d", 
i
);

1581 
r
 = 
	`g’_¿nd64
(
ùx
);

1582 
	`as£¹_u64_eq
(
r
, 
¬¿y64
[
i
],

1583 "Mism©ch‡ˆ¬¿y64[%d]=%"
FMTx64
" g’=%"FMTx64, 
i
,

1584 
¬¿y64
[
i
], 
r
);

1586 
i
 = 0; i < 
COUNT_2
; i++) {

1587 
r
 = 
	`g’_¿nd64
(
ùx
);

1588 
	`as£¹_u64_eq
(
r
, 
¬¿y64_2
[
i
],

1589 "Mism©ch‡ˆ¬¿y64_2[%d]=%"
FMTx64
" g’=%"FMTx64, 
i
,

1590 
¬¿y64_2
[
i
], 
r
);

1592 
	`fši_g’_¿nd
(
ùx
);

1593 
	}
}

1594 
TEST_END


1597 
	$maš
()

1600  (
	`‹¡
(

1601 
‹¡_g’_¿nd_32
,

1602 
‹¡_by_¬¿y_32
,

1603 
‹¡_g’_¿nd_64
,

1604 
‹¡_by_¬¿y_64
));

1605 
	}
}

	@deps/jemalloc/test/unit/a0.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	$TEST_BEGIN
(
‹¡_a0
)

5 *
p
;

7 
p
 = 
	`a0m®loc
(1);

8 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected‡0malloc()ƒrror");

9 
	`a0d®loc
(
p
);

10 
	}
}

11 
TEST_END


14 
	$maš
()

17  (
	`‹¡_no_m®loc_š™
(

18 
‹¡_a0
));

19 
	}
}

	@deps/jemalloc/test/unit/arena_reset.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_PROF


4 cÚ¡ *
	gm®loc_cÚf
 = "prof:true,lg_prof_sample:0";

8 
	$g‘_nsizes_im¶
(cÚ¡ *
cmd
)

10 
»t
;

11 
size_t
 
z
;

13 
z
 = ();

14 
	`as£¹_d_eq
(
	`m®lùl
(
cmd
, (*)&
»t
, &
z
, 
NULL
, 0), 0,

15 "UÃx³ùed m®lùl(\"%s\", ...èçu»", 
cmd
);

17  (
»t
);

18 
	}
}

21 
	$g‘_nsm®l
()

24  (
	`g‘_nsizes_im¶
("arenas.nbins"));

25 
	}
}

28 
	$g‘_Æ¬ge
()

31  (
	`g‘_nsizes_im¶
("arenas.nlruns"));

32 
	}
}

35 
	$g‘_nhuge
()

38  (
	`g‘_nsizes_im¶
("arenas.nhchunks"));

39 
	}
}

41 
size_t


42 
	$g‘_size_im¶
(cÚ¡ *
cmd
, 
size_t
 
šd
)

44 
size_t
 
»t
;

45 
size_t
 
z
;

46 
size_t
 
mib
[4];

47 
size_t
 
mibËn
 = 4;

49 
z
 = (
size_t
);

50 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
(
cmd
, 
mib
, &
mibËn
),

51 0, "UÃx³ùed m®lùÊam‘omib(\"%s\", ...èçu»", 
cmd
);

52 
mib
[2] = 
šd
;

53 
z
 = (
size_t
);

54 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
»t
, &
z
, 
NULL
, 0),

55 0, "UÃx³ùed m®lùlbymib([\"%s\", %zu], ...èçu»", 
cmd
, 
šd
);

57  (
»t
);

58 
	}
}

60 
size_t


61 
	$g‘_sm®l_size
(
size_t
 
šd
)

64  (
	`g‘_size_im¶
("¬’as.bš.0.size", 
šd
));

65 
	}
}

67 
size_t


68 
	$g‘_Ïrge_size
(
size_t
 
šd
)

71  (
	`g‘_size_im¶
("¬’as.Ìun.0.size", 
šd
));

72 
	}
}

74 
size_t


75 
	$g‘_huge_size
(
size_t
 
šd
)

78  (
	`g‘_size_im¶
("¬’as.hchunk.0.size", 
šd
));

79 
	}
}

81 
	$TEST_BEGIN
(
‹¡_¬’a_»£t
)

83 
	#NHUGE
 4

	)

84 
¬’a_šd
, 
nsm®l
, 
Æ¬ge
, 
nhuge
, 
ÅŒs
, 
i
;

85 
size_t
 
sz
, 
mibËn
;

86 **
±rs
;

87 
æags
;

88 
size_t
 
mib
[3];

89 
tsdn_t
 *
tsdn
;

91 
	`‹¡_sk_if
((
cÚfig_v®gršd
 && 
	`uÆik–y
(
š_v®gršd
)è|| (
cÚfig_fl


92 && 
	`uÆik–y
(
İt_qu¬ªtše
)));

94 
sz
 = ();

95 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.ex‹nd", (*)&
¬’a_šd
, &
sz
, 
NULL
, 0),

98 
æags
 = 
	`MALLOCX_ARENA
(
¬’a_šd
è| 
MALLOCX_TCACHE_NONE
;

100 
nsm®l
 = 
	`g‘_nsm®l
();

101 
Æ¬ge
 = 
	`g‘_Æ¬ge
();

102 
nhuge
 = 
	`g‘_nhuge
(è> 
NHUGE
 ? NHUGE : get_nhuge();

103 
ÅŒs
 = 
nsm®l
 + 
Æ¬ge
 + 
nhuge
;

104 
±rs
 = (**)
	`m®loc
(
ÅŒs
 * (*));

105 
	`as£¹_±r_nÙ_nuÎ
(
±rs
, "Unexpected malloc() failure");

108 
i
 = 0; i < 
nsm®l
; i++) {

109 
sz
 = 
	`g‘_sm®l_size
(
i
);

110 
±rs
[
i
] = 
	`m®locx
(
sz
, 
æags
);

111 
	`as£¹_±r_nÙ_nuÎ
(
±rs
[
i
],

112 "UÃx³ùed m®locx(%zu, %#xèçu»", 
sz
, 
æags
);

114 
i
 = 0; i < 
Æ¬ge
; i++) {

115 
sz
 = 
	`g‘_Ïrge_size
(
i
);

116 
±rs
[
nsm®l
 + 
i
] = 
	`m®locx
(
sz
, 
æags
);

117 
	`as£¹_±r_nÙ_nuÎ
(
±rs
[
i
],

118 "UÃx³ùed m®locx(%zu, %#xèçu»", 
sz
, 
æags
);

120 
i
 = 0; i < 
nhuge
; i++) {

121 
sz
 = 
	`g‘_huge_size
(
i
);

122 
±rs
[
nsm®l
 + 
Æ¬ge
 + 
i
] = 
	`m®locx
(
sz
, 
æags
);

123 
	`as£¹_±r_nÙ_nuÎ
(
±rs
[
i
],

124 "UÃx³ùed m®locx(%zu, %#xèçu»", 
sz
, 
æags
);

127 
tsdn
 = 
	`tsdn_ãtch
();

130 
i
 = 0; i < 
ÅŒs
; i++) {

131 
	`as£¹_zu_gt
(
	`iv§Îoc
(
tsdn
, 
±rs
[
i
], 
çl£
), 0,

136 
mibËn
 = (
mib
)/(
size_t
);

137 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’a.0.»£t", 
mib
, &
mibËn
), 0,

139 
mib
[1] = (
size_t
)
¬’a_šd
;

140 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, 
NULL
, NULL, NULL, 0), 0,

144 
i
 = 0; i < 
ÅŒs
; i++) {

145 
	`as£¹_zu_eq
(
	`iv§Îoc
(
tsdn
, 
±rs
[
i
], 
çl£
), 0,

149 
	`ä“
(
±rs
);

150 
	}
}

151 
TEST_END


154 
	$maš
()

157  (
	`‹¡
(

158 
‹¡_¬’a_»£t
));

159 
	}
}

	@deps/jemalloc/test/unit/atomic.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#TEST_STRUCT
(
p
, 
t
) \

4 
p
##
_‹¡_s
 { \

5 
t
 
accum0
; \

6 
t
 
x
; \

7 
t
 
s
; \

9 
p
##
	t_‹¡_s
 
	tp
##
	t_‹¡_t
;

	)

11 
	#TEST_BODY
(
p
, 
t
, 
tc
, 

, 
FMT
) do { \

12 cÚ¡ 
p
##
_‹¡_t
 
‹¡s
[] = { \

13 {(
t
)-1, (t)-1, (t)-2}, \

14 {(
t
)-1, (t) 0, (t)-2}, \

15 {(
t
)-1, (t) 1, (t)-2}, \

17 {(
t
) 0, (t)-1, (t)-2}, \

18 {(
t
) 0, (t) 0, (t)-2}, \

19 {(
t
) 0, (t) 1, (t)-2}, \

21 {(
t
) 1, (t)-1, (t)-2}, \

22 {(
t
) 1, (t) 0, (t)-2}, \

23 {(
t
) 1, (t) 1, (t)-2}, \

25 {(
t
)0, (t)-(1 << 22), (t)-2}, \

26 {(
t
)0, (t)(1 << 22), (t)-2}, \

27 {(
t
)(1 << 22), (t)-(1 << 22), (t)-2}, \

28 {(
t
)(1 << 22), (t)(1 << 22), (t)-2} \

30 
i
; \

32 
i
 = 0; i < (
‹¡s
)/(
p
##
_‹¡_t
); i++) { \

33 
boŞ
 
”r
; \

34 
t
 
accum
 = 
‹¡s
[
i
].
accum0
; \

35 
as£¹_
##

##
	`_eq
(
©omic_»ad_
##
	`p
(&
accum
), \

36 
‹¡s
[
i
].
accum0
, \

37 "E¼Úeou »ad, i=%u", 
i
); \

39 
as£¹_
##

##
	`_eq
(
©omic_add_
##
	`p
(&
accum
, 
‹¡s
[
i
].
x
), \

40 (
t
)((
tc
)
‹¡s
[
i
].
accum0
 + (tcée¡s[i].
x
), \

41 "i=%u,‡ccum=%"
FMT
", x=%"FMT, \

42 
i
, 
‹¡s
[i].
accum0
,e¡s[i].
x
); \

43 
as£¹_
##

##
	`_eq
(
©omic_»ad_
##
	`p
(&
accum
),‡ccum, \

44 "E¼Úeou add, i=%u", 
i
); \

46 
accum
 = 
‹¡s
[
i
].
accum0
; \

47 
as£¹_
##

##
	`_eq
(
©omic_sub_
##
	`p
(&
accum
, 
‹¡s
[
i
].
x
), \

48 (
t
)((
tc
)
‹¡s
[
i
].
accum0
 - (tcée¡s[i].
x
), \

49 "i=%u,‡ccum=%"
FMT
", x=%"FMT, \

50 
i
, 
‹¡s
[i].
accum0
,e¡s[i].
x
); \

51 
as£¹_
##

##
	`_eq
(
©omic_»ad_
##
	`p
(&
accum
),‡ccum, \

52 "E¼Úeou sub, i=%u", 
i
); \

54 
accum
 = 
‹¡s
[
i
].
accum0
; \

55 
”r
 = 
©omic_ÿs_
##
	`p
(&
accum
, 
‹¡s
[
i
].
x
,e¡s[i].
s
); \

56 
	`as£¹_b_eq
(
”r
, 
‹¡s
[
i
].
accum0
 !ğ‹¡s[i].
x
, \

58 
as£¹_
##

##
	`_eq
(
accum
, 
”r
 ? 
‹¡s
[
i
].
accum0
 : \

59 
‹¡s
[
i
].
s
, "Erroneous casƒffect, i=%u", i); \

61 
accum
 = 
‹¡s
[
i
].
accum0
; \

62 
©omic_wr™e_
##
	`p
(&
accum
, 
‹¡s
[
i
].
s
); \

63 
as£¹_
##

##
	`_eq
(
accum
, 
‹¡s
[
i
].
s
, \

64 "E¼Úeou wr™e, i=%u", 
i
); \

66 } 0)

	)

68 
	$TEST_STRUCT
(
ušt64
, 
ušt64_t
)

69 
	$TEST_BEGIN
(
‹¡_©omic_ušt64
)

72 #ià!(
LG_SIZEOF_PTR
 =ğ3 || 
LG_SIZEOF_INT
 == 3)

73 
	`‹¡_sk
("64-bit‡tomic operations‚ot supported");

75 
	`TEST_BODY
(
ušt64
, 
ušt64_t
, ušt64_t, 
u64
, 
FMTx64
);

77 
	}
}

78 
TEST_END


80 
	$TEST_STRUCT
(
ušt32
, 
ušt32_t
)

81 
	$TEST_BEGIN
(
‹¡_©omic_ušt32
)

84 
	`TEST_BODY
(
ušt32
, 
ušt32_t
, ušt32_t, 
u32
, "#"
FMTx32
);

85 
	}
}

86 
TEST_END


88 
	$TEST_STRUCT
(
p
, *)

89 
	$TEST_BEGIN
(
‹¡_©omic_p
)

92 
	`TEST_BODY
(
p
, *, 
ušŒ_t
, 
±r
, "p");

93 
	}
}

94 
TEST_END


96 
	$TEST_STRUCT
(
z
, 
size_t
)

97 
	$TEST_BEGIN
(
‹¡_©omic_z
)

100 
	`TEST_BODY
(
z
, 
size_t
, size_t, 
zu
, "#zx");

101 
	}
}

102 
TEST_END


104 
	$TEST_STRUCT
(
u
, )

105 
	$TEST_BEGIN
(
‹¡_©omic_u
)

108 
	`TEST_BODY
(
u
, , , u, "#x");

109 
	}
}

110 
TEST_END


113 
	$maš
()

116  (
	`‹¡
(

117 
‹¡_©omic_ušt64
,

118 
‹¡_©omic_ušt32
,

119 
‹¡_©omic_p
,

120 
‹¡_©omic_z
,

121 
‹¡_©omic_u
));

122 
	}
}

	@deps/jemalloc/test/unit/bitmap.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	$TEST_BEGIN
(
‹¡_b™m­_size
)

5 
size_t
 
i
, 
´ev_size
;

7 
´ev_size
 = 0;

8 
i
 = 1; i <ğ
BITMAP_MAXBITS
; i++) {

9 
b™m­_šfo_t
 
bšfo
;

10 
size_t
 
size
;

12 
	`b™m­_šfo_š™
(&
bšfo
, 
i
);

13 
size
 = 
	`b™m­_size
(&
bšfo
);

14 
	`as£¹_Œue
(
size
 >ğ
´ev_size
,

16 
´ev_size
 = 
size
;

18 
	}
}

19 
TEST_END


21 
	$TEST_BEGIN
(
‹¡_b™m­_š™
)

23 
size_t
 
i
;

25 
i
 = 1; i <ğ
BITMAP_MAXBITS
; i++) {

26 
b™m­_šfo_t
 
bšfo
;

27 
	`b™m­_šfo_š™
(&
bšfo
, 
i
);

29 
size_t
 
j
;

30 
b™m­_t
 *
b™m­
 = (b™m­_ˆ*)
	`m®loc
(

31 
	`b™m­_size
(&
bšfo
));

32 
	`b™m­_š™
(
b™m­
, &
bšfo
);

34 
j
 = 0; j < 
i
; j++) {

35 
	`as£¹_çl£
(
	`b™m­_g‘
(
b™m­
, &
bšfo
, 
j
),

38 
	`ä“
(
b™m­
);

41 
	}
}

42 
TEST_END


44 
	$TEST_BEGIN
(
‹¡_b™m­_£t
)

46 
size_t
 
i
;

48 
i
 = 1; i <ğ
BITMAP_MAXBITS
; i++) {

49 
b™m­_šfo_t
 
bšfo
;

50 
	`b™m­_šfo_š™
(&
bšfo
, 
i
);

52 
size_t
 
j
;

53 
b™m­_t
 *
b™m­
 = (b™m­_ˆ*)
	`m®loc
(

54 
	`b™m­_size
(&
bšfo
));

55 
	`b™m­_š™
(
b™m­
, &
bšfo
);

57 
j
 = 0; j < 
i
; j++)

58 
	`b™m­_£t
(
b™m­
, &
bšfo
, 
j
);

59 
	`as£¹_Œue
(
	`b™m­_fuÎ
(
b™m­
, &
bšfo
),

61 
	`ä“
(
b™m­
);

64 
	}
}

65 
TEST_END


67 
	$TEST_BEGIN
(
‹¡_b™m­_un£t
)

69 
size_t
 
i
;

71 
i
 = 1; i <ğ
BITMAP_MAXBITS
; i++) {

72 
b™m­_šfo_t
 
bšfo
;

73 
	`b™m­_šfo_š™
(&
bšfo
, 
i
);

75 
size_t
 
j
;

76 
b™m­_t
 *
b™m­
 = (b™m­_ˆ*)
	`m®loc
(

77 
	`b™m­_size
(&
bšfo
));

78 
	`b™m­_š™
(
b™m­
, &
bšfo
);

80 
j
 = 0; j < 
i
; j++)

81 
	`b™m­_£t
(
b™m­
, &
bšfo
, 
j
);

82 
	`as£¹_Œue
(
	`b™m­_fuÎ
(
b™m­
, &
bšfo
),

84 
j
 = 0; j < 
i
; j++)

85 
	`b™m­_un£t
(
b™m­
, &
bšfo
, 
j
);

86 
j
 = 0; j < 
i
; j++)

87 
	`b™m­_£t
(
b™m­
, &
bšfo
, 
j
);

88 
	`as£¹_Œue
(
	`b™m­_fuÎ
(
b™m­
, &
bšfo
),

90 
	`ä“
(
b™m­
);

93 
	}
}

94 
TEST_END


96 
	$TEST_BEGIN
(
‹¡_b™m­_sfu
)

98 
size_t
 
i
;

100 
i
 = 1; i <ğ
BITMAP_MAXBITS
; i++) {

101 
b™m­_šfo_t
 
bšfo
;

102 
	`b™m­_šfo_š™
(&
bšfo
, 
i
);

104 
size_t
 
j
;

105 
b™m­_t
 *
b™m­
 = (b™m­_ˆ*)
	`m®loc
(

106 
	`b™m­_size
(&
bšfo
));

107 
	`b™m­_š™
(
b™m­
, &
bšfo
);

110 
j
 = 0; j < 
i
; j++) {

111 
	`as£¹_zd_eq
(
	`b™m­_sfu
(
b™m­
, &
bšfo
), 
j
,

115 
	`as£¹_Œue
(
	`b™m­_fuÎ
(
b™m­
, &
bšfo
),

122 
j
 = 
i
 - 1; j < i; j--) {

123 
	`b™m­_un£t
(
b™m­
, &
bšfo
, 
j
);

124 
	`as£¹_zd_eq
(
	`b™m­_sfu
(
b™m­
, &
bšfo
), 
j
,

127 
	`b™m­_un£t
(
b™m­
, &
bšfo
, 
j
);

129 
	`as£¹_çl£
(
	`b™m­_g‘
(
b™m­
, &
bšfo
, 0),

136 
j
 = 1; j < 
i
; j++) {

137 
	`b™m­_£t
(
b™m­
, &
bšfo
, 
j
 - 1);

138 
	`as£¹_zd_eq
(
	`b™m­_sfu
(
b™m­
, &
bšfo
), 
j
,

141 
	`b™m­_un£t
(
b™m­
, &
bšfo
, 
j
);

143 
	`as£¹_zd_eq
(
	`b™m­_sfu
(
b™m­
, &
bšfo
), 
i
 - 1,

145 
	`as£¹_Œue
(
	`b™m­_fuÎ
(
b™m­
, &
bšfo
),

147 
	`ä“
(
b™m­
);

150 
	}
}

151 
TEST_END


154 
	$maš
()

157  (
	`‹¡
(

158 
‹¡_b™m­_size
,

159 
‹¡_b™m­_š™
,

160 
‹¡_b™m­_£t
,

161 
‹¡_b™m­_un£t
,

162 
‹¡_b™m­_sfu
));

163 
	}
}

	@deps/jemalloc/test/unit/ckh.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	$TEST_BEGIN
(
‹¡_Ãw_d–‘e
)

5 
tsd_t
 *
tsd
;

6 
ckh_t
 
ckh
;

8 
tsd
 = 
	`tsd_ãtch
();

10 
	`as£¹_çl£
(
	`ckh_Ãw
(
tsd
, &
ckh
, 2, 
ckh_¡ršg_hash
,

11 
ckh_¡ršg_keycomp
), "Unexpected ckh_new()ƒrror");

12 
	`ckh_d–‘e
(
tsd
, &
ckh
);

14 
	`as£¹_çl£
(
	`ckh_Ãw
(
tsd
, &
ckh
, 3, 
ckh_poš‹r_hash
,

15 
ckh_poš‹r_keycomp
), "Unexpected ckh_new()ƒrror");

16 
	`ckh_d–‘e
(
tsd
, &
ckh
);

17 
	}
}

18 
TEST_END


20 
	$TEST_BEGIN
(
‹¡_couÁ_š£¹_£¬ch_»move
)

22 
tsd_t
 *
tsd
;

23 
ckh_t
 
ckh
;

24 cÚ¡ *
¡rs
[] = {

30 cÚ¡ *
missšg
 = "A string‚ot inhe hashable.";

31 
size_t
 
i
;

33 
tsd
 = 
	`tsd_ãtch
();

35 
	`as£¹_çl£
(
	`ckh_Ãw
(
tsd
, &
ckh
, 2, 
ckh_¡ršg_hash
,

36 
ckh_¡ršg_keycomp
), "Unexpected ckh_new()ƒrror");

37 
	`as£¹_zu_eq
(
	`ckh_couÁ
(&
ckh
), 0,

38 "ckh_couÁ(èshould„‘uº %zu, buˆ™„‘uºed %zu", 
	`ZU
(0),

39 
	`ckh_couÁ
(&
ckh
));

42 
i
 = 0; i < (
¡rs
)/(const *); i++) {

43 
	`ckh_š£¹
(
tsd
, &
ckh
, 
¡rs
[
i
], strs[i]);

44 
	`as£¹_zu_eq
(
	`ckh_couÁ
(&
ckh
), 
i
+1,

45 "ckh_couÁ(èshould„‘uº %zu, buˆ™„‘uºed %zu", 
i
+1,

46 
	`ckh_couÁ
(&
ckh
));

50 
i
 = 0; i < (
¡rs
)/(const *); i++) {

52 *
p
;

53 cÚ¡ *
s
;

54 } 
k
, 
v
;

55 **
kp
, **
vp
;

56 cÚ¡ *
ks
, *
vs
;

58 
kp
 = (
i
 & 1è? &
k
.
p
 : 
NULL
;

59 
vp
 = (
i
 & 2è? &
v
.
p
 : 
NULL
;

60 
k
.
p
 = 
NULL
;

61 
v
.
p
 = 
NULL
;

62 
	`as£¹_çl£
(
	`ckh_£¬ch
(&
ckh
, 
¡rs
[
i
], 
kp
, 
vp
),

65 
ks
 = (
i
 & 1è? 
¡rs
[i] : (cÚ¡ *)
NULL
;

66 
vs
 = (
i
 & 2è? 
¡rs
[i] : (cÚ¡ *)
NULL
;

67 
	`as£¹_±r_eq
((*)
ks
, (*)
k
.
s
, "Key mismatch, i=%zu",

68 
i
);

69 
	`as£¹_±r_eq
((*)
vs
, (*)
v
.
s
, "Value mismatch, i=%zu",

70 
i
);

72 
	`as£¹_Œue
(
	`ckh_£¬ch
(&
ckh
, 
missšg
, 
NULL
, NULL),

76 
i
 = 0; i < (
¡rs
)/(const *); i++) {

78 *
p
;

79 cÚ¡ *
s
;

80 } 
k
, 
v
;

81 **
kp
, **
vp
;

82 cÚ¡ *
ks
, *
vs
;

84 
kp
 = (
i
 & 1è? &
k
.
p
 : 
NULL
;

85 
vp
 = (
i
 & 2è? &
v
.
p
 : 
NULL
;

86 
k
.
p
 = 
NULL
;

87 
v
.
p
 = 
NULL
;

88 
	`as£¹_çl£
(
	`ckh_»move
(
tsd
, &
ckh
, 
¡rs
[
i
], 
kp
, 
vp
),

91 
ks
 = (
i
 & 1è? 
¡rs
[i] : (cÚ¡ *)
NULL
;

92 
vs
 = (
i
 & 2è? 
¡rs
[i] : (cÚ¡ *)
NULL
;

93 
	`as£¹_±r_eq
((*)
ks
, (*)
k
.
s
, "Key mismatch, i=%zu",

94 
i
);

95 
	`as£¹_±r_eq
((*)
vs
, (*)
v
.
s
, "Value mismatch, i=%zu",

96 
i
);

97 
	`as£¹_zu_eq
(
	`ckh_couÁ
(&
ckh
),

98 (
¡rs
)/(cÚ¡ *è- 
i
 - 1,

100 (
¡rs
)/(cÚ¡ *è- 
i
 - 1,

101 
	`ckh_couÁ
(&
ckh
));

104 
	`ckh_d–‘e
(
tsd
, &
ckh
);

105 
	}
}

106 
TEST_END


108 
	$TEST_BEGIN
(
‹¡_š£¹_™”_»move
)

110 
	#NITEMS
 
	`ZU
(1000)

	)

111 
tsd_t
 *
tsd
;

112 
ckh_t
 
ckh
;

113 **
p
[
NITEMS
];

114 *
q
, *
r
;

115 
size_t
 
i
;

117 
tsd
 = 
	`tsd_ãtch
();

119 
	`as£¹_çl£
(
	`ckh_Ãw
(
tsd
, &
ckh
, 2, 
ckh_poš‹r_hash
,

120 
ckh_poš‹r_keycomp
), "Unexpected ckh_new()ƒrror");

122 
i
 = 0; i < 
NITEMS
; i++) {

123 
p
[
i
] = 
	`m®locx
(i+1, 0);

124 
	`as£¹_±r_nÙ_nuÎ
(
p
[
i
], "Unexpected mallocx() failure");

127 
i
 = 0; i < 
NITEMS
; i++) {

128 
size_t
 
j
;

130 
j
 = 
i
; j < 
NITEMS
; j++) {

131 
	`as£¹_çl£
(
	`ckh_š£¹
(
tsd
, &
ckh
, 
p
[
j
],…[j]),

133 
	`as£¹_çl£
(
	`ckh_£¬ch
(&
ckh
, 
p
[
j
], &
q
, &
r
),

135 
	`as£¹_±r_eq
(
p
[
j
], 
q
, "Key…ointer mismatch");

136 
	`as£¹_±r_eq
(
p
[
j
], 
r
, "Value…ointer mismatch");

139 
	`as£¹_zu_eq
(
	`ckh_couÁ
(&
ckh
), 
NITEMS
,

141 
NITEMS
, 
	`ckh_couÁ
(&
ckh
));

143 
j
 = 
i
 + 1; j < 
NITEMS
; j++) {

144 
	`as£¹_çl£
(
	`ckh_£¬ch
(&
ckh
, 
p
[
j
], 
NULL
, NULL),

146 
	`as£¹_çl£
(
	`ckh_»move
(
tsd
, &
ckh
, 
p
[
j
], &
q
, &
r
),

148 
	`as£¹_±r_eq
(
p
[
j
], 
q
, "Key…ointer mismatch");

149 
	`as£¹_±r_eq
(
p
[
j
], 
r
, "Value…ointer mismatch");

150 
	`as£¹_Œue
(
	`ckh_£¬ch
(&
ckh
, 
p
[
j
], 
NULL
, NULL),

152 
	`as£¹_Œue
(
	`ckh_»move
(
tsd
, &
ckh
, 
p
[
j
], &
q
, &
r
),

157 
boŞ
 
£’
[
NITEMS
];

158 
size_t
 
bšd
;

160 
	`mem£t
(
£’
, 0, (seen));

162 
bšd
 = 0; !
	`ckh_™”
(&
ckh
, &bšd, &
q
, &
r
);) {

163 
size_t
 
k
;

165 
	`as£¹_±r_eq
(
q
, 
r
, "Key‡nd val‚otƒqual");

167 
k
 = 0; k < 
NITEMS
; k++) {

168 ià(
p
[
k
] =ğ
q
) {

169 
	`as£¹_çl£
(
£’
[
k
],

170 "I‹m %zu‡Ì—dy s“n", 
k
);

171 
£’
[
k
] = 
Œue
;

177 
j
 = 0; j < 
i
 + 1; j++)

178 
	`as£¹_Œue
(
£’
[
j
], "Item %zu‚ot seen", j);

179 ; 
j
 < 
NITEMS
; j++)

180 
	`as£¹_çl£
(
£’
[
j
], "Item %zu seen", j);

184 
i
 = 0; i < 
NITEMS
; i++) {

185 
	`as£¹_çl£
(
	`ckh_£¬ch
(&
ckh
, 
p
[
i
], 
NULL
, NULL),

187 
	`as£¹_çl£
(
	`ckh_»move
(
tsd
, &
ckh
, 
p
[
i
], &
q
, &
r
),

189 
	`as£¹_±r_eq
(
p
[
i
], 
q
, "Key…ointer mismatch");

190 
	`as£¹_±r_eq
(
p
[
i
], 
r
, "Value…ointer mismatch");

191 
	`as£¹_Œue
(
	`ckh_£¬ch
(&
ckh
, 
p
[
i
], 
NULL
, NULL),

193 
	`as£¹_Œue
(
	`ckh_»move
(
tsd
, &
ckh
, 
p
[
i
], &
q
, &
r
),

195 
	`d®locx
(
p
[
i
], 0);

198 
	`as£¹_zu_eq
(
	`ckh_couÁ
(&
ckh
), 0,

200 
	`ZU
(0), 
	`ckh_couÁ
(&
ckh
));

201 
	`ckh_d–‘e
(
tsd
, &
ckh
);

202 #undeà
NITEMS


203 
	}
}

204 
TEST_END


207 
	$maš
()

210  (
	`‹¡
(

211 
‹¡_Ãw_d–‘e
,

212 
‹¡_couÁ_š£¹_£¬ch_»move
,

213 
‹¡_š£¹_™”_»move
));

214 
	}
}

	@deps/jemalloc/test/unit/decay.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 cÚ¡ *
	gm®loc_cÚf
 = "purge:decay,decay_time:1";

5 
n¡ime_mÚÙÚic_t
 *
	gn¡ime_mÚÙÚic_Üig
;

6 
n¡ime_upd©e_t
 *
	gn¡ime_upd©e_Üig
;

8 
	gnupd©es_mock
;

9 
n¡ime_t
 
	gtime_mock
;

10 
boŞ
 
	gmÚÙÚic_mock
;

12 
boŞ


13 
	$n¡ime_mÚÙÚic_mock
()

16  (
mÚÙÚic_mock
);

17 
	}
}

19 
boŞ


20 
	$n¡ime_upd©e_mock
(
n¡ime_t
 *
time
)

23 
nupd©es_mock
++;

24 ià(
mÚÙÚic_mock
)

25 
	`n¡ime_cİy
(
time
, &
time_mock
);

26  (!
mÚÙÚic_mock
);

27 
	}
}

29 
	$TEST_BEGIN
(
‹¡_deÿy_ticks
)

31 
tick”_t
 *
deÿy_tick”
;

32 
tick0
, 
tick1
;

33 
size_t
 
sz
, 
huge0
, 
Ïrge0
;

34 *
p
;

36 
	`‹¡_sk_if
(
İt_purge
 !ğ
purge_mode_deÿy
);

38 
deÿy_tick”
 = 
	`deÿy_tick”_g‘
(
	`tsd_ãtch
(), 0);

39 
	`as£¹_±r_nÙ_nuÎ
(
deÿy_tick”
,

42 
sz
 = (
size_t
);

43 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.hchunk.0.size", (*)&
huge0
, &
sz
, 
NULL
,

45 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ìun.0.size", (*)&
Ïrge0
, &
sz
, 
NULL
,

55 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

56 
p
 = 
	`m®loc
(
huge0
);

57 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected malloc() failure");

58 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

59 
	`as£¹_u32_Ã
(
tick1
, 
tick0
, "Expectedickeroick during malloc()");

61 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

62 
	`ä“
(
p
);

63 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

64 
	`as£¹_u32_Ã
(
tick1
, 
tick0
, "Expectedickeroick during free()");

67 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

68 
p
 = 
	`ÿÎoc
(1, 
huge0
);

69 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected calloc() failure");

70 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

71 
	`as£¹_u32_Ã
(
tick1
, 
tick0
, "Expectedickeroick during calloc()");

72 
	`ä“
(
p
);

75 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

76 
	`as£¹_d_eq
(
	`posix_mem®ign
(&
p
, (
size_t
), 
huge0
), 0,

78 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

79 
	`as£¹_u32_Ã
(
tick1
, 
tick0
,

81 
	`ä“
(
p
);

84 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

85 
p
 = 
	`®igÃd_®loc
((
size_t
), 
huge0
);

86 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected‡ligned_alloc() failure");

87 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

88 
	`as£¹_u32_Ã
(
tick1
, 
tick0
,

90 
	`ä“
(
p
);

94 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

95 
p
 = 
	`»®loc
(
NULL
, 
huge0
);

96 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected„ealloc() failure");

97 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

98 
	`as£¹_u32_Ã
(
tick1
, 
tick0
, "Expectedickeroick during„ealloc()");

100 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

101 
p
 = 
	`»®loc
Õ, 
huge0
);

102 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected„ealloc() failure");

103 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

104 
	`as£¹_u32_Ã
(
tick1
, 
tick0
, "Expectedickeroick during„ealloc()");

106 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

107 
	`»®loc
(
p
, 0);

108 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

109 
	`as£¹_u32_Ã
(
tick1
, 
tick0
, "Expectedickeroick during„ealloc()");

116 
i
;

117 
size_t
 
®locx_sizes
[3];

118 
®locx_sizes
[0] = 
huge0
;

119 
®locx_sizes
[1] = 
Ïrge0
;

120 
®locx_sizes
[2] = 1;

122 
i
 = 0; i < (
®locx_sizes
è/ (
size_t
); i++) {

123 
sz
 = 
®locx_sizes
[
i
];

126 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

127 
p
 = 
	`m®locx
(
sz
, 
MALLOCX_TCACHE_NONE
);

128 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

129 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

130 
	`as£¹_u32_Ã
(
tick1
, 
tick0
,

132 
sz
);

134 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

135 
p
 = 
	`¿Îocx
Õ, 
sz
, 
MALLOCX_TCACHE_NONE
);

136 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected„allocx() failure");

137 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

138 
	`as£¹_u32_Ã
(
tick1
, 
tick0
,

140 
sz
);

142 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

143 
	`x®locx
(
p
, 
sz
, 0, 
MALLOCX_TCACHE_NONE
);

144 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

145 
	`as£¹_u32_Ã
(
tick1
, 
tick0
,

147 
sz
);

149 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

150 
	`d®locx
(
p
, 
MALLOCX_TCACHE_NONE
);

151 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

152 
	`as£¹_u32_Ã
(
tick1
, 
tick0
,

154 
sz
);

156 
p
 = 
	`m®locx
(
sz
, 
MALLOCX_TCACHE_NONE
);

157 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

158 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

159 
	`sd®locx
(
p
, 
sz
, 
MALLOCX_TCACHE_NONE
);

160 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

161 
	`as£¹_u32_Ã
(
tick1
, 
tick0
,

163 "(sz=%zu)", 
sz
);

171 ià(
cÚfig_tÿche
) {

172 
tÿche_šd
, 
i
;

173 
size_t
 
tÿche_sizes
[2];

174 
tÿche_sizes
[0] = 
Ïrge0
;

175 
tÿche_sizes
[1] = 1;

177 
sz
 = ();

178 
	`as£¹_d_eq
(
	`m®lùl
("tÿche.ü—‹", (*)&
tÿche_šd
, &
sz
,

179 
NULL
, 0), 0, "Unexpected mallctl failure");

181 
i
 = 0; i < (
tÿche_sizes
è/ (
size_t
); i++) {

182 
sz
 = 
tÿche_sizes
[
i
];

185 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

186 
p
 = 
	`m®locx
(
sz
, 
	`MALLOCX_TCACHE
(
tÿche_šd
));

187 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

188 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

189 
	`as£¹_u32_Ã
(
tick1
, 
tick0
,

191 "(sz=%zu)", 
sz
);

193 
	`d®locx
(
p
, 
	`MALLOCX_TCACHE
(
tÿche_šd
));

194 
tick0
 = 
	`tick”_»ad
(
deÿy_tick”
);

195 
	`as£¹_d_eq
(
	`m®lùl
("tÿche.æush", 
NULL
, NULL,

196 (*)&
tÿche_šd
, ()), 0,

198 
tick1
 = 
	`tick”_»ad
(
deÿy_tick”
);

199 
	`as£¹_u32_Ã
(
tick1
, 
tick0
,

201 "(sz=%zu)", 
sz
);

204 
	}
}

205 
TEST_END


207 
	$TEST_BEGIN
(
‹¡_deÿy_tick”
)

209 
	#NPS
 1024

	)

210 
æags
 = (
	`MALLOCX_ARENA
(0è| 
MALLOCX_TCACHE_NONE
);

211 *
ps
[
NPS
];

212 
ušt64_t
 
•och
;

213 
ušt64_t
 
Åurge0
 = 0;

214 
ušt64_t
 
Åurge1
 = 0;

215 
size_t
 
sz
, 
Ïrge
;

216 
i
, 
nupd©es0
;

217 
n¡ime_t
 
time
, 
deÿy_time
, 
d—dlše
;

219 
	`‹¡_sk_if
(
İt_purge
 !ğ
purge_mode_deÿy
);

227 ià(
cÚfig_tÿche
) {

228 
size_t
 
tÿche_max
;

230 
sz
 = (
size_t
);

231 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.tÿche_max", (*)&
tÿche_max
,

232 &
sz
, 
NULL
, 0), 0, "Unexpected mallctl failure");

233 
Ïrge
 = 
	`ÇÎocx
(
tÿche_max
 + 1, 
æags
);

235 
sz
 = (
size_t
);

236 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ìun.0.size", (*)&
Ïrge
, &
sz
,

237 
NULL
, 0), 0, "Unexpected mallctl failure");

240 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.purge", 
NULL
, NULL, NULL, 0), 0,

242 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
,

243 (
ušt64_t
)), 0, "Unexpected mallctl failure");

244 
sz
 = (
ušt64_t
);

245 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Åurge", (*)&
Åurge0
, &
sz
,

246 
NULL
, 0), 
cÚfig_¡©s
 ? 0 : 
ENOENT
, "Unexpected mallctl„esult");

248 
i
 = 0; i < 
NPS
; i++) {

249 
ps
[
i
] = 
	`m®locx
(
Ïrge
, 
æags
);

250 
	`as£¹_±r_nÙ_nuÎ
(
ps
[
i
], "Unexpected mallocx() failure");

253 
nupd©es_mock
 = 0;

254 
	`n¡ime_š™
(&
time_mock
, 0);

255 
	`n¡ime_upd©e
(&
time_mock
);

256 
mÚÙÚic_mock
 = 
Œue
;

258 
n¡ime_mÚÙÚic_Üig
 = 
n¡ime_mÚÙÚic
;

259 
n¡ime_upd©e_Üig
 = 
n¡ime_upd©e
;

260 
n¡ime_mÚÙÚic
 = 
n¡ime_mÚÙÚic_mock
;

261 
n¡ime_upd©e
 = 
n¡ime_upd©e_mock
;

263 
i
 = 0; i < 
NPS
; i++) {

264 
	`d®locx
(
ps
[
i
], 
æags
);

265 
nupd©es0
 = 
nupd©es_mock
;

266 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.deÿy", 
NULL
, NULL, NULL, 0), 0,

268 
	`as£¹_u_gt
(
nupd©es_mock
, 
nupd©es0
,

272 
n¡ime_mÚÙÚic
 = 
n¡ime_mÚÙÚic_Üig
;

273 
n¡ime_upd©e
 = 
n¡ime_upd©e_Üig
;

275 
	`n¡ime_š™
(&
time
, 0);

276 
	`n¡ime_upd©e
(&
time
);

277 
	`n¡ime_š™2
(&
deÿy_time
, 
İt_deÿy_time
, 0);

278 
	`n¡ime_cİy
(&
d—dlše
, &
time
);

279 
	`n¡ime_add
(&
d—dlše
, &
deÿy_time
);

281 
i
 = 0; i < 
DECAY_NTICKS_PER_UPDATE
 / 2; i++) {

282 *
p
 = 
	`m®locx
(1, 
æags
);

283 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

284 
	`d®locx
(
p
, 
æags
);

286 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
,

287 (
ušt64_t
)), 0, "Unexpected mallctl failure");

288 
sz
 = (
ušt64_t
);

289 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Åurge", (*)&
Åurge1
,

290 &
sz
, 
NULL
, 0), 
cÚfig_¡©s
 ? 0 : 
ENOENT
,

293 
	`n¡ime_upd©e
(&
time
);

294 } 
	`n¡ime_com·»
(&
time
, &
d—dlše
è<ğ0 && 
Åurge1
 =ğ
Åurge0
);

296 ià(
cÚfig_¡©s
)

297 
	`as£¹_u64_gt
(
Åurge1
, 
Åurge0
, "Expected…urgingo occur");

298 #undeà
NPS


299 
	}
}

300 
TEST_END


302 
	$TEST_BEGIN
(
‹¡_deÿy_nÚmÚÙÚic
)

304 
	#NPS
 (
SMOOTHSTEP_NSTEPS
 + 1)

	)

305 
æags
 = (
	`MALLOCX_ARENA
(0è| 
MALLOCX_TCACHE_NONE
);

306 *
ps
[
NPS
];

307 
ušt64_t
 
•och
;

308 
ušt64_t
 
Åurge0
 = 0;

309 
ušt64_t
 
Åurge1
 = 0;

310 
size_t
 
sz
, 
Ïrge0
;

311 
i
, 
nupd©es0
;

313 
	`‹¡_sk_if
(
İt_purge
 !ğ
purge_mode_deÿy
);

315 
sz
 = (
size_t
);

316 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ìun.0.size", (*)&
Ïrge0
, &
sz
, 
NULL
,

319 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.purge", 
NULL
, NULL, NULL, 0), 0,

321 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
,

322 (
ušt64_t
)), 0, "Unexpected mallctl failure");

323 
sz
 = (
ušt64_t
);

324 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Åurge", (*)&
Åurge0
, &
sz
,

325 
NULL
, 0), 
cÚfig_¡©s
 ? 0 : 
ENOENT
, "Unexpected mallctl„esult");

327 
nupd©es_mock
 = 0;

328 
	`n¡ime_š™
(&
time_mock
, 0);

329 
	`n¡ime_upd©e
(&
time_mock
);

330 
mÚÙÚic_mock
 = 
çl£
;

332 
n¡ime_mÚÙÚic_Üig
 = 
n¡ime_mÚÙÚic
;

333 
n¡ime_upd©e_Üig
 = 
n¡ime_upd©e
;

334 
n¡ime_mÚÙÚic
 = 
n¡ime_mÚÙÚic_mock
;

335 
n¡ime_upd©e
 = 
n¡ime_upd©e_mock
;

337 
i
 = 0; i < 
NPS
; i++) {

338 
ps
[
i
] = 
	`m®locx
(
Ïrge0
, 
æags
);

339 
	`as£¹_±r_nÙ_nuÎ
(
ps
[
i
], "Unexpected mallocx() failure");

342 
i
 = 0; i < 
NPS
; i++) {

343 
	`d®locx
(
ps
[
i
], 
æags
);

344 
nupd©es0
 = 
nupd©es_mock
;

345 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.deÿy", 
NULL
, NULL, NULL, 0), 0,

347 
	`as£¹_u_gt
(
nupd©es_mock
, 
nupd©es0
,

351 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
,

352 (
ušt64_t
)), 0, "Unexpected mallctl failure");

353 
sz
 = (
ušt64_t
);

354 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Åurge", (*)&
Åurge1
, &
sz
,

355 
NULL
, 0), 
cÚfig_¡©s
 ? 0 : 
ENOENT
, "Unexpected mallctl„esult");

357 ià(
cÚfig_¡©s
)

358 
	`as£¹_u64_eq
(
Åurge0
, 
Åurge1
, "Unexpected…urging occurred");

360 
n¡ime_mÚÙÚic
 = 
n¡ime_mÚÙÚic_Üig
;

361 
n¡ime_upd©e
 = 
n¡ime_upd©e_Üig
;

362 #undeà
NPS


363 
	}
}

364 
TEST_END


367 
	$maš
()

370  (
	`‹¡
(

371 
‹¡_deÿy_ticks
,

372 
‹¡_deÿy_tick”
,

373 
‹¡_deÿy_nÚmÚÙÚic
));

374 
	}
}

	@deps/jemalloc/test/unit/fork.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #iâdeà
_WIN32


4 
	~<sys/wa™.h
>

7 
	$TEST_BEGIN
(
‹¡_fÜk
)

9 #iâdeà
_WIN32


10 *
p
;

11 
pid_t
 
pid
;

13 
p
 = 
	`m®loc
(1);

14 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected malloc() failure");

16 
pid
 = 
	`fÜk
();

18 
	`ä“
(
p
);

20 
p
 = 
	`m®loc
(64);

21 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected malloc() failure");

22 
	`ä“
(
p
);

24 ià(
pid
 == -1) {

26 
	`‹¡_ç
("Unexpected fork() failure");

27 } ià(
pid
 == 0) {

29 
	`_ex™
(0);

31 
¡©us
;

34 
Œue
) {

35 ià(
	`wa™pid
(
pid
, &
¡©us
, 0) == -1)

36 
	`‹¡_ç
("Unexpected waitpid() failure");

37 ià(
	`WIFSIGNALED
(
¡©us
)) {

38 
	`‹¡_ç
("Unexpected childermination dueo "

39 "sigÇÈ%d", 
	`WTERMSIG
(
¡©us
));

42 ià(
	`WIFEXITED
(
¡©us
)) {

43 ià(
	`WEXITSTATUS
(
¡©us
) != 0) {

44 
	`‹¡_ç
(

46 
	`WEXITSTATUS
(
¡©us
));

53 
	`‹¡_sk
("fork(2) is irrelevanto Windows");

55 
	}
}

56 
TEST_END


59 
	$maš
()

62  (
	`‹¡
(

63 
‹¡_fÜk
));

64 
	}
}

	@deps/jemalloc/test/unit/hash.c

30 
	~"‹¡/jem®loc_‹¡.h
"

33 
	mhash_v¬ŸÁ_x86_32
,

34 
	mhash_v¬ŸÁ_x86_128
,

35 
	mhash_v¬ŸÁ_x64_128


36 } 
	thash_v¬ŸÁ_t
;

39 
	$hash_v¬ŸÁ_b™s
(
hash_v¬ŸÁ_t
 
v¬ŸÁ
)

42 
v¬ŸÁ
) {

43 
hash_v¬ŸÁ_x86_32
:  (32);

44 
hash_v¬ŸÁ_x86_128
:  (128);

45 
hash_v¬ŸÁ_x64_128
:  (128);

46 : 
	`nÙ_»ached
();

48 
	}
}

51 
	$hash_v¬ŸÁ_¡ršg
(
hash_v¬ŸÁ_t
 
v¬ŸÁ
)

54 
v¬ŸÁ
) {

55 
hash_v¬ŸÁ_x86_32
:  ("hash_x86_32");

56 
hash_v¬ŸÁ_x86_128
:  ("hash_x86_128");

57 
hash_v¬ŸÁ_x64_128
:  ("hash_x64_128");

58 : 
	`nÙ_»ached
();

60 
	}
}

62 
	#KEY_SIZE
 256

	)

64 
	$hash_v¬ŸÁ_v”ify_key
(
hash_v¬ŸÁ_t
 
v¬ŸÁ
, 
ušt8_t
 *
key
)

66 cÚ¡ 
hashby‹s
 = 
	`hash_v¬ŸÁ_b™s
(
v¬ŸÁ
) / 8;

67 cÚ¡ 
hashes_size
 = 
hashby‹s
 * 256;

68 
	`VARIABLE_ARRAY
(
ušt8_t
, 
hashes
, 
hashes_size
);

69 
	`VARIABLE_ARRAY
(
ušt8_t
, 
fš®
, 
hashby‹s
);

70 
i
;

71 
ušt32_t
 
compu‹d
, 
ex³ùed
;

73 
	`mem£t
(
key
, 0, 
KEY_SIZE
);

74 
	`mem£t
(
hashes
, 0, 
hashes_size
);

75 
	`mem£t
(
fš®
, 0, 
hashby‹s
);

81 
i
 = 0; i < 256; i++) {

82 
key
[
i
] = (
ušt8_t
)i;

83 
v¬ŸÁ
) {

84 
hash_v¬ŸÁ_x86_32
: {

85 
ušt32_t
 
out
;

86 
out
 = 
	`hash_x86_32
(
key
, 
i
, 256-i);

87 
	`memıy
(&
hashes
[
i
*
hashby‹s
], &
out
, hashbytes);

89 } 
hash_v¬ŸÁ_x86_128
: {

90 
ušt64_t
 
out
[2];

91 
	`hash_x86_128
(
key
, 
i
, 256-i, 
out
);

92 
	`memıy
(&
hashes
[
i
*
hashby‹s
], 
out
, hashbytes);

94 } 
hash_v¬ŸÁ_x64_128
: {

95 
ušt64_t
 
out
[2];

96 
	`hash_x64_128
(
key
, 
i
, 256-i, 
out
);

97 
	`memıy
(&
hashes
[
i
*
hashby‹s
], 
out
, hashbytes);

99 } : 
	`nÙ_»ached
();

104 
v¬ŸÁ
) {

105 
hash_v¬ŸÁ_x86_32
: {

106 
ušt32_t
 
out
 = 
	`hash_x86_32
(
hashes
, 
hashes_size
, 0);

107 
	`memıy
(
fš®
, &
out
, (out));

109 } 
hash_v¬ŸÁ_x86_128
: {

110 
ušt64_t
 
out
[2];

111 
	`hash_x86_128
(
hashes
, 
hashes_size
, 0, 
out
);

112 
	`memıy
(
fš®
, 
out
, (out));

114 } 
hash_v¬ŸÁ_x64_128
: {

115 
ušt64_t
 
out
[2];

116 
	`hash_x64_128
(
hashes
, 
hashes_size
, 0, 
out
);

117 
	`memıy
(
fš®
, 
out
, (out));

119 } : 
	`nÙ_»ached
();

122 
compu‹d
 = (
fš®
[0] << 0) | (final[1] << 8) | (final[2] << 16) |

123 (
fš®
[3] << 24);

125 
v¬ŸÁ
) {

126 #ifdeà
JEMALLOC_BIG_ENDIAN


127 
hash_v¬ŸÁ_x86_32
: 
ex³ùed
 = 0x6213303eU; ;

128 
hash_v¬ŸÁ_x86_128
: 
ex³ùed
 = 0x266820caU; ;

129 
hash_v¬ŸÁ_x64_128
: 
ex³ùed
 = 0xcc622b6fU; ;

131 
hash_v¬ŸÁ_x86_32
: 
ex³ùed
 = 0xb0f57ee3U; ;

132 
hash_v¬ŸÁ_x86_128
: 
ex³ùed
 = 0xb3ece62aU; ;

133 
hash_v¬ŸÁ_x64_128
: 
ex³ùed
 = 0x6384ba69U; ;

135 : 
	`nÙ_»ached
();

138 
	`as£¹_u32_eq
(
compu‹d
, 
ex³ùed
,

140 
	`hash_v¬ŸÁ_¡ršg
(
v¬ŸÁ
), 
ex³ùed
, 
compu‹d
);

141 
	}
}

144 
	$hash_v¬ŸÁ_v”ify
(
hash_v¬ŸÁ_t
 
v¬ŸÁ
)

146 
	#MAX_ALIGN
 16

	)

147 
ušt8_t
 
key
[
KEY_SIZE
 + (
MAX_ALIGN
 - 1)];

148 
i
;

150 
i
 = 0; i < 
MAX_ALIGN
; i++)

151 
	`hash_v¬ŸÁ_v”ify_key
(
v¬ŸÁ
, &
key
[
i
]);

152 #undeà
MAX_ALIGN


153 
	}
}

154 #undeà
KEY_SIZE


156 
	$TEST_BEGIN
(
‹¡_hash_x86_32
)

159 
	`hash_v¬ŸÁ_v”ify
(
hash_v¬ŸÁ_x86_32
);

160 
	}
}

161 
TEST_END


163 
	$TEST_BEGIN
(
‹¡_hash_x86_128
)

166 
	`hash_v¬ŸÁ_v”ify
(
hash_v¬ŸÁ_x86_128
);

167 
	}
}

168 
TEST_END


170 
	$TEST_BEGIN
(
‹¡_hash_x64_128
)

173 
	`hash_v¬ŸÁ_v”ify
(
hash_v¬ŸÁ_x64_128
);

174 
	}
}

175 
TEST_END


178 
	$maš
()

181  (
	`‹¡
(

182 
‹¡_hash_x86_32
,

183 
‹¡_hash_x86_128
,

184 
‹¡_hash_x64_128
));

185 
	}
}

	@deps/jemalloc/test/unit/junk.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_FILL


4 #iâdeà
JEMALLOC_TEST_JUNK_OPT


5 
	#JEMALLOC_TEST_JUNK_OPT
 "junk:Œue"

	)

7 cÚ¡ *
	gm®loc_cÚf
 =

8 "abÜt:çl£,z”o:çl£,»dzÚe:Œue,qu¬ªtše:0," 
JEMALLOC_TEST_JUNK_OPT
;

11 
¬’a_d®loc_junk_sm®l_t
 *
	g¬’a_d®loc_junk_sm®l_Üig
;

12 
¬’a_d®loc_junk_Ïrge_t
 *
	g¬’a_d®loc_junk_Ïrge_Üig
;

13 
huge_d®loc_junk_t
 *
	ghuge_d®loc_junk_Üig
;

14 *
	gw©ch_fÜ_junkšg
;

15 
boŞ
 
	g§w_junkšg
;

18 
	$w©ch_junkšg
(*
p
)

21 
w©ch_fÜ_junkšg
 = 
p
;

22 
§w_junkšg
 = 
çl£
;

23 
	}
}

26 
	$¬’a_d®loc_junk_sm®l_š‹rû±
(*
±r
, 
¬’a_bš_šfo_t
 *
bš_šfo
)

28 
size_t
 
i
;

30 
	`¬’a_d®loc_junk_sm®l_Üig
(
±r
, 
bš_šfo
);

31 
i
 = 0; i < 
bš_šfo
->
»g_size
; i++) {

32 
	`as£¹_u_eq
(((
ušt8_t
 *)
±r
)[
i
], 
JEMALLOC_FREE_JUNK
,

34 
i
, 
bš_šfo
->
»g_size
);

36 ià(
±r
 =ğ
w©ch_fÜ_junkšg
)

37 
§w_junkšg
 = 
Œue
;

38 
	}
}

41 
	$¬’a_d®loc_junk_Ïrge_š‹rû±
(*
±r
, 
size_t
 
usize
)

43 
size_t
 
i
;

45 
	`¬’a_d®loc_junk_Ïrge_Üig
(
±r
, 
usize
);

46 
i
 = 0; i < 
usize
; i++) {

47 
	`as£¹_u_eq
(((
ušt8_t
 *)
±r
)[
i
], 
JEMALLOC_FREE_JUNK
,

49 
i
, 
usize
);

51 ià(
±r
 =ğ
w©ch_fÜ_junkšg
)

52 
§w_junkšg
 = 
Œue
;

53 
	}
}

56 
	$huge_d®loc_junk_š‹rû±
(*
±r
, 
size_t
 
usize
)

59 
	`huge_d®loc_junk_Üig
(
±r
, 
usize
);

65 ià(
±r
 =ğ
w©ch_fÜ_junkšg
)

66 
§w_junkšg
 = 
Œue
;

67 
	}
}

70 
	$‹¡_junk
(
size_t
 
sz_mš
, size_ˆ
sz_max
)

72 
ušt8_t
 *
s
;

73 
size_t
 
sz_´ev
, 
sz
, 
i
;

75 ià(
İt_junk_ä“
) {

76 
¬’a_d®loc_junk_sm®l_Üig
 = 
¬’a_d®loc_junk_sm®l
;

77 
¬’a_d®loc_junk_sm®l
 = 
¬’a_d®loc_junk_sm®l_š‹rû±
;

78 
¬’a_d®loc_junk_Ïrge_Üig
 = 
¬’a_d®loc_junk_Ïrge
;

79 
¬’a_d®loc_junk_Ïrge
 = 
¬’a_d®loc_junk_Ïrge_š‹rû±
;

80 
huge_d®loc_junk_Üig
 = 
huge_d®loc_junk
;

81 
huge_d®loc_junk
 = 
huge_d®loc_junk_š‹rû±
;

84 
sz_´ev
 = 0;

85 
s
 = (
ušt8_t
 *)
	`m®locx
(
sz_mš
, 0);

86 
	`as£¹_±r_nÙ_nuÎ
((*)
s
, "Unexpected mallocx() failure");

88 
sz
 = 
	`§Îocx
(
s
, 0); sz <ğ
sz_max
;

89 
sz_´ev
 = 
sz
, sz = 
	`§Îocx
(
s
, 0)) {

90 ià(
sz_´ev
 > 0) {

91 
	`as£¹_u_eq
(
s
[0], 'a',

93 
	`ZU
(0), 
sz_´ev
);

94 
	`as£¹_u_eq
(
s
[
sz_´ev
-1], 'a',

96 
sz_´ev
-1, sz_prev);

99 
i
 = 
sz_´ev
; i < 
sz
; i++) {

100 ià(
İt_junk_®loc
) {

101 
	`as£¹_u_eq
(
s
[
i
], 
JEMALLOC_ALLOC_JUNK
,

103 "junk-fËd", 
i
, 
sz
);

105 
s
[
i
] = 'a';

108 ià(
	`x®locx
(
s
, 
sz
+1, 0, 0) == sz) {

109 
	`w©ch_junkšg
(
s
);

110 
s
 = (
ušt8_t
 *)
	`¿Îocx
(s, 
sz
+1, 0);

111 
	`as£¹_±r_nÙ_nuÎ
((*)
s
,

113 
	`as£¹_Œue
(!
İt_junk_ä“
 || 
§w_junkšg
,

115 
sz
);

119 
	`w©ch_junkšg
(
s
);

120 
	`d®locx
(
s
, 0);

121 
	`as£¹_Œue
(!
İt_junk_ä“
 || 
§w_junkšg
,

122 "Ex³ùed„egiÚ oàsiz%zuØbjunk-fËd", 
sz
);

124 ià(
İt_junk_ä“
) {

125 
¬’a_d®loc_junk_sm®l
 = 
¬’a_d®loc_junk_sm®l_Üig
;

126 
¬’a_d®loc_junk_Ïrge
 = 
¬’a_d®loc_junk_Ïrge_Üig
;

127 
huge_d®loc_junk
 = 
huge_d®loc_junk_Üig
;

129 
	}
}

131 
	$TEST_BEGIN
(
‹¡_junk_sm®l
)

134 
	`‹¡_sk_if
(!
cÚfig_fl
);

135 
	`‹¡_junk
(1, 
SMALL_MAXCLASS
-1);

136 
	}
}

137 
TEST_END


139 
	$TEST_BEGIN
(
‹¡_junk_Ïrge
)

142 
	`‹¡_sk_if
(!
cÚfig_fl
);

143 
	`‹¡_junk
(
SMALL_MAXCLASS
+1, 
Ïrge_maxşass
);

144 
	}
}

145 
TEST_END


147 
	$TEST_BEGIN
(
‹¡_junk_huge
)

150 
	`‹¡_sk_if
(!
cÚfig_fl
);

151 
	`‹¡_junk
(
Ïrge_maxşass
+1, 
chunksize
*2);

152 
	}
}

153 
TEST_END


155 
¬’a_¿Îoc_junk_Ïrge_t
 *
	g¬’a_¿Îoc_junk_Ïrge_Üig
;

156 *
	gmo¡_»ûÁly_Œimmed
;

158 
size_t


159 
	$shršk_size
(
size_t
 
size
)

161 
size_t
 
shršk_size
;

163 
shršk_size
 = 
size
 - 1; 
	`ÇÎocx
(shrink_size, 0) == size;

164 
shršk_size
--)

167  (
shršk_size
);

168 
	}
}

171 
	$¬’a_¿Îoc_junk_Ïrge_š‹rû±
(*
±r
, 
size_t
 
Şd_usize
, size_ˆ
usize
)

174 
	`¬’a_¿Îoc_junk_Ïrge_Üig
(
±r
, 
Şd_usize
, 
usize
);

175 
	`as£¹_zu_eq
(
Şd_usize
, 
Ïrge_maxşass
, "Unexpected old_usize");

176 
	`as£¹_zu_eq
(
usize
, 
	`shršk_size
(
Ïrge_maxşass
), "Unexpected usize");

177 
mo¡_»ûÁly_Œimmed
 = 
±r
;

178 
	}
}

180 
	$TEST_BEGIN
(
‹¡_junk_Ïrge_¿Îoc_shršk
)

182 *
p1
, *
p2
;

184 
p1
 = 
	`m®locx
(
Ïrge_maxşass
, 0);

185 
	`as£¹_±r_nÙ_nuÎ
(
p1
, "Unexpected mallocx() failure");

187 
¬’a_¿Îoc_junk_Ïrge_Üig
 = 
¬’a_¿Îoc_junk_Ïrge
;

188 
¬’a_¿Îoc_junk_Ïrge
 = 
¬’a_¿Îoc_junk_Ïrge_š‹rû±
;

190 
p2
 = 
	`¿Îocx
(
p1
, 
	`shršk_size
(
Ïrge_maxşass
), 0);

191 
	`as£¹_±r_eq
(
p1
, 
p2
, "Unexpected move during shrink");

193 
¬’a_¿Îoc_junk_Ïrge
 = 
¬’a_¿Îoc_junk_Ïrge_Üig
;

195 
	`as£¹_±r_eq
(
mo¡_»ûÁly_Œimmed
, 
p1
,

197 
	}
}

198 
TEST_END


200 
boŞ
 
	gd‘eùed_»dzÚe_cÜru±iÚ
;

203 
	$¬’a_»dzÚe_cÜru±iÚ_»¶aûm’t
(*
±r
, 
size_t
 
usize
, 
boŞ
 
aá”
,

204 
size_t
 
off£t
, 
ušt8_t
 
by‹
)

207 
d‘eùed_»dzÚe_cÜru±iÚ
 = 
Œue
;

208 
	}
}

210 
	$TEST_BEGIN
(
‹¡_junk_»dzÚe
)

212 *
s
;

213 
¬’a_»dzÚe_cÜru±iÚ_t
 *
¬’a_»dzÚe_cÜru±iÚ_Üig
;

215 
	`‹¡_sk_if
(!
cÚfig_fl
);

216 
	`‹¡_sk_if
(!
İt_junk_®loc
 || !
İt_junk_ä“
);

218 
¬’a_»dzÚe_cÜru±iÚ_Üig
 = 
¬’a_»dzÚe_cÜru±iÚ
;

219 
¬’a_»dzÚe_cÜru±iÚ
 = 
¬’a_»dzÚe_cÜru±iÚ_»¶aûm’t
;

222 
d‘eùed_»dzÚe_cÜru±iÚ
 = 
çl£
;

223 
s
 = (*)
	`m®locx
(1, 0);

224 
	`as£¹_±r_nÙ_nuÎ
((*)
s
, "Unexpected mallocx() failure");

225 
s
[-1] = 0xbb;

226 
	`d®locx
(
s
, 0);

227 
	`as£¹_Œue
(
d‘eùed_»dzÚe_cÜru±iÚ
,

231 
d‘eùed_»dzÚe_cÜru±iÚ
 = 
çl£
;

232 
s
 = (*)
	`m®locx
(1, 0);

233 
	`as£¹_±r_nÙ_nuÎ
((*)
s
, "Unexpected mallocx() failure");

234 
s
[
	`§Îocx
(s, 0)] = 0xbb;

235 
	`d®locx
(
s
, 0);

236 
	`as£¹_Œue
(
d‘eùed_»dzÚe_cÜru±iÚ
,

239 
¬’a_»dzÚe_cÜru±iÚ
 = 
¬’a_»dzÚe_cÜru±iÚ_Üig
;

240 
	}
}

241 
TEST_END


244 
	$maš
()

247  (
	`‹¡
(

248 
‹¡_junk_sm®l
,

249 
‹¡_junk_Ïrge
,

250 
‹¡_junk_huge
,

251 
‹¡_junk_Ïrge_¿Îoc_shršk
,

252 
‹¡_junk_»dzÚe
));

253 
	}
}

	@deps/jemalloc/test/unit/junk_alloc.c

1 
	#JEMALLOC_TEST_JUNK_OPT
 "junk:®loc"

	)

2 
	~"junk.c
"

3 #undeà
JEMALLOC_TEST_JUNK_OPT


	@deps/jemalloc/test/unit/junk_free.c

1 
	#JEMALLOC_TEST_JUNK_OPT
 "junk:ä“"

	)

2 
	~"junk.c
"

3 #undeà
JEMALLOC_TEST_JUNK_OPT


	@deps/jemalloc/test/unit/lg_chunk.c

1 
	~"‹¡/jem®loc_‹¡.h
"

8 cÚ¡ *
	gm®loc_cÚf
 = "lg_chunk:0";

10 
	$TEST_BEGIN
(
‹¡_lg_chunk_şamp
)

12 *
p
;

14 
p
 = 
	`m®locx
(1, 0);

15 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

16 
	`d®locx
(
p
, 0);

17 
	}
}

18 
TEST_END


21 
	$maš
()

24  (
	`‹¡
(

25 
‹¡_lg_chunk_şamp
));

26 
	}
}

	@deps/jemalloc/test/unit/mallctl.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	$TEST_BEGIN
(
‹¡_m®lùl_”rÜs
)

5 
ušt64_t
 
•och
;

6 
size_t
 
sz
;

8 
	`as£¹_d_eq
(
	`m®lùl
("no_such_Çme", 
NULL
, NULL, NULL, 0), 
ENOENT
,

11 
	`as£¹_d_eq
(
	`m®lùl
("v”siÚ", 
NULL
, NULL, "0.0.0", 
	`¡¾’
("0.0.0")),

12 
EPERM
, "mallctl() should„eturn EPERM on‡ttempto write "

15 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
,

16 (
•och
)-1), 
EINVAL
,

18 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
,

19 (
•och
)+1), 
EINVAL
,

22 
sz
 = (
•och
)-1;

23 
	`as£¹_d_eq
(
	`m®lùl
("•och", (*)&
•och
, &
sz
, 
NULL
, 0), 
EINVAL
,

25 
sz
 = (
•och
)+1;

26 
	`as£¹_d_eq
(
	`m®lùl
("•och", (*)&
•och
, &
sz
, 
NULL
, 0), 
EINVAL
,

28 
	}
}

29 
TEST_END


31 
	$TEST_BEGIN
(
‹¡_m®lùÊam‘omib_”rÜs
)

33 
size_t
 
mib
[1];

34 
size_t
 
mibËn
;

36 
mibËn
 = (
mib
)/(
size_t
);

37 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("no_such_Çme", 
mib
, &
mibËn
), 
ENOENT
,

39 
	}
}

40 
TEST_END


42 
	$TEST_BEGIN
(
‹¡_m®lùlbymib_”rÜs
)

44 
ušt64_t
 
•och
;

45 
size_t
 
sz
;

46 
size_t
 
mib
[1];

47 
size_t
 
mibËn
;

49 
mibËn
 = (
mib
)/(
size_t
);

50 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("v”siÚ", 
mib
, &
mibËn
), 0,

53 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, 
NULL
, NULL, "0.0.0",

54 
	`¡¾’
("0.0.0")), 
EPERM
, "mallctl() should„eturn EPERM on "

57 
mibËn
 = (
mib
)/(
size_t
);

58 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("•och", 
mib
, &
mibËn
), 0,

61 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, 
NULL
, NULL, (*)&
•och
,

62 (
•och
)-1), 
EINVAL
,

64 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, 
NULL
, NULL, (*)&
•och
,

65 (
•och
)+1), 
EINVAL
,

68 
sz
 = (
•och
)-1;

69 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
•och
, &
sz
, 
NULL
, 0),

70 
EINVAL
,

72 
sz
 = (
•och
)+1;

73 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
•och
, &
sz
, 
NULL
, 0),

74 
EINVAL
,

76 
	}
}

77 
TEST_END


79 
	$TEST_BEGIN
(
‹¡_m®lùl_»ad_wr™e
)

81 
ušt64_t
 
Şd_•och
, 
Ãw_•och
;

82 
size_t
 
sz
 = (
Şd_•och
);

85 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, NULL, 0), 0,

87 
	`as£¹_zu_eq
(
sz
, (
Şd_•och
), "Unexpected output size");

90 
	`as£¹_d_eq
(
	`m®lùl
("•och", (*)&
Şd_•och
, &
sz
, 
NULL
, 0), 0,

92 
	`as£¹_zu_eq
(
sz
, (
Şd_•och
), "Unexpected output size");

95 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
Ãw_•och
,

96 (
Ãw_•och
)), 0, "Unexpected mallctl() failure");

97 
	`as£¹_zu_eq
(
sz
, (
Şd_•och
), "Unexpected output size");

100 
	`as£¹_d_eq
(
	`m®lùl
("•och", (*)&
Şd_•och
, &
sz
,

101 (*)&
Ãw_•och
, (new_epoch)), 0,

103 
	`as£¹_zu_eq
(
sz
, (
Şd_•och
), "Unexpected output size");

104 
	}
}

105 
TEST_END


107 
	$TEST_BEGIN
(
‹¡_m®lùÊam‘omib_shÜt_mib
)

109 
size_t
 
mib
[4];

110 
size_t
 
mibËn
;

112 
mibËn
 = 3;

113 
mib
[3] = 42;

114 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’as.bš.0.Äegs", 
mib
, &
mibËn
), 0,

116 
	`as£¹_zu_eq
(
mibËn
, 3, "Unexpected mib output†ength");

117 
	`as£¹_zu_eq
(
mib
[3], 42,

119 
	}
}

120 
TEST_END


122 
	$TEST_BEGIN
(
‹¡_m®lùl_cÚfig
)

125 
	#TEST_MALLCTL_CONFIG
(
cÚfig
, 
t
) do { \

126 
t
 
Şdv®
; \

127 
size_t
 
sz
 = (
Şdv®
); \

128 
	`as£¹_d_eq
(
	`m®lùl
("cÚfig."#cÚfig, (*)&
Şdv®
, &
sz
, \

129 
NULL
, 0), 0, "Unexpected mallctl() failure"); \

130 
	`as£¹_b_eq
(
Şdv®
, 
cÚfig_
##
cÚfig
, "Incorrect config value"); \

131 
	`as£¹_zu_eq
(
sz
, (
Şdv®
), "Unexpected output size"); \

132 } 0)

	)

134 
	`TEST_MALLCTL_CONFIG
(
ÿche_oblivious
, 
boŞ
);

135 
	`TEST_MALLCTL_CONFIG
(
debug
, 
boŞ
);

136 
	`TEST_MALLCTL_CONFIG
(
fl
, 
boŞ
);

137 
	`TEST_MALLCTL_CONFIG
(
Ïzy_lock
, 
boŞ
);

138 
	`TEST_MALLCTL_CONFIG
(
m®loc_cÚf
, const *);

139 
	`TEST_MALLCTL_CONFIG
(
munm­
, 
boŞ
);

140 
	`TEST_MALLCTL_CONFIG
(
´of
, 
boŞ
);

141 
	`TEST_MALLCTL_CONFIG
(
´of_libgcc
, 
boŞ
);

142 
	`TEST_MALLCTL_CONFIG
(
´of_libunwšd
, 
boŞ
);

143 
	`TEST_MALLCTL_CONFIG
(
¡©s
, 
boŞ
);

144 
	`TEST_MALLCTL_CONFIG
(
tÿche
, 
boŞ
);

145 
	`TEST_MALLCTL_CONFIG
(
s
, 
boŞ
);

146 
	`TEST_MALLCTL_CONFIG
(
uŒaû
, 
boŞ
);

147 
	`TEST_MALLCTL_CONFIG
(
v®gršd
, 
boŞ
);

148 
	`TEST_MALLCTL_CONFIG
(
xm®loc
, 
boŞ
);

150 #undeà
TEST_MALLCTL_CONFIG


151 
	}
}

152 
TEST_END


154 
	$TEST_BEGIN
(
‹¡_m®lùl_İt
)

156 
boŞ
 
cÚfig_®ways
 = 
Œue
;

158 
	#TEST_MALLCTL_OPT
(
t
, 
İt
, 
cÚfig
) do { \

159 
t
 
Şdv®
; \

160 
size_t
 
sz
 = (
Şdv®
); \

161 
ex³ùed
 = 
cÚfig_
##
cÚfig
 ? 0 : 
ENOENT
; \

162 
»suÉ
 = 
	`m®lùl
("İt."#İt, (*)&
Şdv®
, &
sz
, 
NULL
, \

164 
	`as£¹_d_eq
(
»suÉ
, 
ex³ùed
, \

166 
	`as£¹_zu_eq
(
sz
, (
Şdv®
), "Unexpected output size"); \

167 } 0)

	)

169 
	`TEST_MALLCTL_OPT
(
boŞ
, 
abÜt
, 
®ways
);

170 
	`TEST_MALLCTL_OPT
(
size_t
, 
lg_chunk
, 
®ways
);

171 
	`TEST_MALLCTL_OPT
(cÚ¡ *, 
dss
, 
®ways
);

172 
	`TEST_MALLCTL_OPT
(, 
Ç»Çs
, 
®ways
);

173 
	`TEST_MALLCTL_OPT
(cÚ¡ *, 
purge
, 
®ways
);

174 
	`TEST_MALLCTL_OPT
(
ssize_t
, 
lg_dœty_muÉ
, 
®ways
);

175 
	`TEST_MALLCTL_OPT
(
ssize_t
, 
deÿy_time
, 
®ways
);

176 
	`TEST_MALLCTL_OPT
(
boŞ
, 
¡©s_´št
, 
®ways
);

177 
	`TEST_MALLCTL_OPT
(cÚ¡ *, 
junk
, 
fl
);

178 
	`TEST_MALLCTL_OPT
(
size_t
, 
qu¬ªtše
, 
fl
);

179 
	`TEST_MALLCTL_OPT
(
boŞ
, 
»dzÚe
, 
fl
);

180 
	`TEST_MALLCTL_OPT
(
boŞ
, 
z”o
, 
fl
);

181 
	`TEST_MALLCTL_OPT
(
boŞ
, 
uŒaû
, utrace);

182 
	`TEST_MALLCTL_OPT
(
boŞ
, 
xm®loc
, xmalloc);

183 
	`TEST_MALLCTL_OPT
(
boŞ
, 
tÿche
,cache);

184 
	`TEST_MALLCTL_OPT
(
size_t
, 
lg_tÿche_max
, 
tÿche
);

185 
	`TEST_MALLCTL_OPT
(
boŞ
, 
´of
,…rof);

186 
	`TEST_MALLCTL_OPT
(cÚ¡ *, 
´of_´efix
, 
´of
);

187 
	`TEST_MALLCTL_OPT
(
boŞ
, 
´of_aùive
, 
´of
);

188 
	`TEST_MALLCTL_OPT
(
ssize_t
, 
lg_´of_§m¶e
, 
´of
);

189 
	`TEST_MALLCTL_OPT
(
boŞ
, 
´of_accum
, 
´of
);

190 
	`TEST_MALLCTL_OPT
(
ssize_t
, 
lg_´of_š‹rv®
, 
´of
);

191 
	`TEST_MALLCTL_OPT
(
boŞ
, 
´of_gdump
, 
´of
);

192 
	`TEST_MALLCTL_OPT
(
boŞ
, 
´of_fš®
, 
´of
);

193 
	`TEST_MALLCTL_OPT
(
boŞ
, 
´of_Ëak
, 
´of
);

195 #undeà
TEST_MALLCTL_OPT


196 
	}
}

197 
TEST_END


199 
	$TEST_BEGIN
(
‹¡_mª·ge_exam¶e
)

201 
nbšs
, 
i
;

202 
size_t
 
mib
[4];

203 
size_t
 
Ën
, 
mibËn
;

205 
Ën
 = (
nbšs
);

206 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.nbšs", (*)&
nbšs
, &
Ën
, 
NULL
, 0), 0,

209 
mibËn
 = 4;

210 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’as.bš.0.size", 
mib
, &
mibËn
), 0,

212 
i
 = 0; i < 
nbšs
; i++) {

213 
size_t
 
bš_size
;

215 
mib
[2] = 
i
;

216 
Ën
 = (
bš_size
);

217 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
bš_size
, &
Ën
,

218 
NULL
, 0), 0, "Unexpected mallctlbymib() failure");

221 
	}
}

222 
TEST_END


224 
	$TEST_BEGIN
(
‹¡_tÿche_nÚe
)

226 *
p0
, *
q
, *
p1
;

228 
	`‹¡_sk_if
(!
cÚfig_tÿche
);

231 
p0
 = 
	`m®locx
(42, 0);

232 
	`as£¹_±r_nÙ_nuÎ
(
p0
, "Unexpected mallocx() failure");

233 
q
 = 
	`m®locx
(42, 0);

234 
	`as£¹_±r_nÙ_nuÎ
(
q
, "Unexpected mallocx() failure");

237 
	`d®locx
(
p0
, 0);

238 
	`d®locx
(
q
, 
MALLOCX_TCACHE_NONE
);

241 
p1
 = 
	`m®locx
(42, 0);

242 
	`as£¹_±r_nÙ_nuÎ
(
p1
, "Unexpected mallocx() failure");

243 
	`as£¹_±r_eq
(
p0
, 
p1
, "Expectedcacheo‡llocate cached„egion");

246 
	`d®locx
(
p1
, 
MALLOCX_TCACHE_NONE
);

247 
	}
}

248 
TEST_END


250 
	$TEST_BEGIN
(
‹¡_tÿche
)

252 
	#NTCACHES
 10

	)

253 
tis
[
NTCACHES
];

254 *
ps
[
NTCACHES
];

255 *
qs
[
NTCACHES
];

256 
i
;

257 
size_t
 
sz
, 
psz
, 
qsz
;

259 
	`‹¡_sk_if
(!
cÚfig_tÿche
);

261 
psz
 = 42;

262 
qsz
 = 
	`ÇÎocx
(
psz
, 0) + 1;

265 
i
 = 0; i < 
NTCACHES
; i++) {

266 
sz
 = ();

267 
	`as£¹_d_eq
(
	`m®lùl
("tÿche.ü—‹", (*)&
tis
[
i
], &
sz
, 
NULL
,

268 0), 0, "UÃx³ùed m®lùl(èçu», i=%u", 
i
);

272 
i
 = 0; i < 
NTCACHES
; i++) {

273 
	`as£¹_d_eq
(
	`m®lùl
("tÿche.de¡roy", 
NULL
, NULL,

274 (*)&
tis
[
i
], ()), 0,

275 "UÃx³ùed m®lùl(èçu», i=%u", 
i
);

277 
i
 = 0; i < 
NTCACHES
; i++) {

278 
sz
 = ();

279 
	`as£¹_d_eq
(
	`m®lùl
("tÿche.ü—‹", (*)&
tis
[
i
], &
sz
, 
NULL
,

280 0), 0, "UÃx³ùed m®lùl(èçu», i=%u", 
i
);

284 
i
 = 0; i < 
NTCACHES
; i++) {

285 
	`as£¹_d_eq
(
	`m®lùl
("tÿche.æush", 
NULL
, NULL, (*)&
tis
[
i
],

287 
i
);

291 
i
 = 0; i < 
NTCACHES
; i++) {

292 
ps
[
i
] = 
	`m®locx
(
psz
, 
	`MALLOCX_TCACHE
(
tis
[i]));

293 
	`as£¹_±r_nÙ_nuÎ
(
ps
[
i
], "Unexpected mallocx() failure, i=%u",

294 
i
);

295 
	`d®locx
(
ps
[
i
], 
	`MALLOCX_TCACHE
(
tis
[i]));

297 
qs
[
i
] = 
	`m®locx
(
qsz
, 
	`MALLOCX_TCACHE
(
tis
[i]));

298 
	`as£¹_±r_nÙ_nuÎ
(
qs
[
i
], "Unexpected mallocx() failure, i=%u",

299 
i
);

300 
	`d®locx
(
qs
[
i
], 
	`MALLOCX_TCACHE
(
tis
[i]));

304 
i
 = 0; i < 
NTCACHES
; i++) {

305 *
p0
 = 
ps
[
i
];

306 
ps
[
i
] = 
	`m®locx
(
psz
, 
	`MALLOCX_TCACHE
(
tis
[i]));

307 
	`as£¹_±r_nÙ_nuÎ
(
ps
[
i
], "Unexpected mallocx() failure, i=%u",

308 
i
);

309 
	`as£¹_±r_eq
(
ps
[
i
], 
p0
,

310 "Ex³ùed m®locx(ètØ®loÿ‹ cached„egiÚ, i=%u", 
i
);

314 
i
 = 0; i < 
NTCACHES
; i++) {

315 *
q0
 = 
qs
[
i
];

316 
qs
[
i
] = 
	`¿Îocx
(
ps
[i], 
qsz
, 
	`MALLOCX_TCACHE
(
tis
[i]));

317 
	`as£¹_±r_nÙ_nuÎ
(
qs
[
i
], "Unexpected„allocx() failure, i=%u",

318 
i
);

319 
	`as£¹_±r_eq
(
qs
[
i
], 
q0
,

320 "Ex³ùed„®locx(ètØ®loÿ‹ cached„egiÚ, i=%u", 
i
);

322 ià(
qs
[
i
] =ğ
NULL
)

323 
qs
[
i
] = 
ps
[i];

325 
i
 = 0; i < 
NTCACHES
; i++)

326 
	`d®locx
(
qs
[
i
], 
	`MALLOCX_TCACHE
(
tis
[i]));

329 
i
 = 0; i < 
NTCACHES
/2; i++) {

330 
	`as£¹_d_eq
(
	`m®lùl
("tÿche.æush", 
NULL
, NULL, (*)&
tis
[
i
],

332 
i
);

336 
i
 = 0; i < 
NTCACHES
; i++) {

337 
	`as£¹_d_eq
(
	`m®lùl
("tÿche.de¡roy", 
NULL
, NULL,

338 (*)&
tis
[
i
], ()), 0,

339 "UÃx³ùed m®lùl(èçu», i=%u", 
i
);

341 
	}
}

342 
TEST_END


344 
	$TEST_BEGIN
(
‹¡_th»ad_¬’a
)

346 
¬’a_Şd
, 
¬’a_Ãw
, 
Ç»Çs
;

347 
size_t
 
sz
 = ();

349 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ç»Çs", (*)&
Ç»Çs
, &
sz
, 
NULL
, 0),

351 
	`as£¹_u_eq
(
Ç»Çs
, 
İt_Ç»Çs
, "Number of‡renas incorrect");

352 
¬’a_Ãw
 = 
Ç»Çs
 - 1;

353 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.¬’a", (*)&
¬’a_Şd
, &
sz
,

354 (*)&
¬’a_Ãw
, ()), 0,

356 
¬’a_Ãw
 = 0;

357 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.¬’a", (*)&
¬’a_Şd
, &
sz
,

358 (*)&
¬’a_Ãw
, ()), 0,

360 
	}
}

361 
TEST_END


363 
	$TEST_BEGIN
(
‹¡_¬’a_i_lg_dœty_muÉ
)

365 
ssize_t
 
lg_dœty_muÉ
, 
Üig_lg_dœty_muÉ
, 
´ev_lg_dœty_muÉ
;

366 
size_t
 
sz
 = (
ssize_t
);

368 
	`‹¡_sk_if
(
İt_purge
 !ğ
purge_mode_¿tio
);

370 
	`as£¹_d_eq
(
	`m®lùl
("arena.0.lg_dirty_mult",

371 (*)&
Üig_lg_dœty_muÉ
, &
sz
, 
NULL
, 0), 0,

374 
lg_dœty_muÉ
 = -2;

375 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.lg_dœty_muÉ", 
NULL
, NULL,

376 (*)&
lg_dœty_muÉ
, (
ssize_t
)), 
EFAULT
,

379 
lg_dœty_muÉ
 = ((
size_t
) << 3);

380 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.lg_dœty_muÉ", 
NULL
, NULL,

381 (*)&
lg_dœty_muÉ
, (
ssize_t
)), 
EFAULT
,

384 
´ev_lg_dœty_muÉ
 = 
Üig_lg_dœty_muÉ
, 
lg_dœty_muÉ
 = -1;

385 
lg_dœty_muÉ
 < (
ssize_t
)((
size_t
è<< 3); 
´ev_lg_dœty_muÉ


386 ğ
lg_dœty_muÉ
,†g_dirty_mult++) {

387 
ssize_t
 
Şd_lg_dœty_muÉ
;

389 
	`as£¹_d_eq
(
	`m®lùl
("arena.0.lg_dirty_mult",

390 (*)&
Şd_lg_dœty_muÉ
, &
sz
, (*)&
lg_dœty_muÉ
,

391 (
ssize_t
)), 0, "Unexpected mallctl() failure");

392 
	`as£¹_zd_eq
(
Şd_lg_dœty_muÉ
, 
´ev_lg_dœty_muÉ
,

395 
	}
}

396 
TEST_END


398 
	$TEST_BEGIN
(
‹¡_¬’a_i_deÿy_time
)

400 
ssize_t
 
deÿy_time
, 
Üig_deÿy_time
, 
´ev_deÿy_time
;

401 
size_t
 
sz
 = (
ssize_t
);

403 
	`‹¡_sk_if
(
İt_purge
 !ğ
purge_mode_deÿy
);

405 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.deÿy_time", (*)&
Üig_deÿy_time
, &
sz
,

406 
NULL
, 0), 0, "Unexpected mallctl() failure");

408 
deÿy_time
 = -2;

409 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.deÿy_time", 
NULL
, NULL,

410 (*)&
deÿy_time
, (
ssize_t
)), 
EFAULT
,

413 
deÿy_time
 = 0x7fffffff;

414 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.deÿy_time", 
NULL
, NULL,

415 (*)&
deÿy_time
, (
ssize_t
)), 0,

418 
´ev_deÿy_time
 = 
deÿy_time
, decay_time = -1;

419 
deÿy_time
 < 20; 
´ev_deÿy_time
 = decay_time, decay_time++) {

420 
ssize_t
 
Şd_deÿy_time
;

422 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.deÿy_time", (*)&
Şd_deÿy_time
,

423 &
sz
, (*)&
deÿy_time
, (
ssize_t
)), 0,

425 
	`as£¹_zd_eq
(
Şd_deÿy_time
, 
´ev_deÿy_time
,

428 
	}
}

429 
TEST_END


431 
	$TEST_BEGIN
(
‹¡_¬’a_i_purge
)

433 
Ç»Çs
;

434 
size_t
 
sz
 = ();

435 
size_t
 
mib
[3];

436 
size_t
 
mibËn
 = 3;

438 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.purge", 
NULL
, NULL, NULL, 0), 0,

441 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ç»Çs", (*)&
Ç»Çs
, &
sz
, 
NULL
, 0),

443 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’a.0.purge", 
mib
, &
mibËn
), 0,

445 
mib
[1] = 
Ç»Çs
;

446 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, 
NULL
, NULL, NULL, 0), 0,

448 
	}
}

449 
TEST_END


451 
	$TEST_BEGIN
(
‹¡_¬’a_i_deÿy
)

453 
Ç»Çs
;

454 
size_t
 
sz
 = ();

455 
size_t
 
mib
[3];

456 
size_t
 
mibËn
 = 3;

458 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.deÿy", 
NULL
, NULL, NULL, 0), 0,

461 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ç»Çs", (*)&
Ç»Çs
, &
sz
, 
NULL
, 0),

463 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’a.0.deÿy", 
mib
, &
mibËn
), 0,

465 
mib
[1] = 
Ç»Çs
;

466 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, 
NULL
, NULL, NULL, 0), 0,

468 
	}
}

469 
TEST_END


471 
	$TEST_BEGIN
(
‹¡_¬’a_i_dss
)

473 cÚ¡ *
dss_´ec_Şd
, *
dss_´ec_Ãw
;

474 
size_t
 
sz
 = (
dss_´ec_Şd
);

475 
size_t
 
mib
[3];

476 
size_t
 
mibËn
;

478 
mibËn
 = (
mib
)/(
size_t
);

479 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’a.0.dss", 
mib
, &
mibËn
), 0,

482 
dss_´ec_Ãw
 = "disabled";

483 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
dss_´ec_Şd
, &
sz
,

484 (*)&
dss_´ec_Ãw
, (dss_prec_new)), 0,

486 
	`as£¹_¡r_Ã
(
dss_´ec_Şd
, "primary",

489 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
dss_´ec_Ãw
, &
sz
,

490 (*)&
dss_´ec_Şd
, (dss_prec_old)), 0,

493 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
dss_´ec_Şd
, &
sz
, 
NULL
,

495 
	`as£¹_¡r_Ã
(
dss_´ec_Şd
, "primary",

498 
mib
[1] = 
	`Ç»Çs_tÙ®_g‘
();

499 
dss_´ec_Ãw
 = "disabled";

500 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
dss_´ec_Şd
, &
sz
,

501 (*)&
dss_´ec_Ãw
, (dss_prec_new)), 0,

503 
	`as£¹_¡r_Ã
(
dss_´ec_Şd
, "primary",

506 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
dss_´ec_Ãw
, &
sz
,

507 (*)&
dss_´ec_Şd
, (
dss_´ec_Ãw
)), 0,

510 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
dss_´ec_Şd
, &
sz
, 
NULL
,

512 
	`as£¹_¡r_Ã
(
dss_´ec_Şd
, "primary",

514 
	}
}

515 
TEST_END


517 
	$TEST_BEGIN
(
‹¡_¬’as_š™Ÿlized
)

519 
Ç»Çs
;

520 
size_t
 
sz
 = (
Ç»Çs
);

522 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ç»Çs", (*)&
Ç»Çs
, &
sz
, 
NULL
, 0),

525 
	`VARIABLE_ARRAY
(
boŞ
, 
š™Ÿlized
, 
Ç»Çs
);

527 
sz
 = 
Ç»Çs
 * (
boŞ
);

528 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.š™Ÿlized", (*)
š™Ÿlized
,

529 &
sz
, 
NULL
, 0), 0, "Unexpected mallctl() failure");

531 
	}
}

532 
TEST_END


534 
	$TEST_BEGIN
(
‹¡_¬’as_lg_dœty_muÉ
)

536 
ssize_t
 
lg_dœty_muÉ
, 
Üig_lg_dœty_muÉ
, 
´ev_lg_dœty_muÉ
;

537 
size_t
 
sz
 = (
ssize_t
);

539 
	`‹¡_sk_if
(
İt_purge
 !ğ
purge_mode_¿tio
);

541 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.lg_dœty_muÉ", (*)&
Üig_lg_dœty_muÉ
,

542 &
sz
, 
NULL
, 0), 0, "Unexpected mallctl() failure");

544 
lg_dœty_muÉ
 = -2;

545 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.lg_dœty_muÉ", 
NULL
, NULL,

546 (*)&
lg_dœty_muÉ
, (
ssize_t
)), 
EFAULT
,

549 
lg_dœty_muÉ
 = ((
size_t
) << 3);

550 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.lg_dœty_muÉ", 
NULL
, NULL,

551 (*)&
lg_dœty_muÉ
, (
ssize_t
)), 
EFAULT
,

554 
´ev_lg_dœty_muÉ
 = 
Üig_lg_dœty_muÉ
, 
lg_dœty_muÉ
 = -1;

555 
lg_dœty_muÉ
 < (
ssize_t
)((
size_t
è<< 3); 
´ev_lg_dœty_muÉ
 =

556 
lg_dœty_muÉ
,†g_dirty_mult++) {

557 
ssize_t
 
Şd_lg_dœty_muÉ
;

559 
	`as£¹_d_eq
(
	`m®lùl
("arenas.lg_dirty_mult",

560 (*)&
Şd_lg_dœty_muÉ
, &
sz
, (*)&
lg_dœty_muÉ
,

561 (
ssize_t
)), 0, "Unexpected mallctl() failure");

562 
	`as£¹_zd_eq
(
Şd_lg_dœty_muÉ
, 
´ev_lg_dœty_muÉ
,

565 
	}
}

566 
TEST_END


568 
	$TEST_BEGIN
(
‹¡_¬’as_deÿy_time
)

570 
ssize_t
 
deÿy_time
, 
Üig_deÿy_time
, 
´ev_deÿy_time
;

571 
size_t
 
sz
 = (
ssize_t
);

573 
	`‹¡_sk_if
(
İt_purge
 !ğ
purge_mode_deÿy
);

575 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.deÿy_time", (*)&
Üig_deÿy_time
, &
sz
,

576 
NULL
, 0), 0, "Unexpected mallctl() failure");

578 
deÿy_time
 = -2;

579 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.deÿy_time", 
NULL
, NULL,

580 (*)&
deÿy_time
, (
ssize_t
)), 
EFAULT
,

583 
deÿy_time
 = 0x7fffffff;

584 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.deÿy_time", 
NULL
, NULL,

585 (*)&
deÿy_time
, (
ssize_t
)), 0,

588 
´ev_deÿy_time
 = 
deÿy_time
, decay_time = -1;

589 
deÿy_time
 < 20; 
´ev_deÿy_time
 = decay_time, decay_time++) {

590 
ssize_t
 
Şd_deÿy_time
;

592 
	`as£¹_d_eq
(
	`m®lùl
("arenas.decay_time",

593 (*)&
Şd_deÿy_time
, &
sz
, (*)&
deÿy_time
,

594 (
ssize_t
)), 0, "Unexpected mallctl() failure");

595 
	`as£¹_zd_eq
(
Şd_deÿy_time
, 
´ev_deÿy_time
,

598 
	}
}

599 
TEST_END


601 
	$TEST_BEGIN
(
‹¡_¬’as_cÚ¡ªts
)

604 
	#TEST_ARENAS_CONSTANT
(
t
, 
Çme
, 
ex³ùed
) do { \

605 
t
 
Çme
; \

606 
size_t
 
sz
 = (
t
); \

607 
	`as£¹_d_eq
(
	`m®lùl
("¬’as."#Çme, (*)&
Çme
, &
sz
, 
NULL
, \

609 
	`as£¹_zu_eq
(
Çme
, 
ex³ùed
, "Incorrect "#name" size"); \

610 } 0)

	)

612 
	`TEST_ARENAS_CONSTANT
(
size_t
, 
quªtum
, 
QUANTUM
);

613 
	`TEST_ARENAS_CONSTANT
(
size_t
, 
·ge
, 
PAGE
);

614 
	`TEST_ARENAS_CONSTANT
(, 
nbšs
, 
NBINS
);

615 
	`TEST_ARENAS_CONSTANT
(, 
Æruns
, 
Æşas£s
);

616 
	`TEST_ARENAS_CONSTANT
(, 
nhchunks
, 
nhşas£s
);

618 #undeà
TEST_ARENAS_CONSTANT


619 
	}
}

620 
TEST_END


622 
	$TEST_BEGIN
(
‹¡_¬’as_bš_cÚ¡ªts
)

625 
	#TEST_ARENAS_BIN_CONSTANT
(
t
, 
Çme
, 
ex³ùed
) do { \

626 
t
 
Çme
; \

627 
size_t
 
sz
 = (
t
); \

628 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.bš.0."#Çme, (*)&
Çme
, &
sz
, \

629 
NULL
, 0), 0, "Unexpected mallctl() failure"); \

630 
	`as£¹_zu_eq
(
Çme
, 
ex³ùed
, "Incorrect "#name" size"); \

631 } 0)

	)

633 
	`TEST_ARENAS_BIN_CONSTANT
(
size_t
, 
size
, 
¬’a_bš_šfo
[0].
»g_size
);

634 
	`TEST_ARENAS_BIN_CONSTANT
(
ušt32_t
, 
Äegs
, 
¬’a_bš_šfo
[0].nregs);

635 
	`TEST_ARENAS_BIN_CONSTANT
(
size_t
, 
run_size
, 
¬’a_bš_šfo
[0].run_size);

637 #undeà
TEST_ARENAS_BIN_CONSTANT


638 
	}
}

639 
TEST_END


641 
	$TEST_BEGIN
(
‹¡_¬’as_Ìun_cÚ¡ªts
)

644 
	#TEST_ARENAS_LRUN_CONSTANT
(
t
, 
Çme
, 
ex³ùed
) do { \

645 
t
 
Çme
; \

646 
size_t
 
sz
 = (
t
); \

647 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ìun.0."#Çme, (*)&
Çme
, &
sz
, \

648 
NULL
, 0), 0, "Unexpected mallctl() failure"); \

649 
	`as£¹_zu_eq
(
Çme
, 
ex³ùed
, "Incorrect "#name" size"); \

650 } 0)

	)

652 
	`TEST_ARENAS_LRUN_CONSTANT
(
size_t
, 
size
, 
LARGE_MINCLASS
);

654 #undeà
TEST_ARENAS_LRUN_CONSTANT


655 
	}
}

656 
TEST_END


658 
	$TEST_BEGIN
(
‹¡_¬’as_hchunk_cÚ¡ªts
)

661 
	#TEST_ARENAS_HCHUNK_CONSTANT
(
t
, 
Çme
, 
ex³ùed
) do { \

662 
t
 
Çme
; \

663 
size_t
 
sz
 = (
t
); \

664 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.hchunk.0."#Çme, (*)&
Çme
, \

665 &
sz
, 
NULL
, 0), 0, "Unexpected mallctl() failure"); \

666 
	`as£¹_zu_eq
(
Çme
, 
ex³ùed
, "Incorrect "#name" size"); \

667 } 0)

	)

669 
	`TEST_ARENAS_HCHUNK_CONSTANT
(
size_t
, 
size
, 
chunksize
);

671 #undeà
TEST_ARENAS_HCHUNK_CONSTANT


672 
	}
}

673 
TEST_END


675 
	$TEST_BEGIN
(
‹¡_¬’as_ex‹nd
)

677 
Ç»Çs_befÜe
, 
¬’a
, 
Ç»Çs_aá”
;

678 
size_t
 
sz
 = ();

680 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ç»Çs", (*)&
Ç»Çs_befÜe
, &
sz
,

681 
NULL
, 0), 0, "Unexpected mallctl() failure");

682 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.ex‹nd", (*)&
¬’a
, &
sz
, 
NULL
, 0), 0,

684 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Ç»Çs", (*)&
Ç»Çs_aá”
, &
sz
, 
NULL
,

687 
	`as£¹_u_eq
(
Ç»Çs_befÜe
+1, 
Ç»Çs_aá”
,

689 
	`as£¹_u_eq
(
¬’a
, 
Ç»Çs_aá”
-1, "Unexpected‡rena index");

690 
	}
}

691 
TEST_END


693 
	$TEST_BEGIN
(
‹¡_¡©s_¬’as
)

696 
	#TEST_STATS_ARENAS
(
t
, 
Çme
) do { \

697 
t
 
Çme
; \

698 
size_t
 
sz
 = (
t
); \

699 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0."#Çme, (*)&
Çme
, &
sz
, \

700 
NULL
, 0), 0, "Unexpected mallctl() failure"); \

701 } 0)

	)

703 
	`TEST_STATS_ARENAS
(, 
Áh»ads
);

704 
	`TEST_STATS_ARENAS
(cÚ¡ *, 
dss
);

705 
	`TEST_STATS_ARENAS
(
ssize_t
, 
lg_dœty_muÉ
);

706 
	`TEST_STATS_ARENAS
(
ssize_t
, 
deÿy_time
);

707 
	`TEST_STATS_ARENAS
(
size_t
, 
·ùive
);

708 
	`TEST_STATS_ARENAS
(
size_t
, 
pdœty
);

710 #undeà
TEST_STATS_ARENAS


711 
	}
}

712 
TEST_END


715 
	$maš
()

718  (
	`‹¡
(

719 
‹¡_m®lùl_”rÜs
,

720 
‹¡_m®lùÊam‘omib_”rÜs
,

721 
‹¡_m®lùlbymib_”rÜs
,

722 
‹¡_m®lùl_»ad_wr™e
,

723 
‹¡_m®lùÊam‘omib_shÜt_mib
,

724 
‹¡_m®lùl_cÚfig
,

725 
‹¡_m®lùl_İt
,

726 
‹¡_mª·ge_exam¶e
,

727 
‹¡_tÿche_nÚe
,

728 
‹¡_tÿche
,

729 
‹¡_th»ad_¬’a
,

730 
‹¡_¬’a_i_lg_dœty_muÉ
,

731 
‹¡_¬’a_i_deÿy_time
,

732 
‹¡_¬’a_i_purge
,

733 
‹¡_¬’a_i_deÿy
,

734 
‹¡_¬’a_i_dss
,

735 
‹¡_¬’as_š™Ÿlized
,

736 
‹¡_¬’as_lg_dœty_muÉ
,

737 
‹¡_¬’as_deÿy_time
,

738 
‹¡_¬’as_cÚ¡ªts
,

739 
‹¡_¬’as_bš_cÚ¡ªts
,

740 
‹¡_¬’as_Ìun_cÚ¡ªts
,

741 
‹¡_¬’as_hchunk_cÚ¡ªts
,

742 
‹¡_¬’as_ex‹nd
,

743 
‹¡_¡©s_¬’as
));

744 
	}
}

	@deps/jemalloc/test/unit/math.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#MAX_REL_ERR
 1.0e-9

	)

4 
	#MAX_ABS_ERR
 1.0e-9

	)

6 
	~<æßt.h
>

8 #ifdeà
__PGI


9 #undeà
INFINITY


12 #iâdeà
INFINITY


13 
	#INFINITY
 (
DBL_MAX
 + DBL_MAX)

	)

16 
boŞ


17 
	$doubË_eq_»l
(
a
, 
b
, 
max_»l_”r
, 
max_abs_”r
)

19 
»l_”r
;

21 ià(
	`çbs
(
a
 - 
b
è< 
max_abs_”r
)

22  (
Œue
);

23 
»l_”r
 = (
	`çbs
(
b
è> fabs(
a
)) ? fabs((a-b)/b) : fabs((a-b)/a);

24  (
»l_”r
 < 
max_»l_”r
);

25 
	}
}

27 
ušt64_t


28 
	$çùÜŸl
(
x
)

30 
ušt64_t
 
»t
 = 1;

31 
i
;

33 
i
 = 2; i <ğ
x
; i++)

34 
»t
 *ğ(
ušt64_t
)
i
;

36  (
»t
);

37 
	}
}

39 
	$TEST_BEGIN
(
‹¡_Ê_gamma_çùÜŸl
)

41 
x
;

44 
x
 = 1; x <= 21; x++) {

45 
	`as£¹_Œue
(
	`doubË_eq_»l
(
	`exp
(
	`Ê_gamma
(
x
)),

46 ()
	`çùÜŸl
(
x
-1), 
MAX_REL_ERR
, 
MAX_ABS_ERR
),

47 "IncÜ»ù faùÜŸÈ»suÉ fÜ x=%u", 
x
);

49 
	}
}

50 
TEST_END


53 cÚ¡ 
	gÊ_gamma_misc_ex³ùed
[] = {

54 
INFINITY
,

191 
	$TEST_BEGIN
(
‹¡_Ê_gamma_misc
)

193 
i
;

195 
i
 = 1; i < (
Ê_gamma_misc_ex³ùed
)/(); i++) {

196 
x
 = ()
i
 * 0.25;

197 
	`as£¹_Œue
(
	`doubË_eq_»l
(
	`Ê_gamma
(
x
),

198 
Ê_gamma_misc_ex³ùed
[
i
], 
MAX_REL_ERR
, 
MAX_ABS_ERR
),

199 "IncÜ»ù†n_gamm¨»suÉ fÜ i=%u", 
i
);

201 
	}
}

202 
TEST_END


205 cÚ¡ 
	g±_nÜm_ex³ùed
[] = {

206 -
INFINITY
,

242 
	$TEST_BEGIN
(
‹¡_±_nÜm
)

244 
i
;

246 
i
 = 1; i < (
±_nÜm_ex³ùed
)/(); i++) {

247 
p
 = ()
i
 * 0.01;

248 
	`as£¹_Œue
(
	`doubË_eq_»l
(
	`±_nÜm
(
p
), 
±_nÜm_ex³ùed
[
i
],

249 
MAX_REL_ERR
, 
MAX_ABS_ERR
),

250 "IncÜ»ù…t_nÜm„esuÉ fÜ i=%u", 
i
);

252 
	}
}

253 
TEST_END


259 cÚ¡ 
	g±_chi2_df
[] = {0.1, 1.1, 10.1, 100.1, 1000.1};

260 cÚ¡ 
	g±_chi2_ex³ùed
[] = {

292 
	$TEST_BEGIN
(
‹¡_±_chi2
)

294 
i
, 
j
;

295 
e
 = 0;

297 
i
 = 0; i < (
±_chi2_df
)/(); i++) {

298 
df
 = 
±_chi2_df
[
i
];

299 
Ê_gamma_df
 = 
	`Ê_gamma
(
df
 * 0.5);

300 
j
 = 1; j < 100; j += 7) {

301 
p
 = ()
j
 * 0.01;

302 
	`as£¹_Œue
(
	`doubË_eq_»l
(
	`±_chi2
(
p
, 
df
, 
Ê_gamma_df
),

303 
±_chi2_ex³ùed
[
e
], 
MAX_REL_ERR
, 
MAX_ABS_ERR
),

304 "IncÜ»ù…t_chi2„esuÉ fÜ i=%u, j=%u", 
i
, 
j
);

305 
e
++;

308 
	}
}

309 
TEST_END


315 cÚ¡ 
	g±_gamma_sh­e
[] = {0.5, 1.0, 1.5, 2.0, 2.5, 3.0};

316 cÚ¡ 
	g±_gamma_ex³ùed
[] = {

354 
	$TEST_BEGIN
(
‹¡_±_gamma_sh­e
)

356 
i
, 
j
;

357 
e
 = 0;

359 
i
 = 0; i < (
±_gamma_sh­e
)/(); i++) {

360 
sh­e
 = 
±_gamma_sh­e
[
i
];

361 
Ê_gamma_sh­e
 = 
	`Ê_gamma
(
sh­e
);

362 
j
 = 1; j < 100; j += 7) {

363 
p
 = ()
j
 * 0.01;

364 
	`as£¹_Œue
(
	`doubË_eq_»l
(
	`±_gamma
(
p
, 
sh­e
, 1.0,

365 
Ê_gamma_sh­e
), 
±_gamma_ex³ùed
[
e
], 
MAX_REL_ERR
,

366 
MAX_ABS_ERR
),

367 "IncÜ»ù…t_gamm¨»suÉ fÜ i=%u, j=%u", 
i
, 
j
);

368 
e
++;

371 
	}
}

372 
TEST_END


374 
	$TEST_BEGIN
(
‹¡_±_gamma_sÿË
)

376 
sh­e
 = 1.0;

377 
Ê_gamma_sh­e
 = 
	`Ê_gamma
(
sh­e
);

379 
	`as£¹_Œue
(
	`doubË_eq_»l
(

380 
	`±_gamma
(0.5, 
sh­e
, 1.0, 
Ê_gamma_sh­e
) * 10.0,

381 
	`±_gamma
(0.5, 
sh­e
, 10.0, 
Ê_gamma_sh­e
), 
MAX_REL_ERR
,

382 
MAX_ABS_ERR
),

384 
	}
}

385 
TEST_END


388 
	$maš
()

391  (
	`‹¡
(

392 
‹¡_Ê_gamma_çùÜŸl
,

393 
‹¡_Ê_gamma_misc
,

394 
‹¡_±_nÜm
,

395 
‹¡_±_chi2
,

396 
‹¡_±_gamma_sh­e
,

397 
‹¡_±_gamma_sÿË
));

398 
	}
}

	@deps/jemalloc/test/unit/mq.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#NSENDERS
 3

	)

4 
	#NMSGS
 100000

	)

6 
mq_msg_s
 
	tmq_msg_t
;

7 
	smq_msg_s
 {

8 
mq_msg
(
mq_msg_t
è
	mlšk
;

10 
	$mq_g’
(, 
mq_
, 
mq_t
, 
mq_msg_t
, 
lšk
)

12 
	$TEST_BEGIN
(
‹¡_mq_basic
)

14 
mq_t
 
mq
;

15 
mq_msg_t
 
msg
;

17 
	`as£¹_çl£
(
	`mq_š™
(&
mq
), "Unexpected mq_init() failure");

18 
	`as£¹_u_eq
(
	`mq_couÁ
(&
mq
), 0, "mq should beƒmpty");

19 
	`as£¹_±r_nuÎ
(
	`mq_Œyg‘
(&
mq
),

22 
	`mq_put
(&
mq
, &
msg
);

23 
	`as£¹_u_eq
(
	`mq_couÁ
(&
mq
), 1, "mq should contain one message");

24 
	`as£¹_±r_eq
(
	`mq_Œyg‘
(&
mq
), &
msg
, "mq_tryget() should„eturn msg");

26 
	`mq_put
(&
mq
, &
msg
);

27 
	`as£¹_±r_eq
(
	`mq_g‘
(&
mq
), &
msg
, "mq_get() should„eturn msg");

29 
	`mq_fši
(&
mq
);

30 
	}
}

31 
TEST_END


34 
	$thd_»ûiv”_¡¬t
(*
¬g
)

36 
mq_t
 *
mq
 = (mq_ˆ*)
¬g
;

37 
i
;

39 
i
 = 0; i < (
NSENDERS
 * 
NMSGS
); i++) {

40 
mq_msg_t
 *
msg
 = 
	`mq_g‘
(
mq
);

41 
	`as£¹_±r_nÙ_nuÎ
(
msg
, "mq_get() should‚ever„eturn NULL");

42 
	`d®locx
(
msg
, 0);

44  (
NULL
);

45 
	}
}

48 
	$thd_£nd”_¡¬t
(*
¬g
)

50 
mq_t
 *
mq
 = (mq_ˆ*)
¬g
;

51 
i
;

53 
i
 = 0; i < 
NMSGS
; i++) {

54 
mq_msg_t
 *
msg
;

55 *
p
;

56 
p
 = 
	`m®locx
((
mq_msg_t
), 0);

57 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

58 
msg
 = (
mq_msg_t
 *)
p
;

59 
	`mq_put
(
mq
, 
msg
);

61  (
NULL
);

62 
	}
}

64 
	$TEST_BEGIN
(
‹¡_mq_th»aded
)

66 
mq_t
 
mq
;

67 
thd_t
 
»ûiv”
;

68 
thd_t
 
£nd”s
[
NSENDERS
];

69 
i
;

71 
	`as£¹_çl£
(
	`mq_š™
(&
mq
), "Unexpected mq_init() failure");

73 
	`thd_ü—‹
(&
»ûiv”
, 
thd_»ûiv”_¡¬t
, (*)&
mq
);

74 
i
 = 0; i < 
NSENDERS
; i++)

75 
	`thd_ü—‹
(&
£nd”s
[
i
], 
thd_£nd”_¡¬t
, (*)&
mq
);

77 
	`thd_još
(
»ûiv”
, 
NULL
);

78 
i
 = 0; i < 
NSENDERS
; i++)

79 
	`thd_još
(
£nd”s
[
i
], 
NULL
);

81 
	`mq_fši
(&
mq
);

82 
	}
}

83 
TEST_END


86 
	$maš
()

89  (
	`‹¡
(

90 
‹¡_mq_basic
,

91 
‹¡_mq_th»aded
));

92 
	}
}

	@deps/jemalloc/test/unit/mtx.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#NTHREADS
 2

	)

4 
	#NINCRS
 2000000

	)

6 
	$TEST_BEGIN
(
‹¡_mtx_basic
)

8 
mtx_t
 
mtx
;

10 
	`as£¹_çl£
(
	`mtx_š™
(&
mtx
), "Unexpected mtx_init() failure");

11 
	`mtx_lock
(&
mtx
);

12 
	`mtx_uÆock
(&
mtx
);

13 
	`mtx_fši
(&
mtx
);

14 
	}
}

15 
TEST_END


18 
mtx_t
 
	mmtx
;

19 
	mx
;

20 } 
	tthd_¡¬t_¬g_t
;

23 
	$thd_¡¬t
(*
v¬g
)

25 
thd_¡¬t_¬g_t
 *
¬g
 = (thd_¡¬t_¬g_ˆ*)
v¬g
;

26 
i
;

28 
i
 = 0; i < 
NINCRS
; i++) {

29 
	`mtx_lock
(&
¬g
->
mtx
);

30 
¬g
->
x
++;

31 
	`mtx_uÆock
(&
¬g
->
mtx
);

33  (
NULL
);

34 
	}
}

36 
	$TEST_BEGIN
(
‹¡_mtx_¿û
)

38 
thd_¡¬t_¬g_t
 
¬g
;

39 
thd_t
 
thds
[
NTHREADS
];

40 
i
;

42 
	`as£¹_çl£
(
	`mtx_š™
(&
¬g
.
mtx
), "Unexpected mtx_init() failure");

43 
¬g
.
x
 = 0;

44 
i
 = 0; i < 
NTHREADS
; i++)

45 
	`thd_ü—‹
(&
thds
[
i
], 
thd_¡¬t
, (*)&
¬g
);

46 
i
 = 0; i < 
NTHREADS
; i++)

47 
	`thd_još
(
thds
[
i
], 
NULL
);

48 
	`as£¹_u_eq
(
¬g
.
x
, 
NTHREADS
 * 
NINCRS
,

50 
	}
}

51 
TEST_END


54 
	$maš
()

57  (
	`‹¡
(

58 
‹¡_mtx_basic
,

59 
‹¡_mtx_¿û
));

60 
	}
}

	@deps/jemalloc/test/unit/nstime.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#BILLION
 
	`UINT64_C
(1000000000)

	)

5 
	$TEST_BEGIN
(
‹¡_n¡ime_š™
)

7 
n¡ime_t
 
n¡
;

9 
	`n¡ime_š™
(&
n¡
, 42000000043);

10 
	`as£¹_u64_eq
(
	`n¡ime_ns
(&
n¡
), 42000000043, "ns incorrectly„ead");

11 
	`as£¹_u64_eq
(
	`n¡ime_£c
(&
n¡
), 42, "sec incorrectly„ead");

12 
	`as£¹_u64_eq
(
	`n¡ime_n£c
(&
n¡
), 43, "nsec incorrectly„ead");

13 
	}
}

14 
TEST_END


16 
	$TEST_BEGIN
(
‹¡_n¡ime_š™2
)

18 
n¡ime_t
 
n¡
;

20 
	`n¡ime_š™2
(&
n¡
, 42, 43);

21 
	`as£¹_u64_eq
(
	`n¡ime_£c
(&
n¡
), 42, "sec incorrectly„ead");

22 
	`as£¹_u64_eq
(
	`n¡ime_n£c
(&
n¡
), 43, "nsec incorrectly„ead");

23 
	}
}

24 
TEST_END


26 
	$TEST_BEGIN
(
‹¡_n¡ime_cİy
)

28 
n¡ime_t
 
n¡a
, 
n¡b
;

30 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

31 
	`n¡ime_š™
(&
n¡b
, 0);

32 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

33 
	`as£¹_u64_eq
(
	`n¡ime_£c
(&
n¡b
), 42, "sec incorrectly copied");

34 
	`as£¹_u64_eq
(
	`n¡ime_n£c
(&
n¡b
), 43, "nsec incorrectly copied");

35 
	}
}

36 
TEST_END


38 
	$TEST_BEGIN
(
‹¡_n¡ime_com·»
)

40 
n¡ime_t
 
n¡a
, 
n¡b
;

42 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

43 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

44 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 0, "Times should beƒqual");

45 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡b
, &
n¡a
), 0, "Times should beƒqual");

47 
	`n¡ime_š™2
(&
n¡b
, 42, 42);

48 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 1,

50 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡b
, &
n¡a
), -1,

53 
	`n¡ime_š™2
(&
n¡b
, 42, 44);

54 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), -1,

56 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡b
, &
n¡a
), 1,

59 
	`n¡ime_š™2
(&
n¡b
, 41, 
BILLION
 - 1);

60 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 1,

62 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡b
, &
n¡a
), -1,

65 
	`n¡ime_š™2
(&
n¡b
, 43, 0);

66 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), -1,

68 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡b
, &
n¡a
), 1,

70 
	}
}

71 
TEST_END


73 
	$TEST_BEGIN
(
‹¡_n¡ime_add
)

75 
n¡ime_t
 
n¡a
, 
n¡b
;

77 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

78 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

79 
	`n¡ime_add
(&
n¡a
, &
n¡b
);

80 
	`n¡ime_š™2
(&
n¡b
, 84, 86);

81 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 0,

84 
	`n¡ime_š™2
(&
n¡a
, 42, 
BILLION
 - 1);

85 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

86 
	`n¡ime_add
(&
n¡a
, &
n¡b
);

87 
	`n¡ime_š™2
(&
n¡b
, 85, 
BILLION
 - 2);

88 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 0,

90 
	}
}

91 
TEST_END


93 
	$TEST_BEGIN
(
‹¡_n¡ime_subŒaù
)

95 
n¡ime_t
 
n¡a
, 
n¡b
;

97 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

98 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

99 
	`n¡ime_subŒaù
(&
n¡a
, &
n¡b
);

100 
	`n¡ime_š™
(&
n¡b
, 0);

101 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 0,

104 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

105 
	`n¡ime_š™2
(&
n¡b
, 41, 44);

106 
	`n¡ime_subŒaù
(&
n¡a
, &
n¡b
);

107 
	`n¡ime_š™2
(&
n¡b
, 0, 
BILLION
 - 1);

108 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 0,

110 
	}
}

111 
TEST_END


113 
	$TEST_BEGIN
(
‹¡_n¡ime_imuÉly
)

115 
n¡ime_t
 
n¡a
, 
n¡b
;

117 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

118 
	`n¡ime_imuÉly
(&
n¡a
, 10);

119 
	`n¡ime_š™2
(&
n¡b
, 420, 430);

120 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 0,

123 
	`n¡ime_š™2
(&
n¡a
, 42, 666666666);

124 
	`n¡ime_imuÉly
(&
n¡a
, 3);

125 
	`n¡ime_š™2
(&
n¡b
, 127, 999999998);

126 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 0,

128 
	}
}

129 
TEST_END


131 
	$TEST_BEGIN
(
‹¡_n¡ime_idivide
)

133 
n¡ime_t
 
n¡a
, 
n¡b
;

135 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

136 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

137 
	`n¡ime_imuÉly
(&
n¡a
, 10);

138 
	`n¡ime_idivide
(&
n¡a
, 10);

139 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 0,

142 
	`n¡ime_š™2
(&
n¡a
, 42, 666666666);

143 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

144 
	`n¡ime_imuÉly
(&
n¡a
, 3);

145 
	`n¡ime_idivide
(&
n¡a
, 3);

146 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡a
, &
n¡b
), 0,

148 
	}
}

149 
TEST_END


151 
	$TEST_BEGIN
(
‹¡_n¡ime_divide
)

153 
n¡ime_t
 
n¡a
, 
n¡b
, 
n¡c
;

155 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

156 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

157 
	`n¡ime_imuÉly
(&
n¡a
, 10);

158 
	`as£¹_u64_eq
(
	`n¡ime_divide
(&
n¡a
, &
n¡b
), 10,

161 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

162 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

163 
	`n¡ime_imuÉly
(&
n¡a
, 10);

164 
	`n¡ime_š™
(&
n¡c
, 1);

165 
	`n¡ime_add
(&
n¡a
, &
n¡c
);

166 
	`as£¹_u64_eq
(
	`n¡ime_divide
(&
n¡a
, &
n¡b
), 10,

169 
	`n¡ime_š™2
(&
n¡a
, 42, 43);

170 
	`n¡ime_cİy
(&
n¡b
, &
n¡a
);

171 
	`n¡ime_imuÉly
(&
n¡a
, 10);

172 
	`n¡ime_š™
(&
n¡c
, 1);

173 
	`n¡ime_subŒaù
(&
n¡a
, &
n¡c
);

174 
	`as£¹_u64_eq
(
	`n¡ime_divide
(&
n¡a
, &
n¡b
), 9,

176 
	}
}

177 
TEST_END


179 
	$TEST_BEGIN
(
‹¡_n¡ime_mÚÙÚic
)

182 
	`n¡ime_mÚÙÚic
();

183 
	}
}

184 
TEST_END


186 
	$TEST_BEGIN
(
‹¡_n¡ime_upd©e
)

188 
n¡ime_t
 
n¡
;

190 
	`n¡ime_š™
(&
n¡
, 0);

192 
	`as£¹_çl£
(
	`n¡ime_upd©e
(&
n¡
), "Basicime update failed.");

196 
n¡ime_t
 
add’d
;

197 
	`n¡ime_š™2
(&
add’d
, 631152000, 0);

198 
	`n¡ime_add
(&
n¡
, &
add’d
);

201 
n¡ime_t
 
n¡0
;

202 
	`n¡ime_cİy
(&
n¡0
, &
n¡
);

203 
	`as£¹_Œue
(
	`n¡ime_upd©e
(&
n¡
),

205 
	`as£¹_d_eq
(
	`n¡ime_com·»
(&
n¡
, &
n¡0
), 0,

208 
	}
}

209 
TEST_END


212 
	$maš
()

215  (
	`‹¡
(

216 
‹¡_n¡ime_š™
,

217 
‹¡_n¡ime_š™2
,

218 
‹¡_n¡ime_cİy
,

219 
‹¡_n¡ime_com·»
,

220 
‹¡_n¡ime_add
,

221 
‹¡_n¡ime_subŒaù
,

222 
‹¡_n¡ime_imuÉly
,

223 
‹¡_n¡ime_idivide
,

224 
‹¡_n¡ime_divide
,

225 
‹¡_n¡ime_mÚÙÚic
,

226 
‹¡_n¡ime_upd©e
));

227 
	}
}

	@deps/jemalloc/test/unit/pack.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 cÚ¡ *
	gm®loc_cÚf
 =

14 #ià
LG_PAGE
 <= 14

15 
	#SZ
 (
	`ZU
(1è<< (
LG_PAGE
 - 2))

	)

17 
	#SZ
 4096

	)

25 
	#NCHUNKS
 8

	)

28 
	$bššd_compu‹
()

30 
size_t
 
sz
;

31 
nbšs
, 
i
;

33 
sz
 = (
nbšs
);

34 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.nbšs", (*)&
nbšs
, &
sz
, 
NULL
, 0), 0,

37 
i
 = 0; i < 
nbšs
; i++) {

38 
size_t
 
mib
[4];

39 
size_t
 
mibËn
 = (
mib
)/(size_t);

40 
size_t
 
size
;

42 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’as.bš.0.size", 
mib
,

43 &
mibËn
), 0, "Unexpected mallctlnametomb failure");

44 
mib
[2] = (
size_t
)
i
;

46 
sz
 = (
size
);

47 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
size
, &
sz
, 
NULL
,

49 ià(
size
 =ğ
SZ
)

50  (
i
);

53 
	`‹¡_ç
("Unableo compute‚regs_per_run");

55 
	}
}

57 
size_t


58 
	$Äegs_³r_run_compu‹
()

60 
ušt32_t
 
Äegs
;

61 
size_t
 
sz
;

62 
bššd
 = 
	`bššd_compu‹
();

63 
size_t
 
mib
[4];

64 
size_t
 
mibËn
 = (
mib
)/(size_t);

66 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’as.bš.0.Äegs", 
mib
, &
mibËn
), 0,

68 
mib
[2] = (
size_t
)
bššd
;

69 
sz
 = (
Äegs
);

70 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
Äegs
, &
sz
, 
NULL
,

72  (
Äegs
);

73 
	}
}

75 
size_t


76 
	$Åages_³r_run_compu‹
()

78 
size_t
 
sz
;

79 
bššd
 = 
	`bššd_compu‹
();

80 
size_t
 
mib
[4];

81 
size_t
 
mibËn
 = (
mib
)/(size_t);

82 
size_t
 
run_size
;

84 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’as.bš.0.run_size", 
mib
, &
mibËn
), 0,

86 
mib
[2] = (
size_t
)
bššd
;

87 
sz
 = (
run_size
);

88 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
run_size
, &
sz
, 
NULL
,

90  (
run_size
 >> 
LG_PAGE
);

91 
	}
}

93 
size_t


94 
	$Åages_³r_chunk_compu‹
()

97  ((
chunksize
 >> 
LG_PAGE
è- 
m­_bŸs
);

98 
	}
}

100 
size_t


101 
	$Äuns_³r_chunk_compu‹
()

104  (
	`Åages_³r_chunk_compu‹
(è/ 
	`Åages_³r_run_compu‹
());

105 
	}
}

108 
	$¬’as_ex‹nd_m®lùl
()

110 
¬’a_šd
;

111 
size_t
 
sz
;

113 
sz
 = (
¬’a_šd
);

114 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.ex‹nd", (*)&
¬’a_šd
, &
sz
, 
NULL
, 0),

117  (
¬’a_šd
);

118 
	}
}

121 
	$¬’a_»£t_m®lùl
(
¬’a_šd
)

123 
size_t
 
mib
[3];

124 
size_t
 
mibËn
 = (
mib
)/(size_t);

126 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’a.0.»£t", 
mib
, &
mibËn
), 0,

128 
mib
[1] = (
size_t
)
¬’a_šd
;

129 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, 
NULL
, NULL, NULL, 0), 0,

131 
	}
}

133 
	$TEST_BEGIN
(
‹¡_·ck
)

135 
¬’a_šd
 = 
	`¬’as_ex‹nd_m®lùl
();

136 
size_t
 
Äegs_³r_run
 = 
	`Äegs_³r_run_compu‹
();

137 
size_t
 
Äuns_³r_chunk
 = 
	`Äuns_³r_chunk_compu‹
();

138 
size_t
 
Äuns
 = 
Äuns_³r_chunk
 * 
NCHUNKS
;

139 
size_t
 
Äegs
 = 
Äegs_³r_run
 * 
Äuns
;

140 
	`VARIABLE_ARRAY
(*, 
±rs
, 
Äegs
);

141 
size_t
 
i
, 
j
, 
off£t
;

144 
i
 = 
off£t
 = 0; i < 
Äuns
; i++) {

145 
j
 = 0; j < 
Äegs_³r_run
; j++) {

146 *
p
 = 
	`m®locx
(
SZ
, 
	`MALLOCX_ARENA
(
¬’a_šd
) |

147 
MALLOCX_TCACHE_NONE
);

148 
	`as£¹_±r_nÙ_nuÎ
(
p
,

151 
SZ
, 
¬’a_šd
, 
i
, 
j
);

152 
±rs
[(
i
 * 
Äegs_³r_run
è+ 
j
] = 
p
;

161 
off£t
 = 0;

162 
i
 = 
off£t
 = 0;

163 
i
 < 
Äuns
;

164 
i
++, 
off£t
 = (off£ˆ+ 1è% 
Äegs_³r_run
) {

165 
j
 = 0; j < 
Äegs_³r_run
; j++) {

166 *
p
 = 
±rs
[(
i
 * 
Äegs_³r_run
è+ 
j
];

167 ià(
off£t
 =ğ
j
)

169 
	`d®locx
(
p
, 
	`MALLOCX_ARENA
(
¬’a_šd
) |

170 
MALLOCX_TCACHE_NONE
);

178 
off£t
 = 0;

179 
i
 = 
off£t
 = 0;

180 
i
 < 
Äuns
;

181 
i
++, 
off£t
 = (off£ˆ+ 1è% 
Äegs_³r_run
) {

182 
j
 = 0; j < 
Äegs_³r_run
; j++) {

183 *
p
;

185 ià(
off£t
 =ğ
j
)

187 
p
 = 
	`m®locx
(
SZ
, 
	`MALLOCX_ARENA
(
¬’a_šd
) |

188 
MALLOCX_TCACHE_NONE
);

189 
	`as£¹_±r_eq
(
p
, 
±rs
[(
i
 * 
Äegs_³r_run
è+ 
j
],

191 
i
, 
j
);

196 
	`¬’a_»£t_m®lùl
(
¬’a_šd
);

197 
	}
}

198 
TEST_END


201 
	$maš
()

204  (
	`‹¡
(

205 
‹¡_·ck
));

206 
	}
}

	@deps/jemalloc/test/unit/pages.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	$TEST_BEGIN
(
‹¡_·ges_huge
)

5 
boŞ
 
comm™
;

6 *
·ges
;

8 
comm™
 = 
Œue
;

9 
·ges
 = 
	`·ges_m­
(
NULL
, 
PAGE
, &
comm™
);

10 
	`as£¹_±r_nÙ_nuÎ
(
·ges
, "Unexpected…ages_map()ƒrror");

12 
	`as£¹_çl£
(
	`·ges_huge
(
·ges
, 
PAGE
),

14 
	`as£¹_çl£
(
	`·ges_nohuge
(
·ges
, 
PAGE
),

17 
	`·ges_unm­
(
·ges
, 
PAGE
);

18 
	}
}

19 
TEST_END


22 
	$maš
()

25  (
	`‹¡
(

26 
‹¡_·ges_huge
));

27 
	}
}

	@deps/jemalloc/test/unit/ph.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
node_s
 
	tnode_t
;

5 
	snode_s
 {

6 
	#NODE_MAGIC
 0x9823af7e

	)

7 
ušt32_t
 
	mmagic
;

8 
phn
(
node_t
è
	mlšk
;

9 
ušt64_t
 
	mkey
;

13 
	$node_cmp
(cÚ¡ 
node_t
 *
a
, cÚ¡‚ode_ˆ*
b
)

15 
»t
;

17 
»t
 = (
a
->
key
 > 
b
->key) - (a->key < b->key);

18 ià(
»t
 == 0) {

23 
»t
 = (((
ušŒ_t
)
a
è> ((ušŒ_t)
b
))

24 - (((
ušŒ_t
)
a
è< ((ušŒ_t)
b
));

26  (
»t
);

27 
	}
}

30 
	$node_cmp_magic
(cÚ¡ 
node_t
 *
a
, cÚ¡‚ode_ˆ*
b
) {

32 
	`as£¹_u32_eq
(
a
->
magic
, 
NODE_MAGIC
, "Bad magic");

33 
	`as£¹_u32_eq
(
b
->
magic
, 
NODE_MAGIC
, "Bad magic");

35  (
	`node_cmp
(
a
, 
b
));

36 
	}
}

38 
	$ph
(
	tnode_t
è
	th—p_t
;

39 
	`ph_g’
(, 
h—p_
, 
h—p_t
, 
node_t
, 
lšk
, 
node_cmp_magic
);

42 
	$node_´št
(cÚ¡ 
node_t
 *
node
, 
d•th
)

44 
i
;

45 
node_t
 *
Ëámo¡_chd
, *
siblšg
;

47 
i
 = 0; i < 
d•th
; i++)

48 
	`m®loc_´štf
("\t");

49 
	`m®loc_´štf
("%2"
FMTu64
"\n", 
node
->
key
);

51 
Ëámo¡_chd
 = 
	`phn_lchd_g‘
(
node_t
, 
lšk
, 
node
);

52 ià(
Ëámo¡_chd
 =ğ
NULL
)

54 
	`node_´št
(
Ëámo¡_chd
, 
d•th
 + 1);

56 
siblšg
 = 
	`phn_Ãxt_g‘
(
node_t
, 
lšk
, 
Ëámo¡_chd
); sibling !=

57 
NULL
; 
siblšg
 = 
	`phn_Ãxt_g‘
(
node_t
, 
lšk
, sibling)) {

58 
	`node_´št
(
siblšg
, 
d•th
 + 1);

60 
	}
}

63 
	$h—p_´št
(cÚ¡ 
h—p_t
 *
h—p
)

65 
node_t
 *
aux–m
;

67 
	`m®loc_´štf
("vvv h—°%°vvv\n", 
h—p
);

68 ià(
h—p
->
ph_roÙ
 =ğ
NULL
)

69 
Ïb–_»tuº
;

71 
	`node_´št
(
h—p
->
ph_roÙ
, 0);

73 
aux–m
 = 
	`phn_Ãxt_g‘
(
node_t
, 
lšk
, 
h—p
->
ph_roÙ
);‡ux–m !ğ
NULL
;

74 
aux–m
 = 
	`phn_Ãxt_g‘
(
node_t
, 
lšk
,‡uxelm)) {

75 
	`as£¹_±r_eq
(
	`phn_Ãxt_g‘
(
node_t
, 
lšk
, 
	`phn_´ev_g‘
(node_t,

76 
lšk
, 
aux–m
)),‡uxelm,

78 
	`node_´št
(
aux–m
, 0);

81 
Ïb–_»tuº
:

82 
	`m®loc_´štf
("^^^ h—°%°^^^\n", 
h—p
);

83 
	}
}

86 
	$node_v®id©e
(cÚ¡ 
node_t
 *
node
, cÚ¡‚ode_ˆ*
·»Á
)

88 
Âodes
 = 1;

89 
node_t
 *
Ëámo¡_chd
, *
siblšg
;

91 ià(
·»Á
 !ğ
NULL
) {

92 
	`as£¹_d_ge
(
	`node_cmp_magic
(
node
, 
·»Á
), 0,

96 
Ëámo¡_chd
 = 
	`phn_lchd_g‘
(
node_t
, 
lšk
, 
node
);

97 ià(
Ëámo¡_chd
 =ğ
NULL
)

98  (
Âodes
);

99 
	`as£¹_±r_eq
((*)
	`phn_´ev_g‘
(
node_t
, 
lšk
, 
Ëámo¡_chd
),

100 (*)
node
, "Leftmost child does‚ot†inko‚ode");

101 
Âodes
 +ğ
	`node_v®id©e
(
Ëámo¡_chd
, 
node
);

103 
siblšg
 = 
	`phn_Ãxt_g‘
(
node_t
, 
lšk
, 
Ëámo¡_chd
); sibling !=

104 
NULL
; 
siblšg
 = 
	`phn_Ãxt_g‘
(
node_t
, 
lšk
, sibling)) {

105 
	`as£¹_±r_eq
(
	`phn_Ãxt_g‘
(
node_t
, 
lšk
, 
	`phn_´ev_g‘
(node_t,

106 
lšk
, 
siblšg
)), sibling,

108 
Âodes
 +ğ
	`node_v®id©e
(
siblšg
, 
node
);

110  (
Âodes
);

111 
	}
}

114 
	$h—p_v®id©e
(cÚ¡ 
h—p_t
 *
h—p
)

116 
Âodes
 = 0;

117 
node_t
 *
aux–m
;

119 ià(
h—p
->
ph_roÙ
 =ğ
NULL
)

120 
Ïb–_»tuº
;

122 
Âodes
 +ğ
	`node_v®id©e
(
h—p
->
ph_roÙ
, 
NULL
);

124 
aux–m
 = 
	`phn_Ãxt_g‘
(
node_t
, 
lšk
, 
h—p
->
ph_roÙ
);‡ux–m !ğ
NULL
;

125 
aux–m
 = 
	`phn_Ãxt_g‘
(
node_t
, 
lšk
,‡uxelm)) {

126 
	`as£¹_±r_eq
(
	`phn_Ãxt_g‘
(
node_t
, 
lšk
, 
	`phn_´ev_g‘
(node_t,

127 
lšk
, 
aux–m
)),‡uxelm,

129 
Âodes
 +ğ
	`node_v®id©e
(
aux–m
, 
NULL
);

132 
Ïb–_»tuº
:

133 ià(
çl£
)

134 
	`h—p_´št
(
h—p
);

135  (
Âodes
);

136 
	}
}

138 
	$TEST_BEGIN
(
‹¡_ph_em±y
)

140 
h—p_t
 
h—p
;

142 
	`h—p_Ãw
(&
h—p
);

143 
	`as£¹_Œue
(
	`h—p_em±y
(&
h—p
), "Heap should beƒmpty");

144 
	`as£¹_±r_nuÎ
(
	`h—p_fœ¡
(&
h—p
), "Unexpected‚ode");

145 
	}
}

146 
TEST_END


149 
	$node_»move
(
h—p_t
 *
h—p
, 
node_t
 *
node
)

152 
	`h—p_»move
(
h—p
, 
node
);

154 
node
->
magic
 = 0;

155 
	}
}

157 
node_t
 *

158 
	$node_»move_fœ¡
(
h—p_t
 *
h—p
)

160 
node_t
 *
node
 = 
	`h—p_»move_fœ¡
(
h—p
);

161 
node
->
magic
 = 0;

162  (
node
);

163 
	}
}

165 
	$TEST_BEGIN
(
‹¡_ph_¿ndom
)

167 
	#NNODES
 25

	)

168 
	#NBAGS
 250

	)

169 
	#SEED
 42

	)

170 
sfmt_t
 *
sfmt
;

171 
ušt64_t
 
bag
[
NNODES
];

172 
h—p_t
 
h—p
;

173 
node_t
 
nodes
[
NNODES
];

174 
i
, 
j
, 
k
;

176 
sfmt
 = 
	`š™_g’_¿nd
(
SEED
);

177 
i
 = 0; i < 
NBAGS
; i++) {

178 
i
) {

181 
j
 = 0; j < 
NNODES
; j++)

182 
bag
[
j
] = j;

186 
j
 = 0; j < 
NNODES
; j++)

187 
bag
[
j
] = 
NNODES
 - j - 1;

190 
j
 = 0; j < 
NNODES
; j++)

191 
bag
[
j
] = 
	`g’_¿nd64_¿nge
(
sfmt
, 
NNODES
);

194 
j
 = 1; j <ğ
NNODES
; j++) {

196 
	`h—p_Ãw
(&
h—p
);

197 
	`as£¹_u_eq
(
	`h—p_v®id©e
(&
h—p
), 0,

199 
k
 = 0; k < 
j
; k++) {

200 
nodes
[
k
].
magic
 = 
NODE_MAGIC
;

201 
nodes
[
k
].
key
 = 
bag
[k];

205 
k
 = 0; k < 
j
; k++) {

206 
	`h—p_š£¹
(&
h—p
, &
nodes
[
k
]);

207 ià(
i
 % 13 == 12) {

209 
	`as£¹_±r_nÙ_nuÎ
(
	`h—p_fœ¡
(&
h—p
),

212 
	`as£¹_u_eq
(
	`h—p_v®id©e
(&
h—p
), 
k
 + 1,

216 
	`as£¹_çl£
(
	`h—p_em±y
(&
h—p
),

220 
i
 % 4) {

222 
k
 = 0; k < 
j
; k++) {

223 
	`as£¹_u_eq
(
	`h—p_v®id©e
(&
h—p
), 
j
 - 
k
,

225 
	`node_»move
(&
h—p
, &
nodes
[
k
]);

226 
	`as£¹_u_eq
(
	`h—p_v®id©e
(&
h—p
), 
j
 - 
k


231 
k
 = 
j
; k > 0; k--) {

232 
	`node_»move
(&
h—p
, &
nodes
[
k
-1]);

233 
	`as£¹_u_eq
(
	`h—p_v®id©e
(&
h—p
), 
k
 - 1,

238 
node_t
 *
´ev
 = 
NULL
;

239 
k
 = 0; k < 
j
; k++) {

240 
node_t
 *
node
 = 
	`node_»move_fœ¡
(&
h—p
);

241 
	`as£¹_u_eq
(
	`h—p_v®id©e
(&
h—p
), 
j
 - 
k


243 ià(
´ev
 !ğ
NULL
) {

244 
	`as£¹_d_ge
(
	`node_cmp
(
node
,

245 
´ev
), 0,

248 
´ev
 = 
node
;

252 
node_t
 *
´ev
 = 
NULL
;

253 
k
 = 0; k < 
j
; k++) {

254 
node_t
 *
node
 = 
	`h—p_fœ¡
(&
h—p
);

255 
	`as£¹_u_eq
(
	`h—p_v®id©e
(&
h—p
), 
j
 - 
k
,

257 ià(
´ev
 !ğ
NULL
) {

258 
	`as£¹_d_ge
(
	`node_cmp
(
node
,

259 
´ev
), 0,

262 
	`node_»move
(&
h—p
, 
node
);

263 
	`as£¹_u_eq
(
	`h—p_v®id©e
(&
h—p
), 
j
 - 
k


265 
´ev
 = 
node
;

269 
	`nÙ_»ached
();

272 
	`as£¹_±r_nuÎ
(
	`h—p_fœ¡
(&
h—p
),

274 
	`as£¹_Œue
(
	`h—p_em±y
(&
h—p
), "Heap should beƒmpty");

277 
	`fši_g’_¿nd
(
sfmt
);

278 #undeà
NNODES


279 #undeà
SEED


280 
	}
}

281 
TEST_END


284 
	$maš
()

287  (
	`‹¡
(

288 
‹¡_ph_em±y
,

289 
‹¡_ph_¿ndom
));

290 
	}
}

	@deps/jemalloc/test/unit/prng.c

1 
	~"‹¡/jem®loc_‹¡.h
"

4 
	$‹¡_´ng_lg_¿nge_u32
(
boŞ
 
©omic
)

6 
ušt32_t
 
§
, 
sb
, 
¿
, 
rb
;

7 
lg_¿nge
;

9 
§
 = 42;

10 
¿
 = 
	`´ng_lg_¿nge_u32
(&
§
, 32, 
©omic
);

11 
§
 = 42;

12 
rb
 = 
	`´ng_lg_¿nge_u32
(&
§
, 32, 
©omic
);

13 
	`as£¹_u32_eq
(
¿
, 
rb
,

16 
sb
 = 42;

17 
rb
 = 
	`´ng_lg_¿nge_u32
(&
sb
, 32, 
©omic
);

18 
	`as£¹_u32_eq
(
¿
, 
rb
,

21 
§
 = 42;

22 
¿
 = 
	`´ng_lg_¿nge_u32
(&
§
, 32, 
©omic
);

23 
rb
 = 
	`´ng_lg_¿nge_u32
(&
§
, 32, 
©omic
);

24 
	`as£¹_u32_Ã
(
¿
, 
rb
,

27 
§
 = 42;

28 
¿
 = 
	`´ng_lg_¿nge_u32
(&
§
, 32, 
©omic
);

29 
lg_¿nge
 = 31;†g_range > 0;†g_range--) {

30 
sb
 = 42;

31 
rb
 = 
	`´ng_lg_¿nge_u32
(&
sb
, 
lg_¿nge
, 
©omic
);

32 
	`as£¹_u32_eq
((
rb
 & (
	`UINT32_C
(0xffffffffè<< 
lg_¿nge
)),

33 0, "High ord” b™ should b0,†g_¿nge=%u", 
lg_¿nge
);

34 
	`as£¹_u32_eq
(
rb
, (
¿
 >> (32 - 
lg_¿nge
)),

36 "lg_¿nge=%u", 
lg_¿nge
);

38 
	}
}

41 
	$‹¡_´ng_lg_¿nge_u64
()

43 
ušt64_t
 
§
, 
sb
, 
¿
, 
rb
;

44 
lg_¿nge
;

46 
§
 = 42;

47 
¿
 = 
	`´ng_lg_¿nge_u64
(&
§
, 64);

48 
§
 = 42;

49 
rb
 = 
	`´ng_lg_¿nge_u64
(&
§
, 64);

50 
	`as£¹_u64_eq
(
¿
, 
rb
,

53 
sb
 = 42;

54 
rb
 = 
	`´ng_lg_¿nge_u64
(&
sb
, 64);

55 
	`as£¹_u64_eq
(
¿
, 
rb
,

58 
§
 = 42;

59 
¿
 = 
	`´ng_lg_¿nge_u64
(&
§
, 64);

60 
rb
 = 
	`´ng_lg_¿nge_u64
(&
§
, 64);

61 
	`as£¹_u64_Ã
(
¿
, 
rb
,

64 
§
 = 42;

65 
¿
 = 
	`´ng_lg_¿nge_u64
(&
§
, 64);

66 
lg_¿nge
 = 63;†g_range > 0;†g_range--) {

67 
sb
 = 42;

68 
rb
 = 
	`´ng_lg_¿nge_u64
(&
sb
, 
lg_¿nge
);

69 
	`as£¹_u64_eq
((
rb
 & (
	`UINT64_C
(0xffffffffffffffffè<< 
lg_¿nge
)),

70 0, "High ord” b™ should b0,†g_¿nge=%u", 
lg_¿nge
);

71 
	`as£¹_u64_eq
(
rb
, (
¿
 >> (64 - 
lg_¿nge
)),

73 "lg_¿nge=%u", 
lg_¿nge
);

75 
	}
}

78 
	$‹¡_´ng_lg_¿nge_zu
(
boŞ
 
©omic
)

80 
size_t
 
§
, 
sb
, 
¿
, 
rb
;

81 
lg_¿nge
;

83 
§
 = 42;

84 
¿
 = 
	`´ng_lg_¿nge_zu
(&
§
, 
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
), 
©omic
);

85 
§
 = 42;

86 
rb
 = 
	`´ng_lg_¿nge_zu
(&
§
, 
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
), 
©omic
);

87 
	`as£¹_zu_eq
(
¿
, 
rb
,

90 
sb
 = 42;

91 
rb
 = 
	`´ng_lg_¿nge_zu
(&
sb
, 
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
), 
©omic
);

92 
	`as£¹_zu_eq
(
¿
, 
rb
,

95 
§
 = 42;

96 
¿
 = 
	`´ng_lg_¿nge_zu
(&
§
, 
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
), 
©omic
);

97 
rb
 = 
	`´ng_lg_¿nge_zu
(&
§
, 
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
), 
©omic
);

98 
	`as£¹_zu_Ã
(
¿
, 
rb
,

101 
§
 = 42;

102 
¿
 = 
	`´ng_lg_¿nge_zu
(&
§
, 
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
), 
©omic
);

103 
lg_¿nge
 = (
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
)) - 1;†g_range > 0;

104 
lg_¿nge
--) {

105 
sb
 = 42;

106 
rb
 = 
	`´ng_lg_¿nge_zu
(&
sb
, 
lg_¿nge
, 
©omic
);

107 
	`as£¹_zu_eq
((
rb
 & (
SIZE_T_MAX
 << 
lg_¿nge
)),

108 0, "High ord” b™ should b0,†g_¿nge=%u", 
lg_¿nge
);

109 
	`as£¹_zu_eq
(
rb
, (
¿
 >> ((
	`ZU
(1è<< (3 + 
LG_SIZEOF_PTR
)) -

110 
lg_¿nge
)), "Expected high order bits of full-width "

111 "»suÉ,†g_¿nge=%u", 
lg_¿nge
);

113 
	}
}

115 
	$TEST_BEGIN
(
‹¡_´ng_lg_¿nge_u32_nÚ©omic
)

118 
	`‹¡_´ng_lg_¿nge_u32
(
çl£
);

119 
	}
}

120 
TEST_END


122 
	$TEST_BEGIN
(
‹¡_´ng_lg_¿nge_u32_©omic
)

125 
	`‹¡_´ng_lg_¿nge_u32
(
Œue
);

126 
	}
}

127 
TEST_END


129 
	$TEST_BEGIN
(
‹¡_´ng_lg_¿nge_u64_nÚ©omic
)

132 
	`‹¡_´ng_lg_¿nge_u64
();

133 
	}
}

134 
TEST_END


136 
	$TEST_BEGIN
(
‹¡_´ng_lg_¿nge_zu_nÚ©omic
)

139 
	`‹¡_´ng_lg_¿nge_zu
(
çl£
);

140 
	}
}

141 
TEST_END


143 
	$TEST_BEGIN
(
‹¡_´ng_lg_¿nge_zu_©omic
)

146 
	`‹¡_´ng_lg_¿nge_zu
(
Œue
);

147 
	}
}

148 
TEST_END


151 
	$‹¡_´ng_¿nge_u32
(
boŞ
 
©omic
)

153 
ušt32_t
 
¿nge
;

154 
	#MAX_RANGE
 10000000

	)

155 
	#RANGE_STEP
 97

	)

156 
	#NREPS
 10

	)

158 
¿nge
 = 2;„ªg< 
MAX_RANGE
;„ªg+ğ
RANGE_STEP
) {

159 
ušt32_t
 
s
;

160 
»p
;

162 
s
 = 
¿nge
;

163 
»p
 = 0;„• < 
NREPS
;„ep++) {

164 
ušt32_t
 
r
 = 
	`´ng_¿nge_u32
(&
s
, 
¿nge
, 
©omic
);

166 
	`as£¹_u32_É
(
r
, 
¿nge
, "Out of„ange");

169 
	}
}

172 
	$‹¡_´ng_¿nge_u64
()

174 
ušt64_t
 
¿nge
;

175 
	#MAX_RANGE
 10000000

	)

176 
	#RANGE_STEP
 97

	)

177 
	#NREPS
 10

	)

179 
¿nge
 = 2;„ªg< 
MAX_RANGE
;„ªg+ğ
RANGE_STEP
) {

180 
ušt64_t
 
s
;

181 
»p
;

183 
s
 = 
¿nge
;

184 
»p
 = 0;„• < 
NREPS
;„ep++) {

185 
ušt64_t
 
r
 = 
	`´ng_¿nge_u64
(&
s
, 
¿nge
);

187 
	`as£¹_u64_É
(
r
, 
¿nge
, "Out of„ange");

190 
	}
}

193 
	$‹¡_´ng_¿nge_zu
(
boŞ
 
©omic
)

195 
size_t
 
¿nge
;

196 
	#MAX_RANGE
 10000000

	)

197 
	#RANGE_STEP
 97

	)

198 
	#NREPS
 10

	)

200 
¿nge
 = 2;„ªg< 
MAX_RANGE
;„ªg+ğ
RANGE_STEP
) {

201 
size_t
 
s
;

202 
»p
;

204 
s
 = 
¿nge
;

205 
»p
 = 0;„• < 
NREPS
;„ep++) {

206 
size_t
 
r
 = 
	`´ng_¿nge_zu
(&
s
, 
¿nge
, 
©omic
);

208 
	`as£¹_zu_É
(
r
, 
¿nge
, "Out of„ange");

211 
	}
}

213 
	$TEST_BEGIN
(
‹¡_´ng_¿nge_u32_nÚ©omic
)

216 
	`‹¡_´ng_¿nge_u32
(
çl£
);

217 
	}
}

218 
TEST_END


220 
	$TEST_BEGIN
(
‹¡_´ng_¿nge_u32_©omic
)

223 
	`‹¡_´ng_¿nge_u32
(
Œue
);

224 
	}
}

225 
TEST_END


227 
	$TEST_BEGIN
(
‹¡_´ng_¿nge_u64_nÚ©omic
)

230 
	`‹¡_´ng_¿nge_u64
();

231 
	}
}

232 
TEST_END


234 
	$TEST_BEGIN
(
‹¡_´ng_¿nge_zu_nÚ©omic
)

237 
	`‹¡_´ng_¿nge_zu
(
çl£
);

238 
	}
}

239 
TEST_END


241 
	$TEST_BEGIN
(
‹¡_´ng_¿nge_zu_©omic
)

244 
	`‹¡_´ng_¿nge_zu
(
Œue
);

245 
	}
}

246 
TEST_END


249 
	$maš
()

252  (
	`‹¡
(

253 
‹¡_´ng_lg_¿nge_u32_nÚ©omic
,

254 
‹¡_´ng_lg_¿nge_u32_©omic
,

255 
‹¡_´ng_lg_¿nge_u64_nÚ©omic
,

256 
‹¡_´ng_lg_¿nge_zu_nÚ©omic
,

257 
‹¡_´ng_lg_¿nge_zu_©omic
,

258 
‹¡_´ng_¿nge_u32_nÚ©omic
,

259 
‹¡_´ng_¿nge_u32_©omic
,

260 
‹¡_´ng_¿nge_u64_nÚ©omic
,

261 
‹¡_´ng_¿nge_zu_nÚ©omic
,

262 
‹¡_´ng_¿nge_zu_©omic
));

263 
	}
}

	@deps/jemalloc/test/unit/prof_accum.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#NTHREADS
 4

	)

4 
	#NALLOCS_PER_THREAD
 50

	)

5 
	#DUMP_INTERVAL
 1

	)

6 
	#BT_COUNT_CHECK_INTERVAL
 5

	)

8 #ifdeà
JEMALLOC_PROF


9 cÚ¡ *
	gm®loc_cÚf
 =

14 
	$´of_dump_İ’_š‹rû±
(
boŞ
 
´İag©e_”r
, cÚ¡ *
f’ame
)

16 
fd
;

18 
fd
 = 
	`İ’
("/dev/nuÎ", 
O_WRONLY
);

19 
	`as£¹_d_Ã
(
fd
, -1, "Unexpected open() failure");

21  (
fd
);

22 
	}
}

25 
	$®loc_äom_³rmu‹d_backŒaû
(
thd_šd
, 
™”©iÚ
)

28  (
	`bÎoc
(1, 
thd_šd
*
NALLOCS_PER_THREAD
 + 
™”©iÚ
));

29 
	}
}

32 
	$thd_¡¬t
(*
v¬g
)

34 
thd_šd
 = *(*)
v¬g
;

35 
size_t
 
bt_couÁ_´ev
, 
bt_couÁ
;

36 
i_´ev
, 
i
;

38 
i_´ev
 = 0;

39 
bt_couÁ_´ev
 = 0;

40 
i
 = 0; i < 
NALLOCS_PER_THREAD
; i++) {

41 *
p
 = 
	`®loc_äom_³rmu‹d_backŒaû
(
thd_šd
, 
i
);

42 
	`d®locx
(
p
, 0);

43 ià(
i
 % 
DUMP_INTERVAL
 == 0) {

44 
	`as£¹_d_eq
(
	`m®lùl
("´of.dump", 
NULL
, NULL, NULL, 0),

48 ià(
i
 % 
BT_COUNT_CHECK_INTERVAL
 == 0 ||

49 
i
+1 =ğ
NALLOCS_PER_THREAD
) {

50 
bt_couÁ
 = 
	`´of_bt_couÁ
();

51 
	`as£¹_zu_Ë
(
bt_couÁ_´ev
+(
i
-
i_´ev
), 
bt_couÁ
,

53 
i_´ev
 = 
i
;

54 
bt_couÁ_´ev
 = 
bt_couÁ
;

58  (
NULL
);

59 
	}
}

61 
	$TEST_BEGIN
(
‹¡_idump
)

63 
boŞ
 
aùive
;

64 
thd_t
 
thds
[
NTHREADS
];

65 
thd_¬gs
[
NTHREADS
];

66 
i
;

68 
	`‹¡_sk_if
(!
cÚfig_´of
);

70 
aùive
 = 
Œue
;

71 
	`as£¹_d_eq
(
	`m®lùl
("´of.aùive", 
NULL
, NULL, (*)&
aùive
,

72 (
aùive
)), 0,

75 
´of_dump_İ’
 = 
´of_dump_İ’_š‹rû±
;

77 
i
 = 0; i < 
NTHREADS
; i++) {

78 
thd_¬gs
[
i
] = i;

79 
	`thd_ü—‹
(&
thds
[
i
], 
thd_¡¬t
, (*)&
thd_¬gs
[i]);

81 
i
 = 0; i < 
NTHREADS
; i++)

82 
	`thd_još
(
thds
[
i
], 
NULL
);

83 
	}
}

84 
TEST_END


87 
	$maš
()

90  (
	`‹¡
(

91 
‹¡_idump
));

92 
	}
}

	@deps/jemalloc/test/unit/prof_active.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_PROF


4 cÚ¡ *
	gm®loc_cÚf
 =

9 
	$m®lùl_boŞ_g‘
(cÚ¡ *
Çme
, 
boŞ
 
ex³ùed
, cÚ¡ *
func
, 
lše
)

11 
boŞ
 
Şd
;

12 
size_t
 
sz
;

14 
sz
 = (
Şd
);

15 
	`as£¹_d_eq
(
	`m®lùl
(
Çme
, (*)&
Şd
, &
sz
, 
NULL
, 0), 0,

16 "%s():%d: UÃx³ùed m®lùÈçu»„—dšg %s", 
func
, 
lše
, 
Çme
);

17 
	`as£¹_b_eq
(
Şd
, 
ex³ùed
, "%s():%d: UÃx³ùed % v®ue", 
func
, 
lše
,

18 
Çme
);

19 
	}
}

22 
	$m®lùl_boŞ_£t
(cÚ¡ *
Çme
, 
boŞ
 
Şd_ex³ùed
, boŞ 
v®_Ãw
,

23 cÚ¡ *
func
, 
lše
)

25 
boŞ
 
Şd
;

26 
size_t
 
sz
;

28 
sz
 = (
Şd
);

29 
	`as£¹_d_eq
(
	`m®lùl
(
Çme
, (*)&
Şd
, &
sz
, (*)&
v®_Ãw
,

30 (
v®_Ãw
)), 0,

31 "%s():%d: UÃx³ùed m®lùÈçu»„—dšg/wr™šg %s", 
func
,

32 
lše
, 
Çme
);

33 
	`as£¹_b_eq
(
Şd
, 
Şd_ex³ùed
, "%s():%d: UÃx³ùed % v®ue", 
func
,

34 
lše
, 
Çme
);

35 
	}
}

38 
	$m®lùl_´of_aùive_g‘_im¶
(
boŞ
 
´of_aùive_Şd_ex³ùed
, cÚ¡ *
func
,

39 
lše
)

42 
	`m®lùl_boŞ_g‘
("´of.aùive", 
´of_aùive_Şd_ex³ùed
, 
func
, 
lše
);

43 
	}
}

44 
	#m®lùl_´of_aùive_g‘
(
a
) \

45 
	`m®lùl_´of_aùive_g‘_im¶
(
a
, 
__func__
, 
__LINE__
)

	)

48 
	$m®lùl_´of_aùive_£t_im¶
(
boŞ
 
´of_aùive_Şd_ex³ùed
,

49 
boŞ
 
´of_aùive_Ãw
, cÚ¡ *
func
, 
lše
)

52 
	`m®lùl_boŞ_£t
("´of.aùive", 
´of_aùive_Şd_ex³ùed
,

53 
´of_aùive_Ãw
, 
func
, 
lše
);

54 
	}
}

55 
	#m®lùl_´of_aùive_£t
(
a
, 
b
) \

56 
	`m®lùl_´of_aùive_£t_im¶
(
a
, 
b
, 
__func__
, 
__LINE__
)

	)

59 
	$m®lùl_th»ad_´of_aùive_g‘_im¶
(
boŞ
 
th»ad_´of_aùive_Şd_ex³ùed
,

60 cÚ¡ *
func
, 
lše
)

63 
	`m®lùl_boŞ_g‘
("th»ad.´of.aùive", 
th»ad_´of_aùive_Şd_ex³ùed
,

64 
func
, 
lše
);

65 
	}
}

66 
	#m®lùl_th»ad_´of_aùive_g‘
(
a
) \

67 
	`m®lùl_th»ad_´of_aùive_g‘_im¶
(
a
, 
__func__
, 
__LINE__
)

	)

70 
	$m®lùl_th»ad_´of_aùive_£t_im¶
(
boŞ
 
th»ad_´of_aùive_Şd_ex³ùed
,

71 
boŞ
 
th»ad_´of_aùive_Ãw
, cÚ¡ *
func
, 
lše
)

74 
	`m®lùl_boŞ_£t
("th»ad.´of.aùive", 
th»ad_´of_aùive_Şd_ex³ùed
,

75 
th»ad_´of_aùive_Ãw
, 
func
, 
lše
);

76 
	}
}

77 
	#m®lùl_th»ad_´of_aùive_£t
(
a
, 
b
) \

78 
	`m®lùl_th»ad_´of_aùive_£t_im¶
(
a
, 
b
, 
__func__
, 
__LINE__
)

	)

81 
	$´of_§m¶šg_´obe_im¶
(
boŞ
 
ex³ù_§m¶e
, cÚ¡ *
func
, 
lše
)

83 *
p
;

84 
size_t
 
ex³ùed_backŒaûs
 = 
ex³ù_§m¶e
 ? 1 : 0;

86 
	`as£¹_zu_eq
(
	`´of_bt_couÁ
(), 0, "%s():%d: Ex³ùed 0 backŒaûs", 
func
,

87 
lše
);

88 
p
 = 
	`m®locx
(1, 0);

89 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

90 
	`as£¹_zu_eq
(
	`´of_bt_couÁ
(), 
ex³ùed_backŒaûs
,

91 "%s():%d: UÃx³ùed backŒaû couÁ", 
func
, 
lše
);

92 
	`d®locx
(
p
, 0);

93 
	}
}

94 
	#´of_§m¶šg_´obe
(
a
) \

95 
	`´of_§m¶šg_´obe_im¶
(
a
, 
__func__
, 
__LINE__
)

	)

97 
	$TEST_BEGIN
(
‹¡_´of_aùive
)

100 
	`‹¡_sk_if
(!
cÚfig_´of
);

102 
	`m®lùl_´of_aùive_g‘
(
Œue
);

103 
	`m®lùl_th»ad_´of_aùive_g‘
(
çl£
);

105 
	`m®lùl_´of_aùive_£t
(
Œue
,rue);

106 
	`m®lùl_th»ad_´of_aùive_£t
(
çl£
, false);

108 
	`´of_§m¶šg_´obe
(
çl£
);

110 
	`m®lùl_´of_aùive_£t
(
Œue
, 
çl£
);

111 
	`m®lùl_th»ad_´of_aùive_£t
(
çl£
, false);

113 
	`´of_§m¶šg_´obe
(
çl£
);

115 
	`m®lùl_´of_aùive_£t
(
çl£
, false);

116 
	`m®lùl_th»ad_´of_aùive_£t
(
çl£
, 
Œue
);

118 
	`´of_§m¶šg_´obe
(
çl£
);

120 
	`m®lùl_´of_aùive_£t
(
çl£
, 
Œue
);

121 
	`m®lùl_th»ad_´of_aùive_£t
(
Œue
,rue);

123 
	`´of_§m¶šg_´obe
(
Œue
);

126 
	`m®lùl_´of_aùive_£t
(
Œue
,rue);

127 
	`m®lùl_th»ad_´of_aùive_£t
(
Œue
, 
çl£
);

128 
	}
}

129 
TEST_END


132 
	$maš
()

135  (
	`‹¡
(

136 
‹¡_´of_aùive
));

137 
	}
}

	@deps/jemalloc/test/unit/prof_gdump.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_PROF


4 cÚ¡ *
	gm®loc_cÚf
 = "prof:true,prof_active:false,prof_gdump:true";

7 
boŞ
 
	gdid_´of_dump_İ’
;

10 
	$´of_dump_İ’_š‹rû±
(
boŞ
 
´İag©e_”r
, cÚ¡ *
f’ame
)

12 
fd
;

14 
did_´of_dump_İ’
 = 
Œue
;

16 
fd
 = 
	`İ’
("/dev/nuÎ", 
O_WRONLY
);

17 
	`as£¹_d_Ã
(
fd
, -1, "Unexpected open() failure");

19  (
fd
);

20 
	}
}

22 
	$TEST_BEGIN
(
‹¡_gdump
)

24 
boŞ
 
aùive
, 
gdump
, 
gdump_Şd
;

25 *
p
, *
q
, *
r
, *
s
;

26 
size_t
 
sz
;

28 
	`‹¡_sk_if
(!
cÚfig_´of
);

30 
aùive
 = 
Œue
;

31 
	`as£¹_d_eq
(
	`m®lùl
("´of.aùive", 
NULL
, NULL, (*)&
aùive
,

32 (
aùive
)), 0,

35 
´of_dump_İ’
 = 
´of_dump_İ’_š‹rû±
;

37 
did_´of_dump_İ’
 = 
çl£
;

38 
p
 = 
	`m®locx
(
chunksize
, 0);

39 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

40 
	`as£¹_Œue
(
did_´of_dump_İ’
, "Expected‡…rofile dump");

42 
did_´of_dump_İ’
 = 
çl£
;

43 
q
 = 
	`m®locx
(
chunksize
, 0);

44 
	`as£¹_±r_nÙ_nuÎ
(
q
, "Unexpected mallocx() failure");

45 
	`as£¹_Œue
(
did_´of_dump_İ’
, "Expected‡…rofile dump");

47 
gdump
 = 
çl£
;

48 
sz
 = (
gdump_Şd
);

49 
	`as£¹_d_eq
(
	`m®lùl
("´of.gdump", (*)&
gdump_Şd
, &
sz
,

50 (*)&
gdump
, (gdump)), 0,

52 
	`as£¹
(
gdump_Şd
);

53 
did_´of_dump_İ’
 = 
çl£
;

54 
r
 = 
	`m®locx
(
chunksize
, 0);

55 
	`as£¹_±r_nÙ_nuÎ
(
q
, "Unexpected mallocx() failure");

56 
	`as£¹_çl£
(
did_´of_dump_İ’
, "Unexpected…rofile dump");

58 
gdump
 = 
Œue
;

59 
sz
 = (
gdump_Şd
);

60 
	`as£¹_d_eq
(
	`m®lùl
("´of.gdump", (*)&
gdump_Şd
, &
sz
,

61 (*)&
gdump
, (gdump)), 0,

63 
	`as£¹
(!
gdump_Şd
);

64 
did_´of_dump_İ’
 = 
çl£
;

65 
s
 = 
	`m®locx
(
chunksize
, 0);

66 
	`as£¹_±r_nÙ_nuÎ
(
q
, "Unexpected mallocx() failure");

67 
	`as£¹_Œue
(
did_´of_dump_İ’
, "Expected‡…rofile dump");

69 
	`d®locx
(
p
, 0);

70 
	`d®locx
(
q
, 0);

71 
	`d®locx
(
r
, 0);

72 
	`d®locx
(
s
, 0);

73 
	}
}

74 
TEST_END


77 
	$maš
()

80  (
	`‹¡
(

81 
‹¡_gdump
));

82 
	}
}

	@deps/jemalloc/test/unit/prof_idump.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_PROF


4 cÚ¡ *
	gm®loc_cÚf
 =

9 
boŞ
 
	gdid_´of_dump_İ’
;

12 
	$´of_dump_İ’_š‹rû±
(
boŞ
 
´İag©e_”r
, cÚ¡ *
f’ame
)

14 
fd
;

16 
did_´of_dump_İ’
 = 
Œue
;

18 
fd
 = 
	`İ’
("/dev/nuÎ", 
O_WRONLY
);

19 
	`as£¹_d_Ã
(
fd
, -1, "Unexpected open() failure");

21  (
fd
);

22 
	}
}

24 
	$TEST_BEGIN
(
‹¡_idump
)

26 
boŞ
 
aùive
;

27 *
p
;

29 
	`‹¡_sk_if
(!
cÚfig_´of
);

31 
aùive
 = 
Œue
;

32 
	`as£¹_d_eq
(
	`m®lùl
("´of.aùive", 
NULL
, NULL, (*)&
aùive
,

33 (
aùive
)), 0,

36 
´of_dump_İ’
 = 
´of_dump_İ’_š‹rû±
;

38 
did_´of_dump_İ’
 = 
çl£
;

39 
p
 = 
	`m®locx
(1, 0);

40 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

41 
	`d®locx
(
p
, 0);

42 
	`as£¹_Œue
(
did_´of_dump_İ’
, "Expected‡…rofile dump");

43 
	}
}

44 
TEST_END


47 
	$maš
()

50  (
	`‹¡
(

51 
‹¡_idump
));

52 
	}
}

	@deps/jemalloc/test/unit/prof_reset.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_PROF


4 cÚ¡ *
	gm®loc_cÚf
 =

9 
	$´of_dump_İ’_š‹rû±
(
boŞ
 
´İag©e_”r
, cÚ¡ *
f’ame
)

11 
fd
;

13 
fd
 = 
	`İ’
("/dev/nuÎ", 
O_WRONLY
);

14 
	`as£¹_d_Ã
(
fd
, -1, "Unexpected open() failure");

16  (
fd
);

17 
	}
}

20 
	$£t_´of_aùive
(
boŞ
 
aùive
)

23 
	`as£¹_d_eq
(
	`m®lùl
("´of.aùive", 
NULL
, NULL, (*)&
aùive
,

24 (
aùive
)), 0, "Unexpected mallctl failure");

25 
	}
}

27 
size_t


28 
	$g‘_lg_´of_§m¶e
()

30 
size_t
 
lg_´of_§m¶e
;

31 
size_t
 
sz
 = (size_t);

33 
	`as£¹_d_eq
(
	`m®lùl
("´of.lg_§m¶e", (*)&
lg_´of_§m¶e
, &
sz
,

34 
NULL
, 0), 0,

36  (
lg_´of_§m¶e
);

37 
	}
}

40 
	$do_´of_»£t
(
size_t
 
lg_´of_§m¶e
)

42 
	`as£¹_d_eq
(
	`m®lùl
("´of.»£t", 
NULL
, NULL,

43 (*)&
lg_´of_§m¶e
, (
size_t
)), 0,

45 
	`as£¹_zu_eq
(
lg_´of_§m¶e
, 
	`g‘_lg_´of_§m¶e
(),

47 
	}
}

49 
	$TEST_BEGIN
(
‹¡_´of_»£t_basic
)

51 
size_t
 
lg_´of_§m¶e_Üig
, 
lg_´of_§m¶e
, 
lg_´of_§m¶e_Ãxt
;

52 
size_t
 
sz
;

53 
i
;

55 
	`‹¡_sk_if
(!
cÚfig_´of
);

57 
sz
 = (
size_t
);

58 
	`as£¹_d_eq
(
	`m®lùl
("İt.lg_´of_§m¶e", (*)&
lg_´of_§m¶e_Üig
,

59 &
sz
, 
NULL
, 0), 0,

61 
	`as£¹_zu_eq
(
lg_´of_§m¶e_Üig
, 0,

63 
lg_´of_§m¶e
 = 
	`g‘_lg_´of_§m¶e
();

64 
	`as£¹_zu_eq
(
lg_´of_§m¶e_Üig
, 
lg_´of_§m¶e
,

69 
i
 = 0; i < 2; i++) {

70 
	`as£¹_d_eq
(
	`m®lùl
("´of.»£t", 
NULL
, NULL, NULL, 0), 0,

72 
lg_´of_§m¶e
 = 
	`g‘_lg_´of_§m¶e
();

73 
	`as£¹_zu_eq
(
lg_´of_§m¶e_Üig
, 
lg_´of_§m¶e
,

78 
lg_´of_§m¶e_Ãxt
 = 1;

79 
i
 = 0; i < 2; i++) {

80 
	`do_´of_»£t
(
lg_´of_§m¶e_Ãxt
);

81 
lg_´of_§m¶e
 = 
	`g‘_lg_´of_§m¶e
();

82 
	`as£¹_zu_eq
(
lg_´of_§m¶e
, 
lg_´of_§m¶e_Ãxt
,

84 
lg_´of_§m¶e_Ãxt
 = 
lg_´of_§m¶e_Üig
;

88 
lg_´of_§m¶e
 = 
	`g‘_lg_´of_§m¶e
();

89 
	`as£¹_zu_eq
(
lg_´of_§m¶e_Üig
, 
lg_´of_§m¶e
,

92 
	}
}

93 
TEST_END


95 
boŞ
 
	g´of_dump_h—d”_š‹rû±ed
 = 
çl£
;

96 
´of_út_t
 
	gút_®l_cİy
 = {0, 0, 0, 0};

97 
boŞ


98 
	$´of_dump_h—d”_š‹rû±
(
tsdn_t
 *
tsdn
, 
boŞ
 
´İag©e_”r
,

99 cÚ¡ 
´of_út_t
 *
út_®l
)

102 
´of_dump_h—d”_š‹rû±ed
 = 
Œue
;

103 
	`memıy
(&
út_®l_cİy
, 
út_®l
, (
´of_út_t
));

105  (
çl£
);

106 
	}
}

108 
	$TEST_BEGIN
(
‹¡_´of_»£t_ş—nup
)

110 *
p
;

111 
´of_dump_h—d”_t
 *
´of_dump_h—d”_Üig
;

113 
	`‹¡_sk_if
(!
cÚfig_´of
);

115 
	`£t_´of_aùive
(
Œue
);

117 
	`as£¹_zu_eq
(
	`´of_bt_couÁ
(), 0, "Expected 0 backtraces");

118 
p
 = 
	`m®locx
(1, 0);

119 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

120 
	`as£¹_zu_eq
(
	`´of_bt_couÁ
(), 1, "Expected 1 backtrace");

122 
´of_dump_h—d”_Üig
 = 
´of_dump_h—d”
;

123 
´of_dump_h—d”
 = 
´of_dump_h—d”_š‹rû±
;

124 
	`as£¹_çl£
(
´of_dump_h—d”_š‹rû±ed
, "Unexpected intercept");

126 
	`as£¹_d_eq
(
	`m®lùl
("´of.dump", 
NULL
, NULL, NULL, 0),

128 
	`as£¹_Œue
(
´of_dump_h—d”_š‹rû±ed
, "Expected intercept");

129 
	`as£¹_u64_eq
(
út_®l_cİy
.
curobjs
, 1, "Expected 1‡llocation");

131 
	`as£¹_d_eq
(
	`m®lùl
("´of.»£t", 
NULL
, NULL, NULL, 0), 0,

133 
	`as£¹_d_eq
(
	`m®lùl
("´of.dump", 
NULL
, NULL, NULL, 0),

135 
	`as£¹_u64_eq
(
út_®l_cİy
.
curobjs
, 0, "Expected 0‡llocations");

136 
	`as£¹_zu_eq
(
	`´of_bt_couÁ
(), 1, "Expected 1 backtrace");

138 
´of_dump_h—d”
 = 
´of_dump_h—d”_Üig
;

140 
	`d®locx
(
p
, 0);

141 
	`as£¹_zu_eq
(
	`´of_bt_couÁ
(), 0, "Expected 0 backtraces");

143 
	`£t_´of_aùive
(
çl£
);

144 
	}
}

145 
	gTEST_END


147 
	#NTHREADS
 4

	)

148 
	#NALLOCS_PER_THREAD
 (1U << 13)

	)

149 
	#OBJ_RING_BUF_COUNT
 1531

	)

150 
	#RESET_INTERVAL
 (1U << 10)

	)

151 
	#DUMP_INTERVAL
 3677

	)

153 
	$thd_¡¬t
(*
v¬g
)

155 
thd_šd
 = *(*)
v¬g
;

156 
i
;

157 *
objs
[
OBJ_RING_BUF_COUNT
];

159 
	`mem£t
(
objs
, 0, (objs));

161 
i
 = 0; i < 
NALLOCS_PER_THREAD
; i++) {

162 ià(
i
 % 
RESET_INTERVAL
 == 0) {

163 
	`as£¹_d_eq
(
	`m®lùl
("´of.»£t", 
NULL
, NULL, NULL, 0),

168 ià(
i
 % 
DUMP_INTERVAL
 == 0) {

169 
	`as£¹_d_eq
(
	`m®lùl
("´of.dump", 
NULL
, NULL, NULL, 0),

174 **
µ
 = &
objs
[
i
 % 
OBJ_RING_BUF_COUNT
];

175 ià(*
µ
 !ğ
NULL
) {

176 
	`d®locx
(*
µ
, 0);

177 *
µ
 = 
NULL
;

179 *
µ
 = 
	`bÎoc
(1, 
thd_šd
*
NALLOCS_PER_THREAD
 + 
i
);

180 
	`as£¹_±r_nÙ_nuÎ
(*
µ
,

186 
i
 = 0; i < 
OBJ_RING_BUF_COUNT
; i++) {

187 **
µ
 = &
objs
[
i
 % 
OBJ_RING_BUF_COUNT
];

188 ià(*
µ
 !ğ
NULL
) {

189 
	`d®locx
(*
µ
, 0);

190 *
µ
 = 
NULL
;

194  (
NULL
);

195 
	}
}

197 
	$TEST_BEGIN
(
‹¡_´of_»£t
)

199 
size_t
 
lg_´of_§m¶e_Üig
;

200 
thd_t
 
thds
[
NTHREADS
];

201 
thd_¬gs
[
NTHREADS
];

202 
i
;

203 
size_t
 
bt_couÁ
, 
td©a_couÁ
;

205 
	`‹¡_sk_if
(!
cÚfig_´of
);

207 
bt_couÁ
 = 
	`´of_bt_couÁ
();

208 
	`as£¹_zu_eq
(
bt_couÁ
, 0,

210 
td©a_couÁ
 = 
	`´of_td©a_couÁ
();

212 
lg_´of_§m¶e_Üig
 = 
	`g‘_lg_´of_§m¶e
();

213 
	`do_´of_»£t
(5);

215 
	`£t_´of_aùive
(
Œue
);

217 
i
 = 0; i < 
NTHREADS
; i++) {

218 
thd_¬gs
[
i
] = i;

219 
	`thd_ü—‹
(&
thds
[
i
], 
thd_¡¬t
, (*)&
thd_¬gs
[i]);

221 
i
 = 0; i < 
NTHREADS
; i++)

222 
	`thd_još
(
thds
[
i
], 
NULL
);

224 
	`as£¹_zu_eq
(
	`´of_bt_couÁ
(), 
bt_couÁ
,

226 
	`as£¹_zu_eq
(
	`´of_td©a_couÁ
(), 
td©a_couÁ
,

229 
	`£t_´of_aùive
(
çl£
);

231 
	`do_´of_»£t
(
lg_´of_§m¶e_Üig
);

232 
	}
}

233 
	gTEST_END


234 #undeà
NTHREADS


235 #undeà
NALLOCS_PER_THREAD


236 #undeà
OBJ_RING_BUF_COUNT


237 #undeà
RESET_INTERVAL


238 #undeà
DUMP_INTERVAL


241 
	#NITER
 10

	)

242 
	$TEST_BEGIN
(
‹¡_x®locx
)

244 
size_t
 
lg_´of_§m¶e_Üig
;

245 
i
;

246 *
±rs
[
NITER
];

248 
	`‹¡_sk_if
(!
cÚfig_´of
);

250 
lg_´of_§m¶e_Üig
 = 
	`g‘_lg_´of_§m¶e
();

251 
	`£t_´of_aùive
(
Œue
);

254 
	`do_´of_»£t
(0);

256 
i
 = 0; i < 
NITER
; i++) {

257 *
p
;

258 
size_t
 
sz
, 
nsz
;

261 
	`do_´of_»£t
(0);

264 
p
 = 
±rs
[
i
] = 
	`m®locx
(1, 0);

265 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

268 
	`do_´of_»£t
(0);

271 
sz
 = 
	`§Îocx
(
p
, 0);

272 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
sz
, 0, 0), sz,

276 
nsz
 = 
	`ÇÎocx
(
sz
+1, 0);

277 
	`as£¹_zu_eq
(
	`x®locx
(
p
, 
nsz
, 0, 0), 
sz
,

281 
i
 = 0; i < 
NITER
; i++) {

283 
	`d®locx
(
±rs
[
i
], 0);

286 
	`£t_´of_aùive
(
çl£
);

287 
	`do_´of_»£t
(
lg_´of_§m¶e_Üig
);

288 
	}
}

289 
	gTEST_END


290 #undeà
NITER


293 
	$maš
()

297 
´of_dump_İ’
 = 
´of_dump_İ’_š‹rû±
;

299  (
	`‹¡
(

300 
‹¡_´of_»£t_basic
,

301 
‹¡_´of_»£t_ş—nup
,

302 
‹¡_´of_»£t
,

303 
‹¡_x®locx
));

304 
	}
}

	@deps/jemalloc/test/unit/prof_thread_name.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_PROF


4 cÚ¡ *
	gm®loc_cÚf
 = "prof:true,prof_active:false";

8 
	$m®lùl_th»ad_Çme_g‘_im¶
(cÚ¡ *
th»ad_Çme_ex³ùed
, cÚ¡ *
func
,

9 
lše
)

11 cÚ¡ *
th»ad_Çme_Şd
;

12 
size_t
 
sz
;

14 
sz
 = (
th»ad_Çme_Şd
);

15 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.´of.Çme", (*)&
th»ad_Çme_Şd
, &
sz
,

16 
NULL
, 0), 0,

18 
func
, 
lše
);

19 
	`as£¹_¡r_eq
(
th»ad_Çme_Şd
, 
th»ad_Çme_ex³ùed
,

20 "%s():%d: UÃx³ùedh»ad.´of.Çmv®ue", 
func
, 
lše
);

21 
	}
}

22 
	#m®lùl_th»ad_Çme_g‘
(
a
) \

23 
	`m®lùl_th»ad_Çme_g‘_im¶
(
a
, 
__func__
, 
__LINE__
)

	)

26 
	$m®lùl_th»ad_Çme_£t_im¶
(cÚ¡ *
th»ad_Çme
, cÚ¡ *
func
,

27 
lše
)

30 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.´of.Çme", 
NULL
, NULL,

31 (*)&
th»ad_Çme
, (thread_name)), 0,

33 
func
, 
lše
);

34 
	`m®lùl_th»ad_Çme_g‘_im¶
(
th»ad_Çme
, 
func
, 
lše
);

35 
	}
}

36 
	#m®lùl_th»ad_Çme_£t
(
a
) \

37 
	`m®lùl_th»ad_Çme_£t_im¶
(
a
, 
__func__
, 
__LINE__
)

	)

39 
	$TEST_BEGIN
(
‹¡_´of_th»ad_Çme_v®id©iÚ
)

41 cÚ¡ *
th»ad_Çme
;

43 
	`‹¡_sk_if
(!
cÚfig_´of
);

45 
	`m®lùl_th»ad_Çme_g‘
("");

46 
	`m®lùl_th»ad_Çme_£t
("hihere");

49 
th»ad_Çme
 = 
NULL
;

50 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.´of.Çme", 
NULL
, NULL,

51 (*)&
th»ad_Çme
, Ñh»ad_Çme)), 
EFAULT
,

53 
th»ad_Çme
);

56 
th»ad_Çme
 = "hi\nthere";

57 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.´of.Çme", 
NULL
, NULL,

58 (*)&
th»ad_Çme
, Ñh»ad_Çme)), 
EFAULT
,

60 
th»ad_Çme
);

64 cÚ¡ *
th»ad_Çme_Şd
;

65 
size_t
 
sz
;

67 
sz
 = (
th»ad_Çme_Şd
);

68 
	`as£¹_d_eq
(
	`m®lùl
("thread.prof.name",

69 (*)&
th»ad_Çme_Şd
, &
sz
, (*)&
th»ad_Çme
,

70 (
th»ad_Çme
)), 
EPERM
,

72 "th»ad.´of.Çme", 
th»ad_Çme
);

75 
	`m®lùl_th»ad_Çme_£t
("");

76 
	}
}

77 
	gTEST_END


79 
	#NTHREADS
 4

	)

80 
	#NRESET
 25

	)

82 
	$thd_¡¬t
(*
v¬g
)

84 
thd_šd
 = *(*)
v¬g
;

85 
th»ad_Çme
[16] = "";

86 
i
;

88 
	`m®loc_¢´štf
(
th»ad_Çme
, Ñh»ad_Çme), "th»ad %u", 
thd_šd
);

90 
	`m®lùl_th»ad_Çme_g‘
("");

91 
	`m®lùl_th»ad_Çme_£t
(
th»ad_Çme
);

93 
i
 = 0; i < 
NRESET
; i++) {

94 
	`as£¹_d_eq
(
	`m®lùl
("´of.»£t", 
NULL
, NULL, NULL, 0), 0,

96 
	`m®lùl_th»ad_Çme_g‘
(
th»ad_Çme
);

99 
	`m®lùl_th»ad_Çme_£t
(
th»ad_Çme
);

100 
	`m®lùl_th»ad_Çme_£t
("");

102  (
NULL
);

103 
	}
}

105 
	$TEST_BEGIN
(
‹¡_´of_th»ad_Çme_th»aded
)

107 
thd_t
 
thds
[
NTHREADS
];

108 
thd_¬gs
[
NTHREADS
];

109 
i
;

111 
	`‹¡_sk_if
(!
cÚfig_´of
);

113 
i
 = 0; i < 
NTHREADS
; i++) {

114 
thd_¬gs
[
i
] = i;

115 
	`thd_ü—‹
(&
thds
[
i
], 
thd_¡¬t
, (*)&
thd_¬gs
[i]);

117 
i
 = 0; i < 
NTHREADS
; i++)

118 
	`thd_još
(
thds
[
i
], 
NULL
);

119 
	}
}

120 
	gTEST_END


121 #undeà
NTHREADS


122 #undeà
NRESET


125 
	$maš
()

128  (
	`‹¡
(

129 
‹¡_´of_th»ad_Çme_v®id©iÚ
,

130 
‹¡_´of_th»ad_Çme_th»aded
));

131 
	}
}

	@deps/jemalloc/test/unit/ql.c

1 
	~"‹¡/jem®loc_‹¡.h
"

4 
	#NENTRIES
 9

	)

6 
li¡_s
 
	tli¡_t
;

7 
	$ql_h—d
(
	tli¡_t
è
	tli¡_h—d_t
;

9 
	sli¡_s
 {

10 
	`ql_–m
(
li¡_t
è
lšk
;

11 
id
;

15 
	$‹¡_em±y_li¡
(
li¡_h—d_t
 *
h—d
)

17 
li¡_t
 *
t
;

18 
i
;

20 
	`as£¹_±r_nuÎ
(
	`ql_fœ¡
(
h—d
), "Unexpectedƒlement forƒmpty†ist");

21 
	`as£¹_±r_nuÎ
(
	`ql_Ï¡
(
h—d
, 
lšk
),

24 
i
 = 0;

25 
	`ql_fÜ—ch
(
t
, 
h—d
, 
lšk
) {

26 
i
++;

28 
	`as£¹_u_eq
(
i
, 0, "Unexpectedƒlement forƒmpty†ist");

30 
i
 = 0;

31 
	`ql_»v”£_fÜ—ch
(
t
, 
h—d
, 
lšk
) {

32 
i
++;

34 
	`as£¹_u_eq
(
i
, 0, "Unexpectedƒlement forƒmpty†ist");

35 
	}
}

37 
	$TEST_BEGIN
(
‹¡_ql_em±y
)

39 
li¡_h—d_t
 
h—d
;

41 
	`ql_Ãw
(&
h—d
);

42 
	`‹¡_em±y_li¡
(&
h—d
);

43 
	}
}

44 
TEST_END


47 
	$š™_’Œ›s
(
li¡_t
 *
’Œ›s
, 
ÃÁr›s
)

49 
i
;

51 
i
 = 0; i < 
ÃÁr›s
; i++) {

52 
’Œ›s
[
i
].
id
 = 'a' + i;

53 
	`ql_–m_Ãw
(&
’Œ›s
[
i
], 
lšk
);

55 
	}
}

58 
	$‹¡_’Œ›s_li¡
(
li¡_h—d_t
 *
h—d
, 
li¡_t
 *
’Œ›s
, 
ÃÁr›s
)

60 
li¡_t
 *
t
;

61 
i
;

63 
	`as£¹_c_eq
(
	`ql_fœ¡
(
h—d
)->
id
, 
’Œ›s
[0].id, "Element id mismatch");

64 
	`as£¹_c_eq
(
	`ql_Ï¡
(
h—d
, 
lšk
)->
id
, 
’Œ›s
[
ÃÁr›s
-1].id,

67 
i
 = 0;

68 
	`ql_fÜ—ch
(
t
, 
h—d
, 
lšk
) {

69 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[
i
].id, "Element id mismatch");

70 
i
++;

73 
i
 = 0;

74 
	`ql_»v”£_fÜ—ch
(
t
, 
h—d
, 
lšk
) {

75 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[
ÃÁr›s
-
i
-1].id,

77 
i
++;

80 
i
 = 0; i < 
ÃÁr›s
-1; i++) {

81 
t
 = 
	`ql_Ãxt
(
h—d
, &
’Œ›s
[
i
], 
lšk
);

82 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[
i
+1].id, "Element id mismatch");

84 
	`as£¹_±r_nuÎ
(
	`ql_Ãxt
(
h—d
, &
’Œ›s
[
ÃÁr›s
-1], 
lšk
),

87 
	`as£¹_±r_nuÎ
(
	`ql_´ev
(
h—d
, &
’Œ›s
[0], 
lšk
), "Unexpectedƒlement");

88 
i
 = 1; i < 
ÃÁr›s
; i++) {

89 
t
 = 
	`ql_´ev
(
h—d
, &
’Œ›s
[
i
], 
lšk
);

90 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[
i
-1].id, "Element id mismatch");

92 
	}
}

94 
	$TEST_BEGIN
(
‹¡_ql__š£¹
)

96 
li¡_h—d_t
 
h—d
;

97 
li¡_t
 
’Œ›s
[
NENTRIES
];

98 
i
;

100 
	`ql_Ãw
(&
h—d
);

101 
	`š™_’Œ›s
(
’Œ›s
, ÓÁr›s)/(
li¡_t
));

102 
i
 = 0; i < 
NENTRIES
; i++)

103 
	`ql__š£¹
(&
h—d
, &
’Œ›s
[
i
], 
lšk
);

105 
	`‹¡_’Œ›s_li¡
(&
h—d
, 
’Œ›s
, 
NENTRIES
);

106 
	}
}

107 
TEST_END


109 
	$TEST_BEGIN
(
‹¡_ql__»move
)

111 
li¡_h—d_t
 
h—d
;

112 
li¡_t
 
’Œ›s
[
NENTRIES
];

113 
i
;

115 
	`ql_Ãw
(&
h—d
);

116 
	`š™_’Œ›s
(
’Œ›s
, ÓÁr›s)/(
li¡_t
));

117 
i
 = 0; i < 
NENTRIES
; i++)

118 
	`ql__š£¹
(&
h—d
, &
’Œ›s
[
i
], 
lšk
);

120 
i
 = 0; i < 
NENTRIES
; i++) {

121 
	`‹¡_’Œ›s_li¡
(&
h—d
, 
’Œ›s
, 
NENTRIES
-
i
);

122 
	`ql__»move
(&
h—d
, 
li¡_t
, 
lšk
);

124 
	`‹¡_em±y_li¡
(&
h—d
);

125 
	}
}

126 
TEST_END


128 
	$TEST_BEGIN
(
‹¡_ql_h—d_š£¹
)

130 
li¡_h—d_t
 
h—d
;

131 
li¡_t
 
’Œ›s
[
NENTRIES
];

132 
i
;

134 
	`ql_Ãw
(&
h—d
);

135 
	`š™_’Œ›s
(
’Œ›s
, ÓÁr›s)/(
li¡_t
));

136 
i
 = 0; i < 
NENTRIES
; i++)

137 
	`ql_h—d_š£¹
(&
h—d
, &
’Œ›s
[
NENTRIES
-
i
-1], 
lšk
);

139 
	`‹¡_’Œ›s_li¡
(&
h—d
, 
’Œ›s
, 
NENTRIES
);

140 
	}
}

141 
TEST_END


143 
	$TEST_BEGIN
(
‹¡_ql_h—d_»move
)

145 
li¡_h—d_t
 
h—d
;

146 
li¡_t
 
’Œ›s
[
NENTRIES
];

147 
i
;

149 
	`ql_Ãw
(&
h—d
);

150 
	`š™_’Œ›s
(
’Œ›s
, ÓÁr›s)/(
li¡_t
));

151 
i
 = 0; i < 
NENTRIES
; i++)

152 
	`ql_h—d_š£¹
(&
h—d
, &
’Œ›s
[
NENTRIES
-
i
-1], 
lšk
);

154 
i
 = 0; i < 
NENTRIES
; i++) {

155 
	`‹¡_’Œ›s_li¡
(&
h—d
, &
’Œ›s
[
i
], 
NENTRIES
-i);

156 
	`ql_h—d_»move
(&
h—d
, 
li¡_t
, 
lšk
);

158 
	`‹¡_em±y_li¡
(&
h—d
);

159 
	}
}

160 
TEST_END


162 
	$TEST_BEGIN
(
‹¡_ql_š£¹
)

164 
li¡_h—d_t
 
h—d
;

165 
li¡_t
 
’Œ›s
[8];

166 
li¡_t
 *
a
, *
b
, *
c
, *
d
, *
e
, *
f
, *
g
, *
h
;

168 
	`ql_Ãw
(&
h—d
);

169 
	`š™_’Œ›s
(
’Œ›s
, ÓÁr›s)/(
li¡_t
));

170 
a
 = &
’Œ›s
[0];

171 
b
 = &
’Œ›s
[1];

172 
c
 = &
’Œ›s
[2];

173 
d
 = &
’Œ›s
[3];

174 
e
 = &
’Œ›s
[4];

175 
f
 = &
’Œ›s
[5];

176 
g
 = &
’Œ›s
[6];

177 
h
 = &
’Œ›s
[7];

185 
	`ql__š£¹
(&
h—d
, 
f
, 
lšk
);

186 
	`ql_befÜe_š£¹
(&
h—d
, 
f
, 
b
, 
lšk
);

187 
	`ql_befÜe_š£¹
(&
h—d
, 
f
, 
c
, 
lšk
);

188 
	`ql_aá”_š£¹
(
f
, 
h
, 
lšk
);

189 
	`ql_aá”_š£¹
(
f
, 
g
, 
lšk
);

190 
	`ql_befÜe_š£¹
(&
h—d
, 
b
, 
a
, 
lšk
);

191 
	`ql_aá”_š£¹
(
c
, 
d
, 
lšk
);

192 
	`ql_befÜe_š£¹
(&
h—d
, 
f
, 
e
, 
lšk
);

194 
	`‹¡_’Œ›s_li¡
(&
h—d
, 
’Œ›s
, ÓÁr›s)/(
li¡_t
));

195 
	}
}

196 
TEST_END


199 
	$maš
()

202  (
	`‹¡
(

203 
‹¡_ql_em±y
,

204 
‹¡_ql__š£¹
,

205 
‹¡_ql__»move
,

206 
‹¡_ql_h—d_š£¹
,

207 
‹¡_ql_h—d_»move
,

208 
‹¡_ql_š£¹
));

209 
	}
}

	@deps/jemalloc/test/unit/qr.c

1 
	~"‹¡/jem®loc_‹¡.h
"

4 
	#NENTRIES
 9

	)

6 
	#SPLIT_INDEX
 5

	)

8 
ršg_s
 
	tršg_t
;

10 
	sršg_s
 {

11 
qr
(
ršg_t
è
	mlšk
;

12 
	mid
;

16 
	$š™_’Œ›s
(
ršg_t
 *
’Œ›s
)

18 
i
;

20 
i
 = 0; i < 
NENTRIES
; i++) {

21 
	`qr_Ãw
(&
’Œ›s
[
i
], 
lšk
);

22 
’Œ›s
[
i
].
id
 = 'a' + i;

24 
	}
}

27 
	$‹¡_šd•’d’t_’Œ›s
(
ršg_t
 *
’Œ›s
)

29 
ršg_t
 *
t
;

30 
i
, 
j
;

32 
i
 = 0; i < 
NENTRIES
; i++) {

33 
j
 = 0;

34 
	`qr_fÜ—ch
(
t
, &
’Œ›s
[
i
], 
lšk
) {

35 
j
++;

37 
	`as£¹_u_eq
(
j
, 1,

41 
i
 = 0; i < 
NENTRIES
; i++) {

42 
j
 = 0;

43 
	`qr_»v”£_fÜ—ch
(
t
, &
’Œ›s
[
i
], 
lšk
) {

44 
j
++;

46 
	`as£¹_u_eq
(
j
, 1,

50 
i
 = 0; i < 
NENTRIES
; i++) {

51 
t
 = 
	`qr_Ãxt
(&
’Œ›s
[
i
], 
lšk
);

52 
	`as£¹_±r_eq
(
t
, &
’Œ›s
[
i
],

56 
i
 = 0; i < 
NENTRIES
; i++) {

57 
t
 = 
	`qr_´ev
(&
’Œ›s
[
i
], 
lšk
);

58 
	`as£¹_±r_eq
(
t
, &
’Œ›s
[
i
],

62 
	}
}

64 
	$TEST_BEGIN
(
‹¡_qr_Úe
)

66 
ršg_t
 
’Œ›s
[
NENTRIES
];

68 
	`š™_’Œ›s
(
’Œ›s
);

69 
	`‹¡_šd•’d’t_’Œ›s
(
’Œ›s
);

70 
	}
}

71 
TEST_END


74 
	$‹¡_’Œ›s_ršg
(
ršg_t
 *
’Œ›s
)

76 
ršg_t
 *
t
;

77 
i
, 
j
;

79 
i
 = 0; i < 
NENTRIES
; i++) {

80 
j
 = 0;

81 
	`qr_fÜ—ch
(
t
, &
’Œ›s
[
i
], 
lšk
) {

82 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[(
i
+
j
è% 
NENTRIES
].id,

84 
j
++;

87 
i
 = 0; i < 
NENTRIES
; i++) {

88 
j
 = 0;

89 
	`qr_»v”£_fÜ—ch
(
t
, &
’Œ›s
[
i
], 
lšk
) {

90 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[(
NENTRIES
+
i
-
j
-1) %

91 
NENTRIES
].
id
, "Element id mismatch");

92 
j
++;

95 
i
 = 0; i < 
NENTRIES
; i++) {

96 
t
 = 
	`qr_Ãxt
(&
’Œ›s
[
i
], 
lšk
);

97 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[(
i
+1è% 
NENTRIES
].id,

100 
i
 = 0; i < 
NENTRIES
; i++) {

101 
t
 = 
	`qr_´ev
(&
’Œ›s
[
i
], 
lšk
);

102 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[(
NENTRIES
+
i
-1) % NENTRIES].id,

105 
	}
}

107 
	$TEST_BEGIN
(
‹¡_qr_aá”_š£¹
)

109 
ršg_t
 
’Œ›s
[
NENTRIES
];

110 
i
;

112 
	`š™_’Œ›s
(
’Œ›s
);

113 
i
 = 1; i < 
NENTRIES
; i++)

114 
	`qr_aá”_š£¹
(&
’Œ›s
[
i
 - 1], &’Œ›s[i], 
lšk
);

115 
	`‹¡_’Œ›s_ršg
(
’Œ›s
);

116 
	}
}

117 
TEST_END


119 
	$TEST_BEGIN
(
‹¡_qr_»move
)

121 
ršg_t
 
’Œ›s
[
NENTRIES
];

122 
ršg_t
 *
t
;

123 
i
, 
j
;

125 
	`š™_’Œ›s
(
’Œ›s
);

126 
i
 = 1; i < 
NENTRIES
; i++)

127 
	`qr_aá”_š£¹
(&
’Œ›s
[
i
 - 1], &’Œ›s[i], 
lšk
);

129 
i
 = 0; i < 
NENTRIES
; i++) {

130 
j
 = 0;

131 
	`qr_fÜ—ch
(
t
, &
’Œ›s
[
i
], 
lšk
) {

132 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[
i
+
j
].id,

134 
j
++;

136 
j
 = 0;

137 
	`qr_»v”£_fÜ—ch
(
t
, &
’Œ›s
[
i
], 
lšk
) {

138 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[
NENTRIES
 - 1 - 
j
].id,

140 
j
++;

142 
	`qr_»move
(&
’Œ›s
[
i
], 
lšk
);

144 
	`‹¡_šd•’d’t_’Œ›s
(
’Œ›s
);

145 
	}
}

146 
TEST_END


148 
	$TEST_BEGIN
(
‹¡_qr_befÜe_š£¹
)

150 
ršg_t
 
’Œ›s
[
NENTRIES
];

151 
ršg_t
 *
t
;

152 
i
, 
j
;

154 
	`š™_’Œ›s
(
’Œ›s
);

155 
i
 = 1; i < 
NENTRIES
; i++)

156 
	`qr_befÜe_š£¹
(&
’Œ›s
[
i
 - 1], &’Œ›s[i], 
lšk
);

157 
i
 = 0; i < 
NENTRIES
; i++) {

158 
j
 = 0;

159 
	`qr_fÜ—ch
(
t
, &
’Œ›s
[
i
], 
lšk
) {

160 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[(
NENTRIES
+
i
-
j
) %

161 
NENTRIES
].
id
, "Element id mismatch");

162 
j
++;

165 
i
 = 0; i < 
NENTRIES
; i++) {

166 
j
 = 0;

167 
	`qr_»v”£_fÜ—ch
(
t
, &
’Œ›s
[
i
], 
lšk
) {

168 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[(
i
+
j
+1è% 
NENTRIES
].id,

170 
j
++;

173 
i
 = 0; i < 
NENTRIES
; i++) {

174 
t
 = 
	`qr_Ãxt
(&
’Œ›s
[
i
], 
lšk
);

175 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[(
NENTRIES
+
i
-1) % NENTRIES].id,

178 
i
 = 0; i < 
NENTRIES
; i++) {

179 
t
 = 
	`qr_´ev
(&
’Œ›s
[
i
], 
lšk
);

180 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[(
i
+1è% 
NENTRIES
].id,

183 
	}
}

184 
TEST_END


187 
	$‹¡_¥l™_’Œ›s
(
ršg_t
 *
’Œ›s
)

189 
ršg_t
 *
t
;

190 
i
, 
j
;

192 
i
 = 0; i < 
NENTRIES
; i++) {

193 
j
 = 0;

194 
	`qr_fÜ—ch
(
t
, &
’Œ›s
[
i
], 
lšk
) {

195 ià(
i
 < 
SPLIT_INDEX
) {

196 
	`as£¹_c_eq
(
t
->
id
,

197 
’Œ›s
[(
i
+
j
è% 
SPLIT_INDEX
].
id
,

200 
	`as£¹_c_eq
(
t
->
id
, 
’Œ›s
[(
i
+
j
-
SPLIT_INDEX
) %

201 (
NENTRIES
-
SPLIT_INDEX
è+ SPLIT_INDEX].
id
,

204 
j
++;

207 
	}
}

209 
	$TEST_BEGIN
(
‹¡_qr_m–d_¥l™
)

211 
ršg_t
 
’Œ›s
[
NENTRIES
];

212 
i
;

214 
	`š™_’Œ›s
(
’Œ›s
);

215 
i
 = 1; i < 
NENTRIES
; i++)

216 
	`qr_aá”_š£¹
(&
’Œ›s
[
i
 - 1], &’Œ›s[i], 
lšk
);

218 
	`qr_¥l™
(&
’Œ›s
[0], &’Œ›s[
SPLIT_INDEX
], 
lšk
);

219 
	`‹¡_¥l™_’Œ›s
(
’Œ›s
);

221 
	`qr_m–d
(&
’Œ›s
[0], &’Œ›s[
SPLIT_INDEX
], 
lšk
);

222 
	`‹¡_’Œ›s_ršg
(
’Œ›s
);

224 
	`qr_m–d
(&
’Œ›s
[0], &’Œ›s[
SPLIT_INDEX
], 
lšk
);

225 
	`‹¡_¥l™_’Œ›s
(
’Œ›s
);

227 
	`qr_¥l™
(&
’Œ›s
[0], &’Œ›s[
SPLIT_INDEX
], 
lšk
);

228 
	`‹¡_’Œ›s_ršg
(
’Œ›s
);

230 
	`qr_¥l™
(&
’Œ›s
[0], &’Œ›s[0], 
lšk
);

231 
	`‹¡_’Œ›s_ršg
(
’Œ›s
);

233 
	`qr_m–d
(&
’Œ›s
[0], &’Œ›s[0], 
lšk
);

234 
	`‹¡_’Œ›s_ršg
(
’Œ›s
);

235 
	}
}

236 
TEST_END


239 
	$maš
()

242  (
	`‹¡
(

243 
‹¡_qr_Úe
,

244 
‹¡_qr_aá”_š£¹
,

245 
‹¡_qr_»move
,

246 
‹¡_qr_befÜe_š£¹
,

247 
‹¡_qr_m–d_¥l™
));

248 
	}
}

	@deps/jemalloc/test/unit/quarantine.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#QUARANTINE_SIZE
 8192

	)

4 
	#STRINGIFY_HELPER
(
x
è#x

	)

5 
	#STRINGIFY
(
x
è
	`STRINGIFY_HELPER
(x)

	)

7 #ifdeà
JEMALLOC_FILL


8 cÚ¡ *
	gm®loc_cÚf
 = "abort:false,junk:true,redzone:true,quarantine:"

9 
STRINGIFY
(
QUARANTINE_SIZE
);

13 
	$qu¬ªtše_ş—r
()

15 *
p
;

17 
p
 = 
	`m®locx
(
QUARANTINE_SIZE
*2, 0);

18 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

19 
	`d®locx
(
p
, 0);

20 
	}
}

22 
	$TEST_BEGIN
(
‹¡_qu¬ªtše
)

24 
	#SZ
 
	`ZU
(256)

	)

25 
	#NQUARANTINED
 (
QUARANTINE_SIZE
/
SZ
)

	)

26 *
qu¬ªtšed
[
NQUARANTINED
+1];

27 
size_t
 
i
, 
j
;

29 
	`‹¡_sk_if
(!
cÚfig_fl
);

31 
	`as£¹_zu_eq
(
	`ÇÎocx
(
SZ
, 0), SZ,

32 "SZ=%zu dÛ nÙ…»ci£lyƒqu®‡ sizşass", 
SZ
);

34 
	`qu¬ªtše_ş—r
();

43 
i
 = 0; i < 
NQUARANTINED
+1; i++) {

44 *
p
 = 
	`m®locx
(
SZ
, 0);

45 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

46 
qu¬ªtšed
[
i
] = 
p
;

47 
	`d®locx
(
p
, 0);

48 
j
 = 0; j < 
i
; j++) {

49 
	`as£¹_±r_Ã
(
p
, 
qu¬ªtšed
[
j
],

51 "i=%zu, j=%zu", 
i
, 
j
);

54 #undeà
NQUARANTINED


55 #undeà
SZ


56 
	}
}

57 
TEST_END


59 
boŞ
 
	gd‘eùed_»dzÚe_cÜru±iÚ
;

62 
	$¬’a_»dzÚe_cÜru±iÚ_»¶aûm’t
(*
±r
, 
size_t
 
usize
, 
boŞ
 
aá”
,

63 
size_t
 
off£t
, 
ušt8_t
 
by‹
)

66 
d‘eùed_»dzÚe_cÜru±iÚ
 = 
Œue
;

67 
	}
}

69 
	$TEST_BEGIN
(
‹¡_qu¬ªtše_»dzÚe
)

71 *
s
;

72 
¬’a_»dzÚe_cÜru±iÚ_t
 *
¬’a_»dzÚe_cÜru±iÚ_Üig
;

74 
	`‹¡_sk_if
(!
cÚfig_fl
);

76 
¬’a_»dzÚe_cÜru±iÚ_Üig
 = 
¬’a_»dzÚe_cÜru±iÚ
;

77 
¬’a_»dzÚe_cÜru±iÚ
 = 
¬’a_»dzÚe_cÜru±iÚ_»¶aûm’t
;

80 
d‘eùed_»dzÚe_cÜru±iÚ
 = 
çl£
;

81 
s
 = (*)
	`m®locx
(1, 0);

82 
	`as£¹_±r_nÙ_nuÎ
((*)
s
, "Unexpected mallocx() failure");

83 
s
[-1] = 0xbb;

84 
	`d®locx
(
s
, 0);

85 
	`as£¹_Œue
(
d‘eùed_»dzÚe_cÜru±iÚ
,

89 
d‘eùed_»dzÚe_cÜru±iÚ
 = 
çl£
;

90 
s
 = (*)
	`m®locx
(1, 0);

91 
	`as£¹_±r_nÙ_nuÎ
((*)
s
, "Unexpected mallocx() failure");

92 
s
[
	`§Îocx
(s, 0)] = 0xbb;

93 
	`d®locx
(
s
, 0);

94 
	`as£¹_Œue
(
d‘eùed_»dzÚe_cÜru±iÚ
,

97 
¬’a_»dzÚe_cÜru±iÚ
 = 
¬’a_»dzÚe_cÜru±iÚ_Üig
;

98 
	}
}

99 
TEST_END


102 
	$maš
()

105  (
	`‹¡
(

106 
‹¡_qu¬ªtše
,

107 
‹¡_qu¬ªtše_»dzÚe
));

108 
	}
}

	@deps/jemalloc/test/unit/rb.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#rbŠ_bÏck_height
(
a_ty³
, 
a_f›ld
, 
a_rbt
, 
r_height
) do { \

4 
a_ty³
 *
rbp_bh_t
; \

5 
rbp_bh_t
 = (
a_rbt
)->
rbt_roÙ
, (
r_height
) = 0; \

6 
rbp_bh_t
 !ğ
NULL
; \

7 
rbp_bh_t
 = 
	`rbŠ_Ëá_g‘
(
a_ty³
, 
a_f›ld
,„bp_bh_t)) { \

8 ià(!
	`rbŠ_»d_g‘
(
a_ty³
, 
a_f›ld
, 
rbp_bh_t
)) { \

9 (
r_height
)++; \

12 } 0)

	)

14 
node_s
 
	tnode_t
;

16 
	snode_s
 {

17 
	#NODE_MAGIC
 0x9823af7e

	)

18 
ušt32_t
 
	mmagic
;

19 
rb_node
(
node_t
è
	mlšk
;

20 
ušt64_t
 
	mkey
;

24 
	$node_cmp
(cÚ¡ 
node_t
 *
a
, cÚ¡‚ode_ˆ*
b
) {

25 
»t
;

27 
	`as£¹_u32_eq
(
a
->
magic
, 
NODE_MAGIC
, "Bad magic");

28 
	`as£¹_u32_eq
(
b
->
magic
, 
NODE_MAGIC
, "Bad magic");

30 
»t
 = (
a
->
key
 > 
b
->key) - (a->key < b->key);

31 ià(
»t
 == 0) {

36 
»t
 = (((
ušŒ_t
)
a
è> ((ušŒ_t)
b
))

37 - (((
ušŒ_t
)
a
è< ((ušŒ_t)
b
));

39  (
»t
);

40 
	}
}

42 
	$rb_Œ“
(
	tnode_t
è
	tŒ“_t
;

43 
	`rb_g’
(, 
Œ“_
, 
Œ“_t
, 
node_t
, 
lšk
, 
node_cmp
);

45 
	$TEST_BEGIN
(
‹¡_rb_em±y
)

47 
Œ“_t
 
Œ“
;

48 
node_t
 
key
;

50 
	`Œ“_Ãw
(&
Œ“
);

52 
	`as£¹_Œue
(
	`Œ“_em±y
(&
Œ“
), "Tree should beƒmpty");

53 
	`as£¹_±r_nuÎ
(
	`Œ“_fœ¡
(&
Œ“
), "Unexpected‚ode");

54 
	`as£¹_±r_nuÎ
(
	`Œ“_Ï¡
(&
Œ“
), "Unexpected‚ode");

56 
key
.key = 0;

57 
key
.
magic
 = 
NODE_MAGIC
;

58 
	`as£¹_±r_nuÎ
(
	`Œ“_£¬ch
(&
Œ“
, &
key
), "Unexpected‚ode");

60 
key
.key = 0;

61 
key
.
magic
 = 
NODE_MAGIC
;

62 
	`as£¹_±r_nuÎ
(
	`Œ“_n£¬ch
(&
Œ“
, &
key
), "Unexpected‚ode");

64 
key
.key = 0;

65 
key
.
magic
 = 
NODE_MAGIC
;

66 
	`as£¹_±r_nuÎ
(
	`Œ“_p£¬ch
(&
Œ“
, &
key
), "Unexpected‚ode");

67 
	}
}

68 
TEST_END


71 
	$Œ“_»cur£
(
node_t
 *
node
, 
bÏck_height
, 
bÏck_d•th
)

73 
»t
 = 0;

74 
node_t
 *
Ëá_node
;

75 
node_t
 *
right_node
;

77 ià(
node
 =ğ
NULL
)

78  (
»t
);

80 
Ëá_node
 = 
	`rbŠ_Ëá_g‘
(
node_t
, 
lšk
, 
node
);

81 
right_node
 = 
	`rbŠ_right_g‘
(
node_t
, 
lšk
, 
node
);

83 ià(!
	`rbŠ_»d_g‘
(
node_t
, 
lšk
, 
node
))

84 
bÏck_d•th
++;

87 ià(
	`rbŠ_»d_g‘
(
node_t
, 
lšk
, 
node
)) {

88 ià(
Ëá_node
 !ğ
NULL
)

89 
	`as£¹_çl£
(
	`rbŠ_»d_g‘
(
node_t
, 
lšk
, 
Ëá_node
),

91 ià(
right_node
 !ğ
NULL
)

92 
	`as£¹_çl£
(
	`rbŠ_»d_g‘
(
node_t
, 
lšk
, 
right_node
),

97 
	`as£¹_u32_eq
(
node
->
magic
, 
NODE_MAGIC
, "Bad magic");

100 ià(
Ëá_node
 !ğ
NULL
)

101 
»t
 +ğ
	`Œ“_»cur£
(
Ëá_node
, 
bÏck_height
, 
bÏck_d•th
);

103 
»t
 +ğ(
bÏck_d•th
 !ğ
bÏck_height
);

106 ià(
right_node
 !ğ
NULL
)

107 
»t
 +ğ
	`Œ“_»cur£
(
right_node
, 
bÏck_height
, 
bÏck_d•th
);

109 
»t
 +ğ(
bÏck_d•th
 !ğ
bÏck_height
);

111  (
»t
);

112 
	}
}

114 
node_t
 *

115 
	$Œ“_™”©e_cb
(
Œ“_t
 *
Œ“
, 
node_t
 *
node
, *
d©a
)

117 *
i
 = (*)
d©a
;

118 
node_t
 *
£¬ch_node
;

120 
	`as£¹_u32_eq
(
node
->
magic
, 
NODE_MAGIC
, "Bad magic");

123 
£¬ch_node
 = 
	`Œ“_£¬ch
(
Œ“
, 
node
);

124 
	`as£¹_±r_eq
(
£¬ch_node
, 
node
,

128 
£¬ch_node
 = 
	`Œ“_n£¬ch
(
Œ“
, 
node
);

129 
	`as£¹_±r_eq
(
£¬ch_node
, 
node
,

133 
£¬ch_node
 = 
	`Œ“_p£¬ch
(
Œ“
, 
node
);

134 
	`as£¹_±r_eq
(
£¬ch_node
, 
node
,

137 (*
i
)++;

139  (
NULL
);

140 
	}
}

143 
	$Œ“_™”©e
(
Œ“_t
 *
Œ“
)

145 
i
;

147 
i
 = 0;

148 
	`Œ“_™”
(
Œ“
, 
NULL
, 
Œ“_™”©e_cb
, (*)&
i
);

150  (
i
);

151 
	}
}

154 
	$Œ“_™”©e_»v”£
(
Œ“_t
 *
Œ“
)

156 
i
;

158 
i
 = 0;

159 
	`Œ“_»v”£_™”
(
Œ“
, 
NULL
, 
Œ“_™”©e_cb
, (*)&
i
);

161  (
i
);

162 
	}
}

165 
	$node_»move
(
Œ“_t
 *
Œ“
, 
node_t
 *
node
, 
Âodes
)

167 
node_t
 *
£¬ch_node
;

168 
bÏck_height
, 
imb®ªûs
;

170 
	`Œ“_»move
(
Œ“
, 
node
);

173 
£¬ch_node
 = 
	`Œ“_n£¬ch
(
Œ“
, 
node
);

174 ià(
£¬ch_node
 !ğ
NULL
) {

175 
	`as£¹_u64_ge
(
£¬ch_node
->
key
, 
node
->key,

180 
£¬ch_node
 = 
	`Œ“_p£¬ch
(
Œ“
, 
node
);

181 ià(
£¬ch_node
 !ğ
NULL
) {

182 
	`as£¹_u64_Ë
(
£¬ch_node
->
key
, 
node
->key,

186 
node
->
magic
 = 0;

188 
	`rbŠ_bÏck_height
(
node_t
, 
lšk
, 
Œ“
, 
bÏck_height
);

189 
imb®ªûs
 = 
	`Œ“_»cur£
(
Œ“
->
rbt_roÙ
, 
bÏck_height
, 0);

190 
	`as£¹_u_eq
(
imb®ªûs
, 0, "Tree is unbalanced");

191 
	`as£¹_u_eq
(
	`Œ“_™”©e
(
Œ“
), 
Âodes
-1,

193 
	`as£¹_u_eq
(
	`Œ“_™”©e_»v”£
(
Œ“
), 
Âodes
-1,

195 
	}
}

197 
node_t
 *

198 
	$»move_™”©e_cb
(
Œ“_t
 *
Œ“
, 
node_t
 *
node
, *
d©a
)

200 *
Âodes
 = (*)
d©a
;

201 
node_t
 *
»t
 = 
	`Œ“_Ãxt
(
Œ“
, 
node
);

203 
	`node_»move
(
Œ“
, 
node
, *
Âodes
);

205  (
»t
);

206 
	}
}

208 
node_t
 *

209 
	$»move_»v”£_™”©e_cb
(
Œ“_t
 *
Œ“
, 
node_t
 *
node
, *
d©a
)

211 *
Âodes
 = (*)
d©a
;

212 
node_t
 *
»t
 = 
	`Œ“_´ev
(
Œ“
, 
node
);

214 
	`node_»move
(
Œ“
, 
node
, *
Âodes
);

216  (
»t
);

217 
	}
}

220 
	$de¡roy_cb
(
node_t
 *
node
, *
d©a
)

222 *
Âodes
 = (*)
d©a
;

224 
	`as£¹_u_gt
(*
Âodes
, 0, "Destruction„emovedoo many‚odes");

225 (*
Âodes
)--;

226 
	}
}

228 
	$TEST_BEGIN
(
‹¡_rb_¿ndom
)

230 
	#NNODES
 25

	)

231 
	#NBAGS
 250

	)

232 
	#SEED
 42

	)

233 
sfmt_t
 *
sfmt
;

234 
ušt64_t
 
bag
[
NNODES
];

235 
Œ“_t
 
Œ“
;

236 
node_t
 
nodes
[
NNODES
];

237 
i
, 
j
, 
k
, 
bÏck_height
, 
imb®ªûs
;

239 
sfmt
 = 
	`š™_g’_¿nd
(
SEED
);

240 
i
 = 0; i < 
NBAGS
; i++) {

241 
i
) {

244 
j
 = 0; j < 
NNODES
; j++)

245 
bag
[
j
] = j;

249 
j
 = 0; j < 
NNODES
; j++)

250 
bag
[
j
] = 
NNODES
 - j - 1;

253 
j
 = 0; j < 
NNODES
; j++)

254 
bag
[
j
] = 
	`g’_¿nd64_¿nge
(
sfmt
, 
NNODES
);

257 
j
 = 1; j <ğ
NNODES
; j++) {

259 
	`Œ“_Ãw
(&
Œ“
);

260 
k
 = 0; k < 
j
; k++) {

261 
nodes
[
k
].
magic
 = 
NODE_MAGIC
;

262 
nodes
[
k
].
key
 = 
bag
[k];

266 
k
 = 0; k < 
j
; k++) {

267 
	`Œ“_š£¹
(&
Œ“
, &
nodes
[
k
]);

269 
	`rbŠ_bÏck_height
(
node_t
, 
lšk
, &
Œ“
,

270 
bÏck_height
);

271 
imb®ªûs
 = 
	`Œ“_»cur£
(
Œ“
.
rbt_roÙ
,

272 
bÏck_height
, 0);

273 
	`as£¹_u_eq
(
imb®ªûs
, 0,

276 
	`as£¹_u_eq
(
	`Œ“_™”©e
(&
Œ“
), 
k
+1,

278 
	`as£¹_u_eq
(
	`Œ“_™”©e_»v”£
(&
Œ“
), 
k
+1,

281 
	`as£¹_çl£
(
	`Œ“_em±y
(&
Œ“
),

283 
	`as£¹_±r_nÙ_nuÎ
(
	`Œ“_fœ¡
(&
Œ“
),

285 
	`as£¹_±r_nÙ_nuÎ
(
	`Œ“_Ï¡
(&
Œ“
),

288 
	`Œ“_Ãxt
(&
Œ“
, &
nodes
[
k
]);

289 
	`Œ“_´ev
(&
Œ“
, &
nodes
[
k
]);

293 
i
 % 5) {

295 
k
 = 0; k < 
j
; k++)

296 
	`node_»move
(&
Œ“
, &
nodes
[
k
], 
j
 - k);

299 
k
 = 
j
; k > 0; k--)

300 
	`node_»move
(&
Œ“
, &
nodes
[
k
-1], k);

303 
node_t
 *
¡¬t
;

304 
Âodes
 = 
j
;

306 
¡¬t
 = 
NULL
;

308 
¡¬t
 = 
	`Œ“_™”
(&
Œ“
, start,

309 
»move_™”©e_cb
, (*)&
Âodes
);

310 
Âodes
--;

311 } 
¡¬t
 !ğ
NULL
);

312 
	`as£¹_u_eq
(
Âodes
, 0,

316 
node_t
 *
¡¬t
;

317 
Âodes
 = 
j
;

319 
¡¬t
 = 
NULL
;

321 
¡¬t
 = 
	`Œ“_»v”£_™”
(&
Œ“
, start,

322 
»move_»v”£_™”©e_cb
,

323 (*)&
Âodes
);

324 
Âodes
--;

325 } 
¡¬t
 !ğ
NULL
);

326 
	`as£¹_u_eq
(
Âodes
, 0,

330 
Âodes
 = 
j
;

331 
	`Œ“_de¡roy
(&
Œ“
, 
de¡roy_cb
, &
Âodes
);

332 
	`as£¹_u_eq
(
Âodes
, 0,

336 
	`nÙ_»ached
();

340 
	`fši_g’_¿nd
(
sfmt
);

341 #undeà
NNODES


342 #undeà
NBAGS


343 #undeà
SEED


344 
	}
}

345 
TEST_END


348 
	$maš
()

351  (
	`‹¡
(

352 
‹¡_rb_em±y
,

353 
‹¡_rb_¿ndom
));

354 
	}
}

	@deps/jemalloc/test/unit/rtree.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
¹»e_node_–m_t
 *

4 
	$node_®loc
(
size_t
 
Ãlms
)

7  ((
¹»e_node_–m_t
 *)
	`ÿÎoc
(
Ãlms
, (rtree_node_elm_t)));

8 
	}
}

11 
	$node_d®loc
(
¹»e_node_–m_t
 *
node
)

14 
	`ä“
(
node
);

15 
	}
}

17 
	$TEST_BEGIN
(
‹¡_¹»e_g‘_em±y
)

19 
i
;

21 
i
 = 1; i <ğ((
ušŒ_t
) << 3); i++) {

22 
¹»e_t
 
¹»e
;

23 
	`as£¹_çl£
(
	`¹»e_Ãw
(&
¹»e
, 
i
, 
node_®loc
, 
node_d®loc
),

25 
	`as£¹_±r_nuÎ
(
	`¹»e_g‘
(&
¹»e
, 0, 
çl£
),

27 
	`¹»e_d–‘e
(&
¹»e
);

29 
	}
}

30 
TEST_END


32 
	$TEST_BEGIN
(
‹¡_¹»e_exŒema
)

34 
i
;

35 
ex‹Á_node_t
 
node_a
, 
node_b
;

37 
i
 = 1; i <ğ((
ušŒ_t
) << 3); i++) {

38 
¹»e_t
 
¹»e
;

39 
	`as£¹_çl£
(
	`¹»e_Ãw
(&
¹»e
, 
i
, 
node_®loc
, 
node_d®loc
),

42 
	`as£¹_çl£
(
	`¹»e_£t
(&
¹»e
, 0, &
node_a
),

44 
	`as£¹_±r_eq
(
	`¹»e_g‘
(&
¹»e
, 0, 
Œue
), &
node_a
,

47 
	`as£¹_çl£
(
	`¹»e_£t
(&
¹»e
, ~((
ušŒ_t
)0), &
node_b
),

49 
	`as£¹_±r_eq
(
	`¹»e_g‘
(&
¹»e
, ~((
ušŒ_t
)0), 
Œue
), &
node_b
,

52 
	`¹»e_d–‘e
(&
¹»e
);

54 
	}
}

55 
TEST_END


57 
	$TEST_BEGIN
(
‹¡_¹»e_b™s
)

59 
i
, 
j
, 
k
;

61 
i
 = 1; i < ((
ušŒ_t
) << 3); i++) {

62 
ušŒ_t
 
keys
[] = {0, 1,

63 (((
ušŒ_t
)1è<< ((ušŒ_t)*8-
i
)) - 1};

64 
ex‹Á_node_t
 
node
;

65 
¹»e_t
 
¹»e
;

67 
	`as£¹_çl£
(
	`¹»e_Ãw
(&
¹»e
, 
i
, 
node_®loc
, 
node_d®loc
),

70 
j
 = 0; j < (
keys
)/(
ušŒ_t
); j++) {

71 
	`as£¹_çl£
(
	`¹»e_£t
(&
¹»e
, 
keys
[
j
], &
node
),

73 
k
 = 0; k < (
keys
)/(
ušŒ_t
); k++) {

74 
	`as£¹_±r_eq
(
	`¹»e_g‘
(&
¹»e
, 
keys
[
k
], 
Œue
),

75 &
node
, "rtree_get() should„eturn "

78 "£ˆkey=%#"
FMTxPTR
", g‘ key=%#"FMTxPTR, 
i
,

79 
j
, 
k
, 
keys
[j], keys[k]);

81 
	`as£¹_±r_nuÎ
(
	`¹»e_g‘
(&
¹»e
,

82 (((
ušŒ_t
)1è<< ((ušŒ_t)*8-
i
)), 
çl£
),

84 "i=%u, j=%u", 
i
, 
j
);

85 
	`as£¹_çl£
(
	`¹»e_£t
(&
¹»e
, 
keys
[
j
], 
NULL
),

89 
	`¹»e_d–‘e
(&
¹»e
);

91 
	}
}

92 
TEST_END


94 
	$TEST_BEGIN
(
‹¡_¹»e_¿ndom
)

96 
i
;

97 
sfmt_t
 *
sfmt
;

98 
	#NSET
 16

	)

99 
	#SEED
 42

	)

101 
sfmt
 = 
	`š™_g’_¿nd
(
SEED
);

102 
i
 = 1; i <ğ((
ušŒ_t
) << 3); i++) {

103 
ušŒ_t
 
keys
[
NSET
];

104 
ex‹Á_node_t
 
node
;

105 
j
;

106 
¹»e_t
 
¹»e
;

108 
	`as£¹_çl£
(
	`¹»e_Ãw
(&
¹»e
, 
i
, 
node_®loc
, 
node_d®loc
),

111 
j
 = 0; j < 
NSET
; j++) {

112 
keys
[
j
] = (
ušŒ_t
)
	`g’_¿nd64
(
sfmt
);

113 
	`as£¹_çl£
(
	`¹»e_£t
(&
¹»e
, 
keys
[
j
], &
node
),

115 
	`as£¹_±r_eq
(
	`¹»e_g‘
(&
¹»e
, 
keys
[
j
], 
Œue
), &
node
,

118 
j
 = 0; j < 
NSET
; j++) {

119 
	`as£¹_±r_eq
(
	`¹»e_g‘
(&
¹»e
, 
keys
[
j
], 
Œue
), &
node
,

123 
j
 = 0; j < 
NSET
; j++) {

124 
	`as£¹_çl£
(
	`¹»e_£t
(&
¹»e
, 
keys
[
j
], 
NULL
),

126 
	`as£¹_±r_nuÎ
(
	`¹»e_g‘
(&
¹»e
, 
keys
[
j
], 
Œue
),

129 
j
 = 0; j < 
NSET
; j++) {

130 
	`as£¹_±r_nuÎ
(
	`¹»e_g‘
(&
¹»e
, 
keys
[
j
], 
Œue
),

134 
	`¹»e_d–‘e
(&
¹»e
);

136 
	`fši_g’_¿nd
(
sfmt
);

137 #undeà
NSET


138 #undeà
SEED


139 
	}
}

140 
TEST_END


143 
	$maš
()

146  (
	`‹¡
(

147 
‹¡_¹»e_g‘_em±y
,

148 
‹¡_¹»e_exŒema
,

149 
‹¡_¹»e_b™s
,

150 
‹¡_¹»e_¿ndom
));

151 
	}
}

	@deps/jemalloc/test/unit/run_quantize.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	$TEST_BEGIN
(
‹¡_sm®l_run_size
)

5 
nbšs
, 
i
;

6 
size_t
 
sz
, 
run_size
;

7 
size_t
 
mib
[4];

8 
size_t
 
mibËn
 = (
mib
) / (size_t);

15 
sz
 = ();

16 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.nbšs", (*)&
nbšs
, &
sz
, 
NULL
, 0), 0,

19 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’as.bš.0.run_size", 
mib
, &
mibËn
), 0,

21 
i
 = 0; i < 
nbšs
; i++) {

22 
mib
[2] = 
i
;

23 
sz
 = (
size_t
);

24 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
run_size
, &
sz
,

25 
NULL
, 0), 0, "Unexpected mallctlbymib failure");

26 
	`as£¹_zu_eq
(
run_size
, 
	`run_quªtize_æoÜ
(run_size),

28 
run_size
);

29 
	`as£¹_zu_eq
(
run_size
, 
	`run_quªtize_û
(run_size),

31 
run_size
);

33 
	}
}

34 
TEST_END


36 
	$TEST_BEGIN
(
‹¡_Ïrge_run_size
)

38 
boŞ
 
ÿche_oblivious
;

39 
Æruns
, 
i
;

40 
size_t
 
sz
, 
run_size_´ev
, 
û_´ev
;

41 
size_t
 
mib
[4];

42 
size_t
 
mibËn
 = (
mib
) / (size_t);

49 
sz
 = (
boŞ
);

50 
	`as£¹_d_eq
(
	`m®lùl
("cÚfig.ÿche_oblivious", (*)&
ÿche_oblivious
,

51 &
sz
, 
NULL
, 0), 0, "Unexpected mallctl failure");

53 
sz
 = ();

54 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Æruns", (*)&
Æruns
, &
sz
, 
NULL
, 0), 0,

57 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’as.Ìun.0.size", 
mib
, &
mibËn
), 0,

59 
i
 = 0; i < 
Æruns
; i++) {

60 
size_t
 
Ìun_size
, 
run_size
, 
æoÜ
, 
û
;

62 
mib
[2] = 
i
;

63 
sz
 = (
size_t
);

64 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
Ìun_size
, &
sz
,

65 
NULL
, 0), 0, "Unexpected mallctlbymib failure");

66 
run_size
 = 
ÿche_oblivious
 ? 
Ìun_size
 + 
PAGE
 :†run_size;

67 
æoÜ
 = 
	`run_quªtize_æoÜ
(
run_size
);

68 
û
 = 
	`run_quªtize_û
(
run_size
);

70 
	`as£¹_zu_eq
(
run_size
, 
æoÜ
,

72 "sizÖrun_size=%zu,„un_size=%zu)", 
Ìun_size
, 
run_size
);

73 
	`as£¹_zu_eq
(
run_size
, 
û
,

75 "sizÖrun_size=%zu,„un_size=%zu)", 
Ìun_size
, 
run_size
);

77 ià(
i
 > 0) {

78 
	`as£¹_zu_eq
(
run_size_´ev
, 
	`run_quªtize_æoÜ
(
run_size


79 - 
PAGE
), "Floor should be‡…recise size");

80 ià(
run_size_´ev
 < 
û_´ev
) {

81 
	`as£¹_zu_eq
(
û_´ev
, 
run_size
,

84 "run_size=%zu)", 
run_size_´ev
, 
û_´ev
,

85 
run_size
);

88 
run_size_´ev
 = 
æoÜ
;

89 
û_´ev
 = 
	`run_quªtize_û
(
run_size
 + 
PAGE
);

91 
	}
}

92 
TEST_END


94 
	$TEST_BEGIN
(
‹¡_mÚÙÚic
)

96 
nbšs
, 
Æruns
, 
i
;

97 
size_t
 
sz
, 
æoÜ_´ev
, 
û_´ev
;

104 
sz
 = ();

105 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.nbšs", (*)&
nbšs
, &
sz
, 
NULL
, 0), 0,

108 
sz
 = ();

109 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.Æruns", (*)&
Æruns
, &
sz
, 
NULL
, 0), 0,

112 
æoÜ_´ev
 = 0;

113 
û_´ev
 = 0;

114 
i
 = 1; i <ğ
chunksize
 >> 
LG_PAGE
; i++) {

115 
size_t
 
run_size
, 
æoÜ
, 
û
;

117 
run_size
 = 
i
 << 
LG_PAGE
;

118 
æoÜ
 = 
	`run_quªtize_æoÜ
(
run_size
);

119 
û
 = 
	`run_quªtize_û
(
run_size
);

121 
	`as£¹_zu_Ë
(
æoÜ
, 
run_size
,

123 
æoÜ
, 
run_size
, 
û
);

124 
	`as£¹_zu_ge
(
û
, 
run_size
,

126 
æoÜ
, 
run_size
, 
û
);

128 
	`as£¹_zu_Ë
(
æoÜ_´ev
, 
æoÜ
, "Floor should be monotonic "

130 
æoÜ_´ev
, 
æoÜ
, 
run_size
, 
û
);

131 
	`as£¹_zu_Ë
(
û_´ev
, 
û
, "Ceiling should be monotonic "

133 
æoÜ
, 
run_size
, 
û_´ev
, 
û
);

135 
æoÜ_´ev
 = 
æoÜ
;

136 
û_´ev
 = 
û
;

138 
	}
}

139 
TEST_END


142 
	$maš
()

145  (
	`‹¡
(

146 
‹¡_sm®l_run_size
,

147 
‹¡_Ïrge_run_size
,

148 
‹¡_mÚÙÚic
));

149 
	}
}

	@deps/jemalloc/test/unit/size_classes.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
size_t


4 
	$g‘_max_size_şass
()

6 
nhchunks
;

7 
size_t
 
mib
[4];

8 
size_t
 
sz
, 
mibËn
, 
max_size_şass
;

10 
sz
 = ();

11 
	`as£¹_d_eq
(
	`m®lùl
("¬’as.nhchunks", (*)&
nhchunks
, &
sz
, 
NULL
, 0),

14 
mibËn
 = (
mib
è/ (
size_t
);

15 
	`as£¹_d_eq
(
	`m®lùÊam‘omib
("¬’as.hchunk.0.size", 
mib
, &
mibËn
), 0,

17 
mib
[2] = 
nhchunks
 - 1;

19 
sz
 = (
size_t
);

20 
	`as£¹_d_eq
(
	`m®lùlbymib
(
mib
, 
mibËn
, (*)&
max_size_şass
, &
sz
,

21 
NULL
, 0), 0, "Unexpected mallctlbymib()ƒrror");

23  (
max_size_şass
);

24 
	}
}

26 
	$TEST_BEGIN
(
‹¡_size_şas£s
)

28 
size_t
 
size_şass
, 
max_size_şass
;

29 
szšd_t
 
šdex
, 
max_šdex
;

31 
max_size_şass
 = 
	`g‘_max_size_şass
();

32 
max_šdex
 = 
	`size2šdex
(
max_size_şass
);

34 
šdex
 = 0, 
size_şass
 = 
	`šdex2size
(šdex); index < 
max_šdex
 ||

35 
size_şass
 < 
max_size_şass
; 
šdex
++, size_class =

36 
	`šdex2size
(
šdex
)) {

37 
	`as£¹_Œue
(
šdex
 < 
max_šdex
,

39 "size_şass=%zu (%#zx)", 
šdex
, 
size_şass
, size_class);

40 
	`as£¹_Œue
(
size_şass
 < 
max_size_şass
,

42 "size_şass=%zu (%#zx)", 
šdex
, 
size_şass
, size_class);

44 
	`as£¹_u_eq
(
šdex
, 
	`size2šdex
(
size_şass
),

46 " size_şass=%zu --> index=%u --> size_şass=%zu", 
šdex
,

47 
size_şass
, 
	`size2šdex
(size_class),

48 
	`šdex2size
(
	`size2šdex
(
size_şass
)));

49 
	`as£¹_zu_eq
(
size_şass
, 
	`šdex2size
(
	`size2šdex
(size_class)),

51 " size_şass=%zu --> index=%u --> size_şass=%zu", 
šdex
,

52 
size_şass
, 
	`size2šdex
(size_class),

53 
	`šdex2size
(
	`size2šdex
(
size_şass
)));

55 
	`as£¹_u_eq
(
šdex
+1, 
	`size2šdex
(
size_şass
+1),

58 
	`as£¹_zu_eq
(
size_şass
, (
šdex
 > 0) ?

59 
	`s2u
(
	`šdex2size
(
šdex
-1)+1) : s2u(1),

61 
	`as£¹_zu_eq
(
size_şass
, 
	`s2u
(size_class-1),

63 
	`as£¹_zu_eq
(
size_şass
, 
	`s2u
(size_class),

65 
	`as£¹_zu_eq
(
	`s2u
(
size_şass
+1), 
	`šdex2size
(
šdex
+1),

69 
	`as£¹_u_eq
(
šdex
, 
	`size2šdex
(
	`šdex2size
(index)),

71 
	`as£¹_zu_eq
(
max_size_şass
, 
	`šdex2size
(
	`size2šdex
(max_size_class)),

74 
	`as£¹_zu_eq
(
size_şass
, 
	`s2u
(
	`šdex2size
(
šdex
-1)+1),

76 
	`as£¹_zu_eq
(
size_şass
, 
	`s2u
(size_class-1),

78 
	`as£¹_zu_eq
(
size_şass
, 
	`s2u
(size_class),

80 
	}
}

81 
TEST_END


83 
	$TEST_BEGIN
(
‹¡_psize_şas£s
)

85 
size_t
 
size_şass
, 
max_size_şass
;

86 
pszšd_t
 
pšd
, 
max_pšd
;

88 
max_size_şass
 = 
	`g‘_max_size_şass
();

89 
max_pšd
 = 
	`psz2šd
(
max_size_şass
);

91 
pšd
 = 0, 
size_şass
 = 
	`pšd2sz
Õšd);…šd < 
max_pšd
 ||

92 
size_şass
 < 
max_size_şass
; 
pšd
++, size_class =

93 
	`pšd2sz
(
pšd
)) {

94 
	`as£¹_Œue
(
pšd
 < 
max_pšd
,

96 "size_şass=%zu (%#zx)", 
pšd
, 
size_şass
, size_class);

97 
	`as£¹_Œue
(
size_şass
 < 
max_size_şass
,

99 "size_şass=%zu (%#zx)", 
pšd
, 
size_şass
, size_class);

101 
	`as£¹_u_eq
(
pšd
, 
	`psz2šd
(
size_şass
),

103 " size_şass=%zu -->…šd=%u --> size_şass=%zu", 
pšd
,

104 
size_şass
, 
	`psz2šd
(size_class),

105 
	`pšd2sz
(
	`psz2šd
(
size_şass
)));

106 
	`as£¹_zu_eq
(
size_şass
, 
	`pšd2sz
(
	`psz2šd
(size_class)),

108 " size_şass=%zu -->…šd=%u --> size_şass=%zu", 
pšd
,

109 
size_şass
, 
	`psz2šd
(size_class),

110 
	`pšd2sz
(
	`psz2šd
(
size_şass
)));

112 
	`as£¹_u_eq
(
pšd
+1, 
	`psz2šd
(
size_şass
+1),

115 
	`as£¹_zu_eq
(
size_şass
, (
pšd
 > 0) ?

116 
	`psz2u
(
	`pšd2sz
(
pšd
-1)+1) :…sz2u(1),

118 
	`as£¹_zu_eq
(
size_şass
, 
	`psz2u
(size_class-1),

120 
	`as£¹_zu_eq
(
size_şass
, 
	`psz2u
(size_class),

122 
	`as£¹_zu_eq
(
	`psz2u
(
size_şass
+1), 
	`pšd2sz
(
pšd
+1),

126 
	`as£¹_u_eq
(
pšd
, 
	`psz2šd
(
	`pšd2sz
(pind)),

128 
	`as£¹_zu_eq
(
max_size_şass
, 
	`pšd2sz
(
	`psz2šd
(max_size_class)),

131 
	`as£¹_zu_eq
(
size_şass
, 
	`psz2u
(
	`pšd2sz
(
pšd
-1)+1),

133 
	`as£¹_zu_eq
(
size_şass
, 
	`psz2u
(size_class-1),

135 
	`as£¹_zu_eq
(
size_şass
, 
	`psz2u
(size_class),

137 
	}
}

138 
TEST_END


140 
	$TEST_BEGIN
(
‹¡_ov”æow
)

142 
size_t
 
max_size_şass
;

144 
max_size_şass
 = 
	`g‘_max_size_şass
();

146 
	`as£¹_u_eq
(
	`size2šdex
(
max_size_şass
+1), 
NSIZES
,

148 
	`as£¹_u_eq
(
	`size2šdex
(
	`ZU
(
PTRDIFF_MAX
)+1), 
NSIZES
,

150 
	`as£¹_u_eq
(
	`size2šdex
(
SIZE_T_MAX
), 
NSIZES
,

153 
	`as£¹_zu_eq
(
	`s2u
(
max_size_şass
+1), 0,

155 
	`as£¹_zu_eq
(
	`s2u
(
	`ZU
(
PTRDIFF_MAX
)+1), 0,

157 
	`as£¹_zu_eq
(
	`s2u
(
SIZE_T_MAX
), 0,

160 
	`as£¹_u_eq
(
	`psz2šd
(
max_size_şass
+1), 
NPSIZES
,

162 
	`as£¹_u_eq
(
	`psz2šd
(
	`ZU
(
PTRDIFF_MAX
)+1), 
NPSIZES
,

164 
	`as£¹_u_eq
(
	`psz2šd
(
SIZE_T_MAX
), 
NPSIZES
,

167 
	`as£¹_zu_eq
(
	`psz2u
(
max_size_şass
+1), 0,

169 
	`as£¹_zu_eq
(
	`psz2u
(
	`ZU
(
PTRDIFF_MAX
)+1), 0,

171 
	`as£¹_zu_eq
(
	`psz2u
(
SIZE_T_MAX
), 0,

173 
	}
}

174 
TEST_END


177 
	$maš
()

180  (
	`‹¡
(

181 
‹¡_size_şas£s
,

182 
‹¡_psize_şas£s
,

183 
‹¡_ov”æow
));

184 
	}
}

	@deps/jemalloc/test/unit/smoothstep.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 cÚ¡ 
ušt64_t
 
	gsmoÙh¡•_b
[] = {

4 
	#STEP
(
¡•
, 
h
, 
x
, 
y
) \

5 
h
,

	)

6 
SMOOTHSTEP


7 #undeà
STEP


10 
	$TEST_BEGIN
(
‹¡_smoÙh¡•_š‹g¿l
)

12 
ušt64_t
 
sum
, 
mš
, 
max
;

13 
i
;

22 
sum
 = 0;

23 
i
 = 0; i < 
SMOOTHSTEP_NSTEPS
; i++)

24 
sum
 +ğ
smoÙh¡•_b
[
i
];

26 
max
 = (
	`KQU
(1è<< (
SMOOTHSTEP_BFP
-1)è* (
SMOOTHSTEP_NSTEPS
+1);

27 
mš
 = 
max
 - 
SMOOTHSTEP_NSTEPS
;

29 
	`as£¹_u64_ge
(
sum
, 
mš
,

31 
	`as£¹_u64_Ë
(
sum
, 
max
, "Integralƒxceeds 1/2");

32 ià(
çl£
) {

33 
	`m®loc_´štf
("%"
FMTu64
" ulps under 1/2 (limit %d)\n",

34 
max
 - 
sum
, 
SMOOTHSTEP_NSTEPS
);

36 
	}
}

37 
TEST_END


39 
	$TEST_BEGIN
(
‹¡_smoÙh¡•_mÚÙÚic
)

41 
ušt64_t
 
´ev_h
;

42 
i
;

50 
´ev_h
 = 0;

51 
i
 = 0; i < 
SMOOTHSTEP_NSTEPS
; i++) {

52 
ušt64_t
 
h
 = 
smoÙh¡•_b
[
i
];

53 
	`as£¹_u64_ge
(
h
, 
´ev_h
, "P›ûwi£‚Ú-mÚÙÚic, i=%u", 
i
);

54 
´ev_h
 = 
h
;

56 
	`as£¹_u64_eq
(
smoÙh¡•_b
[
SMOOTHSTEP_NSTEPS
-1],

57 (
	`KQU
(1è<< 
SMOOTHSTEP_BFP
), "Last step mustƒqual 1");

58 
	}
}

59 
TEST_END


61 
	$TEST_BEGIN
(
‹¡_smoÙh¡•_¦İe
)

63 
ušt64_t
 
´ev_h
, 
´ev_d–
;

64 
i
;

72 
´ev_h
 = 0;

73 
´ev_d–
 = 0;

74 
i
 = 0; i < 
SMOOTHSTEP_NSTEPS
 / 2 + SMOOTHSTEP_NSTEPS % 2; i++) {

75 
ušt64_t
 
h
 = 
smoÙh¡•_b
[
i
];

76 
ušt64_t
 
d–
 = 
h
 - 
´ev_h
;

77 
	`as£¹_u64_ge
(
d–
, 
´ev_d–
,

79 "i=%u", 
i
);

80 
´ev_h
 = 
h
;

81 
´ev_d–
 = 
d–
;

84 
´ev_h
 = 
	`KQU
(1è<< 
SMOOTHSTEP_BFP
;

85 
´ev_d–
 = 0;

86 
i
 = 
SMOOTHSTEP_NSTEPS
-1; i >= SMOOTHSTEP_NSTEPS / 2; i--) {

87 
ušt64_t
 
h
 = 
smoÙh¡•_b
[
i
];

88 
ušt64_t
 
d–
 = 
´ev_h
 - 
h
;

89 
	`as£¹_u64_ge
(
d–
, 
´ev_d–
,

91 "i=%u", 
i
);

92 
´ev_h
 = 
h
;

93 
´ev_d–
 = 
d–
;

95 
	}
}

96 
TEST_END


99 
	$maš
()

102  (
	`‹¡
(

103 
‹¡_smoÙh¡•_š‹g¿l
,

104 
‹¡_smoÙh¡•_mÚÙÚic
,

105 
‹¡_smoÙh¡•_¦İe
));

106 
	}
}

	@deps/jemalloc/test/unit/stats.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	$TEST_BEGIN
(
‹¡_¡©s_summ¬y
)

5 
size_t
 *
ÿùive
;

6 
size_t
 
sz
, 
®loÿ‹d
, 
aùive
, 
»sid’t
, 
m­³d
;

7 
ex³ùed
 = 
cÚfig_¡©s
 ? 0 : 
ENOENT
;

9 
sz
 = (
ÿùive
);

10 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.ÿùive", (*)&
ÿùive
, &
sz
, 
NULL
, 0),

11 
ex³ùed
, "Unexpected mallctl()„esult");

13 
sz
 = (
size_t
);

14 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.®loÿ‹d", (*)&
®loÿ‹d
, &
sz
, 
NULL
,

15 0), 
ex³ùed
, "Unexpected mallctl()„esult");

16 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.aùive", (*)&
aùive
, &
sz
, 
NULL
, 0),

17 
ex³ùed
, "Unexpected mallctl()„esult");

18 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.»sid’t", (*)&
»sid’t
, &
sz
, 
NULL
, 0),

19 
ex³ùed
, "Unexpected mallctl()„esult");

20 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.m­³d", (*)&
m­³d
, &
sz
, 
NULL
, 0),

21 
ex³ùed
, "Unexpected mallctl()„esult");

23 ià(
cÚfig_¡©s
) {

24 
	`as£¹_zu_Ë
(
aùive
, *
ÿùive
,

26 
	`as£¹_zu_Ë
(
®loÿ‹d
, 
aùive
,

28 
	`as£¹_zu_É
(
aùive
, 
»sid’t
,

30 
	`as£¹_zu_É
(
aùive
, 
m­³d
,

33 
	}
}

34 
TEST_END


36 
	$TEST_BEGIN
(
‹¡_¡©s_huge
)

38 *
p
;

39 
ušt64_t
 
•och
;

40 
size_t
 
®loÿ‹d
;

41 
ušt64_t
 
nm®loc
, 
nd®loc
, 
Äeque¡s
;

42 
size_t
 
sz
;

43 
ex³ùed
 = 
cÚfig_¡©s
 ? 0 : 
ENOENT
;

45 
p
 = 
	`m®locx
(
Ïrge_maxşass
+1, 0);

46 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

48 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
, (epoch)),

51 
sz
 = (
size_t
);

52 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.huge.®loÿ‹d", (*)&
®loÿ‹d
,

53 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

54 
sz
 = (
ušt64_t
);

55 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.huge.nm®loc", (*)&
nm®loc
,

56 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

57 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.huge.nd®loc", (*)&
nd®loc
,

58 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

59 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.huge.Äeque¡s", (*)&
Äeque¡s
,

60 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

62 ià(
cÚfig_¡©s
) {

63 
	`as£¹_zu_gt
(
®loÿ‹d
, 0,

65 
	`as£¹_u64_ge
(
nm®loc
, 
nd®loc
,

67 
	`as£¹_u64_Ë
(
nm®loc
, 
Äeque¡s
,

71 
	`d®locx
(
p
, 0);

72 
	}
}

73 
TEST_END


75 
	$TEST_BEGIN
(
‹¡_¡©s_¬’as_summ¬y
)

77 
¬’a
;

78 *
l™e
, *
Ïrge
, *
huge
;

79 
ušt64_t
 
•och
;

80 
size_t
 
sz
;

81 
ex³ùed
 = 
cÚfig_¡©s
 ? 0 : 
ENOENT
;

82 
size_t
 
m­³d
;

83 
ušt64_t
 
Åurge
, 
nmadvi£
, 
purged
;

85 
¬’a
 = 0;

86 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.¬’a", 
NULL
, NULL, (*)&
¬’a
,

87 (
¬’a
)), 0, "Unexpected mallctl() failure");

89 
l™e
 = 
	`m®locx
(
SMALL_MAXCLASS
, 0);

90 
	`as£¹_±r_nÙ_nuÎ
(
l™e
, "Unexpected mallocx() failure");

91 
Ïrge
 = 
	`m®locx
(
Ïrge_maxşass
, 0);

92 
	`as£¹_±r_nÙ_nuÎ
(
Ïrge
, "Unexpected mallocx() failure");

93 
huge
 = 
	`m®locx
(
chunksize
, 0);

94 
	`as£¹_±r_nÙ_nuÎ
(
huge
, "Unexpected mallocx() failure");

96 
	`d®locx
(
l™e
, 0);

97 
	`d®locx
(
Ïrge
, 0);

98 
	`d®locx
(
huge
, 0);

100 
	`as£¹_d_eq
(
	`m®lùl
("¬’a.0.purge", 
NULL
, NULL, NULL, 0), 0,

103 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
, (epoch)),

106 
sz
 = (
size_t
);

107 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.m­³d", (*)&
m­³d
, &
sz
, 
NULL
,

108 0), 
ex³ùed
, "Unexepected mallctl()„esult");

109 
sz
 = (
ušt64_t
);

110 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Åurge", (*)&
Åurge
, &
sz
, 
NULL
,

111 0), 
ex³ùed
, "Unexepected mallctl()„esult");

112 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.nmadvi£", (*)&
nmadvi£
, &
sz
,

113 
NULL
, 0), 
ex³ùed
, "Unexepected mallctl()„esult");

114 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.purged", (*)&
purged
, &
sz
, 
NULL
,

115 0), 
ex³ùed
, "Unexepected mallctl()„esult");

117 ià(
cÚfig_¡©s
) {

118 
	`as£¹_u64_gt
(
Åurge
, 0,

120 
	`as£¹_u64_Ë
(
nmadvi£
, 
purged
,

123 
	}
}

124 
TEST_END


127 
	$thd_¡¬t
(*
¬g
)

130  (
NULL
);

131 
	}
}

134 
	$no_Ïzy_lock
()

136 
thd_t
 
thd
;

138 
	`thd_ü—‹
(&
thd
, 
thd_¡¬t
, 
NULL
);

139 
	`thd_još
(
thd
, 
NULL
);

140 
	}
}

142 
	$TEST_BEGIN
(
‹¡_¡©s_¬’as_sm®l
)

144 
¬’a
;

145 *
p
;

146 
size_t
 
sz
, 
®loÿ‹d
;

147 
ušt64_t
 
•och
, 
nm®loc
, 
nd®loc
, 
Äeque¡s
;

148 
ex³ùed
 = 
cÚfig_¡©s
 ? 0 : 
ENOENT
;

150 
	`no_Ïzy_lock
();

152 
¬’a
 = 0;

153 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.¬’a", 
NULL
, NULL, (*)&
¬’a
,

154 (
¬’a
)), 0, "Unexpected mallctl() failure");

156 
p
 = 
	`m®locx
(
SMALL_MAXCLASS
, 0);

157 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

159 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.æush", 
NULL
, NULL, NULL, 0),

160 
cÚfig_tÿche
 ? 0 : 
ENOENT
, "Unexpected mallctl()„esult");

162 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
, (epoch)),

165 
sz
 = (
size_t
);

166 
	`as£¹_d_eq
(
	`m®lùl
("stats.arenas.0.small.allocated",

167 (*)&
®loÿ‹d
, &
sz
, 
NULL
, 0), 
ex³ùed
,

169 
sz
 = (
ušt64_t
);

170 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.sm®l.nm®loc", (*)&
nm®loc
,

171 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

172 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.sm®l.nd®loc", (*)&
nd®loc
,

173 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

174 
	`as£¹_d_eq
(
	`m®lùl
("stats.arenas.0.small.nrequests",

175 (*)&
Äeque¡s
, &
sz
, 
NULL
, 0), 
ex³ùed
,

178 ià(
cÚfig_¡©s
) {

179 
	`as£¹_zu_gt
(
®loÿ‹d
, 0,

181 
	`as£¹_u64_gt
(
nm®loc
, 0,

183 
	`as£¹_u64_ge
(
nm®loc
, 
nd®loc
,

185 
	`as£¹_u64_gt
(
Äeque¡s
, 0,

189 
	`d®locx
(
p
, 0);

190 
	}
}

191 
TEST_END


193 
	$TEST_BEGIN
(
‹¡_¡©s_¬’as_Ïrge
)

195 
¬’a
;

196 *
p
;

197 
size_t
 
sz
, 
®loÿ‹d
;

198 
ušt64_t
 
•och
, 
nm®loc
, 
nd®loc
, 
Äeque¡s
;

199 
ex³ùed
 = 
cÚfig_¡©s
 ? 0 : 
ENOENT
;

201 
¬’a
 = 0;

202 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.¬’a", 
NULL
, NULL, (*)&
¬’a
,

203 (
¬’a
)), 0, "Unexpected mallctl() failure");

205 
p
 = 
	`m®locx
(
Ïrge_maxşass
, 0);

206 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

208 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
, (epoch)),

211 
sz
 = (
size_t
);

212 
	`as£¹_d_eq
(
	`m®lùl
("stats.arenas.0.large.allocated",

213 (*)&
®loÿ‹d
, &
sz
, 
NULL
, 0), 
ex³ùed
,

215 
sz
 = (
ušt64_t
);

216 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Ïrge.nm®loc", (*)&
nm®loc
,

217 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

218 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Ïrge.nd®loc", (*)&
nd®loc
,

219 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

220 
	`as£¹_d_eq
(
	`m®lùl
("stats.arenas.0.large.nrequests",

221 (*)&
Äeque¡s
, &
sz
, 
NULL
, 0), 
ex³ùed
,

224 ià(
cÚfig_¡©s
) {

225 
	`as£¹_zu_gt
(
®loÿ‹d
, 0,

227 
	`as£¹_u64_gt
(
nm®loc
, 0,

229 
	`as£¹_u64_ge
(
nm®loc
, 
nd®loc
,

231 
	`as£¹_u64_gt
(
Äeque¡s
, 0,

235 
	`d®locx
(
p
, 0);

236 
	}
}

237 
TEST_END


239 
	$TEST_BEGIN
(
‹¡_¡©s_¬’as_huge
)

241 
¬’a
;

242 *
p
;

243 
size_t
 
sz
, 
®loÿ‹d
;

244 
ušt64_t
 
•och
, 
nm®loc
, 
nd®loc
;

245 
ex³ùed
 = 
cÚfig_¡©s
 ? 0 : 
ENOENT
;

247 
¬’a
 = 0;

248 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.¬’a", 
NULL
, NULL, (*)&
¬’a
,

249 (
¬’a
)), 0, "Unexpected mallctl() failure");

251 
p
 = 
	`m®locx
(
chunksize
, 0);

252 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

254 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
, (epoch)),

257 
sz
 = (
size_t
);

258 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.huge.®loÿ‹d", (*)&
®loÿ‹d
,

259 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

260 
sz
 = (
ušt64_t
);

261 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.huge.nm®loc", (*)&
nm®loc
,

262 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

263 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.huge.nd®loc", (*)&
nd®loc
,

264 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

266 ià(
cÚfig_¡©s
) {

267 
	`as£¹_zu_gt
(
®loÿ‹d
, 0,

269 
	`as£¹_u64_gt
(
nm®loc
, 0,

271 
	`as£¹_u64_ge
(
nm®loc
, 
nd®loc
,

275 
	`d®locx
(
p
, 0);

276 
	}
}

277 
TEST_END


279 
	$TEST_BEGIN
(
‹¡_¡©s_¬’as_bšs
)

281 
¬’a
;

282 *
p
;

283 
size_t
 
sz
, 
cu¼uns
, 
cu¼egs
;

284 
ušt64_t
 
•och
, 
nm®loc
, 
nd®loc
, 
Äeque¡s
, 
nfls
, 
næushes
;

285 
ušt64_t
 
Äuns
, 
Ä”uns
;

286 
ex³ùed
 = 
cÚfig_¡©s
 ? 0 : 
ENOENT
;

288 
¬’a
 = 0;

289 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.¬’a", 
NULL
, NULL, (*)&
¬’a
,

290 (
¬’a
)), 0, "Unexpected mallctl() failure");

292 
p
 = 
	`m®locx
(
¬’a_bš_šfo
[0].
»g_size
, 0);

293 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

295 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.tÿche.æush", 
NULL
, NULL, NULL, 0),

296 
cÚfig_tÿche
 ? 0 : 
ENOENT
, "Unexpected mallctl()„esult");

298 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
, (epoch)),

301 
sz
 = (
ušt64_t
);

302 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.bšs.0.nm®loc", (*)&
nm®loc
,

303 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

304 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.bšs.0.nd®loc", (*)&
nd®loc
,

305 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

306 
	`as£¹_d_eq
(
	`m®lùl
("stats.arenas.0.bins.0.nrequests",

307 (*)&
Äeque¡s
, &
sz
, 
NULL
, 0), 
ex³ùed
,

309 
sz
 = (
size_t
);

310 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.bšs.0.cu¼egs", (*)&
cu¼egs
,

311 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

313 
sz
 = (
ušt64_t
);

314 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.bšs.0.nfls", (*)&
nfls
,

315 &
sz
, 
NULL
, 0), 
cÚfig_tÿche
 ? 
ex³ùed
 : 
ENOENT
,

317 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.bšs.0.næushes", (*)&
næushes
,

318 &
sz
, 
NULL
, 0), 
cÚfig_tÿche
 ? 
ex³ùed
 : 
ENOENT
,

321 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.bšs.0.Äuns", (*)&
Äuns
, &
sz
,

322 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

323 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.bšs.0.Ä”uns", (*)&
Ä”uns
,

324 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

325 
sz
 = (
size_t
);

326 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.bšs.0.cu¼uns", (*)&
cu¼uns
,

327 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

329 ià(
cÚfig_¡©s
) {

330 
	`as£¹_u64_gt
(
nm®loc
, 0,

332 
	`as£¹_u64_ge
(
nm®loc
, 
nd®loc
,

334 
	`as£¹_u64_gt
(
Äeque¡s
, 0,

336 
	`as£¹_zu_gt
(
cu¼egs
, 0,

338 ià(
cÚfig_tÿche
) {

339 
	`as£¹_u64_gt
(
nfls
, 0,

341 
	`as£¹_u64_gt
(
næushes
, 0,

344 
	`as£¹_u64_gt
(
Äuns
, 0,

346 
	`as£¹_zu_gt
(
cu¼uns
, 0,

350 
	`d®locx
(
p
, 0);

351 
	}
}

352 
TEST_END


354 
	$TEST_BEGIN
(
‹¡_¡©s_¬’as_Ìuns
)

356 
¬’a
;

357 *
p
;

358 
ušt64_t
 
•och
, 
nm®loc
, 
nd®loc
, 
Äeque¡s
;

359 
size_t
 
cu¼uns
, 
sz
;

360 
ex³ùed
 = 
cÚfig_¡©s
 ? 0 : 
ENOENT
;

362 
¬’a
 = 0;

363 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.¬’a", 
NULL
, NULL, (*)&
¬’a
,

364 (
¬’a
)), 0, "Unexpected mallctl() failure");

366 
p
 = 
	`m®locx
(
LARGE_MINCLASS
, 0);

367 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

369 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
, (epoch)),

372 
sz
 = (
ušt64_t
);

373 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Ìuns.0.nm®loc", (*)&
nm®loc
,

374 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

375 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Ìuns.0.nd®loc", (*)&
nd®loc
,

376 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

377 
	`as£¹_d_eq
(
	`m®lùl
("stats.arenas.0.lruns.0.nrequests",

378 (*)&
Äeque¡s
, &
sz
, 
NULL
, 0), 
ex³ùed
,

380 
sz
 = (
size_t
);

381 
	`as£¹_d_eq
(
	`m®lùl
("¡©s.¬’as.0.Ìuns.0.cu¼uns", (*)&
cu¼uns
,

382 &
sz
, 
NULL
, 0), 
ex³ùed
, "Unexpected mallctl()„esult");

384 ià(
cÚfig_¡©s
) {

385 
	`as£¹_u64_gt
(
nm®loc
, 0,

387 
	`as£¹_u64_ge
(
nm®loc
, 
nd®loc
,

389 
	`as£¹_u64_gt
(
Äeque¡s
, 0,

391 
	`as£¹_u64_gt
(
cu¼uns
, 0,

395 
	`d®locx
(
p
, 0);

396 
	}
}

397 
TEST_END


399 
	$TEST_BEGIN
(
‹¡_¡©s_¬’as_hchunks
)

401 
¬’a
;

402 *
p
;

403 
ušt64_t
 
•och
, 
nm®loc
, 
nd®loc
;

404 
size_t
 
curhchunks
, 
sz
;

405 
ex³ùed
 = 
cÚfig_¡©s
 ? 0 : 
ENOENT
;

407 
¬’a
 = 0;

408 
	`as£¹_d_eq
(
	`m®lùl
("th»ad.¬’a", 
NULL
, NULL, (*)&
¬’a
,

409 (
¬’a
)), 0, "Unexpected mallctl() failure");

411 
p
 = 
	`m®locx
(
chunksize
, 0);

412 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected mallocx() failure");

414 
	`as£¹_d_eq
(
	`m®lùl
("•och", 
NULL
, NULL, (*)&
•och
, (epoch)),

417 
sz
 = (
ušt64_t
);

418 
	`as£¹_d_eq
(
	`m®lùl
("stats.arenas.0.hchunks.0.nmalloc",

419 (*)&
nm®loc
, &
sz
, 
NULL
, 0), 
ex³ùed
,

421 
	`as£¹_d_eq
(
	`m®lùl
("stats.arenas.0.hchunks.0.ndalloc",

422 (*)&
nd®loc
, &
sz
, 
NULL
, 0), 
ex³ùed
,

424 
sz
 = (
size_t
);

425 
	`as£¹_d_eq
(
	`m®lùl
("stats.arenas.0.hchunks.0.curhchunks",

426 (*)&
curhchunks
, &
sz
, 
NULL
, 0), 
ex³ùed
,

429 ià(
cÚfig_¡©s
) {

430 
	`as£¹_u64_gt
(
nm®loc
, 0,

432 
	`as£¹_u64_ge
(
nm®loc
, 
nd®loc
,

434 
	`as£¹_u64_gt
(
curhchunks
, 0,

438 
	`d®locx
(
p
, 0);

439 
	}
}

440 
TEST_END


443 
	$maš
()

446  (
	`‹¡
(

447 
‹¡_¡©s_summ¬y
,

448 
‹¡_¡©s_huge
,

449 
‹¡_¡©s_¬’as_summ¬y
,

450 
‹¡_¡©s_¬’as_sm®l
,

451 
‹¡_¡©s_¬’as_Ïrge
,

452 
‹¡_¡©s_¬’as_huge
,

453 
‹¡_¡©s_¬’as_bšs
,

454 
‹¡_¡©s_¬’as_Ìuns
,

455 
‹¡_¡©s_¬’as_hchunks
));

456 
	}
}

	@deps/jemalloc/test/unit/ticker.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	$TEST_BEGIN
(
‹¡_tick”_tick
)

5 
	#NREPS
 2

	)

6 
	#NTICKS
 3

	)

7 
tick”_t
 
tick”
;

8 
št32_t
 
i
, 
j
;

10 
	`tick”_š™
(&
tick”
, 
NTICKS
);

11 
i
 = 0; i < 
NREPS
; i++) {

12 
j
 = 0; j < 
NTICKS
; j++) {

13 
	`as£¹_u_eq
(
	`tick”_»ad
(&
tick”
), 
NTICKS
 - 
j
,

14 "UÃx³ùedick” v®u(i=%d, j=%d)", 
i
, 
j
);

15 
	`as£¹_çl£
(
	`tick”_tick
(&
tick”
),

16 "UÃx³ùedick” fœ(i=%d, j=%d)", 
i
, 
j
);

18 
	`as£¹_u32_eq
(
	`tick”_»ad
(&
tick”
), 0,

20 
	`as£¹_Œue
(
	`tick”_tick
(&
tick”
),

21 "Ex³ùedick” fœ(i=%d)", 
i
);

22 
	`as£¹_u32_eq
(
	`tick”_»ad
(&
tick”
), 
NTICKS
,

25 #undeà
NTICKS


26 
	}
}

27 
TEST_END


29 
	$TEST_BEGIN
(
‹¡_tick”_ticks
)

31 
	#NTICKS
 3

	)

32 
tick”_t
 
tick”
;

34 
	`tick”_š™
(&
tick”
, 
NTICKS
);

36 
	`as£¹_u_eq
(
	`tick”_»ad
(&
tick”
), 
NTICKS
, "Unexpectedicker value");

37 
	`as£¹_çl£
(
	`tick”_ticks
(&
tick”
, 
NTICKS
), "Unexpectedicker fire");

38 
	`as£¹_u_eq
(
	`tick”_»ad
(&
tick”
), 0, "Unexpectedicker value");

39 
	`as£¹_Œue
(
	`tick”_ticks
(&
tick”
, 
NTICKS
), "Expectedicker fire");

40 
	`as£¹_u_eq
(
	`tick”_»ad
(&
tick”
), 
NTICKS
, "Unexpectedicker value");

42 
	`as£¹_Œue
(
	`tick”_ticks
(&
tick”
, 
NTICKS
 + 1), "Expectedicker fire");

43 
	`as£¹_u_eq
(
	`tick”_»ad
(&
tick”
), 
NTICKS
, "Unexpectedicker value");

44 #undeà
NTICKS


45 
	}
}

46 
TEST_END


48 
	$TEST_BEGIN
(
‹¡_tick”_cİy
)

50 
	#NTICKS
 3

	)

51 
tick”_t
 

, 
tb
;

53 
	`tick”_š™
(&

, 
NTICKS
);

54 
	`tick”_cİy
(&
tb
, &

);

55 
	`as£¹_u_eq
(
	`tick”_»ad
(&
tb
), 
NTICKS
, "Unexpectedicker value");

56 
	`as£¹_Œue
(
	`tick”_ticks
(&
tb
, 
NTICKS
 + 1), "Expectedicker fire");

57 
	`as£¹_u_eq
(
	`tick”_»ad
(&
tb
), 
NTICKS
, "Unexpectedicker value");

59 
	`tick”_tick
(&

);

60 
	`tick”_cİy
(&
tb
, &

);

61 
	`as£¹_u_eq
(
	`tick”_»ad
(&
tb
), 
NTICKS
 - 1, "Unexpectedicker value");

62 
	`as£¹_Œue
(
	`tick”_ticks
(&
tb
, 
NTICKS
), "Expectedicker fire");

63 
	`as£¹_u_eq
(
	`tick”_»ad
(&
tb
), 
NTICKS
, "Unexpectedicker value");

64 #undeà
NTICKS


65 
	}
}

66 
TEST_END


69 
	$maš
()

72  (
	`‹¡
(

73 
‹¡_tick”_tick
,

74 
‹¡_tick”_ticks
,

75 
‹¡_tick”_cİy
));

76 
	}
}

	@deps/jemalloc/test/unit/tsd.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#THREAD_DATA
 0x72b65c10

	)

5 
	td©a_t
;

7 
boŞ
 
	gd©a_ş—nup_execu‹d
;

9 
	$m®loc_tsd_ty³s
(
d©a_
, 
d©a_t
)

10 
	$m®loc_tsd_´Ùos
(, 
d©a_
, 
d©a_t
)

13 
	$d©a_ş—nup
(*
¬g
)

15 
d©a_t
 *
d©a
 = (d©a_ˆ*)
¬g
;

17 ià(!
d©a_ş—nup_execu‹d
) {

18 
	`as£¹_x_eq
(*
d©a
, 
THREAD_DATA
,

22 
d©a_ş—nup_execu‹d
 = 
Œue
;

28 *
d©a
) {

29 
THREAD_DATA
:

30 *
d©a
 = 1;

31 
	`d©a_tsd_£t
(
d©a
);

34 *
d©a
 = 2;

35 
	`d©a_tsd_£t
(
d©a
);

40 
	`nÙ_»ached
();

44 *
p
 = 
	`m®locx
(1, 0);

45 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpeced mallocx() failure");

46 
	`d®locx
(
p
, 0);

48 
	}
}

50 
	$m®loc_tsd_ex‹ºs
(
d©a_
, 
d©a_t
)

51 
	#DATA_INIT
 0x12345678

	)

52 
	$m®loc_tsd_d©a
(, 
d©a_
, 
d©a_t
, 
DATA_INIT
)

53 
	$m®loc_tsd_funcs
(, 
d©a_
, 
d©a_t
, 
DATA_INIT
, 
d©a_ş—nup
)

56 
	$thd_¡¬t
(*
¬g
)

58 
d©a_t
 
d
 = (d©a_t)(
ušŒ_t
)
¬g
;

59 *
p
;

61 
	`as£¹_x_eq
(*
	`d©a_tsd_g‘
(
Œue
), 
DATA_INIT
,

64 
p
 = 
	`m®loc
(1);

65 
	`as£¹_±r_nÙ_nuÎ
(
p
, "Unexpected malloc() failure");

67 
	`d©a_tsd_£t
(&
d
);

68 
	`as£¹_x_eq
(*
	`d©a_tsd_g‘
(
Œue
), 
d
,

71 
d
 = 0;

72 
	`as£¹_x_eq
(*
	`d©a_tsd_g‘
(
Œue
), (
d©a_t
)(
ušŒ_t
)
¬g
,

75 
	`ä“
(
p
);

76  (
NULL
);

77 
	}
}

79 
	$TEST_BEGIN
(
‹¡_tsd_maš_th»ad
)

82 
	`thd_¡¬t
((*)(
ušŒ_t
)0xa5f3e329);

83 
	}
}

84 
TEST_END


86 
	$TEST_BEGIN
(
‹¡_tsd_sub_th»ad
)

88 
thd_t
 
thd
;

90 
d©a_ş—nup_execu‹d
 = 
çl£
;

91 
	`thd_ü—‹
(&
thd
, 
thd_¡¬t
, (*)
THREAD_DATA
);

92 
	`thd_još
(
thd
, 
NULL
);

93 
	`as£¹_Œue
(
d©a_ş—nup_execu‹d
,

95 
	}
}

96 
TEST_END


99 
	$maš
()

103 ià(
	`ÇÎocx
(1, 0) == 0) {

104 
	`m®loc_´štf
("Initializationƒrror");

105  (
‹¡_¡©us_ç
);

107 
	`d©a_tsd_boÙ
();

109  (
	`‹¡
(

110 
‹¡_tsd_maš_th»ad
,

111 
‹¡_tsd_sub_th»ad
));

112 
	}
}

	@deps/jemalloc/test/unit/util.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
	#TEST_POW2_CEIL
(
t
, 
suf
, 
´i
) do { \

4 
i
, 
pow2
; \

5 
t
 
x
; \

7 
as£¹_
##
suf
##
	`_eq
(
pow2_û_
##
	`suf
(0), 0, "Unexpected„esult"); \

9 
i
 = 0; i < (
t
) * 8; i++) { \

10 
as£¹_
##
suf
##
	`_eq
(
pow2_û_
##
	`suf
(((
t
)1è<< 
i
), ((t)1) \

11 << 
i
, "Unexpected„esult"); \

14 
i
 = 2; i < (
t
) * 8; i++) { \

15 
as£¹_
##
suf
##
	`_eq
(
pow2_û_
##
	`suf
((((
t
)1è<< 
i
) - 1), \

16 ((
t
)1è<< 
i
, "Unexpected„esult"); \

19 
i
 = 0; i < (
t
) * 8 - 1; i++) { \

20 
as£¹_
##
suf
##
	`_eq
(
pow2_û_
##
	`suf
((((
t
)1è<< 
i
) + 1), \

21 ((
t
)1è<< (
i
+1), "Unexpected„esult"); \

24 
pow2
 = 1;…ow2 < 25;…ow2++) { \

25 
x
 = (((
t
)1è<< (
pow2
-1)) + 1; x <= ((t)1) <<…ow2; \

26 
x
++) { \

27 
as£¹_
##
suf
##
	`_eq
(
pow2_û_
##
	`suf
(
x
), \

28 ((
t
)1è<< 
pow2
, \

29 "UÃx³ùed„esuÉ, x=%"
´i
, 
x
); \

32 } 0)

	)

34 
	$TEST_BEGIN
(
‹¡_pow2_û_u64
)

37 
	`TEST_POW2_CEIL
(
ušt64_t
, 
u64
, 
FMTu64
);

38 
	}
}

39 
TEST_END


41 
	$TEST_BEGIN
(
‹¡_pow2_û_u32
)

44 
	`TEST_POW2_CEIL
(
ušt32_t
, 
u32
, 
FMTu32
);

45 
	}
}

46 
TEST_END


48 
	$TEST_BEGIN
(
‹¡_pow2_û_zu
)

51 
	`TEST_POW2_CEIL
(
size_t
, 
zu
, "zu");

52 
	}
}

53 
TEST_END


55 
	$TEST_BEGIN
(
‹¡_m®loc_¡¹oumax_no_’d±r
)

57 
”r
;

59 
	`£t_”ºo
(0);

60 
	`as£¹_ju_eq
(
	`m®loc_¡¹oumax
("0", 
NULL
, 0), 0, "Unexpected„esult");

61 
”r
 = 
	`g‘_”ºo
();

62 
	`as£¹_d_eq
(
”r
, 0, "Unexpected failure");

63 
	}
}

64 
TEST_END


66 
	$TEST_BEGIN
(
‹¡_m®loc_¡¹oumax
)

68 
	s‹¡_s
 {

69 cÚ¡ *
šput
;

70 cÚ¡ *
ex³ùed_»mašd”
;

71 
ba£
;

72 
ex³ùed_”ºo
;

73 cÚ¡ *
ex³ùed_”ºo_Çme
;

74 
uštmax_t
 
ex³ùed_x
;

76 
	#ERR
(
e
èe, #e

	)

77 
	#KUMAX
(
x
è((
uštmax_t
)x##
ULL
)

	)

78 
	#KSMAX
(
x
è((
uštmax_t
)(
štmax_t
)x##
LL
)

	)

79 
‹¡_s
 
‹¡s
[] = {

80 {"0", "0", -1, 
	`ERR
(
EINVAL
), 
UINTMAX_MAX
},

81 {"0", "0", 1, 
	`ERR
(
EINVAL
), 
UINTMAX_MAX
},

82 {"0", "0", 37, 
	`ERR
(
EINVAL
), 
UINTMAX_MAX
},

84 {"", "", 0, 
	`ERR
(
EINVAL
), 
UINTMAX_MAX
},

85 {"+", "+", 0, 
	`ERR
(
EINVAL
), 
UINTMAX_MAX
},

86 {"++3", "++3", 0, 
	`ERR
(
EINVAL
), 
UINTMAX_MAX
},

87 {"-", "-", 0, 
	`ERR
(
EINVAL
), 
UINTMAX_MAX
},

89 {"42", "", 0, 
	`ERR
(0), 
	`KUMAX
(42)},

90 {"+42", "", 0, 
	`ERR
(0), 
	`KUMAX
(42)},

91 {"-42", "", 0, 
	`ERR
(0), 
	`KSMAX
(-42)},

92 {"042", "", 0, 
	`ERR
(0), 
	`KUMAX
(042)},

93 {"+042", "", 0, 
	`ERR
(0), 
	`KUMAX
(042)},

94 {"-042", "", 0, 
	`ERR
(0), 
	`KSMAX
(-042)},

95 {"0x42", "", 0, 
	`ERR
(0), 
	`KUMAX
(0x42)},

96 {"+0x42", "", 0, 
	`ERR
(0), 
	`KUMAX
(0x42)},

97 {"-0x42", "", 0, 
	`ERR
(0), 
	`KSMAX
(-0x42)},

99 {"0", "", 0, 
	`ERR
(0), 
	`KUMAX
(0)},

100 {"1", "", 0, 
	`ERR
(0), 
	`KUMAX
(1)},

102 {"42", "", 0, 
	`ERR
(0), 
	`KUMAX
(42)},

103 {" 42", "", 0, 
	`ERR
(0), 
	`KUMAX
(42)},

104 {"42 ", " ", 0, 
	`ERR
(0), 
	`KUMAX
(42)},

105 {"0x", "x", 0, 
	`ERR
(0), 
	`KUMAX
(0)},

106 {"42x", "x", 0, 
	`ERR
(0), 
	`KUMAX
(42)},

108 {"07", "", 0, 
	`ERR
(0), 
	`KUMAX
(7)},

109 {"010", "", 0, 
	`ERR
(0), 
	`KUMAX
(8)},

110 {"08", "8", 0, 
	`ERR
(0), 
	`KUMAX
(0)},

111 {"0_", "_", 0, 
	`ERR
(0), 
	`KUMAX
(0)},

113 {"0x", "x", 0, 
	`ERR
(0), 
	`KUMAX
(0)},

114 {"0X", "X", 0, 
	`ERR
(0), 
	`KUMAX
(0)},

115 {"0xg", "xg", 0, 
	`ERR
(0), 
	`KUMAX
(0)},

116 {"0XA", "", 0, 
	`ERR
(0), 
	`KUMAX
(10)},

118 {"010", "", 10, 
	`ERR
(0), 
	`KUMAX
(10)},

119 {"0x3", "x3", 10, 
	`ERR
(0), 
	`KUMAX
(0)},

121 {"12", "2", 2, 
	`ERR
(0), 
	`KUMAX
(1)},

122 {"78", "8", 8, 
	`ERR
(0), 
	`KUMAX
(7)},

123 {"9a", "a", 10, 
	`ERR
(0), 
	`KUMAX
(9)},

124 {"9A", "A", 10, 
	`ERR
(0), 
	`KUMAX
(9)},

125 {"fg", "g", 16, 
	`ERR
(0), 
	`KUMAX
(15)},

126 {"FG", "G", 16, 
	`ERR
(0), 
	`KUMAX
(15)},

127 {"0xfg", "g", 16, 
	`ERR
(0), 
	`KUMAX
(15)},

128 {"0XFG", "G", 16, 
	`ERR
(0), 
	`KUMAX
(15)},

129 {"z_", "_", 36, 
	`ERR
(0), 
	`KUMAX
(35)},

130 {"Z_", "_", 36, 
	`ERR
(0), 
	`KUMAX
(35)}

132 #undeà
ERR


133 #undeà
KUMAX


134 #undeà
KSMAX


135 
i
;

137 
i
 = 0; i < (
‹¡s
)/(
‹¡_s
); i++) {

138 
‹¡_s
 *
‹¡
 = &
‹¡s
[
i
];

139 
”r
;

140 
uštmax_t
 
»suÉ
;

141 *
»mašd”
;

143 
	`£t_”ºo
(0);

144 
»suÉ
 = 
	`m®loc_¡¹oumax
(
‹¡
->
šput
, &
»mašd”
,e¡->
ba£
);

145 
”r
 = 
	`g‘_”ºo
();

146 
	`as£¹_d_eq
(
”r
, 
‹¡
->
ex³ùed_”ºo
,

148 
‹¡
->
ex³ùed_”ºo_Çme
,e¡->
šput
,e¡->
ba£
);

149 
	`as£¹_¡r_eq
(
»mašd”
, 
‹¡
->
ex³ùed_»mašd”
,

151 
‹¡
->
šput
,e¡->
ba£
);

152 ià(
”r
 == 0) {

153 
	`as£¹_ju_eq
(
»suÉ
, 
‹¡
->
ex³ùed_x
,

155 
‹¡
->
šput
,e¡->
ba£
);

158 
	}
}

159 
TEST_END


161 
	$TEST_BEGIN
(
‹¡_m®loc_¢´štf_Œunÿ‹d
)

163 
	#BUFLEN
 15

	)

164 
buf
[
BUFLEN
];

165 
size_t
 
»suÉ
;

166 
size_t
 
Ën
;

167 
	#TEST
(
ex³ùed_¡r_uÁrunÿ‹d
, ...) do { \

168 
»suÉ
 = 
	`m®loc_¢´štf
(
buf
, 
Ën
, 
__VA_ARGS__
); \

169 
	`as£¹_d_eq
(
	`¡ºcmp
(
buf
, 
ex³ùed_¡r_uÁrunÿ‹d
, 
Ën
-1), 0, \

171 
buf
, 
ex³ùed_¡r_uÁrunÿ‹d
); \

172 
	`as£¹_zu_eq
(
»suÉ
, 
	`¡¾’
(
ex³ùed_¡r_uÁrunÿ‹d
), \

174 } 0)

	)

176 
Ën
 = 1;†’ < 
BUFLEN
;†en++) {

177 
	`TEST
("012346789", "012346789");

178 
	`TEST
("a0123b", "a%sb", "0123");

179 
	`TEST
("a01234567", "a%s%s", "0123", "4567");

180 
	`TEST
("a0123 ", "a%-6s", "0123");

181 
	`TEST
("a 0123", "a%6s", "0123");

182 
	`TEST
("a 012", "a%6.3s", "0123");

183 
	`TEST
("a 012", "a%*.*s", 6, 3, "0123");

184 
	`TEST
("a 123b", "a% db", 123);

185 
	`TEST
("a123b", "a%-db", 123);

186 
	`TEST
("a-123b", "a%-db", -123);

187 
	`TEST
("a+123b", "a%+db", 123);

189 #undeà
BUFLEN


190 #undeà
TEST


191 
	}
}

192 
TEST_END


194 
	$TEST_BEGIN
(
‹¡_m®loc_¢´štf
)

196 
	#BUFLEN
 128

	)

197 
buf
[
BUFLEN
];

198 
size_t
 
»suÉ
;

199 
	#TEST
(
ex³ùed_¡r
, ...) do { \

200 
»suÉ
 = 
	`m®loc_¢´štf
(
buf
, (buf), 
__VA_ARGS__
); \

201 
	`as£¹_¡r_eq
(
buf
, 
ex³ùed_¡r
, "Unexpected output"); \

202 
	`as£¹_zu_eq
(
»suÉ
, 
	`¡¾’
(
ex³ùed_¡r
), "Unexpected„esult");\

203 } 0)

	)

205 
	`TEST
("hello", "hello");

207 
	`TEST
("50%, 100%", "50%%, %d%%", 100);

209 
	`TEST
("a0123b", "a%sb", "0123");

211 
	`TEST
("a 0123b", "a%5sb", "0123");

212 
	`TEST
("a 0123b", "a%*sb", 5, "0123");

214 
	`TEST
("a0123 b", "a%-5sb", "0123");

215 
	`TEST
("a0123b", "a%*sb", -1, "0123");

216 
	`TEST
("a0123 b", "a%*sb", -5, "0123");

217 
	`TEST
("a0123 b", "a%-*sb", -5, "0123");

219 
	`TEST
("a012b", "a%.3sb", "0123");

220 
	`TEST
("a012b", "a%.*sb", 3, "0123");

221 
	`TEST
("a0123b", "a%.*sb", -3, "0123");

223 
	`TEST
("a 012b", "a%5.3sb", "0123");

224 
	`TEST
("a 012b", "a%5.*sb", 3, "0123");

225 
	`TEST
("a 012b", "a%*.3sb", 5, "0123");

226 
	`TEST
("a 012b", "a%*.*sb", 5, 3, "0123");

227 
	`TEST
("a 0123b", "a%*.*sb", 5, -3, "0123");

229 
	`TEST
("_abcd_", "_%x_", 0xabcd);

230 
	`TEST
("_0xabcd_", "_%#x_", 0xabcd);

231 
	`TEST
("_1234_", "_%o_", 01234);

232 
	`TEST
("_01234_", "_%#o_", 01234);

233 
	`TEST
("_1234_", "_%u_", 1234);

235 
	`TEST
("_1234_", "_%d_", 1234);

236 
	`TEST
("_ 1234_", "_% d_", 1234);

237 
	`TEST
("_+1234_", "_%+d_", 1234);

238 
	`TEST
("_-1234_", "_%d_", -1234);

239 
	`TEST
("_-1234_", "_% d_", -1234);

240 
	`TEST
("_-1234_", "_%+d_", -1234);

242 
	`TEST
("_-1234_", "_%d_", -1234);

243 
	`TEST
("_1234_", "_%d_", 1234);

244 
	`TEST
("_-1234_", "_%i_", -1234);

245 
	`TEST
("_1234_", "_%i_", 1234);

246 
	`TEST
("_01234_", "_%#o_", 01234);

247 
	`TEST
("_1234_", "_%u_", 1234);

248 
	`TEST
("_0x1234abc_", "_%#x_", 0x1234abc);

249 
	`TEST
("_0X1234ABC_", "_%#X_", 0x1234abc);

250 
	`TEST
("_c_", "_%c_", 'c');

251 
	`TEST
("_string_", "_%s_", "string");

252 
	`TEST
("_0x42_", "_%p_", ((*)0x42));

254 
	`TEST
("_-1234_", "_%ld_", (()-1234));

255 
	`TEST
("_1234_", "_%ld_", (()1234));

256 
	`TEST
("_-1234_", "_%li_", (()-1234));

257 
	`TEST
("_1234_", "_%li_", (()1234));

258 
	`TEST
("_01234_", "_%#lo_", (()01234));

259 
	`TEST
("_1234_", "_%lu_", (()1234));

260 
	`TEST
("_0x1234abc_", "_%#lx_", (()0x1234abc));

261 
	`TEST
("_0X1234ABC_", "_%#lX_", (()0x1234ABC));

263 
	`TEST
("_-1234_", "_%lld_", (()-1234));

264 
	`TEST
("_1234_", "_%lld_", (()1234));

265 
	`TEST
("_-1234_", "_%lli_", (()-1234));

266 
	`TEST
("_1234_", "_%lli_", (()1234));

267 
	`TEST
("_01234_", "_%#llo_", (()01234));

268 
	`TEST
("_1234_", "_%llu_", (()1234));

269 
	`TEST
("_0x1234abc_", "_%#llx_", (()0x1234abc));

270 
	`TEST
("_0X1234ABC_", "_%#llX_", (()0x1234ABC));

272 
	`TEST
("_-1234_", "_%qd_", (()-1234));

273 
	`TEST
("_1234_", "_%qd_", (()1234));

274 
	`TEST
("_-1234_", "_%qi_", (()-1234));

275 
	`TEST
("_1234_", "_%qi_", (()1234));

276 
	`TEST
("_01234_", "_%#qo_", (()01234));

277 
	`TEST
("_1234_", "_%qu_", (()1234));

278 
	`TEST
("_0x1234abc_", "_%#qx_", (()0x1234abc));

279 
	`TEST
("_0X1234ABC_", "_%#qX_", (()0x1234ABC));

281 
	`TEST
("_-1234_", "_%jd_", ((
štmax_t
)-1234));

282 
	`TEST
("_1234_", "_%jd_", ((
štmax_t
)1234));

283 
	`TEST
("_-1234_", "_%ji_", ((
štmax_t
)-1234));

284 
	`TEST
("_1234_", "_%ji_", ((
štmax_t
)1234));

285 
	`TEST
("_01234_", "_%#jo_", ((
štmax_t
)01234));

286 
	`TEST
("_1234_", "_%ju_", ((
štmax_t
)1234));

287 
	`TEST
("_0x1234abc_", "_%#jx_", ((
štmax_t
)0x1234abc));

288 
	`TEST
("_0X1234ABC_", "_%#jX_", ((
štmax_t
)0x1234ABC));

290 
	`TEST
("_1234_", "_%td_", ((
±rdiff_t
)1234));

291 
	`TEST
("_-1234_", "_%td_", ((
±rdiff_t
)-1234));

292 
	`TEST
("_1234_", "_%ti_", ((
±rdiff_t
)1234));

293 
	`TEST
("_-1234_", "_%ti_", ((
±rdiff_t
)-1234));

295 
	`TEST
("_-1234_", "_%zd_", ((
ssize_t
)-1234));

296 
	`TEST
("_1234_", "_%zd_", ((
ssize_t
)1234));

297 
	`TEST
("_-1234_", "_%zi_", ((
ssize_t
)-1234));

298 
	`TEST
("_1234_", "_%zi_", ((
ssize_t
)1234));

299 
	`TEST
("_01234_", "_%#zo_", ((
ssize_t
)01234));

300 
	`TEST
("_1234_", "_%zu_", ((
ssize_t
)1234));

301 
	`TEST
("_0x1234abc_", "_%#zx_", ((
ssize_t
)0x1234abc));

302 
	`TEST
("_0X1234ABC_", "_%#zX_", ((
ssize_t
)0x1234ABC));

303 #undeà
BUFLEN


304 
	}
}

305 
TEST_END


308 
	$maš
()

311  (
	`‹¡
(

312 
‹¡_pow2_û_u64
,

313 
‹¡_pow2_û_u32
,

314 
‹¡_pow2_û_zu
,

315 
‹¡_m®loc_¡¹oumax_no_’d±r
,

316 
‹¡_m®loc_¡¹oumax
,

317 
‹¡_m®loc_¢´štf_Œunÿ‹d
,

318 
‹¡_m®loc_¢´štf
));

319 
	}
}

	@deps/jemalloc/test/unit/witness.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 
w™Ãss_lock_”rÜ_t
 *
	gw™Ãss_lock_”rÜ_Üig
;

4 
w™Ãss_owÃr_”rÜ_t
 *
	gw™Ãss_owÃr_”rÜ_Üig
;

5 
w™Ãss_nÙ_owÃr_”rÜ_t
 *
	gw™Ãss_nÙ_owÃr_”rÜ_Üig
;

6 
w™Ãss_lockËss_”rÜ_t
 *
	gw™Ãss_lockËss_”rÜ_Üig
;

8 
boŞ
 
	g§w_lock_”rÜ
;

9 
boŞ
 
	g§w_owÃr_”rÜ
;

10 
boŞ
 
	g§w_nÙ_owÃr_”rÜ
;

11 
boŞ
 
	g§w_lockËss_”rÜ
;

14 
	$w™Ãss_lock_”rÜ_š‹rû±
(cÚ¡ 
w™Ãss_li¡_t
 *
w™Ãs£s
,

15 cÚ¡ 
w™Ãss_t
 *
w™Ãss
)

18 
§w_lock_”rÜ
 = 
Œue
;

19 
	}
}

22 
	$w™Ãss_owÃr_”rÜ_š‹rû±
(cÚ¡ 
w™Ãss_t
 *
w™Ãss
)

25 
§w_owÃr_”rÜ
 = 
Œue
;

26 
	}
}

29 
	$w™Ãss_nÙ_owÃr_”rÜ_š‹rû±
(cÚ¡ 
w™Ãss_t
 *
w™Ãss
)

32 
§w_nÙ_owÃr_”rÜ
 = 
Œue
;

33 
	}
}

36 
	$w™Ãss_lockËss_”rÜ_š‹rû±
(cÚ¡ 
w™Ãss_li¡_t
 *
w™Ãs£s
)

39 
§w_lockËss_”rÜ
 = 
Œue
;

40 
	}
}

43 
	$w™Ãss_comp
(cÚ¡ 
w™Ãss_t
 *
a
, cÚ¡ w™Ãss_ˆ*
b
)

46 
	`as£¹_u_eq
(
a
->
¿nk
, 
b
->rank, "Witnesses should haveƒqual„ank");

48  (
	`¡rcmp
(
a
->
Çme
, 
b
->name));

49 
	}
}

52 
	$w™Ãss_comp_»v”£
(cÚ¡ 
w™Ãss_t
 *
a
, cÚ¡ w™Ãss_ˆ*
b
)

55 
	`as£¹_u_eq
(
a
->
¿nk
, 
b
->rank, "Witnesses should haveƒqual„ank");

57  (-
	`¡rcmp
(
a
->
Çme
, 
b
->name));

58 
	}
}

60 
	$TEST_BEGIN
(
‹¡_w™Ãss
)

62 
w™Ãss_t
 
a
, 
b
;

63 
tsdn_t
 *
tsdn
;

65 
	`‹¡_sk_if
(!
cÚfig_debug
);

67 
tsdn
 = 
	`tsdn_ãtch
();

69 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

71 
	`w™Ãss_š™
(&
a
, "a", 1, 
NULL
);

72 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn
, &
a
);

73 
	`w™Ãss_lock
(
tsdn
, &
a
);

74 
	`w™Ãss_as£¹_owÃr
(
tsdn
, &
a
);

76 
	`w™Ãss_š™
(&
b
, "b", 2, 
NULL
);

77 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn
, &
b
);

78 
	`w™Ãss_lock
(
tsdn
, &
b
);

79 
	`w™Ãss_as£¹_owÃr
(
tsdn
, &
b
);

81 
	`w™Ãss_uÆock
(
tsdn
, &
a
);

82 
	`w™Ãss_uÆock
(
tsdn
, &
b
);

84 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

85 
	}
}

86 
TEST_END


88 
	$TEST_BEGIN
(
‹¡_w™Ãss_comp
)

90 
w™Ãss_t
 
a
, 
b
, 
c
, 
d
;

91 
tsdn_t
 *
tsdn
;

93 
	`‹¡_sk_if
(!
cÚfig_debug
);

95 
tsdn
 = 
	`tsdn_ãtch
();

97 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

99 
	`w™Ãss_š™
(&
a
, "a", 1, 
w™Ãss_comp
);

100 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn
, &
a
);

101 
	`w™Ãss_lock
(
tsdn
, &
a
);

102 
	`w™Ãss_as£¹_owÃr
(
tsdn
, &
a
);

104 
	`w™Ãss_š™
(&
b
, "b", 1, 
w™Ãss_comp
);

105 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn
, &
b
);

106 
	`w™Ãss_lock
(
tsdn
, &
b
);

107 
	`w™Ãss_as£¹_owÃr
(
tsdn
, &
b
);

108 
	`w™Ãss_uÆock
(
tsdn
, &
b
);

110 
w™Ãss_lock_”rÜ_Üig
 = 
w™Ãss_lock_”rÜ
;

111 
w™Ãss_lock_”rÜ
 = 
w™Ãss_lock_”rÜ_š‹rû±
;

112 
§w_lock_”rÜ
 = 
çl£
;

114 
	`w™Ãss_š™
(&
c
, "c", 1, 
w™Ãss_comp_»v”£
);

115 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn
, &
c
);

116 
	`as£¹_çl£
(
§w_lock_”rÜ
, "Unexpected witness†ockƒrror");

117 
	`w™Ãss_lock
(
tsdn
, &
c
);

118 
	`as£¹_Œue
(
§w_lock_”rÜ
, "Expected witness†ockƒrror");

119 
	`w™Ãss_uÆock
(
tsdn
, &
c
);

121 
§w_lock_”rÜ
 = 
çl£
;

123 
	`w™Ãss_š™
(&
d
, "d", 1, 
NULL
);

124 
	`w™Ãss_as£¹_nÙ_owÃr
(
tsdn
, &
d
);

125 
	`as£¹_çl£
(
§w_lock_”rÜ
, "Unexpected witness†ockƒrror");

126 
	`w™Ãss_lock
(
tsdn
, &
d
);

127 
	`as£¹_Œue
(
§w_lock_”rÜ
, "Expected witness†ockƒrror");

128 
	`w™Ãss_uÆock
(
tsdn
, &
d
);

130 
	`w™Ãss_uÆock
(
tsdn
, &
a
);

132 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

134 
w™Ãss_lock_”rÜ
 = 
w™Ãss_lock_”rÜ_Üig
;

135 
	}
}

136 
TEST_END


138 
	$TEST_BEGIN
(
‹¡_w™Ãss_»v”§l
)

140 
w™Ãss_t
 
a
, 
b
;

141 
tsdn_t
 *
tsdn
;

143 
	`‹¡_sk_if
(!
cÚfig_debug
);

145 
w™Ãss_lock_”rÜ_Üig
 = 
w™Ãss_lock_”rÜ
;

146 
w™Ãss_lock_”rÜ
 = 
w™Ãss_lock_”rÜ_š‹rû±
;

147 
§w_lock_”rÜ
 = 
çl£
;

149 
tsdn
 = 
	`tsdn_ãtch
();

151 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

153 
	`w™Ãss_š™
(&
a
, "a", 1, 
NULL
);

154 
	`w™Ãss_š™
(&
b
, "b", 2, 
NULL
);

156 
	`w™Ãss_lock
(
tsdn
, &
b
);

157 
	`as£¹_çl£
(
§w_lock_”rÜ
, "Unexpected witness†ockƒrror");

158 
	`w™Ãss_lock
(
tsdn
, &
a
);

159 
	`as£¹_Œue
(
§w_lock_”rÜ
, "Expected witness†ockƒrror");

161 
	`w™Ãss_uÆock
(
tsdn
, &
a
);

162 
	`w™Ãss_uÆock
(
tsdn
, &
b
);

164 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

166 
w™Ãss_lock_”rÜ
 = 
w™Ãss_lock_”rÜ_Üig
;

167 
	}
}

168 
TEST_END


170 
	$TEST_BEGIN
(
‹¡_w™Ãss_»cursive
)

172 
w™Ãss_t
 
a
;

173 
tsdn_t
 *
tsdn
;

175 
	`‹¡_sk_if
(!
cÚfig_debug
);

177 
w™Ãss_nÙ_owÃr_”rÜ_Üig
 = 
w™Ãss_nÙ_owÃr_”rÜ
;

178 
w™Ãss_nÙ_owÃr_”rÜ
 = 
w™Ãss_nÙ_owÃr_”rÜ_š‹rû±
;

179 
§w_nÙ_owÃr_”rÜ
 = 
çl£
;

181 
w™Ãss_lock_”rÜ_Üig
 = 
w™Ãss_lock_”rÜ
;

182 
w™Ãss_lock_”rÜ
 = 
w™Ãss_lock_”rÜ_š‹rû±
;

183 
§w_lock_”rÜ
 = 
çl£
;

185 
tsdn
 = 
	`tsdn_ãtch
();

187 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

189 
	`w™Ãss_š™
(&
a
, "a", 1, 
NULL
);

191 
	`w™Ãss_lock
(
tsdn
, &
a
);

192 
	`as£¹_çl£
(
§w_lock_”rÜ
, "Unexpected witness†ockƒrror");

193 
	`as£¹_çl£
(
§w_nÙ_owÃr_”rÜ
, "Unexpected witness‚ot ownerƒrror");

194 
	`w™Ãss_lock
(
tsdn
, &
a
);

195 
	`as£¹_Œue
(
§w_lock_”rÜ
, "Expected witness†ockƒrror");

196 
	`as£¹_Œue
(
§w_nÙ_owÃr_”rÜ
, "Expected witness‚ot ownerƒrror");

198 
	`w™Ãss_uÆock
(
tsdn
, &
a
);

200 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

202 
w™Ãss_owÃr_”rÜ
 = 
w™Ãss_owÃr_”rÜ_Üig
;

203 
w™Ãss_lock_”rÜ
 = 
w™Ãss_lock_”rÜ_Üig
;

205 
	}
}

206 
TEST_END


208 
	$TEST_BEGIN
(
‹¡_w™Ãss_uÆock_nÙ_owÃd
)

210 
w™Ãss_t
 
a
;

211 
tsdn_t
 *
tsdn
;

213 
	`‹¡_sk_if
(!
cÚfig_debug
);

215 
w™Ãss_owÃr_”rÜ_Üig
 = 
w™Ãss_owÃr_”rÜ
;

216 
w™Ãss_owÃr_”rÜ
 = 
w™Ãss_owÃr_”rÜ_š‹rû±
;

217 
§w_owÃr_”rÜ
 = 
çl£
;

219 
tsdn
 = 
	`tsdn_ãtch
();

221 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

223 
	`w™Ãss_š™
(&
a
, "a", 1, 
NULL
);

225 
	`as£¹_çl£
(
§w_owÃr_”rÜ
, "Unexpected ownerƒrror");

226 
	`w™Ãss_uÆock
(
tsdn
, &
a
);

227 
	`as£¹_Œue
(
§w_owÃr_”rÜ
, "Expected ownerƒrror");

229 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

231 
w™Ãss_owÃr_”rÜ
 = 
w™Ãss_owÃr_”rÜ_Üig
;

232 
	}
}

233 
TEST_END


235 
	$TEST_BEGIN
(
‹¡_w™Ãss_lockful
)

237 
w™Ãss_t
 
a
;

238 
tsdn_t
 *
tsdn
;

240 
	`‹¡_sk_if
(!
cÚfig_debug
);

242 
w™Ãss_lockËss_”rÜ_Üig
 = 
w™Ãss_lockËss_”rÜ
;

243 
w™Ãss_lockËss_”rÜ
 = 
w™Ãss_lockËss_”rÜ_š‹rû±
;

244 
§w_lockËss_”rÜ
 = 
çl£
;

246 
tsdn
 = 
	`tsdn_ãtch
();

248 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

250 
	`w™Ãss_š™
(&
a
, "a", 1, 
NULL
);

252 
	`as£¹_çl£
(
§w_lockËss_”rÜ
, "Unexpected†ocklessƒrror");

253 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

255 
	`w™Ãss_lock
(
tsdn
, &
a
);

256 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

257 
	`as£¹_Œue
(
§w_lockËss_”rÜ
, "Expected†ocklessƒrror");

259 
	`w™Ãss_uÆock
(
tsdn
, &
a
);

261 
	`w™Ãss_as£¹_lockËss
(
tsdn
);

263 
w™Ãss_lockËss_”rÜ
 = 
w™Ãss_lockËss_”rÜ_Üig
;

264 
	}
}

265 
TEST_END


268 
	$maš
()

271  (
	`‹¡
(

272 
‹¡_w™Ãss
,

273 
‹¡_w™Ãss_comp
,

274 
‹¡_w™Ãss_»v”§l
,

275 
‹¡_w™Ãss_»cursive
,

276 
‹¡_w™Ãss_uÆock_nÙ_owÃd
,

277 
‹¡_w™Ãss_lockful
));

278 
	}
}

	@deps/jemalloc/test/unit/zero.c

1 
	~"‹¡/jem®loc_‹¡.h
"

3 #ifdeà
JEMALLOC_FILL


4 cÚ¡ *
	gm®loc_cÚf
 =

9 
	$‹¡_z”o
(
size_t
 
sz_mš
, size_ˆ
sz_max
)

11 
ušt8_t
 *
s
;

12 
size_t
 
sz_´ev
, 
sz
, 
i
;

13 
	#MAGIC
 ((
ušt8_t
)0x61)

	)

15 
sz_´ev
 = 0;

16 
s
 = (
ušt8_t
 *)
	`m®locx
(
sz_mš
, 0);

17 
	`as£¹_±r_nÙ_nuÎ
((*)
s
, "Unexpected mallocx() failure");

19 
sz
 = 
	`§Îocx
(
s
, 0); sz <ğ
sz_max
;

20 
sz_´ev
 = 
sz
, sz = 
	`§Îocx
(
s
, 0)) {

21 ià(
sz_´ev
 > 0) {

22 
	`as£¹_u_eq
(
s
[0], 
MAGIC
,

24 
	`ZU
(0), 
sz_´ev
);

25 
	`as£¹_u_eq
(
s
[
sz_´ev
-1], 
MAGIC
,

27 
sz_´ev
-1, sz_prev);

30 
i
 = 
sz_´ev
; i < 
sz
; i++) {

31 
	`as£¹_u_eq
(
s
[
i
], 0x0,

33 
i
, 
sz
);

34 
s
[
i
] = 
MAGIC
;

37 ià(
	`x®locx
(
s
, 
sz
+1, 0, 0) == sz) {

38 
s
 = (
ušt8_t
 *)
	`¿Îocx
(s, 
sz
+1, 0);

39 
	`as£¹_±r_nÙ_nuÎ
((*)
s
,

44 
	`d®locx
(
s
, 0);

45 #undeà
MAGIC


46 
	}
}

48 
	$TEST_BEGIN
(
‹¡_z”o_sm®l
)

51 
	`‹¡_sk_if
(!
cÚfig_fl
);

52 
	`‹¡_z”o
(1, 
SMALL_MAXCLASS
-1);

53 
	}
}

54 
TEST_END


56 
	$TEST_BEGIN
(
‹¡_z”o_Ïrge
)

59 
	`‹¡_sk_if
(!
cÚfig_fl
);

60 
	`‹¡_z”o
(
SMALL_MAXCLASS
+1, 
Ïrge_maxşass
);

61 
	}
}

62 
TEST_END


64 
	$TEST_BEGIN
(
‹¡_z”o_huge
)

67 
	`‹¡_sk_if
(!
cÚfig_fl
);

68 
	`‹¡_z”o
(
Ïrge_maxşass
+1, 
chunksize
*2);

69 
	}
}

70 
TEST_END


73 
	$maš
()

76  (
	`‹¡
(

77 
‹¡_z”o_sm®l
,

78 
‹¡_z”o_Ïrge
,

79 
‹¡_z”o_huge
));

80 
	}
}

	@deps/linenoise/example.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~"lš’oi£.h
"

7 
	$com¶‘iÚ
(cÚ¡ *
buf
, 
lš’oi£Com¶‘iÚs
 *
lc
) {

8 ià(
buf
[0] == 'h') {

9 
	`lš’oi£AddCom¶‘iÚ
(
lc
,"hello");

10 
	`lš’oi£AddCom¶‘iÚ
(
lc
,"hellohere");

12 
	}
}

14 *
	$hšts
(cÚ¡ *
buf
, *
cŞÜ
, *
bŞd
) {

15 ià(!
	`¡rÿ£cmp
(
buf
,"hello")) {

16 *
cŞÜ
 = 35;

17 *
bŞd
 = 0;

20  
NULL
;

21 
	}
}

23 
	$maš
(
¬gc
, **
¬gv
) {

24 *
lše
;

25 *
´gÇme
 = 
¬gv
[0];

28 
¬gc
 > 1) {

29 
¬gc
--;

30 
¬gv
++;

31 ià(!
	`¡rcmp
(*
¬gv
,"--multiline")) {

32 
	`lš’oi£S‘MuÉiLše
(1);

33 
	`´štf
("Multi-line modeƒnabled.\n");

34 } ià(!
	`¡rcmp
(*
¬gv
,"--keycodes")) {

35 
	`lš’oi£PrštKeyCodes
();

36 
	`ex™
(0);

38 
	`årštf
(
¡d”r
, "U§ge: % [--muÉše] [--keycodes]\n", 
´gÇme
);

39 
	`ex™
(1);

45 
	`lš’oi£S‘Com¶‘iÚC®lback
(
com¶‘iÚ
);

46 
	`lš’oi£S‘HštsC®lback
(
hšts
);

50 
	`lš’oi£Hi¡ÜyLßd
("history.txt");

58 (
lše
 = 
	`lš’oi£
("h–lo> ")è!ğ
NULL
) {

60 ià(
lše
[0] != '\0' &&†ine[0] != '/') {

61 
	`´štf
("echo: '%s'\n", 
lše
);

62 
	`lš’oi£Hi¡ÜyAdd
(
lše
);

63 
	`lš’oi£Hi¡ÜySave
("history.txt");

64 } ià(!
	`¡ºcmp
(
lše
,"/historylen",11)) {

66 
Ën
 = 
	`©oi
(
lše
+11);

67 
	`lš’oi£Hi¡ÜyS‘MaxL’
(
Ën
);

68 } ià(
lše
[0] == '/') {

69 
	`´štf
("UÄecÚized commªd: %s\n", 
lše
);

71 
	`ä“
(
lše
);

74 
	}
}

	@deps/linenoise/linenoise.c

106 
	~<‹rmios.h
>

107 
	~<uni¡d.h
>

108 
	~<¡dlib.h
>

109 
	~<¡dio.h
>

110 
	~<”ºo.h
>

111 
	~<¡ršg.h
>

112 
	~<¡dlib.h
>

113 
	~<ùy³.h
>

114 
	~<sys/¡©.h
>

115 
	~<sys/ty³s.h
>

116 
	~<sys/ioùl.h
>

117 
	~<uni¡d.h
>

118 
	~"lš’oi£.h
"

120 
	#LINENOISE_DEFAULT_HISTORY_MAX_LEN
 100

	)

121 
	#LINENOISE_MAX_LINE
 4096

	)

122 *
	gunsuµÜ‹d_‹rm
[] = {"dumb","cÚs25","emacs",
NULL
};

123 
lš’oi£Com¶‘iÚC®lback
 *
	gcom¶‘iÚC®lback
 = 
NULL
;

124 
lš’oi£HštsC®lback
 *
	ghštsC®lback
 = 
NULL
;

125 
lš’oi£F»eHštsC®lback
 *
	gä“HštsC®lback
 = 
NULL
;

127 
‹rmios
 
	gÜig_‹rmios
;

128 
	g¿wmode
 = 0;

129 
	gmlmode
 = 0;

130 
	g©ex™_»gi¡”ed
 = 0;

131 
	ghi¡Üy_max_Ën
 = 
LINENOISE_DEFAULT_HISTORY_MAX_LEN
;

132 
	ghi¡Üy_Ën
 = 0;

133 **
	ghi¡Üy
 = 
NULL
;

138 
	slš’oi£S‹
 {

139 
	mifd
;

140 
	mofd
;

141 *
	mbuf
;

142 
size_t
 
	mbuæ’
;

143 cÚ¡ *
	m´om±
;

144 
size_t
 
	m¶’
;

145 
size_t
 
	mpos
;

146 
size_t
 
	mŞdpos
;

147 
size_t
 
	mËn
;

148 
size_t
 
	mcŞs
;

149 
size_t
 
	mmaxrows
;

150 
	mhi¡Üy_šdex
;

153 
	eKEY_ACTION
{

154 
	mKEY_NULL
 = 0,

155 
	mCTRL_A
 = 1,

156 
	mCTRL_B
 = 2,

157 
	mCTRL_C
 = 3,

158 
	mCTRL_D
 = 4,

159 
	mCTRL_E
 = 5,

160 
	mCTRL_F
 = 6,

161 
	mCTRL_H
 = 8,

162 
	mTAB
 = 9,

163 
	mCTRL_K
 = 11,

164 
	mCTRL_L
 = 12,

165 
	mENTER
 = 13,

166 
	mCTRL_N
 = 14,

167 
	mCTRL_P
 = 16,

168 
	mCTRL_T
 = 20,

169 
	mCTRL_U
 = 21,

170 
	mCTRL_W
 = 23,

171 
	mESC
 = 27,

172 
	mBACKSPACE
 = 127

175 
lš’oi£AtEx™
();

176 
lš’oi£Hi¡ÜyAdd
(cÚ¡ *
lše
);

177 
»äeshLše
(
lš’oi£S‹
 *
l
);

181 
FILE
 *
	gÊdebug_å
 = 
NULL
;

182 
	#Êdebug
(...) \

184 ià(
Êdebug_å
 =ğ
NULL
) { \

185 
Êdebug_å
 = 
	`fİ’
("/tmp/lndebug.txt","a"); \

186 
	`årštf
(
Êdebug_å
, \

188 ()
l
->
Ën
,(î->
pos
,(î->
Şdpos
,
¶’
,
rows
,
½os
, \

189 ()
l
->
maxrows
,
Şd_rows
); \

191 
	`årštf
(
Êdebug_å
, ", " 
__VA_ARGS__
); \

192 
	`fæush
(
Êdebug_å
); \

193 } 0)

	)

195 
	#Êdebug
(
fmt
, ...)

	)

201 
	$lš’oi£S‘MuÉiLše
(
ml
) {

202 
mlmode
 = 
ml
;

203 
	}
}

207 
	$isUnsuµÜ‹dT”m
() {

208 *
‹rm
 = 
	`g‘’v
("TERM");

209 
j
;

211 ià(
‹rm
 =ğ
NULL
)  0;

212 
j
 = 0; 
unsuµÜ‹d_‹rm
[j]; j++)

213 ià(!
	`¡rÿ£cmp
(
‹rm
,
unsuµÜ‹d_‹rm
[
j
]))  1;

215 
	}
}

218 
	$’abËRawMode
(
fd
) {

219 
‹rmios
 
¿w
;

221 ià(!
	`i§‰y
(
STDIN_FILENO
)è
çl
;

222 ià(!
©ex™_»gi¡”ed
) {

223 
	`©ex™
(
lš’oi£AtEx™
);

224 
©ex™_»gi¡”ed
 = 1;

226 ià(
	`tcg‘©Œ
(
fd
,&
Üig_‹rmios
è=ğ-1è
çl
;

228 
¿w
 = 
Üig_‹rmios
;

231 
¿w
.
c_iæag
 &ğ~(
BRKINT
 | 
ICRNL
 | 
INPCK
 | 
ISTRIP
 | 
IXON
);

233 
¿w
.
c_oæag
 &ğ~(
OPOST
);

235 
¿w
.
c_cæag
 |ğ(
CS8
);

238 
¿w
.
c_læag
 &ğ~(
ECHO
 | 
ICANON
 | 
IEXTEN
 | 
ISIG
);

241 
¿w
.
c_cc
[
VMIN
] = 1;„aw.c_cc[
VTIME
] = 0;

244 ià(
	`tc£‰r
(
fd
,
TCSAFLUSH
,&
¿w
è< 0è
çl
;

245 
¿wmode
 = 1;

248 
çl
:

249 
”ºo
 = 
ENOTTY
;

251 
	}
}

253 
	$di§bËRawMode
(
fd
) {

255 ià(
¿wmode
 && 
	`tc£‰r
(
fd
,
TCSAFLUSH
,&
Üig_‹rmios
) != -1)

256 
¿wmode
 = 0;

257 
	}
}

262 
	$g‘CursÜPos™iÚ
(
ifd
, 
ofd
) {

263 
buf
[32];

264 
cŞs
, 
rows
;

265 
i
 = 0;

268 ià(
	`wr™e
(
ofd
, "\x1b[6n", 4) != 4)  -1;

271 
i
 < (
buf
)-1) {

272 ià(
	`»ad
(
ifd
,
buf
+
i
,1) != 1) ;

273 ià(
buf
[
i
] == 'R') ;

274 
i
++;

276 
buf
[
i
] = '\0';

279 ià(
buf
[0] !ğ
ESC
 || buf[1] != '[')  -1;

280 ià(
	`ssÿnf
(
buf
+2,"%d;%d",&
rows
,&
cŞs
) != 2)  -1;

281  
cŞs
;

282 
	}
}

286 
	$g‘CŞumns
(
ifd
, 
ofd
) {

287 
wšsize
 
ws
;

289 ià(
	`ioùl
(1, 
TIOCGWINSZ
, &
ws
è=ğ-1 || ws.
ws_cŞ
 == 0) {

291 
¡¬t
, 
cŞs
;

294 
¡¬t
 = 
	`g‘CursÜPos™iÚ
(
ifd
,
ofd
);

295 ià(
¡¬t
 =ğ-1è
çed
;

298 ià(
	`wr™e
(
ofd
,"\x1b[999C",6è!ğ6è
çed
;

299 
cŞs
 = 
	`g‘CursÜPos™iÚ
(
ifd
,
ofd
);

300 ià(
cŞs
 =ğ-1è
çed
;

303 ià(
cŞs
 > 
¡¬t
) {

304 
£q
[32];

305 
	`¢´štf
(
£q
,32,"\x1b[%dD",
cŞs
-
¡¬t
);

306 ià(
	`wr™e
(
ofd
,
£q
,
	`¡¾’
(seq)) == -1) {

310  
cŞs
;

312  
ws
.
ws_cŞ
;

315 
çed
:

317 
	}
}

320 
	$lš’oi£CË¬Sü“n
() {

321 ià(
	`wr™e
(
STDOUT_FILENO
,"\x1b[H\x1b[2J",7) <= 0) {

324 
	}
}

328 
	$lš’oi£B“p
() {

329 
	`årštf
(
¡d”r
, "\x7");

330 
	`fæush
(
¡d”r
);

331 
	}
}

336 
	$ä“Com¶‘iÚs
(
lš’oi£Com¶‘iÚs
 *
lc
) {

337 
size_t
 
i
;

338 
i
 = 0; i < 
lc
->
Ën
; i++)

339 
	`ä“
(
lc
->
cvec
[
i
]);

340 ià(
lc
->
cvec
 !ğ
NULL
)

341 
	`ä“
(
lc
->
cvec
);

342 
	}
}

350 
	$com¶‘eLše
(
lš’oi£S‹
 *
ls
) {

351 
lš’oi£Com¶‘iÚs
 
lc
 = { 0, 
NULL
 };

352 
Ä—d
, 
nwr™‹n
;

353 
c
 = 0;

355 
	`com¶‘iÚC®lback
(
ls
->
buf
,&
lc
);

356 ià(
lc
.
Ën
 == 0) {

357 
	`lš’oi£B“p
();

359 
size_t
 
¡İ
 = 0, 
i
 = 0;

361 !
¡İ
) {

363 ià(
i
 < 
lc
.
Ën
) {

364 
lš’oi£S‹
 
§ved
 = *
ls
;

366 
ls
->
Ën
 =†s->
pos
 = 
	`¡¾’
(
lc
.
cvec
[
i
]);

367 
ls
->
buf
 = 
lc
.
cvec
[
i
];

368 
	`»äeshLše
(
ls
);

369 
ls
->
Ën
 = 
§ved
.len;

370 
ls
->
pos
 = 
§ved
.pos;

371 
ls
->
buf
 = 
§ved
.buf;

373 
	`»äeshLše
(
ls
);

376 
Ä—d
 = 
	`»ad
(
ls
->
ifd
,&
c
,1);

377 ià(
Ä—d
 <= 0) {

378 
	`ä“Com¶‘iÚs
(&
lc
);

382 
c
) {

384 
i
 = (i+1è% (
lc
.
Ën
+1);

385 ià(
i
 =ğ
lc
.
Ën
è
	`lš’oi£B“p
();

389 ià(
i
 < 
lc
.
Ën
è
	`»äeshLše
(
ls
);

390 
¡İ
 = 1;

394 ià(
i
 < 
lc
.
Ën
) {

395 
nwr™‹n
 = 
	`¢´štf
(
ls
->
buf
,ls->
buæ’
,"%s",
lc
.
cvec
[
i
]);

396 
ls
->
Ën
 =†s->
pos
 = 
nwr™‹n
;

398 
¡İ
 = 1;

404 
	`ä“Com¶‘iÚs
(&
lc
);

405  
c
;

406 
	}
}

409 
	$lš’oi£S‘Com¶‘iÚC®lback
(
lš’oi£Com¶‘iÚC®lback
 *
â
) {

410 
com¶‘iÚC®lback
 = 
â
;

411 
	}
}

415 
	$lš’oi£S‘HštsC®lback
(
lš’oi£HštsC®lback
 *
â
) {

416 
hštsC®lback
 = 
â
;

417 
	}
}

421 
	$lš’oi£S‘F»eHštsC®lback
(
lš’oi£F»eHštsC®lback
 *
â
) {

422 
ä“HštsC®lback
 = 
â
;

423 
	}
}

429 
	$lš’oi£AddCom¶‘iÚ
(
lš’oi£Com¶‘iÚs
 *
lc
, cÚ¡ *
¡r
) {

430 
size_t
 
Ën
 = 
	`¡¾’
(
¡r
);

431 *
cİy
, **
cvec
;

433 
cİy
 = 
	`m®loc
(
Ën
+1);

434 ià(
cİy
 =ğ
NULL
) ;

435 
	`memıy
(
cİy
,
¡r
,
Ën
+1);

436 
cvec
 = 
	`»®loc
(
lc
->cvec,(*)*Öc->
Ën
+1));

437 ià(
cvec
 =ğ
NULL
) {

438 
	`ä“
(
cİy
);

441 
lc
->
cvec
 = cvec;

442 
lc
->
cvec
[lc->
Ën
++] = 
cİy
;

443 
	}
}

451 
	sabuf
 {

452 *
	mb
;

453 
	mËn
;

456 
	$abIn™
(
abuf
 *
ab
) {

457 
ab
->
b
 = 
NULL
;

458 
ab
->
Ën
 = 0;

459 
	}
}

461 
	$abAµ’d
(
abuf
 *
ab
, cÚ¡ *
s
, 
Ën
) {

462 *
Ãw
 = 
	`»®loc
(
ab
->
b
,ab->
Ën
+len);

464 ià(
Ãw
 =ğ
NULL
) ;

465 
	`memıy
(
Ãw
+
ab
->
Ën
,
s
,len);

466 
ab
->
b
 = 
Ãw
;

467 
ab
->
Ën
 +=†en;

468 
	}
}

470 
	$abF»e
(
abuf
 *
ab
) {

471 
	`ä“
(
ab
->
b
);

472 
	}
}

476 
	$»äeshShowHšts
(
abuf
 *
ab
, 
lš’oi£S‹
 *
l
, 
¶’
) {

477 
£q
[64];

478 ià(
hštsC®lback
 && 
¶’
+
l
->
Ën
 <†->
cŞs
) {

479 
cŞÜ
 = -1, 
bŞd
 = 0;

480 *
hšt
 = 
	`hštsC®lback
(
l
->
buf
,&
cŞÜ
,&
bŞd
);

481 ià(
hšt
) {

482 
hš’
 = 
	`¡¾’
(
hšt
);

483 
hštmaxËn
 = 
l
->
cŞs
-(
¶’
+l->
Ën
);

484 ià(
hš’
 > 
hštmaxËn
) hintlen = hintmaxlen;

485 ià(
bŞd
 =ğ1 && 
cŞÜ
 == -1) color = 37;

486 ià(
cŞÜ
 !ğ-1 || 
bŞd
 != 0)

487 
	`¢´štf
(
£q
,64,"\033[%d;%d;49m",
bŞd
,
cŞÜ
);

488 
	`abAµ’d
(
ab
,
£q
,
	`¡¾’
(seq));

489 
	`abAµ’d
(
ab
,
hšt
,
hš’
);

490 ià(
cŞÜ
 !ğ-1 || 
bŞd
 != 0)

491 
	`abAµ’d
(
ab
,"\033[0m",4);

493 ià(
ä“HštsC®lback
è
	`ä“HštsC®lback
(
hšt
);

496 
	}
}

502 
	$»äeshSšgËLše
(
lš’oi£S‹
 *
l
) {

503 
£q
[64];

504 
size_t
 
¶’
 = 
	`¡¾’
(
l
->
´om±
);

505 
fd
 = 
l
->
ofd
;

506 *
buf
 = 
l
->buf;

507 
size_t
 
Ën
 = 
l
->len;

508 
size_t
 
pos
 = 
l
->pos;

509 
abuf
 
ab
;

511 (
¶’
+
pos
è>ğ
l
->
cŞs
) {

512 
buf
++;

513 
Ën
--;

514 
pos
--;

516 
¶’
+
Ën
 > 
l
->
cŞs
) {

517 
Ën
--;

520 
	`abIn™
(&
ab
);

522 
	`¢´štf
(
£q
,64,"\r");

523 
	`abAµ’d
(&
ab
,
£q
,
	`¡¾’
(seq));

525 
	`abAµ’d
(&
ab
,
l
->
´om±
,
	`¡¾’
(l->prompt));

526 
	`abAµ’d
(&
ab
,
buf
,
Ën
);

528 
	`»äeshShowHšts
(&
ab
,
l
,
¶’
);

530 
	`¢´štf
(
£q
,64,"\x1b[0K");

531 
	`abAµ’d
(&
ab
,
£q
,
	`¡¾’
(seq));

533 
	`¢´štf
(
£q
,64,"\r\x1b[%dC", ()(
pos
+
¶’
));

534 
	`abAµ’d
(&
ab
,
£q
,
	`¡¾’
(seq));

535 ià(
	`wr™e
(
fd
,
ab
.
b
,ab.
Ën
) == -1) {}

536 
	`abF»e
(&
ab
);

537 
	}
}

543 
	$»äeshMuÉiLše
(
lš’oi£S‹
 *
l
) {

544 
£q
[64];

545 
¶’
 = 
	`¡¾’
(
l
->
´om±
);

546 
rows
 = (
¶’
+
l
->
Ën
+l->
cŞs
-1)/l->cols;

547 
½os
 = (
¶’
+
l
->
Şdpos
+l->
cŞs
)/l->cols;

548 
½os2
;

549 
cŞ
;

550 
Şd_rows
 = 
l
->
maxrows
;

551 
fd
 = 
l
->
ofd
, 
j
;

552 
abuf
 
ab
;

555 ià(
rows
 > ()
l
->
maxrows
)†->maxrows =„ows;

559 
	`abIn™
(&
ab
);

560 ià(
Şd_rows
-
½os
 > 0) {

561 
	`Êdebug
("gØdowÀ%d", 
Şd_rows
-
½os
);

562 
	`¢´štf
(
£q
,64,"\x1b[%dB", 
Şd_rows
-
½os
);

563 
	`abAµ’d
(&
ab
,
£q
,
	`¡¾’
(seq));

567 
j
 = 0; j < 
Şd_rows
-1; j++) {

568 
	`Êdebug
("clear+up");

569 
	`¢´štf
(
£q
,64,"\r\x1b[0K\x1b[1A");

570 
	`abAµ’d
(&
ab
,
£q
,
	`¡¾’
(seq));

574 
	`Êdebug
("clear");

575 
	`¢´štf
(
£q
,64,"\r\x1b[0K");

576 
	`abAµ’d
(&
ab
,
£q
,
	`¡¾’
(seq));

579 
	`abAµ’d
(&
ab
,
l
->
´om±
,
	`¡¾’
(l->prompt));

580 
	`abAµ’d
(&
ab
,
l
->
buf
,l->
Ën
);

583 
	`»äeshShowHšts
(&
ab
,
l
,
¶’
);

587 ià(
l
->
pos
 &&

588 
l
->
pos
 =ğl->
Ën
 &&

589 (
l
->
pos
+
¶’
è%†->
cŞs
 == 0)

591 
	`Êdebug
("<newline>");

592 
	`abAµ’d
(&
ab
,"\n",1);

593 
	`¢´štf
(
£q
,64,"\r");

594 
	`abAµ’d
(&
ab
,
£q
,
	`¡¾’
(seq));

595 
rows
++;

596 ià(
rows
 > ()
l
->
maxrows
)†->maxrows =„ows;

600 
½os2
 = (
¶’
+
l
->
pos
+l->
cŞs
)/l->cols;

601 
	`Êdebug
("½os2 %d", 
½os2
);

604 ià(
rows
-
½os2
 > 0) {

605 
	`Êdebug
("go-u°%d", 
rows
-
½os2
);

606 
	`¢´štf
(
£q
,64,"\x1b[%dA", 
rows
-
½os2
);

607 
	`abAµ’d
(&
ab
,
£q
,
	`¡¾’
(seq));

611 
cŞ
 = (
¶’
+()
l
->
pos
è% (î->
cŞs
;

612 
	`Êdebug
("£ˆcŞ %d", 1+
cŞ
);

613 ià(
cŞ
)

614 
	`¢´štf
(
£q
,64,"\r\x1b[%dC", 
cŞ
);

616 
	`¢´štf
(
£q
,64,"\r");

617 
	`abAµ’d
(&
ab
,
£q
,
	`¡¾’
(seq));

619 
	`Êdebug
("\n");

620 
l
->
Şdpos
 =†->
pos
;

622 ià(
	`wr™e
(
fd
,
ab
.
b
,ab.
Ën
) == -1) {}

623 
	`abF»e
(&
ab
);

624 
	}
}

628 
	$»äeshLše
(
lš’oi£S‹
 *
l
) {

629 ià(
mlmode
)

630 
	`»äeshMuÉiLše
(
l
);

632 
	`»äeshSšgËLše
(
l
);

633 
	}
}

638 
	$lš’oi£Ed™In£¹
(
lš’oi£S‹
 *
l
, 
c
) {

639 ià(
l
->
Ën
 <†->
buæ’
) {

640 ià(
l
->
Ën
 =ğl->
pos
) {

641 
l
->
buf
[l->
pos
] = 
c
;

642 
l
->
pos
++;

643 
l
->
Ën
++;

644 
l
->
buf
[l->
Ën
] = '\0';

645 ià((!
mlmode
 && 
l
->
¶’
+l->
Ën
 <†->
cŞs
 && !
hštsC®lback
)) {

648 ià(
	`wr™e
(
l
->
ofd
,&
c
,1) == -1)  -1;

650 
	`»äeshLše
(
l
);

653 
	`memmove
(
l
->
buf
+l->
pos
+1,l->buf+l->pos,l->
Ën
-l->pos);

654 
l
->
buf
[l->
pos
] = 
c
;

655 
l
->
Ën
++;

656 
l
->
pos
++;

657 
l
->
buf
[l->
Ën
] = '\0';

658 
	`»äeshLše
(
l
);

662 
	}
}

665 
	$lš’oi£Ed™MoveLeá
(
lš’oi£S‹
 *
l
) {

666 ià(
l
->
pos
 > 0) {

667 
l
->
pos
--;

668 
	`»äeshLše
(
l
);

670 
	}
}

673 
	$lš’oi£Ed™MoveRight
(
lš’oi£S‹
 *
l
) {

674 ià(
l
->
pos
 !ğl->
Ën
) {

675 
l
->
pos
++;

676 
	`»äeshLše
(
l
);

678 
	}
}

681 
	$lš’oi£Ed™MoveHome
(
lš’oi£S‹
 *
l
) {

682 ià(
l
->
pos
 != 0) {

683 
l
->
pos
 = 0;

684 
	`»äeshLše
(
l
);

686 
	}
}

689 
	$lš’oi£Ed™MoveEnd
(
lš’oi£S‹
 *
l
) {

690 ià(
l
->
pos
 !ğl->
Ën
) {

691 
l
->
pos
 =†->
Ën
;

692 
	`»äeshLše
(
l
);

694 
	}
}

698 
	#LINENOISE_HISTORY_NEXT
 0

	)

699 
	#LINENOISE_HISTORY_PREV
 1

	)

700 
	$lš’oi£Ed™Hi¡ÜyNext
(
lš’oi£S‹
 *
l
, 
dœ
) {

701 ià(
hi¡Üy_Ën
 > 1) {

704 
	`ä“
(
hi¡Üy
[
hi¡Üy_Ën
 - 1 - 
l
->
hi¡Üy_šdex
]);

705 
hi¡Üy
[
hi¡Üy_Ën
 - 1 - 
l
->
hi¡Üy_šdex
] = 
	`¡rdup
Ö->
buf
);

707 
l
->
hi¡Üy_šdex
 +ğ(
dœ
 =ğ
LINENOISE_HISTORY_PREV
) ? 1 : -1;

708 ià(
l
->
hi¡Üy_šdex
 < 0) {

709 
l
->
hi¡Üy_šdex
 = 0;

711 } ià(
l
->
hi¡Üy_šdex
 >ğ
hi¡Üy_Ën
) {

712 
l
->
hi¡Üy_šdex
 = 
hi¡Üy_Ën
-1;

715 
	`¡ºıy
(
l
->
buf
,
hi¡Üy
[
hi¡Üy_Ën
 - 1 -†->
hi¡Üy_šdex
],l->
buæ’
);

716 
l
->
buf
[l->
buæ’
-1] = '\0';

717 
l
->
Ën
 =†->
pos
 = 
	`¡¾’
Ö->
buf
);

718 
	`»äeshLše
(
l
);

720 
	}
}

724 
	$lš’oi£Ed™D–‘e
(
lš’oi£S‹
 *
l
) {

725 ià(
l
->
Ën
 > 0 &&†->
pos
 <†->len) {

726 
	`memmove
(
l
->
buf
+l->
pos
,l->buf+l->pos+1,l->
Ën
-l->pos-1);

727 
l
->
Ën
--;

728 
l
->
buf
[l->
Ën
] = '\0';

729 
	`»äeshLše
(
l
);

731 
	}
}

734 
	$lš’oi£Ed™Back¥aû
(
lš’oi£S‹
 *
l
) {

735 ià(
l
->
pos
 > 0 &&†->
Ën
 > 0) {

736 
	`memmove
(
l
->
buf
+l->
pos
-1,l->buf+l->pos,l->
Ën
-l->pos);

737 
l
->
pos
--;

738 
l
->
Ën
--;

739 
l
->
buf
[l->
Ën
] = '\0';

740 
	`»äeshLše
(
l
);

742 
	}
}

746 
	$lš’oi£Ed™D–‘eP»vWÜd
(
lš’oi£S‹
 *
l
) {

747 
size_t
 
Şd_pos
 = 
l
->
pos
;

748 
size_t
 
diff
;

750 
l
->
pos
 > 0 &&†->
buf
[l->pos-1] == ' ')

751 
l
->
pos
--;

752 
l
->
pos
 > 0 &&†->
buf
[l->pos-1] != ' ')

753 
l
->
pos
--;

754 
diff
 = 
Şd_pos
 - 
l
->
pos
;

755 
	`memmove
(
l
->
buf
+l->
pos
,l->buf+
Şd_pos
,l->
Ën
-old_pos+1);

756 
l
->
Ën
 -ğ
diff
;

757 
	`»äeshLše
(
l
);

758 
	}
}

768 
	$lš’oi£Ed™
(
¡dš_fd
, 
¡dout_fd
, *
buf
, 
size_t
 
buæ’
, cÚ¡ *
´om±
)

770 
lš’oi£S‹
 
l
;

774 
l
.
ifd
 = 
¡dš_fd
;

775 
l
.
ofd
 = 
¡dout_fd
;

776 
l
.
buf
 = buf;

777 
l
.
buæ’
 = buflen;

778 
l
.
´om±
 =…rompt;

779 
l
.
¶’
 = 
	`¡¾’
(
´om±
);

780 
l
.
Şdpos
 =†.
pos
 = 0;

781 
l
.
Ën
 = 0;

782 
l
.
cŞs
 = 
	`g‘CŞumns
(
¡dš_fd
, 
¡dout_fd
);

783 
l
.
maxrows
 = 0;

784 
l
.
hi¡Üy_šdex
 = 0;

787 
l
.
buf
[0] = '\0';

788 
l
.
buæ’
--;

792 
	`lš’oi£Hi¡ÜyAdd
("");

794 ià(
	`wr™e
(
l
.
ofd
,
´om±
,l.
¶’
) == -1)  -1;

796 
c
;

797 
Ä—d
;

798 
£q
[3];

800 
Ä—d
 = 
	`»ad
(
l
.
ifd
,&
c
,1);

801 ià(
Ä—d
 <ğ0è 
l
.
Ën
;

806 ià(
c
 =ğ9 && 
com¶‘iÚC®lback
 !ğ
NULL
) {

807 
c
 = 
	`com¶‘eLše
(&
l
);

809 ià(
c
 < 0è 
l
.
Ën
;

811 ià(
c
 == 0) ;

814 
c
) {

815 
ENTER
:

816 
hi¡Üy_Ën
--;

817 
	`ä“
(
hi¡Üy
[
hi¡Üy_Ën
]);

818 ià(
mlmode
è
	`lš’oi£Ed™MoveEnd
(&
l
);

819 ià(
hštsC®lback
) {

822 
lš’oi£HštsC®lback
 *
hc
 = 
hštsC®lback
;

823 
hštsC®lback
 = 
NULL
;

824 
	`»äeshLše
(&
l
);

825 
hštsC®lback
 = 
hc
;

827  ()
l
.
Ën
;

828 
CTRL_C
:

829 
”ºo
 = 
EAGAIN
;

831 
BACKSPACE
:

833 
	`lš’oi£Ed™Back¥aû
(&
l
);

835 
CTRL_D
:

837 ià(
l
.
Ën
 > 0) {

838 
	`lš’oi£Ed™D–‘e
(&
l
);

840 
hi¡Üy_Ën
--;

841 
	`ä“
(
hi¡Üy
[
hi¡Üy_Ën
]);

845 
CTRL_T
:

846 ià(
l
.
pos
 > 0 &&†.po <†.
Ën
) {

847 
aux
 = 
buf
[
l
.
pos
-1];

848 
buf
[
l
.
pos
-1] = buf[l.pos];

849 
buf
[
l
.
pos
] = 
aux
;

850 ià(
l
.
pos
 !ğl.
Ën
-1)†.pos++;

851 
	`»äeshLše
(&
l
);

854 
CTRL_B
:

855 
	`lš’oi£Ed™MoveLeá
(&
l
);

857 
CTRL_F
:

858 
	`lš’oi£Ed™MoveRight
(&
l
);

860 
CTRL_P
:

861 
	`lš’oi£Ed™Hi¡ÜyNext
(&
l
, 
LINENOISE_HISTORY_PREV
);

863 
CTRL_N
:

864 
	`lš’oi£Ed™Hi¡ÜyNext
(&
l
, 
LINENOISE_HISTORY_NEXT
);

866 
ESC
:

870 ià(
	`»ad
(
l
.
ifd
,
£q
,1) == -1) ;

871 ià(
	`»ad
(
l
.
ifd
,
£q
+1,1) == -1) ;

874 ià(
£q
[0] == '[') {

875 ià(
£q
[1] >= '0' && seq[1] <= '9') {

877 ià(
	`»ad
(
l
.
ifd
,
£q
+2,1) == -1) ;

878 ià(
£q
[2] == '~') {

879 
£q
[1]) {

881 
	`lš’oi£Ed™D–‘e
(&
l
);

886 
£q
[1]) {

888 
	`lš’oi£Ed™Hi¡ÜyNext
(&
l
, 
LINENOISE_HISTORY_PREV
);

891 
	`lš’oi£Ed™Hi¡ÜyNext
(&
l
, 
LINENOISE_HISTORY_NEXT
);

894 
	`lš’oi£Ed™MoveRight
(&
l
);

897 
	`lš’oi£Ed™MoveLeá
(&
l
);

900 
	`lš’oi£Ed™MoveHome
(&
l
);

903 
	`lš’oi£Ed™MoveEnd
(&
l
);

910 ià(
£q
[0] == 'O') {

911 
£q
[1]) {

913 
	`lš’oi£Ed™MoveHome
(&
l
);

916 
	`lš’oi£Ed™MoveEnd
(&
l
);

922 ià(
	`lš’oi£Ed™In£¹
(&
l
,
c
))  -1;

924 
CTRL_U
:

925 
buf
[0] = '\0';

926 
l
.
pos
 =†.
Ën
 = 0;

927 
	`»äeshLše
(&
l
);

929 
CTRL_K
:

930 
buf
[
l
.
pos
] = '\0';

931 
l
.
Ën
 =†.
pos
;

932 
	`»äeshLše
(&
l
);

934 
CTRL_A
:

935 
	`lš’oi£Ed™MoveHome
(&
l
);

937 
CTRL_E
:

938 
	`lš’oi£Ed™MoveEnd
(&
l
);

940 
CTRL_L
:

941 
	`lš’oi£CË¬Sü“n
();

942 
	`»äeshLše
(&
l
);

944 
CTRL_W
:

945 
	`lš’oi£Ed™D–‘eP»vWÜd
(&
l
);

949  
l
.
Ën
;

950 
	}
}

955 
	$lš’oi£PrštKeyCodes
() {

956 
qu™
[4];

958 
	`´štf
("Linenoise key codes debugging mode.\n"

960 ià(
	`’abËRawMode
(
STDIN_FILENO
) == -1) ;

961 
	`mem£t
(
qu™
,' ',4);

963 
c
;

964 
Ä—d
;

966 
Ä—d
 = 
	`»ad
(
STDIN_FILENO
,&
c
,1);

967 ià(
Ä—d
 <= 0) ;

968 
	`memmove
(
qu™
,quit+1,(quit)-1);

969 
qu™
[(qu™)-1] = 
c
;

970 ià(
	`memcmp
(
qu™
,"quit",(quit)) == 0) ;

972 
	`´štf
("'%c' %02x (%d) (type quitoƒxit)\n",

973 
	`i¥ršt
(
c
) ? c : '?', ()c, ()c);

974 
	`´štf
("\r");

975 
	`fæush
(
¡dout
);

977 
	`di§bËRawMode
(
STDIN_FILENO
);

978 
	}
}

982 
	$lš’oi£Raw
(*
buf
, 
size_t
 
buæ’
, cÚ¡ *
´om±
) {

983 
couÁ
;

985 ià(
buæ’
 == 0) {

986 
”ºo
 = 
EINVAL
;

990 ià(
	`’abËRawMode
(
STDIN_FILENO
) == -1)  -1;

991 
couÁ
 = 
	`lš’oi£Ed™
(
STDIN_FILENO
, 
STDOUT_FILENO
, 
buf
, 
buæ’
, 
´om±
);

992 
	`di§bËRawMode
(
STDIN_FILENO
);

993 
	`´štf
("\n");

994  
couÁ
;

995 
	}
}

1002 *
	$lš’oi£NoTTY
() {

1003 *
lše
 = 
NULL
;

1004 
size_t
 
Ën
 = 0, 
maxËn
 = 0;

1007 ià(
Ën
 =ğ
maxËn
) {

1008 ià(
maxËn
 == 0) maxlen = 16;

1009 
maxËn
 *= 2;

1010 *
Şdv®
 = 
lše
;

1011 
lše
 = 
	`»®loc
Öše,
maxËn
);

1012 ià(
lše
 =ğ
NULL
) {

1013 ià(
Şdv®
è
	`ä“
(oldval);

1014  
NULL
;

1017 
c
 = 
	`fg‘c
(
¡dš
);

1018 ià(
c
 =ğ
EOF
 || c == '\n') {

1019 ià(
c
 =ğ
EOF
 && 
Ën
 == 0) {

1020 
	`ä“
(
lše
);

1021  
NULL
;

1023 
lše
[
Ën
] = '\0';

1024  
lše
;

1027 
lše
[
Ën
] = 
c
;

1028 
Ën
++;

1031 
	}
}

1038 *
	$lš’oi£
(cÚ¡ *
´om±
) {

1039 
buf
[
LINENOISE_MAX_LINE
];

1040 
couÁ
;

1042 ià(!
	`i§‰y
(
STDIN_FILENO
)) {

1045  
	`lš’oi£NoTTY
();

1046 } ià(
	`isUnsuµÜ‹dT”m
()) {

1047 
size_t
 
Ën
;

1049 
	`´štf
("%s",
´om±
);

1050 
	`fæush
(
¡dout
);

1051 ià(
	`fg‘s
(
buf
,
LINENOISE_MAX_LINE
,
¡dš
è=ğ
NULL
)  NULL;

1052 
Ën
 = 
	`¡¾’
(
buf
);

1053 
Ën
 && (
buf
[len-1] == '\n' || buf[len-1] == '\r')) {

1054 
Ën
--;

1055 
buf
[
Ën
] = '\0';

1057  
	`¡rdup
(
buf
);

1059 
couÁ
 = 
	`lš’oi£Raw
(
buf
,
LINENOISE_MAX_LINE
,
´om±
);

1060 ià(
couÁ
 =ğ-1è 
NULL
;

1061  
	`¡rdup
(
buf
);

1063 
	}
}

1069 
	$lš’oi£F»e
(*
±r
) {

1070 
	`ä“
(
±r
);

1071 
	}
}

1077 
	$ä“Hi¡Üy
() {

1078 ià(
hi¡Üy
) {

1079 
j
;

1081 
j
 = 0; j < 
hi¡Üy_Ën
; j++)

1082 
	`ä“
(
hi¡Üy
[
j
]);

1083 
	`ä“
(
hi¡Üy
);

1085 
	}
}

1088 
	$lš’oi£AtEx™
() {

1089 
	`di§bËRawMode
(
STDIN_FILENO
);

1090 
	`ä“Hi¡Üy
();

1091 
	}
}

1100 
	$lš’oi£Hi¡ÜyAdd
(cÚ¡ *
lše
) {

1101 *
lšecİy
;

1103 ià(
hi¡Üy_max_Ën
 == 0)  0;

1106 ià(
hi¡Üy
 =ğ
NULL
) {

1107 
hi¡Üy
 = 
	`m®loc
((*)*
hi¡Üy_max_Ën
);

1108 ià(
hi¡Üy
 =ğ
NULL
)  0;

1109 
	`mem£t
(
hi¡Üy
,0,((*)*
hi¡Üy_max_Ën
));

1113 ià(
hi¡Üy_Ën
 && !
	`¡rcmp
(
hi¡Üy
[hi¡Üy_Ën-1], 
lše
))  0;

1117 
lšecİy
 = 
	`¡rdup
(
lše
);

1118 ià(!
lšecİy
)  0;

1119 ià(
hi¡Üy_Ën
 =ğ
hi¡Üy_max_Ën
) {

1120 
	`ä“
(
hi¡Üy
[0]);

1121 
	`memmove
(
hi¡Üy
,hi¡Üy+1,(*)*(
hi¡Üy_max_Ën
-1));

1122 
hi¡Üy_Ën
--;

1124 
hi¡Üy
[
hi¡Üy_Ën
] = 
lšecİy
;

1125 
hi¡Üy_Ën
++;

1127 
	}
}

1133 
	$lš’oi£Hi¡ÜyS‘MaxL’
(
Ën
) {

1134 **
Ãw
;

1136 ià(
Ën
 < 1)  0;

1137 ià(
hi¡Üy
) {

1138 
tocİy
 = 
hi¡Üy_Ën
;

1140 
Ãw
 = 
	`m®loc
((*)*
Ën
);

1141 ià(
Ãw
 =ğ
NULL
)  0;

1144 ià(
Ën
 < 
tocİy
) {

1145 
j
;

1147 
j
 = 0; j < 
tocİy
-
Ën
; j++è
	`ä“
(
hi¡Üy
[j]);

1148 
tocİy
 = 
Ën
;

1150 
	`mem£t
(
Ãw
,0,(*)*
Ën
);

1151 
	`memıy
(
Ãw
,
hi¡Üy
+(
hi¡Üy_Ën
-
tocİy
), (*)*tocopy);

1152 
	`ä“
(
hi¡Üy
);

1153 
hi¡Üy
 = 
Ãw
;

1155 
hi¡Üy_max_Ën
 = 
Ën
;

1156 ià(
hi¡Üy_Ën
 > 
hi¡Üy_max_Ën
)

1157 
hi¡Üy_Ën
 = 
hi¡Üy_max_Ën
;

1159 
	}
}

1163 
	$lš’oi£Hi¡ÜySave
(cÚ¡ *
f’ame
) {

1164 
mode_t
 
Şd_umask
 = 
	`umask
(
S_IXUSR
|
S_IRWXG
|
S_IRWXO
);

1165 
FILE
 *
å
;

1166 
j
;

1168 
å
 = 
	`fİ’
(
f’ame
,"w");

1169 
	`umask
(
Şd_umask
);

1170 ià(
å
 =ğ
NULL
)  -1;

1171 
	`chmod
(
f’ame
,
S_IRUSR
|
S_IWUSR
);

1172 
j
 = 0; j < 
hi¡Üy_Ën
; j++)

1173 
	`årštf
(
å
,"%s\n",
hi¡Üy
[
j
]);

1174 
	`fşo£
(
å
);

1176 
	}
}

1183 
	$lš’oi£Hi¡ÜyLßd
(cÚ¡ *
f’ame
) {

1184 
FILE
 *
å
 = 
	`fİ’
(
f’ame
,"r");

1185 
buf
[
LINENOISE_MAX_LINE
];

1187 ià(
å
 =ğ
NULL
)  -1;

1189 
	`fg‘s
(
buf
,
LINENOISE_MAX_LINE
,
å
è!ğ
NULL
) {

1190 *
p
;

1192 
p
 = 
	`¡rchr
(
buf
,'\r');

1193 ià(!
p
è°ğ
	`¡rchr
(
buf
,'\n');

1194 ià(
p
) *p = '\0';

1195 
	`lš’oi£Hi¡ÜyAdd
(
buf
);

1197 
	`fşo£
(
å
);

1199 
	}
}

	@deps/linenoise/linenoise.h

39 #iâdeà
__LINENOISE_H


40 
	#__LINENOISE_H


	)

42 #ifdeà
__ılu¥lus


46 
	slš’oi£Com¶‘iÚs
 {

47 
size_t
 
Ën
;

48 **
cvec
;

49 } 
	tlš’oi£Com¶‘iÚs
;

51 (
lš’oi£Com¶‘iÚC®lback
)(cÚ¡ *, 
	tlš’oi£Com¶‘iÚs
 *);

52 *(
	tlš’oi£HštsC®lback
)(cÚ¡ *, *
	tcŞÜ
, *
	tbŞd
);

53 (
lš’oi£F»eHštsC®lback
)(*);

54 
lš’oi£S‘Com¶‘iÚC®lback
(
lš’oi£Com¶‘iÚC®lback
 *);

55 
lš’oi£S‘HštsC®lback
(
lš’oi£HštsC®lback
 *);

56 
lš’oi£S‘F»eHštsC®lback
(
lš’oi£F»eHštsC®lback
 *);

57 
lš’oi£AddCom¶‘iÚ
(
lš’oi£Com¶‘iÚs
 *, const *);

59 *
lš’oi£
(cÚ¡ *
´om±
);

60 
lš’oi£F»e
(*
±r
);

61 
lš’oi£Hi¡ÜyAdd
(cÚ¡ *
lše
);

62 
lš’oi£Hi¡ÜyS‘MaxL’
(
Ën
);

63 
lš’oi£Hi¡ÜySave
(cÚ¡ *
f’ame
);

64 
lš’oi£Hi¡ÜyLßd
(cÚ¡ *
f’ame
);

65 
lš’oi£CË¬Sü“n
();

66 
lš’oi£S‘MuÉiLše
(
ml
);

67 
lš’oi£PrštKeyCodes
();

69 #ifdeà
__ılu¥lus


	@deps/lua/etc/all.c

5 
	#lu¯Î_c


	)

7 
	~"Ïpi.c
"

8 
	~"lcode.c
"

9 
	~"ldebug.c
"

10 
	~"ldo.c
"

11 
	~"ldump.c
"

12 
	~"lfunc.c
"

13 
	~"lgc.c
"

14 
	~"Îex.c
"

15 
	~"lmem.c
"

16 
	~"lobjeù.c
"

17 
	~"lİcodes.c
"

18 
	~"Í¬£r.c
"

19 
	~"l¡©e.c
"

20 
	~"l¡ršg.c
"

21 
	~"ÉabË.c
"

22 
	~"Ém.c
"

23 
	~"lundump.c
"

24 
	~"lvm.c
"

25 
	~"lzio.c
"

27 
	~"Ïuxlib.c
"

28 
	~"lba£lib.c
"

29 
	~"ldblib.c
"

30 
	~"liŞib.c
"

31 
	~"lš™.c
"

32 
	~"lm©hlib.c
"

33 
	~"lßdlib.c
"

34 
	~"lo¦ib.c
"

35 
	~"l¡¾ib.c
"

36 
	~"Éablib.c
"

38 
	~"lua.c
"

	@deps/lua/etc/lua.hpp

6 
	~"lua.h
"

7 
	~"lu®ib.h
"

8 
	~"Ïuxlib.h
"

	@deps/lua/etc/min.c

7 
	~<¡dio.h
>

9 
	~"lua.h
"

10 
	~"Ïuxlib.h
"

12 
	$´št
(
lua_S‹
 *
L
)

14 
n
=
	`lua_g‘tİ
(
L
);

15 
i
;

16 
i
=1; i<=
n
; i++)

18 ià(
i
>1è
	`´štf
("\t");

19 ià(
	`lua_is¡ršg
(
L
,
i
))

20 
	`´štf
("%s",
	`lua_to¡ršg
(
L
,
i
));

21 ià(
	`lua_i¢
(
L
,
i
))

22 
	`´štf
("%s","nil");

23 ià(
	`lua_isboŞ—n
(
L
,
i
))

24 
	`´štf
("%s",
	`lua_toboŞ—n
(
L
,
i
) ? "true" : "false");

26 
	`´štf
("%s:%p",
	`luaL_ty³Çme
(
L
,
i
),
	`lua_tİoš‹r
(L,i));

28 
	`´štf
("\n");

30 
	}
}

32 
	$maš
()

34 
lua_S‹
 *
L
=
	`lua_İ’
();

35 
	`lua_»gi¡”
(
L
,"´št",
´št
);

36 ià(
	`luaL_dofe
(
L
,
NULL
)!=0è
	`årštf
(
¡d”r
,"%s\n",
	`lua_to¡ršg
(L,-1));

37 
	`lua_şo£
(
L
);

39 
	}
}

	@deps/lua/etc/noparser.c

15 
	#LUA_CORE


	)

17 
	~"Îex.h
"

18 
	~"Í¬£r.h
"

19 
	~"lzio.h
"

21 
LUAI_FUNC
 
	$luaX_š™
 (
lua_S‹
 *
L
) {

22 
	`UNUSED
(
L
);

23 
	}
}

25 
LUAI_FUNC
 
PrÙo
 *
	$luaY_·r£r
 (
lua_S‹
 *
L
, 
ZIO
 *
z
, 
Mbufãr
 *
buff
, cÚ¡ *
Çme
) {

26 
	`UNUSED
(
z
);

27 
	`UNUSED
(
buff
);

28 
	`UNUSED
(
Çme
);

29 
	`lua_pushl™”®
(
L
,"parser‚ot†oaded");

30 
	`lua_”rÜ
(
L
);

31  
NULL
;

32 
	}
}

34 #ifdeà
NODUMP


35 
	~"lundump.h
"

37 
LUAI_FUNC
 
	$luaU_dump
 (
lua_S‹
* 
L
, cÚ¡ 
PrÙo
* 
f
, 
lua_Wr™”
 
w
, * 
d©a
, 
¡r
) {

38 
	`UNUSED
(
f
);

39 
	`UNUSED
(
w
);

40 
	`UNUSED
(
d©a
);

41 
	`UNUSED
(
¡r
);

43 
	`UNUSED
(
L
);

46 
	`lua_pushl™”®
(
L
,"dumper‚ot†oaded");

47 
	`lua_”rÜ
(
L
);

49 
	}
}

	@deps/lua/src/fpconv.c

31 
	~<¡dio.h
>

32 
	~<¡dlib.h
>

33 
	~<as£¹.h
>

34 
	~<¡ršg.h
>

36 
	~"åcÚv.h
"

43 
	gloÿË_decim®_pošt
 = '.';

52 
	$åcÚv_upd©e_loÿË
()

54 
buf
[8];

56 
	`¢´štf
(
buf
, (buf), "%g", 0.5);

60 ià(
buf
[0] != '0' || buf[2] != '5' || buf[3] != 0) {

61 
	`årštf
(
¡d”r
, "Error: wide characters found or…rintf() bug.");

62 
	`abÜt
();

65 
loÿË_decim®_pošt
 = 
buf
[1];

66 
	}
}

75 
šlše
 
	$v®id_numb”_ch¬aù”
(
ch
)

77 
low”_ch
;

79 ià('0' <ğ
ch
 && ch <= '9')

81 ià(
ch
 == '-' || ch == '+' || ch == '.')

85 
low”_ch
 = 
ch
 | 0x20;

86 ià('a' <ğ
low”_ch
 &&†ower_ch <= 'y')

90 
	}
}

94 
	$¡¹od_bufãr_size
(cÚ¡ *
s
)

96 cÚ¡ *
p
 = 
s
;

98 
	`v®id_numb”_ch¬aù”
(*
p
))

99 
p
++;

101  
p
 - 
s
;

102 
	}
}

106 
	$åcÚv_¡¹od
(cÚ¡ *
ÅŒ
, **
’d±r
)

108 
loÿlbuf
[
FPCONV_G_FMT_BUFSIZE
];

109 *
buf
, *
’dbuf
, *
dp
;

110 
buæ’
;

111 
v®ue
;

114 ià(
loÿË_decim®_pošt
 == '.')

115  
	`¡¹od
(
ÅŒ
, 
’d±r
);

117 
buæ’
 = 
	`¡¹od_bufãr_size
(
ÅŒ
);

118 ià(!
buæ’
) {

120 *
’d±r
 = (*)
ÅŒ
;

125 ià(
buæ’
 >ğ
FPCONV_G_FMT_BUFSIZE
) {

127 
buf
 = 
	`m®loc
(
buæ’
 + 1);

128 ià(!
buf
) {

129 
	`årštf
(
¡d”r
, "Out of memory");

130 
	`abÜt
();

134 
buf
 = 
loÿlbuf
;

136 
	`memıy
(
buf
, 
ÅŒ
, 
buæ’
);

137 
buf
[
buæ’
] = 0;

140 
dp
 = 
	`¡rchr
(
buf
, '.');

141 ià(
dp
)

142 *
dp
 = 
loÿË_decim®_pošt
;

144 
v®ue
 = 
	`¡¹od
(
buf
, &
’dbuf
);

145 *
’d±r
 = (*)&
ÅŒ
[
’dbuf
 - 
buf
];

146 ià(
buæ’
 >ğ
FPCONV_G_FMT_BUFSIZE
)

147 
	`ä“
(
buf
);

149  
v®ue
;

150 
	}
}

153 
	$£t_numb”_fÜm©
(*
fmt
, 
´ecisiÚ
)

155 
d1
, 
d2
, 
i
;

157 
	`as£¹
(1 <ğ
´ecisiÚ
 &&…recision <= 14);

160 
d1
 = 
´ecisiÚ
 / 10;

161 
d2
 = 
´ecisiÚ
 % 10;

162 
fmt
[0] = '%';

163 
fmt
[1] = '.';

164 
i
 = 2;

165 ià(
d1
) {

166 
fmt
[
i
++] = '0' + 
d1
;

168 
fmt
[
i
++] = '0' + 
d2
;

169 
fmt
[
i
++] = 'g';

170 
fmt
[
i
] = 0;

171 
	}
}

174 
	$åcÚv_g_fmt
(*
¡r
, 
num
, 
´ecisiÚ
)

176 
buf
[
FPCONV_G_FMT_BUFSIZE
];

177 
fmt
[6];

178 
Ën
;

179 *
b
;

181 
	`£t_numb”_fÜm©
(
fmt
, 
´ecisiÚ
);

184 ià(
loÿË_decim®_pošt
 == '.')

185  
	`¢´štf
(
¡r
, 
FPCONV_G_FMT_BUFSIZE
, 
fmt
, 
num
);

188 
Ën
 = 
	`¢´štf
(
buf
, 
FPCONV_G_FMT_BUFSIZE
, 
fmt
, 
num
);

191 
b
 = 
buf
;

193 *
¡r
++ = (*
b
 =ğ
loÿË_decim®_pošt
 ? '.' : *b);

194 } *
b
++);

196  
Ën
;

197 
	}
}

199 
	$åcÚv_š™
()

201 
	`åcÚv_upd©e_loÿË
();

202 
	}
}

	@deps/lua/src/fpconv.h

7 
	#FPCONV_G_FMT_BUFSIZE
 32

	)

9 #ifdeà
USE_INTERNAL_FPCONV


10 
šlše
 
	$åcÚv_š™
()

13 
	}
}

15 
åcÚv_š™
();

18 
åcÚv_g_fmt
(*, , );

19 
åcÚv_¡¹od
(const *, **);

	@deps/lua/src/lapi.c

8 
	~<as£¹.h
>

9 
	~<m©h.h
>

10 
	~<¡d¬g.h
>

11 
	~<¡ršg.h
>

13 
	#Ïpi_c


	)

14 
	#LUA_CORE


	)

16 
	~"lua.h
"

18 
	~"Ïpi.h
"

19 
	~"ldebug.h
"

20 
	~"ldo.h
"

21 
	~"lfunc.h
"

22 
	~"lgc.h
"

23 
	~"lmem.h
"

24 
	~"lobjeù.h
"

25 
	~"l¡©e.h
"

26 
	~"l¡ršg.h
"

27 
	~"ÉabË.h
"

28 
	~"Ém.h
"

29 
	~"lundump.h
"

30 
	~"lvm.h
"

34 cÚ¡ 
	glua_id’t
[] =

35 "$Lua: " 
LUA_RELEASE
 " " 
LUA_COPYRIGHT
 " $\n"

36 "$AuthÜs: " 
LUA_AUTHORS
 " $\n"

41 
	#­i_checkÃËms
(
L
, 
n
è
	`­i_check
(L, (nè<ğ(L->
tİ
 - L->
ba£
))

	)

43 
	#­i_checkv®idšdex
(
L
, 
i
è
	`­i_check
(L, (iè!ğ
luaO_nobjeù
)

	)

45 
	#­i_šü_tİ
(
L
è{
	`­i_check
(L, L->
tİ
 < L->
ci
->tİ); L->tİ++;}

	)

49 
TV®ue
 *
	$šdex2adr
 (
lua_S‹
 *
L
, 
idx
) {

50 ià(
idx
 > 0) {

51 
TV®ue
 *
o
 = 
L
->
ba£
 + (
idx
 - 1);

52 
	`­i_check
(
L
, 
idx
 <ğL->
ci
->
tİ
 - L->
ba£
);

53 ià(
o
 >ğ
L
->
tİ
è 
	`ÿ¡
(
TV®ue
 *, 
luaO_nobjeù
);

54  
o
;

56 ià(
idx
 > 
LUA_REGISTRYINDEX
) {

57 
	`­i_check
(
L
, 
idx
 !ğ0 && -idx <ğL->
tİ
 - L->
ba£
);

58  
L
->
tİ
 + 
idx
;

60 
idx
) {

61 
LUA_REGISTRYINDEX
:  
	`»gi¡ry
(
L
);

62 
LUA_ENVIRONINDEX
: {

63 
Closu»
 *
func
 = 
	`cu¼_func
(
L
);

64 
	`£thv®ue
(
L
, &L->
’v
, 
func
->
c
.env);

65  &
L
->
’v
;

67 
LUA_GLOBALSINDEX
:  
	`gt
(
L
);

69 
Closu»
 *
func
 = 
	`cu¼_func
(
L
);

70 
idx
 = 
LUA_GLOBALSINDEX
 - idx;

71  (
idx
 <ğ
func
->
c
.
nupv®ues
)

72 ? &
func
->
c
.
upv®ue
[
idx
-1]

73 : 
	`ÿ¡
(
TV®ue
 *, 
luaO_nobjeù
);

76 
	}
}

79 
TabË
 *
	$g‘cu¼’v
 (
lua_S‹
 *
L
) {

80 ià(
L
->
ci
 =ğL->
ba£_ci
)

81  
	`hv®ue
(
	`gt
(
L
));

83 
Closu»
 *
func
 = 
	`cu¼_func
(
L
);

84  
func
->
c
.
’v
;

86 
	}
}

89 
	$luaA_pushobjeù
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
o
) {

90 
	`£tobj2s
(
L
, L->
tİ
, 
o
);

91 
	`­i_šü_tİ
(
L
);

92 
	}
}

95 
LUA_API
 
	$lua_check¡ack
 (
lua_S‹
 *
L
, 
size
) {

96 
»s
 = 1;

97 
	`lua_lock
(
L
);

98 ià(
size
 > 
LUAI_MAXCSTACK
 || (
L
->
tİ
 - L->
ba£
 + size) > LUAI_MAXCSTACK)

99 
»s
 = 0;

100 ià(
size
 > 0) {

101 
	`luaD_check¡ack
(
L
, 
size
);

102 ià(
L
->
ci
->
tİ
 < L->tİ + 
size
)

103 
L
->
ci
->
tİ
 = L->tİ + 
size
;

105 
	`lua_uÆock
(
L
);

106  
»s
;

107 
	}
}

110 
LUA_API
 
	$lua_xmove
 (
lua_S‹
 *
äom
,†ua_S‹ *
to
, 
n
) {

111 
i
;

112 ià(
äom
 =ğ
to
) ;

113 
	`lua_lock
(
to
);

114 
	`­i_checkÃËms
(
äom
, 
n
);

115 
	`­i_check
(
äom
, 
	`G
(äomè=ğG(
to
));

116 
	`­i_check
(
äom
, 
to
->
ci
->
tİ
 -o->tİ >ğ
n
);

117 
äom
->
tİ
 -ğ
n
;

118 
i
 = 0; i < 
n
; i++) {

119 
	`£tobj2s
(
to
,o->
tİ
++, 
äom
->tİ + 
i
);

121 
	`lua_uÆock
(
to
);

122 
	}
}

125 
LUA_API
 
	$lua_£ev–
 (
lua_S‹
 *
äom
,†ua_S‹ *
to
) {

126 
to
->
nCÿÎs
 = 
äom
->nCcalls;

127 
	}
}

130 
LUA_API
 
lua_CFunùiÚ
 
	$lua_©·nic
 (
lua_S‹
 *
L
, 
lua_CFunùiÚ
 
·nicf
) {

131 
lua_CFunùiÚ
 
Şd
;

132 
	`lua_lock
(
L
);

133 
Şd
 = 
	`G
(
L
)->
·nic
;

134 
	`G
(
L
)->
·nic
 = 
·nicf
;

135 
	`lua_uÆock
(
L
);

136  
Şd
;

137 
	}
}

140 
LUA_API
 
lua_S‹
 *
	$lua_Ãwth»ad
 (
lua_S‹
 *
L
) {

141 
lua_S‹
 *
L1
;

142 
	`lua_lock
(
L
);

143 
	`luaC_checkGC
(
L
);

144 
L1
 = 
	`luaE_Ãwth»ad
(
L
);

145 
	`£‰hv®ue
(
L
, L->
tİ
, 
L1
);

146 
	`­i_šü_tİ
(
L
);

147 
	`lua_uÆock
(
L
);

148 
	`luai_u£r¡©‘h»ad
(
L
, 
L1
);

149  
L1
;

150 
	}
}

159 
LUA_API
 
	$lua_g‘tİ
 (
lua_S‹
 *
L
) {

160  
	`ÿ¡_št
(
L
->
tİ
 - L->
ba£
);

161 
	}
}

164 
LUA_API
 
	$lua_£‰İ
 (
lua_S‹
 *
L
, 
idx
) {

165 
	`lua_lock
(
L
);

166 ià(
idx
 >= 0) {

167 
	`­i_check
(
L
, 
idx
 <ğL->
¡ack_Ï¡
 - L->
ba£
);

168 
L
->
tİ
 < L->
ba£
 + 
idx
)

169 
	`£Šv®ue
(
L
->
tİ
++);

170 
L
->
tİ
 = L->
ba£
 + 
idx
;

173 
	`­i_check
(
L
, -(
idx
+1è<ğ(L->
tİ
 - L->
ba£
));

174 
L
->
tİ
 +ğ
idx
+1;

176 
	`lua_uÆock
(
L
);

177 
	}
}

180 
LUA_API
 
	$lua_»move
 (
lua_S‹
 *
L
, 
idx
) {

181 
StkId
 
p
;

182 
	`lua_lock
(
L
);

183 
p
 = 
	`šdex2adr
(
L
, 
idx
);

184 
	`­i_checkv®idšdex
(
L
, 
p
);

185 ++
p
 < 
L
->
tİ
è
	`£tobjs2s
(L,…-1,…);

186 
L
->
tİ
--;

187 
	`lua_uÆock
(
L
);

188 
	}
}

191 
LUA_API
 
	$lua_š£¹
 (
lua_S‹
 *
L
, 
idx
) {

192 
StkId
 
p
;

193 
StkId
 
q
;

194 
	`lua_lock
(
L
);

195 
p
 = 
	`šdex2adr
(
L
, 
idx
);

196 
	`­i_checkv®idšdex
(
L
, 
p
);

197 
q
 = 
L
->
tİ
; q>
p
; q--è
	`£tobjs2s
(L, q, q-1);

198 
	`£tobjs2s
(
L
, 
p
, L->
tİ
);

199 
	`lua_uÆock
(
L
);

200 
	}
}

203 
LUA_API
 
	$lua_»¶aû
 (
lua_S‹
 *
L
, 
idx
) {

204 
StkId
 
o
;

205 
	`lua_lock
(
L
);

207 ià(
idx
 =ğ
LUA_ENVIRONINDEX
 && 
L
->
ci
 =ğL->
ba£_ci
)

208 
	`luaG_ruÃ¼Ü
(
L
, "no callingƒnvironment");

209 
	`­i_checkÃËms
(
L
, 1);

210 
o
 = 
	`šdex2adr
(
L
, 
idx
);

211 
	`­i_checkv®idšdex
(
L
, 
o
);

212 ià(
idx
 =ğ
LUA_ENVIRONINDEX
) {

213 
Closu»
 *
func
 = 
	`cu¼_func
(
L
);

214 
	`­i_check
(
L
, 
	`‰i¡abË
(L->
tİ
 - 1));

215 
func
->
c
.
’v
 = 
	`hv®ue
(
L
->
tİ
 - 1);

216 
	`luaC_b¬r›r
(
L
, 
func
, L->
tİ
 - 1);

219 
	`£tobj
(
L
, 
o
, L->
tİ
 - 1);

220 ià(
idx
 < 
LUA_GLOBALSINDEX
)

221 
	`luaC_b¬r›r
(
L
, 
	`cu¼_func
(L), L->
tİ
 - 1);

223 
L
->
tİ
--;

224 
	`lua_uÆock
(
L
);

225 
	}
}

228 
LUA_API
 
	$lua_pushv®ue
 (
lua_S‹
 *
L
, 
idx
) {

229 
	`lua_lock
(
L
);

230 
	`£tobj2s
(
L
, L->
tİ
, 
	`šdex2adr
(L, 
idx
));

231 
	`­i_šü_tİ
(
L
);

232 
	`lua_uÆock
(
L
);

233 
	}
}

242 
LUA_API
 
	$lua_ty³
 (
lua_S‹
 *
L
, 
idx
) {

243 
StkId
 
o
 = 
	`šdex2adr
(
L
, 
idx
);

244  (
o
 =ğ
luaO_nobjeù
è? 
LUA_TNONE
 : 
	`‰y³
(o);

245 
	}
}

248 
LUA_API
 cÚ¡ *
	$lua_ty³Çme
 (
lua_S‹
 *
L
, 
t
) {

249 
	`UNUSED
(
L
);

250  (
t
 =ğ
LUA_TNONE
è? "nØv®ue" : 
luaT_ty³Çmes
[t];

251 
	}
}

254 
LUA_API
 
	$lua_iscfunùiÚ
 (
lua_S‹
 *
L
, 
idx
) {

255 
StkId
 
o
 = 
	`šdex2adr
(
L
, 
idx
);

256  
	`iscfunùiÚ
(
o
);

257 
	}
}

260 
LUA_API
 
	$lua_i¢umb”
 (
lua_S‹
 *
L
, 
idx
) {

261 
TV®ue
 
n
;

262 cÚ¡ 
TV®ue
 *
o
 = 
	`šdex2adr
(
L
, 
idx
);

263  
	`tÚumb”
(
o
, &
n
);

264 
	}
}

267 
LUA_API
 
	$lua_is¡ršg
 (
lua_S‹
 *
L
, 
idx
) {

268 
t
 = 
	`lua_ty³
(
L
, 
idx
);

269  (
t
 =ğ
LUA_TSTRING
 || =ğ
LUA_TNUMBER
);

270 
	}
}

273 
LUA_API
 
	$lua_isu£rd©a
 (
lua_S‹
 *
L
, 
idx
) {

274 cÚ¡ 
TV®ue
 *
o
 = 
	`šdex2adr
(
L
, 
idx
);

275  (
	`‰isu£rd©a
(
o
è|| 
	`‰i¦ightu£rd©a
(o));

276 
	}
}

279 
LUA_API
 
	$lua_¿wequ®
 (
lua_S‹
 *
L
, 
šdex1
, 
šdex2
) {

280 
StkId
 
o1
 = 
	`šdex2adr
(
L
, 
šdex1
);

281 
StkId
 
o2
 = 
	`šdex2adr
(
L
, 
šdex2
);

282  (
o1
 =ğ
luaO_nobjeù
 || 
o2
 ==†uaO_nilobject) ? 0

283 : 
	`luaO_¿wequ®Obj
(
o1
, 
o2
);

284 
	}
}

287 
LUA_API
 
	$lua_equ®
 (
lua_S‹
 *
L
, 
šdex1
, 
šdex2
) {

288 
StkId
 
o1
, 
o2
;

289 
i
;

290 
	`lua_lock
(
L
);

291 
o1
 = 
	`šdex2adr
(
L
, 
šdex1
);

292 
o2
 = 
	`šdex2adr
(
L
, 
šdex2
);

293 
i
 = (
o1
 =ğ
luaO_nobjeù
 || 
o2
 =ğluaO_nobjeùè? 0 : 
	`equ®obj
(
L
, o1, o2);

294 
	`lua_uÆock
(
L
);

295  
i
;

296 
	}
}

299 
LUA_API
 
	$lua_Ës¡hª
 (
lua_S‹
 *
L
, 
šdex1
, 
šdex2
) {

300 
StkId
 
o1
, 
o2
;

301 
i
;

302 
	`lua_lock
(
L
);

303 
o1
 = 
	`šdex2adr
(
L
, 
šdex1
);

304 
o2
 = 
	`šdex2adr
(
L
, 
šdex2
);

305 
i
 = (
o1
 =ğ
luaO_nobjeù
 || 
o2
 ==†uaO_nilobject) ? 0

306 : 
	`luaV_Ës¡hª
(
L
, 
o1
, 
o2
);

307 
	`lua_uÆock
(
L
);

308  
i
;

309 
	}
}

313 
LUA_API
 
lua_Numb”
 
	$lua_tÚumb”
 (
lua_S‹
 *
L
, 
idx
) {

314 
TV®ue
 
n
;

315 cÚ¡ 
TV®ue
 *
o
 = 
	`šdex2adr
(
L
, 
idx
);

316 ià(
	`tÚumb”
(
o
, &
n
))

317  
	`nv®ue
(
o
);

320 
	}
}

323 
LUA_API
 
lua_IÁeg”
 
	$lua_toš‹g”
 (
lua_S‹
 *
L
, 
idx
) {

324 
TV®ue
 
n
;

325 cÚ¡ 
TV®ue
 *
o
 = 
	`šdex2adr
(
L
, 
idx
);

326 ià(
	`tÚumb”
(
o
, &
n
)) {

327 
lua_IÁeg”
 
»s
;

328 
lua_Numb”
 
num
 = 
	`nv®ue
(
o
);

329 
	`lua_numb”2š‹g”
(
»s
, 
num
);

330  
»s
;

334 
	}
}

337 
LUA_API
 
	$lua_toboŞ—n
 (
lua_S‹
 *
L
, 
idx
) {

338 cÚ¡ 
TV®ue
 *
o
 = 
	`šdex2adr
(
L
, 
idx
);

339  !
	`l_isçl£
(
o
);

340 
	}
}

343 
LUA_API
 cÚ¡ *
	$lua_tŞ¡ršg
 (
lua_S‹
 *
L
, 
idx
, 
size_t
 *
Ën
) {

344 
StkId
 
o
 = 
	`šdex2adr
(
L
, 
idx
);

345 ià(!
	`‰is¡ršg
(
o
)) {

346 
	`lua_lock
(
L
);

347 ià(!
	`luaV_to¡ršg
(
L
, 
o
)) {

348 ià(
Ën
 !ğ
NULL
) *len = 0;

349 
	`lua_uÆock
(
L
);

350  
NULL
;

352 
	`luaC_checkGC
(
L
);

353 
o
 = 
	`šdex2adr
(
L
, 
idx
);

354 
	`lua_uÆock
(
L
);

356 ià(
Ën
 !ğ
NULL
è*ËÀğ
	`tsv®ue
(
o
)->len;

357  
	`sv®ue
(
o
);

358 
	}
}

361 
LUA_API
 
size_t
 
	$lua_objËn
 (
lua_S‹
 *
L
, 
idx
) {

362 
StkId
 
o
 = 
	`šdex2adr
(
L
, 
idx
);

363 
	`‰y³
(
o
)) {

364 
LUA_TSTRING
:  
	`tsv®ue
(
o
)->
Ën
;

365 
LUA_TUSERDATA
:  
	`uv®ue
(
o
)->
Ën
;

366 
LUA_TTABLE
:  
	`luaH_g‘n
(
	`hv®ue
(
o
));

367 
LUA_TNUMBER
: {

368 
size_t
 
l
;

369 
	`lua_lock
(
L
);

370 
l
 = (
	`luaV_to¡ršg
(
L
, 
o
è? 
	`tsv®ue
(o)->
Ën
 : 0);

371 
	`lua_uÆock
(
L
);

372  
l
;

376 
	}
}

379 
LUA_API
 
lua_CFunùiÚ
 
	$lua_tocfunùiÚ
 (
lua_S‹
 *
L
, 
idx
) {

380 
StkId
 
o
 = 
	`šdex2adr
(
L
, 
idx
);

381  (!
	`iscfunùiÚ
(
o
)è? 
NULL
 : 
	`şv®ue
(o)->
c
.
f
;

382 
	}
}

385 
LUA_API
 *
	$lua_tou£rd©a
 (
lua_S‹
 *
L
, 
idx
) {

386 
StkId
 
o
 = 
	`šdex2adr
(
L
, 
idx
);

387 
	`‰y³
(
o
)) {

388 
LUA_TUSERDATA
:  (
	`¿wuv®ue
(
o
) + 1);

389 
LUA_TLIGHTUSERDATA
:  
	`pv®ue
(
o
);

390 :  
NULL
;

392 
	}
}

395 
LUA_API
 
lua_S‹
 *
	$lua_tÙh»ad
 (
lua_S‹
 *
L
, 
idx
) {

396 
StkId
 
o
 = 
	`šdex2adr
(
L
, 
idx
);

397  (!
	`‰i¡h»ad
(
o
)è? 
NULL
 : 
	`thv®ue
(o);

398 
	}
}

401 
LUA_API
 cÚ¡ *
	$lua_tİoš‹r
 (
lua_S‹
 *
L
, 
idx
) {

402 
StkId
 
o
 = 
	`šdex2adr
(
L
, 
idx
);

403 
	`‰y³
(
o
)) {

404 
LUA_TTABLE
:  
	`hv®ue
(
o
);

405 
LUA_TFUNCTION
:  
	`şv®ue
(
o
);

406 
LUA_TTHREAD
:  
	`thv®ue
(
o
);

407 
LUA_TUSERDATA
:

408 
LUA_TLIGHTUSERDATA
:

409  
	`lua_tou£rd©a
(
L
, 
idx
);

410 :  
NULL
;

412 
	}
}

421 
LUA_API
 
	$lua_pushn
 (
lua_S‹
 *
L
) {

422 
	`lua_lock
(
L
);

423 
	`£Šv®ue
(
L
->
tİ
);

424 
	`­i_šü_tİ
(
L
);

425 
	`lua_uÆock
(
L
);

426 
	}
}

429 
LUA_API
 
	$lua_pushnumb”
 (
lua_S‹
 *
L
, 
lua_Numb”
 
n
) {

430 
	`lua_lock
(
L
);

431 
	`£Šv®ue
(
L
->
tİ
, 
n
);

432 
	`­i_šü_tİ
(
L
);

433 
	`lua_uÆock
(
L
);

434 
	}
}

437 
LUA_API
 
	$lua_pushš‹g”
 (
lua_S‹
 *
L
, 
lua_IÁeg”
 
n
) {

438 
	`lua_lock
(
L
);

439 
	`£Šv®ue
(
L
->
tİ
, 
	`ÿ¡_num
(
n
));

440 
	`­i_šü_tİ
(
L
);

441 
	`lua_uÆock
(
L
);

442 
	}
}

445 
LUA_API
 
	$lua_pushl¡ršg
 (
lua_S‹
 *
L
, cÚ¡ *
s
, 
size_t
 
Ën
) {

446 
	`lua_lock
(
L
);

447 
	`luaC_checkGC
(
L
);

448 
	`£tsv®ue2s
(
L
, L->
tİ
, 
	`luaS_Ãwl¡r
(L, 
s
, 
Ën
));

449 
	`­i_šü_tİ
(
L
);

450 
	`lua_uÆock
(
L
);

451 
	}
}

454 
LUA_API
 
	$lua_push¡ršg
 (
lua_S‹
 *
L
, cÚ¡ *
s
) {

455 ià(
s
 =ğ
NULL
)

456 
	`lua_pushn
(
L
);

458 
	`lua_pushl¡ršg
(
L
, 
s
, 
	`¡¾’
(s));

459 
	}
}

462 
LUA_API
 cÚ¡ *
	$lua_pushvf¡ršg
 (
lua_S‹
 *
L
, cÚ¡ *
fmt
,

463 
va_li¡
 
¬gp
) {

464 cÚ¡ *
»t
;

465 
	`lua_lock
(
L
);

466 
	`luaC_checkGC
(
L
);

467 
»t
 = 
	`luaO_pushvf¡ršg
(
L
, 
fmt
, 
¬gp
);

468 
	`lua_uÆock
(
L
);

469  
»t
;

470 
	}
}

473 
LUA_API
 cÚ¡ *
	$lua_pushf¡ršg
 (
lua_S‹
 *
L
, cÚ¡ *
fmt
, ...) {

474 cÚ¡ *
»t
;

475 
va_li¡
 
¬gp
;

476 
	`lua_lock
(
L
);

477 
	`luaC_checkGC
(
L
);

478 
	`va_¡¬t
(
¬gp
, 
fmt
);

479 
»t
 = 
	`luaO_pushvf¡ršg
(
L
, 
fmt
, 
¬gp
);

480 
	`va_’d
(
¬gp
);

481 
	`lua_uÆock
(
L
);

482  
»t
;

483 
	}
}

486 
LUA_API
 
	$lua_pushcşosu»
 (
lua_S‹
 *
L
, 
lua_CFunùiÚ
 
â
, 
n
) {

487 
Closu»
 *
ş
;

488 
	`lua_lock
(
L
);

489 
	`luaC_checkGC
(
L
);

490 
	`­i_checkÃËms
(
L
, 
n
);

491 
ş
 = 
	`luaF_ÃwCşosu»
(
L
, 
n
, 
	`g‘cu¼’v
(L));

492 
ş
->
c
.
f
 = 
â
;

493 
L
->
tİ
 -ğ
n
;

494 
n
--)

495 
	`£tobj2n
(
L
, &
ş
->
c
.
upv®ue
[
n
], L->
tİ
+n);

496 
	`£tşv®ue
(
L
, L->
tİ
, 
ş
);

497 
	`lua_as£¹
(
	`iswh™e
(
	`obj2gco
(
ş
)));

498 
	`­i_šü_tİ
(
L
);

499 
	`lua_uÆock
(
L
);

500 
	}
}

503 
LUA_API
 
	$lua_pushboŞ—n
 (
lua_S‹
 *
L
, 
b
) {

504 
	`lua_lock
(
L
);

505 
	`£tbv®ue
(
L
->
tİ
, (
b
 != 0));

506 
	`­i_šü_tİ
(
L
);

507 
	`lua_uÆock
(
L
);

508 
	}
}

511 
LUA_API
 
	$lua_pushlightu£rd©a
 (
lua_S‹
 *
L
, *
p
) {

512 
	`lua_lock
(
L
);

513 
	`£v®ue
(
L
->
tİ
, 
p
);

514 
	`­i_šü_tİ
(
L
);

515 
	`lua_uÆock
(
L
);

516 
	}
}

519 
LUA_API
 
	$lua_pushth»ad
 (
lua_S‹
 *
L
) {

520 
	`lua_lock
(
L
);

521 
	`£‰hv®ue
(
L
, L->
tİ
, L);

522 
	`­i_šü_tİ
(
L
);

523 
	`lua_uÆock
(
L
);

524  (
	`G
(
L
)->
mašth»ad
 == L);

525 
	}
}

534 
LUA_API
 
	$lua_g‘bË
 (
lua_S‹
 *
L
, 
idx
) {

535 
StkId
 
t
;

536 
	`lua_lock
(
L
);

537 
t
 = 
	`šdex2adr
(
L
, 
idx
);

538 
	`­i_checkv®idšdex
(
L
, 
t
);

539 
	`luaV_g‘bË
(
L
, 
t
, L->
tİ
 - 1, L->top - 1);

540 
	`lua_uÆock
(
L
);

541 
	}
}

544 
LUA_API
 
	$lua_g‘f›ld
 (
lua_S‹
 *
L
, 
idx
, cÚ¡ *
k
) {

545 
StkId
 
t
;

546 
TV®ue
 
key
;

547 
	`lua_lock
(
L
);

548 
t
 = 
	`šdex2adr
(
L
, 
idx
);

549 
	`­i_checkv®idšdex
(
L
, 
t
);

550 
	`£tsv®ue
(
L
, &
key
, 
	`luaS_Ãw
(L, 
k
));

551 
	`luaV_g‘bË
(
L
, 
t
, &
key
, L->
tİ
);

552 
	`­i_šü_tİ
(
L
);

553 
	`lua_uÆock
(
L
);

554 
	}
}

557 
LUA_API
 
	$lua_¿wg‘
 (
lua_S‹
 *
L
, 
idx
) {

558 
StkId
 
t
;

559 
	`lua_lock
(
L
);

560 
t
 = 
	`šdex2adr
(
L
, 
idx
);

561 
	`­i_check
(
L
, 
	`‰i¡abË
(
t
));

562 
	`£tobj2s
(
L
, L->
tİ
 - 1, 
	`luaH_g‘
(
	`hv®ue
(
t
), L->top - 1));

563 
	`lua_uÆock
(
L
);

564 
	}
}

567 
LUA_API
 
	$lua_¿wg‘i
 (
lua_S‹
 *
L
, 
idx
, 
n
) {

568 
StkId
 
o
;

569 
	`lua_lock
(
L
);

570 
o
 = 
	`šdex2adr
(
L
, 
idx
);

571 
	`­i_check
(
L
, 
	`‰i¡abË
(
o
));

572 
	`£tobj2s
(
L
, L->
tİ
, 
	`luaH_g‘num
(
	`hv®ue
(
o
), 
n
));

573 
	`­i_šü_tİ
(
L
);

574 
	`lua_uÆock
(
L
);

575 
	}
}

578 
LUA_API
 
	$lua_ü—‹bË
 (
lua_S‹
 *
L
, 
Ç¼ay
, 
Äec
) {

579 
	`lua_lock
(
L
);

580 
	`luaC_checkGC
(
L
);

581 
	`£thv®ue
(
L
, L->
tİ
, 
	`luaH_Ãw
(L, 
Ç¼ay
, 
Äec
));

582 
	`­i_šü_tİ
(
L
);

583 
	`lua_uÆock
(
L
);

584 
	}
}

587 
LUA_API
 
	$lua_g‘m‘©abË
 (
lua_S‹
 *
L
, 
objšdex
) {

588 cÚ¡ 
TV®ue
 *
obj
;

589 
TabË
 *
mt
 = 
NULL
;

590 
»s
;

591 
	`lua_lock
(
L
);

592 
obj
 = 
	`šdex2adr
(
L
, 
objšdex
);

593 
	`‰y³
(
obj
)) {

594 
LUA_TTABLE
:

595 
mt
 = 
	`hv®ue
(
obj
)->
m‘©abË
;

597 
LUA_TUSERDATA
:

598 
mt
 = 
	`uv®ue
(
obj
)->
m‘©abË
;

601 
mt
 = 
	`G
(
L
)->mt[
	`‰y³
(
obj
)];

604 ià(
mt
 =ğ
NULL
)

605 
»s
 = 0;

607 
	`£thv®ue
(
L
, L->
tİ
, 
mt
);

608 
	`­i_šü_tİ
(
L
);

609 
»s
 = 1;

611 
	`lua_uÆock
(
L
);

612  
»s
;

613 
	}
}

616 
LUA_API
 
	$lua_g‘ãnv
 (
lua_S‹
 *
L
, 
idx
) {

617 
StkId
 
o
;

618 
	`lua_lock
(
L
);

619 
o
 = 
	`šdex2adr
(
L
, 
idx
);

620 
	`­i_checkv®idšdex
(
L
, 
o
);

621 
	`‰y³
(
o
)) {

622 
LUA_TFUNCTION
:

623 
	`£thv®ue
(
L
, L->
tİ
, 
	`şv®ue
(
o
)->
c
.
’v
);

625 
LUA_TUSERDATA
:

626 
	`£thv®ue
(
L
, L->
tİ
, 
	`uv®ue
(
o
)->
’v
);

628 
LUA_TTHREAD
:

629 
	`£tobj2s
(
L
, L->
tİ
, 
	`gt
(
	`thv®ue
(
o
)));

632 
	`£Šv®ue
(
L
->
tİ
);

635 
	`­i_šü_tİ
(
L
);

636 
	`lua_uÆock
(
L
);

637 
	}
}

645 
LUA_API
 
	$lua_£‰abË
 (
lua_S‹
 *
L
, 
idx
) {

646 
StkId
 
t
;

647 
	`lua_lock
(
L
);

648 
	`­i_checkÃËms
(
L
, 2);

649 
t
 = 
	`šdex2adr
(
L
, 
idx
);

650 
	`­i_checkv®idšdex
(
L
, 
t
);

651 
	`luaV_£‰abË
(
L
, 
t
, L->
tİ
 - 2, L->top - 1);

652 
L
->
tİ
 -= 2;

653 
	`lua_uÆock
(
L
);

654 
	}
}

657 
LUA_API
 
	$lua_£tf›ld
 (
lua_S‹
 *
L
, 
idx
, cÚ¡ *
k
) {

658 
StkId
 
t
;

659 
TV®ue
 
key
;

660 
	`lua_lock
(
L
);

661 
	`­i_checkÃËms
(
L
, 1);

662 
t
 = 
	`šdex2adr
(
L
, 
idx
);

663 
	`­i_checkv®idšdex
(
L
, 
t
);

664 
	`£tsv®ue
(
L
, &
key
, 
	`luaS_Ãw
(L, 
k
));

665 
	`luaV_£‰abË
(
L
, 
t
, &
key
, L->
tİ
 - 1);

666 
L
->
tİ
--;

667 
	`lua_uÆock
(
L
);

668 
	}
}

671 
LUA_API
 
	$lua_¿w£t
 (
lua_S‹
 *
L
, 
idx
) {

672 
StkId
 
t
;

673 
	`lua_lock
(
L
);

674 
	`­i_checkÃËms
(
L
, 2);

675 
t
 = 
	`šdex2adr
(
L
, 
idx
);

676 
	`­i_check
(
L
, 
	`‰i¡abË
(
t
));

677 
	`£tobj2t
(
L
, 
	`luaH_£t
(L, 
	`hv®ue
(
t
), L->
tİ
-2), L->top-1);

678 
	`luaC_b¬r›¹
(
L
, 
	`hv®ue
(
t
), L->
tİ
-1);

679 
L
->
tİ
 -= 2;

680 
	`lua_uÆock
(
L
);

681 
	}
}

684 
LUA_API
 
	$lua_¿w£ti
 (
lua_S‹
 *
L
, 
idx
, 
n
) {

685 
StkId
 
o
;

686 
	`lua_lock
(
L
);

687 
	`­i_checkÃËms
(
L
, 1);

688 
o
 = 
	`šdex2adr
(
L
, 
idx
);

689 
	`­i_check
(
L
, 
	`‰i¡abË
(
o
));

690 
	`£tobj2t
(
L
, 
	`luaH_£Šum
(L, 
	`hv®ue
(
o
), 
n
), L->
tİ
-1);

691 
	`luaC_b¬r›¹
(
L
, 
	`hv®ue
(
o
), L->
tİ
-1);

692 
L
->
tİ
--;

693 
	`lua_uÆock
(
L
);

694 
	}
}

697 
LUA_API
 
	$lua_£tm‘©abË
 (
lua_S‹
 *
L
, 
objšdex
) {

698 
TV®ue
 *
obj
;

699 
TabË
 *
mt
;

700 
	`lua_lock
(
L
);

701 
	`­i_checkÃËms
(
L
, 1);

702 
obj
 = 
	`šdex2adr
(
L
, 
objšdex
);

703 
	`­i_checkv®idšdex
(
L
, 
obj
);

704 ià(
	`‰i¢
(
L
->
tİ
 - 1))

705 
mt
 = 
NULL
;

707 
	`­i_check
(
L
, 
	`‰i¡abË
(L->
tİ
 - 1));

708 
mt
 = 
	`hv®ue
(
L
->
tİ
 - 1);

710 
	`‰y³
(
obj
)) {

711 
LUA_TTABLE
: {

712 
	`hv®ue
(
obj
)->
m‘©abË
 = 
mt
;

713 ià(
mt
)

714 
	`luaC_objb¬r›¹
(
L
, 
	`hv®ue
(
obj
), 
mt
);

717 
LUA_TUSERDATA
: {

718 
	`uv®ue
(
obj
)->
m‘©abË
 = 
mt
;

719 ià(
mt
)

720 
	`luaC_objb¬r›r
(
L
, 
	`¿wuv®ue
(
obj
), 
mt
);

724 
	`G
(
L
)->
mt
[
	`‰y³
(
obj
)] = mt;

728 
L
->
tİ
--;

729 
	`lua_uÆock
(
L
);

731 
	}
}

734 
LUA_API
 
	$lua_£tãnv
 (
lua_S‹
 *
L
, 
idx
) {

735 
StkId
 
o
;

736 
»s
 = 1;

737 
	`lua_lock
(
L
);

738 
	`­i_checkÃËms
(
L
, 1);

739 
o
 = 
	`šdex2adr
(
L
, 
idx
);

740 
	`­i_checkv®idšdex
(
L
, 
o
);

741 
	`­i_check
(
L
, 
	`‰i¡abË
(L->
tİ
 - 1));

742 
	`‰y³
(
o
)) {

743 
LUA_TFUNCTION
:

744 
	`şv®ue
(
o
)->
c
.
’v
 = 
	`hv®ue
(
L
->
tİ
 - 1);

746 
LUA_TUSERDATA
:

747 
	`uv®ue
(
o
)->
’v
 = 
	`hv®ue
(
L
->
tİ
 - 1);

749 
LUA_TTHREAD
:

750 
	`£thv®ue
(
L
, 
	`gt
(
	`thv®ue
(
o
)), 
	`hv®ue
(L->
tİ
 - 1));

753 
»s
 = 0;

756 ià(
»s
è
	`luaC_objb¬r›r
(
L
, 
	`gcv®ue
(
o
), 
	`hv®ue
(L->
tİ
 - 1));

757 
L
->
tİ
--;

758 
	`lua_uÆock
(
L
);

759  
»s
;

760 
	}
}

768 
	#adju¡»suÉs
(
L
,
Äes
) \

769 { ià(
Äes
 =ğ
LUA_MULTRET
 && 
L
->
tİ
 >ğL->
ci
->tİèL->ci->tİ = L->tİ; }

	)

772 
	#check»suÉs
(
L
,
Ç
,
Ä
) \

773 
	`­i_check
(
L
, (
Ä
è=ğ
LUA_MULTRET
 || (L->
ci
->
tİ
 - L->tİ >ğÒrè- (
Ç
)))

	)

776 
LUA_API
 
	$lua_ÿÎ
 (
lua_S‹
 *
L
, 
Çrgs
, 
ÄesuÉs
) {

777 
StkId
 
func
;

778 
	`lua_lock
(
L
);

779 
	`­i_checkÃËms
(
L
, 
Çrgs
+1);

780 
	`check»suÉs
(
L
, 
Çrgs
, 
ÄesuÉs
);

781 
func
 = 
L
->
tİ
 - (
Çrgs
+1);

782 
	`luaD_ÿÎ
(
L
, 
func
, 
ÄesuÉs
);

783 
	`adju¡»suÉs
(
L
, 
ÄesuÉs
);

784 
	`lua_uÆock
(
L
);

785 
	}
}

792 
	sC®lS
 {

793 
StkId
 
	mfunc
;

794 
	mÄesuÉs
;

798 
	$f_ÿÎ
 (
lua_S‹
 *
L
, *
ud
) {

799 
C®lS
 *
c
 = 
	`ÿ¡
(C®lS *, 
ud
);

800 
	`luaD_ÿÎ
(
L
, 
c
->
func
, c->
ÄesuÉs
);

801 
	}
}

805 
LUA_API
 
	$lua_pÿÎ
 (
lua_S‹
 *
L
, 
Çrgs
, 
ÄesuÉs
, 
”rfunc
) {

806 
C®lS
 
c
;

807 
¡©us
;

808 
±rdiff_t
 
func
;

809 
	`lua_lock
(
L
);

810 
	`­i_checkÃËms
(
L
, 
Çrgs
+1);

811 
	`check»suÉs
(
L
, 
Çrgs
, 
ÄesuÉs
);

812 ià(
”rfunc
 == 0)

813 
func
 = 0;

815 
StkId
 
o
 = 
	`šdex2adr
(
L
, 
”rfunc
);

816 
	`­i_checkv®idšdex
(
L
, 
o
);

817 
func
 = 
	`§ve¡ack
(
L
, 
o
);

819 
c
.
func
 = 
L
->
tİ
 - (
Çrgs
+1);

820 
c
.
ÄesuÉs
 =‚results;

821 
¡©us
 = 
	`luaD_pÿÎ
(
L
, 
f_ÿÎ
, &
c
, 
	`§ve¡ack
(L, c.
func
), func);

822 
	`adju¡»suÉs
(
L
, 
ÄesuÉs
);

823 
	`lua_uÆock
(
L
);

824  
¡©us
;

825 
	}
}

831 
	sCC®lS
 {

832 
lua_CFunùiÚ
 
	mfunc
;

833 *
	mud
;

837 
	$f_CÿÎ
 (
lua_S‹
 *
L
, *
ud
) {

838 
CC®lS
 *
c
 = 
	`ÿ¡
(CC®lS *, 
ud
);

839 
Closu»
 *
ş
;

840 
ş
 = 
	`luaF_ÃwCşosu»
(
L
, 0, 
	`g‘cu¼’v
(L));

841 
ş
->
c
.
f
 = c->
func
;

842 
	`£tşv®ue
(
L
, L->
tİ
, 
ş
);

843 
	`­i_šü_tİ
(
L
);

844 
	`£v®ue
(
L
->
tİ
, 
c
->
ud
);

845 
	`­i_šü_tİ
(
L
);

846 
	`luaD_ÿÎ
(
L
, L->
tİ
 - 2, 0);

847 
	}
}

850 
LUA_API
 
	$lua_ıÿÎ
 (
lua_S‹
 *
L
, 
lua_CFunùiÚ
 
func
, *
ud
) {

851 
CC®lS
 
c
;

852 
¡©us
;

853 
	`lua_lock
(
L
);

854 
c
.
func
 = func;

855 
c
.
ud
 = ud;

856 
¡©us
 = 
	`luaD_pÿÎ
(
L
, 
f_CÿÎ
, &
c
, 
	`§ve¡ack
(L, L->
tİ
), 0);

857 
	`lua_uÆock
(
L
);

858  
¡©us
;

859 
	}
}

862 
LUA_API
 
	$lua_lßd
 (
lua_S‹
 *
L
, 
lua_R—d”
 
»ad”
, *
d©a
,

863 cÚ¡ *
chunkÇme
) {

864 
ZIO
 
z
;

865 
¡©us
;

866 
	`lua_lock
(
L
);

867 ià(!
chunkÇme
) chunkname = "?";

868 
	`luaZ_š™
(
L
, &
z
, 
»ad”
, 
d©a
);

869 
¡©us
 = 
	`luaD_´Ùeùed·r£r
(
L
, &
z
, 
chunkÇme
);

870 
	`lua_uÆock
(
L
);

871  
¡©us
;

872 
	}
}

875 
LUA_API
 
	$lua_dump
 (
lua_S‹
 *
L
, 
lua_Wr™”
 
wr™”
, *
d©a
) {

876 
¡©us
;

877 
TV®ue
 *
o
;

878 
	`lua_lock
(
L
);

879 
	`­i_checkÃËms
(
L
, 1);

880 
o
 = 
L
->
tİ
 - 1;

881 ià(
	`isLfunùiÚ
(
o
))

882 
¡©us
 = 
	`luaU_dump
(
L
, 
	`şv®ue
(
o
)->
l
.
p
, 
wr™”
, 
d©a
, 0);

884 
¡©us
 = 1;

885 
	`lua_uÆock
(
L
);

886  
¡©us
;

887 
	}
}

890 
LUA_API
 
	$lua_¡©us
 (
lua_S‹
 *
L
) {

891  
L
->
¡©us
;

892 
	}
}

899 
LUA_API
 
	$lua_gc
 (
lua_S‹
 *
L
, 
wh©
, 
d©a
) {

900 
»s
 = 0;

901 
glob®_S‹
 *
g
;

902 
	`lua_lock
(
L
);

903 
g
 = 
	`G
(
L
);

904 
wh©
) {

905 
LUA_GCSTOP
: {

906 
g
->
GCth»shŞd
 = 
MAX_LUMEM
;

909 
LUA_GCRESTART
: {

910 
g
->
GCth»shŞd
 = g->
tÙ®by‹s
;

913 
LUA_GCCOLLECT
: {

914 
	`luaC_fuÎgc
(
L
);

917 
LUA_GCCOUNT
: {

919 
»s
 = 
	`ÿ¡_št
(
g
->
tÙ®by‹s
 >> 10);

922 
LUA_GCCOUNTB
: {

923 
»s
 = 
	`ÿ¡_št
(
g
->
tÙ®by‹s
 & 0x3ff);

926 
LUA_GCSTEP
: {

927 
lu_mem
 
a
 = (
	`ÿ¡
Öu_mem, 
d©a
) << 10);

928 ià(
a
 <ğ
g
->
tÙ®by‹s
)

929 
g
->
GCth»shŞd
 = g->
tÙ®by‹s
 - 
a
;

931 
g
->
GCth»shŞd
 = 0;

932 
g
->
GCth»shŞd
 <ğg->
tÙ®by‹s
) {

933 
	`luaC_¡•
(
L
);

934 ià(
g
->
gc¡©e
 =ğ
GCS·u£
) {

935 
»s
 = 1;

941 
LUA_GCSETPAUSE
: {

942 
»s
 = 
g
->
gıau£
;

943 
g
->
gıau£
 = 
d©a
;

946 
LUA_GCSETSTEPMUL
: {

947 
»s
 = 
g
->
gc¡•mul
;

948 
g
->
gc¡•mul
 = 
d©a
;

951 : 
»s
 = -1;

953 
	`lua_uÆock
(
L
);

954  
»s
;

955 
	}
}

964 
LUA_API
 
	$lua_”rÜ
 (
lua_S‹
 *
L
) {

965 
	`lua_lock
(
L
);

966 
	`­i_checkÃËms
(
L
, 1);

967 
	`luaG_”rÜmsg
(
L
);

968 
	`lua_uÆock
(
L
);

970 
	}
}

973 
LUA_API
 
	$lua_Ãxt
 (
lua_S‹
 *
L
, 
idx
) {

974 
StkId
 
t
;

975 
mÜe
;

976 
	`lua_lock
(
L
);

977 
t
 = 
	`šdex2adr
(
L
, 
idx
);

978 
	`­i_check
(
L
, 
	`‰i¡abË
(
t
));

979 
mÜe
 = 
	`luaH_Ãxt
(
L
, 
	`hv®ue
(
t
), L->
tİ
 - 1);

980 ià(
mÜe
) {

981 
	`­i_šü_tİ
(
L
);

984 
L
->
tİ
 -= 1;

985 
	`lua_uÆock
(
L
);

986  
mÜe
;

987 
	}
}

990 
LUA_API
 
	$lua_cÚÿt
 (
lua_S‹
 *
L
, 
n
) {

991 
	`lua_lock
(
L
);

992 
	`­i_checkÃËms
(
L
, 
n
);

993 ià(
n
 >= 2) {

994 
	`luaC_checkGC
(
L
);

995 
	`luaV_cÚÿt
(
L
, 
n
, 
	`ÿ¡_št
(L->
tİ
 - L->
ba£
) - 1);

996 
L
->
tİ
 -ğ(
n
-1);

998 ià(
n
 == 0) {

999 
	`£tsv®ue2s
(
L
, L->
tİ
, 
	`luaS_Ãwl¡r
(L, "", 0));

1000 
	`­i_šü_tİ
(
L
);

1003 
	`lua_uÆock
(
L
);

1004 
	}
}

1007 
LUA_API
 
lua_AÎoc
 
	$lua_g‘®locf
 (
lua_S‹
 *
L
, **
ud
) {

1008 
lua_AÎoc
 
f
;

1009 
	`lua_lock
(
L
);

1010 ià(
ud
è*ud = 
	`G
(
L
)->ud;

1011 
f
 = 
	`G
(
L
)->
ä—Îoc
;

1012 
	`lua_uÆock
(
L
);

1013  
f
;

1014 
	}
}

1017 
LUA_API
 
	$lua_£Îocf
 (
lua_S‹
 *
L
, 
lua_AÎoc
 
f
, *
ud
) {

1018 
	`lua_lock
(
L
);

1019 
	`G
(
L
)->
ud
 = ud;

1020 
	`G
(
L
)->
ä—Îoc
 = 
f
;

1021 
	`lua_uÆock
(
L
);

1022 
	}
}

1025 
LUA_API
 *
	$lua_Ãwu£rd©a
 (
lua_S‹
 *
L
, 
size_t
 
size
) {

1026 
Ud©a
 *
u
;

1027 
	`lua_lock
(
L
);

1028 
	`luaC_checkGC
(
L
);

1029 
u
 = 
	`luaS_Ãwud©a
(
L
, 
size
, 
	`g‘cu¼’v
(L));

1030 
	`£tuv®ue
(
L
, L->
tİ
, 
u
);

1031 
	`­i_šü_tİ
(
L
);

1032 
	`lua_uÆock
(
L
);

1033  
u
 + 1;

1034 
	}
}

1039 cÚ¡ *
	$aux_upv®ue
 (
StkId
 
fi
, 
n
, 
TV®ue
 **
v®
) {

1040 
Closu»
 *
f
;

1041 ià(!
	`‰isfunùiÚ
(
fi
)è 
NULL
;

1042 
f
 = 
	`şv®ue
(
fi
);

1043 ià(
f
->
c
.
isC
) {

1044 ià(!(1 <ğ
n
 &&‚ <ğ
f
->
c
.
nupv®ues
)è 
NULL
;

1045 *
v®
 = &
f
->
c
.
upv®ue
[
n
-1];

1049 
PrÙo
 *
p
 = 
f
->
l
.p;

1050 ià(!(1 <ğ
n
 &&‚ <ğ
p
->
sizeupv®ues
)è 
NULL
;

1051 *
v®
 = 
f
->
l
.
upv®s
[
n
-1]->
v
;

1052  
	`g‘¡r
(
p
->
upv®ues
[
n
-1]);

1054 
	}
}

1057 
LUA_API
 cÚ¡ *
	$lua_g‘upv®ue
 (
lua_S‹
 *
L
, 
funcšdex
, 
n
) {

1058 cÚ¡ *
Çme
;

1059 
TV®ue
 *
v®
;

1060 
	`lua_lock
(
L
);

1061 
Çme
 = 
	`aux_upv®ue
(
	`šdex2adr
(
L
, 
funcšdex
), 
n
, &
v®
);

1062 ià(
Çme
) {

1063 
	`£tobj2s
(
L
, L->
tİ
, 
v®
);

1064 
	`­i_šü_tİ
(
L
);

1066 
	`lua_uÆock
(
L
);

1067  
Çme
;

1068 
	}
}

1071 
LUA_API
 cÚ¡ *
	$lua_£tupv®ue
 (
lua_S‹
 *
L
, 
funcšdex
, 
n
) {

1072 cÚ¡ *
Çme
;

1073 
TV®ue
 *
v®
;

1074 
StkId
 
fi
;

1075 
	`lua_lock
(
L
);

1076 
fi
 = 
	`šdex2adr
(
L
, 
funcšdex
);

1077 
	`­i_checkÃËms
(
L
, 1);

1078 
Çme
 = 
	`aux_upv®ue
(
fi
, 
n
, &
v®
);

1079 ià(
Çme
) {

1080 
L
->
tİ
--;

1081 
	`£tobj
(
L
, 
v®
, L->
tİ
);

1082 
	`luaC_b¬r›r
(
L
, 
	`şv®ue
(
fi
), L->
tİ
);

1084 
	`lua_uÆock
(
L
);

1085  
Çme
;

1086 
	}
}

	@deps/lua/src/lapi.h

7 #iâdeà
Ïpi_h


8 
	#Ïpi_h


	)

11 
	~"lobjeù.h
"

14 
LUAI_FUNC
 
luaA_pushobjeù
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
o
);

	@deps/lua/src/lauxlib.c

8 
	~<ùy³.h
>

9 
	~<”ºo.h
>

10 
	~<¡d¬g.h
>

11 
	~<¡dio.h
>

12 
	~<¡dlib.h
>

13 
	~<¡ršg.h
>

20 
	#Ïuxlib_c


	)

21 
	#LUA_LIB


	)

23 
	~"lua.h
"

25 
	~"Ïuxlib.h
"

28 
	#FREELIST_REF
 0

	)

32 
	#abs_šdex
(
L
, 
i
è((iè> 0 || (iè<ğ
LUA_REGISTRYINDEX
 ? (i) : \

33 
	`lua_g‘tİ
(
L
è+ (
i
è+ 1)

	)

43 
LUALIB_API
 
	$luaL_¬g”rÜ
 (
lua_S‹
 *
L
, 
Çrg
, cÚ¡ *
exŒamsg
) {

44 
lua_Debug
 
¬
;

45 ià(!
	`lua_g‘¡ack
(
L
, 0, &
¬
))

46  
	`luaL_”rÜ
(
L
, "bad‡rgum’ˆ#%d (%s)", 
Çrg
, 
exŒamsg
);

47 
	`lua_g‘šfo
(
L
, "n", &
¬
);

48 ià(
	`¡rcmp
(
¬
.
Çmewh©
, "method") == 0) {

49 
Çrg
--;

50 ià(
Çrg
 == 0)

51  
	`luaL_”rÜ
(
L
, "ÿÎšg " 
LUA_QS
 " on bad self (%s)",

52 
¬
.
Çme
, 
exŒamsg
);

54 ià(
¬
.
Çme
 =ğ
NULL
)

55 
¬
.
Çme
 = "?";

56  
	`luaL_”rÜ
(
L
, "bad‡rgum’ˆ#%dØ" 
LUA_QS
 " (%s)",

57 
Çrg
, 
¬
.
Çme
, 
exŒamsg
);

58 
	}
}

61 
LUALIB_API
 
	$luaL_ty³¼Ü
 (
lua_S‹
 *
L
, 
Çrg
, cÚ¡ *
Šame
) {

62 cÚ¡ *
msg
 = 
	`lua_pushf¡ršg
(
L
, "%sƒxpected, got %s",

63 
Šame
, 
	`luaL_ty³Çme
(
L
, 
Çrg
));

64  
	`luaL_¬g”rÜ
(
L
, 
Çrg
, 
msg
);

65 
	}
}

68 
	$g_”rÜ
 (
lua_S‹
 *
L
, 
Çrg
, 
g
) {

69 
	`luaL_ty³¼Ü
(
L
, 
Çrg
, 
	`lua_ty³Çme
(L, 
g
));

70 
	}
}

73 
LUALIB_API
 
	$luaL_wh”e
 (
lua_S‹
 *
L
, 
Ëv–
) {

74 
lua_Debug
 
¬
;

75 ià(
	`lua_g‘¡ack
(
L
, 
Ëv–
, &
¬
)) {

76 
	`lua_g‘šfo
(
L
, "Sl", &
¬
);

77 ià(
¬
.
cu¼’še
 > 0) {

78 
	`lua_pushf¡ršg
(
L
, "%s:%d: ", 
¬
.
shÜt_¤c
,‡r.
cu¼’še
);

82 
	`lua_pushl™”®
(
L
, "");

83 
	}
}

86 
LUALIB_API
 
	$luaL_”rÜ
 (
lua_S‹
 *
L
, cÚ¡ *
fmt
, ...) {

87 
va_li¡
 
¬gp
;

88 
	`va_¡¬t
(
¬gp
, 
fmt
);

89 
	`luaL_wh”e
(
L
, 1);

90 
	`lua_pushvf¡ršg
(
L
, 
fmt
, 
¬gp
);

91 
	`va_’d
(
¬gp
);

92 
	`lua_cÚÿt
(
L
, 2);

93  
	`lua_”rÜ
(
L
);

94 
	}
}

99 
LUALIB_API
 
	$luaL_checkİtiÚ
 (
lua_S‹
 *
L
, 
Çrg
, cÚ¡ *
def
,

100 cÚ¡ *cÚ¡ 
l¡
[]) {

101 cÚ¡ *
Çme
 = (
def
è? 
	`luaL_İt¡ršg
(
L
, 
Çrg
, def) :

102 
	`luaL_check¡ršg
(
L
, 
Çrg
);

103 
i
;

104 
i
=0; 
l¡
[i]; i++)

105 ià(
	`¡rcmp
(
l¡
[
i
], 
Çme
) == 0)

106  
i
;

107  
	`luaL_¬g”rÜ
(
L
, 
Çrg
,

108 
	`lua_pushf¡ršg
(
L
, "šv®id o±iÚ " 
LUA_QS
, 
Çme
));

109 
	}
}

112 
LUALIB_API
 
	$luaL_Ãwm‘©abË
 (
lua_S‹
 *
L
, cÚ¡ *
Šame
) {

113 
	`lua_g‘f›ld
(
L
, 
LUA_REGISTRYINDEX
, 
Šame
);

114 ià(!
	`lua_i¢
(
L
, -1))

116 
	`lua_pİ
(
L
, 1);

117 
	`lua_ÃwbË
(
L
);

118 
	`lua_pushv®ue
(
L
, -1);

119 
	`lua_£tf›ld
(
L
, 
LUA_REGISTRYINDEX
, 
Šame
);

121 
	}
}

124 
LUALIB_API
 *
	$luaL_checkud©a
 (
lua_S‹
 *
L
, 
ud
, cÚ¡ *
Šame
) {

125 *
p
 = 
	`lua_tou£rd©a
(
L
, 
ud
);

126 ià(
p
 !ğ
NULL
) {

127 ià(
	`lua_g‘m‘©abË
(
L
, 
ud
)) {

128 
	`lua_g‘f›ld
(
L
, 
LUA_REGISTRYINDEX
, 
Šame
);

129 ià(
	`lua_¿wequ®
(
L
, -1, -2)) {

130 
	`lua_pİ
(
L
, 2);

131  
p
;

135 
	`luaL_ty³¼Ü
(
L
, 
ud
, 
Šame
);

136  
NULL
;

137 
	}
}

140 
LUALIB_API
 
	$luaL_check¡ack
 (
lua_S‹
 *
L
, 
¥aû
, cÚ¡ *
mes
) {

141 ià(!
	`lua_check¡ack
(
L
, 
¥aû
))

142 
	`luaL_”rÜ
(
L
, "¡ack ov”æow (%s)", 
mes
);

143 
	}
}

146 
LUALIB_API
 
	$luaL_checkty³
 (
lua_S‹
 *
L
, 
Çrg
, 
t
) {

147 ià(
	`lua_ty³
(
L
, 
Çrg
è!ğ
t
)

148 
	`g_”rÜ
(
L
, 
Çrg
, 
t
);

149 
	}
}

152 
LUALIB_API
 
	$luaL_checkªy
 (
lua_S‹
 *
L
, 
Çrg
) {

153 ià(
	`lua_ty³
(
L
, 
Çrg
è=ğ
LUA_TNONE
)

154 
	`luaL_¬g”rÜ
(
L
, 
Çrg
, "valueƒxpected");

155 
	}
}

158 
LUALIB_API
 cÚ¡ *
	$luaL_checkl¡ršg
 (
lua_S‹
 *
L
, 
Çrg
, 
size_t
 *
Ën
) {

159 cÚ¡ *
s
 = 
	`lua_tŞ¡ršg
(
L
, 
Çrg
, 
Ën
);

160 ià(!
s
è
	`g_”rÜ
(
L
, 
Çrg
, 
LUA_TSTRING
);

161  
s
;

162 
	}
}

165 
LUALIB_API
 cÚ¡ *
	$luaL_İ¡ršg
 (
lua_S‹
 *
L
, 
Çrg
,

166 cÚ¡ *
def
, 
size_t
 *
Ën
) {

167 ià(
	`lua_i¢ÚeÜn
(
L
, 
Çrg
)) {

168 ià(
Ën
)

169 *
Ën
 = (
def
 ? 
	`¡¾’
(def) : 0);

170  
def
;

172  
	`luaL_checkl¡ršg
(
L
, 
Çrg
, 
Ën
);

173 
	}
}

176 
LUALIB_API
 
lua_Numb”
 
	$luaL_checknumb”
 (
lua_S‹
 *
L
, 
Çrg
) {

177 
lua_Numb”
 
d
 = 
	`lua_tÚumb”
(
L
, 
Çrg
);

178 ià(
d
 =ğ0 && !
	`lua_i¢umb”
(
L
, 
Çrg
))

179 
	`g_”rÜ
(
L
, 
Çrg
, 
LUA_TNUMBER
);

180  
d
;

181 
	}
}

184 
LUALIB_API
 
lua_Numb”
 
	$luaL_İŠumb”
 (
lua_S‹
 *
L
, 
Çrg
, 
lua_Numb”
 
def
) {

185  
	`luaL_İt
(
L
, 
luaL_checknumb”
, 
Çrg
, 
def
);

186 
	}
}

189 
LUALIB_API
 
lua_IÁeg”
 
	$luaL_checkš‹g”
 (
lua_S‹
 *
L
, 
Çrg
) {

190 
lua_IÁeg”
 
d
 = 
	`lua_toš‹g”
(
L
, 
Çrg
);

191 ià(
d
 =ğ0 && !
	`lua_i¢umb”
(
L
, 
Çrg
))

192 
	`g_”rÜ
(
L
, 
Çrg
, 
LUA_TNUMBER
);

193  
d
;

194 
	}
}

197 
LUALIB_API
 
lua_IÁeg”
 
	$luaL_İtš‹g”
 (
lua_S‹
 *
L
, 
Çrg
,

198 
lua_IÁeg”
 
def
) {

199  
	`luaL_İt
(
L
, 
luaL_checkš‹g”
, 
Çrg
, 
def
);

200 
	}
}

203 
LUALIB_API
 
	$luaL_g‘m‘af›ld
 (
lua_S‹
 *
L
, 
obj
, cÚ¡ *
ev’t
) {

204 ià(!
	`lua_g‘m‘©abË
(
L
, 
obj
))

206 
	`lua_push¡ršg
(
L
, 
ev’t
);

207 
	`lua_¿wg‘
(
L
, -2);

208 ià(
	`lua_i¢
(
L
, -1)) {

209 
	`lua_pİ
(
L
, 2);

213 
	`lua_»move
(
L
, -2);

216 
	}
}

219 
LUALIB_API
 
	$luaL_ÿÎm‘a
 (
lua_S‹
 *
L
, 
obj
, cÚ¡ *
ev’t
) {

220 
obj
 = 
	`abs_šdex
(
L
, obj);

221 ià(!
	`luaL_g‘m‘af›ld
(
L
, 
obj
, 
ev’t
))

223 
	`lua_pushv®ue
(
L
, 
obj
);

224 
	`lua_ÿÎ
(
L
, 1, 1);

226 
	}
}

229 
LUALIB_API
 (
luaL_»gi¡”
è(
lua_S‹
 *
L
, cÚ¡ *
libÇme
,

230 cÚ¡ 
luaL_Reg
 *
l
) {

231 
	`luaI_İ’lib
(
L
, 
libÇme
, 
l
, 0);

232 
	}
}

235 
	$libsize
 (cÚ¡ 
luaL_Reg
 *
l
) {

236 
size
 = 0;

237 ; 
l
->
Çme
;†++è
size
++;

238  
size
;

239 
	}
}

242 
LUALIB_API
 
	$luaI_İ’lib
 (
lua_S‹
 *
L
, cÚ¡ *
libÇme
,

243 cÚ¡ 
luaL_Reg
 *
l
, 
nup
) {

244 ià(
libÇme
) {

245 
size
 = 
	`libsize
(
l
);

247 
	`luaL_fšdbË
(
L
, 
LUA_REGISTRYINDEX
, "_LOADED", 1);

248 
	`lua_g‘f›ld
(
L
, -1, 
libÇme
);

249 ià(!
	`lua_i¡abË
(
L
, -1)) {

250 
	`lua_pİ
(
L
, 1);

252 ià(
	`luaL_fšdbË
(
L
, 
LUA_GLOBALSINDEX
, 
libÇme
, 
size
è!ğ
NULL
)

253 
	`luaL_”rÜ
(
L
, "ÇmcÚæiù fÜ moduË " 
LUA_QS
, 
libÇme
);

254 
	`lua_pushv®ue
(
L
, -1);

255 
	`lua_£tf›ld
(
L
, -3, 
libÇme
);

257 
	`lua_»move
(
L
, -2);

258 
	`lua_š£¹
(
L
, -(
nup
+1));

260 ; 
l
->
Çme
;†++) {

261 
i
;

262 
i
=0; i<
nup
; i++)

263 
	`lua_pushv®ue
(
L
, -
nup
);

264 
	`lua_pushcşosu»
(
L
, 
l
->
func
, 
nup
);

265 
	`lua_£tf›ld
(
L
, -(
nup
+2), 
l
->
Çme
);

267 
	`lua_pİ
(
L
, 
nup
);

268 
	}
}

278 #ià
defšed
(
LUA_COMPAT_GETN
)

280 
	$checkšt
 (
lua_S‹
 *
L
, 
tİİ
) {

281 
n
 = (
	`lua_ty³
(
L
, -1è=ğ
LUA_TNUMBER
è? 
	`lua_toš‹g”
(L, -1) : -1;

282 
	`lua_pİ
(
L
, 
tİİ
);

283  
n
;

284 
	}
}

287 
	$g‘sizes
 (
lua_S‹
 *
L
) {

288 
	`lua_g‘f›ld
(
L
, 
LUA_REGISTRYINDEX
, "LUA_SIZES");

289 ià(
	`lua_i¢
(
L
, -1)) {

290 
	`lua_pİ
(
L
, 1);

291 
	`lua_ÃwbË
(
L
);

292 
	`lua_pushv®ue
(
L
, -1);

293 
	`lua_£tm‘©abË
(
L
, -2);

294 
	`lua_pushl™”®
(
L
, "kv");

295 
	`lua_£tf›ld
(
L
, -2, "__mode");

296 
	`lua_pushv®ue
(
L
, -1);

297 
	`lua_£tf›ld
(
L
, 
LUA_REGISTRYINDEX
, "LUA_SIZES");

299 
	}
}

302 
LUALIB_API
 
	$luaL_£Š
 (
lua_S‹
 *
L
, 
t
, 
n
) {

303 
t
 = 
	`abs_šdex
(
L
,);

304 
	`lua_pushl™”®
(
L
, "n");

305 
	`lua_¿wg‘
(
L
, 
t
);

306 ià(
	`checkšt
(
L
, 1) >= 0) {

307 
	`lua_pushl™”®
(
L
, "n");

308 
	`lua_pushš‹g”
(
L
, 
n
);

309 
	`lua_¿w£t
(
L
, 
t
);

312 
	`g‘sizes
(
L
);

313 
	`lua_pushv®ue
(
L
, 
t
);

314 
	`lua_pushš‹g”
(
L
, 
n
);

315 
	`lua_¿w£t
(
L
, -3);

316 
	`lua_pİ
(
L
, 1);

318 
	}
}

321 
LUALIB_API
 
	$luaL_g‘n
 (
lua_S‹
 *
L
, 
t
) {

322 
n
;

323 
t
 = 
	`abs_šdex
(
L
,);

324 
	`lua_pushl™”®
(
L
, "n");

325 
	`lua_¿wg‘
(
L
, 
t
);

326 ià((
n
 = 
	`checkšt
(
L
, 1)) >= 0) ‚;

327 
	`g‘sizes
(
L
);

328 
	`lua_pushv®ue
(
L
, 
t
);

329 
	`lua_¿wg‘
(
L
, -2);

330 ià((
n
 = 
	`checkšt
(
L
, 2)) >= 0) ‚;

331  ()
	`lua_objËn
(
L
, 
t
);

332 
	}
}

340 
LUALIB_API
 cÚ¡ *
	$luaL_gsub
 (
lua_S‹
 *
L
, cÚ¡ *
s
, cÚ¡ *
p
,

341 cÚ¡ *
r
) {

342 cÚ¡ *
wd
;

343 
size_t
 
l
 = 
	`¡¾’
(
p
);

344 
luaL_Bufãr
 
b
;

345 
	`luaL_buffš™
(
L
, &
b
);

346 (
wd
 = 
	`¡r¡r
(
s
, 
p
)è!ğ
NULL
) {

347 
	`luaL_addl¡ršg
(&
b
, 
s
, 
wd
 - s);

348 
	`luaL_add¡ršg
(&
b
, 
r
);

349 
s
 = 
wd
 + 
l
;

351 
	`luaL_add¡ršg
(&
b
, 
s
);

352 
	`luaL_push»suÉ
(&
b
);

353  
	`lua_to¡ršg
(
L
, -1);

354 
	}
}

357 
LUALIB_API
 cÚ¡ *
	$luaL_fšdbË
 (
lua_S‹
 *
L
, 
idx
,

358 cÚ¡ *
âame
, 
szhšt
) {

359 cÚ¡ *
e
;

360 
	`lua_pushv®ue
(
L
, 
idx
);

362 
e
 = 
	`¡rchr
(
âame
, '.');

363 ià(
e
 =ğ
NULL
èğ
âame
 + 
	`¡¾’
(fname);

364 
	`lua_pushl¡ršg
(
L
, 
âame
, 
e
 - fname);

365 
	`lua_¿wg‘
(
L
, -2);

366 ià(
	`lua_i¢
(
L
, -1)) {

367 
	`lua_pİ
(
L
, 1);

368 
	`lua_ü—‹bË
(
L
, 0, (*
e
 =ğ'.' ? 1 : 
szhšt
));

369 
	`lua_pushl¡ršg
(
L
, 
âame
, 
e
 - fname);

370 
	`lua_pushv®ue
(
L
, -2);

371 
	`lua_£‰abË
(
L
, -4);

373 ià(!
	`lua_i¡abË
(
L
, -1)) {

374 
	`lua_pİ
(
L
, 2);

375  
âame
;

377 
	`lua_»move
(
L
, -2);

378 
âame
 = 
e
 + 1;

379 } *
e
 == '.');

380  
NULL
;

381 
	}
}

392 
	#bufæ’
(
B
è((B)->
p
 - (B)->
bufãr
)

	)

393 
	#buffä“
(
B
è((
size_t
)(
LUAL_BUFFERSIZE
 - 
	`bufæ’
(B)))

	)

395 
	#LIMIT
 (
LUA_MINSTACK
/2)

	)

398 
	$em±ybufãr
 (
luaL_Bufãr
 *
B
) {

399 
size_t
 
l
 = 
	`bufæ’
(
B
);

400 ià(
l
 == 0)  0;

402 
	`lua_pushl¡ršg
(
B
->
L
, B->
bufãr
, 
l
);

403 
B
->
p
 = B->
bufãr
;

404 
B
->
lvl
++;

407 
	}
}

410 
	$adju¡¡ack
 (
luaL_Bufãr
 *
B
) {

411 ià(
B
->
lvl
 > 1) {

412 
lua_S‹
 *
L
 = 
B
->L;

413 
tog‘
 = 1;

414 
size_t
 
tİËn
 = 
	`lua_¡¾’
(
L
, -1);

416 
size_t
 
l
 = 
	`lua_¡¾’
(
L
, -(
tog‘
+1));

417 ià(
B
->
lvl
 - 
tog‘
 + 1 >ğ
LIMIT
 || 
tİËn
 > 
l
) {

418 
tİËn
 +ğ
l
;

419 
tog‘
++;

422 } 
tog‘
 < 
B
->
lvl
);

423 
	`lua_cÚÿt
(
L
, 
tog‘
);

424 
B
->
lvl
 = B->lvÈ- 
tog‘
 + 1;

426 
	}
}

429 
LUALIB_API
 *
	$luaL_´•bufãr
 (
luaL_Bufãr
 *
B
) {

430 ià(
	`em±ybufãr
(
B
))

431 
	`adju¡¡ack
(
B
);

432  
B
->
bufãr
;

433 
	}
}

436 
LUALIB_API
 
	$luaL_addl¡ršg
 (
luaL_Bufãr
 *
B
, cÚ¡ *
s
, 
size_t
 
l
) {

437 
l
--)

438 
	`luaL_addch¬
(
B
, *
s
++);

439 
	}
}

442 
LUALIB_API
 
	$luaL_add¡ršg
 (
luaL_Bufãr
 *
B
, cÚ¡ *
s
) {

443 
	`luaL_addl¡ršg
(
B
, 
s
, 
	`¡¾’
(s));

444 
	}
}

447 
LUALIB_API
 
	$luaL_push»suÉ
 (
luaL_Bufãr
 *
B
) {

448 
	`em±ybufãr
(
B
);

449 
	`lua_cÚÿt
(
B
->
L
, B->
lvl
);

450 
B
->
lvl
 = 1;

451 
	}
}

454 
LUALIB_API
 
	$luaL_addv®ue
 (
luaL_Bufãr
 *
B
) {

455 
lua_S‹
 *
L
 = 
B
->L;

456 
size_t
 
vl
;

457 cÚ¡ *
s
 = 
	`lua_tŞ¡ršg
(
L
, -1, &
vl
);

458 ià(
vl
 <ğ
	`buffä“
(
B
)) {

459 
	`memıy
(
B
->
p
, 
s
, 
vl
);

460 
B
->
p
 +ğ
vl
;

461 
	`lua_pİ
(
L
, 1);

464 ià(
	`em±ybufãr
(
B
))

465 
	`lua_š£¹
(
L
, -2);

466 
B
->
lvl
++;

467 
	`adju¡¡ack
(
B
);

469 
	}
}

472 
LUALIB_API
 
	$luaL_buffš™
 (
lua_S‹
 *
L
, 
luaL_Bufãr
 *
B
) {

473 
B
->
L
 = L;

474 
B
->
p
 = B->
bufãr
;

475 
B
->
lvl
 = 0;

476 
	}
}

481 
LUALIB_API
 
	$luaL_»f
 (
lua_S‹
 *
L
, 
t
) {

482 
»f
;

483 
t
 = 
	`abs_šdex
(
L
,);

484 ià(
	`lua_i¢
(
L
, -1)) {

485 
	`lua_pİ
(
L
, 1);

486  
LUA_REFNIL
;

488 
	`lua_¿wg‘i
(
L
, 
t
, 
FREELIST_REF
);

489 
»f
 = ()
	`lua_toš‹g”
(
L
, -1);

490 
	`lua_pİ
(
L
, 1);

491 ià(
»f
 != 0) {

492 
	`lua_¿wg‘i
(
L
, 
t
, 
»f
);

493 
	`lua_¿w£ti
(
L
, 
t
, 
FREELIST_REF
);

496 
»f
 = ()
	`lua_objËn
(
L
, 
t
);

497 
»f
++;

499 
	`lua_¿w£ti
(
L
, 
t
, 
»f
);

500  
»f
;

501 
	}
}

504 
LUALIB_API
 
	$luaL_uÄef
 (
lua_S‹
 *
L
, 
t
, 
»f
) {

505 ià(
»f
 >= 0) {

506 
t
 = 
	`abs_šdex
(
L
,);

507 
	`lua_¿wg‘i
(
L
, 
t
, 
FREELIST_REF
);

508 
	`lua_¿w£ti
(
L
, 
t
, 
»f
);

509 
	`lua_pushš‹g”
(
L
, 
»f
);

510 
	`lua_¿w£ti
(
L
, 
t
, 
FREELIST_REF
);

512 
	}
}

522 
	sLßdF
 {

523 
	mexŒ®še
;

524 
FILE
 *
	mf
;

525 
	mbuff
[
LUAL_BUFFERSIZE
];

526 } 
	tLßdF
;

529 cÚ¡ *
	$g‘F
 (
lua_S‹
 *
L
, *
ud
, 
size_t
 *
size
) {

530 
LßdF
 *
lf
 = (LßdF *)
ud
;

531 ()
L
;

532 ià(
lf
->
exŒ®še
) {

533 
lf
->
exŒ®še
 = 0;

534 *
size
 = 1;

537 ià(
	`ãof
(
lf
->
f
)è 
NULL
;

538 *
size
 = 
	`ä—d
(
lf
->
buff
, 1, Öf->buff),†f->
f
);

539  (*
size
 > 0è? 
lf
->
buff
 : 
NULL
;

540 
	}
}

543 
	$”rfe
 (
lua_S‹
 *
L
, cÚ¡ *
wh©
, 
âamešdex
) {

544 cÚ¡ *
£¼
 = 
	`¡»¼Ü
(
”ºo
);

545 cÚ¡ *
f’ame
 = 
	`lua_to¡ršg
(
L
, 
âamešdex
) + 1;

546 
	`lua_pushf¡ršg
(
L
, "ÿÂÙ % %s: %s", 
wh©
, 
f’ame
, 
£¼
);

547 
	`lua_»move
(
L
, 
âamešdex
);

548  
LUA_ERRFILE
;

549 
	}
}

552 
LUALIB_API
 
	$luaL_lßdfe
 (
lua_S‹
 *
L
, cÚ¡ *
f’ame
) {

553 
LßdF
 
lf
;

554 
¡©us
, 
»ad¡©us
;

555 
c
;

556 
âamešdex
 = 
	`lua_g‘tİ
(
L
) + 1;

557 
lf
.
exŒ®še
 = 0;

558 ià(
f’ame
 =ğ
NULL
) {

559 
	`lua_pushl™”®
(
L
, "=stdin");

560 
lf
.
f
 = 
¡dš
;

563 
	`lua_pushf¡ršg
(
L
, "@%s", 
f’ame
);

564 
lf
.
f
 = 
	`fİ’
(
f’ame
, "r");

565 ià(
lf
.
f
 =ğ
NULL
è 
	`”rfe
(
L
, "İ’", 
âamešdex
);

567 
c
 = 
	`g‘c
(
lf
.
f
);

568 ià(
c
 == '#') {

569 
lf
.
exŒ®še
 = 1;

570 (
c
 = 
	`g‘c
(
lf
.
f
)è!ğ
EOF
 && c != '\n') ;

571 ià(
c
 =ğ'\n'èøğ
	`g‘c
(
lf
.
f
);

573 ià(
c
 =ğ
LUA_SIGNATURE
[0] && 
f’ame
) {

574 
lf
.
f
 = 
	`äeİ’
(
f’ame
, "rb",†f.f);

575 ià(
lf
.
f
 =ğ
NULL
è 
	`”rfe
(
L
, "»İ’", 
âamešdex
);

577 (
c
 = 
	`g‘c
(
lf
.
f
)è!ğ
EOF
 && c !ğ
LUA_SIGNATURE
[0]) ;

578 
lf
.
exŒ®še
 = 0;

580 
	`ung‘c
(
c
, 
lf
.
f
);

581 
¡©us
 = 
	`lua_lßd
(
L
, 
g‘F
, &
lf
, 
	`lua_to¡ršg
(L, -1));

582 
»ad¡©us
 = 
	`ã¼Ü
(
lf
.
f
);

583 ià(
f’ame
è
	`fşo£
(
lf
.
f
);

584 ià(
»ad¡©us
) {

585 
	`lua_£‰İ
(
L
, 
âamešdex
);

586  
	`”rfe
(
L
, "»ad", 
âamešdex
);

588 
	`lua_»move
(
L
, 
âamešdex
);

589  
¡©us
;

590 
	}
}

593 
	sLßdS
 {

594 cÚ¡ *
	ms
;

595 
size_t
 
	msize
;

596 } 
	tLßdS
;

599 cÚ¡ *
	$g‘S
 (
lua_S‹
 *
L
, *
ud
, 
size_t
 *
size
) {

600 
LßdS
 *
ls
 = (LßdS *)
ud
;

601 ()
L
;

602 ià(
ls
->
size
 =ğ0è 
NULL
;

603 *
size
 = 
ls
->size;

604 
ls
->
size
 = 0;

605  
ls
->
s
;

606 
	}
}

609 
LUALIB_API
 
	$luaL_lßdbufãr
 (
lua_S‹
 *
L
, cÚ¡ *
buff
, 
size_t
 
size
,

610 cÚ¡ *
Çme
) {

611 
LßdS
 
ls
;

612 
ls
.
s
 = 
buff
;

613 
ls
.
size
 = size;

614  
	`lua_lßd
(
L
, 
g‘S
, &
ls
, 
Çme
);

615 
	}
}

618 
LUALIB_API
 (
luaL_lßd¡ršg
è(
lua_S‹
 *
L
, cÚ¡ *
s
) {

619  
	`luaL_lßdbufãr
(
L
, 
s
, 
	`¡¾’
(s), s);

620 
	}
}

627 *
	$l_®loc
 (*
ud
, *
±r
, 
size_t
 
osize
, size_ˆ
nsize
) {

628 ()
ud
;

629 ()
osize
;

630 ià(
nsize
 == 0) {

631 
	`ä“
(
±r
);

632  
NULL
;

635  
	`»®loc
(
±r
, 
nsize
);

636 
	}
}

639 
	$·nic
 (
lua_S‹
 *
L
) {

640 ()
L
;

641 
	`årštf
(
¡d”r
, "PANIC: unprotectedƒrror in callo Lua API (%s)\n",

642 
	`lua_to¡ršg
(
L
, -1));

644 
	}
}

647 
LUALIB_API
 
lua_S‹
 *
	$luaL_Ãw¡©e
 () {

648 
lua_S‹
 *
L
 = 
	`lua_Ãw¡©e
(
l_®loc
, 
NULL
);

649 ià(
L
è
	`lua_©·nic
(L, &
·nic
);

650  
L
;

651 
	}
}

	@deps/lua/src/lauxlib.h

8 #iâdeà
Ïuxlib_h


9 
	#Ïuxlib_h


	)

12 
	~<¡ddef.h
>

13 
	~<¡dio.h
>

15 
	~"lua.h
"

18 #ià
defšed
(
LUA_COMPAT_GETN
)

19 
LUALIB_API
 (
luaL_g‘n
è(
lua_S‹
 *
L
, 
t
);

20 
LUALIB_API
 (
luaL_£Š
è(
lua_S‹
 *
L
, 
t
, 
n
);

22 
	#luaL_g‘n
(
L
,
i
è(()
	`lua_objËn
(L, i))

	)

23 
	#luaL_£Š
(
L
,
i
,
j
è(()0è

	)

26 #ià
	`defšed
(
LUA_COMPAT_OPENLIB
)

27 
	#luaI_İ’lib
 
luaL_İ’lib


	)

32 
	#LUA_ERRFILE
 (
LUA_ERRERR
+1)

	)

35 
	sluaL_Reg
 {

36 cÚ¡ *
Çme
;

37 
lua_CFunùiÚ
 
func
;

38 } 
	tluaL_Reg
;

42 
LUALIB_API
 (
luaI_İ’lib
è(
lua_S‹
 *
L
, cÚ¡ *
libÇme
,

43 cÚ¡ 
luaL_Reg
 *
l
, 
nup
);

44 
LUALIB_API
 (
luaL_»gi¡”
è(
lua_S‹
 *
L
, cÚ¡ *
libÇme
,

45 cÚ¡ 
luaL_Reg
 *
l
);

46 
LUALIB_API
 (
luaL_g‘m‘af›ld
è(
lua_S‹
 *
L
, 
obj
, cÚ¡ *
e
);

47 
LUALIB_API
 (
luaL_ÿÎm‘a
è(
lua_S‹
 *
L
, 
obj
, cÚ¡ *
e
);

48 
LUALIB_API
 (
luaL_ty³¼Ü
è(
lua_S‹
 *
L
, 
Çrg
, cÚ¡ *
Šame
);

49 
LUALIB_API
 (
luaL_¬g”rÜ
è(
lua_S‹
 *
L
, 
num¬g
, cÚ¡ *
exŒamsg
);

50 
LUALIB_API
 cÚ¡ *(
luaL_checkl¡ršg
è(
lua_S‹
 *
L
, 
numArg
,

51 
size_t
 *
l
);

52 
LUALIB_API
 cÚ¡ *(
luaL_İ¡ršg
è(
lua_S‹
 *
L
, 
numArg
,

53 cÚ¡ *
def
, 
size_t
 *
l
);

54 
LUALIB_API
 
	$lua_Numb”
 (
luaL_checknumb”
è(
lua_S‹
 *
L
, 
numArg
);

55 
LUALIB_API
 
	$lua_Numb”
 (
luaL_İŠumb”
è(
lua_S‹
 *
L
, 
nArg
, 
lua_Numb”
 
def
);

57 
LUALIB_API
 
	$lua_IÁeg”
 (
luaL_checkš‹g”
è(
lua_S‹
 *
L
, 
numArg
);

58 
LUALIB_API
 
	$lua_IÁeg”
 (
luaL_İtš‹g”
è(
lua_S‹
 *
L
, 
nArg
,

59 
lua_IÁeg”
 
def
);

61 
LUALIB_API
 (
luaL_check¡ack
è(
lua_S‹
 *
L
, 
sz
, cÚ¡ *
msg
);

62 
LUALIB_API
 (
luaL_checkty³
è(
lua_S‹
 *
L
, 
Çrg
, 
t
);

63 
LUALIB_API
 (
luaL_checkªy
è(
lua_S‹
 *
L
, 
Çrg
);

65 
LUALIB_API
 (
luaL_Ãwm‘©abË
è(
lua_S‹
 *
L
, cÚ¡ *
Šame
);

66 
LUALIB_API
 *(
luaL_checkud©a
è(
lua_S‹
 *
L
, 
ud
, cÚ¡ *
Šame
);

68 
LUALIB_API
 (
luaL_wh”e
è(
lua_S‹
 *
L
, 
lvl
);

69 
LUALIB_API
 (
luaL_”rÜ
è(
lua_S‹
 *
L
, cÚ¡ *
fmt
, ...);

71 
LUALIB_API
 (
luaL_checkİtiÚ
è(
lua_S‹
 *
L
, 
Çrg
, cÚ¡ *
def
,

72 cÚ¡ *cÚ¡ 
l¡
[]);

74 
LUALIB_API
 (
luaL_»f
è(
lua_S‹
 *
L
, 
t
);

75 
LUALIB_API
 (
luaL_uÄef
è(
lua_S‹
 *
L
, 
t
, 
»f
);

77 
LUALIB_API
 (
luaL_lßdfe
è(
lua_S‹
 *
L
, cÚ¡ *
f’ame
);

78 
LUALIB_API
 (
luaL_lßdbufãr
è(
lua_S‹
 *
L
, cÚ¡ *
buff
, 
size_t
 
sz
,

79 cÚ¡ *
Çme
);

80 
LUALIB_API
 (
luaL_lßd¡ršg
è(
lua_S‹
 *
L
, cÚ¡ *
s
);

82 
LUALIB_API
 
lua_S‹
 *(
luaL_Ãw¡©e
) ();

85 
LUALIB_API
 cÚ¡ *(
luaL_gsub
è(
lua_S‹
 *
L
, cÚ¡ *
s
, cÚ¡ *
p
,

86 cÚ¡ *
r
);

88 
LUALIB_API
 cÚ¡ *(
luaL_fšdbË
è(
lua_S‹
 *
L
, 
idx
,

89 cÚ¡ *
âame
, 
szhšt
);

100 
	#luaL_¬gcheck
(
L
, 
cÚd
,
num¬g
,
exŒamsg
) \

101 (()((
cÚd
è|| 
	`luaL_¬g”rÜ
(
L
, (
num¬g
), (
exŒamsg
))))

	)

102 
	#luaL_check¡ršg
(
L
,
n
è(
	`luaL_checkl¡ršg
(L, (n), 
NULL
))

	)

103 
	#luaL_İt¡ršg
(
L
,
n
,
d
è(
	`luaL_İ¡ršg
(L, (n), (d), 
NULL
))

	)

104 
	#luaL_checkšt
(
L
,
n
è(()
	`luaL_checkš‹g”
(L, (n)))

	)

105 
	#luaL_İtšt
(
L
,
n
,
d
è(()
	`luaL_İtš‹g”
(L, (n), (d)))

	)

106 
	#luaL_checklÚg
(
L
,
n
è(()
	`luaL_checkš‹g”
(L, (n)))

	)

107 
	#luaL_İÚg
(
L
,
n
,
d
è(()
	`luaL_İtš‹g”
(L, (n), (d)))

	)

109 
	#luaL_ty³Çme
(
L
,
i
è
	`lua_ty³Çme
(L, 
	`lua_ty³
(L,(i)))

	)

111 
	#luaL_dofe
(
L
, 
â
) \

112 (
	`luaL_lßdfe
(
L
, 
â
è|| 
	`lua_pÿÎ
(L, 0, 
LUA_MULTRET
, 0))

	)

114 
	#luaL_do¡ršg
(
L
, 
s
) \

115 (
	`luaL_lßd¡ršg
(
L
, 
s
è|| 
	`lua_pÿÎ
(L, 0, 
LUA_MULTRET
, 0))

	)

117 
	#luaL_g‘m‘©abË
(
L
,
n
è(
	`lua_g‘f›ld
(L, 
LUA_REGISTRYINDEX
, (n)))

	)

119 
	#luaL_İt
(
L
,
f
,
n
,
d
è(
	`lua_i¢ÚeÜn
(L,Ò)è? (dè: 
	`f
(L,Ò)))

	)

129 
	sluaL_Bufãr
 {

130 *
p
;

131 
lvl
;

132 
lua_S‹
 *
L
;

133 
bufãr
[
LUAL_BUFFERSIZE
];

134 } 
	tluaL_Bufãr
;

136 
	#luaL_addch¬
(
B
,
c
) \

137 (()((
B
)->
p
 < ((B)->
bufãr
+
LUAL_BUFFERSIZE
è|| 
	`luaL_´•bufãr
(B)), \

138 (*(
B
)->
p
++ = ()(
c
)))

	)

141 
	#luaL_putch¬
(
B
,
c
è
	`luaL_addch¬
(B,c)

	)

143 
	#luaL_addsize
(
B
,
n
è((B)->
p
 +ğÒ))

	)

145 
LUALIB_API
 (
luaL_buffš™
è(
lua_S‹
 *
L
, 
luaL_Bufãr
 *
B
);

146 
LUALIB_API
 *(
luaL_´•bufãr
è(
luaL_Bufãr
 *
B
);

147 
LUALIB_API
 (
luaL_addl¡ršg
è(
luaL_Bufãr
 *
B
, cÚ¡ *
s
, 
size_t
 
l
);

148 
LUALIB_API
 (
luaL_add¡ršg
è(
luaL_Bufãr
 *
B
, cÚ¡ *
s
);

149 
LUALIB_API
 (
luaL_addv®ue
è(
luaL_Bufãr
 *
B
);

150 
LUALIB_API
 (
luaL_push»suÉ
è(
luaL_Bufãr
 *
B
);

159 
	#LUA_NOREF
 (-2)

	)

160 
	#LUA_REFNIL
 (-1)

	)

162 
	#lua_»f
(
L
,
lock
è(Öockè? 
	`luaL_»f
(L, 
LUA_REGISTRYINDEX
) : \

163 (
	`lua_push¡ršg
(
L
, "uÆocked„eã»nû ¬obsŞ‘e"), 
	`lua_”rÜ
(L), 0))

	)

165 
	#lua_uÄef
(
L
,
»f
è
	`luaL_uÄef
(L, 
LUA_REGISTRYINDEX
, (»f))

	)

167 
	#lua_g‘»f
(
L
,
»f
è
	`lua_¿wg‘i
(L, 
LUA_REGISTRYINDEX
, (»f))

	)

170 
	#luaL_»g
 
luaL_Reg


	)

	@deps/lua/src/lbaselib.c

9 
	~<ùy³.h
>

10 
	~<¡dio.h
>

11 
	~<¡dlib.h
>

12 
	~<¡ršg.h
>

14 
	#lba£lib_c


	)

15 
	#LUA_LIB


	)

17 
	~"lua.h
"

19 
	~"Ïuxlib.h
"

20 
	~"lu®ib.h
"

31 
	$luaB_´št
 (
lua_S‹
 *
L
) {

32 
n
 = 
	`lua_g‘tİ
(
L
);

33 
i
;

34 
	`lua_g‘glob®
(
L
, "tostring");

35 
i
=1; i<=
n
; i++) {

36 cÚ¡ *
s
;

37 
	`lua_pushv®ue
(
L
, -1);

38 
	`lua_pushv®ue
(
L
, 
i
);

39 
	`lua_ÿÎ
(
L
, 1, 1);

40 
s
 = 
	`lua_to¡ršg
(
L
, -1);

41 ià(
s
 =ğ
NULL
)

42  
	`luaL_”rÜ
(
L
, 
	`LUA_QL
("tostring") " must„eturn‡ stringo "

43 
	`LUA_QL
("print"));

44 ià(
i
>1è
	`åuts
("\t", 
¡dout
);

45 
	`åuts
(
s
, 
¡dout
);

46 
	`lua_pİ
(
L
, 1);

48 
	`åuts
("\n", 
¡dout
);

50 
	}
}

53 
	$luaB_tÚumb”
 (
lua_S‹
 *
L
) {

54 
ba£
 = 
	`luaL_İtšt
(
L
, 2, 10);

55 ià(
ba£
 == 10) {

56 
	`luaL_checkªy
(
L
, 1);

57 ià(
	`lua_i¢umb”
(
L
, 1)) {

58 
	`lua_pushnumb”
(
L
, 
	`lua_tÚumb”
(L, 1));

63 cÚ¡ *
s1
 = 
	`luaL_check¡ršg
(
L
, 1);

64 *
s2
;

65 
n
;

66 
	`luaL_¬gcheck
(
L
, 2 <ğ
ba£
 && base <= 36, 2, "base out of„ange");

67 
n
 = 
	`¡¹oul
(
s1
, &
s2
, 
ba£
);

68 ià(
s1
 !ğ
s2
) {

69 
	`is¥aû
(()(*
s2
))) s2++;

70 ià(*
s2
 == '\0') {

71 
	`lua_pushnumb”
(
L
, (
lua_Numb”
)
n
);

76 
	`lua_pushn
(
L
);

78 
	}
}

81 
	$luaB_”rÜ
 (
lua_S‹
 *
L
) {

82 
Ëv–
 = 
	`luaL_İtšt
(
L
, 2, 1);

83 
	`lua_£‰İ
(
L
, 1);

84 ià(
	`lua_is¡ršg
(
L
, 1è&& 
Ëv–
 > 0) {

85 
	`luaL_wh”e
(
L
, 
Ëv–
);

86 
	`lua_pushv®ue
(
L
, 1);

87 
	`lua_cÚÿt
(
L
, 2);

89  
	`lua_”rÜ
(
L
);

90 
	}
}

93 
	$luaB_g‘m‘©abË
 (
lua_S‹
 *
L
) {

94 
	`luaL_checkªy
(
L
, 1);

95 ià(!
	`lua_g‘m‘©abË
(
L
, 1)) {

96 
	`lua_pushn
(
L
);

99 
	`luaL_g‘m‘af›ld
(
L
, 1, "__metatable");

101 
	}
}

104 
	$luaB_£tm‘©abË
 (
lua_S‹
 *
L
) {

105 
t
 = 
	`lua_ty³
(
L
, 2);

106 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

107 
	`luaL_¬gcheck
(
L
, 
t
 =ğ
LUA_TNIL
 || =ğ
LUA_TTABLE
, 2,

109 ià(
	`luaL_g‘m‘af›ld
(
L
, 1, "__metatable"))

110 
	`luaL_”rÜ
(
L
, "cannot change‡…rotected metatable");

111 
	`lua_£‰İ
(
L
, 2);

112 
	`lua_£tm‘©abË
(
L
, 1);

114 
	}
}

117 
	$g‘func
 (
lua_S‹
 *
L
, 
İt
) {

118 ià(
	`lua_isfunùiÚ
(
L
, 1)è
	`lua_pushv®ue
(L, 1);

120 
lua_Debug
 
¬
;

121 
Ëv–
 = 
İt
 ? 
	`luaL_İtšt
(
L
, 1, 1è: 
	`luaL_checkšt
(L, 1);

122 
	`luaL_¬gcheck
(
L
, 
Ëv–
 >= 0, 1, "level must be‚on-negative");

123 ià(
	`lua_g‘¡ack
(
L
, 
Ëv–
, &
¬
) == 0)

124 
	`luaL_¬g”rÜ
(
L
, 1, "invalid†evel");

125 
	`lua_g‘šfo
(
L
, "f", &
¬
);

126 ià(
	`lua_i¢
(
L
, -1))

127 
	`luaL_”rÜ
(
L
, "no functionƒnvironment forail call‡t†evel %d",

128 
Ëv–
);

130 
	}
}

133 
	$luaB_g‘ãnv
 (
lua_S‹
 *
L
) {

134 
	`g‘func
(
L
, 1);

135 ià(
	`lua_iscfunùiÚ
(
L
, -1))

136 
	`lua_pushv®ue
(
L
, 
LUA_GLOBALSINDEX
);

138 
	`lua_g‘ãnv
(
L
, -1);

140 
	}
}

143 
	$luaB_£tãnv
 (
lua_S‹
 *
L
) {

144 
	`luaL_checkty³
(
L
, 2, 
LUA_TTABLE
);

145 
	`g‘func
(
L
, 0);

146 
	`lua_pushv®ue
(
L
, 2);

147 ià(
	`lua_i¢umb”
(
L
, 1è&& 
	`lua_tÚumb”
(L, 1) == 0) {

149 
	`lua_pushth»ad
(
L
);

150 
	`lua_š£¹
(
L
, -2);

151 
	`lua_£tãnv
(
L
, -2);

154 ià(
	`lua_iscfunùiÚ
(
L
, -2è|| 
	`lua_£tãnv
(L, -2) == 0)

155 
	`luaL_”rÜ
(
L
,

156 
	`LUA_QL
("setfenv") " cannot changeƒnvironment of given object");

158 
	}
}

161 
	$luaB_¿wequ®
 (
lua_S‹
 *
L
) {

162 
	`luaL_checkªy
(
L
, 1);

163 
	`luaL_checkªy
(
L
, 2);

164 
	`lua_pushboŞ—n
(
L
, 
	`lua_¿wequ®
(L, 1, 2));

166 
	}
}

169 
	$luaB_¿wg‘
 (
lua_S‹
 *
L
) {

170 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

171 
	`luaL_checkªy
(
L
, 2);

172 
	`lua_£‰İ
(
L
, 2);

173 
	`lua_¿wg‘
(
L
, 1);

175 
	}
}

177 
	$luaB_¿w£t
 (
lua_S‹
 *
L
) {

178 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

179 
	`luaL_checkªy
(
L
, 2);

180 
	`luaL_checkªy
(
L
, 3);

181 
	`lua_£‰İ
(
L
, 3);

182 
	`lua_¿w£t
(
L
, 1);

184 
	}
}

187 
	$luaB_gcšfo
 (
lua_S‹
 *
L
) {

188 
	`lua_pushš‹g”
(
L
, 
	`lua_g‘gccouÁ
(L));

190 
	}
}

193 
	$luaB_cŞËùg¬bage
 (
lua_S‹
 *
L
) {

194 cÚ¡ *cÚ¡ 
İts
[] = {"stop", "restart", "collect",

195 "couÁ", "¡•", "£au£", "£t¡•mul", 
NULL
};

196 cÚ¡ 
İt¢um
[] = {
LUA_GCSTOP
, 
LUA_GCRESTART
, 
LUA_GCCOLLECT
,

197 
LUA_GCCOUNT
, 
LUA_GCSTEP
, 
LUA_GCSETPAUSE
, 
LUA_GCSETSTEPMUL
};

198 
o
 = 
	`luaL_checkİtiÚ
(
L
, 1, "cŞËù", 
İts
);

199 
ex
 = 
	`luaL_İtšt
(
L
, 2, 0);

200 
»s
 = 
	`lua_gc
(
L
, 
İt¢um
[
o
], 
ex
);

201 
İt¢um
[
o
]) {

202 
LUA_GCCOUNT
: {

203 
b
 = 
	`lua_gc
(
L
, 
LUA_GCCOUNTB
, 0);

204 
	`lua_pushnumb”
(
L
, 
»s
 + ((
lua_Numb”
)
b
/1024));

207 
LUA_GCSTEP
: {

208 
	`lua_pushboŞ—n
(
L
, 
»s
);

212 
	`lua_pushnumb”
(
L
, 
»s
);

216 
	}
}

219 
	$luaB_ty³
 (
lua_S‹
 *
L
) {

220 
	`luaL_checkªy
(
L
, 1);

221 
	`lua_push¡ršg
(
L
, 
	`luaL_ty³Çme
(L, 1));

223 
	}
}

226 
	$luaB_Ãxt
 (
lua_S‹
 *
L
) {

227 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

228 
	`lua_£‰İ
(
L
, 2);

229 ià(
	`lua_Ãxt
(
L
, 1))

232 
	`lua_pushn
(
L
);

235 
	}
}

238 
	$luaB_·œs
 (
lua_S‹
 *
L
) {

239 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

240 
	`lua_pushv®ue
(
L
, 
	`lua_upv®uešdex
(1));

241 
	`lua_pushv®ue
(
L
, 1);

242 
	`lua_pushn
(
L
);

244 
	}
}

247 
	$aœ§ux
 (
lua_S‹
 *
L
) {

248 
i
 = 
	`luaL_checkšt
(
L
, 2);

249 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

250 
i
++;

251 
	`lua_pushš‹g”
(
L
, 
i
);

252 
	`lua_¿wg‘i
(
L
, 1, 
i
);

253  (
	`lua_i¢
(
L
, -1)) ? 0 : 2;

254 
	}
}

257 
	$luaB_aœs
 (
lua_S‹
 *
L
) {

258 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

259 
	`lua_pushv®ue
(
L
, 
	`lua_upv®uešdex
(1));

260 
	`lua_pushv®ue
(
L
, 1);

261 
	`lua_pushš‹g”
(
L
, 0);

263 
	}
}

266 
	$lßd_aux
 (
lua_S‹
 *
L
, 
¡©us
) {

267 ià(
¡©us
 == 0)

270 
	`lua_pushn
(
L
);

271 
	`lua_š£¹
(
L
, -2);

274 
	}
}

277 
	$luaB_lßd¡ršg
 (
lua_S‹
 *
L
) {

278 
size_t
 
l
;

279 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 1, &
l
);

280 cÚ¡ *
chunkÇme
 = 
	`luaL_İt¡ršg
(
L
, 2, 
s
);

281  
	`lßd_aux
(
L
, 
	`luaL_lßdbufãr
(L, 
s
, 
l
, 
chunkÇme
));

282 
	}
}

285 
	$luaB_lßdfe
 (
lua_S‹
 *
L
) {

286 cÚ¡ *
âame
 = 
	`luaL_İt¡ršg
(
L
, 1, 
NULL
);

287  
	`lßd_aux
(
L
, 
	`luaL_lßdfe
(L, 
âame
));

288 
	}
}

297 cÚ¡ *
	$g’”ic_»ad”
 (
lua_S‹
 *
L
, *
ud
, 
size_t
 *
size
) {

298 ()
ud
;

299 
	`luaL_check¡ack
(
L
, 2, "too many‚ested functions");

300 
	`lua_pushv®ue
(
L
, 1);

301 
	`lua_ÿÎ
(
L
, 0, 1);

302 ià(
	`lua_i¢
(
L
, -1)) {

303 *
size
 = 0;

304  
NULL
;

306 ià(
	`lua_is¡ršg
(
L
, -1)) {

307 
	`lua_»¶aû
(
L
, 3);

308  
	`lua_tŞ¡ršg
(
L
, 3, 
size
);

310 
	`luaL_”rÜ
(
L
, "reader function must„eturn‡ string");

311  
NULL
;

312 
	}
}

315 
	$luaB_lßd
 (
lua_S‹
 *
L
) {

316 
¡©us
;

317 cÚ¡ *
úame
 = 
	`luaL_İt¡ršg
(
L
, 2, "=(load)");

318 
	`luaL_checkty³
(
L
, 1, 
LUA_TFUNCTION
);

319 
	`lua_£‰İ
(
L
, 3);

320 
¡©us
 = 
	`lua_lßd
(
L
, 
g’”ic_»ad”
, 
NULL
, 
úame
);

321  
	`lßd_aux
(
L
, 
¡©us
);

322 
	}
}

325 
	$luaB_dofe
 (
lua_S‹
 *
L
) {

326 cÚ¡ *
âame
 = 
	`luaL_İt¡ršg
(
L
, 1, 
NULL
);

327 
n
 = 
	`lua_g‘tİ
(
L
);

328 ià(
	`luaL_lßdfe
(
L
, 
âame
è!ğ0è
	`lua_”rÜ
(L);

329 
	`lua_ÿÎ
(
L
, 0, 
LUA_MULTRET
);

330  
	`lua_g‘tİ
(
L
è- 
n
;

331 
	}
}

334 
	$luaB_as£¹
 (
lua_S‹
 *
L
) {

335 
	`luaL_checkªy
(
L
, 1);

336 ià(!
	`lua_toboŞ—n
(
L
, 1))

337  
	`luaL_”rÜ
(
L
, "%s", 
	`luaL_İt¡ršg
(L, 2, "assertion failed!"));

338  
	`lua_g‘tİ
(
L
);

339 
	}
}

342 
	$luaB_uÅack
 (
lua_S‹
 *
L
) {

343 
i
, 
e
, 
n
;

344 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

345 
i
 = 
	`luaL_İtšt
(
L
, 2, 1);

346 
e
 = 
	`luaL_İt
(
L
, 
luaL_checkšt
, 3, 
	`luaL_g‘n
(L, 1));

347 ià(
i
 > 
e
)  0;

348 
n
 = 
e
 - 
i
 + 1;

349 ià(
n
 <ğ0 || !
	`lua_check¡ack
(
L
,‚))

350  
	`luaL_”rÜ
(
L
, "too many„esultso unpack");

351 
	`lua_¿wg‘i
(
L
, 1, 
i
);

352 
i
++ < 
e
)

353 
	`lua_¿wg‘i
(
L
, 1, 
i
);

354  
n
;

355 
	}
}

358 
	$luaB_£Ëù
 (
lua_S‹
 *
L
) {

359 
n
 = 
	`lua_g‘tİ
(
L
);

360 ià(
	`lua_ty³
(
L
, 1è=ğ
LUA_TSTRING
 && *
	`lua_to¡ršg
(L, 1) == '#') {

361 
	`lua_pushš‹g”
(
L
, 
n
-1);

365 
i
 = 
	`luaL_checkšt
(
L
, 1);

366 ià(
i
 < 0è˜ğ
n
 + i;

367 ià(
i
 > 
n
) i =‚;

368 
	`luaL_¬gcheck
(
L
, 1 <ğ
i
, 1, "index out of„ange");

369  
n
 - 
i
;

371 
	}
}

374 
	$luaB_pÿÎ
 (
lua_S‹
 *
L
) {

375 
¡©us
;

376 
	`luaL_checkªy
(
L
, 1);

377 
¡©us
 = 
	`lua_pÿÎ
(
L
, 
	`lua_g‘tİ
(Lè- 1, 
LUA_MULTRET
, 0);

378 
	`lua_pushboŞ—n
(
L
, (
¡©us
 == 0));

379 
	`lua_š£¹
(
L
, 1);

380  
	`lua_g‘tİ
(
L
);

381 
	}
}

384 
	$luaB_xpÿÎ
 (
lua_S‹
 *
L
) {

385 
¡©us
;

386 
	`luaL_checkªy
(
L
, 2);

387 
	`lua_£‰İ
(
L
, 2);

388 
	`lua_š£¹
(
L
, 1);

389 
¡©us
 = 
	`lua_pÿÎ
(
L
, 0, 
LUA_MULTRET
, 1);

390 
	`lua_pushboŞ—n
(
L
, (
¡©us
 == 0));

391 
	`lua_»¶aû
(
L
, 1);

392  
	`lua_g‘tİ
(
L
);

393 
	}
}

396 
	$luaB_to¡ršg
 (
lua_S‹
 *
L
) {

397 
	`luaL_checkªy
(
L
, 1);

398 ià(
	`luaL_ÿÎm‘a
(
L
, 1, "__tostring"))

400 
	`lua_ty³
(
L
, 1)) {

401 
LUA_TNUMBER
:

402 
	`lua_push¡ršg
(
L
, 
	`lua_to¡ršg
(L, 1));

404 
LUA_TSTRING
:

405 
	`lua_pushv®ue
(
L
, 1);

407 
LUA_TBOOLEAN
:

408 
	`lua_push¡ršg
(
L
, (
	`lua_toboŞ—n
(L, 1) ? "true" : "false"));

410 
LUA_TNIL
:

411 
	`lua_pushl™”®
(
L
, "nil");

414 
	`lua_pushf¡ršg
(
L
, "%s: %p", 
	`luaL_ty³Çme
(L, 1), 
	`lua_tİoš‹r
(L, 1));

418 
	}
}

421 
	$luaB_Ãw´oxy
 (
lua_S‹
 *
L
) {

422 
	`lua_£‰İ
(
L
, 1);

423 
	`lua_Ãwu£rd©a
(
L
, 0);

424 ià(
	`lua_toboŞ—n
(
L
, 1) == 0)

426 ià(
	`lua_isboŞ—n
(
L
, 1)) {

427 
	`lua_ÃwbË
(
L
);

428 
	`lua_pushv®ue
(
L
, -1);

429 
	`lua_pushboŞ—n
(
L
, 1);

430 
	`lua_¿w£t
(
L
, 
	`lua_upv®uešdex
(1));

433 
v®id´oxy
 = 0;

434 ià(
	`lua_g‘m‘©abË
(
L
, 1)) {

435 
	`lua_¿wg‘
(
L
, 
	`lua_upv®uešdex
(1));

436 
v®id´oxy
 = 
	`lua_toboŞ—n
(
L
, -1);

437 
	`lua_pİ
(
L
, 1);

439 
	`luaL_¬gcheck
(
L
, 
v®id´oxy
, 1, "boolean or…roxyƒxpected");

440 
	`lua_g‘m‘©abË
(
L
, 1);

442 
	`lua_£tm‘©abË
(
L
, 2);

444 
	}
}

447 cÚ¡ 
luaL_Reg
 
	gba£_funcs
[] = {

448 {"as£¹", 
luaB_as£¹
},

449 {"cŞËùg¬bage", 
luaB_cŞËùg¬bage
},

450 {"dofe", 
luaB_dofe
},

451 {"”rÜ", 
luaB_”rÜ
},

452 {"gcšfo", 
luaB_gcšfo
},

453 {"g‘ãnv", 
luaB_g‘ãnv
},

454 {"g‘m‘©abË", 
luaB_g‘m‘©abË
},

455 {"lßdfe", 
luaB_lßdfe
},

456 {"lßd", 
luaB_lßd
},

457 {"lßd¡ršg", 
luaB_lßd¡ršg
},

458 {"Ãxt", 
luaB_Ãxt
},

459 {"pÿÎ", 
luaB_pÿÎ
},

460 {"´št", 
luaB_´št
},

461 {"¿wequ®", 
luaB_¿wequ®
},

462 {"¿wg‘", 
luaB_¿wg‘
},

463 {"¿w£t", 
luaB_¿w£t
},

464 {"£Ëù", 
luaB_£Ëù
},

465 {"£tãnv", 
luaB_£tãnv
},

466 {"£tm‘©abË", 
luaB_£tm‘©abË
},

467 {"tÚumb”", 
luaB_tÚumb”
},

468 {"to¡ršg", 
luaB_to¡ršg
},

469 {"ty³", 
luaB_ty³
},

470 {"uÅack", 
luaB_uÅack
},

471 {"xpÿÎ", 
luaB_xpÿÎ
},

472 {
NULL
, NULL}

482 
	#CO_RUN
 0

	)

483 
	#CO_SUS
 1

	)

484 
	#CO_NOR
 2

	)

485 
	#CO_DEAD
 3

	)

487 cÚ¡ *cÚ¡ 
	g¡©Çmes
[] =

490 
	$co¡©us
 (
lua_S‹
 *
L
,†ua_S‹ *
co
) {

491 ià(
L
 =ğ
co
è 
CO_RUN
;

492 
	`lua_¡©us
(
co
)) {

493 
LUA_YIELD
:

494  
CO_SUS
;

496 
lua_Debug
 
¬
;

497 ià(
	`lua_g‘¡ack
(
co
, 0, &
¬
) > 0)

498  
CO_NOR
;

499 ià(
	`lua_g‘tİ
(
co
) == 0)

500  
CO_DEAD
;

502  
CO_SUS
;

505  
CO_DEAD
;

507 
	}
}

510 
	$luaB_co¡©us
 (
lua_S‹
 *
L
) {

511 
lua_S‹
 *
co
 = 
	`lua_tÙh»ad
(
L
, 1);

512 
	`luaL_¬gcheck
(
L
, 
co
, 1, "coroutineƒxpected");

513 
	`lua_push¡ršg
(
L
, 
¡©Çmes
[
	`co¡©us
(L, 
co
)]);

515 
	}
}

518 
	$aux»sume
 (
lua_S‹
 *
L
,†ua_S‹ *
co
, 
Çrg
) {

519 
¡©us
 = 
	`co¡©us
(
L
, 
co
);

520 ià(!
	`lua_check¡ack
(
co
, 
Çrg
))

521 
	`luaL_”rÜ
(
L
, "too many‡rgumentso„esume");

522 ià(
¡©us
 !ğ
CO_SUS
) {

523 
	`lua_pushf¡ršg
(
L
, "ÿÂÙ„esum% cÜoutše", 
¡©Çmes
[
¡©us
]);

526 
	`lua_xmove
(
L
, 
co
, 
Çrg
);

527 
	`lua_£ev–
(
L
, 
co
);

528 
¡©us
 = 
	`lua_»sume
(
co
, 
Çrg
);

529 ià(
¡©us
 =ğ0 || stu =ğ
LUA_YIELD
) {

530 
Äes
 = 
	`lua_g‘tİ
(
co
);

531 ià(!
	`lua_check¡ack
(
L
, 
Äes
 + 1))

532 
	`luaL_”rÜ
(
L
, "too many„esultso„esume");

533 
	`lua_xmove
(
co
, 
L
, 
Äes
);

534  
Äes
;

537 
	`lua_xmove
(
co
, 
L
, 1);

540 
	}
}

543 
	$luaB_cÜesume
 (
lua_S‹
 *
L
) {

544 
lua_S‹
 *
co
 = 
	`lua_tÙh»ad
(
L
, 1);

545 
r
;

546 
	`luaL_¬gcheck
(
L
, 
co
, 1, "coroutineƒxpected");

547 
r
 = 
	`aux»sume
(
L
, 
co
, 
	`lua_g‘tİ
(L) - 1);

548 ià(
r
 < 0) {

549 
	`lua_pushboŞ—n
(
L
, 0);

550 
	`lua_š£¹
(
L
, -2);

554 
	`lua_pushboŞ—n
(
L
, 1);

555 
	`lua_š£¹
(
L
, -(
r
 + 1));

556  
r
 + 1;

558 
	}
}

561 
	$luaB_auxw¿p
 (
lua_S‹
 *
L
) {

562 
lua_S‹
 *
co
 = 
	`lua_tÙh»ad
(
L
, 
	`lua_upv®uešdex
(1));

563 
r
 = 
	`aux»sume
(
L
, 
co
, 
	`lua_g‘tİ
(L));

564 ià(
r
 < 0) {

565 ià(
	`lua_is¡ršg
(
L
, -1)) {

566 
	`luaL_wh”e
(
L
, 1);

567 
	`lua_š£¹
(
L
, -2);

568 
	`lua_cÚÿt
(
L
, 2);

570 
	`lua_”rÜ
(
L
);

572  
r
;

573 
	}
}

576 
	$luaB_coü—‹
 (
lua_S‹
 *
L
) {

577 
lua_S‹
 *
NL
 = 
	`lua_Ãwth»ad
(
L
);

578 
	`luaL_¬gcheck
(
L
, 
	`lua_isfunùiÚ
(L, 1è&& !
	`lua_iscfunùiÚ
(L, 1), 1,

580 
	`lua_pushv®ue
(
L
, 1);

581 
	`lua_xmove
(
L
, 
NL
, 1);

583 
	}
}

586 
	$luaB_cow¿p
 (
lua_S‹
 *
L
) {

587 
	`luaB_coü—‹
(
L
);

588 
	`lua_pushcşosu»
(
L
, 
luaB_auxw¿p
, 1);

590 
	}
}

593 
	$luaB_y›ld
 (
lua_S‹
 *
L
) {

594  
	`lua_y›ld
(
L
, 
	`lua_g‘tİ
(L));

595 
	}
}

598 
	$luaB_cÜuÂšg
 (
lua_S‹
 *
L
) {

599 ià(
	`lua_pushth»ad
(
L
))

600 
	`lua_pushn
(
L
);

602 
	}
}

605 cÚ¡ 
luaL_Reg
 
	gco_funcs
[] = {

606 {"ü—‹", 
luaB_coü—‹
},

607 {"»sume", 
luaB_cÜesume
},

608 {"ruÂšg", 
luaB_cÜuÂšg
},

609 {"¡©us", 
luaB_co¡©us
},

610 {"w¿p", 
luaB_cow¿p
},

611 {"y›ld", 
luaB_y›ld
},

612 {
NULL
, NULL}

618 
	$auxİ’
 (
lua_S‹
 *
L
, cÚ¡ *
Çme
,

619 
lua_CFunùiÚ
 
f
,†ua_CFunùiÚ 
u
) {

620 
	`lua_pushcfunùiÚ
(
L
, 
u
);

621 
	`lua_pushcşosu»
(
L
, 
f
, 1);

622 
	`lua_£tf›ld
(
L
, -2, 
Çme
);

623 
	}
}

626 
	$ba£_İ’
 (
lua_S‹
 *
L
) {

628 
	`lua_pushv®ue
(
L
, 
LUA_GLOBALSINDEX
);

629 
	`lua_£tglob®
(
L
, "_G");

631 
	`luaL_»gi¡”
(
L
, "_G", 
ba£_funcs
);

632 
	`lua_pushl™”®
(
L
, 
LUA_VERSION
);

633 
	`lua_£tglob®
(
L
, "_VERSION");

635 
	`auxİ’
(
L
, "aœs", 
luaB_aœs
, 
aœ§ux
);

636 
	`auxİ’
(
L
, "·œs", 
luaB_·œs
, 
luaB_Ãxt
);

638 
	`lua_ü—‹bË
(
L
, 0, 1);

639 
	`lua_pushv®ue
(
L
, -1);

640 
	`lua_£tm‘©abË
(
L
, -2);

641 
	`lua_pushl™”®
(
L
, "kv");

642 
	`lua_£tf›ld
(
L
, -2, "__mode");

643 
	`lua_pushcşosu»
(
L
, 
luaB_Ãw´oxy
, 1);

644 
	`lua_£tglob®
(
L
, "newproxy");

645 
	}
}

648 
LUALIB_API
 
	$luaİ’_ba£
 (
lua_S‹
 *
L
) {

649 
	`ba£_İ’
(
L
);

650 
	`luaL_»gi¡”
(
L
, 
LUA_COLIBNAME
, 
co_funcs
);

652 
	}
}

	@deps/lua/src/lcode.c

8 
	~<¡dlib.h
>

10 
	#lcode_c


	)

11 
	#LUA_CORE


	)

13 
	~"lua.h
"

15 
	~"lcode.h
"

16 
	~"ldebug.h
"

17 
	~"ldo.h
"

18 
	~"lgc.h
"

19 
	~"Îex.h
"

20 
	~"lmem.h
"

21 
	~"lobjeù.h
"

22 
	~"lİcodes.h
"

23 
	~"Í¬£r.h
"

24 
	~"ÉabË.h
"

27 
	#hasjumps
(
e
è(Ó)->
t
 !ğÓ)->
f
)

	)

30 
	$i¢um”®
(
expdesc
 *
e
) {

31  (
e
->
k
 =ğ
VKNUM
 &&ƒ->
t
 =ğ
NO_JUMP
 &&ƒ->
f
 == NO_JUMP);

32 
	}
}

35 
	$luaK_n
 (
FuncS‹
 *
fs
, 
äom
, 
n
) {

36 
In¡ruùiÚ
 *
´evious
;

37 ià(
fs
->
pc
 > fs->
Ï¡rg‘
) {

38 ià(
fs
->
pc
 == 0) {

39 ià(
äom
 >ğ
fs
->
Çùv¬
)

43 
´evious
 = &
fs
->
f
->
code
[fs->
pc
-1];

44 ià(
	`GET_OPCODE
(*
´evious
è=ğ
OP_LOADNIL
) {

45 
päom
 = 
	`GETARG_A
(*
´evious
);

46 
±o
 = 
	`GETARG_B
(*
´evious
);

47 ià(
päom
 <ğ
äom
 && from <ğ
±o
+1) {

48 ià(
äom
+
n
-1 > 
±o
)

49 
	`SETARG_B
(*
´evious
, 
äom
+
n
-1);

55 
	`luaK_codeABC
(
fs
, 
OP_LOADNIL
, 
äom
, from+
n
-1, 0);

56 
	}
}

59 
	$luaK_jump
 (
FuncS‹
 *
fs
) {

60 
jpc
 = 
fs
->jpc;

61 
j
;

62 
fs
->
jpc
 = 
NO_JUMP
;

63 
j
 = 
	`luaK_codeAsBx
(
fs
, 
OP_JMP
, 0, 
NO_JUMP
);

64 
	`luaK_cÚÿt
(
fs
, &
j
, 
jpc
);

65  
j
;

66 
	}
}

69 
	$luaK_»t
 (
FuncS‹
 *
fs
, 
fœ¡
, 
Ä‘
) {

70 
	`luaK_codeABC
(
fs
, 
OP_RETURN
, 
fœ¡
, 
Ä‘
+1, 0);

71 
	}
}

74 
	$cÚdjump
 (
FuncS‹
 *
fs
, 
OpCode
 
İ
, 
A
, 
B
, 
C
) {

75 
	`luaK_codeABC
(
fs
, 
İ
, 
A
, 
B
, 
C
);

76  
	`luaK_jump
(
fs
);

77 
	}
}

80 
	$fixjump
 (
FuncS‹
 *
fs
, 
pc
, 
de¡
) {

81 
In¡ruùiÚ
 *
jmp
 = &
fs
->
f
->
code
[
pc
];

82 
off£t
 = 
de¡
-(
pc
+1);

83 
	`lua_as£¹
(
de¡
 !ğ
NO_JUMP
);

84 ià(
	`abs
(
off£t
è> 
MAXARG_sBx
)

85 
	`luaX_syÁax”rÜ
(
fs
->
ls
, "control structureoo†ong");

86 
	`SETARG_sBx
(*
jmp
, 
off£t
);

87 
	}
}

94 
	$luaK_g‘Ïb–
 (
FuncS‹
 *
fs
) {

95 
fs
->
Ï¡rg‘
 = fs->
pc
;

96  
fs
->
pc
;

97 
	}
}

100 
	$g‘jump
 (
FuncS‹
 *
fs
, 
pc
) {

101 
off£t
 = 
	`GETARG_sBx
(
fs
->
f
->
code
[
pc
]);

102 ià(
off£t
 =ğ
NO_JUMP
)

103  
NO_JUMP
;

105  (
pc
+1)+
off£t
;

106 
	}
}

109 
In¡ruùiÚ
 *
	$g‘jumpcÚŒŞ
 (
FuncS‹
 *
fs
, 
pc
) {

110 
In¡ruùiÚ
 *
pi
 = &
fs
->
f
->
code
[
pc
];

111 ià(
pc
 >ğ1 && 
	`‹¡TMode
(
	`GET_OPCODE
(*(
pi
-1))))

112  
pi
-1;

114  
pi
;

115 
	}
}

122 
	$Ãed_v®ue
 (
FuncS‹
 *
fs
, 
li¡
) {

123 ; 
li¡
 !ğ
NO_JUMP
;†i¡ = 
	`g‘jump
(
fs
,†ist)) {

124 
In¡ruùiÚ
 
i
 = *
	`g‘jumpcÚŒŞ
(
fs
, 
li¡
);

125 ià(
	`GET_OPCODE
(
i
è!ğ
OP_TESTSET
)  1;

128 
	}
}

131 
	$·tch‹¡»g
 (
FuncS‹
 *
fs
, 
node
, 
»g
) {

132 
In¡ruùiÚ
 *
i
 = 
	`g‘jumpcÚŒŞ
(
fs
, 
node
);

133 ià(
	`GET_OPCODE
(*
i
è!ğ
OP_TESTSET
)

135 ià(
»g
 !ğ
NO_REG
 &&„eg !ğ
	`GETARG_B
(*
i
))

136 
	`SETARG_A
(*
i
, 
»g
);

138 *
i
 = 
	`CREATE_ABC
(
OP_TEST
, 
	`GETARG_B
(*i), 0, 
	`GETARG_C
(*i));

141 
	}
}

144 
	$»movev®ues
 (
FuncS‹
 *
fs
, 
li¡
) {

145 ; 
li¡
 !ğ
NO_JUMP
;†i¡ = 
	`g‘jump
(
fs
,†ist))

146 
	`·tch‹¡»g
(
fs
, 
li¡
, 
NO_REG
);

147 
	}
}

150 
	$·tchli¡aux
 (
FuncS‹
 *
fs
, 
li¡
, 
vrg‘
, 
»g
,

151 
drg‘
) {

152 
li¡
 !ğ
NO_JUMP
) {

153 
Ãxt
 = 
	`g‘jump
(
fs
, 
li¡
);

154 ià(
	`·tch‹¡»g
(
fs
, 
li¡
, 
»g
))

155 
	`fixjump
(
fs
, 
li¡
, 
vrg‘
);

157 
	`fixjump
(
fs
, 
li¡
, 
drg‘
);

158 
li¡
 = 
Ãxt
;

160 
	}
}

163 
	$disch¬gejpc
 (
FuncS‹
 *
fs
) {

164 
	`·tchli¡aux
(
fs
, fs->
jpc
, fs->
pc
, 
NO_REG
, fs->pc);

165 
fs
->
jpc
 = 
NO_JUMP
;

166 
	}
}

169 
	$luaK_·tchli¡
 (
FuncS‹
 *
fs
, 
li¡
, 
rg‘
) {

170 ià(
rg‘
 =ğ
fs
->
pc
)

171 
	`luaK_·tchtoh”e
(
fs
, 
li¡
);

173 
	`lua_as£¹
(
rg‘
 < 
fs
->
pc
);

174 
	`·tchli¡aux
(
fs
, 
li¡
, 
rg‘
, 
NO_REG
,arget);

176 
	}
}

179 
	$luaK_·tchtoh”e
 (
FuncS‹
 *
fs
, 
li¡
) {

180 
	`luaK_g‘Ïb–
(
fs
);

181 
	`luaK_cÚÿt
(
fs
, &fs->
jpc
, 
li¡
);

182 
	}
}

185 
	$luaK_cÚÿt
 (
FuncS‹
 *
fs
, *
l1
, 
l2
) {

186 ià(
l2
 =ğ
NO_JUMP
) ;

187 ià(*
l1
 =ğ
NO_JUMP
)

188 *
l1
 = 
l2
;

190 
li¡
 = *
l1
;

191 
Ãxt
;

192 (
Ãxt
 = 
	`g‘jump
(
fs
, 
li¡
)è!ğ
NO_JUMP
)

193 
li¡
 = 
Ãxt
;

194 
	`fixjump
(
fs
, 
li¡
, 
l2
);

196 
	}
}

199 
	$luaK_check¡ack
 (
FuncS‹
 *
fs
, 
n
) {

200 
Ãw¡ack
 = 
fs
->
ä“»g
 + 
n
;

201 ià(
Ãw¡ack
 > 
fs
->
f
->
max¡acksize
) {

202 ià(
Ãw¡ack
 >ğ
MAXSTACK
)

203 
	`luaX_syÁax”rÜ
(
fs
->
ls
, "function orƒxpressionoo complex");

204 
fs
->
f
->
max¡acksize
 = 
	`ÿ¡_by‹
(
Ãw¡ack
);

206 
	}
}

209 
	$luaK_»£rv”egs
 (
FuncS‹
 *
fs
, 
n
) {

210 
	`luaK_check¡ack
(
fs
, 
n
);

211 
fs
->
ä“»g
 +ğ
n
;

212 
	}
}

215 
	$ä“»g
 (
FuncS‹
 *
fs
, 
»g
) {

216 ià(!
	`ISK
(
»g
è&&„eg >ğ
fs
->
Çùv¬
) {

217 
fs
->
ä“»g
--;

218 
	`lua_as£¹
(
»g
 =ğ
fs
->
ä“»g
);

220 
	}
}

223 
	$ä“exp
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

224 ià(
e
->
k
 =ğ
VNONRELOC
)

225 
	`ä“»g
(
fs
, 
e
->
u
.
s
.
šfo
);

226 
	}
}

229 
	$addk
 (
FuncS‹
 *
fs
, 
TV®ue
 *
k
, TV®u*
v
) {

230 
lua_S‹
 *
L
 = 
fs
->L;

231 
TV®ue
 *
idx
 = 
	`luaH_£t
(
L
, 
fs
->
h
, 
k
);

232 
PrÙo
 *
f
 = 
fs
->f;

233 
Şdsize
 = 
f
->
sizek
;

234 ià(
	`‰i¢umb”
(
idx
)) {

235 
	`lua_as£¹
(
	`luaO_¿wequ®Obj
(&
fs
->
f
->
k
[
	`ÿ¡_št
(
	`nv®ue
(
idx
))], 
v
));

236  
	`ÿ¡_št
(
	`nv®ue
(
idx
));

239 
	`£Šv®ue
(
idx
, 
	`ÿ¡_num
(
fs
->
nk
));

240 
	`luaM_growveùÜ
(
L
, 
f
->
k
, 
fs
->
nk
, f->
sizek
, 
TV®ue
,

241 
MAXARG_Bx
, "constantable overflow");

242 
Şdsize
 < 
f
->
sizek
è
	`£Šv®ue
(&f->
k
[oldsize++]);

243 
	`£tobj
(
L
, &
f
->
k
[
fs
->
nk
], 
v
);

244 
	`luaC_b¬r›r
(
L
, 
f
, 
v
);

245  
fs
->
nk
++;

247 
	}
}

250 
	$luaK_¡ršgK
 (
FuncS‹
 *
fs
, 
TSŒšg
 *
s
) {

251 
TV®ue
 
o
;

252 
	`£tsv®ue
(
fs
->
L
, &
o
, 
s
);

253  
	`addk
(
fs
, &
o
, &o);

254 
	}
}

257 
	$luaK_numb”K
 (
FuncS‹
 *
fs
, 
lua_Numb”
 
r
) {

258 
TV®ue
 
o
;

259 
	`£Šv®ue
(&
o
, 
r
);

260  
	`addk
(
fs
, &
o
, &o);

261 
	}
}

264 
	$boŞK
 (
FuncS‹
 *
fs
, 
b
) {

265 
TV®ue
 
o
;

266 
	`£tbv®ue
(&
o
, 
b
);

267  
	`addk
(
fs
, &
o
, &o);

268 
	}
}

271 
	$nK
 (
FuncS‹
 *
fs
) {

272 
TV®ue
 
k
, 
v
;

273 
	`£Šv®ue
(&
v
);

275 
	`£thv®ue
(
fs
->
L
, &
k
, fs->
h
);

276  
	`addk
(
fs
, &
k
, &
v
);

277 
	}
}

280 
	$luaK_£Œ‘uºs
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
, 
ÄesuÉs
) {

281 ià(
e
->
k
 =ğ
VCALL
) {

282 
	`SETARG_C
(
	`g‘code
(
fs
, 
e
), 
ÄesuÉs
+1);

284 ià(
e
->
k
 =ğ
VVARARG
) {

285 
	`SETARG_B
(
	`g‘code
(
fs
, 
e
), 
ÄesuÉs
+1);

286 
	`SETARG_A
(
	`g‘code
(
fs
, 
e
), fs->
ä“»g
);

287 
	`luaK_»£rv”egs
(
fs
, 1);

289 
	}
}

292 
	$luaK_£tÚ”‘
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

293 ià(
e
->
k
 =ğ
VCALL
) {

294 
e
->
k
 = 
VNONRELOC
;

295 
e
->
u
.
s
.
šfo
 = 
	`GETARG_A
(
	`g‘code
(
fs
,ƒ));

297 ià(
e
->
k
 =ğ
VVARARG
) {

298 
	`SETARG_B
(
	`g‘code
(
fs
, 
e
), 2);

299 
e
->
k
 = 
VRELOCABLE
;

301 
	}
}

304 
	$luaK_disch¬gev¬s
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

305 
e
->
k
) {

306 
VLOCAL
: {

307 
e
->
k
 = 
VNONRELOC
;

310 
VUPVAL
: {

311 
e
->
u
.
s
.
šfo
 = 
	`luaK_codeABC
(
fs
, 
OP_GETUPVAL
, 0,ƒ->u.s.info, 0);

312 
e
->
k
 = 
VRELOCABLE
;

315 
VGLOBAL
: {

316 
e
->
u
.
s
.
šfo
 = 
	`luaK_codeABx
(
fs
, 
OP_GETGLOBAL
, 0,ƒ->u.s.info);

317 
e
->
k
 = 
VRELOCABLE
;

320 
VINDEXED
: {

321 
	`ä“»g
(
fs
, 
e
->
u
.
s
.
aux
);

322 
	`ä“»g
(
fs
, 
e
->
u
.
s
.
šfo
);

323 
e
->
u
.
s
.
šfo
 = 
	`luaK_codeABC
(
fs
, 
OP_GETTABLE
, 0,ƒ->u.s.šfo,ƒ->u.s.
aux
);

324 
e
->
k
 = 
VRELOCABLE
;

327 
VVARARG
:

328 
VCALL
: {

329 
	`luaK_£tÚ”‘
(
fs
, 
e
);

334 
	}
}

337 
	$code_Ïb–
 (
FuncS‹
 *
fs
, 
A
, 
b
, 
jump
) {

338 
	`luaK_g‘Ïb–
(
fs
);

339  
	`luaK_codeABC
(
fs
, 
OP_LOADBOOL
, 
A
, 
b
, 
jump
);

340 
	}
}

343 
	$disch¬ge2»g
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
, 
»g
) {

344 
	`luaK_disch¬gev¬s
(
fs
, 
e
);

345 
e
->
k
) {

346 
VNIL
: {

347 
	`luaK_n
(
fs
, 
»g
, 1);

350 
VFALSE
: 
VTRUE
: {

351 
	`luaK_codeABC
(
fs
, 
OP_LOADBOOL
, 
»g
, 
e
->
k
 =ğ
VTRUE
, 0);

354 
VK
: {

355 
	`luaK_codeABx
(
fs
, 
OP_LOADK
, 
»g
, 
e
->
u
.
s
.
šfo
);

358 
VKNUM
: {

359 
	`luaK_codeABx
(
fs
, 
OP_LOADK
, 
»g
, 
	`luaK_numb”K
(fs, 
e
->
u
.
nv®
));

362 
VRELOCABLE
: {

363 
In¡ruùiÚ
 *
pc
 = &
	`g‘code
(
fs
, 
e
);

364 
	`SETARG_A
(*
pc
, 
»g
);

367 
VNONRELOC
: {

368 ià(
»g
 !ğ
e
->
u
.
s
.
šfo
)

369 
	`luaK_codeABC
(
fs
, 
OP_MOVE
, 
»g
, 
e
->
u
.
s
.
šfo
, 0);

373 
	`lua_as£¹
(
e
->
k
 =ğ
VVOID
 ||ƒ->k =ğ
VJMP
);

377 
e
->
u
.
s
.
šfo
 = 
»g
;

378 
e
->
k
 = 
VNONRELOC
;

379 
	}
}

382 
	$disch¬ge2ªy»g
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

383 ià(
e
->
k
 !ğ
VNONRELOC
) {

384 
	`luaK_»£rv”egs
(
fs
, 1);

385 
	`disch¬ge2»g
(
fs
, 
e
, fs->
ä“»g
-1);

387 
	}
}

390 
	$exp2»g
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
, 
»g
) {

391 
	`disch¬ge2»g
(
fs
, 
e
, 
»g
);

392 ià(
e
->
k
 =ğ
VJMP
)

393 
	`luaK_cÚÿt
(
fs
, &
e
->
t
,ƒ->
u
.
s
.
šfo
);

394 ià(
	`hasjumps
(
e
)) {

395 
fš®
;

396 
p_f
 = 
NO_JUMP
;

397 
p_t
 = 
NO_JUMP
;

398 ià(
	`Ãed_v®ue
(
fs
, 
e
->
t
è||‚“d_v®ue(fs,ƒ->
f
)) {

399 
fj
 = (
e
->
k
 =ğ
VJMP
è? 
NO_JUMP
 : 
	`luaK_jump
(
fs
);

400 
p_f
 = 
	`code_Ïb–
(
fs
, 
»g
, 0, 1);

401 
p_t
 = 
	`code_Ïb–
(
fs
, 
»g
, 1, 0);

402 
	`luaK_·tchtoh”e
(
fs
, 
fj
);

404 
fš®
 = 
	`luaK_g‘Ïb–
(
fs
);

405 
	`·tchli¡aux
(
fs
, 
e
->
f
, 
fš®
, 
»g
, 
p_f
);

406 
	`·tchli¡aux
(
fs
, 
e
->
t
, 
fš®
, 
»g
, 
p_t
);

408 
e
->
f
 =ƒ->
t
 = 
NO_JUMP
;

409 
e
->
u
.
s
.
šfo
 = 
»g
;

410 
e
->
k
 = 
VNONRELOC
;

411 
	}
}

414 
	$luaK_exp2ÃxŒeg
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

415 
	`luaK_disch¬gev¬s
(
fs
, 
e
);

416 
	`ä“exp
(
fs
, 
e
);

417 
	`luaK_»£rv”egs
(
fs
, 1);

418 
	`exp2»g
(
fs
, 
e
, fs->
ä“»g
 - 1);

419 
	}
}

422 
	$luaK_exp2ªy»g
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

423 
	`luaK_disch¬gev¬s
(
fs
, 
e
);

424 ià(
e
->
k
 =ğ
VNONRELOC
) {

425 ià(!
	`hasjumps
(
e
)èƒ->
u
.
s
.
šfo
;

426 ià(
e
->
u
.
s
.
šfo
 >ğ
fs
->
Çùv¬
) {

427 
	`exp2»g
(
fs
, 
e
,ƒ->
u
.
s
.
šfo
);

428  
e
->
u
.
s
.
šfo
;

431 
	`luaK_exp2ÃxŒeg
(
fs
, 
e
);

432  
e
->
u
.
s
.
šfo
;

433 
	}
}

436 
	$luaK_exp2v®
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

437 ià(
	`hasjumps
(
e
))

438 
	`luaK_exp2ªy»g
(
fs
, 
e
);

440 
	`luaK_disch¬gev¬s
(
fs
, 
e
);

441 
	}
}

444 
	$luaK_exp2RK
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

445 
	`luaK_exp2v®
(
fs
, 
e
);

446 
e
->
k
) {

447 
VKNUM
:

448 
VTRUE
:

449 
VFALSE
:

450 
VNIL
: {

451 ià(
fs
->
nk
 <ğ
MAXINDEXRK
) {

452 
e
->
u
.
s
.
šfo
 = (e->
k
 =ğ
VNIL
è? 
	`nK
(
fs
) :

453 (
e
->
k
 =ğ
VKNUM
è? 
	`luaK_numb”K
(
fs
,ƒ->
u
.
nv®
) :

454 
	`boŞK
(
fs
, (
e
->
k
 =ğ
VTRUE
));

455 
e
->
k
 = 
VK
;

456  
	`RKASK
(
e
->
u
.
s
.
šfo
);

460 
VK
: {

461 ià(
e
->
u
.
s
.
šfo
 <ğ
MAXINDEXRK
)

462  
	`RKASK
(
e
->
u
.
s
.
šfo
);

468  
	`luaK_exp2ªy»g
(
fs
, 
e
);

469 
	}
}

472 
	$luaK_¡Üev¬
 (
FuncS‹
 *
fs
, 
expdesc
 *
v¬
,ƒxpdesø*
ex
) {

473 
v¬
->
k
) {

474 
VLOCAL
: {

475 
	`ä“exp
(
fs
, 
ex
);

476 
	`exp2»g
(
fs
, 
ex
, 
v¬
->
u
.
s
.
šfo
);

479 
VUPVAL
: {

480 
e
 = 
	`luaK_exp2ªy»g
(
fs
, 
ex
);

481 
	`luaK_codeABC
(
fs
, 
OP_SETUPVAL
, 
e
, 
v¬
->
u
.
s
.
šfo
, 0);

484 
VGLOBAL
: {

485 
e
 = 
	`luaK_exp2ªy»g
(
fs
, 
ex
);

486 
	`luaK_codeABx
(
fs
, 
OP_SETGLOBAL
, 
e
, 
v¬
->
u
.
s
.
šfo
);

489 
VINDEXED
: {

490 
e
 = 
	`luaK_exp2RK
(
fs
, 
ex
);

491 
	`luaK_codeABC
(
fs
, 
OP_SETTABLE
, 
v¬
->
u
.
s
.
šfo
, v¬->u.s.
aux
, 
e
);

495 
	`lua_as£¹
(0);

499 
	`ä“exp
(
fs
, 
ex
);

500 
	}
}

503 
	$luaK_£lf
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
,ƒxpdesø*
key
) {

504 
func
;

505 
	`luaK_exp2ªy»g
(
fs
, 
e
);

506 
	`ä“exp
(
fs
, 
e
);

507 
func
 = 
fs
->
ä“»g
;

508 
	`luaK_»£rv”egs
(
fs
, 2);

509 
	`luaK_codeABC
(
fs
, 
OP_SELF
, 
func
, 
e
->
u
.
s
.
šfo
, 
	`luaK_exp2RK
(fs, 
key
));

510 
	`ä“exp
(
fs
, 
key
);

511 
e
->
u
.
s
.
šfo
 = 
func
;

512 
e
->
k
 = 
VNONRELOC
;

513 
	}
}

516 
	$šv”tjump
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

517 
In¡ruùiÚ
 *
pc
 = 
	`g‘jumpcÚŒŞ
(
fs
, 
e
->
u
.
s
.
šfo
);

518 
	`lua_as£¹
(
	`‹¡TMode
(
	`GET_OPCODE
(*
pc
)è&& GET_OPCODE(*pcè!ğ
OP_TESTSET
 &&

519 
	`GET_OPCODE
(*
pc
è!ğ
OP_TEST
);

520 
	`SETARG_A
(*
pc
, !(
	`GETARG_A
(*pc)));

521 
	}
}

524 
	$jumpÚcÚd
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
, 
cÚd
) {

525 ià(
e
->
k
 =ğ
VRELOCABLE
) {

526 
In¡ruùiÚ
 
›
 = 
	`g‘code
(
fs
, 
e
);

527 ià(
	`GET_OPCODE
(
›
è=ğ
OP_NOT
) {

528 
fs
->
pc
--;

529  
	`cÚdjump
(
fs
, 
OP_TEST
, 
	`GETARG_B
(
›
), 0, !
cÚd
);

533 
	`disch¬ge2ªy»g
(
fs
, 
e
);

534 
	`ä“exp
(
fs
, 
e
);

535  
	`cÚdjump
(
fs
, 
OP_TESTSET
, 
NO_REG
, 
e
->
u
.
s
.
šfo
, 
cÚd
);

536 
	}
}

539 
	$luaK_goiárue
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

540 
pc
;

541 
	`luaK_disch¬gev¬s
(
fs
, 
e
);

542 
e
->
k
) {

543 
VK
: 
VKNUM
: 
VTRUE
: {

544 
pc
 = 
NO_JUMP
;

547 
VJMP
: {

548 
	`šv”tjump
(
fs
, 
e
);

549 
pc
 = 
e
->
u
.
s
.
šfo
;

553 
pc
 = 
	`jumpÚcÚd
(
fs
, 
e
, 0);

557 
	`luaK_cÚÿt
(
fs
, &
e
->
f
, 
pc
);

558 
	`luaK_·tchtoh”e
(
fs
, 
e
->
t
);

559 
e
->
t
 = 
NO_JUMP
;

560 
	}
}

563 
	$luaK_goifçl£
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

564 
pc
;

565 
	`luaK_disch¬gev¬s
(
fs
, 
e
);

566 
e
->
k
) {

567 
VNIL
: 
VFALSE
: {

568 
pc
 = 
NO_JUMP
;

571 
VJMP
: {

572 
pc
 = 
e
->
u
.
s
.
šfo
;

576 
pc
 = 
	`jumpÚcÚd
(
fs
, 
e
, 1);

580 
	`luaK_cÚÿt
(
fs
, &
e
->
t
, 
pc
);

581 
	`luaK_·tchtoh”e
(
fs
, 
e
->
f
);

582 
e
->
f
 = 
NO_JUMP
;

583 
	}
}

586 
	$cod’Ù
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
) {

587 
	`luaK_disch¬gev¬s
(
fs
, 
e
);

588 
e
->
k
) {

589 
VNIL
: 
VFALSE
: {

590 
e
->
k
 = 
VTRUE
;

593 
VK
: 
VKNUM
: 
VTRUE
: {

594 
e
->
k
 = 
VFALSE
;

597 
VJMP
: {

598 
	`šv”tjump
(
fs
, 
e
);

601 
VRELOCABLE
:

602 
VNONRELOC
: {

603 
	`disch¬ge2ªy»g
(
fs
, 
e
);

604 
	`ä“exp
(
fs
, 
e
);

605 
e
->
u
.
s
.
šfo
 = 
	`luaK_codeABC
(
fs
, 
OP_NOT
, 0,ƒ->u.s.info, 0);

606 
e
->
k
 = 
VRELOCABLE
;

610 
	`lua_as£¹
(0);

615 { 
‹mp
 = 
e
->
f
;ƒ->àğe->
t
;ƒ->t =emp; }

616 
	`»movev®ues
(
fs
, 
e
->
f
);

617 
	`»movev®ues
(
fs
, 
e
->
t
);

618 
	}
}

621 
	$luaK_šdexed
 (
FuncS‹
 *
fs
, 
expdesc
 *
t
,ƒxpdesø*
k
) {

622 
t
->
u
.
s
.
aux
 = 
	`luaK_exp2RK
(
fs
, 
k
);

623 
t
->
k
 = 
VINDEXED
;

624 
	}
}

627 
	$cÚ¡fŞdšg
 (
OpCode
 
İ
, 
expdesc
 *
e1
,ƒxpdesø*
e2
) {

628 
lua_Numb”
 
v1
, 
v2
, 
r
;

629 ià(!
	`i¢um”®
(
e1
è|| !i¢um”®(
e2
))  0;

630 
v1
 = 
e1
->
u
.
nv®
;

631 
v2
 = 
e2
->
u
.
nv®
;

632 
İ
) {

633 
OP_ADD
: 
r
 = 
	`luai_numadd
(
v1
, 
v2
); ;

634 
OP_SUB
: 
r
 = 
	`luai_numsub
(
v1
, 
v2
); ;

635 
OP_MUL
: 
r
 = 
	`luai_nummul
(
v1
, 
v2
); ;

636 
OP_DIV
:

637 ià(
v2
 == 0)  0;

638 
r
 = 
	`luai_numdiv
(
v1
, 
v2
); ;

639 
OP_MOD
:

640 ià(
v2
 == 0)  0;

641 
r
 = 
	`luai_nummod
(
v1
, 
v2
); ;

642 
OP_POW
: 
r
 = 
	`luai_numpow
(
v1
, 
v2
); ;

643 
OP_UNM
: 
r
 = 
	`luai_numunm
(
v1
); ;

644 
OP_LEN
:  0;

645 : 
	`lua_as£¹
(0); 
r
 = 0; ;

647 ià(
	`luai_numi¢ª
(
r
))  0;

648 
e1
->
u
.
nv®
 = 
r
;

650 
	}
}

653 
	$cod—r™h
 (
FuncS‹
 *
fs
, 
OpCode
 
İ
, 
expdesc
 *
e1
,ƒxpdesø*
e2
) {

654 ià(
	`cÚ¡fŞdšg
(
İ
, 
e1
, 
e2
))

657 
o2
 = (
İ
 !ğ
OP_UNM
 && o°!ğ
OP_LEN
è? 
	`luaK_exp2RK
(
fs
, 
e2
) : 0;

658 
o1
 = 
	`luaK_exp2RK
(
fs
, 
e1
);

659 ià(
o1
 > 
o2
) {

660 
	`ä“exp
(
fs
, 
e1
);

661 
	`ä“exp
(
fs
, 
e2
);

664 
	`ä“exp
(
fs
, 
e2
);

665 
	`ä“exp
(
fs
, 
e1
);

667 
e1
->
u
.
s
.
šfo
 = 
	`luaK_codeABC
(
fs
, 
İ
, 0, 
o1
, 
o2
);

668 
e1
->
k
 = 
VRELOCABLE
;

670 
	}
}

673 
	$codecomp
 (
FuncS‹
 *
fs
, 
OpCode
 
İ
, 
cÚd
, 
expdesc
 *
e1
,

674 
expdesc
 *
e2
) {

675 
o1
 = 
	`luaK_exp2RK
(
fs
, 
e1
);

676 
o2
 = 
	`luaK_exp2RK
(
fs
, 
e2
);

677 
	`ä“exp
(
fs
, 
e2
);

678 
	`ä“exp
(
fs
, 
e1
);

679 ià(
cÚd
 =ğ0 && 
İ
 !ğ
OP_EQ
) {

680 
‹mp
;

681 
‹mp
 = 
o1
; o1 = 
o2
; o2 =emp;

682 
cÚd
 = 1;

684 
e1
->
u
.
s
.
šfo
 = 
	`cÚdjump
(
fs
, 
İ
, 
cÚd
, 
o1
, 
o2
);

685 
e1
->
k
 = 
VJMP
;

686 
	}
}

689 
	$luaK_´efix
 (
FuncS‹
 *
fs
, 
UnO´
 
İ
, 
expdesc
 *
e
) {

690 
expdesc
 
e2
;

691 
e2
.
t
 =ƒ2.
f
 = 
NO_JUMP
;ƒ2.
k
 = 
VKNUM
;ƒ2.
u
.
nv®
 = 0;

692 
İ
) {

693 
OPR_MINUS
: {

694 ià(!
	`i¢um”®
(
e
))

695 
	`luaK_exp2ªy»g
(
fs
, 
e
);

696 
	`cod—r™h
(
fs
, 
OP_UNM
, 
e
, &
e2
);

699 
OPR_NOT
: 
	`cod’Ù
(
fs
, 
e
); ;

700 
OPR_LEN
: {

701 
	`luaK_exp2ªy»g
(
fs
, 
e
);

702 
	`cod—r™h
(
fs
, 
OP_LEN
, 
e
, &
e2
);

705 : 
	`lua_as£¹
(0);

707 
	}
}

710 
	$luaK_šfix
 (
FuncS‹
 *
fs
, 
BšO´
 
İ
, 
expdesc
 *
v
) {

711 
İ
) {

712 
OPR_AND
: {

713 
	`luaK_goiárue
(
fs
, 
v
);

716 
OPR_OR
: {

717 
	`luaK_goifçl£
(
fs
, 
v
);

720 
OPR_CONCAT
: {

721 
	`luaK_exp2ÃxŒeg
(
fs
, 
v
);

724 
OPR_ADD
: 
OPR_SUB
: 
OPR_MUL
: 
OPR_DIV
:

725 
OPR_MOD
: 
OPR_POW
: {

726 ià(!
	`i¢um”®
(
v
)è
	`luaK_exp2RK
(
fs
, v);

730 
	`luaK_exp2RK
(
fs
, 
v
);

734 
	}
}

737 
	$luaK_posfix
 (
FuncS‹
 *
fs
, 
BšO´
 
İ
, 
expdesc
 *
e1
,ƒxpdesø*
e2
) {

738 
İ
) {

739 
OPR_AND
: {

740 
	`lua_as£¹
(
e1
->
t
 =ğ
NO_JUMP
);

741 
	`luaK_disch¬gev¬s
(
fs
, 
e2
);

742 
	`luaK_cÚÿt
(
fs
, &
e2
->
f
, 
e1
->f);

743 *
e1
 = *
e2
;

746 
OPR_OR
: {

747 
	`lua_as£¹
(
e1
->
f
 =ğ
NO_JUMP
);

748 
	`luaK_disch¬gev¬s
(
fs
, 
e2
);

749 
	`luaK_cÚÿt
(
fs
, &
e2
->
t
, 
e1
->t);

750 *
e1
 = *
e2
;

753 
OPR_CONCAT
: {

754 
	`luaK_exp2v®
(
fs
, 
e2
);

755 ià(
e2
->
k
 =ğ
VRELOCABLE
 && 
	`GET_OPCODE
(
	`g‘code
(
fs
,ƒ2)è=ğ
OP_CONCAT
) {

756 
	`lua_as£¹
(
e1
->
u
.
s
.
šfo
 =ğ
	`GETARG_B
(
	`g‘code
(
fs
, 
e2
))-1);

757 
	`ä“exp
(
fs
, 
e1
);

758 
	`SETARG_B
(
	`g‘code
(
fs
, 
e2
), 
e1
->
u
.
s
.
šfo
);

759 
e1
->
k
 = 
VRELOCABLE
;ƒ1->
u
.
s
.
šfo
 = 
e2
->u.s.info;

762 
	`luaK_exp2ÃxŒeg
(
fs
, 
e2
);

763 
	`cod—r™h
(
fs
, 
OP_CONCAT
, 
e1
, 
e2
);

767 
OPR_ADD
: 
	`cod—r™h
(
fs
, 
OP_ADD
, 
e1
, 
e2
); ;

768 
OPR_SUB
: 
	`cod—r™h
(
fs
, 
OP_SUB
, 
e1
, 
e2
); ;

769 
OPR_MUL
: 
	`cod—r™h
(
fs
, 
OP_MUL
, 
e1
, 
e2
); ;

770 
OPR_DIV
: 
	`cod—r™h
(
fs
, 
OP_DIV
, 
e1
, 
e2
); ;

771 
OPR_MOD
: 
	`cod—r™h
(
fs
, 
OP_MOD
, 
e1
, 
e2
); ;

772 
OPR_POW
: 
	`cod—r™h
(
fs
, 
OP_POW
, 
e1
, 
e2
); ;

773 
OPR_EQ
: 
	`codecomp
(
fs
, 
OP_EQ
, 1, 
e1
, 
e2
); ;

774 
OPR_NE
: 
	`codecomp
(
fs
, 
OP_EQ
, 0, 
e1
, 
e2
); ;

775 
OPR_LT
: 
	`codecomp
(
fs
, 
OP_LT
, 1, 
e1
, 
e2
); ;

776 
OPR_LE
: 
	`codecomp
(
fs
, 
OP_LE
, 1, 
e1
, 
e2
); ;

777 
OPR_GT
: 
	`codecomp
(
fs
, 
OP_LT
, 0, 
e1
, 
e2
); ;

778 
OPR_GE
: 
	`codecomp
(
fs
, 
OP_LE
, 0, 
e1
, 
e2
); ;

779 : 
	`lua_as£¹
(0);

781 
	}
}

784 
	$luaK_fixlše
 (
FuncS‹
 *
fs
, 
lše
) {

785 
fs
->
f
->
lšešfo
[fs->
pc
 - 1] = 
lše
;

786 
	}
}

789 
	$luaK_code
 (
FuncS‹
 *
fs
, 
In¡ruùiÚ
 
i
, 
lše
) {

790 
PrÙo
 *
f
 = 
fs
->f;

791 
	`disch¬gejpc
(
fs
);

793 
	`luaM_growveùÜ
(
fs
->
L
, 
f
->
code
, fs->
pc
, f->
sizecode
, 
In¡ruùiÚ
,

794 
MAX_INT
, "code size overflow");

795 
f
->
code
[
fs
->
pc
] = 
i
;

797 
	`luaM_growveùÜ
(
fs
->
L
, 
f
->
lšešfo
, fs->
pc
, f->
siz–šešfo
, ,

798 
MAX_INT
, "code size overflow");

799 
f
->
lšešfo
[
fs
->
pc
] = 
lše
;

800  
fs
->
pc
++;

801 
	}
}

804 
	$luaK_codeABC
 (
FuncS‹
 *
fs
, 
OpCode
 
o
, 
a
, 
b
, 
c
) {

805 
	`lua_as£¹
(
	`g‘OpMode
(
o
è=ğ
iABC
);

806 
	`lua_as£¹
(
	`g‘BMode
(
o
è!ğ
OpArgN
 || 
b
 == 0);

807 
	`lua_as£¹
(
	`g‘CMode
(
o
è!ğ
OpArgN
 || 
c
 == 0);

808  
	`luaK_code
(
fs
, 
	`CREATE_ABC
(
o
, 
a
, 
b
, 
c
), fs->
ls
->
Ï¡lše
);

809 
	}
}

812 
	$luaK_codeABx
 (
FuncS‹
 *
fs
, 
OpCode
 
o
, 
a
, 
bc
) {

813 
	`lua_as£¹
(
	`g‘OpMode
(
o
è=ğ
iABx
 || g‘OpMode(oè=ğ
iAsBx
);

814 
	`lua_as£¹
(
	`g‘CMode
(
o
è=ğ
OpArgN
);

815  
	`luaK_code
(
fs
, 
	`CREATE_ABx
(
o
, 
a
, 
bc
), fs->
ls
->
Ï¡lše
);

816 
	}
}

819 
	$luaK_£i¡
 (
FuncS‹
 *
fs
, 
ba£
, 
ÃËms
, 
to¡Üe
) {

820 
c
 = (
ÃËms
 - 1)/
LFIELDS_PER_FLUSH
 + 1;

821 
b
 = (
to¡Üe
 =ğ
LUA_MULTRET
) ? 0 :ostore;

822 
	`lua_as£¹
(
to¡Üe
 != 0);

823 ià(
c
 <ğ
MAXARG_C
)

824 
	`luaK_codeABC
(
fs
, 
OP_SETLIST
, 
ba£
, 
b
, 
c
);

826 
	`luaK_codeABC
(
fs
, 
OP_SETLIST
, 
ba£
, 
b
, 0);

827 
	`luaK_code
(
fs
, 
	`ÿ¡
(
In¡ruùiÚ
, 
c
), fs->
ls
->
Ï¡lše
);

829 
fs
->
ä“»g
 = 
ba£
 + 1;

830 
	}
}

	@deps/lua/src/lcode.h

7 #iâdeà
lcode_h


8 
	#lcode_h


	)

10 
	~"Îex.h
"

11 
	~"lobjeù.h
"

12 
	~"lİcodes.h
"

13 
	~"Í¬£r.h
"

20 
	#NO_JUMP
 (-1)

	)

26 
	eBšO´
 {

27 
	mOPR_ADD
, 
	mOPR_SUB
, 
	mOPR_MUL
, 
	mOPR_DIV
, 
	mOPR_MOD
, 
	mOPR_POW
,

28 
	mOPR_CONCAT
,

29 
	mOPR_NE
, 
	mOPR_EQ
,

30 
	mOPR_LT
, 
	mOPR_LE
, 
	mOPR_GT
, 
	mOPR_GE
,

31 
	mOPR_AND
, 
	mOPR_OR
,

32 
	mOPR_NOBINOPR


33 } 
	tBšO´
;

36 
	eUnO´
 { 
	mOPR_MINUS
, 
	mOPR_NOT
, 
	mOPR_LEN
, 
	mOPR_NOUNOPR
 } 
	tUnO´
;

39 
	#g‘code
(
fs
,
e
è((fs)->
f
->
code
[Ó)->
u
.
s
.
šfo
])

	)

41 
	#luaK_codeAsBx
(
fs
,
o
,
A
,
sBx
è
	`luaK_codeABx
(fs,o,A,(sBx)+
MAXARG_sBx
)

	)

43 
	#luaK_£tmuÉ»t
(
fs
,
e
è
	`luaK_£Œ‘uºs
(fs,ƒ, 
LUA_MULTRET
)

	)

45 
LUAI_FUNC
 
luaK_codeABx
 (
FuncS‹
 *
fs
, 
OpCode
 
o
, 
A
, 
Bx
);

46 
LUAI_FUNC
 
luaK_codeABC
 (
FuncS‹
 *
fs
, 
OpCode
 
o
, 
A
, 
B
, 
C
);

47 
LUAI_FUNC
 
luaK_fixlše
 (
FuncS‹
 *
fs
, 
lše
);

48 
LUAI_FUNC
 
luaK_n
 (
FuncS‹
 *
fs
, 
äom
, 
n
);

49 
LUAI_FUNC
 
luaK_»£rv”egs
 (
FuncS‹
 *
fs
, 
n
);

50 
LUAI_FUNC
 
luaK_check¡ack
 (
FuncS‹
 *
fs
, 
n
);

51 
LUAI_FUNC
 
luaK_¡ršgK
 (
FuncS‹
 *
fs
, 
TSŒšg
 *
s
);

52 
LUAI_FUNC
 
luaK_numb”K
 (
FuncS‹
 *
fs
, 
lua_Numb”
 
r
);

53 
LUAI_FUNC
 
luaK_disch¬gev¬s
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
);

54 
LUAI_FUNC
 
luaK_exp2ªy»g
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
);

55 
LUAI_FUNC
 
luaK_exp2ÃxŒeg
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
);

56 
LUAI_FUNC
 
luaK_exp2v®
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
);

57 
LUAI_FUNC
 
luaK_exp2RK
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
);

58 
LUAI_FUNC
 
luaK_£lf
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
,ƒxpdesø*
key
);

59 
LUAI_FUNC
 
luaK_šdexed
 (
FuncS‹
 *
fs
, 
expdesc
 *
t
,ƒxpdesø*
k
);

60 
LUAI_FUNC
 
luaK_goiárue
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
);

61 
LUAI_FUNC
 
luaK_¡Üev¬
 (
FuncS‹
 *
fs
, 
expdesc
 *
v¬
,ƒxpdesø*
e
);

62 
LUAI_FUNC
 
luaK_£Œ‘uºs
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
, 
ÄesuÉs
);

63 
LUAI_FUNC
 
luaK_£tÚ”‘
 (
FuncS‹
 *
fs
, 
expdesc
 *
e
);

64 
LUAI_FUNC
 
luaK_jump
 (
FuncS‹
 *
fs
);

65 
LUAI_FUNC
 
luaK_»t
 (
FuncS‹
 *
fs
, 
fœ¡
, 
Ä‘
);

66 
LUAI_FUNC
 
luaK_·tchli¡
 (
FuncS‹
 *
fs
, 
li¡
, 
rg‘
);

67 
LUAI_FUNC
 
luaK_·tchtoh”e
 (
FuncS‹
 *
fs
, 
li¡
);

68 
LUAI_FUNC
 
luaK_cÚÿt
 (
FuncS‹
 *
fs
, *
l1
, 
l2
);

69 
LUAI_FUNC
 
luaK_g‘Ïb–
 (
FuncS‹
 *
fs
);

70 
LUAI_FUNC
 
luaK_´efix
 (
FuncS‹
 *
fs
, 
UnO´
 
İ
, 
expdesc
 *
v
);

71 
LUAI_FUNC
 
luaK_šfix
 (
FuncS‹
 *
fs
, 
BšO´
 
İ
, 
expdesc
 *
v
);

72 
LUAI_FUNC
 
luaK_posfix
 (
FuncS‹
 *
fs
, 
BšO´
 
İ
, 
expdesc
 *
v1
,ƒxpdesø*
v2
);

73 
LUAI_FUNC
 
luaK_£i¡
 (
FuncS‹
 *
fs
, 
ba£
, 
ÃËms
, 
to¡Üe
);

	@deps/lua/src/ldblib.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

12 
	#ldblib_c


	)

13 
	#LUA_LIB


	)

15 
	~"lua.h
"

17 
	~"Ïuxlib.h
"

18 
	~"lu®ib.h
"

22 
	$db_g‘»gi¡ry
 (
lua_S‹
 *
L
) {

23 
	`lua_pushv®ue
(
L
, 
LUA_REGISTRYINDEX
);

25 
	}
}

28 
	$db_g‘m‘©abË
 (
lua_S‹
 *
L
) {

29 
	`luaL_checkªy
(
L
, 1);

30 ià(!
	`lua_g‘m‘©abË
(
L
, 1)) {

31 
	`lua_pushn
(
L
);

34 
	}
}

37 
	$db_£tm‘©abË
 (
lua_S‹
 *
L
) {

38 
t
 = 
	`lua_ty³
(
L
, 2);

39 
	`luaL_¬gcheck
(
L
, 
t
 =ğ
LUA_TNIL
 || =ğ
LUA_TTABLE
, 2,

41 
	`lua_£‰İ
(
L
, 2);

42 
	`lua_pushboŞ—n
(
L
, 
	`lua_£tm‘©abË
(L, 1));

44 
	}
}

47 
	$db_g‘ãnv
 (
lua_S‹
 *
L
) {

48 
	`luaL_checkªy
(
L
, 1);

49 
	`lua_g‘ãnv
(
L
, 1);

51 
	}
}

54 
	$db_£tãnv
 (
lua_S‹
 *
L
) {

55 
	`luaL_checkty³
(
L
, 2, 
LUA_TTABLE
);

56 
	`lua_£‰İ
(
L
, 2);

57 ià(
	`lua_£tãnv
(
L
, 1) == 0)

58 
	`luaL_”rÜ
(
L
, 
	`LUA_QL
("setfenv")

61 
	}
}

64 
	$£‰abss
 (
lua_S‹
 *
L
, cÚ¡ *
i
, cÚ¡ *
v
) {

65 
	`lua_push¡ršg
(
L
, 
v
);

66 
	`lua_£tf›ld
(
L
, -2, 
i
);

67 
	}
}

70 
	$£‰absi
 (
lua_S‹
 *
L
, cÚ¡ *
i
, 
v
) {

71 
	`lua_pushš‹g”
(
L
, 
v
);

72 
	`lua_£tf›ld
(
L
, -2, 
i
);

73 
	}
}

76 
lua_S‹
 *
	$g‘th»ad
 (
lua_S‹
 *
L
, *
¬g
) {

77 ià(
	`lua_i¡h»ad
(
L
, 1)) {

78 *
¬g
 = 1;

79  
	`lua_tÙh»ad
(
L
, 1);

82 *
¬g
 = 0;

83  
L
;

85 
	}
}

88 
	$Œ—t¡ackİtiÚ
 (
lua_S‹
 *
L
,†ua_S‹ *
L1
, cÚ¡ *
âame
) {

89 ià(
L
 =ğ
L1
) {

90 
	`lua_pushv®ue
(
L
, -2);

91 
	`lua_»move
(
L
, -3);

94 
	`lua_xmove
(
L1
, 
L
, 1);

95 
	`lua_£tf›ld
(
L
, -2, 
âame
);

96 
	}
}

99 
	$db_g‘šfo
 (
lua_S‹
 *
L
) {

100 
lua_Debug
 
¬
;

101 
¬g
;

102 
lua_S‹
 *
L1
 = 
	`g‘th»ad
(
L
, &
¬g
);

103 cÚ¡ *
İtiÚs
 = 
	`luaL_İt¡ršg
(
L
, 
¬g
+2, "flnSu");

104 ià(
	`lua_i¢umb”
(
L
, 
¬g
+1)) {

105 ià(!
	`lua_g‘¡ack
(
L1
, ()
	`lua_toš‹g”
(
L
, 
¬g
+1), &
¬
)) {

106 
	`lua_pushn
(
L
);

110 ià(
	`lua_isfunùiÚ
(
L
, 
¬g
+1)) {

111 
	`lua_pushf¡ršg
(
L
, ">%s", 
İtiÚs
);

112 
İtiÚs
 = 
	`lua_to¡ršg
(
L
, -1);

113 
	`lua_pushv®ue
(
L
, 
¬g
+1);

114 
	`lua_xmove
(
L
, 
L1
, 1);

117  
	`luaL_¬g”rÜ
(
L
, 
¬g
+1, "function or†evelƒxpected");

118 ià(!
	`lua_g‘šfo
(
L1
, 
İtiÚs
, &
¬
))

119  
	`luaL_¬g”rÜ
(
L
, 
¬g
+2, "invalid option");

120 
	`lua_ü—‹bË
(
L
, 0, 2);

121 ià(
	`¡rchr
(
İtiÚs
, 'S')) {

122 
	`£‰abss
(
L
, "sourû", 
¬
.
sourû
);

123 
	`£‰abss
(
L
, "shÜt_¤c", 
¬
.
shÜt_¤c
);

124 
	`£‰absi
(
L
, "lšedefšed", 
¬
.
lšedefšed
);

125 
	`£‰absi
(
L
, "Ï¡lšedefšed", 
¬
.
Ï¡lšedefšed
);

126 
	`£‰abss
(
L
, "wh©", 
¬
.
wh©
);

128 ià(
	`¡rchr
(
İtiÚs
, 'l'))

129 
	`£‰absi
(
L
, "cu¼’še", 
¬
.
cu¼’še
);

130 ià(
	`¡rchr
(
İtiÚs
, 'u'))

131 
	`£‰absi
(
L
, "nups", 
¬
.
nups
);

132 ià(
	`¡rchr
(
İtiÚs
, 'n')) {

133 
	`£‰abss
(
L
, "Çme", 
¬
.
Çme
);

134 
	`£‰abss
(
L
, "Çmewh©", 
¬
.
Çmewh©
);

136 ià(
	`¡rchr
(
İtiÚs
, 'L'))

137 
	`Œ—t¡ackİtiÚ
(
L
, 
L1
, "activelines");

138 ià(
	`¡rchr
(
İtiÚs
, 'f'))

139 
	`Œ—t¡ackİtiÚ
(
L
, 
L1
, "func");

141 
	}
}

144 
	$db_g‘loÿl
 (
lua_S‹
 *
L
) {

145 
¬g
;

146 
lua_S‹
 *
L1
 = 
	`g‘th»ad
(
L
, &
¬g
);

147 
lua_Debug
 
¬
;

148 cÚ¡ *
Çme
;

149 ià(!
	`lua_g‘¡ack
(
L1
, 
	`luaL_checkšt
(
L
, 
¬g
+1), &
¬
))

150  
	`luaL_¬g”rÜ
(
L
, 
¬g
+1, "level out of„ange");

151 
Çme
 = 
	`lua_g‘loÿl
(
L1
, &
¬
, 
	`luaL_checkšt
(
L
, 
¬g
+2));

152 ià(
Çme
) {

153 
	`lua_xmove
(
L1
, 
L
, 1);

154 
	`lua_push¡ršg
(
L
, 
Çme
);

155 
	`lua_pushv®ue
(
L
, -2);

159 
	`lua_pushn
(
L
);

162 
	}
}

165 
	$db_£oÿl
 (
lua_S‹
 *
L
) {

166 
¬g
;

167 
lua_S‹
 *
L1
 = 
	`g‘th»ad
(
L
, &
¬g
);

168 
lua_Debug
 
¬
;

169 ià(!
	`lua_g‘¡ack
(
L1
, 
	`luaL_checkšt
(
L
, 
¬g
+1), &
¬
))

170  
	`luaL_¬g”rÜ
(
L
, 
¬g
+1, "level out of„ange");

171 
	`luaL_checkªy
(
L
, 
¬g
+3);

172 
	`lua_£‰İ
(
L
, 
¬g
+3);

173 
	`lua_xmove
(
L
, 
L1
, 1);

174 
	`lua_push¡ršg
(
L
, 
	`lua_£oÿl
(
L1
, &
¬
, 
	`luaL_checkšt
(L, 
¬g
+2)));

176 
	}
}

179 
	$auxupv®ue
 (
lua_S‹
 *
L
, 
g‘
) {

180 cÚ¡ *
Çme
;

181 
n
 = 
	`luaL_checkšt
(
L
, 2);

182 
	`luaL_checkty³
(
L
, 1, 
LUA_TFUNCTION
);

183 ià(
	`lua_iscfunùiÚ
(
L
, 1))  0;

184 
Çme
 = 
g‘
 ? 
	`lua_g‘upv®ue
(
L
, 1, 
n
è: 
	`lua_£tupv®ue
(L, 1,‚);

185 ià(
Çme
 =ğ
NULL
)  0;

186 
	`lua_push¡ršg
(
L
, 
Çme
);

187 
	`lua_š£¹
(
L
, -(
g‘
+1));

188  
g‘
 + 1;

189 
	}
}

192 
	$db_g‘upv®ue
 (
lua_S‹
 *
L
) {

193  
	`auxupv®ue
(
L
, 1);

194 
	}
}

197 
	$db_£tupv®ue
 (
lua_S‹
 *
L
) {

198 
	`luaL_checkªy
(
L
, 3);

199  
	`auxupv®ue
(
L
, 0);

200 
	}
}

204 cÚ¡ 
	gKEY_HOOK
 = 'h';

207 
	$hookf
 (
lua_S‹
 *
L
, 
lua_Debug
 *
¬
) {

208 cÚ¡ *cÚ¡ 
hookÇmes
[] =

210 
	`lua_pushlightu£rd©a
(
L
, (*)&
KEY_HOOK
);

211 
	`lua_¿wg‘
(
L
, 
LUA_REGISTRYINDEX
);

212 
	`lua_pushlightu£rd©a
(
L
, L);

213 
	`lua_¿wg‘
(
L
, -2);

214 ià(
	`lua_isfunùiÚ
(
L
, -1)) {

215 
	`lua_push¡ršg
(
L
, 
hookÇmes
[()
¬
->
ev’t
]);

216 ià(
¬
->
cu¼’še
 >= 0)

217 
	`lua_pushš‹g”
(
L
, 
¬
->
cu¼’še
);

218 
	`lua_pushn
(
L
);

219 
	`lua_as£¹
(
	`lua_g‘šfo
(
L
, "lS", 
¬
));

220 
	`lua_ÿÎ
(
L
, 2, 0);

222 
	}
}

225 
	$makemask
 (cÚ¡ *
smask
, 
couÁ
) {

226 
mask
 = 0;

227 ià(
	`¡rchr
(
smask
, 'c')è
mask
 |ğ
LUA_MASKCALL
;

228 ià(
	`¡rchr
(
smask
, 'r')è
mask
 |ğ
LUA_MASKRET
;

229 ià(
	`¡rchr
(
smask
, 'l')è
mask
 |ğ
LUA_MASKLINE
;

230 ià(
couÁ
 > 0è
mask
 |ğ
LUA_MASKCOUNT
;

231  
mask
;

232 
	}
}

235 *
	$unmakemask
 (
mask
, *
smask
) {

236 
i
 = 0;

237 ià(
mask
 & 
LUA_MASKCALL
è
smask
[
i
++] = 'c';

238 ià(
mask
 & 
LUA_MASKRET
è
smask
[
i
++] = 'r';

239 ià(
mask
 & 
LUA_MASKLINE
è
smask
[
i
++] = 'l';

240 
smask
[
i
] = '\0';

241  
smask
;

242 
	}
}

245 
	$g‘hookbË
 (
lua_S‹
 *
L
) {

246 
	`lua_pushlightu£rd©a
(
L
, (*)&
KEY_HOOK
);

247 
	`lua_¿wg‘
(
L
, 
LUA_REGISTRYINDEX
);

248 ià(!
	`lua_i¡abË
(
L
, -1)) {

249 
	`lua_pİ
(
L
, 1);

250 
	`lua_ü—‹bË
(
L
, 0, 1);

251 
	`lua_pushlightu£rd©a
(
L
, (*)&
KEY_HOOK
);

252 
	`lua_pushv®ue
(
L
, -2);

253 
	`lua_¿w£t
(
L
, 
LUA_REGISTRYINDEX
);

255 
	}
}

258 
	$db_£thook
 (
lua_S‹
 *
L
) {

259 
¬g
, 
mask
, 
couÁ
;

260 
lua_Hook
 
func
;

261 
lua_S‹
 *
L1
 = 
	`g‘th»ad
(
L
, &
¬g
);

262 ià(
	`lua_i¢ÚeÜn
(
L
, 
¬g
+1)) {

263 
	`lua_£‰İ
(
L
, 
¬g
+1);

264 
func
 = 
NULL
; 
mask
 = 0; 
couÁ
 = 0;

267 cÚ¡ *
smask
 = 
	`luaL_check¡ršg
(
L
, 
¬g
+2);

268 
	`luaL_checkty³
(
L
, 
¬g
+1, 
LUA_TFUNCTION
);

269 
couÁ
 = 
	`luaL_İtšt
(
L
, 
¬g
+3, 0);

270 
func
 = 
hookf
; 
mask
 = 
	`makemask
(
smask
, 
couÁ
);

272 
	`g‘hookbË
(
L
);

273 
	`lua_pushlightu£rd©a
(
L
, 
L1
);

274 
	`lua_pushv®ue
(
L
, 
¬g
+1);

275 
	`lua_¿w£t
(
L
, -3);

276 
	`lua_pİ
(
L
, 1);

277 
	`lua_£thook
(
L1
, 
func
, 
mask
, 
couÁ
);

279 
	}
}

282 
	$db_g‘hook
 (
lua_S‹
 *
L
) {

283 
¬g
;

284 
lua_S‹
 *
L1
 = 
	`g‘th»ad
(
L
, &
¬g
);

285 
buff
[5];

286 
mask
 = 
	`lua_g‘hookmask
(
L1
);

287 
lua_Hook
 
hook
 = 
	`lua_g‘hook
(
L1
);

288 ià(
hook
 !ğ
NULL
 && hook !ğ
hookf
)

289 
	`lua_pushl™”®
(
L
, "external hook");

291 
	`g‘hookbË
(
L
);

292 
	`lua_pushlightu£rd©a
(
L
, 
L1
);

293 
	`lua_¿wg‘
(
L
, -2);

294 
	`lua_»move
(
L
, -2);

296 
	`lua_push¡ršg
(
L
, 
	`unmakemask
(
mask
, 
buff
));

297 
	`lua_pushš‹g”
(
L
, 
	`lua_g‘hookcouÁ
(
L1
));

299 
	}
}

302 
	$db_debug
 (
lua_S‹
 *
L
) {

304 
bufãr
[250];

305 
	`åuts
("lua_debug> ", 
¡d”r
);

306 ià(
	`fg‘s
(
bufãr
, (bufãr), 
¡dš
) == 0 ||

307 
	`¡rcmp
(
bufãr
, "cont\n") == 0)

309 ià(
	`luaL_lßdbufãr
(
L
, 
bufãr
, 
	`¡¾’
(buffer), "=(debug command)") ||

310 
	`lua_pÿÎ
(
L
, 0, 0, 0)) {

311 
	`åuts
(
	`lua_to¡ršg
(
L
, -1), 
¡d”r
);

312 
	`åuts
("\n", 
¡d”r
);

314 
	`lua_£‰İ
(
L
, 0);

316 
	}
}

319 
	#LEVELS1
 12

	)

320 
	#LEVELS2
 10

	)

322 
	$db_”rÜfb
 (
lua_S‹
 *
L
) {

323 
Ëv–
;

324 
fœ¡·¹
 = 1;

325 
¬g
;

326 
lua_S‹
 *
L1
 = 
	`g‘th»ad
(
L
, &
¬g
);

327 
lua_Debug
 
¬
;

328 ià(
	`lua_i¢umb”
(
L
, 
¬g
+2)) {

329 
Ëv–
 = ()
	`lua_toš‹g”
(
L
, 
¬g
+2);

330 
	`lua_pİ
(
L
, 1);

333 
Ëv–
 = (
L
 =ğ
L1
) ? 1 : 0;

334 ià(
	`lua_g‘tİ
(
L
è=ğ
¬g
)

335 
	`lua_pushl™”®
(
L
, "");

336 ià(!
	`lua_is¡ršg
(
L
, 
¬g
+1))  1;

337 
	`lua_pushl™”®
(
L
, "\n");

338 
	`lua_pushl™”®
(
L
, "stackraceback:");

339 
	`lua_g‘¡ack
(
L1
, 
Ëv–
++, &
¬
)) {

340 ià(
Ëv–
 > 
LEVELS1
 && 
fœ¡·¹
) {

342 ià(!
	`lua_g‘¡ack
(
L1
, 
Ëv–
+
LEVELS2
, &
¬
))

343 
Ëv–
--;

345 
	`lua_pushl™”®
(
L
, "\n\t...");

346 
	`lua_g‘¡ack
(
L1
, 
Ëv–
+
LEVELS2
, &
¬
))

347 
Ëv–
++;

349 
fœ¡·¹
 = 0;

352 
	`lua_pushl™”®
(
L
, "\n\t");

353 
	`lua_g‘šfo
(
L1
, "SÆ", &
¬
);

354 
	`lua_pushf¡ršg
(
L
, "%s:", 
¬
.
shÜt_¤c
);

355 ià(
¬
.
cu¼’še
 > 0)

356 
	`lua_pushf¡ršg
(
L
, "%d:", 
¬
.
cu¼’še
);

357 ià(*
¬
.
Çmewh©
 != '\0')

358 
	`lua_pushf¡ršg
(
L
, " iÀfunùiÚ " 
LUA_QS
, 
¬
.
Çme
);

360 ià(*
¬
.
wh©
 == 'm')

361 
	`lua_pushf¡ršg
(
L
, " in main chunk");

362 ià(*
¬
.
wh©
 == 'C' || *ar.what == 't')

363 
	`lua_pushl™”®
(
L
, " ?");

365 
	`lua_pushf¡ršg
(
L
, " in function <%s:%d>",

366 
¬
.
shÜt_¤c
,‡r.
lšedefšed
);

368 
	`lua_cÚÿt
(
L
, 
	`lua_g‘tİ
(Lè- 
¬g
);

370 
	`lua_cÚÿt
(
L
, 
	`lua_g‘tİ
(Lè- 
¬g
);

372 
	}
}

375 cÚ¡ 
luaL_Reg
 
	gdblib
[] = {

376 {"debug", 
db_debug
},

377 {"g‘ãnv", 
db_g‘ãnv
},

378 {"g‘hook", 
db_g‘hook
},

379 {"g‘šfo", 
db_g‘šfo
},

380 {"g‘loÿl", 
db_g‘loÿl
},

381 {"g‘»gi¡ry", 
db_g‘»gi¡ry
},

382 {"g‘m‘©abË", 
db_g‘m‘©abË
},

383 {"g‘upv®ue", 
db_g‘upv®ue
},

384 {"£tãnv", 
db_£tãnv
},

385 {"£thook", 
db_£thook
},

386 {"£oÿl", 
db_£oÿl
},

387 {"£tm‘©abË", 
db_£tm‘©abË
},

388 {"£tupv®ue", 
db_£tupv®ue
},

389 {"Œaûback", 
db_”rÜfb
},

390 {
NULL
, NULL}

394 
LUALIB_API
 
	$luaİ’_debug
 (
lua_S‹
 *
L
) {

395 
	`luaL_»gi¡”
(
L
, 
LUA_DBLIBNAME
, 
dblib
);

397 
	}
}

	@deps/lua/src/ldebug.c

8 
	~<¡d¬g.h
>

9 
	~<¡ddef.h
>

10 
	~<¡ršg.h
>

13 
	#ldebug_c


	)

14 
	#LUA_CORE


	)

16 
	~"lua.h
"

18 
	~"Ïpi.h
"

19 
	~"lcode.h
"

20 
	~"ldebug.h
"

21 
	~"ldo.h
"

22 
	~"lfunc.h
"

23 
	~"lobjeù.h
"

24 
	~"lİcodes.h
"

25 
	~"l¡©e.h
"

26 
	~"l¡ršg.h
"

27 
	~"ÉabË.h
"

28 
	~"Ém.h
"

29 
	~"lvm.h
"

33 cÚ¡ *
g‘funúame
 (
lua_S‹
 *
L
, 
C®lInfo
 *
ci
, cÚ¡ **
Çme
);

36 
	$cu¼’c
 (
lua_S‹
 *
L
, 
C®lInfo
 *
ci
) {

37 ià(!
	`isLua
(
ci
))  -1;

38 ià(
ci
 =ğ
L
->ci)

39 
ci
->
§vedpc
 = 
L
->savedpc;

40  
	`pcR–
(
ci
->
§vedpc
, 
	`ci_func
(ci)->
l
.
p
);

41 
	}
}

44 
	$cu¼’še
 (
lua_S‹
 *
L
, 
C®lInfo
 *
ci
) {

45 
pc
 = 
	`cu¼’c
(
L
, 
ci
);

46 ià(
pc
 < 0)

49  
	`g‘lše
(
	`ci_func
(
ci
)->
l
.
p
, 
pc
);

50 
	}
}

56 
LUA_API
 
	$lua_£thook
 (
lua_S‹
 *
L
, 
lua_Hook
 
func
, 
mask
, 
couÁ
) {

57 ià(
func
 =ğ
NULL
 || 
mask
 == 0) {

58 
mask
 = 0;

59 
func
 = 
NULL
;

61 
L
->
hook
 = 
func
;

62 
L
->
ba£hookcouÁ
 = 
couÁ
;

63 
	`»£thookcouÁ
(
L
);

64 
L
->
hookmask
 = 
	`ÿ¡_by‹
(
mask
);

66 
	}
}

69 
LUA_API
 
lua_Hook
 
	$lua_g‘hook
 (
lua_S‹
 *
L
) {

70  
L
->
hook
;

71 
	}
}

74 
LUA_API
 
	$lua_g‘hookmask
 (
lua_S‹
 *
L
) {

75  
L
->
hookmask
;

76 
	}
}

79 
LUA_API
 
	$lua_g‘hookcouÁ
 (
lua_S‹
 *
L
) {

80  
L
->
ba£hookcouÁ
;

81 
	}
}

84 
LUA_API
 
	$lua_g‘¡ack
 (
lua_S‹
 *
L
, 
Ëv–
, 
lua_Debug
 *
¬
) {

85 
¡©us
;

86 
C®lInfo
 *
ci
;

87 
	`lua_lock
(
L
);

88 
ci
 = 
L
->ci; 
Ëv–
 > 0 && c˜> L->
ba£_ci
; ci--) {

89 
Ëv–
--;

90 ià(
	`f_isLua
(
ci
))

91 
Ëv–
 -ğ
ci
->
ÿÎs
;

93 ià(
Ëv–
 =ğ0 && 
ci
 > 
L
->
ba£_ci
) {

94 
¡©us
 = 1;

95 
¬
->
i_ci
 = 
	`ÿ¡_št
(
ci
 - 
L
->
ba£_ci
);

97 ià(
Ëv–
 < 0) {

98 
¡©us
 = 1;

99 
¬
->
i_ci
 = 0;

101 
¡©us
 = 0;

102 
	`lua_uÆock
(
L
);

103  
¡©us
;

104 
	}
}

107 
PrÙo
 *
	$g‘lu­rÙo
 (
C®lInfo
 *
ci
) {

108  (
	`isLua
(
ci
è? 
	`ci_func
(ci)->
l
.
p
 : 
NULL
);

109 
	}
}

112 cÚ¡ *
	$fšdloÿl
 (
lua_S‹
 *
L
, 
C®lInfo
 *
ci
, 
n
) {

113 cÚ¡ *
Çme
;

114 
PrÙo
 *
å
 = 
	`g‘lu­rÙo
(
ci
);

115 ià(
å
 && (
Çme
 = 
	`luaF_g‘loÿÊame
(å, 
n
, 
	`cu¼’c
(
L
, 
ci
))è!ğ
NULL
)

116  
Çme
;

118 
StkId
 
lim™
 = (
ci
 =ğ
L
->ciè? L->
tİ
 : (ci+1)->
func
;

119 ià(
lim™
 - 
ci
->
ba£
 >ğ
n
 &&‚ > 0)

122  
NULL
;

124 
	}
}

127 
LUA_API
 cÚ¡ *
	$lua_g‘loÿl
 (
lua_S‹
 *
L
, cÚ¡ 
lua_Debug
 *
¬
, 
n
) {

128 
C®lInfo
 *
ci
 = 
L
->
ba£_ci
 + 
¬
->
i_ci
;

129 cÚ¡ *
Çme
 = 
	`fšdloÿl
(
L
, 
ci
, 
n
);

130 
	`lua_lock
(
L
);

131 ià(
Çme
)

132 
	`luaA_pushobjeù
(
L
, 
ci
->
ba£
 + (
n
 - 1));

133 
	`lua_uÆock
(
L
);

134  
Çme
;

135 
	}
}

138 
LUA_API
 cÚ¡ *
	$lua_£oÿl
 (
lua_S‹
 *
L
, cÚ¡ 
lua_Debug
 *
¬
, 
n
) {

139 
C®lInfo
 *
ci
 = 
L
->
ba£_ci
 + 
¬
->
i_ci
;

140 cÚ¡ *
Çme
 = 
	`fšdloÿl
(
L
, 
ci
, 
n
);

141 
	`lua_lock
(
L
);

142 ià(
Çme
)

143 
	`£tobjs2s
(
L
, 
ci
->
ba£
 + (
n
 - 1), L->
tİ
 - 1);

144 
L
->
tİ
--;

145 
	`lua_uÆock
(
L
);

146  
Çme
;

147 
	}
}

150 
	$funcšfo
 (
lua_Debug
 *
¬
, 
Closu»
 *
ş
) {

151 ià(
ş
->
c
.
isC
) {

152 
¬
->
sourû
 = "=[C]";

153 
¬
->
lšedefšed
 = -1;

154 
¬
->
Ï¡lšedefšed
 = -1;

155 
¬
->
wh©
 = "C";

158 
¬
->
sourû
 = 
	`g‘¡r
(
ş
->
l
.
p
->source);

159 
¬
->
lšedefšed
 = 
ş
->
l
.
p
->linedefined;

160 
¬
->
Ï¡lšedefšed
 = 
ş
->
l
.
p
->lastlinedefined;

161 
¬
->
wh©
 = (¬->
lšedefšed
 == 0) ? "main" : "Lua";

163 
	`luaO_chunkid
(
¬
->
shÜt_¤c
,‡r->
sourû
, 
LUA_IDSIZE
);

164 
	}
}

167 
	$šfo_ÿÎ
 (
lua_Debug
 *
¬
) {

168 
¬
->
Çme
 =‡r->
Çmewh©
 = "";

169 
¬
->
wh©
 = "tail";

170 
¬
->
Ï¡lšedefšed
 =‡r->
lšedefšed
 =‡r->
cu¼’še
 = -1;

171 
¬
->
sourû
 = "=(tail call)";

172 
	`luaO_chunkid
(
¬
->
shÜt_¤c
,‡r->
sourû
, 
LUA_IDSIZE
);

173 
¬
->
nups
 = 0;

174 
	}
}

177 
	$cŞËùv®idlšes
 (
lua_S‹
 *
L
, 
Closu»
 *
f
) {

178 ià(
f
 =ğ
NULL
 || f->
c
.
isC
) {

179 
	`£Šv®ue
(
L
->
tİ
);

182 
TabË
 *
t
 = 
	`luaH_Ãw
(
L
, 0, 0);

183 *
lšešfo
 = 
f
->
l
.
p
->lineinfo;

184 
i
;

185 
i
=0; i<
f
->
l
.
p
->
siz–šešfo
; i++)

186 
	`£tbv®ue
(
	`luaH_£Šum
(
L
, 
t
, 
lšešfo
[
i
]), 1);

187 
	`£thv®ue
(
L
, L->
tİ
, 
t
);

189 
	`šü_tİ
(
L
);

190 
	}
}

193 
	$auxg‘šfo
 (
lua_S‹
 *
L
, cÚ¡ *
wh©
, 
lua_Debug
 *
¬
,

194 
Closu»
 *
f
, 
C®lInfo
 *
ci
) {

195 
¡©us
 = 1;

196 ià(
f
 =ğ
NULL
) {

197 
	`šfo_ÿÎ
(
¬
);

198  
¡©us
;

200 ; *
wh©
; what++) {

201 *
wh©
) {

203 
	`funcšfo
(
¬
, 
f
);

207 
¬
->
cu¼’še
 = (
ci
è? 
	`cu¼’še
(
L
, ci) : -1;

211 
¬
->
nups
 = 
f
->
c
.
nupv®ues
;

215 
¬
->
Çmewh©
 = (
ci
è? 
	`g‘funúame
(
L
, ci, &¬->
Çme
è: 
NULL
;

216 ià(
¬
->
Çmewh©
 =ğ
NULL
) {

217 
¬
->
Çmewh©
 = "";

218 
¬
->
Çme
 = 
NULL
;

225 : 
¡©us
 = 0;

228  
¡©us
;

229 
	}
}

232 
LUA_API
 
	$lua_g‘šfo
 (
lua_S‹
 *
L
, cÚ¡ *
wh©
, 
lua_Debug
 *
¬
) {

233 
¡©us
;

234 
Closu»
 *
f
 = 
NULL
;

235 
C®lInfo
 *
ci
 = 
NULL
;

236 
	`lua_lock
(
L
);

237 ià(*
wh©
 == '>') {

238 
StkId
 
func
 = 
L
->
tİ
 - 1;

239 
	`luai_­icheck
(
L
, 
	`‰isfunùiÚ
(
func
));

240 
wh©
++;

241 
f
 = 
	`şv®ue
(
func
);

242 
L
->
tİ
--;

244 ià(
¬
->
i_ci
 != 0) {

245 
ci
 = 
L
->
ba£_ci
 + 
¬
->
i_ci
;

246 
	`lua_as£¹
(
	`‰isfunùiÚ
(
ci
->
func
));

247 
f
 = 
	`şv®ue
(
ci
->
func
);

249 
¡©us
 = 
	`auxg‘šfo
(
L
, 
wh©
, 
¬
, 
f
, 
ci
);

250 ià(
	`¡rchr
(
wh©
, 'f')) {

251 ià(
f
 =ğ
NULL
è
	`£Šv®ue
(
L
->
tİ
);

252 
	`£tşv®ue
(
L
, L->
tİ
, 
f
);

253 
	`šü_tİ
(
L
);

255 ià(
	`¡rchr
(
wh©
, 'L'))

256 
	`cŞËùv®idlšes
(
L
, 
f
);

257 
	`lua_uÆock
(
L
);

258  
¡©us
;

259 
	}
}

268 
	#check
(
x
èià(!(x)è 0;

	)

270 
	#checkjump
(
±
,
pc
è
	`check
(0 <ğpø&&…ø<…t->
sizecode
)

	)

272 
	#check»g
(
±
,
»g
è
	`check
(Ôegè< (±)->
max¡acksize
)

	)

276 
	$´echeck
 (cÚ¡ 
PrÙo
 *
±
) {

277 
	`check
(
±
->
max¡acksize
 <ğ
MAXSTACK
);

278 
	`check
(
±
->
num·¿ms
+Õt->
is_v¬¬g
 & 
VARARG_HASARG
è<ğ±->
max¡acksize
);

279 
	`check
(!(
±
->
is_v¬¬g
 & 
VARARG_NEEDSARG
) ||

280 (
±
->
is_v¬¬g
 & 
VARARG_HASARG
));

281 
	`check
(
±
->
sizeupv®ues
 <ğ±->
nups
);

282 
	`check
(
±
->
siz–šešfo
 =ğ±->
sizecode
 ||…t->sizelineinfo == 0);

283 
	`check
(
±
->
sizecode
 > 0 && 
	`GET_OPCODE
Õt->
code
[±->sizecode-1]è=ğ
OP_RETURN
);

285 
	}
}

288 
	#checkİ’İ
(
±
,
pc
è
	`luaG_checkİ’İ
(Õt)->
code
[Õc)+1])

	)

290 
	$luaG_checkİ’İ
 (
In¡ruùiÚ
 
i
) {

291 
	`GET_OPCODE
(
i
)) {

292 
OP_CALL
:

293 
OP_TAILCALL
:

294 
OP_RETURN
:

295 
OP_SETLIST
: {

296 
	`check
(
	`GETARG_B
(
i
) == 0);

301 
	}
}

304 
	$checkArgMode
 (cÚ¡ 
PrÙo
 *
±
, 
r
, 
OpArgMask
 
mode
) {

305 
mode
) {

306 
OpArgN
: 
	`check
(
r
 == 0); ;

307 
OpArgU
: ;

308 
OpArgR
: 
	`check»g
(
±
, 
r
); ;

309 
OpArgK
:

310 
	`check
(
	`ISK
(
r
è? 
	`INDEXK
Ôè< 
±
->
sizek
 :„ <…t->
max¡acksize
);

314 
	}
}

317 
In¡ruùiÚ
 
	$symbexec
 (cÚ¡ 
PrÙo
 *
±
, 
Ï¡pc
, 
»g
) {

318 
pc
;

319 
Ï¡
;

320 
Ï¡
 = 
±
->
sizecode
-1;

321 
	`check
(
	`´echeck
(
±
));

322 
pc
 = 0;…ø< 
Ï¡pc
;…c++) {

323 
In¡ruùiÚ
 
i
 = 
±
->
code
[
pc
];

324 
OpCode
 
İ
 = 
	`GET_OPCODE
(
i
);

325 
a
 = 
	`GETARG_A
(
i
);

326 
b
 = 0;

327 
c
 = 0;

328 
	`check
(
İ
 < 
NUM_OPCODES
);

329 
	`check»g
(
±
, 
a
);

330 
	`g‘OpMode
(
İ
)) {

331 
iABC
: {

332 
b
 = 
	`GETARG_B
(
i
);

333 
c
 = 
	`GETARG_C
(
i
);

334 
	`check
(
	`checkArgMode
(
±
, 
b
, 
	`g‘BMode
(
İ
)));

335 
	`check
(
	`checkArgMode
(
±
, 
c
, 
	`g‘CMode
(
İ
)));

338 
iABx
: {

339 
b
 = 
	`GETARG_Bx
(
i
);

340 ià(
	`g‘BMode
(
İ
è=ğ
OpArgK
è
	`check
(
b
 < 
±
->
sizek
);

343 
iAsBx
: {

344 
b
 = 
	`GETARG_sBx
(
i
);

345 ià(
	`g‘BMode
(
İ
è=ğ
OpArgR
) {

346 
de¡
 = 
pc
+1+
b
;

347 
	`check
(0 <ğ
de¡
 && de¡ < 
±
->
sizecode
);

348 ià(
de¡
 > 0) {

349 
j
;

354 
j
 = 0; j < 
de¡
; j++) {

355 
In¡ruùiÚ
 
d
 = 
±
->
code
[
de¡
-1-
j
];

356 ià(!(
	`GET_OPCODE
(
d
è=ğ
OP_SETLIST
 && 
	`GETARG_C
(d) == 0)) ;

360 
	`check
((
j
&1) == 0);

366 ià(
	`‹¡AMode
(
İ
)) {

367 ià(
a
 =ğ
»g
è
Ï¡
 = 
pc
;

369 ià(
	`‹¡TMode
(
İ
)) {

370 
	`check
(
pc
+2 < 
±
->
sizecode
);

371 
	`check
(
	`GET_OPCODE
(
±
->
code
[
pc
+1]è=ğ
OP_JMP
);

373 
İ
) {

374 
OP_LOADBOOL
: {

375 ià(
c
 == 1) {

376 
	`check
(
pc
+2 < 
±
->
sizecode
);

377 
	`check
(
	`GET_OPCODE
(
±
->
code
[
pc
+1]è!ğ
OP_SETLIST
 ||

378 
	`GETARG_C
(
±
->
code
[
pc
+1]) != 0);

382 
OP_LOADNIL
: {

383 ià(
a
 <ğ
»g
 &&„eg <ğ
b
)

384 
Ï¡
 = 
pc
;

387 
OP_GETUPVAL
:

388 
OP_SETUPVAL
: {

389 
	`check
(
b
 < 
±
->
nups
);

392 
OP_GETGLOBAL
:

393 
OP_SETGLOBAL
: {

394 
	`check
(
	`‰is¡ršg
(&
±
->
k
[
b
]));

397 
OP_SELF
: {

398 
	`check»g
(
±
, 
a
+1);

399 ià(
»g
 =ğ
a
+1è
Ï¡
 = 
pc
;

402 
OP_CONCAT
: {

403 
	`check
(
b
 < 
c
);

406 
OP_TFORLOOP
: {

407 
	`check
(
c
 >= 1);

408 
	`check»g
(
±
, 
a
+2+
c
);

409 ià(
»g
 >ğ
a
+2è
Ï¡
 = 
pc
;

412 
OP_FORLOOP
:

413 
OP_FORPREP
:

414 
	`check»g
(
±
, 
a
+3);

416 
OP_JMP
: {

417 
de¡
 = 
pc
+1+
b
;

419 ià(
»g
 !ğ
NO_REG
 && 
pc
 < 
de¡
 && de¡ <ğ
Ï¡pc
)

420 
pc
 +ğ
b
;

423 
OP_CALL
:

424 
OP_TAILCALL
: {

425 ià(
b
 != 0) {

426 
	`check»g
(
±
, 
a
+
b
-1);

428 
c
--;

429 ià(
c
 =ğ
LUA_MULTRET
) {

430 
	`check
(
	`checkİ’İ
(
±
, 
pc
));

432 ià(
c
 != 0)

433 
	`check»g
(
±
, 
a
+
c
-1);

434 ià(
»g
 >ğ
a
è
Ï¡
 = 
pc
;

437 
OP_RETURN
: {

438 
b
--;

439 ià(
b
 > 0è
	`check»g
(
±
, 
a
+b-1);

442 
OP_SETLIST
: {

443 ià(
b
 > 0è
	`check»g
(
±
, 
a
 + b);

444 ià(
c
 == 0) {

445 
pc
++;

446 
	`check
(
pc
 < 
±
->
sizecode
 - 1);

450 
OP_CLOSURE
: {

451 
nup
, 
j
;

452 
	`check
(
b
 < 
±
->
siz•
);

453 
nup
 = 
±
->
p
[
b
]->
nups
;

454 
	`check
(
pc
 + 
nup
 < 
±
->
sizecode
);

455 
j
 = 1; j <ğ
nup
; j++) {

456 
OpCode
 
İ1
 = 
	`GET_OPCODE
(
±
->
code
[
pc
 + 
j
]);

457 
	`check
(
İ1
 =ğ
OP_GETUPVAL
 || op1 =ğ
OP_MOVE
);

459 ià(
»g
 !ğ
NO_REG
)

460 
pc
 +ğ
nup
;

463 
OP_VARARG
: {

464 
	`check
((
±
->
is_v¬¬g
 & 
VARARG_ISVARARG
) &&

465 !(
±
->
is_v¬¬g
 & 
VARARG_NEEDSARG
));

466 
b
--;

467 ià(
b
 =ğ
LUA_MULTRET
è
	`check
(
	`checkİ’İ
(
±
, 
pc
));

468 
	`check»g
(
±
, 
a
+
b
-1);

474  
±
->
code
[
Ï¡
];

475 
	}
}

477 #undeà
check


478 #undeà
checkjump


479 #undeà
check»g


484 
	$luaG_checkcode
 (cÚ¡ 
PrÙo
 *
±
) {

485  (
	`symbexec
(
±
,…t->
sizecode
, 
NO_REG
) != 0);

486 
	}
}

489 cÚ¡ *
	$kÇme
 (
PrÙo
 *
p
, 
c
) {

490 ià(
	`ISK
(
c
è&& 
	`‰is¡ršg
(&
p
->
k
[
	`INDEXK
(c)]))

491  
	`sv®ue
(&
p
->
k
[
	`INDEXK
(
c
)]);

494 
	}
}

497 cÚ¡ *
	$g‘objÇme
 (
lua_S‹
 *
L
, 
C®lInfo
 *
ci
, 
¡ackpos
,

498 cÚ¡ **
Çme
) {

499 ià(
	`isLua
(
ci
)) {

500 
PrÙo
 *
p
 = 
	`ci_func
(
ci
)->
l
.p;

501 
pc
 = 
	`cu¼’c
(
L
, 
ci
);

502 
In¡ruùiÚ
 
i
;

503 *
Çme
 = 
	`luaF_g‘loÿÊame
(
p
, 
¡ackpos
+1, 
pc
);

504 ià(*
Çme
)

506 
i
 = 
	`symbexec
(
p
, 
pc
, 
¡ackpos
);

507 
	`lua_as£¹
(
pc
 != -1);

508 
	`GET_OPCODE
(
i
)) {

509 
OP_GETGLOBAL
: {

510 
g
 = 
	`GETARG_Bx
(
i
);

511 
	`lua_as£¹
(
	`‰is¡ršg
(&
p
->
k
[
g
]));

512 *
Çme
 = 
	`sv®ue
(&
p
->
k
[
g
]);

515 
OP_MOVE
: {

516 
a
 = 
	`GETARG_A
(
i
);

517 
b
 = 
	`GETARG_B
(
i
);

518 ià(
b
 < 
a
)

519  
	`g‘objÇme
(
L
, 
ci
, 
b
, 
Çme
);

522 
OP_GETTABLE
: {

523 
k
 = 
	`GETARG_C
(
i
);

524 *
Çme
 = 
	`kÇme
(
p
, 
k
);

527 
OP_GETUPVAL
: {

528 
u
 = 
	`GETARG_B
(
i
);

529 *
Çme
 = 
p
->
upv®ues
 ? 
	`g‘¡r
Õ->upv®ues[
u
]) : "?";

532 
OP_SELF
: {

533 
k
 = 
	`GETARG_C
(
i
);

534 *
Çme
 = 
	`kÇme
(
p
, 
k
);

540  
NULL
;

541 
	}
}

544 cÚ¡ *
	$g‘funúame
 (
lua_S‹
 *
L
, 
C®lInfo
 *
ci
, cÚ¡ **
Çme
) {

545 
In¡ruùiÚ
 
i
;

546 ià((
	`isLua
(
ci
è&& ci->
ÿÎs
 > 0) || !isLua(ci - 1))

547  
NULL
;

548 
ci
--;

549 
i
 = 
	`ci_func
(
ci
)->
l
.
p
->
code
[
	`cu¼’c
(
L
, ci)];

550 ià(
	`GET_OPCODE
(
i
è=ğ
OP_CALL
 || GET_OPCODE(iè=ğ
OP_TAILCALL
 ||

551 
	`GET_OPCODE
(
i
è=ğ
OP_TFORLOOP
)

552  
	`g‘objÇme
(
L
, 
ci
, 
	`GETARG_A
(
i
), 
Çme
);

554  
NULL
;

555 
	}
}

559 
	$isš¡ack
 (
C®lInfo
 *
ci
, cÚ¡ 
TV®ue
 *
o
) {

560 
StkId
 
p
;

561 
p
 = 
ci
->
ba£
;… < ci->
tİ
;…++)

562 ià(
o
 =ğ
p
)  1;

564 
	}
}

567 
	$luaG_ty³”rÜ
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
o
, cÚ¡ *
İ
) {

568 cÚ¡ *
Çme
 = 
NULL
;

569 cÚ¡ *
t
 = 
luaT_ty³Çmes
[
	`‰y³
(
o
)];

570 cÚ¡ *
kšd
 = (
	`isš¡ack
(
L
->
ci
, 
o
)) ?

571 
	`g‘objÇme
(
L
, L->
ci
, 
	`ÿ¡_št
(
o
 - L->
ba£
), &
Çme
) :

572 
NULL
;

573 ià(
kšd
)

574 
	`luaG_ruÃ¼Ü
(
L
, "©‹m±Ø% % " 
LUA_QS
 " (a %s value)",

575 
İ
, 
kšd
, 
Çme
, 
t
);

577 
	`luaG_ruÃ¼Ü
(
L
, "©‹m±Ø% ¨% v®ue", 
İ
, 
t
);

578 
	}
}

581 
	$luaG_cÚÿ‹¼Ü
 (
lua_S‹
 *
L
, 
StkId
 
p1
, StkId 
p2
) {

582 ià(
	`‰is¡ršg
(
p1
è|| 
	`‰i¢umb”
Õ1)èp1 = 
p2
;

583 
	`lua_as£¹
(!
	`‰is¡ršg
(
p1
è&& !
	`‰i¢umb”
(p1));

584 
	`luaG_ty³”rÜ
(
L
, 
p1
, "concatenate");

585 
	}
}

588 
	$luaG_¬™h”rÜ
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
p1
, cÚ¡ TV®u*
p2
) {

589 
TV®ue
 
‹mp
;

590 ià(
	`luaV_tÚumb”
(
p1
, &
‹mp
è=ğ
NULL
)

591 
p2
 = 
p1
;

592 
	`luaG_ty³”rÜ
(
L
, 
p2
, "perform‡rithmetic on");

593 
	}
}

596 
	$luaG_Üd””rÜ
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
p1
, cÚ¡ TV®u*
p2
) {

597 cÚ¡ *
t1
 = 
luaT_ty³Çmes
[
	`‰y³
(
p1
)];

598 cÚ¡ *
t2
 = 
luaT_ty³Çmes
[
	`‰y³
(
p2
)];

599 ià(
t1
[2] =ğ
t2
[2])

600 
	`luaG_ruÃ¼Ü
(
L
, "©‹m±Øcom·»wØ% v®ues", 
t1
);

602 
	`luaG_ruÃ¼Ü
(
L
, "©‹m±Øcom·» % w™h %s", 
t1
, 
t2
);

604 
	}
}

607 
	$addšfo
 (
lua_S‹
 *
L
, cÚ¡ *
msg
) {

608 
C®lInfo
 *
ci
 = 
L
->ci;

609 ià(
	`isLua
(
ci
)) {

610 
buff
[
LUA_IDSIZE
];

611 
lše
 = 
	`cu¼’še
(
L
, 
ci
);

612 
	`luaO_chunkid
(
buff
, 
	`g‘¡r
(
	`g‘lu­rÙo
(
ci
)->
sourû
), 
LUA_IDSIZE
);

613 
	`luaO_pushf¡ršg
(
L
, "%s:%d: %s", 
buff
, 
lše
, 
msg
);

615 
	}
}

618 
	$luaG_”rÜmsg
 (
lua_S‹
 *
L
) {

619 ià(
L
->
”rfunc
 != 0) {

620 
StkId
 
”rfunc
 = 
	`»¡Üe¡ack
(
L
, L->errfunc);

621 ià(!
	`‰isfunùiÚ
(
”rfunc
)è
	`luaD_throw
(
L
, 
LUA_ERRERR
);

622 
	`£tobjs2s
(
L
, L->
tİ
, L->top - 1);

623 
	`£tobjs2s
(
L
, L->
tİ
 - 1, 
”rfunc
);

624 
	`šü_tİ
(
L
);

625 
	`luaD_ÿÎ
(
L
, L->
tİ
 - 2, 1);

627 
	`luaD_throw
(
L
, 
LUA_ERRRUN
);

628 
	}
}

631 
	$luaG_ruÃ¼Ü
 (
lua_S‹
 *
L
, cÚ¡ *
fmt
, ...) {

632 
va_li¡
 
¬gp
;

633 
	`va_¡¬t
(
¬gp
, 
fmt
);

634 
	`addšfo
(
L
, 
	`luaO_pushvf¡ršg
(L, 
fmt
, 
¬gp
));

635 
	`va_’d
(
¬gp
);

636 
	`luaG_”rÜmsg
(
L
);

637 
	}
}

	@deps/lua/src/ldebug.h

7 #iâdeà
ldebug_h


8 
	#ldebug_h


	)

11 
	~"l¡©e.h
"

14 
	#pcR–
(
pc
, 
p
è(
	`ÿ¡
(, (pcè- (p)->
code
è- 1)

	)

16 
	#g‘lše
(
f
,
pc
è(((f)->
lšešfo
è? (f)->lšešfo[pc] : 0)

	)

18 
	#»£thookcouÁ
(
L
è(L->
hookcouÁ
 = L->
ba£hookcouÁ
)

	)

21 
LUAI_FUNC
 
luaG_ty³”rÜ
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
o
,

22 cÚ¡ *
İÇme
);

23 
LUAI_FUNC
 
luaG_cÚÿ‹¼Ü
 (
lua_S‹
 *
L
, 
StkId
 
p1
, StkId 
p2
);

24 
LUAI_FUNC
 
luaG_¬™h”rÜ
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
p1
,

25 cÚ¡ 
TV®ue
 *
p2
);

26 
LUAI_FUNC
 
luaG_Üd””rÜ
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
p1
,

27 cÚ¡ 
TV®ue
 *
p2
);

28 
LUAI_FUNC
 
luaG_ruÃ¼Ü
 (
lua_S‹
 *
L
, cÚ¡ *
fmt
, ...);

29 
LUAI_FUNC
 
luaG_”rÜmsg
 (
lua_S‹
 *
L
);

30 
LUAI_FUNC
 
luaG_checkcode
 (cÚ¡ 
PrÙo
 *
±
);

31 
LUAI_FUNC
 
luaG_checkİ’İ
 (
In¡ruùiÚ
 
i
);

	@deps/lua/src/ldo.c

8 
	~<£tjmp.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

12 
	#ldo_c


	)

13 
	#LUA_CORE


	)

15 
	~"lua.h
"

17 
	~"ldebug.h
"

18 
	~"ldo.h
"

19 
	~"lfunc.h
"

20 
	~"lgc.h
"

21 
	~"lmem.h
"

22 
	~"lobjeù.h
"

23 
	~"lİcodes.h
"

24 
	~"Í¬£r.h
"

25 
	~"l¡©e.h
"

26 
	~"l¡ršg.h
"

27 
	~"ÉabË.h
"

28 
	~"Ém.h
"

29 
	~"lundump.h
"

30 
	~"lvm.h
"

31 
	~"lzio.h
"

44 
	slua_lÚgjmp
 {

45 
lua_lÚgjmp
 *
	m´evious
;

46 
luai_jmpbuf
 
	mb
;

47 vŞ©
	m¡©us
;

51 
	$luaD_£‹¼Üobj
 (
lua_S‹
 *
L
, 
”rcode
, 
StkId
 
Şdtİ
) {

52 
”rcode
) {

53 
LUA_ERRMEM
: {

54 
	`£tsv®ue2s
(
L
, 
Şdtİ
, 
	`luaS_Ãwl™”®
(L, 
MEMERRMSG
));

57 
LUA_ERRERR
: {

58 
	`£tsv®ue2s
(
L
, 
Şdtİ
, 
	`luaS_Ãwl™”®
(L, "error inƒrror handling"));

61 
LUA_ERRSYNTAX
:

62 
LUA_ERRRUN
: {

63 
	`£tobjs2s
(
L
, 
Şdtİ
, L->
tİ
 - 1);

67 
L
->
tİ
 = 
Şdtİ
 + 1;

68 
	}
}

71 
	$»¡Üe_¡ack_lim™
 (
lua_S‹
 *
L
) {

72 
	`lua_as£¹
(
L
->
¡ack_Ï¡
 - L->
¡ack
 =ğL->
¡acksize
 - 
EXTRA_STACK
 - 1);

73 ià(
L
->
size_ci
 > 
LUAI_MAXCALLS
) {

74 
šu£
 = 
	`ÿ¡_št
(
L
->
ci
 - L->
ba£_ci
);

75 ià(
šu£
 + 1 < 
LUAI_MAXCALLS
)

76 
	`luaD_»®locCI
(
L
, 
LUAI_MAXCALLS
);

78 
	}
}

81 
	$»£t¡ack
 (
lua_S‹
 *
L
, 
¡©us
) {

82 
L
->
ci
 = L->
ba£_ci
;

83 
L
->
ba£
 = L->
ci
->base;

84 
	`luaF_şo£
(
L
, L->
ba£
);

85 
	`luaD_£‹¼Üobj
(
L
, 
¡©us
, L->
ba£
);

86 
L
->
nCÿÎs
 = L->
ba£CÿÎs
;

87 
L
->
®lowhook
 = 1;

88 
	`»¡Üe_¡ack_lim™
(
L
);

89 
L
->
”rfunc
 = 0;

90 
L
->
”rÜJmp
 = 
NULL
;

91 
	}
}

94 
	$luaD_throw
 (
lua_S‹
 *
L
, 
”rcode
) {

95 ià(
L
->
”rÜJmp
) {

96 
L
->
”rÜJmp
->
¡©us
 = 
”rcode
;

97 
	`LUAI_THROW
(
L
, L->
”rÜJmp
);

100 
L
->
¡©us
 = 
	`ÿ¡_by‹
(
”rcode
);

101 ià(
	`G
(
L
)->
·nic
) {

102 
	`»£t¡ack
(
L
, 
”rcode
);

103 
	`lua_uÆock
(
L
);

104 
	`G
(
L
)->
	`·nic
(L);

106 
	`ex™
(
EXIT_FAILURE
);

108 
	}
}

111 
	$luaD_¿wruÅrÙeùed
 (
lua_S‹
 *
L
, 
Pfunc
 
f
, *
ud
) {

112 
lua_lÚgjmp
 
lj
;

113 
lj
.
¡©us
 = 0;

114 
lj
.
´evious
 = 
L
->
”rÜJmp
;

115 
L
->
”rÜJmp
 = &
lj
;

116 
	`LUAI_TRY
(
L
, &
lj
,

117 (*
f
)(
L
, 
ud
);

119 
L
->
”rÜJmp
 = 
lj
.
´evious
;

120  
lj
.
¡©us
;

121 
	}
}

126 
	$cÜ»ù¡ack
 (
lua_S‹
 *
L
, 
TV®ue
 *
Şd¡ack
) {

127 
C®lInfo
 *
ci
;

128 
GCObjeù
 *
up
;

129 
L
->
tİ
 = (L->tİ - 
Şd¡ack
è+ L->
¡ack
;

130 
up
 = 
L
->
İ’upv®
; u°!ğ
NULL
; u°ğup->
gch
.
Ãxt
)

131 
	`gco2uv
(
up
)->
v
 = (gco2uv(up)->v - 
Şd¡ack
è+ 
L
->
¡ack
;

132 
ci
 = 
L
->
ba£_ci
; ci <= L->ci; ci++) {

133 
ci
->
tİ
 = (ci->tİ - 
Şd¡ack
è+ 
L
->
¡ack
;

134 
ci
->
ba£
 = (ci->ba£ - 
Şd¡ack
è+ 
L
->
¡ack
;

135 
ci
->
func
 = (ci->funø- 
Şd¡ack
è+ 
L
->
¡ack
;

137 
L
->
ba£
 = (L->ba£ - 
Şd¡ack
è+ L->
¡ack
;

138 
	}
}

141 
	$luaD_»®loc¡ack
 (
lua_S‹
 *
L
, 
Ãwsize
) {

142 
TV®ue
 *
Şd¡ack
 = 
L
->
¡ack
;

143 
»®size
 = 
Ãwsize
 + 1 + 
EXTRA_STACK
;

144 
	`lua_as£¹
(
L
->
¡ack_Ï¡
 - L->
¡ack
 =ğL->
¡acksize
 - 
EXTRA_STACK
 - 1);

145 
	`luaM_»®locveùÜ
(
L
, L->
¡ack
, L->
¡acksize
, 
»®size
, 
TV®ue
);

146 
L
->
¡acksize
 = 
»®size
;

147 
L
->
¡ack_Ï¡
 = L->
¡ack
+
Ãwsize
;

148 
	`cÜ»ù¡ack
(
L
, 
Şd¡ack
);

149 
	}
}

152 
	$luaD_»®locCI
 (
lua_S‹
 *
L
, 
Ãwsize
) {

153 
C®lInfo
 *
Şdci
 = 
L
->
ba£_ci
;

154 
	`luaM_»®locveùÜ
(
L
, L->
ba£_ci
, L->
size_ci
, 
Ãwsize
, 
C®lInfo
);

155 
L
->
size_ci
 = 
Ãwsize
;

156 
L
->
ci
 = (L->c˜- 
Şdci
è+ L->
ba£_ci
;

157 
L
->
’d_ci
 = L->
ba£_ci
 + L->
size_ci
 - 1;

158 
	}
}

161 
	$luaD_grow¡ack
 (
lua_S‹
 *
L
, 
n
) {

162 ià(
n
 <ğ
L
->
¡acksize
)

163 
	`luaD_»®loc¡ack
(
L
, 2*L->
¡acksize
);

165 
	`luaD_»®loc¡ack
(
L
, L->
¡acksize
 + 
n
);

166 
	}
}

169 
C®lInfo
 *
	$growCI
 (
lua_S‹
 *
L
) {

170 ià(
L
->
size_ci
 > 
LUAI_MAXCALLS
)

171 
	`luaD_throw
(
L
, 
LUA_ERRERR
);

173 
	`luaD_»®locCI
(
L
, 2*L->
size_ci
);

174 ià(
L
->
size_ci
 > 
LUAI_MAXCALLS
)

175 
	`luaG_ruÃ¼Ü
(
L
, "stack overflow");

177  ++
L
->
ci
;

178 
	}
}

181 
	$luaD_ÿÎhook
 (
lua_S‹
 *
L
, 
ev’t
, 
lše
) {

182 
lua_Hook
 
hook
 = 
L
->hook;

183 ià(
hook
 && 
L
->
®lowhook
) {

184 
±rdiff_t
 
tİ
 = 
	`§ve¡ack
(
L
, L->top);

185 
±rdiff_t
 
ci_tİ
 = 
	`§ve¡ack
(
L
, L->
ci
->
tİ
);

186 
lua_Debug
 
¬
;

187 
¬
.
ev’t
 =ƒvent;

188 
¬
.
cu¼’še
 = 
lše
;

189 ià(
ev’t
 =ğ
LUA_HOOKTAILRET
)

190 
¬
.
i_ci
 = 0;

192 
¬
.
i_ci
 = 
	`ÿ¡_št
(
L
->
ci
 - L->
ba£_ci
);

193 
	`luaD_check¡ack
(
L
, 
LUA_MINSTACK
);

194 
L
->
ci
->
tİ
 = L->tİ + 
LUA_MINSTACK
;

195 
	`lua_as£¹
(
L
->
ci
->
tİ
 <ğL->
¡ack_Ï¡
);

196 
L
->
®lowhook
 = 0;

197 
	`lua_uÆock
(
L
);

198 (*
hook
)(
L
, &
¬
);

199 
	`lua_lock
(
L
);

200 
	`lua_as£¹
(!
L
->
®lowhook
);

201 
L
->
®lowhook
 = 1;

202 
L
->
ci
->
tİ
 = 
	`»¡Üe¡ack
(L, 
ci_tİ
);

203 
L
->
tİ
 = 
	`»¡Üe¡ack
(L,op);

205 
	}
}

208 
StkId
 
	$adju¡_v¬¬gs
 (
lua_S‹
 *
L
, 
PrÙo
 *
p
, 
aùu®
) {

209 
i
;

210 
nfix¬gs
 = 
p
->
num·¿ms
;

211 
TabË
 *
hb
 = 
NULL
;

212 
StkId
 
ba£
, 
fixed
;

213 ; 
aùu®
 < 
nfix¬gs
; ++actual)

214 
	`£Šv®ue
(
L
->
tİ
++);

215 #ià
	`defšed
(
LUA_COMPAT_VARARG
)

216 ià(
p
->
is_v¬¬g
 & 
VARARG_NEEDSARG
) {

217 
nv¬
 = 
aùu®
 - 
nfix¬gs
;

218 
	`lua_as£¹
(
p
->
is_v¬¬g
 & 
VARARG_HASARG
);

219 
	`luaC_checkGC
(
L
);

220 
	`luaD_check¡ack
(
L
, 
p
->
max¡acksize
);

221 
hb
 = 
	`luaH_Ãw
(
L
, 
nv¬
, 1);

222 
i
=0; i<
nv¬
; i++)

223 
	`£tobj2n
(
L
, 
	`luaH_£Šum
(L, 
hb
, 
i
+1), L->
tİ
 - 
nv¬
 + i);

225 
	`£Šv®ue
(
	`luaH_£t¡r
(
L
, 
hb
, 
	`luaS_Ãwl™”®
(L, "n")), 
	`ÿ¡_num
(
nv¬
));

229 
fixed
 = 
L
->
tİ
 - 
aùu®
;

230 
ba£
 = 
L
->
tİ
;

231 
i
=0; i<
nfix¬gs
; i++) {

232 
	`£tobjs2s
(
L
, L->
tİ
++, 
fixed
+
i
);

233 
	`£Šv®ue
(
fixed
+
i
);

236 ià(
hb
) {

237 
	`£thv®ue
(
L
, L->
tİ
++, 
hb
);

238 
	`lua_as£¹
(
	`iswh™e
(
	`obj2gco
(
hb
)));

240  
ba£
;

241 
	}
}

244 
StkId
 
	$ŒyfuncTM
 (
lua_S‹
 *
L
, 
StkId
 
func
) {

245 cÚ¡ 
TV®ue
 *
tm
 = 
	`luaT_g‘tmbyobj
(
L
, 
func
, 
TM_CALL
);

246 
StkId
 
p
;

247 
±rdiff_t
 
funü
 = 
	`§ve¡ack
(
L
, 
func
);

248 ià(!
	`‰isfunùiÚ
(
tm
))

249 
	`luaG_ty³”rÜ
(
L
, 
func
, "call");

251 
p
 = 
L
->
tİ
;… > 
func
;…--è
	`£tobjs2s
(L,…,…-1);

252 
	`šü_tİ
(
L
);

253 
func
 = 
	`»¡Üe¡ack
(
L
, 
funü
);

254 
	`£tobj2s
(
L
, 
func
, 
tm
);

255  
func
;

256 
	}
}

260 
	#šc_ci
(
L
) \

261 ((
L
->
ci
 =ğL->
’d_ci
è? 
	`growCI
(L) : \

262 (
	`cÚdh¬d¡ack‹¡s
(
	`luaD_»®locCI
(
L
, L->
size_ci
)), ++L->
ci
))

	)

265 
	$luaD_´eÿÎ
 (
lua_S‹
 *
L
, 
StkId
 
func
, 
ÄesuÉs
) {

266 
LClosu»
 *
ş
;

267 
±rdiff_t
 
funü
;

268 ià(!
	`‰isfunùiÚ
(
func
))

269 
func
 = 
	`ŒyfuncTM
(
L
, func);

270 
funü
 = 
	`§ve¡ack
(
L
, 
func
);

271 
ş
 = &
	`şv®ue
(
func
)->
l
;

272 
L
->
ci
->
§vedpc
 = L->savedpc;

273 ià(!
ş
->
isC
) {

274 
C®lInfo
 *
ci
;

275 
StkId
 
¡
, 
ba£
;

276 
PrÙo
 *
p
 = 
ş
->p;

277 
	`luaD_check¡ack
(
L
, 
p
->
max¡acksize
);

278 
func
 = 
	`»¡Üe¡ack
(
L
, 
funü
);

279 ià(!
p
->
is_v¬¬g
) {

280 
ba£
 = 
func
 + 1;

281 ià(
L
->
tİ
 > 
ba£
 + 
p
->
num·¿ms
)

282 
L
->
tİ
 = 
ba£
 + 
p
->
num·¿ms
;

285 
Çrgs
 = 
	`ÿ¡_št
(
L
->
tİ
 - 
func
) - 1;

286 
ba£
 = 
	`adju¡_v¬¬gs
(
L
, 
p
, 
Çrgs
);

287 
func
 = 
	`»¡Üe¡ack
(
L
, 
funü
);

289 
ci
 = 
	`šc_ci
(
L
);

290 
ci
->
func
 = func;

291 
L
->
ba£
 = 
ci
->base = base;

292 
ci
->
tİ
 = 
L
->
ba£
 + 
p
->
max¡acksize
;

293 
	`lua_as£¹
(
ci
->
tİ
 <ğ
L
->
¡ack_Ï¡
);

294 
L
->
§vedpc
 = 
p
->
code
;

295 
ci
->
ÿÎs
 = 0;

296 
ci
->
ÄesuÉs
 =‚results;

297 
¡
 = 
L
->
tİ
; sˆ< 
ci
->top; st++)

298 
	`£Šv®ue
(
¡
);

299 
L
->
tİ
 = 
ci
->top;

300 ià(
L
->
hookmask
 & 
LUA_MASKCALL
) {

301 
L
->
§vedpc
++;

302 
	`luaD_ÿÎhook
(
L
, 
LUA_HOOKCALL
, -1);

303 
L
->
§vedpc
--;

305  
PCRLUA
;

308 
C®lInfo
 *
ci
;

309 
n
;

310 
	`luaD_check¡ack
(
L
, 
LUA_MINSTACK
);

311 
ci
 = 
	`šc_ci
(
L
);

312 
ci
->
func
 = 
	`»¡Üe¡ack
(
L
, 
funü
);

313 
L
->
ba£
 = 
ci
->ba£ = ci->
func
 + 1;

314 
ci
->
tİ
 = 
L
->tİ + 
LUA_MINSTACK
;

315 
	`lua_as£¹
(
ci
->
tİ
 <ğ
L
->
¡ack_Ï¡
);

316 
ci
->
ÄesuÉs
 =‚results;

317 ià(
L
->
hookmask
 & 
LUA_MASKCALL
)

318 
	`luaD_ÿÎhook
(
L
, 
LUA_HOOKCALL
, -1);

319 
	`lua_uÆock
(
L
);

320 
n
 = (*
	`cu¼_func
(
L
)->
c
.
f
)(L);

321 
	`lua_lock
(
L
);

322 ià(
n
 < 0)

323  
PCRYIELD
;

325 
	`luaD_posÿÎ
(
L
, L->
tİ
 - 
n
);

326  
PCRC
;

329 
	}
}

332 
StkId
 
	$ÿÎ»thooks
 (
lua_S‹
 *
L
, 
StkId
 
fœ¡ResuÉ
) {

333 
±rdiff_t
 
ä
 = 
	`§ve¡ack
(
L
, 
fœ¡ResuÉ
);

334 
	`luaD_ÿÎhook
(
L
, 
LUA_HOOKRET
, -1);

335 ià(
	`f_isLua
(
L
->
ci
)) {

336 (
L
->
hookmask
 & 
LUA_MASKRET
è&& L->
ci
->
ÿÎs
--)

337 
	`luaD_ÿÎhook
(
L
, 
LUA_HOOKTAILRET
, -1);

339  
	`»¡Üe¡ack
(
L
, 
ä
);

340 
	}
}

343 
	$luaD_posÿÎ
 (
lua_S‹
 *
L
, 
StkId
 
fœ¡ResuÉ
) {

344 
StkId
 
»s
;

345 
wª‹d
, 
i
;

346 
C®lInfo
 *
ci
;

347 ià(
L
->
hookmask
 & 
LUA_MASKRET
)

348 
fœ¡ResuÉ
 = 
	`ÿÎ»thooks
(
L
, firstResult);

349 
ci
 = 
L
->ci--;

350 
»s
 = 
ci
->
func
;

351 
wª‹d
 = 
ci
->
ÄesuÉs
;

352 
L
->
ba£
 = (
ci
 - 1)->base;

353 
L
->
§vedpc
 = (
ci
 - 1)->savedpc;

355 
i
 = 
wª‹d
; i !ğ0 && 
fœ¡ResuÉ
 < 
L
->
tİ
; i--)

356 
	`£tobjs2s
(
L
, 
»s
++, 
fœ¡ResuÉ
++);

357 
i
-- > 0)

358 
	`£Šv®ue
(
»s
++);

359 
L
->
tİ
 = 
»s
;

360  (
wª‹d
 - 
LUA_MULTRET
);

361 
	}
}

370 
	$luaD_ÿÎ
 (
lua_S‹
 *
L
, 
StkId
 
func
, 
nResuÉs
) {

371 ià(++
L
->
nCÿÎs
 >ğ
LUAI_MAXCCALLS
) {

372 ià(
L
->
nCÿÎs
 =ğ
LUAI_MAXCCALLS
)

373 
	`luaG_ruÃ¼Ü
(
L
, "C stack overflow");

374 ià(
L
->
nCÿÎs
 >ğ(
LUAI_MAXCCALLS
 + (LUAI_MAXCCALLS>>3)))

375 
	`luaD_throw
(
L
, 
LUA_ERRERR
);

377 ià(
	`luaD_´eÿÎ
(
L
, 
func
, 
nResuÉs
è=ğ
PCRLUA
)

378 
	`luaV_execu‹
(
L
, 1);

379 
L
->
nCÿÎs
--;

380 
	`luaC_checkGC
(
L
);

381 
	}
}

384 
	$»sume
 (
lua_S‹
 *
L
, *
ud
) {

385 
StkId
 
fœ¡Arg
 = 
	`ÿ¡
(StkId, 
ud
);

386 
C®lInfo
 *
ci
 = 
L
->ci;

387 ià(
L
->
¡©us
 == 0) {

388 
	`lua_as£¹
(
ci
 =ğ
L
->
ba£_ci
 && 
fœ¡Arg
 > L->
ba£
);

389 ià(
	`luaD_´eÿÎ
(
L
, 
fœ¡Arg
 - 1, 
LUA_MULTRET
è!ğ
PCRLUA
)

393 
	`lua_as£¹
(
L
->
¡©us
 =ğ
LUA_YIELD
);

394 
L
->
¡©us
 = 0;

395 ià(!
	`f_isLua
(
ci
)) {

397 
	`lua_as£¹
(
	`GET_OPCODE
(*((
ci
-1)->
§vedpc
 - 1)è=ğ
OP_CALL
 ||

398 
	`GET_OPCODE
(*((
ci
-1)->
§vedpc
 - 1)è=ğ
OP_TAILCALL
);

399 ià(
	`luaD_posÿÎ
(
L
, 
fœ¡Arg
))

400 
L
->
tİ
 = L->
ci
->top;

403 
L
->
ba£
 = L->
ci
->base;

405 
	`luaV_execu‹
(
L
, 
	`ÿ¡_št
(L->
ci
 - L->
ba£_ci
));

406 
	}
}

409 
	$»sume_”rÜ
 (
lua_S‹
 *
L
, cÚ¡ *
msg
) {

410 
L
->
tİ
 = L->
ci
->
ba£
;

411 
	`£tsv®ue2s
(
L
, L->
tİ
, 
	`luaS_Ãw
(L, 
msg
));

412 
	`šü_tİ
(
L
);

413 
	`lua_uÆock
(
L
);

414  
LUA_ERRRUN
;

415 
	}
}

418 
LUA_API
 
	$lua_»sume
 (
lua_S‹
 *
L
, 
Çrgs
) {

419 
¡©us
;

420 
	`lua_lock
(
L
);

421 ià(
L
->
¡©us
 !ğ
LUA_YIELD
 && (L->¡©u !ğ0 || L->
ci
 !ğL->
ba£_ci
))

422  
	`»sume_”rÜ
(
L
, "cannot„esume‚on-suspended coroutine");

423 ià(
L
->
nCÿÎs
 >ğ
LUAI_MAXCCALLS
)

424  
	`»sume_”rÜ
(
L
, "C stack overflow");

425 
	`luai_u£r¡©”esume
(
L
, 
Çrgs
);

426 
	`lua_as£¹
(
L
->
”rfunc
 == 0);

427 
L
->
ba£CÿÎs
 = ++L->
nCÿÎs
;

428 
¡©us
 = 
	`luaD_¿wruÅrÙeùed
(
L
, 
»sume
, L->
tİ
 - 
Çrgs
);

429 ià(
¡©us
 != 0) {

430 
L
->
¡©us
 = 
	`ÿ¡_by‹
(status);

431 
	`luaD_£‹¼Üobj
(
L
, 
¡©us
, L->
tİ
);

432 
L
->
ci
->
tİ
 = L->top;

435 
	`lua_as£¹
(
L
->
nCÿÎs
 =ğL->
ba£CÿÎs
);

436 
¡©us
 = 
L
->status;

438 --
L
->
nCÿÎs
;

439 
	`lua_uÆock
(
L
);

440  
¡©us
;

441 
	}
}

444 
LUA_API
 
	$lua_y›ld
 (
lua_S‹
 *
L
, 
ÄesuÉs
) {

445 
	`luai_u£r¡©ey›ld
(
L
, 
ÄesuÉs
);

446 
	`lua_lock
(
L
);

447 ià(
L
->
nCÿÎs
 > L->
ba£CÿÎs
)

448 
	`luaG_ruÃ¼Ü
(
L
, "attempto yield‡cross metamethod/C-call boundary");

449 
L
->
ba£
 = L->
tİ
 - 
ÄesuÉs
;

450 
L
->
¡©us
 = 
LUA_YIELD
;

451 
	`lua_uÆock
(
L
);

453 
	}
}

456 
	$luaD_pÿÎ
 (
lua_S‹
 *
L
, 
Pfunc
 
func
, *
u
,

457 
±rdiff_t
 
Şd_tİ
,…Œdiff_ˆ
ef
) {

458 
¡©us
;

459 
ŞdnCÿÎs
 = 
L
->
nCÿÎs
;

460 
±rdiff_t
 
Şd_ci
 = 
	`§veci
(
L
, L->
ci
);

461 
lu_by‹
 
Şd_®lowhooks
 = 
L
->
®lowhook
;

462 
±rdiff_t
 
Şd_”rfunc
 = 
L
->
”rfunc
;

463 
L
->
”rfunc
 = 
ef
;

464 
¡©us
 = 
	`luaD_¿wruÅrÙeùed
(
L
, 
func
, 
u
);

465 ià(
¡©us
 != 0) {

466 
StkId
 
Şdtİ
 = 
	`»¡Üe¡ack
(
L
, 
Şd_tİ
);

467 
	`luaF_şo£
(
L
, 
Şdtİ
);

468 
	`luaD_£‹¼Üobj
(
L
, 
¡©us
, 
Şdtİ
);

469 
L
->
nCÿÎs
 = 
ŞdnCÿÎs
;

470 
L
->
ci
 = 
	`»¡Üeci
(L, 
Şd_ci
);

471 
L
->
ba£
 = L->
ci
->base;

472 
L
->
§vedpc
 = L->
ci
->savedpc;

473 
L
->
®lowhook
 = 
Şd_®lowhooks
;

474 
	`»¡Üe_¡ack_lim™
(
L
);

476 
L
->
”rfunc
 = 
Şd_”rfunc
;

477  
¡©us
;

478 
	}
}

485 
	sSP¬£r
 {

486 
ZIO
 *
	mz
;

487 
Mbufãr
 
	mbuff
;

488 cÚ¡ *
	mÇme
;

491 
	$f_·r£r
 (
lua_S‹
 *
L
, *
ud
) {

492 
i
;

493 
PrÙo
 *
tf
;

494 
Closu»
 *
ş
;

495 
SP¬£r
 *
p
 = 
	`ÿ¡
(SP¬£¸*, 
ud
);

496 
c
 = 
	`luaZ_lookah—d
(
p
->
z
);

497 
	`luaC_checkGC
(
L
);

498 
tf
 = (
luaY_·r£r
)(
L
, 
p
->
z
,

499 &
p
->
buff
,…->
Çme
);

500 
ş
 = 
	`luaF_ÃwLşosu»
(
L
, 
tf
->
nups
, 
	`hv®ue
(
	`gt
(L)));

501 
ş
->
l
.
p
 = 
tf
;

502 
i
 = 0; i < 
tf
->
nups
; i++)

503 
ş
->
l
.
upv®s
[
i
] = 
	`luaF_Ãwupv®
(
L
);

504 
	`£tşv®ue
(
L
, L->
tİ
, 
ş
);

505 
	`šü_tİ
(
L
);

506 
	}
}

509 
	$luaD_´Ùeùed·r£r
 (
lua_S‹
 *
L
, 
ZIO
 *
z
, cÚ¡ *
Çme
) {

510 
SP¬£r
 
p
;

511 
¡©us
;

512 
p
.
z
 = z;….
Çme
 =‚ame;

513 
	`luaZ_š™bufãr
(
L
, &
p
.
buff
);

514 
¡©us
 = 
	`luaD_pÿÎ
(
L
, 
f_·r£r
, &
p
, 
	`§ve¡ack
(L, L->
tİ
), L->
”rfunc
);

515 
	`luaZ_ä“bufãr
(
L
, &
p
.
buff
);

516  
¡©us
;

517 
	}
}

	@deps/lua/src/ldo.h

7 #iâdeà
ldo_h


8 
	#ldo_h


	)

11 
	~"lobjeù.h
"

12 
	~"l¡©e.h
"

13 
	~"lzio.h
"

16 
	#luaD_check¡ack
(
L
,
n
) \

17 ià((*)
L
->
¡ack_Ï¡
 - (*)L->
tİ
 <ğ(
n
)*()(
TV®ue
)) \

18 
	`luaD_grow¡ack
(
L
, 
n
); \

19 
	`cÚdh¬d¡ack‹¡s
(
	`luaD_»®loc¡ack
(
L
, L->
¡acksize
 - 
EXTRA_STACK
 - 1));

	)

22 
	#šü_tİ
(
L
è{
	`luaD_check¡ack
(L,1); L->
tİ
++;}

	)

24 
	#§ve¡ack
(
L
,
p
è((*)Õè- (*)L->
¡ack
)

	)

25 
	#»¡Üe¡ack
(
L
,
n
è((
TV®ue
 *)((*)L->
¡ack
 + (n)))

	)

27 
	#§veci
(
L
,
p
è((*)Õè- (*)L->
ba£_ci
)

	)

28 
	#»¡Üeci
(
L
,
n
è((
C®lInfo
 *)((*)L->
ba£_ci
 + (n)))

	)

32 
	#PCRLUA
 0

	)

33 
	#PCRC
 1

	)

34 
	#PCRYIELD
 2

	)

38 (*
	tPfunc
è(
	tlua_S‹
 *
	tL
, *
	tud
);

40 
LUAI_FUNC
 
	`luaD_´Ùeùed·r£r
 (
lua_S‹
 *
L
, 
ZIO
 *
z
, cÚ¡ *
Çme
);

41 
LUAI_FUNC
 
	`luaD_ÿÎhook
 (
lua_S‹
 *
L
, 
ev’t
, 
lše
);

42 
LUAI_FUNC
 
	`luaD_´eÿÎ
 (
lua_S‹
 *
L
, 
StkId
 
func
, 
ÄesuÉs
);

43 
LUAI_FUNC
 
	`luaD_ÿÎ
 (
lua_S‹
 *
L
, 
StkId
 
func
, 
nResuÉs
);

44 
LUAI_FUNC
 
	`luaD_pÿÎ
 (
lua_S‹
 *
L
, 
Pfunc
 
func
, *
u
,

45 
±rdiff_t
 
Şdtİ
,…Œdiff_ˆ
ef
);

46 
LUAI_FUNC
 
	`luaD_posÿÎ
 (
lua_S‹
 *
L
, 
StkId
 
fœ¡ResuÉ
);

47 
LUAI_FUNC
 
	`luaD_»®locCI
 (
lua_S‹
 *
L
, 
Ãwsize
);

48 
LUAI_FUNC
 
	`luaD_»®loc¡ack
 (
lua_S‹
 *
L
, 
Ãwsize
);

49 
LUAI_FUNC
 
	`luaD_grow¡ack
 (
lua_S‹
 *
L
, 
n
);

51 
LUAI_FUNC
 
	`luaD_throw
 (
lua_S‹
 *
L
, 
”rcode
);

52 
LUAI_FUNC
 
	`luaD_¿wruÅrÙeùed
 (
lua_S‹
 *
L
, 
Pfunc
 
f
, *
ud
);

54 
LUAI_FUNC
 
	`luaD_£‹¼Üobj
 (
lua_S‹
 *
L
, 
”rcode
, 
StkId
 
Şdtİ
);

	@deps/lua/src/ldump.c

7 
	~<¡ddef.h
>

9 
	#ldump_c


	)

10 
	#LUA_CORE


	)

12 
	~"lua.h
"

14 
	~"lobjeù.h
"

15 
	~"l¡©e.h
"

16 
	~"lundump.h
"

19 
lua_S‹
* 
	mL
;

20 
lua_Wr™”
 
	mwr™”
;

21 * 
	md©a
;

22 
	m¡r
;

23 
	m¡©us
;

24 } 
	tDumpS‹
;

26 
	#DumpMem
(
b
,
n
,
size
,
D
è
	`DumpBlock
(b,Ò)*(size),D)

	)

27 
	#DumpV¬
(
x
,
D
è
	`DumpMem
(&x,1,(x),D)

	)

29 
	$DumpBlock
(cÚ¡ * 
b
, 
size_t
 
size
, 
DumpS‹
* 
D
)

31 ià(
D
->
¡©us
==0)

33 
	`lua_uÆock
(
D
->
L
);

34 
D
->
¡©us
=(*D->
wr™”
)(D->
L
,
b
,
size
,D->
d©a
);

35 
	`lua_lock
(
D
->
L
);

37 
	}
}

39 
	$DumpCh¬
(
y
, 
DumpS‹
* 
D
)

41 
x
=()
y
;

42 
	`DumpV¬
(
x
,
D
);

43 
	}
}

45 
	$DumpIÁ
(
x
, 
DumpS‹
* 
D
)

47 
	`DumpV¬
(
x
,
D
);

48 
	}
}

50 
	$DumpNumb”
(
lua_Numb”
 
x
, 
DumpS‹
* 
D
)

52 
	`DumpV¬
(
x
,
D
);

53 
	}
}

55 
	$DumpVeùÜ
(cÚ¡ * 
b
, 
n
, 
size_t
 
size
, 
DumpS‹
* 
D
)

57 
	`DumpIÁ
(
n
,
D
);

58 
	`DumpMem
(
b
,
n
,
size
,
D
);

59 
	}
}

61 
	$DumpSŒšg
(cÚ¡ 
TSŒšg
* 
s
, 
DumpS‹
* 
D
)

63 ià(
s
==
NULL
 || 
	`g‘¡r
(s)==NULL)

65 
size_t
 
size
=0;

66 
	`DumpV¬
(
size
,
D
);

70 
size_t
 
size
=
s
->
tsv
.
Ën
+1;

71 
	`DumpV¬
(
size
,
D
);

72 
	`DumpBlock
(
	`g‘¡r
(
s
),
size
,
D
);

74 
	}
}

76 
	#DumpCode
(
f
,
D
è
	`DumpVeùÜ
(f->
code
,f->
sizecode
,(
In¡ruùiÚ
),D)

	)

78 
DumpFunùiÚ
(cÚ¡ 
PrÙo
* 
f
, cÚ¡ 
TSŒšg
* 
p
, 
DumpS‹
* 
D
);

80 
	$DumpCÚ¡ªts
(cÚ¡ 
PrÙo
* 
f
, 
DumpS‹
* 
D
)

82 
i
,
n
=
f
->
sizek
;

83 
	`DumpIÁ
(
n
,
D
);

84 
i
=0; i<
n
; i++)

86 cÚ¡ 
TV®ue
* 
o
=&
f
->
k
[
i
];

87 
	`DumpCh¬
(
	`‰y³
(
o
),
D
);

88 
	`‰y³
(
o
))

90 
LUA_TNIL
:

92 
LUA_TBOOLEAN
:

93 
	`DumpCh¬
(
	`bv®ue
(
o
),
D
);

95 
LUA_TNUMBER
:

96 
	`DumpNumb”
(
	`nv®ue
(
o
),
D
);

98 
LUA_TSTRING
:

99 
	`DumpSŒšg
(
	`¿wtsv®ue
(
o
),
D
);

102 
	`lua_as£¹
(0);

106 
n
=
f
->
siz•
;

107 
	`DumpIÁ
(
n
,
D
);

108 
i
=0; i<
n
; i++è
	`DumpFunùiÚ
(
f
->
p
[i],f->
sourû
,
D
);

109 
	}
}

111 
	$DumpDebug
(cÚ¡ 
PrÙo
* 
f
, 
DumpS‹
* 
D
)

113 
i
,
n
;

114 
n
ğ(
D
->
¡r
è? 0 : 
f
->
siz–šešfo
;

115 
	`DumpVeùÜ
(
f
->
lšešfo
,
n
,(),
D
);

116 
n
ğ(
D
->
¡r
è? 0 : 
f
->
siz–ocv¬s
;

117 
	`DumpIÁ
(
n
,
D
);

118 
i
=0; i<
n
; i++)

120 
	`DumpSŒšg
(
f
->
locv¬s
[
i
].
v¬Çme
,
D
);

121 
	`DumpIÁ
(
f
->
locv¬s
[
i
].
¡¬c
,
D
);

122 
	`DumpIÁ
(
f
->
locv¬s
[
i
].
’dpc
,
D
);

124 
n
ğ(
D
->
¡r
è? 0 : 
f
->
sizeupv®ues
;

125 
	`DumpIÁ
(
n
,
D
);

126 
i
=0; i<
n
; i++è
	`DumpSŒšg
(
f
->
upv®ues
[i],
D
);

127 
	}
}

129 
	$DumpFunùiÚ
(cÚ¡ 
PrÙo
* 
f
, cÚ¡ 
TSŒšg
* 
p
, 
DumpS‹
* 
D
)

131 
	`DumpSŒšg
((
f
->
sourû
==
p
 || 
D
->
¡r
è? 
NULL
 : f->source,D);

132 
	`DumpIÁ
(
f
->
lšedefšed
,
D
);

133 
	`DumpIÁ
(
f
->
Ï¡lšedefšed
,
D
);

134 
	`DumpCh¬
(
f
->
nups
,
D
);

135 
	`DumpCh¬
(
f
->
num·¿ms
,
D
);

136 
	`DumpCh¬
(
f
->
is_v¬¬g
,
D
);

137 
	`DumpCh¬
(
f
->
max¡acksize
,
D
);

138 
	`DumpCode
(
f
,
D
);

139 
	`DumpCÚ¡ªts
(
f
,
D
);

140 
	`DumpDebug
(
f
,
D
);

141 
	}
}

143 
	$DumpH—d”
(
DumpS‹
* 
D
)

145 
h
[
LUAC_HEADERSIZE
];

146 
	`luaU_h—d”
(
h
);

147 
	`DumpBlock
(
h
,
LUAC_HEADERSIZE
,
D
);

148 
	}
}

153 
	$luaU_dump
 (
lua_S‹
* 
L
, cÚ¡ 
PrÙo
* 
f
, 
lua_Wr™”
 
w
, * 
d©a
, 
¡r
)

155 
DumpS‹
 
D
;

156 
D
.
L
=L;

157 
D
.
wr™”
=
w
;

158 
D
.
d©a
=data;

159 
D
.
¡r
=strip;

160 
D
.
¡©us
=0;

161 
	`DumpH—d”
(&
D
);

162 
	`DumpFunùiÚ
(
f
,
NULL
,&
D
);

163  
D
.
¡©us
;

164 
	}
}

	@deps/lua/src/lfunc.c

8 
	~<¡ddef.h
>

10 
	#lfunc_c


	)

11 
	#LUA_CORE


	)

13 
	~"lua.h
"

15 
	~"lfunc.h
"

16 
	~"lgc.h
"

17 
	~"lmem.h
"

18 
	~"lobjeù.h
"

19 
	~"l¡©e.h
"

23 
Closu»
 *
	$luaF_ÃwCşosu»
 (
lua_S‹
 *
L
, 
ÃËms
, 
TabË
 *
e
) {

24 
Closu»
 *
c
 = 
	`ÿ¡
(Closu» *, 
	`luaM_m®loc
(
L
, 
	`sizeCşosu»
(
ÃËms
)));

25 
	`luaC_lšk
(
L
, 
	`obj2gco
(
c
), 
LUA_TFUNCTION
);

26 
c
->c.
isC
 = 1;

27 
c
->c.
’v
 = 
e
;

28 
c
->c.
nupv®ues
 = 
	`ÿ¡_by‹
(
ÃËms
);

29  
c
;

30 
	}
}

33 
Closu»
 *
	$luaF_ÃwLşosu»
 (
lua_S‹
 *
L
, 
ÃËms
, 
TabË
 *
e
) {

34 
Closu»
 *
c
 = 
	`ÿ¡
(Closu» *, 
	`luaM_m®loc
(
L
, 
	`sizeLşosu»
(
ÃËms
)));

35 
	`luaC_lšk
(
L
, 
	`obj2gco
(
c
), 
LUA_TFUNCTION
);

36 
c
->
l
.
isC
 = 0;

37 
c
->
l
.
’v
 = 
e
;

38 
c
->
l
.
nupv®ues
 = 
	`ÿ¡_by‹
(
ÃËms
);

39 
ÃËms
--è
c
->
l
.
upv®s
[ÃËms] = 
NULL
;

40  
c
;

41 
	}
}

44 
UpV®
 *
	$luaF_Ãwupv®
 (
lua_S‹
 *
L
) {

45 
UpV®
 *
uv
 = 
	`luaM_Ãw
(
L
, UpVal);

46 
	`luaC_lšk
(
L
, 
	`obj2gco
(
uv
), 
LUA_TUPVAL
);

47 
uv
->
v
 = &uv->
u
.
v®ue
;

48 
	`£Šv®ue
(
uv
->
v
);

49  
uv
;

50 
	}
}

53 
UpV®
 *
	$luaF_fšdupv®
 (
lua_S‹
 *
L
, 
StkId
 
Ëv–
) {

54 
glob®_S‹
 *
g
 = 
	`G
(
L
);

55 
GCObjeù
 **
µ
 = &
L
->
İ’upv®
;

56 
UpV®
 *
p
;

57 
UpV®
 *
uv
;

58 *
µ
 !ğ
NULL
 && (
p
 = 
	`ngcÙouv
(*µ))->
v
 >ğ
Ëv–
) {

59 
	`lua_as£¹
(
p
->
v
 !ğ&p->
u
.
v®ue
);

60 ià(
p
->
v
 =ğ
Ëv–
) {

61 ià(
	`isd—d
(
g
, 
	`obj2gco
(
p
)))

62 
	`chªgewh™e
(
	`obj2gco
(
p
));

63  
p
;

65 
µ
 = &
p
->
Ãxt
;

67 
uv
 = 
	`luaM_Ãw
(
L
, 
UpV®
);

68 
uv
->
‰
 = 
LUA_TUPVAL
;

69 
uv
->
m¬ked
 = 
	`luaC_wh™e
(
g
);

70 
uv
->
v
 = 
Ëv–
;

71 
uv
->
Ãxt
 = *
µ
;

72 *
µ
 = 
	`obj2gco
(
uv
);

73 
uv
->
u
.
l
.
´ev
 = &
g
->
uvh—d
;

74 
uv
->
u
.
l
.
Ãxt
 = 
g
->
uvh—d
.u.l.next;

75 
uv
->
u
.
l
.
Ãxt
->u.l.
´ev
 = uv;

76 
g
->
uvh—d
.
u
.
l
.
Ãxt
 = 
uv
;

77 
	`lua_as£¹
(
uv
->
u
.
l
.
Ãxt
->u.l.
´ev
 == uv && uv->u.l.prev->u.l.next == uv);

78  
uv
;

79 
	}
}

82 
	$uÆškupv®
 (
UpV®
 *
uv
) {

83 
	`lua_as£¹
(
uv
->
u
.
l
.
Ãxt
->u.l.
´ev
 == uv && uv->u.l.prev->u.l.next == uv);

84 
uv
->
u
.
l
.
Ãxt
->u.l.
´ev
 = uv->u.l.prev;

85 
uv
->
u
.
l
.
´ev
->u.l.
Ãxt
 = uv->u.l.next;

86 
	}
}

89 
	$luaF_ä“upv®
 (
lua_S‹
 *
L
, 
UpV®
 *
uv
) {

90 ià(
uv
->
v
 !ğ&uv->
u
.
v®ue
)

91 
	`uÆškupv®
(
uv
);

92 
	`luaM_ä“
(
L
, 
uv
);

93 
	}
}

96 
	$luaF_şo£
 (
lua_S‹
 *
L
, 
StkId
 
Ëv–
) {

97 
UpV®
 *
uv
;

98 
glob®_S‹
 *
g
 = 
	`G
(
L
);

99 
L
->
İ’upv®
 !ğ
NULL
 && (
uv
 = 
	`ngcÙouv
(L->İ’upv®))->
v
 >ğ
Ëv–
) {

100 
GCObjeù
 *
o
 = 
	`obj2gco
(
uv
);

101 
	`lua_as£¹
(!
	`isbÏck
(
o
è&& 
uv
->
v
 !ğ&uv->
u
.
v®ue
);

102 
L
->
İ’upv®
 = 
uv
->
Ãxt
;

103 ià(
	`isd—d
(
g
, 
o
))

104 
	`luaF_ä“upv®
(
L
, 
uv
);

106 
	`uÆškupv®
(
uv
);

107 
	`£tobj
(
L
, &
uv
->
u
.
v®ue
, uv->
v
);

108 
uv
->
v
 = &uv->
u
.
v®ue
;

109 
	`luaC_lškupv®
(
L
, 
uv
);

112 
	}
}

115 
PrÙo
 *
	$luaF_Ãw´Ùo
 (
lua_S‹
 *
L
) {

116 
PrÙo
 *
f
 = 
	`luaM_Ãw
(
L
, Proto);

117 
	`luaC_lšk
(
L
, 
	`obj2gco
(
f
), 
LUA_TPROTO
);

118 
f
->
k
 = 
NULL
;

119 
f
->
sizek
 = 0;

120 
f
->
p
 = 
NULL
;

121 
f
->
siz•
 = 0;

122 
f
->
code
 = 
NULL
;

123 
f
->
sizecode
 = 0;

124 
f
->
siz–šešfo
 = 0;

125 
f
->
sizeupv®ues
 = 0;

126 
f
->
nups
 = 0;

127 
f
->
upv®ues
 = 
NULL
;

128 
f
->
num·¿ms
 = 0;

129 
f
->
is_v¬¬g
 = 0;

130 
f
->
max¡acksize
 = 0;

131 
f
->
lšešfo
 = 
NULL
;

132 
f
->
siz–ocv¬s
 = 0;

133 
f
->
locv¬s
 = 
NULL
;

134 
f
->
lšedefšed
 = 0;

135 
f
->
Ï¡lšedefšed
 = 0;

136 
f
->
sourû
 = 
NULL
;

137  
f
;

138 
	}
}

141 
	$luaF_ä“´Ùo
 (
lua_S‹
 *
L
, 
PrÙo
 *
f
) {

142 
	`luaM_ä“¬¿y
(
L
, 
f
->
code
, f->
sizecode
, 
In¡ruùiÚ
);

143 
	`luaM_ä“¬¿y
(
L
, 
f
->
p
, f->
siz•
, 
PrÙo
 *);

144 
	`luaM_ä“¬¿y
(
L
, 
f
->
k
, f->
sizek
, 
TV®ue
);

145 
	`luaM_ä“¬¿y
(
L
, 
f
->
lšešfo
, f->
siz–šešfo
, );

146 
	`luaM_ä“¬¿y
(
L
, 
f
->
locv¬s
, f->
siz–ocv¬s
, 
LocV¬
);

147 
	`luaM_ä“¬¿y
(
L
, 
f
->
upv®ues
, f->
sizeupv®ues
, 
TSŒšg
 *);

148 
	`luaM_ä“
(
L
, 
f
);

149 
	}
}

152 
	$luaF_ä“şosu»
 (
lua_S‹
 *
L
, 
Closu»
 *
c
) {

153 
size
 = (
c
->c.
isC
è? 
	`sizeCşosu»
(c->c.
nupv®ues
) :

154 
	`sizeLşosu»
(
c
->
l
.
nupv®ues
);

155 
	`luaM_ä“mem
(
L
, 
c
, 
size
);

156 
	}
}

163 cÚ¡ *
	$luaF_g‘loÿÊame
 (cÚ¡ 
PrÙo
 *
f
, 
loÿl_numb”
, 
pc
) {

164 
i
;

165 
i
 = 0; i<
f
->
siz–ocv¬s
 && f->
locv¬s
[i].
¡¬c
 <ğ
pc
; i++) {

166 ià(
pc
 < 
f
->
locv¬s
[
i
].
’dpc
) {

167 
loÿl_numb”
--;

168 ià(
loÿl_numb”
 == 0)

169  
	`g‘¡r
(
f
->
locv¬s
[
i
].
v¬Çme
);

172  
NULL
;

173 
	}
}

	@deps/lua/src/lfunc.h

7 #iâdeà
lfunc_h


8 
	#lfunc_h


	)

11 
	~"lobjeù.h
"

14 
	#sizeCşosu»
(
n
è(
	`ÿ¡
(, (
CClosu»
)) + \

15 
	`ÿ¡
(, (
TV®ue
)*((
n
)-1)))

	)

17 
	#sizeLşosu»
(
n
è(
	`ÿ¡
(, (
LClosu»
)) + \

18 
	`ÿ¡
(, (
TV®ue
 *)*((
n
)-1)))

	)

21 
LUAI_FUNC
 
PrÙo
 *
luaF_Ãw´Ùo
 (
lua_S‹
 *
L
);

22 
LUAI_FUNC
 
Closu»
 *
luaF_ÃwCşosu»
 (
lua_S‹
 *
L
, 
ÃËms
, 
TabË
 *
e
);

23 
LUAI_FUNC
 
Closu»
 *
luaF_ÃwLşosu»
 (
lua_S‹
 *
L
, 
ÃËms
, 
TabË
 *
e
);

24 
LUAI_FUNC
 
UpV®
 *
luaF_Ãwupv®
 (
lua_S‹
 *
L
);

25 
LUAI_FUNC
 
UpV®
 *
luaF_fšdupv®
 (
lua_S‹
 *
L
, 
StkId
 
Ëv–
);

26 
LUAI_FUNC
 
luaF_şo£
 (
lua_S‹
 *
L
, 
StkId
 
Ëv–
);

27 
LUAI_FUNC
 
luaF_ä“´Ùo
 (
lua_S‹
 *
L
, 
PrÙo
 *
f
);

28 
LUAI_FUNC
 
luaF_ä“şosu»
 (
lua_S‹
 *
L
, 
Closu»
 *
c
);

29 
LUAI_FUNC
 
luaF_ä“upv®
 (
lua_S‹
 *
L
, 
UpV®
 *
uv
);

30 
LUAI_FUNC
 cÚ¡ *
luaF_g‘loÿÊame
 (cÚ¡ 
PrÙo
 *
func
, 
loÿl_numb”
,

31 
pc
);

	@deps/lua/src/lgc.c

7 
	~<¡ršg.h
>

9 
	#lgc_c


	)

10 
	#LUA_CORE


	)

12 
	~"lua.h
"

14 
	~"ldebug.h
"

15 
	~"ldo.h
"

16 
	~"lfunc.h
"

17 
	~"lgc.h
"

18 
	~"lmem.h
"

19 
	~"lobjeù.h
"

20 
	~"l¡©e.h
"

21 
	~"l¡ršg.h
"

22 
	~"ÉabË.h
"

23 
	~"Ém.h
"

26 
	#GCSTEPSIZE
 1024u

	)

27 
	#GCSWEEPMAX
 40

	)

28 
	#GCSWEEPCOST
 10

	)

29 
	#GCFINALIZECOST
 100

	)

32 
	#maskm¬ks
 
	`ÿ¡_by‹
(~(
	`b™mask
(
BLACKBIT
)|
WHITEBITS
))

	)

34 
	#makewh™e
(
g
,
x
) \

35 ((
x
)->
gch
.
m¬ked
 = 
	`ÿ¡_by‹
(((x)->gch.m¬ked & 
maskm¬ks
è| 
	`luaC_wh™e
(
g
)))

	)

37 
	#wh™e2g¿y
(
x
è
	`»£t2b™s
((x)->
gch
.
m¬ked
, 
WHITE0BIT
, 
WHITE1BIT
)

	)

38 
	#bÏck2g¿y
(
x
è
	`»£tb™
((x)->
gch
.
m¬ked
, 
BLACKBIT
)

	)

40 
	#¡ršgm¬k
(
s
è
	`»£t2b™s
((s)->
tsv
.
m¬ked
, 
WHITE0BIT
, 
WHITE1BIT
)

	)

43 
	#isfš®ized
(
u
è
	`‹¡b™
((u)->
m¬ked
, 
FINALIZEDBIT
)

	)

44 
	#m¬kfš®ized
(
u
è
	`l_£tb™
((u)->
m¬ked
, 
FINALIZEDBIT
)

	)

47 
	#KEYWEAK
 
	`b™mask
(
KEYWEAKBIT
)

	)

48 
	#VALUEWEAK
 
	`b™mask
(
VALUEWEAKBIT
)

	)

52 
	#m¬kv®ue
(
g
,
o
è{ 
	`checkcÚsi¡’cy
(o); \

53 ià(
	`iscŞËùabË
(
o
è&& 
	`iswh™e
(
	`gcv®ue
(o))è
	`»®lym¬kobjeù
(
g
,gcv®ue(o)); }

	)

55 
	#m¬kobjeù
(
g
,
t
è{ ià(
	`iswh™e
(
	`obj2gco
(t))) \

56 
	`»®lym¬kobjeù
(
g
, 
	`obj2gco
(
t
)); }

	)

59 
	#£‰h»shŞd
(
g
è(g->
GCth»shŞd
 = (g->
e¡im©e
/100è* g->
gıau£
)

	)

62 
	$»mov“Áry
 (
Node
 *
n
) {

63 
	`lua_as£¹
(
	`‰i¢
(
	`gv®
(
n
)));

64 ià(
	`iscŞËùabË
(
	`gkey
(
n
)))

65 
	`£‰ty³
(
	`gkey
(
n
), 
LUA_TDEADKEY
);

66 
	}
}

69 
	$»®lym¬kobjeù
 (
glob®_S‹
 *
g
, 
GCObjeù
 *
o
) {

70 
	`lua_as£¹
(
	`iswh™e
(
o
è&& !
	`isd—d
(
g
, o));

71 
	`wh™e2g¿y
(
o
);

72 
o
->
gch
.
‰
) {

73 
LUA_TSTRING
: {

76 
LUA_TUSERDATA
: {

77 
TabË
 *
mt
 = 
	`gco2u
(
o
)->
m‘©abË
;

78 
	`g¿y2bÏck
(
o
);

79 ià(
mt
è
	`m¬kobjeù
(
g
, mt);

80 
	`m¬kobjeù
(
g
, 
	`gco2u
(
o
)->
’v
);

83 
LUA_TUPVAL
: {

84 
UpV®
 *
uv
 = 
	`gco2uv
(
o
);

85 
	`m¬kv®ue
(
g
, 
uv
->
v
);

86 ià(
uv
->
v
 =ğ&uv->
u
.
v®ue
)

87 
	`g¿y2bÏck
(
o
);

90 
LUA_TFUNCTION
: {

91 
	`gco2ş
(
o
)->
c
.
gşi¡
 = 
g
->
g¿y
;

92 
g
->
g¿y
 = 
o
;

95 
LUA_TTABLE
: {

96 
	`gco2h
(
o
)->
gşi¡
 = 
g
->
g¿y
;

97 
g
->
g¿y
 = 
o
;

100 
LUA_TTHREAD
: {

101 
	`gco2th
(
o
)->
gşi¡
 = 
g
->
g¿y
;

102 
g
->
g¿y
 = 
o
;

105 
LUA_TPROTO
: {

106 
	`gco2p
(
o
)->
gşi¡
 = 
g
->
g¿y
;

107 
g
->
g¿y
 = 
o
;

110 : 
	`lua_as£¹
(0);

112 
	}
}

115 
	$m¬ktmu
 (
glob®_S‹
 *
g
) {

116 
GCObjeù
 *
u
 = 
g
->
tmud©a
;

117 ià(
u
) {

119 
u
 = u->
gch
.
Ãxt
;

120 
	`makewh™e
(
g
, 
u
);

121 
	`»®lym¬kobjeù
(
g
, 
u
);

122 } 
u
 !ğ
g
->
tmud©a
);

124 
	}
}

128 
size_t
 
	$luaC_£·¿‹ud©a
 (
lua_S‹
 *
L
, 
®l
) {

129 
glob®_S‹
 *
g
 = 
	`G
(
L
);

130 
size_t
 
d—dmem
 = 0;

131 
GCObjeù
 **
p
 = &
g
->
mašth»ad
->
Ãxt
;

132 
GCObjeù
 *
cu¼
;

133 (
cu¼
 = *
p
è!ğ
NULL
) {

134 ià(!(
	`iswh™e
(
cu¼
è|| 
®l
è|| 
	`isfš®ized
(
	`gco2u
(curr)))

135 
p
 = &
cu¼
->
gch
.
Ãxt
;

136 ià(
	`ç¡tm
(
L
, 
	`gco2u
(
cu¼
)->
m‘©abË
, 
TM_GC
è=ğ
NULL
) {

137 
	`m¬kfš®ized
(
	`gco2u
(
cu¼
));

138 
p
 = &
cu¼
->
gch
.
Ãxt
;

141 
d—dmem
 +ğ
	`sizeud©a
(
	`gco2u
(
cu¼
));

142 
	`m¬kfš®ized
(
	`gco2u
(
cu¼
));

143 *
p
 = 
cu¼
->
gch
.
Ãxt
;

145 ià(
g
->
tmud©a
 =ğ
NULL
)

146 
g
->
tmud©a
 = 
cu¼
->
gch
.
Ãxt
 = curr;

148 
cu¼
->
gch
.
Ãxt
 = 
g
->
tmud©a
->gch.next;

149 
g
->
tmud©a
->
gch
.
Ãxt
 = 
cu¼
;

150 
g
->
tmud©a
 = 
cu¼
;

154  
d—dmem
;

155 
	}
}

158 
	$Œav”£bË
 (
glob®_S‹
 *
g
, 
TabË
 *
h
) {

159 
i
;

160 
w—kkey
 = 0;

161 
w—kv®ue
 = 0;

162 cÚ¡ 
TV®ue
 *
mode
;

163 ià(
h
->
m‘©abË
)

164 
	`m¬kobjeù
(
g
, 
h
->
m‘©abË
);

165 
mode
 = 
	`gç¡tm
(
g
, 
h
->
m‘©abË
, 
TM_MODE
);

166 ià(
mode
 && 
	`‰is¡ršg
(mode)) {

167 
w—kkey
 = (
	`¡rchr
(
	`sv®ue
(
mode
), 'k'è!ğ
NULL
);

168 
w—kv®ue
 = (
	`¡rchr
(
	`sv®ue
(
mode
), 'v'è!ğ
NULL
);

169 ià(
w—kkey
 || 
w—kv®ue
) {

170 
h
->
m¬ked
 &ğ~(
KEYWEAK
 | 
VALUEWEAK
);

171 
h
->
m¬ked
 |ğ
	`ÿ¡_by‹
((
w—kkey
 << 
KEYWEAKBIT
) |

172 (
w—kv®ue
 << 
VALUEWEAKBIT
));

173 
h
->
gşi¡
 = 
g
->
w—k
;

174 
g
->
w—k
 = 
	`obj2gco
(
h
);

177 ià(
w—kkey
 && 
w—kv®ue
)  1;

178 ià(!
w—kv®ue
) {

179 
i
 = 
h
->
siz—¼ay
;

180 
i
--)

181 
	`m¬kv®ue
(
g
, &
h
->
¬¿y
[
i
]);

183 
i
 = 
	`siz’ode
(
h
);

184 
i
--) {

185 
Node
 *
n
 = 
	`gnode
(
h
, 
i
);

186 
	`lua_as£¹
(
	`‰y³
(
	`gkey
(
n
)è!ğ
LUA_TDEADKEY
 || 
	`‰i¢
(
	`gv®
(n)));

187 ià(
	`‰i¢
(
	`gv®
(
n
)))

188 
	`»mov“Áry
(
n
);

190 
	`lua_as£¹
(!
	`‰i¢
(
	`gkey
(
n
)));

191 ià(!
w—kkey
è
	`m¬kv®ue
(
g
, 
	`gkey
(
n
));

192 ià(!
w—kv®ue
è
	`m¬kv®ue
(
g
, 
	`gv®
(
n
));

195  
w—kkey
 || 
w—kv®ue
;

196 
	}
}

203 
	$Œav”£´Ùo
 (
glob®_S‹
 *
g
, 
PrÙo
 *
f
) {

204 
i
;

205 ià(
f
->
sourû
è
	`¡ršgm¬k
(f->source);

206 
i
=0; i<
f
->
sizek
; i++)

207 
	`m¬kv®ue
(
g
, &
f
->
k
[
i
]);

208 
i
=0; i<
f
->
sizeupv®ues
; i++) {

209 ià(
f
->
upv®ues
[
i
])

210 
	`¡ršgm¬k
(
f
->
upv®ues
[
i
]);

212 
i
=0; i<
f
->
siz•
; i++) {

213 ià(
f
->
p
[
i
])

214 
	`m¬kobjeù
(
g
, 
f
->
p
[
i
]);

216 
i
=0; i<
f
->
siz–ocv¬s
; i++) {

217 ià(
f
->
locv¬s
[
i
].
v¬Çme
)

218 
	`¡ršgm¬k
(
f
->
locv¬s
[
i
].
v¬Çme
);

220 
	}
}

224 
	$Œav”£şosu»
 (
glob®_S‹
 *
g
, 
Closu»
 *
ş
) {

225 
	`m¬kobjeù
(
g
, 
ş
->
c
.
’v
);

226 ià(
ş
->
c
.
isC
) {

227 
i
;

228 
i
=0; i<
ş
->
c
.
nupv®ues
; i++)

229 
	`m¬kv®ue
(
g
, &
ş
->
c
.
upv®ue
[
i
]);

232 
i
;

233 
	`lua_as£¹
(
ş
->
l
.
nupv®ues
 =ğş->l.
p
->
nups
);

234 
	`m¬kobjeù
(
g
, 
ş
->
l
.
p
);

235 
i
=0; i<
ş
->
l
.
nupv®ues
; i++)

236 
	`m¬kobjeù
(
g
, 
ş
->
l
.
upv®s
[
i
]);

238 
	}
}

241 
	$check¡acksizes
 (
lua_S‹
 *
L
, 
StkId
 
max
) {

242 
ci_u£d
 = 
	`ÿ¡_št
(
L
->
ci
 - L->
ba£_ci
);

243 
s_u£d
 = 
	`ÿ¡_št
(
max
 - 
L
->
¡ack
);

244 ià(
L
->
size_ci
 > 
LUAI_MAXCALLS
)

246 ià(4*
ci_u£d
 < 
L
->
size_ci
 && 2*
BASIC_CI_SIZE
 < L->size_ci)

247 
	`luaD_»®locCI
(
L
, L->
size_ci
/2);

248 
	`cÚdh¬d¡ack‹¡s
(
	`luaD_»®locCI
(
L
, 
ci_u£d
 + 1));

249 ià(4*
s_u£d
 < 
L
->
¡acksize
 &&

250 2*(
BASIC_STACK_SIZE
+
EXTRA_STACK
è< 
L
->
¡acksize
)

251 
	`luaD_»®loc¡ack
(
L
, L->
¡acksize
/2);

252 
	`cÚdh¬d¡ack‹¡s
(
	`luaD_»®loc¡ack
(
L
, 
s_u£d
));

253 
	}
}

256 
	$Œav”£¡ack
 (
glob®_S‹
 *
g
, 
lua_S‹
 *
l
) {

257 
StkId
 
o
, 
lim
;

258 
C®lInfo
 *
ci
;

259 
	`m¬kv®ue
(
g
, 
	`gt
(
l
));

260 
lim
 = 
l
->
tİ
;

261 
ci
 = 
l
->
ba£_ci
; ci <=†->ci; ci++) {

262 
	`lua_as£¹
(
ci
->
tİ
 <ğ
l
->
¡ack_Ï¡
);

263 ià(
lim
 < 
ci
->
tİ
)†im = ci->top;

265 
o
 = 
l
->
¡ack
; o <†->
tİ
; o++)

266 
	`m¬kv®ue
(
g
, 
o
);

267 ; 
o
 <ğ
lim
; o++)

268 
	`£Šv®ue
(
o
);

269 
	`check¡acksizes
(
l
, 
lim
);

270 
	}
}

277 
l_mem
 
	$´İag©em¬k
 (
glob®_S‹
 *
g
) {

278 
GCObjeù
 *
o
 = 
g
->
g¿y
;

279 
	`lua_as£¹
(
	`isg¿y
(
o
));

280 
	`g¿y2bÏck
(
o
);

281 
o
->
gch
.
‰
) {

282 
LUA_TTABLE
: {

283 
TabË
 *
h
 = 
	`gco2h
(
o
);

284 
g
->
g¿y
 = 
h
->
gşi¡
;

285 ià(
	`Œav”£bË
(
g
, 
h
))

286 
	`bÏck2g¿y
(
o
);

287  (
TabË
è+ (
TV®ue
è* 
h
->
siz—¼ay
 +

288 (
Node
è* 
	`siz’ode
(
h
);

290 
LUA_TFUNCTION
: {

291 
Closu»
 *
ş
 = 
	`gco2ş
(
o
);

292 
g
->
g¿y
 = 
ş
->
c
.
gşi¡
;

293 
	`Œav”£şosu»
(
g
, 
ş
);

294  (
ş
->
c
.
isC
è? 
	`sizeCşosu»
(ş->c.
nupv®ues
) :

295 
	`sizeLşosu»
(
ş
->
l
.
nupv®ues
);

297 
LUA_TTHREAD
: {

298 
lua_S‹
 *
th
 = 
	`gco2th
(
o
);

299 
g
->
g¿y
 = 
th
->
gşi¡
;

300 
th
->
gşi¡
 = 
g
->
g¿yagaš
;

301 
g
->
g¿yagaš
 = 
o
;

302 
	`bÏck2g¿y
(
o
);

303 
	`Œav”£¡ack
(
g
, 
th
);

304  (
lua_S‹
è+ (
TV®ue
è* 
th
->
¡acksize
 +

305 (
C®lInfo
è* 
th
->
size_ci
;

307 
LUA_TPROTO
: {

308 
PrÙo
 *
p
 = 
	`gco2p
(
o
);

309 
g
->
g¿y
 = 
p
->
gşi¡
;

310 
	`Œav”£´Ùo
(
g
, 
p
);

311  (
PrÙo
è+ (
In¡ruùiÚ
è* 
p
->
sizecode
 +

312 (
PrÙo
 *è* 
p
->
siz•
 +

313 (
TV®ue
è* 
p
->
sizek
 +

314 (è* 
p
->
siz–šešfo
 +

315 (
LocV¬
è* 
p
->
siz–ocv¬s
 +

316 (
TSŒšg
 *è* 
p
->
sizeupv®ues
;

318 : 
	`lua_as£¹
(0);  0;

320 
	}
}

323 
size_t
 
	$´İag©—Î
 (
glob®_S‹
 *
g
) {

324 
size_t
 
m
 = 0;

325 
g
->
g¿y
è
m
 +ğ
	`´İag©em¬k
(g);

326  
m
;

327 
	}
}

337 
	$isş—»d
 (cÚ¡ 
TV®ue
 *
o
, 
iskey
) {

338 ià(!
	`iscŞËùabË
(
o
))  0;

339 ià(
	`‰is¡ršg
(
o
)) {

340 
	`¡ršgm¬k
(
	`¿wtsv®ue
(
o
));

343  
	`iswh™e
(
	`gcv®ue
(
o
)) ||

344 (
	`‰isu£rd©a
(
o
è&& (!
iskey
 && 
	`isfš®ized
(
	`uv®ue
(o))));

345 
	}
}

351 
	$ş—¹abË
 (
GCObjeù
 *
l
) {

352 
l
) {

353 
TabË
 *
h
 = 
	`gco2h
(
l
);

354 
i
 = 
h
->
siz—¼ay
;

355 
	`lua_as£¹
(
	`‹¡b™
(
h
->
m¬ked
, 
VALUEWEAKBIT
) ||

356 
	`‹¡b™
(
h
->
m¬ked
, 
KEYWEAKBIT
));

357 ià(
	`‹¡b™
(
h
->
m¬ked
, 
VALUEWEAKBIT
)) {

358 
i
--) {

359 
TV®ue
 *
o
 = &
h
->
¬¿y
[
i
];

360 ià(
	`isş—»d
(
o
, 0))

361 
	`£Šv®ue
(
o
);

364 
i
 = 
	`siz’ode
(
h
);

365 
i
--) {

366 
Node
 *
n
 = 
	`gnode
(
h
, 
i
);

367 ià(!
	`‰i¢
(
	`gv®
(
n
)) &&

368 (
	`isş—»d
(
	`key2tv®
(
n
), 1è|| isş—»d(
	`gv®
(n), 0))) {

369 
	`£Šv®ue
(
	`gv®
(
n
));

370 
	`»mov“Áry
(
n
);

373 
l
 = 
h
->
gşi¡
;

375 
	}
}

378 
	$ä“obj
 (
lua_S‹
 *
L
, 
GCObjeù
 *
o
) {

379 
o
->
gch
.
‰
) {

380 
LUA_TPROTO
: 
	`luaF_ä“´Ùo
(
L
, 
	`gco2p
(
o
)); ;

381 
LUA_TFUNCTION
: 
	`luaF_ä“şosu»
(
L
, 
	`gco2ş
(
o
)); ;

382 
LUA_TUPVAL
: 
	`luaF_ä“upv®
(
L
, 
	`gco2uv
(
o
)); ;

383 
LUA_TTABLE
: 
	`luaH_ä“
(
L
, 
	`gco2h
(
o
)); ;

384 
LUA_TTHREAD
: {

385 
	`lua_as£¹
(
	`gco2th
(
o
è!ğ
L
 && gco2th(oè!ğ
	`G
(L)->
mašth»ad
);

386 
	`luaE_ä“th»ad
(
L
, 
	`gco2th
(
o
));

389 
LUA_TSTRING
: {

390 
	`G
(
L
)->
¡¹
.
nu£
--;

391 
	`luaM_ä“mem
(
L
, 
o
, 
	`size¡ršg
(
	`gco2ts
(o)));

394 
LUA_TUSERDATA
: {

395 
	`luaM_ä“mem
(
L
, 
o
, 
	`sizeud©a
(
	`gco2u
(o)));

398 : 
	`lua_as£¹
(0);

400 
	}
}

404 
	#sw“pwhŞ–i¡
(
L
,
p
è
	`sw“¶i¡
(L,p,
MAX_LUMEM
)

	)

407 
GCObjeù
 **
	$sw“¶i¡
 (
lua_S‹
 *
L
, 
GCObjeù
 **
p
, 
lu_mem
 
couÁ
) {

408 
GCObjeù
 *
cu¼
;

409 
glob®_S‹
 *
g
 = 
	`G
(
L
);

410 
d—dmask
 = 
	`Ùh”wh™e
(
g
);

411 (
cu¼
 = *
p
è!ğ
NULL
 && 
couÁ
-- > 0) {

412 ià(
cu¼
->
gch
.
‰
 =ğ
LUA_TTHREAD
)

413 
	`sw“pwhŞ–i¡
(
L
, &
	`gco2th
(
cu¼
)->
İ’upv®
);

414 ià((
cu¼
->
gch
.
m¬ked
 ^ 
WHITEBITS
è& 
d—dmask
) {

415 
	`lua_as£¹
(!
	`isd—d
(
g
, 
cu¼
è|| 
	`‹¡b™
(cu¼->
gch
.
m¬ked
, 
FIXEDBIT
));

416 
	`makewh™e
(
g
, 
cu¼
);

417 
p
 = &
cu¼
->
gch
.
Ãxt
;

420 
	`lua_as£¹
(
	`isd—d
(
g
, 
cu¼
è|| 
d—dmask
 =ğ
	`b™mask
(
SFIXEDBIT
));

421 *
p
 = 
cu¼
->
gch
.
Ãxt
;

422 ià(
cu¼
 =ğ
g
->
roÙgc
)

423 
g
->
roÙgc
 = 
cu¼
->
gch
.
Ãxt
;

424 
	`ä“obj
(
L
, 
cu¼
);

427  
p
;

428 
	}
}

431 
	$checkSizes
 (
lua_S‹
 *
L
) {

432 
glob®_S‹
 *
g
 = 
	`G
(
L
);

434 ià(
g
->
¡¹
.
nu£
 < 
	`ÿ¡
(
lu_št32
, g->¡¹.
size
/4) &&

435 
g
->
¡¹
.
size
 > 
MINSTRTABSIZE
*2)

436 
	`luaS_»size
(
L
, 
g
->
¡¹
.
size
/2);

438 ià(
	`luaZ_sizebufãr
(&
g
->
buff
è> 
LUA_MINBUFFER
*2) {

439 
size_t
 
Ãwsize
 = 
	`luaZ_sizebufãr
(&
g
->
buff
) / 2;

440 
	`luaZ_»sizebufãr
(
L
, &
g
->
buff
, 
Ãwsize
);

442 
	}
}

445 
	$GCTM
 (
lua_S‹
 *
L
) {

446 
glob®_S‹
 *
g
 = 
	`G
(
L
);

447 
GCObjeù
 *
o
 = 
g
->
tmud©a
->
gch
.
Ãxt
;

448 
Ud©a
 *
ud©a
 = 
	`¿wgco2u
(
o
);

449 cÚ¡ 
TV®ue
 *
tm
;

451 ià(
o
 =ğ
g
->
tmud©a
)

452 
g
->
tmud©a
 = 
NULL
;

454 
g
->
tmud©a
->
gch
.
Ãxt
 = 
ud©a
->
uv
.next;

455 
ud©a
->
uv
.
Ãxt
 = 
g
->
mašth»ad
->next;

456 
g
->
mašth»ad
->
Ãxt
 = 
o
;

457 
	`makewh™e
(
g
, 
o
);

458 
tm
 = 
	`ç¡tm
(
L
, 
ud©a
->
uv
.
m‘©abË
, 
TM_GC
);

459 ià(
tm
 !ğ
NULL
) {

460 
lu_by‹
 
Şdah
 = 
L
->
®lowhook
;

461 
lu_mem
 
Şdt
 = 
g
->
GCth»shŞd
;

462 
L
->
®lowhook
 = 0;

463 
g
->
GCth»shŞd
 = 2*g->
tÙ®by‹s
;

464 
	`£tobj2s
(
L
, L->
tİ
, 
tm
);

465 
	`£tuv®ue
(
L
, L->
tİ
+1, 
ud©a
);

466 
L
->
tİ
 += 2;

467 
	`luaD_ÿÎ
(
L
, L->
tİ
 - 2, 0);

468 
L
->
®lowhook
 = 
Şdah
;

469 
g
->
GCth»shŞd
 = 
Şdt
;

471 
	}
}

477 
	$luaC_ÿÎGCTM
 (
lua_S‹
 *
L
) {

478 
	`G
(
L
)->
tmud©a
)

479 
	`GCTM
(
L
);

480 
	}
}

483 
	$luaC_ä“®l
 (
lua_S‹
 *
L
) {

484 
glob®_S‹
 *
g
 = 
	`G
(
L
);

485 
i
;

486 
g
->
cu¼’twh™e
 = 
WHITEBITS
 | 
	`b™mask
(
SFIXEDBIT
);

487 
	`sw“pwhŞ–i¡
(
L
, &
g
->
roÙgc
);

488 
i
 = 0; i < 
g
->
¡¹
.
size
; i++)

489 
	`sw“pwhŞ–i¡
(
L
, &
g
->
¡¹
.
hash
[
i
]);

490 
	}
}

493 
	$m¬kmt
 (
glob®_S‹
 *
g
) {

494 
i
;

495 
i
=0; i<
NUM_TAGS
; i++)

496 ià(
g
->
mt
[
i
]è
	`m¬kobjeù
(g, g->mt[i]);

497 
	}
}

501 
	$m¬kroÙ
 (
lua_S‹
 *
L
) {

502 
glob®_S‹
 *
g
 = 
	`G
(
L
);

503 
g
->
g¿y
 = 
NULL
;

504 
g
->
g¿yagaš
 = 
NULL
;

505 
g
->
w—k
 = 
NULL
;

506 
	`m¬kobjeù
(
g
, g->
mašth»ad
);

508 
	`m¬kv®ue
(
g
, 
	`gt
(g->
mašth»ad
));

509 
	`m¬kv®ue
(
g
, 
	`»gi¡ry
(
L
));

510 
	`m¬kmt
(
g
);

511 
g
->
gc¡©e
 = 
GCS´İag©e
;

512 
	}
}

515 
	$»m¬kupv®s
 (
glob®_S‹
 *
g
) {

516 
UpV®
 *
uv
;

517 
uv
 = 
g
->
uvh—d
.
u
.
l
.
Ãxt
; uv != &g->uvhead; uv = uv->u.l.next) {

518 
	`lua_as£¹
(
uv
->
u
.
l
.
Ãxt
->u.l.
´ev
 == uv && uv->u.l.prev->u.l.next == uv);

519 ià(
	`isg¿y
(
	`obj2gco
(
uv
)))

520 
	`m¬kv®ue
(
g
, 
uv
->
v
);

522 
	}
}

525 
	$©omic
 (
lua_S‹
 *
L
) {

526 
glob®_S‹
 *
g
 = 
	`G
(
L
);

527 
size_t
 
udsize
;

529 
	`»m¬kupv®s
(
g
);

531 
	`´İag©—Î
(
g
);

533 
g
->
g¿y
 = g->
w—k
;

534 
g
->
w—k
 = 
NULL
;

535 
	`lua_as£¹
(!
	`iswh™e
(
	`obj2gco
(
g
->
mašth»ad
)));

536 
	`m¬kobjeù
(
g
, 
L
);

537 
	`m¬kmt
(
g
);

538 
	`´İag©—Î
(
g
);

540 
g
->
g¿y
 = g->
g¿yagaš
;

541 
g
->
g¿yagaš
 = 
NULL
;

542 
	`´İag©—Î
(
g
);

543 
udsize
 = 
	`luaC_£·¿‹ud©a
(
L
, 0);

544 
	`m¬ktmu
(
g
);

545 
udsize
 +ğ
	`´İag©—Î
(
g
);

546 
	`ş—¹abË
(
g
->
w—k
);

548 
g
->
cu¼’twh™e
 = 
	`ÿ¡_by‹
(
	`Ùh”wh™e
(g));

549 
g
->
sw“p¡rgc
 = 0;

550 
g
->
sw“pgc
 = &g->
roÙgc
;

551 
g
->
gc¡©e
 = 
GCSsw“p¡ršg
;

552 
g
->
e¡im©e
 = g->
tÙ®by‹s
 - 
udsize
;

553 
	}
}

556 
l_mem
 
	$sšgË¡•
 (
lua_S‹
 *
L
) {

557 
glob®_S‹
 *
g
 = 
	`G
(
L
);

559 
g
->
gc¡©e
) {

560 
GCS·u£
: {

561 
	`m¬kroÙ
(
L
);

564 
GCS´İag©e
: {

565 ià(
g
->
g¿y
)

566  
	`´İag©em¬k
(
g
);

568 
	`©omic
(
L
);

572 
GCSsw“p¡ršg
: {

573 
lu_mem
 
Şd
 = 
g
->
tÙ®by‹s
;

574 
	`sw“pwhŞ–i¡
(
L
, &
g
->
¡¹
.
hash
[g->
sw“p¡rgc
++]);

575 ià(
g
->
sw“p¡rgc
 >ğg->
¡¹
.
size
)

576 
g
->
gc¡©e
 = 
GCSsw“p
;

577 
	`lua_as£¹
(
Şd
 >ğ
g
->
tÙ®by‹s
);

578 
g
->
e¡im©e
 -ğ
Şd
 - g->
tÙ®by‹s
;

579  
GCSWEEPCOST
;

581 
GCSsw“p
: {

582 
lu_mem
 
Şd
 = 
g
->
tÙ®by‹s
;

583 
g
->
sw“pgc
 = 
	`sw“¶i¡
(
L
, g->sw“pgc, 
GCSWEEPMAX
);

584 ià(*
g
->
sw“pgc
 =ğ
NULL
) {

585 
	`checkSizes
(
L
);

586 
g
->
gc¡©e
 = 
GCSfš®ize
;

588 
	`lua_as£¹
(
Şd
 >ğ
g
->
tÙ®by‹s
);

589 
g
->
e¡im©e
 -ğ
Şd
 - g->
tÙ®by‹s
;

590  
GCSWEEPMAX
*
GCSWEEPCOST
;

592 
GCSfš®ize
: {

593 ià(
g
->
tmud©a
) {

594 
	`GCTM
(
L
);

595 ià(
g
->
e¡im©e
 > 
GCFINALIZECOST
)

596 
g
->
e¡im©e
 -ğ
GCFINALIZECOST
;

597  
GCFINALIZECOST
;

600 
g
->
gc¡©e
 = 
GCS·u£
;

601 
g
->
gcd•t
 = 0;

605 : 
	`lua_as£¹
(0);  0;

607 
	}
}

610 
	$luaC_¡•
 (
lua_S‹
 *
L
) {

611 
glob®_S‹
 *
g
 = 
	`G
(
L
);

612 
l_mem
 
lim
 = (
GCSTEPSIZE
/100è* 
g
->
gc¡•mul
;

613 ià(
lim
 == 0)

614 
lim
 = (
MAX_LUMEM
-1)/2;

615 
g
->
gcd•t
 +ğg->
tÙ®by‹s
 - g->
GCth»shŞd
;

617 
lim
 -ğ
	`sšgË¡•
(
L
);

618 ià(
g
->
gc¡©e
 =ğ
GCS·u£
)

620 } 
lim
 > 0);

621 ià(
g
->
gc¡©e
 !ğ
GCS·u£
) {

622 ià(
g
->
gcd•t
 < 
GCSTEPSIZE
)

623 
g
->
GCth»shŞd
 = g->
tÙ®by‹s
 + 
GCSTEPSIZE
;

625 
g
->
gcd•t
 -ğ
GCSTEPSIZE
;

626 
g
->
GCth»shŞd
 = g->
tÙ®by‹s
;

630 
	`£‰h»shŞd
(
g
);

632 
	}
}

635 
	$luaC_fuÎgc
 (
lua_S‹
 *
L
) {

636 
glob®_S‹
 *
g
 = 
	`G
(
L
);

637 ià(
g
->
gc¡©e
 <ğ
GCS´İag©e
) {

639 
g
->
sw“p¡rgc
 = 0;

640 
g
->
sw“pgc
 = &g->
roÙgc
;

642 
g
->
g¿y
 = 
NULL
;

643 
g
->
g¿yagaš
 = 
NULL
;

644 
g
->
w—k
 = 
NULL
;

645 
g
->
gc¡©e
 = 
GCSsw“p¡ršg
;

647 
	`lua_as£¹
(
g
->
gc¡©e
 !ğ
GCS·u£
 && g->gc¡©!ğ
GCS´İag©e
);

649 
g
->
gc¡©e
 !ğ
GCSfš®ize
) {

650 
	`lua_as£¹
(
g
->
gc¡©e
 =ğ
GCSsw“p¡ršg
 || g->gc¡©=ğ
GCSsw“p
);

651 
	`sšgË¡•
(
L
);

653 
	`m¬kroÙ
(
L
);

654 
g
->
gc¡©e
 !ğ
GCS·u£
) {

655 
	`sšgË¡•
(
L
);

657 
	`£‰h»shŞd
(
g
);

658 
	}
}

661 
	$luaC_b¬r›rf
 (
lua_S‹
 *
L
, 
GCObjeù
 *
o
, GCObjeù *
v
) {

662 
glob®_S‹
 *
g
 = 
	`G
(
L
);

663 
	`lua_as£¹
(
	`isbÏck
(
o
è&& 
	`iswh™e
(
v
è&& !
	`isd—d
(
g
, v) && !isdead(g, o));

664 
	`lua_as£¹
(
g
->
gc¡©e
 !ğ
GCSfš®ize
 && g->gc¡©!ğ
GCS·u£
);

665 
	`lua_as£¹
(
	`‰y³
(&
o
->
gch
è!ğ
LUA_TTABLE
);

667 ià(
g
->
gc¡©e
 =ğ
GCS´İag©e
)

668 
	`»®lym¬kobjeù
(
g
, 
v
);

670 
	`makewh™e
(
g
, 
o
);

671 
	}
}

674 
	$luaC_b¬r›rback
 (
lua_S‹
 *
L
, 
TabË
 *
t
) {

675 
glob®_S‹
 *
g
 = 
	`G
(
L
);

676 
GCObjeù
 *
o
 = 
	`obj2gco
(
t
);

677 
	`lua_as£¹
(
	`isbÏck
(
o
è&& !
	`isd—d
(
g
, o));

678 
	`lua_as£¹
(
g
->
gc¡©e
 !ğ
GCSfš®ize
 && g->gc¡©!ğ
GCS·u£
);

679 
	`bÏck2g¿y
(
o
);

680 
t
->
gşi¡
 = 
g
->
g¿yagaš
;

681 
g
->
g¿yagaš
 = 
o
;

682 
	}
}

685 
	$luaC_lšk
 (
lua_S‹
 *
L
, 
GCObjeù
 *
o
, 
lu_by‹
 
‰
) {

686 
glob®_S‹
 *
g
 = 
	`G
(
L
);

687 
o
->
gch
.
Ãxt
 = 
g
->
roÙgc
;

688 
g
->
roÙgc
 = 
o
;

689 
o
->
gch
.
m¬ked
 = 
	`luaC_wh™e
(
g
);

690 
o
->
gch
.
‰
 =t;

691 
	}
}

694 
	$luaC_lškupv®
 (
lua_S‹
 *
L
, 
UpV®
 *
uv
) {

695 
glob®_S‹
 *
g
 = 
	`G
(
L
);

696 
GCObjeù
 *
o
 = 
	`obj2gco
(
uv
);

697 
o
->
gch
.
Ãxt
 = 
g
->
roÙgc
;

698 
g
->
roÙgc
 = 
o
;

699 ià(
	`isg¿y
(
o
)) {

700 ià(
g
->
gc¡©e
 =ğ
GCS´İag©e
) {

701 
	`g¿y2bÏck
(
o
);

702 
	`luaC_b¬r›r
(
L
, 
uv
, uv->
v
);

705 
	`makewh™e
(
g
, 
o
);

706 
	`lua_as£¹
(
g
->
gc¡©e
 !ğ
GCSfš®ize
 && g->gc¡©!ğ
GCS·u£
);

709 
	}
}

	@deps/lua/src/lgc.h

7 #iâdeà
lgc_h


8 
	#lgc_h


	)

11 
	~"lobjeù.h
"

17 
	#GCS·u£
 0

	)

18 
	#GCS´İag©e
 1

	)

19 
	#GCSsw“p¡ršg
 2

	)

20 
	#GCSsw“p
 3

	)

21 
	#GCSfš®ize
 4

	)

27 
	#»£tb™s
(
x
,
m
è((xè&ğ
	`ÿ¡
(
lu_by‹
, ~(m)))

	)

28 
	#£tb™s
(
x
,
m
è((xè|ğ(m))

	)

29 
	#‹¡b™s
(
x
,
m
è((xè& (m))

	)

30 
	#b™mask
(
b
è(1<<(b))

	)

31 
	#b™2mask
(
b1
,
b2
è(
	`b™mask
(b1è| b™mask(b2))

	)

32 
	#l_£tb™
(
x
,
b
è
	`£tb™s
(x, 
	`b™mask
(b))

	)

33 
	#»£tb™
(
x
,
b
è
	`»£tb™s
(x, 
	`b™mask
(b))

	)

34 
	#‹¡b™
(
x
,
b
è
	`‹¡b™s
(x, 
	`b™mask
(b))

	)

35 
	#£t2b™s
(
x
,
b1
,
b2
è
	`£tb™s
(x, (
	`b™2mask
(b1, b2)))

	)

36 
	#»£t2b™s
(
x
,
b1
,
b2
è
	`»£tb™s
(x, (
	`b™2mask
(b1, b2)))

	)

37 
	#‹¡2b™s
(
x
,
b1
,
b2
è
	`‹¡b™s
(x, (
	`b™2mask
(b1, b2)))

	)

54 
	#WHITE0BIT
 0

	)

55 
	#WHITE1BIT
 1

	)

56 
	#BLACKBIT
 2

	)

57 
	#FINALIZEDBIT
 3

	)

58 
	#KEYWEAKBIT
 3

	)

59 
	#VALUEWEAKBIT
 4

	)

60 
	#FIXEDBIT
 5

	)

61 
	#SFIXEDBIT
 6

	)

62 
	#WHITEBITS
 
	`b™2mask
(
WHITE0BIT
, 
WHITE1BIT
)

	)

65 
	#iswh™e
(
x
è
	`‹¡2b™s
((x)->
gch
.
m¬ked
, 
WHITE0BIT
, 
WHITE1BIT
)

	)

66 
	#isbÏck
(
x
è
	`‹¡b™
((x)->
gch
.
m¬ked
, 
BLACKBIT
)

	)

67 
	#isg¿y
(
x
è(!
	`isbÏck
(xè&& !
	`iswh™e
(x))

	)

69 
	#Ùh”wh™e
(
g
è(g->
cu¼’twh™e
 ^ 
WHITEBITS
)

	)

70 
	#isd—d
(
g
,
v
è((v)->
gch
.
m¬ked
 & 
	`Ùh”wh™e
(gè& 
WHITEBITS
)

	)

72 
	#chªgewh™e
(
x
è((x)->
gch
.
m¬ked
 ^ğ
WHITEBITS
)

	)

73 
	#g¿y2bÏck
(
x
è
	`l_£tb™
((x)->
gch
.
m¬ked
, 
BLACKBIT
)

	)

75 
	#v®iswh™e
(
x
è(
	`iscŞËùabË
(xè&& 
	`iswh™e
(
	`gcv®ue
(x)))

	)

77 
	#luaC_wh™e
(
g
è
	`ÿ¡
(
lu_by‹
, (g)->
cu¼’twh™e
 & 
WHITEBITS
)

	)

80 
	#luaC_checkGC
(
L
) { \

81 
	`cÚdh¬d¡ack‹¡s
(
	`luaD_»®loc¡ack
(
L
, L->
¡acksize
 - 
EXTRA_STACK
 - 1)); \

82 ià(
	`G
(
L
)->
tÙ®by‹s
 >ğG(L)->
GCth»shŞd
) \

83 
	`luaC_¡•
(
L
); }

	)

86 
	#luaC_b¬r›r
(
L
,
p
,
v
è{ ià(
	`v®iswh™e
(vè&& 
	`isbÏck
(
	`obj2gco
(p))) \

87 
	`luaC_b¬r›rf
(
L
,
	`obj2gco
(
p
),
	`gcv®ue
(
v
)); }

	)

89 
	#luaC_b¬r›¹
(
L
,
t
,
v
è{ ià(
	`v®iswh™e
(vè&& 
	`isbÏck
(
	`obj2gco
(t))) \

90 
	`luaC_b¬r›rback
(
L
,
t
); }

	)

92 
	#luaC_objb¬r›r
(
L
,
p
,
o
) \

93 { ià(
	`iswh™e
(
	`obj2gco
(
o
)è&& 
	`isbÏck
(obj2gco(
p
))) \

94 
	`luaC_b¬r›rf
(
L
,
	`obj2gco
(
p
),obj2gco(
o
)); }

	)

96 
	#luaC_objb¬r›¹
(
L
,
t
,
o
) \

97 { ià(
	`iswh™e
(
	`obj2gco
(
o
)è&& 
	`isbÏck
(obj2gco(
t
))è
	`luaC_b¬r›rback
(
L
,t); }

	)

99 
LUAI_FUNC
 
size_t
 
luaC_£·¿‹ud©a
 (
lua_S‹
 *
L
, 
®l
);

100 
LUAI_FUNC
 
luaC_ÿÎGCTM
 (
lua_S‹
 *
L
);

101 
LUAI_FUNC
 
luaC_ä“®l
 (
lua_S‹
 *
L
);

102 
LUAI_FUNC
 
luaC_¡•
 (
lua_S‹
 *
L
);

103 
LUAI_FUNC
 
luaC_fuÎgc
 (
lua_S‹
 *
L
);

104 
LUAI_FUNC
 
luaC_lšk
 (
lua_S‹
 *
L
, 
GCObjeù
 *
o
, 
lu_by‹
 
‰
);

105 
LUAI_FUNC
 
luaC_lškupv®
 (
lua_S‹
 *
L
, 
UpV®
 *
uv
);

106 
LUAI_FUNC
 
luaC_b¬r›rf
 (
lua_S‹
 *
L
, 
GCObjeù
 *
o
, GCObjeù *
v
);

107 
LUAI_FUNC
 
luaC_b¬r›rback
 (
lua_S‹
 *
L
, 
TabË
 *
t
);

	@deps/lua/src/linit.c

8 
	#lš™_c


	)

9 
	#LUA_LIB


	)

11 
	~"lua.h
"

13 
	~"lu®ib.h
"

14 
	~"Ïuxlib.h
"

17 cÚ¡ 
luaL_Reg
 
	glu®ibs
[] = {

18 {"", 
luaİ’_ba£
},

19 {
LUA_LOADLIBNAME
, 
luaİ’_·ckage
},

20 {
LUA_TABLIBNAME
, 
luaİ’_bË
},

21 {
LUA_IOLIBNAME
, 
luaİ’_io
},

22 {
LUA_OSLIBNAME
, 
luaİ’_os
},

23 {
LUA_STRLIBNAME
, 
luaİ’_¡ršg
},

24 {
LUA_MATHLIBNAME
, 
luaİ’_m©h
},

25 {
LUA_DBLIBNAME
, 
luaİ’_debug
},

26 {
NULL
, NULL}

30 
LUALIB_API
 
	$luaL_İ’libs
 (
lua_S‹
 *
L
) {

31 cÚ¡ 
luaL_Reg
 *
lib
 = 
lu®ibs
;

32 ; 
lib
->
func
;†ib++) {

33 
	`lua_pushcfunùiÚ
(
L
, 
lib
->
func
);

34 
	`lua_push¡ršg
(
L
, 
lib
->
Çme
);

35 
	`lua_ÿÎ
(
L
, 1, 0);

37 
	}
}

	@deps/lua/src/liolib.c

8 
	~<”ºo.h
>

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

11 
	~<¡ršg.h
>

13 
	#liŞib_c


	)

14 
	#LUA_LIB


	)

16 
	~"lua.h
"

18 
	~"Ïuxlib.h
"

19 
	~"lu®ib.h
"

23 
	#IO_INPUT
 1

	)

24 
	#IO_OUTPUT
 2

	)

27 cÚ¡ *cÚ¡ 
	gâames
[] = {"input", "output"};

30 
	$push»suÉ
 (
lua_S‹
 *
L
, 
i
, cÚ¡ *
f’ame
) {

31 
’
 = 
”ºo
;

32 ià(
i
) {

33 
	`lua_pushboŞ—n
(
L
, 1);

37 
	`lua_pushn
(
L
);

38 ià(
f’ame
)

39 
	`lua_pushf¡ršg
(
L
, "%s: %s", 
f’ame
, 
	`¡»¼Ü
(
’
));

41 
	`lua_pushf¡ršg
(
L
, "%s", 
	`¡»¼Ü
(
’
));

42 
	`lua_pushš‹g”
(
L
, 
’
);

45 
	}
}

48 
	$f“¼Ü
 (
lua_S‹
 *
L
, 
¬g
, cÚ¡ *
f’ame
) {

49 
	`lua_pushf¡ršg
(
L
, "%s: %s", 
f’ame
, 
	`¡»¼Ü
(
”ºo
));

50 
	`luaL_¬g”rÜ
(
L
, 
¬g
, 
	`lua_to¡ršg
(L, -1));

51 
	}
}

54 
	#tof•
(
L
è((
FILE
 **)
	`luaL_checkud©a
(L, 1, 
LUA_FILEHANDLE
))

	)

57 
	$io_ty³
 (
lua_S‹
 *
L
) {

58 *
ud
;

59 
	`luaL_checkªy
(
L
, 1);

60 
ud
 = 
	`lua_tou£rd©a
(
L
, 1);

61 
	`lua_g‘f›ld
(
L
, 
LUA_REGISTRYINDEX
, 
LUA_FILEHANDLE
);

62 ià(
ud
 =ğ
NULL
 || !
	`lua_g‘m‘©abË
(
L
, 1è|| !
	`lua_¿wequ®
(L, -2, -1))

63 
	`lua_pushn
(
L
);

64 ià(*((
FILE
 **)
ud
è=ğ
NULL
)

65 
	`lua_pushl™”®
(
L
, "closed file");

67 
	`lua_pushl™”®
(
L
, "file");

69 
	}
}

72 
FILE
 *
	$tofe
 (
lua_S‹
 *
L
) {

73 
FILE
 **
f
 = 
	`tof•
(
L
);

74 ià(*
f
 =ğ
NULL
)

75 
	`luaL_”rÜ
(
L
, "attempto use‡ closed file");

76  *
f
;

77 
	}
}

86 
FILE
 **
	$Ãwfe
 (
lua_S‹
 *
L
) {

87 
FILE
 **
pf
 = (FILE **)
	`lua_Ãwu£rd©a
(
L
, (FILE *));

88 *
pf
 = 
NULL
;

89 
	`luaL_g‘m‘©abË
(
L
, 
LUA_FILEHANDLE
);

90 
	`lua_£tm‘©abË
(
L
, -2);

91  
pf
;

92 
	}
}

98 
	$io_noşo£
 (
lua_S‹
 *
L
) {

99 
	`lua_pushn
(
L
);

100 
	`lua_pushl™”®
(
L
, "cannot close standard file");

102 
	}
}

108 
	$io_pşo£
 (
lua_S‹
 *
L
) {

109 
FILE
 **
p
 = 
	`tof•
(
L
);

110 
ok
 = 
	`lua_pşo£
(
L
, *
p
);

111 *
p
 = 
NULL
;

112  
	`push»suÉ
(
L
, 
ok
, 
NULL
);

113 
	}
}

119 
	$io_fşo£
 (
lua_S‹
 *
L
) {

120 
FILE
 **
p
 = 
	`tof•
(
L
);

121 
ok
 = (
	`fşo£
(*
p
) == 0);

122 *
p
 = 
NULL
;

123  
	`push»suÉ
(
L
, 
ok
, 
NULL
);

124 
	}
}

127 
	$aux_şo£
 (
lua_S‹
 *
L
) {

128 
	`lua_g‘ãnv
(
L
, 1);

129 
	`lua_g‘f›ld
(
L
, -1, "__close");

130  (
	`lua_tocfunùiÚ
(
L
, -1))(L);

131 
	}
}

134 
	$io_şo£
 (
lua_S‹
 *
L
) {

135 ià(
	`lua_i¢Úe
(
L
, 1))

136 
	`lua_¿wg‘i
(
L
, 
LUA_ENVIRONINDEX
, 
IO_OUTPUT
);

137 
	`tofe
(
L
);

138  
	`aux_şo£
(
L
);

139 
	}
}

142 
	$io_gc
 (
lua_S‹
 *
L
) {

143 
FILE
 *
f
 = *
	`tof•
(
L
);

145 ià(
f
 !ğ
NULL
)

146 
	`aux_şo£
(
L
);

148 
	}
}

151 
	$io_to¡ršg
 (
lua_S‹
 *
L
) {

152 
FILE
 *
f
 = *
	`tof•
(
L
);

153 ià(
f
 =ğ
NULL
)

154 
	`lua_pushl™”®
(
L
, "file (closed)");

156 
	`lua_pushf¡ršg
(
L
, "f(%p)", 
f
);

158 
	}
}

161 
	$io_İ’
 (
lua_S‹
 *
L
) {

162 cÚ¡ *
f’ame
 = 
	`luaL_check¡ršg
(
L
, 1);

163 cÚ¡ *
mode
 = 
	`luaL_İt¡ršg
(
L
, 2, "r");

164 
FILE
 **
pf
 = 
	`Ãwfe
(
L
);

165 *
pf
 = 
	`fİ’
(
f’ame
, 
mode
);

166  (*
pf
 =ğ
NULL
è? 
	`push»suÉ
(
L
, 0, 
f’ame
) : 1;

167 
	}
}

174 
	$io_pİ’
 (
lua_S‹
 *
L
) {

175 cÚ¡ *
f’ame
 = 
	`luaL_check¡ršg
(
L
, 1);

176 cÚ¡ *
mode
 = 
	`luaL_İt¡ršg
(
L
, 2, "r");

177 
FILE
 **
pf
 = 
	`Ãwfe
(
L
);

178 *
pf
 = 
	`lua_pİ’
(
L
, 
f’ame
, 
mode
);

179  (*
pf
 =ğ
NULL
è? 
	`push»suÉ
(
L
, 0, 
f’ame
) : 1;

180 
	}
}

183 
	$io_tmpfe
 (
lua_S‹
 *
L
) {

184 
FILE
 **
pf
 = 
	`Ãwfe
(
L
);

185 *
pf
 = 
	`tmpfe
();

186  (*
pf
 =ğ
NULL
è? 
	`push»suÉ
(
L
, 0, NULL) : 1;

187 
	}
}

190 
FILE
 *
	$g‘iofe
 (
lua_S‹
 *
L
, 
fšdex
) {

191 
FILE
 *
f
;

192 
	`lua_¿wg‘i
(
L
, 
LUA_ENVIRONINDEX
, 
fšdex
);

193 
f
 = *(
FILE
 **)
	`lua_tou£rd©a
(
L
, -1);

194 ià(
f
 =ğ
NULL
)

195 
	`luaL_”rÜ
(
L
, "¡ªd¬d % fi şo£d", 
âames
[
fšdex
 - 1]);

196  
f
;

197 
	}
}

200 
	$g_iofe
 (
lua_S‹
 *
L
, 
f
, cÚ¡ *
mode
) {

201 ià(!
	`lua_i¢ÚeÜn
(
L
, 1)) {

202 cÚ¡ *
f’ame
 = 
	`lua_to¡ršg
(
L
, 1);

203 ià(
f’ame
) {

204 
FILE
 **
pf
 = 
	`Ãwfe
(
L
);

205 *
pf
 = 
	`fİ’
(
f’ame
, 
mode
);

206 ià(*
pf
 =ğ
NULL
)

207 
	`f“¼Ü
(
L
, 1, 
f’ame
);

210 
	`tofe
(
L
);

211 
	`lua_pushv®ue
(
L
, 1);

213 
	`lua_¿w£ti
(
L
, 
LUA_ENVIRONINDEX
, 
f
);

216 
	`lua_¿wg‘i
(
L
, 
LUA_ENVIRONINDEX
, 
f
);

218 
	}
}

221 
	$io_šput
 (
lua_S‹
 *
L
) {

222  
	`g_iofe
(
L
, 
IO_INPUT
, "r");

223 
	}
}

226 
	$io_ouut
 (
lua_S‹
 *
L
) {

227  
	`g_iofe
(
L
, 
IO_OUTPUT
, "w");

228 
	}
}

231 
io_»adlše
 (
lua_S‹
 *
L
);

234 
	$aux_lšes
 (
lua_S‹
 *
L
, 
idx
, 
toşo£
) {

235 
	`lua_pushv®ue
(
L
, 
idx
);

236 
	`lua_pushboŞ—n
(
L
, 
toşo£
);

237 
	`lua_pushcşosu»
(
L
, 
io_»adlše
, 2);

238 
	}
}

241 
	$f_lšes
 (
lua_S‹
 *
L
) {

242 
	`tofe
(
L
);

243 
	`aux_lšes
(
L
, 1, 0);

245 
	}
}

248 
	$io_lšes
 (
lua_S‹
 *
L
) {

249 ià(
	`lua_i¢ÚeÜn
(
L
, 1)) {

251 
	`lua_¿wg‘i
(
L
, 
LUA_ENVIRONINDEX
, 
IO_INPUT
);

252  
	`f_lšes
(
L
);

255 cÚ¡ *
f’ame
 = 
	`luaL_check¡ršg
(
L
, 1);

256 
FILE
 **
pf
 = 
	`Ãwfe
(
L
);

257 *
pf
 = 
	`fİ’
(
f’ame
, "r");

258 ià(*
pf
 =ğ
NULL
)

259 
	`f“¼Ü
(
L
, 1, 
f’ame
);

260 
	`aux_lšes
(
L
, 
	`lua_g‘tİ
(L), 1);

263 
	}
}

273 
	$»ad_numb”
 (
lua_S‹
 *
L
, 
FILE
 *
f
) {

274 
lua_Numb”
 
d
;

275 ià(
	`fsÿnf
(
f
, 
LUA_NUMBER_SCAN
, &
d
) == 1) {

276 
	`lua_pushnumb”
(
L
, 
d
);

280 
	`lua_pushn
(
L
);

283 
	}
}

286 
	$‹¡_eof
 (
lua_S‹
 *
L
, 
FILE
 *
f
) {

287 
c
 = 
	`g‘c
(
f
);

288 
	`ung‘c
(
c
, 
f
);

289 
	`lua_pushl¡ršg
(
L
, 
NULL
, 0);

290  (
c
 !ğ
EOF
);

291 
	}
}

294 
	$»ad_lše
 (
lua_S‹
 *
L
, 
FILE
 *
f
) {

295 
luaL_Bufãr
 
b
;

296 
	`luaL_buffš™
(
L
, &
b
);

298 
size_t
 
l
;

299 *
p
 = 
	`luaL_´•bufãr
(&
b
);

300 ià(
	`fg‘s
(
p
, 
LUAL_BUFFERSIZE
, 
f
è=ğ
NULL
) {

301 
	`luaL_push»suÉ
(&
b
);

302  (
	`lua_objËn
(
L
, -1) > 0);

304 
l
 = 
	`¡¾’
(
p
);

305 ià(
l
 =ğ0 || 
p
[l-1] != '\n')

306 
	`luaL_addsize
(&
b
, 
l
);

308 
	`luaL_addsize
(&
b
, 
l
 - 1);

309 
	`luaL_push»suÉ
(&
b
);

313 
	}
}

316 
	$»ad_ch¬s
 (
lua_S‹
 *
L
, 
FILE
 *
f
, 
size_t
 
n
) {

317 
size_t
 
¾’
;

318 
size_t
 
Ä
;

319 
luaL_Bufãr
 
b
;

320 
	`luaL_buffš™
(
L
, &
b
);

321 
¾’
 = 
LUAL_BUFFERSIZE
;

323 *
p
 = 
	`luaL_´•bufãr
(&
b
);

324 ià(
¾’
 > 
n
)„len =‚;

325 
Ä
 = 
	`ä—d
(
p
, (), 
¾’
, 
f
);

326 
	`luaL_addsize
(&
b
, 
Ä
);

327 
n
 -ğ
Ä
;

328 } 
n
 > 0 && 
Ä
 =ğ
¾’
);

329 
	`luaL_push»suÉ
(&
b
);

330  (
n
 =ğ0 || 
	`lua_objËn
(
L
, -1) > 0);

331 
	}
}

334 
	$g_»ad
 (
lua_S‹
 *
L
, 
FILE
 *
f
, 
fœ¡
) {

335 
Çrgs
 = 
	`lua_g‘tİ
(
L
) - 1;

336 
sucûss
;

337 
n
;

338 
	`ş—»¼
(
f
);

339 ià(
Çrgs
 == 0) {

340 
sucûss
 = 
	`»ad_lše
(
L
, 
f
);

341 
n
 = 
fœ¡
+1;

344 
	`luaL_check¡ack
(
L
, 
Çrgs
+
LUA_MINSTACK
, "too many‡rguments");

345 
sucûss
 = 1;

346 
n
 = 
fœ¡
; 
Çrgs
-- && 
sucûss
;‚++) {

347 ià(
	`lua_ty³
(
L
, 
n
è=ğ
LUA_TNUMBER
) {

348 
size_t
 
l
 = (size_t)
	`lua_toš‹g”
(
L
, 
n
);

349 
sucûss
 = (
l
 =ğ0è? 
	`‹¡_eof
(
L
, 
f
è: 
	`»ad_ch¬s
(L, f,†);

352 cÚ¡ *
p
 = 
	`lua_to¡ršg
(
L
, 
n
);

353 
	`luaL_¬gcheck
(
L
, 
p
 &&…[0] =ğ'*', 
n
, "invalid option");

354 
p
[1]) {

356 
sucûss
 = 
	`»ad_numb”
(
L
, 
f
);

359 
sucûss
 = 
	`»ad_lše
(
L
, 
f
);

362 
	`»ad_ch¬s
(
L
, 
f
, ~((
size_t
)0));

363 
sucûss
 = 1;

366  
	`luaL_¬g”rÜ
(
L
, 
n
, "invalid format");

371 ià(
	`ã¼Ü
(
f
))

372  
	`push»suÉ
(
L
, 0, 
NULL
);

373 ià(!
sucûss
) {

374 
	`lua_pİ
(
L
, 1);

375 
	`lua_pushn
(
L
);

377  
n
 - 
fœ¡
;

378 
	}
}

381 
	$io_»ad
 (
lua_S‹
 *
L
) {

382  
	`g_»ad
(
L
, 
	`g‘iofe
(L, 
IO_INPUT
), 1);

383 
	}
}

386 
	$f_»ad
 (
lua_S‹
 *
L
) {

387  
	`g_»ad
(
L
, 
	`tofe
(L), 2);

388 
	}
}

391 
	$io_»adlše
 (
lua_S‹
 *
L
) {

392 
FILE
 *
f
 = *(FILE **)
	`lua_tou£rd©a
(
L
, 
	`lua_upv®uešdex
(1));

393 
suûss
;

394 ià(
f
 =ğ
NULL
)

395 
	`luaL_”rÜ
(
L
, "file is‡lready closed");

396 
suûss
 = 
	`»ad_lše
(
L
, 
f
);

397 ià(
	`ã¼Ü
(
f
))

398  
	`luaL_”rÜ
(
L
, "%s", 
	`¡»¼Ü
(
”ºo
));

399 ià(
suûss
)  1;

401 ià(
	`lua_toboŞ—n
(
L
, 
	`lua_upv®uešdex
(2))) {

402 
	`lua_£‰İ
(
L
, 0);

403 
	`lua_pushv®ue
(
L
, 
	`lua_upv®uešdex
(1));

404 
	`aux_şo£
(
L
);

408 
	}
}

413 
	$g_wr™e
 (
lua_S‹
 *
L
, 
FILE
 *
f
, 
¬g
) {

414 
Çrgs
 = 
	`lua_g‘tİ
(
L
) - 1;

415 
¡©us
 = 1;

416 ; 
Çrgs
--; 
¬g
++) {

417 ià(
	`lua_ty³
(
L
, 
¬g
è=ğ
LUA_TNUMBER
) {

419 
¡©us
 = status &&

420 
	`årštf
(
f
, 
LUA_NUMBER_FMT
, 
	`lua_tÚumb”
(
L
, 
¬g
)) > 0;

423 
size_t
 
l
;

424 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 
¬g
, &
l
);

425 
¡©us
 = stu && (
	`fwr™e
(
s
, (), 
l
, 
f
) ==†);

428  
	`push»suÉ
(
L
, 
¡©us
, 
NULL
);

429 
	}
}

432 
	$io_wr™e
 (
lua_S‹
 *
L
) {

433  
	`g_wr™e
(
L
, 
	`g‘iofe
(L, 
IO_OUTPUT
), 1);

434 
	}
}

437 
	$f_wr™e
 (
lua_S‹
 *
L
) {

438  
	`g_wr™e
(
L
, 
	`tofe
(L), 2);

439 
	}
}

442 
	$f_£ek
 (
lua_S‹
 *
L
) {

443 cÚ¡ 
mode
[] = {
SEEK_SET
, 
SEEK_CUR
, 
SEEK_END
};

444 cÚ¡ *cÚ¡ 
mod’ames
[] = {"£t", "cur", "’d", 
NULL
};

445 
FILE
 *
f
 = 
	`tofe
(
L
);

446 
İ
 = 
	`luaL_checkİtiÚ
(
L
, 2, "cur", 
mod’ames
);

447 
off£t
 = 
	`luaL_İÚg
(
L
, 3, 0);

448 
İ
 = 
	`f£ek
(
f
, 
off£t
, 
mode
[op]);

449 ià(
İ
)

450  
	`push»suÉ
(
L
, 0, 
NULL
);

452 
	`lua_pushš‹g”
(
L
, 
	`á–l
(
f
));

455 
	}
}

458 
	$f_£tvbuf
 (
lua_S‹
 *
L
) {

459 cÚ¡ 
mode
[] = {
_IONBF
, 
_IOFBF
, 
_IOLBF
};

460 cÚ¡ *cÚ¡ 
mod’ames
[] = {"no", "fuÎ", "lše", 
NULL
};

461 
FILE
 *
f
 = 
	`tofe
(
L
);

462 
İ
 = 
	`luaL_checkİtiÚ
(
L
, 2, 
NULL
, 
mod’ames
);

463 
lua_IÁeg”
 
sz
 = 
	`luaL_İtš‹g”
(
L
, 3, 
LUAL_BUFFERSIZE
);

464 
»s
 = 
	`£tvbuf
(
f
, 
NULL
, 
mode
[
İ
], 
sz
);

465  
	`push»suÉ
(
L
, 
»s
 =ğ0, 
NULL
);

466 
	}
}

470 
	$io_æush
 (
lua_S‹
 *
L
) {

471  
	`push»suÉ
(
L
, 
	`fæush
(
	`g‘iofe
(L, 
IO_OUTPUT
)è=ğ0, 
NULL
);

472 
	}
}

475 
	$f_æush
 (
lua_S‹
 *
L
) {

476  
	`push»suÉ
(
L
, 
	`fæush
(
	`tofe
(L)è=ğ0, 
NULL
);

477 
	}
}

480 cÚ¡ 
luaL_Reg
 
	giŞib
[] = {

481 {"şo£", 
io_şo£
},

482 {"æush", 
io_æush
},

483 {"šput", 
io_šput
},

484 {"lšes", 
io_lšes
},

485 {"İ’", 
io_İ’
},

486 {"ouut", 
io_ouut
},

487 {"pİ’", 
io_pİ’
},

488 {"»ad", 
io_»ad
},

489 {"tmpfe", 
io_tmpfe
},

490 {"ty³", 
io_ty³
},

491 {"wr™e", 
io_wr™e
},

492 {
NULL
, NULL}

496 cÚ¡ 
luaL_Reg
 
	gæib
[] = {

497 {"şo£", 
io_şo£
},

498 {"æush", 
f_æush
},

499 {"lšes", 
f_lšes
},

500 {"»ad", 
f_»ad
},

501 {"£ek", 
f_£ek
},

502 {"£tvbuf", 
f_£tvbuf
},

503 {"wr™e", 
f_wr™e
},

504 {"__gc", 
io_gc
},

505 {"__to¡ršg", 
io_to¡ršg
},

506 {
NULL
, NULL}

510 
	$ü—‹m‘a
 (
lua_S‹
 *
L
) {

511 
	`luaL_Ãwm‘©abË
(
L
, 
LUA_FILEHANDLE
);

512 
	`lua_pushv®ue
(
L
, -1);

513 
	`lua_£tf›ld
(
L
, -2, "__index");

514 
	`luaL_»gi¡”
(
L
, 
NULL
, 
æib
);

515 
	}
}

518 
	$ü—‹¡dfe
 (
lua_S‹
 *
L
, 
FILE
 *
f
, 
k
, cÚ¡ *
âame
) {

519 *
	`Ãwfe
(
L
èğ
f
;

520 ià(
k
 > 0) {

521 
	`lua_pushv®ue
(
L
, -1);

522 
	`lua_¿w£ti
(
L
, 
LUA_ENVIRONINDEX
, 
k
);

524 
	`lua_pushv®ue
(
L
, -2);

525 
	`lua_£tãnv
(
L
, -2);

526 
	`lua_£tf›ld
(
L
, -3, 
âame
);

527 
	}
}

530 
	$Ãwãnv
 (
lua_S‹
 *
L
, 
lua_CFunùiÚ
 
şs
) {

531 
	`lua_ü—‹bË
(
L
, 0, 1);

532 
	`lua_pushcfunùiÚ
(
L
, 
şs
);

533 
	`lua_£tf›ld
(
L
, -2, "__close");

534 
	}
}

537 
LUALIB_API
 
	$luaİ’_io
 (
lua_S‹
 *
L
) {

538 
	`ü—‹m‘a
(
L
);

540 
	`Ãwãnv
(
L
, 
io_fşo£
);

541 
	`lua_»¶aû
(
L
, 
LUA_ENVIRONINDEX
);

543 
	`luaL_»gi¡”
(
L
, 
LUA_IOLIBNAME
, 
iŞib
);

545 
	`Ãwãnv
(
L
, 
io_noşo£
);

546 
	`ü—‹¡dfe
(
L
, 
¡dš
, 
IO_INPUT
, "stdin");

547 
	`ü—‹¡dfe
(
L
, 
¡dout
, 
IO_OUTPUT
, "stdout");

548 
	`ü—‹¡dfe
(
L
, 
¡d”r
, 0, "stderr");

549 
	`lua_pİ
(
L
, 1);

550 
	`lua_g‘f›ld
(
L
, -1, "popen");

551 
	`Ãwãnv
(
L
, 
io_pşo£
);

552 
	`lua_£tãnv
(
L
, -2);

553 
	`lua_pİ
(
L
, 1);

555 
	}
}

	@deps/lua/src/llex.c

8 
	~<ùy³.h
>

9 
	~<loÿË.h
>

10 
	~<¡ršg.h
>

12 
	#Îex_c


	)

13 
	#LUA_CORE


	)

15 
	~"lua.h
"

17 
	~"ldo.h
"

18 
	~"Îex.h
"

19 
	~"lobjeù.h
"

20 
	~"Í¬£r.h
"

21 
	~"l¡©e.h
"

22 
	~"l¡ršg.h
"

23 
	~"ÉabË.h
"

24 
	~"lzio.h
"

28 
	#Ãxt
(
ls
èÖs->
cu¼’t
 = 
	`zg‘c
Ös->
z
))

	)

33 
	#cu¼IsNewlše
(
ls
èÖs->
cu¼’t
 =ğ'\n' ||†s->cu¼’ˆ=ğ'\r')

	)

37 cÚ¡ *cÚ¡ 
	gluaX_tok’s
 [] = {

44 
NULL


48 
	#§ve_ªd_Ãxt
(
ls
è(
	`§ve
Ös,†s->
cu¼’t
), 
	`Ãxt
Ös))

	)

51 
	$§ve
 (
LexS‹
 *
ls
, 
c
) {

52 
Mbufãr
 *
b
 = 
ls
->
buff
;

53 ià(
b
->
n
 + 1 > b->
buffsize
) {

54 
size_t
 
Ãwsize
;

55 ià(
b
->
buffsize
 >ğ
MAX_SIZET
/2)

56 
	`luaX_Ëx”rÜ
(
ls
, "lexicalƒlementoo†ong", 0);

57 
Ãwsize
 = 
b
->
buffsize
 * 2;

58 
	`luaZ_»sizebufãr
(
ls
->
L
, 
b
, 
Ãwsize
);

60 
b
->
bufãr
[b->
n
++] = 
	`ÿ¡
(, 
c
);

61 
	}
}

64 
	$luaX_š™
 (
lua_S‹
 *
L
) {

65 
i
;

66 
i
=0; i<
NUM_RESERVED
; i++) {

67 
TSŒšg
 *
ts
 = 
	`luaS_Ãw
(
L
, 
luaX_tok’s
[
i
]);

68 
	`luaS_fix
(
ts
);

69 
	`lua_as£¹
(
	`¡¾’
(
luaX_tok’s
[
i
])+1 <ğ
TOKEN_LEN
);

70 
ts
->
tsv
.
»£rved
 = 
	`ÿ¡_by‹
(
i
+1);

72 
	}
}

75 
	#MAXSRC
 80

	)

78 cÚ¡ *
	$luaX_tok’2¡r
 (
LexS‹
 *
ls
, 
tok’
) {

79 ià(
tok’
 < 
FIRST_RESERVED
) {

80 
	`lua_as£¹
(
tok’
 =ğ
	`ÿ¡
(,oken));

81  (
	`isúŒl
(
tok’
)è? 
	`luaO_pushf¡ršg
(
ls
->
L
, "char(%d)",oken) :

82 
	`luaO_pushf¡ršg
(
ls
->
L
, "%c", 
tok’
);

85  
luaX_tok’s
[
tok’
-
FIRST_RESERVED
];

86 
	}
}

89 cÚ¡ *
	$txtTok’
 (
LexS‹
 *
ls
, 
tok’
) {

90 
tok’
) {

91 
TK_NAME
:

92 
TK_STRING
:

93 
TK_NUMBER
:

94 
	`§ve
(
ls
, '\0');

95  
	`luaZ_bufãr
(
ls
->
buff
);

97  
	`luaX_tok’2¡r
(
ls
, 
tok’
);

99 
	}
}

102 
	$luaX_Ëx”rÜ
 (
LexS‹
 *
ls
, cÚ¡ *
msg
, 
tok’
) {

103 
buff
[
MAXSRC
];

104 
	`luaO_chunkid
(
buff
, 
	`g‘¡r
(
ls
->
sourû
), 
MAXSRC
);

105 
msg
 = 
	`luaO_pushf¡ršg
(
ls
->
L
, "%s:%d: %s", 
buff
,†s->
lš’umb”
, msg);

106 ià(
tok’
)

107 
	`luaO_pushf¡ršg
(
ls
->
L
, "% Ã¬ " 
LUA_QS
, 
msg
, 
	`txtTok’
Ös, 
tok’
));

108 
	`luaD_throw
(
ls
->
L
, 
LUA_ERRSYNTAX
);

109 
	}
}

112 
	$luaX_syÁax”rÜ
 (
LexS‹
 *
ls
, cÚ¡ *
msg
) {

113 
	`luaX_Ëx”rÜ
(
ls
, 
msg
,†s->
t
.
tok’
);

114 
	}
}

117 
TSŒšg
 *
	$luaX_Ãw¡ršg
 (
LexS‹
 *
ls
, cÚ¡ *
¡r
, 
size_t
 
l
) {

118 
lua_S‹
 *
L
 = 
ls
->L;

119 
TSŒšg
 *
ts
 = 
	`luaS_Ãwl¡r
(
L
, 
¡r
, 
l
);

120 
TV®ue
 *
o
 = 
	`luaH_£t¡r
(
L
, 
ls
->
fs
->
h
, 
ts
);

121 ià(
	`‰i¢
(
o
)) {

122 
	`£tbv®ue
(
o
, 1);

123 
	`luaC_checkGC
(
L
);

125  
ts
;

126 
	}
}

129 
	$šşš’umb”
 (
LexS‹
 *
ls
) {

130 
Şd
 = 
ls
->
cu¼’t
;

131 
	`lua_as£¹
(
	`cu¼IsNewlše
(
ls
));

132 
	`Ãxt
(
ls
);

133 ià(
	`cu¼IsNewlše
(
ls
è&&†s->
cu¼’t
 !ğ
Şd
)

134 
	`Ãxt
(
ls
);

135 ià(++
ls
->
lš’umb”
 >ğ
MAX_INT
)

136 
	`luaX_syÁax”rÜ
(
ls
, "chunk hasoo many†ines");

137 
	}
}

140 
	$luaX_£tšput
 (
lua_S‹
 *
L
, 
LexS‹
 *
ls
, 
ZIO
 *
z
, 
TSŒšg
 *
sourû
) {

141 
ls
->
deıošt
 = '.';

142 
ls
->
L
 = L;

143 
ls
->
lookah—d
.
tok’
 = 
TK_EOS
;

144 
ls
->
z
 = z;

145 
ls
->
fs
 = 
NULL
;

146 
ls
->
lš’umb”
 = 1;

147 
ls
->
Ï¡lše
 = 1;

148 
ls
->
sourû
 = source;

149 
	`luaZ_»sizebufãr
(
ls
->
L
,†s->
buff
, 
LUA_MINBUFFER
);

150 
	`Ãxt
(
ls
);

151 
	}
}

163 
	$check_Ãxt
 (
LexS‹
 *
ls
, cÚ¡ *
£t
) {

164 ià(!
	`¡rchr
(
£t
, 
ls
->
cu¼’t
))

166 
	`§ve_ªd_Ãxt
(
ls
);

168 
	}
}

171 
	$bufä•Ïû
 (
LexS‹
 *
ls
, 
äom
, 
to
) {

172 
size_t
 
n
 = 
	`luaZ_bufæ’
(
ls
->
buff
);

173 *
p
 = 
	`luaZ_bufãr
(
ls
->
buff
);

174 
n
--)

175 ià(
p
[
n
] =ğ
äom
èp[n] = 
to
;

176 
	}
}

179 
	$Œydeıošt
 (
LexS‹
 *
ls
, 
SemInfo
 *
£mšfo
) {

181 
lcÚv
 *
cv
 = 
	`loÿËcÚv
();

182 
Şd
 = 
ls
->
deıošt
;

183 
ls
->
deıošt
 = (
cv
 ? cv->
decim®_pošt
[0] : '.');

184 
	`bufä•Ïû
(
ls
, 
Şd
,†s->
deıošt
);

185 ià(!
	`luaO_¡r2d
(
	`luaZ_bufãr
(
ls
->
buff
), &
£mšfo
->
r
)) {

187 
	`bufä•Ïû
(
ls
,†s->
deıošt
, '.');

188 
	`luaX_Ëx”rÜ
(
ls
, "m®fÜmed‚umb”", 
TK_NUMBER
);

190 
	}
}

194 
	$»ad_num”®
 (
LexS‹
 *
ls
, 
SemInfo
 *
£mšfo
) {

195 
	`lua_as£¹
(
	`isdig™
(
ls
->
cu¼’t
));

197 
	`§ve_ªd_Ãxt
(
ls
);

198 } 
	`isdig™
(
ls
->
cu¼’t
) ||†s->current == '.');

199 ià(
	`check_Ãxt
(
ls
, "Ee"))

200 
	`check_Ãxt
(
ls
, "+-");

201 
	`i§Êum
(
ls
->
cu¼’t
) ||†s->current == '_')

202 
	`§ve_ªd_Ãxt
(
ls
);

203 
	`§ve
(
ls
, '\0');

204 
	`bufä•Ïû
(
ls
, '.',†s->
deıošt
);

205 ià(!
	`luaO_¡r2d
(
	`luaZ_bufãr
(
ls
->
buff
), &
£mšfo
->
r
))

206 
	`Œydeıošt
(
ls
, 
£mšfo
);

207 
	}
}

210 
	$sk_£p
 (
LexS‹
 *
ls
) {

211 
couÁ
 = 0;

212 
s
 = 
ls
->
cu¼’t
;

213 
	`lua_as£¹
(
s
 == '[' || s == ']');

214 
	`§ve_ªd_Ãxt
(
ls
);

215 
ls
->
cu¼’t
 == '=') {

216 
	`§ve_ªd_Ãxt
(
ls
);

217 
couÁ
++;

219  (
ls
->
cu¼’t
 =ğ
s
è? 
couÁ
 : (-count) - 1;

220 
	}
}

223 
	$»ad_lÚg_¡ršg
 (
LexS‹
 *
ls
, 
SemInfo
 *
£mšfo
, 
£p
) {

224 
cÚt
 = 0;

225 ()(
cÚt
);

226 
	`§ve_ªd_Ãxt
(
ls
);

227 ià(
	`cu¼IsNewlše
(
ls
))

228 
	`šşš’umb”
(
ls
);

230 
ls
->
cu¼’t
) {

231 
EOZ
:

232 
	`luaX_Ëx”rÜ
(
ls
, (
£mšfo
) ? "unfinished†ong string" :

233 "unfšished†Úg comm’t", 
TK_EOS
);

235 #ià
	`defšed
(
LUA_COMPAT_LSTR
)

237 ià(
	`sk_£p
(
ls
è=ğ
£p
) {

238 
	`§ve_ªd_Ãxt
(
ls
);

239 
cÚt
++;

240 #ià
LUA_COMPAT_LSTR
 == 1

241 ià(
£p
 == 0)

242 
	`luaX_Ëx”rÜ
(
ls
, "nesting of [[...]] is deprecated", '[');

249 ià(
	`sk_£p
(
ls
è=ğ
£p
) {

250 
	`§ve_ªd_Ãxt
(
ls
);

251 #ià
	`defšed
(
LUA_COMPAT_LSTR
) && LUA_COMPAT_LSTR == 2

252 
cÚt
--;

253 ià(
£p
 =ğ0 && 
cÚt
 >= 0) ;

255 
’dloİ
;

261 
	`§ve
(
ls
, '\n');

262 
	`šşš’umb”
(
ls
);

263 ià(!
£mšfo
è
	`luaZ_»£tbufãr
(
ls
->
buff
);

267 ià(
£mšfo
è
	`§ve_ªd_Ãxt
(
ls
);

268 
	`Ãxt
(
ls
);

271 } 
’dloİ
:

272 ià(
£mšfo
)

273 
£mšfo
->
ts
 = 
	`luaX_Ãw¡ršg
(
ls
, 
	`luaZ_bufãr
Ös->
buff
è+ (2 + 
£p
),

274 
	`luaZ_bufæ’
(
ls
->
buff
è- 2*(2 + 
£p
));

275 
	}
}

278 
	$»ad_¡ršg
 (
LexS‹
 *
ls
, 
d–
, 
SemInfo
 *
£mšfo
) {

279 
	`§ve_ªd_Ãxt
(
ls
);

280 
ls
->
cu¼’t
 !ğ
d–
) {

281 
ls
->
cu¼’t
) {

282 
EOZ
:

283 
	`luaX_Ëx”rÜ
(
ls
, "unfšished sŒšg", 
TK_EOS
);

287 
	`luaX_Ëx”rÜ
(
ls
, "unfšished sŒšg", 
TK_STRING
);

290 
c
;

291 
	`Ãxt
(
ls
);

292 
ls
->
cu¼’t
) {

293 'a': 
c
 = '\a'; ;

294 'b': 
c
 = '\b'; ;

295 'f': 
c
 = '\f'; ;

296 'n': 
c
 = '\n'; ;

297 'r': 
c
 = '\r'; ;

298 't': 
c
 = '\t'; ;

299 'v': 
c
 = '\v'; ;

301 '\r': 
	`§ve
(
ls
, '\n'); 
	`šşš’umb”
(ls); ;

302 
EOZ
: ;

304 ià(!
	`isdig™
(
ls
->
cu¼’t
))

305 
	`§ve_ªd_Ãxt
(
ls
);

307 
i
 = 0;

308 
c
 = 0;

310 
c
 = 10*ø+ (
ls
->
cu¼’t
-'0');

311 
	`Ãxt
(
ls
);

312 } ++
i
<3 && 
	`isdig™
(
ls
->
cu¼’t
));

313 ià(
c
 > 
UCHAR_MAX
)

314 
	`luaX_Ëx”rÜ
(
ls
, "esÿ³ sequ’ûoØÏrge", 
TK_STRING
);

315 
	`§ve
(
ls
, 
c
);

320 
	`§ve
(
ls
, 
c
);

321 
	`Ãxt
(
ls
);

325 
	`§ve_ªd_Ãxt
(
ls
);

328 
	`§ve_ªd_Ãxt
(
ls
);

329 
£mšfo
->
ts
 = 
	`luaX_Ãw¡ršg
(
ls
, 
	`luaZ_bufãr
Ös->
buff
) + 1,

330 
	`luaZ_bufæ’
(
ls
->
buff
) - 2);

331 
	}
}

334 
	$Îex
 (
LexS‹
 *
ls
, 
SemInfo
 *
£mšfo
) {

335 
	`luaZ_»£tbufãr
(
ls
->
buff
);

337 
ls
->
cu¼’t
) {

340 
	`šşš’umb”
(
ls
);

344 
	`Ãxt
(
ls
);

345 ià(
ls
->
cu¼’t
 != '-')  '-';

347 
	`Ãxt
(
ls
);

348 ià(
ls
->
cu¼’t
 == '[') {

349 
£p
 = 
	`sk_£p
(
ls
);

350 
	`luaZ_»£tbufãr
(
ls
->
buff
);

351 ià(
£p
 >= 0) {

352 
	`»ad_lÚg_¡ršg
(
ls
, 
NULL
, 
£p
);

353 
	`luaZ_»£tbufãr
(
ls
->
buff
);

358 !
	`cu¼IsNewlše
(
ls
è&&†s->
cu¼’t
 !ğ
EOZ
)

359 
	`Ãxt
(
ls
);

363 
£p
 = 
	`sk_£p
(
ls
);

364 ià(
£p
 >= 0) {

365 
	`»ad_lÚg_¡ršg
(
ls
, 
£mšfo
, 
£p
);

366  
TK_STRING
;

368 ià(
£p
 == -1)  '[';

369 
	`luaX_Ëx”rÜ
(
ls
, "šv®id†Úg sŒšg d–im™”", 
TK_STRING
);

372 
	`Ãxt
(
ls
);

373 ià(
ls
->
cu¼’t
 != '=')  '=';

374 { 
	`Ãxt
(
ls
);  
TK_EQ
; }

377 
	`Ãxt
(
ls
);

378 ià(
ls
->
cu¼’t
 != '=')  '<';

379 { 
	`Ãxt
(
ls
);  
TK_LE
; }

382 
	`Ãxt
(
ls
);

383 ià(
ls
->
cu¼’t
 != '=')  '>';

384 { 
	`Ãxt
(
ls
);  
TK_GE
; }

387 
	`Ãxt
(
ls
);

388 ià(
ls
->
cu¼’t
 != '=')  '~';

389 { 
	`Ãxt
(
ls
);  
TK_NE
; }

393 
	`»ad_¡ršg
(
ls
,†s->
cu¼’t
, 
£mšfo
);

394  
TK_STRING
;

397 
	`§ve_ªd_Ãxt
(
ls
);

398 ià(
	`check_Ãxt
(
ls
, ".")) {

399 ià(
	`check_Ãxt
(
ls
, "."))

400  
TK_DOTS
;

401  
TK_CONCAT
;

403 ià(!
	`isdig™
(
ls
->
cu¼’t
))  '.';

405 
	`»ad_num”®
(
ls
, 
£mšfo
);

406  
TK_NUMBER
;

409 
EOZ
: {

410  
TK_EOS
;

413 ià(
	`is¥aû
(
ls
->
cu¼’t
)) {

414 
	`lua_as£¹
(!
	`cu¼IsNewlše
(
ls
));

415 
	`Ãxt
(
ls
);

418 ià(
	`isdig™
(
ls
->
cu¼’t
)) {

419 
	`»ad_num”®
(
ls
, 
£mšfo
);

420  
TK_NUMBER
;

422 ià(
	`i§Íha
(
ls
->
cu¼’t
) ||†s->current == '_') {

424 
TSŒšg
 *
ts
;

426 
	`§ve_ªd_Ãxt
(
ls
);

427 } 
	`i§Êum
(
ls
->
cu¼’t
) ||†s->current == '_');

428 
ts
 = 
	`luaX_Ãw¡ršg
(
ls
, 
	`luaZ_bufãr
Ös->
buff
),

429 
	`luaZ_bufæ’
(
ls
->
buff
));

430 ià(
ts
->
tsv
.
»£rved
 > 0)

431  
ts
->
tsv
.
»£rved
 - 1 + 
FIRST_RESERVED
;

433 
£mšfo
->
ts
 =s;

434  
TK_NAME
;

438 
c
 = 
ls
->
cu¼’t
;

439 
	`Ãxt
(
ls
);

440  
c
;

445 
	}
}

448 
	$luaX_Ãxt
 (
LexS‹
 *
ls
) {

449 
ls
->
Ï¡lše
 =†s->
lš’umb”
;

450 ià(
ls
->
lookah—d
.
tok’
 !ğ
TK_EOS
) {

451 
ls
->
t
 =†s->
lookah—d
;

452 
ls
->
lookah—d
.
tok’
 = 
TK_EOS
;

455 
ls
->
t
.
tok’
 = 
	`Îex
Ös, &ls->t.
£mšfo
);

456 
	}
}

459 
	$luaX_lookah—d
 (
LexS‹
 *
ls
) {

460 
	`lua_as£¹
(
ls
->
lookah—d
.
tok’
 =ğ
TK_EOS
);

461 
ls
->
lookah—d
.
tok’
 = 
	`Îex
Ös, &ls->lookah—d.
£mšfo
);

462 
	}
}

	@deps/lua/src/llex.h

7 #iâdeà
Îex_h


8 
	#Îex_h


	)

10 
	~"lobjeù.h
"

11 
	~"lzio.h
"

14 
	#FIRST_RESERVED
 257

	)

17 
	#TOKEN_LEN
 (("funùiÚ")/())

	)

24 
	eRESERVED
 {

26 
	mTK_AND
 = 
FIRST_RESERVED
, 
	mTK_BREAK
,

27 
	mTK_DO
, 
	mTK_ELSE
, 
	mTK_ELSEIF
, 
	mTK_END
, 
	mTK_FALSE
, 
	mTK_FOR
, 
	mTK_FUNCTION
,

28 
	mTK_IF
, 
	mTK_IN
, 
	mTK_LOCAL
, 
	mTK_NIL
, 
	mTK_NOT
, 
	mTK_OR
, 
	mTK_REPEAT
,

29 
	mTK_RETURN
, 
	mTK_THEN
, 
	mTK_TRUE
, 
	mTK_UNTIL
, 
	mTK_WHILE
,

31 
	mTK_CONCAT
, 
	mTK_DOTS
, 
	mTK_EQ
, 
	mTK_GE
, 
	mTK_LE
, 
	mTK_NE
, 
	mTK_NUMBER
,

32 
	mTK_NAME
, 
	mTK_STRING
, 
	mTK_EOS


36 
	#NUM_RESERVED
 (
	`ÿ¡
(, 
TK_WHILE
-
FIRST_RESERVED
+1))

	)

40 
LUAI_DATA
 cÚ¡ *cÚ¡ 
	gluaX_tok’s
 [];

44 
lua_Numb”
 
	mr
;

45 
TSŒšg
 *
	mts
;

46 } 
	tSemInfo
;

49 
	sTok’
 {

50 
	mtok’
;

51 
SemInfo
 
	m£mšfo
;

52 } 
	tTok’
;

55 
	sLexS‹
 {

56 
	mcu¼’t
;

57 
	mlš’umb”
;

58 
	mÏ¡lše
;

59 
Tok’
 
	mt
;

60 
Tok’
 
	mlookah—d
;

61 
FuncS‹
 *
	mfs
;

62 
lua_S‹
 *
	mL
;

63 
ZIO
 *
	mz
;

64 
Mbufãr
 *
	mbuff
;

65 
TSŒšg
 *
	msourû
;

66 
	mdeıošt
;

67 } 
	tLexS‹
;

70 
LUAI_FUNC
 
luaX_š™
 (
lua_S‹
 *
L
);

71 
LUAI_FUNC
 
luaX_£tšput
 (
lua_S‹
 *
L
, 
LexS‹
 *
ls
, 
ZIO
 *
z
,

72 
TSŒšg
 *
sourû
);

73 
LUAI_FUNC
 
TSŒšg
 *
luaX_Ãw¡ršg
 (
LexS‹
 *
ls
, cÚ¡ *
¡r
, 
size_t
 
l
);

74 
LUAI_FUNC
 
luaX_Ãxt
 (
LexS‹
 *
ls
);

75 
LUAI_FUNC
 
luaX_lookah—d
 (
LexS‹
 *
ls
);

76 
LUAI_FUNC
 
luaX_Ëx”rÜ
 (
LexS‹
 *
ls
, cÚ¡ *
msg
, 
tok’
);

77 
LUAI_FUNC
 
luaX_syÁax”rÜ
 (
LexS‹
 *
ls
, cÚ¡ *
s
);

78 
LUAI_FUNC
 cÚ¡ *
luaX_tok’2¡r
 (
LexS‹
 *
ls
, 
tok’
);

	@deps/lua/src/llimits.h

7 #iâdeà
Îim™s_h


8 
	#Îim™s_h


	)

11 
	~<lim™s.h
>

12 
	~<¡ddef.h
>

15 
	~"lua.h
"

18 
LUAI_UINT32
 
	tlu_št32
;

20 
LUAI_UMEM
 
	tlu_mem
;

22 
LUAI_MEM
 
	tl_mem
;

27 
	tlu_by‹
;

30 
	#MAX_SIZET
 ((
size_t
)(~(size_t)0)-2)

	)

32 
	#MAX_LUMEM
 ((
lu_mem
)(~Öu_mem)0)-2)

	)

35 
	#MAX_INT
 (
INT_MAX
-2è

	)

42 
	#IÁPošt
(
p
è(()(
lu_mem
)Õ))

	)

47 
LUAI_USER_ALIGNMENT_T
 
	tL_Umax®ign
;

51 
LUAI_UACNUMBER
 
	tl_uacNumb”
;

55 #ifdeà
lua_as£¹


57 
	#check_exp
(
c
,
e
è(
	`lua_as£¹
(c), (e))

	)

58 
	#­i_check
(
l
,
e
è
	`lua_as£¹
Ó)

	)

62 
	#lua_as£¹
(
c
è(()0)

	)

63 
	#check_exp
(
c
,
e
èÓ)

	)

64 
	#­i_check
 
luai_­icheck


	)

69 #iâdeà
UNUSED


70 
	#UNUSED
(
x
è(()(x)è

	)

74 #iâdeà
ÿ¡


75 
	#ÿ¡
(
t
, 
exp
è(Ñ)Óxp))

	)

78 
	#ÿ¡_by‹
(
i
è
	`ÿ¡
(
lu_by‹
, (i))

	)

79 
	#ÿ¡_num
(
i
è
	`ÿ¡
(
lua_Numb”
, (i))

	)

80 
	#ÿ¡_št
(
i
è
	`ÿ¡
(, (i))

	)

88 
lu_št32
 
	tIn¡ruùiÚ
;

93 
	#MAXSTACK
 250

	)

98 #iâdeà
MINSTRTABSIZE


99 
	#MINSTRTABSIZE
 32

	)

104 #iâdeà
LUA_MINBUFFER


105 
	#LUA_MINBUFFER
 32

	)

109 #iâdeà
lua_lock


110 
	#lua_lock
(
L
è((è0)

	)

111 
	#lua_uÆock
(
L
è((è0)

	)

114 #iâdeà
luai_th»ady›ld


115 
	#luai_th»ady›ld
(
L
è{
	`lua_uÆock
(L); 
	`lua_lock
(L);}

	)

122 #iâdeà
HARDSTACKTESTS


123 
	#cÚdh¬d¡ack‹¡s
(
x
è(()0)

	)

125 
	#cÚdh¬d¡ack‹¡s
(
x
è
	)
x

	@deps/lua/src/lmathlib.c

8 
	~<¡dlib.h
>

9 
	~<m©h.h
>

11 
	#lm©hlib_c


	)

12 
	#LUA_LIB


	)

14 
	~"lua.h
"

16 
	~"Ïuxlib.h
"

17 
	~"lu®ib.h
"

20 #undeà
PI


21 
	#PI
 (3.14159265358979323846)

	)

22 
	#RADIANS_PER_DEGREE
 (
PI
/180.0)

	)

26 
	$m©h_abs
 (
lua_S‹
 *
L
) {

27 
	`lua_pushnumb”
(
L
, 
	`çbs
(
	`luaL_checknumb”
(L, 1)));

29 
	}
}

31 
	$m©h_sš
 (
lua_S‹
 *
L
) {

32 
	`lua_pushnumb”
(
L
, 
	`sš
(
	`luaL_checknumb”
(L, 1)));

34 
	}
}

36 
	$m©h_sšh
 (
lua_S‹
 *
L
) {

37 
	`lua_pushnumb”
(
L
, 
	`sšh
(
	`luaL_checknumb”
(L, 1)));

39 
	}
}

41 
	$m©h_cos
 (
lua_S‹
 *
L
) {

42 
	`lua_pushnumb”
(
L
, 
	`cos
(
	`luaL_checknumb”
(L, 1)));

44 
	}
}

46 
	$m©h_cosh
 (
lua_S‹
 *
L
) {

47 
	`lua_pushnumb”
(
L
, 
	`cosh
(
	`luaL_checknumb”
(L, 1)));

49 
	}
}

51 
	$m©h_n
 (
lua_S‹
 *
L
) {

52 
	`lua_pushnumb”
(
L
, 
	`n
(
	`luaL_checknumb”
(L, 1)));

54 
	}
}

56 
	$m©h_nh
 (
lua_S‹
 *
L
) {

57 
	`lua_pushnumb”
(
L
, 
	`nh
(
	`luaL_checknumb”
(L, 1)));

59 
	}
}

61 
	$m©h_asš
 (
lua_S‹
 *
L
) {

62 
	`lua_pushnumb”
(
L
, 
	`asš
(
	`luaL_checknumb”
(L, 1)));

64 
	}
}

66 
	$m©h_acos
 (
lua_S‹
 *
L
) {

67 
	`lua_pushnumb”
(
L
, 
	`acos
(
	`luaL_checknumb”
(L, 1)));

69 
	}
}

71 
	$m©h_©ª
 (
lua_S‹
 *
L
) {

72 
	`lua_pushnumb”
(
L
, 
	`©ª
(
	`luaL_checknumb”
(L, 1)));

74 
	}
}

76 
	$m©h_©ª2
 (
lua_S‹
 *
L
) {

77 
	`lua_pushnumb”
(
L
, 
	`©ª2
(
	`luaL_checknumb”
(L, 1),†uaL_checknumber(L, 2)));

79 
	}
}

81 
	$m©h_û
 (
lua_S‹
 *
L
) {

82 
	`lua_pushnumb”
(
L
, 
	`û
(
	`luaL_checknumb”
(L, 1)));

84 
	}
}

86 
	$m©h_æoÜ
 (
lua_S‹
 *
L
) {

87 
	`lua_pushnumb”
(
L
, 
	`æoÜ
(
	`luaL_checknumb”
(L, 1)));

89 
	}
}

91 
	$m©h_fmod
 (
lua_S‹
 *
L
) {

92 
	`lua_pushnumb”
(
L
, 
	`fmod
(
	`luaL_checknumb”
(L, 1),†uaL_checknumber(L, 2)));

94 
	}
}

96 
	$m©h_modf
 (
lua_S‹
 *
L
) {

97 

;

98 
å
 = 
	`modf
(
	`luaL_checknumb”
(
L
, 1), &

);

99 
	`lua_pushnumb”
(
L
, 

);

100 
	`lua_pushnumb”
(
L
, 
å
);

102 
	}
}

104 
	$m©h_sq¹
 (
lua_S‹
 *
L
) {

105 
	`lua_pushnumb”
(
L
, 
	`sq¹
(
	`luaL_checknumb”
(L, 1)));

107 
	}
}

109 
	$m©h_pow
 (
lua_S‹
 *
L
) {

110 
	`lua_pushnumb”
(
L
, 
	`pow
(
	`luaL_checknumb”
(L, 1),†uaL_checknumber(L, 2)));

112 
	}
}

114 
	$m©h_log
 (
lua_S‹
 *
L
) {

115 
	`lua_pushnumb”
(
L
, 
	`log
(
	`luaL_checknumb”
(L, 1)));

117 
	}
}

119 
	$m©h_log10
 (
lua_S‹
 *
L
) {

120 
	`lua_pushnumb”
(
L
, 
	`log10
(
	`luaL_checknumb”
(L, 1)));

122 
	}
}

124 
	$m©h_exp
 (
lua_S‹
 *
L
) {

125 
	`lua_pushnumb”
(
L
, 
	`exp
(
	`luaL_checknumb”
(L, 1)));

127 
	}
}

129 
	$m©h_deg
 (
lua_S‹
 *
L
) {

130 
	`lua_pushnumb”
(
L
, 
	`luaL_checknumb”
(L, 1)/
RADIANS_PER_DEGREE
);

132 
	}
}

134 
	$m©h_¿d
 (
lua_S‹
 *
L
) {

135 
	`lua_pushnumb”
(
L
, 
	`luaL_checknumb”
(L, 1)*
RADIANS_PER_DEGREE
);

137 
	}
}

139 
	$m©h_äexp
 (
lua_S‹
 *
L
) {

140 
e
;

141 
	`lua_pushnumb”
(
L
, 
	`äexp
(
	`luaL_checknumb”
(L, 1), &
e
));

142 
	`lua_pushš‹g”
(
L
, 
e
);

144 
	}
}

146 
	$m©h_ldexp
 (
lua_S‹
 *
L
) {

147 
	`lua_pushnumb”
(
L
, 
	`ldexp
(
	`luaL_checknumb”
(L, 1), 
	`luaL_checkšt
(L, 2)));

149 
	}
}

153 
	$m©h_mš
 (
lua_S‹
 *
L
) {

154 
n
 = 
	`lua_g‘tİ
(
L
);

155 
lua_Numb”
 
dmš
 = 
	`luaL_checknumb”
(
L
, 1);

156 
i
;

157 
i
=2; i<=
n
; i++) {

158 
lua_Numb”
 
d
 = 
	`luaL_checknumb”
(
L
, 
i
);

159 ià(
d
 < 
dmš
)

160 
dmš
 = 
d
;

162 
	`lua_pushnumb”
(
L
, 
dmš
);

164 
	}
}

167 
	$m©h_max
 (
lua_S‹
 *
L
) {

168 
n
 = 
	`lua_g‘tİ
(
L
);

169 
lua_Numb”
 
dmax
 = 
	`luaL_checknumb”
(
L
, 1);

170 
i
;

171 
i
=2; i<=
n
; i++) {

172 
lua_Numb”
 
d
 = 
	`luaL_checknumb”
(
L
, 
i
);

173 ià(
d
 > 
dmax
)

174 
dmax
 = 
d
;

176 
	`lua_pushnumb”
(
L
, 
dmax
);

178 
	}
}

181 
	$m©h_¿ndom
 (
lua_S‹
 *
L
) {

184 
lua_Numb”
 
r
 = (lua_Numb”)(
	`¿nd
()%
RAND_MAX
) / (lua_Number)RAND_MAX;

185 
	`lua_g‘tİ
(
L
)) {

187 
	`lua_pushnumb”
(
L
, 
r
);

191 
u
 = 
	`luaL_checkšt
(
L
, 1);

192 
	`luaL_¬gcheck
(
L
, 1<=
u
, 1, "interval isƒmpty");

193 
	`lua_pushnumb”
(
L
, 
	`æoÜ
(
r
*
u
)+1);

197 
l
 = 
	`luaL_checkšt
(
L
, 1);

198 
u
 = 
	`luaL_checkšt
(
L
, 2);

199 
	`luaL_¬gcheck
(
L
, 
l
<=
u
, 2, "interval isƒmpty");

200 
	`lua_pushnumb”
(
L
, 
	`æoÜ
(
r
*(
u
-
l
+1))+l);

203 :  
	`luaL_”rÜ
(
L
, "wrong‚umber of‡rguments");

206 
	}
}

209 
	$m©h_¿ndom£ed
 (
lua_S‹
 *
L
) {

210 
	`¤ªd
(
	`luaL_checkšt
(
L
, 1));

212 
	}
}

215 cÚ¡ 
luaL_Reg
 
	gm©hlib
[] = {

216 {"abs", 
m©h_abs
},

217 {"acos", 
m©h_acos
},

218 {"asš", 
m©h_asš
},

219 {"©ª2", 
m©h_©ª2
},

220 {"©ª", 
m©h_©ª
},

221 {"û", 
m©h_û
},

222 {"cosh", 
m©h_cosh
},

223 {"cos", 
m©h_cos
},

224 {"deg", 
m©h_deg
},

225 {"exp", 
m©h_exp
},

226 {"æoÜ", 
m©h_æoÜ
},

227 {"fmod", 
m©h_fmod
},

228 {"äexp", 
m©h_äexp
},

229 {"ldexp", 
m©h_ldexp
},

230 {"log10", 
m©h_log10
},

231 {"log", 
m©h_log
},

232 {"max", 
m©h_max
},

233 {"mš", 
m©h_mš
},

234 {"modf", 
m©h_modf
},

235 {"pow", 
m©h_pow
},

236 {"¿d", 
m©h_¿d
},

237 {"¿ndom", 
m©h_¿ndom
},

238 {"¿ndom£ed", 
m©h_¿ndom£ed
},

239 {"sšh", 
m©h_sšh
},

240 {"sš", 
m©h_sš
},

241 {"sq¹", 
m©h_sq¹
},

242 {"nh", 
m©h_nh
},

243 {"n", 
m©h_n
},

244 {
NULL
, NULL}

251 
LUALIB_API
 
	$luaİ’_m©h
 (
lua_S‹
 *
L
) {

252 
	`luaL_»gi¡”
(
L
, 
LUA_MATHLIBNAME
, 
m©hlib
);

253 
	`lua_pushnumb”
(
L
, 
PI
);

254 
	`lua_£tf›ld
(
L
, -2, "pi");

255 
	`lua_pushnumb”
(
L
, 
HUGE_VAL
);

256 
	`lua_£tf›ld
(
L
, -2, "huge");

257 #ià
	`defšed
(
LUA_COMPAT_MOD
)

258 
	`lua_g‘f›ld
(
L
, -1, "fmod");

259 
	`lua_£tf›ld
(
L
, -2, "mod");

262 
	}
}

	@deps/lua/src/lmem.c

8 
	~<¡ddef.h
>

10 
	#lmem_c


	)

11 
	#LUA_CORE


	)

13 
	~"lua.h
"

15 
	~"ldebug.h
"

16 
	~"ldo.h
"

17 
	~"lmem.h
"

18 
	~"lobjeù.h
"

19 
	~"l¡©e.h
"

43 
	#MINSIZEARRAY
 4

	)

46 *
	$luaM_growaux_
 (
lua_S‹
 *
L
, *
block
, *
size
, 
size_t
 
size_–ems
,

47 
lim™
, cÚ¡ *
”rÜmsg
) {

48 *
Ãwblock
;

49 
Ãwsize
;

50 ià(*
size
 >ğ
lim™
/2) {

51 ià(*
size
 >ğ
lim™
)

52 
	`luaG_ruÃ¼Ü
(
L
, 
”rÜmsg
);

53 
Ãwsize
 = 
lim™
;

56 
Ãwsize
 = (*
size
)*2;

57 ià(
Ãwsize
 < 
MINSIZEARRAY
)

58 
Ãwsize
 = 
MINSIZEARRAY
;

60 
Ãwblock
 = 
	`luaM_»®locv
(
L
, 
block
, *
size
, 
Ãwsize
, 
size_–ems
);

61 *
size
 = 
Ãwsize
;

62  
Ãwblock
;

63 
	}
}

66 *
	$luaM_toobig
 (
lua_S‹
 *
L
) {

67 
	`luaG_ruÃ¼Ü
(
L
, "memory‡llocationƒrror: blockoo big");

68  
NULL
;

69 
	}
}

76 *
	$luaM_»®loc_
 (
lua_S‹
 *
L
, *
block
, 
size_t
 
osize
, size_ˆ
nsize
) {

77 
glob®_S‹
 *
g
 = 
	`G
(
L
);

78 
	`lua_as£¹
((
osize
 =ğ0è=ğ(
block
 =ğ
NULL
));

79 
block
 = (*
g
->
ä—Îoc
)(g->
ud
, block, 
osize
, 
nsize
);

80 ià(
block
 =ğ
NULL
 && 
nsize
 > 0)

81 
	`luaD_throw
(
L
, 
LUA_ERRMEM
);

82 
	`lua_as£¹
((
nsize
 =ğ0è=ğ(
block
 =ğ
NULL
));

83 
g
->
tÙ®by‹s
 = (g->tÙ®by‹ - 
osize
è+ 
nsize
;

84  
block
;

85 
	}
}

	@deps/lua/src/lmem.h

7 #iâdeà
lmem_h


8 
	#lmem_h


	)

11 
	~<¡ddef.h
>

13 
	~"Îim™s.h
"

14 
	~"lua.h
"

16 
	#MEMERRMSG
 "nÙƒnough memÜy"

	)

19 
	#luaM_»®locv
(
L
,
b
,
Ú
,
n
,
e
) \

20 ((
	`ÿ¡
(
size_t
, (
n
)+1è<ğ
MAX_SIZET
/(
e
)) ? \

21 
	`luaM_»®loc_
(
L
, (
b
), (
Ú
)*(
e
), (
n
)*(e)) : \

22 
	`luaM_toobig
(
L
))

	)

24 
	#luaM_ä“mem
(
L
, 
b
, 
s
è
	`luaM_»®loc_
(L, (b), (s), 0)

	)

25 
	#luaM_ä“
(
L
, 
b
è
	`luaM_»®loc_
(L, (b), (*(b)), 0)

	)

26 
	#luaM_ä“¬¿y
(
L
, 
b
, 
n
, 
t
è
	`luaM_»®locv
(L, (b),‚, 0, Ñ))

	)

28 
	#luaM_m®loc
(
L
,
t
è
	`luaM_»®loc_
(L, 
NULL
, 0, (t))

	)

29 
	#luaM_Ãw
(
L
,
t
è
	`ÿ¡
Ñ *, 
	`luaM_m®loc
(L, Ñ)))

	)

30 
	#luaM_ÃwveùÜ
(
L
,
n
,
t
) \

31 
	`ÿ¡
(
t
 *, 
	`luaM_»®locv
(
L
, 
NULL
, 0, 
n
, Ñ)))

	)

33 
	#luaM_growveùÜ
(
L
,
v
,
ÃËms
,
size
,
t
,
lim™
,
e
) \

34 ià((
ÃËms
)+1 > (
size
)) \

35 ((
v
)=
	`ÿ¡
(
t
 *, 
	`luaM_growaux_
(
L
,v,&(
size
),Ñ),
lim™
,
e
)))

	)

37 
	#luaM_»®locveùÜ
(
L
, 
v
,
Şdn
,
n
,
t
) \

38 ((
v
)=
	`ÿ¡
(
t
 *, 
	`luaM_»®locv
(
L
, v, 
Şdn
, 
n
, Ñ))))

	)

41 
LUAI_FUNC
 *
luaM_»®loc_
 (
lua_S‹
 *
L
, *
block
, 
size_t
 
Şdsize
,

42 
size_t
 
size
);

43 
LUAI_FUNC
 *
luaM_toobig
 (
lua_S‹
 *
L
);

44 
LUAI_FUNC
 *
luaM_growaux_
 (
lua_S‹
 *
L
, *
block
, *
size
,

45 
size_t
 
size_–em
, 
lim™
,

46 cÚ¡ *
”rÜmsg
);

	@deps/lua/src/loadlib.c

12 
	~<¡dlib.h
>

13 
	~<¡ršg.h
>

16 
	#lßdlib_c


	)

17 
	#LUA_LIB


	)

19 
	~"lua.h
"

21 
	~"Ïuxlib.h
"

22 
	~"lu®ib.h
"

26 
	#LUA_POF
 "luaİ’_"

	)

29 
	#LUA_OFSEP
 "_"

	)

32 
	#LIBPREFIX
 "LOADLIB: "

	)

34 
	#POF
 
LUA_POF


	)

35 
	#LIB_FAIL
 "İ’"

	)

39 
	#ERRLIB
 1

	)

40 
	#ERRFUNC
 2

	)

42 
	#£rogdœ
(
L
è(()0)

	)

45 
Î_uÆßdlib
 (*
lib
);

46 *
Î_lßd
 (
lua_S‹
 *
L
, cÚ¡ *
·th
);

47 
lua_CFunùiÚ
 
Î_sym
 (
lua_S‹
 *
L
, *
lib
, cÚ¡ *
sym
);

51 #ià
defšed
(
LUA_DL_DLOPEN
)

61 
	~<dlfú.h
>

63 
	$Î_uÆßdlib
 (*
lib
) {

64 
	`dlşo£
(
lib
);

65 
	}
}

68 *
	$Î_lßd
 (
lua_S‹
 *
L
, cÚ¡ *
·th
) {

69 *
lib
 = 
	`dlİ’
(
·th
, 
RTLD_NOW
);

70 ià(
lib
 =ğ
NULL
è
	`lua_push¡ršg
(
L
, 
	`dË¼Ü
());

71  
lib
;

72 
	}
}

75 
lua_CFunùiÚ
 
	$Î_sym
 (
lua_S‹
 *
L
, *
lib
, cÚ¡ *
sym
) {

76 
lua_CFunùiÚ
 
f
 = (lua_CFunùiÚ)
	`dlsym
(
lib
, 
sym
);

77 ià(
f
 =ğ
NULL
è
	`lua_push¡ršg
(
L
, 
	`dË¼Ü
());

78  
f
;

79 
	}
}

85 #–ià
defšed
(
LUA_DL_DLL
)

92 
	~<wšdows.h
>

95 #undeà
£rogdœ


97 
	$£rogdœ
 (
lua_S‹
 *
L
) {

98 
buff
[
MAX_PATH
 + 1];

99 *
lb
;

100 
DWORD
 
nsize
 = (
buff
)/();

101 
DWORD
 
n
 = 
	`G‘ModuËFeNameA
(
NULL
, 
buff
, 
nsize
);

102 ià(
n
 =ğ0 ||‚ =ğ
nsize
 || (
lb
 = 
	`¡¼chr
(
buff
, '\\')è=ğ
NULL
)

103 
	`luaL_”rÜ
(
L
, "unableo get ModuleFileName");

105 *
lb
 = '\0';

106 
	`luaL_gsub
(
L
, 
	`lua_to¡ršg
(L, -1), 
LUA_EXECDIR
, 
buff
);

107 
	`lua_»move
(
L
, -2);

109 
	}
}

112 
	$push”rÜ
 (
lua_S‹
 *
L
) {

113 
”rÜ
 = 
	`G‘La¡E¼Ü
();

114 
bufãr
[128];

115 ià(
	`FÜm©Mes§geA
(
FORMAT_MESSAGE_IGNORE_INSERTS
 | 
FORMAT_MESSAGE_FROM_SYSTEM
,

116 
NULL
, 
”rÜ
, 0, 
bufãr
, (buffer), NULL))

117 
	`lua_push¡ršg
(
L
, 
bufãr
);

119 
	`lua_pushf¡ršg
(
L
, "sy¡emƒ¼Ü %d\n", 
”rÜ
);

120 
	}
}

122 
	$Î_uÆßdlib
 (*
lib
) {

123 
	`F»eLib¿ry
((
HINSTANCE
)
lib
);

124 
	}
}

127 *
	$Î_lßd
 (
lua_S‹
 *
L
, cÚ¡ *
·th
) {

128 
HINSTANCE
 
lib
 = 
	`LßdLib¿ryA
(
·th
);

129 ià(
lib
 =ğ
NULL
è
	`push”rÜ
(
L
);

130  
lib
;

131 
	}
}

134 
lua_CFunùiÚ
 
	$Î_sym
 (
lua_S‹
 *
L
, *
lib
, cÚ¡ *
sym
) {

135 
lua_CFunùiÚ
 
f
 = (lua_CFunùiÚ)
	`G‘ProcAdd»ss
((
HINSTANCE
)
lib
, 
sym
);

136 ià(
f
 =ğ
NULL
è
	`push”rÜ
(
L
);

137  
f
;

138 
	}
}

144 #–ià
defšed
(
LUA_DL_DYLD
)

151 
	~<mach-o/dyld.h
>

155 #undeà
POF


156 
	#POF
 "_" 
LUA_POF


	)

159 
	$push”rÜ
 (
lua_S‹
 *
L
) {

160 cÚ¡ *
”r_¡r
;

161 cÚ¡ *
”r_fe
;

162 
NSLškEd™E¼Üs
 
”r
;

163 
”r_num
;

164 
	`NSLškEd™E¼Ü
(&
”r
, &
”r_num
, &
”r_fe
, &
”r_¡r
);

165 
	`lua_push¡ršg
(
L
, 
”r_¡r
);

166 
	}
}

169 cÚ¡ *
	$”rÜäomcode
 (
NSObjeùFeImageR‘uºCode
 
»t
) {

170 
»t
) {

171 
NSObjeùFeImageIÇµrİrŸ‹Fe
:

173 
NSObjeùFeImageArch
:

175 
NSObjeùFeImageFÜm©
:

177 
NSObjeùFeImageAcûss
:

179 
NSObjeùFeImageFau»
:

183 
	}
}

186 
	$Î_uÆßdlib
 (*
lib
) {

187 
	`NSUnLškModuË
((
NSModuË
)
lib
, 
NSUNLINKMODULE_OPTION_RESET_LAZY_REFERENCES
);

188 
	}
}

191 *
	$Î_lßd
 (
lua_S‹
 *
L
, cÚ¡ *
·th
) {

192 
NSObjeùFeImage
 
img
;

193 
NSObjeùFeImageR‘uºCode
 
»t
;

195 if(!
	`_dyld_´e£Á
()) {

196 
	`lua_pushl™”®
(
L
, "dyld‚ot…resent");

197  
NULL
;

199 
»t
 = 
	`NSC»©eObjeùFeImageFromFe
(
·th
, &
img
);

200 ià(
»t
 =ğ
NSObjeùFeImageSucûss
) {

201 
NSModuË
 
mod
 = 
	`NSLškModuË
(
img
, 
·th
, 
NSLINKMODULE_OPTION_PRIVATE
 |

202 
NSLINKMODULE_OPTION_RETURN_ON_ERROR
);

203 
	`NSDe¡royObjeùFeImage
(
img
);

204 ià(
mod
 =ğ
NULL
è
	`push”rÜ
(
L
);

205  
mod
;

207 
	`lua_push¡ršg
(
L
, 
	`”rÜäomcode
(
»t
));

208  
NULL
;

209 
	}
}

212 
lua_CFunùiÚ
 
	$Î_sym
 (
lua_S‹
 *
L
, *
lib
, cÚ¡ *
sym
) {

213 
NSSymbŞ
 
nss
 = 
	`NSLookupSymbŞInModuË
((
NSModuË
)
lib
, 
sym
);

214 ià(
nss
 =ğ
NULL
) {

215 
	`lua_pushf¡ršg
(
L
, "symbŞ " 
LUA_QS
 "‚Ù found", 
sym
);

216  
NULL
;

218  (
lua_CFunùiÚ
)
	`NSAdd»ssOfSymbŞ
(
nss
);

219 
	}
}

232 #undeà
LIB_FAIL


233 
	#LIB_FAIL
 "ab£Á"

	)

236 
	#DLMSG
 "dyÇmiølib¿r› nÙƒÇbËd; check you¸Lu¨š¡®ÏtiÚ"

	)

239 
	$Î_uÆßdlib
 (*
lib
) {

240 ()
lib
;

241 
	}
}

244 *
	$Î_lßd
 (
lua_S‹
 *
L
, cÚ¡ *
·th
) {

245 ()
·th
;

246 
	`lua_pushl™”®
(
L
, 
DLMSG
);

247  
NULL
;

248 
	}
}

251 
lua_CFunùiÚ
 
	$Î_sym
 (
lua_S‹
 *
L
, *
lib
, cÚ¡ *
sym
) {

252 ()
lib
; ()
sym
;

253 
	`lua_pushl™”®
(
L
, 
DLMSG
);

254  
NULL
;

255 
	}
}

262 **
	$Î_»gi¡”
 (
lua_S‹
 *
L
, cÚ¡ *
·th
) {

263 **
¶ib
;

264 
	`lua_pushf¡ršg
(
L
, "%s%s", 
LIBPREFIX
, 
·th
);

265 
	`lua_g‘bË
(
L
, 
LUA_REGISTRYINDEX
);

266 ià(!
	`lua_i¢
(
L
, -1))

267 
¶ib
 = (**)
	`lua_tou£rd©a
(
L
, -1);

269 
	`lua_pİ
(
L
, 1);

270 
¶ib
 = (**)
	`lua_Ãwu£rd©a
(
L
, (const *));

271 *
¶ib
 = 
NULL
;

272 
	`luaL_g‘m‘©abË
(
L
, "_LOADLIB");

273 
	`lua_£tm‘©abË
(
L
, -2);

274 
	`lua_pushf¡ršg
(
L
, "%s%s", 
LIBPREFIX
, 
·th
);

275 
	`lua_pushv®ue
(
L
, -2);

276 
	`lua_£‰abË
(
L
, 
LUA_REGISTRYINDEX
);

278  
¶ib
;

279 
	}
}

286 
	$gùm
 (
lua_S‹
 *
L
) {

287 **
lib
 = (**)
	`luaL_checkud©a
(
L
, 1, "_LOADLIB");

288 ià(*
lib
è
	`Î_uÆßdlib
(*lib);

289 *
lib
 = 
NULL
;

291 
	}
}

294 
	$Î_lßdfunc
 (
lua_S‹
 *
L
, cÚ¡ *
·th
, cÚ¡ *
sym
) {

295 **
»g
 = 
	`Î_»gi¡”
(
L
, 
·th
);

296 ià(*
»g
 =ğ
NULL
è*»g = 
	`Î_lßd
(
L
, 
·th
);

297 ià(*
»g
 =ğ
NULL
)

298  
ERRLIB
;

300 
lua_CFunùiÚ
 
f
 = 
	`Î_sym
(
L
, *
»g
, 
sym
);

301 ià(
f
 =ğ
NULL
)

302  
ERRFUNC
;

303 
	`lua_pushcfunùiÚ
(
L
, 
f
);

306 
	}
}

309 
	$Î_lßdlib
 (
lua_S‹
 *
L
) {

310 cÚ¡ *
·th
 = 
	`luaL_check¡ršg
(
L
, 1);

311 cÚ¡ *
š™
 = 
	`luaL_check¡ršg
(
L
, 2);

312 
¡©
 = 
	`Î_lßdfunc
(
L
, 
·th
, 
š™
);

313 ià(
¡©
 == 0)

316 
	`lua_pushn
(
L
);

317 
	`lua_š£¹
(
L
, -2);

318 
	`lua_push¡ršg
(
L
, (
¡©
 =ğ
ERRLIB
è? 
LIB_FAIL
 : "init");

321 
	}
}

332 
	$»adabË
 (cÚ¡ *
f’ame
) {

333 
FILE
 *
f
 = 
	`fİ’
(
f’ame
, "r");

334 ià(
f
 =ğ
NULL
)  0;

335 
	`fşo£
(
f
);

337 
	}
}

340 cÚ¡ *
	$pushÃx‰em¶©e
 (
lua_S‹
 *
L
, cÚ¡ *
·th
) {

341 cÚ¡ *
l
;

342 *
·th
 =ğ*
LUA_PATHSEP
)…ath++;

343 ià(*
·th
 =ğ'\0'è 
NULL
;

344 
l
 = 
	`¡rchr
(
·th
, *
LUA_PATHSEP
);

345 ià(
l
 =ğ
NULL
èÈğ
·th
 + 
	`¡¾’
(path);

346 
	`lua_pushl¡ršg
(
L
, 
·th
, 
l
 -…ath);

347  
l
;

348 
	}
}

351 cÚ¡ *
	$fšdfe
 (
lua_S‹
 *
L
, cÚ¡ *
Çme
,

352 cÚ¡ *
²ame
) {

353 cÚ¡ *
·th
;

354 
Çme
 = 
	`luaL_gsub
(
L
,‚ame, ".", 
LUA_DIRSEP
);

355 
	`lua_g‘f›ld
(
L
, 
LUA_ENVIRONINDEX
, 
²ame
);

356 
·th
 = 
	`lua_to¡ršg
(
L
, -1);

357 ià(
·th
 =ğ
NULL
)

358 
	`luaL_”rÜ
(
L
, 
	`LUA_QL
("·ckage.%s"è" mu¡ b¨¡ršg", 
²ame
);

359 
	`lua_pushl™”®
(
L
, "");

360 (
·th
 = 
	`pushÃx‰em¶©e
(
L
,…©h)è!ğ
NULL
) {

361 cÚ¡ *
f’ame
;

362 
f’ame
 = 
	`luaL_gsub
(
L
, 
	`lua_to¡ršg
(L, -1), 
LUA_PATH_MARK
, 
Çme
);

363 
	`lua_»move
(
L
, -2);

364 ià(
	`»adabË
(
f’ame
))

365  
f’ame
;

366 
	`lua_pushf¡ršg
(
L
, "\n\ŠØf" 
LUA_QS
, 
f’ame
);

367 
	`lua_»move
(
L
, -2);

368 
	`lua_cÚÿt
(
L
, 2);

370  
NULL
;

371 
	}
}

374 
	$lßd”rÜ
 (
lua_S‹
 *
L
, cÚ¡ *
f’ame
) {

375 
	`luaL_”rÜ
(
L
, "”rÜ†ßdšg moduË " 
LUA_QS
 " from file " LUA_QS ":\n\t%s",

376 
	`lua_to¡ršg
(
L
, 1), 
f’ame
,†ua_tostring(L, -1));

377 
	}
}

380 
	$lßd”_Lua
 (
lua_S‹
 *
L
) {

381 cÚ¡ *
f’ame
;

382 cÚ¡ *
Çme
 = 
	`luaL_check¡ršg
(
L
, 1);

383 
f’ame
 = 
	`fšdfe
(
L
, 
Çme
, "path");

384 ià(
f’ame
 =ğ
NULL
)  1;

385 ià(
	`luaL_lßdfe
(
L
, 
f’ame
) != 0)

386 
	`lßd”rÜ
(
L
, 
f’ame
);

388 
	}
}

391 cÚ¡ *
	$mkfunúame
 (
lua_S‹
 *
L
, cÚ¡ *
modÇme
) {

392 cÚ¡ *
funúame
;

393 cÚ¡ *
m¬k
 = 
	`¡rchr
(
modÇme
, *
LUA_IGMARK
);

394 ià(
m¬k
è
modÇme
 = mark + 1;

395 
funúame
 = 
	`luaL_gsub
(
L
, 
modÇme
, ".", 
LUA_OFSEP
);

396 
funúame
 = 
	`lua_pushf¡ršg
(
L
, 
POF
"%s", funcname);

397 
	`lua_»move
(
L
, -2);

398  
funúame
;

399 
	}
}

402 
	$lßd”_C
 (
lua_S‹
 *
L
) {

403 cÚ¡ *
funúame
;

404 cÚ¡ *
Çme
 = 
	`luaL_check¡ršg
(
L
, 1);

405 cÚ¡ *
f’ame
 = 
	`fšdfe
(
L
, 
Çme
, "cpath");

406 ià(
f’ame
 =ğ
NULL
)  1;

407 
funúame
 = 
	`mkfunúame
(
L
, 
Çme
);

408 ià(
	`Î_lßdfunc
(
L
, 
f’ame
, 
funúame
) != 0)

409 
	`lßd”rÜ
(
L
, 
f’ame
);

411 
	}
}

414 
	$lßd”_CroÙ
 (
lua_S‹
 *
L
) {

415 cÚ¡ *
funúame
;

416 cÚ¡ *
f’ame
;

417 cÚ¡ *
Çme
 = 
	`luaL_check¡ršg
(
L
, 1);

418 cÚ¡ *
p
 = 
	`¡rchr
(
Çme
, '.');

419 
¡©
;

420 ià(
p
 =ğ
NULL
)  0;

421 
	`lua_pushl¡ršg
(
L
, 
Çme
, 
p
 -‚ame);

422 
f’ame
 = 
	`fšdfe
(
L
, 
	`lua_to¡ršg
(L, -1), "cpath");

423 ià(
f’ame
 =ğ
NULL
)  1;

424 
funúame
 = 
	`mkfunúame
(
L
, 
Çme
);

425 ià((
¡©
 = 
	`Î_lßdfunc
(
L
, 
f’ame
, 
funúame
)) != 0) {

426 ià(
¡©
 !ğ
ERRFUNC
è
	`lßd”rÜ
(
L
, 
f’ame
);

427 
	`lua_pushf¡ršg
(
L
, "\n\ŠØmoduË " 
LUA_QS
 " in file " LUA_QS,

428 
Çme
, 
f’ame
);

432 
	}
}

435 
	$lßd”_´–ßd
 (
lua_S‹
 *
L
) {

436 cÚ¡ *
Çme
 = 
	`luaL_check¡ršg
(
L
, 1);

437 
	`lua_g‘f›ld
(
L
, 
LUA_ENVIRONINDEX
, "preload");

438 ià(!
	`lua_i¡abË
(
L
, -1))

439 
	`luaL_”rÜ
(
L
, 
	`LUA_QL
("package.preload") " must be‡able");

440 
	`lua_g‘f›ld
(
L
, -1, 
Çme
);

441 ià(
	`lua_i¢
(
L
, -1))

442 
	`lua_pushf¡ršg
(
L
, "\n\ŠØf›ld…ackage.´–ßd['%s']", 
Çme
);

444 
	}
}

447 cÚ¡ 
	g£Áš–_
 = 0;

448 
	#£Áš–
 ((*)&
£Áš–_
)

	)

451 
	$Î_»quœe
 (
lua_S‹
 *
L
) {

452 cÚ¡ *
Çme
 = 
	`luaL_check¡ršg
(
L
, 1);

453 
i
;

454 
	`lua_£‰İ
(
L
, 1);

455 
	`lua_g‘f›ld
(
L
, 
LUA_REGISTRYINDEX
, "_LOADED");

456 
	`lua_g‘f›ld
(
L
, 2, 
Çme
);

457 ià(
	`lua_toboŞ—n
(
L
, -1)) {

458 ià(
	`lua_tou£rd©a
(
L
, -1è=ğ
£Áš–
)

459 
	`luaL_”rÜ
(
L
, "loİ o¸´eviou ”rÜ†ßdšg moduË " 
LUA_QS
, 
Çme
);

463 
	`lua_g‘f›ld
(
L
, 
LUA_ENVIRONINDEX
, "loaders");

464 ià(!
	`lua_i¡abË
(
L
, -1))

465 
	`luaL_”rÜ
(
L
, 
	`LUA_QL
("package.loaders") " must be‡able");

466 
	`lua_pushl™”®
(
L
, "");

467 
i
=1; ; i++) {

468 
	`lua_¿wg‘i
(
L
, -2, 
i
);

469 ià(
	`lua_i¢
(
L
, -1))

470 
	`luaL_”rÜ
(
L
, "moduË " 
LUA_QS
 "‚ot found:%s",

471 
Çme
, 
	`lua_to¡ršg
(
L
, -2));

472 
	`lua_push¡ršg
(
L
, 
Çme
);

473 
	`lua_ÿÎ
(
L
, 1, 1);

474 ià(
	`lua_isfunùiÚ
(
L
, -1))

476 ià(
	`lua_is¡ršg
(
L
, -1))

477 
	`lua_cÚÿt
(
L
, 2);

479 
	`lua_pİ
(
L
, 1);

481 
	`lua_pushlightu£rd©a
(
L
, 
£Áš–
);

482 
	`lua_£tf›ld
(
L
, 2, 
Çme
);

483 
	`lua_push¡ršg
(
L
, 
Çme
);

484 
	`lua_ÿÎ
(
L
, 1, 1);

485 ià(!
	`lua_i¢
(
L
, -1))

486 
	`lua_£tf›ld
(
L
, 2, 
Çme
);

487 
	`lua_g‘f›ld
(
L
, 2, 
Çme
);

488 ià(
	`lua_tou£rd©a
(
L
, -1è=ğ
£Áš–
) {

489 
	`lua_pushboŞ—n
(
L
, 1);

490 
	`lua_pushv®ue
(
L
, -1);

491 
	`lua_£tf›ld
(
L
, 2, 
Çme
);

494 
	}
}

507 
	$£tãnv
 (
lua_S‹
 *
L
) {

508 
lua_Debug
 
¬
;

509 ià(
	`lua_g‘¡ack
(
L
, 1, &
¬
) == 0 ||

510 
	`lua_g‘šfo
(
L
, "f", &
¬
) == 0 ||

511 
	`lua_iscfunùiÚ
(
L
, -1))

512 
	`luaL_”rÜ
(
L
, 
	`LUA_QL
("module") "‚ot called from‡ Lua function");

513 
	`lua_pushv®ue
(
L
, -2);

514 
	`lua_£tãnv
(
L
, -2);

515 
	`lua_pİ
(
L
, 1);

516 
	}
}

519 
	$doİtiÚs
 (
lua_S‹
 *
L
, 
n
) {

520 
i
;

521 
i
 = 2; i <ğ
n
; i++) {

522 
	`lua_pushv®ue
(
L
, 
i
);

523 
	`lua_pushv®ue
(
L
, -2);

524 
	`lua_ÿÎ
(
L
, 1, 0);

526 
	}
}

529 
	$modš™
 (
lua_S‹
 *
L
, cÚ¡ *
modÇme
) {

530 cÚ¡ *
dÙ
;

531 
	`lua_pushv®ue
(
L
, -1);

532 
	`lua_£tf›ld
(
L
, -2, "_M");

533 
	`lua_push¡ršg
(
L
, 
modÇme
);

534 
	`lua_£tf›ld
(
L
, -2, "_NAME");

535 
dÙ
 = 
	`¡¼chr
(
modÇme
, '.');

536 ià(
dÙ
 =ğ
NULL
èdÙ = 
modÇme
;

537 
dÙ
++;

539 
	`lua_pushl¡ršg
(
L
, 
modÇme
, 
dÙ
 - modname);

540 
	`lua_£tf›ld
(
L
, -2, "_PACKAGE");

541 
	}
}

544 
	$Î_moduË
 (
lua_S‹
 *
L
) {

545 cÚ¡ *
modÇme
 = 
	`luaL_check¡ršg
(
L
, 1);

546 
lßded
 = 
	`lua_g‘tİ
(
L
) + 1;

547 
	`lua_g‘f›ld
(
L
, 
LUA_REGISTRYINDEX
, "_LOADED");

548 
	`lua_g‘f›ld
(
L
, 
lßded
, 
modÇme
);

549 ià(!
	`lua_i¡abË
(
L
, -1)) {

550 
	`lua_pİ
(
L
, 1);

552 ià(
	`luaL_fšdbË
(
L
, 
LUA_GLOBALSINDEX
, 
modÇme
, 1è!ğ
NULL
)

553  
	`luaL_”rÜ
(
L
, "ÇmcÚæiù fÜ moduË " 
LUA_QS
, 
modÇme
);

554 
	`lua_pushv®ue
(
L
, -1);

555 
	`lua_£tf›ld
(
L
, 
lßded
, 
modÇme
);

558 
	`lua_g‘f›ld
(
L
, -1, "_NAME");

559 ià(!
	`lua_i¢
(
L
, -1))

560 
	`lua_pİ
(
L
, 1);

562 
	`lua_pİ
(
L
, 1);

563 
	`modš™
(
L
, 
modÇme
);

565 
	`lua_pushv®ue
(
L
, -1);

566 
	`£tãnv
(
L
);

567 
	`doİtiÚs
(
L
, 
lßded
 - 1);

569 
	}
}

572 
	$Î_£—Î
 (
lua_S‹
 *
L
) {

573 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

574 ià(!
	`lua_g‘m‘©abË
(
L
, 1)) {

575 
	`lua_ü—‹bË
(
L
, 0, 1);

576 
	`lua_pushv®ue
(
L
, -1);

577 
	`lua_£tm‘©abË
(
L
, 1);

579 
	`lua_pushv®ue
(
L
, 
LUA_GLOBALSINDEX
);

580 
	`lua_£tf›ld
(
L
, -2, "__index");

582 
	}
}

590 
	#AUXMARK
 "\1"

	)

592 
	$£©h
 (
lua_S‹
 *
L
, cÚ¡ *
f›ldÇme
, cÚ¡ *
’vÇme
,

593 cÚ¡ *
def
) {

594 cÚ¡ *
·th
 = 
	`g‘’v
(
’vÇme
);

595 ià(
·th
 =ğ
NULL
)

596 
	`lua_push¡ršg
(
L
, 
def
);

599 
·th
 = 
	`luaL_gsub
(
L
,…©h, 
LUA_PATHSEP
 LUA_PATHSEP,

600 
LUA_PATHSEP
 
AUXMARK
 LUA_PATHSEP);

601 
	`luaL_gsub
(
L
, 
·th
, 
AUXMARK
, 
def
);

602 
	`lua_»move
(
L
, -2);

604 
	`£rogdœ
(
L
);

605 
	`lua_£tf›ld
(
L
, -2, 
f›ldÇme
);

606 
	}
}

609 cÚ¡ 
luaL_Reg
 
	gpk_funcs
[] = {

610 {"lßdlib", 
Î_lßdlib
},

611 {"£—Î", 
Î_£—Î
},

612 {
NULL
, NULL}

616 cÚ¡ 
luaL_Reg
 
	gÎ_funcs
[] = {

617 {"moduË", 
Î_moduË
},

618 {"»quœe", 
Î_»quœe
},

619 {
NULL
, NULL}

623 cÚ¡ 
lua_CFunùiÚ
 
	glßd”s
[] =

624 {
lßd”_´–ßd
, 
lßd”_Lua
, 
lßd”_C
, 
lßd”_CroÙ
, 
NULL
};

627 
LUALIB_API
 
	$luaİ’_·ckage
 (
lua_S‹
 *
L
) {

628 
i
;

630 
	`luaL_Ãwm‘©abË
(
L
, "_LOADLIB");

631 
	`lua_pushcfunùiÚ
(
L
, 
gùm
);

632 
	`lua_£tf›ld
(
L
, -2, "__gc");

634 
	`luaL_»gi¡”
(
L
, 
LUA_LOADLIBNAME
, 
pk_funcs
);

635 #ià
	`defšed
(
LUA_COMPAT_LOADLIB
)

636 
	`lua_g‘f›ld
(
L
, -1, "loadlib");

637 
	`lua_£tf›ld
(
L
, 
LUA_GLOBALSINDEX
, "loadlib");

639 
	`lua_pushv®ue
(
L
, -1);

640 
	`lua_»¶aû
(
L
, 
LUA_ENVIRONINDEX
);

642 
	`lua_ü—‹bË
(
L
, (
lßd”s
)/(loaders[0]) - 1, 0);

644 
i
=0; 
lßd”s
[i] !ğ
NULL
; i++) {

645 
	`lua_pushcfunùiÚ
(
L
, 
lßd”s
[
i
]);

646 
	`lua_¿w£ti
(
L
, -2, 
i
+1);

648 
	`lua_£tf›ld
(
L
, -2, "loaders");

649 
	`£©h
(
L
, "·th", 
LUA_PATH
, 
LUA_PATH_DEFAULT
);

650 
	`£©h
(
L
, "ı©h", 
LUA_CPATH
, 
LUA_CPATH_DEFAULT
);

652 
	`lua_pushl™”®
(
L
, 
LUA_DIRSEP
 "\n" 
LUA_PATHSEP
 "\n" 
LUA_PATH_MARK
 "\n"

653 
LUA_EXECDIR
 "\n" 
LUA_IGMARK
);

654 
	`lua_£tf›ld
(
L
, -2, "config");

656 
	`luaL_fšdbË
(
L
, 
LUA_REGISTRYINDEX
, "_LOADED", 2);

657 
	`lua_£tf›ld
(
L
, -2, "loaded");

659 
	`lua_ÃwbË
(
L
);

660 
	`lua_£tf›ld
(
L
, -2, "preload");

661 
	`lua_pushv®ue
(
L
, 
LUA_GLOBALSINDEX
);

662 
	`luaL_»gi¡”
(
L
, 
NULL
, 
Î_funcs
);

663 
	`lua_pİ
(
L
, 1);

665 
	}
}

	@deps/lua/src/lobject.c

7 
	~<ùy³.h
>

8 
	~<¡d¬g.h
>

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

11 
	~<¡ršg.h
>

13 
	#lobjeù_c


	)

14 
	#LUA_CORE


	)

16 
	~"lua.h
"

18 
	~"ldo.h
"

19 
	~"lmem.h
"

20 
	~"lobjeù.h
"

21 
	~"l¡©e.h
"

22 
	~"l¡ršg.h
"

23 
	~"lvm.h
"

27 cÚ¡ 
TV®ue
 
	gluaO_nobjeù_
 = {{
NULL
}, 
LUA_TNIL
};

35 
	$luaO_št2fb
 (
x
) {

36 
e
 = 0;

37 
x
 >= 16) {

38 
x
 = (x+1) >> 1;

39 
e
++;

41 ià(
x
 < 8)  x;

42  ((
e
+1è<< 3è| (
	`ÿ¡_št
(
x
) - 8);

43 
	}
}

47 
	$luaO_fb2št
 (
x
) {

48 
e
 = (
x
 >> 3) & 31;

49 ià(
e
 =ğ0è 
x
;

50  ((
x
 & 7)+8è<< (
e
 - 1);

51 
	}
}

54 
	$luaO_log2
 (
x
) {

55 cÚ¡ 
lu_by‹
 
log_2
[256] = {

65 
l
 = -1;

66 
x
 >ğ256è{ 
l
 += 8; x >>= 8; }

67  
l
 + 
log_2
[
x
];

69 
	}
}

72 
	$luaO_¿wequ®Obj
 (cÚ¡ 
TV®ue
 *
t1
, cÚ¡ TV®u*
t2
) {

73 ià(
	`‰y³
(
t1
è!ğ‰y³(
t2
))  0;

74 
	`‰y³
(
t1
)) {

75 
LUA_TNIL
:

77 
LUA_TNUMBER
:

78  
	`luai_numeq
(
	`nv®ue
(
t1
),‚v®ue(
t2
));

79 
LUA_TBOOLEAN
:

80  
	`bv®ue
(
t1
è=ğbv®ue(
t2
);

81 
LUA_TLIGHTUSERDATA
:

82  
	`pv®ue
(
t1
è=ğpv®ue(
t2
);

84 
	`lua_as£¹
(
	`iscŞËùabË
(
t1
));

85  
	`gcv®ue
(
t1
è=ğgcv®ue(
t2
);

87 
	}
}

90 
	$luaO_¡r2d
 (cÚ¡ *
s
, 
lua_Numb”
 *
»suÉ
) {

91 *
’d±r
;

92 *
»suÉ
 = 
	`lua_¡r2numb”
(
s
, &
’d±r
);

93 ià(
’d±r
 =ğ
s
)  0;

94 ià(*
’d±r
 == 'x' || *endptr == 'X')

95 *
»suÉ
 = 
	`ÿ¡_num
(
	`¡¹oul
(
s
, &
’d±r
, 16));

96 ià(*
’d±r
 == '\0')  1;

97 
	`is¥aû
(
	`ÿ¡
(, *
’d±r
)))ƒndptr++;

98 ià(*
’d±r
 != '\0')  0;

100 
	}
}

104 
	$push¡r
 (
lua_S‹
 *
L
, cÚ¡ *
¡r
) {

105 
	`£tsv®ue2s
(
L
, L->
tİ
, 
	`luaS_Ãw
(L, 
¡r
));

106 
	`šü_tİ
(
L
);

107 
	}
}

111 cÚ¡ *
	$luaO_pushvf¡ršg
 (
lua_S‹
 *
L
, cÚ¡ *
fmt
, 
va_li¡
 
¬gp
) {

112 
n
 = 1;

113 
	`push¡r
(
L
, "");

115 cÚ¡ *
e
 = 
	`¡rchr
(
fmt
, '%');

116 ià(
e
 =ğ
NULL
) ;

117 
	`£tsv®ue2s
(
L
, L->
tİ
, 
	`luaS_Ãwl¡r
(L, 
fmt
, 
e
-fmt));

118 
	`šü_tİ
(
L
);

119 *(
e
+1)) {

121 cÚ¡ *
s
 = 
	`va_¬g
(
¬gp
, *);

122 ià(
s
 =ğ
NULL
) s = "(null)";

123 
	`push¡r
(
L
, 
s
);

127 
buff
[2];

128 
buff
[0] = 
	`ÿ¡
(, 
	`va_¬g
(
¬gp
, ));

129 
buff
[1] = '\0';

130 
	`push¡r
(
L
, 
buff
);

134 
	`£Šv®ue
(
L
->
tİ
, 
	`ÿ¡_num
(
	`va_¬g
(
¬gp
, )));

135 
	`šü_tİ
(
L
);

139 
	`£Šv®ue
(
L
->
tİ
, 
	`ÿ¡_num
(
	`va_¬g
(
¬gp
, 
l_uacNumb”
)));

140 
	`šü_tİ
(
L
);

144 
buff
[4*(*) + 8];

145 
	`¥rštf
(
buff
, "%p", 
	`va_¬g
(
¬gp
, *));

146 
	`push¡r
(
L
, 
buff
);

150 
	`push¡r
(
L
, "%");

154 
buff
[3];

155 
buff
[0] = '%';

156 
buff
[1] = *(
e
+1);

157 
buff
[2] = '\0';

158 
	`push¡r
(
L
, 
buff
);

162 
n
 += 2;

163 
fmt
 = 
e
+2;

165 
	`push¡r
(
L
, 
fmt
);

166 
	`luaV_cÚÿt
(
L
, 
n
+1, 
	`ÿ¡_št
(L->
tİ
 - L->
ba£
) - 1);

167 
L
->
tİ
 -ğ
n
;

168  
	`sv®ue
(
L
->
tİ
 - 1);

169 
	}
}

172 cÚ¡ *
	$luaO_pushf¡ršg
 (
lua_S‹
 *
L
, cÚ¡ *
fmt
, ...) {

173 cÚ¡ *
msg
;

174 
va_li¡
 
¬gp
;

175 
	`va_¡¬t
(
¬gp
, 
fmt
);

176 
msg
 = 
	`luaO_pushvf¡ršg
(
L
, 
fmt
, 
¬gp
);

177 
	`va_’d
(
¬gp
);

178  
msg
;

179 
	}
}

182 
	$luaO_chunkid
 (*
out
, cÚ¡ *
sourû
, 
size_t
 
bufæ’
) {

183 ià(*
sourû
 == '=') {

184 
	`¡ºıy
(
out
, 
sourû
+1, 
bufæ’
);

185 
out
[
bufæ’
-1] = '\0';

188 ià(*
sourû
 == '@') {

189 
size_t
 
l
;

190 
sourû
++;

191 
bufæ’
 -= (" '...' ");

192 
l
 = 
	`¡¾’
(
sourû
);

193 
	`¡rıy
(
out
, "");

194 ià(
l
 > 
bufæ’
) {

195 
sourû
 +ğ(
l
-
bufæ’
);

196 
	`¡rÿt
(
out
, "...");

198 
	`¡rÿt
(
out
, 
sourû
);

201 
size_t
 
Ën
 = 
	`¡rc¥n
(
sourû
, "\n\r");

202 
bufæ’
 -= (" [string \"...\"] ");

203 ià(
Ën
 > 
bufæ’
)†en = bufflen;

204 
	`¡rıy
(
out
, "[string \"");

205 ià(
sourû
[
Ën
] != '\0') {

206 
	`¡ºÿt
(
out
, 
sourû
, 
Ën
);

207 
	`¡rÿt
(
out
, "...");

210 
	`¡rÿt
(
out
, 
sourû
);

211 
	`¡rÿt
(
out
, "\"]");

214 
	}
}

	@deps/lua/src/lobject.h

8 #iâdeà
lobjeù_h


9 
	#lobjeù_h


	)

12 
	~<¡d¬g.h
>

15 
	~"Îim™s.h
"

16 
	~"lua.h
"

20 
	#LAST_TAG
 
LUA_TTHREAD


	)

22 
	#NUM_TAGS
 (
LAST_TAG
+1)

	)

28 
	#LUA_TPROTO
 (
LAST_TAG
+1)

	)

29 
	#LUA_TUPVAL
 (
LAST_TAG
+2)

	)

30 
	#LUA_TDEADKEY
 (
LAST_TAG
+3)

	)

36 
GCObjeù
 
	tGCObjeù
;

43 
	#CommÚH—d”
 
GCObjeù
 *
Ãxt
; 
lu_by‹
 
‰
;†u_by‹ 
m¬ked


	)

49 
	sGCh—d”
 {

50 
	mCommÚH—d”
;

51 } 
	tGCh—d”
;

60 
GCObjeù
 *
	mgc
;

61 *
	mp
;

62 
lua_Numb”
 
	mn
;

63 
	mb
;

64 } 
	tV®ue
;

71 
	#TV®uef›lds
 
V®ue
 
v®ue
; 
‰


	)

73 
	slua_TV®ue
 {

74 
	mTV®uef›lds
;

75 } 
	tTV®ue
;

79 
	#‰i¢
(
o
è(
	`‰y³
(oè=ğ
LUA_TNIL
)

	)

80 
	#‰i¢umb”
(
o
è(
	`‰y³
(oè=ğ
LUA_TNUMBER
)

	)

81 
	#‰is¡ršg
(
o
è(
	`‰y³
(oè=ğ
LUA_TSTRING
)

	)

82 
	#‰i¡abË
(
o
è(
	`‰y³
(oè=ğ
LUA_TTABLE
)

	)

83 
	#‰isfunùiÚ
(
o
è(
	`‰y³
(oè=ğ
LUA_TFUNCTION
)

	)

84 
	#‰isboŞ—n
(
o
è(
	`‰y³
(oè=ğ
LUA_TBOOLEAN
)

	)

85 
	#‰isu£rd©a
(
o
è(
	`‰y³
(oè=ğ
LUA_TUSERDATA
)

	)

86 
	#‰i¡h»ad
(
o
è(
	`‰y³
(oè=ğ
LUA_TTHREAD
)

	)

87 
	#‰i¦ightu£rd©a
(
o
è(
	`‰y³
(oè=ğ
LUA_TLIGHTUSERDATA
)

	)

90 
	#‰y³
(
o
è((o)->
‰
)

	)

91 
	#gcv®ue
(
o
è
	`check_exp
(
	`iscŞËùabË
(o), (o)->
v®ue
.
gc
)

	)

92 
	#pv®ue
(
o
è
	`check_exp
(
	`‰i¦ightu£rd©a
(o), (o)->
v®ue
.
p
)

	)

93 
	#nv®ue
(
o
è
	`check_exp
(
	`‰i¢umb”
(o), (o)->
v®ue
.
n
)

	)

94 
	#¿wtsv®ue
(
o
è
	`check_exp
(
	`‰is¡ršg
(o), &(o)->
v®ue
.
gc
->
ts
)

	)

95 
	#tsv®ue
(
o
è(&
	`¿wtsv®ue
(o)->
tsv
)

	)

96 
	#¿wuv®ue
(
o
è
	`check_exp
(
	`‰isu£rd©a
(o), &(o)->
v®ue
.
gc
->
u
)

	)

97 
	#uv®ue
(
o
è(&
	`¿wuv®ue
(o)->
uv
)

	)

98 
	#şv®ue
(
o
è
	`check_exp
(
	`‰isfunùiÚ
(o), &(o)->
v®ue
.
gc
->
ş
)

	)

99 
	#hv®ue
(
o
è
	`check_exp
(
	`‰i¡abË
(o), &(o)->
v®ue
.
gc
->
h
)

	)

100 
	#bv®ue
(
o
è
	`check_exp
(
	`‰isboŞ—n
(o), (o)->
v®ue
.
b
)

	)

101 
	#thv®ue
(
o
è
	`check_exp
(
	`‰i¡h»ad
(o), &(o)->
v®ue
.
gc
->
th
)

	)

103 
	#l_isçl£
(
o
è(
	`‰i¢
(oè|| (
	`‰isboŞ—n
(oè&& 
	`bv®ue
(oè=ğ0))

	)

108 
	#checkcÚsi¡’cy
(
obj
) \

109 
	`lua_as£¹
(!
	`iscŞËùabË
(
obj
è|| (
	`‰y³
(objè=ğ(obj)->
v®ue
.
gc
->
gch
.
‰
))

	)

111 
	#checkliv’ess
(
g
,
obj
) \

112 
	`lua_as£¹
(!
	`iscŞËùabË
(
obj
) || \

113 ((
	`‰y³
(
obj
è=ğ(obj)->
v®ue
.
gc
->
gch
.
‰
è&& !
	`isd—d
(
g
, (obj)->v®ue.gc)))

	)

117 
	#£Šv®ue
(
obj
è((obj)->
‰
=
LUA_TNIL
)

	)

119 
	#£Šv®ue
(
obj
,
x
) \

120 { 
TV®ue
 *
i_o
=(
obj
); i_o->
v®ue
.
n
=(
x
); i_o->
‰
=
LUA_TNUMBER
; }

	)

122 
	#£v®ue
(
obj
,
x
) \

123 { 
TV®ue
 *
i_o
=(
obj
); i_o->
v®ue
.
p
=(
x
); i_o->
‰
=
LUA_TLIGHTUSERDATA
; }

	)

125 
	#£tbv®ue
(
obj
,
x
) \

126 { 
TV®ue
 *
i_o
=(
obj
); i_o->
v®ue
.
b
=(
x
); i_o->
‰
=
LUA_TBOOLEAN
; }

	)

128 
	#£tsv®ue
(
L
,
obj
,
x
) \

129 { 
TV®ue
 *
i_o
=(
obj
); \

130 
i_o
->
v®ue
.
gc
=
	`ÿ¡
(
GCObjeù
 *, (
x
)); i_o->
‰
=
LUA_TSTRING
; \

131 
	`checkliv’ess
(
	`G
(
L
),
i_o
); }

	)

133 
	#£tuv®ue
(
L
,
obj
,
x
) \

134 { 
TV®ue
 *
i_o
=(
obj
); \

135 
i_o
->
v®ue
.
gc
=
	`ÿ¡
(
GCObjeù
 *, (
x
)); i_o->
‰
=
LUA_TUSERDATA
; \

136 
	`checkliv’ess
(
	`G
(
L
),
i_o
); }

	)

138 
	#£‰hv®ue
(
L
,
obj
,
x
) \

139 { 
TV®ue
 *
i_o
=(
obj
); \

140 
i_o
->
v®ue
.
gc
=
	`ÿ¡
(
GCObjeù
 *, (
x
)); i_o->
‰
=
LUA_TTHREAD
; \

141 
	`checkliv’ess
(
	`G
(
L
),
i_o
); }

	)

143 
	#£tşv®ue
(
L
,
obj
,
x
) \

144 { 
TV®ue
 *
i_o
=(
obj
); \

145 
i_o
->
v®ue
.
gc
=
	`ÿ¡
(
GCObjeù
 *, (
x
)); i_o->
‰
=
LUA_TFUNCTION
; \

146 
	`checkliv’ess
(
	`G
(
L
),
i_o
); }

	)

148 
	#£thv®ue
(
L
,
obj
,
x
) \

149 { 
TV®ue
 *
i_o
=(
obj
); \

150 
i_o
->
v®ue
.
gc
=
	`ÿ¡
(
GCObjeù
 *, (
x
)); i_o->
‰
=
LUA_TTABLE
; \

151 
	`checkliv’ess
(
	`G
(
L
),
i_o
); }

	)

153 
	#£tv®ue
(
L
,
obj
,
x
) \

154 { 
TV®ue
 *
i_o
=(
obj
); \

155 
i_o
->
v®ue
.
gc
=
	`ÿ¡
(
GCObjeù
 *, (
x
)); i_o->
‰
=
LUA_TPROTO
; \

156 
	`checkliv’ess
(
	`G
(
L
),
i_o
); }

	)

161 
	#£tobj
(
L
,
obj1
,
obj2
) \

162 { cÚ¡ 
TV®ue
 *
o2
=(
obj2
); TV®u*
o1
=(
obj1
); \

163 
o1
->
v®ue
 = 
o2
->v®ue; o1->
‰
=o2->tt; \

164 
	`checkliv’ess
(
	`G
(
L
),
o1
); }

	)

172 
	#£tobjs2s
 
£tobj


	)

174 
	#£tobj2s
 
£tobj


	)

175 
	#£tsv®ue2s
 
£tsv®ue


	)

176 
	#£thv®ue2s
 
£thv®ue


	)

177 
	#£tv®ue2s
 
£tv®ue


	)

179 
	#£tobjt2t
 
£tobj


	)

181 
	#£tobj2t
 
£tobj


	)

183 
	#£tobj2n
 
£tobj


	)

184 
	#£tsv®ue2n
 
£tsv®ue


	)

186 
	#£‰ty³
(
obj
, 
‰
è(
	`‰y³
(objèğÑt))

	)

189 
	#iscŞËùabË
(
o
è(
	`‰y³
(oè>ğ
LUA_TSTRING
)

	)

193 
TV®ue
 *
	tStkId
;

199 
	uTSŒšg
 {

200 
L_Umax®ign
 
	mdummy
;

202 
	mCommÚH—d”
;

203 
lu_by‹
 
	m»£rved
;

204 
	mhash
;

205 
size_t
 
	mËn
;

206 } 
	mtsv
;

207 } 
	tTSŒšg
;

210 
	#g‘¡r
(
ts
è
	`ÿ¡
(cÚ¡ *, (tsè+ 1)

	)

211 
	#sv®ue
(
o
è
	`g‘¡r
(
	`¿wtsv®ue
(o))

	)

215 
	uUd©a
 {

216 
L_Umax®ign
 
	mdummy
;

218 
	mCommÚH—d”
;

219 
TabË
 *
	mm‘©abË
;

220 
TabË
 *
	m’v
;

221 
size_t
 
	mËn
;

222 } 
	muv
;

223 } 
	tUd©a
;

231 
	sPrÙo
 {

232 
	mCommÚH—d”
;

233 
TV®ue
 *
	mk
;

234 
In¡ruùiÚ
 *
	mcode
;

235 
PrÙo
 **
	mp
;

236 *
	mlšešfo
;

237 
LocV¬
 *
	mlocv¬s
;

238 
TSŒšg
 **
	mupv®ues
;

239 
TSŒšg
 *
	msourû
;

240 
	msizeupv®ues
;

241 
	msizek
;

242 
	msizecode
;

243 
	msiz–šešfo
;

244 
	msiz•
;

245 
	msiz–ocv¬s
;

246 
	mlšedefšed
;

247 
	mÏ¡lšedefšed
;

248 
GCObjeù
 *
	mgşi¡
;

249 
lu_by‹
 
	mnups
;

250 
lu_by‹
 
	mnum·¿ms
;

251 
lu_by‹
 
	mis_v¬¬g
;

252 
lu_by‹
 
	mmax¡acksize
;

253 } 
	tPrÙo
;

257 
	#VARARG_HASARG
 1

	)

258 
	#VARARG_ISVARARG
 2

	)

259 
	#VARARG_NEEDSARG
 4

	)

262 
	sLocV¬
 {

263 
TSŒšg
 *
	mv¬Çme
;

264 
	m¡¬c
;

265 
	m’dpc
;

266 } 
	tLocV¬
;

274 
	sUpV®
 {

275 
	mCommÚH—d”
;

276 
TV®ue
 *
	mv
;

278 
TV®ue
 
	mv®ue
;

280 
UpV®
 *
	m´ev
;

281 
UpV®
 *
	mÃxt
;

282 } 
	ml
;

283 } 
	mu
;

284 } 
	tUpV®
;

291 
	#Closu»H—d”
 \

292 
CommÚH—d”
; 
lu_by‹
 
isC
;†u_by‹ 
nupv®ues
; 
GCObjeù
 *
gşi¡
; \

293 
TabË
 *
’v


	)

295 
	sCClosu»
 {

296 
	mClosu»H—d”
;

297 
lua_CFunùiÚ
 
	mf
;

298 
TV®ue
 
	mupv®ue
[1];

299 } 
	tCClosu»
;

302 
	sLClosu»
 {

303 
	mClosu»H—d”
;

304 
PrÙo
 *
	mp
;

305 
UpV®
 *
	mupv®s
[1];

306 } 
	tLClosu»
;

309 
	uClosu»
 {

310 
CClosu»
 
	mc
;

311 
LClosu»
 
	ml
;

312 } 
	tClosu»
;

315 
	#iscfunùiÚ
(
o
è(
	`‰y³
(oè=ğ
LUA_TFUNCTION
 && 
	`şv®ue
(o)->
c
.
isC
)

	)

316 
	#isLfunùiÚ
(
o
è(
	`‰y³
(oè=ğ
LUA_TFUNCTION
 && !
	`şv®ue
(o)->
c
.
isC
)

	)

323 
	uTKey
 {

325 
	mTV®uef›lds
;

326 
Node
 *
	mÃxt
;

327 } 
	mnk
;

328 
TV®ue
 
	mtvk
;

329 } 
	tTKey
;

332 
	sNode
 {

333 
TV®ue
 
	mi_v®
;

334 
TKey
 
	mi_key
;

335 } 
	tNode
;

338 
	sTabË
 {

339 
	mCommÚH—d”
;

340 
lu_by‹
 
	mæags
;

341 
lu_by‹
 
	mlsiz’ode
;

342 
TabË
 *
	mm‘©abË
;

343 
TV®ue
 *
	m¬¿y
;

344 
Node
 *
	mnode
;

345 
Node
 *
	mÏ¡ä“
;

346 
GCObjeù
 *
	mgşi¡
;

347 
	msiz—¼ay
;

348 } 
	tTabË
;

355 
	#lmod
(
s
,
size
) \

356 (
	`check_exp
((
size
&(size-1))==0, (
	`ÿ¡
(, (
s
è& ((size)-1)))))

	)

359 
	#twÙo
(
x
è(1<<(x))

	)

360 
	#siz’ode
(
t
è(
	`twÙo
(Ñ)->
lsiz’ode
))

	)

363 
	#luaO_nobjeù
 (&
luaO_nobjeù_
)

	)

365 
LUAI_DATA
 cÚ¡ 
TV®ue
 
	gluaO_nobjeù_
;

367 
	#ûlog2
(
x
è(
	`luaO_log2
((x)-1è+ 1)

	)

369 
LUAI_FUNC
 
luaO_log2
 (
x
);

370 
LUAI_FUNC
 
luaO_št2fb
 (
x
);

371 
LUAI_FUNC
 
luaO_fb2št
 (
x
);

372 
LUAI_FUNC
 
luaO_¿wequ®Obj
 (cÚ¡ 
TV®ue
 *
t1
, cÚ¡ TV®u*
t2
);

373 
LUAI_FUNC
 
luaO_¡r2d
 (cÚ¡ *
s
, 
lua_Numb”
 *
»suÉ
);

374 
LUAI_FUNC
 cÚ¡ *
luaO_pushvf¡ršg
 (
lua_S‹
 *
L
, cÚ¡ *
fmt
,

375 
va_li¡
 
¬gp
);

376 
LUAI_FUNC
 cÚ¡ *
luaO_pushf¡ršg
 (
lua_S‹
 *
L
, cÚ¡ *
fmt
, ...);

377 
LUAI_FUNC
 
luaO_chunkid
 (*
out
, cÚ¡ *
sourû
, 
size_t
 
Ën
);

	@deps/lua/src/lopcodes.c

7 
	#lİcodes_c


	)

8 
	#LUA_CORE


	)

11 
	~"lİcodes.h
"

16 cÚ¡ *cÚ¡ 
	gluaP_İÇmes
[
NUM_OPCODES
+1] = {

55 
NULL


59 
	#İmode
(
t
,
a
,
b
,
c
,
m
è((Ñ)<<7è| (×)<<6è| ((b)<<4è| ((c)<<2è| (m))

	)

61 cÚ¡ 
lu_by‹
 
	gluaP_İmodes
[
NUM_OPCODES
] = {

63 
İmode
(0, 1, 
OpArgR
, 
OpArgN
, 
iABC
)

64 ,
İmode
(0, 1, 
OpArgK
, 
OpArgN
, 
iABx
)

65 ,
İmode
(0, 1, 
OpArgU
, OpArgU, 
iABC
)

66 ,
İmode
(0, 1, 
OpArgR
, 
OpArgN
, 
iABC
)

67 ,
İmode
(0, 1, 
OpArgU
, 
OpArgN
, 
iABC
)

68 ,
İmode
(0, 1, 
OpArgK
, 
OpArgN
, 
iABx
)

69 ,
İmode
(0, 1, 
OpArgR
, 
OpArgK
, 
iABC
)

70 ,
İmode
(0, 0, 
OpArgK
, 
OpArgN
, 
iABx
)

71 ,
İmode
(0, 0, 
OpArgU
, 
OpArgN
, 
iABC
)

72 ,
İmode
(0, 0, 
OpArgK
, OpArgK, 
iABC
)

73 ,
İmode
(0, 1, 
OpArgU
, OpArgU, 
iABC
)

74 ,
İmode
(0, 1, 
OpArgR
, 
OpArgK
, 
iABC
)

75 ,
İmode
(0, 1, 
OpArgK
, OpArgK, 
iABC
)

76 ,
İmode
(0, 1, 
OpArgK
, OpArgK, 
iABC
)

77 ,
İmode
(0, 1, 
OpArgK
, OpArgK, 
iABC
)

78 ,
İmode
(0, 1, 
OpArgK
, OpArgK, 
iABC
)

79 ,
İmode
(0, 1, 
OpArgK
, OpArgK, 
iABC
)

80 ,
İmode
(0, 1, 
OpArgK
, OpArgK, 
iABC
)

81 ,
İmode
(0, 1, 
OpArgR
, 
OpArgN
, 
iABC
)

82 ,
İmode
(0, 1, 
OpArgR
, 
OpArgN
, 
iABC
)

83 ,
İmode
(0, 1, 
OpArgR
, 
OpArgN
, 
iABC
)

84 ,
İmode
(0, 1, 
OpArgR
, OpArgR, 
iABC
)

85 ,
İmode
(0, 0, 
OpArgR
, 
OpArgN
, 
iAsBx
)

86 ,
İmode
(1, 0, 
OpArgK
, OpArgK, 
iABC
)

87 ,
İmode
(1, 0, 
OpArgK
, OpArgK, 
iABC
)

88 ,
İmode
(1, 0, 
OpArgK
, OpArgK, 
iABC
)

89 ,
İmode
(1, 1, 
OpArgR
, 
OpArgU
, 
iABC
)

90 ,
İmode
(1, 1, 
OpArgR
, 
OpArgU
, 
iABC
)

91 ,
İmode
(0, 1, 
OpArgU
, OpArgU, 
iABC
)

92 ,
İmode
(0, 1, 
OpArgU
, OpArgU, 
iABC
)

93 ,
İmode
(0, 0, 
OpArgU
, 
OpArgN
, 
iABC
)

94 ,
İmode
(0, 1, 
OpArgR
, 
OpArgN
, 
iAsBx
)

95 ,
İmode
(0, 1, 
OpArgR
, 
OpArgN
, 
iAsBx
)

96 ,
İmode
(1, 0, 
OpArgN
, 
OpArgU
, 
iABC
)

97 ,
İmode
(0, 0, 
OpArgU
, OpArgU, 
iABC
)

98 ,
İmode
(0, 0, 
OpArgN
, OpArgN, 
iABC
)

99 ,
İmode
(0, 1, 
OpArgU
, 
OpArgN
, 
iABx
)

100 ,
İmode
(0, 1, 
OpArgU
, 
OpArgN
, 
iABC
)

	@deps/lua/src/lopcodes.h

7 #iâdeà
lİcodes_h


8 
	#lİcodes_h


	)

10 
	~"Îim™s.h
"

31 
	eOpMode
 {
	miABC
, 
	miABx
, 
	miAsBx
};

37 
	#SIZE_C
 9

	)

38 
	#SIZE_B
 9

	)

39 
	#SIZE_Bx
 (
SIZE_C
 + 
SIZE_B
)

	)

40 
	#SIZE_A
 8

	)

42 
	#SIZE_OP
 6

	)

44 
	#POS_OP
 0

	)

45 
	#POS_A
 (
POS_OP
 + 
SIZE_OP
)

	)

46 
	#POS_C
 (
POS_A
 + 
SIZE_A
)

	)

47 
	#POS_B
 (
POS_C
 + 
SIZE_C
)

	)

48 
	#POS_Bx
 
POS_C


	)

56 #ià
SIZE_Bx
 < 
LUAI_BITSINT
-1

57 
	#MAXARG_Bx
 ((1<<
SIZE_Bx
)-1)

	)

58 
	#MAXARG_sBx
 (
MAXARG_Bx
>>1è

	)

60 
	#MAXARG_Bx
 
MAX_INT


	)

61 
	#MAXARG_sBx
 
MAX_INT


	)

65 
	#MAXARG_A
 ((1<<
SIZE_A
)-1)

	)

66 
	#MAXARG_B
 ((1<<
SIZE_B
)-1)

	)

67 
	#MAXARG_C
 ((1<<
SIZE_C
)-1)

	)

71 
	#MASK1
(
n
,
p
è((~((~(
In¡ruùiÚ
)0)<<n))<<p)

	)

74 
	#MASK0
(
n
,
p
è(~
	`MASK1
Ò,p))

	)

80 
	#GET_OPCODE
(
i
è(
	`ÿ¡
(
OpCode
, ((i)>>
POS_OP
è& 
	`MASK1
(
SIZE_OP
,0)))

	)

81 
	#SET_OPCODE
(
i
,
o
è((ièğ(((i)&
	`MASK0
(
SIZE_OP
,
POS_OP
)) | \

82 ((
	`ÿ¡
(
In¡ruùiÚ
, 
o
)<<
POS_OP
)&
	`MASK1
(
SIZE_OP
,POS_OP))))

	)

84 
	#GETARG_A
(
i
è(
	`ÿ¡
(, ((i)>>
POS_A
è& 
	`MASK1
(
SIZE_A
,0)))

	)

85 
	#SETARG_A
(
i
,
u
è((ièğ(((i)&
	`MASK0
(
SIZE_A
,
POS_A
)) | \

86 ((
	`ÿ¡
(
In¡ruùiÚ
, 
u
)<<
POS_A
)&
	`MASK1
(
SIZE_A
,POS_A))))

	)

88 
	#GETARG_B
(
i
è(
	`ÿ¡
(, ((i)>>
POS_B
è& 
	`MASK1
(
SIZE_B
,0)))

	)

89 
	#SETARG_B
(
i
,
b
è((ièğ(((i)&
	`MASK0
(
SIZE_B
,
POS_B
)) | \

90 ((
	`ÿ¡
(
In¡ruùiÚ
, 
b
)<<
POS_B
)&
	`MASK1
(
SIZE_B
,POS_B))))

	)

92 
	#GETARG_C
(
i
è(
	`ÿ¡
(, ((i)>>
POS_C
è& 
	`MASK1
(
SIZE_C
,0)))

	)

93 
	#SETARG_C
(
i
,
b
è((ièğ(((i)&
	`MASK0
(
SIZE_C
,
POS_C
)) | \

94 ((
	`ÿ¡
(
In¡ruùiÚ
, 
b
)<<
POS_C
)&
	`MASK1
(
SIZE_C
,POS_C))))

	)

96 
	#GETARG_Bx
(
i
è(
	`ÿ¡
(, ((i)>>
POS_Bx
è& 
	`MASK1
(
SIZE_Bx
,0)))

	)

97 
	#SETARG_Bx
(
i
,
b
è((ièğ(((i)&
	`MASK0
(
SIZE_Bx
,
POS_Bx
)) | \

98 ((
	`ÿ¡
(
In¡ruùiÚ
, 
b
)<<
POS_Bx
)&
	`MASK1
(
SIZE_Bx
,POS_Bx))))

	)

100 
	#GETARG_sBx
(
i
è(
	`GETARG_Bx
(i)-
MAXARG_sBx
)

	)

101 
	#SETARG_sBx
(
i
,
b
è
	`SETARG_Bx
((i),
	`ÿ¡
(, (b)+
MAXARG_sBx
))

	)

104 
	#CREATE_ABC
(
o
,
a
,
b
,
c
è((
	`ÿ¡
(
In¡ruùiÚ
, o)<<
POS_OP
) \

105 | (
	`ÿ¡
(
In¡ruùiÚ
, 
a
)<<
POS_A
) \

106 | (
	`ÿ¡
(
In¡ruùiÚ
, 
b
)<<
POS_B
) \

107 | (
	`ÿ¡
(
In¡ruùiÚ
, 
c
)<<
POS_C
))

	)

109 
	#CREATE_ABx
(
o
,
a
,
bc
è((
	`ÿ¡
(
In¡ruùiÚ
, o)<<
POS_OP
) \

110 | (
	`ÿ¡
(
In¡ruùiÚ
, 
a
)<<
POS_A
) \

111 | (
	`ÿ¡
(
In¡ruùiÚ
, 
bc
)<<
POS_Bx
))

	)

119 
	#BITRK
 (1 << (
SIZE_B
 - 1))

	)

122 
	#ISK
(
x
è((xè& 
BITRK
)

	)

125 
	#INDEXK
(
r
è(()Ôè& ~
BITRK
)

	)

127 
	#MAXINDEXRK
 (
BITRK
 - 1)

	)

130 
	#RKASK
(
x
è((xè| 
BITRK
)

	)

136 
	#NO_REG
 
MAXARG_A


	)

154 
	mOP_MOVE
,

155 
	mOP_LOADK
,

156 
	mOP_LOADBOOL
,

157 
	mOP_LOADNIL
,

158 
	mOP_GETUPVAL
,

160 
	mOP_GETGLOBAL
,

161 
	mOP_GETTABLE
,

163 
	mOP_SETGLOBAL
,

164 
	mOP_SETUPVAL
,

165 
	mOP_SETTABLE
,

167 
	mOP_NEWTABLE
,

169 
	mOP_SELF
,

171 
	mOP_ADD
,

172 
	mOP_SUB
,

173 
	mOP_MUL
,

174 
	mOP_DIV
,

175 
	mOP_MOD
,

176 
	mOP_POW
,

177 
	mOP_UNM
,

178 
	mOP_NOT
,

179 
	mOP_LEN
,

181 
	mOP_CONCAT
,

183 
	mOP_JMP
,

185 
	mOP_EQ
,

186 
	mOP_LT
,

187 
	mOP_LE
,

189 
	mOP_TEST
,

190 
	mOP_TESTSET
,

192 
	mOP_CALL
,

193 
	mOP_TAILCALL
,

194 
	mOP_RETURN
,

196 
	mOP_FORLOOP
,

198 
	mOP_FORPREP
,

200 
	mOP_TFORLOOP
,

202 
	mOP_SETLIST
,

204 
	mOP_CLOSE
,

205 
	mOP_CLOSURE
,

207 
	mOP_VARARG


208 } 
	tOpCode
;

211 
	#NUM_OPCODES
 (
	`ÿ¡
(, 
OP_VARARG
è+ 1)

	)

245 
	eOpArgMask
 {

246 
	mOpArgN
,

247 
	mOpArgU
,

248 
	mOpArgR
,

249 
	mOpArgK


252 
LUAI_DATA
 cÚ¡ 
lu_by‹
 
	gluaP_İmodes
[
NUM_OPCODES
];

254 
	#g‘OpMode
(
m
è(
	`ÿ¡
(
OpMode
, 
luaP_İmodes
[m] & 3))

	)

255 
	#g‘BMode
(
m
è(
	`ÿ¡
(
OpArgMask
, (
luaP_İmodes
[m] >> 4è& 3))

	)

256 
	#g‘CMode
(
m
è(
	`ÿ¡
(
OpArgMask
, (
luaP_İmodes
[m] >> 2è& 3))

	)

257 
	#‹¡AMode
(
m
è(
luaP_İmodes
[m] & (1 << 6))

	)

258 
	#‹¡TMode
(
m
è(
luaP_İmodes
[m] & (1 << 7))

	)

261 
LUAI_DATA
 cÚ¡ *cÚ¡ 
	gluaP_İÇmes
[
NUM_OPCODES
+1];

265 
	#LFIELDS_PER_FLUSH
 50

	)

	@deps/lua/src/loslib.c

8 
	~<”ºo.h
>

9 
	~<loÿË.h
>

10 
	~<¡dlib.h
>

11 
	~<¡ršg.h
>

12 
	~<time.h
>

14 
	#lo¦ib_c


	)

15 
	#LUA_LIB


	)

17 
	~"lua.h
"

19 
	~"Ïuxlib.h
"

20 
	~"lu®ib.h
"

23 
	$os_push»suÉ
 (
lua_S‹
 *
L
, 
i
, cÚ¡ *
f’ame
) {

24 
’
 = 
”ºo
;

25 ià(
i
) {

26 
	`lua_pushboŞ—n
(
L
, 1);

30 
	`lua_pushn
(
L
);

31 
	`lua_pushf¡ršg
(
L
, "%s: %s", 
f’ame
, 
	`¡»¼Ü
(
’
));

32 
	`lua_pushš‹g”
(
L
, 
’
);

35 
	}
}

38 
	$os_execu‹
 (
lua_S‹
 *
L
) {

39 
	`lua_pushš‹g”
(
L
, 
	`sy¡em
(
	`luaL_İt¡ršg
(L, 1, 
NULL
)));

41 
	}
}

44 
	$os_»move
 (
lua_S‹
 *
L
) {

45 cÚ¡ *
f’ame
 = 
	`luaL_check¡ršg
(
L
, 1);

46  
	`os_push»suÉ
(
L
, 
	`»move
(
f’ame
) == 0, filename);

47 
	}
}

50 
	$os_»Çme
 (
lua_S‹
 *
L
) {

51 cÚ¡ *
äomÇme
 = 
	`luaL_check¡ršg
(
L
, 1);

52 cÚ¡ *
tÚame
 = 
	`luaL_check¡ršg
(
L
, 2);

53  
	`os_push»suÉ
(
L
, 
	`»Çme
(
äomÇme
, 
tÚame
) == 0, fromname);

54 
	}
}

57 
	$os_tm²ame
 (
lua_S‹
 *
L
) {

58 
buff
[
LUA_TMPNAMBUFSIZE
];

59 
”r
;

60 
	`lua_tm²am
(
buff
, 
”r
);

61 ià(
”r
)

62  
	`luaL_”rÜ
(
L
, "unableo generate‡ unique filename");

63 
	`lua_push¡ršg
(
L
, 
buff
);

65 
	}
}

68 
	$os_g‘’v
 (
lua_S‹
 *
L
) {

69 
	`lua_push¡ršg
(
L
, 
	`g‘’v
(
	`luaL_check¡ršg
(L, 1)));

71 
	}
}

74 
	$os_şock
 (
lua_S‹
 *
L
) {

75 
	`lua_pushnumb”
(
L
, ((
lua_Numb”
)
	`şock
())/Öua_Numb”)
CLOCKS_PER_SEC
);

77 
	}
}

88 
	$£tf›ld
 (
lua_S‹
 *
L
, cÚ¡ *
key
, 
v®ue
) {

89 
	`lua_pushš‹g”
(
L
, 
v®ue
);

90 
	`lua_£tf›ld
(
L
, -2, 
key
);

91 
	}
}

93 
	$£tboŞf›ld
 (
lua_S‹
 *
L
, cÚ¡ *
key
, 
v®ue
) {

94 ià(
v®ue
 < 0)

96 
	`lua_pushboŞ—n
(
L
, 
v®ue
);

97 
	`lua_£tf›ld
(
L
, -2, 
key
);

98 
	}
}

100 
	$g‘boŞf›ld
 (
lua_S‹
 *
L
, cÚ¡ *
key
) {

101 
»s
;

102 
	`lua_g‘f›ld
(
L
, -1, 
key
);

103 
»s
 = 
	`lua_i¢
(
L
, -1è? -1 : 
	`lua_toboŞ—n
(L, -1);

104 
	`lua_pİ
(
L
, 1);

105  
»s
;

106 
	}
}

109 
	$g‘f›ld
 (
lua_S‹
 *
L
, cÚ¡ *
key
, 
d
) {

110 
»s
;

111 
	`lua_g‘f›ld
(
L
, -1, 
key
);

112 ià(
	`lua_i¢umb”
(
L
, -1))

113 
»s
 = ()
	`lua_toš‹g”
(
L
, -1);

115 ià(
d
 < 0)

116  
	`luaL_”rÜ
(
L
, "f›ld " 
LUA_QS
 " missšg iÀd©bË", 
key
);

117 
»s
 = 
d
;

119 
	`lua_pİ
(
L
, 1);

120  
»s
;

121 
	}
}

124 
	$os_d©e
 (
lua_S‹
 *
L
) {

125 cÚ¡ *
s
 = 
	`luaL_İt¡ršg
(
L
, 1, "%c");

126 
time_t
 
t
 = 
	`luaL_İt
(
L
, (time_t)
luaL_checknumb”
, 2, 
	`time
(
NULL
));

127 
tm
 *
¡m
;

128 ià(*
s
 == '!') {

129 
¡m
 = 
	`gmtime
(&
t
);

130 
s
++;

133 
¡m
 = 
	`loÿÉime
(&
t
);

134 ià(
¡m
 =ğ
NULL
)

135 
	`lua_pushn
(
L
);

136 ià(
	`¡rcmp
(
s
, "*t") == 0) {

137 
	`lua_ü—‹bË
(
L
, 0, 9);

138 
	`£tf›ld
(
L
, "£c", 
¡m
->
tm_£c
);

139 
	`£tf›ld
(
L
, "mš", 
¡m
->
tm_mš
);

140 
	`£tf›ld
(
L
, "hour", 
¡m
->
tm_hour
);

141 
	`£tf›ld
(
L
, "day", 
¡m
->
tm_mday
);

142 
	`£tf›ld
(
L
, "mÚth", 
¡m
->
tm_mÚ
+1);

143 
	`£tf›ld
(
L
, "y—r", 
¡m
->
tm_y—r
+1900);

144 
	`£tf›ld
(
L
, "wday", 
¡m
->
tm_wday
+1);

145 
	`£tf›ld
(
L
, "yday", 
¡m
->
tm_yday
+1);

146 
	`£tboŞf›ld
(
L
, "isd¡", 
¡m
->
tm_isd¡
);

149 
cc
[3];

150 
luaL_Bufãr
 
b
;

151 
cc
[0] = '%'; cc[2] = '\0';

152 
	`luaL_buffš™
(
L
, &
b
);

153 ; *
s
; s++) {

154 ià(*
s
 != '%' || *(s + 1) == '\0')

155 
	`luaL_addch¬
(&
b
, *
s
);

157 
size_t
 
»¦’
;

158 
buff
[200];

159 
cc
[1] = *(++
s
);

160 
»¦’
 = 
	`¡ráime
(
buff
, (buff), 
cc
, 
¡m
);

161 
	`luaL_addl¡ršg
(&
b
, 
buff
, 
»¦’
);

164 
	`luaL_push»suÉ
(&
b
);

167 
	}
}

170 
	$os_time
 (
lua_S‹
 *
L
) {

171 
time_t
 
t
;

172 ià(
	`lua_i¢ÚeÜn
(
L
, 1))

173 
t
 = 
	`time
(
NULL
);

175 
tm
 
ts
;

176 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

177 
	`lua_£‰İ
(
L
, 1);

178 
ts
.
tm_£c
 = 
	`g‘f›ld
(
L
, "sec", 0);

179 
ts
.
tm_mš
 = 
	`g‘f›ld
(
L
, "min", 0);

180 
ts
.
tm_hour
 = 
	`g‘f›ld
(
L
, "hour", 12);

181 
ts
.
tm_mday
 = 
	`g‘f›ld
(
L
, "day", -1);

182 
ts
.
tm_mÚ
 = 
	`g‘f›ld
(
L
, "month", -1) - 1;

183 
ts
.
tm_y—r
 = 
	`g‘f›ld
(
L
, "year", -1) - 1900;

184 
ts
.
tm_isd¡
 = 
	`g‘boŞf›ld
(
L
, "isdst");

185 
t
 = 
	`mktime
(&
ts
);

187 ià(
t
 =ğ(
time_t
)(-1))

188 
	`lua_pushn
(
L
);

190 
	`lua_pushnumb”
(
L
, (
lua_Numb”
)
t
);

192 
	}
}

195 
	$os_difáime
 (
lua_S‹
 *
L
) {

196 
	`lua_pushnumb”
(
L
, 
	`difáime
((
time_t
)(
	`luaL_checknumb”
(L, 1)),

197 (
time_t
)(
	`luaL_İŠumb”
(
L
, 2, 0))));

199 
	}
}

204 
	$os_£oÿË
 (
lua_S‹
 *
L
) {

205 cÚ¡ 
ÿt
[] = {
LC_ALL
, 
LC_COLLATE
, 
LC_CTYPE
, 
LC_MONETARY
,

206 
LC_NUMERIC
, 
LC_TIME
};

207 cÚ¡ *cÚ¡ 
ÿŠames
[] = {"all", "collate", "ctype", "monetary",

208 "num”ic", "time", 
NULL
};

209 cÚ¡ *
l
 = 
	`luaL_İt¡ršg
(
L
, 1, 
NULL
);

210 
İ
 = 
	`luaL_checkİtiÚ
(
L
, 2, "®l", 
ÿŠames
);

211 
	`lua_push¡ršg
(
L
, 
	`£oÿË
(
ÿt
[
İ
], 
l
));

213 
	}
}

216 
	$os_ex™
 (
lua_S‹
 *
L
) {

217 
	`ex™
(
	`luaL_İtšt
(
L
, 1, 
EXIT_SUCCESS
));

218 
	}
}

220 cÚ¡ 
luaL_Reg
 
	gsy¦ib
[] = {

221 {"şock", 
os_şock
},

222 {"d©e", 
os_d©e
},

223 {"difáime", 
os_difáime
},

224 {"execu‹", 
os_execu‹
},

225 {"ex™", 
os_ex™
},

226 {"g‘’v", 
os_g‘’v
},

227 {"»move", 
os_»move
},

228 {"»Çme", 
os_»Çme
},

229 {"£oÿË", 
os_£oÿË
},

230 {"time", 
os_time
},

231 {"tm²ame", 
os_tm²ame
},

232 {
NULL
, NULL}

239 
LUALIB_API
 
	$luaİ’_os
 (
lua_S‹
 *
L
) {

240 
	`luaL_»gi¡”
(
L
, 
LUA_OSLIBNAME
, 
sy¦ib
);

242 
	}
}

	@deps/lua/src/lparser.c

8 
	~<¡ršg.h
>

10 
	#Í¬£r_c


	)

11 
	#LUA_CORE


	)

13 
	~"lua.h
"

15 
	~"lcode.h
"

16 
	~"ldebug.h
"

17 
	~"ldo.h
"

18 
	~"lfunc.h
"

19 
	~"Îex.h
"

20 
	~"lmem.h
"

21 
	~"lobjeù.h
"

22 
	~"lİcodes.h
"

23 
	~"Í¬£r.h
"

24 
	~"l¡©e.h
"

25 
	~"l¡ršg.h
"

26 
	~"ÉabË.h
"

30 
	#hasmuÉ»t
(
k
è((kè=ğ
VCALL
 || (kè=ğ
VVARARG
)

	)

32 
	#g‘locv¬
(
fs
, 
i
è((fs)->
f
->
locv¬s
[(fs)->
aùv¬
[i]])

	)

34 
	#luaY_checklim™
(
fs
,
v
,
l
,
m
èià((v)>Ö)è
	`”rÜlim™
(fs,l,m)

	)

40 
	sBlockCÁ
 {

41 
BlockCÁ
 *
	m´evious
;

42 
	mb»akli¡
;

43 
lu_by‹
 
	mÇùv¬
;

44 
lu_by‹
 
	mupv®
;

45 
lu_by‹
 
	misb»akabË
;

46 } 
	tBlockCÁ
;

53 
chunk
 (
LexS‹
 *
ls
);

54 
ex´
 (
LexS‹
 *
ls
, 
expdesc
 *
v
);

57 
	$ªchÜ_tok’
 (
LexS‹
 *
ls
) {

58 ià(
ls
->
t
.
tok’
 =ğ
TK_NAME
 ||†s->t.tok’ =ğ
TK_STRING
) {

59 
TSŒšg
 *
ts
 = 
ls
->
t
.
£mšfo
.ts;

60 
	`luaX_Ãw¡ršg
(
ls
, 
	`g‘¡r
(
ts
),s->
tsv
.
Ën
);

62 
	}
}

65 
	$”rÜ_ex³ùed
 (
LexS‹
 *
ls
, 
tok’
) {

66 
	`luaX_syÁax”rÜ
(
ls
,

67 
	`luaO_pushf¡ršg
(
ls
->
L
, 
LUA_QS
 "ƒx³ùed", 
	`luaX_tok’2¡r
Ös, 
tok’
)));

68 
	}
}

71 
	$”rÜlim™
 (
FuncS‹
 *
fs
, 
lim™
, cÚ¡ *
wh©
) {

72 cÚ¡ *
msg
 = (
fs
->
f
->
lšedefšed
 == 0) ?

73 
	`luaO_pushf¡ršg
(
fs
->
L
, "maš funùiÚ ha mÜthª %d %s", 
lim™
, 
wh©
) :

74 
	`luaO_pushf¡ršg
(
fs
->
L
, "function‡t†ine %d has morehan %d %s",

75 
fs
->
f
->
lšedefšed
, 
lim™
, 
wh©
);

76 
	`luaX_Ëx”rÜ
(
fs
->
ls
, 
msg
, 0);

77 
	}
}

80 
	$‹¡Ãxt
 (
LexS‹
 *
ls
, 
c
) {

81 ià(
ls
->
t
.
tok’
 =ğ
c
) {

82 
	`luaX_Ãxt
(
ls
);

86 
	}
}

89 
	$check
 (
LexS‹
 *
ls
, 
c
) {

90 ià(
ls
->
t
.
tok’
 !ğ
c
)

91 
	`”rÜ_ex³ùed
(
ls
, 
c
);

92 
	}
}

94 
	$checkÃxt
 (
LexS‹
 *
ls
, 
c
) {

95 
	`check
(
ls
, 
c
);

96 
	`luaX_Ãxt
(
ls
);

97 
	}
}

100 
	#check_cÚd™iÚ
(
ls
,
c
,
msg
è{ ià(!(c)è
	`luaX_syÁax”rÜ
Ös, msg); }

	)

104 
	$check_m©ch
 (
LexS‹
 *
ls
, 
wh©
, 
who
, 
wh”e
) {

105 ià(!
	`‹¡Ãxt
(
ls
, 
wh©
)) {

106 ià(
wh”e
 =ğ
ls
->
lš’umb”
)

107 
	`”rÜ_ex³ùed
(
ls
, 
wh©
);

109 
	`luaX_syÁax”rÜ
(
ls
, 
	`luaO_pushf¡ršg
Ös->
L
,

110 
LUA_QS
 "ƒxpected (to close " LUA_QS "‡t†ine %d)",

111 
	`luaX_tok’2¡r
(
ls
, 
wh©
),†uaX_tok’2¡rÖs, 
who
), 
wh”e
));

114 
	}
}

117 
TSŒšg
 *
	$¡r_checkÇme
 (
LexS‹
 *
ls
) {

118 
TSŒšg
 *
ts
;

119 
	`check
(
ls
, 
TK_NAME
);

120 
ts
 = 
ls
->
t
.
£mšfo
.ts;

121 
	`luaX_Ãxt
(
ls
);

122  
ts
;

123 
	}
}

126 
	$š™_exp
 (
expdesc
 *
e
, 
expkšd
 
k
, 
i
) {

127 
e
->
f
 =ƒ->
t
 = 
NO_JUMP
;

128 
e
->
k
 = k;

129 
e
->
u
.
s
.
šfo
 = 
i
;

130 
	}
}

133 
	$code¡ršg
 (
LexS‹
 *
ls
, 
expdesc
 *
e
, 
TSŒšg
 *
s
) {

134 
	`š™_exp
(
e
, 
VK
, 
	`luaK_¡ršgK
(
ls
->
fs
, 
s
));

135 
	}
}

138 
	$checkÇme
(
LexS‹
 *
ls
, 
expdesc
 *
e
) {

139 
	`code¡ršg
(
ls
, 
e
, 
	`¡r_checkÇme
(ls));

140 
	}
}

143 
	$»gi¡”loÿlv¬
 (
LexS‹
 *
ls
, 
TSŒšg
 *
v¬Çme
) {

144 
FuncS‹
 *
fs
 = 
ls
->fs;

145 
PrÙo
 *
f
 = 
fs
->f;

146 
Şdsize
 = 
f
->
siz–ocv¬s
;

147 
	`luaM_growveùÜ
(
ls
->
L
, 
f
->
locv¬s
, 
fs
->
Æocv¬s
, f->
siz–ocv¬s
,

148 
LocV¬
, 
SHRT_MAX
, "too many†ocal variables");

149 
Şdsize
 < 
f
->
siz–ocv¬s
èf->
locv¬s
[Şdsize++].
v¬Çme
 = 
NULL
;

150 
f
->
locv¬s
[
fs
->
Æocv¬s
].
v¬Çme
 = varname;

151 
	`luaC_objb¬r›r
(
ls
->
L
, 
f
, 
v¬Çme
);

152  
fs
->
Æocv¬s
++;

153 
	}
}

156 
	#Ãw_loÿlv¬l™”®
(
ls
,
v
,
n
) \

157 
	`Ãw_loÿlv¬
(
ls
, 
	`luaX_Ãw¡ršg
Ös, "" 
v
, ((v)/())-1), 
n
)

	)

160 
	$Ãw_loÿlv¬
 (
LexS‹
 *
ls
, 
TSŒšg
 *
Çme
, 
n
) {

161 
FuncS‹
 *
fs
 = 
ls
->fs;

162 
	`luaY_checklim™
(
fs
, fs->
Çùv¬
+
n
+1, 
LUAI_MAXVARS
, "local variables");

163 
fs
->
aùv¬
[fs->
Çùv¬
+
n
] = 
	`ÿ¡
(, 
	`»gi¡”loÿlv¬
(
ls
, 
Çme
));

164 
	}
}

167 
	$adju¡loÿlv¬s
 (
LexS‹
 *
ls
, 
nv¬s
) {

168 
FuncS‹
 *
fs
 = 
ls
->fs;

169 
fs
->
Çùv¬
 = 
	`ÿ¡_by‹
(fs->Çùv¬ + 
nv¬s
);

170 ; 
nv¬s
;‚vars--) {

171 
	`g‘locv¬
(
fs
, fs->
Çùv¬
 - 
nv¬s
).
¡¬c
 = fs->
pc
;

173 
	}
}

176 
	$»movev¬s
 (
LexS‹
 *
ls
, 
tŞev–
) {

177 
FuncS‹
 *
fs
 = 
ls
->fs;

178 
fs
->
Çùv¬
 > 
tŞev–
)

179 
	`g‘locv¬
(
fs
, --fs->
Çùv¬
).
’dpc
 = fs->
pc
;

180 
	}
}

183 
	$šdexupv®ue
 (
FuncS‹
 *
fs
, 
TSŒšg
 *
Çme
, 
expdesc
 *
v
) {

184 
i
;

185 
PrÙo
 *
f
 = 
fs
->f;

186 
Şdsize
 = 
f
->
sizeupv®ues
;

187 
i
=0; i<
f
->
nups
; i++) {

188 ià(
fs
->
upv®ues
[
i
].
k
 =ğ
v
->k && fs->upv®ues[i].
šfo
 =ğv->
u
.
s
.info) {

189 
	`lua_as£¹
(
f
->
upv®ues
[
i
] =ğ
Çme
);

190  
i
;

194 
	`luaY_checklim™
(
fs
, 
f
->
nups
 + 1, 
LUAI_MAXUPVALUES
, "upvalues");

195 
	`luaM_growveùÜ
(
fs
->
L
, 
f
->
upv®ues
, f->
nups
, f->
sizeupv®ues
,

196 
TSŒšg
 *, 
MAX_INT
, "");

197 
Şdsize
 < 
f
->
sizeupv®ues
èf->
upv®ues
[Şdsize++] = 
NULL
;

198 
f
->
upv®ues
[f->
nups
] = 
Çme
;

199 
	`luaC_objb¬r›r
(
fs
->
L
, 
f
, 
Çme
);

200 
	`lua_as£¹
(
v
->
k
 =ğ
VLOCAL
 || v->k =ğ
VUPVAL
);

201 
fs
->
upv®ues
[
f
->
nups
].
k
 = 
	`ÿ¡_by‹
(
v
->k);

202 
fs
->
upv®ues
[
f
->
nups
].
šfo
 = 
	`ÿ¡_by‹
(
v
->
u
.
s
.info);

203  
f
->
nups
++;

204 
	}
}

207 
	$£¬chv¬
 (
FuncS‹
 *
fs
, 
TSŒšg
 *
n
) {

208 
i
;

209 
i
=
fs
->
Çùv¬
-1; i >= 0; i--) {

210 ià(
n
 =ğ
	`g‘locv¬
(
fs
, 
i
).
v¬Çme
)

211  
i
;

214 
	}
}

217 
	$m¬kupv®
 (
FuncS‹
 *
fs
, 
Ëv–
) {

218 
BlockCÁ
 *
bl
 = 
fs
->bl;

219 
bl
 && bl->
Çùv¬
 > 
Ëv–
èbÈğbl->
´evious
;

220 ià(
bl
èbl->
upv®
 = 1;

221 
	}
}

224 
	$sšgËv¬aux
 (
FuncS‹
 *
fs
, 
TSŒšg
 *
n
, 
expdesc
 *
v¬
, 
ba£
) {

225 ià(
fs
 =ğ
NULL
) {

226 
	`š™_exp
(
v¬
, 
VGLOBAL
, 
NO_REG
);

227  
VGLOBAL
;

230 
v
 = 
	`£¬chv¬
(
fs
, 
n
);

231 ià(
v
 >= 0) {

232 
	`š™_exp
(
v¬
, 
VLOCAL
, 
v
);

233 ià(!
ba£
)

234 
	`m¬kupv®
(
fs
, 
v
);

235  
VLOCAL
;

238 ià(
	`sšgËv¬aux
(
fs
->
´ev
, 
n
, 
v¬
, 0è=ğ
VGLOBAL
)

239  
VGLOBAL
;

240 
v¬
->
u
.
s
.
šfo
 = 
	`šdexupv®ue
(
fs
, 
n
, var);

241 
v¬
->
k
 = 
VUPVAL
;

242  
VUPVAL
;

245 
	}
}

248 
	$sšgËv¬
 (
LexS‹
 *
ls
, 
expdesc
 *
v¬
) {

249 
TSŒšg
 *
v¬Çme
 = 
	`¡r_checkÇme
(
ls
);

250 
FuncS‹
 *
fs
 = 
ls
->fs;

251 ià(
	`sšgËv¬aux
(
fs
, 
v¬Çme
, 
v¬
, 1è=ğ
VGLOBAL
)

252 
v¬
->
u
.
s
.
šfo
 = 
	`luaK_¡ršgK
(
fs
, 
v¬Çme
);

253 
	}
}

256 
	$adju¡_assign
 (
LexS‹
 *
ls
, 
nv¬s
, 
Ãxps
, 
expdesc
 *
e
) {

257 
FuncS‹
 *
fs
 = 
ls
->fs;

258 
exŒa
 = 
nv¬s
 - 
Ãxps
;

259 ià(
	`hasmuÉ»t
(
e
->
k
)) {

260 
exŒa
++;

261 ià(
exŒa
 < 0)ƒxtra = 0;

262 
	`luaK_£Œ‘uºs
(
fs
, 
e
, 
exŒa
);

263 ià(
exŒa
 > 1è
	`luaK_»£rv”egs
(
fs
,ƒxtra-1);

266 ià(
e
->
k
 !ğ
VVOID
è
	`luaK_exp2ÃxŒeg
(
fs
,ƒ);

267 ià(
exŒa
 > 0) {

268 
»g
 = 
fs
->
ä“»g
;

269 
	`luaK_»£rv”egs
(
fs
, 
exŒa
);

270 
	`luaK_n
(
fs
, 
»g
, 
exŒa
);

273 
	}
}

276 
	$’‹¾ev–
 (
LexS‹
 *
ls
) {

277 ià(++
ls
->
L
->
nCÿÎs
 > 
LUAI_MAXCCALLS
)

278 
	`luaX_Ëx”rÜ
(
ls
, "chunk hasoo many syntax†evels", 0);

279 
	}
}

282 
	#Ëav–ev–
(
ls
è(Ös)->
L
->
nCÿÎs
--)

	)

285 
	$’‹rblock
 (
FuncS‹
 *
fs
, 
BlockCÁ
 *
bl
, 
lu_by‹
 
isb»akabË
) {

286 
bl
->
b»akli¡
 = 
NO_JUMP
;

287 
bl
->
isb»akabË
 = isbreakable;

288 
bl
->
Çùv¬
 = 
fs
->nactvar;

289 
bl
->
upv®
 = 0;

290 
bl
->
´evious
 = 
fs
->bl;

291 
fs
->
bl
 = bl;

292 
	`lua_as£¹
(
fs
->
ä“»g
 =ğfs->
Çùv¬
);

293 
	}
}

296 
	$Ëaveblock
 (
FuncS‹
 *
fs
) {

297 
BlockCÁ
 *
bl
 = 
fs
->bl;

298 
fs
->
bl
 = bl->
´evious
;

299 
	`»movev¬s
(
fs
->
ls
, 
bl
->
Çùv¬
);

300 ià(
bl
->
upv®
)

301 
	`luaK_codeABC
(
fs
, 
OP_CLOSE
, 
bl
->
Çùv¬
, 0, 0);

303 
	`lua_as£¹
(!
bl
->
isb»akabË
 || !bl->
upv®
);

304 
	`lua_as£¹
(
bl
->
Çùv¬
 =ğ
fs
->nactvar);

305 
fs
->
ä“»g
 = fs->
Çùv¬
;

306 
	`luaK_·tchtoh”e
(
fs
, 
bl
->
b»akli¡
);

307 
	}
}

310 
	$pushşosu»
 (
LexS‹
 *
ls
, 
FuncS‹
 *
func
, 
expdesc
 *
v
) {

311 
FuncS‹
 *
fs
 = 
ls
->fs;

312 
PrÙo
 *
f
 = 
fs
->f;

313 
Şdsize
 = 
f
->
siz•
;

314 
i
;

315 
	`luaM_growveùÜ
(
ls
->
L
, 
f
->
p
, 
fs
->
Å
, f->
siz•
, 
PrÙo
 *,

316 
MAXARG_Bx
, "constantable overflow");

317 
Şdsize
 < 
f
->
siz•
èf->
p
[Şdsize++] = 
NULL
;

318 
f
->
p
[
fs
->
Å
++] = 
func
->f;

319 
	`luaC_objb¬r›r
(
ls
->
L
, 
f
, 
func
->f);

320 
	`š™_exp
(
v
, 
VRELOCABLE
, 
	`luaK_codeABx
(
fs
, 
OP_CLOSURE
, 0, fs->
Å
-1));

321 
i
=0; i<
func
->
f
->
nups
; i++) {

322 
OpCode
 
o
 = (
func
->
upv®ues
[
i
].
k
 =ğ
VLOCAL
è? 
OP_MOVE
 : 
OP_GETUPVAL
;

323 
	`luaK_codeABC
(
fs
, 
o
, 0, 
func
->
upv®ues
[
i
].
šfo
, 0);

325 
	}
}

328 
	$İ’_func
 (
LexS‹
 *
ls
, 
FuncS‹
 *
fs
) {

329 
lua_S‹
 *
L
 = 
ls
->L;

330 
PrÙo
 *
f
 = 
	`luaF_Ãw´Ùo
(
L
);

331 
fs
->
f
 = f;

332 
fs
->
´ev
 = 
ls
->fs;

333 
fs
->
ls
 =†s;

334 
fs
->
L
 = L;

335 
ls
->
fs
 = fs;

336 
fs
->
pc
 = 0;

337 
fs
->
Ï¡rg‘
 = -1;

338 
fs
->
jpc
 = 
NO_JUMP
;

339 
fs
->
ä“»g
 = 0;

340 
fs
->
nk
 = 0;

341 
fs
->
Å
 = 0;

342 
fs
->
Æocv¬s
 = 0;

343 
fs
->
Çùv¬
 = 0;

344 
fs
->
bl
 = 
NULL
;

345 
f
->
sourû
 = 
ls
->source;

346 
f
->
max¡acksize
 = 2;

347 
fs
->
h
 = 
	`luaH_Ãw
(
L
, 0, 0);

349 
	`£thv®ue2s
(
L
, L->
tİ
, 
fs
->
h
);

350 
	`šü_tİ
(
L
);

351 
	`£tv®ue2s
(
L
, L->
tİ
, 
f
);

352 
	`šü_tİ
(
L
);

353 
	}
}

356 
	$şo£_func
 (
LexS‹
 *
ls
) {

357 
lua_S‹
 *
L
 = 
ls
->L;

358 
FuncS‹
 *
fs
 = 
ls
->fs;

359 
PrÙo
 *
f
 = 
fs
->f;

360 
	`»movev¬s
(
ls
, 0);

361 
	`luaK_»t
(
fs
, 0, 0);

362 
	`luaM_»®locveùÜ
(
L
, 
f
->
code
, f->
sizecode
, 
fs
->
pc
, 
In¡ruùiÚ
);

363 
f
->
sizecode
 = 
fs
->
pc
;

364 
	`luaM_»®locveùÜ
(
L
, 
f
->
lšešfo
, f->
siz–šešfo
, 
fs
->
pc
, );

365 
f
->
siz–šešfo
 = 
fs
->
pc
;

366 
	`luaM_»®locveùÜ
(
L
, 
f
->
k
, f->
sizek
, 
fs
->
nk
, 
TV®ue
);

367 
f
->
sizek
 = 
fs
->
nk
;

368 
	`luaM_»®locveùÜ
(
L
, 
f
->
p
, f->
siz•
, 
fs
->
Å
, 
PrÙo
 *);

369 
f
->
siz•
 = 
fs
->
Å
;

370 
	`luaM_»®locveùÜ
(
L
, 
f
->
locv¬s
, f->
siz–ocv¬s
, 
fs
->
Æocv¬s
, 
LocV¬
);

371 
f
->
siz–ocv¬s
 = 
fs
->
Æocv¬s
;

372 
	`luaM_»®locveùÜ
(
L
, 
f
->
upv®ues
, f->
sizeupv®ues
, f->
nups
, 
TSŒšg
 *);

373 
f
->
sizeupv®ues
 = f->
nups
;

374 
	`lua_as£¹
(
	`luaG_checkcode
(
f
));

375 
	`lua_as£¹
(
fs
->
bl
 =ğ
NULL
);

376 
ls
->
fs
 = fs->
´ev
;

378 ià(
fs
è
	`ªchÜ_tok’
(
ls
);

379 
L
->
tİ
 -= 2;

380 
	}
}

383 
PrÙo
 *
	$luaY_·r£r
 (
lua_S‹
 *
L
, 
ZIO
 *
z
, 
Mbufãr
 *
buff
, cÚ¡ *
Çme
) {

384 
LexS‹
 
Ëx¡©e
;

385 
FuncS‹
 
func¡©e
;

386 
Ëx¡©e
.
buff
 = buff;

387 
	`luaX_£tšput
(
L
, &
Ëx¡©e
, 
z
, 
	`luaS_Ãw
(L, 
Çme
));

388 
	`İ’_func
(&
Ëx¡©e
, &
func¡©e
);

389 
func¡©e
.
f
->
is_v¬¬g
 = 
VARARG_ISVARARG
;

390 
	`luaX_Ãxt
(&
Ëx¡©e
);

391 
	`chunk
(&
Ëx¡©e
);

392 
	`check
(&
Ëx¡©e
, 
TK_EOS
);

393 
	`şo£_func
(&
Ëx¡©e
);

394 
	`lua_as£¹
(
func¡©e
.
´ev
 =ğ
NULL
);

395 
	`lua_as£¹
(
func¡©e
.
f
->
nups
 == 0);

396 
	`lua_as£¹
(
Ëx¡©e
.
fs
 =ğ
NULL
);

397  
func¡©e
.
f
;

398 
	}
}

407 
	$f›ld
 (
LexS‹
 *
ls
, 
expdesc
 *
v
) {

409 
FuncS‹
 *
fs
 = 
ls
->fs;

410 
expdesc
 
key
;

411 
	`luaK_exp2ªy»g
(
fs
, 
v
);

412 
	`luaX_Ãxt
(
ls
);

413 
	`checkÇme
(
ls
, &
key
);

414 
	`luaK_šdexed
(
fs
, 
v
, &
key
);

415 
	}
}

418 
	$yšdex
 (
LexS‹
 *
ls
, 
expdesc
 *
v
) {

420 
	`luaX_Ãxt
(
ls
);

421 
	`ex´
(
ls
, 
v
);

422 
	`luaK_exp2v®
(
ls
->
fs
, 
v
);

423 
	`checkÃxt
(
ls
, ']');

424 
	}
}

434 
	sCÚsCÚŒŞ
 {

435 
expdesc
 
	mv
;

436 
expdesc
 *
	mt
;

437 
	mnh
;

438 
	mÇ
;

439 
	mto¡Üe
;

443 
	$»cf›ld
 (
LexS‹
 *
ls
, 
CÚsCÚŒŞ
 *
cc
) {

445 
FuncS‹
 *
fs
 = 
ls
->fs;

446 
»g
 = 
ls
->
fs
->
ä“»g
;

447 
expdesc
 
key
, 
v®
;

448 
rkkey
;

449 ià(
ls
->
t
.
tok’
 =ğ
TK_NAME
) {

450 
	`luaY_checklim™
(
fs
, 
cc
->
nh
, 
MAX_INT
, "items in‡ constructor");

451 
	`checkÇme
(
ls
, &
key
);

454 
	`yšdex
(
ls
, &
key
);

455 
cc
->
nh
++;

456 
	`checkÃxt
(
ls
, '=');

457 
rkkey
 = 
	`luaK_exp2RK
(
fs
, &
key
);

458 
	`ex´
(
ls
, &
v®
);

459 
	`luaK_codeABC
(
fs
, 
OP_SETTABLE
, 
cc
->
t
->
u
.
s
.
šfo
, 
rkkey
, 
	`luaK_exp2RK
(fs, &
v®
));

460 
fs
->
ä“»g
 = 
»g
;

461 
	}
}

464 
	$şo£li¡f›ld
 (
FuncS‹
 *
fs
, 
CÚsCÚŒŞ
 *
cc
) {

465 ià(
cc
->
v
.
k
 =ğ
VVOID
) ;

466 
	`luaK_exp2ÃxŒeg
(
fs
, &
cc
->
v
);

467 
cc
->
v
.
k
 = 
VVOID
;

468 ià(
cc
->
to¡Üe
 =ğ
LFIELDS_PER_FLUSH
) {

469 
	`luaK_£i¡
(
fs
, 
cc
->
t
->
u
.
s
.
šfo
, cc->
Ç
, cc->
to¡Üe
);

470 
cc
->
to¡Üe
 = 0;

472 
	}
}

475 
	$Ï¡li¡f›ld
 (
FuncS‹
 *
fs
, 
CÚsCÚŒŞ
 *
cc
) {

476 ià(
cc
->
to¡Üe
 == 0) ;

477 ià(
	`hasmuÉ»t
(
cc
->
v
.
k
)) {

478 
	`luaK_£tmuÉ»t
(
fs
, &
cc
->
v
);

479 
	`luaK_£i¡
(
fs
, 
cc
->
t
->
u
.
s
.
šfo
, cc->
Ç
, 
LUA_MULTRET
);

480 
cc
->
Ç
--;

483 ià(
cc
->
v
.
k
 !ğ
VVOID
)

484 
	`luaK_exp2ÃxŒeg
(
fs
, &
cc
->
v
);

485 
	`luaK_£i¡
(
fs
, 
cc
->
t
->
u
.
s
.
šfo
, cc->
Ç
, cc->
to¡Üe
);

487 
	}
}

490 
	$li¡f›ld
 (
LexS‹
 *
ls
, 
CÚsCÚŒŞ
 *
cc
) {

491 
	`ex´
(
ls
, &
cc
->
v
);

492 
	`luaY_checklim™
(
ls
->
fs
, 
cc
->
Ç
, 
MAX_INT
, "items in‡ constructor");

493 
cc
->
Ç
++;

494 
cc
->
to¡Üe
++;

495 
	}
}

498 
	$cÚ¡ruùÜ
 (
LexS‹
 *
ls
, 
expdesc
 *
t
) {

500 
FuncS‹
 *
fs
 = 
ls
->fs;

501 
lše
 = 
ls
->
lš’umb”
;

502 
pc
 = 
	`luaK_codeABC
(
fs
, 
OP_NEWTABLE
, 0, 0, 0);

503 
CÚsCÚŒŞ
 
cc
;

504 
cc
.
Ç
 = cc.
nh
 = cc.
to¡Üe
 = 0;

505 
cc
.
t
 =;

506 
	`š™_exp
(
t
, 
VRELOCABLE
, 
pc
);

507 
	`š™_exp
(&
cc
.
v
, 
VVOID
, 0);

508 
	`luaK_exp2ÃxŒeg
(
ls
->
fs
, 
t
);

509 
	`checkÃxt
(
ls
, '{');

511 
	`lua_as£¹
(
cc
.
v
.
k
 =ğ
VVOID
 || cc.
to¡Üe
 > 0);

512 ià(
ls
->
t
.
tok’
 == '}') ;

513 
	`şo£li¡f›ld
(
fs
, &
cc
);

514 
ls
->
t
.
tok’
) {

515 
TK_NAME
: {

516 
	`luaX_lookah—d
(
ls
);

517 ià(
ls
->
lookah—d
.
tok’
 != '=')

518 
	`li¡f›ld
(
ls
, &
cc
);

520 
	`»cf›ld
(
ls
, &
cc
);

524 
	`»cf›ld
(
ls
, &
cc
);

528 
	`li¡f›ld
(
ls
, &
cc
);

532 } 
	`‹¡Ãxt
(
ls
, ',') ||estnext(ls, ';'));

533 
	`check_m©ch
(
ls
, '}', '{', 
lše
);

534 
	`Ï¡li¡f›ld
(
fs
, &
cc
);

535 
	`SETARG_B
(
fs
->
f
->
code
[
pc
], 
	`luaO_št2fb
(
cc
.
Ç
));

536 
	`SETARG_C
(
fs
->
f
->
code
[
pc
], 
	`luaO_št2fb
(
cc
.
nh
));

537 
	}
}

543 
	$·¾i¡
 (
LexS‹
 *
ls
) {

545 
FuncS‹
 *
fs
 = 
ls
->fs;

546 
PrÙo
 *
f
 = 
fs
->f;

547 
Å¬ams
 = 0;

548 
f
->
is_v¬¬g
 = 0;

549 ià(
ls
->
t
.
tok’
 != ')') {

551 
ls
->
t
.
tok’
) {

552 
TK_NAME
: {

553 
	`Ãw_loÿlv¬
(
ls
, 
	`¡r_checkÇme
Ös), 
Å¬ams
++);

556 
TK_DOTS
: {

557 
	`luaX_Ãxt
(
ls
);

558 #ià
	`defšed
(
LUA_COMPAT_VARARG
)

560 
	`Ãw_loÿlv¬l™”®
(
ls
, "¬g", 
Å¬ams
++);

561 
f
->
is_v¬¬g
 = 
VARARG_HASARG
 | 
VARARG_NEEDSARG
;

563 
f
->
is_v¬¬g
 |ğ
VARARG_ISVARARG
;

566 : 
	`luaX_syÁax”rÜ
(
ls
, "<Çme> o¸" 
	`LUA_QL
("...") "ƒxpected");

568 } !
f
->
is_v¬¬g
 && 
	`‹¡Ãxt
(
ls
, ','));

570 
	`adju¡loÿlv¬s
(
ls
, 
Å¬ams
);

571 
f
->
num·¿ms
 = 
	`ÿ¡_by‹
(
fs
->
Çùv¬
 - (f->
is_v¬¬g
 & 
VARARG_HASARG
));

572 
	`luaK_»£rv”egs
(
fs
, fs->
Çùv¬
);

573 
	}
}

576 
	$body
 (
LexS‹
 *
ls
, 
expdesc
 *
e
, 
Ãed£lf
, 
lše
) {

578 
FuncS‹
 
Ãw_fs
;

579 
	`İ’_func
(
ls
, &
Ãw_fs
);

580 
Ãw_fs
.
f
->
lšedefšed
 = 
lše
;

581 
	`checkÃxt
(
ls
, '(');

582 ià(
Ãed£lf
) {

583 
	`Ãw_loÿlv¬l™”®
(
ls
, "self", 0);

584 
	`adju¡loÿlv¬s
(
ls
, 1);

586 
	`·¾i¡
(
ls
);

587 
	`checkÃxt
(
ls
, ')');

588 
	`chunk
(
ls
);

589 
Ãw_fs
.
f
->
Ï¡lšedefšed
 = 
ls
->
lš’umb”
;

590 
	`check_m©ch
(
ls
, 
TK_END
, 
TK_FUNCTION
, 
lše
);

591 
	`şo£_func
(
ls
);

592 
	`pushşosu»
(
ls
, &
Ãw_fs
, 
e
);

593 
	}
}

596 
	$ex¶i¡1
 (
LexS‹
 *
ls
, 
expdesc
 *
v
) {

598 
n
 = 1;

599 
	`ex´
(
ls
, 
v
);

600 
	`‹¡Ãxt
(
ls
, ',')) {

601 
	`luaK_exp2ÃxŒeg
(
ls
->
fs
, 
v
);

602 
	`ex´
(
ls
, 
v
);

603 
n
++;

605  
n
;

606 
	}
}

609 
	$funÿrgs
 (
LexS‹
 *
ls
, 
expdesc
 *
f
) {

610 
FuncS‹
 *
fs
 = 
ls
->fs;

611 
expdesc
 
¬gs
;

612 
ba£
, 
Å¬ams
;

613 
lše
 = 
ls
->
lš’umb”
;

614 
ls
->
t
.
tok’
) {

616 ià(
lše
 !ğ
ls
->
Ï¡lše
)

617 
	`luaX_syÁax”rÜ
(
ls
,"ambiguous syntax (function call x‚ew statement)");

618 
	`luaX_Ãxt
(
ls
);

619 ià(
ls
->
t
.
tok’
 == ')')

620 
¬gs
.
k
 = 
VVOID
;

622 
	`ex¶i¡1
(
ls
, &
¬gs
);

623 
	`luaK_£tmuÉ»t
(
fs
, &
¬gs
);

625 
	`check_m©ch
(
ls
, ')', '(', 
lše
);

629 
	`cÚ¡ruùÜ
(
ls
, &
¬gs
);

632 
TK_STRING
: {

633 
	`code¡ršg
(
ls
, &
¬gs
,†s->
t
.
£mšfo
.
ts
);

634 
	`luaX_Ãxt
(
ls
);

638 
	`luaX_syÁax”rÜ
(
ls
, "function‡rgumentsƒxpected");

642 
	`lua_as£¹
(
f
->
k
 =ğ
VNONRELOC
);

643 
ba£
 = 
f
->
u
.
s
.
šfo
;

644 ià(
	`hasmuÉ»t
(
¬gs
.
k
))

645 
Å¬ams
 = 
LUA_MULTRET
;

647 ià(
¬gs
.
k
 !ğ
VVOID
)

648 
	`luaK_exp2ÃxŒeg
(
fs
, &
¬gs
);

649 
Å¬ams
 = 
fs
->
ä“»g
 - (
ba£
+1);

651 
	`š™_exp
(
f
, 
VCALL
, 
	`luaK_codeABC
(
fs
, 
OP_CALL
, 
ba£
, 
Å¬ams
+1, 2));

652 
	`luaK_fixlše
(
fs
, 
lše
);

653 
fs
->
ä“»g
 = 
ba£
+1;

655 
	}
}

667 
	$´efixexp
 (
LexS‹
 *
ls
, 
expdesc
 *
v
) {

669 
ls
->
t
.
tok’
) {

671 
lše
 = 
ls
->
lš’umb”
;

672 
	`luaX_Ãxt
(
ls
);

673 
	`ex´
(
ls
, 
v
);

674 
	`check_m©ch
(
ls
, ')', '(', 
lše
);

675 
	`luaK_disch¬gev¬s
(
ls
->
fs
, 
v
);

678 
TK_NAME
: {

679 
	`sšgËv¬
(
ls
, 
v
);

683 
	`luaX_syÁax”rÜ
(
ls
, "unexpected symbol");

687 
	}
}

690 
	$´im¬yexp
 (
LexS‹
 *
ls
, 
expdesc
 *
v
) {

693 
FuncS‹
 *
fs
 = 
ls
->fs;

694 
	`´efixexp
(
ls
, 
v
);

696 
ls
->
t
.
tok’
) {

698 
	`f›ld
(
ls
, 
v
);

702 
expdesc
 
key
;

703 
	`luaK_exp2ªy»g
(
fs
, 
v
);

704 
	`yšdex
(
ls
, &
key
);

705 
	`luaK_šdexed
(
fs
, 
v
, &
key
);

709 
expdesc
 
key
;

710 
	`luaX_Ãxt
(
ls
);

711 
	`checkÇme
(
ls
, &
key
);

712 
	`luaK_£lf
(
fs
, 
v
, &
key
);

713 
	`funÿrgs
(
ls
, 
v
);

716 '(': 
TK_STRING
: '{': {

717 
	`luaK_exp2ÃxŒeg
(
fs
, 
v
);

718 
	`funÿrgs
(
ls
, 
v
);

724 
	}
}

727 
	$sim¶“xp
 (
LexS‹
 *
ls
, 
expdesc
 *
v
) {

730 
ls
->
t
.
tok’
) {

731 
TK_NUMBER
: {

732 
	`š™_exp
(
v
, 
VKNUM
, 0);

733 
v
->
u
.
nv®
 = 
ls
->
t
.
£mšfo
.
r
;

736 
TK_STRING
: {

737 
	`code¡ršg
(
ls
, 
v
,†s->
t
.
£mšfo
.
ts
);

740 
TK_NIL
: {

741 
	`š™_exp
(
v
, 
VNIL
, 0);

744 
TK_TRUE
: {

745 
	`š™_exp
(
v
, 
VTRUE
, 0);

748 
TK_FALSE
: {

749 
	`š™_exp
(
v
, 
VFALSE
, 0);

752 
TK_DOTS
: {

753 
FuncS‹
 *
fs
 = 
ls
->fs;

754 
	`check_cÚd™iÚ
(
ls
, 
fs
->
f
->
is_v¬¬g
,

755 "ÿÂÙ u£ " 
	`LUA_QL
("...") " outside‡ vararg function");

756 
fs
->
f
->
is_v¬¬g
 &ğ~
VARARG_NEEDSARG
;

757 
	`š™_exp
(
v
, 
VVARARG
, 
	`luaK_codeABC
(
fs
, 
OP_VARARG
, 0, 1, 0));

761 
	`cÚ¡ruùÜ
(
ls
, 
v
);

764 
TK_FUNCTION
: {

765 
	`luaX_Ãxt
(
ls
);

766 
	`body
(
ls
, 
v
, 0,†s->
lš’umb”
);

770 
	`´im¬yexp
(
ls
, 
v
);

774 
	`luaX_Ãxt
(
ls
);

775 
	}
}

778 
UnO´
 
	$g‘unİr
 (
İ
) {

779 
İ
) {

780 
TK_NOT
:  
OPR_NOT
;

781 '-':  
OPR_MINUS
;

782 '#':  
OPR_LEN
;

783 :  
OPR_NOUNOPR
;

785 
	}
}

788 
BšO´
 
	$g‘bšİr
 (
İ
) {

789 
İ
) {

790 '+':  
OPR_ADD
;

791 '-':  
OPR_SUB
;

792 '*':  
OPR_MUL
;

793 '/':  
OPR_DIV
;

794 '%':  
OPR_MOD
;

795 '^':  
OPR_POW
;

796 
TK_CONCAT
:  
OPR_CONCAT
;

797 
TK_NE
:  
OPR_NE
;

798 
TK_EQ
:  
OPR_EQ
;

799 '<':  
OPR_LT
;

800 
TK_LE
:  
OPR_LE
;

801 '>':  
OPR_GT
;

802 
TK_GE
:  
OPR_GE
;

803 
TK_AND
:  
OPR_AND
;

804 
TK_OR
:  
OPR_OR
;

805 :  
OPR_NOBINOPR
;

807 
	}
}

811 
lu_by‹
 
	mËá
;

812 
lu_by‹
 
	mright
;

813 } 
	g´iÜ™y
[] = {

821 
	#UNARY_PRIORITY
 8

	)

828 
BšO´
 
	$subex´
 (
LexS‹
 *
ls
, 
expdesc
 *
v
, 
lim™
) {

829 
BšO´
 
İ
;

830 
UnO´
 
uİ
;

831 
	`’‹¾ev–
(
ls
);

832 
uİ
 = 
	`g‘unİr
(
ls
->
t
.
tok’
);

833 ià(
uİ
 !ğ
OPR_NOUNOPR
) {

834 
	`luaX_Ãxt
(
ls
);

835 
	`subex´
(
ls
, 
v
, 
UNARY_PRIORITY
);

836 
	`luaK_´efix
(
ls
->
fs
, 
uİ
, 
v
);

838 
	`sim¶“xp
(
ls
, 
v
);

840 
İ
 = 
	`g‘bšİr
(
ls
->
t
.
tok’
);

841 
İ
 !ğ
OPR_NOBINOPR
 && 
´iÜ™y
[İ].
Ëá
 > 
lim™
) {

842 
expdesc
 
v2
;

843 
BšO´
 
Ãxtİ
;

844 
	`luaX_Ãxt
(
ls
);

845 
	`luaK_šfix
(
ls
->
fs
, 
İ
, 
v
);

847 
Ãxtİ
 = 
	`subex´
(
ls
, &
v2
, 
´iÜ™y
[
İ
].
right
);

848 
	`luaK_posfix
(
ls
->
fs
, 
İ
, 
v
, &
v2
);

849 
İ
 = 
Ãxtİ
;

851 
	`Ëav–ev–
(
ls
);

852  
İ
;

853 
	}
}

856 
	$ex´
 (
LexS‹
 *
ls
, 
expdesc
 *
v
) {

857 
	`subex´
(
ls
, 
v
, 0);

858 
	}
}

871 
	$block_fŞlow
 (
tok’
) {

872 
tok’
) {

873 
TK_ELSE
: 
TK_ELSEIF
: 
TK_END
:

874 
TK_UNTIL
: 
TK_EOS
:

878 
	}
}

881 
	$block
 (
LexS‹
 *
ls
) {

883 
FuncS‹
 *
fs
 = 
ls
->fs;

884 
BlockCÁ
 
bl
;

885 
	`’‹rblock
(
fs
, &
bl
, 0);

886 
	`chunk
(
ls
);

887 
	`lua_as£¹
(
bl
.
b»akli¡
 =ğ
NO_JUMP
);

888 
	`Ëaveblock
(
fs
);

889 
	}
}

896 
	sLHS_assign
 {

897 
LHS_assign
 *
	m´ev
;

898 
expdesc
 
	mv
;

908 
	$check_cÚæiù
 (
LexS‹
 *
ls
, 
LHS_assign
 *
lh
, 
expdesc
 *
v
) {

909 
FuncS‹
 *
fs
 = 
ls
->fs;

910 
exŒa
 = 
fs
->
ä“»g
;

911 
cÚæiù
 = 0;

912 ; 
lh
;†h =†h->
´ev
) {

913 ià(
lh
->
v
.
k
 =ğ
VINDEXED
) {

914 ià(
lh
->
v
.
u
.
s
.
šfo
 == v->u.s.info) {

915 
cÚæiù
 = 1;

916 
lh
->
v
.
u
.
s
.
šfo
 = 
exŒa
;

918 ià(
lh
->
v
.
u
.
s
.
aux
 =ğv->u.s.
šfo
) {

919 
cÚæiù
 = 1;

920 
lh
->
v
.
u
.
s
.
aux
 = 
exŒa
;

924 ià(
cÚæiù
) {

925 
	`luaK_codeABC
(
fs
, 
OP_MOVE
, fs->
ä“»g
, 
v
->
u
.
s
.
šfo
, 0);

926 
	`luaK_»£rv”egs
(
fs
, 1);

928 
	}
}

931 
	$assignm’t
 (
LexS‹
 *
ls
, 
LHS_assign
 *
lh
, 
nv¬s
) {

932 
expdesc
 
e
;

933 
	`check_cÚd™iÚ
(
ls
, 
VLOCAL
 <ğ
lh
->
v
.
k
 &&†h->v.k <ğ
VINDEXED
,

935 ià(
	`‹¡Ãxt
(
ls
, ',')) {

936 
LHS_assign
 
nv
;

937 
nv
.
´ev
 = 
lh
;

938 
	`´im¬yexp
(
ls
, &
nv
.
v
);

939 ià(
nv
.
v
.
k
 =ğ
VLOCAL
)

940 
	`check_cÚæiù
(
ls
, 
lh
, &
nv
.
v
);

941 
	`luaY_checklim™
(
ls
->
fs
, 
nv¬s
, 
LUAI_MAXCCALLS
 -†s->
L
->
nCÿÎs
,

943 
	`assignm’t
(
ls
, &
nv
, 
nv¬s
+1);

946 
Ãxps
;

947 
	`checkÃxt
(
ls
, '=');

948 
Ãxps
 = 
	`ex¶i¡1
(
ls
, &
e
);

949 ià(
Ãxps
 !ğ
nv¬s
) {

950 
	`adju¡_assign
(
ls
, 
nv¬s
, 
Ãxps
, &
e
);

951 ià(
Ãxps
 > 
nv¬s
)

952 
ls
->
fs
->
ä“»g
 -ğ
Ãxps
 - 
nv¬s
;

955 
	`luaK_£tÚ”‘
(
ls
->
fs
, &
e
);

956 
	`luaK_¡Üev¬
(
ls
->
fs
, &
lh
->
v
, &
e
);

960 
	`š™_exp
(&
e
, 
VNONRELOC
, 
ls
->
fs
->
ä“»g
-1);

961 
	`luaK_¡Üev¬
(
ls
->
fs
, &
lh
->
v
, &
e
);

962 
	}
}

965 
	$cÚd
 (
LexS‹
 *
ls
) {

967 
expdesc
 
v
;

968 
	`ex´
(
ls
, &
v
);

969 ià(
v
.
k
 =ğ
VNIL
èv.k = 
VFALSE
;

970 
	`luaK_goiárue
(
ls
->
fs
, &
v
);

971  
v
.
f
;

972 
	}
}

975 
	$b»ak¡©
 (
LexS‹
 *
ls
) {

976 
FuncS‹
 *
fs
 = 
ls
->fs;

977 
BlockCÁ
 *
bl
 = 
fs
->bl;

978 
upv®
 = 0;

979 
bl
 && !bl->
isb»akabË
) {

980 
upv®
 |ğ
bl
->upval;

981 
bl
 = bl->
´evious
;

983 ià(!
bl
)

984 
	`luaX_syÁax”rÜ
(
ls
, "no†oopo break");

985 ià(
upv®
)

986 
	`luaK_codeABC
(
fs
, 
OP_CLOSE
, 
bl
->
Çùv¬
, 0, 0);

987 
	`luaK_cÚÿt
(
fs
, &
bl
->
b»akli¡
, 
	`luaK_jump
(fs));

988 
	}
}

991 
	$whe¡©
 (
LexS‹
 *
ls
, 
lše
) {

993 
FuncS‹
 *
fs
 = 
ls
->fs;

994 
wheš™
;

995 
cÚdex™
;

996 
BlockCÁ
 
bl
;

997 
	`luaX_Ãxt
(
ls
);

998 
wheš™
 = 
	`luaK_g‘Ïb–
(
fs
);

999 
cÚdex™
 = 
	`cÚd
(
ls
);

1000 
	`’‹rblock
(
fs
, &
bl
, 1);

1001 
	`checkÃxt
(
ls
, 
TK_DO
);

1002 
	`block
(
ls
);

1003 
	`luaK_·tchli¡
(
fs
, 
	`luaK_jump
(fs), 
wheš™
);

1004 
	`check_m©ch
(
ls
, 
TK_END
, 
TK_WHILE
, 
lše
);

1005 
	`Ëaveblock
(
fs
);

1006 
	`luaK_·tchtoh”e
(
fs
, 
cÚdex™
);

1007 
	}
}

1010 
	$»³©¡©
 (
LexS‹
 *
ls
, 
lše
) {

1012 
cÚdex™
;

1013 
FuncS‹
 *
fs
 = 
ls
->fs;

1014 
»³©_š™
 = 
	`luaK_g‘Ïb–
(
fs
);

1015 
BlockCÁ
 
bl1
, 
bl2
;

1016 
	`’‹rblock
(
fs
, &
bl1
, 1);

1017 
	`’‹rblock
(
fs
, &
bl2
, 0);

1018 
	`luaX_Ãxt
(
ls
);

1019 
	`chunk
(
ls
);

1020 
	`check_m©ch
(
ls
, 
TK_UNTIL
, 
TK_REPEAT
, 
lše
);

1021 
cÚdex™
 = 
	`cÚd
(
ls
);

1022 ià(!
bl2
.
upv®
) {

1023 
	`Ëaveblock
(
fs
);

1024 
	`luaK_·tchli¡
(
ls
->
fs
, 
cÚdex™
, 
»³©_š™
);

1027 
	`b»ak¡©
(
ls
);

1028 
	`luaK_·tchtoh”e
(
ls
->
fs
, 
cÚdex™
);

1029 
	`Ëaveblock
(
fs
);

1030 
	`luaK_·tchli¡
(
ls
->
fs
, 
	`luaK_jump
(fs), 
»³©_š™
);

1032 
	`Ëaveblock
(
fs
);

1033 
	}
}

1036 
	$exp1
 (
LexS‹
 *
ls
) {

1037 
expdesc
 
e
;

1038 
k
;

1039 
	`ex´
(
ls
, &
e
);

1040 
k
 = 
e
.k;

1041 
	`luaK_exp2ÃxŒeg
(
ls
->
fs
, &
e
);

1042  
k
;

1043 
	}
}

1046 
	$fÜbody
 (
LexS‹
 *
ls
, 
ba£
, 
lše
, 
nv¬s
, 
i¢um
) {

1048 
BlockCÁ
 
bl
;

1049 
FuncS‹
 *
fs
 = 
ls
->fs;

1050 
´•
, 
’dfÜ
;

1051 
	`adju¡loÿlv¬s
(
ls
, 3);

1052 
	`checkÃxt
(
ls
, 
TK_DO
);

1053 
´•
 = 
i¢um
 ? 
	`luaK_codeAsBx
(
fs
, 
OP_FORPREP
, 
ba£
, 
NO_JUMP
è: 
	`luaK_jump
(fs);

1054 
	`’‹rblock
(
fs
, &
bl
, 0);

1055 
	`adju¡loÿlv¬s
(
ls
, 
nv¬s
);

1056 
	`luaK_»£rv”egs
(
fs
, 
nv¬s
);

1057 
	`block
(
ls
);

1058 
	`Ëaveblock
(
fs
);

1059 
	`luaK_·tchtoh”e
(
fs
, 
´•
);

1060 
’dfÜ
 = (
i¢um
è? 
	`luaK_codeAsBx
(
fs
, 
OP_FORLOOP
, 
ba£
, 
NO_JUMP
) :

1061 
	`luaK_codeABC
(
fs
, 
OP_TFORLOOP
, 
ba£
, 0, 
nv¬s
);

1062 
	`luaK_fixlše
(
fs
, 
lše
);

1063 
	`luaK_·tchli¡
(
fs
, (
i¢um
 ? 
’dfÜ
 : 
	`luaK_jump
(fs)), 
´•
 + 1);

1064 
	}
}

1067 
	$fÜnum
 (
LexS‹
 *
ls
, 
TSŒšg
 *
v¬Çme
, 
lše
) {

1069 
FuncS‹
 *
fs
 = 
ls
->fs;

1070 
ba£
 = 
fs
->
ä“»g
;

1071 
	`Ãw_loÿlv¬l™”®
(
ls
, "(for index)", 0);

1072 
	`Ãw_loÿlv¬l™”®
(
ls
, "(for†imit)", 1);

1073 
	`Ãw_loÿlv¬l™”®
(
ls
, "(for step)", 2);

1074 
	`Ãw_loÿlv¬
(
ls
, 
v¬Çme
, 3);

1075 
	`checkÃxt
(
ls
, '=');

1076 
	`exp1
(
ls
);

1077 
	`checkÃxt
(
ls
, ',');

1078 
	`exp1
(
ls
);

1079 ià(
	`‹¡Ãxt
(
ls
, ','))

1080 
	`exp1
(
ls
);

1082 
	`luaK_codeABx
(
fs
, 
OP_LOADK
, fs->
ä“»g
, 
	`luaK_numb”K
(fs, 1));

1083 
	`luaK_»£rv”egs
(
fs
, 1);

1085 
	`fÜbody
(
ls
, 
ba£
, 
lše
, 1, 1);

1086 
	}
}

1089 
	$fÜli¡
 (
LexS‹
 *
ls
, 
TSŒšg
 *
šdexÇme
) {

1091 
FuncS‹
 *
fs
 = 
ls
->fs;

1092 
expdesc
 
e
;

1093 
nv¬s
 = 0;

1094 
lše
;

1095 
ba£
 = 
fs
->
ä“»g
;

1097 
	`Ãw_loÿlv¬l™”®
(
ls
, "(fÜ g’”©Ü)", 
nv¬s
++);

1098 
	`Ãw_loÿlv¬l™”®
(
ls
, "(fÜ s‹)", 
nv¬s
++);

1099 
	`Ãw_loÿlv¬l™”®
(
ls
, "(fÜ cÚŒŞ)", 
nv¬s
++);

1101 
	`Ãw_loÿlv¬
(
ls
, 
šdexÇme
, 
nv¬s
++);

1102 
	`‹¡Ãxt
(
ls
, ','))

1103 
	`Ãw_loÿlv¬
(
ls
, 
	`¡r_checkÇme
Ös), 
nv¬s
++);

1104 
	`checkÃxt
(
ls
, 
TK_IN
);

1105 
lše
 = 
ls
->
lš’umb”
;

1106 
	`adju¡_assign
(
ls
, 3, 
	`ex¶i¡1
Ös, &
e
), &e);

1107 
	`luaK_check¡ack
(
fs
, 3);

1108 
	`fÜbody
(
ls
, 
ba£
, 
lše
, 
nv¬s
 - 3, 0);

1109 
	}
}

1112 
	$fÜ¡©
 (
LexS‹
 *
ls
, 
lše
) {

1114 
FuncS‹
 *
fs
 = 
ls
->fs;

1115 
TSŒšg
 *
v¬Çme
;

1116 
BlockCÁ
 
bl
;

1117 
	`’‹rblock
(
fs
, &
bl
, 1);

1118 
	`luaX_Ãxt
(
ls
);

1119 
v¬Çme
 = 
	`¡r_checkÇme
(
ls
);

1120 
ls
->
t
.
tok’
) {

1121 '=': 
	`fÜnum
(
ls
, 
v¬Çme
, 
lše
); ;

1122 ',': 
TK_IN
: 
	`fÜli¡
(
ls
, 
v¬Çme
); ;

1123 : 
	`luaX_syÁax”rÜ
(
ls
, 
	`LUA_QL
("=") " or " LUA_QL("in") "ƒxpected");

1125 
	`check_m©ch
(
ls
, 
TK_END
, 
TK_FOR
, 
lše
);

1126 
	`Ëaveblock
(
fs
);

1127 
	}
}

1130 
	$‹¡_th’_block
 (
LexS‹
 *
ls
) {

1132 
cÚdex™
;

1133 
	`luaX_Ãxt
(
ls
);

1134 
cÚdex™
 = 
	`cÚd
(
ls
);

1135 
	`checkÃxt
(
ls
, 
TK_THEN
);

1136 
	`block
(
ls
);

1137  
cÚdex™
;

1138 
	}
}

1141 
	$if¡©
 (
LexS‹
 *
ls
, 
lše
) {

1143 
FuncS‹
 *
fs
 = 
ls
->fs;

1144 
æi¡
;

1145 
esÿ³li¡
 = 
NO_JUMP
;

1146 
æi¡
 = 
	`‹¡_th’_block
(
ls
);

1147 
ls
->
t
.
tok’
 =ğ
TK_ELSEIF
) {

1148 
	`luaK_cÚÿt
(
fs
, &
esÿ³li¡
, 
	`luaK_jump
(fs));

1149 
	`luaK_·tchtoh”e
(
fs
, 
æi¡
);

1150 
æi¡
 = 
	`‹¡_th’_block
(
ls
);

1152 ià(
ls
->
t
.
tok’
 =ğ
TK_ELSE
) {

1153 
	`luaK_cÚÿt
(
fs
, &
esÿ³li¡
, 
	`luaK_jump
(fs));

1154 
	`luaK_·tchtoh”e
(
fs
, 
æi¡
);

1155 
	`luaX_Ãxt
(
ls
);

1156 
	`block
(
ls
);

1159 
	`luaK_cÚÿt
(
fs
, &
esÿ³li¡
, 
æi¡
);

1160 
	`luaK_·tchtoh”e
(
fs
, 
esÿ³li¡
);

1161 
	`check_m©ch
(
ls
, 
TK_END
, 
TK_IF
, 
lše
);

1162 
	}
}

1165 
	$loÿlfunc
 (
LexS‹
 *
ls
) {

1166 
expdesc
 
v
, 
b
;

1167 
FuncS‹
 *
fs
 = 
ls
->fs;

1168 
	`Ãw_loÿlv¬
(
ls
, 
	`¡r_checkÇme
(ls), 0);

1169 
	`š™_exp
(&
v
, 
VLOCAL
, 
fs
->
ä“»g
);

1170 
	`luaK_»£rv”egs
(
fs
, 1);

1171 
	`adju¡loÿlv¬s
(
ls
, 1);

1172 
	`body
(
ls
, &
b
, 0,†s->
lš’umb”
);

1173 
	`luaK_¡Üev¬
(
fs
, &
v
, &
b
);

1175 
	`g‘locv¬
(
fs
, fs->
Çùv¬
 - 1).
¡¬c
 = fs->
pc
;

1176 
	}
}

1179 
	$loÿl¡©
 (
LexS‹
 *
ls
) {

1181 
nv¬s
 = 0;

1182 
Ãxps
;

1183 
expdesc
 
e
;

1185 
	`Ãw_loÿlv¬
(
ls
, 
	`¡r_checkÇme
Ös), 
nv¬s
++);

1186 } 
	`‹¡Ãxt
(
ls
, ','));

1187 ià(
	`‹¡Ãxt
(
ls
, '='))

1188 
Ãxps
 = 
	`ex¶i¡1
(
ls
, &
e
);

1190 
e
.
k
 = 
VVOID
;

1191 
Ãxps
 = 0;

1193 
	`adju¡_assign
(
ls
, 
nv¬s
, 
Ãxps
, &
e
);

1194 
	`adju¡loÿlv¬s
(
ls
, 
nv¬s
);

1195 
	}
}

1198 
	$funúame
 (
LexS‹
 *
ls
, 
expdesc
 *
v
) {

1200 
Ãed£lf
 = 0;

1201 
	`sšgËv¬
(
ls
, 
v
);

1202 
ls
->
t
.
tok’
 == '.')

1203 
	`f›ld
(
ls
, 
v
);

1204 ià(
ls
->
t
.
tok’
 == ':') {

1205 
Ãed£lf
 = 1;

1206 
	`f›ld
(
ls
, 
v
);

1208  
Ãed£lf
;

1209 
	}
}

1212 
	$func¡©
 (
LexS‹
 *
ls
, 
lše
) {

1214 
Ãed£lf
;

1215 
expdesc
 
v
, 
b
;

1216 
	`luaX_Ãxt
(
ls
);

1217 
Ãed£lf
 = 
	`funúame
(
ls
, &
v
);

1218 
	`body
(
ls
, &
b
, 
Ãed£lf
, 
lše
);

1219 
	`luaK_¡Üev¬
(
ls
->
fs
, &
v
, &
b
);

1220 
	`luaK_fixlše
(
ls
->
fs
, 
lše
);

1221 
	}
}

1224 
	$ex´¡©
 (
LexS‹
 *
ls
) {

1226 
FuncS‹
 *
fs
 = 
ls
->fs;

1227 
LHS_assign
 
v
;

1228 
	`´im¬yexp
(
ls
, &
v
.v);

1229 ià(
v
.v.
k
 =ğ
VCALL
)

1230 
	`SETARG_C
(
	`g‘code
(
fs
, &
v
.v), 1);

1232 
v
.
´ev
 = 
NULL
;

1233 
	`assignm’t
(
ls
, &
v
, 1);

1235 
	}
}

1238 
	$»t¡©
 (
LexS‹
 *
ls
) {

1240 
FuncS‹
 *
fs
 = 
ls
->fs;

1241 
expdesc
 
e
;

1242 
fœ¡
, 
Ä‘
;

1243 
	`luaX_Ãxt
(
ls
);

1244 ià(
	`block_fŞlow
(
ls
->
t
.
tok’
) ||†s->t.token == ';')

1245 
fœ¡
 = 
Ä‘
 = 0;

1247 
Ä‘
 = 
	`ex¶i¡1
(
ls
, &
e
);

1248 ià(
	`hasmuÉ»t
(
e
.
k
)) {

1249 
	`luaK_£tmuÉ»t
(
fs
, &
e
);

1250 ià(
e
.
k
 =ğ
VCALL
 && 
Ä‘
 == 1) {

1251 
	`SET_OPCODE
(
	`g‘code
(
fs
,&
e
), 
OP_TAILCALL
);

1252 
	`lua_as£¹
(
	`GETARG_A
(
	`g‘code
(
fs
,&
e
)è=ğfs->
Çùv¬
);

1254 
fœ¡
 = 
fs
->
Çùv¬
;

1255 
Ä‘
 = 
LUA_MULTRET
;

1258 ià(
Ä‘
 == 1)

1259 
fœ¡
 = 
	`luaK_exp2ªy»g
(
fs
, &
e
);

1261 
	`luaK_exp2ÃxŒeg
(
fs
, &
e
);

1262 
fœ¡
 = 
fs
->
Çùv¬
;

1263 
	`lua_as£¹
(
Ä‘
 =ğ
fs
->
ä“»g
 - 
fœ¡
);

1267 
	`luaK_»t
(
fs
, 
fœ¡
, 
Ä‘
);

1268 
	}
}

1271 
	$¡©em’t
 (
LexS‹
 *
ls
) {

1272 
lše
 = 
ls
->
lš’umb”
;

1273 
ls
->
t
.
tok’
) {

1274 
TK_IF
: {

1275 
	`if¡©
(
ls
, 
lše
);

1278 
TK_WHILE
: {

1279 
	`whe¡©
(
ls
, 
lše
);

1282 
TK_DO
: {

1283 
	`luaX_Ãxt
(
ls
);

1284 
	`block
(
ls
);

1285 
	`check_m©ch
(
ls
, 
TK_END
, 
TK_DO
, 
lše
);

1288 
TK_FOR
: {

1289 
	`fÜ¡©
(
ls
, 
lše
);

1292 
TK_REPEAT
: {

1293 
	`»³©¡©
(
ls
, 
lše
);

1296 
TK_FUNCTION
: {

1297 
	`func¡©
(
ls
, 
lše
);

1300 
TK_LOCAL
: {

1301 
	`luaX_Ãxt
(
ls
);

1302 ià(
	`‹¡Ãxt
(
ls
, 
TK_FUNCTION
))

1303 
	`loÿlfunc
(
ls
);

1305 
	`loÿl¡©
(
ls
);

1308 
TK_RETURN
: {

1309 
	`»t¡©
(
ls
);

1312 
TK_BREAK
: {

1313 
	`luaX_Ãxt
(
ls
);

1314 
	`b»ak¡©
(
ls
);

1318 
	`ex´¡©
(
ls
);

1322 
	}
}

1325 
	$chunk
 (
LexS‹
 *
ls
) {

1327 
i¦a¡
 = 0;

1328 
	`’‹¾ev–
(
ls
);

1329 !
i¦a¡
 && !
	`block_fŞlow
(
ls
->
t
.
tok’
)) {

1330 
i¦a¡
 = 
	`¡©em’t
(
ls
);

1331 
	`‹¡Ãxt
(
ls
, ';');

1332 
	`lua_as£¹
(
ls
->
fs
->
f
->
max¡acksize
 >ğls->fs->
ä“»g
 &&

1333 
ls
->
fs
->
ä“»g
 >ğls->fs->
Çùv¬
);

1334 
ls
->
fs
->
ä“»g
 =†s->fs->
Çùv¬
;

1336 
	`Ëav–ev–
(
ls
);

1337 
	}
}

	@deps/lua/src/lparser.h

7 #iâdeà
Í¬£r_h


8 
	#Í¬£r_h


	)

10 
	~"Îim™s.h
"

11 
	~"lobjeù.h
"

12 
	~"lzio.h
"

20 
	mVVOID
,

21 
	mVNIL
,

22 
	mVTRUE
,

23 
	mVFALSE
,

24 
	mVK
,

25 
	mVKNUM
,

26 
	mVLOCAL
,

27 
	mVUPVAL
,

28 
	mVGLOBAL
,

29 
	mVINDEXED
,

30 
	mVJMP
,

31 
	mVRELOCABLE
,

32 
	mVNONRELOC
,

33 
	mVCALL
,

34 
	mVVARARG


35 } 
	texpkšd
;

37 
	sexpdesc
 {

38 
expkšd
 
	mk
;

40 ¡ruù { 
	mšfo
, 
	maux
; } 
	ms
;

41 
lua_Numb”
 
	mnv®
;

42 } 
	mu
;

43 
	mt
;

44 
	mf
;

45 } 
	texpdesc
;

48 
	supv®desc
 {

49 
lu_by‹
 
	mk
;

50 
lu_by‹
 
	mšfo
;

51 } 
	tupv®desc
;

54 
	gBlockCÁ
;

58 
	sFuncS‹
 {

59 
PrÙo
 *
	mf
;

60 
TabË
 *
	mh
;

61 
FuncS‹
 *
	m´ev
;

62 
LexS‹
 *
	mls
;

63 
lua_S‹
 *
	mL
;

64 
BlockCÁ
 *
	mbl
;

65 
	mpc
;

66 
	mÏ¡rg‘
;

67 
	mjpc
;

68 
	mä“»g
;

69 
	mnk
;

70 
	mÅ
;

71 
	mÆocv¬s
;

72 
lu_by‹
 
	mÇùv¬
;

73 
upv®desc
 
	mupv®ues
[
LUAI_MAXUPVALUES
];

74 
	maùv¬
[
LUAI_MAXVARS
];

75 } 
	tFuncS‹
;

78 
LUAI_FUNC
 
PrÙo
 *
luaY_·r£r
 (
lua_S‹
 *
L
, 
ZIO
 *
z
, 
Mbufãr
 *
buff
,

79 cÚ¡ *
Çme
);

	@deps/lua/src/lstate.c

8 
	~<¡ddef.h
>

10 
	#l¡©e_c


	)

11 
	#LUA_CORE


	)

13 
	~"lua.h
"

15 
	~"ldebug.h
"

16 
	~"ldo.h
"

17 
	~"lfunc.h
"

18 
	~"lgc.h
"

19 
	~"Îex.h
"

20 
	~"lmem.h
"

21 
	~"l¡©e.h
"

22 
	~"l¡ršg.h
"

23 
	~"ÉabË.h
"

24 
	~"Ém.h
"

27 
	#¡©e_size
(
x
è((xè+ 
LUAI_EXTRASPACE
)

	)

28 
	#äom¡©e
(
l
è(
	`ÿ¡
(
lu_by‹
 *, (l)è- 
LUAI_EXTRASPACE
)

	)

29 
	#to¡©e
(
l
è(
	`ÿ¡
(
lua_S‹
 *, ca¡(
lu_by‹
 *,†è+ 
LUAI_EXTRASPACE
))

	)

35 
	sLG
 {

36 
lua_S‹
 
	ml
;

37 
glob®_S‹
 
	mg
;

38 } 
	tLG
;

42 
	$¡ack_š™
 (
lua_S‹
 *
L1
,†ua_S‹ *
L
) {

44 
L1
->
ba£_ci
 = 
	`luaM_ÃwveùÜ
(
L
, 
BASIC_CI_SIZE
, 
C®lInfo
);

45 
L1
->
ci
 = L1->
ba£_ci
;

46 
L1
->
size_ci
 = 
BASIC_CI_SIZE
;

47 
L1
->
’d_ci
 = L1->
ba£_ci
 + L1->
size_ci
 - 1;

49 
L1
->
¡ack
 = 
	`luaM_ÃwveùÜ
(
L
, 
BASIC_STACK_SIZE
 + 
EXTRA_STACK
, 
TV®ue
);

50 
L1
->
¡acksize
 = 
BASIC_STACK_SIZE
 + 
EXTRA_STACK
;

51 
L1
->
tİ
 = L1->
¡ack
;

52 
L1
->
¡ack_Ï¡
 = L1->
¡ack
+(L1->
¡acksize
 - 
EXTRA_STACK
)-1;

54 
L1
->
ci
->
func
 = L1->
tİ
;

55 
	`£Šv®ue
(
L1
->
tİ
++);

56 
L1
->
ba£
 = L1->
ci
->ba£ = L1->
tİ
;

57 
L1
->
ci
->
tİ
 = L1->tİ + 
LUA_MINSTACK
;

58 
	}
}

61 
	$ä“¡ack
 (
lua_S‹
 *
L
,†ua_S‹ *
L1
) {

62 
	`luaM_ä“¬¿y
(
L
, 
L1
->
ba£_ci
, L1->
size_ci
, 
C®lInfo
);

63 
	`luaM_ä“¬¿y
(
L
, 
L1
->
¡ack
, L1->
¡acksize
, 
TV®ue
);

64 
	}
}

70 
	$f_luaİ’
 (
lua_S‹
 *
L
, *
ud
) {

71 
glob®_S‹
 *
g
 = 
	`G
(
L
);

72 
	`UNUSED
(
ud
);

73 
	`¡ack_š™
(
L
, L);

74 
	`£thv®ue
(
L
, 
	`gt
(L), 
	`luaH_Ãw
(L, 0, 2));

75 
	`£thv®ue
(
L
, 
	`»gi¡ry
(L), 
	`luaH_Ãw
(L, 0, 2));

76 
	`luaS_»size
(
L
, 
MINSTRTABSIZE
);

77 
	`luaT_š™
(
L
);

78 
	`luaX_š™
(
L
);

79 
	`luaS_fix
(
	`luaS_Ãwl™”®
(
L
, 
MEMERRMSG
));

80 
g
->
GCth»shŞd
 = 4*g->
tÙ®by‹s
;

81 
	}
}

84 
	$´eš™_¡©e
 (
lua_S‹
 *
L
, 
glob®_S‹
 *
g
) {

85 
	`G
(
L
èğ
g
;

86 
L
->
¡ack
 = 
NULL
;

87 
L
->
¡acksize
 = 0;

88 
L
->
”rÜJmp
 = 
NULL
;

89 
L
->
hook
 = 
NULL
;

90 
L
->
hookmask
 = 0;

91 
L
->
ba£hookcouÁ
 = 0;

92 
L
->
®lowhook
 = 1;

93 
	`»£thookcouÁ
(
L
);

94 
L
->
İ’upv®
 = 
NULL
;

95 
L
->
size_ci
 = 0;

96 
L
->
nCÿÎs
 = L->
ba£CÿÎs
 = 0;

97 
L
->
¡©us
 = 0;

98 
L
->
ba£_ci
 = L->
ci
 = 
NULL
;

99 
L
->
§vedpc
 = 
NULL
;

100 
L
->
”rfunc
 = 0;

101 
	`£Šv®ue
(
	`gt
(
L
));

102 
	}
}

105 
	$şo£_¡©e
 (
lua_S‹
 *
L
) {

106 
glob®_S‹
 *
g
 = 
	`G
(
L
);

107 
	`luaF_şo£
(
L
, L->
¡ack
);

108 
	`luaC_ä“®l
(
L
);

109 
	`lua_as£¹
(
g
->
roÙgc
 =ğ
	`obj2gco
(
L
));

110 
	`lua_as£¹
(
g
->
¡¹
.
nu£
 == 0);

111 
	`luaM_ä“¬¿y
(
L
, 
	`G
(L)->
¡¹
.
hash
, G(L)->¡¹.
size
, 
TSŒšg
 *);

112 
	`luaZ_ä“bufãr
(
L
, &
g
->
buff
);

113 
	`ä“¡ack
(
L
, L);

114 
	`lua_as£¹
(
g
->
tÙ®by‹s
 =ğ(
LG
));

115 (*
g
->
ä—Îoc
)(g->
ud
, 
	`äom¡©e
(
L
), 
	`¡©e_size
(
LG
), 0);

116 
	}
}

119 
lua_S‹
 *
	$luaE_Ãwth»ad
 (
lua_S‹
 *
L
) {

120 
lua_S‹
 *
L1
 = 
	`to¡©e
(
	`luaM_m®loc
(
L
, 
	`¡©e_size
(lua_State)));

121 
	`luaC_lšk
(
L
, 
	`obj2gco
(
L1
), 
LUA_TTHREAD
);

122 
	`´eš™_¡©e
(
L1
, 
	`G
(
L
));

123 
	`¡ack_š™
(
L1
, 
L
);

124 
	`£tobj2n
(
L
, 
	`gt
(
L1
), gt(L));

125 
L1
->
hookmask
 = 
L
->hookmask;

126 
L1
->
ba£hookcouÁ
 = 
L
->basehookcount;

127 
L1
->
hook
 = 
L
->hook;

128 
	`»£thookcouÁ
(
L1
);

129 
	`lua_as£¹
(
	`iswh™e
(
	`obj2gco
(
L1
)));

130  
L1
;

131 
	}
}

134 
	$luaE_ä“th»ad
 (
lua_S‹
 *
L
,†ua_S‹ *
L1
) {

135 
	`luaF_şo£
(
L1
, L1->
¡ack
);

136 
	`lua_as£¹
(
L1
->
İ’upv®
 =ğ
NULL
);

137 
	`luai_u£r¡©eä“
(
L1
);

138 
	`ä“¡ack
(
L
, 
L1
);

139 
	`luaM_ä“mem
(
L
, 
	`äom¡©e
(
L1
), 
	`¡©e_size
(
lua_S‹
));

140 
	}
}

143 
LUA_API
 
lua_S‹
 *
	$lua_Ãw¡©e
 (
lua_AÎoc
 
f
, *
ud
) {

144 
i
;

145 
lua_S‹
 *
L
;

146 
glob®_S‹
 *
g
;

147 *
l
 = (*
f
)(
ud
, 
NULL
, 0, 
	`¡©e_size
(
LG
));

148 ià(
l
 =ğ
NULL
)  NULL;

149 
L
 = 
	`to¡©e
(
l
);

150 
g
 = &((
LG
 *)
L
)->g;

151 
L
->
Ãxt
 = 
NULL
;

152 
L
->
‰
 = 
LUA_TTHREAD
;

153 
g
->
cu¼’twh™e
 = 
	`b™2mask
(
WHITE0BIT
, 
FIXEDBIT
);

154 
L
->
m¬ked
 = 
	`luaC_wh™e
(
g
);

155 
	`£t2b™s
(
L
->
m¬ked
, 
FIXEDBIT
, 
SFIXEDBIT
);

156 
	`´eš™_¡©e
(
L
, 
g
);

157 
g
->
ä—Îoc
 = 
f
;

158 
g
->
ud
 = ud;

159 
g
->
mašth»ad
 = 
L
;

160 
g
->
uvh—d
.
u
.
l
.
´ev
 = &g->uvhead;

161 
g
->
uvh—d
.
u
.
l
.
Ãxt
 = &g->uvhead;

162 
g
->
GCth»shŞd
 = 0;

163 
g
->
¡¹
.
size
 = 0;

164 
g
->
¡¹
.
nu£
 = 0;

165 
g
->
¡¹
.
hash
 = 
NULL
;

166 
	`£Šv®ue
(
	`»gi¡ry
(
L
));

167 
	`luaZ_š™bufãr
(
L
, &
g
->
buff
);

168 
g
->
·nic
 = 
NULL
;

169 
g
->
gc¡©e
 = 
GCS·u£
;

170 
g
->
roÙgc
 = 
	`obj2gco
(
L
);

171 
g
->
sw“p¡rgc
 = 0;

172 
g
->
sw“pgc
 = &g->
roÙgc
;

173 
g
->
g¿y
 = 
NULL
;

174 
g
->
g¿yagaš
 = 
NULL
;

175 
g
->
w—k
 = 
NULL
;

176 
g
->
tmud©a
 = 
NULL
;

177 
g
->
tÙ®by‹s
 = (
LG
);

178 
g
->
gıau£
 = 
LUAI_GCPAUSE
;

179 
g
->
gc¡•mul
 = 
LUAI_GCMUL
;

180 
g
->
gcd•t
 = 0;

181 
i
=0; i<
NUM_TAGS
; i++è
g
->
mt
[i] = 
NULL
;

182 ià(
	`luaD_¿wruÅrÙeùed
(
L
, 
f_luaİ’
, 
NULL
) != 0) {

184 
	`şo£_¡©e
(
L
);

185 
L
 = 
NULL
;

188 
	`luai_u£r¡©eİ’
(
L
);

189  
L
;

190 
	}
}

193 
	$ÿÎ®lgcTM
 (
lua_S‹
 *
L
, *
ud
) {

194 
	`UNUSED
(
ud
);

195 
	`luaC_ÿÎGCTM
(
L
);

196 
	}
}

199 
LUA_API
 
	$lua_şo£
 (
lua_S‹
 *
L
) {

200 
L
 = 
	`G
(L)->
mašth»ad
;

201 
	`lua_lock
(
L
);

202 
	`luaF_şo£
(
L
, L->
¡ack
);

203 
	`luaC_£·¿‹ud©a
(
L
, 1);

204 
L
->
”rfunc
 = 0;

206 
L
->
ci
 = L->
ba£_ci
;

207 
L
->
ba£
 = L->
tİ
 = L->
ci
->base;

208 
L
->
nCÿÎs
 = L->
ba£CÿÎs
 = 0;

209 } 
	`luaD_¿wruÅrÙeùed
(
L
, 
ÿÎ®lgcTM
, 
NULL
) != 0);

210 
	`lua_as£¹
(
	`G
(
L
)->
tmud©a
 =ğ
NULL
);

211 
	`luai_u£r¡©eşo£
(
L
);

212 
	`şo£_¡©e
(
L
);

213 
	}
}

	@deps/lua/src/lstate.h

7 #iâdeà
l¡©e_h


8 
	#l¡©e_h


	)

10 
	~"lua.h
"

12 
	~"lobjeù.h
"

13 
	~"Ém.h
"

14 
	~"lzio.h
"

18 
	glua_lÚgjmp
;

22 
	#gt
(
L
è(&L->
l_gt
)

	)

25 
	#»gi¡ry
(
L
è(&
	`G
(L)->
l_»gi¡ry
)

	)

29 
	#EXTRA_STACK
 5

	)

32 
	#BASIC_CI_SIZE
 8

	)

34 
	#BASIC_STACK_SIZE
 (2*
LUA_MINSTACK
)

	)

38 
	s¡ršgbË
 {

39 
GCObjeù
 **
	mhash
;

40 
lu_št32
 
	mnu£
;

41 
	msize
;

42 } 
	t¡ršgbË
;

48 
	sC®lInfo
 {

49 
StkId
 
	mba£
;

50 
StkId
 
	mfunc
;

51 
StkId
 
	mtİ
;

52 cÚ¡ 
In¡ruùiÚ
 *
	m§vedpc
;

53 
	mÄesuÉs
;

54 
	mÿÎs
;

55 } 
	tC®lInfo
;

59 
	#cu¼_func
(
L
è(
	`şv®ue
(L->
ci
->
func
))

	)

60 
	#ci_func
(
ci
è(
	`şv®ue
((ci)->
func
))

	)

61 
	#f_isLua
(
ci
è(!
	`ci_func
(ci)->
c
.
isC
)

	)

62 
	#isLua
(
ci
è(
	`‰isfunùiÚ
((ci)->
func
è&& 
	`f_isLua
(ci))

	)

68 
	sglob®_S‹
 {

69 
¡ršgbË
 
	m¡¹
;

70 
lua_AÎoc
 
	mä—Îoc
;

71 *
	mud
;

72 
lu_by‹
 
	mcu¼’twh™e
;

73 
lu_by‹
 
	mgc¡©e
;

74 
	msw“p¡rgc
;

75 
GCObjeù
 *
	mroÙgc
;

76 
GCObjeù
 **
	msw“pgc
;

77 
GCObjeù
 *
	mg¿y
;

78 
GCObjeù
 *
	mg¿yagaš
;

79 
GCObjeù
 *
	mw—k
;

80 
GCObjeù
 *
	mtmud©a
;

81 
Mbufãr
 
	mbuff
;

82 
lu_mem
 
	mGCth»shŞd
;

83 
lu_mem
 
	mtÙ®by‹s
;

84 
lu_mem
 
	me¡im©e
;

85 
lu_mem
 
	mgcd•t
;

86 
	mgıau£
;

87 
	mgc¡•mul
;

88 
lua_CFunùiÚ
 
	m·nic
;

89 
TV®ue
 
	ml_»gi¡ry
;

90 
lua_S‹
 *
	mmašth»ad
;

91 
UpV®
 
	muvh—d
;

92 
TabË
 *
	mmt
[
NUM_TAGS
];

93 
TSŒšg
 *
	mtmÇme
[
TM_N
];

94 } 
	tglob®_S‹
;

100 
	slua_S‹
 {

101 
	mCommÚH—d”
;

102 
lu_by‹
 
	m¡©us
;

103 
StkId
 
	mtİ
;

104 
StkId
 
	mba£
;

105 
glob®_S‹
 *
	ml_G
;

106 
C®lInfo
 *
	mci
;

107 cÚ¡ 
In¡ruùiÚ
 *
	m§vedpc
;

108 
StkId
 
	m¡ack_Ï¡
;

109 
StkId
 
	m¡ack
;

110 
C®lInfo
 *
	m’d_ci
;

111 
C®lInfo
 *
	mba£_ci
;

112 
	m¡acksize
;

113 
	msize_ci
;

114 
	mnCÿÎs
;

115 
	mba£CÿÎs
;

116 
lu_by‹
 
	mhookmask
;

117 
lu_by‹
 
	m®lowhook
;

118 
	mba£hookcouÁ
;

119 
	mhookcouÁ
;

120 
lua_Hook
 
	mhook
;

121 
TV®ue
 
	ml_gt
;

122 
TV®ue
 
	m’v
;

123 
GCObjeù
 *
	mİ’upv®
;

124 
GCObjeù
 *
	mgşi¡
;

125 
lua_lÚgjmp
 *
	m”rÜJmp
;

126 
±rdiff_t
 
	m”rfunc
;

130 
	#G
(
L
è(L->
l_G
)

	)

136 
	uGCObjeù
 {

137 
GCh—d”
 
	mgch
;

138 
TSŒšg
 
	mts
;

139 
Ud©a
 
	mu
;

140 
Closu»
 
	mş
;

141 
TabË
 
	mh
;

142 
PrÙo
 
	mp
;

143 
UpV®
 
	muv
;

144 
lua_S‹
 
	mth
;

149 
	#¿wgco2ts
(
o
è
	`check_exp
((o)->
gch
.
‰
 =ğ
LUA_TSTRING
, &((o)->
ts
))

	)

150 
	#gco2ts
(
o
è(&
	`¿wgco2ts
(o)->
tsv
)

	)

151 
	#¿wgco2u
(
o
è
	`check_exp
((o)->
gch
.
‰
 =ğ
LUA_TUSERDATA
, &((o)->
u
))

	)

152 
	#gco2u
(
o
è(&
	`¿wgco2u
(o)->
uv
)

	)

153 
	#gco2ş
(
o
è
	`check_exp
((o)->
gch
.
‰
 =ğ
LUA_TFUNCTION
, &((o)->
ş
))

	)

154 
	#gco2h
(
o
è
	`check_exp
((o)->
gch
.
‰
 =ğ
LUA_TTABLE
, &((o)->
h
))

	)

155 
	#gco2p
(
o
è
	`check_exp
((o)->
gch
.
‰
 =ğ
LUA_TPROTO
, &((o)->
p
))

	)

156 
	#gco2uv
(
o
è
	`check_exp
((o)->
gch
.
‰
 =ğ
LUA_TUPVAL
, &((o)->
uv
))

	)

157 
	#ngcÙouv
(
o
) \

158 
	`check_exp
((
o
è=ğ
NULL
 || (o)->
gch
.
‰
 =ğ
LUA_TUPVAL
, &((o)->
uv
))

	)

159 
	#gco2th
(
o
è
	`check_exp
((o)->
gch
.
‰
 =ğ
LUA_TTHREAD
, &((o)->
th
))

	)

162 
	#obj2gco
(
v
è(
	`ÿ¡
(
GCObjeù
 *, (v)))

	)

165 
LUAI_FUNC
 
lua_S‹
 *
luaE_Ãwth»ad
 (lua_S‹ *
L
);

166 
LUAI_FUNC
 
luaE_ä“th»ad
 (
lua_S‹
 *
L
,†ua_S‹ *
L1
);

	@deps/lua/src/lstring.c

8 
	~<¡ršg.h
>

10 
	#l¡ršg_c


	)

11 
	#LUA_CORE


	)

13 
	~"lua.h
"

15 
	~"lmem.h
"

16 
	~"lobjeù.h
"

17 
	~"l¡©e.h
"

18 
	~"l¡ršg.h
"

22 
	$luaS_»size
 (
lua_S‹
 *
L
, 
Ãwsize
) {

23 
GCObjeù
 **
Ãwhash
;

24 
¡ršgbË
 *
tb
;

25 
i
;

26 ià(
	`G
(
L
)->
gc¡©e
 =ğ
GCSsw“p¡ršg
)

28 
Ãwhash
 = 
	`luaM_ÃwveùÜ
(
L
, 
Ãwsize
, 
GCObjeù
 *);

29 
tb
 = &
	`G
(
L
)->
¡¹
;

30 
i
=0; i<
Ãwsize
; i++è
Ãwhash
[i] = 
NULL
;

32 
i
=0; i<
tb
->
size
; i++) {

33 
GCObjeù
 *
p
 = 
tb
->
hash
[
i
];

34 
p
) {

35 
GCObjeù
 *
Ãxt
 = 
p
->
gch
.next;

36 
h
 = 
	`gco2ts
(
p
)->
hash
;

37 
h1
 = 
	`lmod
(
h
, 
Ãwsize
);

38 
	`lua_as£¹
(
	`ÿ¡_št
(
h
%
Ãwsize
è=ğ
	`lmod
(h,‚ewsize));

39 
p
->
gch
.
Ãxt
 = 
Ãwhash
[
h1
];

40 
Ãwhash
[
h1
] = 
p
;

41 
p
 = 
Ãxt
;

44 
	`luaM_ä“¬¿y
(
L
, 
tb
->
hash
,b->
size
, 
TSŒšg
 *);

45 
tb
->
size
 = 
Ãwsize
;

46 
tb
->
hash
 = 
Ãwhash
;

47 
	}
}

50 
TSŒšg
 *
	$Ãwl¡r
 (
lua_S‹
 *
L
, cÚ¡ *
¡r
, 
size_t
 
l
,

51 
h
) {

52 
TSŒšg
 *
ts
;

53 
¡ršgbË
 *
tb
;

54 ià(
l
+1 > (
MAX_SIZET
 - (
TSŒšg
))/())

55 
	`luaM_toobig
(
L
);

56 
ts
 = 
	`ÿ¡
(
TSŒšg
 *, 
	`luaM_m®loc
(
L
, (
l
+1)*()+(TString)));

57 
ts
->
tsv
.
Ën
 = 
l
;

58 
ts
->
tsv
.
hash
 = 
h
;

59 
ts
->
tsv
.
m¬ked
 = 
	`luaC_wh™e
(
	`G
(
L
));

60 
ts
->
tsv
.
‰
 = 
LUA_TSTRING
;

61 
ts
->
tsv
.
»£rved
 = 0;

62 
	`memıy
(
ts
+1, 
¡r
, 
l
*());

63 ((*)(
ts
+1))[
l
] = '\0';

64 
tb
 = &
	`G
(
L
)->
¡¹
;

65 
h
 = 
	`lmod
(h, 
tb
->
size
);

66 
ts
->
tsv
.
Ãxt
 = 
tb
->
hash
[
h
];

67 
tb
->
hash
[
h
] = 
	`obj2gco
(
ts
);

68 
tb
->
nu£
++;

69 ià(
tb
->
nu£
 > 
	`ÿ¡
(
lu_št32
,b->
size
è&&b->siz<ğ
MAX_INT
/2)

70 
	`luaS_»size
(
L
, 
tb
->
size
*2);

71  
ts
;

72 
	}
}

75 
TSŒšg
 *
	$luaS_Ãwl¡r
 (
lua_S‹
 *
L
, cÚ¡ *
¡r
, 
size_t
 
l
) {

76 
GCObjeù
 *
o
;

77 
h
 = 
	`ÿ¡
(, 
l
);

78 
size_t
 
¡•
 = (
l
>>5)+1;

79 
size_t
 
l1
;

80 
l1
=
l
;†1>=
¡•
;†1-=step)

81 
h
 = h ^ ((h<<5)+(h>>2)+
	`ÿ¡
(, 
¡r
[
l1
-1]));

82 
o
 = 
	`G
(
L
)->
¡¹
.
hash
[
	`lmod
(
h
, G(L)->¡¹.
size
)];

83 
o
 !ğ
NULL
;

84 
o
 = o->
gch
.
Ãxt
) {

85 
TSŒšg
 *
ts
 = 
	`¿wgco2ts
(
o
);

86 ià(
ts
->
tsv
.
Ën
 =ğ
l
 && (
	`memcmp
(
¡r
, 
	`g‘¡r
(ts),†) == 0)) {

88 ià(
	`isd—d
(
	`G
(
L
), 
o
)è
	`chªgewh™e
(o);

89  
ts
;

92  
	`Ãwl¡r
(
L
, 
¡r
, 
l
, 
h
);

93 
	}
}

96 
Ud©a
 *
	$luaS_Ãwud©a
 (
lua_S‹
 *
L
, 
size_t
 
s
, 
TabË
 *
e
) {

97 
Ud©a
 *
u
;

98 ià(
s
 > 
MAX_SIZET
 - (
Ud©a
))

99 
	`luaM_toobig
(
L
);

100 
u
 = 
	`ÿ¡
(
Ud©a
 *, 
	`luaM_m®loc
(
L
, 
s
 + (Udata)));

101 
u
->
uv
.
m¬ked
 = 
	`luaC_wh™e
(
	`G
(
L
));

102 
u
->
uv
.
‰
 = 
LUA_TUSERDATA
;

103 
u
->
uv
.
Ën
 = 
s
;

104 
u
->
uv
.
m‘©abË
 = 
NULL
;

105 
u
->
uv
.
’v
 = 
e
;

107 
u
->
uv
.
Ãxt
 = 
	`G
(
L
)->
mašth»ad
->next;

108 
	`G
(
L
)->
mašth»ad
->
Ãxt
 = 
	`obj2gco
(
u
);

109  
u
;

110 
	}
}

	@deps/lua/src/lstring.h

7 #iâdeà
l¡ršg_h


8 
	#l¡ršg_h


	)

11 
	~"lgc.h
"

12 
	~"lobjeù.h
"

13 
	~"l¡©e.h
"

16 
	#size¡ršg
(
s
è((
TSŒšg
)+((s)->
Ën
+1)*())

	)

18 
	#sizeud©a
(
u
è((
Ud©a
)+(u)->
Ën
)

	)

20 
	#luaS_Ãw
(
L
, 
s
è(
	`luaS_Ãwl¡r
(L, s, 
	`¡¾’
(s)))

	)

21 
	#luaS_Ãwl™”®
(
L
, 
s
è(
	`luaS_Ãwl¡r
(L, "" s, \

22 ((
s
)/())-1))

	)

24 
	#luaS_fix
(
s
è
	`l_£tb™
((s)->
tsv
.
m¬ked
, 
FIXEDBIT
)

	)

26 
LUAI_FUNC
 
luaS_»size
 (
lua_S‹
 *
L
, 
Ãwsize
);

27 
LUAI_FUNC
 
Ud©a
 *
luaS_Ãwud©a
 (
lua_S‹
 *
L
, 
size_t
 
s
, 
TabË
 *
e
);

28 
LUAI_FUNC
 
TSŒšg
 *
luaS_Ãwl¡r
 (
lua_S‹
 *
L
, cÚ¡ *
¡r
, 
size_t
 
l
);

	@deps/lua/src/lstrlib.c

8 
	~<ùy³.h
>

9 
	~<¡ddef.h
>

10 
	~<¡dio.h
>

11 
	~<¡dlib.h
>

12 
	~<¡ršg.h
>

14 
	#l¡¾ib_c


	)

15 
	#LUA_LIB


	)

17 
	~"lua.h
"

19 
	~"Ïuxlib.h
"

20 
	~"lu®ib.h
"

24 
	#uch¬
(
c
è(()(c))

	)

28 
	$¡r_Ën
 (
lua_S‹
 *
L
) {

29 
size_t
 
l
;

30 
	`luaL_checkl¡ršg
(
L
, 1, &
l
);

31 
	`lua_pushš‹g”
(
L
, 
l
);

33 
	}
}

36 
±rdiff_t
 
	$po¤–©
 (
±rdiff_t
 
pos
, 
size_t
 
Ën
) {

38 ià(
pos
 < 0èpo +ğ(
±rdiff_t
)
Ën
 + 1;

39  (
pos
 >= 0) ?…os : 0;

40 
	}
}

43 
	$¡r_sub
 (
lua_S‹
 *
L
) {

44 
size_t
 
l
;

45 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 1, &
l
);

46 
±rdiff_t
 
¡¬t
 = 
	`po¤–©
(
	`luaL_checkš‹g”
(
L
, 2), 
l
);

47 
±rdiff_t
 
’d
 = 
	`po¤–©
(
	`luaL_İtš‹g”
(
L
, 3, -1), 
l
);

48 ià(
¡¬t
 < 1) start = 1;

49 ià(
’d
 > (
±rdiff_t
)
l
)ƒnd = (ptrdiff_t)l;

50 ià(
¡¬t
 <ğ
’d
)

51 
	`lua_pushl¡ršg
(
L
, 
s
+
¡¬t
-1, 
’d
-start+1);

52 
	`lua_pushl™”®
(
L
, "");

54 
	}
}

57 
	$¡r_»v”£
 (
lua_S‹
 *
L
) {

58 
size_t
 
l
;

59 
luaL_Bufãr
 
b
;

60 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 1, &
l
);

61 
	`luaL_buffš™
(
L
, &
b
);

62 
l
--è
	`luaL_addch¬
(&
b
, 
s
[l]);

63 
	`luaL_push»suÉ
(&
b
);

65 
	}
}

68 
	$¡r_low”
 (
lua_S‹
 *
L
) {

69 
size_t
 
l
;

70 
size_t
 
i
;

71 
luaL_Bufãr
 
b
;

72 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 1, &
l
);

73 
	`luaL_buffš™
(
L
, &
b
);

74 
i
=0; i<
l
; i++)

75 
	`luaL_addch¬
(&
b
, 
	`tŞow”
(
	`uch¬
(
s
[
i
])));

76 
	`luaL_push»suÉ
(&
b
);

78 
	}
}

81 
	$¡r_uµ”
 (
lua_S‹
 *
L
) {

82 
size_t
 
l
;

83 
size_t
 
i
;

84 
luaL_Bufãr
 
b
;

85 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 1, &
l
);

86 
	`luaL_buffš™
(
L
, &
b
);

87 
i
=0; i<
l
; i++)

88 
	`luaL_addch¬
(&
b
, 
	`touµ”
(
	`uch¬
(
s
[
i
])));

89 
	`luaL_push»suÉ
(&
b
);

91 
	}
}

93 
	$¡r_»p
 (
lua_S‹
 *
L
) {

94 
size_t
 
l
;

95 
luaL_Bufãr
 
b
;

96 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 1, &
l
);

97 
n
 = 
	`luaL_checkšt
(
L
, 2);

98 
	`luaL_buffš™
(
L
, &
b
);

99 
n
-- > 0)

100 
	`luaL_addl¡ršg
(&
b
, 
s
, 
l
);

101 
	`luaL_push»suÉ
(&
b
);

103 
	}
}

106 
	$¡r_by‹
 (
lua_S‹
 *
L
) {

107 
size_t
 
l
;

108 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 1, &
l
);

109 
±rdiff_t
 
posi
 = 
	`po¤–©
(
	`luaL_İtš‹g”
(
L
, 2, 1), 
l
);

110 
±rdiff_t
 
po£
 = 
	`po¤–©
(
	`luaL_İtš‹g”
(
L
, 3, 
posi
), 
l
);

111 
n
, 
i
;

112 ià(
posi
 <= 0)…osi = 1;

113 ià((
size_t
)
po£
 > 
l
)…ose =†;

114 ià(
posi
 > 
po£
)  0;

115 
n
 = ()(
po£
 - 
posi
 + 1);

116 ià(
posi
 + 
n
 <ğ
po£
)

117 
	`luaL_”rÜ
(
L
, "string sliceoo†ong");

118 
	`luaL_check¡ack
(
L
, 
n
, "string sliceoo†ong");

119 
i
=0; i<
n
; i++)

120 
	`lua_pushš‹g”
(
L
, 
	`uch¬
(
s
[
posi
+
i
-1]));

121  
n
;

122 
	}
}

125 
	$¡r_ch¬
 (
lua_S‹
 *
L
) {

126 
n
 = 
	`lua_g‘tİ
(
L
);

127 
i
;

128 
luaL_Bufãr
 
b
;

129 
	`luaL_buffš™
(
L
, &
b
);

130 
i
=1; i<=
n
; i++) {

131 
c
 = 
	`luaL_checkšt
(
L
, 
i
);

132 
	`luaL_¬gcheck
(
L
, 
	`uch¬
(
c
è=ğc, 
i
, "invalid value");

133 
	`luaL_addch¬
(&
b
, 
	`uch¬
(
c
));

135 
	`luaL_push»suÉ
(&
b
);

137 
	}
}

140 
	$wr™”
 (
lua_S‹
 *
L
, cÚ¡ * 
b
, 
size_t
 
size
, * 
B
) {

141 ()
L
;

142 
	`luaL_addl¡ršg
((
luaL_Bufãr
*è
B
, (cÚ¡ *)
b
, 
size
);

144 
	}
}

147 
	$¡r_dump
 (
lua_S‹
 *
L
) {

148 
luaL_Bufãr
 
b
;

149 
	`luaL_checkty³
(
L
, 1, 
LUA_TFUNCTION
);

150 
	`lua_£‰İ
(
L
, 1);

151 
	`luaL_buffš™
(
L
,&
b
);

152 ià(
	`lua_dump
(
L
, 
wr™”
, &
b
) != 0)

153 
	`luaL_”rÜ
(
L
, "unableo dump given function");

154 
	`luaL_push»suÉ
(&
b
);

156 
	}
}

167 
	#CAP_UNFINISHED
 (-1)

	)

168 
	#CAP_POSITION
 (-2)

	)

170 
	sM©chS‹
 {

171 cÚ¡ *
	m¤c_š™
;

172 cÚ¡ *
	m¤c_’d
;

173 
lua_S‹
 *
	mL
;

174 
	mËv–
;

176 cÚ¡ *
	mš™
;

177 
±rdiff_t
 
	mËn
;

178 } 
	mÿ±u»
[
LUA_MAXCAPTURES
];

179 } 
	tM©chS‹
;

182 
	#L_ESC
 '%'

	)

183 
	#SPECIALS
 "^$*+?.([%-"

	)

186 
	$check_ÿ±u»
 (
M©chS‹
 *
ms
, 
l
) {

187 
l
 -= '1';

188 ià(
l
 < 0 ||† >ğ
ms
->
Ëv–
 || ms->
ÿ±u»
[l].
Ën
 =ğ
CAP_UNFINISHED
)

189  
	`luaL_”rÜ
(
ms
->
L
, "invalid capture index");

190  
l
;

191 
	}
}

194 
	$ÿ±u»_to_şo£
 (
M©chS‹
 *
ms
) {

195 
Ëv–
 = 
ms
->level;

196 
Ëv–
--;†evel>=0;†evel--)

197 ià(
ms
->
ÿ±u»
[
Ëv–
].
Ën
 =ğ
CAP_UNFINISHED
) †evel;

198  
	`luaL_”rÜ
(
ms
->
L
, "invalid…attern capture");

199 
	}
}

202 cÚ¡ *
	$şas£nd
 (
M©chS‹
 *
ms
, cÚ¡ *
p
) {

203 *
p
++) {

204 
L_ESC
: {

205 ià(*
p
 == '\0')

206 
	`luaL_”rÜ
(
ms
->
L
, "m®fÜmed…©‹º (’d w™h " 
	`LUA_QL
("%%") ")");

207  
p
+1;

210 ià(*
p
 == '^')…++;

212 ià(*
p
 == '\0')

213 
	`luaL_”rÜ
(
ms
->
L
, "m®fÜmed…©‹º (missšg " 
	`LUA_QL
("]") ")");

214 ià(*(
p
++è=ğ
L_ESC
 && *p != '\0')

215 
p
++;

216 } *
p
 != ']');

217  
p
+1;

220  
p
;

223 
	}
}

226 
	$m©ch_şass
 (
c
, 
ş
) {

227 
»s
;

228 
	`tŞow”
(
ş
)) {

229 'a' : 
»s
 = 
	`i§Íha
(
c
); ;

230 'c' : 
»s
 = 
	`isúŒl
(
c
); ;

231 'd' : 
»s
 = 
	`isdig™
(
c
); ;

232 'l' : 
»s
 = 
	`i¦ow”
(
c
); ;

233 'p' : 
»s
 = 
	`i¥unù
(
c
); ;

234 's' : 
»s
 = 
	`is¥aû
(
c
); ;

235 'u' : 
»s
 = 
	`isuµ”
(
c
); ;

236 'w' : 
»s
 = 
	`i§Êum
(
c
); ;

237 'x' : 
»s
 = 
	`isxdig™
(
c
); ;

238 'z' : 
»s
 = (
c
 == 0); ;

239 :  (
ş
 =ğ
c
);

241  (
	`i¦ow”
(
ş
è? 
»s
 : !res);

242 
	}
}

245 
	$m©chb¿ck‘şass
 (
c
, cÚ¡ *
p
, cÚ¡ *
ec
) {

246 
sig
 = 1;

247 ià(*(
p
+1) == '^') {

248 
sig
 = 0;

249 
p
++;

251 ++
p
 < 
ec
) {

252 ià(*
p
 =ğ
L_ESC
) {

253 
p
++;

254 ià(
	`m©ch_şass
(
c
, 
	`uch¬
(*
p
)))

255  
sig
;

257 ià((*(
p
+1è=ğ'-'è&& (p+2 < 
ec
)) {

258 
p
+=2;

259 ià(
	`uch¬
(*(
p
-2)è<ğ
c
 && c <= uchar(*p))

260  
sig
;

262 ià(
	`uch¬
(*
p
è=ğ
c
è 
sig
;

264  !
sig
;

265 
	}
}

268 
	$sšgËm©ch
 (
c
, cÚ¡ *
p
, cÚ¡ *
•
) {

269 *
p
) {

271 
L_ESC
:  
	`m©ch_şass
(
c
, 
	`uch¬
(*(
p
+1)));

272 '[':  
	`m©chb¿ck‘şass
(
c
, 
p
, 
•
-1);

273 :  (
	`uch¬
(*
p
è=ğ
c
);

275 
	}
}

278 cÚ¡ *
m©ch
 (
M©chS‹
 *
ms
, cÚ¡ *
s
, cÚ¡ *
p
);

281 cÚ¡ *
	$m©chb®ªû
 (
M©chS‹
 *
ms
, cÚ¡ *
s
,

282 cÚ¡ *
p
) {

283 ià(*
p
 == 0 || *(p+1) == 0)

284 
	`luaL_”rÜ
(
ms
->
L
, "unbalanced…attern");

285 ià(*
s
 !ğ*
p
è 
NULL
;

287 
b
 = *
p
;

288 
e
 = *(
p
+1);

289 
cÚt
 = 1;

290 ++
s
 < 
ms
->
¤c_’d
) {

291 ià(*
s
 =ğ
e
) {

292 ià(--
cÚt
 =ğ0è 
s
+1;

294 ià(*
s
 =ğ
b
è
cÚt
++;

297  
NULL
;

298 
	}
}

301 cÚ¡ *
	$max_ex·nd
 (
M©chS‹
 *
ms
, cÚ¡ *
s
,

302 cÚ¡ *
p
, cÚ¡ *
•
) {

303 
±rdiff_t
 
i
 = 0;

304 (
s
+
i
)<
ms
->
¤c_’d
 && 
	`sšgËm©ch
(
	`uch¬
(*(s+i)), 
p
, 
•
))

305 
i
++;

307 
i
>=0) {

308 cÚ¡ *
»s
 = 
	`m©ch
(
ms
, (
s
+
i
), 
•
+1);

309 ià(
»s
) „es;

310 
i
--;

312  
NULL
;

313 
	}
}

316 cÚ¡ *
	$mš_ex·nd
 (
M©chS‹
 *
ms
, cÚ¡ *
s
,

317 cÚ¡ *
p
, cÚ¡ *
•
) {

319 cÚ¡ *
»s
 = 
	`m©ch
(
ms
, 
s
, 
•
+1);

320 ià(
»s
 !ğ
NULL
)

321  
»s
;

322 ià(
s
<
ms
->
¤c_’d
 && 
	`sšgËm©ch
(
	`uch¬
(*s), 
p
, 
•
))

323 
s
++;

324  
NULL
;

326 
	}
}

329 cÚ¡ *
	$¡¬t_ÿ±u»
 (
M©chS‹
 *
ms
, cÚ¡ *
s
,

330 cÚ¡ *
p
, 
wh©
) {

331 cÚ¡ *
»s
;

332 
Ëv–
 = 
ms
->level;

333 ià(
Ëv–
 >ğ
LUA_MAXCAPTURES
è
	`luaL_”rÜ
(
ms
->
L
, "too many captures");

334 
ms
->
ÿ±u»
[
Ëv–
].
š™
 = 
s
;

335 
ms
->
ÿ±u»
[
Ëv–
].
Ën
 = 
wh©
;

336 
ms
->
Ëv–
 =†evel+1;

337 ià((
»s
=
	`m©ch
(
ms
, 
s
, 
p
)è=ğ
NULL
)

338 
ms
->
Ëv–
--;

339  
»s
;

340 
	}
}

343 cÚ¡ *
	$’d_ÿ±u»
 (
M©chS‹
 *
ms
, cÚ¡ *
s
,

344 cÚ¡ *
p
) {

345 
l
 = 
	`ÿ±u»_to_şo£
(
ms
);

346 cÚ¡ *
»s
;

347 
ms
->
ÿ±u»
[
l
].
Ën
 = 
s
 - ms->ÿ±u»[l].
š™
;

348 ià((
»s
 = 
	`m©ch
(
ms
, 
s
, 
p
)è=ğ
NULL
)

349 
ms
->
ÿ±u»
[
l
].
Ën
 = 
CAP_UNFINISHED
;

350  
»s
;

351 
	}
}

354 cÚ¡ *
	$m©ch_ÿ±u»
 (
M©chS‹
 *
ms
, cÚ¡ *
s
, 
l
) {

355 
size_t
 
Ën
;

356 
l
 = 
	`check_ÿ±u»
(
ms
,†);

357 
Ën
 = 
ms
->
ÿ±u»
[
l
].len;

358 ià((
size_t
)(
ms
->
¤c_’d
-
s
è>ğ
Ën
 &&

359 
	`memcmp
(
ms
->
ÿ±u»
[
l
].
š™
, 
s
, 
Ën
) == 0)

360  
s
+
Ën
;

361  
NULL
;

362 
	}
}

365 cÚ¡ *
	$m©ch
 (
M©chS‹
 *
ms
, cÚ¡ *
s
, cÚ¡ *
p
) {

366 
š™
:

367 *
p
) {

369 ià(*(
p
+1) == ')')

370  
	`¡¬t_ÿ±u»
(
ms
, 
s
, 
p
+2, 
CAP_POSITION
);

372  
	`¡¬t_ÿ±u»
(
ms
, 
s
, 
p
+1, 
CAP_UNFINISHED
);

375  
	`’d_ÿ±u»
(
ms
, 
s
, 
p
+1);

377 
L_ESC
: {

378 *(
p
+1)) {

380 
s
 = 
	`m©chb®ªû
(
ms
, s, 
p
+2);

381 ià(
s
 =ğ
NULL
)  NULL;

382 
p
+=4; 
š™
;

385 cÚ¡ *
•
; 
´evious
;

386 
p
 += 2;

387 ià(*
p
 != '[')

388 
	`luaL_”rÜ
(
ms
->
L
, "missšg " 
	`LUA_QL
("[") "‡fter "

389 
	`LUA_QL
("%%f") " in…attern");

390 
•
 = 
	`şas£nd
(
ms
, 
p
);

391 
´evious
 = (
s
 =ğ
ms
->
¤c_š™
) ? '\0' : *(s-1);

392 ià(
	`m©chb¿ck‘şass
(
	`uch¬
(
´evious
), 
p
, 
•
-1) ||

393 !
	`m©chb¿ck‘şass
(
	`uch¬
(*
s
), 
p
, 
•
-1)è 
NULL
;

394 
p
=
•
; 
š™
;

397 ià(
	`isdig™
(
	`uch¬
(*(
p
+1)))) {

398 
s
 = 
	`m©ch_ÿ±u»
(
ms
, s, 
	`uch¬
(*(
p
+1)));

399 ià(
s
 =ğ
NULL
)  NULL;

400 
p
+=2; 
š™
;

402 
dæt
;

407  
s
;

410 ià(*(
p
+1) == '\0')

411  (
s
 =ğ
ms
->
¤c_’d
è? s : 
NULL
;

412 
dæt
;

414 : 
dæt
: {

415 cÚ¡ *
•
 = 
	`şas£nd
(
ms
, 
p
);

416 
m
 = 
s
<
ms
->
¤c_’d
 && 
	`sšgËm©ch
(
	`uch¬
(*s), 
p
, 
•
);

417 *
•
) {

419 cÚ¡ *
»s
;

420 ià(
m
 && ((
»s
=
	`m©ch
(
ms
, 
s
+1, 
•
+1)è!ğ
NULL
))

421  
»s
;

422 
p
=
•
+1; 
š™
;

425  
	`max_ex·nd
(
ms
, 
s
, 
p
, 
•
);

428  (
m
 ? 
	`max_ex·nd
(
ms
, 
s
+1, 
p
, 
•
è: 
NULL
);

431  
	`mš_ex·nd
(
ms
, 
s
, 
p
, 
•
);

434 ià(!
m
è 
NULL
;

435 
s
++; 
p
=
•
; 
š™
;

440 
	}
}

444 cÚ¡ *
	$lmemfšd
 (cÚ¡ *
s1
, 
size_t
 
l1
,

445 cÚ¡ *
s2
, 
size_t
 
l2
) {

446 ià(
l2
 =ğ0è 
s1
;

447 ià(
l2
 > 
l1
è 
NULL
;

449 cÚ¡ *
š™
;

450 
l2
--;

451 
l1
 =†1-
l2
;

452 
l1
 > 0 && (
š™
 = (cÚ¡ *)
	`memchr
(
s1
, *
s2
,†1)è!ğ
NULL
) {

453 
š™
++;

454 ià(
	`memcmp
(
š™
, 
s2
+1, 
l2
) == 0)

455  
š™
-1;

457 
l1
 -ğ
š™
-
s1
;

458 
s1
 = 
š™
;

461  
NULL
;

463 
	}
}

466 
	$push_Úeÿ±u»
 (
M©chS‹
 *
ms
, 
i
, cÚ¡ *
s
,

467 cÚ¡ *
e
) {

468 ià(
i
 >ğ
ms
->
Ëv–
) {

469 ià(
i
 == 0)

470 
	`lua_pushl¡ršg
(
ms
->
L
, 
s
, 
e
 - s);

472 
	`luaL_”rÜ
(
ms
->
L
, "invalid capture index");

475 
±rdiff_t
 
l
 = 
ms
->
ÿ±u»
[
i
].
Ën
;

476 ià(
l
 =ğ
CAP_UNFINISHED
è
	`luaL_”rÜ
(
ms
->
L
, "unfinished capture");

477 ià(
l
 =ğ
CAP_POSITION
)

478 
	`lua_pushš‹g”
(
ms
->
L
, ms->
ÿ±u»
[
i
].
š™
 - ms->
¤c_š™
 + 1);

480 
	`lua_pushl¡ršg
(
ms
->
L
, ms->
ÿ±u»
[
i
].
š™
, 
l
);

482 
	}
}

485 
	$push_ÿ±u»s
 (
M©chS‹
 *
ms
, cÚ¡ *
s
, cÚ¡ *
e
) {

486 
i
;

487 
Æev–s
 = (
ms
->
Ëv–
 =ğ0 && 
s
) ? 1 : ms->level;

488 
	`luaL_check¡ack
(
ms
->
L
, 
Æev–s
, "too many captures");

489 
i
 = 0; i < 
Æev–s
; i++)

490 
	`push_Úeÿ±u»
(
ms
, 
i
, 
s
, 
e
);

491  
Æev–s
;

492 
	}
}

495 
	$¡r_fšd_aux
 (
lua_S‹
 *
L
, 
fšd
) {

496 
size_t
 
l1
, 
l2
;

497 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 1, &
l1
);

498 cÚ¡ *
p
 = 
	`luaL_checkl¡ršg
(
L
, 2, &
l2
);

499 
±rdiff_t
 
š™
 = 
	`po¤–©
(
	`luaL_İtš‹g”
(
L
, 3, 1), 
l1
) - 1;

500 ià(
š™
 < 0) init = 0;

501 ià((
size_t
)(
š™
è> 
l1
èš™ = (
±rdiff_t
)l1;

502 ià(
fšd
 && (
	`lua_toboŞ—n
(
L
, 4) ||

503 
	`¡½brk
(
p
, 
SPECIALS
è=ğ
NULL
)) {

505 cÚ¡ *
s2
 = 
	`lmemfšd
(
s
+
š™
, 
l1
-š™, 
p
, 
l2
);

506 ià(
s2
) {

507 
	`lua_pushš‹g”
(
L
, 
s2
-
s
+1);

508 
	`lua_pushš‹g”
(
L
, 
s2
-
s
+
l2
);

513 
M©chS‹
 
ms
;

514 
ªchÜ
 = (*
p
 == '^') ? (p++, 1) : 0;

515 cÚ¡ *
s1
=
s
+
š™
;

516 
ms
.
L
 = L;

517 
ms
.
¤c_š™
 = 
s
;

518 
ms
.
¤c_’d
 = 
s
+
l1
;

520 cÚ¡ *
»s
;

521 
ms
.
Ëv–
 = 0;

522 ià((
»s
=
	`m©ch
(&
ms
, 
s1
, 
p
)è!ğ
NULL
) {

523 ià(
fšd
) {

524 
	`lua_pushš‹g”
(
L
, 
s1
-
s
+1);

525 
	`lua_pushš‹g”
(
L
, 
»s
-
s
);

526  
	`push_ÿ±u»s
(&
ms
, 
NULL
, 0) + 2;

529  
	`push_ÿ±u»s
(&
ms
, 
s1
, 
»s
);

531 } 
s1
++ < 
ms
.
¤c_’d
 && !
ªchÜ
);

533 
	`lua_pushn
(
L
);

535 
	}
}

538 
	$¡r_fšd
 (
lua_S‹
 *
L
) {

539  
	`¡r_fšd_aux
(
L
, 1);

540 
	}
}

543 
	$¡r_m©ch
 (
lua_S‹
 *
L
) {

544  
	`¡r_fšd_aux
(
L
, 0);

545 
	}
}

548 
	$gm©ch_aux
 (
lua_S‹
 *
L
) {

549 
M©chS‹
 
ms
;

550 
size_t
 
ls
;

551 cÚ¡ *
s
 = 
	`lua_tŞ¡ršg
(
L
, 
	`lua_upv®uešdex
(1), &
ls
);

552 cÚ¡ *
p
 = 
	`lua_to¡ršg
(
L
, 
	`lua_upv®uešdex
(2));

553 cÚ¡ *
¤c
;

554 
ms
.
L
 = L;

555 
ms
.
¤c_š™
 = 
s
;

556 
ms
.
¤c_’d
 = 
s
+
ls
;

557 
¤c
 = 
s
 + (
size_t
)
	`lua_toš‹g”
(
L
, 
	`lua_upv®uešdex
(3));

558 
¤c
 <ğ
ms
.
¤c_’d
;

559 
¤c
++) {

560 cÚ¡ *
e
;

561 
ms
.
Ëv–
 = 0;

562 ià((
e
 = 
	`m©ch
(&
ms
, 
¤c
, 
p
)è!ğ
NULL
) {

563 
lua_IÁeg”
 
Ãw¡¬t
 = 
e
-
s
;

564 ià(
e
 =ğ
¤c
è
Ãw¡¬t
++;

565 
	`lua_pushš‹g”
(
L
, 
Ãw¡¬t
);

566 
	`lua_»¶aû
(
L
, 
	`lua_upv®uešdex
(3));

567  
	`push_ÿ±u»s
(&
ms
, 
¤c
, 
e
);

571 
	}
}

574 
	$gm©ch
 (
lua_S‹
 *
L
) {

575 
	`luaL_check¡ršg
(
L
, 1);

576 
	`luaL_check¡ršg
(
L
, 2);

577 
	`lua_£‰İ
(
L
, 2);

578 
	`lua_pushš‹g”
(
L
, 0);

579 
	`lua_pushcşosu»
(
L
, 
gm©ch_aux
, 3);

581 
	}
}

584 
	$gfšd_nodef
 (
lua_S‹
 *
L
) {

585  
	`luaL_”rÜ
(
L
, 
	`LUA_QL
("string.gfind") " was„enamedo "

586 
	`LUA_QL
("string.gmatch"));

587 
	}
}

590 
	$add_s
 (
M©chS‹
 *
ms
, 
luaL_Bufãr
 *
b
, cÚ¡ *
s
,

591 cÚ¡ *
e
) {

592 
size_t
 
l
, 
i
;

593 cÚ¡ *
Ãws
 = 
	`lua_tŞ¡ršg
(
ms
->
L
, 3, &
l
);

594 
i
 = 0; i < 
l
; i++) {

595 ià(
Ãws
[
i
] !ğ
L_ESC
)

596 
	`luaL_addch¬
(
b
, 
Ãws
[
i
]);

598 
i
++;

599 ià(!
	`isdig™
(
	`uch¬
(
Ãws
[
i
])))

600 
	`luaL_addch¬
(
b
, 
Ãws
[
i
]);

601 ià(
Ãws
[
i
] == '0')

602 
	`luaL_addl¡ršg
(
b
, 
s
, 
e
 - s);

604 
	`push_Úeÿ±u»
(
ms
, 
Ãws
[
i
] - '1', 
s
, 
e
);

605 
	`luaL_addv®ue
(
b
);

609 
	}
}

612 
	$add_v®ue
 (
M©chS‹
 *
ms
, 
luaL_Bufãr
 *
b
, cÚ¡ *
s
,

613 cÚ¡ *
e
) {

614 
lua_S‹
 *
L
 = 
ms
->L;

615 
	`lua_ty³
(
L
, 3)) {

616 
LUA_TNUMBER
:

617 
LUA_TSTRING
: {

618 
	`add_s
(
ms
, 
b
, 
s
, 
e
);

621 
LUA_TFUNCTION
: {

622 
n
;

623 
	`lua_pushv®ue
(
L
, 3);

624 
n
 = 
	`push_ÿ±u»s
(
ms
, 
s
, 
e
);

625 
	`lua_ÿÎ
(
L
, 
n
, 1);

628 
LUA_TTABLE
: {

629 
	`push_Úeÿ±u»
(
ms
, 0, 
s
, 
e
);

630 
	`lua_g‘bË
(
L
, 3);

634 ià(!
	`lua_toboŞ—n
(
L
, -1)) {

635 
	`lua_pİ
(
L
, 1);

636 
	`lua_pushl¡ršg
(
L
, 
s
, 
e
 - s);

638 ià(!
	`lua_is¡ršg
(
L
, -1))

639 
	`luaL_”rÜ
(
L
, "šv®id„•Ïûm’ˆv®u× %s)", 
	`luaL_ty³Çme
(L, -1));

640 
	`luaL_addv®ue
(
b
);

641 
	}
}

644 
	$¡r_gsub
 (
lua_S‹
 *
L
) {

645 
size_t
 
¤ş
;

646 cÚ¡ *
¤c
 = 
	`luaL_checkl¡ršg
(
L
, 1, &
¤ş
);

647 cÚ¡ *
p
 = 
	`luaL_check¡ršg
(
L
, 2);

648 
Œ
 = 
	`lua_ty³
(
L
, 3);

649 
max_s
 = 
	`luaL_İtšt
(
L
, 4, 
¤ş
+1);

650 
ªchÜ
 = (*
p
 == '^') ? (p++, 1) : 0;

651 
n
 = 0;

652 
M©chS‹
 
ms
;

653 
luaL_Bufãr
 
b
;

654 
	`luaL_¬gcheck
(
L
, 
Œ
 =ğ
LUA_TNUMBER
 ||¸=ğ
LUA_TSTRING
 ||

655 
Œ
 =ğ
LUA_TFUNCTION
 ||¸=ğ
LUA_TTABLE
, 3,

657 
	`luaL_buffš™
(
L
, &
b
);

658 
ms
.
L
 = L;

659 
ms
.
¤c_š™
 = 
¤c
;

660 
ms
.
¤c_’d
 = 
¤c
+
¤ş
;

661 
n
 < 
max_s
) {

662 cÚ¡ *
e
;

663 
ms
.
Ëv–
 = 0;

664 
e
 = 
	`m©ch
(&
ms
, 
¤c
, 
p
);

665 ià(
e
) {

666 
n
++;

667 
	`add_v®ue
(&
ms
, &
b
, 
¤c
, 
e
);

669 ià(
e
 &&ƒ>
¤c
)

670 
¤c
 = 
e
;

671 ià(
¤c
 < 
ms
.
¤c_’d
)

672 
	`luaL_addch¬
(&
b
, *
¤c
++);

674 ià(
ªchÜ
) ;

676 
	`luaL_addl¡ršg
(&
b
, 
¤c
, 
ms
.
¤c_’d
-src);

677 
	`luaL_push»suÉ
(&
b
);

678 
	`lua_pushš‹g”
(
L
, 
n
);

680 
	}
}

686 
	#MAX_ITEM
 512

	)

688 
	#FLAGS
 "-+ #0"

	)

693 
	#MAX_FORMAT
 ((
FLAGS
è+ (
LUA_INTFRMLEN
è+ 10)

	)

696 
	$addquÙed
 (
lua_S‹
 *
L
, 
luaL_Bufãr
 *
b
, 
¬g
) {

697 
size_t
 
l
;

698 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 
¬g
, &
l
);

699 
	`luaL_addch¬
(
b
, '"');

700 
l
--) {

701 *
s
) {

703 
	`luaL_addch¬
(
b
, '\\');

704 
	`luaL_addch¬
(
b
, *
s
);

708 
	`luaL_addl¡ršg
(
b
, "\\r", 2);

712 
	`luaL_addl¡ršg
(
b
, "\\000", 4);

716 
	`luaL_addch¬
(
b
, *
s
);

720 
s
++;

722 
	`luaL_addch¬
(
b
, '"');

723 
	}
}

725 cÚ¡ *
	$sÿnfÜm©
 (
lua_S‹
 *
L
, cÚ¡ *
¡rämt
, *
fÜm
) {

726 cÚ¡ *
p
 = 
¡rämt
;

727 *
p
 !ğ'\0' && 
	`¡rchr
(
FLAGS
, *pè!ğ
NULL
)…++;

728 ià((
size_t
)(
p
 - 
¡rämt
è>ğ(
FLAGS
))

729 
	`luaL_”rÜ
(
L
, "invalid format (repeated flags)");

730 ià(
	`isdig™
(
	`uch¬
(*
p
)))…++;

731 ià(
	`isdig™
(
	`uch¬
(*
p
)))…++;

732 ià(*
p
 == '.') {

733 
p
++;

734 ià(
	`isdig™
(
	`uch¬
(*
p
)))…++;

735 ià(
	`isdig™
(
	`uch¬
(*
p
)))…++;

737 ià(
	`isdig™
(
	`uch¬
(*
p
)))

738 
	`luaL_”rÜ
(
L
, "invalid format (width or…recisionoo†ong)");

739 *(
fÜm
++) = '%';

740 
	`¡ºıy
(
fÜm
, 
¡rämt
, 
p
 - strfrmt + 1);

741 
fÜm
 +ğ
p
 - 
¡rämt
 + 1;

742 *
fÜm
 = '\0';

743  
p
;

744 
	}
}

747 
	$addš’
 (*
fÜm
) {

748 
size_t
 
l
 = 
	`¡¾’
(
fÜm
);

749 
¥ec
 = 
fÜm
[
l
 - 1];

750 
	`¡rıy
(
fÜm
 + 
l
 - 1, 
LUA_INTFRMLEN
);

751 
fÜm
[
l
 + (
LUA_INTFRMLEN
è- 2] = 
¥ec
;

752 
fÜm
[
l
 + (
LUA_INTFRMLEN
) - 1] = '\0';

753 
	}
}

756 
	$¡r_fÜm©
 (
lua_S‹
 *
L
) {

757 
tİ
 = 
	`lua_g‘tİ
(
L
);

758 
¬g
 = 1;

759 
size_t
 
sæ
;

760 cÚ¡ *
¡rämt
 = 
	`luaL_checkl¡ršg
(
L
, 
¬g
, &
sæ
);

761 cÚ¡ *
¡rämt_’d
 = 
¡rämt
+
sæ
;

762 
luaL_Bufãr
 
b
;

763 
	`luaL_buffš™
(
L
, &
b
);

764 
¡rämt
 < 
¡rämt_’d
) {

765 ià(*
¡rämt
 !ğ
L_ESC
)

766 
	`luaL_addch¬
(&
b
, *
¡rämt
++);

767 ià(*++
¡rämt
 =ğ
L_ESC
)

768 
	`luaL_addch¬
(&
b
, *
¡rämt
++);

770 
fÜm
[
MAX_FORMAT
];

771 
buff
[
MAX_ITEM
];

772 ià(++
¬g
 > 
tİ
)

773 
	`luaL_¬g”rÜ
(
L
, 
¬g
, "no value");

774 
¡rämt
 = 
	`sÿnfÜm©
(
L
, sŒämt, 
fÜm
);

775 *
¡rämt
++) {

777 
	`¥rštf
(
buff
, 
fÜm
, ()
	`luaL_checknumb”
(
L
, 
¬g
));

781 
	`addš’
(
fÜm
);

782 
	`¥rštf
(
buff
, 
fÜm
, (
LUA_INTFRM_T
)
	`luaL_checknumb”
(
L
, 
¬g
));

786 
	`addš’
(
fÜm
);

787 
	`¥rštf
(
buff
, 
fÜm
, (
LUA_INTFRM_T
)
	`luaL_checknumb”
(
L
, 
¬g
));

792 
	`¥rštf
(
buff
, 
fÜm
, ()
	`luaL_checknumb”
(
L
, 
¬g
));

796 
	`addquÙed
(
L
, &
b
, 
¬g
);

800 
size_t
 
l
;

801 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 
¬g
, &
l
);

802 ià(!
	`¡rchr
(
fÜm
, '.'è&& 
l
 >= 100) {

805 
	`lua_pushv®ue
(
L
, 
¬g
);

806 
	`luaL_addv®ue
(&
b
);

810 
	`¥rštf
(
buff
, 
fÜm
, 
s
);

815  
	`luaL_”rÜ
(
L
, "šv®id o±iÚ " 
	`LUA_QL
("%%%c") "o "

816 
	`LUA_QL
("fÜm©"), *(
¡rämt
 - 1));

819 
	`luaL_addl¡ršg
(&
b
, 
buff
, 
	`¡¾’
(buff));

822 
	`luaL_push»suÉ
(&
b
);

824 
	}
}

827 cÚ¡ 
luaL_Reg
 
	g¡¾ib
[] = {

828 {"by‹", 
¡r_by‹
},

829 {"ch¬", 
¡r_ch¬
},

830 {"dump", 
¡r_dump
},

831 {"fšd", 
¡r_fšd
},

832 {"fÜm©", 
¡r_fÜm©
},

833 {"gfšd", 
gfšd_nodef
},

834 {"gm©ch", 
gm©ch
},

835 {"gsub", 
¡r_gsub
},

836 {"Ën", 
¡r_Ën
},

837 {"low”", 
¡r_low”
},

838 {"m©ch", 
¡r_m©ch
},

839 {"»p", 
¡r_»p
},

840 {"»v”£", 
¡r_»v”£
},

841 {"sub", 
¡r_sub
},

842 {"uµ”", 
¡r_uµ”
},

843 {
NULL
, NULL}

847 
	$ü—‹m‘©abË
 (
lua_S‹
 *
L
) {

848 
	`lua_ü—‹bË
(
L
, 0, 1);

849 
	`lua_pushl™”®
(
L
, "");

850 
	`lua_pushv®ue
(
L
, -2);

851 
	`lua_£tm‘©abË
(
L
, -2);

852 
	`lua_pİ
(
L
, 1);

853 
	`lua_pushv®ue
(
L
, -2);

854 
	`lua_£tf›ld
(
L
, -2, "__index");

855 
	`lua_pİ
(
L
, 1);

856 
	}
}

862 
LUALIB_API
 
	$luaİ’_¡ršg
 (
lua_S‹
 *
L
) {

863 
	`luaL_»gi¡”
(
L
, 
LUA_STRLIBNAME
, 
¡¾ib
);

864 #ià
	`defšed
(
LUA_COMPAT_GFIND
)

865 
	`lua_g‘f›ld
(
L
, -1, "gmatch");

866 
	`lua_£tf›ld
(
L
, -2, "gfind");

868 
	`ü—‹m‘©abË
(
L
);

870 
	}
}

	@deps/lua/src/ltable.c

21 
	~<m©h.h
>

22 
	~<¡ršg.h
>

24 
	#ÉabË_c


	)

25 
	#LUA_CORE


	)

27 
	~"lua.h
"

29 
	~"ldebug.h
"

30 
	~"ldo.h
"

31 
	~"lgc.h
"

32 
	~"lmem.h
"

33 
	~"lobjeù.h
"

34 
	~"l¡©e.h
"

35 
	~"ÉabË.h
"

41 #ià
LUAI_BITSINT
 > 26

42 
	#MAXBITS
 26

	)

44 
	#MAXBITS
 (
LUAI_BITSINT
-2)

	)

47 
	#MAXASIZE
 (1 << 
MAXBITS
)

	)

50 
	#hashpow2
(
t
,
n
è(
	`gnode
Ñ, 
	`lmod
(Ò), 
	`siz’ode
Ñ))))

	)

52 
	#hash¡r
(
t
,
¡r
è
	`hashpow2
Ñ, (¡r)->
tsv
.
hash
)

	)

53 
	#hashboŞ—n
(
t
,
p
è
	`hashpow2
Ñ,…)

	)

60 
	#hashmod
(
t
,
n
è(
	`gnode
Ñ, (Òè% ((
	`siz’ode
Ñ)-1)|1))))

	)

63 
	#hashpoš‹r
(
t
,
p
è
	`hashmod
Ñ, 
	`IÁPošt
Õ))

	)

69 
	#numšts
 
	`ÿ¡_št
((
lua_Numb”
)/())

	)

73 
	#dummynode
 (&
dummynode_
)

	)

75 cÚ¡ 
Node
 
	gdummynode_
 = {

76 {{
NULL
}, 
LUA_TNIL
},

77 {{{
NULL
}, 
LUA_TNIL
, NULL}}

84 
Node
 *
	$hashnum
 (cÚ¡ 
TabË
 *
t
, 
lua_Numb”
 
n
) {

85 
a
[
numšts
];

86 
i
;

87 ià(
	`luai_numeq
(
n
, 0))

88  
	`gnode
(
t
, 0);

89 
	`memıy
(
a
, &
n
, (a));

90 
i
 = 1; i < 
numšts
; i++è
a
[0] +=‡[i];

91  
	`hashmod
(
t
, 
a
[0]);

92 
	}
}

100 
Node
 *
	$mašpos™iÚ
 (cÚ¡ 
TabË
 *
t
, cÚ¡ 
TV®ue
 *
key
) {

101 
	`‰y³
(
key
)) {

102 
LUA_TNUMBER
:

103  
	`hashnum
(
t
, 
	`nv®ue
(
key
));

104 
LUA_TSTRING
:

105  
	`hash¡r
(
t
, 
	`¿wtsv®ue
(
key
));

106 
LUA_TBOOLEAN
:

107  
	`hashboŞ—n
(
t
, 
	`bv®ue
(
key
));

108 
LUA_TLIGHTUSERDATA
:

109  
	`hashpoš‹r
(
t
, 
	`pv®ue
(
key
));

111  
	`hashpoš‹r
(
t
, 
	`gcv®ue
(
key
));

113 
	}
}

120 
	$¬¿yšdex
 (cÚ¡ 
TV®ue
 *
key
) {

121 ià(
	`‰i¢umb”
(
key
)) {

122 
lua_Numb”
 
n
 = 
	`nv®ue
(
key
);

123 
k
;

124 
	`lua_numb”2št
(
k
, 
n
);

125 ià(
	`luai_numeq
(
	`ÿ¡_num
(
k
), 
n
))

126  
k
;

129 
	}
}

137 
	$fšdšdex
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
StkId
 
key
) {

138 
i
;

139 ià(
	`‰i¢
(
key
))  -1;

140 
i
 = 
	`¬¿yšdex
(
key
);

141 ià(0 < 
i
 && i <ğ
t
->
siz—¼ay
)

142  
i
-1;

144 
Node
 *
n
 = 
	`mašpos™iÚ
(
t
, 
key
);

147 ià(
	`luaO_¿wequ®Obj
(
	`key2tv®
(
n
), 
key
) ||

148 (
	`‰y³
(
	`gkey
(
n
)è=ğ
LUA_TDEADKEY
 && 
	`iscŞËùabË
(
key
) &&

149 
	`gcv®ue
(
	`gkey
(
n
)è=ğgcv®ue(
key
))) {

150 
i
 = 
	`ÿ¡_št
(
n
 - 
	`gnode
(
t
, 0));

152  
i
 + 
t
->
siz—¼ay
;

154 
n
 = 
	`gÃxt
(n);

155 } 
n
);

156 
	`luaG_ruÃ¼Ü
(
L
, "šv®id keyØ" 
	`LUA_QL
("next"));

159 
	}
}

162 
	$luaH_Ãxt
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
StkId
 
key
) {

163 
i
 = 
	`fšdšdex
(
L
, 
t
, 
key
);

164 
i
++; i < 
t
->
siz—¼ay
; i++) {

165 ià(!
	`‰i¢
(&
t
->
¬¿y
[
i
])) {

166 
	`£Šv®ue
(
key
, 
	`ÿ¡_num
(
i
+1));

167 
	`£tobj2s
(
L
, 
key
+1, &
t
->
¬¿y
[
i
]);

171 
i
 -ğ
t
->
siz—¼ay
; i < 
	`siz’ode
(t); i++) {

172 ià(!
	`‰i¢
(
	`gv®
(
	`gnode
(
t
, 
i
)))) {

173 
	`£tobj2s
(
L
, 
key
, 
	`key2tv®
(
	`gnode
(
t
, 
i
)));

174 
	`£tobj2s
(
L
, 
key
+1, 
	`gv®
(
	`gnode
(
t
, 
i
)));

179 
	}
}

189 
	$compu‹sizes
 (
nums
[], *
Ç¼ay
) {

190 
i
;

191 
twÙoi
;

192 
a
 = 0;

193 
Ç
 = 0;

194 
n
 = 0;

195 
i
 = 0, 
twÙoi
 = 1;wÙoi/2 < *
Ç¼ay
; i++,wotoi *= 2) {

196 ià(
nums
[
i
] > 0) {

197 
a
 +ğ
nums
[
i
];

198 ià(
a
 > 
twÙoi
/2) {

199 
n
 = 
twÙoi
;

200 
Ç
 = 
a
;

203 ià(
a
 =ğ*
Ç¼ay
) ;

205 *
Ç¼ay
 = 
n
;

206 
	`lua_as£¹
(*
Ç¼ay
/2 <ğ
Ç
 &&‚a <= *narray);

207  
Ç
;

208 
	}
}

211 
	$couÁšt
 (cÚ¡ 
TV®ue
 *
key
, *
nums
) {

212 
k
 = 
	`¬¿yšdex
(
key
);

213 ià(0 < 
k
 && k <ğ
MAXASIZE
) {

214 
nums
[
	`ûlog2
(
k
)]++;

219 
	}
}

222 
	$numu£¬¿y
 (cÚ¡ 
TabË
 *
t
, *
nums
) {

223 
lg
;

224 
‰lg
;

225 
au£
 = 0;

226 
i
 = 1;

227 
lg
=0, 
‰lg
=1;†g<=
MAXBITS
;†g++,tlg*=2) {

228 
lc
 = 0;

229 
lim
 = 
‰lg
;

230 ià(
lim
 > 
t
->
siz—¼ay
) {

231 
lim
 = 
t
->
siz—¼ay
;

232 ià(
i
 > 
lim
)

236 ; 
i
 <ğ
lim
; i++) {

237 ià(!
	`‰i¢
(&
t
->
¬¿y
[
i
-1]))

238 
lc
++;

240 
nums
[
lg
] +ğ
lc
;

241 
au£
 +ğ
lc
;

243  
au£
;

244 
	}
}

247 
	$numu£hash
 (cÚ¡ 
TabË
 *
t
, *
nums
, *
²asize
) {

248 
tÙ®u£
 = 0;

249 
au£
 = 0;

250 
i
 = 
	`siz’ode
(
t
);

251 
i
--) {

252 
Node
 *
n
 = &
t
->
node
[
i
];

253 ià(!
	`‰i¢
(
	`gv®
(
n
))) {

254 
au£
 +ğ
	`couÁšt
(
	`key2tv®
(
n
), 
nums
);

255 
tÙ®u£
++;

258 *
²asize
 +ğ
au£
;

259  
tÙ®u£
;

260 
	}
}

263 
	$£¼ayveùÜ
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
size
) {

264 
i
;

265 
	`luaM_»®locveùÜ
(
L
, 
t
->
¬¿y
,->
siz—¼ay
, 
size
, 
TV®ue
);

266 
i
=
t
->
siz—¼ay
; i<
size
; i++)

267 
	`£Šv®ue
(&
t
->
¬¿y
[
i
]);

268 
t
->
siz—¼ay
 = 
size
;

269 
	}
}

272 
	$£ŠodeveùÜ
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
size
) {

273 
lsize
;

274 ià(
size
 == 0) {

275 
t
->
node
 = 
	`ÿ¡
(
Node
 *, 
dummynode
);

276 
lsize
 = 0;

279 
i
;

280 
lsize
 = 
	`ûlog2
(
size
);

281 ià(
lsize
 > 
MAXBITS
)

282 
	`luaG_ruÃ¼Ü
(
L
, "table overflow");

283 
size
 = 
	`twÙo
(
lsize
);

284 
t
->
node
 = 
	`luaM_ÃwveùÜ
(
L
, 
size
, 
Node
);

285 
i
=0; i<
size
; i++) {

286 
Node
 *
n
 = 
	`gnode
(
t
, 
i
);

287 
	`gÃxt
(
n
èğ
NULL
;

288 
	`£Šv®ue
(
	`gkey
(
n
));

289 
	`£Šv®ue
(
	`gv®
(
n
));

292 
t
->
lsiz’ode
 = 
	`ÿ¡_by‹
(
lsize
);

293 
t
->
Ï¡ä“
 = 
	`gnode
Ñ, 
size
);

294 
	}
}

297 
	$»size
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
Çsize
, 
nhsize
) {

298 
i
;

299 
Şdasize
 = 
t
->
siz—¼ay
;

300 
Şdhsize
 = 
t
->
lsiz’ode
;

301 
Node
 *
nŞd
 = 
t
->
node
;

302 ià(
Çsize
 > 
Şdasize
)

303 
	`£¼ayveùÜ
(
L
, 
t
, 
Çsize
);

305 
	`£ŠodeveùÜ
(
L
, 
t
, 
nhsize
);

306 ià(
Çsize
 < 
Şdasize
) {

307 
t
->
siz—¼ay
 = 
Çsize
;

309 
i
=
Çsize
; i<
Şdasize
; i++) {

310 ià(!
	`‰i¢
(&
t
->
¬¿y
[
i
]))

311 
	`£tobjt2t
(
L
, 
	`luaH_£Šum
(L, 
t
, 
i
+1), &t->
¬¿y
[i]);

314 
	`luaM_»®locveùÜ
(
L
, 
t
->
¬¿y
, 
Şdasize
, 
Çsize
, 
TV®ue
);

317 
i
 = 
	`twÙo
(
Şdhsize
) - 1; i >= 0; i--) {

318 
Node
 *
Şd
 = 
nŞd
+
i
;

319 ià(!
	`‰i¢
(
	`gv®
(
Şd
)))

320 
	`£tobjt2t
(
L
, 
	`luaH_£t
(L, 
t
, 
	`key2tv®
(
Şd
)), 
	`gv®
(old));

322 ià(
nŞd
 !ğ
dummynode
)

323 
	`luaM_ä“¬¿y
(
L
, 
nŞd
, 
	`twÙo
(
Şdhsize
), 
Node
);

324 
	}
}

327 
	$luaH_»siz—¼ay
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
Çsize
) {

328 
nsize
 = (
t
->
node
 =ğ
dummynode
è? 0 : 
	`siz’ode
(t);

329 
	`»size
(
L
, 
t
, 
Çsize
, 
nsize
);

330 
	}
}

333 
	$»hash
 (
lua_S‹
 *
L
, 
TabË
 *
t
, cÚ¡ 
TV®ue
 *
ek
) {

334 
Çsize
, 
Ç
;

335 
nums
[
MAXBITS
+1];

336 
i
;

337 
tÙ®u£
;

338 
i
=0; i<=
MAXBITS
; i++è
nums
[i] = 0;

339 
Çsize
 = 
	`numu£¬¿y
(
t
, 
nums
);

340 
tÙ®u£
 = 
Çsize
;

341 
tÙ®u£
 +ğ
	`numu£hash
(
t
, 
nums
, &
Çsize
);

343 
Çsize
 +ğ
	`couÁšt
(
ek
, 
nums
);

344 
tÙ®u£
++;

346 
Ç
 = 
	`compu‹sizes
(
nums
, &
Çsize
);

348 
	`»size
(
L
, 
t
, 
Çsize
, 
tÙ®u£
 - 
Ç
);

349 
	}
}

358 
TabË
 *
	$luaH_Ãw
 (
lua_S‹
 *
L
, 
Ç¼ay
, 
nhash
) {

359 
TabË
 *
t
 = 
	`luaM_Ãw
(
L
, Table);

360 
	`luaC_lšk
(
L
, 
	`obj2gco
(
t
), 
LUA_TTABLE
);

361 
t
->
m‘©abË
 = 
NULL
;

362 
t
->
æags
 = 
	`ÿ¡_by‹
(~0);

364 
t
->
¬¿y
 = 
NULL
;

365 
t
->
siz—¼ay
 = 0;

366 
t
->
lsiz’ode
 = 0;

367 
t
->
node
 = 
	`ÿ¡
(
Node
 *, 
dummynode
);

368 
	`£¼ayveùÜ
(
L
, 
t
, 
Ç¼ay
);

369 
	`£ŠodeveùÜ
(
L
, 
t
, 
nhash
);

370  
t
;

371 
	}
}

374 
	$luaH_ä“
 (
lua_S‹
 *
L
, 
TabË
 *
t
) {

375 ià(
t
->
node
 !ğ
dummynode
)

376 
	`luaM_ä“¬¿y
(
L
, 
t
->
node
, 
	`siz’ode
Ñ), 
Node
);

377 
	`luaM_ä“¬¿y
(
L
, 
t
->
¬¿y
,->
siz—¼ay
, 
TV®ue
);

378 
	`luaM_ä“
(
L
, 
t
);

379 
	}
}

382 
Node
 *
	$g‘ä“pos
 (
TabË
 *
t
) {

383 
t
->
Ï¡ä“
-- >->
node
) {

384 ià(
	`‰i¢
(
	`gkey
(
t
->
Ï¡ä“
)))

385  
t
->
Ï¡ä“
;

387  
NULL
;

388 
	}
}

399 
TV®ue
 *
	$Ãwkey
 (
lua_S‹
 *
L
, 
TabË
 *
t
, cÚ¡ 
TV®ue
 *
key
) {

400 
Node
 *
mp
 = 
	`mašpos™iÚ
(
t
, 
key
);

401 ià(!
	`‰i¢
(
	`gv®
(
mp
)è|| m°=ğ
dummynode
) {

402 
Node
 *
Ùh”n
;

403 
Node
 *
n
 = 
	`g‘ä“pos
(
t
);

404 ià(
n
 =ğ
NULL
) {

405 
	`»hash
(
L
, 
t
, 
key
);

406  
	`luaH_£t
(
L
, 
t
, 
key
);

408 
	`lua_as£¹
(
n
 !ğ
dummynode
);

409 
Ùh”n
 = 
	`mašpos™iÚ
(
t
, 
	`key2tv®
(
mp
));

410 ià(
Ùh”n
 !ğ
mp
) {

412 
	`gÃxt
(
Ùh”n
è!ğ
mp
) othern = gnext(othern);

413 
	`gÃxt
(
Ùh”n
èğ
n
;

414 *
n
 = *
mp
;

415 
	`gÃxt
(
mp
èğ
NULL
;

416 
	`£Šv®ue
(
	`gv®
(
mp
));

420 
	`gÃxt
(
n
èğgÃxt(
mp
);

421 
	`gÃxt
(
mp
èğ
n
;

422 
mp
 = 
n
;

425 
	`gkey
(
mp
)->
v®ue
 = 
key
->v®ue; gkey(mp)->
‰
 = key->tt;

426 
	`luaC_b¬r›¹
(
L
, 
t
, 
key
);

427 
	`lua_as£¹
(
	`‰i¢
(
	`gv®
(
mp
)));

428  
	`gv®
(
mp
);

429 
	}
}

435 cÚ¡ 
TV®ue
 *
	$luaH_g‘num
 (
TabË
 *
t
, 
key
) {

437 ià(
	`ÿ¡
(, 
key
-1è< ca¡(, 
t
->
siz—¼ay
))

438  &
t
->
¬¿y
[
key
-1];

440 
lua_Numb”
 
nk
 = 
	`ÿ¡_num
(
key
);

441 
Node
 *
n
 = 
	`hashnum
(
t
, 
nk
);

443 ià(
	`‰i¢umb”
(
	`gkey
(
n
)è&& 
	`luai_numeq
(
	`nv®ue
(gkeyÒ)), 
nk
))

444  
	`gv®
(
n
);

445 
n
 = 
	`gÃxt
(n);

446 } 
n
);

447  
luaO_nobjeù
;

449 
	}
}

455 cÚ¡ 
TV®ue
 *
	$luaH_g‘¡r
 (
TabË
 *
t
, 
TSŒšg
 *
key
) {

456 
Node
 *
n
 = 
	`hash¡r
(
t
, 
key
);

458 ià(
	`‰is¡ršg
(
	`gkey
(
n
)è&& 
	`¿wtsv®ue
(gkeyÒ)è=ğ
key
)

459  
	`gv®
(
n
);

460 
n
 = 
	`gÃxt
(n);

461 } 
n
);

462  
luaO_nobjeù
;

463 
	}
}

469 cÚ¡ 
TV®ue
 *
	$luaH_g‘
 (
TabË
 *
t
, cÚ¡ 
TV®ue
 *
key
) {

470 
	`‰y³
(
key
)) {

471 
LUA_TNIL
:  
luaO_nobjeù
;

472 
LUA_TSTRING
:  
	`luaH_g‘¡r
(
t
, 
	`¿wtsv®ue
(
key
));

473 
LUA_TNUMBER
: {

474 
k
;

475 
lua_Numb”
 
n
 = 
	`nv®ue
(
key
);

476 
	`lua_numb”2št
(
k
, 
n
);

477 ià(
	`luai_numeq
(
	`ÿ¡_num
(
k
), 
	`nv®ue
(
key
)))

478  
	`luaH_g‘num
(
t
, 
k
);

482 
Node
 *
n
 = 
	`mašpos™iÚ
(
t
, 
key
);

484 ià(
	`luaO_¿wequ®Obj
(
	`key2tv®
(
n
), 
key
))

485  
	`gv®
(
n
);

486 
n
 = 
	`gÃxt
(n);

487 } 
n
);

488  
luaO_nobjeù
;

491 
	}
}

494 
TV®ue
 *
	$luaH_£t
 (
lua_S‹
 *
L
, 
TabË
 *
t
, cÚ¡ 
TV®ue
 *
key
) {

495 cÚ¡ 
TV®ue
 *
p
 = 
	`luaH_g‘
(
t
, 
key
);

496 
t
->
æags
 = 0;

497 ià(
p
 !ğ
luaO_nobjeù
)

498  
	`ÿ¡
(
TV®ue
 *, 
p
);

500 ià(
	`‰i¢
(
key
)è
	`luaG_ruÃ¼Ü
(
L
, "table index is‚il");

501 ià(
	`‰i¢umb”
(
key
è&& 
	`luai_numi¢ª
(
	`nv®ue
(key)))

502 
	`luaG_ruÃ¼Ü
(
L
, "table index is NaN");

503  
	`Ãwkey
(
L
, 
t
, 
key
);

505 
	}
}

508 
TV®ue
 *
	$luaH_£Šum
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
key
) {

509 cÚ¡ 
TV®ue
 *
p
 = 
	`luaH_g‘num
(
t
, 
key
);

510 ià(
p
 !ğ
luaO_nobjeù
)

511  
	`ÿ¡
(
TV®ue
 *, 
p
);

513 
TV®ue
 
k
;

514 
	`£Šv®ue
(&
k
, 
	`ÿ¡_num
(
key
));

515  
	`Ãwkey
(
L
, 
t
, &
k
);

517 
	}
}

520 
TV®ue
 *
	$luaH_£t¡r
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
TSŒšg
 *
key
) {

521 cÚ¡ 
TV®ue
 *
p
 = 
	`luaH_g‘¡r
(
t
, 
key
);

522 ià(
p
 !ğ
luaO_nobjeù
)

523  
	`ÿ¡
(
TV®ue
 *, 
p
);

525 
TV®ue
 
k
;

526 
	`£tsv®ue
(
L
, &
k
, 
key
);

527  
	`Ãwkey
(
L
, 
t
, &
k
);

529 
	}
}

532 
	$unbound_£¬ch
 (
TabË
 *
t
, 
j
) {

533 
i
 = 
j
;

534 
j
++;

536 !
	`‰i¢
(
	`luaH_g‘num
(
t
, 
j
))) {

537 
i
 = 
j
;

538 
j
 *= 2;

539 ià(
j
 > 
	`ÿ¡
(, 
MAX_INT
)) {

541 
i
 = 1;

542 !
	`‰i¢
(
	`luaH_g‘num
(
t
, 
i
))) i++;

543  
i
 - 1;

547 
j
 - 
i
 > 1) {

548 
m
 = (
i
+
j
)/2;

549 ià(
	`‰i¢
(
	`luaH_g‘num
(
t
, 
m
))è
j
 = m;

550 
i
 = 
m
;

552  
i
;

553 
	}
}

560 
	$luaH_g‘n
 (
TabË
 *
t
) {

561 
j
 = 
t
->
siz—¼ay
;

562 ià(
j
 > 0 && 
	`‰i¢
(&
t
->
¬¿y
[j - 1])) {

564 
i
 = 0;

565 
j
 - 
i
 > 1) {

566 
m
 = (
i
+
j
)/2;

567 ià(
	`‰i¢
(&
t
->
¬¿y
[
m
 - 1])è
j
 = m;

568 
i
 = 
m
;

570  
i
;

573 ià(
t
->
node
 =ğ
dummynode
)

574  
j
;

575  
	`unbound_£¬ch
(
t
, 
j
);

576 
	}
}

580 #ià
defšed
(
LUA_DEBUG
)

582 
Node
 *
	$luaH_mašpos™iÚ
 (cÚ¡ 
TabË
 *
t
, cÚ¡ 
TV®ue
 *
key
) {

583  
	`mašpos™iÚ
(
t
, 
key
);

584 
	}
}

586 
	$luaH_isdummy
 (
Node
 *
n
è{ ‚ =ğ
dummynode
; 
	}
}

	@deps/lua/src/ltable.h

7 #iâdeà
ÉabË_h


8 
	#ÉabË_h


	)

10 
	~"lobjeù.h
"

13 
	#gnode
(
t
,
i
è(&Ñ)->
node
[i])

	)

14 
	#gkey
(
n
è(&Ò)->
i_key
.
nk
)

	)

15 
	#gv®
(
n
è(&Ò)->
i_v®
)

	)

16 
	#gÃxt
(
n
è(Ò)->
i_key
.
nk
.
Ãxt
)

	)

18 
	#key2tv®
(
n
è(&Ò)->
i_key
.
tvk
)

	)

21 
LUAI_FUNC
 cÚ¡ 
TV®ue
 *
luaH_g‘num
 (
TabË
 *
t
, 
key
);

22 
LUAI_FUNC
 
TV®ue
 *
luaH_£Šum
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
key
);

23 
LUAI_FUNC
 cÚ¡ 
TV®ue
 *
luaH_g‘¡r
 (
TabË
 *
t
, 
TSŒšg
 *
key
);

24 
LUAI_FUNC
 
TV®ue
 *
luaH_£t¡r
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
TSŒšg
 *
key
);

25 
LUAI_FUNC
 cÚ¡ 
TV®ue
 *
luaH_g‘
 (
TabË
 *
t
, cÚ¡ TV®u*
key
);

26 
LUAI_FUNC
 
TV®ue
 *
luaH_£t
 (
lua_S‹
 *
L
, 
TabË
 *
t
, cÚ¡ TV®u*
key
);

27 
LUAI_FUNC
 
TabË
 *
luaH_Ãw
 (
lua_S‹
 *
L
, 
Ç¼ay
, 
Êhash
);

28 
LUAI_FUNC
 
luaH_»siz—¼ay
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
Çsize
);

29 
LUAI_FUNC
 
luaH_ä“
 (
lua_S‹
 *
L
, 
TabË
 *
t
);

30 
LUAI_FUNC
 
luaH_Ãxt
 (
lua_S‹
 *
L
, 
TabË
 *
t
, 
StkId
 
key
);

31 
LUAI_FUNC
 
luaH_g‘n
 (
TabË
 *
t
);

34 #ià
defšed
(
LUA_DEBUG
)

35 
LUAI_FUNC
 
Node
 *
luaH_mašpos™iÚ
 (cÚ¡ 
TabË
 *
t
, cÚ¡ 
TV®ue
 *
key
);

36 
LUAI_FUNC
 
luaH_isdummy
 (
Node
 *
n
);

	@deps/lua/src/ltablib.c

8 
	~<¡ddef.h
>

10 
	#Éablib_c


	)

11 
	#LUA_LIB


	)

13 
	~"lua.h
"

15 
	~"Ïuxlib.h
"

16 
	~"lu®ib.h
"

19 
	#aux_g‘n
(
L
,
n
è(
	`luaL_checkty³
(L,‚, 
LUA_TTABLE
), 
	`luaL_g‘n
(L,‚))

	)

22 
	$fÜ—chi
 (
lua_S‹
 *
L
) {

23 
i
;

24 
n
 = 
	`aux_g‘n
(
L
, 1);

25 
	`luaL_checkty³
(
L
, 2, 
LUA_TFUNCTION
);

26 
i
=1; i <ğ
n
; i++) {

27 
	`lua_pushv®ue
(
L
, 2);

28 
	`lua_pushš‹g”
(
L
, 
i
);

29 
	`lua_¿wg‘i
(
L
, 1, 
i
);

30 
	`lua_ÿÎ
(
L
, 2, 1);

31 ià(!
	`lua_i¢
(
L
, -1))

33 
	`lua_pİ
(
L
, 1);

36 
	}
}

39 
	$fÜ—ch
 (
lua_S‹
 *
L
) {

40 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

41 
	`luaL_checkty³
(
L
, 2, 
LUA_TFUNCTION
);

42 
	`lua_pushn
(
L
);

43 
	`lua_Ãxt
(
L
, 1)) {

44 
	`lua_pushv®ue
(
L
, 2);

45 
	`lua_pushv®ue
(
L
, -3);

46 
	`lua_pushv®ue
(
L
, -3);

47 
	`lua_ÿÎ
(
L
, 2, 1);

48 ià(!
	`lua_i¢
(
L
, -1))

50 
	`lua_pİ
(
L
, 2);

53 
	}
}

56 
	$maxn
 (
lua_S‹
 *
L
) {

57 
lua_Numb”
 
max
 = 0;

58 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

59 
	`lua_pushn
(
L
);

60 
	`lua_Ãxt
(
L
, 1)) {

61 
	`lua_pİ
(
L
, 1);

62 ià(
	`lua_ty³
(
L
, -1è=ğ
LUA_TNUMBER
) {

63 
lua_Numb”
 
v
 = 
	`lua_tÚumb”
(
L
, -1);

64 ià(
v
 > 
max
) max = v;

67 
	`lua_pushnumb”
(
L
, 
max
);

69 
	}
}

72 
	$g‘n
 (
lua_S‹
 *
L
) {

73 
	`lua_pushš‹g”
(
L
, 
	`aux_g‘n
(L, 1));

75 
	}
}

78 
	$£Š
 (
lua_S‹
 *
L
) {

79 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

80 #iâdeà
luaL_£Š


81 
	`luaL_£Š
(
L
, 1, 
	`luaL_checkšt
(L, 2));

83 
	`luaL_”rÜ
(
L
, 
	`LUA_QL
("setn") " is obsolete");

85 
	`lua_pushv®ue
(
L
, 1);

87 
	}
}

90 
	$tš£¹
 (
lua_S‹
 *
L
) {

91 
e
 = 
	`aux_g‘n
(
L
, 1) + 1;

92 
pos
;

93 
	`lua_g‘tİ
(
L
)) {

95 
pos
 = 
e
;

99 
i
;

100 
pos
 = 
	`luaL_checkšt
(
L
, 2);

101 ià(
pos
 > 
e
)ƒ =…os;

102 
i
 = 
e
; i > 
pos
; i--) {

103 
	`lua_¿wg‘i
(
L
, 1, 
i
-1);

104 
	`lua_¿w£ti
(
L
, 1, 
i
);

109  
	`luaL_”rÜ
(
L
, "wrÚg‚umb” oà¬gum’t tØ" 
	`LUA_QL
("insert"));

112 
	`luaL_£Š
(
L
, 1, 
e
);

113 
	`lua_¿w£ti
(
L
, 1, 
pos
);

115 
	}
}

118 
	$Œemove
 (
lua_S‹
 *
L
) {

119 
e
 = 
	`aux_g‘n
(
L
, 1);

120 
pos
 = 
	`luaL_İtšt
(
L
, 2, 
e
);

121 ià(!(1 <ğ
pos
 &&…o <ğ
e
))

123 
	`luaL_£Š
(
L
, 1, 
e
 - 1);

124 
	`lua_¿wg‘i
(
L
, 1, 
pos
);

125  ;
pos
<
e
;…os++) {

126 
	`lua_¿wg‘i
(
L
, 1, 
pos
+1);

127 
	`lua_¿w£ti
(
L
, 1, 
pos
);

129 
	`lua_pushn
(
L
);

130 
	`lua_¿w£ti
(
L
, 1, 
e
);

132 
	}
}

135 
	$addf›ld
 (
lua_S‹
 *
L
, 
luaL_Bufãr
 *
b
, 
i
) {

136 
	`lua_¿wg‘i
(
L
, 1, 
i
);

137 ià(!
	`lua_is¡ršg
(
L
, -1))

138 
	`luaL_”rÜ
(
L
, "invalid value (%s)‡t index %d inable for "

139 
	`LUA_QL
("cÚÿt"), 
	`luaL_ty³Çme
(
L
, -1), 
i
);

140 
	`luaL_addv®ue
(
b
);

141 
	}
}

144 
	$tcÚÿt
 (
lua_S‹
 *
L
) {

145 
luaL_Bufãr
 
b
;

146 
size_t
 
l£p
;

147 
i
, 
Ï¡
;

148 cÚ¡ *
£p
 = 
	`luaL_İ¡ršg
(
L
, 2, "", &
l£p
);

149 
	`luaL_checkty³
(
L
, 1, 
LUA_TTABLE
);

150 
i
 = 
	`luaL_İtšt
(
L
, 3, 1);

151 
Ï¡
 = 
	`luaL_İt
(
L
, 
luaL_checkšt
, 4, 
	`luaL_g‘n
(L, 1));

152 
	`luaL_buffš™
(
L
, &
b
);

153 ; 
i
 < 
Ï¡
; i++) {

154 
	`addf›ld
(
L
, &
b
, 
i
);

155 
	`luaL_addl¡ršg
(&
b
, 
£p
, 
l£p
);

157 ià(
i
 =ğ
Ï¡
)

158 
	`addf›ld
(
L
, &
b
, 
i
);

159 
	`luaL_push»suÉ
(&
b
);

161 
	}
}

173 
	$£t2
 (
lua_S‹
 *
L
, 
i
, 
j
) {

174 
	`lua_¿w£ti
(
L
, 1, 
i
);

175 
	`lua_¿w£ti
(
L
, 1, 
j
);

176 
	}
}

178 
	$sÜt_comp
 (
lua_S‹
 *
L
, 
a
, 
b
) {

179 ià(!
	`lua_i¢
(
L
, 2)) {

180 
»s
;

181 
	`lua_pushv®ue
(
L
, 2);

182 
	`lua_pushv®ue
(
L
, 
a
-1);

183 
	`lua_pushv®ue
(
L
, 
b
-2);

184 
	`lua_ÿÎ
(
L
, 2, 1);

185 
»s
 = 
	`lua_toboŞ—n
(
L
, -1);

186 
	`lua_pİ
(
L
, 1);

187  
»s
;

190  
	`lua_Ës¡hª
(
L
, 
a
, 
b
);

191 
	}
}

193 
	$auxsÜt
 (
lua_S‹
 *
L
, 
l
, 
u
) {

194 
l
 < 
u
) {

195 
i
, 
j
;

197 
	`lua_¿wg‘i
(
L
, 1, 
l
);

198 
	`lua_¿wg‘i
(
L
, 1, 
u
);

199 ià(
	`sÜt_comp
(
L
, -1, -2))

200 
	`£t2
(
L
, 
l
, 
u
);

202 
	`lua_pİ
(
L
, 2);

203 ià(
u
-
l
 == 1) ;

204 
i
 = (
l
+
u
)/2;

205 
	`lua_¿wg‘i
(
L
, 1, 
i
);

206 
	`lua_¿wg‘i
(
L
, 1, 
l
);

207 ià(
	`sÜt_comp
(
L
, -2, -1))

208 
	`£t2
(
L
, 
i
, 
l
);

210 
	`lua_pİ
(
L
, 1);

211 
	`lua_¿wg‘i
(
L
, 1, 
u
);

212 ià(
	`sÜt_comp
(
L
, -1, -2))

213 
	`£t2
(
L
, 
i
, 
u
);

215 
	`lua_pİ
(
L
, 2);

217 ià(
u
-
l
 == 2) ;

218 
	`lua_¿wg‘i
(
L
, 1, 
i
);

219 
	`lua_pushv®ue
(
L
, -1);

220 
	`lua_¿wg‘i
(
L
, 1, 
u
-1);

221 
	`£t2
(
L
, 
i
, 
u
-1);

223 
i
 = 
l
; 
j
 = 
u
-1;

226 
	`lua_¿wg‘i
(
L
, 1, ++
i
), 
	`sÜt_comp
(L, -1, -2)) {

227 ià(
i
>
u
è
	`luaL_”rÜ
(
L
, "invalid order function for sorting");

228 
	`lua_pİ
(
L
, 1);

231 
	`lua_¿wg‘i
(
L
, 1, --
j
), 
	`sÜt_comp
(L, -3, -1)) {

232 ià(
j
<
l
è
	`luaL_”rÜ
(
L
, "invalid order function for sorting");

233 
	`lua_pİ
(
L
, 1);

235 ià(
j
<
i
) {

236 
	`lua_pİ
(
L
, 3);

239 
	`£t2
(
L
, 
i
, 
j
);

241 
	`lua_¿wg‘i
(
L
, 1, 
u
-1);

242 
	`lua_¿wg‘i
(
L
, 1, 
i
);

243 
	`£t2
(
L
, 
u
-1, 
i
);

246 ià(
i
-
l
 < 
u
-i) {

247 
j
=
l
; 
i
=i-1;†=i+2;

250 
j
=
i
+1; i=
u
; u=j-2;

252 
	`auxsÜt
(
L
, 
j
, 
i
);

254 
	}
}

256 
	$sÜt
 (
lua_S‹
 *
L
) {

257 
n
 = 
	`aux_g‘n
(
L
, 1);

258 
	`luaL_check¡ack
(
L
, 40, "");

259 ià(!
	`lua_i¢ÚeÜn
(
L
, 2))

260 
	`luaL_checkty³
(
L
, 2, 
LUA_TFUNCTION
);

261 
	`lua_£‰İ
(
L
, 2);

262 
	`auxsÜt
(
L
, 1, 
n
);

264 
	}
}

269 cÚ¡ 
luaL_Reg
 
	gb_funcs
[] = {

270 {"cÚÿt", 
tcÚÿt
},

271 {"fÜ—ch", 
fÜ—ch
},

272 {"fÜ—chi", 
fÜ—chi
},

273 {"g‘n", 
g‘n
},

274 {"maxn", 
maxn
},

275 {"š£¹", 
tš£¹
},

276 {"»move", 
Œemove
},

277 {"£Š", 
£Š
},

278 {"sÜt", 
sÜt
},

279 {
NULL
, NULL}

283 
LUALIB_API
 
	$luaİ’_bË
 (
lua_S‹
 *
L
) {

284 
	`luaL_»gi¡”
(
L
, 
LUA_TABLIBNAME
, 
b_funcs
);

286 
	}
}

	@deps/lua/src/ltm.c

8 
	~<¡ršg.h
>

10 
	#Ém_c


	)

11 
	#LUA_CORE


	)

13 
	~"lua.h
"

15 
	~"lobjeù.h
"

16 
	~"l¡©e.h
"

17 
	~"l¡ršg.h
"

18 
	~"ÉabË.h
"

19 
	~"Ém.h
"

23 cÚ¡ *cÚ¡ 
	gluaT_ty³Çmes
[] = {

30 
	$luaT_š™
 (
lua_S‹
 *
L
) {

31 cÚ¡ *cÚ¡ 
luaT_ev’Šame
[] = {

38 
i
;

39 
i
=0; i<
TM_N
; i++) {

40 
	`G
(
L
)->
tmÇme
[
i
] = 
	`luaS_Ãw
(L, 
luaT_ev’Šame
[i]);

41 
	`luaS_fix
(
	`G
(
L
)->
tmÇme
[
i
]);

43 
	}
}

50 cÚ¡ 
TV®ue
 *
	$luaT_g‘tm
 (
TabË
 *
ev’ts
, 
TMS
 
ev’t
, 
TSŒšg
 *
’ame
) {

51 cÚ¡ 
TV®ue
 *
tm
 = 
	`luaH_g‘¡r
(
ev’ts
, 
’ame
);

52 
	`lua_as£¹
(
ev’t
 <ğ
TM_EQ
);

53 ià(
	`‰i¢
(
tm
)) {

54 
ev’ts
->
æags
 |ğ
	`ÿ¡_by‹
(1u<<
ev’t
);

55  
NULL
;

57  
tm
;

58 
	}
}

61 cÚ¡ 
TV®ue
 *
	$luaT_g‘tmbyobj
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
o
, 
TMS
 
ev’t
) {

62 
TabË
 *
mt
;

63 
	`‰y³
(
o
)) {

64 
LUA_TTABLE
:

65 
mt
 = 
	`hv®ue
(
o
)->
m‘©abË
;

67 
LUA_TUSERDATA
:

68 
mt
 = 
	`uv®ue
(
o
)->
m‘©abË
;

71 
mt
 = 
	`G
(
L
)->mt[
	`‰y³
(
o
)];

73  (
mt
 ? 
	`luaH_g‘¡r
(mt, 
	`G
(
L
)->
tmÇme
[
ev’t
]è: 
luaO_nobjeù
);

74 
	}
}

	@deps/lua/src/ltm.h

7 #iâdeà
Ém_h


8 
	#Ém_h


	)

11 
	~"lobjeù.h
"

19 
	mTM_INDEX
,

20 
	mTM_NEWINDEX
,

21 
	mTM_GC
,

22 
	mTM_MODE
,

23 
	mTM_EQ
,

24 
	mTM_ADD
,

25 
	mTM_SUB
,

26 
	mTM_MUL
,

27 
	mTM_DIV
,

28 
	mTM_MOD
,

29 
	mTM_POW
,

30 
	mTM_UNM
,

31 
	mTM_LEN
,

32 
	mTM_LT
,

33 
	mTM_LE
,

34 
	mTM_CONCAT
,

35 
	mTM_CALL
,

36 
	mTM_N


37 } 
	tTMS
;

41 
	#gç¡tm
(
g
,
‘
,
e
è(Ótè=ğ
NULL
 ? NULL : \

42 ((
‘
)->
æags
 & (1u<<(
e
))è? 
NULL
 : 
	`luaT_g‘tm
Ót,ƒ, (
g
)->
tmÇme
[e]))

	)

44 
	#ç¡tm
(
l
,
‘
,
e
è
	`gç¡tm
(
	`G
Ö),ƒt,ƒ)

	)

46 
LUAI_DATA
 cÚ¡ *cÚ¡ 
	gluaT_ty³Çmes
[];

49 
LUAI_FUNC
 cÚ¡ 
TV®ue
 *
luaT_g‘tm
 (
TabË
 *
ev’ts
, 
TMS
 
ev’t
, 
TSŒšg
 *
’ame
);

50 
LUAI_FUNC
 cÚ¡ 
TV®ue
 *
luaT_g‘tmbyobj
 (
lua_S‹
 *
L
, cÚ¡ TV®u*
o
,

51 
TMS
 
ev’t
);

52 
LUAI_FUNC
 
luaT_š™
 (
lua_S‹
 *
L
);

	@deps/lua/src/lua.c

8 
	~<sigÇl.h
>

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

11 
	~<¡ršg.h
>

13 
	#lua_c


	)

15 
	~"lua.h
"

17 
	~"Ïuxlib.h
"

18 
	~"lu®ib.h
"

22 
lua_S‹
 *
	gglob®L
 = 
NULL
;

24 cÚ¡ *
	g´ogÇme
 = 
LUA_PROGNAME
;

28 
	$l¡İ
 (
lua_S‹
 *
L
, 
lua_Debug
 *
¬
) {

29 ()
¬
;

30 
	`lua_£thook
(
L
, 
NULL
, 0, 0);

31 
	`luaL_”rÜ
(
L
, "interrupted!");

32 
	}
}

35 
	$ÏùiÚ
 (
i
) {

36 
	`sigÇl
(
i
, 
SIG_DFL
);

38 
	`lua_£thook
(
glob®L
, 
l¡İ
, 
LUA_MASKCALL
 | 
LUA_MASKRET
 | 
LUA_MASKCOUNT
, 1);

39 
	}
}

42 
	$´št_u§ge
 () {

43 
	`årštf
(
¡d”r
,

46 " -¡©ƒxecu‹ sŒšg " 
	`LUA_QL
("stat") "\n"

47 " -ÈÇm„equœlib¿ry " 
	`LUA_QL
("name") "\n"

48 " -˜ƒÁ” iÁ”aùivmodaá”ƒxecutšg " 
	`LUA_QL
("script") "\n"

53 
´ogÇme
);

54 
	`fæush
(
¡d”r
);

55 
	}
}

58 
	$l_mes§ge
 (cÚ¡ *
²ame
, cÚ¡ *
msg
) {

59 ià(
²ame
è
	`årštf
(
¡d”r
, "%s: ",…name);

60 
	`årštf
(
¡d”r
, "%s\n", 
msg
);

61 
	`fæush
(
¡d”r
);

62 
	}
}

65 
	$»pÜt
 (
lua_S‹
 *
L
, 
¡©us
) {

66 ià(
¡©us
 && !
	`lua_i¢
(
L
, -1)) {

67 cÚ¡ *
msg
 = 
	`lua_to¡ršg
(
L
, -1);

68 ià(
msg
 =ğ
NULL
) msg = "(error object is‚ot‡ string)";

69 
	`l_mes§ge
(
´ogÇme
, 
msg
);

70 
	`lua_pİ
(
L
, 1);

72  
¡©us
;

73 
	}
}

76 
	$Œaûback
 (
lua_S‹
 *
L
) {

77 ià(!
	`lua_is¡ršg
(
L
, 1))

79 
	`lua_g‘f›ld
(
L
, 
LUA_GLOBALSINDEX
, "debug");

80 ià(!
	`lua_i¡abË
(
L
, -1)) {

81 
	`lua_pİ
(
L
, 1);

84 
	`lua_g‘f›ld
(
L
, -1, "traceback");

85 ià(!
	`lua_isfunùiÚ
(
L
, -1)) {

86 
	`lua_pİ
(
L
, 2);

89 
	`lua_pushv®ue
(
L
, 1);

90 
	`lua_pushš‹g”
(
L
, 2);

91 
	`lua_ÿÎ
(
L
, 2, 1);

93 
	}
}

96 
	$doÿÎ
 (
lua_S‹
 *
L
, 
Çrg
, 
ş—r
) {

97 
¡©us
;

98 
ba£
 = 
	`lua_g‘tİ
(
L
è- 
Çrg
;

99 
	`lua_pushcfunùiÚ
(
L
, 
Œaûback
);

100 
	`lua_š£¹
(
L
, 
ba£
);

101 
	`sigÇl
(
SIGINT
, 
ÏùiÚ
);

102 
¡©us
 = 
	`lua_pÿÎ
(
L
, 
Çrg
, (
ş—r
 ? 0 : 
LUA_MULTRET
), 
ba£
);

103 
	`sigÇl
(
SIGINT
, 
SIG_DFL
);

104 
	`lua_»move
(
L
, 
ba£
);

106 ià(
¡©us
 !ğ0è
	`lua_gc
(
L
, 
LUA_GCCOLLECT
, 0);

107  
¡©us
;

108 
	}
}

111 
	$´št_v”siÚ
 () {

112 
	`l_mes§ge
(
NULL
, 
LUA_RELEASE
 " " 
LUA_COPYRIGHT
);

113 
	}
}

116 
	$g‘¬gs
 (
lua_S‹
 *
L
, **
¬gv
, 
n
) {

117 
Çrg
;

118 
i
;

119 
¬gc
 = 0;

120 
¬gv
[
¬gc
])‡rgc++;

121 
Çrg
 = 
¬gc
 - (
n
 + 1);

122 
	`luaL_check¡ack
(
L
, 
Çrg
 + 3, "too many‡rgumentso script");

123 
i
=
n
+1; i < 
¬gc
; i++)

124 
	`lua_push¡ršg
(
L
, 
¬gv
[
i
]);

125 
	`lua_ü—‹bË
(
L
, 
Çrg
, 
n
 + 1);

126 
i
=0; i < 
¬gc
; i++) {

127 
	`lua_push¡ršg
(
L
, 
¬gv
[
i
]);

128 
	`lua_¿w£ti
(
L
, -2, 
i
 - 
n
);

130  
Çrg
;

131 
	}
}

134 
	$dofe
 (
lua_S‹
 *
L
, cÚ¡ *
Çme
) {

135 
¡©us
 = 
	`luaL_lßdfe
(
L
, 
Çme
è|| 
	`doÿÎ
(L, 0, 1);

136  
	`»pÜt
(
L
, 
¡©us
);

137 
	}
}

140 
	$do¡ršg
 (
lua_S‹
 *
L
, cÚ¡ *
s
, cÚ¡ *
Çme
) {

141 
¡©us
 = 
	`luaL_lßdbufãr
(
L
, 
s
, 
	`¡¾’
(s), 
Çme
è|| 
	`doÿÎ
(L, 0, 1);

142  
	`»pÜt
(
L
, 
¡©us
);

143 
	}
}

146 
	$dŞib¿ry
 (
lua_S‹
 *
L
, cÚ¡ *
Çme
) {

147 
	`lua_g‘glob®
(
L
, "require");

148 
	`lua_push¡ršg
(
L
, 
Çme
);

149  
	`»pÜt
(
L
, 
	`doÿÎ
(L, 1, 1));

150 
	}
}

153 cÚ¡ *
	$g‘_´om±
 (
lua_S‹
 *
L
, 
fœ¡lše
) {

154 cÚ¡ *
p
;

155 
	`lua_g‘f›ld
(
L
, 
LUA_GLOBALSINDEX
, 
fœ¡lše
 ? "_PROMPT" : "_PROMPT2");

156 
p
 = 
	`lua_to¡ršg
(
L
, -1);

157 ià(
p
 =ğ
NULL
è°ğ(
fœ¡lše
 ? 
LUA_PROMPT
 : 
LUA_PROMPT2
);

158 
	`lua_pİ
(
L
, 1);

159  
p
;

160 
	}
}

163 
	$šcom¶‘e
 (
lua_S‹
 *
L
, 
¡©us
) {

164 ià(
¡©us
 =ğ
LUA_ERRSYNTAX
) {

165 
size_t
 
lmsg
;

166 cÚ¡ *
msg
 = 
	`lua_tŞ¡ršg
(
L
, -1, &
lmsg
);

167 cÚ¡ *

 = 
msg
 + 
lmsg
 - ((
	`LUA_QL
("<eof>")) - 1);

168 ià(
	`¡r¡r
(
msg
, 
	`LUA_QL
("<eof>")è=ğ

) {

169 
	`lua_pİ
(
L
, 1);

174 
	}
}

177 
	$pushlše
 (
lua_S‹
 *
L
, 
fœ¡lše
) {

178 
bufãr
[
LUA_MAXINPUT
];

179 *
b
 = 
bufãr
;

180 
size_t
 
l
;

181 cÚ¡ *
´mt
 = 
	`g‘_´om±
(
L
, 
fœ¡lše
);

182 ià(
	`lua_»adlše
(
L
, 
b
, 
´mt
) == 0)

184 
l
 = 
	`¡¾’
(
b
);

185 ià(
l
 > 0 && 
b
[l-1] == '\n')

186 
b
[
l
-1] = '\0';

187 ià(
fœ¡lše
 && 
b
[0] == '=')

188 
	`lua_pushf¡ršg
(
L
, "»tuº %s", 
b
+1);

190 
	`lua_push¡ršg
(
L
, 
b
);

191 
	`lua_ä“lše
(
L
, 
b
);

193 
	}
}

196 
	$lßdlše
 (
lua_S‹
 *
L
) {

197 
¡©us
;

198 
	`lua_£‰İ
(
L
, 0);

199 ià(!
	`pushlše
(
L
, 1))

202 
¡©us
 = 
	`luaL_lßdbufãr
(
L
, 
	`lua_to¡ršg
(L, 1), 
	`lua_¡¾’
(L, 1), "=stdin");

203 ià(!
	`šcom¶‘e
(
L
, 
¡©us
)) ;

204 ià(!
	`pushlše
(
L
, 0))

206 
	`lua_pushl™”®
(
L
, "\n");

207 
	`lua_š£¹
(
L
, -2);

208 
	`lua_cÚÿt
(
L
, 3);

210 
	`lua_§v–še
(
L
, 1);

211 
	`lua_»move
(
L
, 1);

212  
¡©us
;

213 
	}
}

216 
	$dÙty
 (
lua_S‹
 *
L
) {

217 
¡©us
;

218 cÚ¡ *
Şd´ogÇme
 = 
´ogÇme
;

219 
´ogÇme
 = 
NULL
;

220 (
¡©us
 = 
	`lßdlše
(
L
)) != -1) {

221 ià(
¡©us
 =ğ0è¡©u ğ
	`doÿÎ
(
L
, 0, 0);

222 
	`»pÜt
(
L
, 
¡©us
);

223 ià(
¡©us
 =ğ0 && 
	`lua_g‘tİ
(
L
) > 0) {

224 
	`lua_g‘glob®
(
L
, "print");

225 
	`lua_š£¹
(
L
, 1);

226 ià(
	`lua_pÿÎ
(
L
, 
	`lua_g‘tİ
(L)-1, 0, 0) != 0)

227 
	`l_mes§ge
(
´ogÇme
, 
	`lua_pushf¡ršg
(
L
,

228 "”rÜ c®lšg " 
	`LUA_QL
("print") " (%s)",

229 
	`lua_to¡ršg
(
L
, -1)));

232 
	`lua_£‰İ
(
L
, 0);

233 
	`åuts
("\n", 
¡dout
);

234 
	`fæush
(
¡dout
);

235 
´ogÇme
 = 
Şd´ogÇme
;

236 
	}
}

239 
	$hªdË_süt
 (
lua_S‹
 *
L
, **
¬gv
, 
n
) {

240 
¡©us
;

241 cÚ¡ *
âame
;

242 
Çrg
 = 
	`g‘¬gs
(
L
, 
¬gv
, 
n
);

243 
	`lua_£tglob®
(
L
, "arg");

244 
âame
 = 
¬gv
[
n
];

245 ià(
	`¡rcmp
(
âame
, "-"è=ğ0 && sŒcmp(
¬gv
[
n
-1], "--") != 0)

246 
âame
 = 
NULL
;

247 
¡©us
 = 
	`luaL_lßdfe
(
L
, 
âame
);

248 
	`lua_š£¹
(
L
, -(
Çrg
+1));

249 ià(
¡©us
 == 0)

250 
¡©us
 = 
	`doÿÎ
(
L
, 
Çrg
, 0);

252 
	`lua_pİ
(
L
, 
Çrg
);

253  
	`»pÜt
(
L
, 
¡©us
);

254 
	}
}

258 
	#nÙa
(
x
è{ià((x)[2] !ğ'\0'è -1;}

	)

261 
	$cŞËù¬gs
 (**
¬gv
, *
pi
, *
pv
, *
³
) {

262 
i
;

263 
i
 = 1; 
¬gv
[i] !ğ
NULL
; i++) {

264 ià(
¬gv
[
i
][0] != '-')

265  
i
;

266 
¬gv
[
i
][1]) {

268 
	`nÙa
(
¬gv
[
i
]);

269  (
¬gv
[
i
+1] !ğ
NULL
 ? i+1 : 0);

271  
i
;

273 
	`nÙa
(
¬gv
[
i
]);

274 *
pi
 = 1;

276 
	`nÙa
(
¬gv
[
i
]);

277 *
pv
 = 1;

280 *
³
 = 1;

282 ià(
¬gv
[
i
][2] == '\0') {

283 
i
++;

284 ià(
¬gv
[
i
] =ğ
NULL
)  -1;

291 
	}
}

294 
	$ruÇrgs
 (
lua_S‹
 *
L
, **
¬gv
, 
n
) {

295 
i
;

296 
i
 = 1; i < 
n
; i++) {

297 ià(
¬gv
[
i
] =ğ
NULL
) ;

298 
	`lua_as£¹
(
¬gv
[
i
][0] == '-');

299 
¬gv
[
i
][1]) {

301 cÚ¡ *
chunk
 = 
¬gv
[
i
] + 2;

302 ià(*
chunk
 =ğ'\0'èchunk = 
¬gv
[++
i
];

303 
	`lua_as£¹
(
chunk
 !ğ
NULL
);

304 ià(
	`do¡ršg
(
L
, 
chunk
, "=(command†ine)") != 0)

309 cÚ¡ *
f’ame
 = 
¬gv
[
i
] + 2;

310 ià(*
f’ame
 =ğ'\0'èf’amğ
¬gv
[++
i
];

311 
	`lua_as£¹
(
f’ame
 !ğ
NULL
);

312 ià(
	`dŞib¿ry
(
L
, 
f’ame
))

320 
	}
}

323 
	$hªdË_luaš™
 (
lua_S‹
 *
L
) {

324 cÚ¡ *
š™
 = 
	`g‘’v
(
LUA_INIT
);

325 ià(
š™
 =ğ
NULL
)  0;

326 ià(
š™
[0] == '@')

327  
	`dofe
(
L
, 
š™
+1);

329  
	`do¡ršg
(
L
, 
š™
, "=" 
LUA_INIT
);

330 
	}
}

333 
	sSmaš
 {

334 
	m¬gc
;

335 **
	m¬gv
;

336 
	m¡©us
;

340 
	$pmaš
 (
lua_S‹
 *
L
) {

341 
Smaš
 *
s
 = (Smaš *)
	`lua_tou£rd©a
(
L
, 1);

342 **
¬gv
 = 
s
->argv;

343 
süt
;

344 
has_i
 = 0, 
has_v
 = 0, 
has_e
 = 0;

345 
glob®L
 = 
L
;

346 ià(
¬gv
[0] &&‡rgv[0][0]è
´ogÇme
 =‡rgv[0];

347 
	`lua_gc
(
L
, 
LUA_GCSTOP
, 0);

348 
	`luaL_İ’libs
(
L
);

349 
	`lua_gc
(
L
, 
LUA_GCRESTART
, 0);

350 
s
->
¡©us
 = 
	`hªdË_luaš™
(
L
);

351 ià(
s
->
¡©us
 != 0)  0;

352 
süt
 = 
	`cŞËù¬gs
(
¬gv
, &
has_i
, &
has_v
, &
has_e
);

353 ià(
süt
 < 0) {

354 
	`´št_u§ge
();

355 
s
->
¡©us
 = 1;

358 ià(
has_v
è
	`´št_v”siÚ
();

359 
s
->
¡©us
 = 
	`ruÇrgs
(
L
, 
¬gv
, (
süt
 > 0è? süˆ: s->
¬gc
);

360 ià(
s
->
¡©us
 != 0)  0;

361 ià(
süt
)

362 
s
->
¡©us
 = 
	`hªdË_süt
(
L
, 
¬gv
, 
süt
);

363 ià(
s
->
¡©us
 != 0)  0;

364 ià(
has_i
)

365 
	`dÙty
(
L
);

366 ià(
süt
 =ğ0 && !
has_e
 && !
has_v
) {

367 ià(
	`lua_¡dš_is_‰y
()) {

368 
	`´št_v”siÚ
();

369 
	`dÙty
(
L
);

371 
	`dofe
(
L
, 
NULL
);

374 
	}
}

377 
	$maš
 (
¬gc
, **
¬gv
) {

378 
¡©us
;

379 
Smaš
 
s
;

380 
lua_S‹
 *
L
 = 
	`lua_İ’
();

381 ià(
L
 =ğ
NULL
) {

382 
	`l_mes§ge
(
¬gv
[0], "cannot create state:‚otƒnough memory");

383  
EXIT_FAILURE
;

385 
s
.
¬gc
 =‡rgc;

386 
s
.
¬gv
 =‡rgv;

387 
¡©us
 = 
	`lua_ıÿÎ
(
L
, &
pmaš
, &
s
);

388 
	`»pÜt
(
L
, 
¡©us
);

389 
	`lua_şo£
(
L
);

390  (
¡©us
 || 
s
.¡©usè? 
EXIT_FAILURE
 : 
EXIT_SUCCESS
;

391 
	}
}

	@deps/lua/src/lua.h

9 #iâdeà
lua_h


10 
	#lua_h


	)

12 
	~<¡d¬g.h
>

13 
	~<¡ddef.h
>

16 
	~"luacÚf.h
"

19 
	#LUA_VERSION
 "Lu¨5.1"

	)

20 
	#LUA_RELEASE
 "Lu¨5.1.5"

	)

21 
	#LUA_VERSION_NUM
 501

	)

22 
	#LUA_COPYRIGHT
 "Cİyrighˆ(Cè1994-2012 Lua.Üg, PUC-Rio"

	)

23 
	#LUA_AUTHORS
 "R. I”u§limschy, L. H. dFigueœedØ& W. C–es"

	)

27 
	#LUA_SIGNATURE
 "\033Lua"

	)

30 
	#LUA_MULTRET
 (-1)

	)

36 
	#LUA_REGISTRYINDEX
 (-10000)

	)

37 
	#LUA_ENVIRONINDEX
 (-10001)

	)

38 
	#LUA_GLOBALSINDEX
 (-10002)

	)

39 
	#lua_upv®uešdex
(
i
è(
LUA_GLOBALSINDEX
-(i))

	)

43 
	#LUA_YIELD
 1

	)

44 
	#LUA_ERRRUN
 2

	)

45 
	#LUA_ERRSYNTAX
 3

	)

46 
	#LUA_ERRMEM
 4

	)

47 
	#LUA_ERRERR
 5

	)

50 
lua_S‹
 
	tlua_S‹
;

52 (*
	tlua_CFunùiÚ
è(
	tlua_S‹
 *
	tL
);

58 cÚ¡ * (*
	tlua_R—d”
è(
	tlua_S‹
 *
	tL
, *
	tud
, 
	tsize_t
 *
	tsz
);

60 (*
	tlua_Wr™”
è(
	tlua_S‹
 *
	tL
, cÚ¡ * 
	tp
, 
	tsize_t
 
	tsz
, * 
	tud
);

66 * (*
	tlua_AÎoc
è(*
	tud
, *
	t±r
, 
	tsize_t
 
	tosize
, size_ˆ
	tnsize
);

72 
	#LUA_TNONE
 (-1)

	)

74 
	#LUA_TNIL
 0

	)

75 
	#LUA_TBOOLEAN
 1

	)

76 
	#LUA_TLIGHTUSERDATA
 2

	)

77 
	#LUA_TNUMBER
 3

	)

78 
	#LUA_TSTRING
 4

	)

79 
	#LUA_TTABLE
 5

	)

80 
	#LUA_TFUNCTION
 6

	)

81 
	#LUA_TUSERDATA
 7

	)

82 
	#LUA_TTHREAD
 8

	)

87 
	#LUA_MINSTACK
 20

	)

93 #ià
	`defšed
(
LUA_USER_H
)

94 #šşud
LUA_USER_H


99 
LUA_NUMBER
 
	tlua_Numb”
;

103 
LUA_INTEGER
 
	tlua_IÁeg”
;

110 
LUA_API
 
lua_S‹
 *(
lua_Ãw¡©e
è(
lua_AÎoc
 
f
, *
ud
);

111 
LUA_API
 (
lua_şo£
è(
lua_S‹
 *
L
);

112 
LUA_API
 
lua_S‹
 *(
lua_Ãwth»ad
èÖua_S‹ *
L
);

114 
LUA_API
 
	$lua_CFunùiÚ
 (
lua_©·nic
è(
lua_S‹
 *
L
, 
lua_CFunùiÚ
 
·nicf
);

120 
LUA_API
 (
lua_g‘tİ
è(
lua_S‹
 *
L
);

121 
LUA_API
 (
lua_£‰İ
è(
lua_S‹
 *
L
, 
idx
);

122 
LUA_API
 (
lua_pushv®ue
è(
lua_S‹
 *
L
, 
idx
);

123 
LUA_API
 (
lua_»move
è(
lua_S‹
 *
L
, 
idx
);

124 
LUA_API
 (
lua_š£¹
è(
lua_S‹
 *
L
, 
idx
);

125 
LUA_API
 (
lua_»¶aû
è(
lua_S‹
 *
L
, 
idx
);

126 
LUA_API
 (
lua_check¡ack
è(
lua_S‹
 *
L
, 
sz
);

128 
LUA_API
 (
lua_xmove
è(
lua_S‹
 *
äom
,†ua_S‹ *
to
, 
n
);

135 
LUA_API
 (
lua_i¢umb”
è(
lua_S‹
 *
L
, 
idx
);

136 
LUA_API
 (
lua_is¡ršg
è(
lua_S‹
 *
L
, 
idx
);

137 
LUA_API
 (
lua_iscfunùiÚ
è(
lua_S‹
 *
L
, 
idx
);

138 
LUA_API
 (
lua_isu£rd©a
è(
lua_S‹
 *
L
, 
idx
);

139 
LUA_API
 (
lua_ty³
è(
lua_S‹
 *
L
, 
idx
);

140 
LUA_API
 cÚ¡ *(
lua_ty³Çme
è(
lua_S‹
 *
L
, 

);

142 
LUA_API
 (
lua_equ®
è(
lua_S‹
 *
L
, 
idx1
, 
idx2
);

143 
LUA_API
 (
lua_¿wequ®
è(
lua_S‹
 *
L
, 
idx1
, 
idx2
);

144 
LUA_API
 (
lua_Ës¡hª
è(
lua_S‹
 *
L
, 
idx1
, 
idx2
);

146 
LUA_API
 
	$lua_Numb”
 (
lua_tÚumb”
è(
lua_S‹
 *
L
, 
idx
);

147 
LUA_API
 
	$lua_IÁeg”
 (
lua_toš‹g”
è(
lua_S‹
 *
L
, 
idx
);

148 
LUA_API
 (
lua_toboŞ—n
è(
lua_S‹
 *
L
, 
idx
);

149 
LUA_API
 cÚ¡ *(
lua_tŞ¡ršg
è(
lua_S‹
 *
L
, 
idx
, 
size_t
 *
Ën
);

150 
LUA_API
 
	$size_t
 (
lua_objËn
è(
lua_S‹
 *
L
, 
idx
);

151 
LUA_API
 
	$lua_CFunùiÚ
 (
lua_tocfunùiÚ
è(
lua_S‹
 *
L
, 
idx
);

152 
LUA_API
 *(
lua_tou£rd©a
è(
lua_S‹
 *
L
, 
idx
);

153 
LUA_API
 
lua_S‹
 *(
lua_tÙh»ad
èÖua_S‹ *
L
, 
idx
);

154 
LUA_API
 cÚ¡ *(
lua_tİoš‹r
è(
lua_S‹
 *
L
, 
idx
);

160 
LUA_API
 (
lua_pushn
è(
lua_S‹
 *
L
);

161 
LUA_API
 (
lua_pushnumb”
è(
lua_S‹
 *
L
, 
lua_Numb”
 
n
);

162 
LUA_API
 (
lua_pushš‹g”
è(
lua_S‹
 *
L
, 
lua_IÁeg”
 
n
);

163 
LUA_API
 (
lua_pushl¡ršg
è(
lua_S‹
 *
L
, cÚ¡ *
s
, 
size_t
 
l
);

164 
LUA_API
 (
lua_push¡ršg
è(
lua_S‹
 *
L
, cÚ¡ *
s
);

165 
LUA_API
 cÚ¡ *(
lua_pushvf¡ršg
è(
lua_S‹
 *
L
, cÚ¡ *
fmt
,

166 
va_li¡
 
¬gp
);

167 
LUA_API
 cÚ¡ *(
lua_pushf¡ršg
è(
lua_S‹
 *
L
, cÚ¡ *
fmt
, ...);

168 
LUA_API
 (
lua_pushcşosu»
è(
lua_S‹
 *
L
, 
lua_CFunùiÚ
 
â
, 
n
);

169 
LUA_API
 (
lua_pushboŞ—n
è(
lua_S‹
 *
L
, 
b
);

170 
LUA_API
 (
lua_pushlightu£rd©a
è(
lua_S‹
 *
L
, *
p
);

171 
LUA_API
 (
lua_pushth»ad
è(
lua_S‹
 *
L
);

177 
LUA_API
 (
lua_g‘bË
è(
lua_S‹
 *
L
, 
idx
);

178 
LUA_API
 (
lua_g‘f›ld
è(
lua_S‹
 *
L
, 
idx
, cÚ¡ *
k
);

179 
LUA_API
 (
lua_¿wg‘
è(
lua_S‹
 *
L
, 
idx
);

180 
LUA_API
 (
lua_¿wg‘i
è(
lua_S‹
 *
L
, 
idx
, 
n
);

181 
LUA_API
 (
lua_ü—‹bË
è(
lua_S‹
 *
L
, 
Ç¼
, 
Äec
);

182 
LUA_API
 *(
lua_Ãwu£rd©a
è(
lua_S‹
 *
L
, 
size_t
 
sz
);

183 
LUA_API
 (
lua_g‘m‘©abË
è(
lua_S‹
 *
L
, 
objšdex
);

184 
LUA_API
 (
lua_g‘ãnv
è(
lua_S‹
 *
L
, 
idx
);

190 
LUA_API
 (
lua_£‰abË
è(
lua_S‹
 *
L
, 
idx
);

191 
LUA_API
 (
lua_£tf›ld
è(
lua_S‹
 *
L
, 
idx
, cÚ¡ *
k
);

192 
LUA_API
 (
lua_¿w£t
è(
lua_S‹
 *
L
, 
idx
);

193 
LUA_API
 (
lua_¿w£ti
è(
lua_S‹
 *
L
, 
idx
, 
n
);

194 
LUA_API
 (
lua_£tm‘©abË
è(
lua_S‹
 *
L
, 
objšdex
);

195 
LUA_API
 (
lua_£tãnv
è(
lua_S‹
 *
L
, 
idx
);

201 
LUA_API
 (
lua_ÿÎ
è(
lua_S‹
 *
L
, 
Çrgs
, 
ÄesuÉs
);

202 
LUA_API
 (
lua_pÿÎ
è(
lua_S‹
 *
L
, 
Çrgs
, 
ÄesuÉs
, 
”rfunc
);

203 
LUA_API
 (
lua_ıÿÎ
è(
lua_S‹
 *
L
, 
lua_CFunùiÚ
 
func
, *
ud
);

204 
LUA_API
 (
lua_lßd
è(
lua_S‹
 *
L
, 
lua_R—d”
 
»ad”
, *
dt
,

205 cÚ¡ *
chunkÇme
);

207 
LUA_API
 (
lua_dump
è(
lua_S‹
 *
L
, 
lua_Wr™”
 
wr™”
, *
d©a
);

213 
LUA_API
 (
lua_y›ld
è(
lua_S‹
 *
L
, 
ÄesuÉs
);

214 
LUA_API
 (
lua_»sume
è(
lua_S‹
 *
L
, 
Çrg
);

215 
LUA_API
 (
lua_¡©us
è(
lua_S‹
 *
L
);

221 
	#LUA_GCSTOP
 0

	)

222 
	#LUA_GCRESTART
 1

	)

223 
	#LUA_GCCOLLECT
 2

	)

224 
	#LUA_GCCOUNT
 3

	)

225 
	#LUA_GCCOUNTB
 4

	)

226 
	#LUA_GCSTEP
 5

	)

227 
	#LUA_GCSETPAUSE
 6

	)

228 
	#LUA_GCSETSTEPMUL
 7

	)

230 
LUA_API
 (
lua_gc
è(
lua_S‹
 *
L
, 
wh©
, 
d©a
);

237 
LUA_API
 (
lua_”rÜ
è(
lua_S‹
 *
L
);

239 
LUA_API
 (
lua_Ãxt
è(
lua_S‹
 *
L
, 
idx
);

241 
LUA_API
 (
lua_cÚÿt
è(
lua_S‹
 *
L
, 
n
);

243 
LUA_API
 
	$lua_AÎoc
 (
lua_g‘®locf
è(
lua_S‹
 *
L
, **
ud
);

244 
LUA_API
 
	`lua_£Îocf
 (
lua_S‹
 *
L
, 
lua_AÎoc
 
f
, *
ud
);

254 
	#lua_pİ
(
L
,
n
è
	`lua_£‰İ
(L, -Ò)-1)

	)

256 
	#lua_ÃwbË
(
L
è
	`lua_ü—‹bË
(L, 0, 0)

	)

258 
	#lua_»gi¡”
(
L
,
n
,
f
è(
	`lua_pushcfunùiÚ
(L, (f)), 
	`lua_£tglob®
(L, (n)))

	)

260 
	#lua_pushcfunùiÚ
(
L
,
f
è
	`lua_pushcşosu»
(L, (f), 0)

	)

262 
	#lua_¡¾’
(
L
,
i
è
	`lua_objËn
(L, (i))

	)

264 
	#lua_isfunùiÚ
(
L
,
n
è(
	`lua_ty³
(L, (n)è=ğ
LUA_TFUNCTION
)

	)

265 
	#lua_i¡abË
(
L
,
n
è(
	`lua_ty³
(L, (n)è=ğ
LUA_TTABLE
)

	)

266 
	#lua_i¦ightu£rd©a
(
L
,
n
è(
	`lua_ty³
(L, (n)è=ğ
LUA_TLIGHTUSERDATA
)

	)

267 
	#lua_i¢
(
L
,
n
è(
	`lua_ty³
(L, (n)è=ğ
LUA_TNIL
)

	)

268 
	#lua_isboŞ—n
(
L
,
n
è(
	`lua_ty³
(L, (n)è=ğ
LUA_TBOOLEAN
)

	)

269 
	#lua_i¡h»ad
(
L
,
n
è(
	`lua_ty³
(L, (n)è=ğ
LUA_TTHREAD
)

	)

270 
	#lua_i¢Úe
(
L
,
n
è(
	`lua_ty³
(L, (n)è=ğ
LUA_TNONE
)

	)

271 
	#lua_i¢ÚeÜn
(
L
, 
n
è(
	`lua_ty³
(L, (n)è<ğ0)

	)

273 
	#lua_pushl™”®
(
L
, 
s
) \

274 
	`lua_pushl¡ršg
(
L
, "" 
s
, ((s)/())-1)

	)

276 
	#lua_£tglob®
(
L
,
s
è
	`lua_£tf›ld
(L, 
LUA_GLOBALSINDEX
, (s))

	)

277 
	#lua_g‘glob®
(
L
,
s
è
	`lua_g‘f›ld
(L, 
LUA_GLOBALSINDEX
, (s))

	)

279 
	#lua_to¡ršg
(
L
,
i
è
	`lua_tŞ¡ršg
(L, (i), 
NULL
)

	)

287 
	#lua_İ’
(è
	`luaL_Ãw¡©e
()

	)

289 
	#lua_g‘»gi¡ry
(
L
è
	`lua_pushv®ue
(L, 
LUA_REGISTRYINDEX
)

	)

291 
	#lua_g‘gccouÁ
(
L
è
	`lua_gc
(L, 
LUA_GCCOUNT
, 0)

	)

293 
	#lua_Chunk»ad”
 
lua_R—d”


	)

294 
	#lua_Chunkwr™”
 
lua_Wr™”


	)

298 
LUA_API
 
	`lua_£ev–
 (
lua_S‹
 *
äom
,†ua_S‹ *
to
);

311 
	#LUA_HOOKCALL
 0

	)

312 
	#LUA_HOOKRET
 1

	)

313 
	#LUA_HOOKLINE
 2

	)

314 
	#LUA_HOOKCOUNT
 3

	)

315 
	#LUA_HOOKTAILRET
 4

	)

321 
	#LUA_MASKCALL
 (1 << 
LUA_HOOKCALL
)

	)

322 
	#LUA_MASKRET
 (1 << 
LUA_HOOKRET
)

	)

323 
	#LUA_MASKLINE
 (1 << 
LUA_HOOKLINE
)

	)

324 
	#LUA_MASKCOUNT
 (1 << 
LUA_HOOKCOUNT
)

	)

326 
lua_Debug
 
	tlua_Debug
;

330 (*
	tlua_Hook
è(
	tlua_S‹
 *
	tL
, 
	tlua_Debug
 *
	t¬
);

333 
LUA_API
 
	`lua_g‘¡ack
 (
lua_S‹
 *
L
, 
Ëv–
, 
lua_Debug
 *
¬
);

334 
LUA_API
 
	`lua_g‘šfo
 (
lua_S‹
 *
L
, cÚ¡ *
wh©
, 
lua_Debug
 *
¬
);

335 
LUA_API
 cÚ¡ *
	`lua_g‘loÿl
 (
lua_S‹
 *
L
, cÚ¡ 
lua_Debug
 *
¬
, 
n
);

336 
LUA_API
 cÚ¡ *
	`lua_£oÿl
 (
lua_S‹
 *
L
, cÚ¡ 
lua_Debug
 *
¬
, 
n
);

337 
LUA_API
 cÚ¡ *
	`lua_g‘upv®ue
 (
lua_S‹
 *
L
, 
funcšdex
, 
n
);

338 
LUA_API
 cÚ¡ *
	`lua_£tupv®ue
 (
lua_S‹
 *
L
, 
funcšdex
, 
n
);

340 
LUA_API
 
	`lua_£thook
 (
lua_S‹
 *
L
, 
lua_Hook
 
func
, 
mask
, 
couÁ
);

341 
LUA_API
 
lua_Hook
 
	`lua_g‘hook
 (
lua_S‹
 *
L
);

342 
LUA_API
 
	`lua_g‘hookmask
 (
lua_S‹
 *
L
);

343 
LUA_API
 
	`lua_g‘hookcouÁ
 (
lua_S‹
 *
L
);

346 
	slua_Debug
 {

347 
ev’t
;

348 cÚ¡ *
Çme
;

349 cÚ¡ *
Çmewh©
;

350 cÚ¡ *
wh©
;

351 cÚ¡ *
sourû
;

352 
cu¼’še
;

353 
nups
;

354 
lšedefšed
;

355 
Ï¡lšedefšed
;

356 
shÜt_¤c
[
LUA_IDSIZE
];

358 
i_ci
;

	@deps/lua/src/lua_bit.c

29 
	#LUA_BITOP_VERSION
 "1.0.2"

	)

31 
	#LUA_LIB


	)

32 
	~"lua.h
"

33 
	~"Ïuxlib.h
"

35 #ifdeà
_MSC_VER


37 
__št32
 
	tšt32_t
;

38 
	t__št32
 
	tušt32_t
;

39 
	t__št64
 
	tušt64_t
;

41 
	~<¡dšt.h
>

44 
št32_t
 
	tSB™s
;

45 
ušt32_t
 
	tUB™s
;

48 
lua_Numb”
 
	mn
;

49 #ifdeà
LUA_NUMBER_DOUBLE


50 
ušt64_t
 
	mb
;

52 
UB™s
 
	mb
;

54 } 
	tB™Num
;

57 
UB™s
 
	$b¬g
(
lua_S‹
 *
L
, 
idx
)

59 
B™Num
 
bn
;

60 
UB™s
 
b
;

61 #ià
LUA_VERSION_NUM
 < 502

62 
bn
.
n
 = 
	`lua_tÚumb”
(
L
, 
idx
);

64 
bn
.
n
 = 
	`luaL_checknumb”
(
L
, 
idx
);

66 #ià
	`defšed
(
LUA_NUMBER_DOUBLE
)

67 
bn
.
n
 += 6755399441055744.0;

68 #ifdeà
SWAPPED_DOUBLE


69 
b
 = (
UB™s
)(
bn
.b >> 32);

71 
b
 = (
UB™s
)
bn
.b;

73 #–ià
	`defšed
(
LUA_NUMBER_INT
è|| defšed(
LUA_NUMBER_LONG
) || \

74 
	`defšed
(
LUA_NUMBER_LONGLONG
è|| defšed(
LUA_NUMBER_LONG_LONG
) || \

75 
	`defšed
(
LUA_NUMBER_LLONG
)

76 ià((
UB™s
è=ğ(
lua_Numb”
))

77 
b
 = 
bn
.b;

79 
b
 = (
UB™s
)(
SB™s
)
bn
.
n
;

80 #–ià
	`defšed
(
LUA_NUMBER_FLOAT
)

85 #ià
LUA_VERSION_NUM
 < 502

86 ià(
b
 =ğ0 && !
	`lua_i¢umb”
(
L
, 
idx
)) {

87 
	`luaL_ty³¼Ü
(
L
, 
idx
, "number");

90  
b
;

91 
	}
}

94 
	#BRET
(
b
è
	`lua_pushnumb”
(
L
, (
lua_Numb”
)(
SB™s
)(b));  1;

	)

96 
	$b™_tob™
(
lua_S‹
 *
L
è{ 
	`BRET
(
	`b¬g
(L, 1)è
	}
}

97 
	$b™_bnÙ
(
lua_S‹
 *
L
è{ 
	`BRET
(~
	`b¬g
(L, 1)è
	}
}

99 
	#BIT_OP
(
func
, 
İr
) \

100 
	`func
(
lua_S‹
 *
L
è{ 
i
; 
UB™s
 
b
 = 
	`b¬g
(L, 1); \

101 
i
 = 
	`lua_g‘tİ
(
L
); i > 1; i--è
b
 
İr
 
	`b¬g
(L, i); 
	`BRET
(bè}

	)

102 
	$BIT_OP
(
b™_bªd
, &=)

103 
	`BIT_OP
(
b™_bÜ
, |=)

104 
	`BIT_OP
(
b™_bxÜ
, ^=)

106 
	#bshl
(
b
, 
n
è(b <<‚)

	)

107 
	#bshr
(
b
, 
n
è(b >>‚)

	)

108 
	#b§r
(
b
, 
n
è((
SB™s
)b >>‚)

	)

109 
	#brŞ
(
b
, 
n
è((b <<‚è| (b >> (32-n)))

	)

110 
	#brÜ
(
b
, 
n
è((b << (32-n)è| (b >>‚))

	)

111 
	#BIT_SH
(
func
, 
â
) \

112 
	`func
(
lua_S‹
 *
L
) { \

113 
UB™s
 
b
 = 
	`b¬g
(
L
, 1); UB™ 
n
 = b¬g(L, 2è& 31; 
	`BRET
(
	`â
(b,‚)è
	}

	)
}

114 
	$BIT_SH
(
b™_lshiá
, 
bshl
)

115 
	$BIT_SH
(
b™_rshiá
, 
bshr
)

116 
	$BIT_SH
(
b™_¬shiá
, 
b§r
)

117 
	$BIT_SH
(
b™_rŞ
, 
brŞ
)

118 
	$BIT_SH
(
b™_rÜ
, 
brÜ
)

120 
	$b™_bsw­
(
lua_S‹
 *
L
)

122 
UB™s
 
b
 = 
	`b¬g
(
L
, 1);

123 
b
 = (b >> 24) | ((b >> 8) & 0xff00) | ((b & 0xff00) << 8) | (b << 24);

124 
	`BRET
(
b
)

125 
	}
}

127 
	$b™_tohex
(
lua_S‹
 *
L
)

129 
UB™s
 
b
 = 
	`b¬g
(
L
, 1);

130 
SB™s
 
n
 = 
	`lua_i¢Úe
(
L
, 2è? 8 : (SB™s)
	`b¬g
(L, 2);

131 cÚ¡ *
hexdig™s
 = "0123456789abcdef";

132 
buf
[8];

133 
i
;

134 ià(
n
 < 0è{‚ = -n; 
hexdig™s
 = "0123456789ABCDEF"; }

135 ià(
n
 > 8)‚ = 8;

136 
i
 = ()
n
; --˜>ğ0; ) { 
buf
[i] = 
hexdig™s
[
b
 & 15]; b >>= 4; }

137 
	`lua_pushl¡ršg
(
L
, 
buf
, (
size_t
)
n
);

139 
	}
}

141 cÚ¡ 
luaL_Reg
 
	gb™_funcs
[] = {

142 { "tob™", 
b™_tob™
 },

143 { "bnÙ", 
b™_bnÙ
 },

144 { "bªd", 
b™_bªd
 },

145 { "bÜ", 
b™_bÜ
 },

146 { "bxÜ", 
b™_bxÜ
 },

147 { "lshiá", 
b™_lshiá
 },

148 { "rshiá", 
b™_rshiá
 },

149 { "¬shiá", 
b™_¬shiá
 },

150 { "rŞ", 
b™_rŞ
 },

151 { "rÜ", 
b™_rÜ
 },

152 { "bsw­", 
b™_bsw­
 },

153 { "tohex", 
b™_tohex
 },

154 { 
NULL
, NULL }

161 
	#BAD_SAR
 (
	`b§r
(-8, 2è!ğ(
SB™s
)-2)

	)

163 
LUALIB_API
 
	$luaİ’_b™
(
lua_S‹
 *
L
)

165 
UB™s
 
b
;

166 
	`lua_pushnumb”
(
L
, (
lua_Numb”
)1437217655L);

167 
b
 = 
	`b¬g
(
L
, -1);

168 ià(
b
 !ğ(
UB™s
)1437217655L || 
BAD_SAR
) {

169 cÚ¡ *
msg
 = "compiled with incompatible†uaconf.h";

170 #ifdeà
LUA_NUMBER_DOUBLE


171 #ifdeà
_WIN32


172 ià(
b
 =ğ(
UB™s
)1610612736L)

173 
msg
 = "use D3DCREATE_FPU_PRESERVE with DirectX";

175 ià(
b
 =ğ(
UB™s
)1127743488L)

176 
msg
 = "not compiled with SWAPPED_DOUBLE";

178 ià(
BAD_SAR
)

179 
msg
 = "arithmetic„ight-shift broken";

180 
	`luaL_”rÜ
(
L
, "b™†ib¿ry s–f-‹¡ faed (%s)", 
msg
);

182 #ià
LUA_VERSION_NUM
 < 502

183 
	`luaL_»gi¡”
(
L
, "b™", 
b™_funcs
);

185 
	`luaL_Ãwlib
(
L
, 
b™_funcs
);

188 
	}
}

	@deps/lua/src/lua_cjson.c

39 
	~<as£¹.h
>

40 
	~<¡ršg.h
>

41 
	~<m©h.h
>

42 
	~<lim™s.h
>

43 
	~"lua.h
"

44 
	~"Ïuxlib.h
"

46 
	~"¡rbuf.h
"

47 
	~"åcÚv.h
"

49 
	~"../../../¤c/sŞ¬isfixes.h
"

51 #iâdeà
CJSON_MODNAME


52 
	#CJSON_MODNAME
 "cjsÚ"

	)

55 #iâdeà
CJSON_VERSION


56 
	#CJSON_VERSION
 "2.1.0"

	)

60 #ià!
defšed
(
isšf
è&& (defšed(
USE_INTERNAL_ISINF
è|| defšed(
MISSING_ISINF
))

61 
	#isšf
(
x
è(!
	`i¢ª
(xè&& i¢ª((xè- (x)))

	)

64 
	#DEFAULT_SPARSE_CONVERT
 0

	)

65 
	#DEFAULT_SPARSE_RATIO
 2

	)

66 
	#DEFAULT_SPARSE_SAFE
 10

	)

67 
	#DEFAULT_ENCODE_MAX_DEPTH
 1000

	)

68 
	#DEFAULT_DECODE_MAX_DEPTH
 1000

	)

69 
	#DEFAULT_ENCODE_INVALID_NUMBERS
 0

	)

70 
	#DEFAULT_DECODE_INVALID_NUMBERS
 1

	)

71 
	#DEFAULT_ENCODE_KEEP_BUFFER
 1

	)

72 
	#DEFAULT_ENCODE_NUMBER_PRECISION
 14

	)

74 #ifdeà
DISABLE_INVALID_NUMBERS


75 #undeà
DEFAULT_DECODE_INVALID_NUMBERS


76 
	#DEFAULT_DECODE_INVALID_NUMBERS
 0

	)

80 
	mT_OBJ_BEGIN
,

81 
	mT_OBJ_END
,

82 
	mT_ARR_BEGIN
,

83 
	mT_ARR_END
,

84 
	mT_STRING
,

85 
	mT_NUMBER
,

86 
	mT_BOOLEAN
,

87 
	mT_NULL
,

88 
	mT_COLON
,

89 
	mT_COMMA
,

90 
	mT_END
,

91 
	mT_WHITESPACE
,

92 
	mT_ERROR
,

93 
	mT_UNKNOWN


94 } 
	tjsÚ_tok’_ty³_t
;

96 cÚ¡ *
	gjsÚ_tok’_ty³_Çme
[] = {

111 
NULL


115 
jsÚ_tok’_ty³_t
 
	mch2tok’
[256];

116 
	mesÿ³2ch¬
[256];

120 
¡rbuf_t
 
	m’code_buf
;

122 
	m’code_¥¬£_cÚv”t
;

123 
	m’code_¥¬£_¿tio
;

124 
	m’code_¥¬£_§ã
;

125 
	m’code_max_d•th
;

126 
	m’code_šv®id_numb”s
;

127 
	m’code_numb”_´ecisiÚ
;

128 
	m’code_k“p_bufãr
;

130 
	mdecode_šv®id_numb”s
;

131 
	mdecode_max_d•th
;

132 } 
	tjsÚ_cÚfig_t
;

135 cÚ¡ *
	md©a
;

136 cÚ¡ *
	m±r
;

137 
¡rbuf_t
 *
	mtmp
;

138 
jsÚ_cÚfig_t
 *
	mcfg
;

139 
	mcu¼’t_d•th
;

140 } 
	tjsÚ_·r£_t
;

143 
jsÚ_tok’_ty³_t
 
	mty³
;

144 
	mšdex
;

146 cÚ¡ *
	m¡ršg
;

147 
	mnumb”
;

148 
	mboŞ—n
;

149 } 
	mv®ue
;

150 
	m¡ršg_Ën
;

151 } 
	tjsÚ_tok’_t
;

153 cÚ¡ *
	gch¬2esÿ³
[256] = {

162 
NULL
, NULL, "\\\"", NULL, NULL, NULL, NULL, NULL,

163 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, "\\/",

164 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

165 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

166 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

167 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

168 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

169 
NULL
, NULL, NULL, NULL, "\\\\", NULL, NULL, NULL,

170 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

171 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

172 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

173 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, "\\u007f",

174 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

175 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

176 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

177 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

178 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

179 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

180 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

181 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

182 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

183 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

184 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

185 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

186 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

187 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

188 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

189 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL, NULL,

194 
jsÚ_cÚfig_t
 *
	$jsÚ_ãtch_cÚfig
(
lua_S‹
 *
l
)

196 
jsÚ_cÚfig_t
 *
cfg
;

198 
cfg
 = 
	`lua_tou£rd©a
(
l
, 
	`lua_upv®uešdex
(1));

199 ià(!
cfg
)

200 
	`luaL_”rÜ
(
l
, "BUG: Unableo fetch CJSON configuration");

202  
cfg
;

203 
	}
}

208 
jsÚ_cÚfig_t
 *
	$jsÚ_¬g_š™
(
lua_S‹
 *
l
, 
¬gs
)

210 
	`luaL_¬gcheck
(
l
, 
	`lua_g‘tİ
Öè<ğ
¬gs
,‡rgs + 1,

213 
	`lua_g‘tİ
(
l
è< 
¬gs
)

214 
	`lua_pushn
(
l
);

216  
	`jsÚ_ãtch_cÚfig
(
l
);

217 
	}
}

220 
	$jsÚ_š‹g”_İtiÚ
(
lua_S‹
 *
l
, 
İtšdex
, *
£‰šg
,

221 
mš
, 
max
)

223 
”rmsg
[64];

224 
v®ue
;

226 ià(!
	`lua_i¢
(
l
, 
İtšdex
)) {

227 
v®ue
 = 
	`luaL_checkš‹g”
(
l
, 
İtšdex
);

228 
	`¢´štf
(
”rmsg
, Ó¼msg), "ex³ùed iÁeg” b‘w“À%d‡nd %d", 
mš
, 
max
);

229 
	`luaL_¬gcheck
(
l
, 
mš
 <ğ
v®ue
 && v®u<ğ
max
, 1, 
”rmsg
);

230 *
£‰šg
 = 
v®ue
;

233 
	`lua_pushš‹g”
(
l
, *
£‰šg
);

236 
	}
}

239 
	$jsÚ_’um_İtiÚ
(
lua_S‹
 *
l
, 
İtšdex
, *
£‰šg
,

240 cÚ¡ **
İtiÚs
, 
boŞ_Œue
)

242 cÚ¡ *
boŞ_İtiÚs
[] = { "off", "Ú", 
NULL
 };

244 ià(!
İtiÚs
) {

245 
İtiÚs
 = 
boŞ_İtiÚs
;

246 
boŞ_Œue
 = 1;

249 ià(!
	`lua_i¢
(
l
, 
İtšdex
)) {

250 ià(
boŞ_Œue
 && 
	`lua_isboŞ—n
(
l
, 
İtšdex
))

251 *
£‰šg
 = 
	`lua_toboŞ—n
(
l
, 
İtšdex
è* 
boŞ_Œue
;

253 *
£‰šg
 = 
	`luaL_checkİtiÚ
(
l
, 
İtšdex
, 
NULL
, 
İtiÚs
);

256 ià(
boŞ_Œue
 && (*
£‰šg
 == 0 || *setting == bool_true))

257 
	`lua_pushboŞ—n
(
l
, *
£‰šg
);

259 
	`lua_push¡ršg
(
l
, 
İtiÚs
[*
£‰šg
]);

262 
	}
}

268 
	$jsÚ_cfg_’code_¥¬£_¬¿y
(
lua_S‹
 *
l
)

270 
jsÚ_cÚfig_t
 *
cfg
 = 
	`jsÚ_¬g_š™
(
l
, 3);

272 
	`jsÚ_’um_İtiÚ
(
l
, 1, &
cfg
->
’code_¥¬£_cÚv”t
, 
NULL
, 1);

273 
	`jsÚ_š‹g”_İtiÚ
(
l
, 2, &
cfg
->
’code_¥¬£_¿tio
, 0, 
INT_MAX
);

274 
	`jsÚ_š‹g”_İtiÚ
(
l
, 3, &
cfg
->
’code_¥¬£_§ã
, 0, 
INT_MAX
);

277 
	}
}

281 
	$jsÚ_cfg_’code_max_d•th
(
lua_S‹
 *
l
)

283 
jsÚ_cÚfig_t
 *
cfg
 = 
	`jsÚ_¬g_š™
(
l
, 1);

285  
	`jsÚ_š‹g”_İtiÚ
(
l
, 1, &
cfg
->
’code_max_d•th
, 1, 
INT_MAX
);

286 
	}
}

290 
	$jsÚ_cfg_decode_max_d•th
(
lua_S‹
 *
l
)

292 
jsÚ_cÚfig_t
 *
cfg
 = 
	`jsÚ_¬g_š™
(
l
, 1);

294  
	`jsÚ_š‹g”_İtiÚ
(
l
, 1, &
cfg
->
decode_max_d•th
, 1, 
INT_MAX
);

295 
	}
}

298 
	$jsÚ_cfg_’code_numb”_´ecisiÚ
(
lua_S‹
 *
l
)

300 
jsÚ_cÚfig_t
 *
cfg
 = 
	`jsÚ_¬g_š™
(
l
, 1);

302  
	`jsÚ_š‹g”_İtiÚ
(
l
, 1, &
cfg
->
’code_numb”_´ecisiÚ
, 1, 14);

303 
	}
}

306 
	$jsÚ_cfg_’code_k“p_bufãr
(
lua_S‹
 *
l
)

308 
jsÚ_cÚfig_t
 *
cfg
 = 
	`jsÚ_¬g_š™
(
l
, 1);

309 
Şd_v®ue
;

311 
Şd_v®ue
 = 
cfg
->
’code_k“p_bufãr
;

313 
	`jsÚ_’um_İtiÚ
(
l
, 1, &
cfg
->
’code_k“p_bufãr
, 
NULL
, 1);

316 ià(
Şd_v®ue
 ^ 
cfg
->
’code_k“p_bufãr
) {

317 ià(
cfg
->
’code_k“p_bufãr
)

318 
	`¡rbuf_š™
(&
cfg
->
’code_buf
, 0);

320 
	`¡rbuf_ä“
(&
cfg
->
’code_buf
);

324 
	}
}

326 #ià
defšed
(
DISABLE_INVALID_NUMBERS
è&& !defšed(
USE_INTERNAL_FPCONV
)

327 
	$jsÚ_v”ify_šv®id_numb”_£‰šg
(
lua_S‹
 *
l
, *
£‰šg
)

329 ià(*
£‰šg
 == 1) {

330 *
£‰šg
 = 0;

331 
	`luaL_”rÜ
(
l
, "Infinity, NaN,‡nd/or hexadecimal‚umbers‡re‚ot supported.");

333 
	}
}

335 
	#jsÚ_v”ify_šv®id_numb”_£‰šg
(
l
, 
s
èdØ{ } 0)

	)

338 
	$jsÚ_cfg_’code_šv®id_numb”s
(
lua_S‹
 *
l
)

340 cÚ¡ *
İtiÚs
[] = { "off", "Ú", "nuÎ", 
NULL
 };

341 
jsÚ_cÚfig_t
 *
cfg
 = 
	`jsÚ_¬g_š™
(
l
, 1);

343 
	`jsÚ_’um_İtiÚ
(
l
, 1, &
cfg
->
’code_šv®id_numb”s
, 
İtiÚs
, 1);

345 
	`jsÚ_v”ify_šv®id_numb”_£‰šg
(
l
, &
cfg
->
’code_šv®id_numb”s
);

348 
	}
}

350 
	$jsÚ_cfg_decode_šv®id_numb”s
(
lua_S‹
 *
l
)

352 
jsÚ_cÚfig_t
 *
cfg
 = 
	`jsÚ_¬g_š™
(
l
, 1);

354 
	`jsÚ_’um_İtiÚ
(
l
, 1, &
cfg
->
decode_šv®id_numb”s
, 
NULL
, 1);

356 
	`jsÚ_v”ify_šv®id_numb”_£‰šg
(
l
, &
cfg
->
’code_šv®id_numb”s
);

359 
	}
}

361 
	$jsÚ_de¡roy_cÚfig
(
lua_S‹
 *
l
)

363 
jsÚ_cÚfig_t
 *
cfg
;

365 
cfg
 = 
	`lua_tou£rd©a
(
l
, 1);

366 ià(
cfg
)

367 
	`¡rbuf_ä“
(&
cfg
->
’code_buf
);

368 
cfg
 = 
NULL
;

371 
	}
}

373 
	$jsÚ_ü—‹_cÚfig
(
lua_S‹
 *
l
)

375 
jsÚ_cÚfig_t
 *
cfg
;

376 
i
;

378 
cfg
 = 
	`lua_Ãwu£rd©a
(
l
, (*cfg));

381 
	`lua_ÃwbË
(
l
);

382 
	`lua_pushcfunùiÚ
(
l
, 
jsÚ_de¡roy_cÚfig
);

383 
	`lua_£tf›ld
(
l
, -2, "__gc");

384 
	`lua_£tm‘©abË
(
l
, -2);

386 
cfg
->
’code_¥¬£_cÚv”t
 = 
DEFAULT_SPARSE_CONVERT
;

387 
cfg
->
’code_¥¬£_¿tio
 = 
DEFAULT_SPARSE_RATIO
;

388 
cfg
->
’code_¥¬£_§ã
 = 
DEFAULT_SPARSE_SAFE
;

389 
cfg
->
’code_max_d•th
 = 
DEFAULT_ENCODE_MAX_DEPTH
;

390 
cfg
->
decode_max_d•th
 = 
DEFAULT_DECODE_MAX_DEPTH
;

391 
cfg
->
’code_šv®id_numb”s
 = 
DEFAULT_ENCODE_INVALID_NUMBERS
;

392 
cfg
->
decode_šv®id_numb”s
 = 
DEFAULT_DECODE_INVALID_NUMBERS
;

393 
cfg
->
’code_k“p_bufãr
 = 
DEFAULT_ENCODE_KEEP_BUFFER
;

394 
cfg
->
’code_numb”_´ecisiÚ
 = 
DEFAULT_ENCODE_NUMBER_PRECISION
;

396 #ià
DEFAULT_ENCODE_KEEP_BUFFER
 > 0

397 
	`¡rbuf_š™
(&
cfg
->
’code_buf
, 0);

403 
i
 = 0; i < 256; i++)

404 
cfg
->
ch2tok’
[
i
] = 
T_ERROR
;

407 
cfg
->
ch2tok’
['{'] = 
T_OBJ_BEGIN
;

408 
cfg
->
ch2tok’
['}'] = 
T_OBJ_END
;

409 
cfg
->
ch2tok’
['['] = 
T_ARR_BEGIN
;

410 
cfg
->
ch2tok’
[']'] = 
T_ARR_END
;

411 
cfg
->
ch2tok’
[','] = 
T_COMMA
;

412 
cfg
->
ch2tok’
[':'] = 
T_COLON
;

413 
cfg
->
ch2tok’
['\0'] = 
T_END
;

414 
cfg
->
ch2tok’
[' '] = 
T_WHITESPACE
;

415 
cfg
->
ch2tok’
['\t'] = 
T_WHITESPACE
;

416 
cfg
->
ch2tok’
['\n'] = 
T_WHITESPACE
;

417 
cfg
->
ch2tok’
['\r'] = 
T_WHITESPACE
;

420 
cfg
->
ch2tok’
['f'] = 
T_UNKNOWN
;

421 
cfg
->
ch2tok’
['i'] = 
T_UNKNOWN
;

422 
cfg
->
ch2tok’
['I'] = 
T_UNKNOWN
;

423 
cfg
->
ch2tok’
['n'] = 
T_UNKNOWN
;

424 
cfg
->
ch2tok’
['N'] = 
T_UNKNOWN
;

425 
cfg
->
ch2tok’
['t'] = 
T_UNKNOWN
;

426 
cfg
->
ch2tok’
['"'] = 
T_UNKNOWN
;

427 
cfg
->
ch2tok’
['+'] = 
T_UNKNOWN
;

428 
cfg
->
ch2tok’
['-'] = 
T_UNKNOWN
;

429 
i
 = 0; i < 10; i++)

430 
cfg
->
ch2tok’
['0' + 
i
] = 
T_UNKNOWN
;

433 
i
 = 0; i < 256; i++)

434 
cfg
->
esÿ³2ch¬
[
i
] = 0;

435 
cfg
->
esÿ³2ch¬
['"'] = '"';

436 
cfg
->
esÿ³2ch¬
['\\'] = '\\';

437 
cfg
->
esÿ³2ch¬
['/'] = '/';

438 
cfg
->
esÿ³2ch¬
['b'] = '\b';

439 
cfg
->
esÿ³2ch¬
['t'] = '\t';

440 
cfg
->
esÿ³2ch¬
['n'] = '\n';

441 
cfg
->
esÿ³2ch¬
['f'] = '\f';

442 
cfg
->
esÿ³2ch¬
['r'] = '\r';

443 
cfg
->
esÿ³2ch¬
['u'] = 'u';

444 
	}
}

448 
	$jsÚ_’code_exû±iÚ
(
lua_S‹
 *
l
, 
jsÚ_cÚfig_t
 *
cfg
, 
¡rbuf_t
 *
jsÚ
, 
lšdex
,

449 cÚ¡ *
»asÚ
)

451 ià(!
cfg
->
’code_k“p_bufãr
)

452 
	`¡rbuf_ä“
(
jsÚ
);

453 
	`luaL_”rÜ
(
l
, "Cannot serialise %s: %s",

454 
	`lua_ty³Çme
(
l
, 
	`lua_ty³
Ö, 
lšdex
)), 
»asÚ
);

455 
	}
}

463 
	$jsÚ_­³nd_¡ršg
(
lua_S‹
 *
l
, 
¡rbuf_t
 *
jsÚ
, 
lšdex
)

465 cÚ¡ *
esc¡r
;

466 
i
;

467 cÚ¡ *
¡r
;

468 
size_t
 
Ën
;

470 
¡r
 = 
	`lua_tŞ¡ršg
(
l
, 
lšdex
, &
Ën
);

476 
	`¡rbuf_’su»_em±y_Ëngth
(
jsÚ
, 
Ën
 * 6 + 2);

478 
	`¡rbuf_­³nd_ch¬_un§ã
(
jsÚ
, '\"');

479 
i
 = 0; i < 
Ën
; i++) {

480 
esc¡r
 = 
ch¬2esÿ³
[()
¡r
[
i
]];

481 ià(
esc¡r
)

482 
	`¡rbuf_­³nd_¡ršg
(
jsÚ
, 
esc¡r
);

484 
	`¡rbuf_­³nd_ch¬_un§ã
(
jsÚ
, 
¡r
[
i
]);

486 
	`¡rbuf_­³nd_ch¬_un§ã
(
jsÚ
, '\"');

487 
	}
}

493 
	$lua_¬¿y_Ëngth
(
lua_S‹
 *
l
, 
jsÚ_cÚfig_t
 *
cfg
, 
¡rbuf_t
 *
jsÚ
)

495 
k
;

496 
max
;

497 
™ems
;

499 
max
 = 0;

500 
™ems
 = 0;

502 
	`lua_pushn
(
l
);

504 
	`lua_Ãxt
(
l
, -2) != 0) {

506 ià(
	`lua_ty³
(
l
, -2è=ğ
LUA_TNUMBER
 &&

507 (
k
 = 
	`lua_tÚumb”
(
l
, -2))) {

509 ià(
	`æoÜ
(
k
) == k && k >= 1) {

510 ià(
k
 > 
max
)

511 
max
 = 
k
;

512 
™ems
++;

513 
	`lua_pİ
(
l
, 1);

519 
	`lua_pİ
(
l
, 2);

524 ià(
cfg
->
’code_¥¬£_¿tio
 > 0 &&

525 
max
 > 
™ems
 * 
cfg
->
’code_¥¬£_¿tio
 &&

526 
max
 > 
cfg
->
’code_¥¬£_§ã
) {

527 ià(!
cfg
->
’code_¥¬£_cÚv”t
)

528 
	`jsÚ_’code_exû±iÚ
(
l
, 
cfg
, 
jsÚ
, -1, "excessively sparse‡rray");

533  
max
;

534 
	}
}

536 
	$jsÚ_check_’code_d•th
(
lua_S‹
 *
l
, 
jsÚ_cÚfig_t
 *
cfg
,

537 
cu¼’t_d•th
, 
¡rbuf_t
 *
jsÚ
)

549 ià(
cu¼’t_d•th
 <ğ
cfg
->
’code_max_d•th
 && 
	`lua_check¡ack
(
l
, 3))

552 ià(!
cfg
->
’code_k“p_bufãr
)

553 
	`¡rbuf_ä“
(
jsÚ
);

555 
	`luaL_”rÜ
(
l
, "Cannot serialise,ƒxcessive‚esting (%d)",

556 
cu¼’t_d•th
);

557 
	}
}

559 
jsÚ_­³nd_d©a
(
lua_S‹
 *
l
, 
jsÚ_cÚfig_t
 *
cfg
,

560 
cu¼’t_d•th
, 
¡rbuf_t
 *
jsÚ
);

566 
	$jsÚ_­³nd_¬¿y
(
lua_S‹
 *
l
, 
jsÚ_cÚfig_t
 *
cfg
, 
cu¼’t_d•th
,

567 
¡rbuf_t
 *
jsÚ
, 
¬¿y_Ëngth
)

569 
comma
, 
i
;

571 
	`¡rbuf_­³nd_ch¬
(
jsÚ
, '[');

573 
comma
 = 0;

574 
i
 = 1; i <ğ
¬¿y_Ëngth
; i++) {

575 ià(
comma
)

576 
	`¡rbuf_­³nd_ch¬
(
jsÚ
, ',');

578 
comma
 = 1;

580 
	`lua_¿wg‘i
(
l
, -1, 
i
);

581 
	`jsÚ_­³nd_d©a
(
l
, 
cfg
, 
cu¼’t_d•th
, 
jsÚ
);

582 
	`lua_pİ
(
l
, 1);

585 
	`¡rbuf_­³nd_ch¬
(
jsÚ
, ']');

586 
	}
}

588 
	$jsÚ_­³nd_numb”
(
lua_S‹
 *
l
, 
jsÚ_cÚfig_t
 *
cfg
,

589 
¡rbuf_t
 *
jsÚ
, 
lšdex
)

591 
num
 = 
	`lua_tÚumb”
(
l
, 
lšdex
);

592 
Ën
;

594 ià(
cfg
->
’code_šv®id_numb”s
 == 0) {

596 ià(
	`isšf
(
num
è|| 
	`i¢ª
(num))

597 
	`jsÚ_’code_exû±iÚ
(
l
, 
cfg
, 
jsÚ
, 
lšdex
, "must‚ot be NaN or Inf");

598 } ià(
cfg
->
’code_šv®id_numb”s
 == 1) {

601 ià(
	`i¢ª
(
num
)) {

602 
	`¡rbuf_­³nd_mem
(
jsÚ
, "nan", 3);

607 ià(
	`isšf
(
num
è|| 
	`i¢ª
(num)) {

608 
	`¡rbuf_­³nd_mem
(
jsÚ
, "null", 4);

613 
	`¡rbuf_’su»_em±y_Ëngth
(
jsÚ
, 
FPCONV_G_FMT_BUFSIZE
);

614 
Ën
 = 
	`åcÚv_g_fmt
(
	`¡rbuf_em±y_±r
(
jsÚ
), 
num
, 
cfg
->
’code_numb”_´ecisiÚ
);

615 
	`¡rbuf_ex‹nd_Ëngth
(
jsÚ
, 
Ën
);

616 
	}
}

618 
	$jsÚ_­³nd_objeù
(
lua_S‹
 *
l
, 
jsÚ_cÚfig_t
 *
cfg
,

619 
cu¼’t_d•th
, 
¡rbuf_t
 *
jsÚ
)

621 
comma
, 
keyty³
;

624 
	`¡rbuf_­³nd_ch¬
(
jsÚ
, '{');

626 
	`lua_pushn
(
l
);

628 
comma
 = 0;

629 
	`lua_Ãxt
(
l
, -2) != 0) {

630 ià(
comma
)

631 
	`¡rbuf_­³nd_ch¬
(
jsÚ
, ',');

633 
comma
 = 1;

636 
keyty³
 = 
	`lua_ty³
(
l
, -2);

637 ià(
keyty³
 =ğ
LUA_TNUMBER
) {

638 
	`¡rbuf_­³nd_ch¬
(
jsÚ
, '"');

639 
	`jsÚ_­³nd_numb”
(
l
, 
cfg
, 
jsÚ
, -2);

640 
	`¡rbuf_­³nd_mem
(
jsÚ
, "\":", 2);

641 } ià(
keyty³
 =ğ
LUA_TSTRING
) {

642 
	`jsÚ_­³nd_¡ršg
(
l
, 
jsÚ
, -2);

643 
	`¡rbuf_­³nd_ch¬
(
jsÚ
, ':');

645 
	`jsÚ_’code_exû±iÚ
(
l
, 
cfg
, 
jsÚ
, -2,

651 
	`jsÚ_­³nd_d©a
(
l
, 
cfg
, 
cu¼’t_d•th
, 
jsÚ
);

652 
	`lua_pİ
(
l
, 1);

656 
	`¡rbuf_­³nd_ch¬
(
jsÚ
, '}');

657 
	}
}

660 
	$jsÚ_­³nd_d©a
(
lua_S‹
 *
l
, 
jsÚ_cÚfig_t
 *
cfg
,

661 
cu¼’t_d•th
, 
¡rbuf_t
 *
jsÚ
)

663 
Ën
;

665 
	`lua_ty³
(
l
, -1)) {

666 
LUA_TSTRING
:

667 
	`jsÚ_­³nd_¡ršg
(
l
, 
jsÚ
, -1);

669 
LUA_TNUMBER
:

670 
	`jsÚ_­³nd_numb”
(
l
, 
cfg
, 
jsÚ
, -1);

672 
LUA_TBOOLEAN
:

673 ià(
	`lua_toboŞ—n
(
l
, -1))

674 
	`¡rbuf_­³nd_mem
(
jsÚ
, "true", 4);

676 
	`¡rbuf_­³nd_mem
(
jsÚ
, "false", 5);

678 
LUA_TTABLE
:

679 
cu¼’t_d•th
++;

680 
	`jsÚ_check_’code_d•th
(
l
, 
cfg
, 
cu¼’t_d•th
, 
jsÚ
);

681 
Ën
 = 
	`lua_¬¿y_Ëngth
(
l
, 
cfg
, 
jsÚ
);

682 ià(
Ën
 > 0)

683 
	`jsÚ_­³nd_¬¿y
(
l
, 
cfg
, 
cu¼’t_d•th
, 
jsÚ
, 
Ën
);

685 
	`jsÚ_­³nd_objeù
(
l
, 
cfg
, 
cu¼’t_d•th
, 
jsÚ
);

687 
LUA_TNIL
:

688 
	`¡rbuf_­³nd_mem
(
jsÚ
, "null", 4);

690 
LUA_TLIGHTUSERDATA
:

691 ià(
	`lua_tou£rd©a
(
l
, -1è=ğ
NULL
) {

692 
	`¡rbuf_­³nd_mem
(
jsÚ
, "null", 4);

698 
	`jsÚ_’code_exû±iÚ
(
l
, 
cfg
, 
jsÚ
, -1, "type‚ot supported");

701 
	}
}

703 
	$jsÚ_’code
(
lua_S‹
 *
l
)

705 
jsÚ_cÚfig_t
 *
cfg
 = 
	`jsÚ_ãtch_cÚfig
(
l
);

706 
¡rbuf_t
 
loÿl_’code_buf
;

707 
¡rbuf_t
 *
’code_buf
;

708 *
jsÚ
;

709 
Ën
;

711 
	`luaL_¬gcheck
(
l
, 
	`lua_g‘tİ
(l) == 1, 1, "expected 1‡rgument");

713 ià(!
cfg
->
’code_k“p_bufãr
) {

715 
’code_buf
 = &
loÿl_’code_buf
;

716 
	`¡rbuf_š™
(
’code_buf
, 0);

719 
’code_buf
 = &
cfg
->encode_buf;

720 
	`¡rbuf_»£t
(
’code_buf
);

723 
	`jsÚ_­³nd_d©a
(
l
, 
cfg
, 0, 
’code_buf
);

724 
jsÚ
 = 
	`¡rbuf_¡ršg
(
’code_buf
, &
Ën
);

726 
	`lua_pushl¡ršg
(
l
, 
jsÚ
, 
Ën
);

728 ià(!
cfg
->
’code_k“p_bufãr
)

729 
	`¡rbuf_ä“
(
’code_buf
);

732 
	}
}

736 
jsÚ_´oûss_v®ue
(
lua_S‹
 *
l
, 
jsÚ_·r£_t
 *
jsÚ
,

737 
jsÚ_tok’_t
 *
tok’
);

739 
	$hexdig™2št
(
hex
)

741 ià('0' <ğ
hex
 && hex <= '9')

742  
hex
 - '0';

745 
hex
 |= 0x20;

746 ià('a' <ğ
hex
 && hex <= 'f')

747  10 + 
hex
 - 'a';

750 
	}
}

752 
	$decode_hex4
(cÚ¡ *
hex
)

754 
dig™
[4];

755 
i
;

760 
i
 = 0; i < 4; i++) {

761 
dig™
[
i
] = 
	`hexdig™2št
(
hex
[i]);

762 ià(
dig™
[
i
] < 0) {

767  (
dig™
[0] << 12) +

768 (
dig™
[1] << 8) +

769 (
dig™
[2] << 4) +

770 
dig™
[3];

771 
	}
}

775 
	$cod•ošt_to_utf8
(*
utf8
, 
cod•ošt
)

778 ià(
cod•ošt
 <= 0x7F) {

779 
utf8
[0] = 
cod•ošt
;

784 ià(
cod•ošt
 <= 0x7FF) {

785 
utf8
[0] = (
cod•ošt
 >> 6) | 0xC0;

786 
utf8
[1] = (
cod•ošt
 & 0x3F) | 0x80;

791 ià(
cod•ošt
 <= 0xFFFF) {

792 
utf8
[0] = (
cod•ošt
 >> 12) | 0xE0;

793 
utf8
[1] = ((
cod•ošt
 >> 6) & 0x3F) | 0x80;

794 
utf8
[2] = (
cod•ošt
 & 0x3F) | 0x80;

799 ià(
cod•ošt
 <= 0x1FFFFF) {

800 
utf8
[0] = (
cod•ošt
 >> 18) | 0xF0;

801 
utf8
[1] = ((
cod•ošt
 >> 12) & 0x3F) | 0x80;

802 
utf8
[2] = ((
cod•ošt
 >> 6) & 0x3F) | 0x80;

803 
utf8
[3] = (
cod•ošt
 & 0x3F) | 0x80;

808 
	}
}

819 
	$jsÚ_­³nd_unicode_esÿ³
(
jsÚ_·r£_t
 *
jsÚ
)

821 
utf8
[4];

822 
cod•ošt
;

823 
su¼og©e_low
;

824 
Ën
;

825 
esÿ³_Ën
 = 6;

828 
cod•ošt
 = 
	`decode_hex4
(
jsÚ
->
±r
 + 2);

829 ià(
cod•ošt
 < 0)

838 ià((
cod•ošt
 & 0xF800) == 0xD800) {

840 ià(
cod•ošt
 & 0x400)

844 ià(*(
jsÚ
->
±r
 + 
esÿ³_Ën
) != '\\' ||

845 *(
jsÚ
->
±r
 + 
esÿ³_Ën
 + 1) != 'u') {

850 
su¼og©e_low
 = 
	`decode_hex4
(
jsÚ
->
±r
 + 2 + 
esÿ³_Ën
);

851 ià(
su¼og©e_low
 < 0)

855 ià((
su¼og©e_low
 & 0xFC00) != 0xDC00)

859 
cod•ošt
 = (codepoint & 0x3FF) << 10;

860 
su¼og©e_low
 &= 0x3FF;

861 
cod•ošt
 = (cod•ošˆ| 
su¼og©e_low
) + 0x10000;

862 
esÿ³_Ën
 = 12;

866 
Ën
 = 
	`cod•ošt_to_utf8
(
utf8
, 
cod•ošt
);

867 ià(!
Ën
)

871 
	`¡rbuf_­³nd_mem_un§ã
(
jsÚ
->
tmp
, 
utf8
, 
Ën
);

872 
jsÚ
->
±r
 +ğ
esÿ³_Ën
;

875 
	}
}

877 
	$jsÚ_£t_tok’_”rÜ
(
jsÚ_tok’_t
 *
tok’
, 
jsÚ_·r£_t
 *
jsÚ
,

878 cÚ¡ *
”¹y³
)

880 
tok’
->
ty³
 = 
T_ERROR
;

881 
tok’
->
šdex
 = 
jsÚ
->
±r
 - jsÚ->
d©a
;

882 
tok’
->
v®ue
.
¡ršg
 = 
”¹y³
;

883 
	}
}

885 
	$jsÚ_Ãxt_¡ršg_tok’
(
jsÚ_·r£_t
 *
jsÚ
, 
jsÚ_tok’_t
 *
tok’
)

887 *
esÿ³2ch¬
 = 
jsÚ
->
cfg
->escape2char;

888 
ch
;

891 
	`as£¹
(*
jsÚ
->
±r
 == '"');

894 
jsÚ
->
±r
++;

900 
	`¡rbuf_»£t
(
jsÚ
->
tmp
);

902 (
ch
 = *
jsÚ
->
±r
) != '"') {

903 ià(!
ch
) {

905 
	`jsÚ_£t_tok’_”rÜ
(
tok’
, 
jsÚ
, "unexpectedƒnd of string");

910 ià(
ch
 == '\\') {

912 
ch
 = *(
jsÚ
->
±r
 + 1);

915 
ch
 = 
esÿ³2ch¬
[()ch];

916 ià(
ch
 == 'u') {

917 ià(
	`jsÚ_­³nd_unicode_esÿ³
(
jsÚ
) == 0)

920 
	`jsÚ_£t_tok’_”rÜ
(
tok’
, 
jsÚ
,

924 ià(!
ch
) {

925 
	`jsÚ_£t_tok’_”rÜ
(
tok’
, 
jsÚ
, "invalidƒscape code");

930 
jsÚ
->
±r
++;

934 
	`¡rbuf_­³nd_ch¬_un§ã
(
jsÚ
->
tmp
, 
ch
);

935 
jsÚ
->
±r
++;

937 
jsÚ
->
±r
++;

939 
	`¡rbuf_’su»_nuÎ
(
jsÚ
->
tmp
);

941 
tok’
->
ty³
 = 
T_STRING
;

942 
tok’
->
v®ue
.
¡ršg
 = 
	`¡rbuf_¡ršg
(
jsÚ
->
tmp
, &tok’->
¡ršg_Ën
);

943 
	}
}

960 
	$jsÚ_is_šv®id_numb”
(
jsÚ_·r£_t
 *
jsÚ
)

962 cÚ¡ *
p
 = 
jsÚ
->
±r
;

965 ià(*
p
 == '+')

969 ià(*
p
 == '-')

970 
p
++;

973 ià(*
p
 == '0') {

974 
ch2
 = *(
p
 + 1);

976 ià((
ch2
 | 0x20) == 'x' ||

977 ('0' <ğ
ch2
 && ch2 <= '9'))

981 } ià(*
p
 <= '9') {

986 ià(!
	`¡ºÿ£cmp
(
p
, "inf", 3))

988 ià(!
	`¡ºÿ£cmp
(
p
, "nan", 3))

994 
	}
}

996 
	$jsÚ_Ãxt_numb”_tok’
(
jsÚ_·r£_t
 *
jsÚ
, 
jsÚ_tok’_t
 *
tok’
)

998 *
’d±r
;

1000 
tok’
->
ty³
 = 
T_NUMBER
;

1001 
tok’
->
v®ue
.
numb”
 = 
	`åcÚv_¡¹od
(
jsÚ
->
±r
, &
’d±r
);

1002 ià(
jsÚ
->
±r
 =ğ
’d±r
)

1003 
	`jsÚ_£t_tok’_”rÜ
(
tok’
, 
jsÚ
, "invalid‚umber");

1005 
jsÚ
->
±r
 = 
’d±r
;

1008 
	}
}

1014 
	$jsÚ_Ãxt_tok’
(
jsÚ_·r£_t
 *
jsÚ
, 
jsÚ_tok’_t
 *
tok’
)

1016 cÚ¡ 
jsÚ_tok’_ty³_t
 *
ch2tok’
 = 
jsÚ
->
cfg
->ch2token;

1017 
ch
;

1021 
ch
 = ()*(
jsÚ
->
±r
);

1022 
tok’
->
ty³
 = 
ch2tok’
[
ch
];

1023 ià(
tok’
->
ty³
 !ğ
T_WHITESPACE
)

1025 
jsÚ
->
±r
++;

1030 
tok’
->
šdex
 = 
jsÚ
->
±r
 - jsÚ->
d©a
;

1033 ià(
tok’
->
ty³
 =ğ
T_ERROR
) {

1034 
	`jsÚ_£t_tok’_”rÜ
(
tok’
, 
jsÚ
, "invalidoken");

1038 ià(
tok’
->
ty³
 =ğ
T_END
) {

1043 ià(
tok’
->
ty³
 !ğ
T_UNKNOWN
) {

1044 
jsÚ
->
±r
++;

1054 ià(
ch
 == '"') {

1055 
	`jsÚ_Ãxt_¡ršg_tok’
(
jsÚ
, 
tok’
);

1057 } ià(
ch
 == '-' || ('0' <= ch && ch <= '9')) {

1058 ià(!
jsÚ
->
cfg
->
decode_šv®id_numb”s
 && 
	`jsÚ_is_šv®id_numb”
(json)) {

1059 
	`jsÚ_£t_tok’_”rÜ
(
tok’
, 
jsÚ
, "invalid‚umber");

1062 
	`jsÚ_Ãxt_numb”_tok’
(
jsÚ
, 
tok’
);

1064 } ià(!
	`¡ºcmp
(
jsÚ
->
±r
, "true", 4)) {

1065 
tok’
->
ty³
 = 
T_BOOLEAN
;

1066 
tok’
->
v®ue
.
boŞ—n
 = 1;

1067 
jsÚ
->
±r
 += 4;

1069 } ià(!
	`¡ºcmp
(
jsÚ
->
±r
, "false", 5)) {

1070 
tok’
->
ty³
 = 
T_BOOLEAN
;

1071 
tok’
->
v®ue
.
boŞ—n
 = 0;

1072 
jsÚ
->
±r
 += 5;

1074 } ià(!
	`¡ºcmp
(
jsÚ
->
±r
, "null", 4)) {

1075 
tok’
->
ty³
 = 
T_NULL
;

1076 
jsÚ
->
±r
 += 4;

1078 } ià(
jsÚ
->
cfg
->
decode_šv®id_numb”s
 &&

1079 
	`jsÚ_is_šv®id_numb”
(
jsÚ
)) {

1085 
	`jsÚ_Ãxt_numb”_tok’
(
jsÚ
, 
tok’
);

1090 
	`jsÚ_£t_tok’_”rÜ
(
tok’
, 
jsÚ
, "invalidoken");

1091 
	}
}

1099 
	$jsÚ_throw_·r£_”rÜ
(
lua_S‹
 *
l
, 
jsÚ_·r£_t
 *
jsÚ
,

1100 cÚ¡ *
exp
, 
jsÚ_tok’_t
 *
tok’
)

1102 cÚ¡ *
found
;

1104 
	`¡rbuf_ä“
(
jsÚ
->
tmp
);

1106 ià(
tok’
->
ty³
 =ğ
T_ERROR
)

1107 
found
 = 
tok’
->
v®ue
.
¡ršg
;

1109 
found
 = 
jsÚ_tok’_ty³_Çme
[
tok’
->
ty³
];

1112 
	`luaL_”rÜ
(
l
, "Expected %s but found %s‡t character %d",

1113 
exp
, 
found
, 
tok’
->
šdex
 + 1);

1114 
	}
}

1116 
šlše
 
	$jsÚ_decode_asûnd
(
jsÚ_·r£_t
 *
jsÚ
)

1118 
jsÚ
->
cu¼’t_d•th
--;

1119 
	}
}

1121 
	$jsÚ_decode_desûnd
(
lua_S‹
 *
l
, 
jsÚ_·r£_t
 *
jsÚ
, 
¦Ùs
)

1123 
jsÚ
->
cu¼’t_d•th
++;

1125 ià(
jsÚ
->
cu¼’t_d•th
 <ğjsÚ->
cfg
->
decode_max_d•th
 &&

1126 
	`lua_check¡ack
(
l
, 
¦Ùs
)) {

1130 
	`¡rbuf_ä“
(
jsÚ
->
tmp
);

1131 
	`luaL_”rÜ
(
l
, "Foundoo many‚ested data structures (%d)‡t character %d",

1132 
jsÚ
->
cu¼’t_d•th
, jsÚ->
±r
 - jsÚ->
d©a
);

1133 
	}
}

1135 
	$jsÚ_·r£_objeù_cÚ‹xt
(
lua_S‹
 *
l
, 
jsÚ_·r£_t
 *
jsÚ
)

1137 
jsÚ_tok’_t
 
tok’
;

1141 
	`jsÚ_decode_desûnd
(
l
, 
jsÚ
, 3);

1143 
	`lua_ÃwbË
(
l
);

1145 
	`jsÚ_Ãxt_tok’
(
jsÚ
, &
tok’
);

1148 ià(
tok’
.
ty³
 =ğ
T_OBJ_END
) {

1149 
	`jsÚ_decode_asûnd
(
jsÚ
);

1154 ià(
tok’
.
ty³
 !ğ
T_STRING
)

1155 
	`jsÚ_throw_·r£_”rÜ
(
l
, 
jsÚ
, "objeù key sŒšg", &
tok’
);

1158 
	`lua_pushl¡ršg
(
l
, 
tok’
.
v®ue
.
¡ršg
,ok’.
¡ršg_Ën
);

1160 
	`jsÚ_Ãxt_tok’
(
jsÚ
, &
tok’
);

1161 ià(
tok’
.
ty³
 !ğ
T_COLON
)

1162 
	`jsÚ_throw_·r£_”rÜ
(
l
, 
jsÚ
, "cŞÚ", &
tok’
);

1165 
	`jsÚ_Ãxt_tok’
(
jsÚ
, &
tok’
);

1166 
	`jsÚ_´oûss_v®ue
(
l
, 
jsÚ
, &
tok’
);

1169 
	`lua_¿w£t
(
l
, -3);

1171 
	`jsÚ_Ãxt_tok’
(
jsÚ
, &
tok’
);

1173 ià(
tok’
.
ty³
 =ğ
T_OBJ_END
) {

1174 
	`jsÚ_decode_asûnd
(
jsÚ
);

1178 ià(
tok’
.
ty³
 !ğ
T_COMMA
)

1179 
	`jsÚ_throw_·r£_”rÜ
(
l
, 
jsÚ
, "comm¨Ü objeùƒnd", &
tok’
);

1181 
	`jsÚ_Ãxt_tok’
(
jsÚ
, &
tok’
);

1183 
	}
}

1186 
	$jsÚ_·r£_¬¿y_cÚ‹xt
(
lua_S‹
 *
l
, 
jsÚ_·r£_t
 *
jsÚ
)

1188 
jsÚ_tok’_t
 
tok’
;

1189 
i
;

1193 
	`jsÚ_decode_desûnd
(
l
, 
jsÚ
, 2);

1195 
	`lua_ÃwbË
(
l
);

1197 
	`jsÚ_Ãxt_tok’
(
jsÚ
, &
tok’
);

1200 ià(
tok’
.
ty³
 =ğ
T_ARR_END
) {

1201 
	`jsÚ_decode_asûnd
(
jsÚ
);

1205 
i
 = 1; ; i++) {

1206 
	`jsÚ_´oûss_v®ue
(
l
, 
jsÚ
, &
tok’
);

1207 
	`lua_¿w£ti
(
l
, -2, 
i
);

1209 
	`jsÚ_Ãxt_tok’
(
jsÚ
, &
tok’
);

1211 ià(
tok’
.
ty³
 =ğ
T_ARR_END
) {

1212 
	`jsÚ_decode_asûnd
(
jsÚ
);

1216 ià(
tok’
.
ty³
 !ğ
T_COMMA
)

1217 
	`jsÚ_throw_·r£_”rÜ
(
l
, 
jsÚ
, "comm¨Ü‡¼ayƒnd", &
tok’
);

1219 
	`jsÚ_Ãxt_tok’
(
jsÚ
, &
tok’
);

1221 
	}
}

1224 
	$jsÚ_´oûss_v®ue
(
lua_S‹
 *
l
, 
jsÚ_·r£_t
 *
jsÚ
,

1225 
jsÚ_tok’_t
 *
tok’
)

1227 
tok’
->
ty³
) {

1228 
T_STRING
:

1229 
	`lua_pushl¡ršg
(
l
, 
tok’
->
v®ue
.
¡ršg
,ok’->
¡ršg_Ën
);

1231 
T_NUMBER
:

1232 
	`lua_pushnumb”
(
l
, 
tok’
->
v®ue
.
numb”
);

1234 
T_BOOLEAN
:

1235 
	`lua_pushboŞ—n
(
l
, 
tok’
->
v®ue
.
boŞ—n
);

1237 
T_OBJ_BEGIN
:

1238 
	`jsÚ_·r£_objeù_cÚ‹xt
(
l
, 
jsÚ
);

1240 
T_ARR_BEGIN
:

1241 
	`jsÚ_·r£_¬¿y_cÚ‹xt
(
l
, 
jsÚ
);

1243 
T_NULL
:

1246 
	`lua_pushlightu£rd©a
(
l
, 
NULL
);

1249 
	`jsÚ_throw_·r£_”rÜ
(
l
, 
jsÚ
, "v®ue", 
tok’
);

1251 
	}
}

1253 
	$jsÚ_decode
(
lua_S‹
 *
l
)

1255 
jsÚ_·r£_t
 
jsÚ
;

1256 
jsÚ_tok’_t
 
tok’
;

1257 
size_t
 
jsÚ_Ën
;

1259 
	`luaL_¬gcheck
(
l
, 
	`lua_g‘tİ
(l) == 1, 1, "expected 1‡rgument");

1261 
jsÚ
.
cfg
 = 
	`jsÚ_ãtch_cÚfig
(
l
);

1262 
jsÚ
.
d©a
 = 
	`luaL_checkl¡ršg
(
l
, 1, &
jsÚ_Ën
);

1263 
jsÚ
.
cu¼’t_d•th
 = 0;

1264 
jsÚ
.
±r
 = jsÚ.
d©a
;

1271 ià(
jsÚ_Ën
 >ğ2 && (!
jsÚ
.
d©a
[0] || !json.data[1]))

1272 
	`luaL_”rÜ
(
l
, "JSON…arser does‚ot support UTF-16 or UTF-32");

1277 
jsÚ
.
tmp
 = 
	`¡rbuf_Ãw
(
jsÚ_Ën
);

1279 
	`jsÚ_Ãxt_tok’
(&
jsÚ
, &
tok’
);

1280 
	`jsÚ_´oûss_v®ue
(
l
, &
jsÚ
, &
tok’
);

1283 
	`jsÚ_Ãxt_tok’
(&
jsÚ
, &
tok’
);

1285 ià(
tok’
.
ty³
 !ğ
T_END
)

1286 
	`jsÚ_throw_·r£_”rÜ
(
l
, &
jsÚ
, "th’d", &
tok’
);

1288 
	`¡rbuf_ä“
(
jsÚ
.
tmp
);

1291 
	}
}

1295 #ià!
defšed
(
LUA_VERSION_NUM
) || LUA_VERSION_NUM < 502

1300 
	$luaL_£tfuncs
 (
lua_S‹
 *
l
, cÚ¡ 
luaL_Reg
 *
»g
, 
nup
)

1302 
i
;

1304 
	`luaL_check¡ack
(
l
, 
nup
, "too many upvalues");

1305 ; 
»g
->
Çme
 !ğ
NULL
;„eg++) {

1306 
i
 = 0; i < 
nup
; i++)

1307 
	`lua_pushv®ue
(
l
, -
nup
);

1308 
	`lua_pushcşosu»
(
l
, 
»g
->
func
, 
nup
);

1309 
	`lua_£tf›ld
(
l
, -(
nup
 + 2), 
»g
->
Çme
);

1311 
	`lua_pİ
(
l
, 
nup
);

1312 
	}
}

1318 
	$jsÚ_´Ùeù_cÚv”siÚ
(
lua_S‹
 *
l
)

1320 
”r
;

1323 
	`luaL_¬gcheck
(
l
, 
	`lua_g‘tİ
(l) == 1, 1, "expected 1‡rgument");

1326 
	`lua_pushv®ue
(
l
, 
	`lua_upv®uešdex
(1));

1327 
	`lua_š£¹
(
l
, 1);

1328 
”r
 = 
	`lua_pÿÎ
(
l
, 1, 1, 0);

1329 ià(!
”r
)

1332 ià(
”r
 =ğ
LUA_ERRRUN
) {

1333 
	`lua_pushn
(
l
);

1334 
	`lua_š£¹
(
l
, -2);

1340  
	`luaL_”rÜ
(
l
, "Memory‡llocationƒrror in CJSON…rotected call");

1341 
	}
}

1344 
	$lua_cjsÚ_Ãw
(
lua_S‹
 *
l
)

1346 
luaL_Reg
 
»g
[] = {

1347 { "’code", 
jsÚ_’code
 },

1348 { "decode", 
jsÚ_decode
 },

1349 { "’code_¥¬£_¬¿y", 
jsÚ_cfg_’code_¥¬£_¬¿y
 },

1350 { "’code_max_d•th", 
jsÚ_cfg_’code_max_d•th
 },

1351 { "decode_max_d•th", 
jsÚ_cfg_decode_max_d•th
 },

1352 { "’code_numb”_´ecisiÚ", 
jsÚ_cfg_’code_numb”_´ecisiÚ
 },

1353 { "’code_k“p_bufãr", 
jsÚ_cfg_’code_k“p_bufãr
 },

1354 { "’code_šv®id_numb”s", 
jsÚ_cfg_’code_šv®id_numb”s
 },

1355 { "decode_šv®id_numb”s", 
jsÚ_cfg_decode_šv®id_numb”s
 },

1356 { "Ãw", 
lua_cjsÚ_Ãw
 },

1357 { 
NULL
, NULL }

1361 
	`åcÚv_š™
();

1364 
	`lua_ÃwbË
(
l
);

1367 
	`jsÚ_ü—‹_cÚfig
(
l
);

1368 
	`luaL_£tfuncs
(
l
, 
»g
, 1);

1371 
	`lua_pushlightu£rd©a
(
l
, 
NULL
);

1372 
	`lua_£tf›ld
(
l
, -2, "null");

1375 
	`lua_pushl™”®
(
l
, 
CJSON_MODNAME
);

1376 
	`lua_£tf›ld
(
l
, -2, "_NAME");

1377 
	`lua_pushl™”®
(
l
, 
CJSON_VERSION
);

1378 
	`lua_£tf›ld
(
l
, -2, "_VERSION");

1381 
	}
}

1384 
	$lua_cjsÚ_§ã_Ãw
(
lua_S‹
 *
l
)

1386 cÚ¡ *
func
[] = { "decode", "’code", 
NULL
 };

1387 
i
;

1389 
	`lua_cjsÚ_Ãw
(
l
);

1392 
	`lua_pushcfunùiÚ
(
l
, 
lua_cjsÚ_§ã_Ãw
);

1393 
	`lua_£tf›ld
(
l
, -2, "new");

1395 
i
 = 0; 
func
[i]; i++) {

1396 
	`lua_g‘f›ld
(
l
, -1, 
func
[
i
]);

1397 
	`lua_pushcşosu»
(
l
, 
jsÚ_´Ùeù_cÚv”siÚ
, 1);

1398 
	`lua_£tf›ld
(
l
, -2, 
func
[
i
]);

1402 
	}
}

1404 
	$luaİ’_cjsÚ
(
lua_S‹
 *
l
)

1406 
	`lua_cjsÚ_Ãw
(
l
);

1408 #ifdeà
ENABLE_CJSON_GLOBAL


1410 
	`lua_pushv®ue
(
l
, -1);

1411 
	`lua_£tglob®
(
l
, 
CJSON_MODNAME
);

1416 
	}
}

1418 
	$luaİ’_cjsÚ_§ã
(
lua_S‹
 *
l
)

1420 
	`lua_cjsÚ_§ã_Ãw
(
l
);

1424 
	}
}

	@deps/lua/src/lua_cmsgpack.c

1 
	~<m©h.h
>

2 
	~<¡dlib.h
>

3 
	~<¡dšt.h
>

4 
	~<¡ršg.h
>

5 
	~<as£¹.h
>

7 
	~"lua.h
"

8 
	~"Ïuxlib.h
"

10 
	#LUACMSGPACK_NAME
 "cmsg·ck"

	)

11 
	#LUACMSGPACK_SAFE_NAME
 "cmsg·ck_§ã"

	)

12 
	#LUACMSGPACK_VERSION
 "lua-cmsg·ck 0.4.0"

	)

13 
	#LUACMSGPACK_COPYRIGHT
 "Cİyrighˆ(Cè2012, S®v©ÜSªfpo"

	)

14 
	#LUACMSGPACK_DESCRIPTION
 "Mes§gePack C im¶em’tiÚ fÜ Lua"

	)

17 #iâdeà
LUACMSGPACK_MAX_NESTING


18 
	#LUACMSGPACK_MAX_NESTING
 16

	)

22 
	#IS_INT_TYPE_EQUIVALENT
(
x
, 
T
è(!
	`isšf
(xè&& (T)(xè=ğ(x))

	)

24 
	#IS_INT64_EQUIVALENT
(
x
è
	`IS_INT_TYPE_EQUIVALENT
(x, 
št64_t
)

	)

25 
	#IS_INT_EQUIVALENT
(
x
è
	`IS_INT_TYPE_EQUIVALENT
(x, )

	)

28 #ià
UINTPTR_MAX
 =ğ
UINT_MAX


29 
	#BITS_32
 1

	)

31 
	#BITS_32
 0

	)

34 #ià
BITS_32


35 
	#lua_pushunsigÃd
(
L
, 
n
è
	`lua_pushnumb”
(L,‚)

	)

37 
	#lua_pushunsigÃd
(
L
, 
n
è
	`lua_pushš‹g”
(L,‚)

	)

69 
	$mem»viæe
(*
±r
, 
size_t
 
Ën
) {

70 *
p
 = (*)
±r
,

71 *
e
 = (*)
p
+
Ën
-1,

72 
aux
;

73 
‹¡
 = 1;

74 *
‹¡p
 = (*è&
‹¡
;

76 ià(
‹¡p
[0] == 0) ;

77 
Ën
 /= 2;

78 
Ën
--) {

79 
aux
 = *
p
;

80 *
p
 = *
e
;

81 *
e
 = 
aux
;

82 
p
++;

83 
e
--;

85 
	}
}

93 
	smp_buf
 {

94 *
	mb
;

95 
size_t
 
	mËn
, 
	mä“
;

96 } 
	tmp_buf
;

98 *
	$mp_»®loc
(
lua_S‹
 *
L
, *
rg‘
, 
size_t
 
osize
,size_ˆ
nsize
) {

99 *(*
loÿl_»®loc
è(*, *, 
size_t
 
osize
, size_ˆ
nsize
èğ
NULL
;

100 *
ud
;

102 
loÿl_»®loc
 = 
	`lua_g‘®locf
(
L
, &
ud
);

104  
	`loÿl_»®loc
(
ud
, 
rg‘
, 
osize
, 
nsize
);

105 
	}
}

107 
mp_buf
 *
	$mp_buf_Ãw
(
lua_S‹
 *
L
) {

108 
mp_buf
 *
buf
 = 
NULL
;

111 
buf
 = (
mp_buf
*)
	`mp_»®loc
(
L
, 
NULL
, 0, (*buf));

113 
buf
->
b
 = 
NULL
;

114 
buf
->
Ën
 = buf->
ä“
 = 0;

115  
buf
;

116 
	}
}

118 
	$mp_buf_­³nd
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, cÚ¡ *
s
, 
size_t
 
Ën
) {

119 ià(
buf
->
ä“
 < 
Ën
) {

120 
size_t
 
Ãwsize
 = (
buf
->
Ën
+len)*2;

122 
buf
->
b
 = (*)
	`mp_»®loc
(
L
, buf->b, buf->
Ën
 + buf->
ä“
, 
Ãwsize
);

123 
buf
->
ä“
 = 
Ãwsize
 - buf->
Ën
;

125 
	`memıy
(
buf
->
b
+buf->
Ën
,
s
,len);

126 
buf
->
Ën
 +=†en;

127 
buf
->
ä“
 -ğ
Ën
;

128 
	}
}

130 
	$mp_buf_ä“
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
) {

131 
	`mp_»®loc
(
L
, 
buf
->
b
, buf->
Ën
 + buf->
ä“
, 0);

132 
	`mp_»®loc
(
L
, 
buf
, (*buf), 0);

133 
	}
}

144 
	#MP_CUR_ERROR_NONE
 0

	)

145 
	#MP_CUR_ERROR_EOF
 1

	)

146 
	#MP_CUR_ERROR_BADFMT
 2

	)

148 
	smp_cur
 {

149 cÚ¡ *
	mp
;

150 
size_t
 
	mËá
;

151 
	m”r
;

152 } 
	tmp_cur
;

154 
	$mp_cur_š™
(
mp_cur
 *
cursÜ
, cÚ¡ *
s
, 
size_t
 
Ën
) {

155 
cursÜ
->
p
 = 
s
;

156 
cursÜ
->
Ëá
 = 
Ën
;

157 
cursÜ
->
”r
 = 
MP_CUR_ERROR_NONE
;

158 
	}
}

160 
	#mp_cur_cÚsume
(
_c
,
_Ën
èdØ{ _c->
p
 +ğ_Ën; _c->
Ëá
 -ğ_Ën; } 0)

	)

165 
	#mp_cur_Ãed
(
_c
,
_Ën
) do { \

166 ià(
_c
->
Ëá
 < 
_Ën
) { \

167 
_c
->
”r
 = 
MP_CUR_ERROR_EOF
; \

170 } 0)

	)

174 
	$mp_’code_by‹s
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, cÚ¡ *
s
, 
size_t
 
Ën
) {

175 
hdr
[5];

176 
hd¾’
;

178 ià(
Ën
 < 32) {

179 
hdr
[0] = 0xa0 | (
Ën
&0xff);

180 
hd¾’
 = 1;

181 } ià(
Ën
 <= 0xff) {

182 
hdr
[0] = 0xd9;

183 
hdr
[1] = 
Ën
;

184 
hd¾’
 = 2;

185 } ià(
Ën
 <= 0xffff) {

186 
hdr
[0] = 0xda;

187 
hdr
[1] = (
Ën
&0xff00)>>8;

188 
hdr
[2] = 
Ën
&0xff;

189 
hd¾’
 = 3;

191 
hdr
[0] = 0xdb;

192 
hdr
[1] = (
Ën
&0xff000000)>>24;

193 
hdr
[2] = (
Ën
&0xff0000)>>16;

194 
hdr
[3] = (
Ën
&0xff00)>>8;

195 
hdr
[4] = 
Ën
&0xff;

196 
hd¾’
 = 5;

198 
	`mp_buf_­³nd
(
L
,
buf
,
hdr
,
hd¾’
);

199 
	`mp_buf_­³nd
(
L
,
buf
,
s
,
Ën
);

200 
	}
}

203 
	$mp_’code_doubË
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, 
d
) {

204 
b
[9];

205 
f
 = 
d
;

207 
	`as£¹
((
f
è=ğ4 && (
d
) == 8);

208 ià(
d
 =ğ()
f
) {

209 
b
[0] = 0xca;

210 
	`memıy
(
b
+1,&
f
,4);

211 
	`mem»viæe
(
b
+1,4);

212 
	`mp_buf_­³nd
(
L
,
buf
,
b
,5);

213 } ià((
d
) == 8) {

214 
b
[0] = 0xcb;

215 
	`memıy
(
b
+1,&
d
,8);

216 
	`mem»viæe
(
b
+1,8);

217 
	`mp_buf_­³nd
(
L
,
buf
,
b
,9);

219 
	}
}

221 
	$mp_’code_št
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, 
št64_t
 
n
) {

222 
b
[9];

223 
’ş’
;

225 ià(
n
 >= 0) {

226 ià(
n
 <= 127) {

227 
b
[0] = 
n
 & 0x7f;

228 
’ş’
 = 1;

229 } ià(
n
 <= 0xff) {

230 
b
[0] = 0xcc;

231 
b
[1] = 
n
 & 0xff;

232 
’ş’
 = 2;

233 } ià(
n
 <= 0xffff) {

234 
b
[0] = 0xcd;

235 
b
[1] = (
n
 & 0xff00) >> 8;

236 
b
[2] = 
n
 & 0xff;

237 
’ş’
 = 3;

238 } ià(
n
 <= 0xffffffffLL) {

239 
b
[0] = 0xce;

240 
b
[1] = (
n
 & 0xff000000) >> 24;

241 
b
[2] = (
n
 & 0xff0000) >> 16;

242 
b
[3] = (
n
 & 0xff00) >> 8;

243 
b
[4] = 
n
 & 0xff;

244 
’ş’
 = 5;

246 
b
[0] = 0xcf;

247 
b
[1] = (
n
 & 0xff00000000000000LL) >> 56;

248 
b
[2] = (
n
 & 0xff000000000000LL) >> 48;

249 
b
[3] = (
n
 & 0xff0000000000LL) >> 40;

250 
b
[4] = (
n
 & 0xff00000000LL) >> 32;

251 
b
[5] = (
n
 & 0xff000000) >> 24;

252 
b
[6] = (
n
 & 0xff0000) >> 16;

253 
b
[7] = (
n
 & 0xff00) >> 8;

254 
b
[8] = 
n
 & 0xff;

255 
’ş’
 = 9;

258 ià(
n
 >= -32) {

259 
b
[0] = ((sigÃd )
n
);

260 
’ş’
 = 1;

261 } ià(
n
 >= -128) {

262 
b
[0] = 0xd0;

263 
b
[1] = 
n
 & 0xff;

264 
’ş’
 = 2;

265 } ià(
n
 >= -32768) {

266 
b
[0] = 0xd1;

267 
b
[1] = (
n
 & 0xff00) >> 8;

268 
b
[2] = 
n
 & 0xff;

269 
’ş’
 = 3;

270 } ià(
n
 >= -2147483648LL) {

271 
b
[0] = 0xd2;

272 
b
[1] = (
n
 & 0xff000000) >> 24;

273 
b
[2] = (
n
 & 0xff0000) >> 16;

274 
b
[3] = (
n
 & 0xff00) >> 8;

275 
b
[4] = 
n
 & 0xff;

276 
’ş’
 = 5;

278 
b
[0] = 0xd3;

279 
b
[1] = (
n
 & 0xff00000000000000LL) >> 56;

280 
b
[2] = (
n
 & 0xff000000000000LL) >> 48;

281 
b
[3] = (
n
 & 0xff0000000000LL) >> 40;

282 
b
[4] = (
n
 & 0xff00000000LL) >> 32;

283 
b
[5] = (
n
 & 0xff000000) >> 24;

284 
b
[6] = (
n
 & 0xff0000) >> 16;

285 
b
[7] = (
n
 & 0xff00) >> 8;

286 
b
[8] = 
n
 & 0xff;

287 
’ş’
 = 9;

290 
	`mp_buf_­³nd
(
L
,
buf
,
b
,
’ş’
);

291 
	}
}

293 
	$mp_’code_¬¿y
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, 
št64_t
 
n
) {

294 
b
[5];

295 
’ş’
;

297 ià(
n
 <= 15) {

298 
b
[0] = 0x90 | (
n
 & 0xf);

299 
’ş’
 = 1;

300 } ià(
n
 <= 65535) {

301 
b
[0] = 0xdc;

302 
b
[1] = (
n
 & 0xff00) >> 8;

303 
b
[2] = 
n
 & 0xff;

304 
’ş’
 = 3;

306 
b
[0] = 0xdd;

307 
b
[1] = (
n
 & 0xff000000) >> 24;

308 
b
[2] = (
n
 & 0xff0000) >> 16;

309 
b
[3] = (
n
 & 0xff00) >> 8;

310 
b
[4] = 
n
 & 0xff;

311 
’ş’
 = 5;

313 
	`mp_buf_­³nd
(
L
,
buf
,
b
,
’ş’
);

314 
	}
}

316 
	$mp_’code_m­
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, 
št64_t
 
n
) {

317 
b
[5];

318 
’ş’
;

320 ià(
n
 <= 15) {

321 
b
[0] = 0x80 | (
n
 & 0xf);

322 
’ş’
 = 1;

323 } ià(
n
 <= 65535) {

324 
b
[0] = 0xde;

325 
b
[1] = (
n
 & 0xff00) >> 8;

326 
b
[2] = 
n
 & 0xff;

327 
’ş’
 = 3;

329 
b
[0] = 0xdf;

330 
b
[1] = (
n
 & 0xff000000) >> 24;

331 
b
[2] = (
n
 & 0xff0000) >> 16;

332 
b
[3] = (
n
 & 0xff00) >> 8;

333 
b
[4] = 
n
 & 0xff;

334 
’ş’
 = 5;

336 
	`mp_buf_­³nd
(
L
,
buf
,
b
,
’ş’
);

337 
	}
}

341 
	$mp_’code_lua_¡ršg
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
) {

342 
size_t
 
Ën
;

343 cÚ¡ *
s
;

345 
s
 = 
	`lua_tŞ¡ršg
(
L
,-1,&
Ën
);

346 
	`mp_’code_by‹s
(
L
,
buf
,(cÚ¡ *)
s
,
Ën
);

347 
	}
}

349 
	$mp_’code_lua_boŞ
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
) {

350 
b
 = 
	`lua_toboŞ—n
(
L
,-1) ? 0xc3 : 0xc2;

351 
	`mp_buf_­³nd
(
L
,
buf
,&
b
,1);

352 
	}
}

355 
	$mp_’code_lua_š‹g”
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
) {

356 #ià(
LUA_VERSION_NUM
 < 503è&& 
BITS_32


357 
lua_Numb”
 
i
 = 
	`lua_tÚumb”
(
L
,-1);

359 
lua_IÁeg”
 
i
 = 
	`lua_toš‹g”
(
L
,-1);

361 
	`mp_’code_št
(
L
, 
buf
, (
št64_t
)
i
);

362 
	}
}

367 
	$mp_’code_lua_numb”
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
) {

368 
lua_Numb”
 
n
 = 
	`lua_tÚumb”
(
L
,-1);

370 ià(
	`IS_INT64_EQUIVALENT
(
n
)) {

371 
	`mp_’code_lua_š‹g”
(
L
, 
buf
);

373 
	`mp_’code_doubË
(
L
,
buf
,()
n
);

375 
	}
}

377 
mp_’code_lua_ty³
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, 
Ëv–
);

380 
	$mp_’code_lua_bË_as_¬¿y
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, 
Ëv–
) {

381 #ià
LUA_VERSION_NUM
 < 502

382 
size_t
 
Ën
 = 
	`lua_objËn
(
L
,-1), 
j
;

384 
size_t
 
Ën
 = 
	`lua_¿wËn
(
L
,-1), 
j
;

387 
	`mp_’code_¬¿y
(
L
,
buf
,
Ën
);

388 
j
 = 1; j <ğ
Ën
; j++) {

389 
	`lua_pushnumb”
(
L
,
j
);

390 
	`lua_g‘bË
(
L
,-2);

391 
	`mp_’code_lua_ty³
(
L
,
buf
,
Ëv–
+1);

393 
	}
}

396 
	$mp_’code_lua_bË_as_m­
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, 
Ëv–
) {

397 
size_t
 
Ën
 = 0;

403 
	`lua_pushn
(
L
);

404 
	`lua_Ãxt
(
L
,-2)) {

405 
	`lua_pİ
(
L
,1);

406 
Ën
++;

410 
	`mp_’code_m­
(
L
,
buf
,
Ën
);

411 
	`lua_pushn
(
L
);

412 
	`lua_Ãxt
(
L
,-2)) {

414 
	`lua_pushv®ue
(
L
,-2);

415 
	`mp_’code_lua_ty³
(
L
,
buf
,
Ëv–
+1);

416 
	`mp_’code_lua_ty³
(
L
,
buf
,
Ëv–
+1);

418 
	}
}

423 
	$bË_is_ª_¬¿y
(
lua_S‹
 *
L
) {

424 
couÁ
 = 0, 
max
 = 0;

425 #ià
LUA_VERSION_NUM
 < 503

426 
lua_Numb”
 
n
;

428 
lua_IÁeg”
 
n
;

432 
¡acktİ
;

434 
¡acktİ
 = 
	`lua_g‘tİ
(
L
);

436 
	`lua_pushn
(
L
);

437 
	`lua_Ãxt
(
L
,-2)) {

439 
	`lua_pİ
(
L
,1);

441 #ià
LUA_VERSION_NUM
 < 503

442 ià((
LUA_TNUMBER
 !ğ
	`lua_ty³
(
L
,-1)è|| (
n
 = 
	`lua_tÚumb”
(L, -1)) <= 0 ||

443 !
	`IS_INT_EQUIVALENT
(
n
))

445 ià(!
	`lua_isš‹g”
(
L
,-1è|| (
n
 = 
	`lua_toš‹g”
(L, -1)) <= 0)

448 
	`lua_£‰İ
(
L
, 
¡acktİ
);

451 
max
 = (
n
 > max ?‚ : max);

452 
couÁ
++;

459 
	`lua_£‰İ
(
L
, 
¡acktİ
);

460  
max
 =ğ
couÁ
;

461 
	}
}

466 
	$mp_’code_lua_bË
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, 
Ëv–
) {

467 ià(
	`bË_is_ª_¬¿y
(
L
))

468 
	`mp_’code_lua_bË_as_¬¿y
(
L
,
buf
,
Ëv–
);

470 
	`mp_’code_lua_bË_as_m­
(
L
,
buf
,
Ëv–
);

471 
	}
}

473 
	$mp_’code_lua_nuÎ
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
) {

474 
b
[1];

476 
b
[0] = 0xc0;

477 
	`mp_buf_­³nd
(
L
,
buf
,
b
,1);

478 
	}
}

480 
	$mp_’code_lua_ty³
(
lua_S‹
 *
L
, 
mp_buf
 *
buf
, 
Ëv–
) {

481 
t
 = 
	`lua_ty³
(
L
,-1);

485 ià(
t
 =ğ
LUA_TTABLE
 && 
Ëv–
 =ğ
LUACMSGPACK_MAX_NESTING
èˆğ
LUA_TNIL
;

486 
t
) {

487 
LUA_TSTRING
: 
	`mp_’code_lua_¡ršg
(
L
,
buf
); ;

488 
LUA_TBOOLEAN
: 
	`mp_’code_lua_boŞ
(
L
,
buf
); ;

489 
LUA_TNUMBER
:

490 #ià
LUA_VERSION_NUM
 < 503

491 
	`mp_’code_lua_numb”
(
L
,
buf
); ;

493 ià(
	`lua_isš‹g”
(
L
, -1)) {

494 
	`mp_’code_lua_š‹g”
(
L
, 
buf
);

496 
	`mp_’code_lua_numb”
(
L
, 
buf
);

500 
LUA_TTABLE
: 
	`mp_’code_lua_bË
(
L
,
buf
,
Ëv–
); ;

501 : 
	`mp_’code_lua_nuÎ
(
L
,
buf
); ;

503 
	`lua_pİ
(
L
,1);

504 
	}
}

510 
	$mp_·ck
(
lua_S‹
 *
L
) {

511 
Çrgs
 = 
	`lua_g‘tİ
(
L
);

512 
i
;

513 
mp_buf
 *
buf
;

515 ià(
Çrgs
 == 0)

516  
	`luaL_¬g”rÜ
(
L
, 0, "MessagePack…ack‚eeds input.");

518 
buf
 = 
	`mp_buf_Ãw
(
L
);

519 
i
 = 1; i <ğ
Çrgs
; i++) {

522 
	`lua_pushv®ue
(
L
, 
i
);

524 
	`mp_’code_lua_ty³
(
L
,
buf
,0);

526 
	`lua_pushl¡ršg
(
L
,(*)
buf
->
b
,buf->
Ën
);

531 
buf
->
ä“
 +ğbuf->
Ën
;

532 
buf
->
Ën
 = 0;

534 
	`mp_buf_ä“
(
L
, 
buf
);

537 
	`lua_cÚÿt
(
L
, 
Çrgs
);

539 
	}
}

543 
mp_decode_to_lua_ty³
(
lua_S‹
 *
L
, 
mp_cur
 *
c
);

545 
	$mp_decode_to_lua_¬¿y
(
lua_S‹
 *
L
, 
mp_cur
 *
c
, 
size_t
 
Ën
) {

546 
	`as£¹
(
Ën
 <ğ
UINT_MAX
);

547 
šdex
 = 1;

549 
	`lua_ÃwbË
(
L
);

550 
Ën
--) {

551 
	`lua_pushnumb”
(
L
,
šdex
++);

552 
	`mp_decode_to_lua_ty³
(
L
,
c
);

553 ià(
c
->
”r
) ;

554 
	`lua_£‰abË
(
L
,-3);

556 
	}
}

558 
	$mp_decode_to_lua_hash
(
lua_S‹
 *
L
, 
mp_cur
 *
c
, 
size_t
 
Ën
) {

559 
	`as£¹
(
Ën
 <ğ
UINT_MAX
);

560 
	`lua_ÃwbË
(
L
);

561 
Ën
--) {

562 
	`mp_decode_to_lua_ty³
(
L
,
c
);

563 ià(
c
->
”r
) ;

564 
	`mp_decode_to_lua_ty³
(
L
,
c
);

565 ià(
c
->
”r
) ;

566 
	`lua_£‰abË
(
L
,-3);

568 
	}
}

572 
	$mp_decode_to_lua_ty³
(
lua_S‹
 *
L
, 
mp_cur
 *
c
) {

573 
	`mp_cur_Ãed
(
c
,1);

580 
	`luaL_check¡ack
(
L
, 1,

584 
c
->
p
[0]) {

586 
	`mp_cur_Ãed
(
c
,2);

587 
	`lua_pushunsigÃd
(
L
,
c
->
p
[1]);

588 
	`mp_cur_cÚsume
(
c
,2);

591 
	`mp_cur_Ãed
(
c
,2);

592 
	`lua_pushš‹g”
(
L
,(sigÃd )
c
->
p
[1]);

593 
	`mp_cur_cÚsume
(
c
,2);

596 
	`mp_cur_Ãed
(
c
,3);

597 
	`lua_pushunsigÃd
(
L
,

598 (
c
->
p
[1] << 8) |

599 
c
->
p
[2]);

600 
	`mp_cur_cÚsume
(
c
,3);

603 
	`mp_cur_Ãed
(
c
,3);

604 
	`lua_pushš‹g”
(
L
,(
št16_t
)

605 (
c
->
p
[1] << 8) |

606 
c
->
p
[2]);

607 
	`mp_cur_cÚsume
(
c
,3);

610 
	`mp_cur_Ãed
(
c
,5);

611 
	`lua_pushunsigÃd
(
L
,

612 ((
ušt32_t
)
c
->
p
[1] << 24) |

613 ((
ušt32_t
)
c
->
p
[2] << 16) |

614 ((
ušt32_t
)
c
->
p
[3] << 8) |

615 (
ušt32_t
)
c
->
p
[4]);

616 
	`mp_cur_cÚsume
(
c
,5);

619 
	`mp_cur_Ãed
(
c
,5);

620 
	`lua_pushš‹g”
(
L
,

621 ((
št32_t
)
c
->
p
[1] << 24) |

622 ((
št32_t
)
c
->
p
[2] << 16) |

623 ((
št32_t
)
c
->
p
[3] << 8) |

624 (
št32_t
)
c
->
p
[4]);

625 
	`mp_cur_cÚsume
(
c
,5);

628 
	`mp_cur_Ãed
(
c
,9);

629 
	`lua_pushunsigÃd
(
L
,

630 ((
ušt64_t
)
c
->
p
[1] << 56) |

631 ((
ušt64_t
)
c
->
p
[2] << 48) |

632 ((
ušt64_t
)
c
->
p
[3] << 40) |

633 ((
ušt64_t
)
c
->
p
[4] << 32) |

634 ((
ušt64_t
)
c
->
p
[5] << 24) |

635 ((
ušt64_t
)
c
->
p
[6] << 16) |

636 ((
ušt64_t
)
c
->
p
[7] << 8) |

637 (
ušt64_t
)
c
->
p
[8]);

638 
	`mp_cur_cÚsume
(
c
,9);

641 
	`mp_cur_Ãed
(
c
,9);

642 #ià
LUA_VERSION_NUM
 < 503

643 
	`lua_pushnumb”
(
L
,

645 
	`lua_pushš‹g”
(
L
,

647 ((
št64_t
)
c
->
p
[1] << 56) |

648 ((
št64_t
)
c
->
p
[2] << 48) |

649 ((
št64_t
)
c
->
p
[3] << 40) |

650 ((
št64_t
)
c
->
p
[4] << 32) |

651 ((
št64_t
)
c
->
p
[5] << 24) |

652 ((
št64_t
)
c
->
p
[6] << 16) |

653 ((
št64_t
)
c
->
p
[7] << 8) |

654 (
št64_t
)
c
->
p
[8]);

655 
	`mp_cur_cÚsume
(
c
,9);

658 
	`lua_pushn
(
L
);

659 
	`mp_cur_cÚsume
(
c
,1);

662 
	`lua_pushboŞ—n
(
L
,1);

663 
	`mp_cur_cÚsume
(
c
,1);

666 
	`lua_pushboŞ—n
(
L
,0);

667 
	`mp_cur_cÚsume
(
c
,1);

670 
	`mp_cur_Ãed
(
c
,5);

671 
	`as£¹
(() == 4);

673 
f
;

674 
	`memıy
(&
f
,
c
->
p
+1,4);

675 
	`mem»viæe
(&
f
,4);

676 
	`lua_pushnumb”
(
L
,
f
);

677 
	`mp_cur_cÚsume
(
c
,5);

681 
	`mp_cur_Ãed
(
c
,9);

682 
	`as£¹
(() == 8);

684 
d
;

685 
	`memıy
(&
d
,
c
->
p
+1,8);

686 
	`mem»viæe
(&
d
,8);

687 
	`lua_pushnumb”
(
L
,
d
);

688 
	`mp_cur_cÚsume
(
c
,9);

692 
	`mp_cur_Ãed
(
c
,2);

694 
size_t
 
l
 = 
c
->
p
[1];

695 
	`mp_cur_Ãed
(
c
,2+
l
);

696 
	`lua_pushl¡ršg
(
L
,(*)
c
->
p
+2,
l
);

697 
	`mp_cur_cÚsume
(
c
,2+
l
);

701 
	`mp_cur_Ãed
(
c
,3);

703 
size_t
 
l
 = (
c
->
p
[1] << 8) | c->p[2];

704 
	`mp_cur_Ãed
(
c
,3+
l
);

705 
	`lua_pushl¡ršg
(
L
,(*)
c
->
p
+3,
l
);

706 
	`mp_cur_cÚsume
(
c
,3+
l
);

710 
	`mp_cur_Ãed
(
c
,5);

712 
size_t
 
l
 = ((size_t)
c
->
p
[1] << 24) |

713 ((
size_t
)
c
->
p
[2] << 16) |

714 ((
size_t
)
c
->
p
[3] << 8) |

715 (
size_t
)
c
->
p
[4];

716 
	`mp_cur_cÚsume
(
c
,5);

717 
	`mp_cur_Ãed
(
c
,
l
);

718 
	`lua_pushl¡ršg
(
L
,(*)
c
->
p
,
l
);

719 
	`mp_cur_cÚsume
(
c
,
l
);

723 
	`mp_cur_Ãed
(
c
,3);

725 
size_t
 
l
 = (
c
->
p
[1] << 8) | c->p[2];

726 
	`mp_cur_cÚsume
(
c
,3);

727 
	`mp_decode_to_lua_¬¿y
(
L
,
c
,
l
);

731 
	`mp_cur_Ãed
(
c
,5);

733 
size_t
 
l
 = ((size_t)
c
->
p
[1] << 24) |

734 ((
size_t
)
c
->
p
[2] << 16) |

735 ((
size_t
)
c
->
p
[3] << 8) |

736 (
size_t
)
c
->
p
[4];

737 
	`mp_cur_cÚsume
(
c
,5);

738 
	`mp_decode_to_lua_¬¿y
(
L
,
c
,
l
);

742 
	`mp_cur_Ãed
(
c
,3);

744 
size_t
 
l
 = (
c
->
p
[1] << 8) | c->p[2];

745 
	`mp_cur_cÚsume
(
c
,3);

746 
	`mp_decode_to_lua_hash
(
L
,
c
,
l
);

750 
	`mp_cur_Ãed
(
c
,5);

752 
size_t
 
l
 = ((size_t)
c
->
p
[1] << 24) |

753 ((
size_t
)
c
->
p
[2] << 16) |

754 ((
size_t
)
c
->
p
[3] << 8) |

755 (
size_t
)
c
->
p
[4];

756 
	`mp_cur_cÚsume
(
c
,5);

757 
	`mp_decode_to_lua_hash
(
L
,
c
,
l
);

761 ià((
c
->
p
[0] & 0x80) == 0) {

762 
	`lua_pushunsigÃd
(
L
,
c
->
p
[0]);

763 
	`mp_cur_cÚsume
(
c
,1);

764 } ià((
c
->
p
[0] & 0xe0) == 0xe0) {

765 
	`lua_pushš‹g”
(
L
,(sigÃd )
c
->
p
[0]);

766 
	`mp_cur_cÚsume
(
c
,1);

767 } ià((
c
->
p
[0] & 0xe0) == 0xa0) {

768 
size_t
 
l
 = 
c
->
p
[0] & 0x1f;

769 
	`mp_cur_Ãed
(
c
,1+
l
);

770 
	`lua_pushl¡ršg
(
L
,(*)
c
->
p
+1,
l
);

771 
	`mp_cur_cÚsume
(
c
,1+
l
);

772 } ià((
c
->
p
[0] & 0xf0) == 0x90) {

773 
size_t
 
l
 = 
c
->
p
[0] & 0xf;

774 
	`mp_cur_cÚsume
(
c
,1);

775 
	`mp_decode_to_lua_¬¿y
(
L
,
c
,
l
);

776 } ià((
c
->
p
[0] & 0xf0) == 0x80) {

777 
size_t
 
l
 = 
c
->
p
[0] & 0xf;

778 
	`mp_cur_cÚsume
(
c
,1);

779 
	`mp_decode_to_lua_hash
(
L
,
c
,
l
);

781 
c
->
”r
 = 
MP_CUR_ERROR_BADFMT
;

784 
	}
}

786 
	$mp_uÅack_fuÎ
(
lua_S‹
 *
L
, 
lim™
, 
off£t
) {

787 
size_t
 
Ën
;

788 cÚ¡ *
s
;

789 
mp_cur
 
c
;

790 
út
;

791 
decode_®l
 = (!
lim™
 && !
off£t
);

793 
s
 = 
	`luaL_checkl¡ršg
(
L
,1,&
Ën
);

795 ià(
off£t
 < 0 || 
lim™
 < 0)

796  
	`luaL_”rÜ
(
L
,

798 
off£t
, 
Ën
);

799 ià(
off£t
 > 
Ën
)

800  
	`luaL_”rÜ
(
L
,

801 "S¹ off£ˆ%d g»©”hª iÅuˆËngth %d.", 
off£t
, 
Ën
);

803 ià(
decode_®l
è
lim™
 = 
INT_MAX
;

805 
	`mp_cur_š™
(&
c
,(cÚ¡ *)
s
+
off£t
,
Ën
-offset);

809 
út
 = 0; 
c
.
Ëá
 > 0 && cÁ < 
lim™
; cnt++) {

810 
	`mp_decode_to_lua_ty³
(
L
,&
c
);

812 ià(
c
.
”r
 =ğ
MP_CUR_ERROR_EOF
) {

813  
	`luaL_”rÜ
(
L
,"Missing bytes in input.");

814 } ià(
c
.
”r
 =ğ
MP_CUR_ERROR_BADFMT
) {

815  
	`luaL_”rÜ
(
L
,"Bad data format in input.");

819 ià(!
decode_®l
) {

823 
off£t
 = 
Ën
 - 
c
.
Ëá
;

825 
	`lua_pushš‹g”
(
L
, 
c
.
Ëá
 =ğ0 ? -1 : 
off£t
);

832 
	`lua_š£¹
(
L
, 2);

833 
út
 += 1;

836  
út
;

837 
	}
}

839 
	$mp_uÅack
(
lua_S‹
 *
L
) {

840  
	`mp_uÅack_fuÎ
(
L
, 0, 0);

841 
	}
}

843 
	$mp_uÅack_Úe
(
lua_S‹
 *
L
) {

844 
off£t
 = 
	`luaL_İtš‹g”
(
L
, 2, 0);

846 
	`lua_pİ
(
L
, 
	`lua_g‘tİ
(L)-1);

847  
	`mp_uÅack_fuÎ
(
L
, 1, 
off£t
);

848 
	}
}

850 
	$mp_uÅack_lim™
(
lua_S‹
 *
L
) {

851 
lim™
 = 
	`luaL_checkš‹g”
(
L
, 2);

852 
off£t
 = 
	`luaL_İtš‹g”
(
L
, 3, 0);

854 
	`lua_pİ
(
L
, 
	`lua_g‘tİ
(L)-1);

856  
	`mp_uÅack_fuÎ
(
L
, 
lim™
, 
off£t
);

857 
	}
}

859 
	$mp_§ã
(
lua_S‹
 *
L
) {

860 
¬gc
, 
”r
, 
tÙ®_»suÉs
;

862 
¬gc
 = 
	`lua_g‘tİ
(
L
);

866 
	`lua_pushv®ue
(
L
, 
	`lua_upv®uešdex
(1));

867 
	`lua_š£¹
(
L
, 1);

869 
”r
 = 
	`lua_pÿÎ
(
L
, 
¬gc
, 
LUA_MULTRET
, 0);

870 
tÙ®_»suÉs
 = 
	`lua_g‘tİ
(
L
);

872 ià(!
”r
) {

873  
tÙ®_»suÉs
;

875 
	`lua_pushn
(
L
);

876 
	`lua_š£¹
(
L
,-2);

879 
	}
}

882 cÚ¡ 
luaL_Reg
 
	gcmds
[] = {

883 {"·ck", 
mp_·ck
},

884 {"uÅack", 
mp_uÅack
},

885 {"uÅack_Úe", 
mp_uÅack_Úe
},

886 {"uÅack_lim™", 
mp_uÅack_lim™
},

890 
	$luaİ’_ü—‹
(
lua_S‹
 *
L
) {

891 
i
;

894 
	`lua_ÃwbË
(
L
);

896 
i
 = 0; i < ((
cmds
)/(*cmds) - 1); i++) {

897 
	`lua_pushcfunùiÚ
(
L
, 
cmds
[
i
].
func
);

898 
	`lua_£tf›ld
(
L
, -2, 
cmds
[
i
].
Çme
);

902 
	`lua_pushl™”®
(
L
, 
LUACMSGPACK_NAME
);

903 
	`lua_£tf›ld
(
L
, -2, "_NAME");

904 
	`lua_pushl™”®
(
L
, 
LUACMSGPACK_VERSION
);

905 
	`lua_£tf›ld
(
L
, -2, "_VERSION");

906 
	`lua_pushl™”®
(
L
, 
LUACMSGPACK_COPYRIGHT
);

907 
	`lua_£tf›ld
(
L
, -2, "_COPYRIGHT");

908 
	`lua_pushl™”®
(
L
, 
LUACMSGPACK_DESCRIPTION
);

909 
	`lua_£tf›ld
(
L
, -2, "_DESCRIPTION");

911 
	}
}

913 
LUALIB_API
 
	$luaİ’_cmsg·ck
(
lua_S‹
 *
L
) {

914 
	`luaİ’_ü—‹
(
L
);

916 #ià
LUA_VERSION_NUM
 < 502

918 
	`lua_pushv®ue
(
L
, -1);

919 
	`lua_£tglob®
(
L
, 
LUACMSGPACK_NAME
);

923 
	}
}

925 
LUALIB_API
 
	$luaİ’_cmsg·ck_§ã
(
lua_S‹
 *
L
) {

926 
i
;

928 
	`luaİ’_cmsg·ck
(
L
);

931 
i
 = 0; i < ((
cmds
)/(*cmds) - 1); i++) {

932 
	`lua_g‘f›ld
(
L
, -1, 
cmds
[
i
].
Çme
);

933 
	`lua_pushcşosu»
(
L
, 
mp_§ã
, 1);

934 
	`lua_£tf›ld
(
L
, -2, 
cmds
[
i
].
Çme
);

937 #ià
LUA_VERSION_NUM
 < 502

939 
	`lua_pushv®ue
(
L
, -1);

940 
	`lua_£tglob®
(
L
, 
LUACMSGPACK_SAFE_NAME
);

944 
	}
}

	@deps/lua/src/lua_struct.c

29 
	~<as£¹.h
>

30 
	~<ùy³.h
>

31 
	~<lim™s.h
>

32 
	~<¡ddef.h
>

33 
	~<¡ršg.h
>

36 
	~"lua.h
"

37 
	~"Ïuxlib.h
"

40 #ià(
LUA_VERSION_NUM
 >= 502)

42 
	#luaL_»gi¡”
(
L
,
n
,
f
è
	`luaL_Ãwlib
(L,f)

	)

48 #ià!
defšed
(
STRUCT_INT
)

49 
	#STRUCT_INT
 

	)

52 
STRUCT_INT
 
	tIÁty³
;

55 
	tSTRUCT_INT
 
	tUš‰y³
;

59 
	#MAXINTSIZE
 32

	)

62 
	#i¥2
(
x
è((xè> 0 && ((xè& ((xè- 1)è=ğ0)

	)

65 
	scD
 {

66 
	mc
;

67 
	md
;

71 
	#PADDING
 ((
cD
è- ())

	)

72 
	#MAXALIGN
 (
PADDING
 > (è? PADDING : ())

	)

76 
	#BIG
 0

	)

77 
	#LITTLE
 1

	)

81 
	mdummy
;

82 
	m’dŸn
;

83 } cÚ¡ 
	gÇtive
 = {1};

86 
	sH—d”
 {

87 
	m’dŸn
;

88 
	m®ign
;

89 } 
	tH—d”
;

92 
	$g‘num
 (
lua_S‹
 *
L
, cÚ¡ **
fmt
, 
df
) {

93 ià(!
	`isdig™
(**
fmt
))

94  
df
;

96 
a
 = 0;

98 ià(
a
 > (
INT_MAX
 / 10è||‡ * 10 > (INT_MAX - (**
fmt
 - '0')))

99 
	`luaL_”rÜ
(
L
, "integral size overflow");

100 
a
 =‡*10 + *((*
fmt
)++) - '0';

101 } 
	`isdig™
(**
fmt
));

102  
a
;

104 
	}
}

107 
	#deçuÉİtiÚs
(
h
è((h)->
’dŸn
 = 
Çtive
.’dŸn, (h)->
®ign
 = 1)

	)

111 
size_t
 
	$İtsize
 (
lua_S‹
 *
L
, 
İt
, cÚ¡ **
fmt
) {

112 
İt
) {

116 'T':  (
size_t
);

120 'c':  
	`g‘num
(
L
, 
fmt
, 1);

122 
sz
 = 
	`g‘num
(
L
, 
fmt
, ());

123 ià(
sz
 > 
MAXINTSIZE
)

124 
	`luaL_”rÜ
(
L
, "integral size %d is†argerhan†imit of %d",

125 
sz
, 
MAXINTSIZE
);

126  
sz
;

130 
	}
}

137 
	$g‘tßlign
 (
size_t
 
Ën
, 
H—d”
 *
h
, 
İt
, size_ˆ
size
) {

138 ià(
size
 =ğ0 || 
İt
 == 'c')  0;

139 ià(
size
 > (
size_t
)
h
->
®ign
)

140 
size
 = 
h
->
®ign
;

141  (
size
 - (
Ën
 & (size - 1))) & (size - 1);

142 
	}
}

148 
	$cÚŒŞİtiÚs
 (
lua_S‹
 *
L
, 
İt
, cÚ¡ **
fmt
,

149 
H—d”
 *
h
) {

150 
İt
) {

152 '>': 
h
->
’dŸn
 = 
BIG
; ;

153 '<': 
h
->
’dŸn
 = 
LITTLE
; ;

155 
a
 = 
	`g‘num
(
L
, 
fmt
, 
MAXALIGN
);

156 ià(!
	`i¥2
(
a
))

157 
	`luaL_”rÜ
(
L
, "®ignm’ˆ%d i nÙ‡…ow” oà2", 
a
);

158 
h
->
®ign
 = 
a
;

162 cÚ¡ *
msg
 = 
	`lua_pushf¡ršg
(
L
, "šv®id fÜm© o±iÚ '%c'", 
İt
);

163 
	`luaL_¬g”rÜ
(
L
, 1, 
msg
);

166 
	}
}

169 
	$putš‹g”
 (
lua_S‹
 *
L
, 
luaL_Bufãr
 *
b
, 
¬g
, 
’dŸn
,

170 
size
) {

171 
lua_Numb”
 
n
 = 
	`luaL_checknumb”
(
L
, 
¬g
);

172 
Uš‰y³
 
v®ue
;

173 
buff
[
MAXINTSIZE
];

174 ià(
n
 < 0)

175 
v®ue
 = (
Uš‰y³
)(
IÁty³
)
n
;

177 
v®ue
 = (
Uš‰y³
)
n
;

178 ià(
’dŸn
 =ğ
LITTLE
) {

179 
i
;

180 
i
 = 0; i < 
size
; i++) {

181 
buff
[
i
] = (
v®ue
 & 0xff);

182 
v®ue
 >>= 8;

186 
i
;

187 
i
 = 
size
 - 1; i >= 0; i--) {

188 
buff
[
i
] = (
v®ue
 & 0xff);

189 
v®ue
 >>= 8;

192 
	`luaL_addl¡ršg
(
b
, 
buff
, 
size
);

193 
	}
}

196 
	$cÜ»ùby‹s
 (*
b
, 
size
, 
’dŸn
) {

197 ià(
’dŸn
 !ğ
Çtive
.endian) {

198 
i
 = 0;

199 
i
 < --
size
) {

200 
‹mp
 = 
b
[
i
];

201 
b
[
i
++] = b[
size
];

202 
b
[
size
] = 
‹mp
;

205 
	}
}

208 
	$b_·ck
 (
lua_S‹
 *
L
) {

209 
luaL_Bufãr
 
b
;

210 cÚ¡ *
fmt
 = 
	`luaL_check¡ršg
(
L
, 1);

211 
H—d”
 
h
;

212 
¬g
 = 2;

213 
size_t
 
tÙ®size
 = 0;

214 
	`deçuÉİtiÚs
(&
h
);

215 
	`lua_pushn
(
L
);

216 
	`luaL_buffš™
(
L
, &
b
);

217 *
fmt
 != '\0') {

218 
İt
 = *
fmt
++;

219 
size_t
 
size
 = 
	`İtsize
(
L
, 
İt
, &
fmt
);

220 
tßlign
 = 
	`g‘tßlign
(
tÙ®size
, &
h
, 
İt
, 
size
);

221 
tÙ®size
 +ğ
tßlign
;

222 
tßlign
-- > 0è
	`luaL_addch¬
(&
b
, '\0');

223 
İt
) {

226 
	`putš‹g”
(
L
, &
b
, 
¬g
++, 
h
.
’dŸn
, 
size
);

230 
	`luaL_addch¬
(&
b
, '\0');

234 
f
 = ()
	`luaL_checknumb”
(
L
, 
¬g
++);

235 
	`cÜ»ùby‹s
((*)&
f
, 
size
, 
h
.
’dŸn
);

236 
	`luaL_addl¡ršg
(&
b
, (*)&
f
, 
size
);

240 
d
 = 
	`luaL_checknumb”
(
L
, 
¬g
++);

241 
	`cÜ»ùby‹s
((*)&
d
, 
size
, 
h
.
’dŸn
);

242 
	`luaL_addl¡ršg
(&
b
, (*)&
d
, 
size
);

246 
size_t
 
l
;

247 cÚ¡ *
s
 = 
	`luaL_checkl¡ršg
(
L
, 
¬g
++, &
l
);

248 ià(
size
 =ğ0èsizğ
l
;

249 
	`luaL_¬gcheck
(
L
, 
l
 >ğ(
size_t
)
size
, 
¬g
, "stringoo short");

250 
	`luaL_addl¡ršg
(&
b
, 
s
, 
size
);

251 ià(
İt
 == 's') {

252 
	`luaL_addch¬
(&
b
, '\0');

253 
size
++;

257 : 
	`cÚŒŞİtiÚs
(
L
, 
İt
, &
fmt
, &
h
);

259 
tÙ®size
 +ğ
size
;

261 
	`luaL_push»suÉ
(&
b
);

263 
	}
}

266 
lua_Numb”
 
	$g‘š‹g”
 (cÚ¡ *
buff
, 
’dŸn
,

267 
issigÃd
, 
size
) {

268 
Uš‰y³
 
l
 = 0;

269 
i
;

270 ià(
’dŸn
 =ğ
BIG
) {

271 
i
 = 0; i < 
size
; i++) {

272 
l
 <<= 8;

273 
l
 |ğ(
Uš‰y³
)()
buff
[
i
];

277 
i
 = 
size
 - 1; i >= 0; i--) {

278 
l
 <<= 8;

279 
l
 |ğ(
Uš‰y³
)()
buff
[
i
];

282 ià(!
issigÃd
)

283  (
lua_Numb”
)
l
;

285 
Uš‰y³
 
mask
 = (Uš‰y³)(~((Uš‰y³)0)è<< (
size
*8 - 1);

286 ià(
l
 & 
mask
)

287 
l
 |ğ
mask
;

288  (
lua_Numb”
)(
IÁty³
)
l
;

290 
	}
}

293 
	$b_uÅack
 (
lua_S‹
 *
L
) {

294 
H—d”
 
h
;

295 cÚ¡ *
fmt
 = 
	`luaL_check¡ršg
(
L
, 1);

296 
size_t
 
ld
;

297 cÚ¡ *
d©a
 = 
	`luaL_checkl¡ršg
(
L
, 2, &
ld
);

298 
size_t
 
pos
 = 
	`luaL_İtš‹g”
(
L
, 3, 1) - 1;

299 
	`deçuÉİtiÚs
(&
h
);

300 
	`lua_£‰İ
(
L
, 2);

301 *
fmt
) {

302 
İt
 = *
fmt
++;

303 
size_t
 
size
 = 
	`İtsize
(
L
, 
İt
, &
fmt
);

304 
pos
 +ğ
	`g‘tßlign
Õos, &
h
, 
İt
, 
size
);

305 
	`luaL_¬gcheck
(
L
, 
pos
+
size
 <ğ
ld
, 2, "data stringoo short");

306 
	`luaL_check¡ack
(
L
, 1, "too many„esults");

307 
İt
) {

310 
issigÃd
 = 
	`i¦ow”
(
İt
);

311 
lua_Numb”
 
»s
 = 
	`g‘š‹g”
(
d©a
+
pos
, 
h
.
’dŸn
, 
issigÃd
, 
size
);

312 
	`lua_pushnumb”
(
L
, 
»s
);

319 
f
;

320 
	`memıy
(&
f
, 
d©a
+
pos
, 
size
);

321 
	`cÜ»ùby‹s
((*)&
f
, (f), 
h
.
’dŸn
);

322 
	`lua_pushnumb”
(
L
, 
f
);

326 
d
;

327 
	`memıy
(&
d
, 
d©a
+
pos
, 
size
);

328 
	`cÜ»ùby‹s
((*)&
d
, (d), 
h
.
’dŸn
);

329 
	`lua_pushnumb”
(
L
, 
d
);

333 ià(
size
 == 0) {

334 ià(!
	`lua_i¢umb”
(
L
, -1))

335 
	`luaL_”rÜ
(
L
, "format `c0'‚eeds‡…revious size");

336 
size
 = 
	`lua_tÚumb”
(
L
, -1);

337 
	`lua_pİ
(
L
, 1);

338 
	`luaL_¬gcheck
(
L
, 
pos
+
size
 <ğ
ld
, 2, "data stringoo short");

340 
	`lua_pushl¡ršg
(
L
, 
d©a
+
pos
, 
size
);

344 cÚ¡ *
e
 = (cÚ¡ *)
	`memchr
(
d©a
+
pos
, '\0', 
ld
 -…os);

345 ià(
e
 =ğ
NULL
)

346 
	`luaL_”rÜ
(
L
, "unfinished string in data");

347 
size
 = (
e
 - (
d©a
+
pos
)) + 1;

348 
	`lua_pushl¡ršg
(
L
, 
d©a
+
pos
, 
size
 - 1);

351 : 
	`cÚŒŞİtiÚs
(
L
, 
İt
, &
fmt
, &
h
);

353 
pos
 +ğ
size
;

355 
	`lua_pushš‹g”
(
L
, 
pos
 + 1);

356  
	`lua_g‘tİ
(
L
) - 2;

357 
	}
}

360 
	$b_size
 (
lua_S‹
 *
L
) {

361 
H—d”
 
h
;

362 cÚ¡ *
fmt
 = 
	`luaL_check¡ršg
(
L
, 1);

363 
size_t
 
pos
 = 0;

364 
	`deçuÉİtiÚs
(&
h
);

365 *
fmt
) {

366 
İt
 = *
fmt
++;

367 
size_t
 
size
 = 
	`İtsize
(
L
, 
İt
, &
fmt
);

368 
pos
 +ğ
	`g‘tßlign
Õos, &
h
, 
İt
, 
size
);

369 ià(
İt
 == 's')

370 
	`luaL_¬g”rÜ
(
L
, 1, "option 's' has‚o fixed size");

371 ià(
İt
 =ğ'c' && 
size
 == 0)

372 
	`luaL_¬g”rÜ
(
L
, 1, "option 'c0' has‚o fixed size");

373 ià(!
	`i§Êum
(
İt
))

374 
	`cÚŒŞİtiÚs
(
L
, 
İt
, &
fmt
, &
h
);

375 
pos
 +ğ
size
;

377 
	`lua_pushš‹g”
(
L
, 
pos
);

379 
	}
}

385 cÚ¡ 
luaL_Reg
 
	gthi¦ib
[] = {

386 {"·ck", 
b_·ck
},

387 {"uÅack", 
b_uÅack
},

388 {"size", 
b_size
},

389 {
NULL
, NULL}

393 
LUALIB_API
 
luaİ’_¡ruù
 (
lua_S‹
 *
L
);

395 
LUALIB_API
 
	$luaİ’_¡ruù
 (
lua_S‹
 *
L
) {

396 
	`luaL_»gi¡”
(
L
, "¡ruù", 
thi¦ib
);

398 
	}
}

	@deps/lua/src/luac.c

7 
	~<”ºo.h
>

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

12 
	#luac_c


	)

13 
	#LUA_CORE


	)

15 
	~"lua.h
"

16 
	~"Ïuxlib.h
"

18 
	~"ldo.h
"

19 
	~"lfunc.h
"

20 
	~"lmem.h
"

21 
	~"lobjeù.h
"

22 
	~"lİcodes.h
"

23 
	~"l¡ršg.h
"

24 
	~"lundump.h
"

26 
	#PROGNAME
 "luac"

	)

27 
	#OUTPUT
 
PROGNAME
 ".out"

	)

29 
	gli¡šg
=0;

30 
	gdumpšg
=1;

31 
	g¡rpšg
=0;

32 
	gOuut
[]={ 
OUTPUT
 };

33 cÚ¡ * 
	gouut
=
Ouut
;

34 cÚ¡ * 
	g´ogÇme
=
PROGNAME
;

36 
	$çl
(cÚ¡ * 
mes§ge
)

38 
	`årštf
(
¡d”r
,"%s: %s\n",
´ogÇme
,
mes§ge
);

39 
	`ex™
(
EXIT_FAILURE
);

40 
	}
}

42 
	$ÿÂÙ
(cÚ¡ * 
wh©
)

44 
	`årštf
(
¡d”r
,"%s: cªnÙ % %s: %s\n",
´ogÇme
,
wh©
,
ouut
,
	`¡»¼Ü
(
”ºo
));

45 
	`ex™
(
EXIT_FAILURE
);

46 
	}
}

48 
	$u§ge
(cÚ¡ * 
mes§ge
)

50 ià(*
mes§ge
=='-')

51 
	`årštf
(
¡d”r
,"%s: uÄecognized o±iÚ " 
LUA_QS
 "\n",
´ogÇme
,
mes§ge
);

53 
	`årštf
(
¡d”r
,"%s: %s\n",
´ogÇme
,
mes§ge
);

54 
	`årštf
(
¡d”r
,

59 " -ØÇm ouuˆtØf" 
	`LUA_QL
("name") " (default is \"%s\")\n"

64 
´ogÇme
,
Ouut
);

65 
	`ex™
(
EXIT_FAILURE
);

66 
	}
}

68 
	#IS
(
s
è(
	`¡rcmp
(
¬gv
[
i
],s)==0)

	)

70 
	$dßrgs
(
¬gc
, * 
¬gv
[])

72 
i
;

73 
v”siÚ
=0;

74 ià(
¬gv
[0]!=
NULL
 && *¬gv[0]!=0è
´ogÇme
=argv[0];

75 
i
=1; i<
¬gc
; i++)

77 ià(*
¬gv
[
i
]!='-')

79 ià(
	`IS
("--"))

81 ++
i
;

82 ià(
v”siÚ
) ++version;

85 ià(
	`IS
("-"))

87 ià(
	`IS
("-l"))

88 ++
li¡šg
;

89 ià(
	`IS
("-o"))

91 
ouut
=
¬gv
[++
i
];

92 ià(
ouut
==
NULL
 || *ouut==0è
	`u§ge
(
	`LUA_QL
("-o") "‚eeds‡rgument");

93 ià(
	`IS
("-")è
ouut
=
NULL
;

95 ià(
	`IS
("-p"))

96 
dumpšg
=0;

97 ià(
	`IS
("-s"))

98 
¡rpšg
=1;

99 ià(
	`IS
("-v"))

100 ++
v”siÚ
;

102 
	`u§ge
(
¬gv
[
i
]);

104 ià(
i
==
¬gc
 && (
li¡šg
 || !
dumpšg
))

106 
dumpšg
=0;

107 
¬gv
[--
i
]=
Ouut
;

109 ià(
v”siÚ
)

111 
	`´štf
("%  %s\n",
LUA_RELEASE
,
LUA_COPYRIGHT
);

112 ià(
v”siÚ
==
¬gc
-1è
	`ex™
(
EXIT_SUCCESS
);

114  
i
;

115 
	}
}

117 
	#tİrÙo
(
L
,
i
è(
	`şv®ue
(L->
tİ
+(i))->
l
.
p
)

	)

119 cÚ¡ 
PrÙo
* 
	$combše
(
lua_S‹
* 
L
, 
n
)

121 ià(
n
==1)

122  
	`tİrÙo
(
L
,-1);

125 
i
,
pc
;

126 
PrÙo
* 
f
=
	`luaF_Ãw´Ùo
(
L
);

127 
	`£tv®ue2s
(
L
,L->
tİ
,
f
); 
	`šü_tİ
(L);

128 
f
->
sourû
=
	`luaS_Ãwl™”®
(
L
,"=(" 
PROGNAME
 ")");

129 
f
->
max¡acksize
=1;

130 
pc
=2*
n
+1;

131 
f
->
code
=
	`luaM_ÃwveùÜ
(
L
,
pc
,
In¡ruùiÚ
);

132 
f
->
sizecode
=
pc
;

133 
f
->
p
=
	`luaM_ÃwveùÜ
(
L
,
n
,
PrÙo
*);

134 
f
->
siz•
=
n
;

135 
pc
=0;

136 
i
=0; i<
n
; i++)

138 
f
->
p
[
i
]=
	`tİrÙo
(
L
,i-
n
-1);

139 
f
->
code
[
pc
++]=
	`CREATE_ABx
(
OP_CLOSURE
,0,
i
);

140 
f
->
code
[
pc
++]=
	`CREATE_ABC
(
OP_CALL
,0,1,1);

142 
f
->
code
[
pc
++]=
	`CREATE_ABC
(
OP_RETURN
,0,1,0);

143  
f
;

145 
	}
}

147 
	$wr™”
(
lua_S‹
* 
L
, cÚ¡ * 
p
, 
size_t
 
size
, * 
u
)

149 
	`UNUSED
(
L
);

150  (
	`fwr™e
(
p
,
size
,1,(
FILE
*)
u
)!=1) && (size!=0);

151 
	}
}

153 
	sSmaš
 {

154 
	m¬gc
;

155 ** 
	m¬gv
;

158 
	$pmaš
(
lua_S‹
* 
L
)

160 
Smaš
* 
s
 = (Smaš*)
	`lua_tou£rd©a
(
L
, 1);

161 
¬gc
=
s
->argc;

162 ** 
¬gv
=
s
->argv;

163 cÚ¡ 
PrÙo
* 
f
;

164 
i
;

165 ià(!
	`lua_check¡ack
(
L
,
¬gc
)è
	`çl
("too many input files");

166 
i
=0; i<
¬gc
; i++)

168 cÚ¡ * 
f’ame
=
	`IS
("-"è? 
NULL
 : 
¬gv
[
i
];

169 ià(
	`luaL_lßdfe
(
L
,
f’ame
)!=0è
	`çl
(
	`lua_to¡ršg
(L,-1));

171 
f
=
	`combše
(
L
,
¬gc
);

172 ià(
li¡šg
è
	`luaU_´št
(
f
,listing>1);

173 ià(
dumpšg
)

175 
FILE
* 
D
ğ(
ouut
==
NULL
è? 
¡dout
 : 
	`fİ’
(output,"wb");

176 ià(
D
==
NULL
è
	`ÿÂÙ
("open");

177 
	`lua_lock
(
L
);

178 
	`luaU_dump
(
L
,
f
,
wr™”
,
D
,
¡rpšg
);

179 
	`lua_uÆock
(
L
);

180 ià(
	`ã¼Ü
(
D
)è
	`ÿÂÙ
("write");

181 ià(
	`fşo£
(
D
)è
	`ÿÂÙ
("close");

184 
	}
}

186 
	$maš
(
¬gc
, * 
¬gv
[])

188 
lua_S‹
* 
L
;

189 
Smaš
 
s
;

190 
i
=
	`dßrgs
(
¬gc
,
¬gv
);

191 
¬gc
-=
i
; 
¬gv
+=i;

192 ià(
¬gc
<=0è
	`u§ge
("no input files given");

193 
L
=
	`lua_İ’
();

194 ià(
L
==
NULL
è
	`çl
("notƒnough memory for state");

195 
s
.
¬gc
=argc;

196 
s
.
¬gv
=argv;

197 ià(
	`lua_ıÿÎ
(
L
,
pmaš
,&
s
)!=0è
	`çl
(
	`lua_to¡ršg
(L,-1));

198 
	`lua_şo£
(
L
);

199  
EXIT_SUCCESS
;

200 
	}
}

	@deps/lua/src/luaconf.h

8 #iâdeà
lcÚfig_h


9 
	#lcÚfig_h


	)

11 
	~<lim™s.h
>

12 
	~<¡ddef.h
>

27 #ià
defšed
(
__STRICT_ANSI__
)

28 
	#LUA_ANSI


	)

32 #ià!
defšed
(
LUA_ANSI
è&& defšed(
_WIN32
)

33 
	#LUA_WIN


	)

36 #ià
defšed
(
LUA_USE_LINUX
)

37 
	#LUA_USE_POSIX


	)

38 
	#LUA_USE_DLOPEN


	)

39 
	#LUA_USE_READLINE


	)

42 #ià
defšed
(
LUA_USE_MACOSX
)

43 
	#LUA_USE_POSIX


	)

44 
	#LUA_DL_DYLD


	)

54 #ià
defšed
(
LUA_USE_POSIX
)

55 
	#LUA_USE_MKSTEMP


	)

56 
	#LUA_USE_ISATTY


	)

57 
	#LUA_USE_POPEN


	)

58 
	#LUA_USE_ULONGJMP


	)

69 
	#LUA_PATH
 "LUA_PATH"

	)

70 
	#LUA_CPATH
 "LUA_CPATH"

	)

71 
	#LUA_INIT
 "LUA_INIT"

	)

83 #ià
defšed
(
_WIN32
)

88 
	#LUA_LDIR
 "!\\lua\\"

	)

89 
	#LUA_CDIR
 "!\\"

	)

90 
	#LUA_PATH_DEFAULT
 \

91 ".\\?.lua;" 
LUA_LDIR
"?.lua;" LUA_LDIR"?\\init.lua;" \

92 
LUA_CDIR
"?.lua;" LUA_CDIR"?\\š™.lua"

	)

93 
	#LUA_CPATH_DEFAULT
 \

94 ".\\?.dÎ;" 
LUA_CDIR
"?.dÎ;" LUA_CDIR"lßd®l.dÎ"

	)

97 
	#LUA_ROOT
 "/u¤/loÿl/"

	)

98 
	#LUA_LDIR
 
LUA_ROOT
 "sh¬e/lua/5.1/"

	)

99 
	#LUA_CDIR
 
LUA_ROOT
 "lib/lua/5.1/"

	)

100 
	#LUA_PATH_DEFAULT
 \

101 "./?.lua;" 
LUA_LDIR
"?.lua;" LUA_LDIR"?/init.lua;" \

102 
LUA_CDIR
"?.lua;" LUA_CDIR"?/š™.lua"

	)

103 
	#LUA_CPATH_DEFAULT
 \

104 "./?.so;" 
LUA_CDIR
"?.so;" LUA_CDIR"lßd®l.so"

	)

113 #ià
defšed
(
_WIN32
)

114 
	#LUA_DIRSEP
 "\\"

	)

116 
	#LUA_DIRSEP
 "/"

	)

132 
	#LUA_PATHSEP
 ";"

	)

133 
	#LUA_PATH_MARK
 "?"

	)

134 
	#LUA_EXECDIR
 "!"

	)

135 
	#LUA_IGMARK
 "-"

	)

143 
	#LUA_INTEGER
 
±rdiff_t


	)

154 #ià
defšed
(
LUA_BUILD_AS_DLL
)

156 #ià
defšed
(
LUA_CORE
è|| defšed(
LUA_LIB
)

157 
	#LUA_API
 
	`__deş¥ec
(
dÎexpÜt
)

	)

159 
	#LUA_API
 
	`__deş¥ec
(
dÎimpÜt
)

	)

164 
	#LUA_API
 

	)

169 
	#LUALIB_API
 
LUA_API


	)

181 #ià
defšed
(
lu¯Î_c
)

182 
	#LUAI_FUNC
 

	)

183 
	#LUAI_DATA


	)

185 #–ià
defšed
(
__GNUC__
è&& ((__GNUC__*100 + 
__GNUC_MINOR__
) >= 302) && \

186 
	$defšed
(
__ELF__
)

187 
	#LUAI_FUNC
 
	`__©Œibu‹__
((
	`visib™y
("hidd’"))è

	)

188 
	#LUAI_DATA
 
LUAI_FUNC


	)

191 
	#LUAI_FUNC
 

	)

192 
	#LUAI_DATA
 

	)

201 
	#LUA_QL
(
x
è"'" x "'"

	)

202 
	#LUA_QS
 
	`LUA_QL
("%s")

	)

210 
	#LUA_IDSIZE
 60

	)

219 #ià
	`defšed
(
lua_c
è|| defšed(
lu¯Î_c
)

227 #ià
	`defšed
(
LUA_USE_ISATTY
)

228 
	~<uni¡d.h
>

229 
	#lua_¡dš_is_‰y
(è
	`i§‰y
(0)

	)

230 #–ià
	`defšed
(
LUA_WIN
)

231 
	~<io.h
>

232 
	~<¡dio.h
>

233 
	#lua_¡dš_is_‰y
(è
	`_i§‰y
(
	`_f’o
(
¡dš
))

	)

235 
	#lua_¡dš_is_‰y
(è1

	)

245 
	#LUA_PROMPT
 "> "

	)

246 
	#LUA_PROMPT2
 ">> "

	)

254 
	#LUA_PROGNAME
 "lua"

	)

262 
	#LUA_MAXINPUT
 512

	)

273 #ià
	`defšed
(
LUA_USE_READLINE
)

274 
	~<¡dio.h
>

275 
	~<»adlše/»adlše.h
>

276 
	~<»adlše/hi¡Üy.h
>

277 
	#lua_»adlše
(
L
,
b
,
p
è(()L, ((b)=
	`»adlše
Õ)è!ğ
NULL
)

	)

278 
	#lua_§v–še
(
L
,
idx
) \

279 ià(
	`lua_¡¾’
(
L
,
idx
) > 0) \

280 
	`add_hi¡Üy
(
	`lua_to¡ršg
(
L
, 
idx
));

	)

281 
	#lua_ä“lše
(
L
,
b
è(()L, 
	`ä“
(b))

	)

283 
	#lua_»adlše
(
L
,
b
,
p
) \

284 (()
L
, 
	`åuts
(
p
, 
¡dout
), 
	`fæush
(stdout), \

285 
	`fg‘s
(
b
, 
LUA_MAXINPUT
, 
¡dš
è!ğ
NULL
è

	)

286 
	#lua_§v–še
(
L
,
idx
è{ ()L; ()idx; 
	}

	)
}

287 
	#lua_ä“lše
(
L
,
b
è{ ()L; ()b; }

	)

302 
	#LUAI_GCPAUSE
 200

	)

313 
	#LUAI_GCMUL
 200

	)

322 #undeà
LUA_COMPAT_GETN


329 #undeà
LUA_COMPAT_LOADLIB


336 
	#LUA_COMPAT_VARARG


	)

343 
	#LUA_COMPAT_MOD


	)

351 
	#LUA_COMPAT_LSTR
 1

	)

358 
	#LUA_COMPAT_GFIND


	)

366 
	#LUA_COMPAT_OPENLIB


	)

377 #ià
defšed
(
LUA_USE_APICHECK
)

378 
	~<as£¹.h
>

379 
	#luai_­icheck
(
L
,
o
è{ ()L; 
	`as£¹
(o); }

	)

381 
	#luai_­icheck
(
L
,
o
è{ ()L; }

	)

391 #ià
INT_MAX
-20 < 32760

392 
	#LUAI_BITSINT
 16

	)

393 #–ià
INT_MAX
 > 2147483640L

395 
	#LUAI_BITSINT
 32

	)

413 #ià
LUAI_BITSINT
 >= 32

414 
	#LUAI_UINT32
 

	)

415 
	#LUAI_INT32
 

	)

416 
	#LUAI_MAXINT32
 
INT_MAX


	)

417 
	#LUAI_UMEM
 
size_t


	)

418 
	#LUAI_MEM
 
±rdiff_t


	)

421 
	#LUAI_UINT32
 

	)

422 
	#LUAI_INT32
 

	)

423 
	#LUAI_MAXINT32
 
LONG_MAX


	)

424 
	#LUAI_UMEM
 

	)

425 
	#LUAI_MEM
 

	)

435 
	#LUAI_MAXCALLS
 20000

	)

446 
	#LUAI_MAXCSTACK
 8000

	)

468 
	#LUAI_MAXCCALLS
 200

	)

475 
	#LUAI_MAXVARS
 200

	)

482 
	#LUAI_MAXUPVALUES
 60

	)

488 
	#LUAL_BUFFERSIZE
 
BUFSIZ


	)

504 
	#LUA_NUMBER_DOUBLE


	)

505 
	#LUA_NUMBER
 

	)

511 
	#LUAI_UACNUMBER
 

	)

521 
	#LUA_NUMBER_SCAN
 "%lf"

	)

522 
	#LUA_NUMBER_FMT
 "%.14g"

	)

523 
	#lua_numb”2¡r
(
s
,
n
è
	`¥rštf
((s), 
LUA_NUMBER_FMT
, (n))

	)

524 
	#LUAI_MAXNUMBER2STR
 32

	)

525 
	#lua_¡r2numb”
(
s
,
p
è
	`¡¹od
((s), (p))

	)

531 #ià
defšed
(
LUA_CORE
)

532 
	~<m©h.h
>

533 
	#luai_numadd
(
a
,
b
è(×)+(b))

	)

534 
	#luai_numsub
(
a
,
b
è(×)-(b))

	)

535 
	#luai_nummul
(
a
,
b
è(×)*(b))

	)

536 
	#luai_numdiv
(
a
,
b
è(×)/(b))

	)

537 
	#luai_nummod
(
a
,
b
è(×è- 
	`æoÜ
(×)/(b))*(b))

	)

538 
	#luai_numpow
(
a
,
b
è(
	`pow
×,b))

	)

539 
	#luai_numunm
(
a
è(-×))

	)

540 
	#luai_numeq
(
a
,
b
è(×)==(b))

	)

541 
	#luai_numÉ
(
a
,
b
è(×)<(b))

	)

542 
	#luai_numË
(
a
,
b
è(×)<=(b))

	)

543 
	#luai_numi¢ª
(
a
è(!
	`luai_numeq
(×), (a)))

	)

557 #ià
defšed
(
LUA_NUMBER_DOUBLE
è&& !defšed(
LUA_ANSI
è&& !defšed(
__SSE2__
) && \

558 (
defšed
(
__i386
è|| defšed (
_M_IX86
è|| 
	$defšed
(
__i386__
))

561 #ià
	`defšed
(
_MSC_VER
)

563 
	#lua_numb”2št
(
i
,
d
è
__asm
 
æd
 d __asm 
fi¡p
 
	)
i

564 
	#lua_numb”2š‹g”
(
i
,
n
è
	`lua_numb”2št
(i,‚)

	)

570 
	uluai_Ca¡
 { 
l_d
; 
l_l
; };

571 
	#lua_numb”2št
(
i
,
d
) \

572 { vŞ©
luai_Ca¡
 
u
; u.
l_d
 = (
d
è+ 6755399441055744.0; (
i
èğu.
l_l
; 
	}

	)
}

573 
	#lua_numb”2š‹g”
(
i
,
n
è
	`lua_numb”2št
(i,‚)

	)

580 
	#lua_numb”2št
(
i
,
d
è((i)=()(d))

	)

581 
	#lua_numb”2š‹g”
(
i
,
d
è((i)=(
lua_IÁeg”
)(d))

	)

595 
	#LUAI_USER_ALIGNMENT_T
 uniÚ { 
u
; *
s
; 
l
; }

	)

606 #ià
defšed
(
__ılu¥lus
)

608 
	#LUAI_THROW
(
L
,
c
è
	`throw
(c)

	)

609 
	#LUAI_TRY
(
L
,
c
,
a
è
Œy
 {‡ } 
	`ÿtch
(...) \

610 { ià((
c
)->
¡©us
 =ğ0è(c)->¡©u ğ-1; }

	)

611 
	#luai_jmpbuf
 

	)

613 #–ià
defšed
(
LUA_USE_ULONGJMP
)

615 
	#LUAI_THROW
(
L
,
c
è
	`_lÚgjmp
((c)->
b
, 1)

	)

616 
	#LUAI_TRY
(
L
,
c
,
a
èià(
	`_£tjmp
((c)->
b
è=ğ0è{‡ }

	)

617 
	#luai_jmpbuf
 
jmp_buf


	)

621 
	#LUAI_THROW
(
L
,
c
è
	`lÚgjmp
((c)->
b
, 1)

	)

622 
	#LUAI_TRY
(
L
,
c
,
a
èià(
	`£tjmp
((c)->
b
è=ğ0è{‡ }

	)

623 
	#luai_jmpbuf
 
jmp_buf


	)

633 
	#LUA_MAXCAPTURES
 32

	)

644 #ià
defšed
(
lo¦ib_c
è|| defšed(
lu¯Î_c
)

646 #ià
defšed
(
LUA_USE_MKSTEMP
)

647 
	~<uni¡d.h
>

648 
	#LUA_TMPNAMBUFSIZE
 32

	)

649 
	#lua_tm²am
(
b
,
e
) { \

650 
	`¡rıy
(
b
, "/tmp/lua_XXXXXX"); \

651 
e
 = 
	`mk¡emp
(
b
); \

652 ià(
e
 !ğ-1è
	`şo£
(e); \

653 
e
 = (=ğ-1); }

	)

656 
	#LUA_TMPNAMBUFSIZE
 
L_tm²am


	)

657 
	#lua_tm²am
(
b
,
e
è{ƒ = (
	`tm²am
(bè=ğ
NULL
); }

	)

668 #ià
defšed
(
LUA_USE_POPEN
)

670 
	#lua_pİ’
(
L
,
c
,
m
è(()L, 
	`fæush
(
NULL
), 
	`pİ’
(c,m))

	)

671 
	#lua_pşo£
(
L
,
fe
è(()L, (
	`pşo£
(feè!ğ-1))

	)

673 #–ià
defšed
(
LUA_WIN
)

675 
	#lua_pİ’
(
L
,
c
,
m
è(()L, 
	`_pİ’
(c,m))

	)

676 
	#lua_pşo£
(
L
,
fe
è(()L, (
	`_pşo£
(feè!ğ-1))

	)

680 
	#lua_pİ’
(
L
,
c
,
m
) (()(()c, m), \

681 
	`luaL_”rÜ
(
L
, 
	`LUA_QL
("pİ’"è"‚Ù suµÜ‹d"), (
FILE
*)0)

	)

682 
	#lua_pşo£
(
L
,
fe
è(()(()L, fe), 0)

	)

700 #ià
defšed
(
LUA_USE_DLOPEN
)

701 
	#LUA_DL_DLOPEN


	)

704 #ià
defšed
(
LUA_WIN
)

705 
	#LUA_DL_DLL


	)

715 
	#LUAI_EXTRASPACE
 0

	)

723 
	#luai_u£r¡©eİ’
(
L
è(()L)

	)

724 
	#luai_u£r¡©eşo£
(
L
è(()L)

	)

725 
	#luai_u£r¡©‘h»ad
(
L
,
L1
è(()L)

	)

726 
	#luai_u£r¡©eä“
(
L
è(()L)

	)

727 
	#luai_u£r¡©”esume
(
L
,
n
è(()L)

	)

728 
	#luai_u£r¡©ey›ld
(
L
,
n
è(()L)

	)

739 #ià
defšed
(
LUA_USELONGLONG
)

741 
	#LUA_INTFRMLEN
 "Î"

	)

742 
	#LUA_INTFRM_T
 

	)

746 
	#LUA_INTFRMLEN
 "l"

	)

747 
	#LUA_INTFRM_T
 

	)

	@deps/lua/src/lualib.h

8 #iâdeà
lu®ib_h


9 
	#lu®ib_h


	)

11 
	~"lua.h
"

15 
	#LUA_FILEHANDLE
 "FILE*"

	)

18 
	#LUA_COLIBNAME
 "cÜoutše"

	)

19 
LUALIB_API
 (
luaİ’_ba£
è(
lua_S‹
 *
L
);

21 
	#LUA_TABLIBNAME
 "bË"

	)

22 
LUALIB_API
 (
luaİ’_bË
è(
lua_S‹
 *
L
);

24 
	#LUA_IOLIBNAME
 "io"

	)

25 
LUALIB_API
 (
luaİ’_io
è(
lua_S‹
 *
L
);

27 
	#LUA_OSLIBNAME
 "os"

	)

28 
LUALIB_API
 (
luaİ’_os
è(
lua_S‹
 *
L
);

30 
	#LUA_STRLIBNAME
 "¡ršg"

	)

31 
LUALIB_API
 (
luaİ’_¡ršg
è(
lua_S‹
 *
L
);

33 
	#LUA_MATHLIBNAME
 "m©h"

	)

34 
LUALIB_API
 (
luaİ’_m©h
è(
lua_S‹
 *
L
);

36 
	#LUA_DBLIBNAME
 "debug"

	)

37 
LUALIB_API
 (
luaİ’_debug
è(
lua_S‹
 *
L
);

39 
	#LUA_LOADLIBNAME
 "·ckage"

	)

40 
LUALIB_API
 (
luaİ’_·ckage
è(
lua_S‹
 *
L
);

44 
LUALIB_API
 (
luaL_İ’libs
è(
lua_S‹
 *
L
);

48 #iâdeà
lua_as£¹


49 
	#lua_as£¹
(
x
è(()0)

	)

	@deps/lua/src/lundump.c

7 
	~<¡ršg.h
>

9 
	#lundump_c


	)

10 
	#LUA_CORE


	)

12 
	~"lua.h
"

14 
	~"ldebug.h
"

15 
	~"ldo.h
"

16 
	~"lfunc.h
"

17 
	~"lmem.h
"

18 
	~"lobjeù.h
"

19 
	~"l¡ršg.h
"

20 
	~"lundump.h
"

21 
	~"lzio.h
"

24 
lua_S‹
* 
	mL
;

25 
ZIO
* 
	mZ
;

26 
Mbufãr
* 
	mb
;

27 cÚ¡ * 
	mÇme
;

28 } 
	tLßdS‹
;

30 #ifdeà
LUAC_TRUST_BINARIES


31 
	#IF
(
c
,
s
)

	)

32 
	#”rÜ
(
S
,
s
)

	)

34 
	#IF
(
c
,
s
èià(cè
	`”rÜ
(
S
,s)

	)

36 
	$”rÜ
(
LßdS‹
* 
S
, cÚ¡ * 
why
)

38 
	`luaO_pushf¡ršg
(
S
->
L
,"%s: % š…»comped chunk",S->
Çme
,
why
);

39 
	`luaD_throw
(
S
->
L
,
LUA_ERRSYNTAX
);

40 
	}
}

43 
	#LßdMem
(
S
,
b
,
n
,
size
è
	`LßdBlock
(S,b,Ò)*(size))

	)

44 
	#LßdBy‹
(
S
è(
lu_by‹
)
	`LßdCh¬
(S)

	)

45 
	#LßdV¬
(
S
,
x
è
	`LßdMem
(S,&x,1,(x))

	)

46 
	#LßdVeùÜ
(
S
,
b
,
n
,
size
è
	`LßdMem
(S,b,n,size)

	)

48 
	$LßdBlock
(
LßdS‹
* 
S
, * 
b
, 
size_t
 
size
)

50 
size_t
 
r
=
	`luaZ_»ad
(
S
->
Z
,
b
,
size
);

51 
	`IF
 (
r
!=0, "unexpectedƒnd");

52 
	}
}

54 
	$LßdCh¬
(
LßdS‹
* 
S
)

56 
x
;

57 
	`LßdV¬
(
S
,
x
);

58  
x
;

59 
	}
}

61 
	$LßdIÁ
(
LßdS‹
* 
S
)

63 
x
;

64 
	`LßdV¬
(
S
,
x
);

65 
	`IF
 (
x
<0, "bad integer");

66  
x
;

67 
	}
}

69 
lua_Numb”
 
	$LßdNumb”
(
LßdS‹
* 
S
)

71 
lua_Numb”
 
x
;

72 
	`LßdV¬
(
S
,
x
);

73  
x
;

74 
	}
}

76 
TSŒšg
* 
	$LßdSŒšg
(
LßdS‹
* 
S
)

78 
size_t
 
size
;

79 
	`LßdV¬
(
S
,
size
);

80 ià(
size
==0)

81  
NULL
;

84 * 
s
=
	`luaZ_İ’¥aû
(
S
->
L
,S->
b
,
size
);

85 
	`LßdBlock
(
S
,
s
,
size
);

86  
	`luaS_Ãwl¡r
(
S
->
L
,
s
,
size
-1);

88 
	}
}

90 
	$LßdCode
(
LßdS‹
* 
S
, 
PrÙo
* 
f
)

92 
n
=
	`LßdIÁ
(
S
);

93 
f
->
code
=
	`luaM_ÃwveùÜ
(
S
->
L
,
n
,
In¡ruùiÚ
);

94 
f
->
sizecode
=
n
;

95 
	`LßdVeùÜ
(
S
,
f
->
code
,
n
,(
In¡ruùiÚ
));

96 
	}
}

98 
PrÙo
* 
LßdFunùiÚ
(
LßdS‹
* 
S
, 
TSŒšg
* 
p
);

100 
	$LßdCÚ¡ªts
(
LßdS‹
* 
S
, 
PrÙo
* 
f
)

102 
i
,
n
;

103 
n
=
	`LßdIÁ
(
S
);

104 
f
->
k
=
	`luaM_ÃwveùÜ
(
S
->
L
,
n
,
TV®ue
);

105 
f
->
sizek
=
n
;

106 
i
=0; i<
n
; i++è
	`£Šv®ue
(&
f
->
k
[i]);

107 
i
=0; i<
n
; i++)

109 
TV®ue
* 
o
=&
f
->
k
[
i
];

110 
t
=
	`LßdCh¬
(
S
);

111 
t
)

113 
LUA_TNIL
:

114 
	`£Šv®ue
(
o
);

116 
LUA_TBOOLEAN
:

117 
	`£tbv®ue
(
o
,
	`LßdCh¬
(
S
)!=0);

119 
LUA_TNUMBER
:

120 
	`£Šv®ue
(
o
,
	`LßdNumb”
(
S
));

122 
LUA_TSTRING
:

123 
	`£tsv®ue2n
(
S
->
L
,
o
,
	`LßdSŒšg
(S));

126 
	`”rÜ
(
S
,"bad constant");

130 
n
=
	`LßdIÁ
(
S
);

131 
f
->
p
=
	`luaM_ÃwveùÜ
(
S
->
L
,
n
,
PrÙo
*);

132 
f
->
siz•
=
n
;

133 
i
=0; i<
n
; i++è
f
->
p
[i]=
NULL
;

134 
i
=0; i<
n
; i++è
f
->
p
[i]=
	`LßdFunùiÚ
(
S
,f->
sourû
);

135 
	}
}

137 
	$LßdDebug
(
LßdS‹
* 
S
, 
PrÙo
* 
f
)

139 
i
,
n
;

140 
n
=
	`LßdIÁ
(
S
);

141 
f
->
lšešfo
=
	`luaM_ÃwveùÜ
(
S
->
L
,
n
,);

142 
f
->
siz–šešfo
=
n
;

143 
	`LßdVeùÜ
(
S
,
f
->
lšešfo
,
n
,());

144 
n
=
	`LßdIÁ
(
S
);

145 
f
->
locv¬s
=
	`luaM_ÃwveùÜ
(
S
->
L
,
n
,
LocV¬
);

146 
f
->
siz–ocv¬s
=
n
;

147 
i
=0; i<
n
; i++è
f
->
locv¬s
[i].
v¬Çme
=
NULL
;

148 
i
=0; i<
n
; i++)

150 
f
->
locv¬s
[
i
].
v¬Çme
=
	`LßdSŒšg
(
S
);

151 
f
->
locv¬s
[
i
].
¡¬c
=
	`LßdIÁ
(
S
);

152 
f
->
locv¬s
[
i
].
’dpc
=
	`LßdIÁ
(
S
);

154 
n
=
	`LßdIÁ
(
S
);

155 
f
->
upv®ues
=
	`luaM_ÃwveùÜ
(
S
->
L
,
n
,
TSŒšg
*);

156 
f
->
sizeupv®ues
=
n
;

157 
i
=0; i<
n
; i++è
f
->
upv®ues
[i]=
NULL
;

158 
i
=0; i<
n
; i++è
f
->
upv®ues
[i]=
	`LßdSŒšg
(
S
);

159 
	}
}

161 
PrÙo
* 
	$LßdFunùiÚ
(
LßdS‹
* 
S
, 
TSŒšg
* 
p
)

163 
PrÙo
* 
f
;

164 ià(++
S
->
L
->
nCÿÎs
 > 
LUAI_MAXCCALLS
è
	`”rÜ
(S,"codeoo deep");

165 
f
=
	`luaF_Ãw´Ùo
(
S
->
L
);

166 
	`£tv®ue2s
(
S
->
L
,S->L->
tİ
,
f
); 
	`šü_tİ
(S->L);

167 
f
->
sourû
=
	`LßdSŒšg
(
S
); ià(f->sourû==
NULL
èf->sourû=
p
;

168 
f
->
lšedefšed
=
	`LßdIÁ
(
S
);

169 
f
->
Ï¡lšedefšed
=
	`LßdIÁ
(
S
);

170 
f
->
nups
=
	`LßdBy‹
(
S
);

171 
f
->
num·¿ms
=
	`LßdBy‹
(
S
);

172 
f
->
is_v¬¬g
=
	`LßdBy‹
(
S
);

173 
f
->
max¡acksize
=
	`LßdBy‹
(
S
);

174 
	`LßdCode
(
S
,
f
);

175 
	`LßdCÚ¡ªts
(
S
,
f
);

176 
	`LßdDebug
(
S
,
f
);

177 
	`IF
 (!
	`luaG_checkcode
(
f
), "bad code");

178 
S
->
L
->
tİ
--;

179 
S
->
L
->
nCÿÎs
--;

180  
f
;

181 
	}
}

183 
	$LßdH—d”
(
LßdS‹
* 
S
)

185 
h
[
LUAC_HEADERSIZE
];

186 
s
[
LUAC_HEADERSIZE
];

187 
	`luaU_h—d”
(
h
);

188 
	`LßdBlock
(
S
,
s
,
LUAC_HEADERSIZE
);

189 
	`IF
 (
	`memcmp
(
h
,
s
,
LUAC_HEADERSIZE
)!=0, "bad header");

190 
	}
}

195 
PrÙo
* 
	$luaU_undump
 (
lua_S‹
* 
L
, 
ZIO
* 
Z
, 
Mbufãr
* 
buff
, cÚ¡ * 
Çme
)

197 
LßdS‹
 
S
;

198 ià(*
Çme
=='@' || *name=='=')

199 
S
.
Çme
=name+1;

200 ià(*
Çme
==
LUA_SIGNATURE
[0])

201 
S
.
Çme
="binary string";

203 
S
.
Çme
=name;

204 
S
.
L
=L;

205 
S
.
Z
=Z;

206 
S
.
b
=
buff
;

207 
	`LßdH—d”
(&
S
);

208  
	`LßdFunùiÚ
(&
S
,
	`luaS_Ãwl™”®
(
L
,"=?"));

209 
	}
}

214 
	$luaU_h—d”
 (* 
h
)

216 
x
=1;

217 
	`memıy
(
h
,
LUA_SIGNATURE
,(LUA_SIGNATURE)-1);

218 
h
+=(
LUA_SIGNATURE
)-1;

219 *
h
++=()
LUAC_VERSION
;

220 *
h
++=()
LUAC_FORMAT
;

221 *
h
++=()*(*)&
x
;

222 *
h
++=()();

223 *
h
++=()(
size_t
);

224 *
h
++=()(
In¡ruùiÚ
);

225 *
h
++=()(
lua_Numb”
);

226 *
h
++=()(((
lua_Numb”
)0.5)==0);

227 
	}
}

	@deps/lua/src/lundump.h

7 #iâdeà
lundump_h


8 
	#lundump_h


	)

10 
	~"lobjeù.h
"

11 
	~"lzio.h
"

14 
LUAI_FUNC
 
PrÙo
* 
luaU_undump
 (
lua_S‹
* 
L
, 
ZIO
* 
Z
, 
Mbufãr
* 
buff
, cÚ¡ * 
Çme
);

17 
LUAI_FUNC
 
luaU_h—d”
 (* 
h
);

20 
LUAI_FUNC
 
luaU_dump
 (
lua_S‹
* 
L
, cÚ¡ 
PrÙo
* 
f
, 
lua_Wr™”
 
w
, * 
d©a
, 
¡r
);

22 #ifdeà
luac_c


24 
LUAI_FUNC
 
luaU_´št
 (cÚ¡ 
PrÙo
* 
f
, 
fuÎ
);

28 
	#LUAC_VERSION
 0x51

	)

31 
	#LUAC_FORMAT
 0

	)

34 
	#LUAC_HEADERSIZE
 12

	)

	@deps/lua/src/lvm.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

12 
	#lvm_c


	)

13 
	#LUA_CORE


	)

15 
	~"lua.h
"

17 
	~"ldebug.h
"

18 
	~"ldo.h
"

19 
	~"lfunc.h
"

20 
	~"lgc.h
"

21 
	~"lobjeù.h
"

22 
	~"lİcodes.h
"

23 
	~"l¡©e.h
"

24 
	~"l¡ršg.h
"

25 
	~"ÉabË.h
"

26 
	~"Ém.h
"

27 
	~"lvm.h
"

32 
	#MAXTAGLOOP
 100

	)

35 cÚ¡ 
TV®ue
 *
	$luaV_tÚumb”
 (cÚ¡ 
TV®ue
 *
obj
, TV®u*
n
) {

36 
lua_Numb”
 
num
;

37 ià(
	`‰i¢umb”
(
obj
))  obj;

38 ià(
	`‰is¡ršg
(
obj
è&& 
	`luaO_¡r2d
(
	`sv®ue
(obj), &
num
)) {

39 
	`£Šv®ue
(
n
, 
num
);

40  
n
;

43  
NULL
;

44 
	}
}

47 
	$luaV_to¡ršg
 (
lua_S‹
 *
L
, 
StkId
 
obj
) {

48 ià(!
	`‰i¢umb”
(
obj
))

51 
s
[
LUAI_MAXNUMBER2STR
];

52 
lua_Numb”
 
n
 = 
	`nv®ue
(
obj
);

53 
	`lua_numb”2¡r
(
s
, 
n
);

54 
	`£tsv®ue2s
(
L
, 
obj
, 
	`luaS_Ãw
(L, 
s
));

57 
	}
}

60 
	$Œaûexec
 (
lua_S‹
 *
L
, cÚ¡ 
In¡ruùiÚ
 *
pc
) {

61 
lu_by‹
 
mask
 = 
L
->
hookmask
;

62 cÚ¡ 
In¡ruùiÚ
 *
Şdpc
 = 
L
->
§vedpc
;

63 
L
->
§vedpc
 = 
pc
;

64 ià((
mask
 & 
LUA_MASKCOUNT
è&& 
L
->
hookcouÁ
 == 0) {

65 
	`»£thookcouÁ
(
L
);

66 
	`luaD_ÿÎhook
(
L
, 
LUA_HOOKCOUNT
, -1);

68 ià(
mask
 & 
LUA_MASKLINE
) {

69 
PrÙo
 *
p
 = 
	`ci_func
(
L
->
ci
)->
l
.p;

70 
Åc
 = 
	`pcR–
(
pc
, 
p
);

71 
Ãwlše
 = 
	`g‘lše
(
p
, 
Åc
);

74 ià(
Åc
 =ğ0 || 
pc
 <ğ
Şdpc
 || 
Ãwlše
 !ğ
	`g‘lše
(
p
, 
	`pcR–
(oldpc,…)))

75 
	`luaD_ÿÎhook
(
L
, 
LUA_HOOKLINE
, 
Ãwlše
);

77 
	}
}

80 
	$ÿÎTM»s
 (
lua_S‹
 *
L
, 
StkId
 
»s
, cÚ¡ 
TV®ue
 *
f
,

81 cÚ¡ 
TV®ue
 *
p1
, cÚ¡ TV®u*
p2
) {

82 
±rdiff_t
 
»suÉ
 = 
	`§ve¡ack
(
L
, 
»s
);

83 
	`£tobj2s
(
L
, L->
tİ
, 
f
);

84 
	`£tobj2s
(
L
, L->
tİ
+1, 
p1
);

85 
	`£tobj2s
(
L
, L->
tİ
+2, 
p2
);

86 
	`luaD_check¡ack
(
L
, 3);

87 
L
->
tİ
 += 3;

88 
	`luaD_ÿÎ
(
L
, L->
tİ
 - 3, 1);

89 
»s
 = 
	`»¡Üe¡ack
(
L
, 
»suÉ
);

90 
L
->
tİ
--;

91 
	`£tobjs2s
(
L
, 
»s
, L->
tİ
);

92 
	}
}

96 
	$ÿÎTM
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
f
, cÚ¡ TV®u*
p1
,

97 cÚ¡ 
TV®ue
 *
p2
, cÚ¡ TV®u*
p3
) {

98 
	`£tobj2s
(
L
, L->
tİ
, 
f
);

99 
	`£tobj2s
(
L
, L->
tİ
+1, 
p1
);

100 
	`£tobj2s
(
L
, L->
tİ
+2, 
p2
);

101 
	`£tobj2s
(
L
, L->
tİ
+3, 
p3
);

102 
	`luaD_check¡ack
(
L
, 4);

103 
L
->
tİ
 += 4;

104 
	`luaD_ÿÎ
(
L
, L->
tİ
 - 4, 0);

105 
	}
}

108 
	$luaV_g‘bË
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
t
, TV®u*
key
, 
StkId
 
v®
) {

109 
loİ
;

110 
loİ
 = 0;†oİ < 
MAXTAGLOOP
;†oop++) {

111 cÚ¡ 
TV®ue
 *
tm
;

112 ià(
	`‰i¡abË
(
t
)) {

113 
TabË
 *
h
 = 
	`hv®ue
(
t
);

114 cÚ¡ 
TV®ue
 *
»s
 = 
	`luaH_g‘
(
h
, 
key
);

115 ià(!
	`‰i¢
(
»s
) ||

116 (
tm
 = 
	`ç¡tm
(
L
, 
h
->
m‘©abË
, 
TM_INDEX
)è=ğ
NULL
) {

117 
	`£tobj2s
(
L
, 
v®
, 
»s
);

122 ià(
	`‰i¢
(
tm
 = 
	`luaT_g‘tmbyobj
(
L
, 
t
, 
TM_INDEX
)))

123 
	`luaG_ty³”rÜ
(
L
, 
t
, "index");

124 ià(
	`‰isfunùiÚ
(
tm
)) {

125 
	`ÿÎTM»s
(
L
, 
v®
, 
tm
, 
t
, 
key
);

128 
t
 = 
tm
;

130 
	`luaG_ruÃ¼Ü
(
L
, "loop in gettable");

131 
	}
}

134 
	$luaV_£‰abË
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
t
, TV®u*
key
, 
StkId
 
v®
) {

135 
loİ
;

136 
TV®ue
 
‹mp
;

137 
loİ
 = 0;†oİ < 
MAXTAGLOOP
;†oop++) {

138 cÚ¡ 
TV®ue
 *
tm
;

139 ià(
	`‰i¡abË
(
t
)) {

140 
TabË
 *
h
 = 
	`hv®ue
(
t
);

141 
TV®ue
 *
Şdv®
 = 
	`luaH_£t
(
L
, 
h
, 
key
);

142 ià(!
	`‰i¢
(
Şdv®
) ||

143 (
tm
 = 
	`ç¡tm
(
L
, 
h
->
m‘©abË
, 
TM_NEWINDEX
)è=ğ
NULL
) {

144 
	`£tobj2t
(
L
, 
Şdv®
, 
v®
);

145 
h
->
æags
 = 0;

146 
	`luaC_b¬r›¹
(
L
, 
h
, 
v®
);

151 ià(
	`‰i¢
(
tm
 = 
	`luaT_g‘tmbyobj
(
L
, 
t
, 
TM_NEWINDEX
)))

152 
	`luaG_ty³”rÜ
(
L
, 
t
, "index");

153 ià(
	`‰isfunùiÚ
(
tm
)) {

154 
	`ÿÎTM
(
L
, 
tm
, 
t
, 
key
, 
v®
);

158 
	`£tobj
(
L
, &
‹mp
, 
tm
);

159 
t
 = &
‹mp
;

161 
	`luaG_ruÃ¼Ü
(
L
, "loop in settable");

162 
	}
}

165 
	$ÿÎ_bšTM
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
p1
, cÚ¡ TV®u*
p2
,

166 
StkId
 
»s
, 
TMS
 
ev’t
) {

167 cÚ¡ 
TV®ue
 *
tm
 = 
	`luaT_g‘tmbyobj
(
L
, 
p1
, 
ev’t
);

168 ià(
	`‰i¢
(
tm
))

169 
tm
 = 
	`luaT_g‘tmbyobj
(
L
, 
p2
, 
ev’t
);

170 ià(
	`‰i¢
(
tm
))  0;

171 
	`ÿÎTM»s
(
L
, 
»s
, 
tm
, 
p1
, 
p2
);

173 
	}
}

176 cÚ¡ 
TV®ue
 *
	$g‘_compTM
 (
lua_S‹
 *
L
, 
TabË
 *
mt1
, TabË *
mt2
,

177 
TMS
 
ev’t
) {

178 cÚ¡ 
TV®ue
 *
tm1
 = 
	`ç¡tm
(
L
, 
mt1
, 
ev’t
);

179 cÚ¡ 
TV®ue
 *
tm2
;

180 ià(
tm1
 =ğ
NULL
)  NULL;

181 ià(
mt1
 =ğ
mt2
è 
tm1
;

182 
tm2
 = 
	`ç¡tm
(
L
, 
mt2
, 
ev’t
);

183 ià(
tm2
 =ğ
NULL
)  NULL;

184 ià(
	`luaO_¿wequ®Obj
(
tm1
, 
tm2
))

185  
tm1
;

186  
NULL
;

187 
	}
}

190 
	$ÿÎ_Üd”TM
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
p1
, cÚ¡ TV®u*
p2
,

191 
TMS
 
ev’t
) {

192 cÚ¡ 
TV®ue
 *
tm1
 = 
	`luaT_g‘tmbyobj
(
L
, 
p1
, 
ev’t
);

193 cÚ¡ 
TV®ue
 *
tm2
;

194 ià(
	`‰i¢
(
tm1
))  -1;

195 
tm2
 = 
	`luaT_g‘tmbyobj
(
L
, 
p2
, 
ev’t
);

196 ià(!
	`luaO_¿wequ®Obj
(
tm1
, 
tm2
))

198 
	`ÿÎTM»s
(
L
, L->
tİ
, 
tm1
, 
p1
, 
p2
);

199  !
	`l_isçl£
(
L
->
tİ
);

200 
	}
}

203 
	$l_¡rcmp
 (cÚ¡ 
TSŒšg
 *
ls
, cÚ¡ TSŒšg *
rs
) {

204 cÚ¡ *
l
 = 
	`g‘¡r
(
ls
);

205 
size_t
 
Î
 = 
ls
->
tsv
.
Ën
;

206 cÚ¡ *
r
 = 
	`g‘¡r
(
rs
);

207 
size_t
 
Ì
 = 
rs
->
tsv
.
Ën
;

209 
‹mp
 = 
	`¡rcŞl
(
l
, 
r
);

210 ià(
‹mp
 != 0) emp;

212 
size_t
 
Ën
 = 
	`¡¾’
(
l
);

213 ià(
Ën
 =ğ
Ì
)

214  (
Ën
 =ğ
Î
) ? 0 : 1;

215 ià(
Ën
 =ğ
Î
)

218 
Ën
++;

219 
l
 +ğ
Ën
; 
Î
 -ğËn; 
r
 +ğËn; 
Ì
 -=†en;

222 
	}
}

225 
	$luaV_Ës¡hª
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
l
, cÚ¡ TV®u*
r
) {

226 
»s
;

227 ià(
	`‰y³
(
l
è!ğ‰y³(
r
))

228  
	`luaG_Üd””rÜ
(
L
, 
l
, 
r
);

229 ià(
	`‰i¢umb”
(
l
))

230  
	`luai_numÉ
(
	`nv®ue
(
l
),‚v®ue(
r
));

231 ià(
	`‰is¡ršg
(
l
))

232  
	`l_¡rcmp
(
	`¿wtsv®ue
(
l
),„awtsv®ue(
r
)) < 0;

233 ià((
»s
 = 
	`ÿÎ_Üd”TM
(
L
, 
l
, 
r
, 
TM_LT
)) != -1)

234  
»s
;

235  
	`luaG_Üd””rÜ
(
L
, 
l
, 
r
);

236 
	}
}

239 
	$Ës£qu®
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
l
, cÚ¡ TV®u*
r
) {

240 
»s
;

241 ià(
	`‰y³
(
l
è!ğ‰y³(
r
))

242  
	`luaG_Üd””rÜ
(
L
, 
l
, 
r
);

243 ià(
	`‰i¢umb”
(
l
))

244  
	`luai_numË
(
	`nv®ue
(
l
),‚v®ue(
r
));

245 ià(
	`‰is¡ršg
(
l
))

246  
	`l_¡rcmp
(
	`¿wtsv®ue
(
l
),„awtsv®ue(
r
)) <= 0;

247 ià((
»s
 = 
	`ÿÎ_Üd”TM
(
L
, 
l
, 
r
, 
TM_LE
)) != -1)

248  
»s
;

249 ià((
»s
 = 
	`ÿÎ_Üd”TM
(
L
, 
r
, 
l
, 
TM_LT
)) != -1)

250  !
»s
;

251  
	`luaG_Üd””rÜ
(
L
, 
l
, 
r
);

252 
	}
}

255 
	$luaV_equ®v®
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
t1
, cÚ¡ TV®u*
t2
) {

256 cÚ¡ 
TV®ue
 *
tm
;

257 
	`lua_as£¹
(
	`‰y³
(
t1
è=ğ‰y³(
t2
));

258 
	`‰y³
(
t1
)) {

259 
LUA_TNIL
:  1;

260 
LUA_TNUMBER
:  
	`luai_numeq
(
	`nv®ue
(
t1
),‚v®ue(
t2
));

261 
LUA_TBOOLEAN
:  
	`bv®ue
(
t1
è=ğbv®ue(
t2
);

262 
LUA_TLIGHTUSERDATA
:  
	`pv®ue
(
t1
è=ğpv®ue(
t2
);

263 
LUA_TUSERDATA
: {

264 ià(
	`uv®ue
(
t1
è=ğuv®ue(
t2
))  1;

265 
tm
 = 
	`g‘_compTM
(
L
, 
	`uv®ue
(
t1
)->
m‘©abË
, uv®ue(
t2
)->metatable,

266 
TM_EQ
);

269 
LUA_TTABLE
: {

270 ià(
	`hv®ue
(
t1
è=ğhv®ue(
t2
))  1;

271 
tm
 = 
	`g‘_compTM
(
L
, 
	`hv®ue
(
t1
)->
m‘©abË
, hv®ue(
t2
)->m‘©abË, 
TM_EQ
);

274 :  
	`gcv®ue
(
t1
è=ğgcv®ue(
t2
);

276 ià(
tm
 =ğ
NULL
)  0;

277 
	`ÿÎTM»s
(
L
, L->
tİ
, 
tm
, 
t1
, 
t2
);

278  !
	`l_isçl£
(
L
->
tİ
);

279 
	}
}

282 
	$luaV_cÚÿt
 (
lua_S‹
 *
L
, 
tÙ®
, 
Ï¡
) {

284 
StkId
 
tİ
 = 
L
->
ba£
 + 
Ï¡
 + 1;

285 
n
 = 2;

286 ià(!(
	`‰is¡ršg
(
tİ
-2è|| 
	`‰i¢umb”
Ñİ-2)è|| !
	`to¡ršg
(
L
,op-1)) {

287 ià(!
	`ÿÎ_bšTM
(
L
, 
tİ
-2,İ-1,İ-2, 
TM_CONCAT
))

288 
	`luaG_cÚÿ‹¼Ü
(
L
, 
tİ
-2,op-1);

289 } ià(
	`tsv®ue
(
tİ
-1)->
Ën
 == 0)

290 ()
	`to¡ršg
(
L
, 
tİ
 - 2);

293 
size_t
 

 = 
	`tsv®ue
(
tİ
-1)->
Ën
;

294 *
bufãr
;

295 
i
;

297 
n
 = 1;‚ < 
tÙ®
 && 
	`to¡ršg
(
L
, 
tİ
-n-1);‚++) {

298 
size_t
 
l
 = 
	`tsv®ue
(
tİ
-
n
-1)->
Ën
;

299 ià(
l
 >ğ
MAX_SIZET
 - 

è
	`luaG_ruÃ¼Ü
(
L
, "string†ength overflow");

300 

 +ğ
l
;

302 
bufãr
 = 
	`luaZ_İ’¥aû
(
L
, &
	`G
(L)->
buff
, 

);

303 

 = 0;

304 
i
=
n
; i>0; i--) {

305 
size_t
 
l
 = 
	`tsv®ue
(
tİ
-
i
)->
Ën
;

306 
	`memıy
(
bufãr
+

, 
	`sv®ue
(
tİ
-
i
), 
l
);

307 

 +ğ
l
;

309 
	`£tsv®ue2s
(
L
, 
tİ
-
n
, 
	`luaS_Ãwl¡r
(L, 
bufãr
, 

));

311 
tÙ®
 -ğ
n
-1;

312 
Ï¡
 -ğ
n
-1;

313 } 
tÙ®
 > 1);

314 
	}
}

317 
	$Ar™h
 (
lua_S‹
 *
L
, 
StkId
 
¿
, cÚ¡ 
TV®ue
 *
rb
,

318 cÚ¡ 
TV®ue
 *
rc
, 
TMS
 
İ
) {

319 
TV®ue
 
‹mpb
, 
‹mpc
;

320 cÚ¡ 
TV®ue
 *
b
, *
c
;

321 ià((
b
 = 
	`luaV_tÚumb”
(
rb
, &
‹mpb
)è!ğ
NULL
 &&

322 (
c
 = 
	`luaV_tÚumb”
(
rc
, &
‹mpc
)è!ğ
NULL
) {

323 
lua_Numb”
 
nb
 = 
	`nv®ue
(
b
), 
nc
 =‚v®ue(
c
);

324 
İ
) {

325 
TM_ADD
: 
	`£Šv®ue
(
¿
, 
	`luai_numadd
(
nb
, 
nc
)); ;

326 
TM_SUB
: 
	`£Šv®ue
(
¿
, 
	`luai_numsub
(
nb
, 
nc
)); ;

327 
TM_MUL
: 
	`£Šv®ue
(
¿
, 
	`luai_nummul
(
nb
, 
nc
)); ;

328 
TM_DIV
: 
	`£Šv®ue
(
¿
, 
	`luai_numdiv
(
nb
, 
nc
)); ;

329 
TM_MOD
: 
	`£Šv®ue
(
¿
, 
	`luai_nummod
(
nb
, 
nc
)); ;

330 
TM_POW
: 
	`£Šv®ue
(
¿
, 
	`luai_numpow
(
nb
, 
nc
)); ;

331 
TM_UNM
: 
	`£Šv®ue
(
¿
, 
	`luai_numunm
(
nb
)); ;

332 : 
	`lua_as£¹
(0); ;

335 ià(!
	`ÿÎ_bšTM
(
L
, 
rb
, 
rc
, 
¿
, 
İ
))

336 
	`luaG_¬™h”rÜ
(
L
, 
rb
, 
rc
);

337 
	}
}

345 
	#ruÁime_check
(
L
, 
c
è{ ià(!(c)è; }

	)

347 
	#RA
(
i
è(
ba£
+
	`GETARG_A
(i))

	)

349 
	#RB
(
i
è
	`check_exp
(
	`g‘BMode
(
	`GET_OPCODE
(i)è=ğ
OpArgR
, 
ba£
+
	`GETARG_B
(i))

	)

350 
	#RC
(
i
è
	`check_exp
(
	`g‘CMode
(
	`GET_OPCODE
(i)è=ğ
OpArgR
, 
ba£
+
	`GETARG_C
(i))

	)

351 
	#RKB
(
i
è
	`check_exp
(
	`g‘BMode
(
	`GET_OPCODE
(i)è=ğ
OpArgK
, \

352 
	`ISK
(
	`GETARG_B
(
i
)è? 
k
+
	`INDEXK
(GETARG_B(i)è: 
ba£
+GETARG_B(i))

	)

353 
	#RKC
(
i
è
	`check_exp
(
	`g‘CMode
(
	`GET_OPCODE
(i)è=ğ
OpArgK
, \

354 
	`ISK
(
	`GETARG_C
(
i
)è? 
k
+
	`INDEXK
(GETARG_C(i)è: 
ba£
+GETARG_C(i))

	)

355 
	#KBx
(
i
è
	`check_exp
(
	`g‘BMode
(
	`GET_OPCODE
(i)è=ğ
OpArgK
, 
k
+
	`GETARG_Bx
(i))

	)

358 
	#dojump
(
L
,
pc
,
i
è{Õcè+ğ(i); 
	`luai_th»ady›ld
(L);}

	)

361 
	#PrÙeù
(
x
è{ 
L
->
§vedpc
 = 
pc
; {x;}; 
ba£
 = L->ba£; }

	)

364 
	#¬™h_İ
(
İ
,
tm
) { \

365 
TV®ue
 *
rb
 = 
	`RKB
(
i
); \

366 
TV®ue
 *
rc
 = 
	`RKC
(
i
); \

367 ià(
	`‰i¢umb”
(
rb
è&&ti¢umb”(
rc
)) { \

368 
lua_Numb”
 
nb
 = 
	`nv®ue
(
rb
), 
nc
 =‚v®ue(
rc
); \

369 
	`£Šv®ue
(
¿
, 
	`İ
(
nb
, 
nc
)); \

372 
	`PrÙeù
(
	`Ar™h
(
L
, 
¿
, 
rb
, 
rc
, 
tm
)); \

373 }

	)

377 
	$luaV_execu‹
 (
lua_S‹
 *
L
, 
ÃxecÿÎs
) {

378 
LClosu»
 *
ş
;

379 
StkId
 
ba£
;

380 
TV®ue
 *
k
;

381 cÚ¡ 
In¡ruùiÚ
 *
pc
;

382 
»’Œy
:

383 
	`lua_as£¹
(
	`isLua
(
L
->
ci
));

384 
pc
 = 
L
->
§vedpc
;

385 
ş
 = &
	`şv®ue
(
L
->
ci
->
func
)->
l
;

386 
ba£
 = 
L
->base;

387 
k
 = 
ş
->
p
->k;

390 cÚ¡ 
In¡ruùiÚ
 
i
 = *
pc
++;

391 
StkId
 
¿
;

392 ià((
L
->
hookmask
 & (
LUA_MASKLINE
 | 
LUA_MASKCOUNT
)) &&

393 (--
L
->
hookcouÁ
 =ğ0 || L->
hookmask
 & 
LUA_MASKLINE
)) {

394 
	`Œaûexec
(
L
, 
pc
);

395 ià(
L
->
¡©us
 =ğ
LUA_YIELD
) {

396 
L
->
§vedpc
 = 
pc
 - 1;

399 
ba£
 = 
L
->base;

402 
¿
 = 
	`RA
(
i
);

403 
	`lua_as£¹
(
ba£
 =ğ
L
->ba£ && L->ba£ =ğL->
ci
->base);

404 
	`lua_as£¹
(
ba£
 <ğ
L
->
tİ
 && L->tİ <ğL->
¡ack
 + L->
¡acksize
);

405 
	`lua_as£¹
(
L
->
tİ
 =ğL->
ci
->tİ || 
	`luaG_checkİ’İ
(
i
));

406 
	`GET_OPCODE
(
i
)) {

407 
OP_MOVE
: {

408 
	`£tobjs2s
(
L
, 
¿
, 
	`RB
(
i
));

411 
OP_LOADK
: {

412 
	`£tobj2s
(
L
, 
¿
, 
	`KBx
(
i
));

415 
OP_LOADBOOL
: {

416 
	`£tbv®ue
(
¿
, 
	`GETARG_B
(
i
));

417 ià(
	`GETARG_C
(
i
)è
pc
++;

420 
OP_LOADNIL
: {

421 
TV®ue
 *
rb
 = 
	`RB
(
i
);

423 
	`£Šv®ue
(
rb
--);

424 } 
rb
 >ğ
¿
);

427 
OP_GETUPVAL
: {

428 
b
 = 
	`GETARG_B
(
i
);

429 
	`£tobj2s
(
L
, 
¿
, 
ş
->
upv®s
[
b
]->
v
);

432 
OP_GETGLOBAL
: {

433 
TV®ue
 
g
;

434 
TV®ue
 *
rb
 = 
	`KBx
(
i
);

435 
	`£thv®ue
(
L
, &
g
, 
ş
->
’v
);

436 
	`lua_as£¹
(
	`‰is¡ršg
(
rb
));

437 
	`PrÙeù
(
	`luaV_g‘bË
(
L
, &
g
, 
rb
, 
¿
));

440 
OP_GETTABLE
: {

441 
	`PrÙeù
(
	`luaV_g‘bË
(
L
, 
	`RB
(
i
), 
	`RKC
(i), 
¿
));

444 
OP_SETGLOBAL
: {

445 
TV®ue
 
g
;

446 
	`£thv®ue
(
L
, &
g
, 
ş
->
’v
);

447 
	`lua_as£¹
(
	`‰is¡ršg
(
	`KBx
(
i
)));

448 
	`PrÙeù
(
	`luaV_£‰abË
(
L
, &
g
, 
	`KBx
(
i
), 
¿
));

451 
OP_SETUPVAL
: {

452 
UpV®
 *
uv
 = 
ş
->
upv®s
[
	`GETARG_B
(
i
)];

453 
	`£tobj
(
L
, 
uv
->
v
, 
¿
);

454 
	`luaC_b¬r›r
(
L
, 
uv
, 
¿
);

457 
OP_SETTABLE
: {

458 
	`PrÙeù
(
	`luaV_£‰abË
(
L
, 
¿
, 
	`RKB
(
i
), 
	`RKC
(i)));

461 
OP_NEWTABLE
: {

462 
b
 = 
	`GETARG_B
(
i
);

463 
c
 = 
	`GETARG_C
(
i
);

464 
	`£thv®ue
(
L
, 
¿
, 
	`luaH_Ãw
(L, 
	`luaO_fb2št
(
b
),†uaO_fb2št(
c
)));

465 
	`PrÙeù
(
	`luaC_checkGC
(
L
));

468 
OP_SELF
: {

469 
StkId
 
rb
 = 
	`RB
(
i
);

470 
	`£tobjs2s
(
L
, 
¿
+1, 
rb
);

471 
	`PrÙeù
(
	`luaV_g‘bË
(
L
, 
rb
, 
	`RKC
(
i
), 
¿
));

474 
OP_ADD
: {

475 
	`¬™h_İ
(
luai_numadd
, 
TM_ADD
);

478 
OP_SUB
: {

479 
	`¬™h_İ
(
luai_numsub
, 
TM_SUB
);

482 
OP_MUL
: {

483 
	`¬™h_İ
(
luai_nummul
, 
TM_MUL
);

486 
OP_DIV
: {

487 
	`¬™h_İ
(
luai_numdiv
, 
TM_DIV
);

490 
OP_MOD
: {

491 
	`¬™h_İ
(
luai_nummod
, 
TM_MOD
);

494 
OP_POW
: {

495 
	`¬™h_İ
(
luai_numpow
, 
TM_POW
);

498 
OP_UNM
: {

499 
TV®ue
 *
rb
 = 
	`RB
(
i
);

500 ià(
	`‰i¢umb”
(
rb
)) {

501 
lua_Numb”
 
nb
 = 
	`nv®ue
(
rb
);

502 
	`£Šv®ue
(
¿
, 
	`luai_numunm
(
nb
));

505 
	`PrÙeù
(
	`Ar™h
(
L
, 
¿
, 
rb
,„b, 
TM_UNM
));

509 
OP_NOT
: {

510 
»s
 = 
	`l_isçl£
(
	`RB
(
i
));

511 
	`£tbv®ue
(
¿
, 
»s
);

514 
OP_LEN
: {

515 cÚ¡ 
TV®ue
 *
rb
 = 
	`RB
(
i
);

516 
	`‰y³
(
rb
)) {

517 
LUA_TTABLE
: {

518 
	`£Šv®ue
(
¿
, 
	`ÿ¡_num
(
	`luaH_g‘n
(
	`hv®ue
(
rb
))));

521 
LUA_TSTRING
: {

522 
	`£Šv®ue
(
¿
, 
	`ÿ¡_num
(
	`tsv®ue
(
rb
)->
Ën
));

526 
	`PrÙeù
(

527 ià(!
	`ÿÎ_bšTM
(
L
, 
rb
, 
luaO_nobjeù
, 
¿
, 
TM_LEN
))

528 
	`luaG_ty³”rÜ
(
L
, 
rb
, "get†ength of");

534 
OP_CONCAT
: {

535 
b
 = 
	`GETARG_B
(
i
);

536 
c
 = 
	`GETARG_C
(
i
);

537 
	`PrÙeù
(
	`luaV_cÚÿt
(
L
, 
c
-
b
+1, c); 
	`luaC_checkGC
(L));

538 
	`£tobjs2s
(
L
, 
	`RA
(
i
), 
ba£
+
b
);

541 
OP_JMP
: {

542 
	`dojump
(
L
, 
pc
, 
	`GETARG_sBx
(
i
));

545 
OP_EQ
: {

546 
TV®ue
 *
rb
 = 
	`RKB
(
i
);

547 
TV®ue
 *
rc
 = 
	`RKC
(
i
);

548 
	`PrÙeù
(

549 ià(
	`equ®obj
(
L
, 
rb
, 
rc
è=ğ
	`GETARG_A
(
i
))

550 
	`dojump
(
L
, 
pc
, 
	`GETARG_sBx
(*pc));

552 
pc
++;

555 
OP_LT
: {

556 
	`PrÙeù
(

557 ià(
	`luaV_Ës¡hª
(
L
, 
	`RKB
(
i
), 
	`RKC
(i)è=ğ
	`GETARG_A
(i))

558 
	`dojump
(
L
, 
pc
, 
	`GETARG_sBx
(*pc));

560 
pc
++;

563 
OP_LE
: {

564 
	`PrÙeù
(

565 ià(
	`Ës£qu®
(
L
, 
	`RKB
(
i
), 
	`RKC
(i)è=ğ
	`GETARG_A
(i))

566 
	`dojump
(
L
, 
pc
, 
	`GETARG_sBx
(*pc));

568 
pc
++;

571 
OP_TEST
: {

572 ià(
	`l_isçl£
(
¿
è!ğ
	`GETARG_C
(
i
))

573 
	`dojump
(
L
, 
pc
, 
	`GETARG_sBx
(*pc));

574 
pc
++;

577 
OP_TESTSET
: {

578 
TV®ue
 *
rb
 = 
	`RB
(
i
);

579 ià(
	`l_isçl£
(
rb
è!ğ
	`GETARG_C
(
i
)) {

580 
	`£tobjs2s
(
L
, 
¿
, 
rb
);

581 
	`dojump
(
L
, 
pc
, 
	`GETARG_sBx
(*pc));

583 
pc
++;

586 
OP_CALL
: {

587 
b
 = 
	`GETARG_B
(
i
);

588 
ÄesuÉs
 = 
	`GETARG_C
(
i
) - 1;

589 ià(
b
 !ğ0è
L
->
tİ
 = 
¿
+b;

590 
L
->
§vedpc
 = 
pc
;

591 
	`luaD_´eÿÎ
(
L
, 
¿
, 
ÄesuÉs
)) {

592 
PCRLUA
: {

593 
ÃxecÿÎs
++;

594 
»’Œy
;

596 
PCRC
: {

598 ià(
ÄesuÉs
 >ğ0è
L
->
tİ
 = L->
ci
->top;

599 
ba£
 = 
L
->base;

607 
OP_TAILCALL
: {

608 
b
 = 
	`GETARG_B
(
i
);

609 ià(
b
 !ğ0è
L
->
tİ
 = 
¿
+b;

610 
L
->
§vedpc
 = 
pc
;

611 
	`lua_as£¹
(
	`GETARG_C
(
i
è- 1 =ğ
LUA_MULTRET
);

612 
	`luaD_´eÿÎ
(
L
, 
¿
, 
LUA_MULTRET
)) {

613 
PCRLUA
: {

615 
C®lInfo
 *
ci
 = 
L
->ci - 1;

616 
aux
;

617 
StkId
 
func
 = 
ci
->func;

618 
StkId
 
pfunc
 = (
ci
+1)->
func
;

619 ià(
L
->
İ’upv®
è
	`luaF_şo£
(L, 
ci
->
ba£
);

620 
L
->
ba£
 = 
ci
->ba£ = ci->
func
 + ((ci+1)->ba£ - 
pfunc
);

621 
aux
 = 0; 
pfunc
+aux < 
L
->
tİ
;‡ux++)

622 
	`£tobjs2s
(
L
, 
func
+
aux
, 
pfunc
+aux);

623 
ci
->
tİ
 = 
L
->tİ = 
func
+
aux
;

624 
	`lua_as£¹
(
L
->
tİ
 =ğL->
ba£
 + 
	`şv®ue
(
func
)->
l
.
p
->
max¡acksize
);

625 
ci
->
§vedpc
 = 
L
->savedpc;

626 
ci
->
ÿÎs
++;

627 
L
->
ci
--;

628 
»’Œy
;

630 
PCRC
: {

631 
ba£
 = 
L
->base;

639 
OP_RETURN
: {

640 
b
 = 
	`GETARG_B
(
i
);

641 ià(
b
 !ğ0è
L
->
tİ
 = 
¿
+b-1;

642 ià(
L
->
İ’upv®
è
	`luaF_şo£
(L, 
ba£
);

643 
L
->
§vedpc
 = 
pc
;

644 
b
 = 
	`luaD_posÿÎ
(
L
, 
¿
);

645 ià(--
ÃxecÿÎs
 == 0)

648 ià(
b
è
L
->
tİ
 = L->
ci
->top;

649 
	`lua_as£¹
(
	`isLua
(
L
->
ci
));

650 
	`lua_as£¹
(
	`GET_OPCODE
(*((
L
->
ci
)->
§vedpc
 - 1)è=ğ
OP_CALL
);

651 
»’Œy
;

654 
OP_FORLOOP
: {

655 
lua_Numb”
 
¡•
 = 
	`nv®ue
(
¿
+2);

656 
lua_Numb”
 
idx
 = 
	`luai_numadd
(
	`nv®ue
(
¿
), 
¡•
);

657 
lua_Numb”
 
lim™
 = 
	`nv®ue
(
¿
+1);

658 ià(
	`luai_numÉ
(0, 
¡•
è? 
	`luai_numË
(
idx
, 
lim™
)

659 : 
	`luai_numË
(
lim™
, 
idx
)) {

660 
	`dojump
(
L
, 
pc
, 
	`GETARG_sBx
(
i
));

661 
	`£Šv®ue
(
¿
, 
idx
);

662 
	`£Šv®ue
(
¿
+3, 
idx
);

666 
OP_FORPREP
: {

667 cÚ¡ 
TV®ue
 *
š™
 = 
¿
;

668 cÚ¡ 
TV®ue
 *
¶im™
 = 
¿
+1;

669 cÚ¡ 
TV®ue
 *
p¡•
 = 
¿
+2;

670 
L
->
§vedpc
 = 
pc
;

671 ià(!
	`tÚumb”
(
š™
, 
¿
))

672 
	`luaG_ruÃ¼Ü
(
L
, 
	`LUA_QL
("for") " initial value must be‡‚umber");

673 ià(!
	`tÚumb”
(
¶im™
, 
¿
+1))

674 
	`luaG_ruÃ¼Ü
(
L
, 
	`LUA_QL
("for") "†imit must be‡‚umber");

675 ià(!
	`tÚumb”
(
p¡•
, 
¿
+2))

676 
	`luaG_ruÃ¼Ü
(
L
, 
	`LUA_QL
("for") " step must be‡‚umber");

677 
	`£Šv®ue
(
¿
, 
	`luai_numsub
(
	`nv®ue
Ôa),‚v®ue(
p¡•
)));

678 
	`dojump
(
L
, 
pc
, 
	`GETARG_sBx
(
i
));

681 
OP_TFORLOOP
: {

682 
StkId
 
cb
 = 
¿
 + 3;

683 
	`£tobjs2s
(
L
, 
cb
+2, 
¿
+2);

684 
	`£tobjs2s
(
L
, 
cb
+1, 
¿
+1);

685 
	`£tobjs2s
(
L
, 
cb
, 
¿
);

686 
L
->
tİ
 = 
cb
+3;

687 
	`PrÙeù
(
	`luaD_ÿÎ
(
L
, 
cb
, 
	`GETARG_C
(
i
)));

688 
L
->
tİ
 = L->
ci
->top;

689 
cb
 = 
	`RA
(
i
) + 3;

690 ià(!
	`‰i¢
(
cb
)) {

691 
	`£tobjs2s
(
L
, 
cb
-1, cb);

692 
	`dojump
(
L
, 
pc
, 
	`GETARG_sBx
(*pc));

694 
pc
++;

697 
OP_SETLIST
: {

698 
n
 = 
	`GETARG_B
(
i
);

699 
c
 = 
	`GETARG_C
(
i
);

700 
Ï¡
;

701 
TabË
 *
h
;

702 ià(
n
 == 0) {

703 
n
 = 
	`ÿ¡_št
(
L
->
tİ
 - 
¿
) - 1;

704 
L
->
tİ
 = L->
ci
->top;

706 ià(
c
 =ğ0èøğ
	`ÿ¡_št
(*
pc
++);

707 
	`ruÁime_check
(
L
, 
	`‰i¡abË
(
¿
));

708 
h
 = 
	`hv®ue
(
¿
);

709 
Ï¡
 = ((
c
-1)*
LFIELDS_PER_FLUSH
è+ 
n
;

710 ià(
Ï¡
 > 
h
->
siz—¼ay
)

711 
	`luaH_»siz—¼ay
(
L
, 
h
, 
Ï¡
);

712 ; 
n
 > 0;‚--) {

713 
TV®ue
 *
v®
 = 
¿
+
n
;

714 
	`£tobj2t
(
L
, 
	`luaH_£Šum
(L, 
h
, 
Ï¡
--), 
v®
);

715 
	`luaC_b¬r›¹
(
L
, 
h
, 
v®
);

719 
OP_CLOSE
: {

720 
	`luaF_şo£
(
L
, 
¿
);

723 
OP_CLOSURE
: {

724 
PrÙo
 *
p
;

725 
Closu»
 *
nş
;

726 
nup
, 
j
;

727 
p
 = 
ş
->p->p[
	`GETARG_Bx
(
i
)];

728 
nup
 = 
p
->
nups
;

729 
nş
 = 
	`luaF_ÃwLşosu»
(
L
, 
nup
, 
ş
->
’v
);

730 
nş
->
l
.
p
 =…;

731 
j
=0; j<
nup
; j++, 
pc
++) {

732 ià(
	`GET_OPCODE
(*
pc
è=ğ
OP_GETUPVAL
)

733 
nş
->
l
.
upv®s
[
j
] = 
ş
->upv®s[
	`GETARG_B
(*
pc
)];

735 
	`lua_as£¹
(
	`GET_OPCODE
(*
pc
è=ğ
OP_MOVE
);

736 
nş
->
l
.
upv®s
[
j
] = 
	`luaF_fšdupv®
(
L
, 
ba£
 + 
	`GETARG_B
(*
pc
));

739 
	`£tşv®ue
(
L
, 
¿
, 
nş
);

740 
	`PrÙeù
(
	`luaC_checkGC
(
L
));

743 
OP_VARARG
: {

744 
b
 = 
	`GETARG_B
(
i
) - 1;

745 
j
;

746 
C®lInfo
 *
ci
 = 
L
->ci;

747 
n
 = 
	`ÿ¡_št
(
ci
->
ba£
 - ci->
func
è- 
ş
->
p
->
num·¿ms
 - 1;

748 ià(
b
 =ğ
LUA_MULTRET
) {

749 
	`PrÙeù
(
	`luaD_check¡ack
(
L
, 
n
));

750 
¿
 = 
	`RA
(
i
);

751 
b
 = 
n
;

752 
L
->
tİ
 = 
¿
 + 
n
;

754 
j
 = 0; j < 
b
; j++) {

755 ià(
j
 < 
n
) {

756 
	`£tobjs2s
(
L
, 
¿
 + 
j
, 
ci
->
ba£
 - 
n
 + j);

759 
	`£Šv®ue
(
¿
 + 
j
);

766 
	}
}

	@deps/lua/src/lvm.h

7 #iâdeà
lvm_h


8 
	#lvm_h


	)

11 
	~"ldo.h
"

12 
	~"lobjeù.h
"

13 
	~"Ém.h
"

16 
	#to¡ršg
(
L
,
o
è((
	`‰y³
(oè=ğ
LUA_TSTRING
è|| (
	`luaV_to¡ršg
(L, o)))

	)

18 
	#tÚumb”
(
o
,
n
è(
	`‰y³
(oè=ğ
LUA_TNUMBER
 || \

19 (((
o
èğ
	`luaV_tÚumb”
(o,
n
)è!ğ
NULL
))

	)

21 
	#equ®obj
(
L
,
o1
,
o2
) \

22 (
	`‰y³
(
o1
è=ğ‰y³(
o2
è&& 
	`luaV_equ®v®
(
L
, o1, o2))

	)

25 
LUAI_FUNC
 
luaV_Ës¡hª
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
l
, cÚ¡ TV®u*
r
);

26 
LUAI_FUNC
 
luaV_equ®v®
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
t1
, cÚ¡ TV®u*
t2
);

27 
LUAI_FUNC
 cÚ¡ 
TV®ue
 *
luaV_tÚumb”
 (cÚ¡ TV®u*
obj
, TV®u*
n
);

28 
LUAI_FUNC
 
luaV_to¡ršg
 (
lua_S‹
 *
L
, 
StkId
 
obj
);

29 
LUAI_FUNC
 
luaV_g‘bË
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
t
, TV®u*
key
,

30 
StkId
 
v®
);

31 
LUAI_FUNC
 
luaV_£‰abË
 (
lua_S‹
 *
L
, cÚ¡ 
TV®ue
 *
t
, TV®u*
key
,

32 
StkId
 
v®
);

33 
LUAI_FUNC
 
luaV_execu‹
 (
lua_S‹
 *
L
, 
ÃxecÿÎs
);

34 
LUAI_FUNC
 
luaV_cÚÿt
 (
lua_S‹
 *
L
, 
tÙ®
, 
Ï¡
);

	@deps/lua/src/lzio.c

8 
	~<¡ršg.h
>

10 
	#lzio_c


	)

11 
	#LUA_CORE


	)

13 
	~"lua.h
"

15 
	~"Îim™s.h
"

16 
	~"lmem.h
"

17 
	~"l¡©e.h
"

18 
	~"lzio.h
"

21 
	$luaZ_fl
 (
ZIO
 *
z
) {

22 
size_t
 
size
;

23 
lua_S‹
 *
L
 = 
z
->L;

24 cÚ¡ *
buff
;

25 
	`lua_uÆock
(
L
);

26 
buff
 = 
z
->
	`»ad”
(
L
, z->
d©a
, &
size
);

27 
	`lua_lock
(
L
);

28 ià(
buff
 =ğ
NULL
 || 
size
 =ğ0è 
EOZ
;

29 
z
->
n
 = 
size
 - 1;

30 
z
->
p
 = 
buff
;

31  
	`ch¬2št
(*(
z
->
p
++));

32 
	}
}

35 
	$luaZ_lookah—d
 (
ZIO
 *
z
) {

36 ià(
z
->
n
 == 0) {

37 ià(
	`luaZ_fl
(
z
è=ğ
EOZ
)

38  
EOZ
;

40 
z
->
n
++;

41 
z
->
p
--;

44  
	`ch¬2št
(*
z
->
p
);

45 
	}
}

48 
	$luaZ_š™
 (
lua_S‹
 *
L
, 
ZIO
 *
z
, 
lua_R—d”
 
»ad”
, *
d©a
) {

49 
z
->
L
 = L;

50 
z
->
»ad”
 =„eader;

51 
z
->
d©a
 = data;

52 
z
->
n
 = 0;

53 
z
->
p
 = 
NULL
;

54 
	}
}

58 
size_t
 
	$luaZ_»ad
 (
ZIO
 *
z
, *
b
, 
size_t
 
n
) {

59 
n
) {

60 
size_t
 
m
;

61 ià(
	`luaZ_lookah—d
(
z
è=ğ
EOZ
)

62  
n
;

63 
m
 = (
n
 <ğ
z
->n) ?‚ : z->n;

64 
	`memıy
(
b
, 
z
->
p
, 
m
);

65 
z
->
n
 -ğ
m
;

66 
z
->
p
 +ğ
m
;

67 
b
 = (*)b + 
m
;

68 
n
 -ğ
m
;

71 
	}
}

74 *
	$luaZ_İ’¥aû
 (
lua_S‹
 *
L
, 
Mbufãr
 *
buff
, 
size_t
 
n
) {

75 ià(
n
 > 
buff
->
buffsize
) {

76 ià(
n
 < 
LUA_MINBUFFER
)‚ = LUA_MINBUFFER;

77 
	`luaZ_»sizebufãr
(
L
, 
buff
, 
n
);

79  
buff
->
bufãr
;

80 
	}
}

	@deps/lua/src/lzio.h

8 #iâdeà
lzio_h


9 
	#lzio_h


	)

11 
	~"lua.h
"

13 
	~"lmem.h
"

16 
	#EOZ
 (-1è

	)

18 
Zio
 
	tZIO
;

20 
	#ch¬2št
(
c
è
	`ÿ¡
(, ca¡(, (c)))

	)

22 
	#zg‘c
(
z
è(((z)->
n
--)>0 ? 
	`ch¬2št
(*(z)->
p
++è: 
	`luaZ_fl
(z))

	)

24 
	sMbufãr
 {

25 *
	mbufãr
;

26 
size_t
 
	mn
;

27 
size_t
 
	mbuffsize
;

28 } 
	tMbufãr
;

30 
	#luaZ_š™bufãr
(
L
, 
buff
è((buff)->
bufãr
 = 
NULL
, (buff)->
buffsize
 = 0)

	)

32 
	#luaZ_bufãr
(
buff
è((buff)->
bufãr
)

	)

33 
	#luaZ_sizebufãr
(
buff
è((buff)->
buffsize
)

	)

34 
	#luaZ_bufæ’
(
buff
è((buff)->
n
)

	)

36 
	#luaZ_»£tbufãr
(
buff
è((buff)->
n
 = 0)

	)

39 
	#luaZ_»sizebufãr
(
L
, 
buff
, 
size
) \

40 (
	`luaM_»®locveùÜ
(
L
, (
buff
)->
bufãr
, (buff)->
buffsize
, 
size
, ), \

41 (
buff
)->
buffsize
 = 
size
)

	)

43 
	#luaZ_ä“bufãr
(
L
, 
buff
è
	`luaZ_»sizebufãr
(L, buff, 0)

	)

46 
LUAI_FUNC
 *
luaZ_İ’¥aû
 (
lua_S‹
 *
L
, 
Mbufãr
 *
buff
, 
size_t
 
n
);

47 
LUAI_FUNC
 
luaZ_š™
 (
lua_S‹
 *
L
, 
ZIO
 *
z
, 
lua_R—d”
 
»ad”
,

48 *
d©a
);

49 
LUAI_FUNC
 
size_t
 
luaZ_»ad
 (
ZIO
* 
z
, * 
b
, size_ˆ
n
);

50 
LUAI_FUNC
 
luaZ_lookah—d
 (
ZIO
 *
z
);

56 
	sZio
 {

57 
size_t
 
	mn
;

58 cÚ¡ *
	mp
;

59 
lua_R—d”
 
	m»ad”
;

60 * 
	md©a
;

61 
lua_S‹
 *
	mL
;

65 
LUAI_FUNC
 
luaZ_fl
 (
ZIO
 *
z
);

	@deps/lua/src/print.c

7 
	~<ùy³.h
>

8 
	~<¡dio.h
>

10 
	#luac_c


	)

11 
	#LUA_CORE


	)

13 
	~"ldebug.h
"

14 
	~"lobjeù.h
"

15 
	~"lİcodes.h
"

16 
	~"lundump.h
"

18 
	#PrštFunùiÚ
 
luaU_´št


	)

20 
	#Sizeof
(
x
è(()(x))

	)

21 
	#VOID
(
p
è((cÚ¡ *)Õ))

	)

23 
	$PrštSŒšg
(cÚ¡ 
TSŒšg
* 
ts
)

25 cÚ¡ * 
s
=
	`g‘¡r
(
ts
);

26 
size_t
 
i
,
n
=
ts
->
tsv
.
Ën
;

27 
	`putch¬
('"');

28 
i
=0; i<
n
; i++)

30 
c
=
s
[
i
];

31 
c
)

33 '"': 
	`´štf
("\\\""); ;

34 '\\': 
	`´štf
("\\\\"); ;

35 '\a': 
	`´štf
("\\a"); ;

36 '\b': 
	`´štf
("\\b"); ;

37 '\f': 
	`´štf
("\\f"); ;

38 '\n': 
	`´štf
("\\n"); ;

39 '\r': 
	`´štf
("\\r"); ;

40 '\t': 
	`´štf
("\\t"); ;

41 '\v': 
	`´štf
("\\v"); ;

42 : ià(
	`i¥ršt
(()
c
))

43 
	`putch¬
(
c
);

45 
	`´štf
("\\%03u",()
c
);

48 
	`putch¬
('"');

49 
	}
}

51 
	$PrštCÚ¡ªt
(cÚ¡ 
PrÙo
* 
f
, 
i
)

53 cÚ¡ 
TV®ue
* 
o
=&
f
->
k
[
i
];

54 
	`‰y³
(
o
))

56 
LUA_TNIL
:

57 
	`´štf
("nil");

59 
LUA_TBOOLEAN
:

60 
	`´štf
(
	`bv®ue
(
o
) ? "true" : "false");

62 
LUA_TNUMBER
:

63 
	`´štf
(
LUA_NUMBER_FMT
,
	`nv®ue
(
o
));

65 
LUA_TSTRING
:

66 
	`PrštSŒšg
(
	`¿wtsv®ue
(
o
));

69 
	`´štf
("?y³=%d",
	`‰y³
(
o
));

72 
	}
}

74 
	$PrštCode
(cÚ¡ 
PrÙo
* 
f
)

76 cÚ¡ 
In¡ruùiÚ
* 
code
=
f
->code;

77 
pc
,
n
=
f
->
sizecode
;

78 
pc
=0;…c<
n
;…c++)

80 
In¡ruùiÚ
 
i
=
code
[
pc
];

81 
OpCode
 
o
=
	`GET_OPCODE
(
i
);

82 
a
=
	`GETARG_A
(
i
);

83 
b
=
	`GETARG_B
(
i
);

84 
c
=
	`GETARG_C
(
i
);

85 
bx
=
	`GETARG_Bx
(
i
);

86 
sbx
=
	`GETARG_sBx
(
i
);

87 
lše
=
	`g‘lše
(
f
,
pc
);

88 
	`´štf
("\t%d\t",
pc
+1);

89 ià(
lše
>0è
	`´štf
("[%d]\t",line); printf("[-]\t");

90 
	`´štf
("%-9s\t",
luaP_İÇmes
[
o
]);

91 
	`g‘OpMode
(
o
))

93 
iABC
:

94 
	`´štf
("%d",
a
);

95 ià(
	`g‘BMode
(
o
)!=
OpArgN
è
	`´štf
(" %d",
	`ISK
(
b
è? (-1-
	`INDEXK
(b)) : b);

96 ià(
	`g‘CMode
(
o
)!=
OpArgN
è
	`´štf
(" %d",
	`ISK
(
c
è? (-1-
	`INDEXK
(c)) : c);

98 
iABx
:

99 ià(
	`g‘BMode
(
o
)==
OpArgK
è
	`´štf
("%d %d",
a
,-1-
bx
); printf("%d %d",a,bx);

101 
iAsBx
:

102 ià(
o
==
OP_JMP
è
	`´štf
("%d",
sbx
); ´štf("%d %d",
a
,sbx);

105 
o
)

107 
OP_LOADK
:

108 
	`´štf
("\t; "); 
	`PrštCÚ¡ªt
(
f
,
bx
);

110 
OP_GETUPVAL
:

111 
OP_SETUPVAL
:

112 
	`´štf
("\t; %s", (
f
->
sizeupv®ues
>0è? 
	`g‘¡r
(f->
upv®ues
[
b
]) : "-");

114 
OP_GETGLOBAL
:

115 
OP_SETGLOBAL
:

116 
	`´štf
("\t; %s",
	`sv®ue
(&
f
->
k
[
bx
]));

118 
OP_GETTABLE
:

119 
OP_SELF
:

120 ià(
	`ISK
(
c
)è{ 
	`´štf
("\t; "); 
	`PrštCÚ¡ªt
(
f
,
	`INDEXK
(c)); }

122 
OP_SETTABLE
:

123 
OP_ADD
:

124 
OP_SUB
:

125 
OP_MUL
:

126 
OP_DIV
:

127 
OP_POW
:

128 
OP_EQ
:

129 
OP_LT
:

130 
OP_LE
:

131 ià(
	`ISK
(
b
è|| ISK(
c
))

133 
	`´štf
("\t; ");

134 ià(
	`ISK
(
b
)è
	`PrštCÚ¡ªt
(
f
,
	`INDEXK
(b)); 
	`´štf
("-");

135 
	`´štf
(" ");

136 ià(
	`ISK
(
c
)è
	`PrštCÚ¡ªt
(
f
,
	`INDEXK
(c)); 
	`´štf
("-");

139 
OP_JMP
:

140 
OP_FORLOOP
:

141 
OP_FORPREP
:

142 
	`´štf
("\t;Ø%d",
sbx
+
pc
+2);

144 
OP_CLOSURE
:

145 
	`´štf
("\t; %p",
	`VOID
(
f
->
p
[
bx
]));

147 
OP_SETLIST
:

148 ià(
c
==0è
	`´štf
("\t; %d",()
code
[++
pc
]);

149 
	`´štf
("\t; %d",
c
);

154 
	`´štf
("\n");

156 
	}
}

158 
	#SS
(
x
è(x==1)?"":"s"

	)

159 
	#S
(
x
èx,
	`SS
(x)

	)

161 
	$PrštH—d”
(cÚ¡ 
PrÙo
* 
f
)

163 cÚ¡ * 
s
=
	`g‘¡r
(
f
->
sourû
);

164 ià(*
s
=='@' || *s=='=')

165 
s
++;

166 ià(*
s
==
LUA_SIGNATURE
[0])

167 
s
="(bstring)";

169 
s
="(string)";

170 
	`´štf
("\n%s <%s:%d,%d> (%d instruction%s, %d bytes‡t %p)\n",

171 (
f
->
lšedefšed
==0)?"maš":"funùiÚ",
s
,

172 
f
->
lšedefšed
,f->
Ï¡lšedefšed
,

173 
	`S
(
f
->
sizecode
),f->sizecode*
	`Sizeof
(
In¡ruùiÚ
),
	`VOID
(f));

174 
	`´štf
("%d%s…aram%s, %d slot%s, %d upvalue%s, ",

175 
f
->
num·¿ms
,f->
is_v¬¬g
?"+":"",
	`SS
(f->numparams),

176 
	`S
(
f
->
max¡acksize
),S(f->
nups
));

177 
	`´štf
("%d†ocal%s, %d constant%s, %d function%s\n",

178 
	`S
(
f
->
siz–ocv¬s
),S(f->
sizek
),S(f->
siz•
));

179 
	}
}

181 
	$PrštCÚ¡ªts
(cÚ¡ 
PrÙo
* 
f
)

183 
i
,
n
=
f
->
sizek
;

184 
	`´štf
("cÚ¡ªt (%dèfÜ %p:\n",
n
,
	`VOID
(
f
));

185 
i
=0; i<
n
; i++)

187 
	`´štf
("\t%d\t",
i
+1);

188 
	`PrštCÚ¡ªt
(
f
,
i
);

189 
	`´štf
("\n");

191 
	}
}

193 
	$PrštLoÿls
(cÚ¡ 
PrÙo
* 
f
)

195 
i
,
n
=
f
->
siz–ocv¬s
;

196 
	`´štf
("loÿl (%dèfÜ %p:\n",
n
,
	`VOID
(
f
));

197 
i
=0; i<
n
; i++)

199 
	`´štf
("\t%d\t%s\t%d\t%d\n",

200 
i
,
	`g‘¡r
(
f
->
locv¬s
[i].
v¬Çme
),f->locv¬s[i].
¡¬c
+1,f->locv¬s[i].
’dpc
+1);

202 
	}
}

204 
	$PrštUpv®ues
(cÚ¡ 
PrÙo
* 
f
)

206 
i
,
n
=
f
->
sizeupv®ues
;

207 
	`´štf
("upv®ue (%dèfÜ %p:\n",
n
,
	`VOID
(
f
));

208 ià(
f
->
upv®ues
==
NULL
) ;

209 
i
=0; i<
n
; i++)

211 
	`´štf
("\t%d\t%s\n",
i
,
	`g‘¡r
(
f
->
upv®ues
[i]));

213 
	}
}

215 
	$PrštFunùiÚ
(cÚ¡ 
PrÙo
* 
f
, 
fuÎ
)

217 
i
,
n
=
f
->
siz•
;

218 
	`PrštH—d”
(
f
);

219 
	`PrštCode
(
f
);

220 ià(
fuÎ
)

222 
	`PrštCÚ¡ªts
(
f
);

223 
	`PrštLoÿls
(
f
);

224 
	`PrštUpv®ues
(
f
);

226 
i
=0; i<
n
; i++è
	`PrštFunùiÚ
(
f
->
p
[i],
fuÎ
);

227 
	}
}

	@deps/lua/src/strbuf.c

25 
	~<¡dio.h
>

26 
	~<¡dlib.h
>

27 
	~<¡d¬g.h
>

28 
	~<¡ršg.h
>

30 
	~"¡rbuf.h
"

32 
	$d›
(cÚ¡ *
fmt
, ...)

34 
va_li¡
 
¬g
;

36 
	`va_¡¬t
(
¬g
, 
fmt
);

37 
	`vårštf
(
¡d”r
, 
fmt
, 
¬g
);

38 
	`va_’d
(
¬g
);

39 
	`årštf
(
¡d”r
, "\n");

41 
	`ex™
(-1);

42 
	}
}

44 
	$¡rbuf_š™
(
¡rbuf_t
 *
s
, 
Ën
)

46 
size
;

48 ià(
Ën
 <= 0)

49 
size
 = 
STRBUF_DEFAULT_SIZE
;

51 
size
 = 
Ën
 + 1;

53 
s
->
buf
 = 
NULL
;

54 
s
->
size
 = size;

55 
s
->
Ëngth
 = 0;

56 
s
->
šüem’t
 = 
STRBUF_DEFAULT_INCREMENT
;

57 
s
->
dyÇmic
 = 0;

58 
s
->
»®locs
 = 0;

59 
s
->
debug
 = 0;

61 
s
->
buf
 = 
	`m®loc
(
size
);

62 ià(!
s
->
buf
)

63 
	`d›
("Out of memory");

65 
	`¡rbuf_’su»_nuÎ
(
s
);

66 
	}
}

68 
¡rbuf_t
 *
	$¡rbuf_Ãw
(
Ën
)

70 
¡rbuf_t
 *
s
;

72 
s
 = 
	`m®loc
((
¡rbuf_t
));

73 ià(!
s
)

74 
	`d›
("Out of memory");

76 
	`¡rbuf_š™
(
s
, 
Ën
);

79 
s
->
dyÇmic
 = 1;

81  
s
;

82 
	}
}

84 
	$¡rbuf_£t_šüem’t
(
¡rbuf_t
 *
s
, 
šüem’t
)

88 ià(
šüem’t
 == 0 || increment == -1)

89 
	`d›
("BUG: Invalid string increment");

91 
s
->
šüem’t
 = increment;

92 
	}
}

94 
šlše
 
	$debug_¡©s
(
¡rbuf_t
 *
s
)

96 ià(
s
->
debug
) {

97 
	`årštf
(
¡d”r
, "strbuf(%lx)„eallocs: %d,†ength: %d, size: %d\n",

98 ()
s
, s->
»®locs
, s->
Ëngth
, s->
size
);

100 
	}
}

104 
	$¡rbuf_ä“
(
¡rbuf_t
 *
s
)

106 
	`debug_¡©s
(
s
);

108 ià(
s
->
buf
) {

109 
	`ä“
(
s
->
buf
);

110 
s
->
buf
 = 
NULL
;

112 ià(
s
->
dyÇmic
)

113 
	`ä“
(
s
);

114 
	}
}

116 *
	$¡rbuf_ä“_to_¡ršg
(
¡rbuf_t
 *
s
, *
Ën
)

118 *
buf
;

120 
	`debug_¡©s
(
s
);

122 
	`¡rbuf_’su»_nuÎ
(
s
);

124 
buf
 = 
s
->buf;

125 ià(
Ën
)

126 *
Ën
 = 
s
->
Ëngth
;

128 ià(
s
->
dyÇmic
)

129 
	`ä“
(
s
);

131  
buf
;

132 
	}
}

134 
	$ÿlcuÏ‹_Ãw_size
(
¡rbuf_t
 *
s
, 
Ën
)

136 
»qsize
, 
Ãwsize
;

138 ià(
Ën
 <= 0)

139 
	`d›
("BUG: Invalid strbuf†ength„equested");

142 
»qsize
 = 
Ën
 + 1;

145 ià(
s
->
size
 > 
»qsize
)

146  
»qsize
;

148 
Ãwsize
 = 
s
->
size
;

149 ià(
s
->
šüem’t
 < 0) {

151 
Ãwsize
 < 
»qsize
)

152 
Ãwsize
 *ğ-
s
->
šüem’t
;

155 
Ãwsize
 = (Òewsiz+ 
s
->
šüem’t
 - 1) / s->increment) * s->increment;

158  
Ãwsize
;

159 
	}
}

164 
	$¡rbuf_»size
(
¡rbuf_t
 *
s
, 
Ën
)

166 
Ãwsize
;

168 
Ãwsize
 = 
	`ÿlcuÏ‹_Ãw_size
(
s
, 
Ën
);

170 ià(
s
->
debug
 > 1) {

171 
	`årštf
(
¡d”r
, "strbuf(%lx)„esize: %d => %d\n",

172 ()
s
, s->
size
, 
Ãwsize
);

175 
s
->
size
 = 
Ãwsize
;

176 
s
->
buf
 = 
	`»®loc
(s->buf, s->
size
);

177 ià(!
s
->
buf
)

178 
	`d›
("Out of memory");

179 
s
->
»®locs
++;

180 
	}
}

182 
	$¡rbuf_­³nd_¡ršg
(
¡rbuf_t
 *
s
, cÚ¡ *
¡r
)

184 
¥aû
, 
i
;

186 
¥aû
 = 
	`¡rbuf_em±y_Ëngth
(
s
);

188 
i
 = 0; 
¡r
[i]; i++) {

189 ià(
¥aû
 < 1) {

190 
	`¡rbuf_»size
(
s
, s->
Ëngth
 + 1);

191 
¥aû
 = 
	`¡rbuf_em±y_Ëngth
(
s
);

194 
s
->
buf
[s->
Ëngth
] = 
¡r
[
i
];

195 
s
->
Ëngth
++;

196 
¥aû
--;

198 
	}
}

202 
	$¡rbuf_­³nd_fmt
(
¡rbuf_t
 *
s
, 
Ën
, cÚ¡ *
fmt
, ...)

204 
va_li¡
 
¬g
;

205 
fmt_Ën
;

207 
	`¡rbuf_’su»_em±y_Ëngth
(
s
, 
Ën
);

209 
	`va_¡¬t
(
¬g
, 
fmt
);

210 
fmt_Ën
 = 
	`v¢´štf
(
s
->
buf
 + s->
Ëngth
, 
Ën
, 
fmt
, 
¬g
);

211 
	`va_’d
(
¬g
);

213 ià(
fmt_Ën
 < 0)

214 
	`d›
("BUG: Unableo convert‚umber");

216 
s
->
Ëngth
 +ğ
fmt_Ën
;

217 
	}
}

221 
	$¡rbuf_­³nd_fmt_»Œy
(
¡rbuf_t
 *
s
, cÚ¡ *
fmt
, ...)

223 
va_li¡
 
¬g
;

224 
fmt_Ën
, 
Œy
;

225 
em±y_Ën
;

229 
Œy
 = 0; ;ry++) {

230 
	`va_¡¬t
(
¬g
, 
fmt
);

234 
em±y_Ën
 = 
	`¡rbuf_em±y_Ëngth
(
s
);

236 
fmt_Ën
 = 
	`v¢´štf
(
s
->
buf
 + s->
Ëngth
, 
em±y_Ën
 + 1, 
fmt
, 
¬g
);

237 
	`va_’d
(
¬g
);

239 ià(
fmt_Ën
 <ğ
em±y_Ën
)

241 ià(
Œy
 > 0)

242 
	`d›
("BUG:†ength of formatted string changed");

244 
	`¡rbuf_»size
(
s
, s->
Ëngth
 + 
fmt_Ën
);

247 
s
->
Ëngth
 +ğ
fmt_Ën
;

248 
	}
}

	@deps/lua/src/strbuf.h

25 
	~<¡dlib.h
>

26 
	~<¡d¬g.h
>

35 *
	mbuf
;

36 
	msize
;

37 
	mËngth
;

38 
	mšüem’t
;

39 
	mdyÇmic
;

40 
	m»®locs
;

41 
	mdebug
;

42 } 
	t¡rbuf_t
;

44 #iâdeà
STRBUF_DEFAULT_SIZE


45 
	#STRBUF_DEFAULT_SIZE
 1023

	)

47 #iâdeà
STRBUF_DEFAULT_INCREMENT


48 
	#STRBUF_DEFAULT_INCREMENT
 -2

	)

52 
¡rbuf_t
 *
¡rbuf_Ãw
(
Ën
);

53 
¡rbuf_š™
(
¡rbuf_t
 *
s
, 
Ën
);

54 
¡rbuf_£t_šüem’t
(
¡rbuf_t
 *
s
, 
šüem’t
);

57 
¡rbuf_ä“
(
¡rbuf_t
 *
s
);

58 *
¡rbuf_ä“_to_¡ršg
(
¡rbuf_t
 *
s
, *
Ën
);

61 
¡rbuf_»size
(
¡rbuf_t
 *
s
, 
Ën
);

62 
¡rbuf_em±y_Ëngth
(
¡rbuf_t
 *
s
);

63 
¡rbuf_Ëngth
(
¡rbuf_t
 *
s
);

64 *
¡rbuf_¡ršg
(
¡rbuf_t
 *
s
, *
Ën
);

65 
¡rbuf_’su»_em±y_Ëngth
(
¡rbuf_t
 *
s
, 
Ën
);

66 *
¡rbuf_em±y_±r
(
¡rbuf_t
 *
s
);

67 
¡rbuf_ex‹nd_Ëngth
(
¡rbuf_t
 *
s
, 
Ën
);

70 
¡rbuf_­³nd_fmt
(
¡rbuf_t
 *
s
, 
Ën
, cÚ¡ *
fmt
, ...);

71 
¡rbuf_­³nd_fmt_»Œy
(
¡rbuf_t
 *
s
, cÚ¡ *
fÜm©
, ...);

72 
¡rbuf_­³nd_mem
(
¡rbuf_t
 *
s
, cÚ¡ *
c
, 
Ën
);

73 
¡rbuf_­³nd_¡ršg
(
¡rbuf_t
 *
s
, cÚ¡ *
¡r
);

74 
¡rbuf_­³nd_ch¬
(
¡rbuf_t
 *
s
, cÚ¡ 
c
);

75 
¡rbuf_’su»_nuÎ
(
¡rbuf_t
 *
s
);

78 
šlše
 
	$¡rbuf_»£t
(
¡rbuf_t
 *
s
)

80 
s
->
Ëngth
 = 0;

81 
	}
}

83 
šlše
 
	$¡rbuf_®loÿ‹d
(
¡rbuf_t
 *
s
)

85  
s
->
buf
 !ğ
NULL
;

86 
	}
}

90 
šlše
 
	$¡rbuf_em±y_Ëngth
(
¡rbuf_t
 *
s
)

92  
s
->
size
 - s->
Ëngth
 - 1;

93 
	}
}

95 
šlše
 
	$¡rbuf_’su»_em±y_Ëngth
(
¡rbuf_t
 *
s
, 
Ën
)

97 ià(
Ën
 > 
	`¡rbuf_em±y_Ëngth
(
s
))

98 
	`¡rbuf_»size
(
s
, s->
Ëngth
 + 
Ën
);

99 
	}
}

101 
šlše
 *
	$¡rbuf_em±y_±r
(
¡rbuf_t
 *
s
)

103  
s
->
buf
 + s->
Ëngth
;

104 
	}
}

106 
šlše
 
	$¡rbuf_ex‹nd_Ëngth
(
¡rbuf_t
 *
s
, 
Ën
)

108 
s
->
Ëngth
 +ğ
Ën
;

109 
	}
}

111 
šlše
 
	$¡rbuf_Ëngth
(
¡rbuf_t
 *
s
)

113  
s
->
Ëngth
;

114 
	}
}

116 
šlše
 
	$¡rbuf_­³nd_ch¬
(
¡rbuf_t
 *
s
, cÚ¡ 
c
)

118 
	`¡rbuf_’su»_em±y_Ëngth
(
s
, 1);

119 
s
->
buf
[s->
Ëngth
++] = 
c
;

120 
	}
}

122 
šlše
 
	$¡rbuf_­³nd_ch¬_un§ã
(
¡rbuf_t
 *
s
, cÚ¡ 
c
)

124 
s
->
buf
[s->
Ëngth
++] = 
c
;

125 
	}
}

127 
šlše
 
	$¡rbuf_­³nd_mem
(
¡rbuf_t
 *
s
, cÚ¡ *
c
, 
Ën
)

129 
	`¡rbuf_’su»_em±y_Ëngth
(
s
, 
Ën
);

130 
	`memıy
(
s
->
buf
 + s->
Ëngth
, 
c
, 
Ën
);

131 
s
->
Ëngth
 +ğ
Ën
;

132 
	}
}

134 
šlše
 
	$¡rbuf_­³nd_mem_un§ã
(
¡rbuf_t
 *
s
, cÚ¡ *
c
, 
Ën
)

136 
	`memıy
(
s
->
buf
 + s->
Ëngth
, 
c
, 
Ën
);

137 
s
->
Ëngth
 +ğ
Ën
;

138 
	}
}

140 
šlše
 
	$¡rbuf_’su»_nuÎ
(
¡rbuf_t
 *
s
)

142 
s
->
buf
[s->
Ëngth
] = 0;

143 
	}
}

145 
šlše
 *
	$¡rbuf_¡ršg
(
¡rbuf_t
 *
s
, *
Ën
)

147 ià(
Ën
)

148 *
Ën
 = 
s
->
Ëngth
;

150  
s
->
buf
;

151 
	}
}

	@src/adlist.c

32 
	~<¡dlib.h
>

33 
	~"adli¡.h
"

34 
	~"zm®loc.h
"

41 
li¡
 *
	$li¡C»©e
()

43 
li¡
 *list;

45 ià((
li¡
 = 
	`zm®loc
((*li¡))è=ğ
NULL
)

46  
NULL
;

47 
li¡
->
h—d
 =†i¡->

 = 
NULL
;

48 
li¡
->
Ën
 = 0;

49 
li¡
->
dup
 = 
NULL
;

50 
li¡
->
ä“
 = 
NULL
;

51 
li¡
->
m©ch
 = 
NULL
;

52  
li¡
;

53 
	}
}

58 
	$li¡R–—£
(
li¡
 *list)

60 
Ën
;

61 
li¡Node
 *
cu¼’t
, *
Ãxt
;

63 
cu¼’t
 = 
li¡
->
h—d
;

64 
Ën
 = 
li¡
->len;

65 
Ën
--) {

66 
Ãxt
 = 
cu¼’t
->next;

67 ià(
li¡
->
ä“
èli¡->
	`ä“
(
cu¼’t
->
v®ue
);

68 
	`zä“
(
cu¼’t
);

69 
cu¼’t
 = 
Ãxt
;

71 
	`zä“
(
li¡
);

72 
	}
}

80 
li¡
 *
	$li¡AddNodeH—d
(
li¡
 *li¡, *
v®ue
)

82 
li¡Node
 *
node
;

84 ià((
node
 = 
	`zm®loc
((*node))è=ğ
NULL
)

85  
NULL
;

86 
node
->
v®ue
 = value;

87 ià(
li¡
->
Ën
 == 0) {

88 
li¡
->
h—d
 =†i¡->

 = 
node
;

89 
node
->
´ev
 =‚ode->
Ãxt
 = 
NULL
;

91 
node
->
´ev
 = 
NULL
;

92 
node
->
Ãxt
 = 
li¡
->
h—d
;

93 
li¡
->
h—d
->
´ev
 = 
node
;

94 
li¡
->
h—d
 = 
node
;

96 
li¡
->
Ën
++;

97  
li¡
;

98 
	}
}

106 
li¡
 *
	$li¡AddNodeTa
(
li¡
 *li¡, *
v®ue
)

108 
li¡Node
 *
node
;

110 ià((
node
 = 
	`zm®loc
((*node))è=ğ
NULL
)

111  
NULL
;

112 
node
->
v®ue
 = value;

113 ià(
li¡
->
Ën
 == 0) {

114 
li¡
->
h—d
 =†i¡->

 = 
node
;

115 
node
->
´ev
 =‚ode->
Ãxt
 = 
NULL
;

117 
node
->
´ev
 = 
li¡
->

;

118 
node
->
Ãxt
 = 
NULL
;

119 
li¡
->

->
Ãxt
 = 
node
;

120 
li¡
->

 = 
node
;

122 
li¡
->
Ën
++;

123  
li¡
;

124 
	}
}

126 
li¡
 *
	$li¡In£¹Node
(
li¡
 *li¡, 
li¡Node
 *
Şd_node
, *
v®ue
, 
aá”
) {

127 
li¡Node
 *
node
;

129 ià((
node
 = 
	`zm®loc
((*node))è=ğ
NULL
)

130  
NULL
;

131 
node
->
v®ue
 = value;

132 ià(
aá”
) {

133 
node
->
´ev
 = 
Şd_node
;

134 
node
->
Ãxt
 = 
Şd_node
->next;

135 ià(
li¡
->

 =ğ
Şd_node
) {

136 
li¡
->

 = 
node
;

139 
node
->
Ãxt
 = 
Şd_node
;

140 
node
->
´ev
 = 
Şd_node
->prev;

141 ià(
li¡
->
h—d
 =ğ
Şd_node
) {

142 
li¡
->
h—d
 = 
node
;

145 ià(
node
->
´ev
 !ğ
NULL
) {

146 
node
->
´ev
->
Ãxt
 =‚ode;

148 ià(
node
->
Ãxt
 !ğ
NULL
) {

149 
node
->
Ãxt
->
´ev
 =‚ode;

151 
li¡
->
Ën
++;

152  
li¡
;

153 
	}
}

159 
	$li¡D–Node
(
li¡
 *li¡, 
li¡Node
 *
node
)

161 ià(
node
->
´ev
)

162 
node
->
´ev
->
Ãxt
 =‚ode->next;

164 
li¡
->
h—d
 = 
node
->
Ãxt
;

165 ià(
node
->
Ãxt
)

166 
node
->
Ãxt
->
´ev
 =‚ode->prev;

168 
li¡
->

 = 
node
->
´ev
;

169 ià(
li¡
->
ä“
èli¡->
	`ä“
(
node
->
v®ue
);

170 
	`zä“
(
node
);

171 
li¡
->
Ën
--;

172 
	}
}

178 
li¡I‹r
 *
	$li¡G‘I‹¿tÜ
(
li¡
 *li¡, 
dœeùiÚ
)

180 
li¡I‹r
 *
™”
;

182 ià((
™”
 = 
	`zm®loc
((*™”))è=ğ
NULL
)  NULL;

183 ià(
dœeùiÚ
 =ğ
AL_START_HEAD
)

184 
™”
->
Ãxt
 = 
li¡
->
h—d
;

186 
™”
->
Ãxt
 = 
li¡
->

;

187 
™”
->
dœeùiÚ
 = direction;

188  
™”
;

189 
	}
}

192 
	$li¡R–—£I‹¿tÜ
(
li¡I‹r
 *
™”
) {

193 
	`zä“
(
™”
);

194 
	}
}

197 
	$li¡Rewšd
(
li¡
 *li¡, 
li¡I‹r
 *
li
) {

198 
li
->
Ãxt
 = 
li¡
->
h—d
;

199 
li
->
dœeùiÚ
 = 
AL_START_HEAD
;

200 
	}
}

202 
	$li¡RewšdTa
(
li¡
 *li¡, 
li¡I‹r
 *
li
) {

203 
li
->
Ãxt
 = 
li¡
->

;

204 
li
->
dœeùiÚ
 = 
AL_START_TAIL
;

205 
	}
}

221 
li¡Node
 *
	$li¡Next
(
li¡I‹r
 *
™”
)

223 
li¡Node
 *
cu¼’t
 = 
™”
->
Ãxt
;

225 ià(
cu¼’t
 !ğ
NULL
) {

226 ià(
™”
->
dœeùiÚ
 =ğ
AL_START_HEAD
)

227 
™”
->
Ãxt
 = 
cu¼’t
->next;

229 
™”
->
Ãxt
 = 
cu¼’t
->
´ev
;

231  
cu¼’t
;

232 
	}
}

242 
li¡
 *
	$li¡Dup
(
li¡
 *
Üig
)

244 
li¡
 *
cİy
;

245 
li¡I‹r
 
™”
;

246 
li¡Node
 *
node
;

248 ià((
cİy
 = 
	`li¡C»©e
()è=ğ
NULL
)

249  
NULL
;

250 
cİy
->
dup
 = 
Üig
->dup;

251 
cİy
->
ä“
 = 
Üig
->free;

252 
cİy
->
m©ch
 = 
Üig
->match;

253 
	`li¡Rewšd
(
Üig
, &
™”
);

254 (
node
 = 
	`li¡Next
(&
™”
)è!ğ
NULL
) {

255 *
v®ue
;

257 ià(
cİy
->
dup
) {

258 
v®ue
 = 
cİy
->
	`dup
(
node
->value);

259 ià(
v®ue
 =ğ
NULL
) {

260 
	`li¡R–—£
(
cİy
);

261  
NULL
;

264 
v®ue
 = 
node
->value;

265 ià(
	`li¡AddNodeTa
(
cİy
, 
v®ue
è=ğ
NULL
) {

266 
	`li¡R–—£
(
cİy
);

267  
NULL
;

270  
cİy
;

271 
	}
}

282 
li¡Node
 *
	$li¡S—rchKey
(
li¡
 *li¡, *
key
)

284 
li¡I‹r
 
™”
;

285 
li¡Node
 *
node
;

287 
	`li¡Rewšd
(
li¡
, &
™”
);

288 (
node
 = 
	`li¡Next
(&
™”
)è!ğ
NULL
) {

289 ià(
li¡
->
m©ch
) {

290 ià(
li¡
->
	`m©ch
(
node
->
v®ue
, 
key
)) {

291  
node
;

294 ià(
key
 =ğ
node
->
v®ue
) {

295  
node
;

299  
NULL
;

300 
	}
}

307 
li¡Node
 *
	$li¡Index
(
li¡
 *li¡, 
šdex
) {

308 
li¡Node
 *
n
;

310 ià(
šdex
 < 0) {

311 
šdex
 = (-index)-1;

312 
n
 = 
li¡
->

;

313 
šdex
-- && 
n
èÀğn->
´ev
;

315 
n
 = 
li¡
->
h—d
;

316 
šdex
-- && 
n
èÀğn->
Ãxt
;

318  
n
;

319 
	}
}

322 
	$li¡RÙ©e
(
li¡
 *list) {

323 
li¡Node
 *

 = 
li¡
->tail;

325 ià(
	`li¡L’gth
(
li¡
) <= 1) ;

328 
li¡
->

 =a->
´ev
;

329 
li¡
->

->
Ãxt
 = 
NULL
;

331 
li¡
->
h—d
->
´ev
 = 

;

332 

->
´ev
 = 
NULL
;

333 

->
Ãxt
 = 
li¡
->
h—d
;

334 
li¡
->
h—d
 = 

;

335 
	}
}

	@src/adlist.h

31 #iâdeà
__ADLIST_H__


32 
	#__ADLIST_H__


	)

36 
	sli¡Node
 {

37 
li¡Node
 *
	m´ev
;

38 
li¡Node
 *
	mÃxt
;

39 *
	mv®ue
;

40 } 
	tli¡Node
;

42 
	sli¡I‹r
 {

43 
li¡Node
 *
	mÃxt
;

44 
	mdœeùiÚ
;

45 } 
	tli¡I‹r
;

47 
	sli¡
 {

48 
li¡Node
 *
	mh—d
;

49 
li¡Node
 *
	m
;

50 *(*
	mdup
)(*
	m±r
);

51 (*
	mä“
)(*
	m±r
);

52 (*
	mm©ch
)(*
	m±r
, *
	mkey
);

53 
	mËn
;

54 } 
	tli¡
;

57 
	#li¡L’gth
(
l
è(Ö)->
Ën
)

	)

58 
	#li¡Fœ¡
(
l
è(Ö)->
h—d
)

	)

59 
	#li¡La¡
(
l
è(Ö)->

)

	)

60 
	#li¡P»vNode
(
n
è(Ò)->
´ev
)

	)

61 
	#li¡NextNode
(
n
è(Ò)->
Ãxt
)

	)

62 
	#li¡NodeV®ue
(
n
è(Ò)->
v®ue
)

	)

64 
	#li¡S‘DupM‘hod
(
l
,
m
è(Ö)->
dup
 = (m))

	)

65 
	#li¡S‘F»eM‘hod
(
l
,
m
è(Ö)->
ä“
 = (m))

	)

66 
	#li¡S‘M©chM‘hod
(
l
,
m
è(Ö)->
m©ch
 = (m))

	)

68 
	#li¡G‘DupM‘hod
(
l
è(Ö)->
dup
)

	)

69 
	#li¡G‘F»e
(
l
è(Ö)->
ä“
)

	)

70 
	#li¡G‘M©chM‘hod
(
l
è(Ö)->
m©ch
)

	)

73 
li¡
 *
li¡C»©e
();

74 
li¡R–—£
(
li¡
 *list);

75 
li¡
 *
li¡AddNodeH—d
Öi¡ *li¡, *
v®ue
);

76 
li¡
 *
li¡AddNodeTa
Öi¡ *li¡, *
v®ue
);

77 
li¡
 *
li¡In£¹Node
Öi¡ *li¡, 
li¡Node
 *
Şd_node
, *
v®ue
, 
aá”
);

78 
li¡D–Node
(
li¡
 *li¡, 
li¡Node
 *
node
);

79 
li¡I‹r
 *
li¡G‘I‹¿tÜ
(
li¡
 *li¡, 
dœeùiÚ
);

80 
li¡Node
 *
li¡Next
(
li¡I‹r
 *
™”
);

81 
li¡R–—£I‹¿tÜ
(
li¡I‹r
 *
™”
);

82 
li¡
 *
li¡Dup
Öi¡ *
Üig
);

83 
li¡Node
 *
li¡S—rchKey
(
li¡
 *li¡, *
key
);

84 
li¡Node
 *
li¡Index
(
li¡
 *li¡, 
šdex
);

85 
li¡Rewšd
(
li¡
 *li¡, 
li¡I‹r
 *
li
);

86 
li¡RewšdTa
(
li¡
 *li¡, 
li¡I‹r
 *
li
);

87 
li¡RÙ©e
(
li¡
 *list);

90 
	#AL_START_HEAD
 0

	)

91 
	#AL_START_TAIL
 1

	)

	@src/ae.c

33 
	~<¡dio.h
>

34 
	~<sys/time.h
>

35 
	~<sys/ty³s.h
>

36 
	~<uni¡d.h
>

37 
	~<¡dlib.h
>

38 
	~<pŞl.h
>

39 
	~<¡ršg.h
>

40 
	~<time.h
>

41 
	~<”ºo.h
>

43 
	~"«.h
"

44 
	~"zm®loc.h
"

45 
	~"cÚfig.h
"

49 #ifdeà
HAVE_EVPORT


50 
	~"«_evpÜt.c
"

52 #ifdeà
HAVE_EPOLL


53 
	~"«_•Şl.c
"

55 #ifdeà
HAVE_KQUEUE


56 
	~"«_kqueue.c
"

58 
	~"«_£Ëù.c
"

63 
«Ev’tLoİ
 *
	$«C»©eEv’tLoİ
(
£tsize
) {

64 
«Ev’tLoİ
 *
ev’tLoİ
;

65 
i
;

67 ià((
ev’tLoİ
 = 
	`zm®loc
((*ev’tLoİ))è=ğ
NULL
è
”r
;

68 
ev’tLoİ
->
ev’ts
 = 
	`zm®loc
((
«FeEv’t
)*
£tsize
);

69 
ev’tLoİ
->
fœed
 = 
	`zm®loc
((
«FœedEv’t
)*
£tsize
);

70 ià(
ev’tLoİ
->
ev’ts
 =ğ
NULL
 ||ƒv’tLoİ->
fœed
 =ğNULLè
”r
;

71 
ev’tLoİ
->
£tsize
 = setsize;

72 
ev’tLoİ
->
Ï¡Time
 = 
	`time
(
NULL
);

73 
ev’tLoİ
->
timeEv’tH—d
 = 
NULL
;

74 
ev’tLoİ
->
timeEv’tNextId
 = 0;

75 
ev’tLoİ
->
¡İ
 = 0;

76 
ev’tLoİ
->
maxfd
 = -1;

77 
ev’tLoİ
->
befÜe¦“p
 = 
NULL
;

78 ià(
	`«ApiC»©e
(
ev’tLoİ
è=ğ-1è
”r
;

81 
i
 = 0; i < 
£tsize
; i++)

82 
ev’tLoİ
->
ev’ts
[
i
].
mask
 = 
AE_NONE
;

83  
ev’tLoİ
;

85 
”r
:

86 ià(
ev’tLoİ
) {

87 
	`zä“
(
ev’tLoİ
->
ev’ts
);

88 
	`zä“
(
ev’tLoİ
->
fœed
);

89 
	`zä“
(
ev’tLoİ
);

91  
NULL
;

92 
	}
}

95 
	$«G‘S‘Size
(
«Ev’tLoİ
 *
ev’tLoİ
) {

96  
ev’tLoİ
->
£tsize
;

97 
	}
}

106 
	$«ResizeS‘Size
(
«Ev’tLoİ
 *
ev’tLoİ
, 
£tsize
) {

107 
i
;

109 ià(
£tsize
 =ğ
ev’tLoİ
->£tsizeè 
AE_OK
;

110 ià(
ev’tLoİ
->
maxfd
 >ğ
£tsize
è 
AE_ERR
;

111 ià(
	`«ApiResize
(
ev’tLoİ
,
£tsize
è=ğ-1è 
AE_ERR
;

113 
ev’tLoİ
->
ev’ts
 = 
	`z»®loc
Óv’tLoİ->ev’ts,(
«FeEv’t
)*
£tsize
);

114 
ev’tLoİ
->
fœed
 = 
	`z»®loc
Óv’tLoİ->fœed,(
«FœedEv’t
)*
£tsize
);

115 
ev’tLoİ
->
£tsize
 = setsize;

119 
i
 = 
ev’tLoİ
->
maxfd
+1; i < 
£tsize
; i++)

120 
ev’tLoİ
->
ev’ts
[
i
].
mask
 = 
AE_NONE
;

121  
AE_OK
;

122 
	}
}

124 
	$«D–‘eEv’tLoİ
(
«Ev’tLoİ
 *
ev’tLoİ
) {

125 
	`«ApiF»e
(
ev’tLoİ
);

126 
	`zä“
(
ev’tLoİ
->
ev’ts
);

127 
	`zä“
(
ev’tLoİ
->
fœed
);

128 
	`zä“
(
ev’tLoİ
);

129 
	}
}

131 
	$«Stİ
(
«Ev’tLoİ
 *
ev’tLoİ
) {

132 
ev’tLoİ
->
¡İ
 = 1;

133 
	}
}

135 
	$«C»©eFeEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
,

136 
«FeProc
 *
´oc
, *
ş›ÁD©a
)

138 ià(
fd
 >ğ
ev’tLoİ
->
£tsize
) {

139 
”ºo
 = 
ERANGE
;

140  
AE_ERR
;

142 
«FeEv’t
 *
ã
 = &
ev’tLoİ
->
ev’ts
[
fd
];

144 ià(
	`«ApiAddEv’t
(
ev’tLoİ
, 
fd
, 
mask
) == -1)

145  
AE_ERR
;

146 
ã
->
mask
 |= mask;

147 ià(
mask
 & 
AE_READABLE
è
ã
->
rfeProc
 = 
´oc
;

148 ià(
mask
 & 
AE_WRITABLE
è
ã
->
wfeProc
 = 
´oc
;

149 
ã
->
ş›ÁD©a
 = clientData;

150 ià(
fd
 > 
ev’tLoİ
->
maxfd
)

151 
ev’tLoİ
->
maxfd
 = 
fd
;

152  
AE_OK
;

153 
	}
}

155 
	$«D–‘eFeEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
)

157 ià(
fd
 >ğ
ev’tLoİ
->
£tsize
) ;

158 
«FeEv’t
 *
ã
 = &
ev’tLoİ
->
ev’ts
[
fd
];

159 ià(
ã
->
mask
 =ğ
AE_NONE
) ;

161 
	`«ApiD–Ev’t
(
ev’tLoİ
, 
fd
, 
mask
);

162 
ã
->
mask
 = fe->mask & (~mask);

163 ià(
fd
 =ğ
ev’tLoİ
->
maxfd
 && 
ã
->
mask
 =ğ
AE_NONE
) {

165 
j
;

167 
j
 = 
ev’tLoİ
->
maxfd
-1; j >= 0; j--)

168 ià(
ev’tLoİ
->
ev’ts
[
j
].
mask
 !ğ
AE_NONE
) ;

169 
ev’tLoİ
->
maxfd
 = 
j
;

171 
	}
}

173 
	$«G‘FeEv’ts
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
) {

174 ià(
fd
 >ğ
ev’tLoİ
->
£tsize
)  0;

175 
«FeEv’t
 *
ã
 = &
ev’tLoİ
->
ev’ts
[
fd
];

177  
ã
->
mask
;

178 
	}
}

180 
	$«G‘Time
(*
£cÚds
, *
mli£cÚds
)

182 
timev®
 
tv
;

184 
	`g‘timeofday
(&
tv
, 
NULL
);

185 *
£cÚds
 = 
tv
.
tv_£c
;

186 *
mli£cÚds
 = 
tv
.
tv_u£c
/1000;

187 
	}
}

189 
	$«AddMli£cÚdsToNow
(
mli£cÚds
, *
£c
, *
ms
) {

190 
cur_£c
, 
cur_ms
, 
wh’_£c
, 
wh’_ms
;

192 
	`«G‘Time
(&
cur_£c
, &
cur_ms
);

193 
wh’_£c
 = 
cur_£c
 + 
mli£cÚds
/1000;

194 
wh’_ms
 = 
cur_ms
 + 
mli£cÚds
%1000;

195 ià(
wh’_ms
 >= 1000) {

196 
wh’_£c
 ++;

197 
wh’_ms
 -= 1000;

199 *
£c
 = 
wh’_£c
;

200 *
ms
 = 
wh’_ms
;

201 
	}
}

203 
	$«C»©eTimeEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
mli£cÚds
,

204 
«TimeProc
 *
´oc
, *
ş›ÁD©a
,

205 
«Ev’tFš®iz”Proc
 *
fš®iz”Proc
)

207 
id
 = 
ev’tLoİ
->
timeEv’tNextId
++;

208 
«TimeEv’t
 *
‹
;

210 
‹
 = 
	`zm®loc
((*te));

211 ià(
‹
 =ğ
NULL
è 
AE_ERR
;

212 
‹
->
id
 = id;

213 
	`«AddMli£cÚdsToNow
(
mli£cÚds
,&
‹
->
wh’_£c
,&‹->
wh’_ms
);

214 
‹
->
timeProc
 = 
´oc
;

215 
‹
->
fš®iz”Proc
 = finalizerProc;

216 
‹
->
ş›ÁD©a
 = clientData;

217 
‹
->
Ãxt
 = 
ev’tLoİ
->
timeEv’tH—d
;

218 
ev’tLoİ
->
timeEv’tH—d
 = 
‹
;

219  
id
;

220 
	}
}

222 
	$«D–‘eTimeEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
id
)

224 
«TimeEv’t
 *
‹
 = 
ev’tLoİ
->
timeEv’tH—d
;

225 
‹
) {

226 ià(
‹
->
id
 == id) {

227 
‹
->
id
 = 
AE_DELETED_EVENT_ID
;

228  
AE_OK
;

230 
‹
 =e->
Ãxt
;

232  
AE_ERR
;

233 
	}
}

246 
«TimeEv’t
 *
	$«S—rchN—»¡Tim”
(
«Ev’tLoİ
 *
ev’tLoİ
)

248 
«TimeEv’t
 *
‹
 = 
ev’tLoİ
->
timeEv’tH—d
;

249 
«TimeEv’t
 *
Ã¬e¡
 = 
NULL
;

251 
‹
) {

252 ià(!
Ã¬e¡
 || 
‹
->
wh’_£c
 <‚earest->when_sec ||

253 (
‹
->
wh’_£c
 =ğ
Ã¬e¡
->when_sec &&

254 
‹
->
wh’_ms
 < 
Ã¬e¡
->when_ms))

255 
Ã¬e¡
 = 
‹
;

256 
‹
 =e->
Ãxt
;

258  
Ã¬e¡
;

259 
	}
}

262 
	$´oûssTimeEv’ts
(
«Ev’tLoİ
 *
ev’tLoİ
) {

263 
´oûs£d
 = 0;

264 
«TimeEv’t
 *
‹
, *
´ev
;

265 
maxId
;

266 
time_t
 
now
 = 
	`time
(
NULL
);

276 ià(
now
 < 
ev’tLoİ
->
Ï¡Time
) {

277 
‹
 = 
ev’tLoİ
->
timeEv’tH—d
;

278 
‹
) {

279 
‹
->
wh’_£c
 = 0;

280 
‹
 =e->
Ãxt
;

283 
ev’tLoİ
->
Ï¡Time
 = 
now
;

285 
´ev
 = 
NULL
;

286 
‹
 = 
ev’tLoİ
->
timeEv’tH—d
;

287 
maxId
 = 
ev’tLoİ
->
timeEv’tNextId
-1;

288 
‹
) {

289 
now_£c
, 
now_ms
;

290 
id
;

293 ià(
‹
->
id
 =ğ
AE_DELETED_EVENT_ID
) {

294 
«TimeEv’t
 *
Ãxt
 = 
‹
->next;

295 ià(
´ev
 =ğ
NULL
)

296 
ev’tLoİ
->
timeEv’tH—d
 = 
‹
->
Ãxt
;

298 
´ev
->
Ãxt
 = 
‹
->next;

299 ià(
‹
->
fš®iz”Proc
)

300 
‹
->
	`fš®iz”Proc
(
ev’tLoİ
,e->
ş›ÁD©a
);

301 
	`zä“
(
‹
);

302 
‹
 = 
Ãxt
;

311 ià(
‹
->
id
 > 
maxId
) {

312 
‹
 =e->
Ãxt
;

315 
	`«G‘Time
(&
now_£c
, &
now_ms
);

316 ià(
now_£c
 > 
‹
->
wh’_£c
 ||

317 (
now_£c
 =ğ
‹
->
wh’_£c
 && 
now_ms
 >ğ‹->
wh’_ms
))

319 
»tv®
;

321 
id
 = 
‹
->id;

322 
»tv®
 = 
‹
->
	`timeProc
(
ev’tLoİ
, 
id
,e->
ş›ÁD©a
);

323 
´oûs£d
++;

324 ià(
»tv®
 !ğ
AE_NOMORE
) {

325 
	`«AddMli£cÚdsToNow
(
»tv®
,&
‹
->
wh’_£c
,&‹->
wh’_ms
);

327 
‹
->
id
 = 
AE_DELETED_EVENT_ID
;

330 
´ev
 = 
‹
;

331 
‹
 =e->
Ãxt
;

333  
´oûs£d
;

334 
	}
}

349 
	$«ProûssEv’ts
(
«Ev’tLoİ
 *
ev’tLoİ
, 
æags
)

351 
´oûs£d
 = 0, 
numev’ts
;

354 ià(!(
æags
 & 
AE_TIME_EVENTS
è&& !(æag & 
AE_FILE_EVENTS
))  0;

360 ià(
ev’tLoİ
->
maxfd
 != -1 ||

361 ((
æags
 & 
AE_TIME_EVENTS
è&& !(æag & 
AE_DONT_WAIT
))) {

362 
j
;

363 
«TimeEv’t
 *
shÜ‹¡
 = 
NULL
;

364 
timev®
 
tv
, *
tvp
;

366 ià(
æags
 & 
AE_TIME_EVENTS
 && !(æag & 
AE_DONT_WAIT
))

367 
shÜ‹¡
 = 
	`«S—rchN—»¡Tim”
(
ev’tLoİ
);

368 ià(
shÜ‹¡
) {

369 
now_£c
, 
now_ms
;

371 
	`«G‘Time
(&
now_£c
, &
now_ms
);

372 
tvp
 = &
tv
;

376 
ms
 =

377 (
shÜ‹¡
->
wh’_£c
 - 
now_£c
)*1000 +

378 
shÜ‹¡
->
wh’_ms
 - 
now_ms
;

380 ià(
ms
 > 0) {

381 
tvp
->
tv_£c
 = 
ms
/1000;

382 
tvp
->
tv_u£c
 = (
ms
 % 1000)*1000;

384 
tvp
->
tv_£c
 = 0;

385 
tvp
->
tv_u£c
 = 0;

391 ià(
æags
 & 
AE_DONT_WAIT
) {

392 
tv
.
tv_£c
 =v.
tv_u£c
 = 0;

393 
tvp
 = &
tv
;

396 
tvp
 = 
NULL
;

400 
numev’ts
 = 
	`«ApiPŞl
(
ev’tLoİ
, 
tvp
);

401 
j
 = 0; j < 
numev’ts
; j++) {

402 
«FeEv’t
 *
ã
 = &
ev’tLoİ
->
ev’ts
[ev’tLoİ->
fœed
[
j
].
fd
];

403 
mask
 = 
ev’tLoİ
->
fœed
[
j
].mask;

404 
fd
 = 
ev’tLoİ
->
fœed
[
j
].fd;

405 
rfœed
 = 0;

410 ià(
ã
->
mask
 & mask & 
AE_READABLE
) {

411 
rfœed
 = 1;

412 
ã
->
	`rfeProc
(
ev’tLoİ
,
fd
,ã->
ş›ÁD©a
,
mask
);

414 ià(
ã
->
mask
 & mask & 
AE_WRITABLE
) {

415 ià(!
rfœed
 || 
ã
->
wfeProc
 !ğã->
rfeProc
)

416 
ã
->
	`wfeProc
(
ev’tLoİ
,
fd
,ã->
ş›ÁD©a
,
mask
);

418 
´oûs£d
++;

422 ià(
æags
 & 
AE_TIME_EVENTS
)

423 
´oûs£d
 +ğ
	`´oûssTimeEv’ts
(
ev’tLoİ
);

425  
´oûs£d
;

426 
	}
}

430 
	$«Wa™
(
fd
, 
mask
, 
mli£cÚds
) {

431 
pŞlfd
 
pfd
;

432 
»tmask
 = 0, 
»tv®
;

434 
	`mem£t
(&
pfd
, 0, (pfd));

435 
pfd
.
fd
 = fd;

436 ià(
mask
 & 
AE_READABLE
è
pfd
.
ev’ts
 |ğ
POLLIN
;

437 ià(
mask
 & 
AE_WRITABLE
è
pfd
.
ev’ts
 |ğ
POLLOUT
;

439 ià((
»tv®
 = 
	`pŞl
(&
pfd
, 1, 
mli£cÚds
))== 1) {

440 ià(
pfd
.
»v’ts
 & 
POLLIN
è
»tmask
 |ğ
AE_READABLE
;

441 ià(
pfd
.
»v’ts
 & 
POLLOUT
è
»tmask
 |ğ
AE_WRITABLE
;

442 ià(
pfd
.
»v’ts
 & 
POLLERR
è
»tmask
 |ğ
AE_WRITABLE
;

443 ià(
pfd
.
»v’ts
 & 
POLLHUP
è
»tmask
 |ğ
AE_WRITABLE
;

444  
»tmask
;

446  
»tv®
;

448 
	}
}

450 
	$«Maš
(
«Ev’tLoİ
 *
ev’tLoİ
) {

451 
ev’tLoİ
->
¡İ
 = 0;

452 !
ev’tLoİ
->
¡İ
) {

453 ià(
ev’tLoİ
->
befÜe¦“p
 !ğ
NULL
)

454 
ev’tLoİ
->
	`befÜe¦“p
(eventLoop);

455 
	`«ProûssEv’ts
(
ev’tLoİ
, 
AE_ALL_EVENTS
);

457 
	}
}

459 *
	$«G‘ApiName
() {

460  
	`«ApiName
();

461 
	}
}

463 
	$«S‘BefÜeSË•Proc
(
«Ev’tLoİ
 *
ev’tLoİ
, 
«BefÜeSË•Proc
 *
befÜe¦“p
) {

464 
ev’tLoİ
->
befÜe¦“p
 = beforesleep;

465 
	}
}

	@src/ae.h

33 #iâdeà
__AE_H__


34 
	#__AE_H__


	)

36 
	~<time.h
>

38 
	#AE_OK
 0

	)

39 
	#AE_ERR
 -1

	)

41 
	#AE_NONE
 0

	)

42 
	#AE_READABLE
 1

	)

43 
	#AE_WRITABLE
 2

	)

45 
	#AE_FILE_EVENTS
 1

	)

46 
	#AE_TIME_EVENTS
 2

	)

47 
	#AE_ALL_EVENTS
 (
AE_FILE_EVENTS
|
AE_TIME_EVENTS
)

	)

48 
	#AE_DONT_WAIT
 4

	)

50 
	#AE_NOMORE
 -1

	)

51 
	#AE_DELETED_EVENT_ID
 -1

	)

54 
	#AE_NOTUSED
(
V
è((èV)

	)

56 
	g«Ev’tLoİ
;

59 
	t«FeProc
(
	t«Ev’tLoİ
 *
	tev’tLoİ
, 
	tfd
, *
	tş›ÁD©a
, 
	tmask
);

60 
	t«TimeProc
(
	t«Ev’tLoİ
 *
	tev’tLoİ
, 
	tid
, *
	tş›ÁD©a
);

61 
	t«Ev’tFš®iz”Proc
(
	t«Ev’tLoİ
 *
	tev’tLoİ
, *
	tş›ÁD©a
);

62 
	t«BefÜeSË•Proc
(
	t«Ev’tLoİ
 *
	tev’tLoİ
);

65 
	s«FeEv’t
 {

66 
	mmask
;

67 
«FeProc
 *
	mrfeProc
;

68 
«FeProc
 *
	mwfeProc
;

69 *
	mş›ÁD©a
;

70 } 
	t«FeEv’t
;

73 
	s«TimeEv’t
 {

74 
	mid
;

75 
	mwh’_£c
;

76 
	mwh’_ms
;

77 
«TimeProc
 *
	mtimeProc
;

78 
«Ev’tFš®iz”Proc
 *
	mfš®iz”Proc
;

79 *
	mş›ÁD©a
;

80 
«TimeEv’t
 *
	mÃxt
;

81 } 
	t«TimeEv’t
;

84 
	s«FœedEv’t
 {

85 
	mfd
;

86 
	mmask
;

87 } 
	t«FœedEv’t
;

90 
	s«Ev’tLoİ
 {

91 
	mmaxfd
;

92 
	m£tsize
;

93 
	mtimeEv’tNextId
;

94 
time_t
 
	mÏ¡Time
;

95 
«FeEv’t
 *
	mev’ts
;

96 
«FœedEv’t
 *
	mfœed
;

97 
«TimeEv’t
 *
	mtimeEv’tH—d
;

98 
	m¡İ
;

99 *
	m­id©a
;

100 
«BefÜeSË•Proc
 *
	mbefÜe¦“p
;

101 } 
	t«Ev’tLoİ
;

104 
«Ev’tLoİ
 *
«C»©eEv’tLoİ
(
£tsize
);

105 
«D–‘eEv’tLoİ
(
«Ev’tLoİ
 *
ev’tLoİ
);

106 
«Stİ
(
«Ev’tLoİ
 *
ev’tLoİ
);

107 
«C»©eFeEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
,

108 
«FeProc
 *
´oc
, *
ş›ÁD©a
);

109 
«D–‘eFeEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
);

110 
«G‘FeEv’ts
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
);

111 
«C»©eTimeEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
mli£cÚds
,

112 
«TimeProc
 *
´oc
, *
ş›ÁD©a
,

113 
«Ev’tFš®iz”Proc
 *
fš®iz”Proc
);

114 
«D–‘eTimeEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
id
);

115 
«ProûssEv’ts
(
«Ev’tLoİ
 *
ev’tLoİ
, 
æags
);

116 
«Wa™
(
fd
, 
mask
, 
mli£cÚds
);

117 
«Maš
(
«Ev’tLoİ
 *
ev’tLoİ
);

118 *
«G‘ApiName
();

119 
«S‘BefÜeSË•Proc
(
«Ev’tLoİ
 *
ev’tLoİ
, 
«BefÜeSË•Proc
 *
befÜe¦“p
);

120 
«G‘S‘Size
(
«Ev’tLoİ
 *
ev’tLoİ
);

121 
«ResizeS‘Size
(
«Ev’tLoİ
 *
ev’tLoİ
, 
£tsize
);

	@src/ae_epoll.c

32 
	~<sys/•Şl.h
>

34 
	s«ApiS‹
 {

35 
	m•fd
;

36 
•Şl_ev’t
 *
	mev’ts
;

37 } 
	t«ApiS‹
;

39 
	$«ApiC»©e
(
«Ev’tLoİ
 *
ev’tLoİ
) {

40 
«ApiS‹
 *
¡©e
 = 
	`zm®loc
((aeApiState));

42 ià(!
¡©e
)  -1;

43 
¡©e
->
ev’ts
 = 
	`zm®loc
((
•Şl_ev’t
)*
ev’tLoİ
->
£tsize
);

44 ià(!
¡©e
->
ev’ts
) {

45 
	`zä“
(
¡©e
);

48 
¡©e
->
•fd
 = 
	`•Şl_ü—‹
(1024);

49 ià(
¡©e
->
•fd
 == -1) {

50 
	`zä“
(
¡©e
->
ev’ts
);

51 
	`zä“
(
¡©e
);

54 
ev’tLoİ
->
­id©a
 = 
¡©e
;

56 
	}
}

58 
	$«ApiResize
(
«Ev’tLoİ
 *
ev’tLoİ
, 
£tsize
) {

59 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

61 
¡©e
->
ev’ts
 = 
	`z»®loc
(¡©e->ev’ts, (
•Şl_ev’t
)*
£tsize
);

63 
	}
}

65 
	$«ApiF»e
(
«Ev’tLoİ
 *
ev’tLoİ
) {

66 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

68 
	`şo£
(
¡©e
->
•fd
);

69 
	`zä“
(
¡©e
->
ev’ts
);

70 
	`zä“
(
¡©e
);

71 
	}
}

73 
	$«ApiAddEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
) {

74 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

75 
•Şl_ev’t
 
“
 = {0};

78 
İ
 = 
ev’tLoİ
->
ev’ts
[
fd
].
mask
 =ğ
AE_NONE
 ?

79 
EPOLL_CTL_ADD
 : 
EPOLL_CTL_MOD
;

81 
“
.
ev’ts
 = 0;

82 
mask
 |ğ
ev’tLoİ
->
ev’ts
[
fd
].mask;

83 ià(
mask
 & 
AE_READABLE
è
“
.
ev’ts
 |ğ
EPOLLIN
;

84 ià(
mask
 & 
AE_WRITABLE
è
“
.
ev’ts
 |ğ
EPOLLOUT
;

85 
“
.
d©a
.
fd
 = fd;

86 ià(
	`•Şl_ùl
(
¡©e
->
•fd
,
İ
,
fd
,&
“
) == -1)  -1;

88 
	}
}

90 
	$«ApiD–Ev’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
d–mask
) {

91 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

92 
•Şl_ev’t
 
“
 = {0};

93 
mask
 = 
ev’tLoİ
->
ev’ts
[
fd
].mask & (~
d–mask
);

95 
“
.
ev’ts
 = 0;

96 ià(
mask
 & 
AE_READABLE
è
“
.
ev’ts
 |ğ
EPOLLIN
;

97 ià(
mask
 & 
AE_WRITABLE
è
“
.
ev’ts
 |ğ
EPOLLOUT
;

98 
“
.
d©a
.
fd
 = fd;

99 ià(
mask
 !ğ
AE_NONE
) {

100 
	`•Şl_ùl
(
¡©e
->
•fd
,
EPOLL_CTL_MOD
,
fd
,&
“
);

104 
	`•Şl_ùl
(
¡©e
->
•fd
,
EPOLL_CTL_DEL
,
fd
,&
“
);

106 
	}
}

108 
	$«ApiPŞl
(
«Ev’tLoİ
 *
ev’tLoİ
, 
timev®
 *
tvp
) {

109 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

110 
»tv®
, 
numev’ts
 = 0;

112 
»tv®
 = 
	`•Şl_wa™
(
¡©e
->
•fd
,¡©e->
ev’ts
,
ev’tLoİ
->
£tsize
,

113 
tvp
 ? (tvp->
tv_£c
*1000 +vp->
tv_u£c
/1000) : -1);

114 ià(
»tv®
 > 0) {

115 
j
;

117 
numev’ts
 = 
»tv®
;

118 
j
 = 0; j < 
numev’ts
; j++) {

119 
mask
 = 0;

120 
•Şl_ev’t
 *
e
 = 
¡©e
->
ev’ts
+
j
;

122 ià(
e
->
ev’ts
 & 
EPOLLIN
è
mask
 |ğ
AE_READABLE
;

123 ià(
e
->
ev’ts
 & 
EPOLLOUT
è
mask
 |ğ
AE_WRITABLE
;

124 ià(
e
->
ev’ts
 & 
EPOLLERR
è
mask
 |ğ
AE_WRITABLE
;

125 ià(
e
->
ev’ts
 & 
EPOLLHUP
è
mask
 |ğ
AE_WRITABLE
;

126 
ev’tLoİ
->
fœed
[
j
].
fd
 = 
e
->
d©a
.fd;

127 
ev’tLoİ
->
fœed
[
j
].
mask
 = mask;

130  
numev’ts
;

131 
	}
}

133 *
	$«ApiName
() {

135 
	}
}

	@src/ae_evport.c

31 
	~<as£¹.h
>

32 
	~<”ºo.h
>

33 
	~<pÜt.h
>

34 
	~<pŞl.h
>

36 
	~<sys/ty³s.h
>

37 
	~<sys/time.h
>

39 
	~<¡dio.h
>

41 
	gevpÜt_debug
 = 0;

66 
	#MAX_EVENT_BATCHSZ
 512

	)

68 
	s«ApiS‹
 {

69 
	mpÜtfd
;

70 
	mÅ’dšg
;

71 
	m³ndšg_fds
[
MAX_EVENT_BATCHSZ
];

72 
	m³ndšg_masks
[
MAX_EVENT_BATCHSZ
];

73 } 
	t«ApiS‹
;

75 
	$«ApiC»©e
(
«Ev’tLoİ
 *
ev’tLoİ
) {

76 
i
;

77 
«ApiS‹
 *
¡©e
 = 
	`zm®loc
((aeApiState));

78 ià(!
¡©e
)  -1;

80 
¡©e
->
pÜtfd
 = 
	`pÜt_ü—‹
();

81 ià(
¡©e
->
pÜtfd
 == -1) {

82 
	`zä“
(
¡©e
);

86 
¡©e
->
Å’dšg
 = 0;

88 
i
 = 0; i < 
MAX_EVENT_BATCHSZ
; i++) {

89 
¡©e
->
³ndšg_fds
[
i
] = -1;

90 
¡©e
->
³ndšg_masks
[
i
] = 
AE_NONE
;

93 
ev’tLoİ
->
­id©a
 = 
¡©e
;

95 
	}
}

97 
	$«ApiResize
(
«Ev’tLoİ
 *
ev’tLoİ
, 
£tsize
) {

100 
	}
}

102 
	$«ApiF»e
(
«Ev’tLoİ
 *
ev’tLoİ
) {

103 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

105 
	`şo£
(
¡©e
->
pÜtfd
);

106 
	`zä“
(
¡©e
);

107 
	}
}

109 
	$«ApiLookupP’dšg
(
«ApiS‹
 *
¡©e
, 
fd
) {

110 
i
;

112 
i
 = 0; i < 
¡©e
->
Å’dšg
; i++) {

113 ià(
¡©e
->
³ndšg_fds
[
i
] =ğ
fd
)

114  (
i
);

118 
	}
}

123 
	$«ApiAssocŸ‹
(cÚ¡ *
wh”e
, 
pÜtfd
, 
fd
, 
mask
) {

124 
ev’ts
 = 0;

125 
rv
, 
”r
;

127 ià(
mask
 & 
AE_READABLE
)

128 
ev’ts
 |ğ
POLLIN
;

129 ià(
mask
 & 
AE_WRITABLE
)

130 
ev’ts
 |ğ
POLLOUT
;

132 ià(
evpÜt_debug
)

133 
	`årštf
(
¡d”r
, "%s:…Üt_assocŸ‹(%d, 0x%xèğ", 
wh”e
, 
fd
, 
ev’ts
);

135 
rv
 = 
	`pÜt_assocŸ‹
(
pÜtfd
, 
PORT_SOURCE_FD
, 
fd
, 
ev’ts
,

136 (*)(
ušŒ_t
)
mask
);

137 
”r
 = 
”ºo
;

139 ià(
evpÜt_debug
)

140 
	`årštf
(
¡d”r
, "%d (%s)\n", 
rv
,„v =ğ0 ? "nØ”rÜ" : 
	`¡»¼Ü
(
”r
));

142 ià(
rv
 == -1) {

143 
	`årštf
(
¡d”r
, "%s:…Üt_assocŸ‹: %s\n", 
wh”e
, 
	`¡»¼Ü
(
”r
));

145 ià(
”r
 =ğ
EAGAIN
)

146 
	`årštf
(
¡d”r
, "aeApiAssociate:ƒvent…ort†imitƒxceeded.");

149  
rv
;

150 
	}
}

152 
	$«ApiAddEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
) {

153 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

154 
fuÎmask
, 
pfd
;

156 ià(
evpÜt_debug
)

157 
	`årštf
(
¡d”r
, "«ApiAddEv’t: fd %d mask 0x%x\n", 
fd
, 
mask
);

164 
fuÎmask
 = 
mask
 | 
ev’tLoİ
->
ev’ts
[
fd
].mask;

165 
pfd
 = 
	`«ApiLookupP’dšg
(
¡©e
, 
fd
);

167 ià(
pfd
 != -1) {

174 ià(
evpÜt_debug
)

175 
	`årštf
(
¡d”r
, "«ApiAddEv’t:‡ddšgØ³ndšg fd %d\n", 
fd
);

176 
¡©e
->
³ndšg_masks
[
pfd
] |ğ
fuÎmask
;

180  (
	`«ApiAssocŸ‹
("«ApiAddEv’t", 
¡©e
->
pÜtfd
, 
fd
, 
fuÎmask
));

181 
	}
}

183 
	$«ApiD–Ev’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
) {

184 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

185 
fuÎmask
, 
pfd
;

187 ià(
evpÜt_debug
)

188 
	`årštf
(
¡d”r
, "d– fd %d mask 0x%x\n", 
fd
, 
mask
);

190 
pfd
 = 
	`«ApiLookupP’dšg
(
¡©e
, 
fd
);

192 ià(
pfd
 != -1) {

193 ià(
evpÜt_debug
)

194 
	`årštf
(
¡d”r
, "d–‘šgƒv’ˆäom…’dšg fd %d\n", 
fd
);

201 
¡©e
->
³ndšg_masks
[
pfd
] &ğ~
mask
;

203 ià(
¡©e
->
³ndšg_masks
[
pfd
] =ğ
AE_NONE
)

204 
¡©e
->
³ndšg_fds
[
pfd
] = -1;

217 
fuÎmask
 = 
ev’tLoİ
->
ev’ts
[
fd
].
mask
;

218 ià(
fuÎmask
 =ğ
AE_NONE
) {

223 ià(
evpÜt_debug
)

224 
	`årštf
(
¡d”r
, "«ApiD–Ev’t:…Üt_dissocŸ‹(%d)\n", 
fd
);

226 ià(
	`pÜt_dissocŸ‹
(
¡©e
->
pÜtfd
, 
PORT_SOURCE_FD
, 
fd
) != 0) {

227 
	`³¼Ü
("aeApiDelEvent:…ort_dissociate");

228 
	`abÜt
();

230 } ià(
	`«ApiAssocŸ‹
("«ApiD–Ev’t", 
¡©e
->
pÜtfd
, 
fd
,

231 
fuÎmask
) != 0) {

239 
	`abÜt
();

241 
	}
}

243 
	$«ApiPŞl
(
«Ev’tLoİ
 *
ev’tLoİ
, 
timev®
 *
tvp
) {

244 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

245 
time¥ec
 
timeout
, *
t¥
;

246 
mask
, 
i
;

247 
ušt_t
 
Ãv’ts
;

248 
pÜt_ev’t_t
 
ev’t
[
MAX_EVENT_BATCHSZ
];

255 
i
 = 0; i < 
¡©e
->
Å’dšg
; i++) {

256 ià(
¡©e
->
³ndšg_fds
[
i
] == -1)

260 ià(
	`«ApiAssocŸ‹
("«ApiPŞl", 
¡©e
->
pÜtfd
,

261 
¡©e
->
³ndšg_fds
[
i
], s‹->
³ndšg_masks
[i]) != 0) {

263 
	`abÜt
();

266 
¡©e
->
³ndšg_masks
[
i
] = 
AE_NONE
;

267 
¡©e
->
³ndšg_fds
[
i
] = -1;

270 
¡©e
->
Å’dšg
 = 0;

272 ià(
tvp
 !ğ
NULL
) {

273 
timeout
.
tv_£c
 = 
tvp
->tv_sec;

274 
timeout
.
tv_n£c
 = 
tvp
->
tv_u£c
 * 1000;

275 
t¥
 = &
timeout
;

277 
t¥
 = 
NULL
;

284 
Ãv’ts
 = 1;

285 ià(
	`pÜt_g‘n
(
¡©e
->
pÜtfd
, 
ev’t
, 
MAX_EVENT_BATCHSZ
, &
Ãv’ts
,

286 
t¥
è=ğ-1 && (
”ºo
 !ğ
ETIME
 || 
Ãv’ts
 == 0)) {

287 ià(
”ºo
 =ğ
ETIME
 ||ƒ¼nØ=ğ
EINTR
)

291 
	`³¼Ü
("aeApiPoll:…ort_get");

292 
	`abÜt
();

295 
¡©e
->
Å’dšg
 = 
Ãv’ts
;

297 
i
 = 0; i < 
Ãv’ts
; i++) {

298 
mask
 = 0;

299 ià(
ev’t
[
i
].
pÜ‹v_ev’ts
 & 
POLLIN
)

300 
mask
 |ğ
AE_READABLE
;

301 ià(
ev’t
[
i
].
pÜ‹v_ev’ts
 & 
POLLOUT
)

302 
mask
 |ğ
AE_WRITABLE
;

304 
ev’tLoİ
->
fœed
[
i
].
fd
 = 
ev’t
[i].
pÜ‹v_objeù
;

305 
ev’tLoİ
->
fœed
[
i
].
mask
 = mask;

307 ià(
evpÜt_debug
)

308 
	`årštf
(
¡d”r
, "aeApiPoll: fd %d mask 0x%x\n",

309 ()
ev’t
[
i
].
pÜ‹v_objeù
, 
mask
);

311 
¡©e
->
³ndšg_fds
[
i
] = 
ev’t
[i].
pÜ‹v_objeù
;

312 
¡©e
->
³ndšg_masks
[
i
] = (
ušŒ_t
)
ev’t
[i].
pÜ‹v_u£r
;

315  
Ãv’ts
;

316 
	}
}

318 *
	$«ApiName
() {

320 
	}
}

	@src/ae_kqueue.c

32 
	~<sys/ty³s.h
>

33 
	~<sys/ev’t.h
>

34 
	~<sys/time.h
>

36 
	s«ApiS‹
 {

37 
	mkqfd
;

38 
kev’t
 *
	mev’ts
;

39 } 
	t«ApiS‹
;

41 
	$«ApiC»©e
(
«Ev’tLoİ
 *
ev’tLoİ
) {

42 
«ApiS‹
 *
¡©e
 = 
	`zm®loc
((aeApiState));

44 ià(!
¡©e
)  -1;

45 
¡©e
->
ev’ts
 = 
	`zm®loc
((
kev’t
)*
ev’tLoİ
->
£tsize
);

46 ià(!
¡©e
->
ev’ts
) {

47 
	`zä“
(
¡©e
);

50 
¡©e
->
kqfd
 = 
	`kqueue
();

51 ià(
¡©e
->
kqfd
 == -1) {

52 
	`zä“
(
¡©e
->
ev’ts
);

53 
	`zä“
(
¡©e
);

56 
ev’tLoİ
->
­id©a
 = 
¡©e
;

58 
	}
}

60 
	$«ApiResize
(
«Ev’tLoİ
 *
ev’tLoİ
, 
£tsize
) {

61 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

63 
¡©e
->
ev’ts
 = 
	`z»®loc
(¡©e->ev’ts, (
kev’t
)*
£tsize
);

65 
	}
}

67 
	$«ApiF»e
(
«Ev’tLoİ
 *
ev’tLoİ
) {

68 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

70 
	`şo£
(
¡©e
->
kqfd
);

71 
	`zä“
(
¡©e
->
ev’ts
);

72 
	`zä“
(
¡©e
);

73 
	}
}

75 
	$«ApiAddEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
) {

76 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

77 
kev’t
 
ke
;

79 ià(
mask
 & 
AE_READABLE
) {

80 
	`EV_SET
(&
ke
, 
fd
, 
EVFILT_READ
, 
EV_ADD
, 0, 0, 
NULL
);

81 ià(
	`kev’t
(
¡©e
->
kqfd
, &
ke
, 1, 
NULL
, 0, NULL) == -1)  -1;

83 ià(
mask
 & 
AE_WRITABLE
) {

84 
	`EV_SET
(&
ke
, 
fd
, 
EVFILT_WRITE
, 
EV_ADD
, 0, 0, 
NULL
);

85 ià(
	`kev’t
(
¡©e
->
kqfd
, &
ke
, 1, 
NULL
, 0, NULL) == -1)  -1;

88 
	}
}

90 
	$«ApiD–Ev’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
) {

91 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

92 
kev’t
 
ke
;

94 ià(
mask
 & 
AE_READABLE
) {

95 
	`EV_SET
(&
ke
, 
fd
, 
EVFILT_READ
, 
EV_DELETE
, 0, 0, 
NULL
);

96 
	`kev’t
(
¡©e
->
kqfd
, &
ke
, 1, 
NULL
, 0, NULL);

98 ià(
mask
 & 
AE_WRITABLE
) {

99 
	`EV_SET
(&
ke
, 
fd
, 
EVFILT_WRITE
, 
EV_DELETE
, 0, 0, 
NULL
);

100 
	`kev’t
(
¡©e
->
kqfd
, &
ke
, 1, 
NULL
, 0, NULL);

102 
	}
}

104 
	$«ApiPŞl
(
«Ev’tLoİ
 *
ev’tLoİ
, 
timev®
 *
tvp
) {

105 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

106 
»tv®
, 
numev’ts
 = 0;

108 ià(
tvp
 !ğ
NULL
) {

109 
time¥ec
 
timeout
;

110 
timeout
.
tv_£c
 = 
tvp
->tv_sec;

111 
timeout
.
tv_n£c
 = 
tvp
->
tv_u£c
 * 1000;

112 
»tv®
 = 
	`kev’t
(
¡©e
->
kqfd
, 
NULL
, 0, s‹->
ev’ts
, 
ev’tLoİ
->
£tsize
,

113 &
timeout
);

115 
»tv®
 = 
	`kev’t
(
¡©e
->
kqfd
, 
NULL
, 0, s‹->
ev’ts
, 
ev’tLoİ
->
£tsize
,

116 
NULL
);

119 ià(
»tv®
 > 0) {

120 
j
;

122 
numev’ts
 = 
»tv®
;

123 
j
 = 0; j < 
numev’ts
; j++) {

124 
mask
 = 0;

125 
kev’t
 *
e
 = 
¡©e
->
ev’ts
+
j
;

127 ià(
e
->
f‹r
 =ğ
EVFILT_READ
è
mask
 |ğ
AE_READABLE
;

128 ià(
e
->
f‹r
 =ğ
EVFILT_WRITE
è
mask
 |ğ
AE_WRITABLE
;

129 
ev’tLoİ
->
fœed
[
j
].
fd
 = 
e
->
id’t
;

130 
ev’tLoİ
->
fœed
[
j
].
mask
 = mask;

133  
numev’ts
;

134 
	}
}

136 *
	$«ApiName
() {

138 
	}
}

	@src/ae_select.c

32 
	~<sys/£Ëù.h
>

33 
	~<¡ršg.h
>

35 
	s«ApiS‹
 {

36 
fd_£t
 
	mrfds
, 
	mwfds
;

39 
fd_£t
 
	m_rfds
, 
	m_wfds
;

40 } 
	t«ApiS‹
;

42 
	$«ApiC»©e
(
«Ev’tLoİ
 *
ev’tLoİ
) {

43 
«ApiS‹
 *
¡©e
 = 
	`zm®loc
((aeApiState));

45 ià(!
¡©e
)  -1;

46 
	`FD_ZERO
(&
¡©e
->
rfds
);

47 
	`FD_ZERO
(&
¡©e
->
wfds
);

48 
ev’tLoİ
->
­id©a
 = 
¡©e
;

50 
	}
}

52 
	$«ApiResize
(
«Ev’tLoİ
 *
ev’tLoİ
, 
£tsize
) {

54 ià(
£tsize
 >ğ
FD_SETSIZE
)  -1;

56 
	}
}

58 
	$«ApiF»e
(
«Ev’tLoİ
 *
ev’tLoİ
) {

59 
	`zä“
(
ev’tLoİ
->
­id©a
);

60 
	}
}

62 
	$«ApiAddEv’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
) {

63 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

65 ià(
mask
 & 
AE_READABLE
è
	`FD_SET
(
fd
,&
¡©e
->
rfds
);

66 ià(
mask
 & 
AE_WRITABLE
è
	`FD_SET
(
fd
,&
¡©e
->
wfds
);

68 
	}
}

70 
	$«ApiD–Ev’t
(
«Ev’tLoİ
 *
ev’tLoİ
, 
fd
, 
mask
) {

71 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

73 ià(
mask
 & 
AE_READABLE
è
	`FD_CLR
(
fd
,&
¡©e
->
rfds
);

74 ià(
mask
 & 
AE_WRITABLE
è
	`FD_CLR
(
fd
,&
¡©e
->
wfds
);

75 
	}
}

77 
	$«ApiPŞl
(
«Ev’tLoİ
 *
ev’tLoİ
, 
timev®
 *
tvp
) {

78 
«ApiS‹
 *
¡©e
 = 
ev’tLoİ
->
­id©a
;

79 
»tv®
, 
j
, 
numev’ts
 = 0;

81 
	`memıy
(&
¡©e
->
_rfds
,&¡©e->
rfds
,(
fd_£t
));

82 
	`memıy
(&
¡©e
->
_wfds
,&¡©e->
wfds
,(
fd_£t
));

84 
»tv®
 = 
	`£Ëù
(
ev’tLoİ
->
maxfd
+1,

85 &
¡©e
->
_rfds
,&¡©e->
_wfds
,
NULL
,
tvp
);

86 ià(
»tv®
 > 0) {

87 
j
 = 0; j <ğ
ev’tLoİ
->
maxfd
; j++) {

88 
mask
 = 0;

89 
«FeEv’t
 *
ã
 = &
ev’tLoİ
->
ev’ts
[
j
];

91 ià(
ã
->
mask
 =ğ
AE_NONE
) ;

92 ià(
ã
->
mask
 & 
AE_READABLE
 && 
	`FD_ISSET
(
j
,&
¡©e
->
_rfds
))

93 
mask
 |ğ
AE_READABLE
;

94 ià(
ã
->
mask
 & 
AE_WRITABLE
 && 
	`FD_ISSET
(
j
,&
¡©e
->
_wfds
))

95 
mask
 |ğ
AE_WRITABLE
;

96 
ev’tLoİ
->
fœed
[
numev’ts
].
fd
 = 
j
;

97 
ev’tLoİ
->
fœed
[
numev’ts
].
mask
 = mask;

98 
numev’ts
++;

101  
numev’ts
;

102 
	}
}

104 *
	$«ApiName
() {

106 
	}
}

	@src/anet.c

31 
	~"fmaüos.h
"

33 
	~<sys/ty³s.h
>

34 
	~<sys/sock‘.h
>

35 
	~<sys/¡©.h
>

36 
	~<sys/un.h
>

37 
	~<sys/time.h
>

38 
	~<Ãtš‘/š.h
>

39 
	~<Ãtš‘/tı.h
>

40 
	~<¬·/š‘.h
>

41 
	~<uni¡d.h
>

42 
	~<fú.h
>

43 
	~<¡ršg.h
>

44 
	~<Ãtdb.h
>

45 
	~<”ºo.h
>

46 
	~<¡d¬g.h
>

47 
	~<¡dio.h
>

49 
	~"ª‘.h
"

51 
	$ª‘S‘E¼Ü
(*
”r
, cÚ¡ *
fmt
, ...)

53 
va_li¡
 
­
;

55 ià(!
”r
) ;

56 
	`va_¡¬t
(
­
, 
fmt
);

57 
	`v¢´štf
(
”r
, 
ANET_ERR_LEN
, 
fmt
, 
­
);

58 
	`va_’d
(
­
);

59 
	}
}

61 
	$ª‘S‘Block
(*
”r
, 
fd
, 
nÚ_block
) {

62 
æags
;

67 ià((
æags
 = 
	`fú
(
fd
, 
F_GETFL
)) == -1) {

68 
	`ª‘S‘E¼Ü
(
”r
, "fú(F_GETFL): %s", 
	`¡»¼Ü
(
”ºo
));

69  
ANET_ERR
;

72 ià(
nÚ_block
)

73 
æags
 |ğ
O_NONBLOCK
;

75 
æags
 &ğ~
O_NONBLOCK
;

77 ià(
	`fú
(
fd
, 
F_SETFL
, 
æags
) == -1) {

78 
	`ª‘S‘E¼Ü
(
”r
, "fú(F_SETFL,O_NONBLOCK): %s", 
	`¡»¼Ü
(
”ºo
));

79  
ANET_ERR
;

81  
ANET_OK
;

82 
	}
}

84 
	$ª‘NÚBlock
(*
”r
, 
fd
) {

85  
	`ª‘S‘Block
(
”r
,
fd
,1);

86 
	}
}

88 
	$ª‘Block
(*
”r
, 
fd
) {

89  
	`ª‘S‘Block
(
”r
,
fd
,0);

90 
	}
}

95 
	$ª‘K“pAlive
(*
”r
, 
fd
, 
š‹rv®
)

97 
v®
 = 1;

99 ià(
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_KEEPALIVE
, &
v®
, (val)) == -1)

101 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİˆSO_KEEPALIVE: %s", 
	`¡»¼Ü
(
”ºo
));

102  
ANET_ERR
;

105 #ifdeà
__lšux__


111 
v®
 = 
š‹rv®
;

112 ià(
	`£tsockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPIDLE
, &
v®
, (val)) < 0) {

113 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİˆTCP_KEEPIDLE: %s\n", 
	`¡»¼Ü
(
”ºo
));

114  
ANET_ERR
;

120 
v®
 = 
š‹rv®
/3;

121 ià(
v®
 == 0) val = 1;

122 ià(
	`£tsockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPINTVL
, &
v®
, (val)) < 0) {

123 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİˆTCP_KEEPINTVL: %s\n", 
	`¡»¼Ü
(
”ºo
));

124  
ANET_ERR
;

129 
v®
 = 3;

130 ià(
	`£tsockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_KEEPCNT
, &
v®
, (val)) < 0) {

131 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİˆTCP_KEEPCNT: %s\n", 
	`¡»¼Ü
(
”ºo
));

132  
ANET_ERR
;

135 ((è
š‹rv®
);

138  
ANET_OK
;

139 
	}
}

141 
	$ª‘S‘TıNoD–ay
(*
”r
, 
fd
, 
v®
)

143 ià(
	`£tsockİt
(
fd
, 
IPPROTO_TCP
, 
TCP_NODELAY
, &
v®
, (val)) == -1)

145 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİˆTCP_NODELAY: %s", 
	`¡»¼Ü
(
”ºo
));

146  
ANET_ERR
;

148  
ANET_OK
;

149 
	}
}

151 
	$ª‘EÇbËTıNoD–ay
(*
”r
, 
fd
)

153  
	`ª‘S‘TıNoD–ay
(
”r
, 
fd
, 1);

154 
	}
}

156 
	$ª‘Di§bËTıNoD–ay
(*
”r
, 
fd
)

158  
	`ª‘S‘TıNoD–ay
(
”r
, 
fd
, 0);

159 
	}
}

162 
	$ª‘S‘S’dBufãr
(*
”r
, 
fd
, 
buffsize
)

164 ià(
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_SNDBUF
, &
buffsize
, (buffsize)) == -1)

166 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİˆSO_SNDBUF: %s", 
	`¡»¼Ü
(
”ºo
));

167  
ANET_ERR
;

169  
ANET_OK
;

170 
	}
}

172 
	$ª‘TıK“pAlive
(*
”r
, 
fd
)

174 
yes
 = 1;

175 ià(
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_KEEPALIVE
, &
yes
, (yes)) == -1) {

176 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİˆSO_KEEPALIVE: %s", 
	`¡»¼Ü
(
”ºo
));

177  
ANET_ERR
;

179  
ANET_OK
;

180 
	}
}

184 
	$ª‘S’dTimeout
(*
”r
, 
fd
, 
ms
) {

185 
timev®
 
tv
;

187 
tv
.
tv_£c
 = 
ms
/1000;

188 
tv
.
tv_u£c
 = (
ms
%1000)*1000;

189 ià(
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_SNDTIMEO
, &
tv
, (tv)) == -1) {

190 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİˆSO_SNDTIMEO: %s", 
	`¡»¼Ü
(
”ºo
));

191  
ANET_ERR
;

193  
ANET_OK
;

194 
	}
}

203 
	$ª‘G’”icResŞve
(*
”r
, *
ho¡
, *
buf
, 
size_t
 
buf_Ën
,

204 
æags
)

206 
addršfo
 
hšts
, *
šfo
;

207 
rv
;

209 
	`mem£t
(&
hšts
,0,(hints));

210 ià(
æags
 & 
ANET_IP_ONLY
è
hšts
.
ai_æags
 = 
AI_NUMERICHOST
;

211 
hšts
.
ai_çmy
 = 
AF_UNSPEC
;

212 
hšts
.
ai_sockty³
 = 
SOCK_STREAM
;

214 ià((
rv
 = 
	`g‘addršfo
(
ho¡
, 
NULL
, &
hšts
, &
šfo
)) != 0) {

215 
	`ª‘S‘E¼Ü
(
”r
, "%s", 
	`gai_¡»¼Ü
(
rv
));

216  
ANET_ERR
;

218 ià(
šfo
->
ai_çmy
 =ğ
AF_INET
) {

219 
sockaddr_š
 *
§
 = (sockaddr_š *)
šfo
->
ai_addr
;

220 
	`š‘_Áİ
(
AF_INET
, &(
§
->
sš_addr
), 
buf
, 
buf_Ën
);

222 
sockaddr_š6
 *
§
 = (sockaddr_š6 *)
šfo
->
ai_addr
;

223 
	`š‘_Áİ
(
AF_INET6
, &(
§
->
sš6_addr
), 
buf
, 
buf_Ën
);

226 
	`ä“addršfo
(
šfo
);

227  
ANET_OK
;

228 
	}
}

230 
	$ª‘ResŞve
(*
”r
, *
ho¡
, *
buf
, 
size_t
 
buf_Ën
) {

231  
	`ª‘G’”icResŞve
(
”r
,
ho¡
,
buf
,
buf_Ën
,
ANET_NONE
);

232 
	}
}

234 
	$ª‘ResŞveIP
(*
”r
, *
ho¡
, *
buf
, 
size_t
 
buf_Ën
) {

235  
	`ª‘G’”icResŞve
(
”r
,
ho¡
,
buf
,
buf_Ën
,
ANET_IP_ONLY
);

236 
	}
}

238 
	$ª‘S‘Reu£Addr
(*
”r
, 
fd
) {

239 
yes
 = 1;

242 ià(
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
yes
, (yes)) == -1) {

243 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİˆSO_REUSEADDR: %s", 
	`¡»¼Ü
(
”ºo
));

244  
ANET_ERR
;

246  
ANET_OK
;

247 
	}
}

249 
	$ª‘C»©eSock‘
(*
”r
, 
domaš
) {

250 
s
;

251 ià((
s
 = 
	`sock‘
(
domaš
, 
SOCK_STREAM
, 0)) == -1) {

252 
	`ª‘S‘E¼Ü
(
”r
, "ü—tšg sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

253  
ANET_ERR
;

258 ià(
	`ª‘S‘Reu£Addr
(
”r
,
s
è=ğ
ANET_ERR
) {

259 
	`şo£
(
s
);

260  
ANET_ERR
;

262  
s
;

263 
	}
}

265 
	#ANET_CONNECT_NONE
 0

	)

266 
	#ANET_CONNECT_NONBLOCK
 1

	)

267 
	#ANET_CONNECT_BE_BINDING
 2

	)

268 
	$ª‘TıG’”icCÚÃù
(*
”r
, *
addr
, 
pÜt
,

269 *
sourû_addr
, 
æags
)

271 
s
 = 
ANET_ERR
, 
rv
;

272 
pÜt¡r
[6];

273 
addršfo
 
hšts
, *
£rvšfo
, *
b£rvšfo
, *
p
, *
b
;

275 
	`¢´štf
(
pÜt¡r
,ÕÜt¡r),"%d",
pÜt
);

276 
	`mem£t
(&
hšts
,0,(hints));

277 
hšts
.
ai_çmy
 = 
AF_UNSPEC
;

278 
hšts
.
ai_sockty³
 = 
SOCK_STREAM
;

280 ià((
rv
 = 
	`g‘addršfo
(
addr
,
pÜt¡r
,&
hšts
,&
£rvšfo
)) != 0) {

281 
	`ª‘S‘E¼Ü
(
”r
, "%s", 
	`gai_¡»¼Ü
(
rv
));

282  
ANET_ERR
;

284 
p
 = 
£rvšfo
;… !ğ
NULL
;… =…->
ai_Ãxt
) {

288 ià((
s
 = 
	`sock‘
(
p
->
ai_çmy
,p->
ai_sockty³
,p->
ai_´ÙocŞ
)) == -1)

290 ià(
	`ª‘S‘Reu£Addr
(
”r
,
s
è=ğ
ANET_ERR
è
”rÜ
;

291 ià(
æags
 & 
ANET_CONNECT_NONBLOCK
 && 
	`ª‘NÚBlock
(
”r
,
s
è!ğ
ANET_OK
)

292 
”rÜ
;

293 ià(
sourû_addr
) {

294 
bound
 = 0;

296 ià((
rv
 = 
	`g‘addršfo
(
sourû_addr
, 
NULL
, &
hšts
, &
b£rvšfo
)) != 0)

298 
	`ª‘S‘E¼Ü
(
”r
, "%s", 
	`gai_¡»¼Ü
(
rv
));

299 
”rÜ
;

301 
b
 = 
b£rvšfo
; b !ğ
NULL
; b = b->
ai_Ãxt
) {

302 ià(
	`bšd
(
s
,
b
->
ai_addr
,b->
ai_add¾’
) != -1) {

303 
bound
 = 1;

307 
	`ä“addršfo
(
b£rvšfo
);

308 ià(!
bound
) {

309 
	`ª‘S‘E¼Ü
(
”r
, "bšd: %s", 
	`¡»¼Ü
(
”ºo
));

310 
”rÜ
;

313 ià(
	`cÚÃù
(
s
,
p
->
ai_addr
,p->
ai_add¾’
) == -1) {

316 ià(
”ºo
 =ğ
EINPROGRESS
 && 
æags
 & 
ANET_CONNECT_NONBLOCK
)

317 
’d
;

318 
	`şo£
(
s
);

319 
s
 = 
ANET_ERR
;

325 
’d
;

327 ià(
p
 =ğ
NULL
)

328 
	`ª‘S‘E¼Ü
(
”r
, "ü—tšg sock‘: %s", 
	`¡»¼Ü
(
”ºo
));

330 
”rÜ
:

331 ià(
s
 !ğ
ANET_ERR
) {

332 
	`şo£
(
s
);

333 
s
 = 
ANET_ERR
;

336 
’d
:

337 
	`ä“addršfo
(
£rvšfo
);

341 ià(
s
 =ğ
ANET_ERR
 && 
sourû_addr
 && (
æags
 & 
ANET_CONNECT_BE_BINDING
)) {

342  
	`ª‘TıG’”icCÚÃù
(
”r
,
addr
,
pÜt
,
NULL
,
æags
);

344  
s
;

346 
	}
}

348 
	$ª‘TıCÚÃù
(*
”r
, *
addr
, 
pÜt
)

350  
	`ª‘TıG’”icCÚÃù
(
”r
,
addr
,
pÜt
,
NULL
,
ANET_CONNECT_NONE
);

351 
	}
}

353 
	$ª‘TıNÚBlockCÚÃù
(*
”r
, *
addr
, 
pÜt
)

355  
	`ª‘TıG’”icCÚÃù
(
”r
,
addr
,
pÜt
,
NULL
,
ANET_CONNECT_NONBLOCK
);

356 
	}
}

358 
	$ª‘TıNÚBlockBšdCÚÃù
(*
”r
, *
addr
, 
pÜt
,

359 *
sourû_addr
)

361  
	`ª‘TıG’”icCÚÃù
(
”r
,
addr
,
pÜt
,
sourû_addr
,

362 
ANET_CONNECT_NONBLOCK
);

363 
	}
}

365 
	$ª‘TıNÚBlockBe¡EffÜtBšdCÚÃù
(*
”r
, *
addr
, 
pÜt
,

366 *
sourû_addr
)

368  
	`ª‘TıG’”icCÚÃù
(
”r
,
addr
,
pÜt
,
sourû_addr
,

369 
ANET_CONNECT_NONBLOCK
|
ANET_CONNECT_BE_BINDING
);

370 
	}
}

372 
	$ª‘UnixG’”icCÚÃù
(*
”r
, *
·th
, 
æags
)

374 
s
;

375 
sockaddr_un
 
§
;

377 ià((
s
 = 
	`ª‘C»©eSock‘
(
”r
,
AF_LOCAL
)è=ğ
ANET_ERR
)

378  
ANET_ERR
;

380 
§
.
sun_çmy
 = 
AF_LOCAL
;

381 
	`¡ºıy
(
§
.
sun_·th
,
·th
,(sa.sun_path)-1);

382 ià(
æags
 & 
ANET_CONNECT_NONBLOCK
) {

383 ià(
	`ª‘NÚBlock
(
”r
,
s
è!ğ
ANET_OK
)

384  
ANET_ERR
;

386 ià(
	`cÚÃù
(
s
,(
sockaddr
*)&
§
,(sa)) == -1) {

387 ià(
”ºo
 =ğ
EINPROGRESS
 &&

388 
æags
 & 
ANET_CONNECT_NONBLOCK
)

389  
s
;

391 
	`ª‘S‘E¼Ü
(
”r
, "cÚÃù: %s", 
	`¡»¼Ü
(
”ºo
));

392 
	`şo£
(
s
);

393  
ANET_ERR
;

395  
s
;

396 
	}
}

398 
	$ª‘UnixCÚÃù
(*
”r
, *
·th
)

400  
	`ª‘UnixG’”icCÚÃù
(
”r
,
·th
,
ANET_CONNECT_NONE
);

401 
	}
}

403 
	$ª‘UnixNÚBlockCÚÃù
(*
”r
, *
·th
)

405  
	`ª‘UnixG’”icCÚÃù
(
”r
,
·th
,
ANET_CONNECT_NONBLOCK
);

406 
	}
}

410 
	$ª‘R—d
(
fd
, *
buf
, 
couÁ
)

412 
ssize_t
 
Ä—d
, 
tÙËn
 = 0;

413 
tÙËn
 !ğ
couÁ
) {

414 
Ä—d
 = 
	`»ad
(
fd
,
buf
,
couÁ
-
tÙËn
);

415 ià(
Ä—d
 =ğ0è 
tÙËn
;

416 ià(
Ä—d
 == -1)  -1;

417 
tÙËn
 +ğ
Ä—d
;

418 
buf
 +ğ
Ä—d
;

420  
tÙËn
;

421 
	}
}

425 
	$ª‘Wr™e
(
fd
, *
buf
, 
couÁ
)

427 
ssize_t
 
nwr™‹n
, 
tÙËn
 = 0;

428 
tÙËn
 !ğ
couÁ
) {

429 
nwr™‹n
 = 
	`wr™e
(
fd
,
buf
,
couÁ
-
tÙËn
);

430 ià(
nwr™‹n
 =ğ0è 
tÙËn
;

431 ià(
nwr™‹n
 == -1)  -1;

432 
tÙËn
 +ğ
nwr™‹n
;

433 
buf
 +ğ
nwr™‹n
;

435  
tÙËn
;

436 
	}
}

438 
	$ª‘Li¡’
(*
”r
, 
s
, 
sockaddr
 *
§
, 
sockËn_t
 
Ën
, 
backlog
) {

439 ià(
	`bšd
(
s
,
§
,
Ën
) == -1) {

440 
	`ª‘S‘E¼Ü
(
”r
, "bšd: %s", 
	`¡»¼Ü
(
”ºo
));

441 
	`şo£
(
s
);

442  
ANET_ERR
;

445 ià(
	`li¡’
(
s
, 
backlog
) == -1) {

446 
	`ª‘S‘E¼Ü
(
”r
, "li¡’: %s", 
	`¡»¼Ü
(
”ºo
));

447 
	`şo£
(
s
);

448  
ANET_ERR
;

450  
ANET_OK
;

451 
	}
}

453 
	$ª‘V6OÆy
(*
”r
, 
s
) {

454 
yes
 = 1;

455 ià(
	`£tsockİt
(
s
,
IPPROTO_IPV6
,
IPV6_V6ONLY
,&
yes
,(yes)) == -1) {

456 
	`ª‘S‘E¼Ü
(
”r
, "£tsockİt: %s", 
	`¡»¼Ü
(
”ºo
));

457 
	`şo£
(
s
);

458  
ANET_ERR
;

460  
ANET_OK
;

461 
	}
}

463 
	$_ª‘TıS”v”
(*
”r
, 
pÜt
, *
bšdaddr
, 
af
, 
backlog
)

465 
s
, 
rv
;

466 
_pÜt
[6];

467 
addršfo
 
hšts
, *
£rvšfo
, *
p
;

469 
	`¢´štf
(
_pÜt
,6,"%d",
pÜt
);

470 
	`mem£t
(&
hšts
,0,(hints));

471 
hšts
.
ai_çmy
 = 
af
;

472 
hšts
.
ai_sockty³
 = 
SOCK_STREAM
;

473 
hšts
.
ai_æags
 = 
AI_PASSIVE
;

475 ià((
rv
 = 
	`g‘addršfo
(
bšdaddr
,
_pÜt
,&
hšts
,&
£rvšfo
)) != 0) {

476 
	`ª‘S‘E¼Ü
(
”r
, "%s", 
	`gai_¡»¼Ü
(
rv
));

477  
ANET_ERR
;

479 
p
 = 
£rvšfo
;… !ğ
NULL
;… =…->
ai_Ãxt
) {

480 ià((
s
 = 
	`sock‘
(
p
->
ai_çmy
,p->
ai_sockty³
,p->
ai_´ÙocŞ
)) == -1)

483 ià(
af
 =ğ
AF_INET6
 && 
	`ª‘V6OÆy
(
”r
,
s
è=ğ
ANET_ERR
è
”rÜ
;

484 ià(
	`ª‘S‘Reu£Addr
(
”r
,
s
è=ğ
ANET_ERR
è
”rÜ
;

485 ià(
	`ª‘Li¡’
(
”r
,
s
,
p
->
ai_addr
,p->
ai_add¾’
,
backlog
è=ğ
ANET_ERR
è
”rÜ
;

486 
’d
;

488 ià(
p
 =ğ
NULL
) {

489 
	`ª‘S‘E¼Ü
(
”r
, "uÇbËØbšd sock‘,ƒ¼no: %d", 
”ºo
);

490 
”rÜ
;

493 
”rÜ
:

494 
s
 = 
ANET_ERR
;

495 
’d
:

496 
	`ä“addršfo
(
£rvšfo
);

497  
s
;

498 
	}
}

500 
	$ª‘TıS”v”
(*
”r
, 
pÜt
, *
bšdaddr
, 
backlog
)

502  
	`_ª‘TıS”v”
(
”r
, 
pÜt
, 
bšdaddr
, 
AF_INET
, 
backlog
);

503 
	}
}

505 
	$ª‘Tı6S”v”
(*
”r
, 
pÜt
, *
bšdaddr
, 
backlog
)

507  
	`_ª‘TıS”v”
(
”r
, 
pÜt
, 
bšdaddr
, 
AF_INET6
, 
backlog
);

508 
	}
}

510 
	$ª‘UnixS”v”
(*
”r
, *
·th
, 
mode_t
 
³rm
, 
backlog
)

512 
s
;

513 
sockaddr_un
 
§
;

515 ià((
s
 = 
	`ª‘C»©eSock‘
(
”r
,
AF_LOCAL
)è=ğ
ANET_ERR
)

516  
ANET_ERR
;

518 
	`mem£t
(&
§
,0,(sa));

519 
§
.
sun_çmy
 = 
AF_LOCAL
;

520 
	`¡ºıy
(
§
.
sun_·th
,
·th
,(sa.sun_path)-1);

521 ià(
	`ª‘Li¡’
(
”r
,
s
,(
sockaddr
*)&
§
,(§),
backlog
è=ğ
ANET_ERR
)

522  
ANET_ERR
;

523 ià(
³rm
)

524 
	`chmod
(
§
.
sun_·th
, 
³rm
);

525  
s
;

526 
	}
}

528 
	$ª‘G’”icAcû±
(*
”r
, 
s
, 
sockaddr
 *
§
, 
sockËn_t
 *
Ën
) {

529 
fd
;

531 
fd
 = 
	`acû±
(
s
,
§
,
Ën
);

532 ià(
fd
 == -1) {

533 ià(
”ºo
 =ğ
EINTR
)

536 
	`ª‘S‘E¼Ü
(
”r
, "acû±: %s", 
	`¡»¼Ü
(
”ºo
));

537  
ANET_ERR
;

542  
fd
;

543 
	}
}

545 
	$ª‘TıAcû±
(*
”r
, 
s
, *

, 
size_t
 
_Ën
, *
pÜt
) {

546 
fd
;

547 
sockaddr_¡Üage
 
§
;

548 
sockËn_t
 
§Ën
 = (
§
);

549 ià((
fd
 = 
	`ª‘G’”icAcû±
(
”r
,
s
,(
sockaddr
*)&
§
,&
§Ën
)) == -1)

550  
ANET_ERR
;

552 ià(
§
.
ss_çmy
 =ğ
AF_INET
) {

553 
sockaddr_š
 *
s
 = (sockaddr_š *)&
§
;

554 ià(

è
	`š‘_Áİ
(
AF_INET
,(*)&(
s
->
sš_addr
),,
_Ën
);

555 ià(
pÜt
è*pÜˆğ
	`Áohs
(
s
->
sš_pÜt
);

557 
sockaddr_š6
 *
s
 = (sockaddr_š6 *)&
§
;

558 ià(

è
	`š‘_Áİ
(
AF_INET6
,(*)&(
s
->
sš6_addr
),,
_Ën
);

559 ià(
pÜt
è*pÜˆğ
	`Áohs
(
s
->
sš6_pÜt
);

561  
fd
;

562 
	}
}

564 
	$ª‘UnixAcû±
(*
”r
, 
s
) {

565 
fd
;

566 
sockaddr_un
 
§
;

567 
sockËn_t
 
§Ën
 = (
§
);

568 ià((
fd
 = 
	`ª‘G’”icAcû±
(
”r
,
s
,(
sockaddr
*)&
§
,&
§Ën
)) == -1)

569  
ANET_ERR
;

571  
fd
;

572 
	}
}

574 
	$ª‘P“rToSŒšg
(
fd
, *

, 
size_t
 
_Ën
, *
pÜt
) {

575 
sockaddr_¡Üage
 
§
;

576 
sockËn_t
 
§Ën
 = (
§
);

578 ià(
	`g‘³”Çme
(
fd
,(
sockaddr
*)&
§
,&
§Ën
è=ğ-1è
”rÜ
;

579 ià(
_Ën
 =ğ0è
”rÜ
;

581 ià(
§
.
ss_çmy
 =ğ
AF_INET
) {

582 
sockaddr_š
 *
s
 = (sockaddr_š *)&
§
;

583 ià(

è
	`š‘_Áİ
(
AF_INET
,(*)&(
s
->
sš_addr
),,
_Ën
);

584 ià(
pÜt
è*pÜˆğ
	`Áohs
(
s
->
sš_pÜt
);

585 } ià(
§
.
ss_çmy
 =ğ
AF_INET6
) {

586 
sockaddr_š6
 *
s
 = (sockaddr_š6 *)&
§
;

587 ià(

è
	`š‘_Áİ
(
AF_INET6
,(*)&(
s
->
sš6_addr
),,
_Ën
);

588 ià(
pÜt
è*pÜˆğ
	`Áohs
(
s
->
sš6_pÜt
);

589 } ià(
§
.
ss_çmy
 =ğ
AF_UNIX
) {

590 ià(

è
	`¡ºıy
(,"/unixsock‘",
_Ën
);

591 ià(
pÜt
) *port = 0;

593 
”rÜ
;

597 
”rÜ
:

598 ià(

) {

599 ià(
_Ën
 >= 2) {

600 

[0] = '?';

601 

[1] = '\0';

602 } ià(
_Ën
 == 1) {

603 

[0] = '\0';

606 ià(
pÜt
) *port = 0;

608 
	}
}

613 
	$ª‘FÜm©Addr
(*
buf
, 
size_t
 
buf_Ën
, *

, 
pÜt
) {

614  
	`¢´štf
(
buf
,
buf_Ën
, 
	`¡rchr
(

,':') ?

615 "[%s]:%d" : "%s:%d", 

, 
pÜt
);

616 
	}
}

619 
	$ª‘FÜm©P“r
(
fd
, *
buf
, 
size_t
 
buf_Ën
) {

620 

[
INET6_ADDRSTRLEN
];

621 
pÜt
;

623 
	`ª‘P“rToSŒšg
(
fd
,

,(),&
pÜt
);

624  
	`ª‘FÜm©Addr
(
buf
, 
buf_Ën
, 

, 
pÜt
);

625 
	}
}

627 
	$ª‘SockName
(
fd
, *

, 
size_t
 
_Ën
, *
pÜt
) {

628 
sockaddr_¡Üage
 
§
;

629 
sockËn_t
 
§Ën
 = (
§
);

631 ià(
	`g‘sockÇme
(
fd
,(
sockaddr
*)&
§
,&
§Ën
) == -1) {

632 ià(
pÜt
) *port = 0;

633 

[0] = '?';

634 

[1] = '\0';

637 ià(
§
.
ss_çmy
 =ğ
AF_INET
) {

638 
sockaddr_š
 *
s
 = (sockaddr_š *)&
§
;

639 ià(

è
	`š‘_Áİ
(
AF_INET
,(*)&(
s
->
sš_addr
),,
_Ën
);

640 ià(
pÜt
è*pÜˆğ
	`Áohs
(
s
->
sš_pÜt
);

642 
sockaddr_š6
 *
s
 = (sockaddr_š6 *)&
§
;

643 ià(

è
	`š‘_Áİ
(
AF_INET6
,(*)&(
s
->
sš6_addr
),,
_Ën
);

644 ià(
pÜt
è*pÜˆğ
	`Áohs
(
s
->
sš6_pÜt
);

647 
	}
}

649 
	$ª‘FÜm©Sock
(
fd
, *
fmt
, 
size_t
 
fmt_Ën
) {

650 

[
INET6_ADDRSTRLEN
];

651 
pÜt
;

653 
	`ª‘SockName
(
fd
,

,(),&
pÜt
);

654  
	`ª‘FÜm©Addr
(
fmt
, 
fmt_Ën
, 

, 
pÜt
);

655 
	}
}

	@src/anet.h

31 #iâdeà
ANET_H


32 
	#ANET_H


	)

34 
	~<sys/ty³s.h
>

36 
	#ANET_OK
 0

	)

37 
	#ANET_ERR
 -1

	)

38 
	#ANET_ERR_LEN
 256

	)

41 
	#ANET_NONE
 0

	)

42 
	#ANET_IP_ONLY
 (1<<0)

	)

44 #ià
defšed
(
__sun
è|| defšed(
_AIX
)

45 
	#AF_LOCAL
 
AF_UNIX


	)

48 #ifdeà
_AIX


49 #undeà
_Ën


52 
ª‘TıCÚÃù
(*
”r
, *
addr
, 
pÜt
);

53 
ª‘TıNÚBlockCÚÃù
(*
”r
, *
addr
, 
pÜt
);

54 
ª‘TıNÚBlockBšdCÚÃù
(*
”r
, *
addr
, 
pÜt
, *
sourû_addr
);

55 
ª‘TıNÚBlockBe¡EffÜtBšdCÚÃù
(*
”r
, *
addr
, 
pÜt
, *
sourû_addr
);

56 
ª‘UnixCÚÃù
(*
”r
, *
·th
);

57 
ª‘UnixNÚBlockCÚÃù
(*
”r
, *
·th
);

58 
ª‘R—d
(
fd
, *
buf
, 
couÁ
);

59 
ª‘ResŞve
(*
”r
, *
ho¡
, *
buf
, 
size_t
 
buf_Ën
);

60 
ª‘ResŞveIP
(*
”r
, *
ho¡
, *
buf
, 
size_t
 
buf_Ën
);

61 
ª‘TıS”v”
(*
”r
, 
pÜt
, *
bšdaddr
, 
backlog
);

62 
ª‘Tı6S”v”
(*
”r
, 
pÜt
, *
bšdaddr
, 
backlog
);

63 
ª‘UnixS”v”
(*
”r
, *
·th
, 
mode_t
 
³rm
, 
backlog
);

64 
ª‘TıAcû±
(*
”r
, 
£rv”sock
, *

, 
size_t
 
_Ën
, *
pÜt
);

65 
ª‘UnixAcû±
(*
”r
, 
£rv”sock
);

66 
ª‘Wr™e
(
fd
, *
buf
, 
couÁ
);

67 
ª‘NÚBlock
(*
”r
, 
fd
);

68 
ª‘Block
(*
”r
, 
fd
);

69 
ª‘EÇbËTıNoD–ay
(*
”r
, 
fd
);

70 
ª‘Di§bËTıNoD–ay
(*
”r
, 
fd
);

71 
ª‘TıK“pAlive
(*
”r
, 
fd
);

72 
ª‘S’dTimeout
(*
”r
, 
fd
, 
ms
);

73 
ª‘P“rToSŒšg
(
fd
, *

, 
size_t
 
_Ën
, *
pÜt
);

74 
ª‘K“pAlive
(*
”r
, 
fd
, 
š‹rv®
);

75 
ª‘SockName
(
fd
, *

, 
size_t
 
_Ën
, *
pÜt
);

76 
ª‘FÜm©Addr
(*
fmt
, 
size_t
 
fmt_Ën
, *

, 
pÜt
);

77 
ª‘FÜm©P“r
(
fd
, *
fmt
, 
size_t
 
fmt_Ën
);

78 
ª‘FÜm©Sock
(
fd
, *
fmt
, 
size_t
 
fmt_Ën
);

	@src/aof.c

30 
	~"£rv”.h
"

31 
	~"bio.h
"

32 
	~"rio.h
"

34 
	~<sigÇl.h
>

35 
	~<fú.h
>

36 
	~<sys/¡©.h
>

37 
	~<sys/ty³s.h
>

38 
	~<sys/time.h
>

39 
	~<sys/»sourû.h
>

40 
	~<sys/wa™.h
>

41 
	~<sys/·¿m.h
>

43 
aofUpd©eCu¼’tSize
();

44 
aofClo£Pes
();

60 
	#AOF_RW_BUF_BLOCK_SIZE
 (1024*1024*10è

	)

62 
	saoäwblock
 {

63 
	mu£d
, 
	mä“
;

64 
	mbuf
[
AOF_RW_BUF_BLOCK_SIZE
];

65 } 
	taoäwblock
;

70 
	$aofRewr™eBufãrRe£t
() {

71 ià(
£rv”
.
aof_»wr™e_buf_blocks
)

72 
	`li¡R–—£
(
£rv”
.
aof_»wr™e_buf_blocks
);

74 
£rv”
.
aof_»wr™e_buf_blocks
 = 
	`li¡C»©e
();

75 
	`li¡S‘F»eM‘hod
(
£rv”
.
aof_»wr™e_buf_blocks
,
zä“
);

76 
	}
}

79 
	$aofRewr™eBufãrSize
() {

80 
li¡Node
 *
Ê
;

81 
li¡I‹r
 
li
;

82 
size
 = 0;

84 
	`li¡Rewšd
(
£rv”
.
aof_»wr™e_buf_blocks
,&
li
);

85 (
Ê
 = 
	`li¡Next
(&
li
))) {

86 
aoäwblock
 *
block
 = 
	`li¡NodeV®ue
(
Ê
);

87 
size
 +ğ
block
->
u£d
;

89  
size
;

90 
	}
}

95 
	$aofChdWr™eDiffD©a
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

96 
li¡Node
 *
Ê
;

97 
aoäwblock
 *
block
;

98 
ssize_t
 
nwr™‹n
;

99 
	`UNUSED
(
–
);

100 
	`UNUSED
(
fd
);

101 
	`UNUSED
(
´ivd©a
);

102 
	`UNUSED
(
mask
);

105 
Ê
 = 
	`li¡Fœ¡
(
£rv”
.
aof_»wr™e_buf_blocks
);

106 
block
 = 
Ê
 ?†n->
v®ue
 : 
NULL
;

107 ià(
£rv”
.
aof_¡İ_£ndšg_diff
 || !
block
) {

108 
	`«D–‘eFeEv’t
(
£rv”
.
–
,£rv”.
aof_pe_wr™e_d©a_to_chd
,

109 
AE_WRITABLE
);

112 ià(
block
->
u£d
 > 0) {

113 
nwr™‹n
 = 
	`wr™e
(
£rv”
.
aof_pe_wr™e_d©a_to_chd
,

114 
block
->
buf
,block->
u£d
);

115 ià(
nwr™‹n
 <= 0) ;

116 
	`memmove
(
block
->
buf
,block->buf+
nwr™‹n
,block->
u£d
-nwritten);

117 
block
->
u£d
 -ğ
nwr™‹n
;

119 ià(
block
->
u£d
 =ğ0è
	`li¡D–Node
(
£rv”
.
aof_»wr™e_buf_blocks
,
Ê
);

121 
	}
}

124 
	$aofRewr™eBufãrAµ’d
(*
s
, 
Ën
) {

125 
li¡Node
 *
Ê
 = 
	`li¡La¡
(
£rv”
.
aof_»wr™e_buf_blocks
);

126 
aoäwblock
 *
block
 = 
Ê
 ?†n->
v®ue
 : 
NULL
;

128 
Ën
) {

131 ià(
block
) {

132 
thi¦’
 = (
block
->
ä“
 < 
Ën
) ? block->free :†en;

133 ià(
thi¦’
) {

134 
	`memıy
(
block
->
buf
+block->
u£d
, 
s
, 
thi¦’
);

135 
block
->
u£d
 +ğ
thi¦’
;

136 
block
->
ä“
 -ğ
thi¦’
;

137 
s
 +ğ
thi¦’
;

138 
Ën
 -ğ
thi¦’
;

142 ià(
Ën
) {

143 
numblocks
;

145 
block
 = 
	`zm®loc
((*block));

146 
block
->
ä“
 = 
AOF_RW_BUF_BLOCK_SIZE
;

147 
block
->
u£d
 = 0;

148 
	`li¡AddNodeTa
(
£rv”
.
aof_»wr™e_buf_blocks
,
block
);

152 
numblocks
 = 
	`li¡L’gth
(
£rv”
.
aof_»wr™e_buf_blocks
);

153 ià(((
numblocks
+1) % 10) == 0) {

154 
Ëv–
 = ((
numblocks
+1è% 100è=ğ0 ? 
LL_WARNING
 :

155 
LL_NOTICE
;

156 
	`£rv”Log
(
Ëv–
,"Background AOF buffer size: %lu MB",

157 
	`aofRewr™eBufãrSize
()/(1024*1024));

164 ià(
	`«G‘FeEv’ts
(
£rv”
.
–
,£rv”.
aof_pe_wr™e_d©a_to_chd
) == 0) {

165 
	`«C»©eFeEv’t
(
£rv”
.
–
, s”v”.
aof_pe_wr™e_d©a_to_chd
,

166 
AE_WRITABLE
, 
aofChdWr™eDiffD©a
, 
NULL
);

168 
	}
}

173 
ssize_t
 
	$aofRewr™eBufãrWr™e
(
fd
) {

174 
li¡Node
 *
Ê
;

175 
li¡I‹r
 
li
;

176 
ssize_t
 
couÁ
 = 0;

178 
	`li¡Rewšd
(
£rv”
.
aof_»wr™e_buf_blocks
,&
li
);

179 (
Ê
 = 
	`li¡Next
(&
li
))) {

180 
aoäwblock
 *
block
 = 
	`li¡NodeV®ue
(
Ê
);

181 
ssize_t
 
nwr™‹n
;

183 ià(
block
->
u£d
) {

184 
nwr™‹n
 = 
	`wr™e
(
fd
,
block
->
buf
,block->
u£d
);

185 ià(
nwr™‹n
 !ğ(
ssize_t
)
block
->
u£d
) {

186 ià(
nwr™‹n
 =ğ0è
”ºo
 = 
EIO
;

189 
couÁ
 +ğ
nwr™‹n
;

192  
couÁ
;

193 
	}
}

201 
	$aof_background_fsync
(
fd
) {

202 
	`bioC»©eBackgroundJob
(
BIO_AOF_FSYNC
,(*)()
fd
,
NULL
,NULL);

203 
	}
}

207 
	$¡İAµ’dOÆy
() {

208 
	`£rv”As£¹
(
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
);

209 
	`æushAµ’dOÆyFe
(1);

210 
	`aof_fsync
(
£rv”
.
aof_fd
);

211 
	`şo£
(
£rv”
.
aof_fd
);

213 
£rv”
.
aof_fd
 = -1;

214 
£rv”
.
aof_£Ëùed_db
 = -1;

215 
£rv”
.
aof_¡©e
 = 
AOF_OFF
;

217 ià(
£rv”
.
aof_chd_pid
 != -1) {

218 
¡©loc
;

220 
	`£rv”Log
(
LL_NOTICE
,"Killing„unning AOF„ewrite child: %ld",

221 (è
£rv”
.
aof_chd_pid
);

222 ià(
	`kl
(
£rv”
.
aof_chd_pid
,
SIGUSR1
) != -1) {

223 
	`wa™3
(&
¡©loc
,0,
NULL
è!ğ
£rv”
.
aof_chd_pid
);

226 
	`aofRewr™eBufãrRe£t
();

227 
	`aofRemoveTempFe
(
£rv”
.
aof_chd_pid
);

228 
£rv”
.
aof_chd_pid
 = -1;

229 
£rv”
.
aof_»wr™e_time_¡¬t
 = -1;

231 
	`aofClo£Pes
();

233 
	}
}

237 
	$¡¬tAµ’dOÆy
() {

238 
cwd
[
MAXPATHLEN
];

240 
£rv”
.
aof_Ï¡_fsync
 = s”v”.
unixtime
;

241 
£rv”
.
aof_fd
 = 
	`İ’
(£rv”.
aof_f’ame
,
O_WRONLY
|
O_APPEND
|
O_CREAT
,0644);

242 
	`£rv”As£¹
(
£rv”
.
aof_¡©e
 =ğ
AOF_OFF
);

243 ià(
£rv”
.
aof_fd
 == -1) {

244 *
cwdp
 = 
	`g‘cwd
(
cwd
,
MAXPATHLEN
);

246 
	`£rv”Log
(
LL_WARNING
,

249 
£rv”
.
aof_f’ame
,

250 
cwdp
 ? cwdp : "unknown",

251 
	`¡»¼Ü
(
”ºo
));

252  
C_ERR
;

254 ià(
£rv”
.
rdb_chd_pid
 != -1) {

255 
£rv”
.
aof_»wr™e_scheduËd
 = 1;

256 
	`£rv”Log
(
LL_WARNING
,"AOF wasƒnabled buthere is‡lready‡ child…rocess saving‡n RDB file on disk. An AOF background was scheduledo start when…ossible.");

257 } ià(
	`»wr™eAµ’dOÆyFeBackground
(è=ğ
C_ERR
) {

258 
	`şo£
(
£rv”
.
aof_fd
);

259 
	`£rv”Log
(
LL_WARNING
,"Redis‚eedsoƒnablehe AOF but can'trigger‡ background AOF„ewrite operation. Checkhe‡bove†ogs for more info‡boutheƒrror.");

260  
C_ERR
;

264 
£rv”
.
aof_¡©e
 = 
AOF_WAIT_REWRITE
;

265  
C_OK
;

266 
	}
}

286 
	#AOF_WRITE_LOG_ERROR_RATE
 30

	)

287 
	$æushAµ’dOÆyFe
(
fÜû
) {

288 
ssize_t
 
nwr™‹n
;

289 
sync_š_´og»ss
 = 0;

290 
m¡ime_t
 
Ï‹ncy
;

292 ià(
	`sd¦’
(
£rv”
.
aof_buf
) == 0) ;

294 ià(
£rv”
.
aof_fsync
 =ğ
AOF_FSYNC_EVERYSEC
)

295 
sync_š_´og»ss
 = 
	`bioP’dšgJobsOfTy³
(
BIO_AOF_FSYNC
) != 0;

297 ià(
£rv”
.
aof_fsync
 =ğ
AOF_FSYNC_EVERYSEC
 && !
fÜû
) {

301 ià(
sync_š_´og»ss
) {

302 ià(
£rv”
.
aof_æush_po¡pÚed_¡¬t
 == 0) {

305 
£rv”
.
aof_æush_po¡pÚed_¡¬t
 = s”v”.
unixtime
;

307 } ià(
£rv”
.
unixtime
 - s”v”.
aof_æush_po¡pÚed_¡¬t
 < 2) {

314 
£rv”
.
aof_d–ayed_fsync
++;

315 
	`£rv”Log
(
LL_NOTICE
,"Asynchronous AOF fsync isakingoo†ong (disk is busy?). Writinghe AOF buffer without waiting for fsynco complete,his may slow down Redis.");

324 
	`Ï‹ncyS¹MÚ™Ü
(
Ï‹ncy
);

325 
nwr™‹n
 = 
	`wr™e
(
£rv”
.
aof_fd
,£rv”.
aof_buf
,
	`sd¦’
(server.aof_buf));

326 
	`Ï‹ncyEndMÚ™Ü
(
Ï‹ncy
);

332 ià(
sync_š_´og»ss
) {

333 
	`Ï‹ncyAddSam¶eIfN“ded
("aof-wr™e-³ndšg-fsync",
Ï‹ncy
);

334 } ià(
£rv”
.
aof_chd_pid
 !ğ-1 || s”v”.
rdb_chd_pid
 != -1) {

335 
	`Ï‹ncyAddSam¶eIfN“ded
("aof-wr™e-aùive-chd",
Ï‹ncy
);

337 
	`Ï‹ncyAddSam¶eIfN“ded
("aof-wr™e-®Úe",
Ï‹ncy
);

339 
	`Ï‹ncyAddSam¶eIfN“ded
("aof-wr™e",
Ï‹ncy
);

342 
£rv”
.
aof_æush_po¡pÚed_¡¬t
 = 0;

344 ià(
nwr™‹n
 !ğ(sigÃd)
	`sd¦’
(
£rv”
.
aof_buf
)) {

345 
time_t
 
Ï¡_wr™e_”rÜ_log
 = 0;

346 
ÿn_log
 = 0;

349 ià((
£rv”
.
unixtime
 - 
Ï¡_wr™e_”rÜ_log
è> 
AOF_WRITE_LOG_ERROR_RATE
) {

350 
ÿn_log
 = 1;

351 
Ï¡_wr™e_”rÜ_log
 = 
£rv”
.
unixtime
;

355 ià(
nwr™‹n
 == -1) {

356 ià(
ÿn_log
) {

357 
	`£rv”Log
(
LL_WARNING
,"Error writingohe AOF file: %s",

358 
	`¡»¼Ü
(
”ºo
));

359 
£rv”
.
aof_Ï¡_wr™e_”ºo
 = 
”ºo
;

362 ià(
ÿn_log
) {

363 
	`£rv”Log
(
LL_WARNING
,"Short write while writingo "

366 ()
nwr™‹n
,

367 ()
	`sd¦’
(
£rv”
.
aof_buf
));

370 ià(
	`árunÿ‹
(
£rv”
.
aof_fd
, s”v”.
aof_cu¼’t_size
) == -1) {

371 ià(
ÿn_log
) {

372 
	`£rv”Log
(
LL_WARNING
, "Could‚ot„emove short write "

375 "árunÿ‹: %s", 
	`¡»¼Ü
(
”ºo
));

380 
nwr™‹n
 = -1;

382 
£rv”
.
aof_Ï¡_wr™e_”ºo
 = 
ENOSPC
;

386 ià(
£rv”
.
aof_fsync
 =ğ
AOF_FSYNC_ALWAYS
) {

391 
	`£rv”Log
(
LL_WARNING
,"Can't„ecover from AOF writeƒrror whenhe AOF fsync…olicy is 'always'. Exiting...");

392 
	`ex™
(1);

397 
£rv”
.
aof_Ï¡_wr™e_¡©us
 = 
C_ERR
;

401 ià(
nwr™‹n
 > 0) {

402 
£rv”
.
aof_cu¼’t_size
 +ğ
nwr™‹n
;

403 
	`sd¤ªge
(
£rv”
.
aof_buf
,
nwr™‹n
,-1);

410 ià(
£rv”
.
aof_Ï¡_wr™e_¡©us
 =ğ
C_ERR
) {

411 
	`£rv”Log
(
LL_WARNING
,

413 
£rv”
.
aof_Ï¡_wr™e_¡©us
 = 
C_OK
;

416 
£rv”
.
aof_cu¼’t_size
 +ğ
nwr™‹n
;

420 ià((
	`sd¦’
(
£rv”
.
aof_buf
)+
	`sd§va
(server.aof_buf)) < 4000) {

421 
	`sdsş—r
(
£rv”
.
aof_buf
);

423 
	`sdsä“
(
£rv”
.
aof_buf
);

424 
£rv”
.
aof_buf
 = 
	`sd£m±y
();

429 ià(
£rv”
.
aof_no_fsync_Ú_»wr™e
 &&

430 (
£rv”
.
aof_chd_pid
 !ğ-1 || s”v”.
rdb_chd_pid
 != -1))

434 ià(
£rv”
.
aof_fsync
 =ğ
AOF_FSYNC_ALWAYS
) {

437 
	`Ï‹ncyS¹MÚ™Ü
(
Ï‹ncy
);

438 
	`aof_fsync
(
£rv”
.
aof_fd
);

439 
	`Ï‹ncyEndMÚ™Ü
(
Ï‹ncy
);

440 
	`Ï‹ncyAddSam¶eIfN“ded
("aof-fsync-®ways",
Ï‹ncy
);

441 
£rv”
.
aof_Ï¡_fsync
 = s”v”.
unixtime
;

442 } ià((
£rv”
.
aof_fsync
 =ğ
AOF_FSYNC_EVERYSEC
 &&

443 
£rv”
.
unixtime
 > s”v”.
aof_Ï¡_fsync
)) {

444 ià(!
sync_š_´og»ss
è
	`aof_background_fsync
(
£rv”
.
aof_fd
);

445 
£rv”
.
aof_Ï¡_fsync
 = s”v”.
unixtime
;

447 
	}
}

449 
sds
 
	$ÿtAµ’dOÆyG’”icCommªd
(
sds
 
d¡
, 
¬gc
, 
robj
 **
¬gv
) {

450 
buf
[32];

451 
Ën
, 
j
;

452 
robj
 *
o
;

454 
buf
[0] = '*';

455 
Ën
 = 1+
	`Î2¡ršg
(
buf
+1,(buf)-1,
¬gc
);

456 
buf
[
Ën
++] = '\r';

457 
buf
[
Ën
++] = '\n';

458 
d¡
 = 
	`sdsÿ’
(d¡,
buf
,
Ën
);

460 
j
 = 0; j < 
¬gc
; j++) {

461 
o
 = 
	`g‘DecodedObjeù
(
¬gv
[
j
]);

462 
buf
[0] = '$';

463 
Ën
 = 1+
	`Î2¡ršg
(
buf
+1,(buf)-1,
	`sd¦’
(
o
->
±r
));

464 
buf
[
Ën
++] = '\r';

465 
buf
[
Ën
++] = '\n';

466 
d¡
 = 
	`sdsÿ’
(d¡,
buf
,
Ën
);

467 
d¡
 = 
	`sdsÿ’
(d¡,
o
->
±r
,
	`sd¦’
(o->ptr));

468 
d¡
 = 
	`sdsÿ’
(dst,"\r\n",2);

469 
	`deüRefCouÁ
(
o
);

471  
d¡
;

472 
	}
}

481 
sds
 
	$ÿtAµ’dOÆyExpœeAtCommªd
(
sds
 
buf
, 
»disCommªd
 *
cmd
, 
robj
 *
key
,„obj *
£cÚds
) {

482 
wh’
;

483 
robj
 *
¬gv
[3];

486 
£cÚds
 = 
	`g‘DecodedObjeù
(seconds);

487 
wh’
 = 
	`¡¹Şl
(
£cÚds
->
±r
,
NULL
,10);

489 ià(
cmd
->
´oc
 =ğ
expœeCommªd
 || cmd->´oø=ğ
£‹xCommªd
 ||

490 
cmd
->
´oc
 =ğ
expœ—tCommªd
)

492 
wh’
 *= 1000;

495 ià(
cmd
->
´oc
 =ğ
expœeCommªd
 || cmd->´oø=ğ
³xpœeCommªd
 ||

496 
cmd
->
´oc
 =ğ
£‹xCommªd
 || cmd->´oø=ğ
p£‹xCommªd
)

498 
wh’
 +ğ
	`m¡ime
();

500 
	`deüRefCouÁ
(
£cÚds
);

502 
¬gv
[0] = 
	`ü—‹SŒšgObjeù
("PEXPIREAT",9);

503 
¬gv
[1] = 
key
;

504 
¬gv
[2] = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
wh’
);

505 
buf
 = 
	`ÿtAµ’dOÆyG’”icCommªd
(buf, 3, 
¬gv
);

506 
	`deüRefCouÁ
(
¬gv
[0]);

507 
	`deüRefCouÁ
(
¬gv
[2]);

508  
buf
;

509 
	}
}

511 
	$ãedAµ’dOÆyFe
(
»disCommªd
 *
cmd
, 
diùid
, 
robj
 **
¬gv
, 
¬gc
) {

512 
sds
 
buf
 = 
	`sd£m±y
();

513 
robj
 *
tm·rgv
[3];

517 ià(
diùid
 !ğ
£rv”
.
aof_£Ëùed_db
) {

518 
£ldb
[64];

520 
	`¢´štf
(
£ldb
,(£ldb),"%d",
diùid
);

521 
buf
 = 
	`sdsÿrštf
(buf,"*2\r\n$6\r\nSELECT\r\n$%lu\r\n%s\r\n",

522 ()
	`¡¾’
(
£ldb
),seldb);

523 
£rv”
.
aof_£Ëùed_db
 = 
diùid
;

526 ià(
cmd
->
´oc
 =ğ
expœeCommªd
 || cmd->´oø=ğ
³xpœeCommªd
 ||

527 
cmd
->
´oc
 =ğ
expœ—tCommªd
) {

529 
buf
 = 
	`ÿtAµ’dOÆyExpœeAtCommªd
(buf,
cmd
,
¬gv
[1],argv[2]);

530 } ià(
cmd
->
´oc
 =ğ
£‹xCommªd
 || cmd->´oø=ğ
p£‹xCommªd
) {

532 
tm·rgv
[0] = 
	`ü—‹SŒšgObjeù
("SET",3);

533 
tm·rgv
[1] = 
¬gv
[1];

534 
tm·rgv
[2] = 
¬gv
[3];

535 
buf
 = 
	`ÿtAµ’dOÆyG’”icCommªd
(buf,3,
tm·rgv
);

536 
	`deüRefCouÁ
(
tm·rgv
[0]);

537 
buf
 = 
	`ÿtAµ’dOÆyExpœeAtCommªd
(buf,
cmd
,
¬gv
[1],argv[2]);

542 
buf
 = 
	`ÿtAµ’dOÆyG’”icCommªd
(buf,
¬gc
,
¬gv
);

548 ià(
£rv”
.
aof_¡©e
 =ğ
AOF_ON
)

549 
£rv”
.
aof_buf
 = 
	`sdsÿ’
(£rv”.aof_buf,
buf
,
	`sd¦’
(buf));

555 ià(
£rv”
.
aof_chd_pid
 != -1)

556 
	`aofRewr™eBufãrAµ’d
((*)
buf
,
	`sd¦’
(buf));

558 
	`sdsä“
(
buf
);

559 
	}
}

567 
ş›Á
 *
	$ü—‹FakeCl›Á
() {

568 
ş›Á
 *
c
 = 
	`zm®loc
((*c));

570 
	`£ËùDb
(
c
,0);

571 
c
->
fd
 = -1;

572 
c
->
Çme
 = 
NULL
;

573 
c
->
qu”ybuf
 = 
	`sd£m±y
();

574 
c
->
qu”ybuf_³ak
 = 0;

575 
c
->
¬gc
 = 0;

576 
c
->
¬gv
 = 
NULL
;

577 
c
->
buåos
 = 0;

578 
c
->
æags
 = 0;

579 
c
->
bty³
 = 
BLOCKED_NONE
;

582 
c
->
»¶¡©e
 = 
SLAVE_STATE_WAIT_BGSAVE_START
;

583 
c
->
»¶y
 = 
	`li¡C»©e
();

584 
c
->
»¶y_by‹s
 = 0;

585 
c
->
obuf_soá_lim™_»ached_time
 = 0;

586 
c
->
w©ched_keys
 = 
	`li¡C»©e
();

587 
c
->
³”id
 = 
NULL
;

588 
	`li¡S‘F»eM‘hod
(
c
->
»¶y
,
deüRefCouÁVoid
);

589 
	`li¡S‘DupM‘hod
(
c
->
»¶y
,
dupCl›ÁR•lyV®ue
);

590 
	`š™Cl›ÁMuÉiS‹
(
c
);

591  
c
;

592 
	}
}

594 
	$ä“FakeCl›ÁArgv
(
ş›Á
 *
c
) {

595 
j
;

597 
j
 = 0; j < 
c
->
¬gc
; j++)

598 
	`deüRefCouÁ
(
c
->
¬gv
[
j
]);

599 
	`zä“
(
c
->
¬gv
);

600 
	}
}

602 
	$ä“FakeCl›Á
(
ş›Á
 *
c
) {

603 
	`sdsä“
(
c
->
qu”ybuf
);

604 
	`li¡R–—£
(
c
->
»¶y
);

605 
	`li¡R–—£
(
c
->
w©ched_keys
);

606 
	`ä“Cl›ÁMuÉiS‹
(
c
);

607 
	`zä“
(
c
);

608 
	}
}

613 
	$lßdAµ’dOÆyFe
(*
f’ame
) {

614 
ş›Á
 *
çkeCl›Á
;

615 
FILE
 *
å
 = 
	`fİ’
(
f’ame
,"r");

616 
»dis_¡©
 
sb
;

617 
Şd_aof_¡©e
 = 
£rv”
.
aof_¡©e
;

618 
loİs
 = 0;

619 
off_t
 
v®id_up_to
 = 0;

621 ià(
å
 && 
	`»dis_f¡©
(
	`f’o
(å),&
sb
è!ğ-1 && sb.
¡_size
 == 0) {

622 
£rv”
.
aof_cu¼’t_size
 = 0;

623 
	`fşo£
(
å
);

624  
C_ERR
;

627 ià(
å
 =ğ
NULL
) {

628 
	`£rv”Log
(
LL_WARNING
,"F©®ƒ¼Ü: cª'ˆİ’h­³nd†og ffÜ„—dšg: %s",
	`¡»¼Ü
(
”ºo
));

629 
	`ex™
(1);

634 
£rv”
.
aof_¡©e
 = 
AOF_OFF
;

636 
çkeCl›Á
 = 
	`ü—‹FakeCl›Á
();

637 
	`¡¬tLßdšg
(
å
);

640 
¬gc
, 
j
;

641 
Ën
;

642 
robj
 **
¬gv
;

643 
buf
[128];

644 
sds
 
¬gsds
;

645 
»disCommªd
 *
cmd
;

648 ià(!(
loİs
++ % 1000)) {

649 
	`lßdšgProg»ss
(
	`á–lo
(
å
));

650 
	`´oûssEv’tsWheBlocked
();

653 ià(
	`fg‘s
(
buf
,(buf),
å
è=ğ
NULL
) {

654 ià(
	`ãof
(
å
))

657 
»ad”r
;

659 ià(
buf
[0] !ğ'*'è
fm‹¼
;

660 ià(
buf
[1] =ğ'\0'è
»ad”r
;

661 
¬gc
 = 
	`©oi
(
buf
+1);

662 ià(
¬gc
 < 1è
fm‹¼
;

664 
¬gv
 = 
	`zm®loc
((
robj
*)*
¬gc
);

665 
çkeCl›Á
->
¬gc
 =‡rgc;

666 
çkeCl›Á
->
¬gv
 =‡rgv;

668 
j
 = 0; j < 
¬gc
; j++) {

669 ià(
	`fg‘s
(
buf
,(buf),
å
è=ğ
NULL
) {

670 
çkeCl›Á
->
¬gc
 = 
j
;

671 
	`ä“FakeCl›ÁArgv
(
çkeCl›Á
);

672 
»ad”r
;

674 ià(
buf
[0] !ğ'$'è
fm‹¼
;

675 
Ën
 = 
	`¡¹Ş
(
buf
+1,
NULL
,10);

676 
¬gsds
 = 
	`sd¢ewËn
(
NULL
,
Ën
);

677 ià(
Ën
 && 
	`ä—d
(
¬gsds
,Ën,1,
å
) == 0) {

678 
	`sdsä“
(
¬gsds
);

679 
çkeCl›Á
->
¬gc
 = 
j
;

680 
	`ä“FakeCl›ÁArgv
(
çkeCl›Á
);

681 
»ad”r
;

683 
¬gv
[
j
] = 
	`ü—‹Objeù
(
OBJ_STRING
,
¬gsds
);

684 ià(
	`ä—d
(
buf
,2,1,
å
) == 0) {

685 
çkeCl›Á
->
¬gc
 = 
j
+1;

686 
	`ä“FakeCl›ÁArgv
(
çkeCl›Á
);

687 
»ad”r
;

692 
cmd
 = 
	`lookupCommªd
(
¬gv
[0]->
±r
);

693 ià(!
cmd
) {

694 
	`£rv”Log
(
LL_WARNING
,"UnknowÀcommªd '%s'„—dšgh­³nd oÆy fe", (*)
¬gv
[0]->
±r
);

695 
	`ex™
(1);

699 
cmd
->
	`´oc
(
çkeCl›Á
);

702 
	`£rv”As£¹
(
çkeCl›Á
->
buåos
 =ğ0 && 
	`li¡L’gth
(çkeCl›Á->
»¶y
) == 0);

704 
	`£rv”As£¹
((
çkeCl›Á
->
æags
 & 
CLIENT_BLOCKED
) == 0);

708 
	`ä“FakeCl›ÁArgv
(
çkeCl›Á
);

709 ià(
£rv”
.
aof_lßd_Œunÿ‹d
è
v®id_up_to
 = 
	`á–lo
(
å
);

714 ià(
çkeCl›Á
->
æags
 & 
CLIENT_MULTI
è
uxeof
;

716 
lßded_ok
:

717 
	`fşo£
(
å
);

718 
	`ä“FakeCl›Á
(
çkeCl›Á
);

719 
£rv”
.
aof_¡©e
 = 
Şd_aof_¡©e
;

720 
	`¡İLßdšg
();

721 
	`aofUpd©eCu¼’tSize
();

722 
£rv”
.
aof_»wr™e_ba£_size
 = s”v”.
aof_cu¼’t_size
;

723  
C_OK
;

725 
»ad”r
:

726 ià(!
	`ãof
(
å
)) {

727 ià(
çkeCl›Á
è
	`ä“FakeCl›Á
(fakeClient);

728 
	`£rv”Log
(
LL_WARNING
,"UÄecov”abËƒ¼Ü„—dšgh­³nd oÆy fe: %s", 
	`¡»¼Ü
(
”ºo
));

729 
	`ex™
(1);

732 
uxeof
:

733 ià(
£rv”
.
aof_lßd_Œunÿ‹d
) {

734 
	`£rv”Log
(
LL_WARNING
,"!!! Warning: short„ead while†oadinghe AOF file !!!");

735 
	`£rv”Log
(
LL_WARNING
,"!!! Truncatinghe AOF‡t offset %llu !!!",

736 (è
v®id_up_to
);

737 ià(
v®id_up_to
 =ğ-1 || 
	`Œunÿ‹
(
f’ame
,valid_up_to) == -1) {

738 ià(
v®id_up_to
 == -1) {

739 
	`£rv”Log
(
LL_WARNING
,"Last valid command offset is invalid");

741 
	`£rv”Log
(
LL_WARNING
,"Errorruncatinghe AOF file: %s",

742 
	`¡»¼Ü
(
”ºo
));

747 ià(
£rv”
.
aof_fd
 !ğ-1 && 
	`l£ek
(£rv”.aof_fd,0,
SEEK_END
) == -1) {

748 
	`£rv”Log
(
LL_WARNING
,"Can't seekheƒnd ofhe AOF file: %s",

749 
	`¡»¼Ü
(
”ºo
));

751 
	`£rv”Log
(
LL_WARNING
,

753 
lßded_ok
;

757 ià(
çkeCl›Á
è
	`ä“FakeCl›Á
(fakeClient);

758 
	`£rv”Log
(
LL_WARNING
,"Unexpectedƒnd of file„eadinghe‡ppend only file. You can: 1) Make‡ backup of your AOF file,hen use ./redis-check-aof --fix <filename>. 2) Alternatively you can sethe 'aof-load-truncated' configuration optiono yes‡nd„estarthe server.");

759 
	`ex™
(1);

761 
fm‹¼
:

762 ià(
çkeCl›Á
è
	`ä“FakeCl›Á
(fakeClient);

763 
	`£rv”Log
(
LL_WARNING
,"Bad file format„eadinghe‡ppend only file: make‡ backup of your AOF file,hen use ./redis-check-aof --fix <filename>");

764 
	`ex™
(1);

765 
	}
}

773 
	$rioWr™eBulkObjeù
(
rio
 *
r
, 
robj
 *
obj
) {

776 ià(
obj
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

777  
	`rioWr™eBulkLÚgLÚg
(
r
,()
obj
->
±r
);

778 } ià(
	`sdsEncodedObjeù
(
obj
)) {

779  
	`rioWr™eBulkSŒšg
(
r
,
obj
->
±r
,
	`sd¦’
(obj->ptr));

781 
	`£rv”Pªic
("Unknown stringƒncoding");

783 
	}
}

787 
	$»wr™eLi¡Objeù
(
rio
 *
r
, 
robj
 *
key
,„obj *
o
) {

788 
couÁ
 = 0, 
™ems
 = 
	`li¡Ty³L’gth
(
o
);

790 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

791 
quickli¡
 *
li¡
 = 
o
->
±r
;

792 
quickli¡I‹r
 *
li
 = 
	`quickli¡G‘I‹¿tÜ
(
li¡
, 
AL_START_HEAD
);

793 
quickli¡EÁry
 
’Œy
;

795 
	`quickli¡Next
(
li
,&
’Œy
)) {

796 ià(
couÁ
 == 0) {

797 
cmd_™ems
 = (
™ems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

798 
AOF_REWRITE_ITEMS_PER_CMD
 : 
™ems
;

799 ià(
	`rioWr™eBulkCouÁ
(
r
,'*',2+
cmd_™ems
) == 0)  0;

800 ià(
	`rioWr™eBulkSŒšg
(
r
,"RPUSH",5) == 0)  0;

801 ià(
	`rioWr™eBulkObjeù
(
r
,
key
) == 0)  0;

804 ià(
’Œy
.
v®ue
) {

805 ià(
	`rioWr™eBulkSŒšg
(
r
,(*)
’Œy
.
v®ue
,’Œy.
sz
) == 0)  0;

807 ià(
	`rioWr™eBulkLÚgLÚg
(
r
,
’Œy
.
lÚgv®
) == 0)  0;

809 ià(++
couÁ
 =ğ
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

810 
™ems
--;

812 
	`quickli¡R–—£I‹¿tÜ
(
li
);

814 
	`£rv”Pªic
("Unknown†istƒncoding");

817 
	}
}

821 
	$»wr™eS‘Objeù
(
rio
 *
r
, 
robj
 *
key
,„obj *
o
) {

822 
couÁ
 = 0, 
™ems
 = 
	`£tTy³Size
(
o
);

824 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

825 
ii
 = 0;

826 
št64_t
 
Îv®
;

828 
	`št£tG‘
(
o
->
±r
,
ii
++,&
Îv®
)) {

829 ià(
couÁ
 == 0) {

830 
cmd_™ems
 = (
™ems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

831 
AOF_REWRITE_ITEMS_PER_CMD
 : 
™ems
;

833 ià(
	`rioWr™eBulkCouÁ
(
r
,'*',2+
cmd_™ems
) == 0)  0;

834 ià(
	`rioWr™eBulkSŒšg
(
r
,"SADD",4) == 0)  0;

835 ià(
	`rioWr™eBulkObjeù
(
r
,
key
) == 0)  0;

837 ià(
	`rioWr™eBulkLÚgLÚg
(
r
,
Îv®
) == 0)  0;

838 ià(++
couÁ
 =ğ
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

839 
™ems
--;

841 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

842 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘I‹¿tÜ
(
o
->
±r
);

843 
diùEÁry
 *
de
;

845 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

846 
robj
 *
–eobj
 = 
	`diùG‘Key
(
de
);

847 ià(
couÁ
 == 0) {

848 
cmd_™ems
 = (
™ems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

849 
AOF_REWRITE_ITEMS_PER_CMD
 : 
™ems
;

851 ià(
	`rioWr™eBulkCouÁ
(
r
,'*',2+
cmd_™ems
) == 0)  0;

852 ià(
	`rioWr™eBulkSŒšg
(
r
,"SADD",4) == 0)  0;

853 ià(
	`rioWr™eBulkObjeù
(
r
,
key
) == 0)  0;

855 ià(
	`rioWr™eBulkObjeù
(
r
,
–eobj
) == 0)  0;

856 ià(++
couÁ
 =ğ
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

857 
™ems
--;

859 
	`diùR–—£I‹¿tÜ
(
di
);

861 
	`£rv”Pªic
("Unknown setƒncoding");

864 
	}
}

868 
	$»wr™eSÜ‹dS‘Objeù
(
rio
 *
r
, 
robj
 *
key
,„obj *
o
) {

869 
couÁ
 = 0, 
™ems
 = 
	`z£tL’gth
(
o
);

871 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

872 *
zl
 = 
o
->
±r
;

873 *
•Œ
, *
¥Œ
;

874 *
v¡r
;

875 
vËn
;

876 
vÎ
;

877 
scÜe
;

879 
•Œ
 = 
	`zli¡Index
(
zl
,0);

880 
	`£rv”As£¹
(
•Œ
 !ğ
NULL
);

881 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

882 
	`£rv”As£¹
(
¥Œ
 !ğ
NULL
);

884 
•Œ
 !ğ
NULL
) {

885 
	`£rv”As£¹
(
	`zli¡G‘
(
•Œ
,&
v¡r
,&
vËn
,&
vÎ
));

886 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

888 ià(
couÁ
 == 0) {

889 
cmd_™ems
 = (
™ems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

890 
AOF_REWRITE_ITEMS_PER_CMD
 : 
™ems
;

892 ià(
	`rioWr™eBulkCouÁ
(
r
,'*',2+
cmd_™ems
*2) == 0)  0;

893 ià(
	`rioWr™eBulkSŒšg
(
r
,"ZADD",4) == 0)  0;

894 ià(
	`rioWr™eBulkObjeù
(
r
,
key
) == 0)  0;

896 ià(
	`rioWr™eBulkDoubË
(
r
,
scÜe
) == 0)  0;

897 ià(
v¡r
 !ğ
NULL
) {

898 ià(
	`rioWr™eBulkSŒšg
(
r
,(*)
v¡r
,
vËn
) == 0)  0;

900 ià(
	`rioWr™eBulkLÚgLÚg
(
r
,
vÎ
) == 0)  0;

902 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

903 ià(++
couÁ
 =ğ
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

904 
™ems
--;

906 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

907 
z£t
 *
zs
 = 
o
->
±r
;

908 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘I‹¿tÜ
(
zs
->
diù
);

909 
diùEÁry
 *
de
;

911 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

912 
robj
 *
–eobj
 = 
	`diùG‘Key
(
de
);

913 *
scÜe
 = 
	`diùG‘V®
(
de
);

915 ià(
couÁ
 == 0) {

916 
cmd_™ems
 = (
™ems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

917 
AOF_REWRITE_ITEMS_PER_CMD
 : 
™ems
;

919 ià(
	`rioWr™eBulkCouÁ
(
r
,'*',2+
cmd_™ems
*2) == 0)  0;

920 ià(
	`rioWr™eBulkSŒšg
(
r
,"ZADD",4) == 0)  0;

921 ià(
	`rioWr™eBulkObjeù
(
r
,
key
) == 0)  0;

923 ià(
	`rioWr™eBulkDoubË
(
r
,*
scÜe
) == 0)  0;

924 ià(
	`rioWr™eBulkObjeù
(
r
,
–eobj
) == 0)  0;

925 ià(++
couÁ
 =ğ
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

926 
™ems
--;

928 
	`diùR–—£I‹¿tÜ
(
di
);

930 
	`£rv”Pªic
("Unknown sorted zsetƒncoding");

933 
	}
}

941 
	$rioWr™eHashI‹¿tÜCursÜ
(
rio
 *
r
, 
hashTy³I‹¿tÜ
 *
hi
, 
wh©
) {

942 ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

943 *
v¡r
 = 
NULL
;

944 
vËn
 = 
UINT_MAX
;

945 
vÎ
 = 
LLONG_MAX
;

947 
	`hashTy³Cu¼’tFromZli¡
(
hi
, 
wh©
, &
v¡r
, &
vËn
, &
vÎ
);

948 ià(
v¡r
) {

949  
	`rioWr™eBulkSŒšg
(
r
, (*)
v¡r
, 
vËn
);

951  
	`rioWr™eBulkLÚgLÚg
(
r
, 
vÎ
);

954 } ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

955 
robj
 *
v®ue
;

957 
	`hashTy³Cu¼’tFromHashTabË
(
hi
, 
wh©
, &
v®ue
);

958  
	`rioWr™eBulkObjeù
(
r
, 
v®ue
);

961 
	`£rv”Pªic
("Unknown hashƒncoding");

963 
	}
}

967 
	$»wr™eHashObjeù
(
rio
 *
r
, 
robj
 *
key
,„obj *
o
) {

968 
hashTy³I‹¿tÜ
 *
hi
;

969 
couÁ
 = 0, 
™ems
 = 
	`hashTy³L’gth
(
o
);

971 
hi
 = 
	`hashTy³In™I‹¿tÜ
(
o
);

972 
	`hashTy³Next
(
hi
è!ğ
C_ERR
) {

973 ià(
couÁ
 == 0) {

974 
cmd_™ems
 = (
™ems
 > 
AOF_REWRITE_ITEMS_PER_CMD
) ?

975 
AOF_REWRITE_ITEMS_PER_CMD
 : 
™ems
;

977 ià(
	`rioWr™eBulkCouÁ
(
r
,'*',2+
cmd_™ems
*2) == 0)  0;

978 ià(
	`rioWr™eBulkSŒšg
(
r
,"HMSET",5) == 0)  0;

979 ià(
	`rioWr™eBulkObjeù
(
r
,
key
) == 0)  0;

982 ià(
	`rioWr™eHashI‹¿tÜCursÜ
(
r
, 
hi
, 
OBJ_HASH_KEY
) == 0)  0;

983 ià(
	`rioWr™eHashI‹¿tÜCursÜ
(
r
, 
hi
, 
OBJ_HASH_VALUE
) == 0)  0;

984 ià(++
couÁ
 =ğ
AOF_REWRITE_ITEMS_PER_CMD
) count = 0;

985 
™ems
--;

988 
	`hashTy³R–—£I‹¿tÜ
(
hi
);

991 
	}
}

996 
ssize_t
 
	$aofR—dDiffFromP¬’t
() {

997 
buf
[65536];

998 
ssize_t
 
Ä—d
, 
tÙ®
 = 0;

1000 (
Ä—d
 =

1001 
	`»ad
(
£rv”
.
aof_pe_»ad_d©a_äom_·»Á
,
buf
,(buf))) > 0) {

1002 
£rv”
.
aof_chd_diff
 = 
	`sdsÿ’
(£rv”.aof_chd_diff,
buf
,
Ä—d
);

1003 
tÙ®
 +ğ
Ä—d
;

1005  
tÙ®
;

1006 
	}
}

1015 
	$»wr™eAµ’dOÆyFe
(*
f’ame
) {

1016 
diùI‹¿tÜ
 *
di
 = 
NULL
;

1017 
diùEÁry
 *
de
;

1018 
rio
 
aof
;

1019 
FILE
 *
å
;

1020 
tmpfe
[256];

1021 
j
;

1022 
now
 = 
	`m¡ime
();

1023 
by‹
;

1024 
size_t
 
´oûs£d
 = 0;

1028 
	`¢´štf
(
tmpfe
,256,"‹mp-»wr™—of-%d.aof", (è
	`g‘pid
());

1029 
å
 = 
	`fİ’
(
tmpfe
,"w");

1030 ià(!
å
) {

1031 
	`£rv”Log
(
LL_WARNING
, "O³nšgh‹m°ffÜ AOF„ewr™š„ewr™eAµ’dOÆyFe(): %s", 
	`¡»¼Ü
(
”ºo
));

1032  
C_ERR
;

1035 
£rv”
.
aof_chd_diff
 = 
	`sd£m±y
();

1036 
	`rioIn™W™hFe
(&
aof
,
å
);

1037 ià(
£rv”
.
aof_»wr™e_šüem’l_fsync
)

1038 
	`rioS‘AutoSync
(&
aof
,
AOF_AUTOSYNC_BYTES
);

1039 
j
 = 0; j < 
£rv”
.
dbnum
; j++) {

1040 
£Ëùcmd
[] = "*2\r\n$6\r\nSELECT\r\n";

1041 
»disDb
 *
db
 = 
£rv”
.db+
j
;

1042 
diù
 *
d
 = 
db
->dict;

1043 ià(
	`diùSize
(
d
) == 0) ;

1044 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
d
);

1045 ià(!
di
) {

1046 
	`fşo£
(
å
);

1047  
C_ERR
;

1051 ià(
	`rioWr™e
(&
aof
,
£Ëùcmd
,(£Ëùcmd)-1è=ğ0è
w”r
;

1052 ià(
	`rioWr™eBulkLÚgLÚg
(&
aof
,
j
è=ğ0è
w”r
;

1055 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1056 
sds
 
key¡r
;

1057 
robj
 
key
, *
o
;

1058 
expœ‘ime
;

1060 
key¡r
 = 
	`diùG‘Key
(
de
);

1061 
o
 = 
	`diùG‘V®
(
de
);

1062 
	`š™SticSŒšgObjeù
(
key
,
key¡r
);

1064 
expœ‘ime
 = 
	`g‘Expœe
(
db
,&
key
);

1067 ià(
expœ‘ime
 !ğ-1 &&ƒxpœ‘im< 
now
) ;

1070 ià(
o
->
ty³
 =ğ
OBJ_STRING
) {

1072 
cmd
[]="*3\r\n$3\r\nSET\r\n";

1073 ià(
	`rioWr™e
(&
aof
,
cmd
,(cmd)-1è=ğ0è
w”r
;

1075 ià(
	`rioWr™eBulkObjeù
(&
aof
,&
key
è=ğ0è
w”r
;

1076 ià(
	`rioWr™eBulkObjeù
(&
aof
,
o
è=ğ0è
w”r
;

1077 } ià(
o
->
ty³
 =ğ
OBJ_LIST
) {

1078 ià(
	`»wr™eLi¡Objeù
(&
aof
,&
key
,
o
è=ğ0è
w”r
;

1079 } ià(
o
->
ty³
 =ğ
OBJ_SET
) {

1080 ià(
	`»wr™eS‘Objeù
(&
aof
,&
key
,
o
è=ğ0è
w”r
;

1081 } ià(
o
->
ty³
 =ğ
OBJ_ZSET
) {

1082 ià(
	`»wr™eSÜ‹dS‘Objeù
(&
aof
,&
key
,
o
è=ğ0è
w”r
;

1083 } ià(
o
->
ty³
 =ğ
OBJ_HASH
) {

1084 ià(
	`»wr™eHashObjeù
(&
aof
,&
key
,
o
è=ğ0è
w”r
;

1086 
	`£rv”Pªic
("Unknown objectype");

1089 ià(
expœ‘ime
 != -1) {

1090 
cmd
[]="*3\r\n$9\r\nPEXPIREAT\r\n";

1091 ià(
	`rioWr™e
(&
aof
,
cmd
,(cmd)-1è=ğ0è
w”r
;

1092 ià(
	`rioWr™eBulkObjeù
(&
aof
,&
key
è=ğ0è
w”r
;

1093 ià(
	`rioWr™eBulkLÚgLÚg
(&
aof
,
expœ‘ime
è=ğ0è
w”r
;

1096 ià(
aof
.
´oûs£d_by‹s
 > 
´oûs£d
+1024*10) {

1097 
´oûs£d
 = 
aof
.
´oûs£d_by‹s
;

1098 
	`aofR—dDiffFromP¬’t
();

1101 
	`diùR–—£I‹¿tÜ
(
di
);

1102 
di
 = 
NULL
;

1107 ià(
	`fæush
(
å
è=ğ
EOF
è
w”r
;

1108 ià(
	`fsync
(
	`f’o
(
å
)è=ğ-1è
w”r
;

1116 
nod©a
 = 0;

1117 
m¡ime_t
 
¡¬t
 = 
	`m¡ime
();

1118 
	`m¡ime
()-
¡¬t
 < 1000 && 
nod©a
 < 20) {

1119 ià(
	`«Wa™
(
£rv”
.
aof_pe_»ad_d©a_äom_·»Á
, 
AE_READABLE
, 1) <= 0)

1121 
nod©a
++;

1124 
nod©a
 = 0;

1126 
	`aofR—dDiffFromP¬’t
();

1130 ià(
	`wr™e
(
£rv”
.
aof_pe_wr™e_ack_to_·»Á
,"!",1è!ğ1è
w”r
;

1131 ià(
	`ª‘NÚBlock
(
NULL
,
£rv”
.
aof_pe_»ad_ack_äom_·»Á
è!ğ
ANET_OK
)

1132 
w”r
;

1136 ià(
	`syncR—d
(
£rv”
.
aof_pe_»ad_ack_äom_·»Á
,&
by‹
,1,5000) != 1 ||

1137 
by‹
 !ğ'!'è
w”r
;

1138 
	`£rv”Log
(
LL_NOTICE
,"Parent‡greedo stop sending diffs. Finalizing AOF...");

1141 
	`aofR—dDiffFromP¬’t
();

1144 
	`£rv”Log
(
LL_NOTICE
,

1146 (è
	`sd¦’
(
£rv”
.
aof_chd_diff
) / (1024*1024));

1147 ià(
	`rioWr™e
(&
aof
,
£rv”
.
aof_chd_diff
,
	`sd¦’
(server.aof_child_diff)) == 0)

1148 
w”r
;

1151 ià(
	`fæush
(
å
è=ğ
EOF
è
w”r
;

1152 ià(
	`fsync
(
	`f’o
(
å
)è=ğ-1è
w”r
;

1153 ià(
	`fşo£
(
å
è=ğ
EOF
è
w”r
;

1157 ià(
	`»Çme
(
tmpfe
,
f’ame
) == -1) {

1158 
	`£rv”Log
(
LL_WARNING
,"E¼Ü movšgem°­³nd oÆy fÚhfš® de¡š©iÚ: %s", 
	`¡»¼Ü
(
”ºo
));

1159 
	`uÆšk
(
tmpfe
);

1160  
C_ERR
;

1162 
	`£rv”Log
(
LL_NOTICE
,"SYNC‡ppend only file„ewrite…erformed");

1163  
C_OK
;

1165 
w”r
:

1166 
	`£rv”Log
(
LL_WARNING
,"Wr™”rÜ wr™šg‡µ’d oÆy fÚ disk: %s", 
	`¡»¼Ü
(
”ºo
));

1167 
	`fşo£
(
å
);

1168 
	`uÆšk
(
tmpfe
);

1169 ià(
di
è
	`diùR–—£I‹¿tÜ
(di);

1170  
C_ERR
;

1171 
	}
}

1180 
	$aofChdPeR—dabË
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

1181 
by‹
;

1182 
	`UNUSED
(
–
);

1183 
	`UNUSED
(
´ivd©a
);

1184 
	`UNUSED
(
mask
);

1186 ià(
	`»ad
(
fd
,&
by‹
,1) == 1 && byte == '!') {

1187 
	`£rv”Log
(
LL_NOTICE
,"AOF„ewrite child‡skso stop sending diffs.");

1188 
£rv”
.
aof_¡İ_£ndšg_diff
 = 1;

1189 ià(
	`wr™e
(
£rv”
.
aof_pe_wr™e_ack_to_chd
,"!",1) != 1) {

1194 
	`£rv”Log
(
LL_WARNING
,"Can't send ACKo AOF child: %s",

1195 
	`¡»¼Ü
(
”ºo
));

1200 
	`«D–‘eFeEv’t
(
£rv”
.
–
,£rv”.
aof_pe_»ad_ack_äom_chd
,
AE_READABLE
);

1201 
	}
}

1208 
	$aofC»©ePes
() {

1209 
fds
[6] = {-1, -1, -1, -1, -1, -1};

1210 
j
;

1212 ià(
	`pe
(
fds
è=ğ-1è
”rÜ
;

1213 ià(
	`pe
(
fds
+2è=ğ-1è
”rÜ
;

1214 ià(
	`pe
(
fds
+4è=ğ-1è
”rÜ
;

1216 ià(
	`ª‘NÚBlock
(
NULL
,
fds
[0]è!ğ
ANET_OK
è
”rÜ
;

1217 ià(
	`ª‘NÚBlock
(
NULL
,
fds
[1]è!ğ
ANET_OK
è
”rÜ
;

1218 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
, 
fds
[2], 
AE_READABLE
, 
aofChdPeR—dabË
, 
NULL
è=ğ
AE_ERR
è
”rÜ
;

1220 
£rv”
.
aof_pe_wr™e_d©a_to_chd
 = 
fds
[1];

1221 
£rv”
.
aof_pe_»ad_d©a_äom_·»Á
 = 
fds
[0];

1222 
£rv”
.
aof_pe_wr™e_ack_to_·»Á
 = 
fds
[3];

1223 
£rv”
.
aof_pe_»ad_ack_äom_chd
 = 
fds
[2];

1224 
£rv”
.
aof_pe_wr™e_ack_to_chd
 = 
fds
[5];

1225 
£rv”
.
aof_pe_»ad_ack_äom_·»Á
 = 
fds
[4];

1226 
£rv”
.
aof_¡İ_£ndšg_diff
 = 0;

1227  
C_OK
;

1229 
”rÜ
:

1230 
	`£rv”Log
(
LL_WARNING
,"Error opening /setting AOF„ewrite IPC…ipes: %s",

1231 
	`¡»¼Ü
(
”ºo
));

1232 
j
 = 0; j < 6; j++èif(
fds
[j] !ğ-1è
	`şo£
(fds[j]);

1233  
C_ERR
;

1234 
	}
}

1236 
	$aofClo£Pes
() {

1237 
	`«D–‘eFeEv’t
(
£rv”
.
–
,£rv”.
aof_pe_»ad_ack_äom_chd
,
AE_READABLE
);

1238 
	`«D–‘eFeEv’t
(
£rv”
.
–
,£rv”.
aof_pe_wr™e_d©a_to_chd
,
AE_WRITABLE
);

1239 
	`şo£
(
£rv”
.
aof_pe_wr™e_d©a_to_chd
);

1240 
	`şo£
(
£rv”
.
aof_pe_»ad_d©a_äom_·»Á
);

1241 
	`şo£
(
£rv”
.
aof_pe_wr™e_ack_to_·»Á
);

1242 
	`şo£
(
£rv”
.
aof_pe_»ad_ack_äom_chd
);

1243 
	`şo£
(
£rv”
.
aof_pe_wr™e_ack_to_chd
);

1244 
	`şo£
(
£rv”
.
aof_pe_»ad_ack_äom_·»Á
);

1245 
	}
}

1263 
	$»wr™eAµ’dOÆyFeBackground
() {

1264 
pid_t
 
chdpid
;

1265 
¡¬t
;

1267 ià(
£rv”
.
aof_chd_pid
 !ğ-1 || s”v”.
rdb_chd_pid
 !ğ-1è 
C_ERR
;

1268 ià(
	`aofC»©ePes
(è!ğ
C_OK
è 
C_ERR
;

1269 
¡¬t
 = 
	`u¡ime
();

1270 ià((
chdpid
 = 
	`fÜk
()) == 0) {

1271 
tmpfe
[256];

1274 
	`şo£Li¡’šgSock‘s
(0);

1275 
	`»disS‘ProcT™Ë
("redis-aof-rewrite");

1276 
	`¢´štf
(
tmpfe
,256,"‹mp-»wr™—of-bg-%d.aof", (è
	`g‘pid
());

1277 ià(
	`»wr™eAµ’dOÆyFe
(
tmpfe
è=ğ
C_OK
) {

1278 
size_t
 
´iv©e_dœty
 = 
	`zm®loc_g‘_´iv©e_dœty
();

1280 ià(
´iv©e_dœty
) {

1281 
	`£rv”Log
(
LL_NOTICE
,

1283 
´iv©e_dœty
/(1024*1024));

1285 
	`ex™FromChd
(0);

1287 
	`ex™FromChd
(1);

1291 
£rv”
.
¡©_fÜk_time
 = 
	`u¡ime
()-
¡¬t
;

1292 
£rv”
.
¡©_fÜk_¿‹
 = (è
	`zm®loc_u£d_memÜy
(è* 1000000 / s”v”.
¡©_fÜk_time
 / (1024*1024*1024);

1293 
	`Ï‹ncyAddSam¶eIfN“ded
("fÜk",
£rv”
.
¡©_fÜk_time
/1000);

1294 ià(
chdpid
 == -1) {

1295 
	`£rv”Log
(
LL_WARNING
,

1297 
	`¡»¼Ü
(
”ºo
));

1298  
C_ERR
;

1300 
	`£rv”Log
(
LL_NOTICE
,

1301 "Background‡µ’d oÆy f»wr™šg s¹ed by…id %d",
chdpid
);

1302 
£rv”
.
aof_»wr™e_scheduËd
 = 0;

1303 
£rv”
.
aof_»wr™e_time_¡¬t
 = 
	`time
(
NULL
);

1304 
£rv”
.
aof_chd_pid
 = 
chdpid
;

1305 
	`upd©eDiùResizePŞicy
();

1310 
£rv”
.
aof_£Ëùed_db
 = -1;

1311 
	`»¶iÿtiÚSütCacheFlush
();

1312  
C_OK
;

1314  
C_OK
;

1315 
	}
}

1317 
	$bg»wr™—ofCommªd
(
ş›Á
 *
c
) {

1318 ià(
£rv”
.
aof_chd_pid
 != -1) {

1319 
	`addR•lyE¼Ü
(
c
,"Background‡ppend only file„ewriting‡lready in…rogress");

1320 } ià(
£rv”
.
rdb_chd_pid
 != -1) {

1321 
£rv”
.
aof_»wr™e_scheduËd
 = 1;

1322 
	`addR•lyStus
(
c
,"Background‡ppend only file„ewriting scheduled");

1323 } ià(
	`»wr™eAµ’dOÆyFeBackground
(è=ğ
C_OK
) {

1324 
	`addR•lyStus
(
c
,"Background‡ppend only file„ewriting started");

1326 
	`addR•ly
(
c
,
sh¬ed
.
”r
);

1328 
	}
}

1330 
	$aofRemoveTempFe
(
pid_t
 
chdpid
) {

1331 
tmpfe
[256];

1333 
	`¢´štf
(
tmpfe
,256,"‹mp-»wr™—of-bg-%d.aof", (è
chdpid
);

1334 
	`uÆšk
(
tmpfe
);

1335 
	}
}

1341 
	$aofUpd©eCu¼’tSize
() {

1342 
»dis_¡©
 
sb
;

1343 
m¡ime_t
 
Ï‹ncy
;

1345 
	`Ï‹ncyS¹MÚ™Ü
(
Ï‹ncy
);

1346 ià(
	`»dis_f¡©
(
£rv”
.
aof_fd
,&
sb
) == -1) {

1347 
	`£rv”Log
(
LL_WARNING
,"Unableo obtainhe AOF file†ength. stat: %s",

1348 
	`¡»¼Ü
(
”ºo
));

1350 
£rv”
.
aof_cu¼’t_size
 = 
sb
.
¡_size
;

1352 
	`Ï‹ncyEndMÚ™Ü
(
Ï‹ncy
);

1353 
	`Ï‹ncyAddSam¶eIfN“ded
("aof-f¡©",
Ï‹ncy
);

1354 
	}
}

1358 
	$backgroundRewr™eDÚeHªdËr
(
ex™code
, 
bysigÇl
) {

1359 ià(!
bysigÇl
 && 
ex™code
 == 0) {

1360 
Ãwfd
, 
Şdfd
;

1361 
tmpfe
[256];

1362 
now
 = 
	`u¡ime
();

1363 
m¡ime_t
 
Ï‹ncy
;

1365 
	`£rv”Log
(
LL_NOTICE
,

1370 
	`Ï‹ncyS¹MÚ™Ü
(
Ï‹ncy
);

1371 
	`¢´štf
(
tmpfe
,256,"temp-rewriteaof-bg-%d.aof",

1372 ()
£rv”
.
aof_chd_pid
);

1373 
Ãwfd
 = 
	`İ’
(
tmpfe
,
O_WRONLY
|
O_APPEND
);

1374 ià(
Ãwfd
 == -1) {

1375 
	`£rv”Log
(
LL_WARNING
,

1376 "UÇbËØİ’h‹mpÜ¬y AOF…roduûd byhchd: %s", 
	`¡»¼Ü
(
”ºo
));

1377 
ş—nup
;

1380 ià(
	`aofRewr™eBufãrWr™e
(
Ãwfd
) == -1) {

1381 
	`£rv”Log
(
LL_WARNING
,

1382 "E¼ÜryšgØæushh·»Á difàtØth»wr™‹ÀAOF: %s", 
	`¡»¼Ü
(
”ºo
));

1383 
	`şo£
(
Ãwfd
);

1384 
ş—nup
;

1386 
	`Ï‹ncyEndMÚ™Ü
(
Ï‹ncy
);

1387 
	`Ï‹ncyAddSam¶eIfN“ded
("aof-»wr™e-diff-wr™e",
Ï‹ncy
);

1389 
	`£rv”Log
(
LL_NOTICE
,

1390 "Residu®…¬’ˆdifàsucûssfuÎy flushedØth»wr™‹ÀAOF (%.2àMB)", (è
	`aofRewr™eBufãrSize
() / (1024*1024));

1419 ià(
£rv”
.
aof_fd
 == -1) {

1425 
Şdfd
 = 
	`İ’
(
£rv”
.
aof_f’ame
,
O_RDONLY
|
O_NONBLOCK
);

1428 
Şdfd
 = -1;

1433 
	`Ï‹ncyS¹MÚ™Ü
(
Ï‹ncy
);

1434 ià(
	`»Çme
(
tmpfe
,
£rv”
.
aof_f’ame
) == -1) {

1435 
	`£rv”Log
(
LL_WARNING
,

1437 
tmpfe
,

1438 
£rv”
.
aof_f’ame
,

1439 
	`¡»¼Ü
(
”ºo
));

1440 
	`şo£
(
Ãwfd
);

1441 ià(
Şdfd
 !ğ-1è
	`şo£
(oldfd);

1442 
ş—nup
;

1444 
	`Ï‹ncyEndMÚ™Ü
(
Ï‹ncy
);

1445 
	`Ï‹ncyAddSam¶eIfN“ded
("aof-»Çme",
Ï‹ncy
);

1447 ià(
£rv”
.
aof_fd
 == -1) {

1450 
	`şo£
(
Ãwfd
);

1453 
Şdfd
 = 
£rv”
.
aof_fd
;

1454 
£rv”
.
aof_fd
 = 
Ãwfd
;

1455 ià(
£rv”
.
aof_fsync
 =ğ
AOF_FSYNC_ALWAYS
)

1456 
	`aof_fsync
(
Ãwfd
);

1457 ià(
£rv”
.
aof_fsync
 =ğ
AOF_FSYNC_EVERYSEC
)

1458 
	`aof_background_fsync
(
Ãwfd
);

1459 
£rv”
.
aof_£Ëùed_db
 = -1;

1460 
	`aofUpd©eCu¼’tSize
();

1461 
£rv”
.
aof_»wr™e_ba£_size
 = s”v”.
aof_cu¼’t_size
;

1465 
	`sdsä“
(
£rv”
.
aof_buf
);

1466 
£rv”
.
aof_buf
 = 
	`sd£m±y
();

1469 
£rv”
.
aof_Ï¡bg»wr™e_¡©us
 = 
C_OK
;

1471 
	`£rv”Log
(
LL_NOTICE
, "Background AOF„ewrite finished successfully");

1473 ià(
£rv”
.
aof_¡©e
 =ğ
AOF_WAIT_REWRITE
)

1474 
£rv”
.
aof_¡©e
 = 
AOF_ON
;

1477 ià(
Şdfd
 !ğ-1è
	`bioC»©eBackgroundJob
(
BIO_CLOSE_FILE
,(*)()Şdfd,
NULL
,NULL);

1479 
	`£rv”Log
(
LL_VERBOSE
,

1480 "Background AOF„ewr™sigÇÈhªdË¸took %Îdus", 
	`u¡ime
()-
now
);

1481 } ià(!
bysigÇl
 && 
ex™code
 != 0) {

1484 ià(
bysigÇl
 !ğ
SIGUSR1
)

1485 
£rv”
.
aof_Ï¡bg»wr™e_¡©us
 = 
C_ERR
;

1486 
	`£rv”Log
(
LL_WARNING
,

1489 
£rv”
.
aof_Ï¡bg»wr™e_¡©us
 = 
C_ERR
;

1491 
	`£rv”Log
(
LL_WARNING
,

1492 "Background AOF„ewr™‹rmš©ed by sigÇÈ%d", 
bysigÇl
);

1495 
ş—nup
:

1496 
	`aofClo£Pes
();

1497 
	`aofRewr™eBufãrRe£t
();

1498 
	`aofRemoveTempFe
(
£rv”
.
aof_chd_pid
);

1499 
£rv”
.
aof_chd_pid
 = -1;

1500 
£rv”
.
aof_»wr™e_time_Ï¡
 = 
	`time
(
NULL
)-£rv”.
aof_»wr™e_time_¡¬t
;

1501 
£rv”
.
aof_»wr™e_time_¡¬t
 = -1;

1503 ià(
£rv”
.
aof_¡©e
 =ğ
AOF_WAIT_REWRITE
)

1504 
£rv”
.
aof_»wr™e_scheduËd
 = 1;

1505 
	}
}

	@src/asciilogo.h

30 *
	gascii_logo
 =

	@src/bio.c

61 
	~"£rv”.h
"

62 
	~"bio.h
"

64 
±h»ad_t
 
	gbio_th»ads
[
BIO_NUM_OPS
];

65 
±h»ad_mu‹x_t
 
	gbio_mu‹x
[
BIO_NUM_OPS
];

66 
±h»ad_cÚd_t
 
	gbio_cÚdv¬
[
BIO_NUM_OPS
];

67 
li¡
 *
	gbio_jobs
[
BIO_NUM_OPS
];

74 
	gbio_³ndšg
[
BIO_NUM_OPS
];

78 
	sbio_job
 {

79 
time_t
 
	mtime
;

82 *
	m¬g1
, *
	m¬g2
, *
	m¬g3
;

85 *
bioProûssBackgroundJobs
(*
¬g
);

89 
	#REDIS_THREAD_STACK_SIZE
 (1024*1024*4)

	)

92 
	$bioIn™
() {

93 
±h»ad_©Œ_t
 
©Œ
;

94 
±h»ad_t
 
th»ad
;

95 
size_t
 
¡acksize
;

96 
j
;

99 
j
 = 0; j < 
BIO_NUM_OPS
; j++) {

100 
	`±h»ad_mu‹x_š™
(&
bio_mu‹x
[
j
],
NULL
);

101 
	`±h»ad_cÚd_š™
(&
bio_cÚdv¬
[
j
],
NULL
);

102 
bio_jobs
[
j
] = 
	`li¡C»©e
();

103 
bio_³ndšg
[
j
] = 0;

107 
	`±h»ad_©Œ_š™
(&
©Œ
);

108 
	`±h»ad_©Œ_g‘¡acksize
(&
©Œ
,&
¡acksize
);

109 ià(!
¡acksize
) stacksize = 1;

110 
¡acksize
 < 
REDIS_THREAD_STACK_SIZE
) stacksize *= 2;

111 
	`±h»ad_©Œ_£t¡acksize
(&
©Œ
, 
¡acksize
);

116 
j
 = 0; j < 
BIO_NUM_OPS
; j++) {

117 *
¬g
 = (*)(è
j
;

118 ià(
	`±h»ad_ü—‹
(&
th»ad
,&
©Œ
,
bioProûssBackgroundJobs
,
¬g
) != 0) {

119 
	`£rv”Log
(
LL_WARNING
,"Fatal: Can't initialize Background Jobs.");

120 
	`ex™
(1);

122 
bio_th»ads
[
j
] = 
th»ad
;

124 
	}
}

126 
	$bioC»©eBackgroundJob
(
ty³
, *
¬g1
, *
¬g2
, *
¬g3
) {

127 
bio_job
 *
job
 = 
	`zm®loc
((*job));

129 
job
->
time
 = 
	`time
(
NULL
);

130 
job
->
¬g1
 =‡rg1;

131 
job
->
¬g2
 =‡rg2;

132 
job
->
¬g3
 =‡rg3;

133 
	`±h»ad_mu‹x_lock
(&
bio_mu‹x
[
ty³
]);

134 
	`li¡AddNodeTa
(
bio_jobs
[
ty³
],
job
);

135 
bio_³ndšg
[
ty³
]++;

136 
	`±h»ad_cÚd_sigÇl
(&
bio_cÚdv¬
[
ty³
]);

137 
	`±h»ad_mu‹x_uÆock
(&
bio_mu‹x
[
ty³
]);

138 
	}
}

140 *
	$bioProûssBackgroundJobs
(*
¬g
) {

141 
bio_job
 *
job
;

142 
ty³
 = (è
¬g
;

143 
sig£t_t
 
sig£t
;

146 ià(
ty³
 >ğ
BIO_NUM_OPS
) {

147 
	`£rv”Log
(
LL_WARNING
,

148 "W¬nšg: biØth»ad s¹ed w™h wrÚgy³ %lu",
ty³
);

149  
NULL
;

154 
	`±h»ad_£tÿnûl¡©e
(
PTHREAD_CANCEL_ENABLE
, 
NULL
);

155 
	`±h»ad_£tÿnûÉy³
(
PTHREAD_CANCEL_ASYNCHRONOUS
, 
NULL
);

157 
	`±h»ad_mu‹x_lock
(&
bio_mu‹x
[
ty³
]);

160 
	`sigem±y£t
(&
sig£t
);

161 
	`sigadd£t
(&
sig£t
, 
SIGALRM
);

162 ià(
	`±h»ad_sigmask
(
SIG_BLOCK
, &
sig£t
, 
NULL
))

163 
	`£rv”Log
(
LL_WARNING
,

164 "W¬nšg: cª'ˆmask SIGALRM iÀbio.øth»ad: %s", 
	`¡»¼Ü
(
”ºo
));

167 
li¡Node
 *
Ê
;

170 ià(
	`li¡L’gth
(
bio_jobs
[
ty³
]) == 0) {

171 
	`±h»ad_cÚd_wa™
(&
bio_cÚdv¬
[
ty³
],&
bio_mu‹x
[type]);

175 
Ê
 = 
	`li¡Fœ¡
(
bio_jobs
[
ty³
]);

176 
job
 = 
Ê
->
v®ue
;

179 
	`±h»ad_mu‹x_uÆock
(&
bio_mu‹x
[
ty³
]);

182 ià(
ty³
 =ğ
BIO_CLOSE_FILE
) {

183 
	`şo£
(()
job
->
¬g1
);

184 } ià(
ty³
 =ğ
BIO_AOF_FSYNC
) {

185 
	`aof_fsync
(()
job
->
¬g1
);

187 
	`£rv”Pªic
("Wrong jobype in bioProcessBackgroundJobs().");

189 
	`zä“
(
job
);

193 
	`±h»ad_mu‹x_lock
(&
bio_mu‹x
[
ty³
]);

194 
	`li¡D–Node
(
bio_jobs
[
ty³
],
Ê
);

195 
bio_³ndšg
[
ty³
]--;

197 
	}
}

200 
	$bioP’dšgJobsOfTy³
(
ty³
) {

201 
v®
;

202 
	`±h»ad_mu‹x_lock
(&
bio_mu‹x
[
ty³
]);

203 
v®
 = 
bio_³ndšg
[
ty³
];

204 
	`±h»ad_mu‹x_uÆock
(&
bio_mu‹x
[
ty³
]);

205  
v®
;

206 
	}
}

212 
	$bioKlTh»ads
() {

213 
”r
, 
j
;

215 
j
 = 0; j < 
BIO_NUM_OPS
; j++) {

216 ià(
	`±h»ad_ÿnûl
(
bio_th»ads
[
j
]) == 0) {

217 ià((
”r
 = 
	`±h»ad_još
(
bio_th»ads
[
j
],
NULL
)) != 0) {

218 
	`£rv”Log
(
LL_WARNING
,

220 
j
, 
	`¡»¼Ü
(
”r
));

222 
	`£rv”Log
(
LL_WARNING
,

223 "BiØth»ad fÜ joby³ #%d”mš©ed",
j
);

227 
	}
}

	@src/bio.h

31 
bioIn™
();

32 
bioC»©eBackgroundJob
(
ty³
, *
¬g1
, *
¬g2
, *
¬g3
);

33 
bioP’dšgJobsOfTy³
(
ty³
);

34 
bioWa™P’dšgJobsLE
(
ty³
, 
num
);

35 
time_t
 
bioOld”JobOfTy³
(
ty³
);

36 
bioKlTh»ads
();

39 
	#BIO_CLOSE_FILE
 0

	)

40 
	#BIO_AOF_FSYNC
 1

	)

41 
	#BIO_NUM_OPS
 2

	)

	@src/bitops.c

31 
	~"£rv”.h
"

40 
size_t
 
	$»disPİcouÁ
(*
s
, 
couÁ
) {

41 
size_t
 
b™s
 = 0;

42 *
p
 = 
s
;

43 
ušt32_t
 *
p4
;

44 cÚ¡ 
b™sšby‹
[256] = {0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,3,4,4,5,4,5,5,6,4,5,5,6,5,6,6,7,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,5,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,3,4,4,5,4,5,5,6,4,5,5,6,5,6,6,7,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,6,3,4,4,5,4,5,5,6,4,5,5,6,5,6,6,7,3,4,4,5,4,5,5,6,4,5,5,6,5,6,6,7,4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8};

47 ()
p
 & 3 && 
couÁ
) {

48 
b™s
 +ğ
b™sšby‹
[*
p
++];

49 
couÁ
--;

53 
p4
 = (
ušt32_t
*)
p
;

54 
couÁ
>=28) {

55 
ušt32_t
 
aux1
, 
aux2
, 
aux3
, 
aux4
, 
aux5
, 
aux6
, 
aux7
;

57 
aux1
 = *
p4
++;

58 
aux2
 = *
p4
++;

59 
aux3
 = *
p4
++;

60 
aux4
 = *
p4
++;

61 
aux5
 = *
p4
++;

62 
aux6
 = *
p4
++;

63 
aux7
 = *
p4
++;

64 
couÁ
 -= 28;

66 
aux1
 =‡ux1 - ((aux1 >> 1) & 0x55555555);

67 
aux1
 = (aux1 & 0x33333333) + ((aux1 >> 2) & 0x33333333);

68 
aux2
 =‡ux2 - ((aux2 >> 1) & 0x55555555);

69 
aux2
 = (aux2 & 0x33333333) + ((aux2 >> 2) & 0x33333333);

70 
aux3
 =‡ux3 - ((aux3 >> 1) & 0x55555555);

71 
aux3
 = (aux3 & 0x33333333) + ((aux3 >> 2) & 0x33333333);

72 
aux4
 =‡ux4 - ((aux4 >> 1) & 0x55555555);

73 
aux4
 = (aux4 & 0x33333333) + ((aux4 >> 2) & 0x33333333);

74 
aux5
 =‡ux5 - ((aux5 >> 1) & 0x55555555);

75 
aux5
 = (aux5 & 0x33333333) + ((aux5 >> 2) & 0x33333333);

76 
aux6
 =‡ux6 - ((aux6 >> 1) & 0x55555555);

77 
aux6
 = (aux6 & 0x33333333) + ((aux6 >> 2) & 0x33333333);

78 
aux7
 =‡ux7 - ((aux7 >> 1) & 0x55555555);

79 
aux7
 = (aux7 & 0x33333333) + ((aux7 >> 2) & 0x33333333);

80 
b™s
 +ğ((((
aux1
 + (aux1 >> 4)) & 0x0F0F0F0F) +

81 ((
aux2
 + (aux2 >> 4)) & 0x0F0F0F0F) +

82 ((
aux3
 + (aux3 >> 4)) & 0x0F0F0F0F) +

83 ((
aux4
 + (aux4 >> 4)) & 0x0F0F0F0F) +

84 ((
aux5
 + (aux5 >> 4)) & 0x0F0F0F0F) +

85 ((
aux6
 + (aux6 >> 4)) & 0x0F0F0F0F) +

86 ((
aux7
 + (aux7 >> 4)) & 0x0F0F0F0F))* 0x01010101) >> 24;

89 
p
 = (*)
p4
;

90 
couÁ
--è
b™s
 +ğ
b™sšby‹
[*
p
++];

91  
b™s
;

92 
	}
}

101 
	$»disB™pos
(*
s
, 
couÁ
, 
b™
) {

102 *
l
;

103 *
c
;

104 
skv®
, 
wÜd
 = 0, 
Úe
;

105 
pos
 = 0;

106 
j
;

118 
skv®
 = 
b™
 ? 0 : 
UCHAR_MAX
;

119 
c
 = (*è
s
;

120 ()
c
 & ((*
l
)-1è&& 
couÁ
) {

121 ià(*
c
 !ğ
skv®
) ;

122 
c
++;

123 
couÁ
--;

124 
pos
 += 8;

128 
skv®
 = 
b™
 ? 0 : 
ULONG_MAX
;

129 
l
 = (*è
c
;

130 
couÁ
 >ğ(*
l
)) {

131 ià(*
l
 !ğ
skv®
) ;

132 
l
++;

133 
couÁ
 -ğ(*
l
);

134 
pos
 +ğ(*
l
)*8;

144 
c
 = (*)
l
;

145 
j
 = 0; j < (*
l
); j++) {

146 
wÜd
 <<= 8;

147 ià(
couÁ
) {

148 
wÜd
 |ğ*
c
;

149 
c
++;

150 
couÁ
--;

159 ià(
b™
 =ğ1 && 
wÜd
 == 0)  -1;

165 
Úe
 = 
ULONG_MAX
;

166 
Úe
 >>= 1;

167 
Úe
 = ~one;

169 
Úe
) {

170 ià(((
Úe
 & 
wÜd
è!ğ0è=ğ
b™
è 
pos
;

171 
pos
++;

172 
Úe
 >>= 1;

177 
	`£rv”Pªic
("End of„edisBitpos()„eached.");

179 
	}
}

202 
	$£tUnsigÃdB™f›ld
(*
p
, 
ušt64_t
 
off£t
, ušt64_ˆ
b™s
, ušt64_ˆ
v®ue
) {

203 
ušt64_t
 
by‹
, 
b™
, 
by‹v®
, 
b™v®
, 
j
;

205 
j
 = 0; j < 
b™s
; j++) {

206 
b™v®
 = (
v®ue
 & ((
ušt64_t
)1<<(
b™s
-1-
j
))) != 0;

207 
by‹
 = 
off£t
 >> 3;

208 
b™
 = 7 - (
off£t
 & 0x7);

209 
by‹v®
 = 
p
[
by‹
];

210 
by‹v®
 &ğ~(1 << 
b™
);

211 
by‹v®
 |ğ
b™v®
 << 
b™
;

212 
p
[
by‹
] = 
by‹v®
 & 0xff;

213 
off£t
++;

215 
	}
}

217 
	$£tSigÃdB™f›ld
(*
p
, 
ušt64_t
 
off£t
, ušt64_ˆ
b™s
, 
št64_t
 
v®ue
) {

218 
ušt64_t
 
uv
 = 
v®ue
;

219 
	`£tUnsigÃdB™f›ld
(
p
,
off£t
,
b™s
,
uv
);

220 
	}
}

222 
ušt64_t
 
	$g‘UnsigÃdB™f›ld
(*
p
, 
ušt64_t
 
off£t
, ušt64_ˆ
b™s
) {

223 
ušt64_t
 
by‹
, 
b™
, 
by‹v®
, 
b™v®
, 
j
, 
v®ue
 = 0;

225 
j
 = 0; j < 
b™s
; j++) {

226 
by‹
 = 
off£t
 >> 3;

227 
b™
 = 7 - (
off£t
 & 0x7);

228 
by‹v®
 = 
p
[
by‹
];

229 
b™v®
 = (
by‹v®
 >> 
b™
) & 1;

230 
v®ue
 = (v®ue<<1è| 
b™v®
;

231 
off£t
++;

233  
v®ue
;

234 
	}
}

236 
št64_t
 
	$g‘SigÃdB™f›ld
(*
p
, 
ušt64_t
 
off£t
, ušt64_ˆ
b™s
) {

237 
št64_t
 
v®ue
;

238 uniÚ {
ušt64_t
 
u
; 
št64_t
 
i
;} 
cÚv
;

247 
cÚv
.
u
 = 
	`g‘UnsigÃdB™f›ld
(
p
,
off£t
,
b™s
);

248 
v®ue
 = 
cÚv
.
i
;

253 ià(
v®ue
 & ((
ušt64_t
)1 << (
b™s
-1)))

254 
v®ue
 |ğ((
ušt64_t
)-1è<< 
b™s
;

255  
v®ue
;

256 
	}
}

277 
	#BFOVERFLOW_WRAP
 0

	)

278 
	#BFOVERFLOW_SAT
 1

	)

279 
	#BFOVERFLOW_FAIL
 2

	)

281 
	$checkUnsigÃdB™f›ldOv”æow
(
ušt64_t
 
v®ue
, 
št64_t
 
šü
, ušt64_ˆ
b™s
, 
owty³
, ušt64_ˆ*
lim™
) {

282 
ušt64_t
 
max
 = (
b™s
 =ğ64è? 
UINT64_MAX
 : (((uint64_t)1<<bits)-1);

283 
št64_t
 
maxšü
 = 
max
-
v®ue
;

284 
št64_t
 
mššü
 = -
v®ue
;

286 ià(
v®ue
 > 
max
 || (
šü
 > 0 && inü > 
maxšü
)) {

287 ià(
lim™
) {

288 ià(
owty³
 =ğ
BFOVERFLOW_WRAP
) {

289 
hªdË_w¿p
;

290 } ià(
owty³
 =ğ
BFOVERFLOW_SAT
) {

291 *
lim™
 = 
max
;

295 } ià(
šü
 < 0 && inü < 
mššü
) {

296 ià(
lim™
) {

297 ià(
owty³
 =ğ
BFOVERFLOW_WRAP
) {

298 
hªdË_w¿p
;

299 } ià(
owty³
 =ğ
BFOVERFLOW_SAT
) {

300 *
lim™
 = 0;

307 
hªdË_w¿p
:

309 
ušt64_t
 
mask
 = ((ušt64_t)-1è<< 
b™s
;

310 
ušt64_t
 
»s
 = 
v®ue
+
šü
;

312 
»s
 &ğ~
mask
;

313 *
lim™
 = 
»s
;

316 
	}
}

318 
	$checkSigÃdB™f›ldOv”æow
(
št64_t
 
v®ue
, iÁ64_ˆ
šü
, 
ušt64_t
 
b™s
, 
owty³
, iÁ64_ˆ*
lim™
) {

319 
št64_t
 
max
 = (
b™s
 =ğ64è? 
INT64_MAX
 : (((int64_t)1<<(bits-1))-1);

320 
št64_t
 
mš
 = (-
max
)-1;

325 
št64_t
 
maxšü
 = 
max
-
v®ue
;

326 
št64_t
 
mššü
 = 
mš
-
v®ue
;

328 ià(
v®ue
 > 
max
 || (
b™s
 !ğ64 && 
šü
 > 
maxšü
) || (value >= 0 && incr > 0 && incr > maxincr))

330 ià(
lim™
) {

331 ià(
owty³
 =ğ
BFOVERFLOW_WRAP
) {

332 
hªdË_w¿p
;

333 } ià(
owty³
 =ğ
BFOVERFLOW_SAT
) {

334 *
lim™
 = 
max
;

338 } ià(
v®ue
 < 
mš
 || (
b™s
 !ğ64 && 
šü
 < 
mššü
) || (value < 0 && incr < 0 && incr < minincr)) {

339 ià(
lim™
) {

340 ià(
owty³
 =ğ
BFOVERFLOW_WRAP
) {

341 
hªdË_w¿p
;

342 } ià(
owty³
 =ğ
BFOVERFLOW_SAT
) {

343 *
lim™
 = 
mš
;

350 
hªdË_w¿p
:

352 
ušt64_t
 
mask
 = ((ušt64_t)-1è<< 
b™s
;

353 
ušt64_t
 
msb
 = (ušt64_t)1 << (
b™s
-1);

354 
ušt64_t
 
a
 = 
v®ue
, 
b
 = 
šü
, 
c
;

355 
c
 = 
a
+
b
;

360 ià(
c
 & 
msb
) {

361 
c
 |ğ
mask
;

363 
c
 &ğ~
mask
;

365 *
lim™
 = 
c
;

368 
	}
}

372 
	$´štB™s
(*
p
, 
couÁ
) {

373 
j
, 
i
, 
by‹
;

375 
j
 = 0; j < 
couÁ
; j++) {

376 
by‹
 = 
p
[
j
];

377 
i
 = 0x80; i > 0; i /= 2)

378 
	`´štf
("%c", (
by‹
 & 
i
) ? '1' : '0');

379 
	`´štf
("|");

381 
	`´štf
("\n");

382 
	}
}

388 
	#BITOP_AND
 0

	)

389 
	#BITOP_OR
 1

	)

390 
	#BITOP_XOR
 2

	)

391 
	#BITOP_NOT
 3

	)

393 
	#BITFIELDOP_GET
 0

	)

394 
	#BITFIELDOP_SET
 1

	)

395 
	#BITFIELDOP_INCRBY
 2

	)

404 
	$g‘B™Off£tFromArgum’t
(
ş›Á
 *
c
, 
robj
 *
o
, 
size_t
 *
off£t
, 
hash
, 
b™s
) {

405 
loff£t
;

406 *
”r
 = "bit offset is‚ot‡n integer or out of„ange";

407 *
p
 = 
o
->
±r
;

408 
size_t
 
¶’
 = 
	`sd¦’
(
p
);

409 
u£hash
 = 0;

412 ià(
p
[0] =ğ'#' && 
hash
 && 
b™s
 > 0è
u£hash
 = 1;

414 ià(
	`¡ršg2Î
(
p
+
u£hash
,
¶’
-u£hash,&
loff£t
) == 0) {

415 
	`addR•lyE¼Ü
(
c
,
”r
);

416  
C_ERR
;

420 ià(
u£hash
è
loff£t
 *ğ
b™s
;

423 ià((
loff£t
 < 0) || (()loffset >> 3) >= (512*1024*1024))

425 
	`addR•lyE¼Ü
(
c
,
”r
);

426  
C_ERR
;

429 *
off£t
 = (
size_t
)
loff£t
;

430  
C_OK
;

431 
	}
}

440 
	$g‘B™f›ldTy³FromArgum’t
(
ş›Á
 *
c
, 
robj
 *
o
, *
sign
, *
b™s
) {

441 *
p
 = 
o
->
±r
;

442 *
”r
 = "Invalid bitfieldype. Use something†ike i16 u8. Notehat u64 is‚ot supported but i64 is.";

443 
Îb™s
;

445 ià(
p
[0] == 'i') {

446 *
sign
 = 1;

447 } ià(
p
[0] == 'u') {

448 *
sign
 = 0;

450 
	`addR•lyE¼Ü
(
c
,
”r
);

451  
C_ERR
;

454 ià((
	`¡ršg2Î
(
p
+1,
	`¡¾’
Õ+1),&
Îb™s
)) == 0 ||

455 
Îb™s
 < 1 ||

456 (*
sign
 =ğ1 && 
Îb™s
 > 64) ||

457 (*
sign
 =ğ0 && 
Îb™s
 > 63))

459 
	`addR•lyE¼Ü
(
c
,
”r
);

460  
C_ERR
;

462 *
b™s
 = 
Îb™s
;

463  
C_OK
;

464 
	}
}

471 
robj
 *
	$lookupSŒšgFÜB™Commªd
(
ş›Á
 *
c
, 
size_t
 
maxb™
) {

472 
size_t
 
by‹
 = 
maxb™
 >> 3;

473 
robj
 *
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

475 ià(
o
 =ğ
NULL
) {

476 
o
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ewËn
(
NULL
, 
by‹
+1));

477 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],
o
);

479 ià(
	`checkTy³
(
c
,
o
,
OBJ_STRING
)è 
NULL
;

480 
o
 = 
	`dbUnsh¬eSŒšgV®ue
(
c
->
db
,c->
¬gv
[1],o);

481 
o
->
±r
 = 
	`sdsgrowz”o
(o->±r,
by‹
+1);

483  
o
;

484 
	}
}

499 *
	$g‘ObjeùR—dOÆySŒšg
(
robj
 *
o
, *
Ën
, *
Îbuf
) {

500 
	`£rv”As£¹
(
o
->
ty³
 =ğ
OBJ_STRING
);

501 *
p
 = 
NULL
;

505 ià(
o
 && o->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

506 
p
 = (*è
Îbuf
;

507 ià(
Ën
è*ËÀğ
	`Î2¡ršg
(
Îbuf
,
LONG_STR_SIZE
,()
o
->
±r
);

508 } ià(
o
) {

509 
p
 = (*è
o
->
±r
;

510 ià(
Ën
è*ËÀğ
	`sd¦’
(
o
->
±r
);

512 ià(
Ën
) *len = 0;

514  
p
;

515 
	}
}

518 
	$£tb™Commªd
(
ş›Á
 *
c
) {

519 
robj
 *
o
;

520 *
”r
 = "bit is‚ot‡n integer or out of„ange";

521 
size_t
 
b™off£t
;

522 
ssize_t
 
by‹
, 
b™
;

523 
by‹v®
, 
b™v®
;

524 
Ú
;

526 ià(
	`g‘B™Off£tFromArgum’t
(
c
,c->
¬gv
[2],&
b™off£t
,0,0è!ğ
C_OK
)

529 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
Ú
,
”r
è!ğ
C_OK
)

533 ià(
Ú
 & ~1) {

534 
	`addR•lyE¼Ü
(
c
,
”r
);

538 ià((
o
 = 
	`lookupSŒšgFÜB™Commªd
(
c
,
b™off£t
)è=ğ
NULL
) ;

541 
by‹
 = 
b™off£t
 >> 3;

542 
by‹v®
 = ((
ušt8_t
*)
o
->
±r
)[
by‹
];

543 
b™
 = 7 - (
b™off£t
 & 0x7);

544 
b™v®
 = 
by‹v®
 & (1 << 
b™
);

547 
by‹v®
 &ğ~(1 << 
b™
);

548 
by‹v®
 |ğ((
Ú
 & 0x1è<< 
b™
);

549 ((
ušt8_t
*)
o
->
±r
)[
by‹
] = 
by‹v®
;

550 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

551 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"£tb™",
c
->
¬gv
[1],c->
db
->
id
);

552 
£rv”
.
dœty
++;

553 
	`addR•ly
(
c
, 
b™v®
 ? 
sh¬ed
.
cÚe
 : sh¬ed.
cz”o
);

554 
	}
}

557 
	$g‘b™Commªd
(
ş›Á
 *
c
) {

558 
robj
 *
o
;

559 
Îbuf
[32];

560 
size_t
 
b™off£t
;

561 
size_t
 
by‹
, 
b™
;

562 
size_t
 
b™v®
 = 0;

564 ià(
	`g‘B™Off£tFromArgum’t
(
c
,c->
¬gv
[2],&
b™off£t
,0,0è!ğ
C_OK
)

567 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

568 
	`checkTy³
(
c
,
o
,
OBJ_STRING
)) ;

570 
by‹
 = 
b™off£t
 >> 3;

571 
b™
 = 7 - (
b™off£t
 & 0x7);

572 ià(
	`sdsEncodedObjeù
(
o
)) {

573 ià(
by‹
 < 
	`sd¦’
(
o
->
±r
))

574 
b™v®
 = ((
ušt8_t
*)
o
->
±r
)[
by‹
] & (1 << 
b™
);

576 ià(
by‹
 < (
size_t
)
	`Î2¡ršg
(
Îbuf
,Ölbuf),()
o
->
±r
))

577 
b™v®
 = 
Îbuf
[
by‹
] & (1 << 
b™
);

580 
	`addR•ly
(
c
, 
b™v®
 ? 
sh¬ed
.
cÚe
 : sh¬ed.
cz”o
);

581 
	}
}

584 
	$b™İCommªd
(
ş›Á
 *
c
) {

585 *
İÇme
 = 
c
->
¬gv
[1]->
±r
;

586 
robj
 *
o
, *
rg‘key
 = 
c
->
¬gv
[2];

587 
İ
, 
j
, 
numkeys
;

588 
robj
 **
objeùs
;

589 **
¤c
;

590 *
Ën
, 
maxËn
 = 0;

592 
mšËn
 = 0;

593 *
»s
 = 
NULL
;

596 ià((
İÇme
[0] =ğ'a' || o²ame[0] =ğ'A'è&& !
	`¡rÿ£cmp
(opname,"and"))

597 
İ
 = 
BITOP_AND
;

598 if((
İÇme
[0] =ğ'o' || o²ame[0] =ğ'O'è&& !
	`¡rÿ£cmp
(opname,"or"))

599 
İ
 = 
BITOP_OR
;

600 if((
İÇme
[0] =ğ'x' || o²ame[0] =ğ'X'è&& !
	`¡rÿ£cmp
(opname,"xor"))

601 
İ
 = 
BITOP_XOR
;

602 if((
İÇme
[0] =ğ'n' || o²ame[0] =ğ'N'è&& !
	`¡rÿ£cmp
(opname,"not"))

603 
İ
 = 
BITOP_NOT
;

605 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

610 ià(
İ
 =ğ
BITOP_NOT
 && 
c
->
¬gc
 != 4) {

611 
	`addR•lyE¼Ü
(
c
,"BITOP NOT must be called with‡ single source key.");

616 
numkeys
 = 
c
->
¬gc
 - 3;

617 
¤c
 = 
	`zm®loc
((*è* 
numkeys
);

618 
Ën
 = 
	`zm®loc
((è* 
numkeys
);

619 
objeùs
 = 
	`zm®loc
((
robj
*è* 
numkeys
);

620 
j
 = 0; j < 
numkeys
; j++) {

621 
o
 = 
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[
j
+3]);

623 ià(
o
 =ğ
NULL
) {

624 
objeùs
[
j
] = 
NULL
;

625 
¤c
[
j
] = 
NULL
;

626 
Ën
[
j
] = 0;

627 
mšËn
 = 0;

631 ià(
	`checkTy³
(
c
,
o
,
OBJ_STRING
)) {

632 
i
;

633 
i
 = 0; i < 
j
; i++) {

634 ià(
objeùs
[
i
])

635 
	`deüRefCouÁ
(
objeùs
[
i
]);

637 
	`zä“
(
¤c
);

638 
	`zä“
(
Ën
);

639 
	`zä“
(
objeùs
);

642 
objeùs
[
j
] = 
	`g‘DecodedObjeù
(
o
);

643 
¤c
[
j
] = 
objeùs
[j]->
±r
;

644 
Ën
[
j
] = 
	`sd¦’
(
objeùs
[j]->
±r
);

645 ià(
Ën
[
j
] > 
maxËn
) maxlen =†en[j];

646 ià(
j
 =ğ0 || 
Ën
[j] < 
mšËn
) minlen =†en[j];

650 ià(
maxËn
) {

651 
»s
 = (*è
	`sd¢ewËn
(
NULL
,
maxËn
);

652 
ouut
, 
by‹
;

653 
i
;

658 
j
 = 0;

659 ià(
mšËn
 >ğ()*4 && 
numkeys
 <= 16) {

660 *
Í
[16];

661 *
Ìes
 = (*è
»s
;

664 
	`memıy
(
Í
,
¤c
,(*)*
numkeys
);

665 
	`memıy
(
»s
,
¤c
[0],
mšËn
);

668 ià(
İ
 =ğ
BITOP_AND
) {

669 
mšËn
 >= ()*4) {

670 
i
 = 1; i < 
numkeys
; i++) {

671 
Ìes
[0] &ğ
Í
[
i
][0];

672 
Ìes
[1] &ğ
Í
[
i
][1];

673 
Ìes
[2] &ğ
Í
[
i
][2];

674 
Ìes
[3] &ğ
Í
[
i
][3];

675 
Í
[
i
]+=4;

677 
Ìes
+=4;

678 
j
 += ()*4;

679 
mšËn
 -= ()*4;

681 } ià(
İ
 =ğ
BITOP_OR
) {

682 
mšËn
 >= ()*4) {

683 
i
 = 1; i < 
numkeys
; i++) {

684 
Ìes
[0] |ğ
Í
[
i
][0];

685 
Ìes
[1] |ğ
Í
[
i
][1];

686 
Ìes
[2] |ğ
Í
[
i
][2];

687 
Ìes
[3] |ğ
Í
[
i
][3];

688 
Í
[
i
]+=4;

690 
Ìes
+=4;

691 
j
 += ()*4;

692 
mšËn
 -= ()*4;

694 } ià(
İ
 =ğ
BITOP_XOR
) {

695 
mšËn
 >= ()*4) {

696 
i
 = 1; i < 
numkeys
; i++) {

697 
Ìes
[0] ^ğ
Í
[
i
][0];

698 
Ìes
[1] ^ğ
Í
[
i
][1];

699 
Ìes
[2] ^ğ
Í
[
i
][2];

700 
Ìes
[3] ^ğ
Í
[
i
][3];

701 
Í
[
i
]+=4;

703 
Ìes
+=4;

704 
j
 += ()*4;

705 
mšËn
 -= ()*4;

707 } ià(
İ
 =ğ
BITOP_NOT
) {

708 
mšËn
 >= ()*4) {

709 
Ìes
[0] = ~lres[0];

710 
Ìes
[1] = ~lres[1];

711 
Ìes
[2] = ~lres[2];

712 
Ìes
[3] = ~lres[3];

713 
Ìes
+=4;

714 
j
 += ()*4;

715 
mšËn
 -= ()*4;

721 ; 
j
 < 
maxËn
; j++) {

722 
ouut
 = (
Ën
[0] <ğ
j
è? 0 : 
¤c
[0][j];

723 ià(
İ
 =ğ
BITOP_NOT
è
ouut
 = ~output;

724 
i
 = 1; i < 
numkeys
; i++) {

725 
by‹
 = (
Ën
[
i
] <ğ
j
è? 0 : 
¤c
[i][j];

726 
İ
) {

727 
BITOP_AND
: 
ouut
 &ğ
by‹
; ;

728 
BITOP_OR
: 
ouut
 |ğ
by‹
; ;

729 
BITOP_XOR
: 
ouut
 ^ğ
by‹
; ;

732 
»s
[
j
] = 
ouut
;

735 
j
 = 0; j < 
numkeys
; j++) {

736 ià(
objeùs
[
j
])

737 
	`deüRefCouÁ
(
objeùs
[
j
]);

739 
	`zä“
(
¤c
);

740 
	`zä“
(
Ën
);

741 
	`zä“
(
objeùs
);

744 ià(
maxËn
) {

745 
o
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
»s
);

746 
	`£tKey
(
c
->
db
,
rg‘key
,
o
);

747 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"£t",
rg‘key
,
c
->
db
->
id
);

748 
	`deüRefCouÁ
(
o
);

749 } ià(
	`dbD–‘e
(
c
->
db
,
rg‘key
)) {

750 
	`sigÇlModif›dKey
(
c
->
db
,
rg‘key
);

751 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
rg‘key
,
c
->
db
->
id
);

753 
£rv”
.
dœty
++;

754 
	`addR•lyLÚgLÚg
(
c
,
maxËn
);

755 
	}
}

758 
	$b™couÁCommªd
(
ş›Á
 *
c
) {

759 
robj
 *
o
;

760 
¡¬t
, 
’d
, 
¡¾’
;

761 *
p
;

762 
Îbuf
[
LONG_STR_SIZE
];

765 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

766 
	`checkTy³
(
c
,
o
,
OBJ_STRING
)) ;

767 
p
 = 
	`g‘ObjeùR—dOÆySŒšg
(
o
,&
¡¾’
,
Îbuf
);

770 ià(
c
->
¬gc
 == 4) {

771 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
¡¬t
,
NULL
è!ğ
C_OK
)

773 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
’d
,
NULL
è!ğ
C_OK
)

776 ià(
¡¬t
 < 0 && 
’d
 < 0 && start >ƒnd) {

777 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

780 ià(
¡¬t
 < 0è¡¬ˆğ
¡¾’
+start;

781 ià(
’d
 < 0è’d = 
¡¾’
+end;

782 ià(
¡¬t
 < 0) start = 0;

783 ià(
’d
 < 0)ƒnd = 0;

784 ià(
’d
 >ğ
¡¾’
)ƒnd = strlen-1;

785 } ià(
c
->
¬gc
 == 2) {

787 
¡¬t
 = 0;

788 
’d
 = 
¡¾’
-1;

791 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

797 ià(
¡¬t
 > 
’d
) {

798 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

800 
by‹s
 = 
’d
-
¡¬t
+1;

802 
	`addR•lyLÚgLÚg
(
c
,
	`»disPİcouÁ
(
p
+
¡¬t
,
by‹s
));

804 
	}
}

807 
	$b™posCommªd
(
ş›Á
 *
c
) {

808 
robj
 *
o
;

809 
b™
, 
¡¬t
, 
’d
, 
¡¾’
;

810 *
p
;

811 
Îbuf
[
LONG_STR_SIZE
];

812 
’d_giv’
 = 0;

816 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
b™
,
NULL
è!ğ
C_OK
)

818 ià(
b™
 != 0 && bit != 1) {

819 
	`addR•lyE¼Ü
(
c
, "The bit‡rgument must be 1 or 0.");

826 ià((
o
 = 
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[1])è=ğ
NULL
) {

827 
	`addR•lyLÚgLÚg
(
c
, 
b™
 ? -1 : 0);

830 ià(
	`checkTy³
(
c
,
o
,
OBJ_STRING
)) ;

831 
p
 = 
	`g‘ObjeùR—dOÆySŒšg
(
o
,&
¡¾’
,
Îbuf
);

834 ià(
c
->
¬gc
 == 4 || c->argc == 5) {

835 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
¡¬t
,
NULL
è!ğ
C_OK
)

837 ià(
c
->
¬gc
 == 5) {

838 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[4],&
’d
,
NULL
è!ğ
C_OK
)

840 
’d_giv’
 = 1;

842 
’d
 = 
¡¾’
-1;

845 ià(
¡¬t
 < 0è¡¬ˆğ
¡¾’
+start;

846 ià(
’d
 < 0è’d = 
¡¾’
+end;

847 ià(
¡¬t
 < 0) start = 0;

848 ià(
’d
 < 0)ƒnd = 0;

849 ià(
’d
 >ğ
¡¾’
)ƒnd = strlen-1;

850 } ià(
c
->
¬gc
 == 3) {

852 
¡¬t
 = 0;

853 
’d
 = 
¡¾’
-1;

856 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

862 ià(
¡¬t
 > 
’d
) {

863 
	`addR•lyLÚgLÚg
(
c
, -1);

865 
by‹s
 = 
’d
-
¡¬t
+1;

866 
pos
 = 
	`»disB™pos
(
p
+
¡¬t
,
by‹s
,
b™
);

875 ià(
’d_giv’
 && 
b™
 =ğ0 && 
pos
 =ğ
by‹s
*8) {

876 
	`addR•lyLÚgLÚg
(
c
,-1);

879 ià(
pos
 !ğ-1èpo +ğ
¡¬t
*8;

880 
	`addR•lyLÚgLÚg
(
c
,
pos
);

882 
	}
}

894 
	sb™f›ldOp
 {

895 
ušt64_t
 
	moff£t
;

896 
št64_t
 
	mi64
;

897 
	mİcode
;

898 
	mowty³
;

899 
	mb™s
;

900 
	msign
;

903 
	$b™f›ldCommªd
(
ş›Á
 *
c
) {

904 
robj
 *
o
;

905 
size_t
 
b™off£t
;

906 
j
, 
numİs
 = 0, 
chªges
 = 0;

907 
b™f›ldOp
 *
İs
 = 
NULL
;

908 
owty³
 = 
BFOVERFLOW_WRAP
;

909 
»adÚly
 = 1;

910 
size_t
 
hige¡_wr™e_off£t
 = 0;

912 
j
 = 2; j < 
c
->
¬gc
; j++) {

913 
»m¬gs
 = 
c
->
¬gc
-
j
-1;

914 *
subcmd
 = 
c
->
¬gv
[
j
]->
±r
;

915 
İcode
;

916 
i64
 = 0;

917 
sign
 = 0;

918 
b™s
 = 0;

920 ià(!
	`¡rÿ£cmp
(
subcmd
,"g‘"è&& 
»m¬gs
 >= 2)

921 
İcode
 = 
BITFIELDOP_GET
;

922 ià(!
	`¡rÿ£cmp
(
subcmd
,"£t"è&& 
»m¬gs
 >= 3)

923 
İcode
 = 
BITFIELDOP_SET
;

924 ià(!
	`¡rÿ£cmp
(
subcmd
,"šüby"è&& 
»m¬gs
 >= 3)

925 
İcode
 = 
BITFIELDOP_INCRBY
;

926 ià(!
	`¡rÿ£cmp
(
subcmd
,"ov”æow"è&& 
»m¬gs
 >= 1) {

927 *
owty³Çme
 = 
c
->
¬gv
[
j
+1]->
±r
;

928 
j
++;

929 ià(!
	`¡rÿ£cmp
(
owty³Çme
,"wrap"))

930 
owty³
 = 
BFOVERFLOW_WRAP
;

931 ià(!
	`¡rÿ£cmp
(
owty³Çme
,"sat"))

932 
owty³
 = 
BFOVERFLOW_SAT
;

933 ià(!
	`¡rÿ£cmp
(
owty³Çme
,"fail"))

934 
owty³
 = 
BFOVERFLOW_FAIL
;

936 
	`addR•lyE¼Ü
(
c
,"Invalid OVERFLOWype specified");

937 
	`zä“
(
İs
);

942 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

943 
	`zä“
(
İs
);

948 ià(
	`g‘B™f›ldTy³FromArgum’t
(
c
,c->
¬gv
[
j
+1],&
sign
,&
b™s
è!ğ
C_OK
) {

949 
	`zä“
(
İs
);

953 ià(
	`g‘B™Off£tFromArgum’t
(
c
,c->
¬gv
[
j
+2],&
b™off£t
,1,
b™s
è!ğ
C_OK
){

954 
	`zä“
(
İs
);

958 ià(
İcode
 !ğ
BITFIELDOP_GET
) {

959 
»adÚly
 = 0;

960 ià(
hige¡_wr™e_off£t
 < 
b™off£t
 + 
b™s
 - 1)

961 
hige¡_wr™e_off£t
 = 
b™off£t
 + 
b™s
 - 1;

963 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[
j
+3],&
i64
,
NULL
è!ğ
C_OK
){

964 
	`zä“
(
İs
);

970 
İs
 = 
	`z»®loc
(İs,(*İs)*(
numİs
+1));

971 
İs
[
numİs
].
off£t
 = 
b™off£t
;

972 
İs
[
numİs
].
i64
 = i64;

973 
İs
[
numİs
].
İcode
 = opcode;

974 
İs
[
numİs
].
owty³
 = owtype;

975 
İs
[
numİs
].
b™s
 = bits;

976 
İs
[
numİs
].
sign
 = sign;

977 
numİs
++;

979 
j
 +ğ3 - (
İcode
 =ğ
BITFIELDOP_GET
);

982 ià(
»adÚly
) {

985 
o
 = 
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[1]);

986 ià(
o
 !ğ
NULL
 && 
	`checkTy³
(
c
,o,
OBJ_STRING
)) ;

990 ià((
o
 = 
	`lookupSŒšgFÜB™Commªd
(
c
,

991 
hige¡_wr™e_off£t
)è=ğ
NULL
) ;

994 
	`addR•lyMuÉiBulkL’
(
c
,
numİs
);

997 
j
 = 0; j < 
numİs
; j++) {

998 
b™f›ldOp
 *
thisİ
 = 
İs
+
j
;

1001 ià(
thisİ
->
İcode
 =ğ
BITFIELDOP_SET
 ||

1002 
thisİ
->
İcode
 =ğ
BITFIELDOP_INCRBY
)

1011 ià(
thisİ
->
sign
) {

1012 
št64_t
 
Şdv®
, 
Ãwv®
, 
w¿µed
, 
»tv®
;

1013 
ov”æow
;

1015 
Şdv®
 = 
	`g‘SigÃdB™f›ld
(
o
->
±r
,
thisİ
->
off£t
,

1016 
thisİ
->
b™s
);

1018 ià(
thisİ
->
İcode
 =ğ
BITFIELDOP_INCRBY
) {

1019 
Ãwv®
 = 
Şdv®
 + 
thisİ
->
i64
;

1020 
ov”æow
 = 
	`checkSigÃdB™f›ldOv”æow
(
Şdv®
,

1021 
thisİ
->
i64
,thisİ->
b™s
,thisİ->
owty³
,&
w¿µed
);

1022 ià(
ov”æow
è
Ãwv®
 = 
w¿µed
;

1023 
»tv®
 = 
Ãwv®
;

1025 
Ãwv®
 = 
thisİ
->
i64
;

1026 
ov”æow
 = 
	`checkSigÃdB™f›ldOv”æow
(
Ãwv®
,

1027 0,
thisİ
->
b™s
,thisİ->
owty³
,&
w¿µed
);

1028 ià(
ov”æow
è
Ãwv®
 = 
w¿µed
;

1029 
»tv®
 = 
Şdv®
;

1034 ià(!(
ov”æow
 && 
thisİ
->
owty³
 =ğ
BFOVERFLOW_FAIL
)) {

1035 
	`addR•lyLÚgLÚg
(
c
,
»tv®
);

1036 
	`£tSigÃdB™f›ld
(
o
->
±r
,
thisİ
->
off£t
,

1037 
thisİ
->
b™s
,
Ãwv®
);

1039 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

1042 
ušt64_t
 
Şdv®
, 
Ãwv®
, 
w¿µed
, 
»tv®
;

1043 
ov”æow
;

1045 
Şdv®
 = 
	`g‘UnsigÃdB™f›ld
(
o
->
±r
,
thisİ
->
off£t
,

1046 
thisİ
->
b™s
);

1048 ià(
thisİ
->
İcode
 =ğ
BITFIELDOP_INCRBY
) {

1049 
Ãwv®
 = 
Şdv®
 + 
thisİ
->
i64
;

1050 
ov”æow
 = 
	`checkUnsigÃdB™f›ldOv”æow
(
Şdv®
,

1051 
thisİ
->
i64
,thisİ->
b™s
,thisİ->
owty³
,&
w¿µed
);

1052 ià(
ov”æow
è
Ãwv®
 = 
w¿µed
;

1053 
»tv®
 = 
Ãwv®
;

1055 
Ãwv®
 = 
thisİ
->
i64
;

1056 
ov”æow
 = 
	`checkUnsigÃdB™f›ldOv”æow
(
Ãwv®
,

1057 0,
thisİ
->
b™s
,thisİ->
owty³
,&
w¿µed
);

1058 ià(
ov”æow
è
Ãwv®
 = 
w¿µed
;

1059 
»tv®
 = 
Şdv®
;

1063 ià(!(
ov”æow
 && 
thisİ
->
owty³
 =ğ
BFOVERFLOW_FAIL
)) {

1064 
	`addR•lyLÚgLÚg
(
c
,
»tv®
);

1065 
	`£tUnsigÃdB™f›ld
(
o
->
±r
,
thisİ
->
off£t
,

1066 
thisİ
->
b™s
,
Ãwv®
);

1068 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

1071 
chªges
++;

1074 
buf
[9];

1075 
¡¾’
 = 0;

1076 *
¤c
 = 
NULL
;

1077 
Îbuf
[
LONG_STR_SIZE
];

1079 ià(
o
 !ğ
NULL
)

1080 
¤c
 = 
	`g‘ObjeùR—dOÆySŒšg
(
o
,&
¡¾’
,
Îbuf
);

1086 
	`mem£t
(
buf
,0,9);

1087 
i
;

1088 
size_t
 
by‹
 = 
thisİ
->
off£t
 >> 3;

1089 
i
 = 0; i < 9; i++) {

1090 ià(
¤c
 =ğ
NULL
 || 
i
+
by‹
 >ğ(
size_t
)
¡¾’
) ;

1091 
buf
[
i
] = 
¤c
[i+
by‹
];

1096 ià(
thisİ
->
sign
) {

1097 
št64_t
 
v®
 = 
	`g‘SigÃdB™f›ld
(
buf
,
thisİ
->
off£t
-(
by‹
*8),

1098 
thisİ
->
b™s
);

1099 
	`addR•lyLÚgLÚg
(
c
,
v®
);

1101 
ušt64_t
 
v®
 = 
	`g‘UnsigÃdB™f›ld
(
buf
,
thisİ
->
off£t
-(
by‹
*8),

1102 
thisİ
->
b™s
);

1103 
	`addR•lyLÚgLÚg
(
c
,
v®
);

1108 ià(
chªges
) {

1109 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

1110 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"£tb™",
c
->
¬gv
[1],c->
db
->
id
);

1111 
£rv”
.
dœty
 +ğ
chªges
;

1113 
	`zä“
(
İs
);

1114 
	}
}

	@src/blocked.c

66 
	~"£rv”.h
"

76 
	$g‘TimeoutFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
objeù
, 
m¡ime_t
 *
timeout
, 
un™
) {

77 
tv®
;

79 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,
objeù
,&
tv®
,

80 "timeouˆi nÙ‡Àš‹g” o¸ouˆoà¿nge"è!ğ
C_OK
)

81  
C_ERR
;

83 ià(
tv®
 < 0) {

84 
	`addR•lyE¼Ü
(
c
,"timeout is‚egative");

85  
C_ERR
;

88 ià(
tv®
 > 0) {

89 ià(
un™
 =ğ
UNIT_SECONDS
è
tv®
 *= 1000;

90 
tv®
 +ğ
	`m¡ime
();

92 *
timeout
 = 
tv®
;

94  
C_OK
;

95 
	}
}

100 
	$blockCl›Á
(
ş›Á
 *
c
, 
bty³
) {

101 
c
->
æags
 |ğ
CLIENT_BLOCKED
;

102 
c
->
bty³
 = btype;

103 
£rv”
.
bpİ_blocked_ş›Ás
++;

104 
	}
}

109 
	$´oûssUnblockedCl›Ás
() {

110 
li¡Node
 *
Ê
;

111 
ş›Á
 *
c
;

113 
	`li¡L’gth
(
£rv”
.
unblocked_ş›Ás
)) {

114 
Ê
 = 
	`li¡Fœ¡
(
£rv”
.
unblocked_ş›Ás
);

115 
	`£rv”As£¹
(
Ê
 !ğ
NULL
);

116 
c
 = 
Ê
->
v®ue
;

117 
	`li¡D–Node
(
£rv”
.
unblocked_ş›Ás
,
Ê
);

118 
c
->
æags
 &ğ~
CLIENT_UNBLOCKED
;

124 ià(!(
c
->
æags
 & 
CLIENT_BLOCKED
)) {

125 ià(
c
->
qu”ybuf
 && 
	`sd¦’
(c->querybuf) > 0) {

126 
	`´oûssIÅutBufãr
(
c
);

130 
	}
}

134 
	$unblockCl›Á
(
ş›Á
 *
c
) {

135 ià(
c
->
bty³
 =ğ
BLOCKED_LIST
) {

136 
	`unblockCl›ÁWa™šgD©a
(
c
);

137 } ià(
c
->
bty³
 =ğ
BLOCKED_WAIT
) {

138 
	`unblockCl›ÁWa™šgR•liÿs
(
c
);

140 
	`£rv”Pªic
("Unknown btype in unblockClient().");

144 
c
->
æags
 &ğ~
CLIENT_BLOCKED
;

145 
c
->
bty³
 = 
BLOCKED_NONE
;

146 
£rv”
.
bpİ_blocked_ş›Ás
--;

149 ià(!(
c
->
æags
 & 
CLIENT_UNBLOCKED
)) {

150 
c
->
æags
 |ğ
CLIENT_UNBLOCKED
;

151 
	`li¡AddNodeTa
(
£rv”
.
unblocked_ş›Ás
,
c
);

153 
	}
}

157 
	$»¶yToBlockedCl›ÁTimedOut
(
ş›Á
 *
c
) {

158 ià(
c
->
bty³
 =ğ
BLOCKED_LIST
) {

159 
	`addR•ly
(
c
,
sh¬ed
.
nuÎmuÉibulk
);

160 } ià(
c
->
bty³
 =ğ
BLOCKED_WAIT
) {

161 
	`addR•lyLÚgLÚg
(
c
,
	`»¶iÿtiÚCouÁAcksByOff£t
(c->
bpİ
.
»¶off£t
));

163 
	`£rv”Pªic
("Unknown btype in„eplyToBlockedClientTimedOut().");

165 
	}
}

174 
	$discÚÃùAÎBlockedCl›Ás
() {

175 
li¡Node
 *
Ê
;

176 
li¡I‹r
 
li
;

178 
	`li¡Rewšd
(
£rv”
.
ş›Ás
,&
li
);

179 (
Ê
 = 
	`li¡Next
(&
li
))) {

180 
ş›Á
 *
c
 = 
	`li¡NodeV®ue
(
Ê
);

182 ià(
c
->
æags
 & 
CLIENT_BLOCKED
) {

183 
	`addR•lySds
(
c
,
	`sd¢ew
(

186 
	`unblockCl›Á
(
c
);

187 
c
->
æags
 |ğ
CLIENT_CLOSE_AFTER_REPLY
;

190 
	}
}

	@src/cluster.c

31 
	~"£rv”.h
"

32 
	~"şu¡”.h
"

33 
	~"’dŸncÚv.h
"

35 
	~<sys/ty³s.h
>

36 
	~<sys/sock‘.h
>

37 
	~<¬·/š‘.h
>

38 
	~<fú.h
>

39 
	~<uni¡d.h
>

40 
	~<sys/sock‘.h
>

41 
	~<sys/¡©.h
>

42 
	~<sys/fe.h
>

43 
	~<m©h.h
>

48 
şu¡”Node
 *
	gmy£lf
 = 
NULL
;

50 
şu¡”Node
 *
ü—‹Clu¡”Node
(*
nod’ame
, 
æags
);

51 
şu¡”AddNode
(
şu¡”Node
 *
node
);

52 
şu¡”Acû±HªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
);

53 
şu¡”R—dHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
);

54 
şu¡”S’dPšg
(
şu¡”Lšk
 *
lšk
, 
ty³
);

55 
şu¡”S’dFa
(*
nod’ame
);

56 
şu¡”S’dFaov”AuthIfN“ded
(
şu¡”Node
 *
node
, 
şu¡”Msg
 *
»que¡
);

57 
şu¡”Upd©eS‹
();

58 
şu¡”NodeG‘SlÙB™
(
şu¡”Node
 *
n
, 
¦Ù
);

59 
sds
 
şu¡”G’NodesDesütiÚ
(
f‹r
);

60 
şu¡”Node
 *
şu¡”LookupNode
(*
Çme
);

61 
şu¡”NodeAddSÏve
(
şu¡”Node
 *
ma¡”
, clu¡”Nod*
¦ave
);

62 
şu¡”AddSlÙ
(
şu¡”Node
 *
n
, 
¦Ù
);

63 
şu¡”D–SlÙ
(
¦Ù
);

64 
şu¡”D–NodeSlÙs
(
şu¡”Node
 *
node
);

65 
şu¡”NodeS‘SlÙB™
(
şu¡”Node
 *
n
, 
¦Ù
);

66 
şu¡”S‘Ma¡”
(
şu¡”Node
 *
n
);

67 
şu¡”HªdËSÏveFaov”
();

68 
şu¡”HªdËSÏveMig¿tiÚ
(
max_¦aves
);

69 
b™m­Te¡B™
(*
b™m­
, 
pos
);

70 
şu¡”DoBefÜeSË•
(
æags
);

71 
şu¡”S’dUpd©e
(
şu¡”Lšk
 *
lšk
, 
şu¡”Node
 *
node
);

72 
»£tMªu®Faov”
();

73 
şu¡”Clo£AÎSlÙs
();

74 
şu¡”S‘NodeAsMa¡”
(
şu¡”Node
 *
n
);

75 
şu¡”D–Node
(
şu¡”Node
 *
d–node
);

76 
sds
 
»´e£ÁClu¡”NodeFÏgs
(sd 
ci
, 
ušt16_t
 
æags
);

77 
ušt64_t
 
şu¡”G‘MaxEpoch
();

78 
şu¡”BumpCÚfigEpochW™houtCÚ£nsus
();

90 
	$şu¡”LßdCÚfig
(*
f’ame
) {

91 
FILE
 *
å
 = 
	`fİ’
(
f’ame
,"r");

92 
¡©
 
sb
;

93 *
lše
;

94 
maxlše
, 
j
;

96 ià(
å
 =ğ
NULL
) {

97 ià(
”ºo
 =ğ
ENOENT
) {

98  
C_ERR
;

100 
	`£rv”Log
(
LL_WARNING
,

102 
f’ame
, 
	`¡»¼Ü
(
”ºo
));

103 
	`ex™
(1);

109 ià(
	`f¡©
(
	`f’o
(
å
),&
sb
è!ğ-1 && sb.
¡_size
 == 0) {

110 
	`fşo£
(
å
);

111  
C_ERR
;

121 
maxlše
 = 1024+
CLUSTER_SLOTS
*128;

122 
lše
 = 
	`zm®loc
(
maxlše
);

123 
	`fg‘s
(
lše
,
maxlše
,
å
è!ğ
NULL
) {

124 
¬gc
;

125 
sds
 *
¬gv
;

126 
şu¡”Node
 *
n
, *
ma¡”
;

127 *
p
, *
s
;

132 ià(
lše
[0] == '\n' ||†ine[0] == '\0') ;

135 
¬gv
 = 
	`sds¥l™¬gs
(
lše
,&
¬gc
);

136 ià(
¬gv
 =ğ
NULL
è
fm‹¼
;

140 ià(
	`¡rÿ£cmp
(
¬gv
[0],"vars") == 0) {

141 
j
 = 1; j < 
¬gc
; j += 2) {

142 ià(
	`¡rÿ£cmp
(
¬gv
[
j
],"currentEpoch") == 0) {

143 
£rv”
.
şu¡”
->
cu¼’tEpoch
 =

144 
	`¡¹ouÎ
(
¬gv
[
j
+1],
NULL
,10);

145 } ià(
	`¡rÿ£cmp
(
¬gv
[
j
],"lastVoteEpoch") == 0) {

146 
£rv”
.
şu¡”
->
Ï¡VÙeEpoch
 =

147 
	`¡¹ouÎ
(
¬gv
[
j
+1],
NULL
,10);

149 
	`£rv”Log
(
LL_WARNING
,

151 
¬gv
[
j
]);

154 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

159 ià(
¬gc
 < 8è
fm‹¼
;

162 
n
 = 
	`şu¡”LookupNode
(
¬gv
[0]);

163 ià(!
n
) {

164 
n
 = 
	`ü—‹Clu¡”Node
(
¬gv
[0],0);

165 
	`şu¡”AddNode
(
n
);

168 ià((
p
 = 
	`¡¼chr
(
¬gv
[1],':')è=ğ
NULL
è
fm‹¼
;

169 *
p
 = '\0';

170 
	`memıy
(
n
->

,
¬gv
[1],
	`¡¾’
(argv[1])+1);

171 
n
->
pÜt
 = 
	`©oi
(
p
+1);

174 
p
 = 
s
 = 
¬gv
[2];

175 
p
) {

176 
p
 = 
	`¡rchr
(
s
,',');

177 ià(
p
) *p = '\0';

178 ià(!
	`¡rÿ£cmp
(
s
,"myself")) {

179 
	`£rv”As£¹
(
£rv”
.
şu¡”
->
my£lf
 =ğ
NULL
);

180 
my£lf
 = 
£rv”
.
şu¡”
->my£làğ
n
;

181 
n
->
æags
 |ğ
CLUSTER_NODE_MYSELF
;

182 } ià(!
	`¡rÿ£cmp
(
s
,"master")) {

183 
n
->
æags
 |ğ
CLUSTER_NODE_MASTER
;

184 } ià(!
	`¡rÿ£cmp
(
s
,"slave")) {

185 
n
->
æags
 |ğ
CLUSTER_NODE_SLAVE
;

186 } ià(!
	`¡rÿ£cmp
(
s
,"fail?")) {

187 
n
->
æags
 |ğ
CLUSTER_NODE_PFAIL
;

188 } ià(!
	`¡rÿ£cmp
(
s
,"fail")) {

189 
n
->
æags
 |ğ
CLUSTER_NODE_FAIL
;

190 
n
->
ç_time
 = 
	`m¡ime
();

191 } ià(!
	`¡rÿ£cmp
(
s
,"handshake")) {

192 
n
->
æags
 |ğ
CLUSTER_NODE_HANDSHAKE
;

193 } ià(!
	`¡rÿ£cmp
(
s
,"noaddr")) {

194 
n
->
æags
 |ğ
CLUSTER_NODE_NOADDR
;

195 } ià(!
	`¡rÿ£cmp
(
s
,"noflags")) {

198 
	`£rv”Pªic
("Unknown flag in„edis cluster config file");

200 ià(
p
è
s
 =…+1;

205 ià(
¬gv
[3][0] != '-') {

206 
ma¡”
 = 
	`şu¡”LookupNode
(
¬gv
[3]);

207 ià(!
ma¡”
) {

208 
ma¡”
 = 
	`ü—‹Clu¡”Node
(
¬gv
[3],0);

209 
	`şu¡”AddNode
(
ma¡”
);

211 
n
->
¦aveof
 = 
ma¡”
;

212 
	`şu¡”NodeAddSÏve
(
ma¡”
,
n
);

216 ià(
	`©oi
(
¬gv
[4])è
n
->
pšg_£Á
 = 
	`m¡ime
();

217 ià(
	`©oi
(
¬gv
[5])è
n
->
pÚg_»ûived
 = 
	`m¡ime
();

220 
n
->
cÚfigEpoch
 = 
	`¡¹ouÎ
(
¬gv
[6],
NULL
,10);

223 
j
 = 8; j < 
¬gc
; j++) {

224 
¡¬t
, 
¡İ
;

226 ià(
¬gv
[
j
][0] == '[') {

228 
¦Ù
;

229 
dœeùiÚ
;

230 
şu¡”Node
 *
ú
;

232 
p
 = 
	`¡rchr
(
¬gv
[
j
],'-');

233 
	`£rv”As£¹
(
p
 !ğ
NULL
);

234 *
p
 = '\0';

235 
dœeùiÚ
 = 
p
[1];

236 
¦Ù
 = 
	`©oi
(
¬gv
[
j
]+1);

237 
p
 += 3;

238 
ú
 = 
	`şu¡”LookupNode
(
p
);

239 ià(!
ú
) {

240 
ú
 = 
	`ü—‹Clu¡”Node
(
p
,0);

241 
	`şu¡”AddNode
(
ú
);

243 ià(
dœeùiÚ
 == '>') {

244 
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
¦Ù
] = 
ú
;

246 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
¦Ù
] = 
ú
;

249 } ià((
p
 = 
	`¡rchr
(
¬gv
[
j
],'-')è!ğ
NULL
) {

250 *
p
 = '\0';

251 
¡¬t
 = 
	`©oi
(
¬gv
[
j
]);

252 
¡İ
 = 
	`©oi
(
p
+1);

254 
¡¬t
 = 
¡İ
 = 
	`©oi
(
¬gv
[
j
]);

256 
¡¬t
 <ğ
¡İ
è
	`şu¡”AddSlÙ
(
n
, start++);

259 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

262 ià(
£rv”
.
şu¡”
->
my£lf
 =ğ
NULL
è
fm‹¼
;

264 
	`zä“
(
lše
);

265 
	`fşo£
(
å
);

267 
	`£rv”Log
(
LL_NOTICE
,"NodcÚfigu¿tiÚ†ßded, I'm %.40s", 
my£lf
->
Çme
);

272 ià(
	`şu¡”G‘MaxEpoch
(è> 
£rv”
.
şu¡”
->
cu¼’tEpoch
) {

273 
£rv”
.
şu¡”
->
cu¼’tEpoch
 = 
	`şu¡”G‘MaxEpoch
();

275  
C_OK
;

277 
fm‹¼
:

278 
	`£rv”Log
(
LL_WARNING
,

280 
	`zä“
(
lše
);

281 ià(
å
è
	`fşo£
(fp);

282 
	`ex™
(1);

283 
	}
}

297 
	$şu¡”SaveCÚfig
(
do_fsync
) {

298 
sds
 
ci
;

299 
size_t
 
cÚ‹Á_size
;

300 
¡©
 
sb
;

301 
fd
;

303 
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 &ğ~
CLUSTER_TODO_SAVE_CONFIG
;

307 
ci
 = 
	`şu¡”G’NodesDesütiÚ
(
CLUSTER_NODE_HANDSHAKE
);

308 
ci
 = 
	`sdsÿrštf
(ci,"vars currentEpoch %llu†astVoteEpoch %llu\n",

309 (è
£rv”
.
şu¡”
->
cu¼’tEpoch
,

310 (è
£rv”
.
şu¡”
->
Ï¡VÙeEpoch
);

311 
cÚ‹Á_size
 = 
	`sd¦’
(
ci
);

313 ià((
fd
 = 
	`İ’
(
£rv”
.
şu¡”_cÚfigfe
,
O_WRONLY
|
O_CREAT
,0644))

314 =ğ-1è
”r
;

317 ià(
	`f¡©
(
fd
,&
sb
) != -1) {

318 ià(
sb
.
¡_size
 > (
off_t
)
cÚ‹Á_size
) {

319 
ci
 = 
	`sdsgrowz”o
(ci,
sb
.
¡_size
);

320 
	`mem£t
(
ci
+
cÚ‹Á_size
,'\n',
sb
.
¡_size
-content_size);

323 ià(
	`wr™e
(
fd
,
ci
,
	`sd¦’
(ci)è!ğ(
ssize_t
)sd¦’(ci)è
”r
;

324 ià(
do_fsync
) {

325 
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 &ğ~
CLUSTER_TODO_FSYNC_CONFIG
;

326 
	`fsync
(
fd
);

331 ià(
cÚ‹Á_size
 !ğ
	`sd¦’
(
ci
è&& 
	`árunÿ‹
(
fd
,content_size) == -1) {

334 
	`şo£
(
fd
);

335 
	`sdsä“
(
ci
);

338 
”r
:

339 ià(
fd
 !ğ-1è
	`şo£
(fd);

340 
	`sdsä“
(
ci
);

342 
	}
}

344 
	$şu¡”SaveCÚfigOrD›
(
do_fsync
) {

345 ià(
	`şu¡”SaveCÚfig
(
do_fsync
) == -1) {

346 
	`£rv”Log
(
LL_WARNING
,"Fatal: can't update cluster config file.");

347 
	`ex™
(1);

349 
	}
}

360 
	$şu¡”LockCÚfig
(*
f’ame
) {

365 #ià!
	`defšed
(
__sun
)

369 
fd
 = 
	`İ’
(
f’ame
,
O_WRONLY
|
O_CREAT
,0644);

370 ià(
fd
 == -1) {

371 
	`£rv”Log
(
LL_WARNING
,

373 
f’ame
, 
	`¡»¼Ü
(
”ºo
));

374  
C_ERR
;

377 ià(
	`æock
(
fd
,
LOCK_EX
|
LOCK_NB
) == -1) {

378 ià(
”ºo
 =ğ
EWOULDBLOCK
) {

379 
	`£rv”Log
(
LL_WARNING
,

383 "fes.", 
f’ame
);

385 
	`£rv”Log
(
LL_WARNING
,

386 "ImpossibËØlock %s: %s", 
f’ame
, 
	`¡»¼Ü
(
”ºo
));

388 
	`şo£
(
fd
);

389  
C_ERR
;

395  
C_OK
;

396 
	}
}

398 
	$şu¡”In™
() {

399 
§vecÚf
 = 0;

401 
£rv”
.
şu¡”
 = 
	`zm®loc
((
şu¡”S‹
));

402 
£rv”
.
şu¡”
->
my£lf
 = 
NULL
;

403 
£rv”
.
şu¡”
->
cu¼’tEpoch
 = 0;

404 
£rv”
.
şu¡”
->
¡©e
 = 
CLUSTER_FAIL
;

405 
£rv”
.
şu¡”
->
size
 = 1;

406 
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 = 0;

407 
£rv”
.
şu¡”
->
nodes
 = 
	`diùC»©e
(&
şu¡”NodesDiùTy³
,
NULL
);

408 
£rv”
.
şu¡”
->
nodes_bÏck_li¡
 =

409 
	`diùC»©e
(&
şu¡”NodesBÏckLi¡DiùTy³
,
NULL
);

410 
£rv”
.
şu¡”
->
çov”_auth_time
 = 0;

411 
£rv”
.
şu¡”
->
çov”_auth_couÁ
 = 0;

412 
£rv”
.
şu¡”
->
çov”_auth_¿nk
 = 0;

413 
£rv”
.
şu¡”
->
çov”_auth_•och
 = 0;

414 
£rv”
.
şu¡”
->
ÿÁ_çov”_»asÚ
 = 
CLUSTER_CANT_FAILOVER_NONE
;

415 
£rv”
.
şu¡”
->
Ï¡VÙeEpoch
 = 0;

416 
£rv”
.
şu¡”
->
¡©s_bus_mes§ges_£Á
 = 0;

417 
£rv”
.
şu¡”
->
¡©s_bus_mes§ges_»ûived
 = 0;

418 
	`mem£t
(
£rv”
.
şu¡”
->
¦Ùs
,0, (server.cluster->slots));

419 
	`şu¡”Clo£AÎSlÙs
();

423 ià(
	`şu¡”LockCÚfig
(
£rv”
.
şu¡”_cÚfigfe
è=ğ
C_ERR
)

424 
	`ex™
(1);

427 ià(
	`şu¡”LßdCÚfig
(
£rv”
.
şu¡”_cÚfigfe
è=ğ
C_ERR
) {

430 
my£lf
 = 
£rv”
.
şu¡”
->myself =

431 
	`ü—‹Clu¡”Node
(
NULL
,
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_MASTER
);

432 
	`£rv”Log
(
LL_NOTICE
,"No cluster configuration found, I'm %.40s",

433 
my£lf
->
Çme
);

434 
	`şu¡”AddNode
(
my£lf
);

435 
§vecÚf
 = 1;

437 ià(
§vecÚf
è
	`şu¡”SaveCÚfigOrD›
(1);

440 
£rv”
.
cfd_couÁ
 = 0;

445 ià(
£rv”
.
pÜt
 > (65535-
CLUSTER_PORT_INCR
)) {

446 
	`£rv”Log
(
LL_WARNING
, "Redis…ort‚umberoo high. "

451 
	`ex™
(1);

454 ià(
	`li¡’ToPÜt
(
£rv”
.
pÜt
+
CLUSTER_PORT_INCR
,

455 
£rv”
.
cfd
,&£rv”.
cfd_couÁ
è=ğ
C_ERR
)

457 
	`ex™
(1);

459 
j
;

461 
j
 = 0; j < 
£rv”
.
cfd_couÁ
; j++) {

462 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
, s”v”.
cfd
[
j
], 
AE_READABLE
,

463 
şu¡”Acû±HªdËr
, 
NULL
è=ğ
AE_ERR
)

464 
	`£rv”Pªic
("Unrecoverableƒrror creating Redis Cluster "

470 
£rv”
.
şu¡”
->
¦Ùs_to_keys
 = 
	`z¦C»©e
();

474 
my£lf
->
pÜt
 = 
£rv”
.port;

476 
£rv”
.
şu¡”
->
mf_’d
 = 0;

477 
	`»£tMªu®Faov”
();

478 
	}
}

489 
	$şu¡”Re£t
(
h¬d
) {

490 
diùI‹¿tÜ
 *
di
;

491 
diùEÁry
 *
de
;

492 
j
;

495 ià(
	`nodeIsSÏve
(
my£lf
)) {

496 
	`şu¡”S‘NodeAsMa¡”
(
my£lf
);

497 
	`»¶iÿtiÚUn£tMa¡”
();

498 
	`em±yDb
(
NULL
);

502 
	`şu¡”Clo£AÎSlÙs
();

503 
	`»£tMªu®Faov”
();

506 
j
 = 0; j < 
CLUSTER_SLOTS
; j++è
	`şu¡”D–SlÙ
(j);

509 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

510 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

511 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

513 ià(
node
 =ğ
my£lf
) ;

514 
	`şu¡”D–Node
(
node
);

516 
	`diùR–—£I‹¿tÜ
(
di
);

519 ià(
h¬d
) {

520 
sds
 
ŞdÇme
;

522 
£rv”
.
şu¡”
->
cu¼’tEpoch
 = 0;

523 
£rv”
.
şu¡”
->
Ï¡VÙeEpoch
 = 0;

524 
my£lf
->
cÚfigEpoch
 = 0;

525 
	`£rv”Log
(
LL_WARNING
, "configEpoch seto 0 via CLUSTER RESET HARD");

529 
ŞdÇme
 = 
	`sd¢ewËn
(
my£lf
->
Çme
, 
CLUSTER_NAMELEN
);

530 
	`diùD–‘e
(
£rv”
.
şu¡”
->
nodes
,
ŞdÇme
);

531 
	`sdsä“
(
ŞdÇme
);

532 
	`g‘RªdomHexCh¬s
(
my£lf
->
Çme
, 
CLUSTER_NAMELEN
);

533 
	`şu¡”AddNode
(
my£lf
);

534 
	`£rv”Log
(
LL_NOTICE
,"Nodh¬d„e£t,‚ow I'm %.40s", 
my£lf
->
Çme
);

538 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

539 
CLUSTER_TODO_UPDATE_STATE
|

540 
CLUSTER_TODO_FSYNC_CONFIG
);

541 
	}
}

547 
şu¡”Lšk
 *
	$ü—‹Clu¡”Lšk
(
şu¡”Node
 *
node
) {

548 
şu¡”Lšk
 *
lšk
 = 
	`zm®loc
((*link));

549 
lšk
->
ùime
 = 
	`m¡ime
();

550 
lšk
->
¢dbuf
 = 
	`sd£m±y
();

551 
lšk
->
rcvbuf
 = 
	`sd£m±y
();

552 
lšk
->
node
 =‚ode;

553 
lšk
->
fd
 = -1;

554  
lšk
;

555 
	}
}

560 
	$ä“Clu¡”Lšk
(
şu¡”Lšk
 *
lšk
) {

561 ià(
lšk
->
fd
 != -1) {

562 
	`«D–‘eFeEv’t
(
£rv”
.
–
, 
lšk
->
fd
, 
AE_WRITABLE
);

563 
	`«D–‘eFeEv’t
(
£rv”
.
–
, 
lšk
->
fd
, 
AE_READABLE
);

565 
	`sdsä“
(
lšk
->
¢dbuf
);

566 
	`sdsä“
(
lšk
->
rcvbuf
);

567 ià(
lšk
->
node
)

568 
lšk
->
node
->lšk = 
NULL
;

569 
	`şo£
(
lšk
->
fd
);

570 
	`zä“
(
lšk
);

571 
	}
}

573 
	#MAX_CLUSTER_ACCEPTS_PER_CALL
 1000

	)

574 
	$şu¡”Acû±HªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

575 
ıÜt
, 
cfd
;

576 
max
 = 
MAX_CLUSTER_ACCEPTS_PER_CALL
;

577 
c
[
NET_IP_STR_LEN
];

578 
şu¡”Lšk
 *
lšk
;

579 
	`UNUSED
(
–
);

580 
	`UNUSED
(
mask
);

581 
	`UNUSED
(
´ivd©a
);

585 ià(
£rv”
.
ma¡”ho¡
 =ğ
NULL
 && s”v”.
lßdšg
) ;

587 
max
--) {

588 
cfd
 = 
	`ª‘TıAcû±
(
£rv”
.
Ã‹¼
, 
fd
, 
c
, (c), &
ıÜt
);

589 ià(
cfd
 =ğ
ANET_ERR
) {

590 ià(
”ºo
 !ğ
EWOULDBLOCK
)

591 
	`£rv”Log
(
LL_VERBOSE
,

592 "E¼Ü‡cû±šg clu¡”‚ode: %s", 
£rv”
.
Ã‹¼
);

595 
	`ª‘NÚBlock
(
NULL
,
cfd
);

596 
	`ª‘EÇbËTıNoD–ay
(
NULL
,
cfd
);

599 
	`£rv”Log
(
LL_VERBOSE
,"Acû±ed clu¡”‚od%s:%d", 
c
, 
ıÜt
);

605 
lšk
 = 
	`ü—‹Clu¡”Lšk
(
NULL
);

606 
lšk
->
fd
 = 
cfd
;

607 
	`«C»©eFeEv’t
(
£rv”
.
–
,
cfd
,
AE_READABLE
,
şu¡”R—dHªdËr
,
lšk
);

609 
	}
}

621 
	$keyHashSlÙ
(*
key
, 
keyËn
) {

622 
s
, 
e
;

624 
s
 = 0; s < 
keyËn
; s++)

625 ià(
key
[
s
] == '{') ;

628 ià(
s
 =ğ
keyËn
è 
	`üc16
(
key
,keylen) & 0x3FFF;

631 
e
 = 
s
+1;ƒ < 
keyËn
;ƒ++)

632 ià(
key
[
e
] == '}') ;

635 ià(
e
 =ğ
keyËn
 ||ƒ =ğ
s
+1è 
	`üc16
(
key
,keylen) & 0x3FFF;

639  
	`üc16
(
key
+
s
+1,
e
-s-1) & 0x3FFF;

640 
	}
}

653 
şu¡”Node
 *
	$ü—‹Clu¡”Node
(*
nod’ame
, 
æags
) {

654 
şu¡”Node
 *
node
 = 
	`zm®loc
((*node));

656 ià(
nod’ame
)

657 
	`memıy
(
node
->
Çme
, 
nod’ame
, 
CLUSTER_NAMELEN
);

659 
	`g‘RªdomHexCh¬s
(
node
->
Çme
, 
CLUSTER_NAMELEN
);

660 
node
->
ùime
 = 
	`m¡ime
();

661 
node
->
cÚfigEpoch
 = 0;

662 
node
->
æags
 = flags;

663 
	`mem£t
(
node
->
¦Ùs
,0,(node->slots));

664 
node
->
num¦Ùs
 = 0;

665 
node
->
num¦aves
 = 0;

666 
node
->
¦aves
 = 
NULL
;

667 
node
->
¦aveof
 = 
NULL
;

668 
node
->
pšg_£Á
 =‚ode->
pÚg_»ûived
 = 0;

669 
node
->
ç_time
 = 0;

670 
node
->
lšk
 = 
NULL
;

671 
	`mem£t
(
node
->

,0,(node->ip));

672 
node
->
pÜt
 = 0;

673 
node
->
ç_»pÜts
 = 
	`li¡C»©e
();

674 
node
->
vÙed_time
 = 0;

675 
node
->
Üphªed_time
 = 0;

676 
node
->
»¶_off£t_time
 = 0;

677 
node
->
»¶_off£t
 = 0;

678 
	`li¡S‘F»eM‘hod
(
node
->
ç_»pÜts
,
zä“
);

679  
node
;

680 
	}
}

692 
	$şu¡”NodeAddFau»R•Üt
(
şu¡”Node
 *
çšg
, clu¡”Nod*
£nd”
) {

693 
li¡
 *
l
 = 
çšg
->
ç_»pÜts
;

694 
li¡Node
 *
Ê
;

695 
li¡I‹r
 
li
;

696 
şu¡”NodeFaR•Üt
 *
ä
;

700 
	`li¡Rewšd
(
l
,&
li
);

701 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

702 
ä
 = 
Ê
->
v®ue
;

703 ià(
ä
->
node
 =ğ
£nd”
) {

704 
ä
->
time
 = 
	`m¡ime
();

710 
ä
 = 
	`zm®loc
((*fr));

711 
ä
->
node
 = 
£nd”
;

712 
ä
->
time
 = 
	`m¡ime
();

713 
	`li¡AddNodeTa
(
l
,
ä
);

715 
	}
}

722 
	$şu¡”NodeCËªupFau»R•Üts
(
şu¡”Node
 *
node
) {

723 
li¡
 *
l
 = 
node
->
ç_»pÜts
;

724 
li¡Node
 *
Ê
;

725 
li¡I‹r
 
li
;

726 
şu¡”NodeFaR•Üt
 *
ä
;

727 
m¡ime_t
 
maxtime
 = 
£rv”
.
şu¡”_node_timeout
 *

728 
CLUSTER_FAIL_REPORT_VALIDITY_MULT
;

729 
m¡ime_t
 
now
 = 
	`m¡ime
();

731 
	`li¡Rewšd
(
l
,&
li
);

732 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

733 
ä
 = 
Ê
->
v®ue
;

734 ià(
now
 - 
ä
->
time
 > 
maxtime
è
	`li¡D–Node
(
l
,
Ê
);

736 
	}
}

749 
	$şu¡”NodeD–Fau»R•Üt
(
şu¡”Node
 *
node
, clu¡”Nod*
£nd”
) {

750 
li¡
 *
l
 = 
node
->
ç_»pÜts
;

751 
li¡Node
 *
Ê
;

752 
li¡I‹r
 
li
;

753 
şu¡”NodeFaR•Üt
 *
ä
;

756 
	`li¡Rewšd
(
l
,&
li
);

757 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

758 
ä
 = 
Ê
->
v®ue
;

759 ià(
ä
->
node
 =ğ
£nd”
) ;

761 ià(!
Ê
)  0;

764 
	`li¡D–Node
(
l
,
Ê
);

765 
	`şu¡”NodeCËªupFau»R•Üts
(
node
);

767 
	}
}

772 
	$şu¡”NodeFau»R•ÜtsCouÁ
(
şu¡”Node
 *
node
) {

773 
	`şu¡”NodeCËªupFau»R•Üts
(
node
);

774  
	`li¡L’gth
(
node
->
ç_»pÜts
);

775 
	}
}

777 
	$şu¡”NodeRemoveSÏve
(
şu¡”Node
 *
ma¡”
, clu¡”Nod*
¦ave
) {

778 
j
;

780 
j
 = 0; j < 
ma¡”
->
num¦aves
; j++) {

781 ià(
ma¡”
->
¦aves
[
j
] =ğ
¦ave
) {

782 ià((
j
+1è< 
ma¡”
->
num¦aves
) {

783 
»maššg_¦aves
 = (
ma¡”
->
num¦aves
 - 
j
) - 1;

784 
	`memmove
(
ma¡”
->
¦aves
+
j
,master->slaves+(j+1),

785 ((*
ma¡”
->
¦aves
è* 
»maššg_¦aves
));

787 
ma¡”
->
num¦aves
--;

788 ià(
ma¡”
->
num¦aves
 == 0)

789 
ma¡”
->
æags
 &ğ~
CLUSTER_NODE_MIGRATE_TO
;

790  
C_OK
;

793  
C_ERR
;

794 
	}
}

796 
	$şu¡”NodeAddSÏve
(
şu¡”Node
 *
ma¡”
, clu¡”Nod*
¦ave
) {

797 
j
;

800 
j
 = 0; j < 
ma¡”
->
num¦aves
; j++)

801 ià(
ma¡”
->
¦aves
[
j
] =ğ
¦ave
è 
C_ERR
;

802 
ma¡”
->
¦aves
 = 
	`z»®loc
(master->slaves,

803 (
şu¡”Node
*)*(
ma¡”
->
num¦aves
+1));

804 
ma¡”
->
¦aves
[ma¡”->
num¦aves
] = 
¦ave
;

805 
ma¡”
->
num¦aves
++;

806 
ma¡”
->
æags
 |ğ
CLUSTER_NODE_MIGRATE_TO
;

807  
C_OK
;

808 
	}
}

810 
	$şu¡”CouÁNÚFašgSÏves
(
şu¡”Node
 *
n
) {

811 
j
, 
ok¦aves
 = 0;

813 
j
 = 0; j < 
n
->
num¦aves
; j++)

814 ià(!
	`nodeFaed
(
n
->
¦aves
[
j
])è
ok¦aves
++;

815  
ok¦aves
;

816 
	}
}

819 
	$ä“Clu¡”Node
(
şu¡”Node
 *
n
) {

820 
sds
 
nod’ame
;

821 
j
;

825 
j
 = 0; j < 
n
->
num¦aves
; j++)

826 
n
->
¦aves
[
j
]->
¦aveof
 = 
NULL
;

829 ià(
	`nodeIsSÏve
(
n
è&&‚->
¦aveof
è
	`şu¡”NodeRemoveSÏve
(n->slaveof,n);

832 
nod’ame
 = 
	`sd¢ewËn
(
n
->
Çme
, 
CLUSTER_NAMELEN
);

833 
	`£rv”As£¹
(
	`diùD–‘e
(
£rv”
.
şu¡”
->
nodes
,
nod’ame
è=ğ
DICT_OK
);

834 
	`sdsä“
(
nod’ame
);

837 ià(
n
->
lšk
è
	`ä“Clu¡”Lšk
(n->link);

838 
	`li¡R–—£
(
n
->
ç_»pÜts
);

839 
	`zä“
(
n
->
¦aves
);

840 
	`zä“
(
n
);

841 
	}
}

844 
	$şu¡”AddNode
(
şu¡”Node
 *
node
) {

845 
»tv®
;

847 
»tv®
 = 
	`diùAdd
(
£rv”
.
şu¡”
->
nodes
,

848 
	`sd¢ewËn
(
node
->
Çme
,
CLUSTER_NAMELEN
),‚ode);

849  (
»tv®
 =ğ
DICT_OK
è? 
C_OK
 : 
C_ERR
;

850 
	}
}

863 
	$şu¡”D–Node
(
şu¡”Node
 *
d–node
) {

864 
j
;

865 
diùI‹¿tÜ
 *
di
;

866 
diùEÁry
 *
de
;

869 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

870 ià(
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
j
] =ğ
d–node
)

871 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
j
] = 
NULL
;

872 ià(
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
j
] =ğ
d–node
)

873 
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
j
] = 
NULL
;

874 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
d–node
)

875 
	`şu¡”D–SlÙ
(
j
);

879 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

880 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

881 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

883 ià(
node
 =ğ
d–node
) ;

884 
	`şu¡”NodeD–Fau»R•Üt
(
node
,
d–node
);

886 
	`diùR–—£I‹¿tÜ
(
di
);

889 
	`ä“Clu¡”Node
(
d–node
);

890 
	}
}

893 
şu¡”Node
 *
	$şu¡”LookupNode
(*
Çme
) {

894 
sds
 
s
 = 
	`sd¢ewËn
(
Çme
, 
CLUSTER_NAMELEN
);

895 
diùEÁry
 *
de
;

897 
de
 = 
	`diùFšd
(
£rv”
.
şu¡”
->
nodes
,
s
);

898 
	`sdsä“
(
s
);

899 ià(
de
 =ğ
NULL
)  NULL;

900  
	`diùG‘V®
(
de
);

901 
	}
}

907 
	$şu¡”R’ameNode
(
şu¡”Node
 *
node
, *
ÃwÇme
) {

908 
»tv®
;

909 
sds
 
s
 = 
	`sd¢ewËn
(
node
->
Çme
, 
CLUSTER_NAMELEN
);

911 
	`£rv”Log
(
LL_DEBUG
,"Renaming‚ode %.40s into %.40s",

912 
node
->
Çme
, 
ÃwÇme
);

913 
»tv®
 = 
	`diùD–‘e
(
£rv”
.
şu¡”
->
nodes
, 
s
);

914 
	`sdsä“
(
s
);

915 
	`£rv”As£¹
(
»tv®
 =ğ
DICT_OK
);

916 
	`memıy
(
node
->
Çme
, 
ÃwÇme
, 
CLUSTER_NAMELEN
);

917 
	`şu¡”AddNode
(
node
);

918 
	}
}

926 
ušt64_t
 
	$şu¡”G‘MaxEpoch
() {

927 
ušt64_t
 
max
 = 0;

928 
diùI‹¿tÜ
 *
di
;

929 
diùEÁry
 *
de
;

931 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

932 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

933 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

934 ià(
node
->
cÚfigEpoch
 > 
max
) max =‚ode->configEpoch;

936 
	`diùR–—£I‹¿tÜ
(
di
);

937 ià(
max
 < 
£rv”
.
şu¡”
->
cu¼’tEpoch
) max = server.cluster->currentEpoch;

938  
max
;

939 
	}
}

970 
	$şu¡”BumpCÚfigEpochW™houtCÚ£nsus
() {

971 
ušt64_t
 
maxEpoch
 = 
	`şu¡”G‘MaxEpoch
();

973 ià(
my£lf
->
cÚfigEpoch
 == 0 ||

974 
my£lf
->
cÚfigEpoch
 !ğ
maxEpoch
)

976 
£rv”
.
şu¡”
->
cu¼’tEpoch
++;

977 
my£lf
->
cÚfigEpoch
 = 
£rv”
.
şu¡”
->
cu¼’tEpoch
;

978 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

979 
CLUSTER_TODO_FSYNC_CONFIG
);

980 
	`£rv”Log
(
LL_WARNING
,

982 (è
my£lf
->
cÚfigEpoch
);

983  
C_OK
;

985  
C_ERR
;

987 
	}
}

1035 
	$şu¡”HªdËCÚfigEpochCŞlisiÚ
(
şu¡”Node
 *
£nd”
) {

1037 ià(
£nd”
->
cÚfigEpoch
 !ğ
my£lf
->configEpoch ||

1038 !
	`nodeIsMa¡”
(
£nd”
è|| !nodeIsMa¡”(
my£lf
)) ;

1040 ià(
	`memcmp
(
£nd”
->
Çme
,
my£lf
->Çme,
CLUSTER_NAMELEN
) <= 0) ;

1042 
£rv”
.
şu¡”
->
cu¼’tEpoch
++;

1043 
my£lf
->
cÚfigEpoch
 = 
£rv”
.
şu¡”
->
cu¼’tEpoch
;

1044 
	`şu¡”SaveCÚfigOrD›
(1);

1045 
	`£rv”Log
(
LL_VERBOSE
,

1048 
£nd”
->
Çme
,

1049 (è
my£lf
->
cÚfigEpoch
);

1050 
	}
}

1074 
	#CLUSTER_BLACKLIST_TTL
 60

	)

1083 
	$şu¡”BÏckli¡CËªup
() {

1084 
diùI‹¿tÜ
 *
di
;

1085 
diùEÁry
 *
de
;

1087 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes_bÏck_li¡
);

1088 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1089 
št64_t
 
expœe
 = 
	`diùG‘UnsigÃdIÁeg”V®
(
de
);

1091 ià(
expœe
 < 
£rv”
.
unixtime
)

1092 
	`diùD–‘e
(
£rv”
.
şu¡”
->
nodes_bÏck_li¡
,
	`diùG‘Key
(
de
));

1094 
	`diùR–—£I‹¿tÜ
(
di
);

1095 
	}
}

1098 
	$şu¡”BÏckli¡AddNode
(
şu¡”Node
 *
node
) {

1099 
diùEÁry
 *
de
;

1100 
sds
 
id
 = 
	`sd¢ewËn
(
node
->
Çme
,
CLUSTER_NAMELEN
);

1102 
	`şu¡”BÏckli¡CËªup
();

1103 ià(
	`diùAdd
(
£rv”
.
şu¡”
->
nodes_bÏck_li¡
,
id
,
NULL
è=ğ
DICT_OK
) {

1106 
id
 = 
	`sdsdup
(id);

1108 
de
 = 
	`diùFšd
(
£rv”
.
şu¡”
->
nodes_bÏck_li¡
,
id
);

1109 
	`diùS‘UnsigÃdIÁeg”V®
(
de
,
	`time
(
NULL
)+
CLUSTER_BLACKLIST_TTL
);

1110 
	`sdsä“
(
id
);

1111 
	}
}

1116 
	$şu¡”BÏckli¡Exi¡s
(*
nodeid
) {

1117 
sds
 
id
 = 
	`sd¢ewËn
(
nodeid
,
CLUSTER_NAMELEN
);

1118 
»tv®
;

1120 
	`şu¡”BÏckli¡CËªup
();

1121 
»tv®
 = 
	`diùFšd
(
£rv”
.
şu¡”
->
nodes_bÏck_li¡
,
id
è!ğ
NULL
;

1122 
	`sdsä“
(
id
);

1123  
»tv®
;

1124 
	}
}

1151 
	$m¬kNodeAsFašgIfN“ded
(
şu¡”Node
 *
node
) {

1152 
çu»s
;

1153 
Ãeded_quÜum
 = (
£rv”
.
şu¡”
->
size
 / 2) + 1;

1155 ià(!
	`nodeTimedOut
(
node
)) ;

1156 ià(
	`nodeFaed
(
node
)) ;

1158 
çu»s
 = 
	`şu¡”NodeFau»R•ÜtsCouÁ
(
node
);

1160 ià(
	`nodeIsMa¡”
(
my£lf
)è
çu»s
++;

1161 ià(
çu»s
 < 
Ãeded_quÜum
) ;

1163 
	`£rv”Log
(
LL_NOTICE
,

1164 "M¬kšg‚od%.40 a çšg (quÜum„—ched).", 
node
->
Çme
);

1167 
node
->
æags
 &ğ~
CLUSTER_NODE_PFAIL
;

1168 
node
->
æags
 |ğ
CLUSTER_NODE_FAIL
;

1169 
node
->
ç_time
 = 
	`m¡ime
();

1173 ià(
	`nodeIsMa¡”
(
my£lf
)è
	`şu¡”S’dFa
(
node
->
Çme
);

1174 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

1175 
	}
}

1180 
	$ş—rNodeFau»IfN“ded
(
şu¡”Node
 *
node
) {

1181 
m¡ime_t
 
now
 = 
	`m¡ime
();

1183 
	`£rv”As£¹
(
	`nodeFaed
(
node
));

1187 ià(
	`nodeIsSÏve
(
node
è||‚ode->
num¦Ùs
 == 0) {

1188 
	`£rv”Log
(
LL_NOTICE
,

1190 
node
->
Çme
,

1191 
	`nodeIsSÏve
(
node
) ? "slave" : "master without slots");

1192 
node
->
æags
 &ğ~
CLUSTER_NODE_FAIL
;

1193 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

1200 ià(
	`nodeIsMa¡”
(
node
è&&‚ode->
num¦Ùs
 > 0 &&

1201 (
now
 - 
node
->
ç_time
) >

1202 (
£rv”
.
şu¡”_node_timeout
 * 
CLUSTER_FAIL_UNDO_TIME_MULT
))

1204 
	`£rv”Log
(
LL_NOTICE
,

1206 
node
->
Çme
);

1207 
node
->
æags
 &ğ~
CLUSTER_NODE_FAIL
;

1208 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

1210 
	}
}

1215 
	$şu¡”HªdshakeInProg»ss
(*

, 
pÜt
) {

1216 
diùI‹¿tÜ
 *
di
;

1217 
diùEÁry
 *
de
;

1219 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

1220 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1221 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

1223 ià(!
	`nodeInHªdshake
(
node
)) ;

1224 ià(!
	`¡rÿ£cmp
(
node
->

,è&&‚ode->
pÜt
 ==…ort) ;

1226 
	`diùR–—£I‹¿tÜ
(
di
);

1227  
de
 !ğ
NULL
;

1228 
	}
}

1237 
	$şu¡”S¹Hªdshake
(*

, 
pÜt
) {

1238 
şu¡”Node
 *
n
;

1239 
nÜm_
[
NET_IP_STR_LEN
];

1240 
sockaddr_¡Üage
 
§
;

1243 ià(
	`š‘_±Ú
(
AF_INET
,

,

1244 &(((
sockaddr_š
 *)&
§
)->
sš_addr
)))

1246 
§
.
ss_çmy
 = 
AF_INET
;

1247 } ià(
	`š‘_±Ú
(
AF_INET6
,

,

1248 &(((
sockaddr_š6
 *)&
§
)->
sš6_addr
)))

1250 
§
.
ss_çmy
 = 
AF_INET6
;

1252 
”ºo
 = 
EINVAL
;

1257 ià(
pÜt
 <ğ0 ||…Üˆ> (65535-
CLUSTER_PORT_INCR
)) {

1258 
”ºo
 = 
EINVAL
;

1264 
	`mem£t
(
nÜm_
,0,
NET_IP_STR_LEN
);

1265 ià(
§
.
ss_çmy
 =ğ
AF_INET
)

1266 
	`š‘_Áİ
(
AF_INET
,

1267 (*)&(((
sockaddr_š
 *)&
§
)->
sš_addr
),

1268 
nÜm_
,
NET_IP_STR_LEN
);

1270 
	`š‘_Áİ
(
AF_INET6
,

1271 (*)&(((
sockaddr_š6
 *)&
§
)->
sš6_addr
),

1272 
nÜm_
,
NET_IP_STR_LEN
);

1274 ià(
	`şu¡”HªdshakeInProg»ss
(
nÜm_
,
pÜt
)) {

1275 
”ºo
 = 
EAGAIN
;

1282 
n
 = 
	`ü—‹Clu¡”Node
(
NULL
,
CLUSTER_NODE_HANDSHAKE
|
CLUSTER_NODE_MEET
);

1283 
	`memıy
(
n
->

,
nÜm_
,(n->ip));

1284 
n
->
pÜt
 =…ort;

1285 
	`şu¡”AddNode
(
n
);

1287 
	}
}

1293 
	$şu¡”ProûssGossSeùiÚ
(
şu¡”Msg
 *
hdr
, 
şu¡”Lšk
 *
lšk
) {

1294 
ušt16_t
 
couÁ
 = 
	`Áohs
(
hdr
->count);

1295 
şu¡”MsgD©aGoss
 *
g
 = (şu¡”MsgD©aGoss*è
hdr
->
d©a
.
pšg
.
goss
;

1296 
şu¡”Node
 *
£nd”
 = 
lšk
->
node
 ?†šk->nod: 
	`şu¡”LookupNode
(
hdr
->sender);

1298 
couÁ
--) {

1299 
ušt16_t
 
æags
 = 
	`Áohs
(
g
->flags);

1300 
şu¡”Node
 *
node
;

1301 
sds
 
ci
;

1303 
ci
 = 
	`»´e£ÁClu¡”NodeFÏgs
(
	`sd£m±y
(), 
æags
);

1304 
	`£rv”Log
(
LL_DEBUG
,"GOSSIP %.40s %s:%d %s",

1305 
g
->
nod’ame
,

1306 
g
->

,

1307 
	`Áohs
(
g
->
pÜt
),

1308 
ci
);

1309 
	`sdsä“
(
ci
);

1312 
node
 = 
	`şu¡”LookupNode
(
g
->
nod’ame
);

1313 ià(
node
) {

1316 ià(
£nd”
 && 
	`nodeIsMa¡”
(£nd”è&& 
node
 !ğ
my£lf
) {

1317 ià(
æags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_PFAIL
)) {

1318 ià(
	`şu¡”NodeAddFau»R•Üt
(
node
,
£nd”
)) {

1319 
	`£rv”Log
(
LL_VERBOSE
,

1321 
£nd”
->
Çme
, 
node
->name);

1323 
	`m¬kNodeAsFašgIfN“ded
(
node
);

1325 ià(
	`şu¡”NodeD–Fau»R•Üt
(
node
,
£nd”
)) {

1326 
	`£rv”Log
(
LL_VERBOSE
,

1328 
£nd”
->
Çme
, 
node
->name);

1338 ià(
node
->
æags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_PFAIL
) &&

1339 !(
æags
 & 
CLUSTER_NODE_NOADDR
) &&

1340 !(
æags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_PFAIL
)) &&

1341 (
	`¡rÿ£cmp
(
node
->

,
g
->è||‚ode->
pÜt
 !ğ
	`Áohs
(g->port)))

1343 ià(
node
->
lšk
è
	`ä“Clu¡”Lšk
(node->link);

1344 
	`memıy
(
node
->

,
g
->,
NET_IP_STR_LEN
);

1345 
node
->
pÜt
 = 
	`Áohs
(
g
->port);

1346 
node
->
æags
 &ğ~
CLUSTER_NODE_NOADDR
;

1355 ià(
£nd”
 &&

1356 !(
æags
 & 
CLUSTER_NODE_NOADDR
) &&

1357 !
	`şu¡”BÏckli¡Exi¡s
(
g
->
nod’ame
))

1359 
	`şu¡”S¹Hªdshake
(
g
->

,
	`Áohs
(g->
pÜt
));

1364 
g
++;

1366 
	}
}

1369 
	$nodeIp2SŒšg
(*
buf
, 
şu¡”Lšk
 *
lšk
) {

1370 
	`ª‘P“rToSŒšg
(
lšk
->
fd
, 
buf
, 
NET_IP_STR_LEN
, 
NULL
);

1371 
	}
}

1383 
	$nodeUpd©eAdd»ssIfN“ded
(
şu¡”Node
 *
node
, 
şu¡”Lšk
 *
lšk
, 
pÜt
) {

1384 

[
NET_IP_STR_LEN
] = {0};

1392 ià(
lšk
 =ğ
node
->link)  0;

1394 
	`nodeIp2SŒšg
(

,
lšk
);

1395 ià(
node
->
pÜt
 =ğpÜˆ&& 
	`¡rcmp
(

,node->ip) == 0)  0;

1398 
	`memıy
(
node
->

,ip,(ip));

1399 
node
->
pÜt
 =…ort;

1400 ià(
node
->
lšk
è
	`ä“Clu¡”Lšk
(node->link);

1401 
node
->
æags
 &ğ~
CLUSTER_NODE_NOADDR
;

1402 
	`£rv”Log
(
LL_WARNING
,"Address updated for‚ode %.40s,‚ow %s:%d",

1403 
node
->
Çme
,‚ode->

,‚ode->
pÜt
);

1407 ià(
	`nodeIsSÏve
(
my£lf
è&& my£lf->
¦aveof
 =ğ
node
)

1408 
	`»¶iÿtiÚS‘Ma¡”
(
node
->

,‚ode->
pÜt
);

1410 
	}
}

1415 
	$şu¡”S‘NodeAsMa¡”
(
şu¡”Node
 *
n
) {

1416 ià(
	`nodeIsMa¡”
(
n
)) ;

1418 ià(
n
->
¦aveof
) {

1419 
	`şu¡”NodeRemoveSÏve
(
n
->
¦aveof
,n);

1420 ià(
n
 !ğ
my£lf
èn->
æags
 |ğ
CLUSTER_NODE_MIGRATE_TO
;

1422 
n
->
æags
 &ğ~
CLUSTER_NODE_SLAVE
;

1423 
n
->
æags
 |ğ
CLUSTER_NODE_MASTER
;

1424 
n
->
¦aveof
 = 
NULL
;

1427 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1428 
CLUSTER_TODO_UPDATE_STATE
);

1429 
	}
}

1442 
	$şu¡”Upd©eSlÙsCÚfigW™h
(
şu¡”Node
 *
£nd”
, 
ušt64_t
 
£nd”CÚfigEpoch
, *
¦Ùs
) {

1443 
j
;

1444 
şu¡”Node
 *
curma¡”
, *
Ãwma¡”
 = 
NULL
;

1452 
ušt16_t
 
dœty_¦Ùs
[
CLUSTER_SLOTS
];

1453 
dœty_¦Ùs_couÁ
 = 0;

1458 
curma¡”
 = 
	`nodeIsMa¡”
(
my£lf
è? my£là: my£lf->
¦aveof
;

1460 ià(
£nd”
 =ğ
my£lf
) {

1461 
	`£rv”Log
(
LL_WARNING
,"Discarding UPDATE message‡bout myself.");

1465 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

1466 ià(
	`b™m­Te¡B™
(
¦Ùs
,
j
)) {

1468 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
£nd”
) ;

1474 ià(
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
j
]) ;

1480 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
NULL
 ||

1481 
£rv”
.
şu¡”
->
¦Ùs
[
j
]->
cÚfigEpoch
 < 
£nd”CÚfigEpoch
)

1485 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
my£lf
 &&

1486 
	`couÁKeysInSlÙ
(
j
) &&

1487 
£nd”
 !ğ
my£lf
)

1489 
dœty_¦Ùs
[
dœty_¦Ùs_couÁ
] = 
j
;

1490 
dœty_¦Ùs_couÁ
++;

1493 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
curma¡”
)

1494 
Ãwma¡”
 = 
£nd”
;

1495 
	`şu¡”D–SlÙ
(
j
);

1496 
	`şu¡”AddSlÙ
(
£nd”
,
j
);

1497 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1498 
CLUSTER_TODO_UPDATE_STATE
|

1499 
CLUSTER_TODO_FSYNC_CONFIG
);

1511 ià(
Ãwma¡”
 && 
curma¡”
->
num¦Ùs
 == 0) {

1512 
	`£rv”Log
(
LL_WARNING
,

1514 "a ¨»¶iÿ oà%.40s", 
£nd”
->
Çme
);

1515 
	`şu¡”S‘Ma¡”
(
£nd”
);

1516 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1517 
CLUSTER_TODO_UPDATE_STATE
|

1518 
CLUSTER_TODO_FSYNC_CONFIG
);

1519 } ià(
dœty_¦Ùs_couÁ
) {

1527 
j
 = 0; j < 
dœty_¦Ùs_couÁ
; j++)

1528 
	`d–KeysInSlÙ
(
dœty_¦Ùs
[
j
]);

1530 
	}
}

1541 
	$şu¡”ProûssPack‘
(
şu¡”Lšk
 *
lšk
) {

1542 
şu¡”Msg
 *
hdr
 = (şu¡”Msg*è
lšk
->
rcvbuf
;

1543 
ušt32_t
 
tÙËn
 = 
	`Áohl
(
hdr
->totlen);

1544 
ušt16_t
 
ty³
 = 
	`Áohs
(
hdr
->type);

1546 
£rv”
.
şu¡”
->
¡©s_bus_mes§ges_»ûived
++;

1547 
	`£rv”Log
(
LL_DEBUG
,"--- Processing…acket ofype %d, %lu bytes",

1548 
ty³
, (è
tÙËn
);

1551 ià(
tÙËn
 < 16)  1;

1552 ià(
tÙËn
 > 
	`sd¦’
(
lšk
->
rcvbuf
))  1;

1554 ià(
	`Áohs
(
hdr
->
v”
è!ğ
CLUSTER_PROTO_VER
) {

1559 
ušt16_t
 
æags
 = 
	`Áohs
(
hdr
->flags);

1560 
ušt64_t
 
£nd”Cu¼’tEpoch
 = 0, 
£nd”CÚfigEpoch
 = 0;

1561 
şu¡”Node
 *
£nd”
;

1563 ià(
ty³
 =ğ
CLUSTERMSG_TYPE_PING
 ||y³ =ğ
CLUSTERMSG_TYPE_PONG
 ||

1564 
ty³
 =ğ
CLUSTERMSG_TYPE_MEET
)

1566 
ušt16_t
 
couÁ
 = 
	`Áohs
(
hdr
->count);

1567 
ušt32_t
 
ex¶’
;

1569 
ex¶’
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

1570 
ex¶’
 +ğ((
şu¡”MsgD©aGoss
)*
couÁ
);

1571 ià(
tÙËn
 !ğ
ex¶’
)  1;

1572 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_FAIL
) {

1573 
ušt32_t
 
ex¶’
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

1575 
ex¶’
 +ğ(
şu¡”MsgD©aFa
);

1576 ià(
tÙËn
 !ğ
ex¶’
)  1;

1577 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_PUBLISH
) {

1578 
ušt32_t
 
ex¶’
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

1580 
ex¶’
 +ğ(
şu¡”MsgD©aPublish
) -

1582 
	`Áohl
(
hdr
->
d©a
.
publish
.
msg
.
chªÃl_Ën
) +

1583 
	`Áohl
(
hdr
->
d©a
.
publish
.
msg
.
mes§ge_Ën
);

1584 ià(
tÙËn
 !ğ
ex¶’
)  1;

1585 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST
 ||

1586 
ty³
 =ğ
CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK
 ||

1587 
ty³
 =ğ
CLUSTERMSG_TYPE_MFSTART
)

1589 
ušt32_t
 
ex¶’
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

1591 ià(
tÙËn
 !ğ
ex¶’
)  1;

1592 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_UPDATE
) {

1593 
ušt32_t
 
ex¶’
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

1595 
ex¶’
 +ğ(
şu¡”MsgD©aUpd©e
);

1596 ià(
tÙËn
 !ğ
ex¶’
)  1;

1600 
£nd”
 = 
	`şu¡”LookupNode
(
hdr
->sender);

1601 ià(
£nd”
 && !
	`nodeInHªdshake
(sender)) {

1603 
£nd”Cu¼’tEpoch
 = 
	`Áohu64
(
hdr
->
cu¼’tEpoch
);

1604 
£nd”CÚfigEpoch
 = 
	`Áohu64
(
hdr
->
cÚfigEpoch
);

1605 ià(
£nd”Cu¼’tEpoch
 > 
£rv”
.
şu¡”
->
cu¼’tEpoch
)

1606 
£rv”
.
şu¡”
->
cu¼’tEpoch
 = 
£nd”Cu¼’tEpoch
;

1608 ià(
£nd”CÚfigEpoch
 > 
£nd”
->
cÚfigEpoch
) {

1609 
£nd”
->
cÚfigEpoch
 = 
£nd”CÚfigEpoch
;

1610 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1611 
CLUSTER_TODO_FSYNC_CONFIG
);

1614 
£nd”
->
»¶_off£t
 = 
	`Áohu64
(
hdr
->
off£t
);

1615 
£nd”
->
»¶_off£t_time
 = 
	`m¡ime
();

1618 ià(
£rv”
.
şu¡”
->
mf_’d
 &&

1619 
	`nodeIsSÏve
(
my£lf
) &&

1620 
my£lf
->
¦aveof
 =ğ
£nd”
 &&

1621 
hdr
->
mæags
[0] & 
CLUSTERMSG_FLAG0_PAUSED
 &&

1622 
£rv”
.
şu¡”
->
mf_ma¡”_off£t
 == 0)

1624 
£rv”
.
şu¡”
->
mf_ma¡”_off£t
 = 
£nd”
->
»¶_off£t
;

1625 
	`£rv”Log
(
LL_WARNING
,

1628 
£rv”
.
şu¡”
->
mf_ma¡”_off£t
);

1633 ià(
ty³
 =ğ
CLUSTERMSG_TYPE_PING
 ||y³ =ğ
CLUSTERMSG_TYPE_MEET
) {

1634 
	`£rv”Log
(
LL_DEBUG
,"Pšg…ack‘„eûived: %p", (*)
lšk
->
node
);

1647 ià(
ty³
 =ğ
CLUSTERMSG_TYPE_MEET
 || 
my£lf
->

[0] == '\0') {

1648 

[
NET_IP_STR_LEN
];

1650 ià(
	`ª‘SockName
(
lšk
->
fd
,

,(),
NULL
) != -1 &&

1651 
	`¡rcmp
(

,
my£lf
->ip))

1653 
	`memıy
(
my£lf
->

,,
NET_IP_STR_LEN
);

1654 
	`£rv”Log
(
LL_WARNING
,"IP‡ddress forhis‚ode updatedo %s",

1655 
my£lf
->

);

1656 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
);

1664 ià(!
£nd”
 && 
ty³
 =ğ
CLUSTERMSG_TYPE_MEET
) {

1665 
şu¡”Node
 *
node
;

1667 
node
 = 
	`ü—‹Clu¡”Node
(
NULL
,
CLUSTER_NODE_HANDSHAKE
);

1668 
	`nodeIp2SŒšg
(
node
->

,
lšk
);

1669 
node
->
pÜt
 = 
	`Áohs
(
hdr
->port);

1670 
	`şu¡”AddNode
(
node
);

1671 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
);

1677 ià(!
£nd”
 && 
ty³
 =ğ
CLUSTERMSG_TYPE_MEET
)

1678 
	`şu¡”ProûssGossSeùiÚ
(
hdr
,
lšk
);

1681 
	`şu¡”S’dPšg
(
lšk
,
CLUSTERMSG_TYPE_PONG
);

1685 ià(
ty³
 =ğ
CLUSTERMSG_TYPE_PING
 ||y³ =ğ
CLUSTERMSG_TYPE_PONG
 ||

1686 
ty³
 =ğ
CLUSTERMSG_TYPE_MEET
)

1688 
	`£rv”Log
(
LL_DEBUG
,"%s…acket„eceived: %p",

1689 
ty³
 =ğ
CLUSTERMSG_TYPE_PING
 ? "ping" : "pong",

1690 (*)
lšk
->
node
);

1691 ià(
lšk
->
node
) {

1692 ià(
	`nodeInHªdshake
(
lšk
->
node
)) {

1695 ià(
£nd”
) {

1696 
	`£rv”Log
(
LL_VERBOSE
,

1698 "upd©šghadd»s iàÃeded.", 
£nd”
->
Çme
);

1699 ià(
	`nodeUpd©eAdd»ssIfN“ded
(
£nd”
,
lšk
,
	`Áohs
(
hdr
->
pÜt
)))

1701 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1702 
CLUSTER_TODO_UPDATE_STATE
);

1706 
	`şu¡”D–Node
(
lšk
->
node
);

1712 
	`şu¡”R’ameNode
(
lšk
->
node
, 
hdr
->
£nd”
);

1713 
	`£rv”Log
(
LL_DEBUG
,"Handshake with‚ode %.40s completed.",

1714 
lšk
->
node
->
Çme
);

1715 
lšk
->
node
->
æags
 &ğ~
CLUSTER_NODE_HANDSHAKE
;

1716 
lšk
->
node
->
æags
 |ğæags&(
CLUSTER_NODE_MASTER
|
CLUSTER_NODE_SLAVE
);

1717 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
);

1718 } ià(
	`memcmp
(
lšk
->
node
->
Çme
,
hdr
->
£nd”
,

1719 
CLUSTER_NAMELEN
) != 0)

1724 
	`£rv”Log
(
LL_DEBUG
,"PONG contains mismatching sender ID. About‚ode %.40s‡dded %d ms‡go, having flags %d",

1725 
lšk
->
node
->
Çme
,

1726 ()(
	`m¡ime
()-(
lšk
->
node
->
ùime
)),

1727 
lšk
->
node
->
æags
);

1728 
lšk
->
node
->
æags
 |ğ
CLUSTER_NODE_NOADDR
;

1729 
lšk
->
node
->

[0] = '\0';

1730 
lšk
->
node
->
pÜt
 = 0;

1731 
	`ä“Clu¡”Lšk
(
lšk
);

1732 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
);

1738 ià(
£nd”
 && 
ty³
 =ğ
CLUSTERMSG_TYPE_PING
 &&

1739 !
	`nodeInHªdshake
(
£nd”
) &&

1740 
	`nodeUpd©eAdd»ssIfN“ded
(
£nd”
,
lšk
,
	`Áohs
(
hdr
->
pÜt
)))

1742 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1743 
CLUSTER_TODO_UPDATE_STATE
);

1747 ià(
lšk
->
node
 && 
ty³
 =ğ
CLUSTERMSG_TYPE_PONG
) {

1748 
lšk
->
node
->
pÚg_»ûived
 = 
	`m¡ime
();

1749 
lšk
->
node
->
pšg_£Á
 = 0;

1757 ià(
	`nodeTimedOut
(
lšk
->
node
)) {

1758 
lšk
->
node
->
æags
 &ğ~
CLUSTER_NODE_PFAIL
;

1759 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1760 
CLUSTER_TODO_UPDATE_STATE
);

1761 } ià(
	`nodeFaed
(
lšk
->
node
)) {

1762 
	`ş—rNodeFau»IfN“ded
(
lšk
->
node
);

1767 ià(
£nd”
) {

1768 ià(!
	`memcmp
(
hdr
->
¦aveof
,
CLUSTER_NODE_NULL_NAME
,

1769 (
hdr
->
¦aveof
)))

1772 
	`şu¡”S‘NodeAsMa¡”
(
£nd”
);

1775 
şu¡”Node
 *
ma¡”
 = 
	`şu¡”LookupNode
(
hdr
->
¦aveof
);

1777 ià(
	`nodeIsMa¡”
(
£nd”
)) {

1779 
	`şu¡”D–NodeSlÙs
(
£nd”
);

1780 
£nd”
->
æags
 &ğ~(
CLUSTER_NODE_MASTER
|

1781 
CLUSTER_NODE_MIGRATE_TO
);

1782 
£nd”
->
æags
 |ğ
CLUSTER_NODE_SLAVE
;

1785 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1786 
CLUSTER_TODO_UPDATE_STATE
);

1790 ià(
ma¡”
 && 
£nd”
->
¦aveof
 != master) {

1791 ià(
£nd”
->
¦aveof
)

1792 
	`şu¡”NodeRemoveSÏve
(
£nd”
->
¦aveof
,sender);

1793 
	`şu¡”NodeAddSÏve
(
ma¡”
,
£nd”
);

1794 
£nd”
->
¦aveof
 = 
ma¡”
;

1797 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
);

1811 
şu¡”Node
 *
£nd”_ma¡”
 = 
NULL
;

1812 
dœty_¦Ùs
 = 0;

1814 ià(
£nd”
) {

1815 
£nd”_ma¡”
 = 
	`nodeIsMa¡”
(
£nd”
è? s’d” : s’d”->
¦aveof
;

1816 ià(
£nd”_ma¡”
) {

1817 
dœty_¦Ùs
 = 
	`memcmp
(
£nd”_ma¡”
->
¦Ùs
,

1818 
hdr
->
my¦Ùs
,(hdr->myslots)) != 0;

1825 ià(
£nd”
 && 
	`nodeIsMa¡”
(£nd”è&& 
dœty_¦Ùs
)

1826 
	`şu¡”Upd©eSlÙsCÚfigW™h
(
£nd”
,
£nd”CÚfigEpoch
,
hdr
->
my¦Ùs
);

1846 ià(
£nd”
 && 
dœty_¦Ùs
) {

1847 
j
;

1849 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

1850 ià(
	`b™m­Te¡B™
(
hdr
->
my¦Ùs
,
j
)) {

1851 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
£nd”
 ||

1852 
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
NULL
) ;

1853 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
]->
cÚfigEpoch
 >

1854 
£nd”CÚfigEpoch
)

1856 
	`£rv”Log
(
LL_VERBOSE
,

1859 
£nd”
->
Çme
, 
£rv”
.
şu¡”
->
¦Ùs
[
j
]->name);

1860 
	`şu¡”S’dUpd©e
(
£nd”
->
lšk
,

1861 
£rv”
.
şu¡”
->
¦Ùs
[
j
]);

1874 ià(
£nd”
 &&

1875 
	`nodeIsMa¡”
(
my£lf
è&&‚odeIsMa¡”(
£nd”
) &&

1876 
£nd”CÚfigEpoch
 =ğ
my£lf
->
cÚfigEpoch
)

1878 
	`şu¡”HªdËCÚfigEpochCŞlisiÚ
(
£nd”
);

1882 ià(
£nd”
è
	`şu¡”ProûssGossSeùiÚ
(
hdr
,
lšk
);

1883 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_FAIL
) {

1884 
şu¡”Node
 *
çšg
;

1886 ià(
£nd”
) {

1887 
çšg
 = 
	`şu¡”LookupNode
(
hdr
->
d©a
.
ç
.
about
.
nod’ame
);

1888 ià(
çšg
 &&

1889 !(
çšg
->
æags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_MYSELF
)))

1891 
	`£rv”Log
(
LL_NOTICE
,

1893 
hdr
->
£nd”
, hdr->
d©a
.
ç
.
about
.
nod’ame
);

1894 
çšg
->
æags
 |ğ
CLUSTER_NODE_FAIL
;

1895 
çšg
->
ç_time
 = 
	`m¡ime
();

1896 
çšg
->
æags
 &ğ~
CLUSTER_NODE_PFAIL
;

1897 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1898 
CLUSTER_TODO_UPDATE_STATE
);

1901 
	`£rv”Log
(
LL_NOTICE
,

1903 
hdr
->
£nd”
, hdr->
d©a
.
ç
.
about
.
nod’ame
);

1905 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_PUBLISH
) {

1906 
robj
 *
chªÃl
, *
mes§ge
;

1907 
ušt32_t
 
chªÃl_Ën
, 
mes§ge_Ën
;

1911 ià(
	`diùSize
(
£rv”
.
pubsub_chªÃls
) ||

1912 
	`li¡L’gth
(
£rv”
.
pubsub_·‰”ns
))

1914 
chªÃl_Ën
 = 
	`Áohl
(
hdr
->
d©a
.
publish
.
msg
.channel_len);

1915 
mes§ge_Ën
 = 
	`Áohl
(
hdr
->
d©a
.
publish
.
msg
.message_len);

1916 
chªÃl
 = 
	`ü—‹SŒšgObjeù
(

1917 (*)
hdr
->
d©a
.
publish
.
msg
.
bulk_d©a
,
chªÃl_Ën
);

1918 
mes§ge
 = 
	`ü—‹SŒšgObjeù
(

1919 (*)
hdr
->
d©a
.
publish
.
msg
.
bulk_d©a
+
chªÃl_Ën
,

1920 
mes§ge_Ën
);

1921 
	`pubsubPublishMes§ge
(
chªÃl
,
mes§ge
);

1922 
	`deüRefCouÁ
(
chªÃl
);

1923 
	`deüRefCouÁ
(
mes§ge
);

1925 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST
) {

1926 ià(!
£nd”
)  1;

1927 
	`şu¡”S’dFaov”AuthIfN“ded
(
£nd”
,
hdr
);

1928 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK
) {

1929 ià(!
£nd”
)  1;

1933 ià(
	`nodeIsMa¡”
(
£nd”
è&& s’d”->
num¦Ùs
 > 0 &&

1934 
£nd”Cu¼’tEpoch
 >ğ
£rv”
.
şu¡”
->
çov”_auth_•och
)

1936 
£rv”
.
şu¡”
->
çov”_auth_couÁ
++;

1939 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_HANDLE_FAILOVER
);

1941 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_MFSTART
) {

1944 ià(!
£nd”
 || s’d”->
¦aveof
 !ğ
my£lf
)  1;

1947 
	`»£tMªu®Faov”
();

1948 
£rv”
.
şu¡”
->
mf_’d
 = 
	`m¡ime
(è+ 
CLUSTER_MF_TIMEOUT
;

1949 
£rv”
.
şu¡”
->
mf_¦ave
 = 
£nd”
;

1950 
	`·u£Cl›Ás
(
	`m¡ime
()+(
CLUSTER_MF_TIMEOUT
*2));

1951 
	`£rv”Log
(
LL_WARNING
,"Manual failover„equested by slave %.40s.",

1952 
£nd”
->
Çme
);

1953 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_UPDATE
) {

1954 
şu¡”Node
 *
n
;

1955 
ušt64_t
 
»pÜ‹dCÚfigEpoch
 =

1956 
	`Áohu64
(
hdr
->
d©a
.
upd©e
.
nodecfg
.
cÚfigEpoch
);

1958 ià(!
£nd”
)  1;

1959 
n
 = 
	`şu¡”LookupNode
(
hdr
->
d©a
.
upd©e
.
nodecfg
.
nod’ame
);

1960 ià(!
n
)  1;

1961 ià(
n
->
cÚfigEpoch
 >ğ
»pÜ‹dCÚfigEpoch
)  1;

1964 ià(
	`nodeIsSÏve
(
n
)è
	`şu¡”S‘NodeAsMa¡”
(n);

1967 
n
->
cÚfigEpoch
 = 
»pÜ‹dCÚfigEpoch
;

1968 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

1969 
CLUSTER_TODO_FSYNC_CONFIG
);

1973 
	`şu¡”Upd©eSlÙsCÚfigW™h
(
n
,
»pÜ‹dCÚfigEpoch
,

1974 
hdr
->
d©a
.
upd©e
.
nodecfg
.
¦Ùs
);

1976 
	`£rv”Log
(
LL_WARNING
,"Reûived unknowÀ·ck‘y³: %d", 
ty³
);

1979 
	}
}

1987 
	$hªdËLškIOE¼Ü
(
şu¡”Lšk
 *
lšk
) {

1988 
	`ä“Clu¡”Lšk
(
lšk
);

1989 
	}
}

1994 
	$şu¡”Wr™eHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

1995 
şu¡”Lšk
 *
lšk
 = (şu¡”Lšk*è
´ivd©a
;

1996 
ssize_t
 
nwr™‹n
;

1997 
	`UNUSED
(
–
);

1998 
	`UNUSED
(
mask
);

2000 
nwr™‹n
 = 
	`wr™e
(
fd
, 
lšk
->
¢dbuf
, 
	`sd¦’
(link->sndbuf));

2001 ià(
nwr™‹n
 <= 0) {

2002 
	`£rv”Log
(
LL_DEBUG
,"I/Oƒrror writingo‚ode†ink: %s",

2003 
	`¡»¼Ü
(
”ºo
));

2004 
	`hªdËLškIOE¼Ü
(
lšk
);

2007 
	`sd¤ªge
(
lšk
->
¢dbuf
,
nwr™‹n
,-1);

2008 ià(
	`sd¦’
(
lšk
->
¢dbuf
) == 0)

2009 
	`«D–‘eFeEv’t
(
£rv”
.
–
, 
lšk
->
fd
, 
AE_WRITABLE
);

2010 
	}
}

2015 
	$şu¡”R—dHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

2016 
buf
[(
şu¡”Msg
)];

2017 
ssize_t
 
Ä—d
;

2018 
şu¡”Msg
 *
hdr
;

2019 
şu¡”Lšk
 *
lšk
 = (şu¡”Lšk*è
´ivd©a
;

2020 
»adËn
, 
rcvbuæ’
;

2021 
	`UNUSED
(
–
);

2022 
	`UNUSED
(
mask
);

2025 
rcvbuæ’
 = 
	`sd¦’
(
lšk
->
rcvbuf
);

2026 ià(
rcvbuæ’
 < 8) {

2029 
»adËn
 = 8 - 
rcvbuæ’
;

2032 
hdr
 = (
şu¡”Msg
*è
lšk
->
rcvbuf
;

2033 ià(
rcvbuæ’
 == 8) {

2036 ià(
	`memcmp
(
hdr
->
sig
,"RCmb",4) != 0 ||

2037 
	`Áohl
(
hdr
->
tÙËn
è< 
CLUSTERMSG_MIN_LEN
)

2039 
	`£rv”Log
(
LL_WARNING
,

2042 
	`hªdËLškIOE¼Ü
(
lšk
);

2046 
»adËn
 = 
	`Áohl
(
hdr
->
tÙËn
è- 
rcvbuæ’
;

2047 ià(
»adËn
 > (
buf
))„eadlen = (buf);

2050 
Ä—d
 = 
	`»ad
(
fd
,
buf
,
»adËn
);

2051 ià(
Ä—d
 =ğ-1 && 
”ºo
 =ğ
EAGAIN
) ;

2053 ià(
Ä—d
 <= 0) {

2055 
	`£rv”Log
(
LL_DEBUG
,"I/Oƒrror„eading from‚ode†ink: %s",

2056 (
Ä—d
 =ğ0è? "cÚÃùiÚ clo£d" : 
	`¡»¼Ü
(
”ºo
));

2057 
	`hªdËLškIOE¼Ü
(
lšk
);

2061 
lšk
->
rcvbuf
 = 
	`sdsÿ’
Öšk->rcvbuf,
buf
,
Ä—d
);

2062 
hdr
 = (
şu¡”Msg
*è
lšk
->
rcvbuf
;

2063 
rcvbuæ’
 +ğ
Ä—d
;

2067 ià(
rcvbuæ’
 >ğ8 &&„cvbuæ’ =ğ
	`Áohl
(
hdr
->
tÙËn
)) {

2068 ià(
	`şu¡”ProûssPack‘
(
lšk
)) {

2069 
	`sdsä“
(
lšk
->
rcvbuf
);

2070 
lšk
->
rcvbuf
 = 
	`sd£m±y
();

2076 
	}
}

2083 
	$şu¡”S’dMes§ge
(
şu¡”Lšk
 *
lšk
, *
msg
, 
size_t
 
msgËn
) {

2084 ià(
	`sd¦’
(
lšk
->
¢dbuf
è=ğ0 && 
msgËn
 != 0)

2085 
	`«C»©eFeEv’t
(
£rv”
.
–
,
lšk
->
fd
,
AE_WRITABLE
,

2086 
şu¡”Wr™eHªdËr
,
lšk
);

2088 
lšk
->
¢dbuf
 = 
	`sdsÿ’
Öšk->¢dbuf, 
msg
, 
msgËn
);

2089 
£rv”
.
şu¡”
->
¡©s_bus_mes§ges_£Á
++;

2090 
	}
}

2098 
	$şu¡”Brßdÿ¡Mes§ge
(*
buf
, 
size_t
 
Ën
) {

2099 
diùI‹¿tÜ
 *
di
;

2100 
diùEÁry
 *
de
;

2102 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

2103 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

2104 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

2106 ià(!
node
->
lšk
) ;

2107 ià(
node
->
æags
 & (
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_HANDSHAKE
))

2109 
	`şu¡”S’dMes§ge
(
node
->
lšk
,
buf
,
Ën
);

2111 
	`diùR–—£I‹¿tÜ
(
di
);

2112 
	}
}

2116 
	$şu¡”BudMes§geHdr
(
şu¡”Msg
 *
hdr
, 
ty³
) {

2117 
tÙËn
 = 0;

2118 
ušt64_t
 
off£t
;

2119 
şu¡”Node
 *
ma¡”
;

2125 
ma¡”
 = (
	`nodeIsSÏve
(
my£lf
è&& my£lf->
¦aveof
) ?

2126 
my£lf
->
¦aveof
 : myself;

2128 
	`mem£t
(
hdr
,0,(*hdr));

2129 
hdr
->
v”
 = 
	`htÚs
(
CLUSTER_PROTO_VER
);

2130 
hdr
->
sig
[0] = 'R';

2131 
hdr
->
sig
[1] = 'C';

2132 
hdr
->
sig
[2] = 'm';

2133 
hdr
->
sig
[3] = 'b';

2134 
hdr
->
ty³
 = 
	`htÚs
(type);

2135 
	`memıy
(
hdr
->
£nd”
,
my£lf
->
Çme
,
CLUSTER_NAMELEN
);

2137 
	`memıy
(
hdr
->
my¦Ùs
,
ma¡”
->
¦Ùs
,(hdr->myslots));

2138 
	`mem£t
(
hdr
->
¦aveof
,0,
CLUSTER_NAMELEN
);

2139 ià(
my£lf
->
¦aveof
 !ğ
NULL
)

2140 
	`memıy
(
hdr
->
¦aveof
,
my£lf
->¦aveof->
Çme
, 
CLUSTER_NAMELEN
);

2141 
hdr
->
pÜt
 = 
	`htÚs
(
£rv”
.port);

2142 
hdr
->
æags
 = 
	`htÚs
(
my£lf
->flags);

2143 
hdr
->
¡©e
 = 
£rv”
.
şu¡”
->state;

2146 
hdr
->
cu¼’tEpoch
 = 
	`htÚu64
(
£rv”
.
şu¡”
->currentEpoch);

2147 
hdr
->
cÚfigEpoch
 = 
	`htÚu64
(
ma¡”
->configEpoch);

2150 ià(
	`nodeIsSÏve
(
my£lf
))

2151 
off£t
 = 
	`»¶iÿtiÚG‘SÏveOff£t
();

2153 
off£t
 = 
£rv”
.
ma¡”_»¶_off£t
;

2154 
hdr
->
off£t
 = 
	`htÚu64
(offset);

2157 ià(
	`nodeIsMa¡”
(
my£lf
è&& 
£rv”
.
şu¡”
->
mf_’d
)

2158 
hdr
->
mæags
[0] |ğ
CLUSTERMSG_FLAG0_PAUSED
;

2162 ià(
ty³
 =ğ
CLUSTERMSG_TYPE_FAIL
) {

2163 
tÙËn
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

2164 
tÙËn
 +ğ(
şu¡”MsgD©aFa
);

2165 } ià(
ty³
 =ğ
CLUSTERMSG_TYPE_UPDATE
) {

2166 
tÙËn
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

2167 
tÙËn
 +ğ(
şu¡”MsgD©aUpd©e
);

2169 
hdr
->
tÙËn
 = 
	`htÚl
(totlen);

2171 
	}
}

2175 
	$şu¡”S’dPšg
(
şu¡”Lšk
 *
lšk
, 
ty³
) {

2176 *
buf
;

2177 
şu¡”Msg
 *
hdr
;

2178 
gosscouÁ
 = 0;

2179 
wª‹d
;

2180 
tÙËn
;

2185 
äeshnodes
 = 
	`diùSize
(
£rv”
.
şu¡”
->
nodes
)-2;

2213 
wª‹d
 = 
	`æoÜ
(
	`diùSize
(
£rv”
.
şu¡”
->
nodes
)/10);

2214 ià(
wª‹d
 < 3) wanted = 3;

2215 ià(
wª‹d
 > 
äeshnodes
) wanted = freshnodes;

2220 
tÙËn
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

2221 
tÙËn
 +ğ((
şu¡”MsgD©aGoss
)*
wª‹d
);

2224 ià(
tÙËn
 < ()(
şu¡”Msg
))otlen = (clusterMsg);

2225 
buf
 = 
	`zÿÎoc
(
tÙËn
);

2226 
hdr
 = (
şu¡”Msg
*è
buf
;

2229 ià(
lšk
->
node
 && 
ty³
 =ğ
CLUSTERMSG_TYPE_PING
)

2230 
lšk
->
node
->
pšg_£Á
 = 
	`m¡ime
();

2231 
	`şu¡”BudMes§geHdr
(
hdr
,
ty³
);

2234 
max™”©iÚs
 = 
wª‹d
*3;

2235 
äeshnodes
 > 0 && 
gosscouÁ
 < 
wª‹d
 && 
max™”©iÚs
--) {

2236 
diùEÁry
 *
de
 = 
	`diùG‘RªdomKey
(
£rv”
.
şu¡”
->
nodes
);

2237 
şu¡”Node
 *
this
 = 
	`diùG‘V®
(
de
);

2238 
şu¡”MsgD©aGoss
 *
goss
;

2239 
j
;

2243 ià(
this
 =ğ
my£lf
) ;

2246 ià(
max™”©iÚs
 > 
wª‹d
*2 &&

2247 !(
this
->
æags
 & (
CLUSTER_NODE_PFAIL
|
CLUSTER_NODE_FAIL
)))

2255 ià(
this
->
æags
 & (
CLUSTER_NODE_HANDSHAKE
|
CLUSTER_NODE_NOADDR
) ||

2256 (
this
->
lšk
 =ğ
NULL
 &&his->
num¦Ùs
 == 0))

2258 
äeshnodes
--;

2263 
j
 = 0; j < 
gosscouÁ
; j++) {

2264 ià(
	`memcmp
(
hdr
->
d©a
.
pšg
.
goss
[
j
].
nod’ame
,
this
->
Çme
,

2265 
CLUSTER_NAMELEN
) == 0) ;

2267 ià(
j
 !ğ
gosscouÁ
) ;

2270 
äeshnodes
--;

2271 
goss
 = &(
hdr
->
d©a
.
pšg
.goss[
gosscouÁ
]);

2272 
	`memıy
(
goss
->
nod’ame
,
this
->
Çme
,
CLUSTER_NAMELEN
);

2273 
goss
->
pšg_£Á
 = 
	`htÚl
(
this
->ping_sent);

2274 
goss
->
pÚg_»ûived
 = 
	`htÚl
(
this
->pong_received);

2275 
	`memıy
(
goss
->

,
this
->ip,(this->ip));

2276 
goss
->
pÜt
 = 
	`htÚs
(
this
->port);

2277 
goss
->
æags
 = 
	`htÚs
(
this
->flags);

2278 
goss
->
nÙu£d1
 = 0;

2279 
goss
->
nÙu£d2
 = 0;

2280 
gosscouÁ
++;

2285 
tÙËn
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

2286 
tÙËn
 +ğ((
şu¡”MsgD©aGoss
)*
gosscouÁ
);

2287 
hdr
->
couÁ
 = 
	`htÚs
(
gosscouÁ
);

2288 
hdr
->
tÙËn
 = 
	`htÚl
(totlen);

2289 
	`şu¡”S’dMes§ge
(
lšk
,
buf
,
tÙËn
);

2290 
	`zä“
(
buf
);

2291 
	}
}

2307 
	#CLUSTER_BROADCAST_ALL
 0

	)

2308 
	#CLUSTER_BROADCAST_LOCAL_SLAVES
 1

	)

2309 
	$şu¡”Brßdÿ¡PÚg
(
rg‘
) {

2310 
diùI‹¿tÜ
 *
di
;

2311 
diùEÁry
 *
de
;

2313 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

2314 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

2315 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

2317 ià(!
node
->
lšk
) ;

2318 ià(
node
 =ğ
my£lf
 || 
	`nodeInHªdshake
(node)) ;

2319 ià(
rg‘
 =ğ
CLUSTER_BROADCAST_LOCAL_SLAVES
) {

2320 
loÿl_¦ave
 =

2321 
	`nodeIsSÏve
(
node
è&&‚ode->
¦aveof
 &&

2322 (
node
->
¦aveof
 =ğ
my£lf
 ||‚ode->slaveof == myself->slaveof);

2323 ià(!
loÿl_¦ave
) ;

2325 
	`şu¡”S’dPšg
(
node
->
lšk
,
CLUSTERMSG_TYPE_PONG
);

2327 
	`diùR–—£I‹¿tÜ
(
di
);

2328 
	}
}

2333 
	$şu¡”S’dPublish
(
şu¡”Lšk
 *
lšk
, 
robj
 *
chªÃl
,„obj *
mes§ge
) {

2334 
buf
[(
şu¡”Msg
)], *
·ylßd
;

2335 
şu¡”Msg
 *
hdr
 = (şu¡”Msg*è
buf
;

2336 
ušt32_t
 
tÙËn
;

2337 
ušt32_t
 
chªÃl_Ën
, 
mes§ge_Ën
;

2339 
chªÃl
 = 
	`g‘DecodedObjeù
(channel);

2340 
mes§ge
 = 
	`g‘DecodedObjeù
(message);

2341 
chªÃl_Ën
 = 
	`sd¦’
(
chªÃl
->
±r
);

2342 
mes§ge_Ën
 = 
	`sd¦’
(
mes§ge
->
±r
);

2344 
	`şu¡”BudMes§geHdr
(
hdr
,
CLUSTERMSG_TYPE_PUBLISH
);

2345 
tÙËn
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

2346 
tÙËn
 +ğ(
şu¡”MsgD©aPublish
è- 8 + 
chªÃl_Ën
 + 
mes§ge_Ën
;

2348 
hdr
->
d©a
.
publish
.
msg
.
chªÃl_Ën
 = 
	`htÚl
(channel_len);

2349 
hdr
->
d©a
.
publish
.
msg
.
mes§ge_Ën
 = 
	`htÚl
(message_len);

2350 
hdr
->
tÙËn
 = 
	`htÚl
(totlen);

2353 ià(
tÙËn
 < (
buf
)) {

2354 
·ylßd
 = 
buf
;

2356 
·ylßd
 = 
	`zm®loc
(
tÙËn
);

2357 
	`memıy
(
·ylßd
,
hdr
,(*hdr));

2358 
hdr
 = (
şu¡”Msg
*è
·ylßd
;

2360 
	`memıy
(
hdr
->
d©a
.
publish
.
msg
.
bulk_d©a
,
chªÃl
->
±r
,
	`sd¦’
(channel->ptr));

2361 
	`memıy
(
hdr
->
d©a
.
publish
.
msg
.
bulk_d©a
+
	`sd¦’
(
chªÃl
->
±r
),

2362 
mes§ge
->
±r
,
	`sd¦’
(message->ptr));

2364 ià(
lšk
)

2365 
	`şu¡”S’dMes§ge
(
lšk
,
·ylßd
,
tÙËn
);

2367 
	`şu¡”Brßdÿ¡Mes§ge
(
·ylßd
,
tÙËn
);

2369 
	`deüRefCouÁ
(
chªÃl
);

2370 
	`deüRefCouÁ
(
mes§ge
);

2371 ià(
·ylßd
 !ğ
buf
è
	`zä“
(payload);

2372 
	}
}

2379 
	$şu¡”S’dFa
(*
nod’ame
) {

2380 
buf
[(
şu¡”Msg
)];

2381 
şu¡”Msg
 *
hdr
 = (şu¡”Msg*è
buf
;

2383 
	`şu¡”BudMes§geHdr
(
hdr
,
CLUSTERMSG_TYPE_FAIL
);

2384 
	`memıy
(
hdr
->
d©a
.
ç
.
about
.
nod’ame
,nod’ame,
CLUSTER_NAMELEN
);

2385 
	`şu¡”Brßdÿ¡Mes§ge
(
buf
,
	`Áohl
(
hdr
->
tÙËn
));

2386 
	}
}

2391 
	$şu¡”S’dUpd©e
(
şu¡”Lšk
 *
lšk
, 
şu¡”Node
 *
node
) {

2392 
buf
[(
şu¡”Msg
)];

2393 
şu¡”Msg
 *
hdr
 = (şu¡”Msg*è
buf
;

2395 ià(
lšk
 =ğ
NULL
) ;

2396 
	`şu¡”BudMes§geHdr
(
hdr
,
CLUSTERMSG_TYPE_UPDATE
);

2397 
	`memıy
(
hdr
->
d©a
.
upd©e
.
nodecfg
.
nod’ame
,
node
->
Çme
,
CLUSTER_NAMELEN
);

2398 
hdr
->
d©a
.
upd©e
.
nodecfg
.
cÚfigEpoch
 = 
	`htÚu64
(
node
->configEpoch);

2399 
	`memıy
(
hdr
->
d©a
.
upd©e
.
nodecfg
.
¦Ùs
,
node
->slots,(node->slots));

2400 
	`şu¡”S’dMes§ge
(
lšk
,
buf
,
	`Áohl
(
hdr
->
tÙËn
));

2401 
	}
}

2410 
	$şu¡”Prİag©ePublish
(
robj
 *
chªÃl
,„obj *
mes§ge
) {

2411 
	`şu¡”S’dPublish
(
NULL
, 
chªÃl
, 
mes§ge
);

2412 
	}
}

2424 
	$şu¡”Reque¡Faov”Auth
() {

2425 
buf
[(
şu¡”Msg
)];

2426 
şu¡”Msg
 *
hdr
 = (şu¡”Msg*è
buf
;

2427 
ušt32_t
 
tÙËn
;

2429 
	`şu¡”BudMes§geHdr
(
hdr
,
CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST
);

2433 ià(
£rv”
.
şu¡”
->
mf_’d
è
hdr
->
mæags
[0] |ğ
CLUSTERMSG_FLAG0_FORCEACK
;

2434 
tÙËn
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

2435 
hdr
->
tÙËn
 = 
	`htÚl
(totlen);

2436 
	`şu¡”Brßdÿ¡Mes§ge
(
buf
,
tÙËn
);

2437 
	}
}

2440 
	$şu¡”S’dFaov”Auth
(
şu¡”Node
 *
node
) {

2441 
buf
[(
şu¡”Msg
)];

2442 
şu¡”Msg
 *
hdr
 = (şu¡”Msg*è
buf
;

2443 
ušt32_t
 
tÙËn
;

2445 ià(!
node
->
lšk
) ;

2446 
	`şu¡”BudMes§geHdr
(
hdr
,
CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK
);

2447 
tÙËn
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

2448 
hdr
->
tÙËn
 = 
	`htÚl
(totlen);

2449 
	`şu¡”S’dMes§ge
(
node
->
lšk
,
buf
,
tÙËn
);

2450 
	}
}

2453 
	$şu¡”S’dMFS¹
(
şu¡”Node
 *
node
) {

2454 
buf
[(
şu¡”Msg
)];

2455 
şu¡”Msg
 *
hdr
 = (şu¡”Msg*è
buf
;

2456 
ušt32_t
 
tÙËn
;

2458 ià(!
node
->
lšk
) ;

2459 
	`şu¡”BudMes§geHdr
(
hdr
,
CLUSTERMSG_TYPE_MFSTART
);

2460 
tÙËn
 = (
şu¡”Msg
)-(
şu¡”MsgD©a
);

2461 
hdr
->
tÙËn
 = 
	`htÚl
(totlen);

2462 
	`şu¡”S’dMes§ge
(
node
->
lšk
,
buf
,
tÙËn
);

2463 
	}
}

2466 
	$şu¡”S’dFaov”AuthIfN“ded
(
şu¡”Node
 *
node
, 
şu¡”Msg
 *
»que¡
) {

2467 
şu¡”Node
 *
ma¡”
 = 
node
->
¦aveof
;

2468 
ušt64_t
 
»que¡Cu¼’tEpoch
 = 
	`Áohu64
(
»que¡
->
cu¼’tEpoch
);

2469 
ušt64_t
 
»que¡CÚfigEpoch
 = 
	`Áohu64
(
»que¡
->
cÚfigEpoch
);

2470 *
şaimed_¦Ùs
 = 
»que¡
->
my¦Ùs
;

2471 
fÜû_ack
 = 
»que¡
->
mæags
[0] & 
CLUSTERMSG_FLAG0_FORCEACK
;

2472 
j
;

2478 ià(
	`nodeIsSÏve
(
my£lf
è|| my£lf->
num¦Ùs
 == 0) ;

2484 ià(
»que¡Cu¼’tEpoch
 < 
£rv”
.
şu¡”
->
cu¼’tEpoch
) {

2485 
	`£rv”Log
(
LL_WARNING
,

2487 
node
->
Çme
,

2488 (è
»que¡Cu¼’tEpoch
,

2489 (è
£rv”
.
şu¡”
->
cu¼’tEpoch
);

2494 ià(
£rv”
.
şu¡”
->
Ï¡VÙeEpoch
 =ğ£rv”.şu¡”->
cu¼’tEpoch
) {

2495 
	`£rv”Log
(
LL_WARNING
,

2497 
node
->
Çme
,

2498 (è
£rv”
.
şu¡”
->
cu¼’tEpoch
);

2505 ià(
	`nodeIsMa¡”
(
node
è|| 
ma¡”
 =ğ
NULL
 ||

2506 (!
	`nodeFaed
(
ma¡”
è&& !
fÜû_ack
))

2508 ià(
	`nodeIsMa¡”
(
node
)) {

2509 
	`£rv”Log
(
LL_WARNING
,

2511 
node
->
Çme
);

2512 } ià(
ma¡”
 =ğ
NULL
) {

2513 
	`£rv”Log
(
LL_WARNING
,

2515 
node
->
Çme
);

2516 } ià(!
	`nodeFaed
(
ma¡”
)) {

2517 
	`£rv”Log
(
LL_WARNING
,

2519 
node
->
Çme
);

2527 ià(
	`m¡ime
(è- 
node
->
¦aveof
->
vÙed_time
 < 
£rv”
.
şu¡”_node_timeout
 * 2)

2529 
	`£rv”Log
(
LL_WARNING
,

2532 
node
->
Çme
,

2533 (è((
£rv”
.
şu¡”_node_timeout
*2)-

2534 (
	`m¡ime
(è- 
node
->
¦aveof
->
vÙed_time
)));

2541 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

2542 ià(
	`b™m­Te¡B™
(
şaimed_¦Ùs
, 
j
) == 0) ;

2543 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
NULL
 ||

2544 
£rv”
.
şu¡”
->
¦Ùs
[
j
]->
cÚfigEpoch
 <ğ
»que¡CÚfigEpoch
)

2551 
	`£rv”Log
(
LL_WARNING
,

2554 
node
->
Çme
, 
j
,

2555 (è
£rv”
.
şu¡”
->
¦Ùs
[
j
]->
cÚfigEpoch
,

2556 (è
»que¡CÚfigEpoch
);

2561 
	`şu¡”S’dFaov”Auth
(
node
);

2562 
£rv”
.
şu¡”
->
Ï¡VÙeEpoch
 = s”v”.şu¡”->
cu¼’tEpoch
;

2563 
node
->
¦aveof
->
vÙed_time
 = 
	`m¡ime
();

2564 
	`£rv”Log
(
LL_WARNING
, "Failover‡uth grantedo %.40s forƒpoch %llu",

2565 
node
->
Çme
, (è
£rv”
.
şu¡”
->
cu¼’tEpoch
);

2566 
	}
}

2580 
	$şu¡”G‘SÏveRªk
() {

2581 
myoff£t
;

2582 
j
, 
¿nk
 = 0;

2583 
şu¡”Node
 *
ma¡”
;

2585 
	`£rv”As£¹
(
	`nodeIsSÏve
(
my£lf
));

2586 
ma¡”
 = 
my£lf
->
¦aveof
;

2587 ià(
ma¡”
 =ğ
NULL
)  0;

2589 
myoff£t
 = 
	`»¶iÿtiÚG‘SÏveOff£t
();

2590 
j
 = 0; j < 
ma¡”
->
num¦aves
; j++)

2591 ià(
ma¡”
->
¦aves
[
j
] !ğ
my£lf
 &&

2592 
ma¡”
->
¦aves
[
j
]->
»¶_off£t
 > 
myoff£t
è
¿nk
++;

2593  
¿nk
;

2594 
	}
}

2618 
	$şu¡”LogCªtFaov”
(
»asÚ
) {

2619 *
msg
;

2620 
time_t
 
Ï¡log_time
 = 0;

2621 
m¡ime_t
 
nŞog_ç_time
 = 
£rv”
.
şu¡”_node_timeout
 + 5000;

2624 ià(
»asÚ
 =ğ
£rv”
.
şu¡”
->
ÿÁ_çov”_»asÚ
 &&

2625 
	`time
(
NULL
)-
Ï¡log_time
 < 
CLUSTER_CANT_FAILOVER_RELOG_PERIOD
)

2628 
£rv”
.
şu¡”
->
ÿÁ_çov”_»asÚ
 = 
»asÚ
;

2633 ià(
my£lf
->
¦aveof
 &&

2634 
	`nodeFaed
(
my£lf
->
¦aveof
) &&

2635 (
	`m¡ime
(è- 
my£lf
->
¦aveof
->
ç_time
è< 
nŞog_ç_time
) ;

2637 
»asÚ
) {

2638 
CLUSTER_CANT_FAILOVER_DATA_AGE
:

2639 
msg
 = "Disconnected from master for†ongerhan‡llowed. "

2643 
CLUSTER_CANT_FAILOVER_WAITING_DELAY
:

2644 
msg
 = "Waitinghe delay before I can start‡‚ew failover.";

2646 
CLUSTER_CANT_FAILOVER_EXPIRED
:

2647 
msg
 = "Failover‡ttemptƒxpired.";

2649 
CLUSTER_CANT_FAILOVER_WAITING_VOTES
:

2650 
msg
 = "Waiting for votes, but majority still‚ot„eached.";

2653 
msg
 = "Unknown„eason code.";

2656 
Ï¡log_time
 = 
	`time
(
NULL
);

2657 
	`£rv”Log
(
LL_WARNING
,"Cu¼’y uÇbËØçov”: %s", 
msg
);

2658 
	}
}

2666 
	$şu¡”Faov”R•ÏûYourMa¡”
() {

2667 
j
;

2668 
şu¡”Node
 *
Şdma¡”
 = 
my£lf
->
¦aveof
;

2670 ià(
	`nodeIsMa¡”
(
my£lf
è|| 
Şdma¡”
 =ğ
NULL
) ;

2673 
	`şu¡”S‘NodeAsMa¡”
(
my£lf
);

2674 
	`»¶iÿtiÚUn£tMa¡”
();

2677 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

2678 ià(
	`şu¡”NodeG‘SlÙB™
(
Şdma¡”
,
j
)) {

2679 
	`şu¡”D–SlÙ
(
j
);

2680 
	`şu¡”AddSlÙ
(
my£lf
,
j
);

2685 
	`şu¡”Upd©eS‹
();

2686 
	`şu¡”SaveCÚfigOrD›
(1);

2690 
	`şu¡”Brßdÿ¡PÚg
(
CLUSTER_BROADCAST_ALL
);

2693 
	`»£tMªu®Faov”
();

2694 
	}
}

2704 
	$şu¡”HªdËSÏveFaov”
() {

2705 
m¡ime_t
 
d©a_age
;

2706 
m¡ime_t
 
auth_age
 = 
	`m¡ime
(è- 
£rv”
.
şu¡”
->
çov”_auth_time
;

2707 
Ãeded_quÜum
 = (
£rv”
.
şu¡”
->
size
 / 2) + 1;

2708 
mªu®_çov”
 = 
£rv”
.
şu¡”
->
mf_’d
 != 0 &&

2709 
£rv”
.
şu¡”
->
mf_ÿn_¡¬t
;

2710 
m¡ime_t
 
auth_timeout
, 
auth_»Œy_time
;

2712 
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 &ğ~
CLUSTER_TODO_HANDLE_FAILOVER
;

2721 
auth_timeout
 = 
£rv”
.
şu¡”_node_timeout
*2;

2722 ià(
auth_timeout
 < 2000)‡uth_timeout = 2000;

2723 
auth_»Œy_time
 = 
auth_timeout
*2;

2730 ià(
	`nodeIsMa¡”
(
my£lf
) ||

2731 
my£lf
->
¦aveof
 =ğ
NULL
 ||

2732 (!
	`nodeFaed
(
my£lf
->
¦aveof
è&& !
mªu®_çov”
) ||

2733 
my£lf
->
¦aveof
->
num¦Ùs
 == 0)

2737 
£rv”
.
şu¡”
->
ÿÁ_çov”_»asÚ
 = 
CLUSTER_CANT_FAILOVER_NONE
;

2743 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_CONNECTED
) {

2744 
d©a_age
 = (
m¡ime_t
)(
£rv”
.
unixtime
 - s”v”.
ma¡”
->
Ï¡š‹¿ùiÚ
)

2747 
d©a_age
 = (
m¡ime_t
)(
£rv”
.
unixtime
 - s”v”.
»¶_down_sšû
) * 1000;

2753 ià(
d©a_age
 > 
£rv”
.
şu¡”_node_timeout
)

2754 
d©a_age
 -ğ
£rv”
.
şu¡”_node_timeout
;

2760 ià(
£rv”
.
şu¡”_¦ave_v®id™y_çùÜ
 &&

2761 
d©a_age
 >

2762 (((
m¡ime_t
)
£rv”
.
»¶_pšg_¦ave_³riod
 * 1000) +

2763 (
£rv”
.
şu¡”_node_timeout
 * s”v”.
şu¡”_¦ave_v®id™y_çùÜ
)))

2765 ià(!
mªu®_çov”
) {

2766 
	`şu¡”LogCªtFaov”
(
CLUSTER_CANT_FAILOVER_DATA_AGE
);

2773 ià(
auth_age
 > 
auth_»Œy_time
) {

2774 
£rv”
.
şu¡”
->
çov”_auth_time
 = 
	`m¡ime
() +

2776 
	`¿ndom
() % 500;

2777 
£rv”
.
şu¡”
->
çov”_auth_couÁ
 = 0;

2778 
£rv”
.
şu¡”
->
çov”_auth_£Á
 = 0;

2779 
£rv”
.
şu¡”
->
çov”_auth_¿nk
 = 
	`şu¡”G‘SÏveRªk
();

2783 
£rv”
.
şu¡”
->
çov”_auth_time
 +=

2784 
£rv”
.
şu¡”
->
çov”_auth_¿nk
 * 1000;

2786 ià(
£rv”
.
şu¡”
->
mf_’d
) {

2787 
£rv”
.
şu¡”
->
çov”_auth_time
 = 
	`m¡ime
();

2788 
£rv”
.
şu¡”
->
çov”_auth_¿nk
 = 0;

2790 
	`£rv”Log
(
LL_WARNING
,

2793 
£rv”
.
şu¡”
->
çov”_auth_time
 - 
	`m¡ime
(),

2794 
£rv”
.
şu¡”
->
çov”_auth_¿nk
,

2795 
	`»¶iÿtiÚG‘SÏveOff£t
());

2799 
	`şu¡”Brßdÿ¡PÚg
(
CLUSTER_BROADCAST_LOCAL_SLAVES
);

2808 ià(
£rv”
.
şu¡”
->
çov”_auth_£Á
 == 0 &&

2809 
£rv”
.
şu¡”
->
mf_’d
 == 0)

2811 
Ãw¿nk
 = 
	`şu¡”G‘SÏveRªk
();

2812 ià(
Ãw¿nk
 > 
£rv”
.
şu¡”
->
çov”_auth_¿nk
) {

2813 
added_d–ay
 =

2814 (
Ãw¿nk
 - 
£rv”
.
şu¡”
->
çov”_auth_¿nk
) * 1000;

2815 
£rv”
.
şu¡”
->
çov”_auth_time
 +ğ
added_d–ay
;

2816 
£rv”
.
şu¡”
->
çov”_auth_¿nk
 = 
Ãw¿nk
;

2817 
	`£rv”Log
(
LL_WARNING
,

2819 
Ãw¿nk
, 
added_d–ay
);

2824 ià(
	`m¡ime
(è< 
£rv”
.
şu¡”
->
çov”_auth_time
) {

2825 
	`şu¡”LogCªtFaov”
(
CLUSTER_CANT_FAILOVER_WAITING_DELAY
);

2830 ià(
auth_age
 > 
auth_timeout
) {

2831 
	`şu¡”LogCªtFaov”
(
CLUSTER_CANT_FAILOVER_EXPIRED
);

2836 ià(
£rv”
.
şu¡”
->
çov”_auth_£Á
 == 0) {

2837 
£rv”
.
şu¡”
->
cu¼’tEpoch
++;

2838 
£rv”
.
şu¡”
->
çov”_auth_•och
 = s”v”.şu¡”->
cu¼’tEpoch
;

2839 
	`£rv”Log
(
LL_WARNING
,"Starting‡ failoverƒlection forƒpoch %llu.",

2840 (è
£rv”
.
şu¡”
->
cu¼’tEpoch
);

2841 
	`şu¡”Reque¡Faov”Auth
();

2842 
£rv”
.
şu¡”
->
çov”_auth_£Á
 = 1;

2843 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|

2844 
CLUSTER_TODO_UPDATE_STATE
|

2845 
CLUSTER_TODO_FSYNC_CONFIG
);

2850 ià(
£rv”
.
şu¡”
->
çov”_auth_couÁ
 >ğ
Ãeded_quÜum
) {

2853 
	`£rv”Log
(
LL_WARNING
,

2857 ià(
my£lf
->
cÚfigEpoch
 < 
£rv”
.
şu¡”
->
çov”_auth_•och
) {

2858 
my£lf
->
cÚfigEpoch
 = 
£rv”
.
şu¡”
->
çov”_auth_•och
;

2859 
	`£rv”Log
(
LL_WARNING
,

2861 (è
my£lf
->
cÚfigEpoch
);

2865 
	`şu¡”Faov”R•ÏûYourMa¡”
();

2867 
	`şu¡”LogCªtFaov”
(
CLUSTER_CANT_FAILOVER_WAITING_VOTES
);

2869 
	}
}

2898 
	$şu¡”HªdËSÏveMig¿tiÚ
(
max_¦aves
) {

2899 
j
, 
ok¦aves
 = 0;

2900 
şu¡”Node
 *
myma¡”
 = 
my£lf
->
¦aveof
, *
rg‘
 = 
NULL
, *
ÿndid©e
 = NULL;

2901 
diùI‹¿tÜ
 *
di
;

2902 
diùEÁry
 *
de
;

2905 ià(
£rv”
.
şu¡”
->
¡©e
 !ğ
CLUSTER_OK
) ;

2909 ià(
myma¡”
 =ğ
NULL
) ;

2910 
j
 = 0; j < 
myma¡”
->
num¦aves
; j++)

2911 ià(!
	`nodeFaed
(
myma¡”
->
¦aves
[
j
]) &&

2912 !
	`nodeTimedOut
(
myma¡”
->
¦aves
[
j
])è
ok¦aves
++;

2913 ià(
ok¦aves
 <ğ
£rv”
.
şu¡”_mig¿tiÚ_b¬r›r
) ;

2925 
ÿndid©e
 = 
my£lf
;

2926 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

2927 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

2928 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

2929 
ok¦aves
 = 0, 
is_Üphªed
 = 1;

2935 ià(
	`nodeIsSÏve
(
node
è|| 
	`nodeFaed
Òode)è
is_Üphªed
 = 0;

2936 ià(!(
node
->
æags
 & 
CLUSTER_NODE_MIGRATE_TO
)è
is_Üphªed
 = 0;

2939 ià(
	`nodeIsMa¡”
(
node
)è
ok¦aves
 = 
	`şu¡”CouÁNÚFašgSÏves
(node);

2940 ià(
ok¦aves
 > 0è
is_Üphªed
 = 0;

2942 ià(
is_Üphªed
) {

2943 ià(!
rg‘
 && 
node
->
num¦Ùs
 > 0)arget =‚ode;

2947 ià(!
node
->
Üphªed_time
ènode->Üphªed_timğ
	`m¡ime
();

2949 
node
->
Üphªed_time
 = 0;

2955 ià(
ok¦aves
 =ğ
max_¦aves
) {

2956 
j
 = 0; j < 
node
->
num¦aves
; j++) {

2957 ià(
	`memcmp
(
node
->
¦aves
[
j
]->
Çme
,

2958 
ÿndid©e
->
Çme
,

2959 
CLUSTER_NAMELEN
) < 0)

2961 
ÿndid©e
 = 
node
->
¦aves
[
j
];

2966 
	`diùR–—£I‹¿tÜ
(
di
);

2973 ià(
rg‘
 && 
ÿndid©e
 =ğ
my£lf
 &&

2974 (
	`m¡ime
()-
rg‘
->
Üphªed_time
è> 
CLUSTER_SLAVE_MIGRATION_DELAY
)

2976 
	`£rv”Log
(
LL_WARNING
,"Migratingo orphaned master %.40s",

2977 
rg‘
->
Çme
);

2978 
	`şu¡”S‘Ma¡”
(
rg‘
);

2980 
	}
}

3016 
	$»£tMªu®Faov”
() {

3017 ià(
£rv”
.
şu¡”
->
mf_’d
 && 
	`ş›ÁsA»Pau£d
()) {

3018 
£rv”
.
ş›Ás_·u£_’d_time
 = 0;

3019 
	`ş›ÁsA»Pau£d
();

3021 
£rv”
.
şu¡”
->
mf_’d
 = 0;

3022 
£rv”
.
şu¡”
->
mf_ÿn_¡¬t
 = 0;

3023 
£rv”
.
şu¡”
->
mf_¦ave
 = 
NULL
;

3024 
£rv”
.
şu¡”
->
mf_ma¡”_off£t
 = 0;

3025 
	}
}

3028 
	$mªu®Faov”CheckTimeout
() {

3029 ià(
£rv”
.
şu¡”
->
mf_’d
 && s”v”.şu¡”->mf_’d < 
	`m¡ime
()) {

3030 
	`£rv”Log
(
LL_WARNING
,"Manual failoverimed out.");

3031 
	`»£tMªu®Faov”
();

3033 
	}
}

3037 
	$şu¡”HªdËMªu®Faov”
() {

3039 ià(
£rv”
.
şu¡”
->
mf_’d
 == 0) ;

3043 ià(
£rv”
.
şu¡”
->
mf_ÿn_¡¬t
) ;

3045 ià(
£rv”
.
şu¡”
->
mf_ma¡”_off£t
 == 0) ;

3047 ià(
£rv”
.
şu¡”
->
mf_ma¡”_off£t
 =ğ
	`»¶iÿtiÚG‘SÏveOff£t
()) {

3050 
£rv”
.
şu¡”
->
mf_ÿn_¡¬t
 = 1;

3051 
	`£rv”Log
(
LL_WARNING
,

3055 
	}
}

3062 
	$şu¡”CrÚ
() {

3063 
diùI‹¿tÜ
 *
di
;

3064 
diùEÁry
 *
de
;

3065 
upd©e_¡©e
 = 0;

3066 
Üphªed_ma¡”s
;

3067 
max_¦aves
;

3068 
this_¦aves
;

3069 
m¡ime_t
 
mš_pÚg
 = 0, 
now
 = 
	`m¡ime
();

3070 
şu¡”Node
 *
mš_pÚg_node
 = 
NULL
;

3071 
™”©iÚ
 = 0;

3072 
m¡ime_t
 
hªdshake_timeout
;

3074 
™”©iÚ
++;

3080 
hªdshake_timeout
 = 
£rv”
.
şu¡”_node_timeout
;

3081 ià(
hªdshake_timeout
 < 1000) handshake_timeout = 1000;

3084 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

3085 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3086 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

3088 ià(
node
->
æags
 & (
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_NOADDR
)) ;

3092 ià(
	`nodeInHªdshake
(
node
è&& 
now
 -‚ode->
ùime
 > 
hªdshake_timeout
) {

3093 
	`şu¡”D–Node
(
node
);

3097 ià(
node
->
lšk
 =ğ
NULL
) {

3098 
fd
;

3099 
m¡ime_t
 
Şd_pšg_£Á
;

3100 
şu¡”Lšk
 *
lšk
;

3102 
fd
 = 
	`ª‘TıNÚBlockBšdCÚÃù
(
£rv”
.
Ã‹¼
, 
node
->

,

3103 
node
->
pÜt
+
CLUSTER_PORT_INCR
, 
NET_FIRST_BIND_ADDR
);

3104 ià(
fd
 == -1) {

3110 ià(
node
->
pšg_£Á
 =ğ0ènode->pšg_£Á = 
	`m¡ime
();

3111 
	`£rv”Log
(
LL_DEBUG
, "Unableo connecto "

3112 "Clu¡” Nod[%s]:%d -> %s", 
node
->

,

3113 
node
->
pÜt
+
CLUSTER_PORT_INCR
,

3114 
£rv”
.
Ã‹¼
);

3117 
lšk
 = 
	`ü—‹Clu¡”Lšk
(
node
);

3118 
lšk
->
fd
 = fd;

3119 
node
->
lšk
 =†ink;

3120 
	`«C»©eFeEv’t
(
£rv”
.
–
,
lšk
->
fd
,
AE_READABLE
,

3121 
şu¡”R—dHªdËr
,
lšk
);

3128 
Şd_pšg_£Á
 = 
node
->
pšg_£Á
;

3129 
	`şu¡”S’dPšg
(
lšk
, 
node
->
æags
 & 
CLUSTER_NODE_MEET
 ?

3130 
CLUSTERMSG_TYPE_MEET
 : 
CLUSTERMSG_TYPE_PING
);

3131 ià(
Şd_pšg_£Á
) {

3135 
node
->
pšg_£Á
 = 
Şd_pšg_£Á
;

3142 
node
->
æags
 &ğ~
CLUSTER_NODE_MEET
;

3144 
	`£rv”Log
(
LL_DEBUG
,"Connecting with Node %.40s‡t %s:%d",

3145 
node
->
Çme
,‚ode->

,‚ode->
pÜt
+
CLUSTER_PORT_INCR
);

3148 
	`diùR–—£I‹¿tÜ
(
di
);

3152 ià(!(
™”©iÚ
 % 10)) {

3153 
j
;

3157 
j
 = 0; j < 5; j++) {

3158 
de
 = 
	`diùG‘RªdomKey
(
£rv”
.
şu¡”
->
nodes
);

3159 
şu¡”Node
 *
this
 = 
	`diùG‘V®
(
de
);

3162 ià(
this
->
lšk
 =ğ
NULL
 ||his->
pšg_£Á
 != 0) ;

3163 ià(
this
->
æags
 & (
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_HANDSHAKE
))

3165 ià(
mš_pÚg_node
 =ğ
NULL
 || 
mš_pÚg
 > 
this
->
pÚg_»ûived
) {

3166 
mš_pÚg_node
 = 
this
;

3167 
mš_pÚg
 = 
this
->
pÚg_»ûived
;

3170 ià(
mš_pÚg_node
) {

3171 
	`£rv”Log
(
LL_DEBUG
,"Pšgšg‚od%.40s", 
mš_pÚg_node
->
Çme
);

3172 
	`şu¡”S’dPšg
(
mš_pÚg_node
->
lšk
, 
CLUSTERMSG_TYPE_PING
);

3182 
Üphªed_ma¡”s
 = 0;

3183 
max_¦aves
 = 0;

3184 
this_¦aves
 = 0;

3185 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

3186 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3187 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

3188 
now
 = 
	`m¡ime
();

3189 
m¡ime_t
 
d–ay
;

3191 ià(
node
->
æags
 &

3192 (
CLUSTER_NODE_MYSELF
|
CLUSTER_NODE_NOADDR
|
CLUSTER_NODE_HANDSHAKE
))

3197 ià(
	`nodeIsSÏve
(
my£lf
è&& 
	`nodeIsMa¡”
(
node
è&& !
	`nodeFaed
(node)) {

3198 
ok¦aves
 = 
	`şu¡”CouÁNÚFašgSÏves
(
node
);

3203 ià(
ok¦aves
 =ğ0 && 
node
->
num¦Ùs
 > 0 &&

3204 
node
->
æags
 & 
CLUSTER_NODE_MIGRATE_TO
)

3206 
Üphªed_ma¡”s
++;

3208 ià(
ok¦aves
 > 
max_¦aves
) max_slaves = okslaves;

3209 ià(
	`nodeIsSÏve
(
my£lf
è&& my£lf->
¦aveof
 =ğ
node
)

3210 
this_¦aves
 = 
ok¦aves
;

3216 ià(
node
->
lšk
 &&

3217 
now
 - 
node
->
lšk
->
ùime
 >

3218 
£rv”
.
şu¡”_node_timeout
 &&

3219 
node
->
pšg_£Á
 &&

3220 
node
->
pÚg_»ûived
 <‚ode->
pšg_£Á
 &&

3222 
now
 - 
node
->
pšg_£Á
 > 
£rv”
.
şu¡”_node_timeout
/2)

3225 
	`ä“Clu¡”Lšk
(
node
->
lšk
);

3232 ià(
node
->
lšk
 &&

3233 
node
->
pšg_£Á
 == 0 &&

3234 (
now
 - 
node
->
pÚg_»ûived
è> 
£rv”
.
şu¡”_node_timeout
/2)

3236 
	`şu¡”S’dPšg
(
node
->
lšk
, 
CLUSTERMSG_TYPE_PING
);

3242 ià(
£rv”
.
şu¡”
->
mf_’d
 &&

3243 
	`nodeIsMa¡”
(
my£lf
) &&

3244 
£rv”
.
şu¡”
->
mf_¦ave
 =ğ
node
 &&

3245 
node
->
lšk
)

3247 
	`şu¡”S’dPšg
(
node
->
lšk
, 
CLUSTERMSG_TYPE_PING
);

3252 ià(
node
->
pšg_£Á
 == 0) ;

3257 
d–ay
 = 
now
 - 
node
->
pšg_£Á
;

3259 ià(
d–ay
 > 
£rv”
.
şu¡”_node_timeout
) {

3262 ià(!(
node
->
æags
 & (
CLUSTER_NODE_PFAIL
|
CLUSTER_NODE_FAIL
))) {

3263 
	`£rv”Log
(
LL_DEBUG
,"*** NODE %.40s…ossibly failing",

3264 
node
->
Çme
);

3265 
node
->
æags
 |ğ
CLUSTER_NODE_PFAIL
;

3266 
upd©e_¡©e
 = 1;

3270 
	`diùR–—£I‹¿tÜ
(
di
);

3275 ià(
	`nodeIsSÏve
(
my£lf
) &&

3276 
£rv”
.
ma¡”ho¡
 =ğ
NULL
 &&

3277 
my£lf
->
¦aveof
 &&

3278 
	`nodeHasAddr
(
my£lf
->
¦aveof
))

3280 
	`»¶iÿtiÚS‘Ma¡”
(
my£lf
->
¦aveof
->

, my£lf->¦aveof->
pÜt
);

3284 
	`mªu®Faov”CheckTimeout
();

3286 ià(
	`nodeIsSÏve
(
my£lf
)) {

3287 
	`şu¡”HªdËMªu®Faov”
();

3288 
	`şu¡”HªdËSÏveFaov”
();

3294 ià(
Üphªed_ma¡”s
 && 
max_¦aves
 >ğ2 && 
this_¦aves
 == max_slaves)

3295 
	`şu¡”HªdËSÏveMig¿tiÚ
(
max_¦aves
);

3298 ià(
upd©e_¡©e
 || 
£rv”
.
şu¡”
->
¡©e
 =ğ
CLUSTER_FAIL
)

3299 
	`şu¡”Upd©eS‹
();

3300 
	}
}

3307 
	$şu¡”BefÜeSË•
() {

3310 ià(
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 & 
CLUSTER_TODO_HANDLE_FAILOVER
)

3311 
	`şu¡”HªdËSÏveFaov”
();

3314 ià(
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 & 
CLUSTER_TODO_UPDATE_STATE
)

3315 
	`şu¡”Upd©eS‹
();

3318 ià(
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 & 
CLUSTER_TODO_SAVE_CONFIG
) {

3319 
fsync
 = 
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 &

3320 
CLUSTER_TODO_FSYNC_CONFIG
;

3321 
	`şu¡”SaveCÚfigOrD›
(
fsync
);

3326 
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 = 0;

3327 
	}
}

3329 
	$şu¡”DoBefÜeSË•
(
æags
) {

3330 
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 |ğ
æags
;

3331 
	}
}

3339 
	$b™m­Te¡B™
(*
b™m­
, 
pos
) {

3340 
off_t
 
by‹
 = 
pos
/8;

3341 
b™
 = 
pos
&7;

3342  (
b™m­
[
by‹
] & (1<<
b™
)) != 0;

3343 
	}
}

3346 
	$b™m­S‘B™
(*
b™m­
, 
pos
) {

3347 
off_t
 
by‹
 = 
pos
/8;

3348 
b™
 = 
pos
&7;

3349 
b™m­
[
by‹
] |ğ1<<
b™
;

3350 
	}
}

3353 
	$b™m­CË¬B™
(*
b™m­
, 
pos
) {

3354 
off_t
 
by‹
 = 
pos
/8;

3355 
b™
 = 
pos
&7;

3356 
b™m­
[
by‹
] &ğ~(1<<
b™
);

3357 
	}
}

3362 
	$şu¡”Ma¡”sHaveSÏves
() {

3363 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

3364 
diùEÁry
 *
de
;

3365 
¦aves
 = 0;

3366 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3367 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

3369 ià(
	`nodeIsSÏve
(
node
)) ;

3370 
¦aves
 +ğ
node
->
num¦aves
;

3372 
	`diùR–—£I‹¿tÜ
(
di
);

3373  
¦aves
 != 0;

3374 
	}
}

3377 
	$şu¡”NodeS‘SlÙB™
(
şu¡”Node
 *
n
, 
¦Ù
) {

3378 
Şd
 = 
	`b™m­Te¡B™
(
n
->
¦Ùs
,
¦Ù
);

3379 
	`b™m­S‘B™
(
n
->
¦Ùs
,
¦Ù
);

3380 ià(!
Şd
) {

3381 
n
->
num¦Ùs
++;

3395 ià(
n
->
num¦Ùs
 =ğ1 && 
	`şu¡”Ma¡”sHaveSÏves
())

3396 
n
->
æags
 |ğ
CLUSTER_NODE_MIGRATE_TO
;

3398  
Şd
;

3399 
	}
}

3402 
	$şu¡”NodeCË¬SlÙB™
(
şu¡”Node
 *
n
, 
¦Ù
) {

3403 
Şd
 = 
	`b™m­Te¡B™
(
n
->
¦Ùs
,
¦Ù
);

3404 
	`b™m­CË¬B™
(
n
->
¦Ùs
,
¦Ù
);

3405 ià(
Şd
è
n
->
num¦Ùs
--;

3406  
Şd
;

3407 
	}
}

3410 
	$şu¡”NodeG‘SlÙB™
(
şu¡”Node
 *
n
, 
¦Ù
) {

3411  
	`b™m­Te¡B™
(
n
->
¦Ùs
,
¦Ù
);

3412 
	}
}

3418 
	$şu¡”AddSlÙ
(
şu¡”Node
 *
n
, 
¦Ù
) {

3419 ià(
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
]è 
C_ERR
;

3420 
	`şu¡”NodeS‘SlÙB™
(
n
,
¦Ù
);

3421 
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
] = 
n
;

3422  
C_OK
;

3423 
	}
}

3428 
	$şu¡”D–SlÙ
(
¦Ù
) {

3429 
şu¡”Node
 *
n
 = 
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
];

3431 ià(!
n
è 
C_ERR
;

3432 
	`£rv”As£¹
(
	`şu¡”NodeCË¬SlÙB™
(
n
,
¦Ù
) == 1);

3433 
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
] = 
NULL
;

3434  
C_OK
;

3435 
	}
}

3439 
	$şu¡”D–NodeSlÙs
(
şu¡”Node
 *
node
) {

3440 
d–‘ed
 = 0, 
j
;

3442 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3443 ià(
	`şu¡”NodeG‘SlÙB™
(
node
,
j
)è
	`şu¡”D–SlÙ
(j);

3444 
d–‘ed
++;

3446  
d–‘ed
;

3447 
	}
}

3451 
	$şu¡”Clo£AÎSlÙs
() {

3452 
	`mem£t
(
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
,0,

3453 (
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
));

3454 
	`mem£t
(
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
,0,

3455 (
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
));

3456 
	}
}

3466 
	#CLUSTER_MAX_REJOIN_DELAY
 5000

	)

3467 
	#CLUSTER_MIN_REJOIN_DELAY
 500

	)

3468 
	#CLUSTER_WRITABLE_DELAY
 2000

	)

3470 
	$şu¡”Upd©eS‹
() {

3471 
j
, 
Ãw_¡©e
;

3472 
»achabË_ma¡”s
 = 0;

3473 
m¡ime_t
 
amÚg_mšÜ™y_time
;

3474 
m¡ime_t
 
fœ¡_ÿÎ_time
 = 0;

3476 
£rv”
.
şu¡”
->
todo_befÜe_¦“p
 &ğ~
CLUSTER_TODO_UPDATE_STATE
;

3484 ià(
fœ¡_ÿÎ_time
 =ğ0èfœ¡_ÿÎ_timğ
	`m¡ime
();

3485 ià(
	`nodeIsMa¡”
(
my£lf
) &&

3486 
£rv”
.
şu¡”
->
¡©e
 =ğ
CLUSTER_FAIL
 &&

3487 
	`m¡ime
(è- 
fœ¡_ÿÎ_time
 < 
CLUSTER_WRITABLE_DELAY
) ;

3491 
Ãw_¡©e
 = 
CLUSTER_OK
;

3494 ià(
£rv”
.
şu¡”_»quœe_fuÎ_cov”age
) {

3495 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3496 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
NULL
 ||

3497 
£rv”
.
şu¡”
->
¦Ùs
[
j
]->
æags
 & (
CLUSTER_NODE_FAIL
))

3499 
Ãw_¡©e
 = 
CLUSTER_FAIL
;

3511 
diùI‹¿tÜ
 *
di
;

3512 
diùEÁry
 *
de
;

3514 
£rv”
.
şu¡”
->
size
 = 0;

3515 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

3516 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3517 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

3519 ià(
	`nodeIsMa¡”
(
node
è&&‚ode->
num¦Ùs
) {

3520 
£rv”
.
şu¡”
->
size
++;

3521 ià((
node
->
æags
 & (
CLUSTER_NODE_FAIL
|
CLUSTER_NODE_PFAIL
)) == 0)

3522 
»achabË_ma¡”s
++;

3525 
	`diùR–—£I‹¿tÜ
(
di
);

3531 
Ãeded_quÜum
 = (
£rv”
.
şu¡”
->
size
 / 2) + 1;

3533 ià(
»achabË_ma¡”s
 < 
Ãeded_quÜum
) {

3534 
Ãw_¡©e
 = 
CLUSTER_FAIL
;

3535 
amÚg_mšÜ™y_time
 = 
	`m¡ime
();

3540 ià(
Ãw_¡©e
 !ğ
£rv”
.
şu¡”
->
¡©e
) {

3541 
m¡ime_t
 
»još_d–ay
 = 
£rv”
.
şu¡”_node_timeout
;

3547 ià(
»još_d–ay
 > 
CLUSTER_MAX_REJOIN_DELAY
)

3548 
»još_d–ay
 = 
CLUSTER_MAX_REJOIN_DELAY
;

3549 ià(
»još_d–ay
 < 
CLUSTER_MIN_REJOIN_DELAY
)

3550 
»još_d–ay
 = 
CLUSTER_MIN_REJOIN_DELAY
;

3552 ià(
Ãw_¡©e
 =ğ
CLUSTER_OK
 &&

3553 
	`nodeIsMa¡”
(
my£lf
) &&

3554 
	`m¡ime
(è- 
amÚg_mšÜ™y_time
 < 
»još_d–ay
)

3560 
	`£rv”Log
(
LL_WARNING
,"Cluster state changed: %s",

3561 
Ãw_¡©e
 =ğ
CLUSTER_OK
 ? "ok" : "fail");

3562 
£rv”
.
şu¡”
->
¡©e
 = 
Ãw_¡©e
;

3564 
	}
}

3588 
	$v”ifyClu¡”CÚfigW™hD©a
() {

3589 
j
;

3590 
upd©e_cÚfig
 = 0;

3594 ià(
	`nodeIsSÏve
(
my£lf
)è 
C_OK
;

3597 
j
 = 1; j < 
£rv”
.
dbnum
; j++) {

3598 ià(
	`diùSize
(
£rv”
.
db
[
j
].
diù
)è 
C_ERR
;

3603 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3604 ià(!
	`couÁKeysInSlÙ
(
j
)) ;

3608 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
my£lf
 ||

3609 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
j
] !ğ
NULL
) ;

3615 
upd©e_cÚfig
++;

3617 ià(
£rv”
.
şu¡”
->
¦Ùs
[
j
] =ğ
NULL
) {

3618 
	`£rv”Log
(
LL_WARNING
, "I have keys for unassigned slot %d. "

3619 "Takšg„e¥Úsib™y fÜ it.",
j
);

3620 
	`şu¡”AddSlÙ
(
my£lf
,
j
);

3622 
	`£rv”Log
(
LL_WARNING
, "I have keys for slot %d, buthe slot is "

3624 "S‘tšg iˆtØimpÜtšg s‹.",
j
);

3625 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
j
] = s”v”.şu¡”->
¦Ùs
[j];

3628 ià(
upd©e_cÚfig
è
	`şu¡”SaveCÚfigOrD›
(1);

3629  
C_OK
;

3630 
	}
}

3638 
	$şu¡”S‘Ma¡”
(
şu¡”Node
 *
n
) {

3639 
	`£rv”As£¹
(
n
 !ğ
my£lf
);

3640 
	`£rv”As£¹
(
my£lf
->
num¦Ùs
 == 0);

3642 ià(
	`nodeIsMa¡”
(
my£lf
)) {

3643 
my£lf
->
æags
 &ğ~(
CLUSTER_NODE_MASTER
|
CLUSTER_NODE_MIGRATE_TO
);

3644 
my£lf
->
æags
 |ğ
CLUSTER_NODE_SLAVE
;

3645 
	`şu¡”Clo£AÎSlÙs
();

3647 ià(
my£lf
->
¦aveof
)

3648 
	`şu¡”NodeRemoveSÏve
(
my£lf
->
¦aveof
,myself);

3650 
my£lf
->
¦aveof
 = 
n
;

3651 
	`şu¡”NodeAddSÏve
(
n
,
my£lf
);

3652 
	`»¶iÿtiÚS‘Ma¡”
(
n
->

,‚->
pÜt
);

3653 
	`»£tMªu®Faov”
();

3654 
	}
}

3660 
	s»disNodeFÏgs
 {

3661 
ušt16_t
 
	mæag
;

3662 *
	mÇme
;

3665 
»disNodeFÏgs
 
	g»disNodeFÏgsTabË
[] = {

3666 {
CLUSTER_NODE_MYSELF
, "myself,"},

3667 {
CLUSTER_NODE_MASTER
, "master,"},

3668 {
CLUSTER_NODE_SLAVE
, "slave,"},

3669 {
CLUSTER_NODE_PFAIL
, "fail?,"},

3670 {
CLUSTER_NODE_FAIL
, "fail,"},

3671 {
CLUSTER_NODE_HANDSHAKE
, "handshake,"},

3672 {
CLUSTER_NODE_NOADDR
, "noaddr,"}

3677 
sds
 
	$»´e£ÁClu¡”NodeFÏgs
(
sds
 
ci
, 
ušt16_t
 
æags
) {

3678 ià(
æags
 == 0) {

3679 
ci
 = 
	`sdsÿt
(ci,"noflags,");

3681 
i
, 
size
 = (
»disNodeFÏgsTabË
)/(
»disNodeFÏgs
);

3682 
i
 = 0; i < 
size
; i++) {

3683 
»disNodeFÏgs
 *
nodeæag
 = 
»disNodeFÏgsTabË
 + 
i
;

3684 ià(
æags
 & 
nodeæag
->
æag
è
ci
 = 
	`sdsÿt
(ci,‚odeæag->
Çme
);

3687 
	`sdsInüL’
(
ci
,-1);

3688  
ci
;

3689 
	}
}

3695 
sds
 
	$şu¡”G’NodeDesütiÚ
(
şu¡”Node
 *
node
) {

3696 
j
, 
¡¬t
;

3697 
sds
 
ci
;

3700 
ci
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"%.40s %s:%d ",

3701 
node
->
Çme
,

3702 
node
->

,

3703 
node
->
pÜt
);

3706 
ci
 = 
	`»´e£ÁClu¡”NodeFÏgs
(ci, 
node
->
æags
);

3709 ià(
node
->
¦aveof
)

3710 
ci
 = 
	`sdsÿrštf
(ci," %.40 ",
node
->
¦aveof
->
Çme
);

3712 
ci
 = 
	`sdsÿ’
(ci," - ",3);

3715 
ci
 = 
	`sdsÿrštf
(ci,"%lld %lld %llu %s",

3716 (è
node
->
pšg_£Á
,

3717 (è
node
->
pÚg_»ûived
,

3718 (è
node
->
cÚfigEpoch
,

3719 (
node
->
lšk
 ||‚ode->
æags
 & 
CLUSTER_NODE_MYSELF
) ?

3723 
¡¬t
 = -1;

3724 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3725 
b™
;

3727 ià((
b™
 = 
	`şu¡”NodeG‘SlÙB™
(
node
,
j
)) != 0) {

3728 ià(
¡¬t
 =ğ-1è¡¬ˆğ
j
;

3730 ià(
¡¬t
 !ğ-1 && (!
b™
 || 
j
 =ğ
CLUSTER_SLOTS
-1)) {

3731 ià(
b™
 && 
j
 =ğ
CLUSTER_SLOTS
-1) j++;

3733 ià(
¡¬t
 =ğ
j
-1) {

3734 
ci
 = 
	`sdsÿrštf
(ci," %d",
¡¬t
);

3736 
ci
 = 
	`sdsÿrštf
(ci," %d-%d",
¡¬t
,
j
-1);

3738 
¡¬t
 = -1;

3745 ià(
node
->
æags
 & 
CLUSTER_NODE_MYSELF
) {

3746 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3747 ià(
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
j
]) {

3748 
ci
 = 
	`sdsÿrštf
(ci," [%d->-%.40s]",
j
,

3749 
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
j
]->
Çme
);

3750 } ià(
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
j
]) {

3751 
ci
 = 
	`sdsÿrštf
(ci," [%d-<-%.40s]",
j
,

3752 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
j
]->
Çme
);

3756  
ci
;

3757 
	}
}

3771 
sds
 
	$şu¡”G’NodesDesütiÚ
(
f‹r
) {

3772 
sds
 
ci
 = 
	`sd£m±y
(), 
ni
;

3773 
diùI‹¿tÜ
 *
di
;

3774 
diùEÁry
 *
de
;

3776 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

3777 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3778 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

3780 ià(
node
->
æags
 & 
f‹r
) ;

3781 
ni
 = 
	`şu¡”G’NodeDesütiÚ
(
node
);

3782 
ci
 = 
	`sdsÿtsds
(ci,
ni
);

3783 
	`sdsä“
(
ni
);

3784 
ci
 = 
	`sdsÿ’
(ci,"\n",1);

3786 
	`diùR–—£I‹¿tÜ
(
di
);

3787  
ci
;

3788 
	}
}

3794 
	$g‘SlÙOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
) {

3795 
¦Ù
;

3797 ià(
	`g‘LÚgLÚgFromObjeù
(
o
,&
¦Ù
è!ğ
C_OK
 ||

3798 
¦Ù
 < 0 || slÙ >ğ
CLUSTER_SLOTS
)

3800 
	`addR•lyE¼Ü
(
c
,"Invalid or out of„ange slot");

3803  (è
¦Ù
;

3804 
	}
}

3806 
	$şu¡”R•lyMuÉiBulkSlÙs
(
ş›Á
 *
c
) {

3818 
num_ma¡”s
 = 0;

3819 *
¦Ù_»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

3821 
diùEÁry
 *
de
;

3822 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
şu¡”
->
nodes
);

3823 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3824 
şu¡”Node
 *
node
 = 
	`diùG‘V®
(
de
);

3825 
j
 = 0, 
¡¬t
 = -1;

3829 ià(!
	`nodeIsMa¡”
(
node
è||‚ode->
num¦Ùs
 == 0) ;

3831 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3832 
b™
, 
i
;

3834 ià((
b™
 = 
	`şu¡”NodeG‘SlÙB™
(
node
,
j
)) != 0) {

3835 ià(
¡¬t
 =ğ-1è¡¬ˆğ
j
;

3837 ià(
¡¬t
 !ğ-1 && (!
b™
 || 
j
 =ğ
CLUSTER_SLOTS
-1)) {

3838 
Ã¡ed_–em’ts
 = 3;

3839 *
Ã¡ed_»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

3841 ià(
b™
 && 
j
 =ğ
CLUSTER_SLOTS
-1) j++;

3845 ià(
¡¬t
 =ğ
j
-1) {

3846 
	`addR•lyLÚgLÚg
(
c
, 
¡¬t
);

3847 
	`addR•lyLÚgLÚg
(
c
, 
¡¬t
);

3849 
	`addR•lyLÚgLÚg
(
c
, 
¡¬t
);

3850 
	`addR•lyLÚgLÚg
(
c
, 
j
-1);

3852 
¡¬t
 = -1;

3855 
	`addR•lyMuÉiBulkL’
(
c
, 3);

3856 
	`addR•lyBulkCSŒšg
(
c
, 
node
->

);

3857 
	`addR•lyLÚgLÚg
(
c
, 
node
->
pÜt
);

3858 
	`addR•lyBulkCBufãr
(
c
, 
node
->
Çme
, 
CLUSTER_NAMELEN
);

3861 
i
 = 0; i < 
node
->
num¦aves
; i++) {

3864 ià(
	`nodeFaed
(
node
->
¦aves
[
i
])) ;

3865 
	`addR•lyMuÉiBulkL’
(
c
, 3);

3866 
	`addR•lyBulkCSŒšg
(
c
, 
node
->
¦aves
[
i
]->

);

3867 
	`addR•lyLÚgLÚg
(
c
, 
node
->
¦aves
[
i
]->
pÜt
);

3868 
	`addR•lyBulkCBufãr
(
c
, 
node
->
¦aves
[
i
]->
Çme
, 
CLUSTER_NAMELEN
);

3869 
Ã¡ed_–em’ts
++;

3871 
	`£tDeã¼edMuÉiBulkL’gth
(
c
, 
Ã¡ed_»¶yËn
, 
Ã¡ed_–em’ts
);

3872 
num_ma¡”s
++;

3876 
	`diùR–—£I‹¿tÜ
(
di
);

3877 
	`£tDeã¼edMuÉiBulkL’gth
(
c
, 
¦Ù_»¶yËn
, 
num_ma¡”s
);

3878 
	}
}

3880 
	$şu¡”Commªd
(
ş›Á
 *
c
) {

3881 ià(
£rv”
.
şu¡”_’abËd
 == 0) {

3882 
	`addR•lyE¼Ü
(
c
,"This instance has cluster support disabled");

3886 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"m“t"è&& c->
¬gc
 == 4) {

3887 
pÜt
;

3889 ià(
	`g‘LÚgLÚgFromObjeù
(
c
->
¬gv
[3], &
pÜt
è!ğ
C_OK
) {

3890 
	`addR•lyE¼ÜFÜm©
(
c
,"Invalid TCP…ort specified: %s",

3891 (*)
c
->
¬gv
[3]->
±r
);

3895 ià(
	`şu¡”S¹Hªdshake
(
c
->
¬gv
[2]->
±r
,
pÜt
) == 0 &&

3896 
”ºo
 =ğ
EINVAL
)

3898 
	`addR•lyE¼ÜFÜm©
(
c
,"Invalid‚ode‡ddress specified: %s:%s",

3899 (*)
c
->
¬gv
[2]->
±r
, (*)c->argv[3]->ptr);

3901 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3903 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"nodes"è&& c->
¬gc
 == 2) {

3905 
robj
 *
o
;

3906 
sds
 
ci
 = 
	`şu¡”G’NodesDesütiÚ
(0);

3908 
o
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
ci
);

3909 
	`addR•lyBulk
(
c
,
o
);

3910 
	`deüRefCouÁ
(
o
);

3911 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"myid"è&& c->
¬gc
 == 2) {

3913 
	`addR•lyBulkCBufãr
(
c
,
my£lf
->
Çme
, 
CLUSTER_NAMELEN
);

3914 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"¦Ùs"è&& c->
¬gc
 == 2) {

3916 
	`şu¡”R•lyMuÉiBulkSlÙs
(
c
);

3917 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"æush¦Ùs"è&& c->
¬gc
 == 2) {

3919 ià(
	`diùSize
(
£rv”
.
db
[0].
diù
) != 0) {

3920 
	`addR•lyE¼Ü
(
c
,"DB must beƒmptyo…erform CLUSTER FLUSHSLOTS.");

3923 
	`şu¡”D–NodeSlÙs
(
my£lf
);

3924 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

3925 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3926 } ià((!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"addslots") ||

3927 !
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"d–¦Ùs")è&& c->
¬gc
 >= 3)

3931 
j
, 
¦Ù
;

3932 *
¦Ùs
 = 
	`zm®loc
(
CLUSTER_SLOTS
);

3933 
d–
 = !
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"delslots");

3935 
	`mem£t
(
¦Ùs
,0,
CLUSTER_SLOTS
);

3938 
j
 = 2; j < 
c
->
¬gc
; j++) {

3939 ià((
¦Ù
 = 
	`g‘SlÙOrR•ly
(
c
,c->
¬gv
[
j
])) == -1) {

3940 
	`zä“
(
¦Ùs
);

3943 ià(
d–
 && 
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
] =ğ
NULL
) {

3944 
	`addR•lyE¼ÜFÜm©
(
c
,"SlÙ %d i ®»ady uÇssigÃd", 
¦Ù
);

3945 
	`zä“
(
¦Ùs
);

3947 } ià(!
d–
 && 
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
]) {

3948 
	`addR•lyE¼ÜFÜm©
(
c
,"SlÙ %d i ®»ady busy", 
¦Ù
);

3949 
	`zä“
(
¦Ùs
);

3952 ià(
¦Ùs
[
¦Ù
]++ == 1) {

3953 
	`addR•lyE¼ÜFÜm©
(
c
,"Slot %d specified multipleimes",

3954 ()
¦Ù
);

3955 
	`zä“
(
¦Ùs
);

3959 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

3960 ià(
¦Ùs
[
j
]) {

3961 
»tv®
;

3965 ià(
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
j
])

3966 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
j
] = 
NULL
;

3968 
»tv®
 = 
d–
 ? 
	`şu¡”D–SlÙ
(
j
) :

3969 
	`şu¡”AddSlÙ
(
my£lf
,
j
);

3970 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
»tv®
 =ğ
C_OK
);

3973 
	`zä“
(
¦Ùs
);

3974 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

3975 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3976 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"£t¦Ù"è&& c->
¬gc
 >= 4) {

3981 
¦Ù
;

3982 
şu¡”Node
 *
n
;

3984 ià(
	`nodeIsSÏve
(
my£lf
)) {

3985 
	`addR•lyE¼Ü
(
c
,"Please use SETSLOT only with masters.");

3989 ià((
¦Ù
 = 
	`g‘SlÙOrR•ly
(
c
,c->
¬gv
[2])) == -1) ;

3991 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[3]->
±r
,"mig¿tšg"è&& c->
¬gc
 == 5) {

3992 ià(
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
] !ğ
my£lf
) {

3993 
	`addR•lyE¼ÜFÜm©
(
c
,"I'm‚ÙhowÃ¸oàhash slÙ %u",
¦Ù
);

3996 ià((
n
 = 
	`şu¡”LookupNode
(
c
->
¬gv
[4]->
±r
)è=ğ
NULL
) {

3997 
	`addR•lyE¼ÜFÜm©
(
c
,"I don't know‡bout‚ode %s",

3998 (*)
c
->
¬gv
[4]->
±r
);

4001 
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
¦Ù
] = 
n
;

4002 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[3]->
±r
,"impÜtšg"è&& c->
¬gc
 == 5) {

4003 ià(
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
] =ğ
my£lf
) {

4004 
	`addR•lyE¼ÜFÜm©
(
c
,

4005 "I'm‡Ì—dyhowÃ¸oàhash slÙ %u",
¦Ù
);

4008 ià((
n
 = 
	`şu¡”LookupNode
(
c
->
¬gv
[4]->
±r
)è=ğ
NULL
) {

4009 
	`addR•lyE¼ÜFÜm©
(
c
,"I don't know‡bout‚ode %s",

4010 (*)
c
->
¬gv
[3]->
±r
);

4013 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
¦Ù
] = 
n
;

4014 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[3]->
±r
,"¡abË"è&& c->
¬gc
 == 4) {

4016 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
¦Ù
] = 
NULL
;

4017 
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
¦Ù
] = 
NULL
;

4018 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[3]->
±r
,"node"è&& c->
¬gc
 == 5) {

4020 
şu¡”Node
 *
n
 = 
	`şu¡”LookupNode
(
c
->
¬gv
[4]->
±r
);

4022 ià(!
n
) {

4023 
	`addR•lyE¼ÜFÜm©
(
c
,"Unknown‚ode %s",

4024 (*)
c
->
¬gv
[4]->
±r
);

4029 ià(
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
] =ğ
my£lf
 && 
n
 != myself) {

4030 ià(
	`couÁKeysInSlÙ
(
¦Ù
) != 0) {

4031 
	`addR•lyE¼ÜFÜm©
(
c
,

4033 "whI stÈhŞd key fÜhi hash slÙ.", 
¦Ù
);

4040 ià(
	`couÁKeysInSlÙ
(
¦Ù
) == 0 &&

4041 
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
¦Ù
])

4042 
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
¦Ù
] = 
NULL
;

4046 ià(
n
 =ğ
my£lf
 &&

4047 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
¦Ù
])

4058 ià(
	`şu¡”BumpCÚfigEpochW™houtCÚ£nsus
(è=ğ
C_OK
) {

4059 
	`£rv”Log
(
LL_WARNING
,

4060 "cÚfigEpoch upd©ed‡á” impÜtšg slÙ %d", 
¦Ù
);

4062 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
¦Ù
] = 
NULL
;

4064 
	`şu¡”D–SlÙ
(
¦Ù
);

4065 
	`şu¡”AddSlÙ
(
n
,
¦Ù
);

4067 
	`addR•lyE¼Ü
(
c
,

4071 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_SAVE_CONFIG
|
CLUSTER_TODO_UPDATE_STATE
);

4072 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4073 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"bum³poch"è&& c->
¬gc
 == 2) {

4075 
»tv®
 = 
	`şu¡”BumpCÚfigEpochW™houtCÚ£nsus
();

4076 
sds
 
»¶y
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"+%s %llu\r\n",

4077 (
»tv®
 =ğ
C_OK
) ? "BUMPED" : "STILL",

4078 (è
my£lf
->
cÚfigEpoch
);

4079 
	`addR•lySds
(
c
,
»¶y
);

4080 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"šfo"è&& c->
¬gc
 == 2) {

4082 *
¡©e¡r
[] = {"ok","fail","needhelp"};

4083 
¦Ùs_assigÃd
 = 0, 
¦Ùs_ok
 = 0, 
¦Ùs_pç
 = 0, 
¦Ùs_ç
 = 0;

4084 
ušt64_t
 
my•och
;

4085 
j
;

4087 
j
 = 0; j < 
CLUSTER_SLOTS
; j++) {

4088 
şu¡”Node
 *
n
 = 
£rv”
.
şu¡”
->
¦Ùs
[
j
];

4090 ià(
n
 =ğ
NULL
) ;

4091 
¦Ùs_assigÃd
++;

4092 ià(
	`nodeFaed
(
n
)) {

4093 
¦Ùs_ç
++;

4094 } ià(
	`nodeTimedOut
(
n
)) {

4095 
¦Ùs_pç
++;

4097 
¦Ùs_ok
++;

4101 
my•och
 = (
	`nodeIsSÏve
(
my£lf
è&& my£lf->
¦aveof
) ?

4102 
my£lf
->
¦aveof
->
cÚfigEpoch
 : myself->configEpoch;

4104 
sds
 
šfo
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

4116 , 
¡©e¡r
[
£rv”
.
şu¡”
->
¡©e
],

4117 
¦Ùs_assigÃd
,

4118 
¦Ùs_ok
,

4119 
¦Ùs_pç
,

4120 
¦Ùs_ç
,

4121 
	`diùSize
(
£rv”
.
şu¡”
->
nodes
),

4122 
£rv”
.
şu¡”
->
size
,

4123 (è
£rv”
.
şu¡”
->
cu¼’tEpoch
,

4124 (è
my•och
,

4125 
£rv”
.
şu¡”
->
¡©s_bus_mes§ges_£Á
,

4126 
£rv”
.
şu¡”
->
¡©s_bus_mes§ges_»ûived


4128 
	`addR•lySds
(
c
,
	`sdsÿrštf
(
	`sd£m±y
(),"$%lu\r\n",

4129 ()
	`sd¦’
(
šfo
)));

4130 
	`addR•lySds
(
c
,
šfo
);

4131 
	`addR•ly
(
c
,
sh¬ed
.
ülf
);

4132 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"§vecÚfig"è&& c->
¬gc
 == 2) {

4133 
»tv®
 = 
	`şu¡”SaveCÚfig
(1);

4135 ià(
»tv®
 == 0)

4136 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4138 
	`addR•lyE¼ÜFÜm©
(
c
,"error savinghe cluster‚ode config: %s",

4139 
	`¡»¼Ü
(
”ºo
));

4140 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"key¦Ù"è&& c->
¬gc
 == 3) {

4142 
sds
 
key
 = 
c
->
¬gv
[2]->
±r
;

4144 
	`addR•lyLÚgLÚg
(
c
,
	`keyHashSlÙ
(
key
,
	`sd¦’
(key)));

4145 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"couÁkeysš¦Ù"è&& c->
¬gc
 == 3) {

4147 
¦Ù
;

4149 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
¦Ù
,
NULL
è!ğ
C_OK
)

4151 ià(
¦Ù
 < 0 || slÙ >ğ
CLUSTER_SLOTS
) {

4152 
	`addR•lyE¼Ü
(
c
,"Invalid slot");

4155 
	`addR•lyLÚgLÚg
(
c
,
	`couÁKeysInSlÙ
(
¦Ù
));

4156 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"g‘keysš¦Ù"è&& c->
¬gc
 == 4) {

4158 
maxkeys
, 
¦Ù
;

4159 
numkeys
, 
j
;

4160 
robj
 **
keys
;

4162 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
¦Ù
,
NULL
è!ğ
C_OK
)

4164 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
maxkeys
,
NULL
)

4165 !ğ
C_OK
)

4167 ià(
¦Ù
 < 0 || slÙ >ğ
CLUSTER_SLOTS
 || 
maxkeys
 < 0) {

4168 
	`addR•lyE¼Ü
(
c
,"Invalid slot or‚umber of keys");

4172 
keys
 = 
	`zm®loc
((
robj
*)*
maxkeys
);

4173 
numkeys
 = 
	`g‘KeysInSlÙ
(
¦Ù
, 
keys
, 
maxkeys
);

4174 
	`addR•lyMuÉiBulkL’
(
c
,
numkeys
);

4175 
j
 = 0; j < 
numkeys
; j++è
	`addR•lyBulk
(
c
,
keys
[j]);

4176 
	`zä“
(
keys
);

4177 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"fÜg‘"è&& c->
¬gc
 == 3) {

4179 
şu¡”Node
 *
n
 = 
	`şu¡”LookupNode
(
c
->
¬gv
[2]->
±r
);

4181 ià(!
n
) {

4182 
	`addR•lyE¼ÜFÜm©
(
c
,"UnknowÀnod%s", (*)c->
¬gv
[2]->
±r
);

4184 } ià(
n
 =ğ
my£lf
) {

4185 
	`addR•lyE¼Ü
(
c
,"Iried hard but I can't forget myself...");

4187 } ià(
	`nodeIsSÏve
(
my£lf
è&& my£lf->
¦aveof
 =ğ
n
) {

4188 
	`addR•lyE¼Ü
(
c
,"Can't forget my master!");

4191 
	`şu¡”BÏckli¡AddNode
(
n
);

4192 
	`şu¡”D–Node
(
n
);

4193 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_UPDATE_STATE
|

4194 
CLUSTER_TODO_SAVE_CONFIG
);

4195 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4196 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"»¶iÿ‹"è&& c->
¬gc
 == 3) {

4198 
şu¡”Node
 *
n
 = 
	`şu¡”LookupNode
(
c
->
¬gv
[2]->
±r
);

4201 ià(!
n
) {

4202 
	`addR•lyE¼ÜFÜm©
(
c
,"UnknowÀnod%s", (*)c->
¬gv
[2]->
±r
);

4207 ià(
n
 =ğ
my£lf
) {

4208 
	`addR•lyE¼Ü
(
c
,"Can't„eplicate myself");

4213 ià(
	`nodeIsSÏve
(
n
)) {

4214 
	`addR•lyE¼Ü
(
c
,"I can only„eplicate‡ master,‚ot‡ slave.");

4221 ià(
	`nodeIsMa¡”
(
my£lf
) &&

4222 (
my£lf
->
num¦Ùs
 !ğ0 || 
	`diùSize
(
£rv”
.
db
[0].
diù
) != 0)) {

4223 
	`addR•lyE¼Ü
(
c
,

4230 
	`şu¡”S‘Ma¡”
(
n
);

4231 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_UPDATE_STATE
|
CLUSTER_TODO_SAVE_CONFIG
);

4232 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4233 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"¦aves"è&& c->
¬gc
 == 3) {

4235 
şu¡”Node
 *
n
 = 
	`şu¡”LookupNode
(
c
->
¬gv
[2]->
±r
);

4236 
j
;

4239 ià(!
n
) {

4240 
	`addR•lyE¼ÜFÜm©
(
c
,"UnknowÀnod%s", (*)c->
¬gv
[2]->
±r
);

4244 ià(
	`nodeIsSÏve
(
n
)) {

4245 
	`addR•lyE¼Ü
(
c
,"The specified‚ode is‚ot‡ master");

4249 
	`addR•lyMuÉiBulkL’
(
c
,
n
->
num¦aves
);

4250 
j
 = 0; j < 
n
->
num¦aves
; j++) {

4251 
sds
 
ni
 = 
	`şu¡”G’NodeDesütiÚ
(
n
->
¦aves
[
j
]);

4252 
	`addR•lyBulkCSŒšg
(
c
,
ni
);

4253 
	`sdsä“
(
ni
);

4255 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"count-failure-reports") &&

4256 
c
->
¬gc
 == 3)

4259 
şu¡”Node
 *
n
 = 
	`şu¡”LookupNode
(
c
->
¬gv
[2]->
±r
);

4261 ià(!
n
) {

4262 
	`addR•lyE¼ÜFÜm©
(
c
,"UnknowÀnod%s", (*)c->
¬gv
[2]->
±r
);

4265 
	`addR•lyLÚgLÚg
(
c
,
	`şu¡”NodeFau»R•ÜtsCouÁ
(
n
));

4267 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"failover") &&

4268 (
c
->
¬gc
 == 2 || c->argc == 3))

4271 
fÜû
 = 0, 
keov”
 = 0;

4273 ià(
c
->
¬gc
 == 3) {

4274 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"force")) {

4275 
fÜû
 = 1;

4276 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"takeover")) {

4277 
keov”
 = 1;

4278 
fÜû
 = 1;

4280 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

4286 ià(
	`nodeIsMa¡”
(
my£lf
)) {

4287 
	`addR•lyE¼Ü
(
c
,"You should send CLUSTER FAILOVERo‡ slave");

4289 } ià(
my£lf
->
¦aveof
 =ğ
NULL
) {

4290 
	`addR•lyE¼Ü
(
c
,"I'm‡ slave but my master is unknowno me");

4292 } ià(!
fÜû
 &&

4293 (
	`nodeFaed
(
my£lf
->
¦aveof
) ||

4294 
my£lf
->
¦aveof
->
lšk
 =ğ
NULL
))

4296 
	`addR•lyE¼Ü
(
c
,"Master is down or failed, "

4300 
	`»£tMªu®Faov”
();

4301 
£rv”
.
şu¡”
->
mf_’d
 = 
	`m¡ime
(è+ 
CLUSTER_MF_TIMEOUT
;

4303 ià(
keov”
) {

4308 
	`£rv”Log
(
LL_WARNING
,"Taking overhe master (user„equest).");

4309 
	`şu¡”BumpCÚfigEpochW™houtCÚ£nsus
();

4310 
	`şu¡”Faov”R•ÏûYourMa¡”
();

4311 } ià(
fÜû
) {

4315 
	`£rv”Log
(
LL_WARNING
,"Forced failover user„equest‡ccepted.");

4316 
£rv”
.
şu¡”
->
mf_ÿn_¡¬t
 = 1;

4318 
	`£rv”Log
(
LL_WARNING
,"Manual failover user„equest‡ccepted.");

4319 
	`şu¡”S’dMFS¹
(
my£lf
->
¦aveof
);

4321 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4322 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"£t-cÚfig-•och"è&& c->
¬gc
 == 3)

4331 
•och
;

4333 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
•och
,
NULL
è!ğ
C_OK
)

4336 ià(
•och
 < 0) {

4337 
	`addR•lyE¼ÜFÜm©
(
c
,"Inv®id cÚfigƒpoch s³cif›d: %Îd",
•och
);

4338 } ià(
	`diùSize
(
£rv”
.
şu¡”
->
nodes
) > 1) {

4339 
	`addR•lyE¼Ü
(
c
,"The user can‡ssign‡ configƒpoch only whenhe "

4341 } ià(
my£lf
->
cÚfigEpoch
 != 0) {

4342 
	`addR•lyE¼Ü
(
c
,"Node configƒpoch is‡lready‚on-zero");

4344 
my£lf
->
cÚfigEpoch
 = 
•och
;

4345 
	`£rv”Log
(
LL_WARNING
,

4347 (è
my£lf
->
cÚfigEpoch
);

4349 ià(
£rv”
.
şu¡”
->
cu¼’tEpoch
 < (
ušt64_t
)
•och
)

4350 
£rv”
.
şu¡”
->
cu¼’tEpoch
 = 
•och
;

4354 
	`şu¡”DoBefÜeSË•
(
CLUSTER_TODO_UPDATE_STATE
|

4355 
CLUSTER_TODO_SAVE_CONFIG
);

4356 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4358 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"reset") &&

4359 (
c
->
¬gc
 == 2 || c->argc == 3))

4362 
h¬d
 = 0;

4365 ià(
c
->
¬gc
 == 3) {

4366 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"hard")) {

4367 
h¬d
 = 1;

4368 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"soft")) {

4369 
h¬d
 = 0;

4371 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

4378 ià(
	`nodeIsMa¡”
(
my£lf
è&& 
	`diùSize
(
c
->
db
->
diù
) != 0) {

4379 
	`addR•lyE¼Ü
(
c
,"CLUSTER RESET can't be called with "

4383 
	`şu¡”Re£t
(
h¬d
);

4384 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4386 
	`addR•lyE¼Ü
(
c
,"Wrong CLUSTER subcommand or‚umber of‡rguments");

4388 
	}
}

4396 
	$ü—‹DumpPaylßd
(
rio
 *
·ylßd
, 
robj
 *
o
) {

4397 
buf
[2];

4398 
ušt64_t
 
üc
;

4402 
	`rioIn™W™hBufãr
(
·ylßd
,
	`sd£m±y
());

4403 
	`£rv”As£¹
(
	`rdbSaveObjeùTy³
(
·ylßd
,
o
));

4404 
	`£rv”As£¹
(
	`rdbSaveObjeù
(
·ylßd
,
o
));

4414 
buf
[0] = 
RDB_VERSION
 & 0xff;

4415 
buf
[1] = (
RDB_VERSION
 >> 8) & 0xff;

4416 
·ylßd
->
io
.
bufãr
.
±r
 = 
	`sdsÿ’
Õaylßd->io.bufãr.±r,
buf
,2);

4419 
üc
 = 
	`üc64
(0,(*)
·ylßd
->
io
.
bufãr
.
±r
,

4420 
	`sd¦’
(
·ylßd
->
io
.
bufãr
.
±r
));

4421 
	`mem»v64ifbe
(&
üc
);

4422 
·ylßd
->
io
.
bufãr
.
±r
 = 
	`sdsÿ’
Õaylßd->io.bufãr.±r,&
üc
,8);

4423 
	}
}

4429 
	$v”ifyDumpPaylßd
(*
p
, 
size_t
 
Ën
) {

4430 *
foÙ”
;

4431 
ušt16_t
 
rdbv”
;

4432 
ušt64_t
 
üc
;

4435 ià(
Ën
 < 10è 
C_ERR
;

4436 
foÙ”
 = 
p
+(
Ën
-10);

4439 
rdbv”
 = (
foÙ”
[1] << 8) | footer[0];

4440 ià(
rdbv”
 > 
RDB_VERSION
è 
C_ERR
;

4443 
üc
 = 
	`üc64
(0,
p
,
Ën
-8);

4444 
	`mem»v64ifbe
(&
üc
);

4445  (
	`memcmp
(&
üc
,
foÙ”
+2,8è=ğ0è? 
C_OK
 : 
C_ERR
;

4446 
	}
}

4451 
	$dumpCommªd
(
ş›Á
 *
c
) {

4452 
robj
 *
o
, *
dumpobj
;

4453 
rio
 
·ylßd
;

4456 ià((
o
 = 
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[1])è=ğ
NULL
) {

4457 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

4462 
	`ü—‹DumpPaylßd
(&
·ylßd
,
o
);

4465 
dumpobj
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
·ylßd
.
io
.
bufãr
.
±r
);

4466 
	`addR•lyBulk
(
c
,
dumpobj
);

4467 
	`deüRefCouÁ
(
dumpobj
);

4469 
	}
}

4472 
	$»¡ÜeCommªd
(
ş›Á
 *
c
) {

4473 
‰l
;

4474 
rio
 
·ylßd
;

4475 
j
, 
ty³
, 
»¶aû
 = 0;

4476 
robj
 *
obj
;

4479 
j
 = 4; j < 
c
->
¬gc
; j++) {

4480 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"replace")) {

4481 
»¶aû
 = 1;

4483 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

4489 ià(!
»¶aû
 && 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]è!ğ
NULL
) {

4490 
	`addR•ly
(
c
,
sh¬ed
.
busykey”r
);

4495 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
‰l
,
NULL
è!ğ
C_OK
) {

4497 } ià(
‰l
 < 0) {

4498 
	`addR•lyE¼Ü
(
c
,"Invalid TTL value, must be >= 0");

4503 ià(
	`v”ifyDumpPaylßd
(
c
->
¬gv
[3]->
±r
,
	`sd¦’
(c->¬gv[3]->±r)è=ğ
C_ERR
)

4505 
	`addR•lyE¼Ü
(
c
,"DUMP…ayload version or checksum‡re wrong");

4509 
	`rioIn™W™hBufãr
(&
·ylßd
,
c
->
¬gv
[3]->
±r
);

4510 ià(((
ty³
 = 
	`rdbLßdObjeùTy³
(&
·ylßd
)) == -1) ||

4511 ((
obj
 = 
	`rdbLßdObjeù
(
ty³
,&
·ylßd
)è=ğ
NULL
))

4513 
	`addR•lyE¼Ü
(
c
,"Bad data format");

4518 ià(
»¶aû
è
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

4521 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],
obj
);

4522 ià(
‰l
è
	`£tExpœe
(
c
->
db
,c->
¬gv
[1],
	`m¡ime
()+ttl);

4523 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

4524 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4525 
£rv”
.
dœty
++;

4526 
	}
}

4534 
	#MIGRATE_SOCKET_CACHE_ITEMS
 64

	)

4535 
	#MIGRATE_SOCKET_CACHE_TTL
 10

	)

4537 
	smig¿‹CachedSock‘
 {

4538 
	mfd
;

4539 
	mÏ¡_dbid
;

4540 
time_t
 
	mÏ¡_u£_time
;

4541 } 
	tmig¿‹CachedSock‘
;

4554 
mig¿‹CachedSock‘
* 
	$mig¿‹G‘Sock‘
(
ş›Á
 *
c
, 
robj
 *
ho¡
,„obj *
pÜt
, 
timeout
) {

4555 
fd
;

4556 
sds
 
Çme
 = 
	`sd£m±y
();

4557 
mig¿‹CachedSock‘
 *
cs
;

4560 
Çme
 = 
	`sdsÿ’
Òame,
ho¡
->
±r
,
	`sd¦’
(host->ptr));

4561 
Çme
 = 
	`sdsÿ’
(name,":",1);

4562 
Çme
 = 
	`sdsÿ’
Òame,
pÜt
->
±r
,
	`sd¦’
(port->ptr));

4563 
cs
 = 
	`diùF‘chV®ue
(
£rv”
.
mig¿‹_ÿched_sock‘s
,
Çme
);

4564 ià(
cs
) {

4565 
	`sdsä“
(
Çme
);

4566 
cs
->
Ï¡_u£_time
 = 
£rv”
.
unixtime
;

4567  
cs
;

4571 ià(
	`diùSize
(
£rv”
.
mig¿‹_ÿched_sock‘s
è=ğ
MIGRATE_SOCKET_CACHE_ITEMS
) {

4573 
diùEÁry
 *
de
 = 
	`diùG‘RªdomKey
(
£rv”
.
mig¿‹_ÿched_sock‘s
);

4574 
cs
 = 
	`diùG‘V®
(
de
);

4575 
	`şo£
(
cs
->
fd
);

4576 
	`zä“
(
cs
);

4577 
	`diùD–‘e
(
£rv”
.
mig¿‹_ÿched_sock‘s
,
	`diùG‘Key
(
de
));

4581 
fd
 = 
	`ª‘TıNÚBlockCÚÃù
(
£rv”
.
Ã‹¼
,
c
->
¬gv
[1]->
±r
,

4582 
	`©oi
(
c
->
¬gv
[2]->
±r
));

4583 ià(
fd
 == -1) {

4584 
	`sdsä“
(
Çme
);

4585 
	`addR•lyE¼ÜFÜm©
(
c
,"Can't connectoarget‚ode: %s",

4586 
£rv”
.
Ã‹¼
);

4587  
NULL
;

4589 
	`ª‘EÇbËTıNoD–ay
(
£rv”
.
Ã‹¼
,
fd
);

4592 ià((
	`«Wa™
(
fd
,
AE_WRITABLE
,
timeout
) & AE_WRITABLE) == 0) {

4593 
	`sdsä“
(
Çme
);

4594 
	`addR•lySds
(
c
,

4595 
	`sd¢ew
("-IOERRƒrror orimeout connectingohe client\r\n"));

4596 
	`şo£
(
fd
);

4597  
NULL
;

4601 
cs
 = 
	`zm®loc
((*cs));

4602 
cs
->
fd
 = fd;

4603 
cs
->
Ï¡_dbid
 = -1;

4604 
cs
->
Ï¡_u£_time
 = 
£rv”
.
unixtime
;

4605 
	`diùAdd
(
£rv”
.
mig¿‹_ÿched_sock‘s
,
Çme
,
cs
);

4606  
cs
;

4607 
	}
}

4610 
	$mig¿‹Clo£Sock‘
(
robj
 *
ho¡
,„obj *
pÜt
) {

4611 
sds
 
Çme
 = 
	`sd£m±y
();

4612 
mig¿‹CachedSock‘
 *
cs
;

4614 
Çme
 = 
	`sdsÿ’
Òame,
ho¡
->
±r
,
	`sd¦’
(host->ptr));

4615 
Çme
 = 
	`sdsÿ’
(name,":",1);

4616 
Çme
 = 
	`sdsÿ’
Òame,
pÜt
->
±r
,
	`sd¦’
(port->ptr));

4617 
cs
 = 
	`diùF‘chV®ue
(
£rv”
.
mig¿‹_ÿched_sock‘s
,
Çme
);

4618 ià(!
cs
) {

4619 
	`sdsä“
(
Çme
);

4623 
	`şo£
(
cs
->
fd
);

4624 
	`zä“
(
cs
);

4625 
	`diùD–‘e
(
£rv”
.
mig¿‹_ÿched_sock‘s
,
Çme
);

4626 
	`sdsä“
(
Çme
);

4627 
	}
}

4629 
	$mig¿‹Clo£TimedoutSock‘s
() {

4630 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
mig¿‹_ÿched_sock‘s
);

4631 
diùEÁry
 *
de
;

4633 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

4634 
mig¿‹CachedSock‘
 *
cs
 = 
	`diùG‘V®
(
de
);

4636 ià((
£rv”
.
unixtime
 - 
cs
->
Ï¡_u£_time
è> 
MIGRATE_SOCKET_CACHE_TTL
) {

4637 
	`şo£
(
cs
->
fd
);

4638 
	`zä“
(
cs
);

4639 
	`diùD–‘e
(
£rv”
.
mig¿‹_ÿched_sock‘s
,
	`diùG‘Key
(
de
));

4642 
	`diùR–—£I‹¿tÜ
(
di
);

4643 
	}
}

4650 
	$mig¿‹Commªd
(
ş›Á
 *
c
) {

4651 
mig¿‹CachedSock‘
 *
cs
;

4652 
cİy
, 
»¶aû
, 
j
;

4653 
timeout
;

4654 
dbid
;

4655 
robj
 **
ov
 = 
NULL
;

4656 
robj
 **
kv
 = 
NULL
;

4657 
robj
 **
Ãw¬gv
 = 
NULL
;

4658 
rio
 
cmd
, 
·ylßd
;

4659 
may_»Œy
 = 1;

4660 
wr™e_”rÜ
 = 0;

4663 
fœ¡_key
 = 3;

4664 
num_keys
 = 1;

4667 
cİy
 = 0;

4668 
»¶aû
 = 0;

4671 
j
 = 6; j < 
c
->
¬gc
; j++) {

4672 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"copy")) {

4673 
cİy
 = 1;

4674 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"replace")) {

4675 
»¶aû
 = 1;

4676 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"keys")) {

4677 ià(
	`sd¦’
(
c
->
¬gv
[3]->
±r
) != 0) {

4678 
	`addR•lyE¼Ü
(
c
,

4683 
fœ¡_key
 = 
j
+1;

4684 
num_keys
 = 
c
->
¬gc
 - 
j
 - 1;

4687 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

4693 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[5],&
timeout
,
NULL
è!ğ
C_OK
 ||

4694 
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[4],&
dbid
,
NULL
è!ğ
C_OK
)

4698 ià(
timeout
 <= 0)imeout = 1000;

4705 
ov
 = 
	`z»®loc
(ov,(
robj
*)*
num_keys
);

4706 
kv
 = 
	`z»®loc
(kv,(
robj
*)*
num_keys
);

4707 
oi
 = 0;

4709 
j
 = 0; j < 
num_keys
; j++) {

4710 ià((
ov
[
oi
] = 
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[
fœ¡_key
+
j
])è!ğ
NULL
) {

4711 
kv
[
oi
] = 
c
->
¬gv
[
fœ¡_key
+
j
];

4712 
oi
++;

4715 
num_keys
 = 
oi
;

4716 ià(
num_keys
 == 0) {

4717 
	`zä“
(
ov
); zä“(
kv
);

4718 
	`addR•lySds
(
c
,
	`sd¢ew
("+NOKEY\r\n"));

4722 
Œy_agaš
:

4723 
wr™e_”rÜ
 = 0;

4726 
cs
 = 
	`mig¿‹G‘Sock‘
(
c
,c->
¬gv
[1],c->¬gv[2],
timeout
);

4727 ià(
cs
 =ğ
NULL
) {

4728 
	`zä“
(
ov
); zä“(
kv
);

4732 
	`rioIn™W™hBufãr
(&
cmd
,
	`sd£m±y
());

4735 
£Ëù
 = 
cs
->
Ï¡_dbid
 !ğ
dbid
;

4736 ià(
£Ëù
) {

4737 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`rioWr™eBulkCouÁ
(&
cmd
,'*',2));

4738 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`rioWr™eBulkSŒšg
(&
cmd
,"SELECT",6));

4739 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`rioWr™eBulkLÚgLÚg
(&
cmd
,
dbid
));

4743 
j
 = 0; j < 
num_keys
; j++) {

4744 
‰l
 = 0;

4745 
expœ—t
 = 
	`g‘Expœe
(
c
->
db
,
kv
[
j
]);

4747 ià(
expœ—t
 != -1) {

4748 
‰l
 = 
expœ—t
-
	`m¡ime
();

4749 ià(
‰l
 < 1)tl = 1;

4751 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`rioWr™eBulkCouÁ
(&
cmd
,'*',
»¶aû
 ? 5 : 4));

4752 ià(
£rv”
.
şu¡”_’abËd
)

4753 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,

4754 
	`rioWr™eBulkSŒšg
(&
cmd
,"RESTORE-ASKING",14));

4756 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`rioWr™eBulkSŒšg
(&
cmd
,"RESTORE",7));

4757 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`sdsEncodedObjeù
(
kv
[
j
]));

4758 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`rioWr™eBulkSŒšg
(&
cmd
,
kv
[
j
]->
±r
,

4759 
	`sd¦’
(
kv
[
j
]->
±r
)));

4760 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`rioWr™eBulkLÚgLÚg
(&
cmd
,
‰l
));

4764 
	`ü—‹DumpPaylßd
(&
·ylßd
,
ov
[
j
]);

4765 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,

4766 
	`rioWr™eBulkSŒšg
(&
cmd
,
·ylßd
.
io
.
bufãr
.
±r
,

4767 
	`sd¦’
(
·ylßd
.
io
.
bufãr
.
±r
)));

4768 
	`sdsä“
(
·ylßd
.
io
.
bufãr
.
±r
);

4772 ià(
»¶aû
)

4773 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`rioWr™eBulkSŒšg
(&
cmd
,"REPLACE",7));

4777 
”ºo
 = 0;

4779 
sds
 
buf
 = 
cmd
.
io
.
bufãr
.
±r
;

4780 
size_t
 
pos
 = 0, 
towr™e
;

4781 
nwr™‹n
 = 0;

4783 (
towr™e
 = 
	`sd¦’
(
buf
)-
pos
) > 0) {

4784 
towr™e
 = (towrite > (64*1024) ? (64*1024) :owrite);

4785 
nwr™‹n
 = 
	`syncWr™e
(
cs
->
fd
,
buf
+
pos
,
towr™e
,
timeout
);

4786 ià(
nwr™‹n
 !ğ(sigÃd)
towr™e
) {

4787 
wr™e_”rÜ
 = 1;

4788 
sock‘_”r
;

4790 
pos
 +ğ
nwr™‹n
;

4794 
buf1
[1024];

4795 
buf2
[1024];

4798 ià(
£Ëù
 && 
	`syncR—dLše
(
cs
->
fd
, 
buf1
, (buf1), 
timeout
) <= 0)

4799 
sock‘_”r
;

4802 
”rÜ_äom_rg‘
 = 0;

4803 
sock‘_”rÜ
 = 0;

4804 
d–_idx
 = 1;

4806 ià(!
cİy
è
Ãw¬gv
 = 
	`zm®loc
((
robj
*)*(
num_keys
+1));

4808 
j
 = 0; j < 
num_keys
; j++) {

4809 ià(
	`syncR—dLše
(
cs
->
fd
, 
buf2
, (buf2), 
timeout
) <= 0) {

4810 
sock‘_”rÜ
 = 1;

4813 ià((
£Ëù
 && 
buf1
[0] =ğ'-'è|| 
buf2
[0] == '-') {

4815 ià(!
”rÜ_äom_rg‘
) {

4816 
cs
->
Ï¡_dbid
 = -1;

4817 
	`addR•lyE¼ÜFÜm©
(
c
,"Target instance„eplied withƒrror: %s",

4818 (
£Ëù
 && 
buf1
[0] =ğ'-'è? buf1+1 : 
buf2
+1);

4819 
”rÜ_äom_rg‘
 = 1;

4822 ià(!
cİy
) {

4824 
	`dbD–‘e
(
c
->
db
,
kv
[
j
]);

4825 
	`sigÇlModif›dKey
(
c
->
db
,
kv
[
j
]);

4826 
£rv”
.
dœty
++;

4829 
Ãw¬gv
[
d–_idx
++] = 
kv
[
j
];

4830 
	`šüRefCouÁ
(
kv
[
j
]);

4838 ià(!
”rÜ_äom_rg‘
 && 
sock‘_”rÜ
 && 
j
 =ğ0 && 
may_»Œy
 &&

4839 
”ºo
 !ğ
ETIMEDOUT
)

4841 
sock‘_”r
;

4844 ià(!
cİy
) {

4846 ià(
d–_idx
 > 1) {

4847 
Ãw¬gv
[0] = 
	`ü—‹SŒšgObjeù
("DEL",3);

4849 
	`»¶aûCl›ÁCommªdVeùÜ
(
c
,
d–_idx
,
Ãw¬gv
);

4852 
	`zä“
(
Ãw¬gv
);

4854 
Ãw¬gv
 = 
NULL
;

4860 ià(!
”rÜ_äom_rg‘
 && 
sock‘_”rÜ
) {

4861 
may_»Œy
 = 0;

4862 
sock‘_”r
;

4865 ià(!
”rÜ_äom_rg‘
) {

4868 
cs
->
Ï¡_dbid
 = 
dbid
;

4869 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4875 
	`sdsä“
(
cmd
.
io
.
bufãr
.
±r
);

4876 
	`zä“
(
ov
); zä“(
kv
); zä“(
Ãw¬gv
);

4877 ià(
sock‘_”rÜ
è
	`mig¿‹Clo£Sock‘
(
c
->
¬gv
[1],c->argv[2]);

4883 
sock‘_”r
:

4886 
	`sdsä“
(
cmd
.
io
.
bufãr
.
±r
);

4887 
	`mig¿‹Clo£Sock‘
(
c
->
¬gv
[1],c->argv[2]);

4888 
	`zä“
(
Ãw¬gv
);

4889 
Ãw¬gv
 = 
NULL
;

4893 ià(
”ºo
 !ğ
ETIMEDOUT
 && 
may_»Œy
) {

4894 
may_»Œy
 = 0;

4895 
Œy_agaš
;

4899 
	`zä“
(
ov
); zä“(
kv
);

4900 
	`addR•lySds
(
c
,

4901 
	`sdsÿrštf
(
	`sd£m±y
(),

4903 
wr™e_”rÜ
 ? "writing" : "reading"));

4905 
	}
}

4915 
	$askšgCommªd
(
ş›Á
 *
c
) {

4916 ià(
£rv”
.
şu¡”_’abËd
 == 0) {

4917 
	`addR•lyE¼Ü
(
c
,"This instance has cluster support disabled");

4920 
c
->
æags
 |ğ
CLIENT_ASKING
;

4921 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4922 
	}
}

4927 
	$»adÚlyCommªd
(
ş›Á
 *
c
) {

4928 ià(
£rv”
.
şu¡”_’abËd
 == 0) {

4929 
	`addR•lyE¼Ü
(
c
,"This instance has cluster support disabled");

4932 
c
->
æags
 |ğ
CLIENT_READONLY
;

4933 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4934 
	}
}

4937 
	$»adwr™eCommªd
(
ş›Á
 *
c
) {

4938 
c
->
æags
 &ğ~
CLIENT_READONLY
;

4939 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

4940 
	}
}

4974 
şu¡”Node
 *
	$g‘NodeByQu”y
(
ş›Á
 *
c
, 
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
hash¦Ù
, *
”rÜ_code
) {

4975 
şu¡”Node
 *
n
 = 
NULL
;

4976 
robj
 *
fœ¡key
 = 
NULL
;

4977 
muÉË_keys
 = 0;

4978 
muÉiS‹
 *
ms
, 
_ms
;

4979 
muÉiCmd
 
mc
;

4980 
i
, 
¦Ù
 = 0, 
mig¿tšg_¦Ù
 = 0, 
impÜtšg_¦Ù
 = 0, 
missšg_keys
 = 0;

4983 ià(
”rÜ_code
è*”rÜ_codğ
CLUSTER_REDIR_NONE
;

4987 ià(
cmd
->
´oc
 =ğ
execCommªd
) {

4990 ià(!(
c
->
æags
 & 
CLIENT_MULTI
)è 
my£lf
;

4991 
ms
 = &
c
->
m¡©e
;

4996 
ms
 = &
_ms
;

4997 
_ms
.
commªds
 = &
mc
;

4998 
_ms
.
couÁ
 = 1;

4999 
mc
.
¬gv
 =‡rgv;

5000 
mc
.
¬gc
 =‡rgc;

5001 
mc
.
cmd
 = cmd;

5006 
i
 = 0; i < 
ms
->
couÁ
; i++) {

5007 
»disCommªd
 *
mcmd
;

5008 
robj
 **
m¬gv
;

5009 
m¬gc
, *
keyšdex
, 
numkeys
, 
j
;

5011 
mcmd
 = 
ms
->
commªds
[
i
].
cmd
;

5012 
m¬gc
 = 
ms
->
commªds
[
i
].
¬gc
;

5013 
m¬gv
 = 
ms
->
commªds
[
i
].
¬gv
;

5015 
keyšdex
 = 
	`g‘KeysFromCommªd
(
mcmd
,
m¬gv
,
m¬gc
,&
numkeys
);

5016 
j
 = 0; j < 
numkeys
; j++) {

5017 
robj
 *
thiskey
 = 
m¬gv
[
keyšdex
[
j
]];

5018 
this¦Ù
 = 
	`keyHashSlÙ
((*)
thiskey
->
±r
,

5019 
	`sd¦’
(
thiskey
->
±r
));

5021 ià(
fœ¡key
 =ğ
NULL
) {

5024 
fœ¡key
 = 
thiskey
;

5025 
¦Ù
 = 
this¦Ù
;

5026 
n
 = 
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
];

5032 ià(
n
 =ğ
NULL
) {

5033 
	`g‘KeysF»eResuÉ
(
keyšdex
);

5034 ià(
”rÜ_code
)

5035 *
”rÜ_code
 = 
CLUSTER_REDIR_DOWN_UNBOUND
;

5036  
NULL
;

5044 ià(
n
 =ğ
my£lf
 &&

5045 
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
¦Ù
] !ğ
NULL
)

5047 
mig¿tšg_¦Ù
 = 1;

5048 } ià(
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
¦Ù
] !ğ
NULL
) {

5049 
impÜtšg_¦Ù
 = 1;

5054 ià(!
	`equ®SŒšgObjeùs
(
fœ¡key
,
thiskey
)) {

5055 ià(
¦Ù
 !ğ
this¦Ù
) {

5057 
	`g‘KeysF»eResuÉ
(
keyšdex
);

5058 ià(
”rÜ_code
)

5059 *
”rÜ_code
 = 
CLUSTER_REDIR_CROSS_SLOT
;

5060  
NULL
;

5064 
muÉË_keys
 = 1;

5070 ià((
mig¿tšg_¦Ù
 || 
impÜtšg_¦Ù
) &&

5071 
	`lookupKeyR—d
(&
£rv”
.
db
[0],
thiskey
è=ğ
NULL
)

5073 
missšg_keys
++;

5076 
	`g‘KeysF»eResuÉ
(
keyšdex
);

5081 ià(
n
 =ğ
NULL
è 
my£lf
;

5084 ià(
£rv”
.
şu¡”
->
¡©e
 !ğ
CLUSTER_OK
) {

5085 ià(
”rÜ_code
è*”rÜ_codğ
CLUSTER_REDIR_DOWN_STATE
;

5086  
NULL
;

5090 ià(
hash¦Ù
è*hash¦Ù = 
¦Ù
;

5095 ià((
mig¿tšg_¦Ù
 || 
impÜtšg_¦Ù
è&& 
cmd
->
´oc
 =ğ
mig¿‹Commªd
)

5096  
my£lf
;

5100 ià(
mig¿tšg_¦Ù
 && 
missšg_keys
) {

5101 ià(
”rÜ_code
è*”rÜ_codğ
CLUSTER_REDIR_ASK
;

5102  
£rv”
.
şu¡”
->
mig¿tšg_¦Ùs_to
[
¦Ù
];

5109 ià(
impÜtšg_¦Ù
 &&

5110 (
c
->
æags
 & 
CLIENT_ASKING
 || 
cmd
->æag & 
CMD_ASKING
))

5112 ià(
muÉË_keys
 && 
missšg_keys
) {

5113 ià(
”rÜ_code
è*”rÜ_codğ
CLUSTER_REDIR_UNSTABLE
;

5114  
NULL
;

5116  
my£lf
;

5123 ià(
c
->
æags
 & 
CLIENT_READONLY
 &&

5124 
cmd
->
æags
 & 
CMD_READONLY
 &&

5125 
	`nodeIsSÏve
(
my£lf
) &&

5126 
my£lf
->
¦aveof
 =ğ
n
)

5128  
my£lf
;

5133 ià(
n
 !ğ
my£lf
 && 
”rÜ_code
è*”rÜ_codğ
CLUSTER_REDIR_MOVED
;

5134  
n
;

5135 
	}
}

5144 
	$şu¡”RedœeùCl›Á
(
ş›Á
 *
c
, 
şu¡”Node
 *
n
, 
hash¦Ù
, 
”rÜ_code
) {

5145 ià(
”rÜ_code
 =ğ
CLUSTER_REDIR_CROSS_SLOT
) {

5146 
	`addR•lySds
(
c
,
	`sd¢ew
("-CROSSSLOT Keys in„equest don't hashohe same slot\r\n"));

5147 } ià(
”rÜ_code
 =ğ
CLUSTER_REDIR_UNSTABLE
) {

5151 
	`addR•lySds
(
c
,
	`sd¢ew
("-TRYAGAIN Multiple keys„equest during„ehashing of slot\r\n"));

5152 } ià(
”rÜ_code
 =ğ
CLUSTER_REDIR_DOWN_STATE
) {

5153 
	`addR•lySds
(
c
,
	`sd¢ew
("-CLUSTERDOWN The cluster is down\r\n"));

5154 } ià(
”rÜ_code
 =ğ
CLUSTER_REDIR_DOWN_UNBOUND
) {

5155 
	`addR•lySds
(
c
,
	`sd¢ew
("-CLUSTERDOWN Hash slot‚ot served\r\n"));

5156 } ià(
”rÜ_code
 =ğ
CLUSTER_REDIR_MOVED
 ||

5157 
”rÜ_code
 =ğ
CLUSTER_REDIR_ASK
)

5159 
	`addR•lySds
(
c
,
	`sdsÿrštf
(
	`sd£m±y
(),

5161 (
”rÜ_code
 =ğ
CLUSTER_REDIR_ASK
) ? "ASK" : "MOVED",

5162 
hash¦Ù
,
n
->

,n->
pÜt
));

5164 
	`£rv”Pªic
("getNodeByQuery() unknownƒrror.");

5166 
	}
}

5179 
	$şu¡”RedœeùBlockedCl›ÁIfN“ded
(
ş›Á
 *
c
) {

5180 ià(
c
->
æags
 & 
CLIENT_BLOCKED
 && c->
bty³
 =ğ
BLOCKED_LIST
) {

5181 
diùEÁry
 *
de
;

5182 
diùI‹¿tÜ
 *
di
;

5185 ià(
£rv”
.
şu¡”
->
¡©e
 =ğ
CLUSTER_FAIL
) {

5186 
	`şu¡”RedœeùCl›Á
(
c
,
NULL
,0,
CLUSTER_REDIR_DOWN_STATE
);

5190 
di
 = 
	`diùG‘I‹¿tÜ
(
c
->
bpİ
.
keys
);

5191 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

5192 
robj
 *
key
 = 
	`diùG‘Key
(
de
);

5193 
¦Ù
 = 
	`keyHashSlÙ
((*)
key
->
±r
, 
	`sd¦’
(key->ptr));

5194 
şu¡”Node
 *
node
 = 
£rv”
.
şu¡”
->
¦Ùs
[
¦Ù
];

5199 ià(
node
 !ğ
my£lf
 &&

5200 
£rv”
.
şu¡”
->
impÜtšg_¦Ùs_äom
[
¦Ù
] =ğ
NULL
)

5202 ià(
node
 =ğ
NULL
) {

5203 
	`şu¡”RedœeùCl›Á
(
c
,
NULL
,0,

5204 
CLUSTER_REDIR_DOWN_UNBOUND
);

5206 
	`şu¡”RedœeùCl›Á
(
c
,
node
,
¦Ù
,

5207 
CLUSTER_REDIR_MOVED
);

5212 
	`diùR–—£I‹¿tÜ
(
di
);

5215 
	}
}

	@src/cluster.h

1 #iâdeà
__CLUSTER_H


2 
	#__CLUSTER_H


	)

8 
	#CLUSTER_SLOTS
 16384

	)

9 
	#CLUSTER_OK
 0

	)

10 
	#CLUSTER_FAIL
 1

	)

11 
	#CLUSTER_NAMELEN
 40

	)

12 
	#CLUSTER_PORT_INCR
 10000

	)

16 
	#CLUSTER_DEFAULT_NODE_TIMEOUT
 15000

	)

17 
	#CLUSTER_DEFAULT_SLAVE_VALIDITY
 10

	)

18 
	#CLUSTER_DEFAULT_REQUIRE_FULL_COVERAGE
 1

	)

19 
	#CLUSTER_FAIL_REPORT_VALIDITY_MULT
 2

	)

20 
	#CLUSTER_FAIL_UNDO_TIME_MULT
 2

	)

21 
	#CLUSTER_FAIL_UNDO_TIME_ADD
 10

	)

22 
	#CLUSTER_FAILOVER_DELAY
 5

	)

23 
	#CLUSTER_DEFAULT_MIGRATION_BARRIER
 1

	)

24 
	#CLUSTER_MF_TIMEOUT
 5000

	)

25 
	#CLUSTER_MF_PAUSE_MULT
 2

	)

26 
	#CLUSTER_SLAVE_MIGRATION_DELAY
 5000

	)

29 
	#CLUSTER_REDIR_NONE
 0

	)

30 
	#CLUSTER_REDIR_CROSS_SLOT
 1

	)

31 
	#CLUSTER_REDIR_UNSTABLE
 2

	)

32 
	#CLUSTER_REDIR_ASK
 3

	)

33 
	#CLUSTER_REDIR_MOVED
 4

	)

34 
	#CLUSTER_REDIR_DOWN_STATE
 5

	)

35 
	#CLUSTER_REDIR_DOWN_UNBOUND
 6

	)

37 
	gşu¡”Node
;

40 
	sşu¡”Lšk
 {

41 
m¡ime_t
 
	mùime
;

42 
	mfd
;

43 
sds
 
	m¢dbuf
;

44 
sds
 
	mrcvbuf
;

45 
şu¡”Node
 *
	mnode
;

46 } 
	tşu¡”Lšk
;

49 
	#CLUSTER_NODE_MASTER
 1

	)

50 
	#CLUSTER_NODE_SLAVE
 2

	)

51 
	#CLUSTER_NODE_PFAIL
 4

	)

52 
	#CLUSTER_NODE_FAIL
 8

	)

53 
	#CLUSTER_NODE_MYSELF
 16

	)

54 
	#CLUSTER_NODE_HANDSHAKE
 32

	)

55 
	#CLUSTER_NODE_NOADDR
 64

	)

56 
	#CLUSTER_NODE_MEET
 128

	)

57 
	#CLUSTER_NODE_MIGRATE_TO
 256

	)

58 
	#CLUSTER_NODE_NULL_NAME
 "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"

	)

60 
	#nodeIsMa¡”
(
n
è(Ò)->
æags
 & 
CLUSTER_NODE_MASTER
)

	)

61 
	#nodeIsSÏve
(
n
è(Ò)->
æags
 & 
CLUSTER_NODE_SLAVE
)

	)

62 
	#nodeInHªdshake
(
n
è(Ò)->
æags
 & 
CLUSTER_NODE_HANDSHAKE
)

	)

63 
	#nodeHasAddr
(
n
è(!(Ò)->
æags
 & 
CLUSTER_NODE_NOADDR
))

	)

64 
	#nodeW™houtAddr
(
n
è(Ò)->
æags
 & 
CLUSTER_NODE_NOADDR
)

	)

65 
	#nodeTimedOut
(
n
è(Ò)->
æags
 & 
CLUSTER_NODE_PFAIL
)

	)

66 
	#nodeFaed
(
n
è(Ò)->
æags
 & 
CLUSTER_NODE_FAIL
)

	)

69 
	#CLUSTER_CANT_FAILOVER_NONE
 0

	)

70 
	#CLUSTER_CANT_FAILOVER_DATA_AGE
 1

	)

71 
	#CLUSTER_CANT_FAILOVER_WAITING_DELAY
 2

	)

72 
	#CLUSTER_CANT_FAILOVER_EXPIRED
 3

	)

73 
	#CLUSTER_CANT_FAILOVER_WAITING_VOTES
 4

	)

74 
	#CLUSTER_CANT_FAILOVER_RELOG_PERIOD
 (60*5è

	)

77 
	sşu¡”NodeFaR•Üt
 {

78 
şu¡”Node
 *
	mnode
;

79 
m¡ime_t
 
	mtime
;

80 } 
	tşu¡”NodeFaR•Üt
;

82 
	sşu¡”Node
 {

83 
m¡ime_t
 
	mùime
;

84 
	mÇme
[
CLUSTER_NAMELEN
];

85 
	mæags
;

86 
ušt64_t
 
	mcÚfigEpoch
;

87 
	m¦Ùs
[
CLUSTER_SLOTS
/8];

88 
	mnum¦Ùs
;

89 
	mnum¦aves
;

90 
şu¡”Node
 **
	m¦aves
;

91 
şu¡”Node
 *
	m¦aveof
;

95 
m¡ime_t
 
	mpšg_£Á
;

96 
m¡ime_t
 
	mpÚg_»ûived
;

97 
m¡ime_t
 
	mç_time
;

98 
m¡ime_t
 
	mvÙed_time
;

99 
m¡ime_t
 
	m»¶_off£t_time
;

100 
m¡ime_t
 
	mÜphªed_time
;

101 
	m»¶_off£t
;

102 
	m
[
NET_IP_STR_LEN
];

103 
	mpÜt
;

104 
şu¡”Lšk
 *
	mlšk
;

105 
li¡
 *
	mç_»pÜts
;

106 } 
	tşu¡”Node
;

108 
	sşu¡”S‹
 {

109 
şu¡”Node
 *
	mmy£lf
;

110 
ušt64_t
 
	mcu¼’tEpoch
;

111 
	m¡©e
;

112 
	msize
;

113 
diù
 *
	mnodes
;

114 
diù
 *
	mnodes_bÏck_li¡
;

115 
şu¡”Node
 *
	mmig¿tšg_¦Ùs_to
[
CLUSTER_SLOTS
];

116 
şu¡”Node
 *
	mimpÜtšg_¦Ùs_äom
[
CLUSTER_SLOTS
];

117 
şu¡”Node
 *
	m¦Ùs
[
CLUSTER_SLOTS
];

118 
zskli¡
 *
	m¦Ùs_to_keys
;

120 
m¡ime_t
 
	mçov”_auth_time
;

121 
	mçov”_auth_couÁ
;

122 
	mçov”_auth_£Á
;

123 
	mçov”_auth_¿nk
;

124 
ušt64_t
 
	mçov”_auth_•och
;

125 
	mÿÁ_çov”_»asÚ
;

128 
m¡ime_t
 
	mmf_’d
;

131 
şu¡”Node
 *
	mmf_¦ave
;

133 
	mmf_ma¡”_off£t
;

135 
	mmf_ÿn_¡¬t
;

138 
ušt64_t
 
	mÏ¡VÙeEpoch
;

139 
	mtodo_befÜe_¦“p
;

140 
	m¡©s_bus_mes§ges_£Á
;

141 
	m¡©s_bus_mes§ges_»ûived
;

142 } 
	tşu¡”S‹
;

145 
	#CLUSTER_TODO_HANDLE_FAILOVER
 (1<<0)

	)

146 
	#CLUSTER_TODO_UPDATE_STATE
 (1<<1)

	)

147 
	#CLUSTER_TODO_SAVE_CONFIG
 (1<<2)

	)

148 
	#CLUSTER_TODO_FSYNC_CONFIG
 (1<<3)

	)

156 
	#CLUSTERMSG_TYPE_PING
 0

	)

157 
	#CLUSTERMSG_TYPE_PONG
 1

	)

158 
	#CLUSTERMSG_TYPE_MEET
 2

	)

159 
	#CLUSTERMSG_TYPE_FAIL
 3

	)

160 
	#CLUSTERMSG_TYPE_PUBLISH
 4

	)

161 
	#CLUSTERMSG_TYPE_FAILOVER_AUTH_REQUEST
 5

	)

162 
	#CLUSTERMSG_TYPE_FAILOVER_AUTH_ACK
 6

	)

163 
	#CLUSTERMSG_TYPE_UPDATE
 7

	)

164 
	#CLUSTERMSG_TYPE_MFSTART
 8

	)

170 
	mnod’ame
[
CLUSTER_NAMELEN
];

171 
ušt32_t
 
	mpšg_£Á
;

172 
ušt32_t
 
	mpÚg_»ûived
;

173 
	m
[
NET_IP_STR_LEN
];

174 
ušt16_t
 
	mpÜt
;

175 
ušt16_t
 
	mæags
;

176 
ušt16_t
 
	mnÙu£d1
;

177 
ušt32_t
 
	mnÙu£d2
;

178 } 
	tşu¡”MsgD©aGoss
;

181 
	mnod’ame
[
CLUSTER_NAMELEN
];

182 } 
	tşu¡”MsgD©aFa
;

185 
ušt32_t
 
	mchªÃl_Ën
;

186 
ušt32_t
 
	mmes§ge_Ën
;

190 
	mbulk_d©a
[8];

191 } 
	tşu¡”MsgD©aPublish
;

194 
ušt64_t
 
	mcÚfigEpoch
;

195 
	mnod’ame
[
CLUSTER_NAMELEN
];

196 
	m¦Ùs
[
CLUSTER_SLOTS
/8];

197 } 
	tşu¡”MsgD©aUpd©e
;

199 
	uşu¡”MsgD©a
 {

203 
şu¡”MsgD©aGoss
 
	mgoss
[1];

204 } 
	mpšg
;

208 
şu¡”MsgD©aFa
 
	mabout
;

209 } 
	mç
;

213 
şu¡”MsgD©aPublish
 
	mmsg
;

214 } 
	mpublish
;

218 
şu¡”MsgD©aUpd©e
 
	mnodecfg
;

219 } 
	mupd©e
;

222 
	#CLUSTER_PROTO_VER
 0

	)

225 
	msig
[4];

226 
ušt32_t
 
	mtÙËn
;

227 
ušt16_t
 
	mv”
;

228 
ušt16_t
 
	mnÙu£d0
;

229 
ušt16_t
 
	mty³
;

230 
ušt16_t
 
	mcouÁ
;

231 
ušt64_t
 
	mcu¼’tEpoch
;

232 
ušt64_t
 
	mcÚfigEpoch
;

235 
ušt64_t
 
	moff£t
;

237 
	m£nd”
[
CLUSTER_NAMELEN
];

238 
	mmy¦Ùs
[
CLUSTER_SLOTS
/8];

239 
	m¦aveof
[
CLUSTER_NAMELEN
];

240 
	mnÙu£d1
[32];

241 
ušt16_t
 
	mpÜt
;

242 
ušt16_t
 
	mæags
;

243 
	m¡©e
;

244 
	mmæags
[3];

245 
şu¡”MsgD©a
 
	md©a
;

246 } 
	tşu¡”Msg
;

248 
	#CLUSTERMSG_MIN_LEN
 ((
şu¡”Msg
)-(
şu¡”MsgD©a
))

	)

252 
	#CLUSTERMSG_FLAG0_PAUSED
 (1<<0è

	)

253 
	#CLUSTERMSG_FLAG0_FORCEACK
 (1<<1è

	)

257 
şu¡”Node
 *
g‘NodeByQu”y
(
ş›Á
 *
c
, 
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
hash¦Ù
, *
ask
);

258 
şu¡”RedœeùBlockedCl›ÁIfN“ded
(
ş›Á
 *
c
);

259 
şu¡”RedœeùCl›Á
(
ş›Á
 *
c
, 
şu¡”Node
 *
n
, 
hash¦Ù
, 
”rÜ_code
);

	@src/config.c

31 
	~"£rv”.h
"

32 
	~"şu¡”.h
"

34 
	~<fú.h
>

35 
	~<sys/¡©.h
>

41 
	scÚfigEnum
 {

42 cÚ¡ *
	mÇme
;

43 cÚ¡ 
	mv®
;

44 } 
	tcÚfigEnum
;

46 
cÚfigEnum
 
	gmaxmemÜy_pŞicy_’um
[] = {

47 {"vŞ©e-Ìu", 
MAXMEMORY_VOLATILE_LRU
},

48 {"vŞ©e-¿ndom",
MAXMEMORY_VOLATILE_RANDOM
},

49 {"vŞ©e-‰l",
MAXMEMORY_VOLATILE_TTL
},

50 {"®lkeys-Ìu",
MAXMEMORY_ALLKEYS_LRU
},

51 {"®lkeys-¿ndom",
MAXMEMORY_ALLKEYS_RANDOM
},

52 {"nÛviùiÚ",
MAXMEMORY_NO_EVICTION
},

53 {
NULL
, 0}

56 
cÚfigEnum
 
	gsy¦og_çc™y_’um
[] = {

57 {"u£r", 
LOG_USER
},

58 {"loÿl0", 
LOG_LOCAL0
},

59 {"loÿl1", 
LOG_LOCAL1
},

60 {"loÿl2", 
LOG_LOCAL2
},

61 {"loÿl3", 
LOG_LOCAL3
},

62 {"loÿl4", 
LOG_LOCAL4
},

63 {"loÿl5", 
LOG_LOCAL5
},

64 {"loÿl6", 
LOG_LOCAL6
},

65 {"loÿl7", 
LOG_LOCAL7
},

66 {
NULL
, 0}

69 
cÚfigEnum
 
	glogËv–_’um
[] = {

70 {"debug", 
LL_DEBUG
},

71 {"v”bo£", 
LL_VERBOSE
},

72 {"nÙiû", 
LL_NOTICE
},

73 {"w¬nšg", 
LL_WARNING
},

74 {
NULL
,0}

77 
cÚfigEnum
 
	gsu³rvi£d_mode_’um
[] = {

78 {"up¡¬t", 
SUPERVISED_UPSTART
},

79 {"sy¡emd", 
SUPERVISED_SYSTEMD
},

80 {"auto", 
SUPERVISED_AUTODETECT
},

81 {"no", 
SUPERVISED_NONE
},

82 {
NULL
, 0}

85 
cÚfigEnum
 
	gaof_fsync_’um
[] = {

86 {"ev”y£c", 
AOF_FSYNC_EVERYSEC
},

87 {"®ways", 
AOF_FSYNC_ALWAYS
},

88 {"no", 
AOF_FSYNC_NO
},

89 {
NULL
, 0}

93 
ş›ÁBufãrLim™sCÚfig
 
	gş›ÁBufãrLim™sDeçuÉs
[
CLIENT_TYPE_OBUF_COUNT
] = {

104 
	$cÚfigEnumG‘V®ue
(
cÚfigEnum
 *
û
, *
Çme
) {

105 
û
->
Çme
 !ğ
NULL
) {

106 ià(!
	`¡rÿ£cmp
(
û
->
Çme
,Çme)è ce->
v®
;

107 
û
++;

109  
INT_MIN
;

110 
	}
}

113 cÚ¡ *
	$cÚfigEnumG‘Name
(
cÚfigEnum
 *
û
, 
v®
) {

114 
û
->
Çme
 !ğ
NULL
) {

115 ià(
û
->
v®
 =ğv®è ce->
Çme
;

116 
û
++;

118  
NULL
;

119 
	}
}

123 cÚ¡ *
	$cÚfigEnumG‘NameOrUnknown
(
cÚfigEnum
 *
û
, 
v®
) {

124 cÚ¡ *
Çme
 = 
	`cÚfigEnumG‘Name
(
û
,
v®
);

125  
Çme
 ?‚ame : "unknown";

126 
	}
}

129 cÚ¡ *
	$eviùPŞicyToSŒšg
() {

130  
	`cÚfigEnumG‘NameOrUnknown
(
maxmemÜy_pŞicy_’um
,
£rv”
.
maxmemÜy_pŞicy
);

131 
	}
}

137 
	$ye¢Ùoi
(*
s
) {

138 ià(!
	`¡rÿ£cmp
(
s
,"yes"))  1;

139 ià(!
	`¡rÿ£cmp
(
s
,"no"))  0;

141 
	}
}

143 
	$­³ndS”v”SaveP¬ams
(
time_t
 
£cÚds
, 
chªges
) {

144 
£rv”
.
§v•¬ams
 = 
	`z»®loc
(£rv”.§v•¬ams,(
§v•¬am
)*(£rv”.
§v•¬am¦’
+1));

145 
£rv”
.
§v•¬ams
[£rv”.
§v•¬am¦’
].
£cÚds
 = seconds;

146 
£rv”
.
§v•¬ams
[£rv”.
§v•¬am¦’
].
chªges
 = changes;

147 
£rv”
.
§v•¬am¦’
++;

148 
	}
}

150 
	$»£tS”v”SaveP¬ams
() {

151 
	`zä“
(
£rv”
.
§v•¬ams
);

152 
£rv”
.
§v•¬ams
 = 
NULL
;

153 
£rv”
.
§v•¬am¦’
 = 0;

154 
	}
}

156 
	$lßdS”v”CÚfigFromSŒšg
(*
cÚfig
) {

157 *
”r
 = 
NULL
;

158 
lš’um
 = 0, 
tÙlšes
, 
i
;

159 
¦aveof_lš’um
 = 0;

160 
sds
 *
lšes
;

162 
lšes
 = 
	`sds¥l™Ën
(
cÚfig
,
	`¡¾’
(cÚfig),"\n",1,&
tÙlšes
);

164 
i
 = 0; i < 
tÙlšes
; i++) {

165 
sds
 *
¬gv
;

166 
¬gc
;

168 
lš’um
 = 
i
+1;

169 
lšes
[
i
] = 
	`sd¡rim
(lines[i]," \t\r\n");

172 ià(
lšes
[
i
][0] == '#' ||†ines[i][0] == '\0') ;

175 
¬gv
 = 
	`sds¥l™¬gs
(
lšes
[
i
],&
¬gc
);

176 ià(
¬gv
 =ğ
NULL
) {

177 
”r
 = "Unbalanced quotes in configuration†ine";

178 
lßd”r
;

182 ià(
¬gc
 == 0) {

183 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

186 
	`sd¡Şow”
(
¬gv
[0]);

189 ià(!
	`¡rÿ£cmp
(
¬gv
[0],"timeout"è&& 
¬gc
 == 2) {

190 
£rv”
.
maxidËtime
 = 
	`©oi
(
¬gv
[1]);

191 ià(
£rv”
.
maxidËtime
 < 0) {

192 
”r
 = "Inv®idimeouˆv®ue"; 
lßd”r
;

194 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"tı-k“·live"è&& 
¬gc
 == 2) {

195 
£rv”
.
tık“·live
 = 
	`©oi
(
¬gv
[1]);

196 ià(
£rv”
.
tık“·live
 < 0) {

197 
”r
 = "Inv®idı-k“·livv®ue"; 
lßd”r
;

199 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"´Ùeùed-mode"è&& 
¬gc
 == 2) {

200 ià((
£rv”
.
´Ùeùed_mode
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

201 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

203 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"pÜt"è&& 
¬gc
 == 2) {

204 
£rv”
.
pÜt
 = 
	`©oi
(
¬gv
[1]);

205 ià(
£rv”
.
pÜt
 < 0 || server.port > 65535) {

206 
”r
 = "Inv®id…Üt"; 
lßd”r
;

208 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"tı-backlog"è&& 
¬gc
 == 2) {

209 
£rv”
.
tı_backlog
 = 
	`©oi
(
¬gv
[1]);

210 ià(
£rv”
.
tı_backlog
 < 0) {

211 
”r
 = "Inv®id backlog v®ue"; 
lßd”r
;

213 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"bšd"è&& 
¬gc
 >= 2) {

214 
j
, 
add»s£s
 = 
¬gc
-1;

216 ià(
add»s£s
 > 
CONFIG_BINDADDR_MAX
) {

217 
”r
 = "ToØmªy bšd‡dd»s£ ¥ecif›d"; 
lßd”r
;

219 
j
 = 0; j < 
add»s£s
; j++)

220 
£rv”
.
bšdaddr
[
j
] = 
	`z¡rdup
(
¬gv
[j+1]);

221 
£rv”
.
bšdaddr_couÁ
 = 
add»s£s
;

222 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"unixsock‘"è&& 
¬gc
 == 2) {

223 
£rv”
.
unixsock‘
 = 
	`z¡rdup
(
¬gv
[1]);

224 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"unixsock‘³rm"è&& 
¬gc
 == 2) {

225 
”ºo
 = 0;

226 
£rv”
.
unixsock‘³rm
 = (
mode_t
)
	`¡¹Ş
(
¬gv
[1], 
NULL
, 8);

227 ià(
”ºo
 || 
£rv”
.
unixsock‘³rm
 > 0777) {

228 
”r
 = "Inv®id sock‘ f³rmissiÚs"; 
lßd”r
;

230 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"save")) {

231 ià(
¬gc
 == 3) {

232 
£cÚds
 = 
	`©oi
(
¬gv
[1]);

233 
chªges
 = 
	`©oi
(
¬gv
[2]);

234 ià(
£cÚds
 < 1 || 
chªges
 < 0) {

235 
”r
 = "Inv®id sav·¿m‘”s"; 
lßd”r
;

237 
	`­³ndS”v”SaveP¬ams
(
£cÚds
,
chªges
);

238 } ià(
¬gc
 =ğ2 && !
	`¡rÿ£cmp
(
¬gv
[1],"")) {

239 
	`»£tS”v”SaveP¬ams
();

241 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"dœ"è&& 
¬gc
 == 2) {

242 ià(
	`chdœ
(
¬gv
[1]) == -1) {

243 
	`£rv”Log
(
LL_WARNING
,"Can't chdiro '%s': %s",

244 
¬gv
[1], 
	`¡»¼Ü
(
”ºo
));

245 
	`ex™
(1);

247 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"logËv–"è&& 
¬gc
 == 2) {

248 
£rv”
.
v”bos™y
 = 
	`cÚfigEnumG‘V®ue
(
logËv–_’um
,
¬gv
[1]);

249 ià(
£rv”
.
v”bos™y
 =ğ
INT_MIN
) {

250 
”r
 = "Invalid†og†evel. "

252 
lßd”r
;

254 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"logfe"è&& 
¬gc
 == 2) {

255 
FILE
 *
logå
;

257 
	`zä“
(
£rv”
.
logfe
);

258 
£rv”
.
logfe
 = 
	`z¡rdup
(
¬gv
[1]);

259 ià(
£rv”
.
logfe
[0] != '\0') {

262 
logå
 = 
	`fİ’
(
£rv”
.
logfe
,"a");

263 ià(
logå
 =ğ
NULL
) {

264 
”r
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

265 "Cª'ˆİ’hlog fe: %s", 
	`¡»¼Ü
(
”ºo
));

266 
lßd”r
;

268 
	`fşo£
(
logå
);

270 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"sy¦og-’abËd"è&& 
¬gc
 == 2) {

271 ià((
£rv”
.
sy¦og_’abËd
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

272 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

274 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"sy¦og-id’t"è&& 
¬gc
 == 2) {

275 ià(
£rv”
.
sy¦og_id’t
è
	`zä“
(server.syslog_ident);

276 
£rv”
.
sy¦og_id’t
 = 
	`z¡rdup
(
¬gv
[1]);

277 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"sy¦og-çc™y"è&& 
¬gc
 == 2) {

278 
£rv”
.
sy¦og_çc™y
 =

279 
	`cÚfigEnumG‘V®ue
(
sy¦og_çc™y_’um
,
¬gv
[1]);

280 ià(
£rv”
.
sy¦og_çc™y
 =ğ
INT_MIN
) {

281 
”r
 = "Invalid†og facility. Must be one of USER or between LOCAL0-LOCAL7";

282 
lßd”r
;

284 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"d©aba£s"è&& 
¬gc
 == 2) {

285 
£rv”
.
dbnum
 = 
	`©oi
(
¬gv
[1]);

286 ià(
£rv”
.
dbnum
 < 1) {

287 
”r
 = "Inv®id‚umb” oàd©aba£s"; 
lßd”r
;

289 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"šşude"è&& 
¬gc
 == 2) {

290 
	`lßdS”v”CÚfig
(
¬gv
[1],
NULL
);

291 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"maxş›Ás"è&& 
¬gc
 == 2) {

292 
£rv”
.
maxş›Ás
 = 
	`©oi
(
¬gv
[1]);

293 ià(
£rv”
.
maxş›Ás
 < 1) {

294 
”r
 = "Inv®id max cl›Á lim™"; 
lßd”r
;

296 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"maxmemÜy"è&& 
¬gc
 == 2) {

297 
£rv”
.
maxmemÜy
 = 
	`memtŞl
(
¬gv
[1],
NULL
);

298 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"maxmemÜy-pŞicy"è&& 
¬gc
 == 2) {

299 
£rv”
.
maxmemÜy_pŞicy
 =

300 
	`cÚfigEnumG‘V®ue
(
maxmemÜy_pŞicy_’um
,
¬gv
[1]);

301 ià(
£rv”
.
maxmemÜy_pŞicy
 =ğ
INT_MIN
) {

302 
”r
 = "Invalid maxmemory…olicy";

303 
lßd”r
;

305 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"maxmemÜy-§m¶es"è&& 
¬gc
 == 2) {

306 
£rv”
.
maxmemÜy_§m¶es
 = 
	`©oi
(
¬gv
[1]);

307 ià(
£rv”
.
maxmemÜy_§m¶es
 <= 0) {

308 
”r
 = "maxmemory-samples must be 1 or greater";

309 
lßd”r
;

311 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"¦aveof"è&& 
¬gc
 == 3) {

312 
¦aveof_lš’um
 = 
lš’um
;

313 
£rv”
.
ma¡”ho¡
 = 
	`sd¢ew
(
¬gv
[1]);

314 
£rv”
.
ma¡”pÜt
 = 
	`©oi
(
¬gv
[2]);

315 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_CONNECT
;

316 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"»¶-pšg-¦ave-³riod"è&& 
¬gc
 == 2) {

317 
£rv”
.
»¶_pšg_¦ave_³riod
 = 
	`©oi
(
¬gv
[1]);

318 ià(
£rv”
.
»¶_pšg_¦ave_³riod
 <= 0) {

319 
”r
 = "repl-ping-slave-period must be 1 or greater";

320 
lßd”r
;

322 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"»¶-timeout"è&& 
¬gc
 == 2) {

323 
£rv”
.
»¶_timeout
 = 
	`©oi
(
¬gv
[1]);

324 ià(
£rv”
.
»¶_timeout
 <= 0) {

325 
”r
 = "repl-timeout must be 1 or greater";

326 
lßd”r
;

328 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"»¶-di§bË-tı-nod–ay"è&& 
¬gc
==2) {

329 ià((
£rv”
.
»¶_di§bË_tı_nod–ay
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

330 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

332 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"»¶-diskËss-sync"è&& 
¬gc
==2) {

333 ià((
£rv”
.
»¶_diskËss_sync
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

334 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

336 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"»¶-diskËss-sync-d–ay"è&& 
¬gc
==2) {

337 
£rv”
.
»¶_diskËss_sync_d–ay
 = 
	`©oi
(
¬gv
[1]);

338 ià(
£rv”
.
»¶_diskËss_sync_d–ay
 < 0) {

339 
”r
 = "repl-diskless-sync-delay can't be‚egative";

340 
lßd”r
;

342 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"»¶-backlog-size"è&& 
¬gc
 == 2) {

343 
size
 = 
	`memtŞl
(
¬gv
[1],
NULL
);

344 ià(
size
 <= 0) {

345 
”r
 = "repl-backlog-size must be 1 or greater.";

346 
lßd”r
;

348 
	`»sizeR•liÿtiÚBacklog
(
size
);

349 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"»¶-backlog-‰l"è&& 
¬gc
 == 2) {

350 
£rv”
.
»¶_backlog_time_lim™
 = 
	`©oi
(
¬gv
[1]);

351 ià(
£rv”
.
»¶_backlog_time_lim™
 < 0) {

352 
”r
 = "repl-backlog-ttl can't be‚egative ";

353 
lßd”r
;

355 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"ma¡”auth"è&& 
¬gc
 == 2) {

356 
	`zä“
(
£rv”
.
ma¡”auth
);

357 
£rv”
.
ma¡”auth
 = 
	`z¡rdup
(
¬gv
[1]);

358 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"¦ave-£rve-¡®e-d©a"è&& 
¬gc
 == 2) {

359 ià((
£rv”
.
»¶_£rve_¡®e_d©a
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

360 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

362 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"¦ave-»ad-Úly"è&& 
¬gc
 == 2) {

363 ià((
£rv”
.
»¶_¦ave_ro
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

364 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

366 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"rdbcom´essiÚ"è&& 
¬gc
 == 2) {

367 ià((
£rv”
.
rdb_com´essiÚ
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

368 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

370 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"rdbchecksum"è&& 
¬gc
 == 2) {

371 ià((
£rv”
.
rdb_checksum
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

372 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

374 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"aùiv”ehashšg"è&& 
¬gc
 == 2) {

375 ià((
£rv”
.
aùiv”ehashšg
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

376 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

378 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"d«mÚize"è&& 
¬gc
 == 2) {

379 ià((
£rv”
.
d«mÚize
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

380 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

382 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"hz"è&& 
¬gc
 == 2) {

383 
£rv”
.
hz
 = 
	`©oi
(
¬gv
[1]);

384 ià(
£rv”
.
hz
 < 
CONFIG_MIN_HZ
) server.hz = CONFIG_MIN_HZ;

385 ià(
£rv”
.
hz
 > 
CONFIG_MAX_HZ
) server.hz = CONFIG_MAX_HZ;

386 #ifdeà
USE_PMDK


387 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"pmfe"è&& (
¬gc
 == 3)) {

388 
£rv”
.
pm_fe_·th
 = 
	`z¡rdup
(
¬gv
[1]);

389 
size
 = 
	`memtŞl
(
¬gv
[2],
NULL
);

390 ià(
size
 == 0) {

391 ià(
	`acûss
(
£rv”
.
pm_fe_·th
, 
F_OK
) != 0) {

392 
”r
 = "If…mfile size == 0…mfile mustƒxist…rioro "

393 "£rv” s¹"; 
lßd”r
;

395 } ià(
size
 < 
CONFIG_MIN_PM_FILE_SIZE
) {

396 
”r
 = "Inv®id…mfsize"; 
lßd”r
;

398 
£rv”
.
pm_fe_size
 = 
size
;

400 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"­³ndÚly"è&& 
¬gc
 == 2) {

401 
yes
;

403 ià((
yes
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

404 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

406 
£rv”
.
aof_¡©e
 = 
yes
 ? 
AOF_ON
 : 
AOF_OFF
;

407 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"­³ndf’ame"è&& 
¬gc
 == 2) {

408 ià(!
	`·thIsBa£Name
(
¬gv
[1])) {

409 
”r
 = "appendfilename can't be‡…ath, just‡ filename";

410 
lßd”r
;

412 
	`zä“
(
£rv”
.
aof_f’ame
);

413 
£rv”
.
aof_f’ame
 = 
	`z¡rdup
(
¬gv
[1]);

414 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"no-appendfsync-on-rewrite")

415 && 
¬gc
 == 2) {

416 ià((
£rv”
.
aof_no_fsync_Ú_»wr™e
ğ
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

417 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

419 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"­³ndfsync"è&& 
¬gc
 == 2) {

420 
£rv”
.
aof_fsync
 = 
	`cÚfigEnumG‘V®ue
(
aof_fsync_’um
,
¬gv
[1]);

421 ià(
£rv”
.
aof_fsync
 =ğ
INT_MIN
) {

422 
”r
 = "argument must be 'no', 'always' or 'everysec'";

423 
lßd”r
;

425 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"auto-aof-rewrite-percentage") &&

426 
¬gc
 == 2)

428 
£rv”
.
aof_»wr™e_³rc
 = 
	`©oi
(
¬gv
[1]);

429 ià(
£rv”
.
aof_»wr™e_³rc
 < 0) {

430 
”r
 = "Invalid‚egative…ercentage for AOF‡uto„ewrite";

431 
lßd”r
;

433 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"auto-aof-rewrite-min-size") &&

434 
¬gc
 == 2)

436 
£rv”
.
aof_»wr™e_mš_size
 = 
	`memtŞl
(
¬gv
[1],
NULL
);

437 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"aof-rewrite-incremental-fsync") &&

438 
¬gc
 == 2)

440 ià((
£rv”
.
aof_»wr™e_šüem’l_fsync
 =

441 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

442 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

444 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"aof-lßd-Œunÿ‹d"è&& 
¬gc
 == 2) {

445 ià((
£rv”
.
aof_lßd_Œunÿ‹d
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

446 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

448 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"»quœ•ass"è&& 
¬gc
 == 2) {

449 ià(
	`¡¾’
(
¬gv
[1]è> 
CONFIG_AUTHPASS_MAX_LEN
) {

450 
”r
 = "Password is†ongerhan CONFIG_AUTHPASS_MAX_LEN";

451 
lßd”r
;

453 
£rv”
.
»quœ•ass
 = 
	`z¡rdup
(
¬gv
[1]);

454 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"pidfe"è&& 
¬gc
 == 2) {

455 
	`zä“
(
£rv”
.
pidfe
);

456 
£rv”
.
pidfe
 = 
	`z¡rdup
(
¬gv
[1]);

457 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"dbf’ame"è&& 
¬gc
 == 2) {

458 ià(!
	`·thIsBa£Name
(
¬gv
[1])) {

459 
”r
 = "dbfilename can't be‡…ath, just‡ filename";

460 
lßd”r
;

462 
	`zä“
(
£rv”
.
rdb_f’ame
);

463 
£rv”
.
rdb_f’ame
 = 
	`z¡rdup
(
¬gv
[1]);

464 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"hash-max-zli¡-’Œ›s"è&& 
¬gc
 == 2) {

465 
£rv”
.
hash_max_zli¡_’Œ›s
 = 
	`memtŞl
(
¬gv
[1], 
NULL
);

466 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"hash-max-zli¡-v®ue"è&& 
¬gc
 == 2) {

467 
£rv”
.
hash_max_zli¡_v®ue
 = 
	`memtŞl
(
¬gv
[1], 
NULL
);

468 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"li¡-max-zli¡-’Œ›s"è&& 
¬gc
 == 2){

470 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"li¡-max-zli¡-v®ue"è&& 
¬gc
 == 2) {

472 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"li¡-max-zli¡-size"è&& 
¬gc
 == 2) {

473 
£rv”
.
li¡_max_zli¡_size
 = 
	`©oi
(
¬gv
[1]);

474 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"li¡-com´ess-d•th"è&& 
¬gc
 == 2) {

475 
£rv”
.
li¡_com´ess_d•th
 = 
	`©oi
(
¬gv
[1]);

476 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"£t-max-št£t-’Œ›s"è&& 
¬gc
 == 2) {

477 
£rv”
.
£t_max_št£t_’Œ›s
 = 
	`memtŞl
(
¬gv
[1], 
NULL
);

478 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"z£t-max-zli¡-’Œ›s"è&& 
¬gc
 == 2) {

479 
£rv”
.
z£t_max_zli¡_’Œ›s
 = 
	`memtŞl
(
¬gv
[1], 
NULL
);

480 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"z£t-max-zli¡-v®ue"è&& 
¬gc
 == 2) {

481 
£rv”
.
z£t_max_zli¡_v®ue
 = 
	`memtŞl
(
¬gv
[1], 
NULL
);

482 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"hÎ-¥¬£-max-by‹s"è&& 
¬gc
 == 2) {

483 
£rv”
.
hÎ_¥¬£_max_by‹s
 = 
	`memtŞl
(
¬gv
[1], 
NULL
);

484 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"»Çme-commªd"è&& 
¬gc
 == 3) {

485 
»disCommªd
 *
cmd
 = 
	`lookupCommªd
(
¬gv
[1]);

486 
»tv®
;

488 ià(!
cmd
) {

489 
”r
 = "No such command in„ename-command";

490 
lßd”r
;

495 
»tv®
 = 
	`diùD–‘e
(
£rv”
.
commªds
, 
¬gv
[1]);

496 
	`£rv”As£¹
(
»tv®
 =ğ
DICT_OK
);

499 ià(
	`sd¦’
(
¬gv
[2]) != 0) {

500 
sds
 
cİy
 = 
	`sdsdup
(
¬gv
[2]);

502 
»tv®
 = 
	`diùAdd
(
£rv”
.
commªds
, 
cİy
, 
cmd
);

503 ià(
»tv®
 !ğ
DICT_OK
) {

504 
	`sdsä“
(
cİy
);

505 
”r
 = "T¬g‘ commªd‚am®»adyƒxi¡s"; 
lßd”r
;

508 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"şu¡”-’abËd"è&& 
¬gc
 == 2) {

509 ià((
£rv”
.
şu¡”_’abËd
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

510 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

512 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"şu¡”-cÚfig-fe"è&& 
¬gc
 == 2) {

513 
	`zä“
(
£rv”
.
şu¡”_cÚfigfe
);

514 
£rv”
.
şu¡”_cÚfigfe
 = 
	`z¡rdup
(
¬gv
[1]);

515 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"cluster-require-full-coverage") &&

516 
¬gc
 == 2)

518 ià((
£rv”
.
şu¡”_»quœe_fuÎ_cov”age
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1)

520 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

522 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"şu¡”-node-timeout"è&& 
¬gc
 == 2) {

523 
£rv”
.
şu¡”_node_timeout
 = 
	`¡¹Şl
(
¬gv
[1],
NULL
,10);

524 ià(
£rv”
.
şu¡”_node_timeout
 <= 0) {

525 
”r
 = "şu¡”‚odtimeouˆmu¡ b1 o¸g»©”"; 
lßd”r
;

527 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"cluster-migration-barrier")

528 && 
¬gc
 == 2)

530 
£rv”
.
şu¡”_mig¿tiÚ_b¬r›r
 = 
	`©oi
(
¬gv
[1]);

531 ià(
£rv”
.
şu¡”_mig¿tiÚ_b¬r›r
 < 0) {

532 
”r
 = "cluster migration barrier must zero or…ositive";

533 
lßd”r
;

535 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"cluster-slave-validity-factor")

536 && 
¬gc
 == 2)

538 
£rv”
.
şu¡”_¦ave_v®id™y_çùÜ
 = 
	`©oi
(
¬gv
[1]);

539 ià(
£rv”
.
şu¡”_¦ave_v®id™y_çùÜ
 < 0) {

540 
”r
 = "cluster slave validity factor must be zero or…ositive";

541 
lßd”r
;

543 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"lua-time-lim™"è&& 
¬gc
 == 2) {

544 
£rv”
.
lua_time_lim™
 = 
	`¡¹Şl
(
¬gv
[1],
NULL
,10);

545 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"slowlog-log-slower-than") &&

546 
¬gc
 == 2)

548 
£rv”
.
¦owlog_log_¦ow”_thª
 = 
	`¡¹Şl
(
¬gv
[1],
NULL
,10);

549 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"latency-monitor-threshold") &&

550 
¬gc
 == 2)

552 
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
 = 
	`¡¹Şl
(
¬gv
[1],
NULL
,10);

553 ià(
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
 < 0) {

554 
”r
 = "The†atencyhreshold can't be‚egative";

555 
lßd”r
;

557 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"¦owlog-max-Ën"è&& 
¬gc
 == 2) {

558 
£rv”
.
¦owlog_max_Ën
 = 
	`¡¹Şl
(
¬gv
[1],
NULL
,10);

559 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"client-output-buffer-limit") &&

560 
¬gc
 == 5)

562 
şass
 = 
	`g‘Cl›ÁTy³ByName
(
¬gv
[1]);

563 
h¬d
, 
soá
;

564 
soá_£cÚds
;

566 ià(
şass
 =ğ-1 || cÏs =ğ
CLIENT_TYPE_MASTER
) {

567 
”r
 = "Unrecognized client†imit class:he user specified "

569 
lßd”r
;

571 
h¬d
 = 
	`memtŞl
(
¬gv
[2],
NULL
);

572 
soá
 = 
	`memtŞl
(
¬gv
[3],
NULL
);

573 
soá_£cÚds
 = 
	`©oi
(
¬gv
[4]);

574 ià(
soá_£cÚds
 < 0) {

575 
”r
 = "Negative‚umber of seconds in soft†imit is invalid";

576 
lßd”r
;

578 
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
h¬d_lim™_by‹s
 = 
h¬d
;

579 
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
soá_lim™_by‹s
 = 
soá
;

580 
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
soá_lim™_£cÚds
 = 
soá_£cÚds
;

581 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"stop-writes-on-bgsave-error") &&

582 
¬gc
 == 2) {

583 ià((
£rv”
.
¡İ_wr™es_Ú_bg§ve_”r
 = 
	`ye¢Ùoi
(
¬gv
[1])) == -1) {

584 
”r
 = "¬gum’ˆmu¡ b'yes' o¸'no'"; 
lßd”r
;

586 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"¦ave-´iÜ™y"è&& 
¬gc
 == 2) {

587 
£rv”
.
¦ave_´iÜ™y
 = 
	`©oi
(
¬gv
[1]);

588 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"¦ave-ªnounû-"è&& 
¬gc
 == 2) {

589 
	`zä“
(
£rv”
.
¦ave_ªnounû_
);

590 
£rv”
.
¦ave_ªnounû_
 = 
	`z¡rdup
(
¬gv
[1]);

591 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"¦ave-ªnounû-pÜt"è&& 
¬gc
 == 2) {

592 
£rv”
.
¦ave_ªnounû_pÜt
 = 
	`©oi
(
¬gv
[1]);

593 ià(
£rv”
.
¦ave_ªnounû_pÜt
 < 0 ||

594 
£rv”
.
¦ave_ªnounû_pÜt
 > 65535)

596 
”r
 = "Inv®id…Üt"; 
lßd”r
;

598 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"mš-¦aves-to-wr™e"è&& 
¬gc
 == 2) {

599 
£rv”
.
»¶_mš_¦aves_to_wr™e
 = 
	`©oi
(
¬gv
[1]);

600 ià(
£rv”
.
»¶_mš_¦aves_to_wr™e
 < 0) {

601 
”r
 = "Inv®id v®ufÜ mš-¦aves-to-wr™e."; 
lßd”r
;

603 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"mš-¦aves-max-Ïg"è&& 
¬gc
 == 2) {

604 
£rv”
.
»¶_mš_¦aves_max_Ïg
 = 
	`©oi
(
¬gv
[1]);

605 ià(
£rv”
.
»¶_mš_¦aves_max_Ïg
 < 0) {

606 
”r
 = "Inv®id v®ufÜ mš-¦aves-max-Ïg."; 
lßd”r
;

608 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"nÙify-key¥aû-ev’ts"è&& 
¬gc
 == 2) {

609 
æags
 = 
	`key¥aûEv’tsSŒšgToFÏgs
(
¬gv
[1]);

611 ià(
æags
 == -1) {

612 
”r
 = "Invalidƒvent class character. Use 'g$lshzxeA'.";

613 
lßd”r
;

615 
£rv”
.
nÙify_key¥aû_ev’ts
 = 
æags
;

616 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"su³rvi£d"è&& 
¬gc
 == 2) {

617 
£rv”
.
su³rvi£d_mode
 =

618 
	`cÚfigEnumG‘V®ue
(
su³rvi£d_mode_’um
,
¬gv
[1]);

620 ià(
£rv”
.
su³rvi£d_mode
 =ğ
INT_MIN
) {

621 
”r
 = "Invalid option for 'supervised'. "

623 
lßd”r
;

625 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"sentinel")) {

628 ià(
¬gc
 != 1) {

629 ià(!
£rv”
.
£Áš–_mode
) {

630 
”r
 = "sentinel directive while‚ot in sentinel mode";

631 
lßd”r
;

633 
”r
 = 
	`£Áš–HªdËCÚfigu¿tiÚ
(
¬gv
+1,
¬gc
-1);

634 ià(
”r
è
lßd”r
;

637 
”r
 = "Bad dœeùivÜ wrÚg‚umb” oà¬gum’ts"; 
lßd”r
;

639 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

643 ià(
£rv”
.
şu¡”_’abËd
 && s”v”.
ma¡”ho¡
) {

644 
lš’um
 = 
¦aveof_lš’um
;

645 
i
 = 
lš’um
-1;

646 
”r
 = "slaveof directive‚ot‡llowed in cluster mode";

647 
lßd”r
;

650 
	`sdsä“¥l™»s
(
lšes
,
tÙlšes
);

653 
lßd”r
:

654 
	`årštf
(
¡d”r
, "\n*** FATAL CONFIG FILE ERROR ***\n");

655 
	`årštf
(
¡d”r
, "R—dšghcÚfigu¿tiÚ fe,‡ˆlš%d\n", 
lš’um
);

656 
	`årštf
(
¡d”r
, ">>> '%s'\n", 
lšes
[
i
]);

657 
	`årštf
(
¡d”r
, "%s\n", 
”r
);

658 
	`ex™
(1);

659 
	}
}

668 
	$lßdS”v”CÚfig
(*
f’ame
, *
İtiÚs
) {

669 
sds
 
cÚfig
 = 
	`sd£m±y
();

670 
buf
[
CONFIG_MAX_LINE
+1];

673 ià(
f’ame
) {

674 
FILE
 *
å
;

676 ià(
f’ame
[0] == '-' && filename[1] == '\0') {

677 
å
 = 
¡dš
;

679 ià((
å
 = 
	`fİ’
(
f’ame
,"r")è=ğ
NULL
) {

680 
	`£rv”Log
(
LL_WARNING
,

681 "F©®ƒ¼Ü, cª'ˆİ’ cÚfig f'%s'", 
f’ame
);

682 
	`ex™
(1);

685 
	`fg‘s
(
buf
,
CONFIG_MAX_LINE
+1,
å
è!ğ
NULL
)

686 
cÚfig
 = 
	`sdsÿt
(cÚfig,
buf
);

687 ià(
å
 !ğ
¡dš
è
	`fşo£
(fp);

690 ià(
İtiÚs
) {

691 
cÚfig
 = 
	`sdsÿt
(config,"\n");

692 
cÚfig
 = 
	`sdsÿt
(cÚfig,
İtiÚs
);

694 
	`lßdS”v”CÚfigFromSŒšg
(
cÚfig
);

695 
	`sdsä“
(
cÚfig
);

696 
	}
}

702 
	#cÚfig_£t_boŞ_f›ld
(
_Çme
,
_v¬
) \

703 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,
_Çme
)) { \

704 
yn
 = 
	`ye¢Ùoi
(
o
->
±r
); \

705 ià(
yn
 =ğ-1è
badfmt
; \

706 
_v¬
 = 
yn
;

	)

708 
	#cÚfig_£t_num”iÿl_f›ld
(
_Çme
,
_v¬
,
mš
,
max
) \

709 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,
_Çme
)) { \

710 ià(
	`g‘LÚgLÚgFromObjeù
(
o
,&
Î
è=ğ
C_ERR
è
badfmt
; \

711 ià(
mš
 !ğ
LLONG_MIN
 && 
Î
 < mšè
badfmt
; \

712 ià(
max
 !ğ
LLONG_MAX
 && 
Î
 > maxè
badfmt
; \

713 
_v¬
 = 
Î
;

	)

715 
	#cÚfig_£t_memÜy_f›ld
(
_Çme
,
_v¬
) \

716 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,
_Çme
)) { \

717 
Î
 = 
	`memtŞl
(
o
->
±r
,&
”r
); \

718 ià(
”r
 || 
Î
 < 0è
badfmt
; \

719 
_v¬
 = 
Î
;

	)

721 
	#cÚfig_£t_’um_f›ld
(
_Çme
,
_v¬
,
_’umv¬
) \

722 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,
_Çme
)) { \

723 
’umv®
 = 
	`cÚfigEnumG‘V®ue
(
_’umv¬
,
o
->
±r
); \

724 ià(
’umv®
 =ğ
INT_MIN
è
badfmt
; \

725 
_v¬
 = 
’umv®
;

	)

727 
	#cÚfig_£t_¥ecŸl_f›ld
(
_Çme
) \

728 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,
_Çme
)è{

	)

730 
	#cÚfig_£t_–£
 } 

	)

732 
	$cÚfigS‘Commªd
(
ş›Á
 *
c
) {

733 
robj
 *
o
;

734 
Î
;

735 
”r
;

736 
	`£rv”As£¹W™hInfo
(
c
,c->
¬gv
[2],
	`sdsEncodedObjeù
(c->argv[2]));

737 
	`£rv”As£¹W™hInfo
(
c
,c->
¬gv
[3],
	`sdsEncodedObjeù
(c->argv[3]));

738 
o
 = 
c
->
¬gv
[3];

743 
	`cÚfig_£t_¥ecŸl_f›ld
("dbfilename") {

744 ià(!
	`·thIsBa£Name
(
o
->
±r
)) {

745 
	`addR•lyE¼Ü
(
c
, "dbfilename can't be‡…ath, just‡ filename");

748 
	`zä“
(
£rv”
.
rdb_f’ame
);

749 
£rv”
.
rdb_f’ame
 = 
	`z¡rdup
(
o
->
±r
);

750 } 
	`cÚfig_£t_¥ecŸl_f›ld
("requirepass") {

751 ià(
	`sd¦’
(
o
->
±r
è> 
CONFIG_AUTHPASS_MAX_LEN
è
badfmt
;

752 
	`zä“
(
£rv”
.
»quœ•ass
);

753 
£rv”
.
»quœ•ass
 = ((*)
o
->
±r
)[0] ? 
	`z¡rdup
(o->±rè: 
NULL
;

754 } 
	`cÚfig_£t_¥ecŸl_f›ld
("masterauth") {

755 
	`zä“
(
£rv”
.
ma¡”auth
);

756 
£rv”
.
ma¡”auth
 = ((*)
o
->
±r
)[0] ? 
	`z¡rdup
(o->±rè: 
NULL
;

757 } 
	`cÚfig_£t_¥ecŸl_f›ld
("maxclients") {

758 
Üig_v®ue
 = 
£rv”
.
maxş›Ás
;

760 ià(
	`g‘LÚgLÚgFromObjeù
(
o
,&
Î
è=ğ
C_ERR
 ||†È< 1è
badfmt
;

763 
£rv”
.
maxş›Ás
 = 
Î
;

764 ià(
Î
 > 
Üig_v®ue
) {

765 
	`adju¡O³nFesLim™
();

766 ià(
£rv”
.
maxş›Ás
 !ğ
Î
) {

767 
	`addR•lyE¼ÜFÜm©
(
c
,"Thİ”©šg sy¡em i nÙ‡bËØhªdËh¥ecif›d‚umb” oàş›Ás,ry w™h %d", 
£rv”
.
maxş›Ás
);

768 
£rv”
.
maxş›Ás
 = 
Üig_v®ue
;

771 ià((è
	`«G‘S‘Size
(
£rv”
.
–
) <

772 
£rv”
.
maxş›Ás
 + 
CONFIG_FDSET_INCR
)

774 ià(
	`«ResizeS‘Size
(
£rv”
.
–
,

775 
£rv”
.
maxş›Ás
 + 
CONFIG_FDSET_INCR
è=ğ
AE_ERR
)

777 
	`addR•lyE¼Ü
(
c
,"Theƒvent†oop API used by Redis is‚ot‡bleo handlehe specified‚umber of clients");

778 
£rv”
.
maxş›Ás
 = 
Üig_v®ue
;

783 } 
	`cÚfig_£t_¥ecŸl_f›ld
("appendonly") {

784 
’abË
 = 
	`ye¢Ùoi
(
o
->
±r
);

786 ià(
’abË
 =ğ-1è
badfmt
;

787 ià(
’abË
 =ğ0 && 
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
) {

788 
	`¡İAµ’dOÆy
();

789 } ià(
’abË
 && 
£rv”
.
aof_¡©e
 =ğ
AOF_OFF
) {

790 ià(
	`¡¬tAµ’dOÆy
(è=ğ
C_ERR
) {

791 
	`addR•lyE¼Ü
(
c
,

796 } 
	`cÚfig_£t_¥ecŸl_f›ld
("save") {

797 
vËn
, 
j
;

798 
sds
 *
v
 = 
	`sds¥l™Ën
(
o
->
±r
,
	`sd¦’
(o->±r)," ",1,&
vËn
);

803 ià(
vËn
 & 1) {

804 
	`sdsä“¥l™»s
(
v
,
vËn
);

805 
badfmt
;

807 
j
 = 0; j < 
vËn
; j++) {

808 *
•Œ
;

809 
v®
;

811 
v®
 = 
	`¡¹Şl
(
v
[
j
], &
•Œ
, 10);

812 ià(
•Œ
[0] != '\0' ||

813 ((
j
 & 1è=ğ0 && 
v®
 < 1) ||

814 ((
j
 & 1è=ğ1 && 
v®
 < 0)) {

815 
	`sdsä“¥l™»s
(
v
,
vËn
);

816 
badfmt
;

820 
	`»£tS”v”SaveP¬ams
();

821 
j
 = 0; j < 
vËn
; j += 2) {

822 
time_t
 
£cÚds
;

823 
chªges
;

825 
£cÚds
 = 
	`¡¹Şl
(
v
[
j
],
NULL
,10);

826 
chªges
 = 
	`¡¹Şl
(
v
[
j
+1],
NULL
,10);

827 
	`­³ndS”v”SaveP¬ams
(
£cÚds
, 
chªges
);

829 
	`sdsä“¥l™»s
(
v
,
vËn
);

830 } 
	`cÚfig_£t_¥ecŸl_f›ld
("dir") {

831 ià(
	`chdœ
((*)
o
->
±r
) == -1) {

832 
	`addR•lyE¼ÜFÜm©
(
c
,"Chªgšg dœeùÜy: %s", 
	`¡»¼Ü
(
”ºo
));

835 } 
	`cÚfig_£t_¥ecŸl_f›ld
("client-output-buffer-limit") {

836 
vËn
, 
j
;

837 
sds
 *
v
 = 
	`sds¥l™Ën
(
o
->
±r
,
	`sd¦’
(o->±r)," ",1,&
vËn
);

840 ià(
vËn
 % 4) {

841 
	`sdsä“¥l™»s
(
v
,
vËn
);

842 
badfmt
;

848 
j
 = 0; j < 
vËn
; j++) {

849 
v®
;

851 ià((
j
 % 4) == 0) {

852 
şass
 = 
	`g‘Cl›ÁTy³ByName
(
v
[
j
]);

853 ià(
şass
 =ğ-1 || cÏs =ğ
CLIENT_TYPE_MASTER
) {

854 
	`sdsä“¥l™»s
(
v
,
vËn
);

855 
badfmt
;

858 
v®
 = 
	`memtŞl
(
v
[
j
], &
”r
);

859 ià(
”r
 || 
v®
 < 0) {

860 
	`sdsä“¥l™»s
(
v
,
vËn
);

861 
badfmt
;

866 
j
 = 0; j < 
vËn
; j += 4) {

867 
şass
;

868 
h¬d
, 
soá
;

869 
soá_£cÚds
;

871 
şass
 = 
	`g‘Cl›ÁTy³ByName
(
v
[
j
]);

872 
h¬d
 = 
	`¡¹Şl
(
v
[
j
+1],
NULL
,10);

873 
soá
 = 
	`¡¹Şl
(
v
[
j
+2],
NULL
,10);

874 
soá_£cÚds
 = 
	`¡¹Şl
(
v
[
j
+3],
NULL
,10);

876 
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
h¬d_lim™_by‹s
 = 
h¬d
;

877 
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
soá_lim™_by‹s
 = 
soá
;

878 
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
soá_lim™_£cÚds
 = 
soá_£cÚds
;

880 
	`sdsä“¥l™»s
(
v
,
vËn
);

881 } 
	`cÚfig_£t_¥ecŸl_f›ld
("notify-keyspace-events") {

882 
æags
 = 
	`key¥aûEv’tsSŒšgToFÏgs
(
o
->
±r
);

884 ià(
æags
 =ğ-1è
badfmt
;

885 
£rv”
.
nÙify_key¥aû_ev’ts
 = 
æags
;

886 } 
	`cÚfig_£t_¥ecŸl_f›ld
("slave-announce-ip") {

887 
	`zä“
(
£rv”
.
¦ave_ªnounû_
);

888 
£rv”
.
¦ave_ªnounû_
 = ((*)
o
->
±r
)[0] ? 
	`z¡rdup
(o->±rè: 
NULL
;

892 } 
	`cÚfig_£t_boŞ_f›ld
(

893 "rdbcom´essiÚ", 
£rv”
.
rdb_com´essiÚ
) {

894 } 
	`cÚfig_£t_boŞ_f›ld
(

895 "»¶-di§bË-tı-nod–ay",
£rv”
.
»¶_di§bË_tı_nod–ay
) {

896 } 
	`cÚfig_£t_boŞ_f›ld
(

897 "»¶-diskËss-sync",
£rv”
.
»¶_diskËss_sync
) {

898 } 
	`cÚfig_£t_boŞ_f›ld
(

899 "şu¡”-»quœe-fuÎ-cov”age",
£rv”
.
şu¡”_»quœe_fuÎ_cov”age
) {

900 } 
	`cÚfig_£t_boŞ_f›ld
(

901 "aof-»wr™e-šüem’l-fsync",
£rv”
.
aof_»wr™e_šüem’l_fsync
) {

902 } 
	`cÚfig_£t_boŞ_f›ld
(

903 "aof-lßd-Œunÿ‹d",
£rv”
.
aof_lßd_Œunÿ‹d
) {

904 } 
	`cÚfig_£t_boŞ_f›ld
(

905 "¦ave-£rve-¡®e-d©a",
£rv”
.
»¶_£rve_¡®e_d©a
) {

906 } 
	`cÚfig_£t_boŞ_f›ld
(

907 "¦ave-»ad-Úly",
£rv”
.
»¶_¦ave_ro
) {

908 } 
	`cÚfig_£t_boŞ_f›ld
(

909 "aùiv”ehashšg",
£rv”
.
aùiv”ehashšg
) {

910 } 
	`cÚfig_£t_boŞ_f›ld
(

911 "´Ùeùed-mode",
£rv”
.
´Ùeùed_mode
) {

912 } 
	`cÚfig_£t_boŞ_f›ld
(

913 "¡İ-wr™es-Ú-bg§ve-”rÜ",
£rv”
.
¡İ_wr™es_Ú_bg§ve_”r
) {

914 } 
	`cÚfig_£t_boŞ_f›ld
(

915 "no-­³ndfsync-Ú-»wr™e",
£rv”
.
aof_no_fsync_Ú_»wr™e
) {

919 } 
	`cÚfig_£t_num”iÿl_f›ld
(

920 "tı-k“·live",
£rv”
.
tık“·live
,0,
LLONG_MAX
) {

921 } 
	`cÚfig_£t_num”iÿl_f›ld
(

922 "maxmemÜy-§m¶es",
£rv”
.
maxmemÜy_§m¶es
,1,
LLONG_MAX
) {

923 } 
	`cÚfig_£t_num”iÿl_f›ld
(

924 "timeout",
£rv”
.
maxidËtime
,0,
LONG_MAX
) {

925 } 
	`cÚfig_£t_num”iÿl_f›ld
(

926 "auto-aof-»wr™e-³rûÁage",
£rv”
.
aof_»wr™e_³rc
,0,
LLONG_MAX
){

927 } 
	`cÚfig_£t_num”iÿl_f›ld
(

928 "auto-aof-»wr™e-mš-size",
£rv”
.
aof_»wr™e_mš_size
,0,
LLONG_MAX
) {

929 } 
	`cÚfig_£t_num”iÿl_f›ld
(

930 "hash-max-zli¡-’Œ›s",
£rv”
.
hash_max_zli¡_’Œ›s
,0,
LLONG_MAX
) {

931 } 
	`cÚfig_£t_num”iÿl_f›ld
(

932 "hash-max-zli¡-v®ue",
£rv”
.
hash_max_zli¡_v®ue
,0,
LLONG_MAX
) {

933 } 
	`cÚfig_£t_num”iÿl_f›ld
(

934 "li¡-max-zli¡-size",
£rv”
.
li¡_max_zli¡_size
,
INT_MIN
,
INT_MAX
) {

935 } 
	`cÚfig_£t_num”iÿl_f›ld
(

936 "li¡-com´ess-d•th",
£rv”
.
li¡_com´ess_d•th
,0,
INT_MAX
) {

937 } 
	`cÚfig_£t_num”iÿl_f›ld
(

938 "£t-max-št£t-’Œ›s",
£rv”
.
£t_max_št£t_’Œ›s
,0,
LLONG_MAX
) {

939 } 
	`cÚfig_£t_num”iÿl_f›ld
(

940 "z£t-max-zli¡-’Œ›s",
£rv”
.
z£t_max_zli¡_’Œ›s
,0,
LLONG_MAX
) {

941 } 
	`cÚfig_£t_num”iÿl_f›ld
(

942 "z£t-max-zli¡-v®ue",
£rv”
.
z£t_max_zli¡_v®ue
,0,
LLONG_MAX
) {

943 } 
	`cÚfig_£t_num”iÿl_f›ld
(

944 "hÎ-¥¬£-max-by‹s",
£rv”
.
hÎ_¥¬£_max_by‹s
,0,
LLONG_MAX
) {

945 } 
	`cÚfig_£t_num”iÿl_f›ld
(

946 "lua-time-lim™",
£rv”
.
lua_time_lim™
,0,
LLONG_MAX
) {

947 } 
	`cÚfig_£t_num”iÿl_f›ld
(

948 "¦owlog-log-¦ow”-thª",
£rv”
.
¦owlog_log_¦ow”_thª
,0,
LLONG_MAX
) {

949 } 
	`cÚfig_£t_num”iÿl_f›ld
(

950 "¦owlog-max-Ën",
Î
,0,
LLONG_MAX
) {

952 
£rv”
.
¦owlog_max_Ën
 = ()
Î
;

953 } 
	`cÚfig_£t_num”iÿl_f›ld
(

954 "Ï‹ncy-mÚ™Ü-th»shŞd",
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
,0,
LLONG_MAX
){

955 } 
	`cÚfig_£t_num”iÿl_f›ld
(

956 "»¶-pšg-¦ave-³riod",
£rv”
.
»¶_pšg_¦ave_³riod
,1,
LLONG_MAX
) {

957 } 
	`cÚfig_£t_num”iÿl_f›ld
(

958 "»¶-timeout",
£rv”
.
»¶_timeout
,1,
LLONG_MAX
) {

959 } 
	`cÚfig_£t_num”iÿl_f›ld
(

960 "»¶-backlog-‰l",
£rv”
.
»¶_backlog_time_lim™
,0,
LLONG_MAX
) {

961 } 
	`cÚfig_£t_num”iÿl_f›ld
(

962 "»¶-diskËss-sync-d–ay",
£rv”
.
»¶_diskËss_sync_d–ay
,0,
LLONG_MAX
) {

963 } 
	`cÚfig_£t_num”iÿl_f›ld
(

964 "¦ave-´iÜ™y",
£rv”
.
¦ave_´iÜ™y
,0,
LLONG_MAX
) {

965 } 
	`cÚfig_£t_num”iÿl_f›ld
(

966 "¦ave-ªnounû-pÜt",
£rv”
.
¦ave_ªnounû_pÜt
,0,65535) {

967 } 
	`cÚfig_£t_num”iÿl_f›ld
(

968 "mš-¦aves-to-wr™e",
£rv”
.
»¶_mš_¦aves_to_wr™e
,0,
LLONG_MAX
) {

969 
	`»äeshGoodSÏvesCouÁ
();

970 } 
	`cÚfig_£t_num”iÿl_f›ld
(

971 "mš-¦aves-max-Ïg",
£rv”
.
»¶_mš_¦aves_max_Ïg
,0,
LLONG_MAX
) {

972 
	`»äeshGoodSÏvesCouÁ
();

973 } 
	`cÚfig_£t_num”iÿl_f›ld
(

974 "şu¡”-node-timeout",
£rv”
.
şu¡”_node_timeout
,0,
LLONG_MAX
) {

975 } 
	`cÚfig_£t_num”iÿl_f›ld
(

976 "şu¡”-mig¿tiÚ-b¬r›r",
£rv”
.
şu¡”_mig¿tiÚ_b¬r›r
,0,
LLONG_MAX
){

977 } 
	`cÚfig_£t_num”iÿl_f›ld
(

978 "şu¡”-¦ave-v®id™y-çùÜ",
£rv”
.
şu¡”_¦ave_v®id™y_çùÜ
,0,
LLONG_MAX
) {

979 } 
	`cÚfig_£t_num”iÿl_f›ld
(

980 "hz",
£rv”
.
hz
,0,
LLONG_MAX
) {

983 ià(
£rv”
.
hz
 < 
CONFIG_MIN_HZ
) server.hz = CONFIG_MIN_HZ;

984 ià(
£rv”
.
hz
 > 
CONFIG_MAX_HZ
) server.hz = CONFIG_MAX_HZ;

985 } 
	`cÚfig_£t_num”iÿl_f›ld
(

986 "w©chdog-³riod",
Î
,0,
LLONG_MAX
) {

987 ià(
Î
)

988 
	`’abËW©chdog
(
Î
);

990 
	`di§bËW©chdog
();

994 } 
	`cÚfig_£t_memÜy_f›ld
("maxmemÜy",
£rv”
.
maxmemÜy
) {

995 ià(
£rv”
.
maxmemÜy
) {

996 ià(
£rv”
.
maxmemÜy
 < 
	`zm®loc_u£d_memÜy
()) {

997 
	`£rv”Log
(
LL_WARNING
,"WARNING:he‚ew maxmemory value set via CONFIG SET is smallerhanhe current memory usage. This will„esult in keysƒviction‡nd/or inabilityo‡ccept‚ew write commands depending onhe maxmemory-policy.");

999 
	`ä“MemÜyIfN“ded
();

1001 } 
	`cÚfig_£t_memÜy_f›ld
("»¶-backlog-size",
Î
) {

1002 
	`»sizeR•liÿtiÚBacklog
(
Î
);

1006 } 
	`cÚfig_£t_’um_f›ld
(

1007 "logËv–",
£rv”
.
v”bos™y
,
logËv–_’um
) {

1008 } 
	`cÚfig_£t_’um_f›ld
(

1009 "maxmemÜy-pŞicy",
£rv”
.
maxmemÜy_pŞicy
,
maxmemÜy_pŞicy_’um
) {

1010 } 
	`cÚfig_£t_’um_f›ld
(

1011 "­³ndfsync",
£rv”
.
aof_fsync
,
aof_fsync_’um
) {

1014 } 
cÚfig_£t_–£
 {

1015 
	`addR•lyE¼ÜFÜm©
(
c
,"Unsupported CONFIG…arameter: %s",

1016 (*)
c
->
¬gv
[2]->
±r
);

1021 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1024 
badfmt
:

1025 
	`addR•lyE¼ÜFÜm©
(
c
,"Invalid‡rgument '%s' for CONFIG SET '%s'",

1026 (*)
o
->
±r
,

1027 (*)
c
->
¬gv
[2]->
±r
);

1034 
	#cÚfig_g‘_¡ršg_f›ld
(
_Çme
,
_v¬
) do { \

1035 ià(
	`¡ršgm©ch
(
·‰”n
,
_Çme
,1)) { \

1036 
	`addR•lyBulkCSŒšg
(
c
,
_Çme
); \

1037 
	`addR•lyBulkCSŒšg
(
c
,
_v¬
 ? _var : ""); \

1038 
m©ches
++; \

1040 } 0);

	)

1042 
	#cÚfig_g‘_boŞ_f›ld
(
_Çme
,
_v¬
) do { \

1043 ià(
	`¡ršgm©ch
(
·‰”n
,
_Çme
,1)) { \

1044 
	`addR•lyBulkCSŒšg
(
c
,
_Çme
); \

1045 
	`addR•lyBulkCSŒšg
(
c
,
_v¬
 ? "yes" : "no"); \

1046 
m©ches
++; \

1048 } 0);

	)

1050 
	#cÚfig_g‘_num”iÿl_f›ld
(
_Çme
,
_v¬
) do { \

1051 ià(
	`¡ršgm©ch
(
·‰”n
,
_Çme
,1)) { \

1052 
	`Î2¡ršg
(
buf
,(buf),
_v¬
); \

1053 
	`addR•lyBulkCSŒšg
(
c
,
_Çme
); \

1054 
	`addR•lyBulkCSŒšg
(
c
,
buf
); \

1055 
m©ches
++; \

1057 } 0);

	)

1059 
	#cÚfig_g‘_’um_f›ld
(
_Çme
,
_v¬
,
_’umv¬
) do { \

1060 ià(
	`¡ršgm©ch
(
·‰”n
,
_Çme
,1)) { \

1061 
	`addR•lyBulkCSŒšg
(
c
,
_Çme
); \

1062 
	`addR•lyBulkCSŒšg
(
c
,
	`cÚfigEnumG‘NameOrUnknown
(
_’umv¬
,
_v¬
)); \

1063 
m©ches
++; \

1065 } 0);

	)

1067 
	`cÚfigG‘Commªd
(
ş›Á
 *
c
) {

1068 
robj
 *
o
 = 
c
->
¬gv
[2];

1069 *
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

1070 *
·‰”n
 = 
o
->
±r
;

1071 
buf
[128];

1072 
m©ches
 = 0;

1073 
	`£rv”As£¹W™hInfo
(
c
,
o
,
	`sdsEncodedObjeù
(o));

1076 
	`cÚfig_g‘_¡ršg_f›ld
("dbf’ame",
£rv”
.
rdb_f’ame
);

1077 
	`cÚfig_g‘_¡ršg_f›ld
("»quœ•ass",
£rv”
.
»quœ•ass
);

1078 
	`cÚfig_g‘_¡ršg_f›ld
("ma¡”auth",
£rv”
.
ma¡”auth
);

1079 
	`cÚfig_g‘_¡ršg_f›ld
("unixsock‘",
£rv”
.
unixsock‘
);

1080 
	`cÚfig_g‘_¡ršg_f›ld
("logfe",
£rv”
.
logfe
);

1081 
	`cÚfig_g‘_¡ršg_f›ld
("pidfe",
£rv”
.
pidfe
);

1082 
	`cÚfig_g‘_¡ršg_f›ld
("¦ave-ªnounû-",
£rv”
.
¦ave_ªnounû_
);

1085 
	`cÚfig_g‘_num”iÿl_f›ld
("maxmemÜy",
£rv”
.
maxmemÜy
);

1086 
	`cÚfig_g‘_num”iÿl_f›ld
("maxmemÜy-§m¶es",
£rv”
.
maxmemÜy_§m¶es
);

1087 
	`cÚfig_g‘_num”iÿl_f›ld
("timeout",
£rv”
.
maxidËtime
);

1088 
	`cÚfig_g‘_num”iÿl_f›ld
("auto-aof-rewrite-percentage",

1089 
£rv”
.
aof_»wr™e_³rc
);

1090 
	`cÚfig_g‘_num”iÿl_f›ld
("auto-aof-rewrite-min-size",

1091 
£rv”
.
aof_»wr™e_mš_size
);

1092 
	`cÚfig_g‘_num”iÿl_f›ld
("hash-max-ziplist-entries",

1093 
£rv”
.
hash_max_zli¡_’Œ›s
);

1094 
	`cÚfig_g‘_num”iÿl_f›ld
("hash-max-ziplist-value",

1095 
£rv”
.
hash_max_zli¡_v®ue
);

1096 
	`cÚfig_g‘_num”iÿl_f›ld
("list-max-ziplist-size",

1097 
£rv”
.
li¡_max_zli¡_size
);

1098 
	`cÚfig_g‘_num”iÿl_f›ld
("list-compress-depth",

1099 
£rv”
.
li¡_com´ess_d•th
);

1100 
	`cÚfig_g‘_num”iÿl_f›ld
("set-max-intset-entries",

1101 
£rv”
.
£t_max_št£t_’Œ›s
);

1102 
	`cÚfig_g‘_num”iÿl_f›ld
("zset-max-ziplist-entries",

1103 
£rv”
.
z£t_max_zli¡_’Œ›s
);

1104 
	`cÚfig_g‘_num”iÿl_f›ld
("zset-max-ziplist-value",

1105 
£rv”
.
z£t_max_zli¡_v®ue
);

1106 
	`cÚfig_g‘_num”iÿl_f›ld
("hll-sparse-max-bytes",

1107 
£rv”
.
hÎ_¥¬£_max_by‹s
);

1108 
	`cÚfig_g‘_num”iÿl_f›ld
("lua-time-lim™",
£rv”
.
lua_time_lim™
);

1109 
	`cÚfig_g‘_num”iÿl_f›ld
("slowlog-log-slower-than",

1110 
£rv”
.
¦owlog_log_¦ow”_thª
);

1111 
	`cÚfig_g‘_num”iÿl_f›ld
("latency-monitor-threshold",

1112 
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
);

1113 
	`cÚfig_g‘_num”iÿl_f›ld
("slowlog-max-len",

1114 
£rv”
.
¦owlog_max_Ën
);

1115 
	`cÚfig_g‘_num”iÿl_f›ld
("pÜt",
£rv”
.
pÜt
);

1116 
	`cÚfig_g‘_num”iÿl_f›ld
("tı-backlog",
£rv”
.
tı_backlog
);

1117 
	`cÚfig_g‘_num”iÿl_f›ld
("d©aba£s",
£rv”
.
dbnum
);

1118 
	`cÚfig_g‘_num”iÿl_f›ld
("»¶-pšg-¦ave-³riod",
£rv”
.
»¶_pšg_¦ave_³riod
);

1119 
	`cÚfig_g‘_num”iÿl_f›ld
("»¶-timeout",
£rv”
.
»¶_timeout
);

1120 
	`cÚfig_g‘_num”iÿl_f›ld
("»¶-backlog-size",
£rv”
.
»¶_backlog_size
);

1121 
	`cÚfig_g‘_num”iÿl_f›ld
("»¶-backlog-‰l",
£rv”
.
»¶_backlog_time_lim™
);

1122 
	`cÚfig_g‘_num”iÿl_f›ld
("maxş›Ás",
£rv”
.
maxş›Ás
);

1123 
	`cÚfig_g‘_num”iÿl_f›ld
("w©chdog-³riod",
£rv”
.
w©chdog_³riod
);

1124 
	`cÚfig_g‘_num”iÿl_f›ld
("¦ave-´iÜ™y",
£rv”
.
¦ave_´iÜ™y
);

1125 
	`cÚfig_g‘_num”iÿl_f›ld
("¦ave-ªnounû-pÜt",
£rv”
.
¦ave_ªnounû_pÜt
);

1126 
	`cÚfig_g‘_num”iÿl_f›ld
("mš-¦aves-to-wr™e",
£rv”
.
»¶_mš_¦aves_to_wr™e
);

1127 
	`cÚfig_g‘_num”iÿl_f›ld
("mš-¦aves-max-Ïg",
£rv”
.
»¶_mš_¦aves_max_Ïg
);

1128 
	`cÚfig_g‘_num”iÿl_f›ld
("hz",
£rv”
.
hz
);

1129 
	`cÚfig_g‘_num”iÿl_f›ld
("şu¡”-node-timeout",
£rv”
.
şu¡”_node_timeout
);

1130 
	`cÚfig_g‘_num”iÿl_f›ld
("şu¡”-mig¿tiÚ-b¬r›r",
£rv”
.
şu¡”_mig¿tiÚ_b¬r›r
);

1131 
	`cÚfig_g‘_num”iÿl_f›ld
("şu¡”-¦ave-v®id™y-çùÜ",
£rv”
.
şu¡”_¦ave_v®id™y_çùÜ
);

1132 
	`cÚfig_g‘_num”iÿl_f›ld
("»¶-diskËss-sync-d–ay",
£rv”
.
»¶_diskËss_sync_d–ay
);

1133 
	`cÚfig_g‘_num”iÿl_f›ld
("tı-k“·live",
£rv”
.
tık“·live
);

1136 
	`cÚfig_g‘_boŞ_f›ld
("cluster-require-full-coverage",

1137 
£rv”
.
şu¡”_»quœe_fuÎ_cov”age
);

1138 
	`cÚfig_g‘_boŞ_f›ld
("no-appendfsync-on-rewrite",

1139 
£rv”
.
aof_no_fsync_Ú_»wr™e
);

1140 
	`cÚfig_g‘_boŞ_f›ld
("slave-serve-stale-data",

1141 
£rv”
.
»¶_£rve_¡®e_d©a
);

1142 
	`cÚfig_g‘_boŞ_f›ld
("slave-read-only",

1143 
£rv”
.
»¶_¦ave_ro
);

1144 
	`cÚfig_g‘_boŞ_f›ld
("stop-writes-on-bgsave-error",

1145 
£rv”
.
¡İ_wr™es_Ú_bg§ve_”r
);

1146 
	`cÚfig_g‘_boŞ_f›ld
("d«mÚize", 
£rv”
.
d«mÚize
);

1147 
	`cÚfig_g‘_boŞ_f›ld
("rdbcom´essiÚ", 
£rv”
.
rdb_com´essiÚ
);

1148 
	`cÚfig_g‘_boŞ_f›ld
("rdbchecksum", 
£rv”
.
rdb_checksum
);

1149 
	`cÚfig_g‘_boŞ_f›ld
("aùiv”ehashšg", 
£rv”
.
aùiv”ehashšg
);

1150 
	`cÚfig_g‘_boŞ_f›ld
("´Ùeùed-mode", 
£rv”
.
´Ùeùed_mode
);

1151 
	`cÚfig_g‘_boŞ_f›ld
("repl-disable-tcp-nodelay",

1152 
£rv”
.
»¶_di§bË_tı_nod–ay
);

1153 
	`cÚfig_g‘_boŞ_f›ld
("repl-diskless-sync",

1154 
£rv”
.
»¶_diskËss_sync
);

1155 
	`cÚfig_g‘_boŞ_f›ld
("aof-rewrite-incremental-fsync",

1156 
£rv”
.
aof_»wr™e_šüem’l_fsync
);

1157 
	`cÚfig_g‘_boŞ_f›ld
("aof-load-truncated",

1158 
£rv”
.
aof_lßd_Œunÿ‹d
);

1161 
	`cÚfig_g‘_’um_f›ld
("maxmemory-policy",

1162 
£rv”
.
maxmemÜy_pŞicy
,
maxmemÜy_pŞicy_’um
);

1163 
	`cÚfig_g‘_’um_f›ld
("loglevel",

1164 
£rv”
.
v”bos™y
,
logËv–_’um
);

1165 
	`cÚfig_g‘_’um_f›ld
("supervised",

1166 
£rv”
.
su³rvi£d_mode
,
su³rvi£d_mode_’um
);

1167 
	`cÚfig_g‘_’um_f›ld
("appendfsync",

1168 
£rv”
.
aof_fsync
,
aof_fsync_’um
);

1169 
	`cÚfig_g‘_’um_f›ld
("syslog-facility",

1170 
£rv”
.
sy¦og_çc™y
,
sy¦og_çc™y_’um
);

1174 ià(
	`¡ršgm©ch
(
·‰”n
,"appendonly",1)) {

1175 
	`addR•lyBulkCSŒšg
(
c
,"appendonly");

1176 
	`addR•lyBulkCSŒšg
(
c
,
£rv”
.
aof_¡©e
 =ğ
AOF_OFF
 ? "no" : "yes");

1177 
m©ches
++;

1179 ià(
	`¡ršgm©ch
(
·‰”n
,"dir",1)) {

1180 
buf
[1024];

1182 ià(
	`g‘cwd
(
buf
,(buf)è=ğ
NULL
)

1183 
buf
[0] = '\0';

1185 
	`addR•lyBulkCSŒšg
(
c
,"dir");

1186 
	`addR•lyBulkCSŒšg
(
c
,
buf
);

1187 
m©ches
++;

1189 ià(
	`¡ršgm©ch
(
·‰”n
,"save",1)) {

1190 
sds
 
buf
 = 
	`sd£m±y
();

1191 
j
;

1193 
j
 = 0; j < 
£rv”
.
§v•¬am¦’
; j++) {

1194 
buf
 = 
	`sdsÿrštf
(buf,"%jd %d",

1195 (
štmax_t
)
£rv”
.
§v•¬ams
[
j
].
£cÚds
,

1196 
£rv”
.
§v•¬ams
[
j
].
chªges
);

1197 ià(
j
 !ğ
£rv”
.
§v•¬am¦’
-1)

1198 
buf
 = 
	`sdsÿ’
(buf," ",1);

1200 
	`addR•lyBulkCSŒšg
(
c
,"save");

1201 
	`addR•lyBulkCSŒšg
(
c
,
buf
);

1202 
	`sdsä“
(
buf
);

1203 
m©ches
++;

1205 ià(
	`¡ršgm©ch
(
·‰”n
,"client-output-buffer-limit",1)) {

1206 
sds
 
buf
 = 
	`sd£m±y
();

1207 
j
;

1209 
j
 = 0; j < 
CLIENT_TYPE_OBUF_COUNT
; j++) {

1210 
buf
 = 
	`sdsÿrštf
(buf,"%s %llu %llu %ld",

1211 
	`g‘Cl›ÁTy³Name
(
j
),

1212 
£rv”
.
ş›Á_obuf_lim™s
[
j
].
h¬d_lim™_by‹s
,

1213 
£rv”
.
ş›Á_obuf_lim™s
[
j
].
soá_lim™_by‹s
,

1214 (è
£rv”
.
ş›Á_obuf_lim™s
[
j
].
soá_lim™_£cÚds
);

1215 ià(
j
 !ğ
CLIENT_TYPE_OBUF_COUNT
-1)

1216 
buf
 = 
	`sdsÿ’
(buf," ",1);

1218 
	`addR•lyBulkCSŒšg
(
c
,"client-output-buffer-limit");

1219 
	`addR•lyBulkCSŒšg
(
c
,
buf
);

1220 
	`sdsä“
(
buf
);

1221 
m©ches
++;

1223 ià(
	`¡ršgm©ch
(
·‰”n
,"unixsocketperm",1)) {

1224 
buf
[32];

1225 
	`¢´štf
(
buf
,(buf),"%o",
£rv”
.
unixsock‘³rm
);

1226 
	`addR•lyBulkCSŒšg
(
c
,"unixsocketperm");

1227 
	`addR•lyBulkCSŒšg
(
c
,
buf
);

1228 
m©ches
++;

1230 ià(
	`¡ršgm©ch
(
·‰”n
,"slaveof",1)) {

1231 
buf
[256];

1233 
	`addR•lyBulkCSŒšg
(
c
,"slaveof");

1234 ià(
£rv”
.
ma¡”ho¡
)

1235 
	`¢´štf
(
buf
,(buf),"%s %d",

1236 
£rv”
.
ma¡”ho¡
, s”v”.
ma¡”pÜt
);

1238 
buf
[0] = '\0';

1239 
	`addR•lyBulkCSŒšg
(
c
,
buf
);

1240 
m©ches
++;

1242 ià(
	`¡ršgm©ch
(
·‰”n
,"notify-keyspace-events",1)) {

1243 
robj
 *
æagsobj
 = 
	`ü—‹Objeù
(
OBJ_STRING
,

1244 
	`key¥aûEv’tsFÏgsToSŒšg
(
£rv”
.
nÙify_key¥aû_ev’ts
));

1246 
	`addR•lyBulkCSŒšg
(
c
,"notify-keyspace-events");

1247 
	`addR•lyBulk
(
c
,
æagsobj
);

1248 
	`deüRefCouÁ
(
æagsobj
);

1249 
m©ches
++;

1251 ià(
	`¡ršgm©ch
(
·‰”n
,"bind",1)) {

1252 
sds
 
aux
 = 
	`sdsjoš
(
£rv”
.
bšdaddr
,£rv”.
bšdaddr_couÁ
," ");

1254 
	`addR•lyBulkCSŒšg
(
c
,"bind");

1255 
	`addR•lyBulkCSŒšg
(
c
,
aux
);

1256 
	`sdsä“
(
aux
);

1257 
m©ches
++;

1259 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
»¶yËn
,
m©ches
*2);

1266 
	#REDIS_CONFIG_REWRITE_SIGNATURE
 "# G’”©ed by CONFIG REWRITE"

	)

1271 
	`diùSdsCa£Hash
(cÚ¡ *
key
);

1272 
	`diùSdsKeyCa£Com·»
(*
´ivd©a
, cÚ¡ *
key1
, cÚ¡ *
key2
);

1273 
	`diùSdsDe¡ruùÜ
(*
´ivd©a
, *
v®
);

1274 
	`diùSdsDe¡ruùÜPM
(*
´ivd©a
, *
v®
);

1275 
	`diùLi¡De¡ruùÜ
(*
´ivd©a
, *
v®
);

1279 
	`»wr™eCÚfigS’tš–O±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
);

1281 
diùTy³
 
İtiÚToLšeDiùTy³
 = {

1282 
diùSdsCa£Hash
,

1283 
NULL
,

1284 
NULL
,

1285 
diùSdsKeyCa£Com·»
,

1286 
diùSdsDe¡ruùÜ
,

1287 
diùLi¡De¡ruùÜ


1290 
diùTy³
 
İtiÚS‘DiùTy³
 = {

1291 
diùSdsCa£Hash
,

1292 
NULL
,

1293 
NULL
,

1294 
diùSdsKeyCa£Com·»
,

1295 
diùSdsDe¡ruùÜ
,

1296 
NULL


1300 
	s»wr™eCÚfigS‹
 {

1301 
diù
 *
İtiÚ_to_lše
;

1302 
diù
 *
»wr™‹n
;

1303 
numlšes
;

1304 
sds
 *
lšes
;

1305 
has_
;

1310 
	`»wr™eCÚfigAµ’dLše
(
»wr™eCÚfigS‹
 *
¡©e
, 
sds
 
lše
) {

1311 
¡©e
->
lšes
 = 
	`z»®loc
(¡©e->lšes, (*è* (¡©e->
numlšes
+1));

1312 
¡©e
->
lšes
[¡©e->
numlšes
++] = 
lše
;

1316 
	`»wr™eCÚfigAddLšeNumb”ToO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
, 
sds
 
İtiÚ
, 
lš’um
) {

1317 
li¡
 *
l
 = 
	`diùF‘chV®ue
(
¡©e
->
İtiÚ_to_lše
,
İtiÚ
);

1319 ià(
l
 =ğ
NULL
) {

1320 
l
 = 
	`li¡C»©e
();

1321 
	`diùAdd
(
¡©e
->
İtiÚ_to_lše
,
	`sdsdup
(
İtiÚ
),
l
);

1323 
	`li¡AddNodeTa
(
l
,(*)()
lš’um
);

1330 
	`»wr™eCÚfigM¬kAsProûs£d
(
»wr™eCÚfigS‹
 *
¡©e
, cÚ¡ *
İtiÚ
) {

1331 
sds
 
İt
 = 
	`sd¢ew
(
İtiÚ
);

1333 ià(
	`diùAdd
(
¡©e
->
»wr™‹n
,
İt
,
NULL
è!ğ
DICT_OK
è
	`sdsä“
(opt);

1341 
»wr™eCÚfigS‹
 *
	`»wr™eCÚfigR—dOldFe
(*
·th
) {

1342 
FILE
 *
å
 = 
	`fİ’
(
·th
,"r");

1343 
»wr™eCÚfigS‹
 *
¡©e
 = 
	`zm®loc
((*state));

1344 
buf
[
CONFIG_MAX_LINE
+1];

1345 
lš’um
 = -1;

1347 ià(
å
 =ğ
NULL
 && 
”ºo
 !ğ
ENOENT
)  NULL;

1349 
¡©e
->
İtiÚ_to_lše
 = 
	`diùC»©e
(&
İtiÚToLšeDiùTy³
,
NULL
);

1350 
¡©e
->
»wr™‹n
 = 
	`diùC»©e
(&
İtiÚS‘DiùTy³
,
NULL
);

1351 
¡©e
->
numlšes
 = 0;

1352 
¡©e
->
lšes
 = 
NULL
;

1353 
¡©e
->
has_
 = 0;

1354 ià(
å
 =ğ
NULL
è 
¡©e
;

1357 
	`fg‘s
(
buf
,
CONFIG_MAX_LINE
+1,
å
è!ğ
NULL
) {

1358 
¬gc
;

1359 
sds
 *
¬gv
;

1360 
sds
 
lše
 = 
	`sd¡rim
(
	`sd¢ew
(
buf
),"\r\n\t ");

1362 
lš’um
++;

1365 ià(
lše
[0] == '#' ||†ine[0] == '\0') {

1366 ià(!
¡©e
->
has_
 && !
	`¡rcmp
(
lše
,
REDIS_CONFIG_REWRITE_SIGNATURE
))

1367 
¡©e
->
has_
 = 1;

1368 
	`»wr™eCÚfigAµ’dLše
(
¡©e
,
lše
);

1373 
¬gv
 = 
	`sds¥l™¬gs
(
lše
,&
¬gc
);

1374 ià(
¬gv
 =ğ
NULL
) {

1378 
sds
 
aux
 = 
	`sd¢ew
("# ??? ");

1379 
aux
 = 
	`sdsÿtsds
×ux,
lše
);

1380 
	`sdsä“
(
lše
);

1381 
	`»wr™eCÚfigAµ’dLše
(
¡©e
,
aux
);

1385 
	`sd¡Şow”
(
¬gv
[0]);

1389 
	`»wr™eCÚfigAµ’dLše
(
¡©e
,
lše
);

1390 
	`»wr™eCÚfigAddLšeNumb”ToO±iÚ
(
¡©e
,
¬gv
[0],
lš’um
);

1392 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

1394 
	`fşo£
(
å
);

1395  
¡©e
;

1414 
	`»wr™eCÚfigRewr™eLše
(
»wr™eCÚfigS‹
 *
¡©e
, cÚ¡ *
İtiÚ
, 
sds
 
lše
, 
fÜû
) {

1415 
sds
 
o
 = 
	`sd¢ew
(
İtiÚ
);

1416 
li¡
 *
l
 = 
	`diùF‘chV®ue
(
¡©e
->
İtiÚ_to_lše
,
o
);

1418 
	`»wr™eCÚfigM¬kAsProûs£d
(
¡©e
,
İtiÚ
);

1420 ià(!
l
 && !
fÜû
) {

1422 
	`sdsä“
(
lše
);

1423 
	`sdsä“
(
o
);

1427 ià(
l
) {

1428 
li¡Node
 *
Ê
 = 
	`li¡Fœ¡
(
l
);

1429 
lš’um
 = (è
Ê
->
v®ue
;

1433 
	`li¡D–Node
(
l
,
Ê
);

1434 ià(
	`li¡L’gth
(
l
è=ğ0è
	`diùD–‘e
(
¡©e
->
İtiÚ_to_lše
,
o
);

1435 
	`sdsä“
(
¡©e
->
lšes
[
lš’um
]);

1436 
¡©e
->
lšes
[
lš’um
] = 
lše
;

1439 ià(!
¡©e
->
has_
) {

1440 
	`»wr™eCÚfigAµ’dLše
(
¡©e
,

1441 
	`sd¢ew
(
REDIS_CONFIG_REWRITE_SIGNATURE
));

1442 
¡©e
->
has_
 = 1;

1444 
	`»wr™eCÚfigAµ’dLše
(
¡©e
,
lše
);

1446 
	`sdsä“
(
o
);

1451 
	`»wr™eCÚfigFÜm©MemÜy
(*
buf
, 
size_t
 
Ën
, 
by‹s
) {

1452 
gb
 = 1024*1024*1024;

1453 
mb
 = 1024*1024;

1454 
kb
 = 1024;

1456 ià(
by‹s
 && (by‹ % 
gb
) == 0) {

1457  
	`¢´štf
(
buf
,
Ën
,"%Îdgb",
by‹s
/
gb
);

1458 } ià(
by‹s
 && (by‹ % 
mb
) == 0) {

1459  
	`¢´štf
(
buf
,
Ën
,"%Îdmb",
by‹s
/
mb
);

1460 } ià(
by‹s
 && (by‹ % 
kb
) == 0) {

1461  
	`¢´štf
(
buf
,
Ën
,"%Îdkb",
by‹s
/
kb
);

1463  
	`¢´štf
(
buf
,
Ën
,"%Îd",
by‹s
);

1468 
	`»wr™eCÚfigBy‹sO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
, *
İtiÚ
, 
v®ue
, 
defv®ue
) {

1469 
buf
[64];

1470 
fÜû
 = 
v®ue
 !ğ
defv®ue
;

1471 
sds
 
lše
;

1473 
	`»wr™eCÚfigFÜm©MemÜy
(
buf
,(buf),
v®ue
);

1474 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"% %s",
İtiÚ
,
buf
);

1475 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1479 
	`»wr™eCÚfigYesNoO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
, *
İtiÚ
, 
v®ue
, 
defv®ue
) {

1480 
fÜû
 = 
v®ue
 !ğ
defv®ue
;

1481 
sds
 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"% %s",
İtiÚ
,

1482 
v®ue
 ? "yes" : "no");

1484 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1488 
	`»wr™eCÚfigSŒšgO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
, *
İtiÚ
, *
v®ue
, *
defv®ue
) {

1489 
fÜû
 = 1;

1490 
sds
 
lše
;

1494 ià(
v®ue
 =ğ
NULL
) {

1495 
	`»wr™eCÚfigM¬kAsProûs£d
(
¡©e
,
İtiÚ
);

1500 ià(
defv®ue
 && 
	`¡rcmp
(
v®ue
,defv®ueè=ğ0è
fÜû
 = 0;

1502 
lše
 = 
	`sd¢ew
(
İtiÚ
);

1503 
lše
 = 
	`sdsÿ’
(line, " ", 1);

1504 
lše
 = 
	`sdsÿŒ•r
Öše, 
v®ue
, 
	`¡¾’
(value));

1506 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1510 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
, *
İtiÚ
, 
v®ue
, 
defv®ue
) {

1511 
fÜû
 = 
v®ue
 !ğ
defv®ue
;

1512 
sds
 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"% %Îd",
İtiÚ
,
v®ue
);

1514 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1518 
	`»wr™eCÚfigOù®O±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
, *
İtiÚ
, 
v®ue
, 
defv®ue
) {

1519 
fÜû
 = 
v®ue
 !ğ
defv®ue
;

1520 
sds
 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"% %o",
İtiÚ
,
v®ue
);

1522 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1528 
	`»wr™eCÚfigEnumO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
, *
İtiÚ
, 
v®ue
, 
cÚfigEnum
 *
û
, 
defv®
) {

1529 
sds
 
lše
;

1530 cÚ¡ *
Çme
 = 
	`cÚfigEnumG‘NameOrUnknown
(
û
,
v®ue
);

1531 
fÜû
 = 
v®ue
 !ğ
defv®
;

1533 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"% %s",
İtiÚ
,
Çme
);

1534 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1538 
	`»wr™eCÚfigSy¦ogçc™yO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
) {

1539 
v®ue
 = 
£rv”
.
sy¦og_çc™y
;

1540 
fÜû
 = 
v®ue
 !ğ
LOG_LOCAL0
;

1541 cÚ¡ *
Çme
 = 
NULL
, *
İtiÚ
 = "syslog-facility";

1542 
sds
 
lše
;

1544 
Çme
 = 
	`cÚfigEnumG‘NameOrUnknown
(
sy¦og_çc™y_’um
,
v®ue
);

1545 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"% %s",
İtiÚ
,
Çme
);

1546 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1550 
	`»wr™eCÚfigSaveO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
) {

1551 
j
;

1552 
sds
 
lše
;

1557 
j
 = 0; j < 
£rv”
.
§v•¬am¦’
; j++) {

1558 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"save %ld %d",

1559 (è
£rv”
.
§v•¬ams
[
j
].
£cÚds
, s”v”.§v•¬ams[j].
chªges
);

1560 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"§ve",
lše
,1);

1563 
	`»wr™eCÚfigM¬kAsProûs£d
(
¡©e
,"save");

1567 
	`»wr™eCÚfigDœO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
) {

1568 
cwd
[1024];

1570 ià(
	`g‘cwd
(
cwd
,(cwd)è=ğ
NULL
) {

1571 
	`»wr™eCÚfigM¬kAsProûs£d
(
¡©e
,"dir");

1574 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"dœ",
cwd
,
NULL
);

1578 
	`»wr™eCÚfigSÏveofO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
) {

1579 *
İtiÚ
 = "slaveof";

1580 
sds
 
lše
;

1585 ià(
£rv”
.
şu¡”_’abËd
 || s”v”.
ma¡”ho¡
 =ğ
NULL
) {

1586 
	`»wr™eCÚfigM¬kAsProûs£d
(
¡©e
,"slaveof");

1589 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"% % %d", 
İtiÚ
,

1590 
£rv”
.
ma¡”ho¡
, s”v”.
ma¡”pÜt
);

1591 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,1);

1595 
	`»wr™eCÚfigNÙifykey¥aûev’tsO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
) {

1596 
fÜû
 = 
£rv”
.
nÙify_key¥aû_ev’ts
 != 0;

1597 *
İtiÚ
 = "notify-keyspace-events";

1598 
sds
 
lše
, 
æags
;

1600 
æags
 = 
	`key¥aûEv’tsFÏgsToSŒšg
(
£rv”
.
nÙify_key¥aû_ev’ts
);

1601 
lše
 = 
	`sd¢ew
(
İtiÚ
);

1602 
lše
 = 
	`sdsÿ’
(line, " ", 1);

1603 
lše
 = 
	`sdsÿŒ•r
Öše, 
æags
, 
	`sd¦’
(flags));

1604 
	`sdsä“
(
æags
);

1605 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1609 
	`»wr™eCÚfigCl›Áouutbufã¾im™O±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
) {

1610 
j
;

1611 *
İtiÚ
 = "client-output-buffer-limit";

1613 
j
 = 0; j < 
CLIENT_TYPE_OBUF_COUNT
; j++) {

1614 
fÜû
 = (
£rv”
.
ş›Á_obuf_lim™s
[
j
].
h¬d_lim™_by‹s
 !=

1615 
ş›ÁBufãrLim™sDeçuÉs
[
j
].
h¬d_lim™_by‹s
) ||

1616 (
£rv”
.
ş›Á_obuf_lim™s
[
j
].
soá_lim™_by‹s
 !=

1617 
ş›ÁBufãrLim™sDeçuÉs
[
j
].
soá_lim™_by‹s
) ||

1618 (
£rv”
.
ş›Á_obuf_lim™s
[
j
].
soá_lim™_£cÚds
 !=

1619 
ş›ÁBufãrLim™sDeçuÉs
[
j
].
soá_lim™_£cÚds
);

1620 
sds
 
lše
;

1621 
h¬d
[64], 
soá
[64];

1623 
	`»wr™eCÚfigFÜm©MemÜy
(
h¬d
,(hard),

1624 
£rv”
.
ş›Á_obuf_lim™s
[
j
].
h¬d_lim™_by‹s
);

1625 
	`»wr™eCÚfigFÜm©MemÜy
(
soá
,(soft),

1626 
£rv”
.
ş›Á_obuf_lim™s
[
j
].
soá_lim™_by‹s
);

1628 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"%s %s %s %s %ld",

1629 
İtiÚ
, 
	`g‘Cl›ÁTy³Name
(
j
), 
h¬d
, 
soá
,

1630 (è
£rv”
.
ş›Á_obuf_lim™s
[
j
].
soá_lim™_£cÚds
);

1631 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1636 
	`»wr™eCÚfigBšdO±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
) {

1637 
fÜû
 = 1;

1638 
sds
 
lše
, 
add»s£s
;

1639 *
İtiÚ
 = "bind";

1642 ià(
£rv”
.
bšdaddr_couÁ
 == 0) {

1643 
	`»wr™eCÚfigM¬kAsProûs£d
(
¡©e
,
İtiÚ
);

1648 
add»s£s
 = 
	`sdsjoš
(
£rv”
.
bšdaddr
,£rv”.
bšdaddr_couÁ
," ");

1649 
lše
 = 
	`sd¢ew
(
İtiÚ
);

1650 
lše
 = 
	`sdsÿ’
(line, " ", 1);

1651 
lše
 = 
	`sdsÿtsds
Öše, 
add»s£s
);

1652 
	`sdsä“
(
add»s£s
);

1654 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,
İtiÚ
,
lše
,
fÜû
);

1659 
sds
 
	`»wr™eCÚfigG‘CÚ‹ÁFromS‹
(
»wr™eCÚfigS‹
 *
¡©e
) {

1660 
sds
 
cÚ‹Á
 = 
	`sd£m±y
();

1661 
j
, 
was_em±y
 = 0;

1663 
j
 = 0; j < 
¡©e
->
numlšes
; j++) {

1665 ià(
	`sd¦’
(
¡©e
->
lšes
[
j
]) == 0) {

1666 ià(
was_em±y
) ;

1667 
was_em±y
 = 1;

1669 
was_em±y
 = 0;

1671 
cÚ‹Á
 = 
	`sdsÿtsds
(cÚ‹Á,
¡©e
->
lšes
[
j
]);

1672 
cÚ‹Á
 = 
	`sdsÿ’
(content,"\n",1);

1674  
cÚ‹Á
;

1678 
	`»wr™eCÚfigR–—£S‹
(
»wr™eCÚfigS‹
 *
¡©e
) {

1679 
	`sdsä“¥l™»s
(
¡©e
->
lšes
,¡©e->
numlšes
);

1680 
	`diùR–—£
(
¡©e
->
İtiÚ_to_lše
);

1681 
	`diùR–—£
(
¡©e
->
»wr™‹n
);

1682 
	`zä“
(
¡©e
);

1693 
	`»wr™eCÚfigRemoveO½hªed
(
»wr™eCÚfigS‹
 *
¡©e
) {

1694 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘I‹¿tÜ
(
¡©e
->
İtiÚ_to_lše
);

1695 
diùEÁry
 *
de
;

1697 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1698 
li¡
 *
l
 = 
	`diùG‘V®
(
de
);

1699 
sds
 
İtiÚ
 = 
	`diùG‘Key
(
de
);

1703 ià(
	`diùFšd
(
¡©e
->
»wr™‹n
,
İtiÚ
è=ğ
NULL
) {

1704 
	`£rv”Log
(
LL_DEBUG
,"NÙ„ewr™‹ÀİtiÚ: %s", 
İtiÚ
);

1708 
	`li¡L’gth
(
l
)) {

1709 
li¡Node
 *
Ê
 = 
	`li¡Fœ¡
(
l
);

1710 
lš’um
 = (è
Ê
->
v®ue
;

1712 
	`sdsä“
(
¡©e
->
lšes
[
lš’um
]);

1713 
¡©e
->
lšes
[
lš’um
] = 
	`sd£m±y
();

1714 
	`li¡D–Node
(
l
,
Ê
);

1717 
	`diùR–—£I‹¿tÜ
(
di
);

1732 
	`»wr™eCÚfigOv”wr™eFe
(*
cÚfigfe
, 
sds
 
cÚ‹Á
) {

1733 
»tv®
 = 0;

1734 
fd
 = 
	`İ’
(
cÚfigfe
,
O_RDWR
|
O_CREAT
,0644);

1735 
cÚ‹Á_size
 = 
	`sd¦’
(
cÚ‹Á
), 
·ddšg
 = 0;

1736 
¡©
 
sb
;

1737 
sds
 
cÚ‹Á_·dded
;

1741 ià(
fd
 == -1)  -1;

1742 ià(
	`f¡©
(
fd
,&
sb
) == -1) {

1743 
	`şo£
(
fd
);

1748 
cÚ‹Á_·dded
 = 
	`sdsdup
(
cÚ‹Á
);

1749 ià(
cÚ‹Á_size
 < 
sb
.
¡_size
) {

1752 
·ddšg
 = 
sb
.
¡_size
 - 
cÚ‹Á_size
;

1753 
cÚ‹Á_·dded
 = 
	`sdsgrowz”o
(cÚ‹Á_·dded,
sb
.
¡_size
);

1754 
cÚ‹Á_·dded
[
cÚ‹Á_size
] = '\n';

1755 
	`mem£t
(
cÚ‹Á_·dded
+
cÚ‹Á_size
+1,'#',
·ddšg
-1);

1759 ià(
	`wr™e
(
fd
,
cÚ‹Á_·dded
,
	`¡¾’
(content_padded)) == -1) {

1760 
»tv®
 = -1;

1761 
ş—nup
;

1765 ià(
·ddšg
) {

1766 ià(
	`árunÿ‹
(
fd
,
cÚ‹Á_size
) == -1) {

1771 
ş—nup
:

1772 
	`sdsä“
(
cÚ‹Á_·dded
);

1773 
	`şo£
(
fd
);

1774  
»tv®
;

1785 
	`»wr™eCÚfig
(*
·th
) {

1786 
»wr™eCÚfigS‹
 *
¡©e
;

1787 
sds
 
ÃwcÚ‹Á
;

1788 
»tv®
;

1791 ià((
¡©e
 = 
	`»wr™eCÚfigR—dOldFe
(
·th
)è=ğ
NULL
)  -1;

1796 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"d«mÚize",
£rv”
.
d«mÚize
,0);

1797 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"pidfe",
£rv”
.
pidfe
,
CONFIG_DEFAULT_PID_FILE
);

1798 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"pÜt",
£rv”
.
pÜt
,
CONFIG_DEFAULT_SERVER_PORT
);

1799 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"tı-backlog",
£rv”
.
tı_backlog
,
CONFIG_DEFAULT_TCP_BACKLOG
);

1800 
	`»wr™eCÚfigBšdO±iÚ
(
¡©e
);

1801 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"unixsock‘",
£rv”
.
unixsock‘
,
NULL
);

1802 
	`»wr™eCÚfigOù®O±iÚ
(
¡©e
,"unixsock‘³rm",
£rv”
.
unixsock‘³rm
,
CONFIG_DEFAULT_UNIX_SOCKET_PERM
);

1803 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"timeout",
£rv”
.
maxidËtime
,
CONFIG_DEFAULT_CLIENT_TIMEOUT
);

1804 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"tı-k“·live",
£rv”
.
tık“·live
,
CONFIG_DEFAULT_TCP_KEEPALIVE
);

1805 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"¦ave-ªnounû-pÜt",
£rv”
.
¦ave_ªnounû_pÜt
,
CONFIG_DEFAULT_SLAVE_ANNOUNCE_PORT
);

1806 
	`»wr™eCÚfigEnumO±iÚ
(
¡©e
,"logËv–",
£rv”
.
v”bos™y
,
logËv–_’um
,
CONFIG_DEFAULT_VERBOSITY
);

1807 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"logfe",
£rv”
.
logfe
,
CONFIG_DEFAULT_LOGFILE
);

1808 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"sy¦og-’abËd",
£rv”
.
sy¦og_’abËd
,
CONFIG_DEFAULT_SYSLOG_ENABLED
);

1809 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"sy¦og-id’t",
£rv”
.
sy¦og_id’t
,
CONFIG_DEFAULT_SYSLOG_IDENT
);

1810 
	`»wr™eCÚfigSy¦ogçc™yO±iÚ
(
¡©e
);

1811 
	`»wr™eCÚfigSaveO±iÚ
(
¡©e
);

1812 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"d©aba£s",
£rv”
.
dbnum
,
CONFIG_DEFAULT_DBNUM
);

1813 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"¡İ-wr™es-Ú-bg§ve-”rÜ",
£rv”
.
¡İ_wr™es_Ú_bg§ve_”r
,
CONFIG_DEFAULT_STOP_WRITES_ON_BGSAVE_ERROR
);

1814 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"rdbcom´essiÚ",
£rv”
.
rdb_com´essiÚ
,
CONFIG_DEFAULT_RDB_COMPRESSION
);

1815 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"rdbchecksum",
£rv”
.
rdb_checksum
,
CONFIG_DEFAULT_RDB_CHECKSUM
);

1816 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"dbf’ame",
£rv”
.
rdb_f’ame
,
CONFIG_DEFAULT_RDB_FILENAME
);

1817 
	`»wr™eCÚfigDœO±iÚ
(
¡©e
);

1818 
	`»wr™eCÚfigSÏveofO±iÚ
(
¡©e
);

1819 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"¦ave-ªnounû-",
£rv”
.
¦ave_ªnounû_
,
CONFIG_DEFAULT_SLAVE_ANNOUNCE_IP
);

1820 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"ma¡”auth",
£rv”
.
ma¡”auth
,
NULL
);

1821 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"¦ave-£rve-¡®e-d©a",
£rv”
.
»¶_£rve_¡®e_d©a
,
CONFIG_DEFAULT_SLAVE_SERVE_STALE_DATA
);

1822 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"¦ave-»ad-Úly",
£rv”
.
»¶_¦ave_ro
,
CONFIG_DEFAULT_SLAVE_READ_ONLY
);

1823 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"»¶-pšg-¦ave-³riod",
£rv”
.
»¶_pšg_¦ave_³riod
,
CONFIG_DEFAULT_REPL_PING_SLAVE_PERIOD
);

1824 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"»¶-timeout",
£rv”
.
»¶_timeout
,
CONFIG_DEFAULT_REPL_TIMEOUT
);

1825 
	`»wr™eCÚfigBy‹sO±iÚ
(
¡©e
,"»¶-backlog-size",
£rv”
.
»¶_backlog_size
,
CONFIG_DEFAULT_REPL_BACKLOG_SIZE
);

1826 
	`»wr™eCÚfigBy‹sO±iÚ
(
¡©e
,"»¶-backlog-‰l",
£rv”
.
»¶_backlog_time_lim™
,
CONFIG_DEFAULT_REPL_BACKLOG_TIME_LIMIT
);

1827 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"»¶-di§bË-tı-nod–ay",
£rv”
.
»¶_di§bË_tı_nod–ay
,
CONFIG_DEFAULT_REPL_DISABLE_TCP_NODELAY
);

1828 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"»¶-diskËss-sync",
£rv”
.
»¶_diskËss_sync
,
CONFIG_DEFAULT_REPL_DISKLESS_SYNC
);

1829 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"»¶-diskËss-sync-d–ay",
£rv”
.
»¶_diskËss_sync_d–ay
,
CONFIG_DEFAULT_REPL_DISKLESS_SYNC_DELAY
);

1830 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"¦ave-´iÜ™y",
£rv”
.
¦ave_´iÜ™y
,
CONFIG_DEFAULT_SLAVE_PRIORITY
);

1831 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"mš-¦aves-to-wr™e",
£rv”
.
»¶_mš_¦aves_to_wr™e
,
CONFIG_DEFAULT_MIN_SLAVES_TO_WRITE
);

1832 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"mš-¦aves-max-Ïg",
£rv”
.
»¶_mš_¦aves_max_Ïg
,
CONFIG_DEFAULT_MIN_SLAVES_MAX_LAG
);

1833 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"»quœ•ass",
£rv”
.
»quœ•ass
,
NULL
);

1834 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"maxş›Ás",
£rv”
.
maxş›Ás
,
CONFIG_DEFAULT_MAX_CLIENTS
);

1835 
	`»wr™eCÚfigBy‹sO±iÚ
(
¡©e
,"maxmemÜy",
£rv”
.
maxmemÜy
,
CONFIG_DEFAULT_MAXMEMORY
);

1836 
	`»wr™eCÚfigEnumO±iÚ
(
¡©e
,"maxmemÜy-pŞicy",
£rv”
.
maxmemÜy_pŞicy
,
maxmemÜy_pŞicy_’um
,
CONFIG_DEFAULT_MAXMEMORY_POLICY
);

1837 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"maxmemÜy-§m¶es",
£rv”
.
maxmemÜy_§m¶es
,
CONFIG_DEFAULT_MAXMEMORY_SAMPLES
);

1838 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"­³ndÚly",
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
,0);

1839 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"­³ndf’ame",
£rv”
.
aof_f’ame
,
CONFIG_DEFAULT_AOF_FILENAME
);

1840 
	`»wr™eCÚfigEnumO±iÚ
(
¡©e
,"­³ndfsync",
£rv”
.
aof_fsync
,
aof_fsync_’um
,
CONFIG_DEFAULT_AOF_FSYNC
);

1841 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"no-­³ndfsync-Ú-»wr™e",
£rv”
.
aof_no_fsync_Ú_»wr™e
,
CONFIG_DEFAULT_AOF_NO_FSYNC_ON_REWRITE
);

1842 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"auto-aof-»wr™e-³rûÁage",
£rv”
.
aof_»wr™e_³rc
,
AOF_REWRITE_PERC
);

1843 
	`»wr™eCÚfigBy‹sO±iÚ
(
¡©e
,"auto-aof-»wr™e-mš-size",
£rv”
.
aof_»wr™e_mš_size
,
AOF_REWRITE_MIN_SIZE
);

1844 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"lua-time-lim™",
£rv”
.
lua_time_lim™
,
LUA_SCRIPT_TIME_LIMIT
);

1845 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"şu¡”-’abËd",
£rv”
.
şu¡”_’abËd
,0);

1846 
	`»wr™eCÚfigSŒšgO±iÚ
(
¡©e
,"şu¡”-cÚfig-fe",
£rv”
.
şu¡”_cÚfigfe
,
CONFIG_DEFAULT_CLUSTER_CONFIG_FILE
);

1847 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"şu¡”-»quœe-fuÎ-cov”age",
£rv”
.
şu¡”_»quœe_fuÎ_cov”age
,
CLUSTER_DEFAULT_REQUIRE_FULL_COVERAGE
);

1848 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"şu¡”-node-timeout",
£rv”
.
şu¡”_node_timeout
,
CLUSTER_DEFAULT_NODE_TIMEOUT
);

1849 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"şu¡”-mig¿tiÚ-b¬r›r",
£rv”
.
şu¡”_mig¿tiÚ_b¬r›r
,
CLUSTER_DEFAULT_MIGRATION_BARRIER
);

1850 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"şu¡”-¦ave-v®id™y-çùÜ",
£rv”
.
şu¡”_¦ave_v®id™y_çùÜ
,
CLUSTER_DEFAULT_SLAVE_VALIDITY
);

1851 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"¦owlog-log-¦ow”-thª",
£rv”
.
¦owlog_log_¦ow”_thª
,
CONFIG_DEFAULT_SLOWLOG_LOG_SLOWER_THAN
);

1852 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"Ï‹ncy-mÚ™Ü-th»shŞd",
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
,
CONFIG_DEFAULT_LATENCY_MONITOR_THRESHOLD
);

1853 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"¦owlog-max-Ën",
£rv”
.
¦owlog_max_Ën
,
CONFIG_DEFAULT_SLOWLOG_MAX_LEN
);

1854 
	`»wr™eCÚfigNÙifykey¥aûev’tsO±iÚ
(
¡©e
);

1855 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"hash-max-zli¡-’Œ›s",
£rv”
.
hash_max_zli¡_’Œ›s
,
OBJ_HASH_MAX_ZIPLIST_ENTRIES
);

1856 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"hash-max-zli¡-v®ue",
£rv”
.
hash_max_zli¡_v®ue
,
OBJ_HASH_MAX_ZIPLIST_VALUE
);

1857 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"li¡-max-zli¡-size",
£rv”
.
li¡_max_zli¡_size
,
OBJ_LIST_MAX_ZIPLIST_SIZE
);

1858 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"li¡-com´ess-d•th",
£rv”
.
li¡_com´ess_d•th
,
OBJ_LIST_COMPRESS_DEPTH
);

1859 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"£t-max-št£t-’Œ›s",
£rv”
.
£t_max_št£t_’Œ›s
,
OBJ_SET_MAX_INTSET_ENTRIES
);

1860 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"z£t-max-zli¡-’Œ›s",
£rv”
.
z£t_max_zli¡_’Œ›s
,
OBJ_ZSET_MAX_ZIPLIST_ENTRIES
);

1861 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"z£t-max-zli¡-v®ue",
£rv”
.
z£t_max_zli¡_v®ue
,
OBJ_ZSET_MAX_ZIPLIST_VALUE
);

1862 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"hÎ-¥¬£-max-by‹s",
£rv”
.
hÎ_¥¬£_max_by‹s
,
CONFIG_DEFAULT_HLL_SPARSE_MAX_BYTES
);

1863 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"aùiv”ehashšg",
£rv”
.
aùiv”ehashšg
,
CONFIG_DEFAULT_ACTIVE_REHASHING
);

1864 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"´Ùeùed-mode",
£rv”
.
´Ùeùed_mode
,
CONFIG_DEFAULT_PROTECTED_MODE
);

1865 
	`»wr™eCÚfigCl›Áouutbufã¾im™O±iÚ
(
¡©e
);

1866 
	`»wr™eCÚfigNum”iÿlO±iÚ
(
¡©e
,"hz",
£rv”
.
hz
,
CONFIG_DEFAULT_HZ
);

1867 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"aof-»wr™e-šüem’l-fsync",
£rv”
.
aof_»wr™e_šüem’l_fsync
,
CONFIG_DEFAULT_AOF_REWRITE_INCREMENTAL_FSYNC
);

1868 
	`»wr™eCÚfigYesNoO±iÚ
(
¡©e
,"aof-lßd-Œunÿ‹d",
£rv”
.
aof_lßd_Œunÿ‹d
,
CONFIG_DEFAULT_AOF_LOAD_TRUNCATED
);

1869 
	`»wr™eCÚfigEnumO±iÚ
(
¡©e
,"su³rvi£d",
£rv”
.
su³rvi£d_mode
,
su³rvi£d_mode_’um
,
SUPERVISED_NONE
);

1872 ià(
£rv”
.
£Áš–_mode
è
	`»wr™eCÚfigS’tš–O±iÚ
(
¡©e
);

1877 
	`»wr™eCÚfigRemoveO½hªed
(
¡©e
);

1881 
ÃwcÚ‹Á
 = 
	`»wr™eCÚfigG‘CÚ‹ÁFromS‹
(
¡©e
);

1882 
»tv®
 = 
	`»wr™eCÚfigOv”wr™eFe
(
£rv”
.
cÚfigfe
,
ÃwcÚ‹Á
);

1884 
	`sdsä“
(
ÃwcÚ‹Á
);

1885 
	`»wr™eCÚfigR–—£S‹
(
¡©e
);

1886  
»tv®
;

1893 
	`cÚfigCommªd
(
ş›Á
 *
c
) {

1895 ià(
£rv”
.
lßdšg
 && 
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"get")) {

1896 
	`addR•lyE¼Ü
(
c
,"Only CONFIG GET is‡llowed during†oading");

1900 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"set")) {

1901 ià(
c
->
¬gc
 !ğ4è
bad¬™y
;

1902 
	`cÚfigS‘Commªd
(
c
);

1903 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"get")) {

1904 ià(
c
->
¬gc
 !ğ3è
bad¬™y
;

1905 
	`cÚfigG‘Commªd
(
c
);

1906 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"resetstat")) {

1907 ià(
c
->
¬gc
 !ğ2è
bad¬™y
;

1908 
	`»£tS”v”Sts
();

1909 
	`»£tCommªdTabËSts
();

1910 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1911 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"rewrite")) {

1912 ià(
c
->
¬gc
 !ğ2è
bad¬™y
;

1913 ià(
£rv”
.
cÚfigfe
 =ğ
NULL
) {

1914 
	`addR•lyE¼Ü
(
c
,"The server is„unning without‡ config file");

1917 ià(
	`»wr™eCÚfig
(
£rv”
.
cÚfigfe
) == -1) {

1918 
	`£rv”Log
(
LL_WARNING
,"CONFIG REWRITE faed: %s", 
	`¡»¼Ü
(
”ºo
));

1919 
	`addR•lyE¼ÜFÜm©
(
c
,"Rewr™šg cÚfig fe: %s", 
	`¡»¼Ü
(
”ºo
));

1921 
	`£rv”Log
(
LL_WARNING
,"CONFIG REWRITEƒxecuted with success.");

1922 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1925 
	`addR•lyE¼Ü
(
c
,

1930 
bad¬™y
:

1931 
	`addR•lyE¼ÜFÜm©
(
c
,"Wrong‚umber of‡rguments for CONFIG %s",

1932 (*è
c
->
¬gv
[1]->
±r
);

	@src/config.h

30 #iâdeà
__CONFIG_H


31 
	#__CONFIG_H


	)

33 #ifdeà
__APPLE__


34 
	~<Avaab™yMaüos.h
>

37 #ifdeà
__lšux__


38 
	~<lšux/v”siÚ.h
>

39 
	~<ã©u»s.h
>

43 #ià
defšed
(
__APPLE__
è&& !defšed(
MAC_OS_X_VERSION_10_6
)

44 
	#»dis_f¡©
 
f¡©64


	)

45 
	#»dis_¡©
 
¡©64


	)

47 
	#»dis_f¡©
 
f¡©


	)

48 
	#»dis_¡©
 
¡©


	)

52 #ifdeà
__lšux__


53 
	#HAVE_PROC_STAT
 1

	)

54 
	#HAVE_PROC_MAPS
 1

	)

55 
	#HAVE_PROC_SMAPS
 1

	)

56 
	#HAVE_PROC_SOMAXCONN
 1

	)

60 #ià
defšed
(
__APPLE__
)

61 
	#HAVE_TASKINFO
 1

	)

65 #ià
defšed
(
__APPLE__
è|| (defšed(
__lšux__
è&& defšed(
__GLIBC__
))

66 
	#HAVE_BACKTRACE
 1

	)

70 #ifdeà
__lšux__


71 
	#HAVE_MSG_NOSIGNAL
 1

	)

75 #ifdeà
__lšux__


76 
	#HAVE_EPOLL
 1

	)

79 #ià(
defšed
(
__APPLE__
è&& defšed(
MAC_OS_X_VERSION_10_6
)è|| defšed(
__F»eBSD__
è|| defšed(
__O³nBSD__
è|| defšed (
__N‘BSD__
)

80 
	#HAVE_KQUEUE
 1

	)

83 #ifdeà
__sun


84 
	~<sys/ã©u»_‹¡s.h
>

85 #ifdeà
_DTRACE_VERSION


86 
	#HAVE_EVPORT
 1

	)

91 #ifdeà
__lšux__


92 
	#aof_fsync
 
fd©async


	)

94 
	#aof_fsync
 
fsync


	)

99 #ifdeà
__lšux__


100 #ià
defšed
(
__GLIBC__
è&& defšed(
__GLIBC_PREREQ
)

101 #ià(
LINUX_VERSION_CODE
 >ğ0x020611 && 
__GLIBC_PREREQ
(2, 6))

102 
	#HAVE_SYNC_FILE_RANGE
 1

	)

105 #ià(
LINUX_VERSION_CODE
 >= 0x020611)

106 
	#HAVE_SYNC_FILE_RANGE
 1

	)

111 #ifdeà
HAVE_SYNC_FILE_RANGE


112 
	#rdb_fsync_¿nge
(
fd
,
off
,
size
è
	`sync_fe_¿nge
(fd,off,size,
SYNC_FILE_RANGE_WAIT_BEFORE
|
SYNC_FILE_RANGE_WRITE
)

	)

114 
	#rdb_fsync_¿nge
(
fd
,
off
,
size
è
	`fsync
(fd)

	)

120 #ià(
defšed
 
__N‘BSD__
 || defšed 
__F»eBSD__
 || defšed 
__O³nBSD__
)

121 
	#USE_SETPROCTITLE


	)

124 #ià((
defšed
 
__lšux
 && defšed(
__GLIBC__
)è|| defšed 
__APPLE__
)

125 
	#USE_SETPROCTITLE


	)

126 
	#INIT_SETPROCTITLE_REPLACEMENT


	)

127 
¥t_š™
(
¬gc
, *
¬gv
[]);

128 
£roù™Ë
(cÚ¡ *
fmt
, ...);

132 
	~<sys/ty³s.h
>

134 #iâdeà
BYTE_ORDER


135 #ià(
BSD
 >= 199103)

136 
	~<machše/’dŸn.h
>

138 #ià
defšed
(
lšux
è|| defšed(
__lšux__
)

139 
	~<’dŸn.h
>

141 
	#LITTLE_ENDIAN
 1234

	)

142 
	#BIG_ENDIAN
 4321

	)

143 
	#PDP_ENDIAN
 3412

	)

145 #ià
defšed
(
__i386__
è|| defšed(
__x86_64__
è|| defšed(
__amd64__
) || \

146 
defšed
(
vax
è|| defšed(
ns32000
è|| defšed(
sun386
) || \

147 
defšed
(
MIPSEL
è|| defšed(
_MIPSEL
è|| defšed(
BIT_ZERO_ON_RIGHT
) || \

148 
defšed
(
__®pha__
è|| 
	$defšed
(
__®pha
)

149 
	#BYTE_ORDER
 
LITTLE_ENDIAN


	)

152 #ià
	`defšed
(
£l
è|| defšed(
pyr
è|| defšed(
mc68000
è|| defšed(
¥¬c
) || \

153 
	`defšed
(
is68k
è|| defšed(
hÛ
è|| defšed(
ibm032
è|| defšed(
ibm370
) || \

154 
	`defšed
(
MIPSEB
è|| defšed(
_MIPSEB
è|| defšed(
_IBMR2
è|| defšed(
DGUX
) ||\

155 
	`defšed
(
­Şlo
è|| defšed(
__cÚvex__
è|| defšed(
_CRAY
) || \

156 
	`defšed
(
__hµa
è|| defšed(
__hp9000
) || \

157 
	`defšed
(
__hp9000s300
è|| defšed(
__hp9000s700
) || \

158 
	`defšed
 (
BIT_ZERO_ON_LEFT
è|| defšed(
m68k
è|| 
	$defšed
(
__¥¬c
)

159 
	#BYTE_ORDER
 
BIG_ENDIAN


	)

169 #iâdeà
BYTE_ORDER


170 #ifdeà
__BYTE_ORDER


171 #ià
	`defšed
(
__LITTLE_ENDIAN
è&& defšed(
__BIG_ENDIAN
)

172 #iâdeà
LITTLE_ENDIAN


173 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

175 #iâdeà
BIG_ENDIAN


176 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

178 #ià(
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN
)

179 
	#BYTE_ORDER
 
LITTLE_ENDIAN


	)

181 
	#BYTE_ORDER
 
BIG_ENDIAN


	)

187 #ià!
	`defšed
(
BYTE_ORDER
) || \

188 (
BYTE_ORDER
 !ğ
BIG_ENDIAN
 && BYTE_ORDER !ğ
LITTLE_ENDIAN
)

197 #ià(
__i386
 || 
__amd64
 || 
__pow”pc__
è&& 
__GNUC__


198 
	#GNUC_VERSION
 (
__GNUC__
 * 10000 + 
__GNUC_MINOR__
 * 100 + 
__GNUC_PATCHLEVEL__
)

	)

199 #ià
	`defšed
(
__şªg__
)

200 
	#HAVE_ATOMIC


	)

202 #ià(
	`defšed
(
__GLIBC__
è&& defšed(
__GLIBC_PREREQ
))

203 #ià(
GNUC_VERSION
 >ğ40100 && 
	`__GLIBC_PREREQ
(2, 6))

204 
	#HAVE_ATOMIC


	)

	@src/crc16.c

1 
	~"£rv”.h
"

47 cÚ¡ 
ušt16_t
 
	güc16b
[256]= {

82 
ušt16_t
 
	$üc16
(cÚ¡ *
buf
, 
Ën
) {

83 
couÁ”
;

84 
ušt16_t
 
üc
 = 0;

85 
couÁ”
 = 0; couÁ” < 
Ën
; counter++)

86 
üc
 = (üc<<8è^ 
üc16b
[((üc>>8è^ *
buf
++)&0x00FF];

87  
üc
;

88 
	}
}

	@src/crc64.c

40 
	~<¡dšt.h
>

42 cÚ¡ 
ušt64_t
 
	güc64_b
[256] = {

43 
UINT64_C
(0x0000000000000000), UINT64_C(0x7ad870c830358979),

44 
UINT64_C
(0xf5b0e190606b12f2), UINT64_C(0x8f689158505e9b8b),

45 
UINT64_C
(0xc038e5739841b68f), UINT64_C(0xbae095bba8743ff6),

46 
UINT64_C
(0x358804e3f82aa47d), UINT64_C(0x4f50742bc81f2d04),

47 
UINT64_C
(0xab28ecb46814fe75), UINT64_C(0xd1f09c7c5821770c),

48 
UINT64_C
(0x5e980d24087fec87), UINT64_C(0x24407dec384a65fe),

49 
UINT64_C
(0x6b1009c7f05548fa), UINT64_C(0x11c8790fc060c183),

50 
UINT64_C
(0x9ea0e857903e5a08), UINT64_C(0xe478989fa00bd371),

51 
UINT64_C
(0x7d08ff3b88be6f81), UINT64_C(0x07d08ff3b88be6f8),

52 
UINT64_C
(0x88b81eabe8d57d73), UINT64_C(0xf2606e63d8e0f40a),

53 
UINT64_C
(0xbd301a4810ffd90e), UINT64_C(0xc7e86a8020ca5077),

54 
UINT64_C
(0x4880fbd87094cbfc), UINT64_C(0x32588b1040a14285),

55 
UINT64_C
(0xd620138fe0aa91f4), UINT64_C(0xacf86347d09f188d),

56 
UINT64_C
(0x2390f21f80c18306), UINT64_C(0x594882d7b0f40a7f),

57 
UINT64_C
(0x1618f6fc78eb277b), UINT64_C(0x6cc0863448deae02),

58 
UINT64_C
(0xe3a8176c18803589), UINT64_C(0x997067a428b5bcf0),

59 
UINT64_C
(0xfa11fe77117cdf02), UINT64_C(0x80c98ebf2149567b),

60 
UINT64_C
(0x0fa11fe77117cdf0), UINT64_C(0x75796f2f41224489),

61 
UINT64_C
(0x3a291b04893d698d), UINT64_C(0x40f16bccb908e0f4),

62 
UINT64_C
(0xcf99fa94e9567b7f), UINT64_C(0xb5418a5cd963f206),

63 
UINT64_C
(0x513912c379682177), UINT64_C(0x2be1620b495da80e),

64 
UINT64_C
(0xa489f35319033385), UINT64_C(0xde51839b2936bafc),

65 
UINT64_C
(0x9101f7b0e12997f8), UINT64_C(0xebd98778d11c1e81),

66 
UINT64_C
(0x64b116208142850a), UINT64_C(0x1e6966e8b1770c73),

67 
UINT64_C
(0x8719014c99c2b083), UINT64_C(0xfdc17184a9f739fa),

68 
UINT64_C
(0x72a9e0dcf9a9a271), UINT64_C(0x08719014c99c2b08),

69 
UINT64_C
(0x4721e43f0183060c), UINT64_C(0x3df994f731b68f75),

70 
UINT64_C
(0xb29105af61e814fe), UINT64_C(0xc849756751dd9d87),

71 
UINT64_C
(0x2c31edf8f1d64ef6), UINT64_C(0x56e99d30c1e3c78f),

72 
UINT64_C
(0xd9810c6891bd5c04), UINT64_C(0xa3597ca0a188d57d),

73 
UINT64_C
(0xec09088b6997f879), UINT64_C(0x96d1784359a27100),

74 
UINT64_C
(0x19b9e91b09fcea8b), UINT64_C(0x636199d339c963f2),

75 
UINT64_C
(0xdf7adabd7a6e2d6f), UINT64_C(0xa5a2aa754a5ba416),

76 
UINT64_C
(0x2aca3b2d1a053f9d), UINT64_C(0x50124be52a30b6e4),

77 
UINT64_C
(0x1f423fcee22f9be0), UINT64_C(0x659a4f06d21a1299),

78 
UINT64_C
(0xeaf2de5e82448912), UINT64_C(0x902aae96b271006b),

79 
UINT64_C
(0x74523609127ad31a), UINT64_C(0x0e8a46c1224f5a63),

80 
UINT64_C
(0x81e2d7997211c1e8), UINT64_C(0xfb3aa75142244891),

81 
UINT64_C
(0xb46ad37a8a3b6595), UINT64_C(0xceb2a3b2ba0eecec),

82 
UINT64_C
(0x41da32eaea507767), UINT64_C(0x3b024222da65fe1e),

83 
UINT64_C
(0xa2722586f2d042ee), UINT64_C(0xd8aa554ec2e5cb97),

84 
UINT64_C
(0x57c2c41692bb501c), UINT64_C(0x2d1ab4dea28ed965),

85 
UINT64_C
(0x624ac0f56a91f461), UINT64_C(0x1892b03d5aa47d18),

86 
UINT64_C
(0x97fa21650afae693), UINT64_C(0xed2251ad3acf6fea),

87 
UINT64_C
(0x095ac9329ac4bc9b), UINT64_C(0x7382b9faaaf135e2),

88 
UINT64_C
(0xfcea28a2faafae69), UINT64_C(0x8632586aca9a2710),

89 
UINT64_C
(0xc9622c4102850a14), UINT64_C(0xb3ba5c8932b0836d),

90 
UINT64_C
(0x3cd2cdd162ee18e6), UINT64_C(0x460abd1952db919f),

91 
UINT64_C
(0x256b24ca6b12f26d), UINT64_C(0x5fb354025b277b14),

92 
UINT64_C
(0xd0dbc55a0b79e09f), UINT64_C(0xaa03b5923b4c69e6),

93 
UINT64_C
(0xe553c1b9f35344e2), UINT64_C(0x9f8bb171c366cd9b),

94 
UINT64_C
(0x10e3202993385610), UINT64_C(0x6a3b50e1a30ddf69),

95 
UINT64_C
(0x8e43c87e03060c18), UINT64_C(0xf49bb8b633338561),

96 
UINT64_C
(0x7bf329ee636d1eea), UINT64_C(0x012b592653589793),

97 
UINT64_C
(0x4e7b2d0d9b47ba97), UINT64_C(0x34a35dc5ab7233ee),

98 
UINT64_C
(0xbbcbcc9dfb2ca865), UINT64_C(0xc113bc55cb19211c),

99 
UINT64_C
(0x5863dbf1e3ac9dec), UINT64_C(0x22bbab39d3991495),

100 
UINT64_C
(0xadd33a6183c78f1e), UINT64_C(0xd70b4aa9b3f20667),

101 
UINT64_C
(0x985b3e827bed2b63), UINT64_C(0xe2834e4a4bd8a21a),

102 
UINT64_C
(0x6debdf121b863991), UINT64_C(0x1733afda2bb3b0e8),

103 
UINT64_C
(0xf34b37458bb86399), UINT64_C(0x8993478dbb8deae0),

104 
UINT64_C
(0x06fbd6d5ebd3716b), UINT64_C(0x7c23a61ddbe6f812),

105 
UINT64_C
(0x3373d23613f9d516), UINT64_C(0x49aba2fe23cc5c6f),

106 
UINT64_C
(0xc6c333a67392c7e4), UINT64_C(0xbc1b436e43a74e9d),

107 
UINT64_C
(0x95ac9329ac4bc9b5), UINT64_C(0xef74e3e19c7e40cc),

108 
UINT64_C
(0x601c72b9cc20db47), UINT64_C(0x1ac40271fc15523e),

109 
UINT64_C
(0x5594765a340a7f3a), UINT64_C(0x2f4c0692043ff643),

110 
UINT64_C
(0xa02497ca54616dc8), UINT64_C(0xdafce7026454e4b1),

111 
UINT64_C
(0x3e847f9dc45f37c0), UINT64_C(0x445c0f55f46abeb9),

112 
UINT64_C
(0xcb349e0da4342532), UINT64_C(0xb1eceec59401ac4b),

113 
UINT64_C
(0xfebc9aee5c1e814f), UINT64_C(0x8464ea266c2b0836),

114 
UINT64_C
(0x0b0c7b7e3c7593bd), UINT64_C(0x71d40bb60c401ac4),

115 
UINT64_C
(0xe8a46c1224f5a634), UINT64_C(0x927c1cda14c02f4d),

116 
UINT64_C
(0x1d148d82449eb4c6), UINT64_C(0x67ccfd4a74ab3dbf),

117 
UINT64_C
(0x289c8961bcb410bb), UINT64_C(0x5244f9a98c8199c2),

118 
UINT64_C
(0xdd2c68f1dcdf0249), UINT64_C(0xa7f41839ecea8b30),

119 
UINT64_C
(0x438c80a64ce15841), UINT64_C(0x3954f06e7cd4d138),

120 
UINT64_C
(0xb63c61362c8a4ab3), UINT64_C(0xcce411fe1cbfc3ca),

121 
UINT64_C
(0x83b465d5d4a0eece), UINT64_C(0xf96c151de49567b7),

122 
UINT64_C
(0x76048445b4cbfc3c), UINT64_C(0x0cdcf48d84fe7545),

123 
UINT64_C
(0x6fbd6d5ebd3716b7), UINT64_C(0x15651d968d029fce),

124 
UINT64_C
(0x9a0d8ccedd5c0445), UINT64_C(0xe0d5fc06ed698d3c),

125 
UINT64_C
(0xaf85882d2576a038), UINT64_C(0xd55df8e515432941),

126 
UINT64_C
(0x5a3569bd451db2ca), UINT64_C(0x20ed197575283bb3),

127 
UINT64_C
(0xc49581ead523e8c2), UINT64_C(0xbe4df122e51661bb),

128 
UINT64_C
(0x3125607ab548fa30), UINT64_C(0x4bfd10b2857d7349),

129 
UINT64_C
(0x04ad64994d625e4d), UINT64_C(0x7e7514517d57d734),

130 
UINT64_C
(0xf11d85092d094cbf), UINT64_C(0x8bc5f5c11d3cc5c6),

131 
UINT64_C
(0x12b5926535897936), UINT64_C(0x686de2ad05bcf04f),

132 
UINT64_C
(0xe70573f555e26bc4), UINT64_C(0x9ddd033d65d7e2bd),

133 
UINT64_C
(0xd28d7716adc8cfb9), UINT64_C(0xa85507de9dfd46c0),

134 
UINT64_C
(0x273d9686cda3dd4b), UINT64_C(0x5de5e64efd965432),

135 
UINT64_C
(0xb99d7ed15d9d8743), UINT64_C(0xc3450e196da80e3a),

136 
UINT64_C
(0x4c2d9f413df695b1), UINT64_C(0x36f5ef890dc31cc8),

137 
UINT64_C
(0x79a59ba2c5dc31cc), UINT64_C(0x037deb6af5e9b8b5),

138 
UINT64_C
(0x8c157a32a5b7233e), UINT64_C(0xf6cd0afa9582aa47),

139 
UINT64_C
(0x4ad64994d625e4da), UINT64_C(0x300e395ce6106da3),

140 
UINT64_C
(0xbf66a804b64ef628), UINT64_C(0xc5bed8cc867b7f51),

141 
UINT64_C
(0x8aeeace74e645255), UINT64_C(0xf036dc2f7e51db2c),

142 
UINT64_C
(0x7f5e4d772e0f40a7), UINT64_C(0x05863dbf1e3ac9de),

143 
UINT64_C
(0xe1fea520be311aaf), UINT64_C(0x9b26d5e88e0493d6),

144 
UINT64_C
(0x144e44b0de5a085d), UINT64_C(0x6e963478ee6f8124),

145 
UINT64_C
(0x21c640532670ac20), UINT64_C(0x5b1e309b16452559),

146 
UINT64_C
(0xd476a1c3461bbed2), UINT64_C(0xaeaed10b762e37ab),

147 
UINT64_C
(0x37deb6af5e9b8b5b), UINT64_C(0x4d06c6676eae0222),

148 
UINT64_C
(0xc26e573f3ef099a9), UINT64_C(0xb8b627f70ec510d0),

149 
UINT64_C
(0xf7e653dcc6da3dd4), UINT64_C(0x8d3e2314f6efb4ad),

150 
UINT64_C
(0x0256b24ca6b12f26), UINT64_C(0x788ec2849684a65f),

151 
UINT64_C
(0x9cf65a1b368f752e), UINT64_C(0xe62e2ad306bafc57),

152 
UINT64_C
(0x6946bb8b56e467dc), UINT64_C(0x139ecb4366d1eea5),

153 
UINT64_C
(0x5ccebf68aecec3a1), UINT64_C(0x2616cfa09efb4ad8),

154 
UINT64_C
(0xa97e5ef8cea5d153), UINT64_C(0xd3a62e30fe90582a),

155 
UINT64_C
(0xb0c7b7e3c7593bd8), UINT64_C(0xca1fc72bf76cb2a1),

156 
UINT64_C
(0x45775673a732292a), UINT64_C(0x3faf26bb9707a053),

157 
UINT64_C
(0x70ff52905f188d57), UINT64_C(0x0a2722586f2d042e),

158 
UINT64_C
(0x854fb3003f739fa5), UINT64_C(0xff97c3c80f4616dc),

159 
UINT64_C
(0x1bef5b57af4dc5ad), UINT64_C(0x61372b9f9f784cd4),

160 
UINT64_C
(0xee5fbac7cf26d75f), UINT64_C(0x9487ca0fff135e26),

161 
UINT64_C
(0xdbd7be24370c7322), UINT64_C(0xa10fceec0739fa5b),

162 
UINT64_C
(0x2e675fb4576761d0), UINT64_C(0x54bf2f7c6752e8a9),

163 
UINT64_C
(0xcdcf48d84fe75459), UINT64_C(0xb71738107fd2dd20),

164 
UINT64_C
(0x387fa9482f8c46ab), UINT64_C(0x42a7d9801fb9cfd2),

165 
UINT64_C
(0x0df7adabd7a6e2d6), UINT64_C(0x772fdd63e7936baf),

166 
UINT64_C
(0xf8474c3bb7cdf024), UINT64_C(0x829f3cf387f8795d),

167 
UINT64_C
(0x66e7a46c27f3aa2c), UINT64_C(0x1c3fd4a417c62355),

168 
UINT64_C
(0x935745fc4798b8de), UINT64_C(0xe98f353477ad31a7),

169 
UINT64_C
(0xa6df411fbfb21ca3), UINT64_C(0xdc0731d78f8795da),

170 
UINT64_C
(0x536fa08fdfd90e51), UINT64_C(0x29b7d047efec8728),

173 
ušt64_t
 
	$üc64
(
ušt64_t
 
üc
, cÚ¡ *
s
, ušt64_ˆ
l
) {

174 
ušt64_t
 
j
;

176 
j
 = 0; j < 
l
; j++) {

177 
ušt8_t
 
by‹
 = 
s
[
j
];

178 
üc
 = 
üc64_b
[(
ušt8_t
)üø^ 
by‹
] ^ (crc >> 8);

180  
üc
;

181 
	}
}

184 #ifdeà
REDIS_TEST


185 
	~<¡dio.h
>

187 
	#UNUSED
(
x
è()(x)

	)

188 
	$üc64Te¡
(
¬gc
, *
¬gv
[]) {

189 
	`UNUSED
(
¬gc
);

190 
	`UNUSED
(
¬gv
);

191 
	`´štf
("e9c6d914c4b8d9ca == %016llx\n",

192 (è
	`üc64
(0,(*)"123456789",9));

194 
	}
}

	@src/crc64.h

1 #iâdeà
CRC64_H


2 
	#CRC64_H


	)

4 
	~<¡dšt.h
>

6 
ušt64_t
 
üc64
(ušt64_ˆ
üc
, cÚ¡ *
s
, ušt64_ˆ
l
);

8 #ifdeà
REDIS_TEST


9 
üc64Te¡
(
¬gc
, *
¬gv
[]);

	@src/db.c

30 
	~"£rv”.h
"

31 
	~"şu¡”.h
"

33 
	~<sigÇl.h
>

34 
	~<ùy³.h
>

36 #ifdeà
USE_PMDK


37 
	~"obj.h
"

38 
	~"libpmemobj.h
"

42 
»disS”v”
 
£rv”
;

44 
¦ÙToKeyAdd
(
robj
 *
key
);

45 
¦ÙToKeyD–
(
robj
 *
key
);

46 
¦ÙToKeyFlush
();

55 
robj
 *
	$lookupKey
(
»disDb
 *
db
, 
robj
 *
key
, 
æags
) {

56 
diùEÁry
 *
de
 = 
	`diùFšd
(
db
->
diù
,
key
->
±r
);

57 ià(
de
) {

58 
robj
 *
v®
 = 
	`diùG‘V®
(
de
);

63 ià(
£rv”
.
rdb_chd_pid
 == -1 &&

64 
£rv”
.
aof_chd_pid
 == -1 &&

65 !(
æags
 & 
LOOKUP_NOTOUCH
))

67 
v®
->
Ìu
 = 
	`LRU_CLOCK
();

69  
v®
;

71  
NULL
;

73 
	}
}

96 
robj
 *
	$lookupKeyR—dW™hFÏgs
(
»disDb
 *
db
, 
robj
 *
key
, 
æags
) {

97 
robj
 *
v®
;

99 ià(
	`expœeIfN“ded
(
db
,
key
) == 1) {

103 ià(
£rv”
.
ma¡”ho¡
 =ğ
NULL
)  NULL;

117 ià(
£rv”
.
cu¼’t_ş›Á
 &&

118 
£rv”
.
cu¼’t_ş›Á
 !ğ£rv”.
ma¡”
 &&

119 
£rv”
.
cu¼’t_ş›Á
->
cmd
 &&

120 
£rv”
.
cu¼’t_ş›Á
->
cmd
->
æags
 & 
CMD_READONLY
)

122  
NULL
;

125 
v®
 = 
	`lookupKey
(
db
,
key
,
æags
);

126 ià(
v®
 =ğ
NULL
)

127 
£rv”
.
¡©_key¥aû_mis£s
++;

129 
£rv”
.
¡©_key¥aû_h™s
++;

130  
v®
;

131 
	}
}

135 
robj
 *
	$lookupKeyR—d
(
»disDb
 *
db
, 
robj
 *
key
) {

136  
	`lookupKeyR—dW™hFÏgs
(
db
,
key
,
LOOKUP_NONE
);

137 
	}
}

144 
robj
 *
	$lookupKeyWr™e
(
»disDb
 *
db
, 
robj
 *
key
) {

145 
	`expœeIfN“ded
(
db
,
key
);

146  
	`lookupKey
(
db
,
key
,
LOOKUP_NONE
);

147 
	}
}

149 
robj
 *
	$lookupKeyR—dOrR•ly
(
ş›Á
 *
c
, 
robj
 *
key
,„obj *
»¶y
) {

150 
robj
 *
o
 = 
	`lookupKeyR—d
(
c
->
db
, 
key
);

151 ià(!
o
è
	`addR•ly
(
c
,
»¶y
);

152  
o
;

153 
	}
}

155 
robj
 *
	$lookupKeyWr™eOrR•ly
(
ş›Á
 *
c
, 
robj
 *
key
,„obj *
»¶y
) {

156 
robj
 *
o
 = 
	`lookupKeyWr™e
(
c
->
db
, 
key
);

157 ià(!
o
è
	`addR•ly
(
c
,
»¶y
);

158  
o
;

159 
	}
}

165 
	$dbAdd
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
) {

166 
sds
 
cİy
 = 
	`sdsdup
(
key
->
±r
);

167 
»tv®
 = 
	`diùAdd
(
db
->
diù
, 
cİy
, 
v®
);

169 
	`£rv”As£¹W™hInfo
(
NULL
,
key
,
»tv®
 =ğ
DICT_OK
);

170 ià(
v®
->
ty³
 =ğ
OBJ_LIST
è
	`sigÇlLi¡AsR—dy
(
db
, 
key
);

171 ià(
£rv”
.
şu¡”_’abËd
è
	`¦ÙToKeyAdd
(
key
);

172 
	}
}

174 #ifdeà
USE_PMDK


178 
	$dbAddPM
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
) {

179 
PMEMoid
 
kv_PM
;

180 
PMEMoid
 *
kv_pm_»ã»nû
;

182 
sds
 
cİy
 = 
	`sdsdupPM
(
key
->
±r
, (**è&
kv_pm_»ã»nû
);

183 
»tv®
 = 
	`diùAddPM
(
db
->
diù
, 
cİy
, 
v®
);

185 
kv_PM
 = 
	`pmemAddToPmemLi¡
((*)
cİy
, (*)(
v®
->
±r
));

186 *
kv_pm_»ã»nû
 = 
kv_PM
;

188 
	`£rv”As£¹W™hInfo
(
NULL
,
key
,
»tv®
 =ğ
C_OK
);

189 ià(
v®
->
ty³
 =ğ
OBJ_LIST
è
	`sigÇlLi¡AsR—dy
(
db
, 
key
);

190 ià(
£rv”
.
şu¡”_’abËd
è
	`¦ÙToKeyAdd
(
key
);

191 
	}
}

199 
	$dbOv”wr™e
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
) {

200 
diùEÁry
 *
de
 = 
	`diùFšd
(
db
->
diù
,
key
->
±r
);

202 
	`£rv”As£¹W™hInfo
(
NULL
,
key
,
de
 != NULL);

203 
	`diùR•Ïû
(
db
->
diù
, 
key
->
±r
, 
v®
);

204 
	}
}

206 #ifdeà
USE_PMDK


212 
	$dbOv”wr™ePM
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
) {

213 
diùEÁry
 *
de
 = 
	`diùFšd
(
db
->
diù
,
key
->
±r
);

215 
	`£rv”As£¹W™hInfo
(
NULL
,
key
,
de
 != NULL);

216 
	`diùR•ÏûPM
(
db
->
diù
, 
key
->
±r
, 
v®
);

217 
	}
}

226 
	$£tKey
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
) {

227 ià(
	`lookupKeyWr™e
(
db
,
key
è=ğ
NULL
) {

228 
	`dbAdd
(
db
,
key
,
v®
);

230 
	`dbOv”wr™e
(
db
,
key
,
v®
);

232 
	`šüRefCouÁ
(
v®
);

233 
	`»moveExpœe
(
db
,
key
);

234 
	`sigÇlModif›dKey
(
db
,
key
);

235 
	}
}

237 #ifdeà
USE_PMDK


239 
	$£tKeyPM
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
) {

240 ià(
	`lookupKeyWr™e
(
db
,
key
è=ğ
NULL
) {

241 
	`dbAddPM
(
db
,
key
,
v®
);

243 
	`dbOv”wr™ePM
(
db
,
key
,
v®
);

246 
	`»moveExpœe
(
db
,
key
);

247 
	`sigÇlModif›dKey
(
db
,
key
);

248 
	}
}

251 
	$dbExi¡s
(
»disDb
 *
db
, 
robj
 *
key
) {

252  
	`diùFšd
(
db
->
diù
,
key
->
±r
è!ğ
NULL
;

253 
	}
}

259 
robj
 *
	$dbRªdomKey
(
»disDb
 *
db
) {

260 
diùEÁry
 *
de
;

263 
sds
 
key
;

264 
robj
 *
keyobj
;

266 
de
 = 
	`diùG‘RªdomKey
(
db
->
diù
);

267 ià(
de
 =ğ
NULL
)  NULL;

269 
key
 = 
	`diùG‘Key
(
de
);

270 
keyobj
 = 
	`ü—‹SŒšgObjeù
(
key
,
	`sd¦’
(key));

271 ià(
	`diùFšd
(
db
->
expœes
,
key
)) {

272 ià(
	`expœeIfN“ded
(
db
,
keyobj
)) {

273 
	`deüRefCouÁ
(
keyobj
);

277  
keyobj
;

279 
	}
}

282 
	$dbD–‘e
(
»disDb
 *
db
, 
robj
 *
key
) {

285 ià(
	`diùSize
(
db
->
expœes
è> 0è
	`diùD–‘e
(db->expœes,
key
->
±r
);

286 ià(
	`diùD–‘e
(
db
->
diù
,
key
->
±r
è=ğ
DICT_OK
) {

287 ià(
£rv”
.
şu¡”_’abËd
è
	`¦ÙToKeyD–
(
key
);

292 
	}
}

321 
robj
 *
	$dbUnsh¬eSŒšgV®ue
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
o
) {

322 
	`£rv”As£¹
(
o
->
ty³
 =ğ
OBJ_STRING
);

323 ià(
o
->
»fcouÁ
 !ğ1 || o->
’codšg
 !ğ
OBJ_ENCODING_RAW
) {

324 
robj
 *
decoded
 = 
	`g‘DecodedObjeù
(
o
);

325 
o
 = 
	`ü—‹RawSŒšgObjeù
(
decoded
->
±r
, 
	`sd¦’
(decoded->ptr));

326 
	`deüRefCouÁ
(
decoded
);

327 
	`dbOv”wr™e
(
db
,
key
,
o
);

329  
o
;

330 
	}
}

332 
em±yDb
((
ÿÎback
)(*)) {

333 
j
;

334 
»moved
 = 0;

336 
j
 = 0; j < 
£rv”
.
dbnum
; j++) {

337 
»moved
 +ğ
	`diùSize
(
£rv”
.
db
[
j
].
diù
);

338 
	`diùEm±y
(
£rv”
.
db
[
j
].
diù
,
ÿÎback
);

339 
	`diùEm±y
(
£rv”
.
db
[
j
].
expœes
,
ÿÎback
);

341 ià(
£rv”
.
şu¡”_’abËd
è
	`¦ÙToKeyFlush
();

342  
»moved
;

343 
	}
}

345 
	$£ËùDb
(
ş›Á
 *
c
, 
id
) {

346 ià(
id
 < 0 || id >ğ
£rv”
.
dbnum
)

347  
C_ERR
;

348 
c
->
db
 = &
£rv”
.db[
id
];

349  
C_OK
;

350 
	}
}

361 
	$sigÇlModif›dKey
(
»disDb
 *
db
, 
robj
 *
key
) {

362 
	`touchW©chedKey
(
db
,
key
);

363 
	}
}

365 
	$sigÇlFlushedDb
(
dbid
) {

366 
	`touchW©chedKeysOnFlush
(
dbid
);

367 
	}
}

373 
	$æushdbCommªd
(
ş›Á
 *
c
) {

374 
£rv”
.
dœty
 +ğ
	`diùSize
(
c
->
db
->
diù
);

375 
	`sigÇlFlushedDb
(
c
->
db
->
id
);

376 
	`diùEm±y
(
c
->
db
->
diù
,
NULL
);

377 
	`diùEm±y
(
c
->
db
->
expœes
,
NULL
);

378 ià(
£rv”
.
şu¡”_’abËd
è
	`¦ÙToKeyFlush
();

379 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

380 
	}
}

382 
	$æush®lCommªd
(
ş›Á
 *
c
) {

383 
	`sigÇlFlushedDb
(-1);

384 
£rv”
.
dœty
 +ğ
	`em±yDb
(
NULL
);

385 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

386 ià(
£rv”
.
rdb_chd_pid
 != -1) {

387 
	`kl
(
£rv”
.
rdb_chd_pid
,
SIGUSR1
);

388 
	`rdbRemoveTempFe
(
£rv”
.
rdb_chd_pid
);

390 ià(
£rv”
.
§v•¬am¦’
 > 0) {

393 
§ved_dœty
 = 
£rv”
.
dœty
;

394 
	`rdbSave
(
£rv”
.
rdb_f’ame
);

395 
£rv”
.
dœty
 = 
§ved_dœty
;

397 
£rv”
.
dœty
++;

398 
	}
}

400 
	$d–Commªd
(
ş›Á
 *
c
) {

401 
d–‘ed
 = 0, 
j
;

403 
j
 = 1; j < 
c
->
¬gc
; j++) {

404 
	`expœeIfN“ded
(
c
->
db
,c->
¬gv
[
j
]);

405 ià(
	`dbD–‘e
(
c
->
db
,c->
¬gv
[
j
])) {

406 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[
j
]);

407 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,

408 "d–",
c
->
¬gv
[
j
],c->
db
->
id
);

409 
£rv”
.
dœty
++;

410 
d–‘ed
++;

413 
	`addR•lyLÚgLÚg
(
c
,
d–‘ed
);

414 
	}
}

418 
	$exi¡sCommªd
(
ş›Á
 *
c
) {

419 
couÁ
 = 0;

420 
j
;

422 
j
 = 1; j < 
c
->
¬gc
; j++) {

423 
	`expœeIfN“ded
(
c
->
db
,c->
¬gv
[
j
]);

424 ià(
	`dbExi¡s
(
c
->
db
,c->
¬gv
[
j
])è
couÁ
++;

426 
	`addR•lyLÚgLÚg
(
c
,
couÁ
);

427 
	}
}

429 
	$£ËùCommªd
(
ş›Á
 *
c
) {

430 
id
;

432 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[1], &
id
,

433 "šv®id DB index"è!ğ
C_OK
)

436 ià(
£rv”
.
şu¡”_’abËd
 && 
id
 != 0) {

437 
	`addR•lyE¼Ü
(
c
,"SELECT is‚ot‡llowed in cluster mode");

440 ià(
	`£ËùDb
(
c
,
id
è=ğ
C_ERR
) {

441 
	`addR•lyE¼Ü
(
c
,"invalid DB index");

443 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

445 
	}
}

447 
	$¿ndomkeyCommªd
(
ş›Á
 *
c
) {

448 
robj
 *
key
;

450 ià((
key
 = 
	`dbRªdomKey
(
c
->
db
)è=ğ
NULL
) {

451 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

455 
	`addR•lyBulk
(
c
,
key
);

456 
	`deüRefCouÁ
(
key
);

457 
	}
}

459 
	$keysCommªd
(
ş›Á
 *
c
) {

460 
diùI‹¿tÜ
 *
di
;

461 
diùEÁry
 *
de
;

462 
sds
 
·‰”n
 = 
c
->
¬gv
[1]->
±r
;

463 
¶’
 = 
	`sd¦’
(
·‰”n
), 
®lkeys
;

464 
numkeys
 = 0;

465 *
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

467 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
c
->
db
->
diù
);

468 
®lkeys
 = (
·‰”n
[0] == '*' &&…attern[1] == '\0');

469 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

470 
sds
 
key
 = 
	`diùG‘Key
(
de
);

471 
robj
 *
keyobj
;

473 ià(
®lkeys
 || 
	`¡ršgm©chËn
(
·‰”n
,
¶’
,
key
,
	`sd¦’
(key),0)) {

474 
keyobj
 = 
	`ü—‹SŒšgObjeù
(
key
,
	`sd¦’
(key));

475 ià(
	`expœeIfN“ded
(
c
->
db
,
keyobj
) == 0) {

476 
	`addR•lyBulk
(
c
,
keyobj
);

477 
numkeys
++;

479 
	`deüRefCouÁ
(
keyobj
);

482 
	`diùR–—£I‹¿tÜ
(
di
);

483 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
»¶yËn
,
numkeys
);

484 
	}
}

488 
	$sÿnC®lback
(*
´ivd©a
, cÚ¡ 
diùEÁry
 *
de
) {

489 **
pd
 = (**è
´ivd©a
;

490 
li¡
 *
keys
 = 
pd
[0];

491 
robj
 *
o
 = 
pd
[1];

492 
robj
 *
key
, *
v®
 = 
NULL
;

494 ià(
o
 =ğ
NULL
) {

495 
sds
 
sdskey
 = 
	`diùG‘Key
(
de
);

496 
key
 = 
	`ü—‹SŒšgObjeù
(
sdskey
, 
	`sd¦’
(sdskey));

497 } ià(
o
->
ty³
 =ğ
OBJ_SET
) {

498 
key
 = 
	`diùG‘Key
(
de
);

499 
	`šüRefCouÁ
(
key
);

500 } ià(
o
->
ty³
 =ğ
OBJ_HASH
) {

501 
key
 = 
	`diùG‘Key
(
de
);

502 
	`šüRefCouÁ
(
key
);

503 
v®
 = 
	`diùG‘V®
(
de
);

504 
	`šüRefCouÁ
(
v®
);

505 } ià(
o
->
ty³
 =ğ
OBJ_ZSET
) {

506 
key
 = 
	`diùG‘Key
(
de
);

507 
	`šüRefCouÁ
(
key
);

508 
v®
 = 
	`ü—‹SŒšgObjeùFromLÚgDoubË
(*(*)
	`diùG‘V®
(
de
),0);

510 
	`£rv”Pªic
("Type‚ot handled in SCAN callback.");

513 
	`li¡AddNodeTa
(
keys
, 
key
);

514 ià(
v®
è
	`li¡AddNodeTa
(
keys
, val);

515 
	}
}

521 
	$·r£SÿnCursÜOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
cursÜ
) {

522 *
•Œ
;

526 
”ºo
 = 0;

527 *
cursÜ
 = 
	`¡¹oul
(
o
->
±r
, &
•Œ
, 10);

528 ià(
	`is¥aû
(((*)
o
->
±r
)[0]è|| 
•Œ
[0] !ğ'\0' || 
”ºo
 =ğ
ERANGE
)

530 
	`addR•lyE¼Ü
(
c
, "invalid cursor");

531  
C_ERR
;

533  
C_OK
;

534 
	}
}

547 
	$sÿnG’”icCommªd
(
ş›Á
 *
c
, 
robj
 *
o
, 
cursÜ
) {

548 
i
, 
j
;

549 
li¡
 *
keys
 = 
	`li¡C»©e
();

550 
li¡Node
 *
node
, *
ÃxŠode
;

551 
couÁ
 = 10;

552 
sds
 
·t
 = 
NULL
;

553 
·’
 = 0, 
u£_·‰”n
 = 0;

554 
diù
 *
ht
;

558 
	`£rv”As£¹
(
o
 =ğ
NULL
 || o->
ty³
 =ğ
OBJ_SET
 || o->ty³ =ğ
OBJ_HASH
 ||

559 
o
->
ty³
 =ğ
OBJ_ZSET
);

562 
i
 = (
o
 =ğ
NULL
) ? 2 : 3;

565 
i
 < 
c
->
¬gc
) {

566 
j
 = 
c
->
¬gc
 - 
i
;

567 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
i
]->
±r
, "couÁ"è&& 
j
 >= 2) {

568 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[
i
+1], &
couÁ
, 
NULL
)

569 !ğ
C_OK
)

571 
ş—nup
;

574 ià(
couÁ
 < 1) {

575 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

576 
ş—nup
;

579 
i
 += 2;

580 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
i
]->
±r
, "m©ch"è&& 
j
 >= 2) {

581 
·t
 = 
c
->
¬gv
[
i
+1]->
±r
;

582 
·’
 = 
	`sd¦’
(
·t
);

586 
u£_·‰”n
 = !(
·t
[0] =ğ'*' && 
·’
 == 1);

588 
i
 += 2;

590 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

591 
ş—nup
;

604 
ht
 = 
NULL
;

605 ià(
o
 =ğ
NULL
) {

606 
ht
 = 
c
->
db
->
diù
;

607 } ià(
o
->
ty³
 =ğ
OBJ_SET
 && o->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

608 
ht
 = 
o
->
±r
;

609 } ià(
o
->
ty³
 =ğ
OBJ_HASH
 && o->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

610 
ht
 = 
o
->
±r
;

611 
couÁ
 *= 2;

612 } ià(
o
->
ty³
 =ğ
OBJ_ZSET
 && o->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

613 
z£t
 *
zs
 = 
o
->
±r
;

614 
ht
 = 
zs
->
diù
;

615 
couÁ
 *= 2;

618 ià(
ht
) {

619 *
´ivd©a
[2];

624 
max™”©iÚs
 = 
couÁ
*10;

629 
´ivd©a
[0] = 
keys
;

630 
´ivd©a
[1] = 
o
;

632 
cursÜ
 = 
	`diùSÿn
(
ht
, cursÜ, 
sÿnC®lback
, 
´ivd©a
);

633 } 
cursÜ
 &&

634 
max™”©iÚs
-- &&

635 
	`li¡L’gth
(
keys
è< ()
couÁ
);

636 } ià(
o
->
ty³
 =ğ
OBJ_SET
) {

637 
pos
 = 0;

638 
št64_t
 
Î
;

640 
	`št£tG‘
(
o
->
±r
,
pos
++,&
Î
))

641 
	`li¡AddNodeTa
(
keys
,
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
Î
));

642 
cursÜ
 = 0;

643 } ià(
o
->
ty³
 =ğ
OBJ_HASH
 || o->ty³ =ğ
OBJ_ZSET
) {

644 *
p
 = 
	`zli¡Index
(
o
->
±r
,0);

645 *
v¡r
;

646 
vËn
;

647 
vÎ
;

649 
p
) {

650 
	`zli¡G‘
(
p
,&
v¡r
,&
vËn
,&
vÎ
);

651 
	`li¡AddNodeTa
(
keys
,

652 (
v¡r
 !ğ
NULL
è? 
	`ü—‹SŒšgObjeù
((*)v¡r,
vËn
) :

653 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
vÎ
));

654 
p
 = 
	`zli¡Next
(
o
->
±r
,p);

656 
cursÜ
 = 0;

658 
	`£rv”Pªic
("Not handledƒncoding in SCAN.");

662 
node
 = 
	`li¡Fœ¡
(
keys
);

663 
node
) {

664 
robj
 *
kobj
 = 
	`li¡NodeV®ue
(
node
);

665 
ÃxŠode
 = 
	`li¡NextNode
(
node
);

666 
f‹r
 = 0;

669 ià(!
f‹r
 && 
u£_·‰”n
) {

670 ià(
	`sdsEncodedObjeù
(
kobj
)) {

671 ià(!
	`¡ršgm©chËn
(
·t
, 
·’
, 
kobj
->
±r
, 
	`sd¦’
(kobj->ptr), 0))

672 
f‹r
 = 1;

674 
buf
[
LONG_STR_SIZE
];

675 
Ën
;

677 
	`£rv”As£¹
(
kobj
->
’codšg
 =ğ
OBJ_ENCODING_INT
);

678 
Ën
 = 
	`Î2¡ršg
(
buf
,(buf),()
kobj
->
±r
);

679 ià(!
	`¡ršgm©chËn
(
·t
, 
·’
, 
buf
, 
Ën
, 0)è
f‹r
 = 1;

684 ià(!
f‹r
 && 
o
 =ğ
NULL
 && 
	`expœeIfN“ded
(
c
->
db
, 
kobj
)) filter = 1;

687 ià(
f‹r
) {

688 
	`deüRefCouÁ
(
kobj
);

689 
	`li¡D–Node
(
keys
, 
node
);

695 ià(
o
 && (o->
ty³
 =ğ
OBJ_ZSET
 || o->ty³ =ğ
OBJ_HASH
)) {

696 
node
 = 
ÃxŠode
;

697 
ÃxŠode
 = 
	`li¡NextNode
(
node
);

698 ià(
f‹r
) {

699 
kobj
 = 
	`li¡NodeV®ue
(
node
);

700 
	`deüRefCouÁ
(
kobj
);

701 
	`li¡D–Node
(
keys
, 
node
);

704 
node
 = 
ÃxŠode
;

708 
	`addR•lyMuÉiBulkL’
(
c
, 2);

709 
	`addR•lyBulkLÚgLÚg
(
c
,
cursÜ
);

711 
	`addR•lyMuÉiBulkL’
(
c
, 
	`li¡L’gth
(
keys
));

712 (
node
 = 
	`li¡Fœ¡
(
keys
)è!ğ
NULL
) {

713 
robj
 *
kobj
 = 
	`li¡NodeV®ue
(
node
);

714 
	`addR•lyBulk
(
c
, 
kobj
);

715 
	`deüRefCouÁ
(
kobj
);

716 
	`li¡D–Node
(
keys
, 
node
);

719 
ş—nup
:

720 
	`li¡S‘F»eM‘hod
(
keys
,
deüRefCouÁVoid
);

721 
	`li¡R–—£
(
keys
);

722 
	}
}

725 
	$sÿnCommªd
(
ş›Á
 *
c
) {

726 
cursÜ
;

727 ià(
	`·r£SÿnCursÜOrR•ly
(
c
,c->
¬gv
[1],&
cursÜ
è=ğ
C_ERR
) ;

728 
	`sÿnG’”icCommªd
(
c
,
NULL
,
cursÜ
);

729 
	}
}

731 
	$dbsizeCommªd
(
ş›Á
 *
c
) {

732 
	`addR•lyLÚgLÚg
(
c
,
	`diùSize
(c->
db
->
diù
));

733 
	}
}

735 
	$Ï¡§veCommªd
(
ş›Á
 *
c
) {

736 
	`addR•lyLÚgLÚg
(
c
,
£rv”
.
Ï¡§ve
);

737 
	}
}

739 
	$ty³Commªd
(
ş›Á
 *
c
) {

740 
robj
 *
o
;

741 *
ty³
;

743 
o
 = 
	`lookupKeyR—dW™hFÏgs
(
c
->
db
,c->
¬gv
[1],
LOOKUP_NOTOUCH
);

744 ià(
o
 =ğ
NULL
) {

745 
ty³
 = "none";

747 
o
->
ty³
) {

748 
OBJ_STRING
: 
ty³
 = "string"; ;

749 
OBJ_LIST
: 
ty³
 = "list"; ;

750 
OBJ_SET
: 
ty³
 = "set"; ;

751 
OBJ_ZSET
: 
ty³
 = "zset"; ;

752 
OBJ_HASH
: 
ty³
 = "hash"; ;

753 : 
ty³
 = "unknown"; ;

756 
	`addR•lyStus
(
c
,
ty³
);

757 
	}
}

759 
	$shutdownCommªd
(
ş›Á
 *
c
) {

760 
æags
 = 0;

762 ià(
c
->
¬gc
 > 2) {

763 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

765 } ià(
c
->
¬gc
 == 2) {

766 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"nosave")) {

767 
æags
 |ğ
SHUTDOWN_NOSAVE
;

768 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"save")) {

769 
æags
 |ğ
SHUTDOWN_SAVE
;

771 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

781 ià(
£rv”
.
lßdšg
 || s”v”.
£Áš–_mode
)

782 
æags
 = (æag & ~
SHUTDOWN_SAVE
è| 
SHUTDOWN_NOSAVE
;

783 ià(
	`´•¬eFÜShutdown
(
æags
è=ğ
C_OK
è
	`ex™
(0);

784 
	`addR•lyE¼Ü
(
c
,"Errorsryingo SHUTDOWN. Check†ogs.");

785 
	}
}

787 
	$»ÇmeG’”icCommªd
(
ş›Á
 *
c
, 
nx
) {

788 
robj
 *
o
;

789 
expœe
;

790 
§mekey
 = 0;

794 ià(
	`sdscmp
(
c
->
¬gv
[1]->
±r
,c->¬gv[2]->±rè=ğ0è
§mekey
 = 1;

796 ià((
o
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
nokey”r
)è=ğ
NULL
)

799 ià(
§mekey
) {

800 
	`addR•ly
(
c
,
nx
 ? 
sh¬ed
.
cz”o
 : sh¬ed.
ok
);

804 
	`šüRefCouÁ
(
o
);

805 
expœe
 = 
	`g‘Expœe
(
c
->
db
,c->
¬gv
[1]);

806 ià(
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[2]è!ğ
NULL
) {

807 ià(
nx
) {

808 
	`deüRefCouÁ
(
o
);

809 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

814 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[2]);

816 
	`dbAdd
(
c
->
db
,c->
¬gv
[2],
o
);

817 ià(
expœe
 !ğ-1è
	`£tExpœe
(
c
->
db
,c->
¬gv
[2],expire);

818 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

819 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

820 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[2]);

821 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"rename_from",

822 
c
->
¬gv
[1],c->
db
->
id
);

823 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"rename_to",

824 
c
->
¬gv
[2],c->
db
->
id
);

825 
£rv”
.
dœty
++;

826 
	`addR•ly
(
c
,
nx
 ? 
sh¬ed
.
cÚe
 : sh¬ed.
ok
);

827 
	}
}

829 
	$»ÇmeCommªd
(
ş›Á
 *
c
) {

830 
	`»ÇmeG’”icCommªd
(
c
,0);

831 
	}
}

833 
	$»Çm’xCommªd
(
ş›Á
 *
c
) {

834 
	`»ÇmeG’”icCommªd
(
c
,1);

835 
	}
}

837 
	$moveCommªd
(
ş›Á
 *
c
) {

838 
robj
 *
o
;

839 
»disDb
 *
¤c
, *
d¡
;

840 
¤cid
;

841 
dbid
, 
expœe
;

843 ià(
£rv”
.
şu¡”_’abËd
) {

844 
	`addR•lyE¼Ü
(
c
,"MOVE is‚ot‡llowed in cluster mode");

849 
¤c
 = 
c
->
db
;

850 
¤cid
 = 
c
->
db
->
id
;

852 ià(
	`g‘LÚgLÚgFromObjeù
(
c
->
¬gv
[2],&
dbid
è=ğ
C_ERR
 ||

853 
dbid
 < 
INT_MIN
 || dbid > 
INT_MAX
 ||

854 
	`£ËùDb
(
c
,
dbid
è=ğ
C_ERR
)

856 
	`addR•ly
(
c
,
sh¬ed
.
outoäªg“¼
);

859 
d¡
 = 
c
->
db
;

860 
	`£ËùDb
(
c
,
¤cid
);

864 ià(
¤c
 =ğ
d¡
) {

865 
	`addR•ly
(
c
,
sh¬ed
.
§meobjeù”r
);

870 
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

871 ià(!
o
) {

872 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

875 
expœe
 = 
	`g‘Expœe
(
c
->
db
,c->
¬gv
[1]);

878 ià(
	`lookupKeyWr™e
(
d¡
,
c
->
¬gv
[1]è!ğ
NULL
) {

879 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

882 
	`dbAdd
(
d¡
,
c
->
¬gv
[1],
o
);

883 ià(
expœe
 !ğ-1è
	`£tExpœe
(
d¡
,
c
->
¬gv
[1],expire);

884 
	`šüRefCouÁ
(
o
);

887 
	`dbD–‘e
(
¤c
,
c
->
¬gv
[1]);

888 
£rv”
.
dœty
++;

889 
	`addR•ly
(
c
,
sh¬ed
.
cÚe
);

890 
	}
}

896 
	$»moveExpœe
(
»disDb
 *
db
, 
robj
 *
key
) {

899 
	`£rv”As£¹W™hInfo
(
NULL
,
key
,
	`diùFšd
(
db
->
diù
,key->
±r
) != NULL);

900  
	`diùD–‘e
(
db
->
expœes
,
key
->
±r
è=ğ
DICT_OK
;

901 
	}
}

903 
	$£tExpœe
(
»disDb
 *
db
, 
robj
 *
key
, 
wh’
) {

904 
diùEÁry
 *
kde
, *
de
;

907 
kde
 = 
	`diùFšd
(
db
->
diù
,
key
->
±r
);

908 
	`£rv”As£¹W™hInfo
(
NULL
,
key
,
kde
 != NULL);

909 
de
 = 
	`diùR•ÏûRaw
(
db
->
expœes
,
	`diùG‘Key
(
kde
));

910 
	`diùS‘SigÃdIÁeg”V®
(
de
,
wh’
);

911 
	}
}

915 
	$g‘Expœe
(
»disDb
 *
db
, 
robj
 *
key
) {

916 
diùEÁry
 *
de
;

919 ià(
	`diùSize
(
db
->
expœes
) == 0 ||

920 (
de
 = 
	`diùFšd
(
db
->
expœes
,
key
->
±r
)è=ğ
NULL
)  -1;

924 
	`£rv”As£¹W™hInfo
(
NULL
,
key
,
	`diùFšd
(
db
->
diù
,key->
±r
) != NULL);

925  
	`diùG‘SigÃdIÁeg”V®
(
de
);

926 
	}
}

936 
	$´İag©eExpœe
(
»disDb
 *
db
, 
robj
 *
key
) {

937 
robj
 *
¬gv
[2];

939 
¬gv
[0] = 
sh¬ed
.
d–
;

940 
¬gv
[1] = 
key
;

941 
	`šüRefCouÁ
(
¬gv
[0]);

942 
	`šüRefCouÁ
(
¬gv
[1]);

944 ià(
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
)

945 
	`ãedAµ’dOÆyFe
(
£rv”
.
d–Commªd
,
db
->
id
,
¬gv
,2);

946 
	`»¶iÿtiÚF“dSÏves
(
£rv”
.
¦aves
,
db
->
id
,
¬gv
,2);

948 
	`deüRefCouÁ
(
¬gv
[0]);

949 
	`deüRefCouÁ
(
¬gv
[1]);

950 
	}
}

952 
	$expœeIfN“ded
(
»disDb
 *
db
, 
robj
 *
key
) {

953 
m¡ime_t
 
wh’
 = 
	`g‘Expœe
(
db
,
key
);

954 
m¡ime_t
 
now
;

956 ià(
wh’
 < 0)  0;

959 ià(
£rv”
.
lßdšg
)  0;

966 
now
 = 
£rv”
.
lua_ÿÎ”
 ? s”v”.
lua_time_¡¬t
 : 
	`m¡ime
();

975 ià(
£rv”
.
ma¡”ho¡
 !ğ
NULL
è 
now
 > 
wh’
;

978 ià(
now
 <ğ
wh’
)  0;

981 
£rv”
.
¡©_expœedkeys
++;

982 
	`´İag©eExpœe
(
db
,
key
);

983 
	`nÙifyKey¥aûEv’t
(
NOTIFY_EXPIRED
,

984 "expœed",
key
,
db
->
id
);

985  
	`dbD–‘e
(
db
,
key
);

986 
	}
}

999 
	$expœeG’”icCommªd
(
ş›Á
 *
c
, 
ba£time
, 
un™
) {

1000 
robj
 *
key
 = 
c
->
¬gv
[1], *
·¿m
 = c->argv[2];

1001 
wh’
;

1003 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
, 
·¿m
, &
wh’
, 
NULL
è!ğ
C_OK
)

1006 ià(
un™
 =ğ
UNIT_SECONDS
è
wh’
 *= 1000;

1007 
wh’
 +ğ
ba£time
;

1010 ià(
	`lookupKeyWr™e
(
c
->
db
,
key
è=ğ
NULL
) {

1011 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

1021 ià(
wh’
 <ğ
	`m¡ime
(è&& !
£rv”
.
lßdšg
 && !£rv”.
ma¡”ho¡
) {

1022 
robj
 *
aux
;

1024 
	`£rv”As£¹W™hInfo
(
c
,
key
,
	`dbD–‘e
(c->
db
,key));

1025 
£rv”
.
dœty
++;

1028 
aux
 = 
	`ü—‹SŒšgObjeù
("DEL",3);

1029 
	`»wr™eCl›ÁCommªdVeùÜ
(
c
,2,
aux
,
key
);

1030 
	`deüRefCouÁ
(
aux
);

1031 
	`sigÇlModif›dKey
(
c
->
db
,
key
);

1032 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
key
,
c
->
db
->
id
);

1033 
	`addR•ly
(
c
, 
sh¬ed
.
cÚe
);

1036 
	`£tExpœe
(
c
->
db
,
key
,
wh’
);

1037 
	`addR•ly
(
c
,
sh¬ed
.
cÚe
);

1038 
	`sigÇlModif›dKey
(
c
->
db
,
key
);

1039 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"expœe",
key
,
c
->
db
->
id
);

1040 
£rv”
.
dœty
++;

1043 
	}
}

1045 
	$expœeCommªd
(
ş›Á
 *
c
) {

1046 
	`expœeG’”icCommªd
(
c
,
	`m¡ime
(),
UNIT_SECONDS
);

1047 
	}
}

1049 
	$expœ—tCommªd
(
ş›Á
 *
c
) {

1050 
	`expœeG’”icCommªd
(
c
,0,
UNIT_SECONDS
);

1051 
	}
}

1053 
	$³xpœeCommªd
(
ş›Á
 *
c
) {

1054 
	`expœeG’”icCommªd
(
c
,
	`m¡ime
(),
UNIT_MILLISECONDS
);

1055 
	}
}

1057 
	$³xpœ—tCommªd
(
ş›Á
 *
c
) {

1058 
	`expœeG’”icCommªd
(
c
,0,
UNIT_MILLISECONDS
);

1059 
	}
}

1061 
	$‰lG’”icCommªd
(
ş›Á
 *
c
, 
ouut_ms
) {

1062 
expœe
, 
‰l
 = -1;

1065 ià(
	`lookupKeyR—dW™hFÏgs
(
c
->
db
,c->
¬gv
[1],
LOOKUP_NOTOUCH
è=ğ
NULL
) {

1066 
	`addR•lyLÚgLÚg
(
c
,-2);

1071 
expœe
 = 
	`g‘Expœe
(
c
->
db
,c->
¬gv
[1]);

1072 ià(
expœe
 != -1) {

1073 
‰l
 = 
expœe
-
	`m¡ime
();

1074 ià(
‰l
 < 0)tl = 0;

1076 ià(
‰l
 == -1) {

1077 
	`addR•lyLÚgLÚg
(
c
,-1);

1079 
	`addR•lyLÚgLÚg
(
c
,
ouut_ms
 ? 
‰l
 : ((ttl+500)/1000));

1081 
	}
}

1083 
	$‰lCommªd
(
ş›Á
 *
c
) {

1084 
	`‰lG’”icCommªd
(
c
, 0);

1085 
	}
}

1087 
	$±Commªd
(
ş›Á
 *
c
) {

1088 
	`‰lG’”icCommªd
(
c
, 1);

1089 
	}
}

1091 
	$³rsi¡Commªd
(
ş›Á
 *
c
) {

1092 
diùEÁry
 *
de
;

1094 
de
 = 
	`diùFšd
(
c
->
db
->
diù
,c->
¬gv
[1]->
±r
);

1095 ià(
de
 =ğ
NULL
) {

1096 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

1098 ià(
	`»moveExpœe
(
c
->
db
,c->
¬gv
[1])) {

1099 
	`addR•ly
(
c
,
sh¬ed
.
cÚe
);

1100 
£rv”
.
dœty
++;

1102 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

1105 
	}
}

1108 
	$touchCommªd
(
ş›Á
 *
c
) {

1109 
touched
 = 0;

1110 
j
 = 1; j < 
c
->
¬gc
; j++)

1111 ià(
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[
j
]è!ğ
NULL
è
touched
++;

1112 
	`addR•lyLÚgLÚg
(
c
,
touched
);

1113 
	}
}

1121 *
	$g‘KeysUsšgCommªdTabË
(
»disCommªd
 *
cmd
,
robj
 **
¬gv
, 
¬gc
, *
numkeys
) {

1122 
j
, 
i
 = 0, 
Ï¡
, *
keys
;

1123 
	`UNUSED
(
¬gv
);

1125 ià(
cmd
->
fœ¡key
 == 0) {

1126 *
numkeys
 = 0;

1127  
NULL
;

1129 
Ï¡
 = 
cmd
->
Ï¡key
;

1130 ià(
Ï¡
 < 0èÏ¡ = 
¬gc
+last;

1131 
keys
 = 
	`zm®loc
(()*((
Ï¡
 - 
cmd
->
fœ¡key
)+1));

1132 
j
 = 
cmd
->
fœ¡key
; j <ğ
Ï¡
; j +ğcmd->
key¡•
) {

1133 
	`£rv”As£¹
(
j
 < 
¬gc
);

1134 
keys
[
i
++] = 
j
;

1136 *
numkeys
 = 
i
;

1137  
keys
;

1138 
	}
}

1151 *
	$g‘KeysFromCommªd
(
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
numkeys
) {

1152 ià(
cmd
->
g‘keys_´oc
) {

1153  
cmd
->
	`g‘keys_´oc
(cmd,
¬gv
,
¬gc
,
numkeys
);

1155  
	`g‘KeysUsšgCommªdTabË
(
cmd
,
¬gv
,
¬gc
,
numkeys
);

1157 
	}
}

1160 
	$g‘KeysF»eResuÉ
(*
»suÉ
) {

1161 
	`zä“
(
»suÉ
);

1162 
	}
}

1167 *
	$zuniÚIÁ”G‘Keys
(
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
numkeys
) {

1168 
i
, 
num
, *
keys
;

1169 
	`UNUSED
(
cmd
);

1171 
num
 = 
	`©oi
(
¬gv
[2]->
±r
);

1174 ià(
num
 > (
¬gc
-3)) {

1175 *
numkeys
 = 0;

1176  
NULL
;

1182 
keys
 = 
	`zm®loc
(()*(
num
+1));

1185 
i
 = 0; i < 
num
; i++è
keys
[i] = 3+i;

1188 
keys
[
num
] = 1;

1189 *
numkeys
 = 
num
+1;

1190  
keys
;

1191 
	}
}

1196 *
	$ev®G‘Keys
(
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
numkeys
) {

1197 
i
, 
num
, *
keys
;

1198 
	`UNUSED
(
cmd
);

1200 
num
 = 
	`©oi
(
¬gv
[2]->
±r
);

1203 ià(
num
 > (
¬gc
-3)) {

1204 *
numkeys
 = 0;

1205  
NULL
;

1208 
keys
 = 
	`zm®loc
(()*
num
);

1209 *
numkeys
 = 
num
;

1212 
i
 = 0; i < 
num
; i++è
keys
[i] = 3+i;

1214  
keys
;

1215 
	}
}

1224 *
	$sÜtG‘Keys
(
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
numkeys
) {

1225 
i
, 
j
, 
num
, *
keys
, 
found_¡Üe
 = 0;

1226 
	`UNUSED
(
cmd
);

1228 
num
 = 0;

1229 
keys
 = 
	`zm®loc
(()*2);

1231 
keys
[
num
++] = 1;

1238 *
Çme
;

1239 
sk
;

1240 } 
skli¡
[] = {

1244 {
NULL
, 0}

1247 
i
 = 2; i < 
¬gc
; i++) {

1248 
j
 = 0; 
skli¡
[j].
Çme
 !ğ
NULL
; j++) {

1249 ià(!
	`¡rÿ£cmp
(
¬gv
[
i
]->
±r
,
skli¡
[
j
].
Çme
)) {

1250 
i
 +ğ
skli¡
[
j
].
sk
;

1252 } ià(!
	`¡rÿ£cmp
(
¬gv
[
i
]->
±r
,"¡Üe"è&& i+1 < 
¬gc
) {

1256 
found_¡Üe
 = 1;

1257 
keys
[
num
] = 
i
+1;

1262 *
numkeys
 = 
num
 + 
found_¡Üe
;

1263  
keys
;

1264 
	}
}

1266 *
	$mig¿‹G‘Keys
(
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
numkeys
) {

1267 
i
, 
num
, 
fœ¡
, *
keys
;

1268 
	`UNUSED
(
cmd
);

1271 
fœ¡
 = 3;

1272 
num
 = 1;

1275 ià(
¬gc
 > 6) {

1276 
i
 = 6; i < 
¬gc
; i++) {

1277 ià(!
	`¡rÿ£cmp
(
¬gv
[
i
]->
±r
,"keys") &&

1278 
	`sd¦’
(
¬gv
[3]->
±r
) == 0)

1280 
fœ¡
 = 
i
+1;

1281 
num
 = 
¬gc
-
fœ¡
;

1287 
keys
 = 
	`zm®loc
(()*
num
);

1288 
i
 = 0; i < 
num
; i++è
keys
[i] = 
fœ¡
+i;

1289 *
numkeys
 = 
num
;

1290  
keys
;

1291 
	}
}

1296 
	$¦ÙToKeyAdd
(
robj
 *
key
) {

1297 
hash¦Ù
 = 
	`keyHashSlÙ
(
key
->
±r
,
	`sd¦’
(key->ptr));

1299 
	`z¦In£¹
(
£rv”
.
şu¡”
->
¦Ùs_to_keys
,
hash¦Ù
,
key
);

1300 
	`šüRefCouÁ
(
key
);

1301 
	}
}

1303 
	$¦ÙToKeyD–
(
robj
 *
key
) {

1304 
hash¦Ù
 = 
	`keyHashSlÙ
(
key
->
±r
,
	`sd¦’
(key->ptr));

1306 
	`z¦D–‘e
(
£rv”
.
şu¡”
->
¦Ùs_to_keys
,
hash¦Ù
,
key
);

1307 
	}
}

1309 
	$¦ÙToKeyFlush
() {

1310 
	`z¦F»e
(
£rv”
.
şu¡”
->
¦Ùs_to_keys
);

1311 
£rv”
.
şu¡”
->
¦Ùs_to_keys
 = 
	`z¦C»©e
();

1312 
	}
}

1314 
	$g‘KeysInSlÙ
(
hash¦Ù
, 
robj
 **
keys
, 
couÁ
) {

1315 
zskli¡Node
 *
n
;

1316 
z¿nge¥ec
 
¿nge
;

1317 
j
 = 0;

1319 
¿nge
.
mš
 =„ªge.
max
 = 
hash¦Ù
;

1320 
¿nge
.
mšex
 =„ªge.
maxex
 = 0;

1322 
n
 = 
	`z¦Fœ¡InRªge
(
£rv”
.
şu¡”
->
¦Ùs_to_keys
, &
¿nge
);

1323 
n
 &&‚->
scÜe
 =ğ
hash¦Ù
 && 
couÁ
--) {

1324 
keys
[
j
++] = 
n
->
obj
;

1325 
n
 =‚->
Ëv–
[0].
fÜw¬d
;

1327  
j
;

1328 
	}
}

1332 
	$d–KeysInSlÙ
(
hash¦Ù
) {

1333 
zskli¡Node
 *
n
;

1334 
z¿nge¥ec
 
¿nge
;

1335 
j
 = 0;

1337 
¿nge
.
mš
 =„ªge.
max
 = 
hash¦Ù
;

1338 
¿nge
.
mšex
 =„ªge.
maxex
 = 0;

1340 
n
 = 
	`z¦Fœ¡InRªge
(
£rv”
.
şu¡”
->
¦Ùs_to_keys
, &
¿nge
);

1341 
n
 &&‚->
scÜe
 =ğ
hash¦Ù
) {

1342 
robj
 *
key
 = 
n
->
obj
;

1343 
n
 =‚->
Ëv–
[0].
fÜw¬d
;

1344 
	`šüRefCouÁ
(
key
);

1345 
	`dbD–‘e
(&
£rv”
.
db
[0],
key
);

1346 
	`deüRefCouÁ
(
key
);

1347 
j
++;

1349  
j
;

1350 
	}
}

1352 
	$couÁKeysInSlÙ
(
hash¦Ù
) {

1353 
zskli¡
 *
z¦
 = 
£rv”
.
şu¡”
->
¦Ùs_to_keys
;

1354 
zskli¡Node
 *
zn
;

1355 
z¿nge¥ec
 
¿nge
;

1356 
¿nk
, 
couÁ
 = 0;

1358 
¿nge
.
mš
 =„ªge.
max
 = 
hash¦Ù
;

1359 
¿nge
.
mšex
 =„ªge.
maxex
 = 0;

1362 
zn
 = 
	`z¦Fœ¡InRªge
(
z¦
, &
¿nge
);

1365 ià(
zn
 !ğ
NULL
) {

1366 
¿nk
 = 
	`z¦G‘Rªk
(
z¦
, 
zn
->
scÜe
, zn->
obj
);

1367 
couÁ
 = (
z¦
->
Ëngth
 - (
¿nk
 - 1));

1370 
zn
 = 
	`z¦La¡InRªge
(
z¦
, &
¿nge
);

1373 ià(
zn
 !ğ
NULL
) {

1374 
¿nk
 = 
	`z¦G‘Rªk
(
z¦
, 
zn
->
scÜe
, zn->
obj
);

1375 
couÁ
 -ğ(
z¦
->
Ëngth
 - 
¿nk
);

1378  
couÁ
;

1379 
	}
}

	@src/debug.c

30 
	~"£rv”.h
"

31 
	~"sha1.h
"

32 
	~"üc64.h
"

34 
	~<¬·/š‘.h
>

35 
	~<sigÇl.h
>

37 #ifdeà
HAVE_BACKTRACE


38 
	~<execšfo.h
>

39 
	~<ucÚ‹xt.h
>

40 
	~<fú.h
>

41 
	~"bio.h
"

42 
	~<uni¡d.h
>

43 
	~<dlfú.h
>

46 #ifdeà
__CYGWIN__


47 #iâdeà
SA_ONSTACK


48 
	#SA_ONSTACK
 0x08000000

	)

60 
	$xÜDige¡
(*
dige¡
, *
±r
, 
size_t
 
Ën
) {

61 
SHA1_CTX
 
ùx
;

62 
hash
[20], *
s
 = 
±r
;

63 
j
;

65 
	`SHA1In™
(&
ùx
);

66 
	`SHA1Upd©e
(&
ùx
,
s
,
Ën
);

67 
	`SHA1Fš®
(
hash
,&
ùx
);

69 
j
 = 0; j < 20; j++)

70 
dige¡
[
j
] ^ğ
hash
[j];

71 
	}
}

73 
	$xÜObjeùDige¡
(*
dige¡
, 
robj
 *
o
) {

74 
o
 = 
	`g‘DecodedObjeù
(o);

75 
	`xÜDige¡
(
dige¡
,
o
->
±r
,
	`sd¦’
(o->ptr));

76 
	`deüRefCouÁ
(
o
);

77 
	}
}

93 
	$mixDige¡
(*
dige¡
, *
±r
, 
size_t
 
Ën
) {

94 
SHA1_CTX
 
ùx
;

95 *
s
 = 
±r
;

97 
	`xÜDige¡
(
dige¡
,
s
,
Ën
);

98 
	`SHA1In™
(&
ùx
);

99 
	`SHA1Upd©e
(&
ùx
,
dige¡
,20);

100 
	`SHA1Fš®
(
dige¡
,&
ùx
);

101 
	}
}

103 
	$mixObjeùDige¡
(*
dige¡
, 
robj
 *
o
) {

104 
o
 = 
	`g‘DecodedObjeù
(o);

105 
	`mixDige¡
(
dige¡
,
o
->
±r
,
	`sd¦’
(o->ptr));

106 
	`deüRefCouÁ
(
o
);

107 
	}
}

115 
	$compu‹D©a£tDige¡
(*
fš®
) {

116 
dige¡
[20];

117 
buf
[128];

118 
diùI‹¿tÜ
 *
di
 = 
NULL
;

119 
diùEÁry
 *
de
;

120 
j
;

121 
ušt32_t
 
aux
;

123 
	`mem£t
(
fš®
,0,20);

125 
j
 = 0; j < 
£rv”
.
dbnum
; j++) {

126 
»disDb
 *
db
 = 
£rv”
.db+
j
;

128 ià(
	`diùSize
(
db
->
diù
) == 0) ;

129 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
db
->
diù
);

133 
aux
 = 
	`htÚl
(
j
);

134 
	`mixDige¡
(
fš®
,&
aux
,(aux));

137 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

138 
sds
 
key
;

139 
robj
 *
keyobj
, *
o
;

140 
expœ‘ime
;

142 
	`mem£t
(
dige¡
,0,20);

143 
key
 = 
	`diùG‘Key
(
de
);

144 
keyobj
 = 
	`ü—‹SŒšgObjeù
(
key
,
	`sd¦’
(key));

146 
	`mixDige¡
(
dige¡
,
key
,
	`sd¦’
(key));

148 
o
 = 
	`diùG‘V®
(
de
);

150 
aux
 = 
	`htÚl
(
o
->
ty³
);

151 
	`mixDige¡
(
dige¡
,&
aux
,(aux));

152 
expœ‘ime
 = 
	`g‘Expœe
(
db
,
keyobj
);

155 ià(
o
->
ty³
 =ğ
OBJ_STRING
) {

156 
	`mixObjeùDige¡
(
dige¡
,
o
);

157 } ià(
o
->
ty³
 =ğ
OBJ_LIST
) {

158 
li¡Ty³I‹¿tÜ
 *
li
 = 
	`li¡Ty³In™I‹¿tÜ
(
o
,0,
REDIS_LIST_TAIL
);

159 
li¡Ty³EÁry
 
’Œy
;

160 
	`li¡Ty³Next
(
li
,&
’Œy
)) {

161 
robj
 *
–eobj
 = 
	`li¡Ty³G‘
(&
’Œy
);

162 
	`mixObjeùDige¡
(
dige¡
,
–eobj
);

163 
	`deüRefCouÁ
(
–eobj
);

165 
	`li¡Ty³R–—£I‹¿tÜ
(
li
);

166 } ià(
o
->
ty³
 =ğ
OBJ_SET
) {

167 
£tTy³I‹¿tÜ
 *
si
 = 
	`£tTy³In™I‹¿tÜ
(
o
);

168 
robj
 *
–e
;

169 (
–e
 = 
	`£tTy³NextObjeù
(
si
)è!ğ
NULL
) {

170 
	`xÜObjeùDige¡
(
dige¡
,
–e
);

171 
	`deüRefCouÁ
(
–e
);

173 
	`£tTy³R–—£I‹¿tÜ
(
si
);

174 } ià(
o
->
ty³
 =ğ
OBJ_ZSET
) {

175 
–edige¡
[20];

177 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

178 *
zl
 = 
o
->
±r
;

179 *
•Œ
, *
¥Œ
;

180 *
v¡r
;

181 
vËn
;

182 
vÎ
;

183 
scÜe
;

185 
•Œ
 = 
	`zli¡Index
(
zl
,0);

186 
	`£rv”As£¹
(
•Œ
 !ğ
NULL
);

187 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

188 
	`£rv”As£¹
(
¥Œ
 !ğ
NULL
);

190 
•Œ
 !ğ
NULL
) {

191 
	`£rv”As£¹
(
	`zli¡G‘
(
•Œ
,&
v¡r
,&
vËn
,&
vÎ
));

192 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

194 
	`mem£t
(
–edige¡
,0,20);

195 ià(
v¡r
 !ğ
NULL
) {

196 
	`mixDige¡
(
–edige¡
,
v¡r
,
vËn
);

198 
	`Î2¡ršg
(
buf
,(buf),
vÎ
);

199 
	`mixDige¡
(
–edige¡
,
buf
,
	`¡¾’
(buf));

202 
	`¢´štf
(
buf
,(buf),"%.17g",
scÜe
);

203 
	`mixDige¡
(
–edige¡
,
buf
,
	`¡¾’
(buf));

204 
	`xÜDige¡
(
dige¡
,
–edige¡
,20);

205 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

207 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

208 
z£t
 *
zs
 = 
o
->
±r
;

209 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘I‹¿tÜ
(
zs
->
diù
);

210 
diùEÁry
 *
de
;

212 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

213 
robj
 *
–eobj
 = 
	`diùG‘Key
(
de
);

214 *
scÜe
 = 
	`diùG‘V®
(
de
);

216 
	`¢´štf
(
buf
,(buf),"%.17g",*
scÜe
);

217 
	`mem£t
(
–edige¡
,0,20);

218 
	`mixObjeùDige¡
(
–edige¡
,
–eobj
);

219 
	`mixDige¡
(
–edige¡
,
buf
,
	`¡¾’
(buf));

220 
	`xÜDige¡
(
dige¡
,
–edige¡
,20);

222 
	`diùR–—£I‹¿tÜ
(
di
);

224 
	`£rv”Pªic
("Unknown sorted setƒncoding");

226 } ià(
o
->
ty³
 =ğ
OBJ_HASH
) {

227 
hashTy³I‹¿tÜ
 *
hi
;

228 
robj
 *
obj
;

230 
hi
 = 
	`hashTy³In™I‹¿tÜ
(
o
);

231 
	`hashTy³Next
(
hi
è!ğ
C_ERR
) {

232 
–edige¡
[20];

234 
	`mem£t
(
–edige¡
,0,20);

235 
obj
 = 
	`hashTy³Cu¼’tObjeù
(
hi
,
OBJ_HASH_KEY
);

236 
	`mixObjeùDige¡
(
–edige¡
,
obj
);

237 
	`deüRefCouÁ
(
obj
);

238 
obj
 = 
	`hashTy³Cu¼’tObjeù
(
hi
,
OBJ_HASH_VALUE
);

239 
	`mixObjeùDige¡
(
–edige¡
,
obj
);

240 
	`deüRefCouÁ
(
obj
);

241 
	`xÜDige¡
(
dige¡
,
–edige¡
,20);

243 
	`hashTy³R–—£I‹¿tÜ
(
hi
);

245 
	`£rv”Pªic
("Unknown objectype");

248 ià(
expœ‘ime
 !ğ-1è
	`xÜDige¡
(
dige¡
,"!!expire!!",10);

250 
	`xÜDige¡
(
fš®
,
dige¡
,20);

251 
	`deüRefCouÁ
(
keyobj
);

253 
	`diùR–—£I‹¿tÜ
(
di
);

255 
	}
}

257 #ià
defšed
(
USE_JEMALLOC
)

258 
	$šputC©Sds
(*
»suÉ
, cÚ¡ *
¡r
) {

260 
sds
 *
šfo
 = (sd *)
»suÉ
;

261 *
šfo
 = 
	`sdsÿt
(*šfo, 
¡r
);

262 
	}
}

265 
	$debugCommªd
(
ş›Á
 *
c
) {

266 ià(
c
->
¬gc
 == 1) {

267 
	`addR•lyE¼Ü
(
c
,"You must specify‡ subcommand for DEBUG. Try DEBUG HELP for info.");

271 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"help")) {

272 *
bËÅ
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

273 
bËn
 = 0;

274 
bËn
++; 
	`addR•lyStus
(
c
,

276 
bËn
++; 
	`addR•lyStus
(
c
,

278 
bËn
++; 
	`addR•lyStus
(
c
,

280 
bËn
++; 
	`addR•lyStus
(
c
,

282 
bËn
++; 
	`addR•lyStus
(
c
,

284 
bËn
++; 
	`addR•lyStus
(
c
,

286 
bËn
++; 
	`addR•lyStus
(
c
,

288 
bËn
++; 
	`addR•lyStus
(
c
,

290 
bËn
++; 
	`addR•lyStus
(
c
,

292 
bËn
++; 
	`addR•lyStus
(
c
,

294 
bËn
++; 
	`addR•lyStus
(
c
,

296 
bËn
++; 
	`addR•lyStus
(
c
,

298 
bËn
++; 
	`addR•lyStus
(
c
,

300 
bËn
++; 
	`addR•lyStus
(
c
,

302 
bËn
++; 
	`addR•lyStus
(
c
,

304 
bËn
++; 
	`addR•lyStus
(
c
,

306 
bËn
++; 
	`addR•lyStus
(
c
,

308 
bËn
++; 
	`addR•lyStus
(
c
,

310 
bËn
++; 
	`addR•lyStus
(
c
,

312 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
bËÅ
,
bËn
);

313 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"segfault")) {

315 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"restart") ||

316 !
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"crash-and-recover"))

318 
d–ay
 = 0;

319 ià(
c
->
¬gc
 >= 3) {

320 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
d–ay
, 
NULL
)

321 !ğ
C_OK
) ;

322 ià(
d–ay
 < 0) delay = 0;

324 
æags
 = !
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"restart") ?

325 (
RESTART_SERVER_GRACEFULLY
|
RESTART_SERVER_CONFIG_REWRITE
) :

326 
RESTART_SERVER_NONE
;

327 
	`»¡¬tS”v”
(
æags
,
d–ay
);

328 
	`addR•lyE¼Ü
(
c
,"failedo„estarthe server. Check server†ogs.");

329 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"oom")) {

330 *
±r
 = 
	`zm®loc
(
ULONG_MAX
);

331 
	`zä“
(
±r
);

332 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

333 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"assert")) {

334 ià(
c
->
¬gc
 >ğ3èc->
¬gv
[2] = 
	`ŒyObjeùEncodšg
(c->argv[2]);

335 
	`£rv”As£¹W™hInfo
(
c
,c->
¬gv
[0],1 == 2);

336 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"reload")) {

337 ià(
	`rdbSave
(
£rv”
.
rdb_f’ame
è!ğ
C_OK
) {

338 
	`addR•ly
(
c
,
sh¬ed
.
”r
);

341 
	`em±yDb
(
NULL
);

342 ià(
	`rdbLßd
(
£rv”
.
rdb_f’ame
è!ğ
C_OK
) {

343 
	`addR•lyE¼Ü
(
c
,"Errorryingo†oadhe RDB dump");

346 
	`£rv”Log
(
LL_WARNING
,"DB„eloaded by DEBUG RELOAD");

347 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

348 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"loadaof")) {

349 ià(
£rv”
.
aof_¡©e
 =ğ
AOF_ON
è
	`æushAµ’dOÆyFe
(1);

350 
	`em±yDb
(
NULL
);

351 ià(
	`lßdAµ’dOÆyFe
(
£rv”
.
aof_f’ame
è!ğ
C_OK
) {

352 
	`addR•ly
(
c
,
sh¬ed
.
”r
);

355 
£rv”
.
dœty
 = 0;

356 
	`£rv”Log
(
LL_WARNING
,"Append Only File†oaded by DEBUG LOADAOF");

357 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

358 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"objeù"è&& c->
¬gc
 == 3) {

359 
diùEÁry
 *
de
;

360 
robj
 *
v®
;

361 *
¡»nc
;

363 ià((
de
 = 
	`diùFšd
(
c
->
db
->
diù
,c->
¬gv
[2]->
±r
)è=ğ
NULL
) {

364 
	`addR•ly
(
c
,
sh¬ed
.
nokey”r
);

367 
v®
 = 
	`diùG‘V®
(
de
);

368 
¡»nc
 = 
	`¡rEncodšg
(
v®
->
’codšg
);

370 
exŒa
[128] = {0};

371 ià(
v®
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

372 *
ÃxŒa
 = 
exŒa
;

373 
»maššg
 = (
exŒa
);

374 
quickli¡
 *
ql
 = 
v®
->
±r
;

376 
u£d
 = 
	`¢´štf
(
ÃxŒa
, 
»maššg
, " ql_nodes:%u", 
ql
->
Ën
);

377 
ÃxŒa
 +ğ
u£d
;

378 
»maššg
 -ğ
u£d
;

380 
avg
 = ()
ql
->
couÁ
/ql->
Ën
;

381 
u£d
 = 
	`¢´štf
(
ÃxŒa
, 
»maššg
, " ql_avg_node:%.2f", 
avg
);

382 
ÃxŒa
 +ğ
u£d
;

383 
»maššg
 -ğ
u£d
;

385 
u£d
 = 
	`¢´štf
(
ÃxŒa
, 
»maššg
, " ql_zli¡_max:%d", 
ql
->
fl
);

386 
ÃxŒa
 +ğ
u£d
;

387 
»maššg
 -ğ
u£d
;

389 
com´es£d
 = 
ql
->
com´ess
 != 0;

390 
u£d
 = 
	`¢´štf
(
ÃxŒa
, 
»maššg
, " ql_com´es£d:%d", 
com´es£d
);

391 
ÃxŒa
 +ğ
u£d
;

392 
»maššg
 -ğ
u£d
;

394 
sz
 = 0;

395 
quickli¡Node
 *
node
 = 
ql
->
h—d
;‚ode;‚odğnode->
Ãxt
) {

396 
sz
 +ğ
node
->sz;

398 
u£d
 = 
	`¢´štf
(
ÃxŒa
, 
»maššg
, " ql_uncom´es£d_size:%lu", 
sz
);

399 
ÃxŒa
 +ğ
u£d
;

400 
»maššg
 -ğ
u£d
;

403 
	`addR•lyStusFÜm©
(
c
,

407 (*)
v®
, v®->
»fcouÁ
,

408 
¡»nc
, 
	`rdbSavedObjeùL’
(
v®
),

409 
v®
->
Ìu
, 
	`e¡im©eObjeùIdËTime
(v®)/1000, 
exŒa
);

410 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"sd¦’"è&& c->
¬gc
 == 3) {

411 
diùEÁry
 *
de
;

412 
robj
 *
v®
;

413 
sds
 
key
;

415 ià((
de
 = 
	`diùFšd
(
c
->
db
->
diù
,c->
¬gv
[2]->
±r
)è=ğ
NULL
) {

416 
	`addR•ly
(
c
,
sh¬ed
.
nokey”r
);

419 
v®
 = 
	`diùG‘V®
(
de
);

420 
key
 = 
	`diùG‘Key
(
de
);

422 ià(
v®
->
ty³
 !ğ
OBJ_STRING
 || !
	`sdsEncodedObjeù
(val)) {

423 
	`addR•lyE¼Ü
(
c
,"Not‡n sdsƒncoded string.");

425 
	`addR•lyStusFÜm©
(
c
,

428 (è
	`sd¦’
(
key
),

429 (è
	`sd§va
(
key
),

430 (è
	`sd¦’
(
v®
->
±r
),

431 (è
	`sd§va
(
v®
->
±r
));

433 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"populate") &&

434 (
c
->
¬gc
 == 3 || c->argc == 4)) {

435 
keys
, 
j
;

436 
robj
 *
key
, *
v®
;

437 
buf
[128];

439 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
keys
, 
NULL
è!ğ
C_OK
)

441 
	`diùEx·nd
(
c
->
db
->
diù
,
keys
);

442 
j
 = 0; j < 
keys
; j++) {

443 
	`¢´štf
(
buf
,(buf),"%s:%lu",

444 (
c
->
¬gc
 =ğ3è? "key" : (*)c->
¬gv
[3]->
±r
, 
j
);

445 
key
 = 
	`ü—‹SŒšgObjeù
(
buf
,
	`¡¾’
(buf));

446 ià(
	`lookupKeyWr™e
(
c
->
db
,
key
è!ğ
NULL
) {

447 
	`deüRefCouÁ
(
key
);

450 
	`¢´štf
(
buf
,(buf),"v®ue:%lu",
j
);

451 
v®
 = 
	`ü—‹SŒšgObjeù
(
buf
,
	`¡¾’
(buf));

452 
	`dbAdd
(
c
->
db
,
key
,
v®
);

453 
	`sigÇlModif›dKey
(
c
->
db
,
key
);

454 
	`deüRefCouÁ
(
key
);

456 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

457 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"dige¡"è&& c->
¬gc
 == 2) {

458 
dige¡
[20];

459 
sds
 
d
 = 
	`sd£m±y
();

460 
j
;

462 
	`compu‹D©a£tDige¡
(
dige¡
);

463 
j
 = 0; j < 20; j++)

464 
d
 = 
	`sdsÿrštf
(d, "%02x",
dige¡
[
j
]);

465 
	`addR•lyStus
(
c
,
d
);

466 
	`sdsä“
(
d
);

467 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"¦“p"è&& c->
¬gc
 == 3) {

468 
dtime
 = 
	`¡¹od
(
c
->
¬gv
[2]->
±r
,
NULL
);

469 
utime
 = 
dtime
*1000000;

470 
time¥ec
 
tv
;

472 
tv
.
tv_£c
 = 
utime
 / 1000000;

473 
tv
.
tv_n£c
 = (
utime
 % 1000000) * 1000;

474 
	`Çno¦“p
(&
tv
, 
NULL
);

475 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

476 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"set-active-expire") &&

477 
c
->
¬gc
 == 3)

479 
£rv”
.
aùive_expœe_’abËd
 = 
	`©oi
(
c
->
¬gv
[2]->
±r
);

480 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

481 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"lua-always-replicate-commands") &&

482 
c
->
¬gc
 == 3)

484 
£rv”
.
lua_®ways_»¶iÿ‹_commªds
 = 
	`©oi
(
c
->
¬gv
[2]->
±r
);

485 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

486 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"”rÜ"è&& c->
¬gc
 == 3) {

487 
sds
 
”r¡r
 = 
	`sd¢ewËn
("-",1);

489 
”r¡r
 = 
	`sdsÿtsds
Ó¼¡r,
c
->
¬gv
[2]->
±r
);

490 
”r¡r
 = 
	`sdsm­ch¬s
(errstr,"\n\r"," ",2);

491 
”r¡r
 = 
	`sdsÿ’
(errstr,"\r\n",2);

492 
	`addR•lySds
(
c
,
”r¡r
);

493 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"¡ruùsize"è&& c->
¬gc
 == 2) {

494 
sds
 
sizes
 = 
	`sd£m±y
();

495 
sizes
 = 
	`sdsÿrštf
(sizes,"bits:%d ",((*) == 8)?64:32);

496 
sizes
 = 
	`sdsÿrštf
(sizes,"robj:%d ",()(
robj
));

497 
sizes
 = 
	`sdsÿrštf
(sizes,"diù’Œy:%d ",()(
diùEÁry
));

498 
sizes
 = 
	`sdsÿrštf
(sizes,"sdshdr5:%d ",()(
sdshdr5
));

499 
sizes
 = 
	`sdsÿrštf
(sizes,"sdshdr8:%d ",()(
sdshdr8
));

500 
sizes
 = 
	`sdsÿrštf
(sizes,"sdshdr16:%d ",()(
sdshdr16
));

501 
sizes
 = 
	`sdsÿrštf
(sizes,"sdshdr32:%d ",()(
sdshdr32
));

502 
sizes
 = 
	`sdsÿrštf
(sizes,"sdshdr64:%d ",()(
sdshdr64
));

503 
	`addR•lyBulkSds
(
c
,
sizes
);

504 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"ht¡©s"è&& c->
¬gc
 == 3) {

505 
dbid
;

506 
sds
 
¡©s
 = 
	`sd£m±y
();

507 
buf
[4096];

509 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
dbid
, 
NULL
è!ğ
C_OK
)

511 ià(
dbid
 < 0 || dbid >ğ
£rv”
.
dbnum
) {

512 
	`addR•lyE¼Ü
(
c
,"Out of„ange database");

516 
¡©s
 = 
	`sdsÿrštf
(stats,"[Dictionary HT]\n");

517 
	`diùG‘Sts
(
buf
,(buf),
£rv”
.
db
[
dbid
].
diù
);

518 
¡©s
 = 
	`sdsÿt
(¡©s,
buf
);

520 
¡©s
 = 
	`sdsÿrštf
(stats,"[Expires HT]\n");

521 
	`diùG‘Sts
(
buf
,(buf),
£rv”
.
db
[
dbid
].
expœes
);

522 
¡©s
 = 
	`sdsÿt
(¡©s,
buf
);

524 
	`addR•lyBulkSds
(
c
,
¡©s
);

525 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"jem®loc"è&& c->
¬gc
 == 3) {

526 #ià
	`defšed
(
USE_JEMALLOC
)

527 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
, "info")) {

528 
sds
 
šfo
 = 
	`sd£m±y
();

529 
	`je_m®loc_¡©s_´št
(
šputC©Sds
, &
šfo
, 
NULL
);

530 
	`addR•lyBulkSds
(
c
, 
šfo
);

531 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
, "purge")) {

532 
tmp
[32];

533 
Ç»Çs
 = 0;

534 
size_t
 
sz
 = ();

535 ià(!
	`je_m®lùl
("¬’as.Ç»Çs", &
Ç»Çs
, &
sz
, 
NULL
, 0)) {

536 
	`¥rštf
(
tmp
, "¬’a.%d.purge", 
Ç»Çs
);

537 ià(!
	`je_m®lùl
(
tmp
, 
NULL
, 0, NULL, 0)) {

538 
	`addR•ly
(
c
, 
sh¬ed
.
ok
);

542 
	`addR•lyE¼Ü
(
c
, "Error…urging dirty…ages");

544 
	`addR•lyE¼ÜFÜm©
(
c
, "Valid jemalloc debug fields: info,…urge");

547 
	`addR•lyE¼ÜFÜm©
(
c
, "jemalloc support‚ot‡vailable");

550 
	`addR•lyE¼ÜFÜm©
(
c
, "Unknown DEBUG subcommand or wrong‚umber of‡rguments for '%s'",

551 (*)
c
->
¬gv
[1]->
±r
);

553 
	}
}

557 
	$_£rv”As£¹
(*
e¡r
, *
fe
, 
lše
) {

558 
	`bugR•ÜtS¹
();

559 
	`£rv”Log
(
LL_WARNING
,"=== ASSERTION FAILED ===");

560 
	`£rv”Log
(
LL_WARNING
,"==> %s:%d '%s' i nÙrue",
fe
,
lše
,
e¡r
);

561 #ifdeà
HAVE_BACKTRACE


562 
£rv”
.
as£¹_çed
 = 
e¡r
;

563 
£rv”
.
as£¹_fe
 = 
fe
;

564 
£rv”
.
as£¹_lše
 = 
lše
;

565 
	`£rv”Log
(
LL_WARNING
,"(forcing SIGSEGVo…rinthe bug„eport.)");

568 
	}
}

570 
	$_£rv”As£¹PrštCl›ÁInfo
(
ş›Á
 *
c
) {

571 
j
;

573 
	`bugR•ÜtS¹
();

574 
	`£rv”Log
(
LL_WARNING
,"=== ASSERTION FAILED CLIENT CONTEXT ===");

575 
	`£rv”Log
(
LL_WARNING
,"ş›Á->æag ğ%d", 
c
->
æags
);

576 
	`£rv”Log
(
LL_WARNING
,"ş›Á->fd = %d", 
c
->
fd
);

577 
	`£rv”Log
(
LL_WARNING
,"ş›Á->¬gøğ%d", 
c
->
¬gc
);

578 
j
=0; j < 
c
->
¬gc
; j++) {

579 
buf
[128];

580 *
¬g
;

582 ià(
c
->
¬gv
[
j
]->
ty³
 =ğ
OBJ_STRING
 && 
	`sdsEncodedObjeù
(c->argv[j])) {

583 
¬g
 = (*è
c
->
¬gv
[
j
]->
±r
;

585 
	`¢´štf
(
buf
,(buf),"Objectype: %u,ƒncoding: %u",

586 
c
->
¬gv
[
j
]->
ty³
, c->¬gv[j]->
’codšg
);

587 
¬g
 = 
buf
;

589 
	`£rv”Log
(
LL_WARNING
,"client->argv[%d] = \"%s\" (refcount: %d)",

590 
j
, 
¬g
, 
c
->
¬gv
[j]->
»fcouÁ
);

592 
	}
}

594 
	$£rv”LogObjeùDebugInfo
(
robj
 *
o
) {

595 
	`£rv”Log
(
LL_WARNING
,"Objeùy³: %d", 
o
->
ty³
);

596 
	`£rv”Log
(
LL_WARNING
,"Objeùƒncodšg: %d", 
o
->
’codšg
);

597 
	`£rv”Log
(
LL_WARNING
,"Objeù„efcouÁ: %d", 
o
->
»fcouÁ
);

598 ià(
o
->
ty³
 =ğ
OBJ_STRING
 && 
	`sdsEncodedObjeù
(o)) {

599 
	`£rv”Log
(
LL_WARNING
,"Objeù„aw sŒšg†’: %zu", 
	`sd¦’
(
o
->
±r
));

600 ià(
	`sd¦’
(
o
->
±r
) < 4096) {

601 
sds
 
»´
 = 
	`sdsÿŒ•r
(
	`sd£m±y
(),
o
->
±r
,
	`sd¦’
(o->ptr));

602 
	`£rv”Log
(
LL_WARNING
,"Objeù„aw sŒšg cÚ‹Á: %s", 
»´
);

603 
	`sdsä“
(
»´
);

605 } ià(
o
->
ty³
 =ğ
OBJ_LIST
) {

606 
	`£rv”Log
(
LL_WARNING
,"Li¡†’gth: %d", (è
	`li¡Ty³L’gth
(
o
));

607 } ià(
o
->
ty³
 =ğ
OBJ_SET
) {

608 
	`£rv”Log
(
LL_WARNING
,"S‘ size: %d", (è
	`£tTy³Size
(
o
));

609 } ià(
o
->
ty³
 =ğ
OBJ_HASH
) {

610 
	`£rv”Log
(
LL_WARNING
,"Hash size: %d", (è
	`hashTy³L’gth
(
o
));

611 } ià(
o
->
ty³
 =ğ
OBJ_ZSET
) {

612 
	`£rv”Log
(
LL_WARNING
,"SÜ‹d s‘ size: %d", (è
	`z£tL’gth
(
o
));

613 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
)

614 
	`£rv”Log
(
LL_WARNING
,"Skli¡†ev–: %d", (è((
z£t
*)
o
->
±r
)->
z¦
->
Ëv–
);

616 
	}
}

618 
	$_£rv”As£¹PrštObjeù
(
robj
 *
o
) {

619 
	`bugR•ÜtS¹
();

620 
	`£rv”Log
(
LL_WARNING
,"=== ASSERTION FAILED OBJECT CONTEXT ===");

621 
	`£rv”LogObjeùDebugInfo
(
o
);

622 
	}
}

624 
	$_£rv”As£¹W™hInfo
(
ş›Á
 *
c
, 
robj
 *
o
, *
e¡r
, *
fe
, 
lše
) {

625 ià(
c
è
	`_£rv”As£¹PrštCl›ÁInfo
(c);

626 ià(
o
è
	`_£rv”As£¹PrštObjeù
(o);

627 
	`_£rv”As£¹
(
e¡r
,
fe
,
lše
);

628 
	}
}

630 
	$_£rv”Pªic
(*
msg
, *
fe
, 
lše
) {

631 
	`bugR•ÜtS¹
();

632 
	`£rv”Log
(
LL_WARNING
,"------------------------------------------------");

633 
	`£rv”Log
(
LL_WARNING
,"!!! Software Failure. Press†eft mouse buttono continue");

634 
	`£rv”Log
(
LL_WARNING
,"Guru Med™©iÚ: % #%s:%d",
msg
,
fe
,
lše
);

635 #ifdeà
HAVE_BACKTRACE


636 
	`£rv”Log
(
LL_WARNING
,"(forcing SIGSEGV in ordero…rinthe stackrace)");

638 
	`£rv”Log
(
LL_WARNING
,"------------------------------------------------");

640 
	}
}

642 
	$bugR•ÜtS¹
() {

643 ià(
£rv”
.
bug_»pÜt_¡¬t
 == 0) {

644 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
,

646 
£rv”
.
bug_»pÜt_¡¬t
 = 1;

648 
	}
}

650 #ifdeà
HAVE_BACKTRACE


651 *
	$g‘McÚ‹xtE
(
ucÚ‹xt_t
 *
uc
) {

652 #ià
	`defšed
(
__APPLE__
è&& !defšed(
MAC_OS_X_VERSION_10_6
)

654 #ià
	`defšed
(
__x86_64__
)

655  (*è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r
;

656 #–ià
	`defšed
(
__i386__
)

657  (*è
uc
->
uc_mcÚ‹xt
->
__ss
.
__e
;

659  (*è
uc
->
uc_mcÚ‹xt
->
__ss
.
__¤r0
;

661 #–ià
	`defšed
(
__APPLE__
è&& defšed(
MAC_OS_X_VERSION_10_6
)

663 #ià
	`defšed
(
_STRUCT_X86_THREAD_STATE64
è&& !defšed(
__i386__
)

664  (*è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r
;

666  (*è
uc
->
uc_mcÚ‹xt
->
__ss
.
__e
;

668 #–ià
	`defšed
(
__lšux__
)

670 #ià
	`defšed
(
__i386__
)

671  (*è
uc
->
uc_mcÚ‹xt
.
g»gs
[14];

672 #–ià
	`defšed
(
__X86_64__
è|| defšed(
__x86_64__
)

673  (*è
uc
->
uc_mcÚ‹xt
.
g»gs
[16];

674 #–ià
	`defšed
(
__Ÿ64__
)

675  (*è
uc
->
uc_mcÚ‹xt
.
sc_
;

676 #–ià
	`defšed
(
__¬m__
)

677  (*è
uc
->
uc_mcÚ‹xt
.
¬m_pc
;

680  
NULL
;

682 
	}
}

684 
	$logSckCÚ‹Á
(**
¥
) {

685 
i
;

686 
i
 = 15; i >= 0; i--) {

687 
addr
 = (è
¥
+
i
;

688 
v®
 = (è
¥
[
i
];

691 
	`£rv”Log
(
LL_WARNING
, "(%08lxè-> %08lx", 
addr
, 
v®
);

693 
	`£rv”Log
(
LL_WARNING
, "(%016lxè-> %016lx", 
addr
, 
v®
);

695 
	}
}

697 
	$logRegi¡”s
(
ucÚ‹xt_t
 *
uc
) {

698 
	`£rv”Log
(
LL_WARNING
|
LL_RAW
, "\n------ REGISTERS ------\n");

701 #ià
	`defšed
(
__APPLE__
è&& defšed(
MAC_OS_X_VERSION_10_6
)

703 #ià
	`defšed
(
_STRUCT_X86_THREAD_STATE64
è&& !defšed(
__i386__
)

704 
	`£rv”Log
(
LL_WARNING
,

711 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__¿x
,

712 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__rbx
,

713 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__rcx
,

714 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__rdx
,

715 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__rdi
,

716 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__rsi
,

717 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__rbp
,

718 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r¥
,

719 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r8
,

720 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r9
,

721 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r10
,

722 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r11
,

723 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r12
,

724 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r13
,

725 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r14
,

726 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r15
,

727 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__r
,

728 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__ræags
,

729 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__cs
,

730 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__fs
,

731 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__gs


733 
	`logSckCÚ‹Á
((**)
uc
->
uc_mcÚ‹xt
->
__ss
.
__r¥
);

736 
	`£rv”Log
(
LL_WARNING
,

742 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__—x
,

743 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__ebx
,

744 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__ecx
,

745 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__edx
,

746 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__edi
,

747 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__esi
,

748 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__ebp
,

749 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__e¥
,

750 (è
uc
->
uc_mcÚ‹xt
->
__ss
.__ss,

751 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__eæags
,

752 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__e
,

753 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__cs
,

754 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__ds
,

755 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__es
,

756 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__fs
,

757 (è
uc
->
uc_mcÚ‹xt
->
__ss
.
__gs


759 
	`logSckCÚ‹Á
((**)
uc
->
uc_mcÚ‹xt
->
__ss
.
__e¥
);

762 #–ià
	`defšed
(
__lšux__
)

764 #ià
	`defšed
(
__i386__
)

765 
	`£rv”Log
(
LL_WARNING
,

771 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[11],

772 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[8],

773 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[10],

774 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[9],

775 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[4],

776 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[5],

777 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[6],

778 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[7],

779 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[18],

780 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[17],

781 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[14],

782 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[15],

783 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[3],

784 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[2],

785 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[1],

786 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[0]

788 
	`logSckCÚ‹Á
((**)
uc
->
uc_mcÚ‹xt
.
g»gs
[7]);

789 #–ià
	`defšed
(
__X86_64__
è|| defšed(
__x86_64__
)

791 
	`£rv”Log
(
LL_WARNING
,

798 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[13],

799 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[11],

800 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[14],

801 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[12],

802 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[8],

803 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[9],

804 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[10],

805 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[15],

806 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[0],

807 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[1],

808 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[2],

809 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[3],

810 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[4],

811 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[5],

812 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[6],

813 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[7],

814 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[16],

815 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[17],

816 (è
uc
->
uc_mcÚ‹xt
.
g»gs
[18]

818 
	`logSckCÚ‹Á
((**)
uc
->
uc_mcÚ‹xt
.
g»gs
[15]);

821 
	`£rv”Log
(
LL_WARNING
,

824 
	}
}

832 
	$İ’DœeùLogFedes
() {

833 
log_to_¡dout
 = 
£rv”
.
logfe
[0] == '\0';

834 
fd
 = 
log_to_¡dout
 ?

835 
STDOUT_FILENO
 :

836 
	`İ’
(
£rv”
.
logfe
, 
O_APPEND
|
O_CREAT
|
O_WRONLY
, 0644);

837  
fd
;

838 
	}
}

841 
	$şo£DœeùLogFedes
(
fd
) {

842 
log_to_¡dout
 = 
£rv”
.
logfe
[0] == '\0';

843 ià(!
log_to_¡dout
è
	`şo£
(
fd
);

844 
	}
}

848 
	$logSckT¿û
(
ucÚ‹xt_t
 *
uc
) {

849 *
Œaû
[101];

850 
Œaû_size
 = 0, 
fd
 = 
	`İ’DœeùLogFedes
();

852 ià(
fd
 == -1) ;

855 
Œaû_size
 = 
	`backŒaû
(
Œaû
+1, 100);

857 ià(
	`g‘McÚ‹xtE
(
uc
è!ğ
NULL
) {

858 *
msg1
 = "EIP:\n";

859 *
msg2
 = "\nBacktrace:\n";

860 ià(
	`wr™e
(
fd
,
msg1
,
	`¡¾’
(msg1)) == -1) { };

861 
Œaû
[0] = 
	`g‘McÚ‹xtE
(
uc
);

862 
	`backŒaû_symbŞs_fd
(
Œaû
, 1, 
fd
);

863 ià(
	`wr™e
(
fd
,
msg2
,
	`¡¾’
(msg2)) == -1) { };

867 
	`backŒaû_symbŞs_fd
(
Œaû
+1, 
Œaû_size
, 
fd
);

870 
	`şo£DœeùLogFedes
(
fd
);

871 
	}
}

876 
	$logCu¼’tCl›Á
() {

877 ià(
£rv”
.
cu¼’t_ş›Á
 =ğ
NULL
) ;

879 
ş›Á
 *
cc
 = 
£rv”
.
cu¼’t_ş›Á
;

880 
sds
 
ş›Á
;

881 
j
;

883 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ CURRENT CLIENT INFO ------\n");

884 
ş›Á
 = 
	`ÿtCl›ÁInfoSŒšg
(
	`sd£m±y
(),
cc
);

885 
	`£rv”Log
(
LL_WARNING
|
LL_RAW
,"%s\n", 
ş›Á
);

886 
	`sdsä“
(
ş›Á
);

887 
j
 = 0; j < 
cc
->
¬gc
; j++) {

888 
robj
 *
decoded
;

890 
decoded
 = 
	`g‘DecodedObjeù
(
cc
->
¬gv
[
j
]);

891 
	`£rv”Log
(
LL_WARNING
|
LL_RAW
,"¬gv[%d]: '%s'\n", 
j
,

892 (*)
decoded
->
±r
);

893 
	`deüRefCouÁ
(
decoded
);

897 ià(
cc
->
¬gc
 >= 1) {

898 
robj
 *
v®
, *
key
;

899 
diùEÁry
 *
de
;

901 
key
 = 
	`g‘DecodedObjeù
(
cc
->
¬gv
[1]);

902 
de
 = 
	`diùFšd
(
cc
->
db
->
diù
, 
key
->
±r
);

903 ià(
de
) {

904 
v®
 = 
	`diùG‘V®
(
de
);

905 
	`£rv”Log
(
LL_WARNING
,"key '%s' found iÀDB cÚššghfŞlowšg objeù:", (*)
key
->
±r
);

906 
	`£rv”LogObjeùDebugInfo
(
v®
);

908 
	`deüRefCouÁ
(
key
);

910 
	}
}

912 #ià
defšed
(
HAVE_PROC_MAPS
)

914 
	#MEMTEST_MAX_REGIONS
 128

	)

917 
	$mem‹¡_‹¡_lšux_ªÚymous_m­s
() {

918 
FILE
 *
å
;

919 
lše
[1024];

920 
logbuf
[1024];

921 
size_t
 
¡¬t_addr
, 
’d_addr
, 
size
;

922 
size_t
 
¡¬t_veù
[
MEMTEST_MAX_REGIONS
];

923 
size_t
 
size_veù
[
MEMTEST_MAX_REGIONS
];

924 
»giÚs
 = 0, 
j
;

926 
fd
 = 
	`İ’DœeùLogFedes
();

927 ià(!
fd
)  0;

929 
å
 = 
	`fİ’
("/proc/self/maps","r");

930 ià(!
å
)  0;

931 
	`fg‘s
(
lše
,Öše),
å
è!ğ
NULL
) {

932 *
¡¬t
, *
’d
, *
p
 = 
lše
;

934 
¡¬t
 = 
p
;

935 
p
 = 
	`¡rchr
(p,'-');

936 ià(!
p
) ;

937 *
p
++ = '\0';

938 
’d
 = 
p
;

939 
p
 = 
	`¡rchr
(p,' ');

940 ià(!
p
) ;

941 *
p
++ = '\0';

942 ià(
	`¡r¡r
(
p
,"stack") ||

943 
	`¡r¡r
(
p
,"vdso") ||

944 
	`¡r¡r
(
p
,"vsyscall")) ;

945 ià(!
	`¡r¡r
(
p
,"00:00")) ;

946 ià(!
	`¡r¡r
(
p
,"rw")) ;

948 
¡¬t_addr
 = 
	`¡¹oul
(
¡¬t
,
NULL
,16);

949 
’d_addr
 = 
	`¡¹oul
(
’d
,
NULL
,16);

950 
size
 = 
’d_addr
-
¡¬t_addr
;

952 
¡¬t_veù
[
»giÚs
] = 
¡¬t_addr
;

953 
size_veù
[
»giÚs
] = 
size
;

954 
	`¢´štf
(
logbuf
,(logbuf),

956 (è
¡¬t_veù
[
»giÚs
],

957 (è
size_veù
[
»giÚs
]);

958 ià(
	`wr™e
(
fd
,
logbuf
,
	`¡¾’
(logbuf)) == -1) { }

959 
»giÚs
++;

962 
”rÜs
 = 0;

963 
j
 = 0; j < 
»giÚs
; j++) {

964 ià(
	`wr™e
(
fd
,".",1) == -1) { }

965 
”rÜs
 +ğ
	`mem‹¡_´e£rvšg_‹¡
((*)
¡¬t_veù
[
j
],
size_veù
[j],1);

966 ià(
	`wr™e
(
fd
, 
”rÜs
 ? "E" : "O",1) == -1) { }

968 ià(
	`wr™e
(
fd
,"\n",1) == -1) { }

973 
	`fşo£
(
å
);

974 
	`şo£DœeùLogFedes
(
fd
);

975  
”rÜs
;

976 
	}
}

982 
	$dumpX86C®ls
(*
addr
, 
size_t
 
Ën
) {

983 
size_t
 
j
;

984 *
p
 = 
addr
;

985 
Dl_šfo
 
šfo
;

988 
ht
[256] = {0};

990 ià(
Ën
 < 5) ;

991 
j
 = 0; j < 
Ën
-4; j++) {

992 ià(
p
[
j
] != 0xE8) ;

993 
rg‘
 = ()
addr
+
j
+5;

994 
rg‘
 +ğ*((
št32_t
*)(
p
+
j
+1));

995 ià(
	`dÏddr
((*)
rg‘
, &
šfo
è!ğ0 && info.
dli_¢ame
 !ğ
NULL
) {

996 ià(
ht
[
rg‘
&0xff] !=arget) {

997 
	`´štf
("FunùiÚ‡ˆ0x%lx i %s\n",
rg‘
,
šfo
.
dli_¢ame
);

998 
ht
[
rg‘
&0xff] =arget;

1000 
j
 += 4;

1003 
	}
}

1005 
	$sig£gvHªdËr
(
sig
, 
sigšfo_t
 *
šfo
, *
£ü‘
) {

1006 
ucÚ‹xt_t
 *
uc
 = (ucÚ‹xt_t*è
£ü‘
;

1007 *
e
 = 
	`g‘McÚ‹xtE
(
uc
);

1008 
sds
 
šfo¡ršg
, 
ş›Ás
;

1009 
sigaùiÚ
 
aù
;

1010 
	`UNUSED
(
šfo
);

1012 
	`bugR•ÜtS¹
();

1013 
	`£rv”Log
(
LL_WARNING
,

1014 "Redi % üashed by sigÇl: %d", 
REDIS_VERSION
, 
sig
);

1015 ià(
e
 !ğ
NULL
) {

1016 
	`£rv”Log
(
LL_WARNING
,

1017 "C¿shed„uÂšghš¡uùiÚ‡t: %p", 
e
);

1019 ià(
sig
 =ğ
SIGSEGV
 || sig =ğ
SIGBUS
) {

1020 
	`£rv”Log
(
LL_WARNING
,

1021 "Acûssšg‡dd»ss: %p", (*)
šfo
->
si_addr
);

1023 
	`£rv”Log
(
LL_WARNING
,

1024 "Faed‡s£¹iÚ: % (%s:%d)", 
£rv”
.
as£¹_çed
,

1025 
£rv”
.
as£¹_fe
, s”v”.
as£¹_lše
);

1028 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ STACK TRACE ------\n");

1029 
	`logSckT¿û
(
uc
);

1032 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ INFO OUTPUT ------\n");

1033 
šfo¡ršg
 = 
	`g’RedisInfoSŒšg
("all");

1034 
šfo¡ršg
 = 
	`sdsÿrštf
(infostring, "hash_init_value: %u\n",

1035 
	`diùG‘HashFunùiÚS“d
());

1036 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
, 
šfo¡ršg
);

1037 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ CLIENT LIST OUTPUT ------\n");

1038 
ş›Ás
 = 
	`g‘AÎCl›ÁsInfoSŒšg
();

1039 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
, 
ş›Ás
);

1040 
	`sdsä“
(
šfo¡ršg
);

1041 
	`sdsä“
(
ş›Ás
);

1044 
	`logCu¼’tCl›Á
();

1047 
	`logRegi¡”s
(
uc
);

1049 #ià
	`defšed
(
HAVE_PROC_MAPS
)

1051 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
, "\n------ FAST MEMORY TEST ------\n");

1052 
	`bioKlTh»ads
();

1053 ià(
	`mem‹¡_‹¡_lšux_ªÚymous_m­s
()) {

1054 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
,

1057 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
,

1062 ià(
e
 !ğ
NULL
) {

1063 
Dl_šfo
 
šfo
;

1064 ià(
	`dÏddr
(
e
, &
šfo
) != 0) {

1065 
	`£rv”Log
(
LL_WARNING
|
LL_RAW
,

1072 
šfo
.
dli_¢ame
, info.
dli_§ddr
, info.
dli_âame
, info.
dli_fba£
,

1073 
šfo
.
dli_§ddr
);

1074 
size_t
 
Ën
 = ()
e
 - ()
šfo
.
dli_§ddr
;

1075 
sz
 = 
	`syscÚf
(
_SC_PAGESIZE
);

1076 ià(
Ën
 < 1<<13) {

1080 
Ãxt
 = (()
e
 + 
sz
) & ~(sz-1);

1081 
’d
 = ()
e
 + 128;

1082 ià(
’d
 > 
Ãxt
)ƒnd =‚ext;

1083 
Ën
 = 
’d
 - ()
šfo
.
dli_§ddr
;

1084 
	`£rv”LogHexDump
(
LL_WARNING
, "dump of function",

1085 
šfo
.
dli_§ddr
 ,
Ën
);

1086 
	`dumpX86C®ls
(
šfo
.
dli_§ddr
,
Ën
);

1091 
	`£rv”LogRaw
(
LL_WARNING
|
LL_RAW
,

1099 ià(
£rv”
.
d«mÚize
 && s”v”.
su³rvi£d
 =ğ0è
	`uÆšk
(£rv”.
pidfe
);

1103 
	`sigem±y£t
 (&
aù
.
§_mask
);

1104 
aù
.
§_æags
 = 
SA_NODEFER
 | 
SA_ONSTACK
 | 
SA_RESETHAND
;

1105 
aù
.
§_hªdËr
 = 
SIG_DFL
;

1106 
	`sigaùiÚ
 (
sig
, &
aù
, 
NULL
);

1107 
	`kl
(
	`g‘pid
(),
sig
);

1108 
	}
}

1113 
	$£rv”LogHexDump
(
Ëv–
, *
desü
, *
v®ue
, 
size_t
 
Ën
) {

1114 
buf
[65], *
b
;

1115 *
v
 = 
v®ue
;

1116 
ch¬£t
[] = "0123456789abcdef";

1118 
	`£rv”Log
(
Ëv–
,"% (hexdum°oà%zu by‹s):", 
desü
, 
Ën
);

1119 
b
 = 
buf
;

1120 
Ën
) {

1121 
b
[0] = 
ch¬£t
[(*
v
)>>4];

1122 
b
[1] = 
ch¬£t
[(*
v
)&0xf];

1123 
b
[2] = '\0';

1124 
b
 += 2;

1125 
Ën
--;

1126 
v
++;

1127 ià(
b
-
buf
 =ğ64 || 
Ën
 == 0) {

1128 
	`£rv”LogRaw
(
Ëv–
|
LL_RAW
,
buf
);

1129 
b
 = 
buf
;

1132 
	`£rv”LogRaw
(
Ëv–
|
LL_RAW
,"\n");

1133 
	}
}

1136 
	~<sys/time.h
>

1138 
	$w©chdogSigÇlHªdËr
(
sig
, 
sigšfo_t
 *
šfo
, *
£ü‘
) {

1139 #ifdeà
HAVE_BACKTRACE


1140 
ucÚ‹xt_t
 *
uc
 = (ucÚ‹xt_t*è
£ü‘
;

1142 
	`UNUSED
(
šfo
);

1143 
	`UNUSED
(
sig
);

1145 
	`£rv”LogFromHªdËr
(
LL_WARNING
,"\n--- WATCHDOG TIMER EXPIRED ---");

1146 #ifdeà
HAVE_BACKTRACE


1147 
	`logSckT¿û
(
uc
);

1149 
	`£rv”LogFromHªdËr
(
LL_WARNING
,"Sorry:‚o support for backtrace().");

1151 
	`£rv”LogFromHªdËr
(
LL_WARNING
,"--------\n");

1152 
	}
}

1157 
	$w©chdogScheduËSigÇl
(
³riod
) {

1158 
™im”v®
 
™
;

1161 
™
.
™_v®ue
.
tv_£c
 = 
³riod
/1000;

1162 
™
.
™_v®ue
.
tv_u£c
 = (
³riod
%1000)*1000;

1164 
™
.
™_š‹rv®
.
tv_£c
 = 0;

1165 
™
.
™_š‹rv®
.
tv_u£c
 = 0;

1166 
	`£t™im”
(
ITIMER_REAL
, &
™
, 
NULL
);

1167 
	}
}

1170 
	$’abËW©chdog
(
³riod
) {

1171 
mš_³riod
;

1173 ià(
£rv”
.
w©chdog_³riod
 == 0) {

1174 
sigaùiÚ
 
aù
;

1178 
	`sigem±y£t
(&
aù
.
§_mask
);

1179 
aù
.
§_æags
 = 
SA_ONSTACK
 | 
SA_SIGINFO
;

1180 
aù
.
§_sigaùiÚ
 = 
w©chdogSigÇlHªdËr
;

1181 
	`sigaùiÚ
(
SIGALRM
, &
aù
, 
NULL
);

1186 
mš_³riod
 = (1000/
£rv”
.
hz
)*2;

1187 ià(
³riod
 < 
mš_³riod
)…eriod = min_period;

1188 
	`w©chdogScheduËSigÇl
(
³riod
);

1189 
£rv”
.
w©chdog_³riod
 = 
³riod
;

1190 
	}
}

1193 
	$di§bËW©chdog
() {

1194 
sigaùiÚ
 
aù
;

1195 ià(
£rv”
.
w©chdog_³riod
 == 0) ;

1196 
	`w©chdogScheduËSigÇl
(0);

1200 
	`sigem±y£t
(&
aù
.
§_mask
);

1201 
aù
.
§_æags
 = 0;

1202 
aù
.
§_hªdËr
 = 
SIG_IGN
;

1203 
	`sigaùiÚ
(
SIGALRM
, &
aù
, 
NULL
);

1204 
£rv”
.
w©chdog_³riod
 = 0;

1205 
	}
}

	@src/debugmacro.h

33 
	~<¡dio.h
>

34 
	#D
(...) \

36 
FILE
 *
å
 = 
	`fİ’
("/tmp/log.txt","a"); \

37 
	`årštf
(
å
,"%s:%s:%d:\t", 
__FILE__
, 
__func__
, 
__LINE__
); \

38 
	`årštf
(
å
,
__VA_ARGS__
); \

39 
	`årštf
(
å
,"\n"); \

40 
	`fşo£
(
å
); \

41 } 0);

	)

	@src/dict.c

36 
	~"fmaüos.h
"

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~<¡ršg.h
>

41 
	~<¡d¬g.h
>

42 
	~<lim™s.h
>

43 
	~<sys/time.h
>

44 
	~<ùy³.h
>

46 #ifdeà
USE_PMDK


47 
	~"obj.h
"

48 
	~"libpmemobj.h
"

49 
	~"£rv”.h
"

50 
	~"pmem.h
"

53 
	~"diù.h
"

54 
	~"zm®loc.h
"

55 
	~"»di§s£¹.h
"

65 
	gdiù_ÿn_»size
 = 1;

66 
	gdiù_fÜû_»size_¿tio
 = 5;

70 
_diùEx·ndIfN“ded
(
diù
 *
ht
);

71 
_diùNextPow”
(
size
);

72 
_diùKeyIndex
(
diù
 *
ht
, cÚ¡ *
key
);

73 
_diùIn™
(
diù
 *
ht
, 
diùTy³
 *
ty³
, *
´ivD©aPŒ
);

78 
	$diùIÁHashFunùiÚ
(
key
)

80 
key
 += ~(key << 15);

81 
key
 ^= (key >> 10);

82 
key
 += (key << 3);

83 
key
 ^= (key >> 6);

84 
key
 += ~(key << 11);

85 
key
 ^= (key >> 16);

86  
key
;

87 
	}
}

89 
ušt32_t
 
	gdiù_hash_funùiÚ_£ed
 = 5381;

91 
	$diùS‘HashFunùiÚS“d
(
ušt32_t
 
£ed
) {

92 
diù_hash_funùiÚ_£ed
 = 
£ed
;

93 
	}
}

95 
ušt32_t
 
	$diùG‘HashFunùiÚS“d
() {

96  
diù_hash_funùiÚ_£ed
;

97 
	}
}

110 
	$diùG’HashFunùiÚ
(cÚ¡ *
key
, 
Ën
) {

113 
ušt32_t
 
£ed
 = 
diù_hash_funùiÚ_£ed
;

114 cÚ¡ 
ušt32_t
 
m
 = 0x5bd1e995;

115 cÚ¡ 
r
 = 24;

118 
ušt32_t
 
h
 = 
£ed
 ^ 
Ën
;

121 cÚ¡ *
d©a
 = (cÚ¡ *)
key
;

123 
Ën
 >= 4) {

124 
ušt32_t
 
k
 = *(ušt32_t*)
d©a
;

126 
k
 *ğ
m
;

127 
k
 ^ğk >> 
r
;

128 
k
 *ğ
m
;

130 
h
 *ğ
m
;

131 
h
 ^ğ
k
;

133 
d©a
 += 4;

134 
Ën
 -= 4;

138 
Ën
) {

139 3: 
h
 ^ğ
d©a
[2] << 16;

140 2: 
h
 ^ğ
d©a
[1] << 8;

141 1: 
h
 ^ğ
d©a
[0]; h *ğ
m
;

146 
h
 ^= h >> 13;

147 
h
 *ğ
m
;

148 
h
 ^= h >> 15;

150  ()
h
;

151 
	}
}

154 
	$diùG’Ca£HashFunùiÚ
(cÚ¡ *
buf
, 
Ën
) {

155 
hash
 = ()
diù_hash_funùiÚ_£ed
;

157 
Ën
--)

158 
hash
 = ((hash << 5è+ hashè+ (
	`tŞow”
(*
buf
++));

159  
hash
;

160 
	}
}

166 
	$_diùRe£t
(
diùht
 *
ht
)

168 
ht
->
bË
 = 
NULL
;

169 
ht
->
size
 = 0;

170 
ht
->
sizemask
 = 0;

171 
ht
->
u£d
 = 0;

172 
	}
}

175 
diù
 *
	$diùC»©e
(
diùTy³
 *
ty³
,

176 *
´ivD©aPŒ
)

178 
diù
 *
d
 = 
	`zm®loc
((*d));

180 
	`_diùIn™
(
d
,
ty³
,
´ivD©aPŒ
);

181  
d
;

182 
	}
}

185 
	$_diùIn™
(
diù
 *
d
, 
diùTy³
 *
ty³
,

186 *
´ivD©aPŒ
)

188 
	`_diùRe£t
(&
d
->
ht
[0]);

189 
	`_diùRe£t
(&
d
->
ht
[1]);

190 
d
->
ty³
 =ype;

191 
d
->
´ivd©a
 = 
´ivD©aPŒ
;

192 
d
->
»hashidx
 = -1;

193 
d
->
™”©Üs
 = 0;

194  
DICT_OK
;

195 
	}
}

199 
	$diùResize
(
diù
 *
d
)

201 
mšim®
;

203 ià(!
diù_ÿn_»size
 || 
	`diùIsRehashšg
(
d
)è 
DICT_ERR
;

204 
mšim®
 = 
d
->
ht
[0].
u£d
;

205 ià(
mšim®
 < 
DICT_HT_INITIAL_SIZE
)

206 
mšim®
 = 
DICT_HT_INITIAL_SIZE
;

207  
	`diùEx·nd
(
d
, 
mšim®
);

208 
	}
}

211 
	$diùEx·nd
(
diù
 *
d
, 
size
)

213 
diùht
 
n
;

214 
»®size
 = 
	`_diùNextPow”
(
size
);

219 ià(
	`diùIsRehashšg
(
d
è|| d->
ht
[0].
u£d
 > 
size
)

220  
DICT_ERR
;

223 ià(
»®size
 =ğ
d
->
ht
[0].
size
è 
DICT_ERR
;

226 
n
.
size
 = 
»®size
;

227 
n
.
sizemask
 = 
»®size
-1;

228 
n
.
bË
 = 
	`zÿÎoc
(
»®size
*(
diùEÁry
*));

229 
n
.
u£d
 = 0;

233 ià(
d
->
ht
[0].
bË
 =ğ
NULL
) {

234 
d
->
ht
[0] = 
n
;

235  
DICT_OK
;

239 
d
->
ht
[1] = 
n
;

240 
d
->
»hashidx
 = 0;

241  
DICT_OK
;

242 
	}
}

253 
	$diùRehash
(
diù
 *
d
, 
n
) {

254 
em±y_vis™s
 = 
n
*10;

255 ià(!
	`diùIsRehashšg
(
d
))  0;

257 
n
-- && 
d
->
ht
[0].
u£d
 != 0) {

258 
diùEÁry
 *
de
, *
Ãxtde
;

262 
	`as£¹
(
d
->
ht
[0].
size
 > ()d->
»hashidx
);

263 
d
->
ht
[0].
bË
[d->
»hashidx
] =ğ
NULL
) {

264 
d
->
»hashidx
++;

265 ià(--
em±y_vis™s
 == 0)  1;

267 
de
 = 
d
->
ht
[0].
bË
[d->
»hashidx
];

269 
de
) {

270 
h
;

272 
Ãxtde
 = 
de
->
Ãxt
;

274 
h
 = 
	`diùHashKey
(
d
, 
de
->
key
è& d->
ht
[1].
sizemask
;

275 
de
->
Ãxt
 = 
d
->
ht
[1].
bË
[
h
];

276 
d
->
ht
[1].
bË
[
h
] = 
de
;

277 
d
->
ht
[0].
u£d
--;

278 
d
->
ht
[1].
u£d
++;

279 
de
 = 
Ãxtde
;

281 
d
->
ht
[0].
bË
[d->
»hashidx
] = 
NULL
;

282 
d
->
»hashidx
++;

286 ià(
d
->
ht
[0].
u£d
 == 0) {

287 
	`zä“
(
d
->
ht
[0].
bË
);

288 
d
->
ht
[0] = d->ht[1];

289 
	`_diùRe£t
(&
d
->
ht
[1]);

290 
d
->
»hashidx
 = -1;

296 
	}
}

298 
	$timeInMli£cÚds
() {

299 
timev®
 
tv
;

301 
	`g‘timeofday
(&
tv
,
NULL
);

302  ((()
tv
.
tv_£c
)*1000)+Ñv.
tv_u£c
/1000);

303 
	}
}

306 
	$diùRehashMli£cÚds
(
diù
 *
d
, 
ms
) {

307 
¡¬t
 = 
	`timeInMli£cÚds
();

308 
»hashes
 = 0;

310 
	`diùRehash
(
d
,100)) {

311 
»hashes
 += 100;

312 ià(
	`timeInMli£cÚds
()-
¡¬t
 > 
ms
) ;

314  
»hashes
;

315 
	}
}

325 
	$_diùRehashS‹p
(
diù
 *
d
) {

326 ià(
d
->
™”©Üs
 =ğ0è
	`diùRehash
(d,1);

327 
	}
}

330 
	$diùAdd
(
diù
 *
d
, *
key
, *
v®
)

332 
diùEÁry
 *
’Œy
 = 
	`diùAddRaw
(
d
,
key
);

334 ià(!
’Œy
è 
DICT_ERR
;

335 
	`diùS‘V®
(
d
, 
’Œy
, 
v®
);

336  
DICT_OK
;

337 
	}
}

339 #ifdeà
USE_PMDK


341 
	$diùAddPM
(
diù
 *
d
, *
key
, *
v®
)

343 
diùEÁry
 *
’Œy
 = 
	`diùAddRawPM
(
d
,
key
);

345 ià(!
’Œy
è 
DICT_ERR
;

346 
	`diùS‘V®
(
d
, 
’Œy
, 
v®
);

348  
DICT_OK
;

349 
	}
}

367 
diùEÁry
 *
	$diùAddRaw
(
diù
 *
d
, *
key
)

369 
šdex
;

370 
diùEÁry
 *
’Œy
;

371 
diùht
 *
ht
;

373 ià(
	`diùIsRehashšg
(
d
)è
	`_diùRehashS‹p
(d);

377 ià((
šdex
 = 
	`_diùKeyIndex
(
d
, 
key
)) == -1)

378  
NULL
;

384 
ht
 = 
	`diùIsRehashšg
(
d
) ? &d->ht[1] : &d->ht[0];

385 
’Œy
 = 
	`zm®loc
((*entry));

387 
’Œy
->
Ãxt
 = 
ht
->
bË
[
šdex
];

388 
ht
->
bË
[
šdex
] = 
’Œy
;

389 
ht
->
u£d
++;

392 
	`diùS‘Key
(
d
, 
’Œy
, 
key
);

393  
’Œy
;

394 
	}
}

396 #ifdeà
USE_PMDK


412 
diùEÁry
 *
	$diùAddRawPM
(
diù
 *
d
, *
key
)

414 
šdex
;

415 
diùEÁry
 *
’Œy
;

416 
diùht
 *
ht
;

418 ià(
	`diùIsRehashšg
(
d
)è
	`_diùRehashS‹p
(d);

422 ià((
šdex
 = 
	`_diùKeyIndex
(
d
, 
key
)) == -1)

423  
NULL
;

429 
ht
 = 
	`diùIsRehashšg
(
d
) ? &d->ht[1] : &d->ht[0];

431 
’Œy
 = 
	`zm®loc
((*entry));

433 
’Œy
->
Ãxt
 = 
ht
->
bË
[
šdex
];

434 
ht
->
bË
[
šdex
] = 
’Œy
;

435 
ht
->
u£d
++;

438 
	`diùS‘Key
(
d
, 
’Œy
, 
key
);

439  
’Œy
;

440 
	}
}

442 
diùEÁry
 *
	$diùAddRecÚ¡ruùedPM
(
diù
 *
d
, *
key
, *
v®
)

444 
šdex
;

445 
diùEÁry
 *
’Œy
;

446 
robj
 *
v®_robj
;

447 
diùht
 *
ht
;

449 ià(
	`diùIsRehashšg
(
d
)è
	`_diùRehashS‹p
(d);

453 ià((
šdex
 = 
	`_diùKeyIndex
(
d
, (cÚ¡ *)
key
)) == -1)

454  
NULL
;

460 
ht
 = 
	`diùIsRehashšg
(
d
) ? &d->ht[1] : &d->ht[0];

461 
’Œy
 = 
	`zm®loc
((*entry));

462 
v®_robj
 = 
	`ü—‹ObjeùPM
(
OBJ_STRING
, 
v®
);

464 
’Œy
->
Ãxt
 = 
ht
->
bË
[
šdex
];

465 
ht
->
bË
[
šdex
] = 
’Œy
;

466 
ht
->
u£d
++;

468 
	`diùS‘Key
(
d
, 
’Œy
, 
key
);

469 
	`diùS‘V®
(
d
, 
’Œy
, 
v®_robj
);

471  
’Œy
;

472 
	}
}

479 
	$diùR•Ïû
(
diù
 *
d
, *
key
, *
v®
)

481 
diùEÁry
 *
’Œy
, 
aux’Œy
;

485 ià(
	`diùAdd
(
d
, 
key
, 
v®
è=ğ
DICT_OK
)

488 
’Œy
 = 
	`diùFšd
(
d
, 
key
);

494 
aux’Œy
 = *
’Œy
;

495 
	`diùS‘V®
(
d
, 
’Œy
, 
v®
);

496 
	`diùF»eV®
(
d
, &
aux’Œy
);

498 
	}
}

500 #ifdeà
USE_PMDK


505 
	$diùR•ÏûPM
(
diù
 *
d
, *
key
, *
v®
)

507 
diùEÁry
 *
’Œy
, 
aux’Œy
;

511 ià(
	`diùAddPM
(
d
, 
key
, 
v®
è=ğ
DICT_OK
)

514 
’Œy
 = 
	`diùFšd
(
d
, 
key
);

520 
aux’Œy
 = *
’Œy
;

521 
	`diùS‘V®
(
d
, 
’Œy
, 
v®
);

522 
	`pmemKV·œS‘
(
’Œy
->
key
, ((
robj
 *)
v®
)->
±r
);

523 
	`diùF»eV®
(
d
, &
aux’Œy
);

525 
	}
}

534 
diùEÁry
 *
	$diùR•ÏûRaw
(
diù
 *
d
, *
key
) {

535 
diùEÁry
 *
’Œy
 = 
	`diùFšd
(
d
,
key
);

537  
’Œy
 ?ƒÁry : 
	`diùAddRaw
(
d
,
key
);

538 
	}
}

541 
	$diùG’”icD–‘e
(
diù
 *
d
, cÚ¡ *
key
, 
noä“
)

543 
h
, 
idx
;

544 
diùEÁry
 *
he
, *
´evHe
;

545 
bË
;

547 ià(
d
->
ht
[0].
size
 =ğ0è 
DICT_ERR
;

548 ià(
	`diùIsRehashšg
(
d
)è
	`_diùRehashS‹p
(d);

549 
h
 = 
	`diùHashKey
(
d
, 
key
);

551 
bË
 = 0;able <= 1;able++) {

552 
idx
 = 
h
 & 
d
->
ht
[
bË
].
sizemask
;

553 
he
 = 
d
->
ht
[
bË
].bË[
idx
];

554 
´evHe
 = 
NULL
;

555 
he
) {

556 ià(
key
==
he
->key || 
	`diùCom·»Keys
(
d
, key, he->key)) {

558 ià(
´evHe
)

559 
´evHe
->
Ãxt
 = 
he
->next;

561 
d
->
ht
[
bË
].bË[
idx
] = 
he
->
Ãxt
;

562 ià(!
noä“
) {

563 
	`diùF»eKey
(
d
, 
he
);

564 
	`diùF»eV®
(
d
, 
he
);

566 
	`zä“
(
he
);

567 
d
->
ht
[
bË
].
u£d
--;

568  
DICT_OK
;

570 
´evHe
 = 
he
;

571 
he
 = he->
Ãxt
;

573 ià(!
	`diùIsRehashšg
(
d
)) ;

575  
DICT_ERR
;

576 
	}
}

578 
	$diùD–‘e
(
diù
 *
ht
, cÚ¡ *
key
) {

579  
	`diùG’”icD–‘e
(
ht
,
key
,0);

580 
	}
}

582 
	$diùD–‘eNoF»e
(
diù
 *
ht
, cÚ¡ *
key
) {

583  
	`diùG’”icD–‘e
(
ht
,
key
,1);

584 
	}
}

587 
_diùCË¬
(
diù
 *
d
, 
diùht
 *
ht
, (
ÿÎback
)(*)) {

588 
i
;

591 
i
 = 0; i < 
ht
->
size
 && ht->
u£d
 > 0; i++) {

592 
diùEÁry
 *
he
, *
ÃxtHe
;

594 ià(
ÿÎback
 && (
i
 & 65535è=ğ0è
	`ÿÎback
(
d
->
´ivd©a
);

596 ià((
he
 = 
ht
->
bË
[
i
]è=ğ
NULL
) ;

597 
he
) {

598 
ÃxtHe
 = 
he
->
Ãxt
;

599 
	`diùF»eKey
(
d
, 
he
);

600 
	`diùF»eV®
(
d
, 
he
);

601 
	`zä“
(
he
);

602 
ht
->
u£d
--;

603 
he
 = 
ÃxtHe
;

607 
	`zä“
(
ht
->
bË
);

609 
	`_diùRe£t
(
ht
);

610  
DICT_OK
;

611 
	}
}

614 
	$diùR–—£
(
diù
 *
d
)

616 
	`_diùCË¬
(
d
,&d->
ht
[0],
NULL
);

617 
	`_diùCË¬
(
d
,&d->
ht
[1],
NULL
);

618 
	`zä“
(
d
);

619 
	}
}

621 
diùEÁry
 *
	$diùFšd
(
diù
 *
d
, cÚ¡ *
key
)

623 
diùEÁry
 *
he
;

624 
h
, 
idx
, 
bË
;

626 ià(
d
->
ht
[0].
u£d
 + d->ht[1].u£d =ğ0è 
NULL
;

627 ià(
	`diùIsRehashšg
(
d
)è
	`_diùRehashS‹p
(d);

628 
h
 = 
	`diùHashKey
(
d
, 
key
);

629 
bË
 = 0;able <= 1;able++) {

630 
idx
 = 
h
 & 
d
->
ht
[
bË
].
sizemask
;

631 
he
 = 
d
->
ht
[
bË
].bË[
idx
];

632 
he
) {

633 ià(
key
==
he
->key || 
	`diùCom·»Keys
(
d
, key, he->key))

634  
he
;

635 
he
 = he->
Ãxt
;

637 ià(!
	`diùIsRehashšg
(
d
)è 
NULL
;

639  
NULL
;

640 
	}
}

642 *
	$diùF‘chV®ue
(
diù
 *
d
, cÚ¡ *
key
) {

643 
diùEÁry
 *
he
;

645 
he
 = 
	`diùFšd
(
d
,
key
);

646  
he
 ? 
	`diùG‘V®
(heè: 
NULL
;

647 
	}
}

655 
	$diùFšg”´št
(
diù
 *
d
) {

656 
š‹g”s
[6], 
hash
 = 0;

657 
j
;

659 
š‹g”s
[0] = (è
d
->
ht
[0].
bË
;

660 
š‹g”s
[1] = 
d
->
ht
[0].
size
;

661 
š‹g”s
[2] = 
d
->
ht
[0].
u£d
;

662 
š‹g”s
[3] = (è
d
->
ht
[1].
bË
;

663 
š‹g”s
[4] = 
d
->
ht
[1].
size
;

664 
š‹g”s
[5] = 
d
->
ht
[1].
u£d
;

673 
j
 = 0; j < 6; j++) {

674 
hash
 +ğ
š‹g”s
[
j
];

676 
hash
 = (~hash) + (hash << 21);

677 
hash
 = hash ^ (hash >> 24);

678 
hash
 = (hash + (hash << 3)) + (hash << 8);

679 
hash
 = hash ^ (hash >> 14);

680 
hash
 = (hash + (hash << 2)) + (hash << 4);

681 
hash
 = hash ^ (hash >> 28);

682 
hash
 = hash + (hash << 31);

684  
hash
;

685 
	}
}

687 
diùI‹¿tÜ
 *
	$diùG‘I‹¿tÜ
(
diù
 *
d
)

689 
diùI‹¿tÜ
 *
™”
 = 
	`zm®loc
((*iter));

691 
™”
->
d
 = d;

692 
™”
->
bË
 = 0;

693 
™”
->
šdex
 = -1;

694 
™”
->
§ã
 = 0;

695 
™”
->
’Œy
 = 
NULL
;

696 
™”
->
ÃxtEÁry
 = 
NULL
;

697  
™”
;

698 
	}
}

700 
diùI‹¿tÜ
 *
	$diùG‘SaãI‹¿tÜ
(
diù
 *
d
) {

701 
diùI‹¿tÜ
 *
i
 = 
	`diùG‘I‹¿tÜ
(
d
);

703 
i
->
§ã
 = 1;

704  
i
;

705 
	}
}

707 
diùEÁry
 *
	$diùNext
(
diùI‹¿tÜ
 *
™”
)

710 ià(
™”
->
’Œy
 =ğ
NULL
) {

711 
diùht
 *
ht
 = &
™”
->
d
->ht[™”->
bË
];

712 ià(
™”
->
šdex
 =ğ-1 && i‹r->
bË
 == 0) {

713 ià(
™”
->
§ã
)

714 
™”
->
d
->
™”©Üs
++;

716 
™”
->
fšg”´št
 = 
	`diùFšg”´št
(™”->
d
);

718 
™”
->
šdex
++;

719 ià(
™”
->
šdex
 >ğ(è
ht
->
size
) {

720 ià(
	`diùIsRehashšg
(
™”
->
d
è&& i‹r->
bË
 == 0) {

721 
™”
->
bË
++;

722 
™”
->
šdex
 = 0;

723 
ht
 = &
™”
->
d
->ht[1];

728 
™”
->
’Œy
 = 
ht
->
bË
[™”->
šdex
];

730 
™”
->
’Œy
 = i‹r->
ÃxtEÁry
;

732 ià(
™”
->
’Œy
) {

735 
™”
->
ÃxtEÁry
 = i‹r->
’Œy
->
Ãxt
;

736  
™”
->
’Œy
;

739  
NULL
;

740 
	}
}

742 
	$diùR–—£I‹¿tÜ
(
diùI‹¿tÜ
 *
™”
)

744 ià(!(
™”
->
šdex
 =ğ-1 && i‹r->
bË
 == 0)) {

745 ià(
™”
->
§ã
)

746 
™”
->
d
->
™”©Üs
--;

748 
	`as£¹
(
™”
->
fšg”´št
 =ğ
	`diùFšg”´št
(™”->
d
));

750 
	`zä“
(
™”
);

751 
	}
}

755 
diùEÁry
 *
	$diùG‘RªdomKey
(
diù
 *
d
)

757 
diùEÁry
 *
he
, *
Üighe
;

758 
h
;

759 
li¡Ën
, 
li¡–e
;

761 ià(
	`diùSize
(
d
è=ğ0è 
NULL
;

762 ià(
	`diùIsRehashšg
(
d
)è
	`_diùRehashS‹p
(d);

763 ià(
	`diùIsRehashšg
(
d
)) {

767 
h
 = 
d
->
»hashidx
 + (
	`¿ndom
(è% (d->
ht
[0].
size
 +

768 
d
->
ht
[1].
size
 -

769 
d
->
»hashidx
));

770 
he
 = (
h
 >ğ
d
->
ht
[0].
size
è? d->ht[1].
bË
[h - d->ht[0].size] :

771 
d
->
ht
[0].
bË
[
h
];

772 } 
he
 =ğ
NULL
);

775 
h
 = 
	`¿ndom
(è& 
d
->
ht
[0].
sizemask
;

776 
he
 = 
d
->
ht
[0].
bË
[
h
];

777 } 
he
 =ğ
NULL
);

784 
li¡Ën
 = 0;

785 
Üighe
 = 
he
;

786 
he
) {

787 
he
 = he->
Ãxt
;

788 
li¡Ën
++;

790 
li¡–e
 = 
	`¿ndom
(è% 
li¡Ën
;

791 
he
 = 
Üighe
;

792 
li¡–e
--è
he
 = he->
Ãxt
;

793  
he
;

794 
	}
}

818 
	$diùG‘SomeKeys
(
diù
 *
d
, 
diùEÁry
 **
des
, 
couÁ
) {

819 
j
;

820 
bËs
;

821 
¡Üed
 = 0, 
maxsizemask
;

822 
max¡•s
;

824 ià(
	`diùSize
(
d
è< 
couÁ
) count = dictSize(d);

825 
max¡•s
 = 
couÁ
*10;

828 
j
 = 0; j < 
couÁ
; j++) {

829 ià(
	`diùIsRehashšg
(
d
))

830 
	`_diùRehashS‹p
(
d
);

835 
bËs
 = 
	`diùIsRehashšg
(
d
) ? 2 : 1;

836 
maxsizemask
 = 
d
->
ht
[0].
sizemask
;

837 ià(
bËs
 > 1 && 
maxsizemask
 < 
d
->
ht
[1].
sizemask
)

838 
maxsizemask
 = 
d
->
ht
[1].
sizemask
;

841 
i
 = 
	`¿ndom
(è& 
maxsizemask
;

842 
em±yËn
 = 0;

843 
¡Üed
 < 
couÁ
 && 
max¡•s
--) {

844 
j
 = 0; j < 
bËs
; j++) {

848 ià(
bËs
 =ğ2 && 
j
 =ğ0 && 
i
 < (è
d
->
»hashidx
) {

853 ià(
i
 >ğ
d
->
ht
[1].
size
è˜ğd->
»hashidx
;

856 ià(
i
 >ğ
d
->
ht
[
j
].
size
) ;

857 
diùEÁry
 *
he
 = 
d
->
ht
[
j
].
bË
[
i
];

861 ià(
he
 =ğ
NULL
) {

862 
em±yËn
++;

863 ià(
em±yËn
 >ğ5 &&ƒm±yËÀ> 
couÁ
) {

864 
i
 = 
	`¿ndom
(è& 
maxsizemask
;

865 
em±yËn
 = 0;

868 
em±yËn
 = 0;

869 
he
) {

872 *
des
 = 
he
;

873 
des
++;

874 
he
 = he->
Ãxt
;

875 
¡Üed
++;

876 ià(
¡Üed
 =ğ
couÁ
)  stored;

880 
i
 = (i+1è& 
maxsizemask
;

882  
¡Üed
;

883 
	}
}

887 
	$»v
(
v
) {

888 
s
 = 8 * (
v
);

889 
mask
 = ~0;

890 (
s
 >>= 1) > 0) {

891 
mask
 ^ğ(mask << 
s
);

892 
v
 = ((v >> 
s
è& 
mask
) | ((v << s) & ~mask);

894  
v
;

895 
	}
}

981 
	$diùSÿn
(
diù
 *
d
,

982 
v
,

983 
diùSÿnFunùiÚ
 *
â
,

984 *
´ivd©a
)

986 
diùht
 *
t0
, *
t1
;

987 cÚ¡ 
diùEÁry
 *
de
;

988 
m0
, 
m1
;

990 ià(
	`diùSize
(
d
) == 0)  0;

992 ià(!
	`diùIsRehashšg
(
d
)) {

993 
t0
 = &(
d
->
ht
[0]);

994 
m0
 = 
t0
->
sizemask
;

997 
de
 = 
t0
->
bË
[
v
 & 
m0
];

998 
de
) {

999 
	`â
(
´ivd©a
, 
de
);

1000 
de
 = de->
Ãxt
;

1004 
t0
 = &
d
->
ht
[0];

1005 
t1
 = &
d
->
ht
[1];

1008 ià(
t0
->
size
 > 
t1
->size) {

1009 
t0
 = &
d
->
ht
[1];

1010 
t1
 = &
d
->
ht
[0];

1013 
m0
 = 
t0
->
sizemask
;

1014 
m1
 = 
t1
->
sizemask
;

1017 
de
 = 
t0
->
bË
[
v
 & 
m0
];

1018 
de
) {

1019 
	`â
(
´ivd©a
, 
de
);

1020 
de
 = de->
Ãxt
;

1027 
de
 = 
t1
->
bË
[
v
 & 
m1
];

1028 
de
) {

1029 
	`â
(
´ivd©a
, 
de
);

1030 
de
 = de->
Ãxt
;

1034 
v
 = (((v | 
m0
) + 1) & ~m0) | (v & m0);

1037 } 
v
 & (
m0
 ^ 
m1
));

1042 
v
 |ğ~
m0
;

1045 
v
 = 
	`»v
(v);

1046 
v
++;

1047 
v
 = 
	`»v
(v);

1049  
v
;

1050 
	}
}

1055 
	$_diùEx·ndIfN“ded
(
diù
 *
d
)

1058 ià(
	`diùIsRehashšg
(
d
)è 
DICT_OK
;

1061 ià(
d
->
ht
[0].
size
 =ğ0è 
	`diùEx·nd
(d, 
DICT_HT_INITIAL_SIZE
);

1067 ià(
d
->
ht
[0].
u£d
 >ğd->ht[0].
size
 &&

1068 (
diù_ÿn_»size
 ||

1069 
d
->
ht
[0].
u£d
/d->ht[0].
size
 > 
diù_fÜû_»size_¿tio
))

1071  
	`diùEx·nd
(
d
, d->
ht
[0].
u£d
*2);

1073  
DICT_OK
;

1074 
	}
}

1077 
	$_diùNextPow”
(
size
)

1079 
i
 = 
DICT_HT_INITIAL_SIZE
;

1081 ià(
size
 >ğ
LONG_MAX
)  LONG_MAX;

1083 ià(
i
 >ğ
size
)

1084  
i
;

1085 
i
 *= 2;

1087 
	}
}

1095 
	$_diùKeyIndex
(
diù
 *
d
, cÚ¡ *
key
)

1097 
h
, 
idx
, 
bË
;

1098 
diùEÁry
 *
he
;

1101 ià(
	`_diùEx·ndIfN“ded
(
d
è=ğ
DICT_ERR
)

1104 
h
 = 
	`diùHashKey
(
d
, 
key
);

1105 
bË
 = 0;able <= 1;able++) {

1106 
idx
 = 
h
 & 
d
->
ht
[
bË
].
sizemask
;

1108 
he
 = 
d
->
ht
[
bË
].bË[
idx
];

1109 
he
) {

1110 ià(
key
==
he
->key || 
	`diùCom·»Keys
(
d
, key, he->key))

1112 
he
 = he->
Ãxt
;

1114 ià(!
	`diùIsRehashšg
(
d
)) ;

1116  
idx
;

1117 
	}
}

1119 
diùEm±y
(
diù
 *
d
, (
ÿÎback
)(*)) {

1120 
	`_diùCË¬
(
d
,&d->
ht
[0],
ÿÎback
);

1121 
	`_diùCË¬
(
d
,&d->
ht
[1],
ÿÎback
);

1122 
d
->
»hashidx
 = -1;

1123 
d
->
™”©Üs
 = 0;

1124 
	}
}

1126 
	$diùEÇbËResize
() {

1127 
diù_ÿn_»size
 = 1;

1128 
	}
}

1130 
	$diùDi§bËResize
() {

1131 
diù_ÿn_»size
 = 0;

1132 
	}
}

1136 
	#DICT_STATS_VECTLEN
 50

	)

1137 
size_t
 
	$_diùG‘StsHt
(*
buf
, 
size_t
 
bufsize
, 
diùht
 *
ht
, 
bËid
) {

1138 
i
, 
¦Ùs
 = 0, 
chašËn
, 
maxchašËn
 = 0;

1139 
tÙchašËn
 = 0;

1140 
şveùÜ
[
DICT_STATS_VECTLEN
];

1141 
size_t
 
l
 = 0;

1143 ià(
ht
->
u£d
 == 0) {

1144  
	`¢´štf
(
buf
,
bufsize
,

1149 
i
 = 0; i < 
DICT_STATS_VECTLEN
; i++è
şveùÜ
[i] = 0;

1150 
i
 = 0; i < 
ht
->
size
; i++) {

1151 
diùEÁry
 *
he
;

1153 ià(
ht
->
bË
[
i
] =ğ
NULL
) {

1154 
şveùÜ
[0]++;

1157 
¦Ùs
++;

1159 
chašËn
 = 0;

1160 
he
 = 
ht
->
bË
[
i
];

1161 
he
) {

1162 
chašËn
++;

1163 
he
 = he->
Ãxt
;

1165 
şveùÜ
[(
chašËn
 < 
DICT_STATS_VECTLEN
) ? chainlen : (DICT_STATS_VECTLEN-1)]++;

1166 ià(
chašËn
 > 
maxchašËn
) maxchainlen = chainlen;

1167 
tÙchašËn
 +ğ
chašËn
;

1171 
l
 +ğ
	`¢´štf
(
buf
+l,
bufsize
-l,

1180 
bËid
, (tableid == 0) ? "main hashable" : "rehashingarget",

1181 
ht
->
size
, ht->
u£d
, 
¦Ùs
, 
maxchašËn
,

1182 ()
tÙchašËn
/
¦Ùs
, ()
ht
->
u£d
/slots);

1184 
i
 = 0; i < 
DICT_STATS_VECTLEN
-1; i++) {

1185 ià(
şveùÜ
[
i
] == 0) ;

1186 ià(
l
 >ğ
bufsize
) ;

1187 
l
 +ğ
	`¢´štf
(
buf
+l,
bufsize
-l,

1189 (
i
 =ğ
DICT_STATS_VECTLEN
-1)?">= ":"",

1190 
i
, 
şveùÜ
[i], (()şveùÜ[i]/
ht
->
size
)*100);

1194 ià(
bufsize
è
buf
[bufsize-1] = '\0';

1195  
	`¡¾’
(
buf
);

1196 
	}
}

1198 
	$diùG‘Sts
(*
buf
, 
size_t
 
bufsize
, 
diù
 *
d
) {

1199 
size_t
 
l
;

1200 *
Üig_buf
 = 
buf
;

1201 
size_t
 
Üig_bufsize
 = 
bufsize
;

1203 
l
 = 
	`_diùG‘StsHt
(
buf
,
bufsize
,&
d
->
ht
[0],0);

1204 
buf
 +ğ
l
;

1205 
bufsize
 -ğ
l
;

1206 ià(
	`diùIsRehashšg
(
d
è&& 
bufsize
 > 0) {

1207 
	`_diùG‘StsHt
(
buf
,
bufsize
,&
d
->
ht
[1],1);

1210 ià(
Üig_bufsize
è
Üig_buf
[orig_bufsize-1] = '\0';

1211 
	}
}

	@src/dict.h

36 
	~<¡dšt.h
>

38 #iâdeà
__DICT_H


39 
	#__DICT_H


	)

41 
	#DICT_OK
 0

	)

42 
	#DICT_ERR
 1

	)

45 
	#DICT_NOTUSED
(
V
è((èV)

	)

47 
	sdiùEÁry
 {

48 *
	mkey
;

50 *
	mv®
;

51 
ušt64_t
 
	mu64
;

52 
št64_t
 
	ms64
;

53 
	md
;

54 } 
	mv
;

55 
diùEÁry
 *
	mÃxt
;

56 } 
	tdiùEÁry
;

58 
	sdiùTy³
 {

59 (*
	mhashFunùiÚ
)(cÚ¡ *
	mkey
);

60 *(*
	mkeyDup
)(*
	m´ivd©a
, cÚ¡ *
	mkey
);

61 *(*
	mv®Dup
)(*
	m´ivd©a
, cÚ¡ *
	mobj
);

62 (*
	mkeyCom·»
)(*
	m´ivd©a
, cÚ¡ *
	mkey1
, cÚ¡ *
	mkey2
);

63 (*
	mkeyDe¡ruùÜ
)(*
	m´ivd©a
, *
	mkey
);

64 (*
	mv®De¡ruùÜ
)(*
	m´ivd©a
, *
	mobj
);

65 } 
	tdiùTy³
;

69 
	sdiùht
 {

70 
diùEÁry
 **
	mbË
;

71 
	msize
;

72 
	msizemask
;

73 
	mu£d
;

74 } 
	tdiùht
;

76 
	sdiù
 {

77 
diùTy³
 *
	mty³
;

78 *
	m´ivd©a
;

79 
diùht
 
	mht
[2];

80 
	m»hashidx
;

81 
	m™”©Üs
;

82 } 
	tdiù
;

88 
	sdiùI‹¿tÜ
 {

89 
diù
 *
	md
;

90 
	mšdex
;

91 
	mbË
, 
	m§ã
;

92 
diùEÁry
 *
	m’Œy
, *
	mÃxtEÁry
;

94 
	mfšg”´št
;

95 } 
	tdiùI‹¿tÜ
;

97 (
	tdiùSÿnFunùiÚ
)(*
	t´ivd©a
, cÚ¡ 
	tdiùEÁry
 *
	tde
);

100 
	#DICT_HT_INITIAL_SIZE
 4

	)

103 
	#diùF»eV®
(
d
, 
’Œy
) \

104 ià((
d
)->
ty³
->
v®De¡ruùÜ
) \

105 (
d
)->
ty³
->
	`v®De¡ruùÜ
((d)->
´ivd©a
, (
’Œy
)->
v
.
v®
)

	)

107 
	#diùS‘V®
(
d
, 
’Œy
, 
_v®_
) do { \

108 ià((
d
)->
ty³
->
v®Dup
) \

109 
’Œy
->
v
.
v®
 = (
d
)->
ty³
->
	`v®Dup
((d)->
´ivd©a
, 
_v®_
); \

111 
’Œy
->
v
.
v®
 = (
_v®_
); \

112 
	}
} 0)

	)

114 
	#diùS‘SigÃdIÁeg”V®
(
’Œy
, 
_v®_
) \

115 dØ{ 
’Œy
->
v
.
s64
 = 
_v®_
; } 0)

	)

117 
	#diùS‘UnsigÃdIÁeg”V®
(
’Œy
, 
_v®_
) \

118 dØ{ 
’Œy
->
v
.
u64
 = 
_v®_
; } 0)

	)

120 
	#diùS‘DoubËV®
(
’Œy
, 
_v®_
) \

121 dØ{ 
’Œy
->
v
.
d
 = 
_v®_
; } 0)

	)

123 
	#diùF»eKey
(
d
, 
’Œy
) \

124 ià((
d
)->
ty³
->
keyDe¡ruùÜ
) \

125 (
d
)->
ty³
->
	`keyDe¡ruùÜ
((d)->
´ivd©a
, (
’Œy
)->
key
)

	)

127 
	#diùS‘Key
(
d
, 
’Œy
, 
_key_
) do { \

128 ià((
d
)->
ty³
->
keyDup
) \

129 
’Œy
->
key
 = (
d
)->
ty³
->
	`keyDup
((d)->
´ivd©a
, 
_key_
); \

131 
’Œy
->
key
 = (
_key_
); \

132 } 0)

	)

134 
	#diùCom·»Keys
(
d
, 
key1
, 
key2
) \

135 (((
d
)->
ty³
->
keyCom·»
) ? \

136 (
d
)->
ty³
->
	`keyCom·»
((d)->
´ivd©a
, 
key1
, 
key2
) : \

137 (
key1
è=ğ(
key2
))

	)

139 
	#diùHashKey
(
d
, 
key
è(d)->
ty³
->
	`hashFunùiÚ
(key)

	)

140 
	#diùG‘Key
(
he
è((he)->
key
)

	)

141 
	#diùG‘V®
(
he
è((he)->
v
.
v®
)

	)

142 
	#diùG‘SigÃdIÁeg”V®
(
he
è((he)->
v
.
s64
)

	)

143 
	#diùG‘UnsigÃdIÁeg”V®
(
he
è((he)->
v
.
u64
)

	)

144 
	#diùG‘DoubËV®
(
he
è((he)->
v
.
d
)

	)

145 
	#diùSlÙs
(
d
è((d)->
ht
[0].
size
+(d)->ht[1].size)

	)

146 
	#diùSize
(
d
è((d)->
ht
[0].
u£d
+(d)->ht[1].u£d)

	)

147 
	#diùIsRehashšg
(
d
è((d)->
»hashidx
 !ğ-1)

	)

150 
diù
 *
diùC»©e
(
diùTy³
 *
ty³
, *
´ivD©aPŒ
);

151 
diùEx·nd
(
diù
 *
d
, 
size
);

152 
diùAdd
(
diù
 *
d
, *
key
, *
v®
);

153 
diùEÁry
 *
diùAddRaw
(
diù
 *
d
, *
key
);

154 
diùR•Ïû
(
diù
 *
d
, *
key
, *
v®
);

155 
diùEÁry
 *
diùR•ÏûRaw
(
diù
 *
d
, *
key
);

156 
diùD–‘e
(
diù
 *
d
, cÚ¡ *
key
);

157 
diùD–‘eNoF»e
(
diù
 *
d
, cÚ¡ *
key
);

158 
diùR–—£
(
diù
 *
d
);

159 
diùEÁry
 * 
diùFšd
(
diù
 *
d
, cÚ¡ *
key
);

160 *
diùF‘chV®ue
(
diù
 *
d
, cÚ¡ *
key
);

161 
diùResize
(
diù
 *
d
);

162 
diùI‹¿tÜ
 *
diùG‘I‹¿tÜ
(
diù
 *
d
);

163 
diùI‹¿tÜ
 *
diùG‘SaãI‹¿tÜ
(
diù
 *
d
);

164 
diùEÁry
 *
diùNext
(
diùI‹¿tÜ
 *
™”
);

165 
diùR–—£I‹¿tÜ
(
diùI‹¿tÜ
 *
™”
);

166 
diùEÁry
 *
diùG‘RªdomKey
(
diù
 *
d
);

167 
diùG‘SomeKeys
(
diù
 *
d
, 
diùEÁry
 **
des
, 
couÁ
);

168 
diùG‘Sts
(*
buf
, 
size_t
 
bufsize
, 
diù
 *
d
);

169 
diùG’HashFunùiÚ
(cÚ¡ *
key
, 
Ën
);

170 
diùG’Ca£HashFunùiÚ
(cÚ¡ *
buf
, 
Ën
);

171 
diùEm±y
(
diù
 *
d
, (
ÿÎback
)(*));

172 
	`diùEÇbËResize
();

173 
	`diùDi§bËResize
();

174 
	`diùRehash
(
diù
 *
d
, 
n
);

175 
	`diùRehashMli£cÚds
(
diù
 *
d
, 
ms
);

176 
	`diùS‘HashFunùiÚS“d
(
š™v®
);

177 
	`diùG‘HashFunùiÚS“d
();

178 
	`diùSÿn
(
diù
 *
d
, 
v
, 
diùSÿnFunùiÚ
 *
â
, *
´ivd©a
);

180 #ifdeà
USE_PMDK


182 
	`diùAddPM
(
diù
 *
d
, *
key
, *
v®
);

183 
diùEÁry
 *
	`diùAddRawPM
(
diù
 *
d
, *
key
);

184 
diùEÁry
 *
	`diùAddRecÚ¡ruùedPM
(
diù
 *
d
, *
key
, *
v®
);

185 
	`diùR•ÏûPM
(
diù
 *
d
, *
key
, *
v®
);

189 
diùTy³
 
diùTy³H—pSŒšgCİyKey
;

190 
diùTy³
 
diùTy³H—pSŒšgs
;

191 
diùTy³
 
diùTy³H—pSŒšgCİyKeyV®ue
;

	@src/endianconv.c

45 
	~<¡dšt.h
>

49 
	$mem»v16
(*
p
) {

50 *
x
 = 
p
, 
t
;

52 
t
 = 
x
[0];

53 
x
[0] = x[1];

54 
x
[1] = 
t
;

55 
	}
}

59 
	$mem»v32
(*
p
) {

60 *
x
 = 
p
, 
t
;

62 
t
 = 
x
[0];

63 
x
[0] = x[3];

64 
x
[3] = 
t
;

65 
t
 = 
x
[1];

66 
x
[1] = x[2];

67 
x
[2] = 
t
;

68 
	}
}

72 
	$mem»v64
(*
p
) {

73 *
x
 = 
p
, 
t
;

75 
t
 = 
x
[0];

76 
x
[0] = x[7];

77 
x
[7] = 
t
;

78 
t
 = 
x
[1];

79 
x
[1] = x[6];

80 
x
[6] = 
t
;

81 
t
 = 
x
[2];

82 
x
[2] = x[5];

83 
x
[5] = 
t
;

84 
t
 = 
x
[3];

85 
x
[3] = x[4];

86 
x
[4] = 
t
;

87 
	}
}

89 
ušt16_t
 
	$šŒev16
(
ušt16_t
 
v
) {

90 
	`mem»v16
(&
v
);

91  
v
;

92 
	}
}

94 
ušt32_t
 
	$šŒev32
(
ušt32_t
 
v
) {

95 
	`mem»v32
(&
v
);

96  
v
;

97 
	}
}

99 
ušt64_t
 
	$šŒev64
(
ušt64_t
 
v
) {

100 
	`mem»v64
(&
v
);

101  
v
;

102 
	}
}

104 #ifdeà
REDIS_TEST


105 
	~<¡dio.h
>

107 
	#UNUSED
(
x
è()(x)

	)

108 
	$’dŸncÚvTe¡
(
¬gc
, *
¬gv
[]) {

109 
buf
[32];

111 
	`UNUSED
(
¬gc
);

112 
	`UNUSED
(
¬gv
);

114 
	`¥rštf
(
buf
,"ciaoroma");

115 
	`mem»v16
(
buf
);

116 
	`´štf
("%s\n", 
buf
);

118 
	`¥rštf
(
buf
,"ciaoroma");

119 
	`mem»v32
(
buf
);

120 
	`´štf
("%s\n", 
buf
);

122 
	`¥rštf
(
buf
,"ciaoroma");

123 
	`mem»v64
(
buf
);

124 
	`´štf
("%s\n", 
buf
);

127 
	}
}

	@src/endianconv.h

33 #iâdeà
__ENDIANCONV_H


34 
	#__ENDIANCONV_H


	)

36 
	~"cÚfig.h
"

37 
	~<¡dšt.h
>

39 
mem»v16
(*
p
);

40 
mem»v32
(*
p
);

41 
mem»v64
(*
p
);

42 
ušt16_t
 
šŒev16
(ušt16_ˆ
v
);

43 
ušt32_t
 
šŒev32
(ušt32_ˆ
v
);

44 
ušt64_t
 
šŒev64
(ušt64_ˆ
v
);

48 #ià(
BYTE_ORDER
 =ğ
LITTLE_ENDIAN
)

49 
	#mem»v16ifbe
(
p
)

	)

50 
	#mem»v32ifbe
(
p
)

	)

51 
	#mem»v64ifbe
(
p
)

	)

52 
	#šŒev16ifbe
(
v
è(v)

	)

53 
	#šŒev32ifbe
(
v
è(v)

	)

54 
	#šŒev64ifbe
(
v
è(v)

	)

56 
	#mem»v16ifbe
(
p
è
	`mem»v16
Õ)

	)

57 
	#mem»v32ifbe
(
p
è
	`mem»v32
Õ)

	)

58 
	#mem»v64ifbe
(
p
è
	`mem»v64
Õ)

	)

59 
	#šŒev16ifbe
(
v
è
	`šŒev16
(v)

	)

60 
	#šŒev32ifbe
(
v
è
	`šŒev32
(v)

	)

61 
	#šŒev64ifbe
(
v
è
	`šŒev64
(v)

	)

66 #ià(
BYTE_ORDER
 =ğ
BIG_ENDIAN
)

67 
	#htÚu64
(
v
è(v)

	)

68 
	#Áohu64
(
v
è(v)

	)

70 
	#htÚu64
(
v
è
	`šŒev64
(v)

	)

71 
	#Áohu64
(
v
è
	`šŒev64
(v)

	)

74 #ifdeà
REDIS_TEST


75 
’dŸncÚvTe¡
(
¬gc
, *
¬gv
[]);

	@src/fmacros.h

30 #iâdeà
_REDIS_FMACRO_H


31 
	#_REDIS_FMACRO_H


	)

33 
	#_BSD_SOURCE


	)

35 #ià
defšed
(
__lšux__
)

36 
	#_GNU_SOURCE


	)

37 
	#_DEFAULT_SOURCE


	)

40 #ià
defšed
(
_AIX
)

41 
	#_ALL_SOURCE


	)

44 #ià
defšed
(
__lšux__
è|| defšed(
__O³nBSD__
)

45 
	#_XOPEN_SOURCE
 700

	)

50 #–ià!
defšed
(
__N‘BSD__
)

51 
	#_XOPEN_SOURCE


	)

54 #ià
defšed
(
__sun
)

55 
	#_POSIX_C_SOURCE
 199506L

	)

58 
	#_LARGEFILE_SOURCE


	)

59 
	#_FILE_OFFSET_BITS
 64

	)

	@src/geo.c

31 
	~"geo.h
"

32 
	~"geohash_h–³r.h
"

33 
	~"debugmaüo.h
"

37 *
zzlFœ¡InRªge
(*
zl
, 
z¿nge¥ec
 *
¿nge
);

38 
z¦V®ueL‹Max
(
v®ue
, 
z¿nge¥ec
 *
¥ec
);

53 
geoA¼ay
 *
	$geoA¼ayC»©e
() {

54 
geoA¼ay
 *
ga
 = 
	`zm®loc
((*ga));

56 
ga
->
¬¿y
 = 
NULL
;

57 
ga
->
buck‘s
 = 0;

58 
ga
->
u£d
 = 0;

59  
ga
;

60 
	}
}

64 
geoPošt
 *
	$geoA¼ayAµ’d
(
geoA¼ay
 *
ga
) {

65 ià(
ga
->
u£d
 =ğga->
buck‘s
) {

66 
ga
->
buck‘s
 = (ga->buckets == 0) ? 8 : ga->buckets*2;

67 
ga
->
¬¿y
 = 
	`z»®loc
(ga->¬¿y,(
geoPošt
)*ga->
buck‘s
);

69 
geoPošt
 *
gp
 = 
ga
->
¬¿y
+ga->
u£d
;

70 
ga
->
u£d
++;

71  
gp
;

72 
	}
}

75 
	$geoA¼ayF»e
(
geoA¼ay
 *
ga
) {

76 
size_t
 
i
;

77 
i
 = 0; i < 
ga
->
u£d
; i++è
	`sdsä“
(ga->
¬¿y
[i].
memb”
);

78 
	`zä“
(
ga
->
¬¿y
);

79 
	`zä“
(
ga
);

80 
	}
}

85 
	$decodeGeohash
(
b™s
, *
xy
) {

86 
GeoHashB™s
 
hash
 = { .
b™s
 = (
ušt64_t
)b™s, .
¡•
 = 
GEO_STEP_MAX
 };

87  
	`geohashDecodeToLÚgL©WGS84
(
hash
, 
xy
);

88 
	}
}

93 
	$exŒaùLÚgL©OrR•ly
(
ş›Á
 *
c
, 
robj
 **
¬gv
, *
xy
) {

94 
i
;

95 
i
 = 0; i < 2; i++) {

96 ià(
	`g‘DoubËFromObjeùOrR•ly
(
c
, 
¬gv
[
i
], 
xy
 + i, 
NULL
) !=

97 
C_OK
) {

98  
C_ERR
;

101 ià(
xy
[0] < 
GEO_LONG_MIN
 || xy[0] > 
GEO_LONG_MAX
 ||

102 
xy
[1] < 
GEO_LAT_MIN
 || xy[1] > 
GEO_LAT_MAX
) {

103 
	`addR•lySds
(
c
, 
	`sdsÿrštf
(
	`sd£m±y
(),

104 "-ERR inv®id†Úg™ude,Ït™ud·œ %f,%f\r\n",
xy
[0],xy[1]));

105  
C_ERR
;

107  
C_OK
;

108 
	}
}

113 
	$lÚgL©FromMemb”
(
robj
 *
zobj
,„obj *
memb”
, *
xy
) {

114 
scÜe
 = 0;

116 ià(
	`z£tScÜe
(
zobj
, 
memb”
, &
scÜe
è=ğ
C_ERR
)  C_ERR;

117 ià(!
	`decodeGeohash
(
scÜe
, 
xy
)è 
C_ERR
;

118  
C_OK
;

119 
	}
}

127 
	$exŒaùUn™OrR•ly
(
ş›Á
 *
c
, 
robj
 *
un™
) {

128 *
u
 = 
un™
->
±r
;

130 ià(!
	`¡rcmp
(
u
, "m")) {

132 } ià(!
	`¡rcmp
(
u
, "km")) {

134 } ià(!
	`¡rcmp
(
u
, "ft")) {

136 } ià(!
	`¡rcmp
(
u
, "mi")) {

139 
	`addR•lyE¼Ü
(
c
,

143 
	}
}

152 
	$exŒaùDi¡ªûOrR•ly
(
ş›Á
 *
c
, 
robj
 **
¬gv
,

153 *
cÚv”siÚ
) {

154 
di¡ªû
;

155 ià(
	`g‘DoubËFromObjeùOrR•ly
(
c
, 
¬gv
[0], &
di¡ªû
,

156 "Ãed‚um”iø¿dius"è!ğ
C_OK
) {

160 ià(
di¡ªû
 < 0) {

161 
	`addR•lyE¼Ü
(
c
,"radius cannot be‚egative");

165 
to_m‘”s
 = 
	`exŒaùUn™OrR•ly
(
c
,
¬gv
[1]);

166 ià(
to_m‘”s
 < 0) {

170 ià(
cÚv”siÚ
è*cÚv”siÚ = 
to_m‘”s
;

171  
di¡ªû
 * 
to_m‘”s
;

172 
	}
}

179 
	$addR•lyDoubËDi¡ªû
(
ş›Á
 *
c
, 
d
) {

180 
dbuf
[128];

181 
dËn
 = 
	`¢´štf
(
dbuf
, (dbuf), "%.4f", 
d
);

182 
	`addR•lyBulkCBufãr
(
c
, 
dbuf
, 
dËn
);

183 
	}
}

191 
	$geoAµ’dIfW™hšRadius
(
geoA¼ay
 *
ga
, 
lÚ
, 
Ït
, 
¿dius
, 
scÜe
, 
sds
 
memb”
) {

192 
di¡ªû
, 
xy
[2];

194 ià(!
	`decodeGeohash
(
scÜe
,
xy
)è 
C_ERR
;

197 ià(!
	`geohashG‘Di¡ªûIfInRadiusWGS84
(
lÚ
,
Ït
, 
xy
[0], xy[1],

198 
¿dius
, &
di¡ªû
))

200  
C_ERR
;

204 
geoPošt
 *
gp
 = 
	`geoA¼ayAµ’d
(
ga
);

205 
gp
->
lÚg™ude
 = 
xy
[0];

206 
gp
->
Ït™ude
 = 
xy
[1];

207 
gp
->
di¡
 = 
di¡ªû
;

208 
gp
->
memb”
 = member;

209 
gp
->
scÜe
 = score;

210  
C_OK
;

211 
	}
}

225 
	$geoG‘PoštsInRªge
(
robj
 *
zobj
, 
mš
, 
max
, 
lÚ
, 
Ït
, 
¿dius
, 
geoA¼ay
 *
ga
) {

228 
z¿nge¥ec
 
¿nge
 = { .
mš
 = mš, .
max
 = max, .
mšex
 = 0, .
maxex
 = 1 };

229 
size_t
 
ÜigšcouÁ
 = 
ga
->
u£d
;

230 
sds
 
memb”
;

232 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

233 *
zl
 = 
zobj
->
±r
;

234 *
•Œ
, *
¥Œ
;

235 *
v¡r
 = 
NULL
;

236 
vËn
 = 0;

237 
vlÚg
 = 0;

238 
scÜe
 = 0;

240 ià((
•Œ
 = 
	`zzlFœ¡InRªge
(
zl
, &
¿nge
)è=ğ
NULL
) {

245 
¥Œ
 = 
	`zli¡Next
(
zl
, 
•Œ
);

246 
•Œ
) {

247 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

250 ià(!
	`z¦V®ueL‹Max
(
scÜe
, &
¿nge
))

254 
	`zli¡G‘
(
•Œ
, &
v¡r
, &
vËn
, &
vlÚg
);

255 
memb”
 = (
v¡r
 =ğ
NULL
è? 
	`sdsäomlÚglÚg
(
vlÚg
) :

256 
	`sd¢ewËn
(
v¡r
,
vËn
);

257 ià(
	`geoAµ’dIfW™hšRadius
(
ga
,
lÚ
,
Ït
,
¿dius
,
scÜe
,
memb”
)

258 =ğ
C_ERR
è
	`sdsä“
(
memb”
);

259 
	`zzlNext
(
zl
, &
•Œ
, &
¥Œ
);

261 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

262 
z£t
 *
zs
 = 
zobj
->
±r
;

263 
zskli¡
 *
z¦
 = 
zs
->zsl;

264 
zskli¡Node
 *
Ê
;

266 ià((
Ê
 = 
	`z¦Fœ¡InRªge
(
z¦
, &
¿nge
)è=ğ
NULL
) {

271 
Ê
) {

272 
robj
 *
o
 = 
Ê
->
obj
;

274 ià(!
	`z¦V®ueL‹Max
(
Ê
->
scÜe
, &
¿nge
))

277 
memb”
 = (
o
->
’codšg
 =ğ
OBJ_ENCODING_INT
) ?

278 
	`sdsäomlÚglÚg
(()
o
->
±r
) :

279 
	`sdsdup
(
o
->
±r
);

280 ià(
	`geoAµ’dIfW™hšRadius
(
ga
,
lÚ
,
Ït
,
¿dius
,
Ê
->
scÜe
,
memb”
)

281 =ğ
C_ERR
è
	`sdsä“
(
memb”
);

282 
Ê
 =†n->
Ëv–
[0].
fÜw¬d
;

285  
ga
->
u£d
 - 
ÜigšcouÁ
;

286 
	}
}

291 
	$scÜesOfGeoHashBox
(
GeoHashB™s
 
hash
, 
GeoHashFix52B™s
 *
mš
, GeoHashFix52B™ *
max
) {

312 *
mš
 = 
	`geohashAlign52B™s
(
hash
);

313 
hash
.
b™s
++;

314 *
max
 = 
	`geohashAlign52B™s
(
hash
);

315 
	}
}

320 
	$memb”sOfGeoHashBox
(
robj
 *
zobj
, 
GeoHashB™s
 
hash
, 
geoA¼ay
 *
ga
, 
lÚ
, 
Ït
, 
¿dius
) {

321 
GeoHashFix52B™s
 
mš
, 
max
;

323 
	`scÜesOfGeoHashBox
(
hash
,&
mš
,&
max
);

324  
	`geoG‘PoštsInRªge
(
zobj
, 
mš
, 
max
, 
lÚ
, 
Ït
, 
¿dius
, 
ga
);

325 
	}
}

328 
	$memb”sOfAÎNeighbÜs
(
robj
 *
zobj
, 
GeoHashRadius
 
n
, 
lÚ
, 
Ït
, 
¿dius
, 
geoA¼ay
 *
ga
) {

329 
GeoHashB™s
 
ÃighbÜs
[9];

330 
i
, 
couÁ
 = 0, 
Ï¡_´oûs£d
 = 0;

331 
debugmsg
 = 0;

333 
ÃighbÜs
[0] = 
n
.
hash
;

334 
ÃighbÜs
[1] = 
n
.ÃighbÜs.
nÜth
;

335 
ÃighbÜs
[2] = 
n
.ÃighbÜs.
south
;

336 
ÃighbÜs
[3] = 
n
.ÃighbÜs.
—¡
;

337 
ÃighbÜs
[4] = 
n
.ÃighbÜs.
we¡
;

338 
ÃighbÜs
[5] = 
n
.ÃighbÜs.
nÜth_—¡
;

339 
ÃighbÜs
[6] = 
n
.ÃighbÜs.
nÜth_we¡
;

340 
ÃighbÜs
[7] = 
n
.ÃighbÜs.
south_—¡
;

341 
ÃighbÜs
[8] = 
n
.ÃighbÜs.
south_we¡
;

345 
i
 = 0; i < (
ÃighbÜs
) / (*neighbors); i++) {

346 ià(
	`HASHISZERO
(
ÃighbÜs
[
i
])) {

347 ià(
debugmsg
è
	`D
("ÃighbÜs[%d] i z”o",
i
);

352 ià(
debugmsg
) {

353 
GeoHashRªge
 
lÚg_¿nge
, 
Ït_¿nge
;

354 
	`geohashG‘CoÜdRªge
(&
lÚg_¿nge
,&
Ït_¿nge
);

355 
GeoHashA»a
 
my¬—
 = {{0,0},{0,0},{0,0}};

356 
	`geohashDecode
(
lÚg_¿nge
, 
Ït_¿nge
, 
ÃighbÜs
[
i
], &
my¬—
);

359 
	`D
("ÃighbÜs[%d]:\n",
i
);

360 
	`D
("¬—.lÚg™ude.mš: %f\n", 
my¬—
.
lÚg™ude
.
mš
);

361 
	`D
("¬—.lÚg™ude.max: %f\n", 
my¬—
.
lÚg™ude
.
max
);

362 
	`D
("¬—.Ït™ude.mš: %f\n", 
my¬—
.
Ït™ude
.
mš
);

363 
	`D
("¬—.Ït™ude.max: %f\n", 
my¬—
.
Ït™ude
.
max
);

364 
	`D
("\n");

371 ià(
Ï¡_´oûs£d
 &&

372 
ÃighbÜs
[
i
].
b™s
 =ğÃighbÜs[
Ï¡_´oûs£d
].bits &&

373 
ÃighbÜs
[
i
].
¡•
 =ğÃighbÜs[
Ï¡_´oûs£d
].step)

375 ià(
debugmsg
)

376 
	`D
("Skpšg…roûssšg oà%d, sama ´evious\n",
i
);

379 
couÁ
 +ğ
	`memb”sOfGeoHashBox
(
zobj
, 
ÃighbÜs
[
i
], 
ga
, 
lÚ
, 
Ït
, 
¿dius
);

380 
Ï¡_´oûs£d
 = 
i
;

382  
couÁ
;

383 
	}
}

386 
	$sÜt_gp_asc
(cÚ¡ *
a
, cÚ¡ *
b
) {

387 cÚ¡ 
geoPošt
 *
g·
 = 
a
, *
gpb
 = 
b
;

390 ià(
g·
->
di¡
 > 
gpb
->dist)

392 ià(
g·
->
di¡
 =ğ
gpb
->dist)

396 
	}
}

398 
	$sÜt_gp_desc
(cÚ¡ *
a
, cÚ¡ *
b
) {

399  -
	`sÜt_gp_asc
(
a
, 
b
);

400 
	}
}

407 
	$geßddCommªd
(
ş›Á
 *
c
) {

409 ià((
c
->
¬gc
 - 2) % 3 != 0) {

411 
	`addR•lyE¼Ü
(
c
, "syntaxƒrror. Try GEOADD key [x1] [y1] [name1] "

416 
–em’ts
 = (
c
->
¬gc
 - 2) / 3;

417 
¬gc
 = 2+
–em’ts
*2;

418 
robj
 **
¬gv
 = 
	`zÿÎoc
(
¬gc
*(robj*));

419 
¬gv
[0] = 
	`ü—‹RawSŒšgObjeù
("zadd",4);

420 
¬gv
[1] = 
c
->argv[1];

421 
	`šüRefCouÁ
(
¬gv
[1]);

426 
i
;

427 
i
 = 0; i < 
–em’ts
; i++) {

428 
xy
[2];

430 ià(
	`exŒaùLÚgL©OrR•ly
(
c
, (c->
¬gv
+2)+(
i
*3),
xy
è=ğ
C_ERR
) {

431 
i
 = 0; i < 
¬gc
; i++)

432 ià(
¬gv
[
i
]è
	`deüRefCouÁ
(argv[i]);

433 
	`zä“
(
¬gv
);

438 
GeoHashB™s
 
hash
;

439 
	`geohashEncodeWGS84
(
xy
[0], xy[1], 
GEO_STEP_MAX
, &
hash
);

440 
GeoHashFix52B™s
 
b™s
 = 
	`geohashAlign52B™s
(
hash
);

441 
robj
 *
scÜe
 = 
	`ü—‹Objeù
(
OBJ_STRING
, 
	`sdsäomlÚglÚg
(
b™s
));

442 
robj
 *
v®
 = 
c
->
¬gv
[2 + 
i
 * 3 + 2];

443 
¬gv
[2+
i
*2] = 
scÜe
;

444 
¬gv
[3+
i
*2] = 
v®
;

445 
	`šüRefCouÁ
(
v®
);

449 
	`»¶aûCl›ÁCommªdVeùÜ
(
c
,
¬gc
,
¬gv
);

450 
	`zaddCommªd
(
c
);

451 
	}
}

453 
	#SORT_NONE
 0

	)

454 
	#SORT_ASC
 1

	)

455 
	#SORT_DESC
 2

	)

457 
	#RADIUS_COORDS
 1

	)

458 
	#RADIUS_MEMBER
 2

	)

463 
	$geÜadiusG’”ic
(
ş›Á
 *
c
, 
ty³
) {

464 
robj
 *
key
 = 
c
->
¬gv
[1];

465 
robj
 *
¡Üekey
 = 
NULL
;

466 
¡Üedi¡
 = 0;

469 
robj
 *
zobj
 = 
NULL
;

470 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
, 
key
, 
sh¬ed
.
em±ymuÉibulk
)è=ğ
NULL
 ||

471 
	`checkTy³
(
c
, 
zobj
, 
OBJ_ZSET
)) {

476 
ba£_¬gs
;

477 
xy
[2] = { 0 };

478 ià(
ty³
 =ğ
RADIUS_COORDS
) {

479 
ba£_¬gs
 = 6;

480 ià(
	`exŒaùLÚgL©OrR•ly
(
c
, c->
¬gv
 + 2, 
xy
è=ğ
C_ERR
)

482 } ià(
ty³
 =ğ
RADIUS_MEMBER
) {

483 
ba£_¬gs
 = 5;

484 
robj
 *
memb”
 = 
c
->
¬gv
[2];

485 ià(
	`lÚgL©FromMemb”
(
zobj
, 
memb”
, 
xy
è=ğ
C_ERR
) {

486 
	`addR•lyE¼Ü
(
c
, "could‚ot decode„equested zset member");

490 
	`addR•lyE¼Ü
(
c
, "unknown georadius searchype");

495 
¿dius_m‘”s
 = 0, 
cÚv”siÚ
 = 1;

496 ià((
¿dius_m‘”s
 = 
	`exŒaùDi¡ªûOrR•ly
(
c
, c->
¬gv
 + 
ba£_¬gs
 - 2,

497 &
cÚv”siÚ
)) < 0) {

502 
w™hdi¡
 = 0, 
w™hhash
 = 0, 
w™hcoÜds
 = 0;

503 
sÜt
 = 
SORT_NONE
;

504 
couÁ
 = 0;

505 ià(
c
->
¬gc
 > 
ba£_¬gs
) {

506 
»maššg
 = 
c
->
¬gc
 - 
ba£_¬gs
;

507 
i
 = 0; i < 
»maššg
; i++) {

508 *
¬g
 = 
c
->
¬gv
[
ba£_¬gs
 + 
i
]->
±r
;

509 ià(!
	`¡rÿ£cmp
(
¬g
, "withdist")) {

510 
w™hdi¡
 = 1;

511 } ià(!
	`¡rÿ£cmp
(
¬g
, "withhash")) {

512 
w™hhash
 = 1;

513 } ià(!
	`¡rÿ£cmp
(
¬g
, "withcoord")) {

514 
w™hcoÜds
 = 1;

515 } ià(!
	`¡rÿ£cmp
(
¬g
, "asc")) {

516 
sÜt
 = 
SORT_ASC
;

517 } ià(!
	`¡rÿ£cmp
(
¬g
, "desc")) {

518 
sÜt
 = 
SORT_DESC
;

519 } ià(!
	`¡rÿ£cmp
(
¬g
, "couÁ"è&& (
i
+1è< 
»maššg
) {

520 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[
ba£_¬gs
+
i
+1],

521 &
couÁ
, 
NULL
è!ğ
C_OK
) ;

522 ià(
couÁ
 <= 0) {

523 
	`addR•lyE¼Ü
(
c
,"COUNT must be > 0");

526 
i
++;

527 } ià(!
	`¡rÿ£cmp
(
¬g
, "¡Üe"è&& (
i
+1è< 
»maššg
) {

528 
¡Üekey
 = 
c
->
¬gv
[
ba£_¬gs
+
i
+1];

529 
¡Üedi¡
 = 0;

530 
i
++;

531 } ià(!
	`¡rÿ£cmp
(
¬g
, "¡Üedi¡"è&& (
i
+1è< 
»maššg
) {

532 
¡Üekey
 = 
c
->
¬gv
[
ba£_¬gs
+
i
+1];

533 
¡Üedi¡
 = 1;

534 
i
++;

536 
	`addR•ly
(
c
, 
sh¬ed
.
syÁax”r
);

543 ià(
¡Üekey
 && (
w™hdi¡
 || 
w™hhash
 || 
w™hcoÜds
)) {

544 
	`addR•lyE¼Ü
(
c
,

552 ià(
couÁ
 !ğ0 && 
sÜt
 =ğ
SORT_NONE
èsÜˆğ
SORT_ASC
;

555 
GeoHashRadius
 
geÜadius
 =

556 
	`geohashG‘A»asByRadiusWGS84
(
xy
[0], xy[1], 
¿dius_m‘”s
);

559 
geoA¼ay
 *
ga
 = 
	`geoA¼ayC»©e
();

560 
	`memb”sOfAÎNeighbÜs
(
zobj
, 
geÜadius
, 
xy
[0], xy[1], 
¿dius_m‘”s
, 
ga
);

563 ià(
ga
->
u£d
 =ğ0 && 
¡Üekey
 =ğ
NULL
) {

564 
	`addR•ly
(
c
, 
sh¬ed
.
em±ymuÉibulk
);

565 
	`geoA¼ayF»e
(
ga
);

569 
»suÉ_Ëngth
 = 
ga
->
u£d
;

570 
»tuºed_™ems
 = (
couÁ
 =ğ0 || 
»suÉ_Ëngth
 < count) ?

571 
»suÉ_Ëngth
 : 
couÁ
;

572 
İtiÚ_Ëngth
 = 0;

575 ià(
sÜt
 =ğ
SORT_ASC
) {

576 
	`qsÜt
(
ga
->
¬¿y
, 
»suÉ_Ëngth
, (
geoPošt
), 
sÜt_gp_asc
);

577 } ià(
sÜt
 =ğ
SORT_DESC
) {

578 
	`qsÜt
(
ga
->
¬¿y
, 
»suÉ_Ëngth
, (
geoPošt
), 
sÜt_gp_desc
);

581 ià(
¡Üekey
 =ğ
NULL
) {

586 ià(
w™hdi¡
)

587 
İtiÚ_Ëngth
++;

589 ià(
w™hcoÜds
)

590 
İtiÚ_Ëngth
++;

592 ià(
w™hhash
)

593 
İtiÚ_Ëngth
++;

599 
	`addR•lyMuÉiBulkL’
(
c
, 
»tuºed_™ems
);

602 
i
;

603 
i
 = 0; i < 
»tuºed_™ems
; i++) {

604 
geoPošt
 *
gp
 = 
ga
->
¬¿y
+
i
;

605 
gp
->
di¡
 /ğ
cÚv”siÚ
;

610 ià(
İtiÚ_Ëngth
)

611 
	`addR•lyMuÉiBulkL’
(
c
, 
İtiÚ_Ëngth
 + 1);

613 
	`addR•lyBulkSds
(
c
,
gp
->
memb”
);

614 
gp
->
memb”
 = 
NULL
;

616 ià(
w™hdi¡
)

617 
	`addR•lyDoubËDi¡ªû
(
c
, 
gp
->
di¡
);

619 ià(
w™hhash
)

620 
	`addR•lyLÚgLÚg
(
c
, 
gp
->
scÜe
);

622 ià(
w™hcoÜds
) {

623 
	`addR•lyMuÉiBulkL’
(
c
, 2);

624 
	`addR•lyHumªLÚgDoubË
(
c
, 
gp
->
lÚg™ude
);

625 
	`addR•lyHumªLÚgDoubË
(
c
, 
gp
->
Ït™ude
);

630 
robj
 *
zobj
;

631 
z£t
 *
zs
;

632 
i
;

633 
size_t
 
max––’
 = 0;

635 ià(
»tuºed_™ems
) {

636 
zobj
 = 
	`ü—‹Z£tObjeù
();

637 
zs
 = 
zobj
->
±r
;

640 
i
 = 0; i < 
»tuºed_™ems
; i++) {

641 
zskli¡Node
 *
znode
;

642 
geoPošt
 *
gp
 = 
ga
->
¬¿y
+
i
;

643 
gp
->
di¡
 /ğ
cÚv”siÚ
;

644 
scÜe
 = 
¡Üedi¡
 ? 
gp
->
di¡
 : gp->score;

645 
size_t
 
––’
 = 
	`sd¦’
(
gp
->
memb”
);

646 
robj
 *
–e
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
gp
->
memb”
);

648 ià(
max––’
 < 
––’
) maxelelen =ƒlelen;

649 
	`šüRefCouÁ
(
–e
);

651 
znode
 = 
	`z¦In£¹
(
zs
->
z¦
,
scÜe
,
–e
);

652 
	`£rv”As£¹
(
	`diùAdd
(
zs
->
diù
,
–e
,&
znode
->
scÜe
è=ğ
DICT_OK
);

653 
gp
->
memb”
 = 
NULL
;

656 ià(
»tuºed_™ems
) {

657 
	`z£tCÚv”tToZli¡IfN“ded
(
zobj
,
max––’
);

658 
	`£tKey
(
c
->
db
,
¡Üekey
,
zobj
);

659 
	`deüRefCouÁ
(
zobj
);

660 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,"geÜadius¡Üe",
¡Üekey
,

661 
c
->
db
->
id
);

662 
£rv”
.
dœty
 +ğ
»tuºed_™ems
;

663 } ià(
	`dbD–‘e
(
c
->
db
,
¡Üekey
)) {

664 
	`sigÇlModif›dKey
(
c
->
db
,
¡Üekey
);

665 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
¡Üekey
,
c
->
db
->
id
);

666 
£rv”
.
dœty
++;

668 
	`addR•lyLÚgLÚg
(
c
, 
»tuºed_™ems
);

670 
	`geoA¼ayF»e
(
ga
);

671 
	}
}

674 
	$geÜadiusCommªd
(
ş›Á
 *
c
) {

675 
	`geÜadiusG’”ic
(
c
, 
RADIUS_COORDS
);

676 
	}
}

679 
	$geÜadiusByMemb”Commªd
(
ş›Á
 *
c
) {

680 
	`geÜadiusG’”ic
(
c
, 
RADIUS_MEMBER
);

681 
	}
}

687 
	$geohashCommªd
(
ş›Á
 *
c
) {

688 *
geßÍhab‘
= "0123456789bcdefghjkmnpqrstuvwxyz";

689 
j
;

692 
robj
 *
zobj
 = 
NULL
;

693 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
, c->
¬gv
[1], 
sh¬ed
.
em±ymuÉibulk
))

694 =ğ
NULL
 || 
	`checkTy³
(
c
, 
zobj
, 
OBJ_ZSET
)) ;

698 
	`addR•lyMuÉiBulkL’
(
c
,c->
¬gc
-2);

699 
j
 = 2; j < 
c
->
¬gc
; j++) {

700 
scÜe
;

701 ià(
	`z£tScÜe
(
zobj
, 
c
->
¬gv
[
j
], &
scÜe
è=ğ
C_ERR
) {

702 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

711 
xy
[2];

712 ià(!
	`decodeGeohash
(
scÜe
,
xy
)) {

713 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

718 
GeoHashRªge
 
r
[2];

719 
GeoHashB™s
 
hash
;

720 
r
[0].
mš
 = -180;

721 
r
[0].
max
 = 180;

722 
r
[1].
mš
 = -90;

723 
r
[1].
max
 = 90;

724 
	`geohashEncode
(&
r
[0],&r[1],
xy
[0],xy[1],26,&
hash
);

726 
buf
[12];

727 
i
;

728 
i
 = 0; i < 11; i++) {

729 
idx
 = (
hash
.
b™s
 >> (52-((
i
+1)*5))) & 0x1f;

730 
buf
[
i
] = 
geßÍhab‘
[
idx
];

732 
buf
[11] = '\0';

733 
	`addR•lyBulkCBufãr
(
c
,
buf
,11);

736 
	}
}

742 
	$geİosCommªd
(
ş›Á
 *
c
) {

743 
j
;

746 
robj
 *
zobj
 = 
NULL
;

747 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
, c->
¬gv
[1], 
sh¬ed
.
em±ymuÉibulk
))

748 =ğ
NULL
 || 
	`checkTy³
(
c
, 
zobj
, 
OBJ_ZSET
)) ;

752 
	`addR•lyMuÉiBulkL’
(
c
,c->
¬gc
-2);

753 
j
 = 2; j < 
c
->
¬gc
; j++) {

754 
scÜe
;

755 ià(
	`z£tScÜe
(
zobj
, 
c
->
¬gv
[
j
], &
scÜe
è=ğ
C_ERR
) {

756 
	`addR•ly
(
c
,
sh¬ed
.
nuÎmuÉibulk
);

759 
xy
[2];

760 ià(!
	`decodeGeohash
(
scÜe
,
xy
)) {

761 
	`addR•ly
(
c
,
sh¬ed
.
nuÎmuÉibulk
);

764 
	`addR•lyMuÉiBulkL’
(
c
,2);

765 
	`addR•lyHumªLÚgDoubË
(
c
,
xy
[0]);

766 
	`addR•lyHumªLÚgDoubË
(
c
,
xy
[1]);

769 
	}
}

776 
	$geodi¡Commªd
(
ş›Á
 *
c
) {

777 
to_m‘”
 = 1;

780 ià(
c
->
¬gc
 == 5) {

781 
to_m‘”
 = 
	`exŒaùUn™OrR•ly
(
c
,c->
¬gv
[4]);

782 ià(
to_m‘”
 < 0) ;

783 } ià(
c
->
¬gc
 > 5) {

784 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

789 
robj
 *
zobj
 = 
NULL
;

790 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
, c->
¬gv
[1], 
sh¬ed
.
em±ybulk
))

791 =ğ
NULL
 || 
	`checkTy³
(
c
, 
zobj
, 
OBJ_ZSET
)) ;

794 
scÜe1
, 
scÜe2
, 
xyxy
[4];

795 ià(
	`z£tScÜe
(
zobj
, 
c
->
¬gv
[2], &
scÜe1
è=ğ
C_ERR
 ||

796 
	`z£tScÜe
(
zobj
, 
c
->
¬gv
[3], &
scÜe2
è=ğ
C_ERR
)

798 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

803 ià(!
	`decodeGeohash
(
scÜe1
,
xyxy
è|| !decodeGeohash(
scÜe2
,xyxy+2))

804 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

806 
	`addR•lyDoubËDi¡ªû
(
c
,

807 
	`geohashG‘Di¡ªû
(
xyxy
[0],xyxy[1],xyxy[2],xyxy[3]è/ 
to_m‘”
);

808 
	}
}

	@src/geo.h

1 #iâdeà
__GEO_H__


2 
	#__GEO_H__


	)

4 
	~"£rv”.h
"

8 
	sgeoPošt
 {

9 
	mlÚg™ude
;

10 
	mÏt™ude
;

11 
	mdi¡
;

12 
	mscÜe
;

13 *
	mmemb”
;

14 } 
	tgeoPošt
;

16 
	sgeoA¼ay
 {

17 
geoPošt
 *
	m¬¿y
;

18 
size_t
 
	mbuck‘s
;

19 
size_t
 
	mu£d
;

20 } 
	tgeoA¼ay
;

	@src/help.h

3 #iâdeà
__REDIS_HELP_H


4 
	#__REDIS_HELP_H


	)

6 *
	gcommªdGroups
[] = {

23 
	scommªdH–p
 {

24 *
	mÇme
;

25 *
	m·¿ms
;

26 *
	msumm¬y
;

27 
	mgroup
;

28 *
	msšû
;

29 } 
	gcommªdH–p
[] = {

	@src/hyperloglog.c

32 
	~"£rv”.h
"

34 
	~<¡dšt.h
>

35 
	~<m©h.h
>

182 
	shÎhdr
 {

183 
	mmagic
[4];

184 
ušt8_t
 
	m’codšg
;

185 
ušt8_t
 
	mnÙu£d
[3];

186 
ušt8_t
 
	mÿrd
[8];

187 
ušt8_t
 
	m»gi¡”s
[];

191 
	#HLL_INVALIDATE_CACHE
(
hdr
è(hdr)->
ÿrd
[7] |ğ(1<<7)

	)

192 
	#HLL_VALID_CACHE
(
hdr
è(((hdr)->
ÿrd
[7] & (1<<7)è=ğ0)

	)

194 
	#HLL_P
 14

	)

195 
	#HLL_REGISTERS
 (1<<
HLL_P
è

	)

196 
	#HLL_P_MASK
 (
HLL_REGISTERS
-1è

	)

197 
	#HLL_BITS
 6

	)

198 
	#HLL_REGISTER_MAX
 ((1<<
HLL_BITS
)-1)

	)

199 
	#HLL_HDR_SIZE
 (
hÎhdr
)

	)

200 
	#HLL_DENSE_SIZE
 (
HLL_HDR_SIZE
+((
HLL_REGISTERS
*
HLL_BITS
+7)/8))

	)

201 
	#HLL_DENSE
 0

	)

202 
	#HLL_SPARSE
 1

	)

203 
	#HLL_RAW
 255

	)

204 
	#HLL_MAX_ENCODING
 1

	)

206 *
	gšv®id_hÎ_”r
 = "-INVALIDOBJ Corrupted HLL object detected\r\n";

337 
	#HLL_DENSE_GET_REGISTER
(
rg‘
,
p
,
»gnum
) do { \

338 
ušt8_t
 *
_p
 = (ušt8_t*è
p
; \

339 
_by‹
 = 
»gnum
*
HLL_BITS
/8; \

340 
_fb
 = 
»gnum
*
HLL_BITS
&7; \

341 
_fb8
 = 8 - 
_fb
; \

342 
b0
 = 
_p
[
_by‹
]; \

343 
b1
 = 
_p
[
_by‹
+1]; \

344 
rg‘
 = ((
b0
 >> 
_fb
è| (
b1
 << 
_fb8
)è& 
HLL_REGISTER_MAX
; \

345 } 0)

	)

349 
	#HLL_DENSE_SET_REGISTER
(
p
,
»gnum
,
v®
) do { \

350 
ušt8_t
 *
_p
 = (ušt8_t*è
p
; \

351 
_by‹
 = 
»gnum
*
HLL_BITS
/8; \

352 
_fb
 = 
»gnum
*
HLL_BITS
&7; \

353 
_fb8
 = 8 - 
_fb
; \

354 
_v
 = 
v®
; \

355 
_p
[
_by‹
] &ğ~(
HLL_REGISTER_MAX
 << 
_fb
); \

356 
_p
[
_by‹
] |ğ
_v
 << 
_fb
; \

357 
_p
[
_by‹
+1] &ğ~(
HLL_REGISTER_MAX
 >> 
_fb8
); \

358 
_p
[
_by‹
+1] |ğ
_v
 >> 
_fb8
; \

359 } 0)

	)

363 
	#HLL_SPARSE_XZERO_BIT
 0x40

	)

364 
	#HLL_SPARSE_VAL_BIT
 0x80

	)

365 
	#HLL_SPARSE_IS_ZERO
(
p
è(((*Õ)è& 0xc0è=ğ0è

	)

366 
	#HLL_SPARSE_IS_XZERO
(
p
è(((*Õ)è& 0xc0è=ğ
HLL_SPARSE_XZERO_BIT
)

	)

367 
	#HLL_SPARSE_IS_VAL
(
p
è((*Õ)è& 
HLL_SPARSE_VAL_BIT
)

	)

368 
	#HLL_SPARSE_ZERO_LEN
(
p
è(((*Õ)è& 0x3f)+1)

	)

369 
	#HLL_SPARSE_XZERO_LEN
(
p
è(((((*Õ)è& 0x3fè<< 8è| (*(Õ)+1)))+1)

	)

370 
	#HLL_SPARSE_VAL_VALUE
(
p
è((((*Õ)è>> 2è& 0x1f)+1)

	)

371 
	#HLL_SPARSE_VAL_LEN
(
p
è(((*Õ)è& 0x3)+1)

	)

372 
	#HLL_SPARSE_VAL_MAX_VALUE
 32

	)

373 
	#HLL_SPARSE_VAL_MAX_LEN
 4

	)

374 
	#HLL_SPARSE_ZERO_MAX_LEN
 64

	)

375 
	#HLL_SPARSE_XZERO_MAX_LEN
 16384

	)

376 
	#HLL_SPARSE_VAL_SET
(
p
,
v®
,
Ën
) do { \

377 *(
p
èğ(((
v®
)-1)<<2|((
Ën
)-1))|
HLL_SPARSE_VAL_BIT
; \

378 } 0)

	)

379 
	#HLL_SPARSE_ZERO_SET
(
p
,
Ën
) do { \

380 *(
p
èğ(
Ën
)-1; \

381 } 0)

	)

382 
	#HLL_SPARSE_XZERO_SET
(
p
,
Ën
) do { \

383 
_l
 = (
Ën
)-1; \

384 *(
p
èğ(
_l
>>8è| 
HLL_SPARSE_XZERO_BIT
; \

385 *((
p
)+1èğ(
_l
&0xff); \

386 } 0)

	)

393 
ušt64_t
 
	$MurmurHash64A
 (cÚ¡ * 
key
, 
Ën
, 
£ed
) {

394 cÚ¡ 
ušt64_t
 
m
 = 0xc6a4a7935bd1e995;

395 cÚ¡ 
r
 = 47;

396 
ušt64_t
 
h
 = 
£ed
 ^ (
Ën
 * 
m
);

397 cÚ¡ 
ušt8_t
 *
d©a
 = (cÚ¡ ušt8_ˆ*)
key
;

398 cÚ¡ 
ušt8_t
 *
’d
 = 
d©a
 + (
Ën
-(len&7));

400 
d©a
 !ğ
’d
) {

401 
ušt64_t
 
k
;

403 #ià(
BYTE_ORDER
 =ğ
LITTLE_ENDIAN
)

404 
k
 = *((
ušt64_t
*)
d©a
);

406 
k
 = (
ušt64_t
è
d©a
[0];

407 
k
 |ğ(
ušt64_t
è
d©a
[1] << 8;

408 
k
 |ğ(
ušt64_t
è
d©a
[2] << 16;

409 
k
 |ğ(
ušt64_t
è
d©a
[3] << 24;

410 
k
 |ğ(
ušt64_t
è
d©a
[4] << 32;

411 
k
 |ğ(
ušt64_t
è
d©a
[5] << 40;

412 
k
 |ğ(
ušt64_t
è
d©a
[6] << 48;

413 
k
 |ğ(
ušt64_t
è
d©a
[7] << 56;

416 
k
 *ğ
m
;

417 
k
 ^ğk >> 
r
;

418 
k
 *ğ
m
;

419 
h
 ^ğ
k
;

420 
h
 *ğ
m
;

421 
d©a
 += 8;

424 
Ën
 & 7) {

425 7: 
h
 ^ğ(
ušt64_t
)
d©a
[6] << 48;

426 6: 
h
 ^ğ(
ušt64_t
)
d©a
[5] << 40;

427 5: 
h
 ^ğ(
ušt64_t
)
d©a
[4] << 32;

428 4: 
h
 ^ğ(
ušt64_t
)
d©a
[3] << 24;

429 3: 
h
 ^ğ(
ušt64_t
)
d©a
[2] << 16;

430 2: 
h
 ^ğ(
ušt64_t
)
d©a
[1] << 8;

431 1: 
h
 ^ğ(
ušt64_t
)
d©a
[0];

432 
h
 *ğ
m
;

435 
h
 ^ğh >> 
r
;

436 
h
 *ğ
m
;

437 
h
 ^ğh >> 
r
;

438  
h
;

439 
	}
}

444 
	$hÎP©L’
(*
–e
, 
size_t
 
–esize
, *
»gp
) {

445 
ušt64_t
 
hash
, 
b™
, 
šdex
;

446 
couÁ
;

459 
hash
 = 
	`MurmurHash64A
(
–e
,
–esize
,0xadc83b19ULL);

460 
šdex
 = 
hash
 & 
HLL_P_MASK
;

461 
hash
 |ğ((
ušt64_t
)1<<63);

462 
b™
 = 
HLL_REGISTERS
;

463 
couÁ
 = 1;

464 (
hash
 & 
b™
) == 0) {

465 
couÁ
++;

466 
b™
 <<= 1;

468 *
»gp
 = (è
šdex
;

469  
couÁ
;

470 
	}
}

485 
	$hÎD’£Add
(
ušt8_t
 *
»gi¡”s
, *
–e
, 
size_t
 
–esize
) {

486 
ušt8_t
 
ŞdcouÁ
, 
couÁ
;

487 
šdex
;

490 
couÁ
 = 
	`hÎP©L’
(
–e
,
–esize
,&
šdex
);

491 
	`HLL_DENSE_GET_REGISTER
(
ŞdcouÁ
,
»gi¡”s
,
šdex
);

492 ià(
couÁ
 > 
ŞdcouÁ
) {

493 
	`HLL_DENSE_SET_REGISTER
(
»gi¡”s
,
šdex
,
couÁ
);

498 
	}
}

504 
	$hÎD’£Sum
(
ušt8_t
 *
»gi¡”s
, *
PE
, *
ezp
) {

505 
E
 = 0;

506 
j
, 
ez
 = 0;

511 ià(
HLL_REGISTERS
 =ğ16384 && 
HLL_BITS
 == 6) {

512 
ušt8_t
 *
r
 = 
»gi¡”s
;

513 
r0
, 
r1
, 
r2
, 
r3
, 
r4
, 
r5
, 
r6
, 
r7
, 
r8
, 
r9
,

514 
r10
, 
r11
, 
r12
, 
r13
, 
r14
, 
r15
;

515 
j
 = 0; j < 1024; j++) {

517 
r0
 = 
r
[0] & 63; iàÔ0 =ğ0è
ez
++;

518 
r1
 = (
r
[0] >> 6 |„[1] << 2è& 63; iàÔ1 =ğ0è
ez
++;

519 
r2
 = (
r
[1] >> 4 |„[2] << 4è& 63; iàÔ2 =ğ0è
ez
++;

520 
r3
 = (
r
[2] >> 2è& 63; iàÔ3 =ğ0è
ez
++;

521 
r4
 = 
r
[3] & 63; iàÔ4 =ğ0è
ez
++;

522 
r5
 = (
r
[3] >> 6 |„[4] << 2è& 63; iàÔ5 =ğ0è
ez
++;

523 
r6
 = (
r
[4] >> 4 |„[5] << 4è& 63; iàÔ6 =ğ0è
ez
++;

524 
r7
 = (
r
[5] >> 2è& 63; iàÔ7 =ğ0è
ez
++;

525 
r8
 = 
r
[6] & 63; iàÔ8 =ğ0è
ez
++;

526 
r9
 = (
r
[6] >> 6 |„[7] << 2è& 63; iàÔ9 =ğ0è
ez
++;

527 
r10
 = (
r
[7] >> 4 |„[8] << 4è& 63; iàÔ10 =ğ0è
ez
++;

528 
r11
 = (
r
[8] >> 2è& 63; iàÔ11 =ğ0è
ez
++;

529 
r12
 = 
r
[9] & 63; iàÔ12 =ğ0è
ez
++;

530 
r13
 = (
r
[9] >> 6 |„[10] << 2è& 63; iàÔ13 =ğ0è
ez
++;

531 
r14
 = (
r
[10] >> 4 |„[11] << 4è& 63; iàÔ14 =ğ0è
ez
++;

532 
r15
 = (
r
[11] >> 2è& 63; iàÔ15 =ğ0è
ez
++;

537 
E
 +ğ(
PE
[
r0
] + PE[
r1
]è+ (PE[
r2
] + PE[
r3
]è+ (PE[
r4
] + PE[
r5
]) +

538 (
PE
[
r6
] + PE[
r7
]è+ (PE[
r8
] + PE[
r9
]è+ (PE[
r10
] + PE[
r11
]) +

539 (
PE
[
r12
] + PE[
r13
]è+ (PE[
r14
] + PE[
r15
]);

540 
r
 += 12;

543 
j
 = 0; j < 
HLL_REGISTERS
; j++) {

544 
»g
;

546 
	`HLL_DENSE_GET_REGISTER
(
»g
,
»gi¡”s
,
j
);

547 ià(
»g
 == 0) {

548 
ez
++;

551 
E
 +ğ
PE
[
»g
];

554 
E
 +ğ
ez
;

556 *
ezp
 = 
ez
;

557  
E
;

558 
	}
}

568 
	$hÎS·r£ToD’£
(
robj
 *
o
) {

569 
sds
 
¥¬£
 = 
o
->
±r
, 
d’£
;

570 
hÎhdr
 *
hdr
, *
Şdhdr
 = (hÎhdr*)
¥¬£
;

571 
idx
 = 0, 
ruÆ’
, 
»gv®
;

572 
ušt8_t
 *
p
 = (ušt8_t*)
¥¬£
, *
’d
 =…+
	`sd¦’
(sparse);

575 
hdr
 = (
hÎhdr
*è
¥¬£
;

576 ià(
hdr
->
’codšg
 =ğ
HLL_DENSE
è 
C_OK
;

581 
d’£
 = 
	`sd¢ewËn
(
NULL
,
HLL_DENSE_SIZE
);

582 
hdr
 = (
hÎhdr
*è
d’£
;

583 *
hdr
 = *
Şdhdr
;

584 
hdr
->
’codšg
 = 
HLL_DENSE
;

588 
p
 +ğ
HLL_HDR_SIZE
;

589 
p
 < 
’d
) {

590 ià(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

591 
ruÆ’
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

592 
idx
 +ğ
ruÆ’
;

593 
p
++;

594 } ià(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

595 
ruÆ’
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

596 
idx
 +ğ
ruÆ’
;

597 
p
 += 2;

599 
ruÆ’
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

600 
»gv®
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

601 
ruÆ’
--) {

602 
	`HLL_DENSE_SET_REGISTER
(
hdr
->
»gi¡”s
,
idx
,
»gv®
);

603 
idx
++;

605 
p
++;

611 ià(
idx
 !ğ
HLL_REGISTERS
) {

612 
	`sdsä“
(
d’£
);

613  
C_ERR
;

617 
	`sdsä“
(
o
->
±r
);

618 
o
->
±r
 = 
d’£
;

619  
C_OK
;

620 
	}
}

638 
	$hÎS·r£Add
(
robj
 *
o
, *
–e
, 
size_t
 
–esize
) {

639 
hÎhdr
 *
hdr
;

640 
ušt8_t
 
ŞdcouÁ
, 
couÁ
, *
¥¬£
, *
’d
, *
p
, *
´ev
, *
Ãxt
;

641 
šdex
, 
fœ¡
, 
¥ª
;

642 
is_z”o
 = 0, 
is_xz”o
 = 0, 
is_v®
 = 0, 
ruÆ’
 = 0;

645 
couÁ
 = 
	`hÎP©L’
(
–e
,
–esize
,&
šdex
);

649 ià(
couÁ
 > 
HLL_SPARSE_VAL_MAX_VALUE
è
´omÙe
;

656 
o
->
±r
 = 
	`sdsMakeRoomFÜ
(o->ptr,3);

660 
¥¬£
 = 
p
 = ((
ušt8_t
*)
o
->
±r
è+ 
HLL_HDR_SIZE
;

661 
’d
 = 
p
 + 
	`sd¦’
(
o
->
±r
è- 
HLL_HDR_SIZE
;

663 
fœ¡
 = 0;

664 
´ev
 = 
NULL
;

665 
Ãxt
 = 
NULL
;

666 
¥ª
 = 0;

667 
p
 < 
’d
) {

668 
İËn
;

675 
İËn
 = 1;

676 ià(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

677 
¥ª
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

678 } ià(
	`HLL_SPARSE_IS_VAL
(
p
)) {

679 
¥ª
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

681 
¥ª
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

682 
İËn
 = 2;

685 ià(
šdex
 <ğ
fœ¡
+
¥ª
-1) ;

686 
´ev
 = 
p
;

687 
p
 +ğ
İËn
;

688 
fœ¡
 +ğ
¥ª
;

690 ià(
¥ª
 == 0)  -1;

692 
Ãxt
 = 
	`HLL_SPARSE_IS_XZERO
(
p
) ?…+2 :…+1;

693 ià(
Ãxt
 >ğ
’d
èÃxˆğ
NULL
;

698 ià(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

699 
is_z”o
 = 1;

700 
ruÆ’
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

701 } ià(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

702 
is_xz”o
 = 1;

703 
ruÆ’
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

705 
is_v®
 = 1;

706 
ruÆ’
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

730 ià(
is_v®
) {

731 
ŞdcouÁ
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

733 ià(
ŞdcouÁ
 >ğ
couÁ
)  0;

736 ià(
ruÆ’
 == 1) {

737 
	`HLL_SPARSE_VAL_SET
(
p
,
couÁ
,1);

738 
upd©ed
;

744 ià(
is_z”o
 && 
ruÆ’
 == 1) {

745 
	`HLL_SPARSE_VAL_SET
(
p
,
couÁ
,1);

746 
upd©ed
;

764 
ušt8_t
 
£q
[5], *
n
 = seq;

765 
Ï¡
 = 
fœ¡
+
¥ª
-1;

766 
Ën
;

768 ià(
is_z”o
 || 
is_xz”o
) {

770 ià(
šdex
 !ğ
fœ¡
) {

771 
Ën
 = 
šdex
-
fœ¡
;

772 ià(
Ën
 > 
HLL_SPARSE_ZERO_MAX_LEN
) {

773 
	`HLL_SPARSE_XZERO_SET
(
n
,
Ën
);

774 
n
 += 2;

776 
	`HLL_SPARSE_ZERO_SET
(
n
,
Ën
);

777 
n
++;

780 
	`HLL_SPARSE_VAL_SET
(
n
,
couÁ
,1);

781 
n
++;

782 ià(
šdex
 !ğ
Ï¡
) {

783 
Ën
 = 
Ï¡
-
šdex
;

784 ià(
Ën
 > 
HLL_SPARSE_ZERO_MAX_LEN
) {

785 
	`HLL_SPARSE_XZERO_SET
(
n
,
Ën
);

786 
n
 += 2;

788 
	`HLL_SPARSE_ZERO_SET
(
n
,
Ën
);

789 
n
++;

794 
curv®
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

796 ià(
šdex
 !ğ
fœ¡
) {

797 
Ën
 = 
šdex
-
fœ¡
;

798 
	`HLL_SPARSE_VAL_SET
(
n
,
curv®
,
Ën
);

799 
n
++;

801 
	`HLL_SPARSE_VAL_SET
(
n
,
couÁ
,1);

802 
n
++;

803 ià(
šdex
 !ğ
Ï¡
) {

804 
Ën
 = 
Ï¡
-
šdex
;

805 
	`HLL_SPARSE_VAL_SET
(
n
,
curv®
,
Ën
);

806 
n
++;

814 
£qËn
 = 
n
-
£q
;

815 
ŞdËn
 = 
is_xz”o
 ? 2 : 1;

816 
d–Ën
 = 
£qËn
-
ŞdËn
;

818 ià(
d–Ën
 > 0 &&

819 
	`sd¦’
(
o
->
±r
)+
d–Ën
 > 
£rv”
.
hÎ_¥¬£_max_by‹s
è
´omÙe
;

820 ià(
d–Ën
 && 
Ãxt
è
	`memmove
Òext+d–Ën,Ãxt,
’d
-next);

821 
	`sdsInüL’
(
o
->
±r
,
d–Ën
);

822 
	`memıy
(
p
,
£q
,
£qËn
);

823 
’d
 +ğ
d–Ën
;

825 
upd©ed
:

831 
p
 = 
´ev
 ?…»v : 
¥¬£
;

832 
sÿÆ’
 = 5;

833 
p
 < 
’d
 && 
sÿÆ’
--) {

834 ià(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

835 
p
 += 2;

837 } ià(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

838 
p
++;

843 ià(
p
+1 < 
’d
 && 
	`HLL_SPARSE_IS_VAL
(p+1)) {

844 
v1
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

845 
v2
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
+1);

846 ià(
v1
 =ğ
v2
) {

847 
Ën
 = 
	`HLL_SPARSE_VAL_LEN
(
p
)+HLL_SPARSE_VAL_LEN(p+1);

848 ià(
Ën
 <ğ
HLL_SPARSE_VAL_MAX_LEN
) {

849 
	`HLL_SPARSE_VAL_SET
(
p
+1,
v1
,
Ën
);

850 
	`memmove
(
p
,p+1,
’d
-p);

851 
	`sdsInüL’
(
o
->
±r
,-1);

852 
’d
--;

860 
p
++;

864 
hdr
 = 
o
->
±r
;

865 
	`HLL_INVALIDATE_CACHE
(
hdr
);

868 
´omÙe
:

869 ià(
	`hÎS·r£ToD’£
(
o
è=ğ
C_ERR
)  -1;

870 
hdr
 = 
o
->
±r
;

879 
d’£_»tv®
 = 
	`hÎD’£Add
(
hdr
->
»gi¡”s
, 
–e
, 
–esize
);

880 
	`£rv”As£¹
(
d’£_»tv®
 == 1);

881  
d’£_»tv®
;

882 
	}
}

888 
	$hÎS·r£Sum
(
ušt8_t
 *
¥¬£
, 
¥¬£Ën
, *
PE
, *
ezp
, *
šv®id
) {

889 
E
 = 0;

890 
ez
 = 0, 
idx
 = 0, 
ruÆ’
, 
»gv®
;

891 
ušt8_t
 *
’d
 = 
¥¬£
+
¥¬£Ën
, *
p
 = sparse;

893 
p
 < 
’d
) {

894 ià(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

895 
ruÆ’
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

896 
idx
 +ğ
ruÆ’
;

897 
ez
 +ğ
ruÆ’
;

899 
p
++;

900 } ià(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

901 
ruÆ’
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

902 
idx
 +ğ
ruÆ’
;

903 
ez
 +ğ
ruÆ’
;

905 
p
 += 2;

907 
ruÆ’
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

908 
»gv®
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

909 
idx
 +ğ
ruÆ’
;

910 
E
 +ğ
PE
[
»gv®
]*
ruÆ’
;

911 
p
++;

914 ià(
idx
 !ğ
HLL_REGISTERS
 && 
šv®id
) *invalid = 1;

915 
E
 +ğ
ez
;

916 *
ezp
 = 
ez
;

917  
E
;

918 
	}
}

928 
	$hÎRawSum
(
ušt8_t
 *
»gi¡”s
, *
PE
, *
ezp
) {

929 
E
 = 0;

930 
j
, 
ez
 = 0;

931 
ušt64_t
 *
wÜd
 = (ušt64_t*è
»gi¡”s
;

932 
ušt8_t
 *
by‹s
;

934 
j
 = 0; j < 
HLL_REGISTERS
/8; j++) {

935 ià(*
wÜd
 == 0) {

936 
ez
 += 8;

938 
by‹s
 = (
ušt8_t
*è
wÜd
;

939 ià(
by‹s
[0]è
E
 +ğ
PE
[by‹s[0]]; 
ez
++;

940 ià(
by‹s
[1]è
E
 +ğ
PE
[by‹s[1]]; 
ez
++;

941 ià(
by‹s
[2]è
E
 +ğ
PE
[by‹s[2]]; 
ez
++;

942 ià(
by‹s
[3]è
E
 +ğ
PE
[by‹s[3]]; 
ez
++;

943 ià(
by‹s
[4]è
E
 +ğ
PE
[by‹s[4]]; 
ez
++;

944 ià(
by‹s
[5]è
E
 +ğ
PE
[by‹s[5]]; 
ez
++;

945 ià(
by‹s
[6]è
E
 +ğ
PE
[by‹s[6]]; 
ez
++;

946 ià(
by‹s
[7]è
E
 +ğ
PE
[by‹s[7]]; 
ez
++;

948 
wÜd
++;

950 
E
 +ğ
ez
;

952 *
ezp
 = 
ez
;

953  
E
;

954 
	}
}

967 
ušt64_t
 
	$hÎCouÁ
(
hÎhdr
 *
hdr
, *
šv®id
) {

968 
m
 = 
HLL_REGISTERS
;

969 
E
, 
®pha
 = 0.7213/(1+1.079/
m
);

970 
j
, 
ez
;

974 
š™Ÿlized
 = 0;

975 
PE
[64];

976 ià(!
š™Ÿlized
) {

977 
PE
[0] = 1;

978 
j
 = 1; j < 64; j++) {

980 
PE
[
j
] = 1.0/(1ULL << j);

982 
š™Ÿlized
 = 1;

986 ià(
hdr
->
’codšg
 =ğ
HLL_DENSE
) {

987 
E
 = 
	`hÎD’£Sum
(
hdr
->
»gi¡”s
,
PE
,&
ez
);

988 } ià(
hdr
->
’codšg
 =ğ
HLL_SPARSE
) {

989 
E
 = 
	`hÎS·r£Sum
(
hdr
->
»gi¡”s
,

990 
	`sd¦’
((
sds
)
hdr
)-
HLL_HDR_SIZE
,
PE
,&
ez
,
šv®id
);

991 } ià(
hdr
->
’codšg
 =ğ
HLL_RAW
) {

992 
E
 = 
	`hÎRawSum
(
hdr
->
»gi¡”s
,
PE
,&
ez
);

994 
	`£rv”Pªic
("Unknown HyperLogLogƒncoding in hllCount()");

998 
E
 = (1/E)*
®pha
*
m
*m;

1005 ià(
E
 < 
m
*2.5 && 
ez
 != 0) {

1006 
E
 = 
m
*
	`log
(m/
ez
);

1007 } ià(
m
 =ğ16384 && 
E
 < 72000) {

1012 
bŸs
 = 5.9119*1.0e-18*(
E
*E*E*E)

1013 -1.4253*1.0e-12*(
E
*E*E)+

1014 1.2940*1.0e-7*(
E
*E)

1015 -5.2921*1.0e-3*
E
+

1017 
E
 -ğE*(
bŸs
/100);

1023  (
ušt64_t
è
E
;

1024 
	}
}

1027 
	$hÎAdd
(
robj
 *
o
, *
–e
, 
size_t
 
–esize
) {

1028 
hÎhdr
 *
hdr
 = 
o
->
±r
;

1029 
hdr
->
’codšg
) {

1030 
HLL_DENSE
:  
	`hÎD’£Add
(
hdr
->
»gi¡”s
,
–e
,
–esize
);

1031 
HLL_SPARSE
:  
	`hÎS·r£Add
(
o
,
–e
,
–esize
);

1034 
	}
}

1044 
	$hÎM”ge
(
ušt8_t
 *
max
, 
robj
 *
hÎ
) {

1045 
hÎhdr
 *
hdr
 = 
hÎ
->
±r
;

1046 
i
;

1048 ià(
hdr
->
’codšg
 =ğ
HLL_DENSE
) {

1049 
ušt8_t
 
v®
;

1051 
i
 = 0; i < 
HLL_REGISTERS
; i++) {

1052 
	`HLL_DENSE_GET_REGISTER
(
v®
,
hdr
->
»gi¡”s
,
i
);

1053 ià(
v®
 > 
max
[
i
]) max[i] = val;

1056 
ušt8_t
 *
p
 = 
hÎ
->
±r
, *
’d
 =… + 
	`sd¦’
(hll->ptr);

1057 
ruÆ’
, 
»gv®
;

1059 
p
 +ğ
HLL_HDR_SIZE
;

1060 
i
 = 0;

1061 
p
 < 
’d
) {

1062 ià(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

1063 
ruÆ’
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

1064 
i
 +ğ
ruÆ’
;

1065 
p
++;

1066 } ià(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

1067 
ruÆ’
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

1068 
i
 +ğ
ruÆ’
;

1069 
p
 += 2;

1071 
ruÆ’
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

1072 
»gv®
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

1073 
ruÆ’
--) {

1074 ià(
»gv®
 > 
max
[
i
]) max[i] =„egval;

1075 
i
++;

1077 
p
++;

1080 ià(
i
 !ğ
HLL_REGISTERS
è 
C_ERR
;

1082  
C_OK
;

1083 
	}
}

1089 
robj
 *
	$ü—‹HLLObjeù
() {

1090 
robj
 *
o
;

1091 
hÎhdr
 *
hdr
;

1092 
sds
 
s
;

1093 
ušt8_t
 *
p
;

1094 
¥¬£Ën
 = 
HLL_HDR_SIZE
 +

1095 (((
HLL_REGISTERS
+(
HLL_SPARSE_XZERO_MAX_LEN
-1)) /

1096 
HLL_SPARSE_XZERO_MAX_LEN
)*2);

1097 
aux
;

1101 
aux
 = 
HLL_REGISTERS
;

1102 
s
 = 
	`sd¢ewËn
(
NULL
,
¥¬£Ën
);

1103 
p
 = (
ušt8_t
*)
s
 + 
HLL_HDR_SIZE
;

1104 
aux
) {

1105 
xz”o
 = 
HLL_SPARSE_XZERO_MAX_LEN
;

1106 ià(
xz”o
 > 
aux
) xzero =‡ux;

1107 
	`HLL_SPARSE_XZERO_SET
(
p
,
xz”o
);

1108 
p
 += 2;

1109 
aux
 -ğ
xz”o
;

1111 
	`£rv”As£¹
((
p
-(
ušt8_t
*)
s
è=ğ
¥¬£Ën
);

1114 
o
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
s
);

1115 
hdr
 = 
o
->
±r
;

1116 
	`memıy
(
hdr
->
magic
,"HYLL",4);

1117 
hdr
->
’codšg
 = 
HLL_SPARSE
;

1118  
o
;

1119 
	}
}

1124 
	$isHLLObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
) {

1125 
hÎhdr
 *
hdr
;

1128 ià(
	`checkTy³
(
c
,
o
,
OBJ_STRING
))

1129  
C_ERR
;

1131 ià(
	`¡ršgObjeùL’
(
o
è< (*
hdr
)è
šv®id
;

1132 
hdr
 = 
o
->
±r
;

1135 ià(
hdr
->
magic
[0] != 'H' || hdr->magic[1] != 'Y' ||

1136 
hdr
->
magic
[2] !ğ'L' || hdr->magic[3] !ğ'L'è
šv®id
;

1138 ià(
hdr
->
’codšg
 > 
HLL_MAX_ENCODING
è
šv®id
;

1141 ià(
hdr
->
’codšg
 =ğ
HLL_DENSE
 &&

1142 
	`¡ršgObjeùL’
(
o
è!ğ
HLL_DENSE_SIZE
è
šv®id
;

1145  
C_OK
;

1147 
šv®id
:

1148 
	`addR•lySds
(
c
,

1149 
	`sd¢ew
("-WRONGTYPE Key is‚ot‡ valid "

1151  
C_ERR
;

1152 
	}
}

1155 
	$pçddCommªd
(
ş›Á
 *
c
) {

1156 
robj
 *
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

1157 
hÎhdr
 *
hdr
;

1158 
upd©ed
 = 0, 
j
;

1160 ià(
o
 =ğ
NULL
) {

1164 
o
 = 
	`ü—‹HLLObjeù
();

1165 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],
o
);

1166 
upd©ed
++;

1168 ià(
	`isHLLObjeùOrR•ly
(
c
,
o
è!ğ
C_OK
) ;

1169 
o
 = 
	`dbUnsh¬eSŒšgV®ue
(
c
->
db
,c->
¬gv
[1],o);

1172 
j
 = 2; j < 
c
->
¬gc
; j++) {

1173 
»tv®
 = 
	`hÎAdd
(
o
, (*)
c
->
¬gv
[
j
]->
±r
,

1174 
	`sd¦’
(
c
->
¬gv
[
j
]->
±r
));

1175 
»tv®
) {

1177 
upd©ed
++;

1180 
	`addR•lySds
(
c
,
	`sd¢ew
(
šv®id_hÎ_”r
));

1184 
hdr
 = 
o
->
±r
;

1185 ià(
upd©ed
) {

1186 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

1187 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"pçdd",
c
->
¬gv
[1],c->
db
->
id
);

1188 
£rv”
.
dœty
++;

1189 
	`HLL_INVALIDATE_CACHE
(
hdr
);

1191 
	`addR•ly
(
c
, 
upd©ed
 ? 
sh¬ed
.
cÚe
 : sh¬ed.
cz”o
);

1192 
	}
}

1195 
	$pfcouÁCommªd
(
ş›Á
 *
c
) {

1196 
robj
 *
o
;

1197 
hÎhdr
 *
hdr
;

1198 
ušt64_t
 
ÿrd
;

1204 ià(
c
->
¬gc
 > 2) {

1205 
ušt8_t
 
max
[
HLL_HDR_SIZE
+
HLL_REGISTERS
], *
»gi¡”s
;

1206 
j
;

1209 
	`mem£t
(
max
,0,(max));

1210 
hdr
 = (
hÎhdr
*è
max
;

1211 
hdr
->
’codšg
 = 
HLL_RAW
;

1212 
»gi¡”s
 = 
max
 + 
HLL_HDR_SIZE
;

1213 
j
 = 1; j < 
c
->
¬gc
; j++) {

1215 
robj
 *
o
 = 
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[
j
]);

1216 ià(
o
 =ğ
NULL
) ;

1217 ià(
	`isHLLObjeùOrR•ly
(
c
,
o
è!ğ
C_OK
) ;

1221 ià(
	`hÎM”ge
(
»gi¡”s
,
o
è=ğ
C_ERR
) {

1222 
	`addR•lySds
(
c
,
	`sd¢ew
(
šv®id_hÎ_”r
));

1228 
	`addR•lyLÚgLÚg
(
c
,
	`hÎCouÁ
(
hdr
,
NULL
));

1236 
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

1237 ià(
o
 =ğ
NULL
) {

1240 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

1242 ià(
	`isHLLObjeùOrR•ly
(
c
,
o
è!ğ
C_OK
) ;

1243 
o
 = 
	`dbUnsh¬eSŒšgV®ue
(
c
->
db
,c->
¬gv
[1],o);

1246 
hdr
 = 
o
->
±r
;

1247 ià(
	`HLL_VALID_CACHE
(
hdr
)) {

1249 
ÿrd
 = (
ušt64_t
)
hdr
->card[0];

1250 
ÿrd
 |ğ(
ušt64_t
)
hdr
->card[1] << 8;

1251 
ÿrd
 |ğ(
ušt64_t
)
hdr
->card[2] << 16;

1252 
ÿrd
 |ğ(
ušt64_t
)
hdr
->card[3] << 24;

1253 
ÿrd
 |ğ(
ušt64_t
)
hdr
->card[4] << 32;

1254 
ÿrd
 |ğ(
ušt64_t
)
hdr
->card[5] << 40;

1255 
ÿrd
 |ğ(
ušt64_t
)
hdr
->card[6] << 48;

1256 
ÿrd
 |ğ(
ušt64_t
)
hdr
->card[7] << 56;

1258 
šv®id
 = 0;

1260 
ÿrd
 = 
	`hÎCouÁ
(
hdr
,&
šv®id
);

1261 ià(
šv®id
) {

1262 
	`addR•lySds
(
c
,
	`sd¢ew
(
šv®id_hÎ_”r
));

1265 
hdr
->
ÿrd
[0] = card & 0xff;

1266 
hdr
->
ÿrd
[1] = (card >> 8) & 0xff;

1267 
hdr
->
ÿrd
[2] = (card >> 16) & 0xff;

1268 
hdr
->
ÿrd
[3] = (card >> 24) & 0xff;

1269 
hdr
->
ÿrd
[4] = (card >> 32) & 0xff;

1270 
hdr
->
ÿrd
[5] = (card >> 40) & 0xff;

1271 
hdr
->
ÿrd
[6] = (card >> 48) & 0xff;

1272 
hdr
->
ÿrd
[7] = (card >> 56) & 0xff;

1277 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

1278 
£rv”
.
dœty
++;

1280 
	`addR•lyLÚgLÚg
(
c
,
ÿrd
);

1282 
	}
}

1285 
	$pfm”geCommªd
(
ş›Á
 *
c
) {

1286 
ušt8_t
 
max
[
HLL_REGISTERS
];

1287 
hÎhdr
 *
hdr
;

1288 
j
;

1293 
	`mem£t
(
max
,0,(max));

1294 
j
 = 1; j < 
c
->
¬gc
; j++) {

1296 
robj
 *
o
 = 
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[
j
]);

1297 ià(
o
 =ğ
NULL
) ;

1298 ià(
	`isHLLObjeùOrR•ly
(
c
,
o
è!ğ
C_OK
) ;

1302 ià(
	`hÎM”ge
(
max
,
o
è=ğ
C_ERR
) {

1303 
	`addR•lySds
(
c
,
	`sd¢ew
(
šv®id_hÎ_”r
));

1309 
robj
 *
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

1310 ià(
o
 =ğ
NULL
) {

1314 
o
 = 
	`ü—‹HLLObjeù
();

1315 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],
o
);

1320 
o
 = 
	`dbUnsh¬eSŒšgV®ue
(
c
->
db
,c->
¬gv
[1],o);

1324 ià(
	`hÎS·r£ToD’£
(
o
è=ğ
C_ERR
) {

1325 
	`addR•lySds
(
c
,
	`sd¢ew
(
šv®id_hÎ_”r
));

1331 
hdr
 = 
o
->
±r
;

1332 
j
 = 0; j < 
HLL_REGISTERS
; j++) {

1333 
	`HLL_DENSE_SET_REGISTER
(
hdr
->
»gi¡”s
,
j
,
max
[j]);

1335 
	`HLL_INVALIDATE_CACHE
(
hdr
);

1337 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

1340 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"pçdd",
c
->
¬gv
[1],c->
db
->
id
);

1341 
£rv”
.
dœty
++;

1342 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1343 
	}
}

1350 
	#HLL_TEST_CYCLES
 1000

	)

1351 
	$pf£láe¡Commªd
(
ş›Á
 *
c
) {

1352 
j
, 
i
;

1353 
sds
 
b™couÁ”s
 = 
	`sd¢ewËn
(
NULL
,
HLL_DENSE_SIZE
);

1354 
hÎhdr
 *
hdr
 = (hÎhdr*è
b™couÁ”s
, *
hdr2
;

1355 
robj
 *
o
 = 
NULL
;

1356 
ušt8_t
 
by‹couÁ”s
[
HLL_REGISTERS
];

1362 
j
 = 0; j < 
HLL_TEST_CYCLES
; j++) {

1365 
i
 = 0; i < 
HLL_REGISTERS
; i++) {

1366 
r
 = 
	`¿nd
(è& 
HLL_REGISTER_MAX
;

1368 
by‹couÁ”s
[
i
] = 
r
;

1369 
	`HLL_DENSE_SET_REGISTER
(
hdr
->
»gi¡”s
,
i
,
r
);

1372 
i
 = 0; i < 
HLL_REGISTERS
; i++) {

1373 
v®
;

1375 
	`HLL_DENSE_GET_REGISTER
(
v®
,
hdr
->
»gi¡”s
,
i
);

1376 ià(
v®
 !ğ
by‹couÁ”s
[
i
]) {

1377 
	`addR•lyE¼ÜFÜm©
(
c
,

1379 
i
, (è
by‹couÁ”s
[i], (è
v®
);

1380 
ş—nup
;

1395 
	`mem£t
(
hdr
->
»gi¡”s
,0,
HLL_DENSE_SIZE
-
HLL_HDR_SIZE
);

1396 
o
 = 
	`ü—‹HLLObjeù
();

1397 
»Ë¼
 = 1.04/
	`sq¹
(
HLL_REGISTERS
);

1398 
št64_t
 
checkpošt
 = 1;

1399 
ušt64_t
 
£ed
 = (ušt64_t)
	`¿nd
() | (uint64_t)rand() << 32;

1400 
ušt64_t
 
–e
;

1401 
j
 = 1; j <= 10000000; j++) {

1402 
–e
 = 
j
 ^ 
£ed
;

1403 
	`hÎD’£Add
(
hdr
->
»gi¡”s
,(*)&
–e
,(ele));

1404 
	`hÎAdd
(
o
,(*)&
–e
,(ele));

1408 ià(
j
 =ğ
checkpošt
 && j < 
£rv”
.
hÎ_¥¬£_max_by‹s
/2) {

1409 
hdr2
 = 
o
->
±r
;

1410 ià(
hdr2
->
’codšg
 !ğ
HLL_SPARSE
) {

1411 
	`addR•lyE¼Ü
(
c
, "TESTFAILED sparseƒncoding‚ot used");

1412 
ş—nup
;

1417 ià(
j
 =ğ
checkpošt
 && 
	`hÎCouÁ
(
hdr
,
NULL
è!ğhÎCouÁ(
o
->
±r
,NULL)) {

1418 
	`addR•lyE¼Ü
(
c
, "TESTFAILED dense/sparse disagree");

1419 
ş—nup
;

1423 ià(
j
 =ğ
checkpošt
) {

1424 
št64_t
 
ab£¼
 = 
checkpošt
 - (št64_t)
	`hÎCouÁ
(
hdr
,
NULL
);

1425 
ušt64_t
 
max”r
 = 
	`û
(
»Ë¼
*6*
checkpošt
);

1431 ià(
j
 =ğ10è
max”r
 = 1;

1433 ià(
ab£¼
 < 0)‡bserr = -abserr;

1434 ià(
ab£¼
 > (
št64_t
)
max”r
) {

1435 
	`addR•lyE¼ÜFÜm©
(
c
,

1437 (è
checkpošt
,

1438 (è
ab£¼
);

1439 
ş—nup
;

1441 
checkpošt
 *= 10;

1446 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1448 
ş—nup
:

1449 
	`sdsä“
(
b™couÁ”s
);

1450 ià(
o
è
	`deüRefCouÁ
(o);

1451 
	}
}

1455 
	$pfdebugCommªd
(
ş›Á
 *
c
) {

1456 *
cmd
 = 
c
->
¬gv
[1]->
±r
;

1457 
hÎhdr
 *
hdr
;

1458 
robj
 *
o
;

1459 
j
;

1461 
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[2]);

1462 ià(
o
 =ğ
NULL
) {

1463 
	`addR•lyE¼Ü
(
c
,"The specified key does‚otƒxist");

1466 ià(
	`isHLLObjeùOrR•ly
(
c
,
o
è!ğ
C_OK
) ;

1467 
o
 = 
	`dbUnsh¬eSŒšgV®ue
(
c
->
db
,c->
¬gv
[2],o);

1468 
hdr
 = 
o
->
±r
;

1471 ià(!
	`¡rÿ£cmp
(
cmd
,"getreg")) {

1472 ià(
c
->
¬gc
 !ğ3è
¬™y”r
;

1474 ià(
hdr
->
’codšg
 =ğ
HLL_SPARSE
) {

1475 ià(
	`hÎS·r£ToD’£
(
o
è=ğ
C_ERR
) {

1476 
	`addR•lySds
(
c
,
	`sd¢ew
(
šv®id_hÎ_”r
));

1479 
£rv”
.
dœty
++;

1482 
hdr
 = 
o
->
±r
;

1483 
	`addR•lyMuÉiBulkL’
(
c
,
HLL_REGISTERS
);

1484 
j
 = 0; j < 
HLL_REGISTERS
; j++) {

1485 
ušt8_t
 
v®
;

1487 
	`HLL_DENSE_GET_REGISTER
(
v®
,
hdr
->
»gi¡”s
,
j
);

1488 
	`addR•lyLÚgLÚg
(
c
,
v®
);

1492 ià(!
	`¡rÿ£cmp
(
cmd
,"decode")) {

1493 ià(
c
->
¬gc
 !ğ3è
¬™y”r
;

1495 
ušt8_t
 *
p
 = 
o
->
±r
, *
’d
 =…+
	`sd¦’
(o->ptr);

1496 
sds
 
decoded
 = 
	`sd£m±y
();

1498 ià(
hdr
->
’codšg
 !ğ
HLL_SPARSE
) {

1499 
	`addR•lyE¼Ü
(
c
,"HLLƒncoding is‚ot sparse");

1503 
p
 +ğ
HLL_HDR_SIZE
;

1504 
p
 < 
’d
) {

1505 
ruÆ’
, 
»gv®
;

1507 ià(
	`HLL_SPARSE_IS_ZERO
(
p
)) {

1508 
ruÆ’
 = 
	`HLL_SPARSE_ZERO_LEN
(
p
);

1509 
p
++;

1510 
decoded
 = 
	`sdsÿrštf
(decoded,"z:%d ",
ruÆ’
);

1511 } ià(
	`HLL_SPARSE_IS_XZERO
(
p
)) {

1512 
ruÆ’
 = 
	`HLL_SPARSE_XZERO_LEN
(
p
);

1513 
p
 += 2;

1514 
decoded
 = 
	`sdsÿrštf
(decoded,"Z:%d ",
ruÆ’
);

1516 
ruÆ’
 = 
	`HLL_SPARSE_VAL_LEN
(
p
);

1517 
»gv®
 = 
	`HLL_SPARSE_VAL_VALUE
(
p
);

1518 
p
++;

1519 
decoded
 = 
	`sdsÿrštf
(decoded,"v:%d,%d ",
»gv®
,
ruÆ’
);

1522 
decoded
 = 
	`sd¡rim
(decoded," ");

1523 
	`addR•lyBulkCBufãr
(
c
,
decoded
,
	`sd¦’
(decoded));

1524 
	`sdsä“
(
decoded
);

1527 ià(!
	`¡rÿ£cmp
(
cmd
,"encoding")) {

1528 *
’codšg¡r
[2] = {"dense","sparse"};

1529 ià(
c
->
¬gc
 !ğ3è
¬™y”r
;

1531 
	`addR•lyStus
(
c
,
’codšg¡r
[
hdr
->
’codšg
]);

1534 ià(!
	`¡rÿ£cmp
(
cmd
,"todense")) {

1535 
cÚv
 = 0;

1536 ià(
c
->
¬gc
 !ğ3è
¬™y”r
;

1538 ià(
hdr
->
’codšg
 =ğ
HLL_SPARSE
) {

1539 ià(
	`hÎS·r£ToD’£
(
o
è=ğ
C_ERR
) {

1540 
	`addR•lySds
(
c
,
	`sd¢ew
(
šv®id_hÎ_”r
));

1543 
cÚv
 = 1;

1544 
£rv”
.
dœty
++;

1546 
	`addR•ly
(
c
,
cÚv
 ? 
sh¬ed
.
cÚe
 : sh¬ed.
cz”o
);

1548 
	`addR•lyE¼ÜFÜm©
(
c
,"UnknowÀPFDEBUG subcommªd '%s'", 
cmd
);

1552 
¬™y”r
:

1553 
	`addR•lyE¼ÜFÜm©
(
c
,

1554 "WrÚg‚umb” oà¬gum’t fÜh'%s' subcommªd",
cmd
);

1555 
	}
}

	@src/intset.c

31 
	~<¡dio.h
>

32 
	~<¡dlib.h
>

33 
	~<¡ršg.h
>

34 
	~"št£t.h
"

35 
	~"zm®loc.h
"

36 
	~"’dŸncÚv.h
"

40 
	#INTSET_ENC_INT16
 ((
št16_t
))

	)

41 
	#INTSET_ENC_INT32
 ((
št32_t
))

	)

42 
	#INTSET_ENC_INT64
 ((
št64_t
))

	)

45 
ušt8_t
 
	$_št£tV®ueEncodšg
(
št64_t
 
v
) {

46 ià(
v
 < 
INT32_MIN
 || v > 
INT32_MAX
)

47  
INTSET_ENC_INT64
;

48 ià(
v
 < 
INT16_MIN
 || v > 
INT16_MAX
)

49  
INTSET_ENC_INT32
;

51  
INTSET_ENC_INT16
;

52 
	}
}

55 
št64_t
 
	$_št£tG‘Encoded
(
št£t
 *
is
, 
pos
, 
ušt8_t
 
’c
) {

56 
št64_t
 
v64
;

57 
št32_t
 
v32
;

58 
št16_t
 
v16
;

60 ià(
’c
 =ğ
INTSET_ENC_INT64
) {

61 
	`memıy
(&
v64
,((
št64_t
*)
is
->
cÚ‹Ás
)+
pos
,(v64));

62 
	`mem»v64ifbe
(&
v64
);

63  
v64
;

64 } ià(
’c
 =ğ
INTSET_ENC_INT32
) {

65 
	`memıy
(&
v32
,((
št32_t
*)
is
->
cÚ‹Ás
)+
pos
,(v32));

66 
	`mem»v32ifbe
(&
v32
);

67  
v32
;

69 
	`memıy
(&
v16
,((
št16_t
*)
is
->
cÚ‹Ás
)+
pos
,(v16));

70 
	`mem»v16ifbe
(&
v16
);

71  
v16
;

73 
	}
}

76 
št64_t
 
	$_št£tG‘
(
št£t
 *
is
, 
pos
) {

77  
	`_št£tG‘Encoded
(
is
,
pos
,
	`šŒev32ifbe
(is->
’codšg
));

78 
	}
}

81 
	$_št£tS‘
(
št£t
 *
is
, 
pos
, 
št64_t
 
v®ue
) {

82 
ušt32_t
 
’codšg
 = 
	`šŒev32ifbe
(
is
->encoding);

84 ià(
’codšg
 =ğ
INTSET_ENC_INT64
) {

85 ((
št64_t
*)
is
->
cÚ‹Ás
)[
pos
] = 
v®ue
;

86 
	`mem»v64ifbe
(((
št64_t
*)
is
->
cÚ‹Ás
)+
pos
);

87 } ià(
’codšg
 =ğ
INTSET_ENC_INT32
) {

88 ((
št32_t
*)
is
->
cÚ‹Ás
)[
pos
] = 
v®ue
;

89 
	`mem»v32ifbe
(((
št32_t
*)
is
->
cÚ‹Ás
)+
pos
);

91 ((
št16_t
*)
is
->
cÚ‹Ás
)[
pos
] = 
v®ue
;

92 
	`mem»v16ifbe
(((
št16_t
*)
is
->
cÚ‹Ás
)+
pos
);

94 
	}
}

97 
št£t
 *
	$št£tNew
() {

98 
št£t
 *
is
 = 
	`zm®loc
((intset));

99 
is
->
’codšg
 = 
	`šŒev32ifbe
(
INTSET_ENC_INT16
);

100 
is
->
Ëngth
 = 0;

101  
is
;

102 
	}
}

105 
št£t
 *
	$št£tResize
(
št£t
 *
is
, 
ušt32_t
 
Ën
) {

106 
ušt32_t
 
size
 = 
Ën
*
	`šŒev32ifbe
(
is
->
’codšg
);

107 
is
 = 
	`z»®loc
(is,(
št£t
)+
size
);

108  
is
;

109 
	}
}

115 
ušt8_t
 
	$št£tS—rch
(
št£t
 *
is
, 
št64_t
 
v®ue
, 
ušt32_t
 *
pos
) {

116 
mš
 = 0, 
max
 = 
	`šŒev32ifbe
(
is
->
Ëngth
)-1, 
mid
 = -1;

117 
št64_t
 
cur
 = -1;

120 ià(
	`šŒev32ifbe
(
is
->
Ëngth
) == 0) {

121 ià(
pos
) *pos = 0;

126 ià(
v®ue
 > 
	`_št£tG‘
(
is
,
	`šŒev32ifbe
(is->
Ëngth
)-1)) {

127 ià(
pos
è*po ğ
	`šŒev32ifbe
(
is
->
Ëngth
);

129 } ià(
v®ue
 < 
	`_št£tG‘
(
is
,0)) {

130 ià(
pos
) *pos = 0;

135 
max
 >ğ
mš
) {

136 
mid
 = (()
mš
 + ()
max
) >> 1;

137 
cur
 = 
	`_št£tG‘
(
is
,
mid
);

138 ià(
v®ue
 > 
cur
) {

139 
mš
 = 
mid
+1;

140 } ià(
v®ue
 < 
cur
) {

141 
max
 = 
mid
-1;

147 ià(
v®ue
 =ğ
cur
) {

148 ià(
pos
è*po ğ
mid
;

151 ià(
pos
è*po ğ
mš
;

154 
	}
}

157 
št£t
 *
	$št£tUpg¿deAndAdd
(
št£t
 *
is
, 
št64_t
 
v®ue
) {

158 
ušt8_t
 
cu»nc
 = 
	`šŒev32ifbe
(
is
->
’codšg
);

159 
ušt8_t
 
Ãw’c
 = 
	`_št£tV®ueEncodšg
(
v®ue
);

160 
Ëngth
 = 
	`šŒev32ifbe
(
is
->length);

161 
´•’d
 = 
v®ue
 < 0 ? 1 : 0;

164 
is
->
’codšg
 = 
	`šŒev32ifbe
(
Ãw’c
);

165 
is
 = 
	`št£tResize
(is,
	`šŒev32ifbe
(is->
Ëngth
)+1);

170 
Ëngth
--)

171 
	`_št£tS‘
(
is
,
Ëngth
+
´•’d
,
	`_št£tG‘Encoded
(is,Ëngth,
cu»nc
));

174 ià(
´•’d
)

175 
	`_št£tS‘
(
is
,0,
v®ue
);

177 
	`_št£tS‘
(
is
,
	`šŒev32ifbe
(is->
Ëngth
),
v®ue
);

178 
is
->
Ëngth
 = 
	`šŒev32ifbe
(intrev32ifbe(is->length)+1);

179  
is
;

180 
	}
}

182 
	$št£tMoveTa
(
št£t
 *
is
, 
ušt32_t
 
äom
, ušt32_ˆ
to
) {

183 *
¤c
, *
d¡
;

184 
ušt32_t
 
by‹s
 = 
	`šŒev32ifbe
(
is
->
Ëngth
)-
äom
;

185 
ušt32_t
 
’codšg
 = 
	`šŒev32ifbe
(
is
->encoding);

187 ià(
’codšg
 =ğ
INTSET_ENC_INT64
) {

188 
¤c
 = (
št64_t
*)
is
->
cÚ‹Ás
+
äom
;

189 
d¡
 = (
št64_t
*)
is
->
cÚ‹Ás
+
to
;

190 
by‹s
 *ğ(
št64_t
);

191 } ià(
’codšg
 =ğ
INTSET_ENC_INT32
) {

192 
¤c
 = (
št32_t
*)
is
->
cÚ‹Ás
+
äom
;

193 
d¡
 = (
št32_t
*)
is
->
cÚ‹Ás
+
to
;

194 
by‹s
 *ğ(
št32_t
);

196 
¤c
 = (
št16_t
*)
is
->
cÚ‹Ás
+
äom
;

197 
d¡
 = (
št16_t
*)
is
->
cÚ‹Ás
+
to
;

198 
by‹s
 *ğ(
št16_t
);

200 
	`memmove
(
d¡
,
¤c
,
by‹s
);

201 
	}
}

204 
št£t
 *
	$št£tAdd
(
št£t
 *
is
, 
št64_t
 
v®ue
, 
ušt8_t
 *
sucûss
) {

205 
ušt8_t
 
v®’c
 = 
	`_št£tV®ueEncodšg
(
v®ue
);

206 
ušt32_t
 
pos
;

207 ià(
sucûss
) *success = 1;

212 ià(
v®’c
 > 
	`šŒev32ifbe
(
is
->
’codšg
)) {

214  
	`št£tUpg¿deAndAdd
(
is
,
v®ue
);

219 ià(
	`št£tS—rch
(
is
,
v®ue
,&
pos
)) {

220 ià(
sucûss
) *success = 0;

221  
is
;

224 
is
 = 
	`št£tResize
(is,
	`šŒev32ifbe
(is->
Ëngth
)+1);

225 ià(
pos
 < 
	`šŒev32ifbe
(
is
->
Ëngth
)è
	`št£tMoveTa
(is,pos,pos+1);

228 
	`_št£tS‘
(
is
,
pos
,
v®ue
);

229 
is
->
Ëngth
 = 
	`šŒev32ifbe
(intrev32ifbe(is->length)+1);

230  
is
;

231 
	}
}

234 
št£t
 *
	$št£tRemove
(
št£t
 *
is
, 
št64_t
 
v®ue
, *
sucûss
) {

235 
ušt8_t
 
v®’c
 = 
	`_št£tV®ueEncodšg
(
v®ue
);

236 
ušt32_t
 
pos
;

237 ià(
sucûss
) *success = 0;

239 ià(
v®’c
 <ğ
	`šŒev32ifbe
(
is
->
’codšg
è&& 
	`št£tS—rch
(is,
v®ue
,&
pos
)) {

240 
ušt32_t
 
Ën
 = 
	`šŒev32ifbe
(
is
->
Ëngth
);

243 ià(
sucûss
) *success = 1;

246 ià(
pos
 < (
Ën
-1)è
	`št£tMoveTa
(
is
,pos+1,pos);

247 
is
 = 
	`št£tResize
(is,
Ën
-1);

248 
is
->
Ëngth
 = 
	`šŒev32ifbe
(
Ën
-1);

250  
is
;

251 
	}
}

254 
ušt8_t
 
	$št£tFšd
(
št£t
 *
is
, 
št64_t
 
v®ue
) {

255 
ušt8_t
 
v®’c
 = 
	`_št£tV®ueEncodšg
(
v®ue
);

256  
v®’c
 <ğ
	`šŒev32ifbe
(
is
->
’codšg
è&& 
	`št£tS—rch
(is,
v®ue
,
NULL
);

257 
	}
}

260 
št64_t
 
	$št£tRªdom
(
št£t
 *
is
) {

261  
	`_št£tG‘
(
is
,
	`¿nd
()%
	`šŒev32ifbe
(is->
Ëngth
));

262 
	}
}

266 
ušt8_t
 
	$št£tG‘
(
št£t
 *
is
, 
ušt32_t
 
pos
, 
št64_t
 *
v®ue
) {

267 ià(
pos
 < 
	`šŒev32ifbe
(
is
->
Ëngth
)) {

268 *
v®ue
 = 
	`_št£tG‘
(
is
,
pos
);

272 
	}
}

275 
ušt32_t
 
	$št£tL’
(
št£t
 *
is
) {

276  
	`šŒev32ifbe
(
is
->
Ëngth
);

277 
	}
}

280 
size_t
 
	$št£tBlobL’
(
št£t
 *
is
) {

281  (
št£t
)+
	`šŒev32ifbe
(
is
->
Ëngth
)*šŒev32ifbe(is->
’codšg
);

282 
	}
}

284 #ifdeà
REDIS_TEST


285 
	~<sys/time.h
>

286 
	~<time.h
>

289 
	$št£tR•r
(
št£t
 *
is
) {

290 
ušt32_t
 
i
 = 0; i < 
	`šŒev32ifbe
(
is
->
Ëngth
); i++) {

291 
	`´štf
("%Îd\n", (
ušt64_t
)
	`_št£tG‘
(
is
,
i
));

293 
	`´štf
("\n");

294 
	}
}

296 
	$”rÜ
(*
”r
) {

297 
	`´štf
("%s\n", 
”r
);

298 
	`ex™
(1);

299 
	}
}

302 
	$ok
() {

303 
	`´štf
("OK\n");

304 
	}
}

306 
	$u£c
() {

307 
timev®
 
tv
;

308 
	`g‘timeofday
(&
tv
,
NULL
);

309  ((()
tv
.
tv_£c
)*1000000)+tv.
tv_u£c
;

310 
	}
}

312 
	#as£¹
(
_e
è((_e)?()0:(
	`_as£¹
(#_e,
__FILE__
,
__LINE__
),
	`ex™
(1)))

	)

313 
	$_as£¹
(*
e¡r
, *
fe
, 
lše
) {

314 
	`´štf
("\n\n=== ASSERTION FAILED ===\n");

315 
	`´štf
("==> %s:%d '%s' i nÙrue\n",
fe
,
lše
,
e¡r
);

316 
	}
}

318 
št£t
 *
	$ü—‹S‘
(
b™s
, 
size
) {

319 
ušt64_t
 
mask
 = (1<<
b™s
)-1;

320 
ušt64_t
 
v®ue
;

321 
št£t
 *
is
 = 
	`št£tNew
();

323 
i
 = 0; i < 
size
; i++) {

324 ià(
b™s
 > 32) {

325 
v®ue
 = (
	`¿nd
()*¿nd()è& 
mask
;

327 
v®ue
 = 
	`¿nd
(è& 
mask
;

329 
is
 = 
	`št£tAdd
(is,
v®ue
,
NULL
);

331  
is
;

332 
	}
}

334 
	$checkCÚsi¡’cy
(
št£t
 *
is
) {

335 
ušt32_t
 
i
 = 0; i < (
	`šŒev32ifbe
(
is
->
Ëngth
)-1); i++) {

336 
ušt32_t
 
’codšg
 = 
	`šŒev32ifbe
(
is
->encoding);

338 ià(
’codšg
 =ğ
INTSET_ENC_INT16
) {

339 
št16_t
 *
i16
 = (št16_t*)
is
->
cÚ‹Ás
;

340 
	`as£¹
(
i16
[
i
] < i16[i+1]);

341 } ià(
’codšg
 =ğ
INTSET_ENC_INT32
) {

342 
št32_t
 *
i32
 = (št32_t*)
is
->
cÚ‹Ás
;

343 
	`as£¹
(
i32
[
i
] < i32[i+1]);

345 
št64_t
 *
i64
 = (št64_t*)
is
->
cÚ‹Ás
;

346 
	`as£¹
(
i64
[
i
] < i64[i+1]);

349 
	}
}

351 
	#UNUSED
(
x
è()(x)

	)

352 
	$št£tTe¡
(
¬gc
, **
¬gv
) {

353 
ušt8_t
 
sucûss
;

354 
i
;

355 
št£t
 *
is
;

356 
	`¤ªd
(
	`time
(
NULL
));

358 
	`UNUSED
(
¬gc
);

359 
	`UNUSED
(
¬gv
);

361 
	`´štf
("Valueƒncodings: "); {

362 
	`as£¹
(
	`_št£tV®ueEncodšg
(-32768è=ğ
INTSET_ENC_INT16
);

363 
	`as£¹
(
	`_št£tV®ueEncodšg
(+32767è=ğ
INTSET_ENC_INT16
);

364 
	`as£¹
(
	`_št£tV®ueEncodšg
(-32769è=ğ
INTSET_ENC_INT32
);

365 
	`as£¹
(
	`_št£tV®ueEncodšg
(+32768è=ğ
INTSET_ENC_INT32
);

366 
	`as£¹
(
	`_št£tV®ueEncodšg
(-2147483648è=ğ
INTSET_ENC_INT32
);

367 
	`as£¹
(
	`_št£tV®ueEncodšg
(+2147483647è=ğ
INTSET_ENC_INT32
);

368 
	`as£¹
(
	`_št£tV®ueEncodšg
(-2147483649è=ğ
INTSET_ENC_INT64
);

369 
	`as£¹
(
	`_št£tV®ueEncodšg
(+2147483648è=ğ
INTSET_ENC_INT64
);

370 
	`as£¹
(
	`_št£tV®ueEncodšg
(-9223372036854775808ull) ==

371 
INTSET_ENC_INT64
);

372 
	`as£¹
(
	`_št£tV®ueEncodšg
(+9223372036854775807ull) ==

373 
INTSET_ENC_INT64
);

374 
	`ok
();

377 
	`´štf
("Basic‡dding: "); {

378 
is
 = 
	`št£tNew
();

379 
is
 = 
	`št£tAdd
(is,5,&
sucûss
); 
	`as£¹
(success);

380 
is
 = 
	`št£tAdd
(is,6,&
sucûss
); 
	`as£¹
(success);

381 
is
 = 
	`št£tAdd
(is,4,&
sucûss
); 
	`as£¹
(success);

382 
is
 = 
	`št£tAdd
(is,4,&
sucûss
); 
	`as£¹
(!success);

383 
	`ok
();

386 
	`´štf
("Large‚umber of„andom‡dds: "); {

387 
ušt32_t
 
š£¹s
 = 0;

388 
is
 = 
	`št£tNew
();

389 
i
 = 0; i < 1024; i++) {

390 
is
 = 
	`št£tAdd
(is,
	`¿nd
()%0x800,&
sucûss
);

391 ià(
sucûss
è
š£¹s
++;

393 
	`as£¹
(
	`šŒev32ifbe
(
is
->
Ëngth
è=ğ
š£¹s
);

394 
	`checkCÚsi¡’cy
(
is
);

395 
	`ok
();

398 
	`´štf
("Upgrade from int16o int32: "); {

399 
is
 = 
	`št£tNew
();

400 
is
 = 
	`št£tAdd
(is,32,
NULL
);

401 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT16
);

402 
is
 = 
	`št£tAdd
(is,65535,
NULL
);

403 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT32
);

404 
	`as£¹
(
	`št£tFšd
(
is
,32));

405 
	`as£¹
(
	`št£tFšd
(
is
,65535));

406 
	`checkCÚsi¡’cy
(
is
);

408 
is
 = 
	`št£tNew
();

409 
is
 = 
	`št£tAdd
(is,32,
NULL
);

410 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT16
);

411 
is
 = 
	`št£tAdd
(is,-65535,
NULL
);

412 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT32
);

413 
	`as£¹
(
	`št£tFšd
(
is
,32));

414 
	`as£¹
(
	`št£tFšd
(
is
,-65535));

415 
	`checkCÚsi¡’cy
(
is
);

416 
	`ok
();

419 
	`´štf
("Upgrade from int16o int64: "); {

420 
is
 = 
	`št£tNew
();

421 
is
 = 
	`št£tAdd
(is,32,
NULL
);

422 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT16
);

423 
is
 = 
	`št£tAdd
(is,4294967295,
NULL
);

424 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT64
);

425 
	`as£¹
(
	`št£tFšd
(
is
,32));

426 
	`as£¹
(
	`št£tFšd
(
is
,4294967295));

427 
	`checkCÚsi¡’cy
(
is
);

429 
is
 = 
	`št£tNew
();

430 
is
 = 
	`št£tAdd
(is,32,
NULL
);

431 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT16
);

432 
is
 = 
	`št£tAdd
(is,-4294967295,
NULL
);

433 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT64
);

434 
	`as£¹
(
	`št£tFšd
(
is
,32));

435 
	`as£¹
(
	`št£tFšd
(
is
,-4294967295));

436 
	`checkCÚsi¡’cy
(
is
);

437 
	`ok
();

440 
	`´štf
("Upgrade from int32o int64: "); {

441 
is
 = 
	`št£tNew
();

442 
is
 = 
	`št£tAdd
(is,65535,
NULL
);

443 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT32
);

444 
is
 = 
	`št£tAdd
(is,4294967295,
NULL
);

445 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT64
);

446 
	`as£¹
(
	`št£tFšd
(
is
,65535));

447 
	`as£¹
(
	`št£tFšd
(
is
,4294967295));

448 
	`checkCÚsi¡’cy
(
is
);

450 
is
 = 
	`št£tNew
();

451 
is
 = 
	`št£tAdd
(is,65535,
NULL
);

452 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT32
);

453 
is
 = 
	`št£tAdd
(is,-4294967295,
NULL
);

454 
	`as£¹
(
	`šŒev32ifbe
(
is
->
’codšg
è=ğ
INTSET_ENC_INT64
);

455 
	`as£¹
(
	`št£tFšd
(
is
,65535));

456 
	`as£¹
(
	`št£tFšd
(
is
,-4294967295));

457 
	`checkCÚsi¡’cy
(
is
);

458 
	`ok
();

461 
	`´štf
("Stress†ookups: "); {

462 
num
 = 100000, 
size
 = 10000;

463 
i
, 
b™s
 = 20;

464 
¡¬t
;

465 
is
 = 
	`ü—‹S‘
(
b™s
,
size
);

466 
	`checkCÚsi¡’cy
(
is
);

468 
¡¬t
 = 
	`u£c
();

469 
i
 = 0; i < 
num
; i++è
	`št£tS—rch
(
is
,
	`¿nd
(è% ((1<<
b™s
)-1),
NULL
);

470 
	`´štf
("%ld†ookups, %ldƒlement set, %lldusec\n",

471 
num
,
size
,
	`u£c
()-
¡¬t
);

474 
	`´štf
("Stress‡dd+delete: "); {

475 
i
, 
v1
, 
v2
;

476 
is
 = 
	`št£tNew
();

477 
i
 = 0; i < 0xffff; i++) {

478 
v1
 = 
	`¿nd
() % 0xfff;

479 
is
 = 
	`št£tAdd
(is,
v1
,
NULL
);

480 
	`as£¹
(
	`št£tFšd
(
is
,
v1
));

482 
v2
 = 
	`¿nd
() % 0xfff;

483 
is
 = 
	`št£tRemove
(is,
v2
,
NULL
);

484 
	`as£¹
(!
	`št£tFšd
(
is
,
v2
));

486 
	`checkCÚsi¡’cy
(
is
);

487 
	`ok
();

491 
	}
}

	@src/intset.h

31 #iâdeà
__INTSET_H


32 
	#__INTSET_H


	)

33 
	~<¡dšt.h
>

35 
	sšt£t
 {

36 
ušt32_t
 
	m’codšg
;

37 
ušt32_t
 
	mËngth
;

38 
št8_t
 
	mcÚ‹Ás
[];

39 } 
	tšt£t
;

41 
št£t
 *
št£tNew
();

42 
št£t
 *
št£tAdd
(št£ˆ*
is
, 
št64_t
 
v®ue
, 
ušt8_t
 *
sucûss
);

43 
št£t
 *
št£tRemove
(št£ˆ*
is
, 
št64_t
 
v®ue
, *
sucûss
);

44 
ušt8_t
 
št£tFšd
(
št£t
 *
is
, 
št64_t
 
v®ue
);

45 
št64_t
 
št£tRªdom
(
št£t
 *
is
);

46 
ušt8_t
 
št£tG‘
(
št£t
 *
is
, 
ušt32_t
 
pos
, 
št64_t
 *
v®ue
);

47 
ušt32_t
 
št£tL’
(
št£t
 *
is
);

48 
size_t
 
št£tBlobL’
(
št£t
 *
is
);

50 #ifdeà
REDIS_TEST


51 
št£tTe¡
(
¬gc
, *
¬gv
[]);

	@src/latency.c

36 
	~"£rv”.h
"

39 
	$diùSŒšgKeyCom·»
(*
´ivd©a
, cÚ¡ *
key1
, cÚ¡ *
key2
) {

40 
	`UNUSED
(
´ivd©a
);

41  
	`¡rcmp
(
key1
,
key2
) == 0;

42 
	}
}

44 
	$diùSŒšgHash
(cÚ¡ *
key
) {

45  
	`diùG’HashFunùiÚ
(
key
, 
	`¡¾’
(key));

46 
	}
}

48 
diùVªÏF»e
(*
´ivd©a
, *
v®
);

50 
diùTy³
 
	gÏ‹ncyTimeS”›sDiùTy³
 = {

51 
diùSŒšgHash
,

52 
NULL
,

53 
NULL
,

54 
diùSŒšgKeyCom·»
,

55 
diùVªÏF»e
,

56 
diùVªÏF»e


61 #ifdeà
__lšux__


64 
	$THPIsEÇbËd
() {

65 
buf
[1024];

67 
FILE
 *
å
 = 
	`fİ’
("/sys/kernel/mm/transparent_hugepage/enabled","r");

68 ià(!
å
)  0;

69 ià(
	`fg‘s
(
buf
,(buf),
å
è=ğ
NULL
) {

70 
	`fşo£
(
å
);

73 
	`fşo£
(
å
);

74  (
	`¡r¡r
(
buf
,"[Ãv”]"è=ğ
NULL
) ? 1 : 0;

75 
	}
}

81 
	$THPG‘AnÚHugePagesSize
() {

82  
	`zm®loc_g‘_sm­_by‹s_by_f›ld
("AnonHugePages:");

83 
	}
}

90 
	$Ï‹ncyMÚ™ÜIn™
() {

91 
£rv”
.
Ï‹ncy_ev’ts
 = 
	`diùC»©e
(&
Ï‹ncyTimeS”›sDiùTy³
,
NULL
);

92 
	}
}

98 
	$Ï‹ncyAddSam¶e
(*
ev’t
, 
m¡ime_t
 
Ï‹ncy
) {

99 
Ï‹ncyTimeS”›s
 *
ts
 = 
	`diùF‘chV®ue
(
£rv”
.
Ï‹ncy_ev’ts
,
ev’t
);

100 
time_t
 
now
 = 
	`time
(
NULL
);

101 
´ev
;

104 ià(
ts
 =ğ
NULL
) {

105 
ts
 = 
	`zm®loc
((*ts));

106 
ts
->
idx
 = 0;

107 
ts
->
max
 = 0;

108 
	`mem£t
(
ts
->
§m¶es
,0,(ts->samples));

109 
	`diùAdd
(
£rv”
.
Ï‹ncy_ev’ts
,
	`z¡rdup
(
ev’t
),
ts
);

114 
´ev
 = (
ts
->
idx
 + 
LATENCY_TS_LEN
 - 1) % LATENCY_TS_LEN;

115 ià(
ts
->
§m¶es
[
´ev
].
time
 =ğ
now
) {

116 ià(
Ï‹ncy
 > 
ts
->
§m¶es
[
´ev
].latency)

117 
ts
->
§m¶es
[
´ev
].
Ï‹ncy
 =†atency;

121 
ts
->
§m¶es
[ts->
idx
].
time
 = 
	`time
(
NULL
);

122 
ts
->
§m¶es
[ts->
idx
].
Ï‹ncy
 =†atency;

123 ià(
Ï‹ncy
 > 
ts
->
max
)s->max =†atency;

125 
ts
->
idx
++;

126 ià(
ts
->
idx
 =ğ
LATENCY_TS_LEN
)s->idx = 0;

127 
	}
}

134 
	$Ï‹ncyRe£tEv’t
(*
ev’t_to_»£t
) {

135 
diùI‹¿tÜ
 *
di
;

136 
diùEÁry
 *
de
;

137 
»£ts
 = 0;

139 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
Ï‹ncy_ev’ts
);

140 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

141 *
ev’t
 = 
	`diùG‘Key
(
de
);

143 ià(
ev’t_to_»£t
 =ğ
NULL
 || 
	`¡rÿ£cmp
(
ev’t
,event_to_reset) == 0) {

144 
	`diùD–‘e
(
£rv”
.
Ï‹ncy_ev’ts
, 
ev’t
);

145 
»£ts
++;

148 
	`diùR–—£I‹¿tÜ
(
di
);

149  
»£ts
;

150 
	}
}

159 
	$ª®yzeL©’cyFÜEv’t
(*
ev’t
, 
Ï‹ncySts
 *
ls
) {

160 
Ï‹ncyTimeS”›s
 *
ts
 = 
	`diùF‘chV®ue
(
£rv”
.
Ï‹ncy_ev’ts
,
ev’t
);

161 
j
;

162 
ušt64_t
 
sum
;

164 
ls
->
®l_time_high
 = 
ts
 ?s->
max
 : 0;

165 
ls
->
avg
 = 0;

166 
ls
->
mš
 = 0;

167 
ls
->
max
 = 0;

168 
ls
->
mad
 = 0;

169 
ls
->
§m¶es
 = 0;

170 
ls
->
³riod
 = 0;

171 ià(!
ts
) ;

174 
sum
 = 0;

175 
j
 = 0; j < 
LATENCY_TS_LEN
; j++) {

176 ià(
ts
->
§m¶es
[
j
].
time
 == 0) ;

177 
ls
->
§m¶es
++;

178 ià(
ls
->
§m¶es
 == 1) {

179 
ls
->
mš
 =†s->
max
 = 
ts
->
§m¶es
[
j
].
Ï‹ncy
;

181 ià(
ls
->
mš
 > 
ts
->
§m¶es
[
j
].
Ï‹ncy
)

182 
ls
->
mš
 = 
ts
->
§m¶es
[
j
].
Ï‹ncy
;

183 ià(
ls
->
max
 < 
ts
->
§m¶es
[
j
].
Ï‹ncy
)

184 
ls
->
max
 = 
ts
->
§m¶es
[
j
].
Ï‹ncy
;

186 
sum
 +ğ
ts
->
§m¶es
[
j
].
Ï‹ncy
;

189 ià(
ls
->
³riod
 =ğ0 || 
ts
->
§m¶es
[
j
].
time
 <†s->period)

190 
ls
->
³riod
 = 
ts
->
§m¶es
[
j
].
time
;

196 ià(
ls
->
§m¶es
) {

197 
ls
->
avg
 = 
sum
 /†s->
§m¶es
;

198 
ls
->
³riod
 = 
	`time
(
NULL
) -†s->period;

199 ià(
ls
->
³riod
 == 0)†s->period = 1;

203 
sum
 = 0;

204 
j
 = 0; j < 
LATENCY_TS_LEN
; j++) {

205 
št64_t
 
d–
;

207 ià(
ts
->
§m¶es
[
j
].
time
 == 0) ;

208 
d–
 = (
št64_t
)
ls
->
avg
 - 
ts
->
§m¶es
[
j
].
Ï‹ncy
;

209 ià(
d–
 < 0) delta = -delta;

210 
sum
 +ğ
d–
;

212 ià(
ls
->
§m¶es
èls->
mad
 = 
sum
 /†s->samples;

213 
	}
}

216 
sds
 
	$ü—‹L©’cyR•Üt
() {

217 
sds
 
»pÜt
 = 
	`sd£m±y
();

218 
advi£_b‘‹r_vm
 = 0;

219 
advi£_¦owlog_’abËd
 = 0;

220 
advi£_¦owlog_tunšg
 = 0;

221 
advi£_¦owlog_š¥eù
 = 0;

222 
advi£_disk_cÚ‹ÁiÚ
 = 0;

223 
advi£_scheduËr
 = 0;

224 
advi£_d©a_wr™eback
 = 0;

225 
advi£_no_­³ndfsync
 = 0;

226 
advi£_loÿl_disk
 = 0;

227 
advi£_ssd
 = 0;

228 
advi£_wr™e_lßd_šfo
 = 0;

229 
advi£_hz
 = 0;

230 
advi£_Ïrge_objeùs
 = 0;

231 
advi£_mass_eviùiÚ
 = 0;

232 
advi£_»Ïx_fsync_pŞicy
 = 0;

233 
advi£_di§bË_thp
 = 0;

234 
adviûs
 = 0;

238 ià(
	`diùSize
(
£rv”
.
Ï‹ncy_ev’ts
) == 0 &&

239 
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
 == 0)

241 
»pÜt
 = 
	`sdsÿt
(report,"I'm sorry, Dave, I can't dohat. Latency monitoring is disabled inhis Redis instance. You may use \"CONFIG SET†atency-monitor-threshold <milliseconds>.\" in orderoƒnable it. If we weren't in‡ deep space mission I'd suggestoake‡†ook‡t http://redis.io/topics/latency-monitor.\n");

242  
»pÜt
;

247 
diùI‹¿tÜ
 *
di
;

248 
diùEÁry
 *
de
;

249 
ev’Šum
 = 0;

251 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
£rv”
.
Ï‹ncy_ev’ts
);

252 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

253 *
ev’t
 = 
	`diùG‘Key
(
de
);

254 
Ï‹ncyTimeS”›s
 *
ts
 = 
	`diùG‘V®
(
de
);

255 
Ï‹ncySts
 
ls
;

257 ià(
ts
 =ğ
NULL
) ;

258 
ev’Šum
++;

259 ià(
ev’Šum
 == 1) {

260 
»pÜt
 = 
	`sdsÿt
(report,"Dave, I have observed†atency spikes inhis Redis instance. You don't mindalking‡bout it, do you Dave?\n\n");

262 
	`ª®yzeL©’cyFÜEv’t
(
ev’t
,&
ls
);

264 
»pÜt
 = 
	`sdsÿrštf
(report,

266 
ev’Šum
, 
ev’t
,

267 
ls
.
§m¶es
,

268 (è
ls
.
avg
,

269 (è
ls
.
mad
,

270 (è
ls
.
³riod
/ls.
§m¶es
,

271 (è
ts
->
max
);

274 ià(!
	`¡rÿ£cmp
(
ev’t
,"fork")) {

275 *
fÜk_qu®™y
;

276 ià(
£rv”
.
¡©_fÜk_¿‹
 < 10) {

277 
fÜk_qu®™y
 = "terrible";

278 
advi£_b‘‹r_vm
 = 1;

279 
adviûs
++;

280 } ià(
£rv”
.
¡©_fÜk_¿‹
 < 25) {

281 
fÜk_qu®™y
 = "poor";

282 
advi£_b‘‹r_vm
 = 1;

283 
adviûs
++;

284 } ià(
£rv”
.
¡©_fÜk_¿‹
 < 100) {

285 
fÜk_qu®™y
 = "good";

287 
fÜk_qu®™y
 = "excellent";

289 
»pÜt
 = 
	`sdsÿrštf
(report,

290 " FÜk„©i %.2àGB/£ø(%s).", 
£rv”
.
¡©_fÜk_¿‹
,

291 
fÜk_qu®™y
);

295 ià(!
	`¡rÿ£cmp
(
ev’t
,"command")) {

296 ià(
£rv”
.
¦owlog_log_¦ow”_thª
 == 0) {

297 
advi£_¦owlog_’abËd
 = 1;

298 
adviûs
++;

299 } ià(
£rv”
.
¦owlog_log_¦ow”_thª
/1000 >

300 
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
)

302 
advi£_¦owlog_tunšg
 = 1;

303 
adviûs
++;

305 
advi£_¦owlog_š¥eù
 = 1;

306 
advi£_Ïrge_objeùs
 = 1;

307 
adviûs
 += 2;

311 ià(!
	`¡rÿ£cmp
(
ev’t
,"fast-command")) {

312 
advi£_scheduËr
 = 1;

313 
adviûs
++;

317 ià(!
	`¡rÿ£cmp
(
ev’t
,"aof-write-pending-fsync")) {

318 
advi£_loÿl_disk
 = 1;

319 
advi£_disk_cÚ‹ÁiÚ
 = 1;

320 
advi£_ssd
 = 1;

321 
advi£_d©a_wr™eback
 = 1;

322 
adviûs
 += 4;

325 ià(!
	`¡rÿ£cmp
(
ev’t
,"aof-write-active-child")) {

326 
advi£_no_­³ndfsync
 = 1;

327 
advi£_d©a_wr™eback
 = 1;

328 
advi£_ssd
 = 1;

329 
adviûs
 += 3;

332 ià(!
	`¡rÿ£cmp
(
ev’t
,"aof-write-alone")) {

333 
advi£_loÿl_disk
 = 1;

334 
advi£_d©a_wr™eback
 = 1;

335 
advi£_ssd
 = 1;

336 
adviûs
 += 3;

339 ià(!
	`¡rÿ£cmp
(
ev’t
,"aof-fsync-always")) {

340 
advi£_»Ïx_fsync_pŞicy
 = 1;

341 
adviûs
++;

344 ià(!
	`¡rÿ£cmp
(
ev’t
,"aof-fstat") ||

345 !
	`¡rÿ£cmp
(
ev’t
,"rdb-unlik-temp-file")) {

346 
advi£_disk_cÚ‹ÁiÚ
 = 1;

347 
advi£_loÿl_disk
 = 1;

348 
adviûs
 += 2;

351 ià(!
	`¡rÿ£cmp
(
ev’t
,"aof-rewrite-diff-write") ||

352 !
	`¡rÿ£cmp
(
ev’t
,"aof-rename")) {

353 
advi£_wr™e_lßd_šfo
 = 1;

354 
advi£_d©a_wr™eback
 = 1;

355 
advi£_ssd
 = 1;

356 
advi£_loÿl_disk
 = 1;

357 
adviûs
 += 4;

361 ià(!
	`¡rÿ£cmp
(
ev’t
,"expire-cycle")) {

362 
advi£_hz
 = 1;

363 
advi£_Ïrge_objeùs
 = 1;

364 
adviûs
 += 2;

368 ià(!
	`¡rÿ£cmp
(
ev’t
,"eviction-del")) {

369 
advi£_Ïrge_objeùs
 = 1;

370 
adviûs
++;

373 ià(!
	`¡rÿ£cmp
(
ev’t
,"eviction-cycle")) {

374 
advi£_mass_eviùiÚ
 = 1;

375 
adviûs
++;

378 
»pÜt
 = 
	`sdsÿ’
(report,"\n",1);

380 
	`diùR–—£I‹¿tÜ
(
di
);

383 ià(
	`THPG‘AnÚHugePagesSize
() > 0) {

384 
advi£_di§bË_thp
 = 1;

385 
adviûs
++;

388 ià(
ev’Šum
 =ğ0 && 
adviûs
 == 0) {

389 
»pÜt
 = 
	`sdsÿt
(report,"Dave,‚o†atency spike was observed duringhe†ifetime ofhis Redis instance,‚ot inhe slightest bit. I honestlyhink you oughto sit down calmly,ake‡ stress…ill,‡ndhinkhings over.\n");

390 } ià(
ev’Šum
 > 0 && 
adviûs
 == 0) {

391 
»pÜt
 = 
	`sdsÿt
(report,"\nWhilehere‡re†atencyƒvents†ogged, I'm‚ot‡bleo suggest‡nyƒasy fix. Please usehe Redis communityo get some help,…rovidinghis„eport in your help„equest.\n");

396 
»pÜt
 = 
	`sdsÿt
(report,"\nI have‡ few‡dvices for you:\n\n");

397 ià(
advi£_b‘‹r_vm
) {

398 
»pÜt
 = 
	`sdsÿt
(report,"- If you‡re using‡ virtual machine, consider upgrading it with‡ faster one using‡n hypervisiorhat…rovides†ess†atency during fork() calls. Xen is knowno have…oor fork()…erformance. Even inhe context ofhe same VM…rovider, certain kinds of instances canƒxecute fork fasterhan others.\n");

402 ià(
advi£_¦owlog_’abËd
) {

403 
»pÜt
 = 
	`sdsÿrštf
Ô•Üt,"- Th”¬Ï‹ncy issue w™h…Ù’tŸÎy slow commªd you‡» usšg. TryØ’abËhSlow Log Redi ã©u» usšghcommªd 'CONFIG SET slowlog-log-¦ow”-thª %Îu'. IàthSlow†og i di§bËd Redi i nÙ‡bËØlog slow commªd executiÚ fÜ you.\n", ()
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
*1000);

406 ià(
advi£_¦owlog_tunšg
) {

407 
»pÜt
 = 
	`sdsÿrštf
Ô•Üt,"- You¸cu¼’ˆSlow Log cÚfigu¿tiÚ oÆy†og ev’t th©‡» slow”hª you¸cÚfigu»d†©’cy mÚ™Üh»shŞd. PËa£ u£ 'CONFIG SET slowlog-log-¦ow”-thª %Îu'.\n", ()
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
*1000);

410 ià(
advi£_¦owlog_š¥eù
) {

411 
»pÜt
 = 
	`sdsÿt
(report,"- Check your Slow Logo understand what‡rehe commands you‡re„unning which‡reoo slowoƒxecute. Please check http://redis.io/commands/slowlog for more information.\n");

415 ià(
advi£_scheduËr
) {

416 
»pÜt
 = 
	`sdsÿt
(report,"- The system is slowoƒxecute Redis code…aths‚ot containing system calls. This usually meanshe system does‚ot…rovide Redis CPUimeo„un for†ong…eriods. You shouldryo:\n"

425 ià(
advi£_loÿl_disk
) {

426 
»pÜt
 = 
	`sdsÿt
(report,"- It is strongly‡dvisedo use†ocal disks for…ersistence,ƒspecially if you‡re using AOF. Remote disks…rovided by…latform-as-a-service…roviders‡re knowno be slow.\n");

429 ià(
advi£_ssd
) {

430 
»pÜt
 = 
	`sdsÿt
(report,"- SSD disks‡re‡bleo„educe fsync†atency,‡ndotalime‚eeded for snapshotting‡nd AOF†og„ewriting (resulting in smaller memory usage‡nd smaller final AOF„ewrite buffer flushes). Withƒxtremely high write†oad SSD disks can be‡ good option. However Redis should…erform„easonably with high†oad using‚ormal disks. Usehis‡dvice‡s‡†ast„esort.\n");

433 ià(
advi£_d©a_wr™eback
) {

434 
»pÜt
 = 
	`sdsÿt
(report,"- Mountingƒxt3/4 filesystems with data=writeback can…rovide‡…erformance boost comparedo data=ordered, howeverhis mode of operation…rovides†ess guarantees,‡nd sometimes it can happenhat‡fter‡ hard crashhe AOF file will have‡n half-written command‡theƒnd‡nd will„equireo be„epaired before Redis„estarts.\n");

437 ià(
advi£_disk_cÚ‹ÁiÚ
) {

438 
»pÜt
 = 
	`sdsÿt
(report,"- Tryo†owerhe disk contention. This is often caused by other disk intensive…rocesses„unning inhe same computer (including other Redis instances).\n");

441 ià(
advi£_no_­³ndfsync
) {

442 
»pÜt
 = 
	`sdsÿt
(report,"- Assuming fromhe…oint of view of data safetyhis is viable in yourƒnvironment, you couldryoƒnablehe 'no-appendfsync-on-rewrite' option, sohat fsync will‚ot be…erformed whilehere is‡ child„ewritinghe AOF file or…roducing‡n RDB file (the moment wherehere is high disk contention).\n");

445 ià(
advi£_»Ïx_fsync_pŞicy
 && 
£rv”
.
aof_fsync
 =ğ
AOF_FSYNC_ALWAYS
) {

446 
»pÜt
 = 
	`sdsÿt
(report,"- Your fsync…olicy is seto 'always'. It is very hardo get good…erformances with such‡ setup, if…ossibleryo„elaxhe fsync…olicyo 'onesec'.\n");

449 ià(
advi£_wr™e_lßd_šfo
) {

450 
»pÜt
 = 
	`sdsÿt
(report,"- Latency duringhe AOF‡tomic„ename operation or whenhe final difference is flushedohe AOF file‡theƒnd ofhe„ewrite, sometimes is caused by very high write†oad, causinghe AOF buffero get very†arge. If…ossibleryo send†ess commandso‡ccomplishhe same work, or use Lua scriptso group multiple operations into‡ single EVALSHA call.\n");

453 ià(
advi£_hz
 && 
£rv”
.
hz
 < 100) {

454 
»pÜt
 = 
	`sdsÿt
(report,"- In ordero makehe Redis keysƒxpiring…rocess more incremental,ryo sethe 'hz' configuration…arametero 100 using 'CONFIG SET hz 100'.\n");

457 ià(
advi£_Ïrge_objeùs
) {

458 
»pÜt
 = 
	`sdsÿt
(report,"- Deleting,ƒxpiring orƒvicting (because of maxmemory…olicy)†arge objects is‡ blocking operation. If you have very†arge objectshat‡re often deleted,ƒxpired, orƒvicted,ryo fragmenthose objects into multiple smaller objects.\n");

461 ià(
advi£_mass_eviùiÚ
) {

462 
»pÜt
 = 
	`sdsÿt
(report,"- Sudden changesohe 'maxmemory' setting via 'CONFIG SET', or‡llocation of†arge objects via sets or sorted sets intersections, STORE option of SORT, Redis Cluster†arge keys migrations (RESTORE command), may create sudden memory…ressure forcinghe servero blockryingoƒvict keys. \n");

465 ià(
advi£_di§bË_thp
) {

466 
»pÜt
 = 
	`sdsÿt
(report,"- I detected‡‚on zero‡mount of‡nonymous huge…ages used by your…rocess. This creates very serious†atencyƒvents in different conditions,ƒspecially when Redis is…ersisting on disk. To disable THP support usehe command 'echo‚ever > /sys/kernel/mm/transparent_hugepage/enabled', make sureo‡lso‡dd it into /etc/rc.local sohathe command will beƒxecuted‡gain‡fter‡„eboot. Notehatƒven if you have‡lready disabled THP, you still‚eedo„estarthe Redis…rocesso get„id ofhe huge…ages‡lready created.\n");

470  
»pÜt
;

471 
	}
}

477 
	$Ï‹ncyCommªdR•lyW™hSam¶es
(
ş›Á
 *
c
, 
Ï‹ncyTimeS”›s
 *
ts
) {

478 *
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

479 
§m¶es
 = 0, 
j
;

481 
j
 = 0; j < 
LATENCY_TS_LEN
; j++) {

482 
i
 = (
ts
->
idx
 + 
j
è% 
LATENCY_TS_LEN
;

484 ià(
ts
->
§m¶es
[
i
].
time
 == 0) ;

485 
	`addR•lyMuÉiBulkL’
(
c
,2);

486 
	`addR•lyLÚgLÚg
(
c
,
ts
->
§m¶es
[
i
].
time
);

487 
	`addR•lyLÚgLÚg
(
c
,
ts
->
§m¶es
[
i
].
Ï‹ncy
);

488 
§m¶es
++;

490 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
»¶yËn
,
§m¶es
);

491 
	}
}

495 
	$Ï‹ncyCommªdR•lyW™hL©e¡Ev’ts
(
ş›Á
 *
c
) {

496 
diùI‹¿tÜ
 *
di
;

497 
diùEÁry
 *
de
;

499 
	`addR•lyMuÉiBulkL’
(
c
,
	`diùSize
(
£rv”
.
Ï‹ncy_ev’ts
));

500 
di
 = 
	`diùG‘I‹¿tÜ
(
£rv”
.
Ï‹ncy_ev’ts
);

501 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

502 *
ev’t
 = 
	`diùG‘Key
(
de
);

503 
Ï‹ncyTimeS”›s
 *
ts
 = 
	`diùG‘V®
(
de
);

504 
Ï¡
 = (
ts
->
idx
 + 
LATENCY_TS_LEN
 - 1) % LATENCY_TS_LEN;

506 
	`addR•lyMuÉiBulkL’
(
c
,4);

507 
	`addR•lyBulkCSŒšg
(
c
,
ev’t
);

508 
	`addR•lyLÚgLÚg
(
c
,
ts
->
§m¶es
[
Ï¡
].
time
);

509 
	`addR•lyLÚgLÚg
(
c
,
ts
->
§m¶es
[
Ï¡
].
Ï‹ncy
);

510 
	`addR•lyLÚgLÚg
(
c
,
ts
->
max
);

512 
	`diùR–—£I‹¿tÜ
(
di
);

513 
	}
}

515 
	#LATENCY_GRAPH_COLS
 80

	)

516 
sds
 
	$Ï‹ncyCommªdG’S·rk–še
(*
ev’t
, 
Ï‹ncyTimeS”›s
 *
ts
) {

517 
j
;

518 
£qu’û
 *
£q
 = 
	`ü—‹S·rklšeSequ’û
();

519 
sds
 
g¿ph
 = 
	`sd£m±y
();

520 
ušt32_t
 
mš
 = 0, 
max
 = 0;

522 
j
 = 0; j < 
LATENCY_TS_LEN
; j++) {

523 
i
 = (
ts
->
idx
 + 
j
è% 
LATENCY_TS_LEN
;

524 
–­£d
;

525 
buf
[64];

527 ià(
ts
->
§m¶es
[
i
].
time
 == 0) ;

529 ià(
£q
->
Ëngth
 == 0) {

530 
mš
 = 
max
 = 
ts
->
§m¶es
[
i
].
Ï‹ncy
;

532 ià(
ts
->
§m¶es
[
i
].
Ï‹ncy
 > 
max
) max =s->samples[i].latency;

533 ià(
ts
->
§m¶es
[
i
].
Ï‹ncy
 < 
mš
) min =s->samples[i].latency;

537 
–­£d
 = 
	`time
(
NULL
è- 
ts
->
§m¶es
[
i
].
time
;

538 ià(
–­£d
 < 60)

539 
	`¢´štf
(
buf
,(buf),"%ds",
–­£d
);

540 ià(
–­£d
 < 3600)

541 
	`¢´štf
(
buf
,(buf),"%dm",
–­£d
/60);

542 ià(
–­£d
 < 3600*24)

543 
	`¢´štf
(
buf
,(buf),"%dh",
–­£d
/3600);

545 
	`¢´štf
(
buf
,(buf),"%dd",
–­£d
/(3600*24));

546 
	`¥¬klšeSequ’ûAddSam¶e
(
£q
,
ts
->
§m¶es
[
i
].
Ï‹ncy
,
buf
);

549 
g¿ph
 = 
	`sdsÿrštf
(graph,

550 "% - high %lu ms,†ow %lu m ×Îimhigh %lu ms)\n", 
ev’t
,

551 (è
max
, (è
mš
, (è
ts
->max);

552 
j
 = 0; j < 
LATENCY_GRAPH_COLS
; j++)

553 
g¿ph
 = 
	`sdsÿ’
(graph,"-",1);

554 
g¿ph
 = 
	`sdsÿ’
(graph,"\n",1);

555 
g¿ph
 = 
	`¥¬klšeR’d”
(g¿ph,
£q
,
LATENCY_GRAPH_COLS
,4,
SPARKLINE_FILL
);

556 
	`ä“S·rklšeSequ’û
(
£q
);

557  
g¿ph
;

558 
	}
}

567 
	$Ï‹ncyCommªd
(
ş›Á
 *
c
) {

568 
Ï‹ncyTimeS”›s
 *
ts
;

570 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"hi¡Üy"è&& c->
¬gc
 == 3) {

572 
ts
 = 
	`diùF‘chV®ue
(
£rv”
.
Ï‹ncy_ev’ts
,
c
->
¬gv
[2]->
±r
);

573 ià(
ts
 =ğ
NULL
) {

574 
	`addR•lyMuÉiBulkL’
(
c
,0);

576 
	`Ï‹ncyCommªdR•lyW™hSam¶es
(
c
,
ts
);

578 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"g¿ph"è&& c->
¬gc
 == 3) {

580 
sds
 
g¿ph
;

581 
diùEÁry
 *
de
;

582 *
ev’t
;

584 
de
 = 
	`diùFšd
(
£rv”
.
Ï‹ncy_ev’ts
,
c
->
¬gv
[2]->
±r
);

585 ià(
de
 =ğ
NULL
è
nod©«¼
;

586 
ts
 = 
	`diùG‘V®
(
de
);

587 
ev’t
 = 
	`diùG‘Key
(
de
);

589 
g¿ph
 = 
	`Ï‹ncyCommªdG’S·rk–še
(
ev’t
,
ts
);

590 
	`addR•lyBulkCSŒšg
(
c
,
g¿ph
);

591 
	`sdsä“
(
g¿ph
);

592 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"Ï‹¡"è&& c->
¬gc
 == 2) {

594 
	`Ï‹ncyCommªdR•lyW™hL©e¡Ev’ts
(
c
);

595 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"doùÜ"è&& c->
¬gc
 == 2) {

597 
sds
 
»pÜt
 = 
	`ü—‹L©’cyR•Üt
();

599 
	`addR•lyBulkCBufãr
(
c
,
»pÜt
,
	`sd¦’
(report));

600 
	`sdsä“
(
»pÜt
);

601 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"»£t"è&& c->
¬gc
 >= 2) {

603 ià(
c
->
¬gc
 == 2) {

604 
	`addR•lyLÚgLÚg
(
c
,
	`Ï‹ncyRe£tEv’t
(
NULL
));

606 
j
, 
»£ts
 = 0;

608 
j
 = 2; j < 
c
->
¬gc
; j++)

609 
»£ts
 +ğ
	`Ï‹ncyRe£tEv’t
(
c
->
¬gv
[
j
]->
±r
);

610 
	`addR•lyLÚgLÚg
(
c
,
»£ts
);

613 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

617 
nod©«¼
:

620 
	`addR•lyE¼ÜFÜm©
(
c
,

621 "NØ§m¶e avaabË fÜƒv’ˆ'%s'", (*è
c
->
¬gv
[2]->
±r
);

622 
	}
}

	@src/latency.h

34 #iâdeà
__LATENCY_H


35 
	#__LATENCY_H


	)

37 
	#LATENCY_TS_LEN
 160

	)

41 
	sÏ‹ncySam¶e
 {

42 
št32_t
 
	mtime
;

43 
ušt32_t
 
	mÏ‹ncy
;

47 
	sÏ‹ncyTimeS”›s
 {

48 
	midx
;

49 
ušt32_t
 
	mmax
;

50 
Ï‹ncySam¶e
 
	m§m¶es
[
LATENCY_TS_LEN
];

54 
	sÏ‹ncySts
 {

55 
ušt32_t
 
	m®l_time_high
;

56 
ušt32_t
 
	mavg
;

57 
ušt32_t
 
	mmš
;

58 
ušt32_t
 
	mmax
;

59 
ušt32_t
 
	mmad
;

60 
ušt32_t
 
	m§m¶es
;

61 
time_t
 
	m³riod
;

64 
Ï‹ncyMÚ™ÜIn™
();

65 
Ï‹ncyAddSam¶e
(*
ev’t
, 
m¡ime_t
 
Ï‹ncy
);

66 
THPIsEÇbËd
();

71 
	#Ï‹ncyS¹MÚ™Ü
(
v¬
èià(
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
) { \

72 
v¬
 = 
	`m¡ime
(); \

74 
v¬
 = 0; \

75 }

	)

79 
	#Ï‹ncyEndMÚ™Ü
(
v¬
èià(
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
) { \

80 
v¬
 = 
	`m¡ime
() - var; \

81 }

	)

84 
	#Ï‹ncyAddSam¶eIfN“ded
(
ev’t
,
v¬
) \

85 ià(
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
 && \

86 (
v¬
è>ğ
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
) \

87 
	`Ï‹ncyAddSam¶e
((
ev’t
),(
v¬
));

	)

90 
	#Ï‹ncyRemoveNe¡edEv’t
(
ev’t_v¬
,
Ã¡ed_v¬
) \

91 
ev’t_v¬
 +ğ
Ã¡ed_v¬
;

	)

	@src/lzf.h

37 #iâdeà
LZF_H


38 
	#LZF_H


	)

49 
	#LZF_VERSION
 0x0105

	)

77 
lzf_com´ess
 (cÚ¡ *cÚ¡ 
š_d©a
, 
š_Ën
,

78 *
out_d©a
, 
out_Ën
);

96 
lzf_decom´ess
 (cÚ¡ *cÚ¡ 
š_d©a
, 
š_Ën
,

97 *
out_d©a
, 
out_Ën
);

	@src/lzfP.h

37 #iâdeà
LZFP_h


38 
	#LZFP_h


	)

40 
	#STANDALONE
 1

	)

42 #iâdeà
STANDALONE


43 
	~"lzf.h
"

54 #iâdeà
HLOG


55 
	#HLOG
 16

	)

63 #iâdeà
VERY_FAST


64 
	#VERY_FAST
 1

	)

74 #iâdeà
ULTRA_FAST


75 
	#ULTRA_FAST
 0

	)

81 #iâdeà
STRICT_ALIGN


82 
	#STRICT_ALIGN
 !(
	`defšed
(
__i386
è|| defšed (
__amd64
))

	)

90 #iâdeà
INIT_HTAB


91 
	#INIT_HTAB
 0

	)

99 #iâdeà
AVOID_ERRNO


100 
	#AVOID_ERRNO
 0

	)

108 #iâdeà
LZF_STATE_ARG


109 
	#LZF_STATE_ARG
 0

	)

120 #iâdeà
CHECK_INPUT


121 
	#CHECK_INPUT
 1

	)

134 #ifdeà
__ılu¥lus


135 
	~<c¡ršg
>

136 
	~<şim™s
>

137 
usšg
 
Çme¥aû
 
	g¡d
;

139 
	~<¡ršg.h
>

140 
	~<lim™s.h
>

143 #iâdeà
LZF_USE_OFFSETS


144 #ià
defšed
 (
WIN32
)

145 
	#LZF_USE_OFFSETS
 
	`defšed
(
_M_X64
)

	)

147 #ià
__ılu¥lus
 > 199711L

148 
	~<c¡dšt
>

150 
	~<¡dšt.h
>

152 
	#LZF_USE_OFFSETS
 (
UINTPTR_MAX
 > 0xffffffffU)

	)

156 
	tu8
;

158 #ià
LZF_USE_OFFSETS


159 
	#LZF_HSLOT_BIAS
 ((cÚ¡ 
u8
 *)
š_d©a
)

	)

160 
	tLZF_HSLOT
;

162 
	#LZF_HSLOT_BIAS
 0

	)

163 cÚ¡ 
	tu8
 *
	tLZF_HSLOT
;

166 
LZF_HSLOT
 
	tLZF_STATE
[1 << (
HLOG
)];

168 #ià!
STRICT_ALIGN


170 #ià
USHRT_MAX
 == 65535

171 
	tu16
;

172 #–ià
UINT_MAX
 == 65535

173 
	tu16
;

175 #undeà
STRICT_ALIGN


176 
	#STRICT_ALIGN
 1

	)

180 #ià
ULTRA_FAST


181 #undeà
VERY_FAST


	@src/lzf_c.c

37 
	~"lzfP.h
"

39 
	#HSIZE
 (1 << (
HLOG
))

	)

47 #iâdeà
FRST


48 
	#FRST
(
p
è((Õ[0]è<< 8è|…[1])

	)

49 
	#NEXT
(
v
,
p
è(((vè<< 8è|…[2])

	)

50 #ià
ULTRA_FAST


51 
	#IDX
(
h
è((Ğh >> (3*8 - 
HLOG
)è- h ) & (
HSIZE
 - 1))

	)

52 #–ià
VERY_FAST


53 
	#IDX
(
h
è((Ğh >> (3*8 - 
HLOG
)è- h*5è& (
HSIZE
 - 1))

	)

55 
	#IDX
(
h
è((((h ^ (h << 5)è>> (3*8 - 
HLOG
)è- h*5è& (
HSIZE
 - 1))

	)

69 
	#FRST
(
p
èÕ[0] << 5è^…[1]

	)

70 
	#NEXT
(
v
,
p
è((vè<< 5è^…[2]

	)

71 
	#IDX
(
h
è((hè& (
HSIZE
 - 1))

	)

74 
	#MAX_LIT
 (1 << 5)

	)

75 
	#MAX_OFF
 (1 << 13)

	)

76 
	#MAX_REF
 ((1 << 8è+ (1 << 3))

	)

78 #ià
__GNUC__
 >= 3

79 
	#ex³ù
(
ex´
,
v®ue
è
	`__butš_ex³ù
 (Óx´),(v®ue))

	)

80 
	#šlše
 
šlše


	)

82 
	#ex³ù
(
ex´
,
v®ue
èÓx´)

	)

83 
	#šlše
 

	)

86 
	#ex³ù_çl£
(
ex´
è
	`ex³ù
 (Óx´è!ğ0, 0)

	)

87 
	#ex³ù_Œue
(
ex´
è
	`ex³ù
 (Óx´è!ğ0, 1)

	)

99 
lzf_com´ess
 (cÚ¡ *cÚ¡ 
š_d©a
, 
š_Ën
,

100 *
out_d©a
, 
out_Ën


101 #ià
LZF_STATE_ARG


102 , 
LZF_STATE
 
hb


106 #ià!
LZF_STATE_ARG


107 
LZF_STATE
 
	ghb
;

109 cÚ¡ 
u8
 *
	g
 = (cÚ¡ u8 *)
š_d©a
;

110 
u8
 *
	gİ
 = (u8 *)
out_d©a
;

111 cÚ¡ 
u8
 *
	gš_’d
 = 

 + 
š_Ën
;

112 
u8
 *
	gout_’d
 = 
İ
 + 
out_Ën
;

113 cÚ¡ 
u8
 *
	g»f
;

122 #ià
defšed
 (
WIN32
è&& defšed (
_M_X64
)

123 
_št64
 
	goff
;

125 
	goff
;

127 
	ghv®
;

128 
	gl™
;

130 ià(!
	gš_Ën
 || !
	gout_Ën
)

133 #ià
INIT_HTAB


134 
mem£t
 (
hb
, 0,  (htab));

137 
	gl™
 = 0; 
	gİ
++;

139 
	ghv®
 = 
FRST
 (

);

140 
	g
 < 
	gš_’d
 - 2)

142 
LZF_HSLOT
 *
	gh¦Ù
;

144 
	ghv®
 = 
NEXT
 (
hv®
, 

);

145 
	gh¦Ù
 = 
hb
 + 
IDX
 (
hv®
);

146 
	g»f
 = *
h¦Ù
 + 
LZF_HSLOT_BIAS
; *
	gh¦Ù
 = 

 - LZF_HSLOT_BIAS;

149 #ià
INIT_HTAB


150 && 
	g»f
 < 
	g


152 && (
	goff
 = 

 - 
»f
 - 1è< 
MAX_OFF


153 && 
»f
 > (
u8
 *)
š_d©a


154 && 
»f
[2] =ğ

[2]

155 #ià
STRICT_ALIGN


156 && ((
»f
[1] << 8è|„ef[0]è=ğ((

[1] << 8) | ip[0])

158 && *(
u16
 *)
»f
 =ğ*(u16 *)



163 
Ën
 = 2;

164 
	gmaxËn
 = 
š_’d
 - 

 - 
Ën
;

165 
	gmaxËn
 = 
maxËn
 > 
MAX_REF
 ? MAX_REF : maxlen;

167 ià(
ex³ù_çl£
 (
İ
 + 3 + 1 >ğ
out_’d
))

168 ià(
İ
 - !
l™
 + 3 + 1 >ğ
out_’d
)

171 
	gİ
 [- 
l™
 - 1] =†it - 1;

172 
	gİ
 -ğ!
l™
;

176 ià(
ex³ù_Œue
 (
maxËn
 > 16))

178 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

179 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

180 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

181 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

183 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

184 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

185 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

186 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

188 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

189 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

190 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

191 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

193 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

194 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

195 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

196 
	gËn
++; ià(
	g»f
 [
Ën
] !ğ

 [len]) ;

200 
	gËn
++;

201 
	gËn
 < 
	gmaxËn
 && 
	g»f
[
Ën
] =ğ

[len]);

206 
	gËn
 -= 2;

207 
	g
++;

209 ià(
	gËn
 < 7)

211 *
	gİ
++ = (
off
 >> 8è+ (
Ën
 << 5);

215 *
	gİ
++ = (
off
 >> 8) + ( 7 << 5);

216 *
	gİ
++ = 
Ën
 - 7;

219 *
	gİ
++ = 
off
;

221 
	gl™
 = 0; 
	gİ
++;

223 
	g
 +ğ
Ën
 + 1;

225 ià(
ex³ù_çl£
 (

 >ğ
š_’d
 - 2))

228 #ià
ULTRA_FAST
 || 
VERY_FAST


229 --
	g
;

230 #ià
VERY_FAST
 && !
ULTRA_FAST


231 --
	g
;

233 
	ghv®
 = 
FRST
 (

);

235 
	ghv®
 = 
NEXT
 (
hv®
, 

);

236 
	ghb
[
IDX
 (
hv®
)] = 

 - 
LZF_HSLOT_BIAS
;

237 
	g
++;

239 #ià
VERY_FAST
 && !
ULTRA_FAST


240 
	ghv®
 = 
NEXT
 (
hv®
, 

);

241 
	ghb
[
IDX
 (
hv®
)] = 

 - 
LZF_HSLOT_BIAS
;

242 
	g
++;

245 
	g
 -ğ
Ën
 + 1;

249 
	ghv®
 = 
NEXT
 (
hv®
, 

);

250 
	ghb
[
IDX
 (
hv®
)] = 

 - 
LZF_HSLOT_BIAS
;

251 
	g
++;

253 
	gËn
--);

259 ià(
ex³ù_çl£
 (
İ
 >ğ
out_’d
))

262 
	gl™
++; *
	gİ
++ = *

++;

264 ià(
ex³ù_çl£
 (
l™
 =ğ
MAX_LIT
))

266 
İ
 [- 
l™
 - 1] =†it - 1;

267 
	gl™
 = 0; 
	gİ
++;

272 ià(
	gİ
 + 3 > 
	gout_’d
)

275 
	g
 < 
	gš_’d
)

277 
	gl™
++; *
	gİ
++ = *

++;

279 ià(
ex³ù_çl£
 (
l™
 =ğ
MAX_LIT
))

281 
İ
 [- 
l™
 - 1] =†it - 1;

282 
	gl™
 = 0; 
	gİ
++;

286 
	gİ
 [- 
l™
 - 1] =†it - 1;

287 
	gİ
 -ğ!
l™
;

289  
	gİ
 - (
	gu8
 *)
	gout_d©a
;

	@src/lzf_d.c

37 
	~"lzfP.h
"

39 #ià
AVOID_ERRNO


40 
	#SET_ERRNO
(
n
)

	)

42 
	~<”ºo.h
>

43 
	#SET_ERRNO
(
n
è
”ºo
 = (n)

	)

46 #ià
USE_REP_MOVSB


47 #ià(
__i386
 || 
__amd64
è&& 
__GNUC__
 >= 3

48 
	#lzf_movsb
(
d¡
, 
¤c
, 
Ën
) \

49 
	`asm
 ("rep movsb" \

50 : "=D" (
d¡
), "=S" (
¤c
), "=c" (
Ën
) \

51 : "0" (
d¡
), "1" (
¤c
), "2" (
Ën
));

	)

56 
	$lzf_decom´ess
 (cÚ¡ *cÚ¡ 
š_d©a
, 
š_Ën
,

57 *
out_d©a
, 
out_Ën
)

59 
u8
 cÚ¡ *

 = (cÚ¡ u8 *)
š_d©a
;

60 
u8
 *
İ
 = (u8 *)
out_d©a
;

61 
u8
 cÚ¡ *cÚ¡ 
š_’d
 = 

 + 
š_Ën
;

62 
u8
 *cÚ¡ 
out_’d
 = 
İ
 + 
out_Ën
;

66 
ù¾
 = *

++;

68 ià(
ù¾
 < (1 << 5))

70 
ù¾
++;

72 ià(
İ
 + 
ù¾
 > 
out_’d
)

74 
	`SET_ERRNO
 (
E2BIG
);

78 #ià
CHECK_INPUT


79 ià(

 + 
ù¾
 > 
š_’d
)

81 
	`SET_ERRNO
 (
EINVAL
);

86 #ifdeà
lzf_movsb


87 
	`lzf_movsb
 (
İ
, 

, 
ù¾
);

89 
ù¾
)

91 32: *
İ
++ = *

++; 31: *op++ = *ip++; 30: *op++ = *ip++; 29: *op++ = *ip++;

92 28: *
İ
++ = *

++; 27: *op++ = *ip++; 26: *op++ = *ip++; 25: *op++ = *ip++;

93 24: *
İ
++ = *

++; 23: *op++ = *ip++; 22: *op++ = *ip++; 21: *op++ = *ip++;

94 20: *
İ
++ = *

++; 19: *op++ = *ip++; 18: *op++ = *ip++; 17: *op++ = *ip++;

95 16: *
İ
++ = *

++; 15: *op++ = *ip++; 14: *op++ = *ip++; 13: *op++ = *ip++;

96 12: *
İ
++ = *

++; 11: *op++ = *ip++; 10: *op++ = *ip++; 9: *op++ = *ip++;

97 8: *
İ
++ = *

++; 7: *op++ = *ip++; 6: *op++ = *ip++; 5: *op++ = *ip++;

98 4: *
İ
++ = *

++; 3: *op++ = *ip++; 2: *op++ = *ip++; 1: *op++ = *ip++;

104 
Ën
 = 
ù¾
 >> 5;

106 
u8
 *
»f
 = 
İ
 - ((
ù¾
 & 0x1f) << 8) - 1;

108 #ià
CHECK_INPUT


109 ià(

 >ğ
š_’d
)

111 
	`SET_ERRNO
 (
EINVAL
);

115 ià(
Ën
 == 7)

117 
Ën
 +ğ*

++;

118 #ià
CHECK_INPUT


119 ià(

 >ğ
š_’d
)

121 
	`SET_ERRNO
 (
EINVAL
);

127 
»f
 -ğ*

++;

129 ià(
İ
 + 
Ën
 + 2 > 
out_’d
)

131 
	`SET_ERRNO
 (
E2BIG
);

135 ià(
»f
 < (
u8
 *)
out_d©a
)

137 
	`SET_ERRNO
 (
EINVAL
);

141 #ifdeà
lzf_movsb


142 
Ën
 += 2;

143 
	`lzf_movsb
 (
İ
, 
»f
, 
Ën
);

145 
Ën
)

148 
Ën
 += 2;

150 ià(
İ
 >ğ
»f
 + 
Ën
)

153 
	`memıy
 (
İ
, 
»f
, 
Ën
);

154 
İ
 +ğ
Ën
;

160 *
İ
++ = *
»f
++;

161 --
Ën
);

166 9: *
İ
++ = *
»f
++;

167 8: *
İ
++ = *
»f
++;

168 7: *
İ
++ = *
»f
++;

169 6: *
İ
++ = *
»f
++;

170 5: *
İ
++ = *
»f
++;

171 4: *
İ
++ = *
»f
++;

172 3: *
İ
++ = *
»f
++;

173 2: *
İ
++ = *
»f
++;

174 1: *
İ
++ = *
»f
++;

175 0: *
İ
++ = *
»f
++;

176 *
İ
++ = *
»f
++;

181 

 < 
š_’d
);

183  
İ
 - (
u8
 *)
out_d©a
;

184 
	}
}

	@src/memtest.c

29 
	~<¡dšt.h
>

30 
	~<¡dlib.h
>

31 
	~<¡dio.h
>

32 
	~<¡ršg.h
>

33 
	~<as£¹.h
>

34 
	~<lim™s.h
>

35 
	~<”ºo.h
>

36 
	~<‹rmios.h
>

37 
	~<sys/ioùl.h
>

38 #ià
defšed
(
__sun
)

39 
	~<¡rİts.h
>

41 
	~"cÚfig.h
"

43 #ià(
ULONG_MAX
 == 4294967295UL)

44 
	#MEMTEST_32BIT


	)

45 #–ià(
ULONG_MAX
 == 18446744073709551615ULL)

46 
	#MEMTEST_64BIT


	)

51 #ifdeà
MEMTEST_32BIT


52 
	#ULONG_ONEZERO
 0x¯¯¯¯UL

	)

53 
	#ULONG_ZEROONE
 0x55555555UL

	)

55 
	#ULONG_ONEZERO
 0x¯¯¯¯¯¯¯¯UL

	)

56 
	#ULONG_ZEROONE
 0x5555555555555555UL

	)

59 
wšsize
 
	gws
;

60 
size_t
 
	g´og»ss_´š‹d
;

61 
size_t
 
	g´og»ss_fuÎ
;

63 
	$mem‹¡_´og»ss_¡¬t
(*
t™Ë
, 
·ss
) {

64 
j
;

66 
	`´štf
("\x1b[H\x1b[2J");

68 
j
 = 0; j < 
ws
.
ws_cŞ
*(ws.
ws_row
-2); j++è
	`´štf
(".");

69 
	`´štf
("Please keepheest„unning several minutes…er GB of memory.\n");

70 
	`´štf
("Also check http://www.memtest86.com/‡nd http://pyropus.ca/software/memtester/");

71 
	`´štf
("\x1b[H\x1b[2K");

72 
	`´štf
("% [%d]\n", 
t™Ë
, 
·ss
);

73 
´og»ss_´š‹d
 = 0;

74 
´og»ss_fuÎ
 = 
ws
.
ws_cŞ
*(ws.
ws_row
-3);

75 
	`fæush
(
¡dout
);

76 
	}
}

78 
	$mem‹¡_´og»ss_’d
() {

79 
	`´štf
("\x1b[H\x1b[2J");

80 
	}
}

82 
	$mem‹¡_´og»ss_¡•
(
size_t
 
cu¼
, size_ˆ
size
, 
c
) {

83 
size_t
 
ch¬s
 = (()
cu¼
*
´og»ss_fuÎ
)/
size
, 
j
;

85 
j
 = 0; j < 
ch¬s
-
´og»ss_´š‹d
; j++è
	`´štf
("%c",
c
);

86 
´og»ss_´š‹d
 = 
ch¬s
;

87 
	`fæush
(
¡dout
);

88 
	}
}

93 
	$mem‹¡_add»ssšg
(*
l
, 
size_t
 
by‹s
, 
š‹¿ùive
) {

94 
wÜds
 = 
by‹s
/();

95 
j
, *
p
;

98 
p
 = 
l
;

99 
j
 = 0; j < 
wÜds
; j++) {

100 *
p
 = ()p;

101 
p
++;

102 ià((
j
 & 0xffffè=ğ0 && 
š‹¿ùive
)

103 
	`mem‹¡_´og»ss_¡•
(
j
,
wÜds
*2,'A');

106 
p
 = 
l
;

107 
j
 = 0; j < 
wÜds
; j++) {

108 ià(*
p
 != ()p) {

109 ià(
š‹¿ùive
) {

110 
	`´štf
("\n*** MEMORY ADDRESSING ERROR: %p contains %lu\n",

111 (*è
p
, *p);

112 
	`ex™
(1);

116 
p
++;

117 ià((
j
 & 0xffffè=ğ0 && 
š‹¿ùive
)

118 
	`mem‹¡_´og»ss_¡•
(
j
+
wÜds
,words*2,'A');

121 
	}
}

131 
	#xÜshiá64¡¬_Ãxt
() do { \

132 
r£ed
 ^=„seed >> 12; \

133 
r£ed
 ^=„seed << 25; \

134 
r£ed
 ^=„seed >> 27; \

135 
rout
 = 
r£ed
 * 
	`UINT64_C
(2685821657736338717); \

136 } 0)

	)

138 
	$mem‹¡_fl_¿ndom
(*
l
, 
size_t
 
by‹s
, 
š‹¿ùive
) {

139 
¡•
 = 4096/();

140 
wÜds
 = 
by‹s
/()/2;

141 
iwÜds
 = 
wÜds
/
¡•
;

142 
off
, 
w
, *
l1
, *
l2
;

143 
ušt64_t
 
r£ed
 = 
	`UINT64_C
(0xd13133de9afdb566);

144 
ušt64_t
 
rout
 = 0;

146 
	`as£¹
((
by‹s
 & 4095) == 0);

147 
off
 = 0; ofà< 
¡•
; off++) {

148 
l1
 = 
l
+
off
;

149 
l2
 = 
l1
+
wÜds
;

150 
w
 = 0; w < 
iwÜds
; w++) {

151 
	`xÜshiá64¡¬_Ãxt
();

152 *
l1
 = *
l2
 = (è
rout
;

153 
l1
 +ğ
¡•
;

154 
l2
 +ğ
¡•
;

155 ià((
w
 & 0xffffè=ğ0 && 
š‹¿ùive
)

156 
	`mem‹¡_´og»ss_¡•
(
w
+
iwÜds
*
off
,
wÜds
,'R');

159 
	}
}

163 
	$mem‹¡_fl_v®ue
(*
l
, 
size_t
 
by‹s
, 
v1
,

164 
v2
, 
sym
, 
š‹¿ùive
)

166 
¡•
 = 4096/();

167 
wÜds
 = 
by‹s
/()/2;

168 
iwÜds
 = 
wÜds
/
¡•
;

169 
off
, 
w
, *
l1
, *
l2
, 
v
;

171 
	`as£¹
((
by‹s
 & 4095) == 0);

172 
off
 = 0; ofà< 
¡•
; off++) {

173 
l1
 = 
l
+
off
;

174 
l2
 = 
l1
+
wÜds
;

175 
v
 = (
off
 & 1è? 
v2
 : 
v1
;

176 
w
 = 0; w < 
iwÜds
; w++) {

177 #ifdeà
MEMTEST_32BIT


178 *
l1
 = *
l2
 = ((è
v
) |

179 (((è
v
) << 16);

181 *
l1
 = *
l2
 = ((è
v
) |

182 (((è
v
) << 16) |

183 (((è
v
) << 32) |

184 (((è
v
) << 48);

186 
l1
 +ğ
¡•
;

187 
l2
 +ğ
¡•
;

188 ià((
w
 & 0xffffè=ğ0 && 
š‹¿ùive
)

189 
	`mem‹¡_´og»ss_¡•
(
w
+
iwÜds
*
off
,
wÜds
,
sym
);

192 
	}
}

194 
	$mem‹¡_com·»
(*
l
, 
size_t
 
by‹s
, 
š‹¿ùive
) {

195 
wÜds
 = 
by‹s
/()/2;

196 
w
, *
l1
, *
l2
;

198 
	`as£¹
((
by‹s
 & 4095) == 0);

199 
l1
 = 
l
;

200 
l2
 = 
l1
+
wÜds
;

201 
w
 = 0; w < 
wÜds
; w++) {

202 ià(*
l1
 !ğ*
l2
) {

203 ià(
š‹¿ùive
) {

204 
	`´štf
("\n*** MEMORY ERROR DETECTED: %p != %p (%lu vs %lu)\n",

205 (*)
l1
, (*)
l2
, *l1, *l2);

206 
	`ex™
(1);

210 
l1
 ++;

211 
l2
 ++;

212 ià((
w
 & 0xffffè=ğ0 && 
š‹¿ùive
)

213 
	`mem‹¡_´og»ss_¡•
(
w
,
wÜds
,'=');

216 
	}
}

218 
	$mem‹¡_com·»_times
(*
m
, 
size_t
 
by‹s
, 
·ss
, 
times
,

219 
š‹¿ùive
)

221 
j
;

222 
”rÜs
 = 0;

224 
j
 = 0; j < 
times
; j++) {

225 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_¡¬t
("Com·»",
·ss
);

226 
”rÜs
 +ğ
	`mem‹¡_com·»
(
m
,
by‹s
,
š‹¿ùive
);

227 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_’d
();

229  
”rÜs
;

230 
	}
}

237 
	$mem‹¡_‹¡
(*
m
, 
size_t
 
by‹s
, 
·s£s
, 
š‹¿ùive
) {

238 
·ss
 = 0;

239 
”rÜs
 = 0;

241 
·ss
 !ğ
·s£s
) {

242 
·ss
++;

244 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_¡¬t
("Add»ssšge¡",
·ss
);

245 
”rÜs
 +ğ
	`mem‹¡_add»ssšg
(
m
,
by‹s
,
š‹¿ùive
);

246 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_’d
();

248 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_¡¬t
("Rªdom fl",
·ss
);

249 
	`mem‹¡_fl_¿ndom
(
m
,
by‹s
,
š‹¿ùive
);

250 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_’d
();

251 
”rÜs
 +ğ
	`mem‹¡_com·»_times
(
m
,
by‹s
,
·ss
,4,
š‹¿ùive
);

253 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_¡¬t
("SŞid fl",
·ss
);

254 
	`mem‹¡_fl_v®ue
(
m
,
by‹s
,0,()-1,'S',
š‹¿ùive
);

255 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_’d
();

256 
”rÜs
 +ğ
	`mem‹¡_com·»_times
(
m
,
by‹s
,
·ss
,4,
š‹¿ùive
);

258 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_¡¬t
("Check”bßrd fl",
·ss
);

259 
	`mem‹¡_fl_v®ue
(
m
,
by‹s
,
ULONG_ONEZERO
,
ULONG_ZEROONE
,'C',
š‹¿ùive
);

260 ià(
š‹¿ùive
è
	`mem‹¡_´og»ss_’d
();

261 
”rÜs
 +ğ
	`mem‹¡_com·»_times
(
m
,
by‹s
,
·ss
,4,
š‹¿ùive
);

263  
”rÜs
;

264 
	}
}

275 
	#MEMTEST_BACKUP_WORDS
 (1024*(1024/()))

	)

279 
	#MEMTEST_DECACHE_SIZE
 (1024*8)

	)

280 
	$mem‹¡_´e£rvšg_‹¡
(*
m
, 
size_t
 
by‹s
, 
·s£s
) {

281 
backup
[
MEMTEST_BACKUP_WORDS
];

282 *
p
 = 
m
;

283 *
’d
 = (*è(((*)
m
)+(
by‹s
-
MEMTEST_DECACHE_SIZE
));

284 
size_t
 
Ëá
 = 
by‹s
;

285 
”rÜs
 = 0;

287 ià(
by‹s
 & 4095)  0;

288 ià(
by‹s
 < 4096*2)  0;

290 
Ëá
) {

294 ià(
Ëá
 == 4096) {

295 
Ëá
 += 4096;

296 
p
 -= 4096/();

299 
·ss
 = 0;

300 
size_t
 
Ën
 = (
Ëá
 > (
backup
)) ? (backup) :†eft;

303 ià(
Ën
/4096 % 2)†en -= 4096;

305 
	`memıy
(
backup
,
p
,
Ën
);

306 
·ss
 !ğ
·s£s
) {

307 
·ss
++;

308 
”rÜs
 +ğ
	`mem‹¡_add»ssšg
(
p
,
Ën
,0);

309 
	`mem‹¡_fl_¿ndom
(
p
,
Ën
,0);

310 ià(
by‹s
 >ğ
MEMTEST_DECACHE_SIZE
) {

311 
	`mem‹¡_com·»_times
(
m
,
MEMTEST_DECACHE_SIZE
,
·ss
,1,0);

312 
	`mem‹¡_com·»_times
(
’d
,
MEMTEST_DECACHE_SIZE
,
·ss
,1,0);

314 
”rÜs
 +ğ
	`mem‹¡_com·»_times
(
p
,
Ën
,
·ss
,4,0);

315 
	`mem‹¡_fl_v®ue
(
p
,
Ën
,0,()-1,'S',0);

316 ià(
by‹s
 >ğ
MEMTEST_DECACHE_SIZE
) {

317 
	`mem‹¡_com·»_times
(
m
,
MEMTEST_DECACHE_SIZE
,
·ss
,1,0);

318 
	`mem‹¡_com·»_times
(
’d
,
MEMTEST_DECACHE_SIZE
,
·ss
,1,0);

320 
”rÜs
 +ğ
	`mem‹¡_com·»_times
(
p
,
Ën
,
·ss
,4,0);

321 
	`mem‹¡_fl_v®ue
(
p
,
Ën
,
ULONG_ONEZERO
,
ULONG_ZEROONE
,'C',0);

322 ià(
by‹s
 >ğ
MEMTEST_DECACHE_SIZE
) {

323 
	`mem‹¡_com·»_times
(
m
,
MEMTEST_DECACHE_SIZE
,
·ss
,1,0);

324 
	`mem‹¡_com·»_times
(
’d
,
MEMTEST_DECACHE_SIZE
,
·ss
,1,0);

326 
”rÜs
 +ğ
	`mem‹¡_com·»_times
(
p
,
Ën
,
·ss
,4,0);

328 
	`memıy
(
p
,
backup
,
Ën
);

329 
Ëá
 -ğ
Ën
;

330 
p
 +ğ
Ën
/();

332  
”rÜs
;

333 
	}
}

336 
	$mem‹¡_®loc_ªd_‹¡
(
size_t
 
megaby‹s
, 
·s£s
) {

337 
size_t
 
by‹s
 = 
megaby‹s
*1024*1024;

338 *
m
 = 
	`m®loc
(
by‹s
);

340 ià(
m
 =ğ
NULL
) {

341 
	`årštf
(
¡d”r
,"Unableo‡llocate %zu megabytes: %s",

342 
megaby‹s
, 
	`¡»¼Ü
(
”ºo
));

343 
	`ex™
(1);

345 
	`mem‹¡_‹¡
(
m
,
by‹s
,
·s£s
,1);

346 
	`ä“
(
m
);

347 
	}
}

349 
	$mem‹¡
(
size_t
 
megaby‹s
, 
·s£s
) {

350 ià(
	`ioùl
(1, 
TIOCGWINSZ
, &
ws
) == -1) {

351 
ws
.
ws_cŞ
 = 80;

352 
ws
.
ws_row
 = 20;

354 
	`mem‹¡_®loc_ªd_‹¡
(
megaby‹s
,
·s£s
);

355 
	`´štf
("\nYour memory…assedhisest.\n");

356 
	`´štf
("Please if you‡re still in doubt usehe followingwoools:\n");

357 
	`´štf
("1) memtest86: http://www.memtest86.com/\n");

358 
	`´štf
("2) memtester: http://pyropus.ca/software/memtester/\n");

359 
	`ex™
(0);

360 
	}
}

	@src/multi.c

30 
	~"£rv”.h
"

35 
	$š™Cl›ÁMuÉiS‹
(
ş›Á
 *
c
) {

36 
c
->
m¡©e
.
commªds
 = 
NULL
;

37 
c
->
m¡©e
.
couÁ
 = 0;

38 
	}
}

41 
	$ä“Cl›ÁMuÉiS‹
(
ş›Á
 *
c
) {

42 
j
;

44 
j
 = 0; j < 
c
->
m¡©e
.
couÁ
; j++) {

45 
i
;

46 
muÉiCmd
 *
mc
 = 
c
->
m¡©e
.
commªds
+
j
;

48 
i
 = 0; i < 
mc
->
¬gc
; i++)

49 
	`deüRefCouÁ
(
mc
->
¬gv
[
i
]);

50 
	`zä“
(
mc
->
¬gv
);

52 
	`zä“
(
c
->
m¡©e
.
commªds
);

53 
	}
}

56 
	$queueMuÉiCommªd
(
ş›Á
 *
c
) {

57 
muÉiCmd
 *
mc
;

58 
j
;

60 
c
->
m¡©e
.
commªds
 = 
	`z»®loc
(c->mstate.commands,

61 (
muÉiCmd
)*(
c
->
m¡©e
.
couÁ
+1));

62 
mc
 = 
c
->
m¡©e
.
commªds
+c->m¡©e.
couÁ
;

63 
mc
->
cmd
 = 
c
->cmd;

64 
mc
->
¬gc
 = 
c
->argc;

65 
mc
->
¬gv
 = 
	`zm®loc
((
robj
*)*
c
->
¬gc
);

66 
	`memıy
(
mc
->
¬gv
,
c
->¬gv,(
robj
*)*c->
¬gc
);

67 
j
 = 0; j < 
c
->
¬gc
; j++)

68 
	`šüRefCouÁ
(
mc
->
¬gv
[
j
]);

69 
c
->
m¡©e
.
couÁ
++;

70 
	}
}

72 
	$disÿrdT¿n§ùiÚ
(
ş›Á
 *
c
) {

73 
	`ä“Cl›ÁMuÉiS‹
(
c
);

74 
	`š™Cl›ÁMuÉiS‹
(
c
);

75 
c
->
æags
 &ğ~(
CLIENT_MULTI
|
CLIENT_DIRTY_CAS
|
CLIENT_DIRTY_EXEC
);

76 
	`unw©chAÎKeys
(
c
);

77 
	}
}

81 
	$æagT¿n§ùiÚ
(
ş›Á
 *
c
) {

82 ià(
c
->
æags
 & 
CLIENT_MULTI
)

83 
c
->
æags
 |ğ
CLIENT_DIRTY_EXEC
;

84 
	}
}

86 
	$muÉiCommªd
(
ş›Á
 *
c
) {

87 ià(
c
->
æags
 & 
CLIENT_MULTI
) {

88 
	`addR•lyE¼Ü
(
c
,"MULTI calls can‚ot be‚ested");

91 
c
->
æags
 |ğ
CLIENT_MULTI
;

92 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

93 
	}
}

95 
	$disÿrdCommªd
(
ş›Á
 *
c
) {

96 ià(!(
c
->
æags
 & 
CLIENT_MULTI
)) {

97 
	`addR•lyE¼Ü
(
c
,"DISCARD without MULTI");

100 
	`disÿrdT¿n§ùiÚ
(
c
);

101 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

102 
	}
}

106 
	$execCommªdPrİag©eMuÉi
(
ş›Á
 *
c
) {

107 
robj
 *
muÉi¡ršg
 = 
	`ü—‹SŒšgObjeù
("MULTI",5);

109 
	`´İag©e
(
£rv”
.
muÉiCommªd
,
c
->
db
->
id
,&
muÉi¡ršg
,1,

110 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

111 
	`deüRefCouÁ
(
muÉi¡ršg
);

112 
	}
}

114 
	$execCommªd
(
ş›Á
 *
c
) {

115 
j
;

116 
robj
 **
Üig_¬gv
;

117 
Üig_¬gc
;

118 
»disCommªd
 *
Üig_cmd
;

119 
mu¡_´İag©e
 = 0;

121 ià(!(
c
->
æags
 & 
CLIENT_MULTI
)) {

122 
	`addR•lyE¼Ü
(
c
,"EXEC without MULTI");

132 ià(
c
->
æags
 & (
CLIENT_DIRTY_CAS
|
CLIENT_DIRTY_EXEC
)) {

133 
	`addR•ly
(
c
, c->
æags
 & 
CLIENT_DIRTY_EXEC
 ? 
sh¬ed
.
exeÿbÜ‹¼
 :

134 
sh¬ed
.
nuÎmuÉibulk
);

135 
	`disÿrdT¿n§ùiÚ
(
c
);

136 
hªdË_mÚ™Ü
;

140 
	`unw©chAÎKeys
(
c
);

141 
Üig_¬gv
 = 
c
->
¬gv
;

142 
Üig_¬gc
 = 
c
->
¬gc
;

143 
Üig_cmd
 = 
c
->
cmd
;

144 
	`addR•lyMuÉiBulkL’
(
c
,c->
m¡©e
.
couÁ
);

145 
j
 = 0; j < 
c
->
m¡©e
.
couÁ
; j++) {

146 
c
->
¬gc
 = c->
m¡©e
.
commªds
[
j
].argc;

147 
c
->
¬gv
 = c->
m¡©e
.
commªds
[
j
].argv;

148 
c
->
cmd
 = c->
m¡©e
.
commªds
[
j
].cmd;

154 ià(!
mu¡_´İag©e
 && !(
c
->
cmd
->
æags
 & 
CMD_READONLY
)) {

155 
	`execCommªdPrİag©eMuÉi
(
c
);

156 
mu¡_´İag©e
 = 1;

159 
	`ÿÎ
(
c
,
CMD_CALL_FULL
);

162 
c
->
m¡©e
.
commªds
[
j
].
¬gc
 = c->argc;

163 
c
->
m¡©e
.
commªds
[
j
].
¬gv
 = c->argv;

164 
c
->
m¡©e
.
commªds
[
j
].
cmd
 = c->cmd;

166 
c
->
¬gv
 = 
Üig_¬gv
;

167 
c
->
¬gc
 = 
Üig_¬gc
;

168 
c
->
cmd
 = 
Üig_cmd
;

169 
	`disÿrdT¿n§ùiÚ
(
c
);

172 ià(
mu¡_´İag©e
è
£rv”
.
dœty
++;

174 
hªdË_mÚ™Ü
:

180 ià(
	`li¡L’gth
(
£rv”
.
mÚ™Üs
è&& !£rv”.
lßdšg
)

181 
	`»¶iÿtiÚF“dMÚ™Üs
(
c
,
£rv”
.
mÚ™Üs
,c->
db
->
id
,c->
¬gv
,c->
¬gc
);

182 
	}
}

196 
	sw©chedKey
 {

197 
robj
 *
	mkey
;

198 
»disDb
 *
	mdb
;

199 } 
	tw©chedKey
;

202 
	$w©chFÜKey
(
ş›Á
 *
c
, 
robj
 *
key
) {

203 
li¡
 *
ş›Ás
 = 
NULL
;

204 
li¡I‹r
 
li
;

205 
li¡Node
 *
Ê
;

206 
w©chedKey
 *
wk
;

209 
	`li¡Rewšd
(
c
->
w©ched_keys
,&
li
);

210 (
Ê
 = 
	`li¡Next
(&
li
))) {

211 
wk
 = 
	`li¡NodeV®ue
(
Ê
);

212 ià(
wk
->
db
 =ğ
c
->db && 
	`equ®SŒšgObjeùs
(
key
,wk->key))

216 
ş›Ás
 = 
	`diùF‘chV®ue
(
c
->
db
->
w©ched_keys
,
key
);

217 ià(!
ş›Ás
) {

218 
ş›Ás
 = 
	`li¡C»©e
();

219 
	`diùAdd
(
c
->
db
->
w©ched_keys
,
key
,
ş›Ás
);

220 
	`šüRefCouÁ
(
key
);

222 
	`li¡AddNodeTa
(
ş›Ás
,
c
);

224 
wk
 = 
	`zm®loc
((*wk));

225 
wk
->
key
 = key;

226 
wk
->
db
 = 
c
->db;

227 
	`šüRefCouÁ
(
key
);

228 
	`li¡AddNodeTa
(
c
->
w©ched_keys
,
wk
);

229 
	}
}

233 
	$unw©chAÎKeys
(
ş›Á
 *
c
) {

234 
li¡I‹r
 
li
;

235 
li¡Node
 *
Ê
;

237 ià(
	`li¡L’gth
(
c
->
w©ched_keys
) == 0) ;

238 
	`li¡Rewšd
(
c
->
w©ched_keys
,&
li
);

239 (
Ê
 = 
	`li¡Next
(&
li
))) {

240 
li¡
 *
ş›Ás
;

241 
w©chedKey
 *
wk
;

245 
wk
 = 
	`li¡NodeV®ue
(
Ê
);

246 
ş›Ás
 = 
	`diùF‘chV®ue
(
wk
->
db
->
w©ched_keys
, wk->
key
);

247 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
ş›Ás
 != NULL);

248 
	`li¡D–Node
(
ş›Ás
,
	`li¡S—rchKey
(ş›Ás,
c
));

250 ià(
	`li¡L’gth
(
ş›Ás
) == 0)

251 
	`diùD–‘e
(
wk
->
db
->
w©ched_keys
, wk->
key
);

253 
	`li¡D–Node
(
c
->
w©ched_keys
,
Ê
);

254 
	`deüRefCouÁ
(
wk
->
key
);

255 
	`zä“
(
wk
);

257 
	}
}

261 
	$touchW©chedKey
(
»disDb
 *
db
, 
robj
 *
key
) {

262 
li¡
 *
ş›Ás
;

263 
li¡I‹r
 
li
;

264 
li¡Node
 *
Ê
;

266 ià(
	`diùSize
(
db
->
w©ched_keys
) == 0) ;

267 
ş›Ás
 = 
	`diùF‘chV®ue
(
db
->
w©ched_keys
, 
key
);

268 ià(!
ş›Ás
) ;

272 
	`li¡Rewšd
(
ş›Ás
,&
li
);

273 (
Ê
 = 
	`li¡Next
(&
li
))) {

274 
ş›Á
 *
c
 = 
	`li¡NodeV®ue
(
Ê
);

276 
c
->
æags
 |ğ
CLIENT_DIRTY_CAS
;

278 
	}
}

284 
	$touchW©chedKeysOnFlush
(
dbid
) {

285 
li¡I‹r
 
li1
, 
li2
;

286 
li¡Node
 *
Ê
;

289 
	`li¡Rewšd
(
£rv”
.
ş›Ás
,&
li1
);

290 (
Ê
 = 
	`li¡Next
(&
li1
))) {

291 
ş›Á
 *
c
 = 
	`li¡NodeV®ue
(
Ê
);

292 
	`li¡Rewšd
(
c
->
w©ched_keys
,&
li2
);

293 (
Ê
 = 
	`li¡Next
(&
li2
))) {

294 
w©chedKey
 *
wk
 = 
	`li¡NodeV®ue
(
Ê
);

299 ià(
dbid
 =ğ-1 || 
wk
->
db
->
id
 == dbid) {

300 ià(
	`diùFšd
(
wk
->
db
->
diù
, wk->
key
->
±r
è!ğ
NULL
)

301 
c
->
æags
 |ğ
CLIENT_DIRTY_CAS
;

305 
	}
}

307 
	$w©chCommªd
(
ş›Á
 *
c
) {

308 
j
;

310 ià(
c
->
æags
 & 
CLIENT_MULTI
) {

311 
	`addR•lyE¼Ü
(
c
,"WATCH inside MULTI is‚ot‡llowed");

314 
j
 = 1; j < 
c
->
¬gc
; j++)

315 
	`w©chFÜKey
(
c
,c->
¬gv
[
j
]);

316 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

317 
	}
}

319 
	$unw©chCommªd
(
ş›Á
 *
c
) {

320 
	`unw©chAÎKeys
(
c
);

321 
c
->
æags
 &ğ(~
CLIENT_DIRTY_CAS
);

322 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

323 
	}
}

	@src/networking.c

30 
	~"£rv”.h
"

31 
	~<sys/uio.h
>

32 
	~<m©h.h
>

34 
£tPrÙocŞE¼Ü
(
ş›Á
 *
c
, 
pos
);

39 
size_t
 
	$sdsZm®locSize
(
sds
 
s
) {

40 *
sh
 = 
	`sdsAÎocPŒ
(
s
);

41  
	`zm®loc_size
(
sh
);

42 
	}
}

46 
size_t
 
	$g‘SŒšgObjeùSdsU£dMemÜy
(
robj
 *
o
) {

47 
	`£rv”As£¹W™hInfo
(
NULL
,
o
,o->
ty³
 =ğ
OBJ_STRING
);

48 
o
->
’codšg
) {

49 
OBJ_ENCODING_RAW
:  
	`sdsZm®locSize
(
o
->
±r
);

50 
OBJ_ENCODING_EMBSTR
:  
	`zm®loc_size
(
o
)-(
robj
);

53 
	}
}

55 *
	$dupCl›ÁR•lyV®ue
(*
o
) {

56 
	`šüRefCouÁ
((
robj
*)
o
);

57  
o
;

58 
	}
}

60 
	$li¡M©chObjeùs
(*
a
, *
b
) {

61  
	`equ®SŒšgObjeùs
(
a
,
b
);

62 
	}
}

64 
ş›Á
 *
	$ü—‹Cl›Á
(
fd
) {

65 
ş›Á
 *
c
 = 
	`zm®loc
((client));

71 ià(
fd
 != -1) {

72 
	`ª‘NÚBlock
(
NULL
,
fd
);

73 
	`ª‘EÇbËTıNoD–ay
(
NULL
,
fd
);

74 ià(
£rv”
.
tık“·live
)

75 
	`ª‘K“pAlive
(
NULL
,
fd
,
£rv”
.
tık“·live
);

76 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
,
fd
,
AE_READABLE
,

77 
»adQu”yFromCl›Á
, 
c
è=ğ
AE_ERR
)

79 
	`şo£
(
fd
);

80 
	`zä“
(
c
);

81  
NULL
;

85 
	`£ËùDb
(
c
,0);

86 
c
->
id
 = 
£rv”
.
Ãxt_ş›Á_id
++;

87 
c
->
fd
 = fd;

88 
c
->
Çme
 = 
NULL
;

89 
c
->
buåos
 = 0;

90 
c
->
qu”ybuf
 = 
	`sd£m±y
();

91 
c
->
qu”ybuf_³ak
 = 0;

92 
c
->
»qty³
 = 0;

93 
c
->
¬gc
 = 0;

94 
c
->
¬gv
 = 
NULL
;

95 
c
->
cmd
 = c->
Ï¡cmd
 = 
NULL
;

96 
c
->
muÉibulkËn
 = 0;

97 
c
->
bulkËn
 = -1;

98 
c
->
£ÁËn
 = 0;

99 
c
->
æags
 = 0;

100 
c
->
ùime
 = c->
Ï¡š‹¿ùiÚ
 = 
£rv”
.
unixtime
;

101 
c
->
auth’tiÿ‹d
 = 0;

102 
c
->
»¶¡©e
 = 
REPL_STATE_NONE
;

103 
c
->
»¶_put_Úlše_Ú_ack
 = 0;

104 
c
->
»¶off
 = 0;

105 
c
->
»¶_ack_off
 = 0;

106 
c
->
»¶_ack_time
 = 0;

107 
c
->
¦ave_li¡’šg_pÜt
 = 0;

108 
c
->
¦ave_
[0] = '\0';

109 
c
->
¦ave_ÿ·
 = 
SLAVE_CAPA_NONE
;

110 
c
->
»¶y
 = 
	`li¡C»©e
();

111 
c
->
»¶y_by‹s
 = 0;

112 
c
->
obuf_soá_lim™_»ached_time
 = 0;

113 
	`li¡S‘F»eM‘hod
(
c
->
»¶y
,
deüRefCouÁVoid
);

114 
	`li¡S‘DupM‘hod
(
c
->
»¶y
,
dupCl›ÁR•lyV®ue
);

115 
c
->
bty³
 = 
BLOCKED_NONE
;

116 
c
->
bpİ
.
timeout
 = 0;

117 
c
->
bpİ
.
keys
 = 
	`diùC»©e
(&
£tDiùTy³
,
NULL
);

118 
c
->
bpİ
.
rg‘
 = 
NULL
;

119 
c
->
bpİ
.
num»¶iÿs
 = 0;

120 
c
->
bpİ
.
»¶off£t
 = 0;

121 
c
->
woff
 = 0;

122 
c
->
w©ched_keys
 = 
	`li¡C»©e
();

123 
c
->
pubsub_chªÃls
 = 
	`diùC»©e
(&
£tDiùTy³
,
NULL
);

124 
c
->
pubsub_·‰”ns
 = 
	`li¡C»©e
();

125 
c
->
³”id
 = 
NULL
;

126 
	`li¡S‘F»eM‘hod
(
c
->
pubsub_·‰”ns
,
deüRefCouÁVoid
);

127 
	`li¡S‘M©chM‘hod
(
c
->
pubsub_·‰”ns
,
li¡M©chObjeùs
);

128 ià(
fd
 !ğ-1è
	`li¡AddNodeTa
(
£rv”
.
ş›Ás
,
c
);

129 
	`š™Cl›ÁMuÉiS‹
(
c
);

130  
c
;

131 
	}
}

155 
	$´•¬eCl›ÁToWr™e
(
ş›Á
 *
c
) {

158 ià(
c
->
æags
 & 
CLIENT_LUA
è 
C_OK
;

161 ià(
c
->
æags
 & (
CLIENT_REPLY_OFF
|
CLIENT_REPLY_SKIP
)è 
C_ERR
;

165 ià((
c
->
æags
 & 
CLIENT_MASTER
) &&

166 !(
c
->
æags
 & 
CLIENT_MASTER_FORCE_REPLY
)è 
C_ERR
;

168 ià(
c
->
fd
 <ğ0è 
C_ERR
;

174 ià(!
	`ş›ÁHasP’dšgR•l›s
(
c
) &&

175 !(
c
->
æags
 & 
CLIENT_PENDING_WRITE
) &&

176 (
c
->
»¶¡©e
 =ğ
REPL_STATE_NONE
 ||

177 (
c
->
»¶¡©e
 =ğ
SLAVE_STATE_ONLINE
 && !c->
»¶_put_Úlše_Ú_ack
)))

185 
c
->
æags
 |ğ
CLIENT_PENDING_WRITE
;

186 
	`li¡AddNodeH—d
(
£rv”
.
ş›Ás_³ndšg_wr™e
,
c
);

190  
C_OK
;

191 
	}
}

195 
robj
 *
	$dupLa¡ObjeùIfN“ded
(
li¡
 *
»¶y
) {

196 
robj
 *
Ãw
, *
cur
;

197 
li¡Node
 *
Ê
;

198 
	`£rv”As£¹
(
	`li¡L’gth
(
»¶y
) > 0);

199 
Ê
 = 
	`li¡La¡
(
»¶y
);

200 
cur
 = 
	`li¡NodeV®ue
(
Ê
);

201 ià(
cur
->
»fcouÁ
 > 1) {

202 
Ãw
 = 
	`dupSŒšgObjeù
(
cur
);

203 
	`deüRefCouÁ
(
cur
);

204 
	`li¡NodeV®ue
(
Ê
èğ
Ãw
;

206  
	`li¡NodeV®ue
(
Ê
);

207 
	}
}

213 
	$_addR•lyToBufãr
(
ş›Á
 *
c
, cÚ¡ *
s
, 
size_t
 
Ën
) {

214 
size_t
 
avaabË
 = (
c
->
buf
)-c->
buåos
;

216 ià(
c
->
æags
 & 
CLIENT_CLOSE_AFTER_REPLY
è 
C_OK
;

220 ià(
	`li¡L’gth
(
c
->
»¶y
è> 0è 
C_ERR
;

223 ià(
Ën
 > 
avaabË
è 
C_ERR
;

225 
	`memıy
(
c
->
buf
+c->
buåos
,
s
,
Ën
);

226 
c
->
buåos
+=
Ën
;

227  
C_OK
;

228 
	}
}

230 
	$_addR•lyObjeùToLi¡
(
ş›Á
 *
c
, 
robj
 *
o
) {

231 
robj
 *

;

233 ià(
c
->
æags
 & 
CLIENT_CLOSE_AFTER_REPLY
) ;

235 ià(
	`li¡L’gth
(
c
->
»¶y
) == 0) {

236 
	`šüRefCouÁ
(
o
);

237 
	`li¡AddNodeTa
(
c
->
»¶y
,
o
);

238 
c
->
»¶y_by‹s
 +ğ
	`g‘SŒšgObjeùSdsU£dMemÜy
(
o
);

240 

 = 
	`li¡NodeV®ue
(
	`li¡La¡
(
c
->
»¶y
));

243 ià(

->
±r
 !ğ
NULL
 &&

244 

->
’codšg
 =ğ
OBJ_ENCODING_RAW
 &&

245 
	`sd¦’
(

->
±r
)+sd¦’(
o
->±rè<ğ
PROTO_REPLY_CHUNK_BYTES
)

247 
c
->
»¶y_by‹s
 -ğ
	`sdsZm®locSize
(

->
±r
);

248 

 = 
	`dupLa¡ObjeùIfN“ded
(
c
->
»¶y
);

249 

->
±r
 = 
	`sdsÿ’
Ña->±r,
o
->±r,
	`sd¦’
(o->ptr));

250 
c
->
»¶y_by‹s
 +ğ
	`sdsZm®locSize
(

->
±r
);

252 
	`šüRefCouÁ
(
o
);

253 
	`li¡AddNodeTa
(
c
->
»¶y
,
o
);

254 
c
->
»¶y_by‹s
 +ğ
	`g‘SŒšgObjeùSdsU£dMemÜy
(
o
);

257 
	`asyncClo£Cl›ÁOnOuutBufãrLim™R—ched
(
c
);

258 
	}
}

262 
	$_addR•lySdsToLi¡
(
ş›Á
 *
c
, 
sds
 
s
) {

263 
robj
 *

;

265 ià(
c
->
æags
 & 
CLIENT_CLOSE_AFTER_REPLY
) {

266 
	`sdsä“
(
s
);

270 ià(
	`li¡L’gth
(
c
->
»¶y
) == 0) {

271 
	`li¡AddNodeTa
(
c
->
»¶y
,
	`ü—‹Objeù
(
OBJ_STRING
,
s
));

272 
c
->
»¶y_by‹s
 +ğ
	`sdsZm®locSize
(
s
);

274 

 = 
	`li¡NodeV®ue
(
	`li¡La¡
(
c
->
»¶y
));

277 ià(

->
±r
 !ğ
NULL
 &&a->
’codšg
 =ğ
OBJ_ENCODING_RAW
 &&

278 
	`sd¦’
(

->
±r
)+sd¦’(
s
è<ğ
PROTO_REPLY_CHUNK_BYTES
)

280 
c
->
»¶y_by‹s
 -ğ
	`sdsZm®locSize
(

->
±r
);

281 

 = 
	`dupLa¡ObjeùIfN“ded
(
c
->
»¶y
);

282 

->
±r
 = 
	`sdsÿ’
Ña->±r,
s
,
	`sd¦’
(s));

283 
c
->
»¶y_by‹s
 +ğ
	`sdsZm®locSize
(

->
±r
);

284 
	`sdsä“
(
s
);

286 
	`li¡AddNodeTa
(
c
->
»¶y
,
	`ü—‹Objeù
(
OBJ_STRING
,
s
));

287 
c
->
»¶y_by‹s
 +ğ
	`sdsZm®locSize
(
s
);

290 
	`asyncClo£Cl›ÁOnOuutBufãrLim™R—ched
(
c
);

291 
	}
}

293 
	$_addR•lySŒšgToLi¡
(
ş›Á
 *
c
, cÚ¡ *
s
, 
size_t
 
Ën
) {

294 
robj
 *

;

296 ià(
c
->
æags
 & 
CLIENT_CLOSE_AFTER_REPLY
) ;

298 ià(
	`li¡L’gth
(
c
->
»¶y
) == 0) {

299 
robj
 *
o
 = 
	`ü—‹SŒšgObjeù
(
s
,
Ën
);

301 
	`li¡AddNodeTa
(
c
->
»¶y
,
o
);

302 
c
->
»¶y_by‹s
 +ğ
	`g‘SŒšgObjeùSdsU£dMemÜy
(
o
);

304 

 = 
	`li¡NodeV®ue
(
	`li¡La¡
(
c
->
»¶y
));

307 ià(

->
±r
 !ğ
NULL
 &&a->
’codšg
 =ğ
OBJ_ENCODING_RAW
 &&

308 
	`sd¦’
(

->
±r
)+
Ën
 <ğ
PROTO_REPLY_CHUNK_BYTES
)

310 
c
->
»¶y_by‹s
 -ğ
	`sdsZm®locSize
(

->
±r
);

311 

 = 
	`dupLa¡ObjeùIfN“ded
(
c
->
»¶y
);

312 

->
±r
 = 
	`sdsÿ’
Ña->±r,
s
,
Ën
);

313 
c
->
»¶y_by‹s
 +ğ
	`sdsZm®locSize
(

->
±r
);

315 
robj
 *
o
 = 
	`ü—‹SŒšgObjeù
(
s
,
Ën
);

317 
	`li¡AddNodeTa
(
c
->
»¶y
,
o
);

318 
c
->
»¶y_by‹s
 +ğ
	`g‘SŒšgObjeùSdsU£dMemÜy
(
o
);

321 
	`asyncClo£Cl›ÁOnOuutBufãrLim™R—ched
(
c
);

322 
	}
}

329 
	$addR•ly
(
ş›Á
 *
c
, 
robj
 *
obj
) {

330 ià(
	`´•¬eCl›ÁToWr™e
(
c
è!ğ
C_OK
) ;

339 ià(
	`sdsEncodedObjeù
(
obj
)) {

340 ià(
	`_addR•lyToBufãr
(
c
,
obj
->
±r
,
	`sd¦’
(obj->±r)è!ğ
C_OK
)

341 
	`_addR•lyObjeùToLi¡
(
c
,
obj
);

342 } ià(
obj
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

346 ià(
	`li¡L’gth
(
c
->
»¶y
è=ğ0 && ((c->
buf
è- c->
buåos
) >= 32) {

347 
buf
[32];

348 
Ën
;

350 
Ën
 = 
	`Î2¡ršg
(
buf
,(buf),()
obj
->
±r
);

351 ià(
	`_addR•lyToBufãr
(
c
,
buf
,
Ën
è=ğ
C_OK
)

356 
obj
 = 
	`g‘DecodedObjeù
(obj);

357 ià(
	`_addR•lyToBufãr
(
c
,
obj
->
±r
,
	`sd¦’
(obj->±r)è!ğ
C_OK
)

358 
	`_addR•lyObjeùToLi¡
(
c
,
obj
);

359 
	`deüRefCouÁ
(
obj
);

361 
	`£rv”Pªic
("Wrong obj->encoding in‡ddReply()");

363 
	}
}

365 
	$addR•lySds
(
ş›Á
 *
c
, 
sds
 
s
) {

366 ià(
	`´•¬eCl›ÁToWr™e
(
c
è!ğ
C_OK
) {

368 
	`sdsä“
(
s
);

371 ià(
	`_addR•lyToBufãr
(
c
,
s
,
	`sd¦’
(s)è=ğ
C_OK
) {

372 
	`sdsä“
(
s
);

375 
	`_addR•lySdsToLi¡
(
c
,
s
);

377 
	}
}

379 
	$addR•lySŒšg
(
ş›Á
 *
c
, cÚ¡ *
s
, 
size_t
 
Ën
) {

380 ià(
	`´•¬eCl›ÁToWr™e
(
c
è!ğ
C_OK
) ;

381 ià(
	`_addR•lyToBufãr
(
c
,
s
,
Ën
è!ğ
C_OK
)

382 
	`_addR•lySŒšgToLi¡
(
c
,
s
,
Ën
);

383 
	}
}

385 
	$addR•lyE¼ÜL’gth
(
ş›Á
 *
c
, cÚ¡ *
s
, 
size_t
 
Ën
) {

386 
	`addR•lySŒšg
(
c
,"-ERR ",5);

387 
	`addR•lySŒšg
(
c
,
s
,
Ën
);

388 
	`addR•lySŒšg
(
c
,"\r\n",2);

389 
	}
}

391 
	$addR•lyE¼Ü
(
ş›Á
 *
c
, cÚ¡ *
”r
) {

392 
	`addR•lyE¼ÜL’gth
(
c
,
”r
,
	`¡¾’
(err));

393 
	}
}

395 
	$addR•lyE¼ÜFÜm©
(
ş›Á
 *
c
, cÚ¡ *
fmt
, ...) {

396 
size_t
 
l
, 
j
;

397 
va_li¡
 
­
;

398 
	`va_¡¬t
(
­
,
fmt
);

399 
sds
 
s
 = 
	`sdsÿtv´štf
(
	`sd£m±y
(),
fmt
,
­
);

400 
	`va_’d
(
­
);

403 
l
 = 
	`sd¦’
(
s
);

404 
j
 = 0; j < 
l
; j++) {

405 ià(
s
[
j
] == '\r' || s[j] == '\n') s[j] = ' ';

407 
	`addR•lyE¼ÜL’gth
(
c
,
s
,
	`sd¦’
(s));

408 
	`sdsä“
(
s
);

409 
	}
}

411 
	$addR•lyStusL’gth
(
ş›Á
 *
c
, cÚ¡ *
s
, 
size_t
 
Ën
) {

412 
	`addR•lySŒšg
(
c
,"+",1);

413 
	`addR•lySŒšg
(
c
,
s
,
Ën
);

414 
	`addR•lySŒšg
(
c
,"\r\n",2);

415 
	}
}

417 
	$addR•lyStus
(
ş›Á
 *
c
, cÚ¡ *
¡©us
) {

418 
	`addR•lyStusL’gth
(
c
,
¡©us
,
	`¡¾’
(status));

419 
	}
}

421 
	$addR•lyStusFÜm©
(
ş›Á
 *
c
, cÚ¡ *
fmt
, ...) {

422 
va_li¡
 
­
;

423 
	`va_¡¬t
(
­
,
fmt
);

424 
sds
 
s
 = 
	`sdsÿtv´štf
(
	`sd£m±y
(),
fmt
,
­
);

425 
	`va_’d
(
­
);

426 
	`addR•lyStusL’gth
(
c
,
s
,
	`sd¦’
(s));

427 
	`sdsä“
(
s
);

428 
	}
}

432 *
	$addDeã¼edMuÉiBulkL’gth
(
ş›Á
 *
c
) {

436 ià(
	`´•¬eCl›ÁToWr™e
(
c
è!ğ
C_OK
è 
NULL
;

437 
	`li¡AddNodeTa
(
c
->
»¶y
,
	`ü—‹Objeù
(
OBJ_STRING
,
NULL
));

438  
	`li¡La¡
(
c
->
»¶y
);

439 
	}
}

442 
	$£tDeã¼edMuÉiBulkL’gth
(
ş›Á
 *
c
, *
node
, 
Ëngth
) {

443 
li¡Node
 *
Ê
 = (li¡Node*)
node
;

444 
robj
 *
Ën
, *
Ãxt
;

447 ià(
node
 =ğ
NULL
) ;

449 
Ën
 = 
	`li¡NodeV®ue
(
Ê
);

450 
Ën
->
±r
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"*%ld\r\n",
Ëngth
);

451 
Ën
->
’codšg
 = 
OBJ_ENCODING_RAW
;

452 
c
->
»¶y_by‹s
 +ğ
	`sdsZm®locSize
(
Ën
->
±r
);

453 ià(
Ê
->
Ãxt
 !ğ
NULL
) {

454 
Ãxt
 = 
	`li¡NodeV®ue
(
Ê
->next);

457 ià(
Ãxt
->
±r
 !ğ
NULL
) {

458 
c
->
»¶y_by‹s
 -ğ
	`sdsZm®locSize
(
Ën
->
±r
);

459 
c
->
»¶y_by‹s
 -ğ
	`g‘SŒšgObjeùSdsU£dMemÜy
(
Ãxt
);

460 
Ën
->
±r
 = 
	`sdsÿ’
Ö’->±r,
Ãxt
->±r,
	`sd¦’
(next->ptr));

461 
c
->
»¶y_by‹s
 +ğ
	`sdsZm®locSize
(
Ën
->
±r
);

462 
	`li¡D–Node
(
c
->
»¶y
,
Ê
->
Ãxt
);

465 
	`asyncClo£Cl›ÁOnOuutBufãrLim™R—ched
(
c
);

466 
	}
}

469 
	$addR•lyDoubË
(
ş›Á
 *
c
, 
d
) {

470 
dbuf
[128], 
sbuf
[128];

471 
dËn
, 
¦’
;

472 ià(
	`isšf
(
d
)) {

475 
	`addR•lyBulkCSŒšg
(
c
, 
d
 > 0 ? "inf" : "-inf");

477 
dËn
 = 
	`¢´štf
(
dbuf
,(dbuf),"%.17g",
d
);

478 
¦’
 = 
	`¢´štf
(
sbuf
,(sbuf),"$%d\r\n%s\r\n",
dËn
,
dbuf
);

479 
	`addR•lySŒšg
(
c
,
sbuf
,
¦’
);

481 
	}
}

486 
	$addR•lyHumªLÚgDoubË
(
ş›Á
 *
c
, 
d
) {

487 
robj
 *
o
 = 
	`ü—‹SŒšgObjeùFromLÚgDoubË
(
d
,1);

488 
	`addR•lyBulk
(
c
,
o
);

489 
	`deüRefCouÁ
(
o
);

490 
	}
}

494 
	$addR•lyLÚgLÚgW™hP»fix
(
ş›Á
 *
c
, 
Î
, 
´efix
) {

495 
buf
[128];

496 
Ën
;

501 ià(
´efix
 =ğ'*' && 
Î
 < 
OBJ_SHARED_BULKHDR_LEN
 &&†l >= 0) {

502 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[
Î
]);

504 } ià(
´efix
 =ğ'$' && 
Î
 < 
OBJ_SHARED_BULKHDR_LEN
 &&†l >= 0) {

505 
	`addR•ly
(
c
,
sh¬ed
.
bulkhdr
[
Î
]);

509 
buf
[0] = 
´efix
;

510 
Ën
 = 
	`Î2¡ršg
(
buf
+1,(buf)-1,
Î
);

511 
buf
[
Ën
+1] = '\r';

512 
buf
[
Ën
+2] = '\n';

513 
	`addR•lySŒšg
(
c
,
buf
,
Ën
+3);

514 
	}
}

516 
	$addR•lyLÚgLÚg
(
ş›Á
 *
c
, 
Î
) {

517 ià(
Î
 == 0)

518 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

519 ià(
Î
 == 1)

520 
	`addR•ly
(
c
,
sh¬ed
.
cÚe
);

522 
	`addR•lyLÚgLÚgW™hP»fix
(
c
,
Î
,':');

523 
	}
}

525 
	$addR•lyMuÉiBulkL’
(
ş›Á
 *
c
, 
Ëngth
) {

526 ià(
Ëngth
 < 
OBJ_SHARED_BULKHDR_LEN
)

527 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[
Ëngth
]);

529 
	`addR•lyLÚgLÚgW™hP»fix
(
c
,
Ëngth
,'*');

530 
	}
}

533 
	$addR•lyBulkL’
(
ş›Á
 *
c
, 
robj
 *
obj
) {

534 
size_t
 
Ën
;

536 ià(
	`sdsEncodedObjeù
(
obj
)) {

537 
Ën
 = 
	`sd¦’
(
obj
->
±r
);

539 
n
 = ()
obj
->
±r
;

542 
Ën
 = 1;

543 ià(
n
 < 0) {

544 
Ën
++;

545 
n
 = -n;

547 (
n
 =‚/10) != 0) {

548 
Ën
++;

552 ià(
Ën
 < 
OBJ_SHARED_BULKHDR_LEN
)

553 
	`addR•ly
(
c
,
sh¬ed
.
bulkhdr
[
Ën
]);

555 
	`addR•lyLÚgLÚgW™hP»fix
(
c
,
Ën
,'$');

556 
	}
}

559 
	$addR•lyBulk
(
ş›Á
 *
c
, 
robj
 *
obj
) {

560 
	`addR•lyBulkL’
(
c
,
obj
);

561 
	`addR•ly
(
c
,
obj
);

562 
	`addR•ly
(
c
,
sh¬ed
.
ülf
);

563 
	}
}

566 
	$addR•lyBulkCBufãr
(
ş›Á
 *
c
, cÚ¡ *
p
, 
size_t
 
Ën
) {

567 
	`addR•lyLÚgLÚgW™hP»fix
(
c
,
Ën
,'$');

568 
	`addR•lySŒšg
(
c
,
p
,
Ën
);

569 
	`addR•ly
(
c
,
sh¬ed
.
ülf
);

570 
	}
}

573 
	$addR•lyBulkSds
(
ş›Á
 *
c
, 
sds
 
s
) {

574 
	`addR•lySds
(
c
,
	`sdsÿtfmt
(
	`sd£m±y
(),"$%u\r\n",

575 ()
	`sd¦’
(
s
)));

576 
	`addR•lySds
(
c
,
s
);

577 
	`addR•ly
(
c
,
sh¬ed
.
ülf
);

578 
	}
}

581 
	$addR•lyBulkCSŒšg
(
ş›Á
 *
c
, cÚ¡ *
s
) {

582 ià(
s
 =ğ
NULL
) {

583 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

585 
	`addR•lyBulkCBufãr
(
c
,
s
,
	`¡¾’
(s));

587 
	}
}

590 
	$addR•lyBulkLÚgLÚg
(
ş›Á
 *
c
, 
Î
) {

591 
buf
[64];

592 
Ën
;

594 
Ën
 = 
	`Î2¡ršg
(
buf
,64,
Î
);

595 
	`addR•lyBulkCBufãr
(
c
,
buf
,
Ën
);

596 
	}
}

601 
	$cİyCl›ÁOuutBufãr
(
ş›Á
 *
d¡
, cl›Á *
¤c
) {

602 
	`li¡R–—£
(
d¡
->
»¶y
);

603 
d¡
->
»¶y
 = 
	`li¡Dup
(
¤c
->reply);

604 
	`memıy
(
d¡
->
buf
,
¤c
->buf,¤c->
buåos
);

605 
d¡
->
buåos
 = 
¤c
->bufpos;

606 
d¡
->
»¶y_by‹s
 = 
¤c
->reply_bytes;

607 
	}
}

611 
	$ş›ÁHasP’dšgR•l›s
(
ş›Á
 *
c
) {

612  
c
->
buåos
 || 
	`li¡L’gth
(c->
»¶y
);

613 
	}
}

615 
	#MAX_ACCEPTS_PER_CALL
 1000

	)

616 
	$acû±CommÚHªdËr
(
fd
, 
æags
, *

) {

617 
ş›Á
 *
c
;

618 ià((
c
 = 
	`ü—‹Cl›Á
(
fd
)è=ğ
NULL
) {

619 
	`£rv”Log
(
LL_WARNING
,

621 
	`¡»¼Ü
(
”ºo
),
fd
);

622 
	`şo£
(
fd
);

629 ià(
	`li¡L’gth
(
£rv”
.
ş›Ás
è> s”v”.
maxş›Ás
) {

630 *
”r
 = "-ERR max‚umber of clients„eached\r\n";

633 ià(
	`wr™e
(
c
->
fd
,
”r
,
	`¡¾’
(err)) == -1) {

636 
£rv”
.
¡©_»jeùed_cÚn
++;

637 
	`ä“Cl›Á
(
c
);

645 ià(
£rv”
.
´Ùeùed_mode
 &&

646 
£rv”
.
bšdaddr_couÁ
 == 0 &&

647 
£rv”
.
»quœ•ass
 =ğ
NULL
 &&

648 !(
æags
 & 
CLIENT_UNIX_SOCKET
) &&

649 

 !ğ
NULL
)

651 ià(
	`¡rcmp
(

,"127.0.0.1") && strcmp(ip,"::1")) {

652 *
”r
 =

673 ià(
	`wr™e
(
c
->
fd
,
”r
,
	`¡¾’
(err)) == -1) {

676 
£rv”
.
¡©_»jeùed_cÚn
++;

677 
	`ä“Cl›Á
(
c
);

682 
£rv”
.
¡©_numcÚÃùiÚs
++;

683 
c
->
æags
 |= flags;

684 
	}
}

686 
	$acû±TıHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

687 
ıÜt
, 
cfd
, 
max
 = 
MAX_ACCEPTS_PER_CALL
;

688 
c
[
NET_IP_STR_LEN
];

689 
	`UNUSED
(
–
);

690 
	`UNUSED
(
mask
);

691 
	`UNUSED
(
´ivd©a
);

693 
max
--) {

694 
cfd
 = 
	`ª‘TıAcû±
(
£rv”
.
Ã‹¼
, 
fd
, 
c
, (c), &
ıÜt
);

695 ià(
cfd
 =ğ
ANET_ERR
) {

696 ià(
”ºo
 !ğ
EWOULDBLOCK
)

697 
	`£rv”Log
(
LL_WARNING
,

698 "Acû±šg cl›Á cÚÃùiÚ: %s", 
£rv”
.
Ã‹¼
);

701 
	`£rv”Log
(
LL_VERBOSE
,"Acû±ed %s:%d", 
c
, 
ıÜt
);

702 
	`acû±CommÚHªdËr
(
cfd
,0,
c
);

704 
	}
}

706 
	$acû±UnixHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

707 
cfd
, 
max
 = 
MAX_ACCEPTS_PER_CALL
;

708 
	`UNUSED
(
–
);

709 
	`UNUSED
(
mask
);

710 
	`UNUSED
(
´ivd©a
);

712 
max
--) {

713 
cfd
 = 
	`ª‘UnixAcû±
(
£rv”
.
Ã‹¼
, 
fd
);

714 ià(
cfd
 =ğ
ANET_ERR
) {

715 ià(
”ºo
 !ğ
EWOULDBLOCK
)

716 
	`£rv”Log
(
LL_WARNING
,

717 "Acû±šg cl›Á cÚÃùiÚ: %s", 
£rv”
.
Ã‹¼
);

720 
	`£rv”Log
(
LL_VERBOSE
,"Acû±ed cÚÃùiÚØ%s", 
£rv”
.
unixsock‘
);

721 
	`acû±CommÚHªdËr
(
cfd
,
CLIENT_UNIX_SOCKET
,
NULL
);

723 
	}
}

725 
	$ä“Cl›ÁArgv
(
ş›Á
 *
c
) {

726 
j
;

727 
j
 = 0; j < 
c
->
¬gc
; j++)

728 
	`deüRefCouÁ
(
c
->
¬gv
[
j
]);

729 
c
->
¬gc
 = 0;

730 
c
->
cmd
 = 
NULL
;

731 
	}
}

736 
	$discÚÃùSÏves
() {

737 
	`li¡L’gth
(
£rv”
.
¦aves
)) {

738 
li¡Node
 *
Ê
 = 
	`li¡Fœ¡
(
£rv”
.
¦aves
);

739 
	`ä“Cl›Á
((
ş›Á
*)
Ê
->
v®ue
);

741 
	}
}

746 
	$uÆškCl›Á
(
ş›Á
 *
c
) {

747 
li¡Node
 *
Ê
;

750 ià(
£rv”
.
cu¼’t_ş›Á
 =ğ
c
è£rv”.cu¼’t_ş›Á = 
NULL
;

755 ià(
c
->
fd
 != -1) {

757 
Ê
 = 
	`li¡S—rchKey
(
£rv”
.
ş›Ás
,
c
);

758 
	`£rv”As£¹
(
Ê
 !ğ
NULL
);

759 
	`li¡D–Node
(
£rv”
.
ş›Ás
,
Ê
);

762 
	`«D–‘eFeEv’t
(
£rv”
.
–
,
c
->
fd
,
AE_READABLE
);

763 
	`«D–‘eFeEv’t
(
£rv”
.
–
,
c
->
fd
,
AE_WRITABLE
);

764 
	`şo£
(
c
->
fd
);

765 
c
->
fd
 = -1;

769 ià(
c
->
æags
 & 
CLIENT_PENDING_WRITE
) {

770 
Ê
 = 
	`li¡S—rchKey
(
£rv”
.
ş›Ás_³ndšg_wr™e
,
c
);

771 
	`£rv”As£¹
(
Ê
 !ğ
NULL
);

772 
	`li¡D–Node
(
£rv”
.
ş›Ás_³ndšg_wr™e
,
Ê
);

773 
c
->
æags
 &ğ~
CLIENT_PENDING_WRITE
;

778 ià(
c
->
æags
 & 
CLIENT_UNBLOCKED
) {

779 
Ê
 = 
	`li¡S—rchKey
(
£rv”
.
unblocked_ş›Ás
,
c
);

780 
	`£rv”As£¹
(
Ê
 !ğ
NULL
);

781 
	`li¡D–Node
(
£rv”
.
unblocked_ş›Ás
,
Ê
);

782 
c
->
æags
 &ğ~
CLIENT_UNBLOCKED
;

784 
	}
}

786 
	$ä“Cl›Á
(
ş›Á
 *
c
) {

787 
li¡Node
 *
Ê
;

794 ià(
£rv”
.
ma¡”
 && 
c
->
æags
 & 
CLIENT_MASTER
) {

795 
	`£rv”Log
(
LL_WARNING
,"Connection with master†ost.");

796 ià(!(
c
->
æags
 & (
CLIENT_CLOSE_AFTER_REPLY
|

797 
CLIENT_CLOSE_ASAP
|

798 
CLIENT_BLOCKED
|

799 
CLIENT_UNBLOCKED
)))

801 
	`»¶iÿtiÚCacheMa¡”
(
c
);

807 ià((
c
->
æags
 & 
CLIENT_SLAVE
è&& !(c->æag & 
CLIENT_MONITOR
)) {

808 
	`£rv”Log
(
LL_WARNING
,"Connection with slave %s†ost.",

809 
	`»¶iÿtiÚG‘SÏveName
(
c
));

813 
	`sdsä“
(
c
->
qu”ybuf
);

814 
c
->
qu”ybuf
 = 
NULL
;

817 ià(
c
->
æags
 & 
CLIENT_BLOCKED
è
	`unblockCl›Á
(c);

818 
	`diùR–—£
(
c
->
bpİ
.
keys
);

821 
	`unw©chAÎKeys
(
c
);

822 
	`li¡R–—£
(
c
->
w©ched_keys
);

825 
	`pubsubUnsubsüibeAÎChªÃls
(
c
,0);

826 
	`pubsubUnsubsüibeAÎP©‹ºs
(
c
,0);

827 
	`diùR–—£
(
c
->
pubsub_chªÃls
);

828 
	`li¡R–—£
(
c
->
pubsub_·‰”ns
);

831 
	`li¡R–—£
(
c
->
»¶y
);

832 
	`ä“Cl›ÁArgv
(
c
);

837 
	`uÆškCl›Á
(
c
);

841 ià(
c
->
æags
 & 
CLIENT_SLAVE
) {

842 ià(
c
->
»¶¡©e
 =ğ
SLAVE_STATE_SEND_BULK
) {

843 ià(
c
->
»¶dbfd
 !ğ-1è
	`şo£
(c->repldbfd);

844 ià(
c
->
»¶´—mbË
è
	`sdsä“
(c->replpreamble);

846 
li¡
 *
l
 = (
c
->
æags
 & 
CLIENT_MONITOR
è? 
£rv”
.
mÚ™Üs
 : s”v”.
¦aves
;

847 
Ê
 = 
	`li¡S—rchKey
(
l
,
c
);

848 
	`£rv”As£¹
(
Ê
 !ğ
NULL
);

849 
	`li¡D–Node
(
l
,
Ê
);

853 ià(
c
->
æags
 & 
CLIENT_SLAVE
 && 
	`li¡L’gth
(
£rv”
.
¦aves
) == 0)

854 
£rv”
.
»¶_no_¦aves_sšû
 = s”v”.
unixtime
;

855 
	`»äeshGoodSÏvesCouÁ
();

860 ià(
c
->
æags
 & 
CLIENT_MASTER
è
	`»¶iÿtiÚHªdËMa¡”DiscÚÃùiÚ
();

864 ià(
c
->
æags
 & 
CLIENT_CLOSE_ASAP
) {

865 
Ê
 = 
	`li¡S—rchKey
(
£rv”
.
ş›Ás_to_şo£
,
c
);

866 
	`£rv”As£¹
(
Ê
 !ğ
NULL
);

867 
	`li¡D–Node
(
£rv”
.
ş›Ás_to_şo£
,
Ê
);

872 ià(
c
->
Çme
è
	`deüRefCouÁ
(c->name);

873 
	`zä“
(
c
->
¬gv
);

874 
	`ä“Cl›ÁMuÉiS‹
(
c
);

875 
	`sdsä“
(
c
->
³”id
);

876 
	`zä“
(
c
);

877 
	}
}

883 
	$ä“Cl›ÁAsync
(
ş›Á
 *
c
) {

884 ià(
c
->
æags
 & 
CLIENT_CLOSE_ASAP
 || c->æag & 
CLIENT_LUA
) ;

885 
c
->
æags
 |ğ
CLIENT_CLOSE_ASAP
;

886 
	`li¡AddNodeTa
(
£rv”
.
ş›Ás_to_şo£
,
c
);

887 
	}
}

889 
	$ä“Cl›ÁsInAsyncF»eQueue
() {

890 
	`li¡L’gth
(
£rv”
.
ş›Ás_to_şo£
)) {

891 
li¡Node
 *
Ê
 = 
	`li¡Fœ¡
(
£rv”
.
ş›Ás_to_şo£
);

892 
ş›Á
 *
c
 = 
	`li¡NodeV®ue
(
Ê
);

894 
c
->
æags
 &ğ~
CLIENT_CLOSE_ASAP
;

895 
	`ä“Cl›Á
(
c
);

896 
	`li¡D–Node
(
£rv”
.
ş›Ás_to_şo£
,
Ê
);

898 
	}
}

902 
	$wr™eToCl›Á
(
fd
, 
ş›Á
 *
c
, 
hªdËr_š¡®Ëd
) {

903 
ssize_t
 
nwr™‹n
 = 0, 
tÙwr™‹n
 = 0;

904 
size_t
 
objËn
;

905 
size_t
 
objmem
;

906 
robj
 *
o
;

908 
	`ş›ÁHasP’dšgR•l›s
(
c
)) {

909 ià(
c
->
buåos
 > 0) {

910 
nwr™‹n
 = 
	`wr™e
(
fd
,
c
->
buf
+c->
£ÁËn
,c->
buåos
-c->sentlen);

911 ià(
nwr™‹n
 <= 0) ;

912 
c
->
£ÁËn
 +ğ
nwr™‹n
;

913 
tÙwr™‹n
 +ğ
nwr™‹n
;

917 ià(()
c
->
£ÁËn
 =ğc->
buåos
) {

918 
c
->
buåos
 = 0;

919 
c
->
£ÁËn
 = 0;

922 
o
 = 
	`li¡NodeV®ue
(
	`li¡Fœ¡
(
c
->
»¶y
));

923 
objËn
 = 
	`sd¦’
(
o
->
±r
);

924 
objmem
 = 
	`g‘SŒšgObjeùSdsU£dMemÜy
(
o
);

926 ià(
objËn
 == 0) {

927 
	`li¡D–Node
(
c
->
»¶y
,
	`li¡Fœ¡
(c->reply));

928 
c
->
»¶y_by‹s
 -ğ
objmem
;

932 
nwr™‹n
 = 
	`wr™e
(
fd
, ((*)
o
->
±r
)+
c
->
£ÁËn
,
objËn
-c->sentlen);

933 ià(
nwr™‹n
 <= 0) ;

934 
c
->
£ÁËn
 +ğ
nwr™‹n
;

935 
tÙwr™‹n
 +ğ
nwr™‹n
;

938 ià(
c
->
£ÁËn
 =ğ
objËn
) {

939 
	`li¡D–Node
(
c
->
»¶y
,
	`li¡Fœ¡
(c->reply));

940 
c
->
£ÁËn
 = 0;

941 
c
->
»¶y_by‹s
 -ğ
objmem
;

952 
£rv”
.
¡©_Ãt_ouut_by‹s
 +ğ
tÙwr™‹n
;

953 ià(
tÙwr™‹n
 > 
NET_MAX_WRITES_PER_EVENT
 &&

954 (
£rv”
.
maxmemÜy
 == 0 ||

955 
	`zm®loc_u£d_memÜy
(è< 
£rv”
.
maxmemÜy
)) ;

957 ià(
nwr™‹n
 == -1) {

958 ià(
”ºo
 =ğ
EAGAIN
) {

959 
nwr™‹n
 = 0;

961 
	`£rv”Log
(
LL_VERBOSE
,

962 "E¼Ü wr™šgØş›Á: %s", 
	`¡»¼Ü
(
”ºo
));

963 
	`ä“Cl›Á
(
c
);

964  
C_ERR
;

967 ià(
tÙwr™‹n
 > 0) {

972 ià(!(
c
->
æags
 & 
CLIENT_MASTER
)èc->
Ï¡š‹¿ùiÚ
 = 
£rv”
.
unixtime
;

974 ià(!
	`ş›ÁHasP’dšgR•l›s
(
c
)) {

975 
c
->
£ÁËn
 = 0;

976 ià(
hªdËr_š¡®Ëd
è
	`«D–‘eFeEv’t
(
£rv”
.
–
,
c
->
fd
,
AE_WRITABLE
);

979 ià(
c
->
æags
 & 
CLIENT_CLOSE_AFTER_REPLY
) {

980 
	`ä“Cl›Á
(
c
);

981  
C_ERR
;

984  
C_OK
;

985 
	}
}

988 
	$£ndR•lyToCl›Á
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

989 
	`UNUSED
(
–
);

990 
	`UNUSED
(
mask
);

991 
	`wr™eToCl›Á
(
fd
,
´ivd©a
,1);

992 
	}
}

998 
	$hªdËCl›ÁsW™hP’dšgWr™es
() {

999 
li¡I‹r
 
li
;

1000 
li¡Node
 *
Ê
;

1001 
´oûs£d
 = 
	`li¡L’gth
(
£rv”
.
ş›Ás_³ndšg_wr™e
);

1003 
	`li¡Rewšd
(
£rv”
.
ş›Ás_³ndšg_wr™e
,&
li
);

1004 (
Ê
 = 
	`li¡Next
(&
li
))) {

1005 
ş›Á
 *
c
 = 
	`li¡NodeV®ue
(
Ê
);

1006 
c
->
æags
 &ğ~
CLIENT_PENDING_WRITE
;

1007 
	`li¡D–Node
(
£rv”
.
ş›Ás_³ndšg_wr™e
,
Ê
);

1010 ià(
	`wr™eToCl›Á
(
c
->
fd
,c,0è=ğ
C_ERR
) ;

1014 ià(
	`ş›ÁHasP’dšgR•l›s
(
c
) &&

1015 
	`«C»©eFeEv’t
(
£rv”
.
–
, 
c
->
fd
, 
AE_WRITABLE
,

1016 
£ndR•lyToCl›Á
, 
c
è=ğ
AE_ERR
)

1018 
	`ä“Cl›ÁAsync
(
c
);

1021  
´oûs£d
;

1022 
	}
}

1025 
	$»£tCl›Á
(
ş›Á
 *
c
) {

1026 
»disCommªdProc
 *
´evcmd
 = 
c
->
cmd
 ? c->cmd->
´oc
 : 
NULL
;

1028 
	`ä“Cl›ÁArgv
(
c
);

1029 
c
->
»qty³
 = 0;

1030 
c
->
muÉibulkËn
 = 0;

1031 
c
->
bulkËn
 = -1;

1035 ià(!(
c
->
æags
 & 
CLIENT_MULTI
è&& 
´evcmd
 !ğ
askšgCommªd
)

1036 
c
->
æags
 &ğ~
CLIENT_ASKING
;

1041 
c
->
æags
 &ğ~
CLIENT_REPLY_SKIP
;

1042 ià(
c
->
æags
 & 
CLIENT_REPLY_SKIP_NEXT
) {

1043 
c
->
æags
 |ğ
CLIENT_REPLY_SKIP
;

1044 
c
->
æags
 &ğ~
CLIENT_REPLY_SKIP_NEXT
;

1046 
	}
}

1048 
	$´oûssIÆšeBufãr
(
ş›Á
 *
c
) {

1049 *
Ãwlše
;

1050 
¬gc
, 
j
;

1051 
sds
 *
¬gv
, 
aux
;

1052 
size_t
 
qu”yËn
;

1055 
Ãwlše
 = 
	`¡rchr
(
c
->
qu”ybuf
,'\n');

1058 ià(
Ãwlše
 =ğ
NULL
) {

1059 ià(
	`sd¦’
(
c
->
qu”ybuf
è> 
PROTO_INLINE_MAX_SIZE
) {

1060 
	`addR•lyE¼Ü
(
c
,"Protocolƒrror:oo big inline„equest");

1061 
	`£tPrÙocŞE¼Ü
(
c
,0);

1063  
C_ERR
;

1067 ià(
Ãwlše
 &&‚ewlš!ğ
c
->
qu”ybuf
 && *(newline-1) == '\r')

1068 
Ãwlše
--;

1071 
qu”yËn
 = 
Ãwlše
-(
c
->
qu”ybuf
);

1072 
aux
 = 
	`sd¢ewËn
(
c
->
qu”ybuf
,
qu”yËn
);

1073 
¬gv
 = 
	`sds¥l™¬gs
(
aux
,&
¬gc
);

1074 
	`sdsä“
(
aux
);

1075 ià(
¬gv
 =ğ
NULL
) {

1076 
	`addR•lyE¼Ü
(
c
,"Protocolƒrror: unbalanced quotes in„equest");

1077 
	`£tPrÙocŞE¼Ü
(
c
,0);

1078  
C_ERR
;

1084 ià(
qu”yËn
 =ğ0 && 
c
->
æags
 & 
CLIENT_SLAVE
)

1085 
c
->
»¶_ack_time
 = 
£rv”
.
unixtime
;

1088 
	`sd¤ªge
(
c
->
qu”ybuf
,
qu”yËn
+2,-1);

1091 ià(
¬gc
) {

1092 ià(
c
->
¬gv
è
	`zä“
(c->argv);

1093 
c
->
¬gv
 = 
	`zm®loc
((
robj
*)*
¬gc
);

1097 
c
->
¬gc
 = 0, 
j
 = 0; j <‡rgc; j++) {

1098 ià(
	`sd¦’
(
¬gv
[
j
])) {

1099 
c
->
¬gv
[c->
¬gc
] = 
	`ü—‹Objeù
(
OBJ_STRING
,¬gv[
j
]);

1100 
c
->
¬gc
++;

1102 
	`sdsä“
(
¬gv
[
j
]);

1105 
	`zä“
(
¬gv
);

1106  
C_OK
;

1107 
	}
}

1111 
	$£tPrÙocŞE¼Ü
(
ş›Á
 *
c
, 
pos
) {

1112 ià(
£rv”
.
v”bos™y
 <ğ
LL_VERBOSE
) {

1113 
sds
 
ş›Á
 = 
	`ÿtCl›ÁInfoSŒšg
(
	`sd£m±y
(),
c
);

1114 
	`£rv”Log
(
LL_VERBOSE
,

1115 "PrÙocŞƒ¼Ü from cl›Á: %s", 
ş›Á
);

1116 
	`sdsä“
(
ş›Á
);

1118 
c
->
æags
 |ğ
CLIENT_CLOSE_AFTER_REPLY
;

1119 
	`sd¤ªge
(
c
->
qu”ybuf
,
pos
,-1);

1120 
	}
}

1122 
	$´oûssMuÉibulkBufãr
(
ş›Á
 *
c
) {

1123 *
Ãwlše
 = 
NULL
;

1124 
pos
 = 0, 
ok
;

1125 
Î
;

1127 ià(
c
->
muÉibulkËn
 == 0) {

1129 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,c->
¬gc
 == 0);

1132 
Ãwlše
 = 
	`¡rchr
(
c
->
qu”ybuf
,'\r');

1133 ià(
Ãwlše
 =ğ
NULL
) {

1134 ià(
	`sd¦’
(
c
->
qu”ybuf
è> 
PROTO_INLINE_MAX_SIZE
) {

1135 
	`addR•lyE¼Ü
(
c
,"Protocolƒrror:oo big mbulk count string");

1136 
	`£tPrÙocŞE¼Ü
(
c
,0);

1138  
C_ERR
;

1142 ià(
Ãwlše
-(
c
->
qu”ybuf
è> ((sigÃd)
	`sd¦’
(c->querybuf)-2))

1143  
C_ERR
;

1147 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,c->
qu”ybuf
[0] == '*');

1148 
ok
 = 
	`¡ršg2Î
(
c
->
qu”ybuf
+1,
Ãwlše
-(c->qu”ybuf+1),&
Î
);

1149 ià(!
ok
 || 
Î
 > 1024*1024) {

1150 
	`addR•lyE¼Ü
(
c
,"Protocolƒrror: invalid multibulk†ength");

1151 
	`£tPrÙocŞE¼Ü
(
c
,
pos
);

1152  
C_ERR
;

1155 
pos
 = (
Ãwlše
-
c
->
qu”ybuf
)+2;

1156 ià(
Î
 <= 0) {

1157 
	`sd¤ªge
(
c
->
qu”ybuf
,
pos
,-1);

1158  
C_OK
;

1161 
c
->
muÉibulkËn
 = 
Î
;

1164 ià(
c
->
¬gv
è
	`zä“
(c->argv);

1165 
c
->
¬gv
 = 
	`zm®loc
((
robj
*)*c->
muÉibulkËn
);

1168 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,c->
muÉibulkËn
 > 0);

1169 
c
->
muÉibulkËn
) {

1171 ià(
c
->
bulkËn
 == -1) {

1172 
Ãwlše
 = 
	`¡rchr
(
c
->
qu”ybuf
+
pos
,'\r');

1173 ià(
Ãwlše
 =ğ
NULL
) {

1174 ià(
	`sd¦’
(
c
->
qu”ybuf
è> 
PROTO_INLINE_MAX_SIZE
) {

1175 
	`addR•lyE¼Ü
(
c
,

1177 
	`£tPrÙocŞE¼Ü
(
c
,0);

1178  
C_ERR
;

1184 ià(
Ãwlše
-(
c
->
qu”ybuf
è> ((sigÃd)
	`sd¦’
(c->querybuf)-2))

1187 ià(
c
->
qu”ybuf
[
pos
] != '$') {

1188 
	`addR•lyE¼ÜFÜm©
(
c
,

1190 
c
->
qu”ybuf
[
pos
]);

1191 
	`£tPrÙocŞE¼Ü
(
c
,
pos
);

1192  
C_ERR
;

1195 
ok
 = 
	`¡ršg2Î
(
c
->
qu”ybuf
+
pos
+1,
Ãwlše
-(c->qu”ybuf+pos+1),&
Î
);

1196 ià(!
ok
 || 
Î
 < 0 ||†l > 512*1024*1024) {

1197 
	`addR•lyE¼Ü
(
c
,"Protocolƒrror: invalid bulk†ength");

1198 
	`£tPrÙocŞE¼Ü
(
c
,
pos
);

1199  
C_ERR
;

1202 
pos
 +ğ
Ãwlše
-(
c
->
qu”ybuf
+pos)+2;

1203 ià(
Î
 >ğ
PROTO_MBULK_BIG_ARG
) {

1204 
size_t
 
qbËn
;

1210 
	`sd¤ªge
(
c
->
qu”ybuf
,
pos
,-1);

1211 
pos
 = 0;

1212 
qbËn
 = 
	`sd¦’
(
c
->
qu”ybuf
);

1215 ià(
qbËn
 < (
size_t
)
Î
+2)

1216 
c
->
qu”ybuf
 = 
	`sdsMakeRoomFÜ
(c->qu”ybuf,
Î
+2-
qbËn
);

1218 
c
->
bulkËn
 = 
Î
;

1222 ià(
	`sd¦’
(
c
->
qu”ybuf
)-
pos
 < ()(c->
bulkËn
+2)) {

1229 ià(
pos
 == 0 &&

1230 
c
->
bulkËn
 >ğ
PROTO_MBULK_BIG_ARG
 &&

1231 (sigÃdè
	`sd¦’
(
c
->
qu”ybuf
è=ğc->
bulkËn
+2)

1233 
c
->
¬gv
[c->
¬gc
++] = 
	`ü—‹Objeù
(
OBJ_STRING
,c->
qu”ybuf
);

1234 
	`sdsInüL’
(
c
->
qu”ybuf
,-2);

1237 
c
->
qu”ybuf
 = 
	`sd¢ewËn
(
NULL
,c->
bulkËn
+2);

1238 
	`sdsş—r
(
c
->
qu”ybuf
);

1239 
pos
 = 0;

1241 
c
->
¬gv
[c->
¬gc
++] =

1242 
	`ü—‹SŒšgObjeù
(
c
->
qu”ybuf
+
pos
,c->
bulkËn
);

1243 
pos
 +ğ
c
->
bulkËn
+2;

1245 
c
->
bulkËn
 = -1;

1246 
c
->
muÉibulkËn
--;

1251 ià(
pos
è
	`sd¤ªge
(
c
->
qu”ybuf
,pos,-1);

1254 ià(
c
->
muÉibulkËn
 =ğ0è 
C_OK
;

1257  
C_ERR
;

1258 
	}
}

1260 
	$´oûssIÅutBufãr
(
ş›Á
 *
c
) {

1261 
£rv”
.
cu¼’t_ş›Á
 = 
c
;

1263 
	`sd¦’
(
c
->
qu”ybuf
)) {

1265 ià(!(
c
->
æags
 & 
CLIENT_SLAVE
è&& 
	`ş›ÁsA»Pau£d
()) ;

1268 ià(
c
->
æags
 & 
CLIENT_BLOCKED
) ;

1275 ià(
c
->
æags
 & (
CLIENT_CLOSE_AFTER_REPLY
|
CLIENT_CLOSE_ASAP
)) ;

1278 ià(!
c
->
»qty³
) {

1279 ià(
c
->
qu”ybuf
[0] == '*') {

1280 
c
->
»qty³
 = 
PROTO_REQ_MULTIBULK
;

1282 
c
->
»qty³
 = 
PROTO_REQ_INLINE
;

1286 ià(
c
->
»qty³
 =ğ
PROTO_REQ_INLINE
) {

1287 ià(
	`´oûssIÆšeBufãr
(
c
è!ğ
C_OK
) ;

1288 } ià(
c
->
»qty³
 =ğ
PROTO_REQ_MULTIBULK
) {

1289 ià(
	`´oûssMuÉibulkBufãr
(
c
è!ğ
C_OK
) ;

1291 
	`£rv”Pªic
("Unknown„equestype");

1295 ià(
c
->
¬gc
 == 0) {

1296 
	`»£tCl›Á
(
c
);

1299 ià(
	`´oûssCommªd
(
c
è=ğ
C_OK
)

1300 
	`»£tCl›Á
(
c
);

1303 ià(
£rv”
.
cu¼’t_ş›Á
 =ğ
NULL
) ;

1306 
£rv”
.
cu¼’t_ş›Á
 = 
NULL
;

1307 
	}
}

1309 
	$»adQu”yFromCl›Á
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

1310 
ş›Á
 *
c
 = (ş›Á*è
´ivd©a
;

1311 
Ä—d
, 
»adËn
;

1312 
size_t
 
qbËn
;

1313 
	`UNUSED
(
–
);

1314 
	`UNUSED
(
mask
);

1316 
»adËn
 = 
PROTO_IOBUF_LEN
;

1323 ià(
c
->
»qty³
 =ğ
PROTO_REQ_MULTIBULK
 && c->
muÉibulkËn
 && c->
bulkËn
 != -1

1324 && 
c
->
bulkËn
 >ğ
PROTO_MBULK_BIG_ARG
)

1326 
»maššg
 = ()(
c
->
bulkËn
+2)-
	`sd¦’
(c->
qu”ybuf
);

1328 ià(
»maššg
 < 
»adËn
)„eadlen =„emaining;

1331 
qbËn
 = 
	`sd¦’
(
c
->
qu”ybuf
);

1332 ià(
c
->
qu”ybuf_³ak
 < 
qbËn
) c->querybuf_peak = qblen;

1333 
c
->
qu”ybuf
 = 
	`sdsMakeRoomFÜ
(c->qu”ybuf, 
»adËn
);

1334 
Ä—d
 = 
	`»ad
(
fd
, 
c
->
qu”ybuf
+
qbËn
, 
»adËn
);

1335 ià(
Ä—d
 == -1) {

1336 ià(
”ºo
 =ğ
EAGAIN
) {

1339 
	`£rv”Log
(
LL_VERBOSE
, "R—dšg from cl›Á: %s",
	`¡»¼Ü
(
”ºo
));

1340 
	`ä“Cl›Á
(
c
);

1343 } ià(
Ä—d
 == 0) {

1344 
	`£rv”Log
(
LL_VERBOSE
, "Client closed connection");

1345 
	`ä“Cl›Á
(
c
);

1349 
	`sdsInüL’
(
c
->
qu”ybuf
,
Ä—d
);

1350 
c
->
Ï¡š‹¿ùiÚ
 = 
£rv”
.
unixtime
;

1351 ià(
c
->
æags
 & 
CLIENT_MASTER
èc->
»¶off
 +ğ
Ä—d
;

1352 
£rv”
.
¡©_Ãt_šput_by‹s
 +ğ
Ä—d
;

1353 ià(
	`sd¦’
(
c
->
qu”ybuf
è> 
£rv”
.
ş›Á_max_qu”ybuf_Ën
) {

1354 
sds
 
ci
 = 
	`ÿtCl›ÁInfoSŒšg
(
	`sd£m±y
(),
c
), 
by‹s
 = sdsempty();

1356 
by‹s
 = 
	`sdsÿŒ•r
(by‹s,
c
->
qu”ybuf
,64);

1357 
	`£rv”Log
(
LL_WARNING
,"Closšg cl›Áh©„—ched max qu”y bufã¸Ëngth: % (qbuàš™ŸÈby‹s: %s)", 
ci
, 
by‹s
);

1358 
	`sdsä“
(
ci
);

1359 
	`sdsä“
(
by‹s
);

1360 
	`ä“Cl›Á
(
c
);

1363 
	`´oûssIÅutBufãr
(
c
);

1364 
	}
}

1366 
	$g‘Cl›ÁsMaxBufãrs
(*
lÚge¡_ouut_li¡
,

1367 *
bigge¡_šput_bufãr
) {

1368 
ş›Á
 *
c
;

1369 
li¡Node
 *
Ê
;

1370 
li¡I‹r
 
li
;

1371 
lŞ
 = 0, 
bib
 = 0;

1373 
	`li¡Rewšd
(
£rv”
.
ş›Ás
,&
li
);

1374 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

1375 
c
 = 
	`li¡NodeV®ue
(
Ê
);

1377 ià(
	`li¡L’gth
(
c
->
»¶y
è> 
lŞ
)†ol =†istLength(c->reply);

1378 ià(
	`sd¦’
(
c
->
qu”ybuf
è> 
bib
) bib = sdslen(c->querybuf);

1380 *
lÚge¡_ouut_li¡
 = 
lŞ
;

1381 *
bigge¡_šput_bufãr
 = 
bib
;

1382 
	}
}

1395 
	$g’Cl›ÁP“rId
(
ş›Á
 *ş›Á, *
³”id
,

1396 
size_t
 
³”id_Ën
) {

1397 ià(
ş›Á
->
æags
 & 
CLIENT_UNIX_SOCKET
) {

1399 
	`¢´štf
(
³”id
,
³”id_Ën
,"%s:0",
£rv”
.
unixsock‘
);

1402 
	`ª‘FÜm©P“r
(
ş›Á
->
fd
,
³”id
,
³”id_Ën
);

1404 
	}
}

1410 *
	$g‘Cl›ÁP“rId
(
ş›Á
 *
c
) {

1411 
³”id
[
NET_PEER_ID_LEN
];

1413 ià(
c
->
³”id
 =ğ
NULL
) {

1414 
	`g’Cl›ÁP“rId
(
c
,
³”id
,(peerid));

1415 
c
->
³”id
 = 
	`sd¢ew
(peerid);

1417  
c
->
³”id
;

1418 
	}
}

1422 
sds
 
	$ÿtCl›ÁInfoSŒšg
(
sds
 
s
, 
ş›Á
 *client) {

1423 
æags
[16], 
ev’ts
[3], *
p
;

1424 
emask
;

1426 
p
 = 
æags
;

1427 ià(
ş›Á
->
æags
 & 
CLIENT_SLAVE
) {

1428 ià(
ş›Á
->
æags
 & 
CLIENT_MONITOR
)

1429 *
p
++ = 'O';

1431 *
p
++ = 'S';

1433 ià(
ş›Á
->
æags
 & 
CLIENT_MASTER
è*
p
++ = 'M';

1434 ià(
ş›Á
->
æags
 & 
CLIENT_MULTI
è*
p
++ = 'x';

1435 ià(
ş›Á
->
æags
 & 
CLIENT_BLOCKED
è*
p
++ = 'b';

1436 ià(
ş›Á
->
æags
 & 
CLIENT_DIRTY_CAS
è*
p
++ = 'd';

1437 ià(
ş›Á
->
æags
 & 
CLIENT_CLOSE_AFTER_REPLY
è*
p
++ = 'c';

1438 ià(
ş›Á
->
æags
 & 
CLIENT_UNBLOCKED
è*
p
++ = 'u';

1439 ià(
ş›Á
->
æags
 & 
CLIENT_CLOSE_ASAP
è*
p
++ = 'A';

1440 ià(
ş›Á
->
æags
 & 
CLIENT_UNIX_SOCKET
è*
p
++ = 'U';

1441 ià(
ş›Á
->
æags
 & 
CLIENT_READONLY
è*
p
++ = 'r';

1442 ià(
p
 =ğ
æags
) *p++ = 'N';

1443 *
p
++ = '\0';

1445 
emask
 = 
ş›Á
->
fd
 =ğ-1 ? 0 : 
	`«G‘FeEv’ts
(
£rv”
.
–
,client->fd);

1446 
p
 = 
ev’ts
;

1447 ià(
emask
 & 
AE_READABLE
è*
p
++ = 'r';

1448 ià(
emask
 & 
AE_WRITABLE
è*
p
++ = 'w';

1449 *
p
 = '\0';

1450  
	`sdsÿtfmt
(
s
,

1452 (è
ş›Á
->
id
,

1453 
	`g‘Cl›ÁP“rId
(
ş›Á
),

1454 
ş›Á
->
fd
,

1455 
ş›Á
->
Çme
 ? (*)ş›Á->Çme->
±r
 : "",

1456 ()(
£rv”
.
unixtime
 - 
ş›Á
->
ùime
),

1457 ()(
£rv”
.
unixtime
 - 
ş›Á
->
Ï¡š‹¿ùiÚ
),

1458 
æags
,

1459 
ş›Á
->
db
->
id
,

1460 (è
	`diùSize
(
ş›Á
->
pubsub_chªÃls
),

1461 (è
	`li¡L’gth
(
ş›Á
->
pubsub_·‰”ns
),

1462 (
ş›Á
->
æags
 & 
CLIENT_MULTI
è? cl›Á->
m¡©e
.
couÁ
 : -1,

1463 (è
	`sd¦’
(
ş›Á
->
qu”ybuf
),

1464 (è
	`sd§va
(
ş›Á
->
qu”ybuf
),

1465 (è
ş›Á
->
buåos
,

1466 (è
	`li¡L’gth
(
ş›Á
->
»¶y
),

1467 (è
	`g‘Cl›ÁOuutBufãrMemÜyU§ge
(
ş›Á
),

1468 
ev’ts
,

1469 
ş›Á
->
Ï¡cmd
 ? cl›Á->Ï¡cmd->
Çme
 : "NULL");

1470 
	}
}

1472 
sds
 
	$g‘AÎCl›ÁsInfoSŒšg
() {

1473 
li¡Node
 *
Ê
;

1474 
li¡I‹r
 
li
;

1475 
ş›Á
 *client;

1476 
sds
 
o
 = 
	`sd¢ewËn
(
NULL
,200*
	`li¡L’gth
(
£rv”
.
ş›Ás
));

1477 
	`sdsş—r
(
o
);

1478 
	`li¡Rewšd
(
£rv”
.
ş›Ás
,&
li
);

1479 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

1480 
ş›Á
 = 
	`li¡NodeV®ue
(
Ê
);

1481 
o
 = 
	`ÿtCl›ÁInfoSŒšg
(o,
ş›Á
);

1482 
o
 = 
	`sdsÿ’
(o,"\n",1);

1484  
o
;

1485 
	}
}

1487 
	$ş›ÁCommªd
(
ş›Á
 *
c
) {

1488 
li¡Node
 *
Ê
;

1489 
li¡I‹r
 
li
;

1490 
ş›Á
 *client;

1492 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"li¡"è&& c->
¬gc
 == 2) {

1494 
sds
 
o
 = 
	`g‘AÎCl›ÁsInfoSŒšg
();

1495 
	`addR•lyBulkCBufãr
(
c
,
o
,
	`sd¦’
(o));

1496 
	`sdsä“
(
o
);

1497 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"»¶y"è&& c->
¬gc
 == 3) {

1499 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"on")) {

1500 
c
->
æags
 &ğ~(
CLIENT_REPLY_SKIP
|
CLIENT_REPLY_OFF
);

1501 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1502 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"off")) {

1503 
c
->
æags
 |ğ
CLIENT_REPLY_OFF
;

1504 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"skip")) {

1505 ià(!(
c
->
æags
 & 
CLIENT_REPLY_OFF
))

1506 
c
->
æags
 |ğ
CLIENT_REPLY_SKIP_NEXT
;

1508 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

1511 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"kill")) {

1514 *
addr
 = 
NULL
;

1515 
ty³
 = -1;

1516 
ušt64_t
 
id
 = 0;

1517 
skme
 = 1;

1518 
kËd
 = 0, 
şo£_this_ş›Á
 = 0;

1520 ià(
c
->
¬gc
 == 3) {

1522 
addr
 = 
c
->
¬gv
[2]->
±r
;

1523 
skme
 = 0;

1524 } ià(
c
->
¬gc
 > 3) {

1525 
i
 = 2;

1528 
i
 < 
c
->
¬gc
) {

1529 
mÜ—rgs
 = 
c
->
¬gc
 > 
i
+1;

1531 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
i
]->
±r
,"id"è&& 
mÜ—rgs
) {

1532 
tmp
;

1534 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[
i
+1],&
tmp
,
NULL
)

1535 !ğ
C_OK
) ;

1536 
id
 = 
tmp
;

1537 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
i
]->
±r
,"ty³"è&& 
mÜ—rgs
) {

1538 
ty³
 = 
	`g‘Cl›ÁTy³ByName
(
c
->
¬gv
[
i
+1]->
±r
);

1539 ià(
ty³
 == -1) {

1540 
	`addR•lyE¼ÜFÜm©
(
c
,"Unknown clientype '%s'",

1541 (*è
c
->
¬gv
[
i
+1]->
±r
);

1544 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
i
]->
±r
,"addr"è&& 
mÜ—rgs
) {

1545 
addr
 = 
c
->
¬gv
[
i
+1]->
±r
;

1546 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
i
]->
±r
,"skme"è&& 
mÜ—rgs
) {

1547 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
i
+1]->
±r
,"yes")) {

1548 
skme
 = 1;

1549 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
i
+1]->
±r
,"no")) {

1550 
skme
 = 0;

1552 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

1556 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

1559 
i
 += 2;

1562 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

1567 
	`li¡Rewšd
(
£rv”
.
ş›Ás
,&
li
);

1568 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

1569 
ş›Á
 = 
	`li¡NodeV®ue
(
Ê
);

1570 ià(
addr
 && 
	`¡rcmp
(
	`g‘Cl›ÁP“rId
(
ş›Á
),addr) != 0) ;

1571 ià(
ty³
 !ğ-1 && 
	`g‘Cl›ÁTy³
(
ş›Á
) !=ype) ;

1572 ià(
id
 !ğ0 && 
ş›Á
->id != id) ;

1573 ià(
c
 =ğ
ş›Á
 && 
skme
) ;

1576 ià(
c
 =ğ
ş›Á
) {

1577 
şo£_this_ş›Á
 = 1;

1579 
	`ä“Cl›Á
(
ş›Á
);

1581 
kËd
++;

1585 ià(
c
->
¬gc
 == 3) {

1586 ià(
kËd
 == 0)

1587 
	`addR•lyE¼Ü
(
c
,"No such client");

1589 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1591 
	`addR•lyLÚgLÚg
(
c
,
kËd
);

1596 ià(
şo£_this_ş›Á
è
c
->
æags
 |ğ
CLIENT_CLOSE_AFTER_REPLY
;

1597 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"£Šame"è&& c->
¬gc
 == 3) {

1598 
j
, 
Ën
 = 
	`sd¦’
(
c
->
¬gv
[2]->
±r
);

1599 *
p
 = 
c
->
¬gv
[2]->
±r
;

1603 ià(
Ën
 == 0) {

1604 ià(
c
->
Çme
è
	`deüRefCouÁ
(c->name);

1605 
c
->
Çme
 = 
NULL
;

1606 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1613 
j
 = 0; j < 
Ën
; j++) {

1614 ià(
p
[
j
] < '!' ||…[j] > '~') {

1615 
	`addR•lyE¼Ü
(
c
,

1621 ià(
c
->
Çme
è
	`deüRefCouÁ
(c->name);

1622 
c
->
Çme
 = c->
¬gv
[2];

1623 
	`šüRefCouÁ
(
c
->
Çme
);

1624 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1625 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"g‘Çme"è&& c->
¬gc
 == 2) {

1626 ià(
c
->
Çme
)

1627 
	`addR•lyBulk
(
c
,c->
Çme
);

1629 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

1630 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"·u£"è&& c->
¬gc
 == 3) {

1631 
du¿tiÚ
;

1633 ià(
	`g‘TimeoutFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
du¿tiÚ
,
UNIT_MILLISECONDS
)

1634 !ğ
C_OK
) ;

1635 
	`·u£Cl›Ás
(
du¿tiÚ
);

1636 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1638 
	`addR•lyE¼Ü
(
c
, "Syntaxƒrror,ry CLIENT (LIST | KILL | GETNAME | SETNAME | PAUSE | REPLY)");

1640 
	}
}

1651 
	$£cur™yW¬nšgCommªd
(
ş›Á
 *
c
) {

1652 
time_t
 
logged_time
;

1653 
time_t
 
now
 = 
	`time
(
NULL
);

1655 ià(
	`Ïbs
(
now
-
logged_time
) > 60) {

1656 
	`£rv”Log
(
LL_WARNING
,"Possible SECURITY ATTACK detected. It†ooks†ike somebody is sending POST or Host: commandso Redis. This is†ikely dueo‡n‡ttacker‡ttemptingo use Cross Protocol Scriptingo compromise your Redis instance. Connection‡borted.");

1657 
logged_time
 = 
now
;

1659 
	`ä“Cl›ÁAsync
(
c
);

1660 
	}
}

1665 
	$»wr™eCl›ÁCommªdVeùÜ
(
ş›Á
 *
c
, 
¬gc
, ...) {

1666 
va_li¡
 
­
;

1667 
j
;

1668 
robj
 **
¬gv
;

1670 
¬gv
 = 
	`zm®loc
((
robj
*)*
¬gc
);

1671 
	`va_¡¬t
(
­
,
¬gc
);

1672 
j
 = 0; j < 
¬gc
; j++) {

1673 
robj
 *
a
;

1675 
a
 = 
	`va_¬g
(
­
, 
robj
*);

1676 
¬gv
[
j
] = 
a
;

1677 
	`šüRefCouÁ
(
a
);

1682 
j
 = 0; j < 
c
->
¬gc
; j++è
	`deüRefCouÁ
(c->
¬gv
[j]);

1683 
	`zä“
(
c
->
¬gv
);

1685 
c
->
¬gv
 =‡rgv;

1686 
c
->
¬gc
 =‡rgc;

1687 
c
->
cmd
 = 
	`lookupCommªdOrOrigš®
(c->
¬gv
[0]->
±r
);

1688 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,c->
cmd
 != NULL);

1689 
	`va_’d
(
­
);

1690 
	}
}

1693 
	$»¶aûCl›ÁCommªdVeùÜ
(
ş›Á
 *
c
, 
¬gc
, 
robj
 **
¬gv
) {

1694 
	`ä“Cl›ÁArgv
(
c
);

1695 
	`zä“
(
c
->
¬gv
);

1696 
c
->
¬gv
 =‡rgv;

1697 
c
->
¬gc
 =‡rgc;

1698 
c
->
cmd
 = 
	`lookupCommªdOrOrigš®
(c->
¬gv
[0]->
±r
);

1699 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,c->
cmd
 != NULL);

1700 
	}
}

1713 
	$»wr™eCl›ÁCommªdArgum’t
(
ş›Á
 *
c
, 
i
, 
robj
 *
Ãwv®
) {

1714 
robj
 *
Şdv®
;

1716 ià(
i
 >ğ
c
->
¬gc
) {

1717 
c
->
¬gv
 = 
	`z»®loc
(c->¬gv,(
robj
*)*(
i
+1));

1718 
c
->
¬gc
 = 
i
+1;

1719 
c
->
¬gv
[
i
] = 
NULL
;

1721 
Şdv®
 = 
c
->
¬gv
[
i
];

1722 
c
->
¬gv
[
i
] = 
Ãwv®
;

1723 
	`šüRefCouÁ
(
Ãwv®
);

1724 ià(
Şdv®
è
	`deüRefCouÁ
(oldval);

1727 ià(
i
 == 0) {

1728 
c
->
cmd
 = 
	`lookupCommªdOrOrigš®
(c->
¬gv
[0]->
±r
);

1729 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,c->
cmd
 != NULL);

1731 
	}
}

1746 
	$g‘Cl›ÁOuutBufãrMemÜyU§ge
(
ş›Á
 *
c
) {

1747 
li¡_™em_size
 = (
li¡Node
)+(
robj
);

1749  
c
->
»¶y_by‹s
 + (
li¡_™em_size
*
	`li¡L’gth
(c->
»¶y
));

1750 
	}
}

1761 
	$g‘Cl›ÁTy³
(
ş›Á
 *
c
) {

1762 ià(
c
->
æags
 & 
CLIENT_MASTER
è 
CLIENT_TYPE_MASTER
;

1763 ià((
c
->
æags
 & 
CLIENT_SLAVE
è&& !(c->æag & 
CLIENT_MONITOR
))

1764  
CLIENT_TYPE_SLAVE
;

1765 ià(
c
->
æags
 & 
CLIENT_PUBSUB
è 
CLIENT_TYPE_PUBSUB
;

1766  
CLIENT_TYPE_NORMAL
;

1767 
	}
}

1769 
	$g‘Cl›ÁTy³ByName
(*
Çme
) {

1770 ià(!
	`¡rÿ£cmp
(
Çme
,"nÜm®")è 
CLIENT_TYPE_NORMAL
;

1771 ià(!
	`¡rÿ£cmp
(
Çme
,"¦ave")è 
CLIENT_TYPE_SLAVE
;

1772 ià(!
	`¡rÿ£cmp
(
Çme
,"pubsub")è 
CLIENT_TYPE_PUBSUB
;

1773 ià(!
	`¡rÿ£cmp
(
Çme
,"ma¡”")è 
CLIENT_TYPE_MASTER
;

1775 
	}
}

1777 *
	$g‘Cl›ÁTy³Name
(
şass
) {

1778 
şass
) {

1779 
CLIENT_TYPE_NORMAL
:  "normal";

1780 
CLIENT_TYPE_SLAVE
:  "slave";

1781 
CLIENT_TYPE_PUBSUB
:  "pubsub";

1782 
CLIENT_TYPE_MASTER
:  "master";

1783 :  
NULL
;

1785 
	}
}

1793 
	$checkCl›ÁOuutBufãrLim™s
(
ş›Á
 *
c
) {

1794 
soá
 = 0, 
h¬d
 = 0, 
şass
;

1795 
u£d_mem
 = 
	`g‘Cl›ÁOuutBufãrMemÜyU§ge
(
c
);

1797 
şass
 = 
	`g‘Cl›ÁTy³
(
c
);

1800 ià(
şass
 =ğ
CLIENT_TYPE_MASTER
èşas ğ
CLIENT_TYPE_NORMAL
;

1802 ià(
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
h¬d_lim™_by‹s
 &&

1803 
u£d_mem
 >ğ
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
h¬d_lim™_by‹s
)

1804 
h¬d
 = 1;

1805 ià(
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
soá_lim™_by‹s
 &&

1806 
u£d_mem
 >ğ
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
soá_lim™_by‹s
)

1807 
soá
 = 1;

1811 ià(
soá
) {

1812 ià(
c
->
obuf_soá_lim™_»ached_time
 == 0) {

1813 
c
->
obuf_soá_lim™_»ached_time
 = 
£rv”
.
unixtime
;

1814 
soá
 = 0;

1816 
time_t
 
–­£d
 = 
£rv”
.
unixtime
 - 
c
->
obuf_soá_lim™_»ached_time
;

1818 ià(
–­£d
 <=

1819 
£rv”
.
ş›Á_obuf_lim™s
[
şass
].
soá_lim™_£cÚds
) {

1820 
soá
 = 0;

1826 
c
->
obuf_soá_lim™_»ached_time
 = 0;

1828  
soá
 || 
h¬d
;

1829 
	}
}

1838 
	$asyncClo£Cl›ÁOnOuutBufãrLim™R—ched
(
ş›Á
 *
c
) {

1839 
	`£rv”As£¹
(
c
->
»¶y_by‹s
 < 
SIZE_MAX
-(1024*64));

1840 ià(
c
->
»¶y_by‹s
 =ğ0 || c->
æags
 & 
CLIENT_CLOSE_ASAP
) ;

1841 ià(
	`checkCl›ÁOuutBufãrLim™s
(
c
)) {

1842 
sds
 
ş›Á
 = 
	`ÿtCl›ÁInfoSŒšg
(
	`sd£m±y
(),
c
);

1844 
	`ä“Cl›ÁAsync
(
c
);

1845 
	`£rv”Log
(
LL_WARNING
,"Cl›Á % scheduËdØbşo£d ASAP fÜ ov”comšg oàouuˆbufã¸lim™s.", 
ş›Á
);

1846 
	`sdsä“
(
ş›Á
);

1848 
	}
}

1854 
	$æushSÏvesOuutBufãrs
() {

1855 
li¡I‹r
 
li
;

1856 
li¡Node
 *
Ê
;

1858 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

1859 (
Ê
 = 
	`li¡Next
(&
li
))) {

1860 
ş›Á
 *
¦ave
 = 
	`li¡NodeV®ue
(
Ê
);

1861 
ev’ts
;

1869 
ev’ts
 = 
	`«G‘FeEv’ts
(
£rv”
.
–
,
¦ave
->
fd
);

1870 ià(
ev’ts
 & 
AE_WRITABLE
 &&

1871 
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_ONLINE
 &&

1872 
	`ş›ÁHasP’dšgR•l›s
(
¦ave
))

1874 
	`wr™eToCl›Á
(
¦ave
->
fd
,slave,0);

1877 
	}
}

1896 
	$·u£Cl›Ás
(
m¡ime_t
 
’d
) {

1897 ià(!
£rv”
.
ş›Ás_·u£d
 || 
’d
 > s”v”.
ş›Ás_·u£_’d_time
)

1898 
£rv”
.
ş›Ás_·u£_’d_time
 = 
’d
;

1899 
£rv”
.
ş›Ás_·u£d
 = 1;

1900 
	}
}

1904 
	$ş›ÁsA»Pau£d
() {

1905 ià(
£rv”
.
ş›Ás_·u£d
 &&

1906 
£rv”
.
ş›Ás_·u£_’d_time
 < s”v”.
m¡ime
)

1908 
li¡Node
 *
Ê
;

1909 
li¡I‹r
 
li
;

1910 
ş›Á
 *
c
;

1912 
£rv”
.
ş›Ás_·u£d
 = 0;

1916 
	`li¡Rewšd
(
£rv”
.
ş›Ás
,&
li
);

1917 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

1918 
c
 = 
	`li¡NodeV®ue
(
Ê
);

1922 ià(
c
->
æags
 & (
CLIENT_SLAVE
|
CLIENT_BLOCKED
)) ;

1923 
c
->
æags
 |ğ
CLIENT_UNBLOCKED
;

1924 
	`li¡AddNodeTa
(
£rv”
.
unblocked_ş›Ás
,
c
);

1927  
£rv”
.
ş›Ás_·u£d
;

1928 
	}
}

1942 
	$´oûssEv’tsWheBlocked
() {

1943 
™”©iÚs
 = 4;

1944 
couÁ
 = 0;

1945 
™”©iÚs
--) {

1946 
ev’ts
 = 0;

1947 
ev’ts
 +ğ
	`«ProûssEv’ts
(
£rv”
.
–
, 
AE_FILE_EVENTS
|
AE_DONT_WAIT
);

1948 
ev’ts
 +ğ
	`hªdËCl›ÁsW™hP’dšgWr™es
();

1949 ià(!
ev’ts
) ;

1950 
couÁ
 +ğ
ev’ts
;

1952  
couÁ
;

1953 
	}
}

	@src/notify.c

30 
	~"£rv”.h
"

40 
	$key¥aûEv’tsSŒšgToFÏgs
(*
şas£s
) {

41 *
p
 = 
şas£s
;

42 
c
, 
æags
 = 0;

44 (
c
 = *
p
++) != '\0') {

45 
c
) {

46 'A': 
æags
 |ğ
NOTIFY_ALL
; ;

47 'g': 
æags
 |ğ
NOTIFY_GENERIC
; ;

48 '$': 
æags
 |ğ
NOTIFY_STRING
; ;

49 'l': 
æags
 |ğ
NOTIFY_LIST
; ;

50 's': 
æags
 |ğ
NOTIFY_SET
; ;

51 'h': 
æags
 |ğ
NOTIFY_HASH
; ;

52 'z': 
æags
 |ğ
NOTIFY_ZSET
; ;

53 'x': 
æags
 |ğ
NOTIFY_EXPIRED
; ;

54 'e': 
æags
 |ğ
NOTIFY_EVICTED
; ;

55 'K': 
æags
 |ğ
NOTIFY_KEYSPACE
; ;

56 'E': 
æags
 |ğ
NOTIFY_KEYEVENT
; ;

60  
æags
;

61 
	}
}

67 
sds
 
	$key¥aûEv’tsFÏgsToSŒšg
(
æags
) {

68 
sds
 
»s
;

70 
»s
 = 
	`sd£m±y
();

71 ià((
æags
 & 
NOTIFY_ALL
) == NOTIFY_ALL) {

72 
»s
 = 
	`sdsÿ’
(res,"A",1);

74 ià(
æags
 & 
NOTIFY_GENERIC
è
»s
 = 
	`sdsÿ’
(res,"g",1);

75 ià(
æags
 & 
NOTIFY_STRING
è
»s
 = 
	`sdsÿ’
(res,"$",1);

76 ià(
æags
 & 
NOTIFY_LIST
è
»s
 = 
	`sdsÿ’
(res,"l",1);

77 ià(
æags
 & 
NOTIFY_SET
è
»s
 = 
	`sdsÿ’
(res,"s",1);

78 ià(
æags
 & 
NOTIFY_HASH
è
»s
 = 
	`sdsÿ’
(res,"h",1);

79 ià(
æags
 & 
NOTIFY_ZSET
è
»s
 = 
	`sdsÿ’
(res,"z",1);

80 ià(
æags
 & 
NOTIFY_EXPIRED
è
»s
 = 
	`sdsÿ’
(res,"x",1);

81 ià(
æags
 & 
NOTIFY_EVICTED
è
»s
 = 
	`sdsÿ’
(res,"e",1);

83 ià(
æags
 & 
NOTIFY_KEYSPACE
è
»s
 = 
	`sdsÿ’
(res,"K",1);

84 ià(
æags
 & 
NOTIFY_KEYEVENT
è
»s
 = 
	`sdsÿ’
(res,"E",1);

85  
»s
;

86 
	}
}

95 
	$nÙifyKey¥aûEv’t
(
ty³
, *
ev’t
, 
robj
 *
key
, 
dbid
) {

96 
sds
 
chª
;

97 
robj
 *
chªobj
, *
ev’tobj
;

98 
Ën
 = -1;

99 
buf
[24];

102 ià(!(
£rv”
.
nÙify_key¥aû_ev’ts
 & 
ty³
)) ;

104 
ev’tobj
 = 
	`ü—‹SŒšgObjeù
(
ev’t
,
	`¡¾’
(event));

107 ià(
£rv”
.
nÙify_key¥aû_ev’ts
 & 
NOTIFY_KEYSPACE
) {

108 
chª
 = 
	`sd¢ewËn
("__keyspace@",11);

109 
Ën
 = 
	`Î2¡ršg
(
buf
,(buf),
dbid
);

110 
chª
 = 
	`sdsÿ’
(chª, 
buf
, 
Ën
);

111 
chª
 = 
	`sdsÿ’
(chan, "__:", 3);

112 
chª
 = 
	`sdsÿtsds
(chª, 
key
->
±r
);

113 
chªobj
 = 
	`ü—‹Objeù
(
OBJ_STRING
, 
chª
);

114 
	`pubsubPublishMes§ge
(
chªobj
, 
ev’tobj
);

115 
	`deüRefCouÁ
(
chªobj
);

119 ià(
£rv”
.
nÙify_key¥aû_ev’ts
 & 
NOTIFY_KEYEVENT
) {

120 
chª
 = 
	`sd¢ewËn
("__keyevent@",11);

121 ià(
Ën
 =ğ-1èËÀğ
	`Î2¡ršg
(
buf
,(buf),
dbid
);

122 
chª
 = 
	`sdsÿ’
(chª, 
buf
, 
Ën
);

123 
chª
 = 
	`sdsÿ’
(chan, "__:", 3);

124 
chª
 = 
	`sdsÿtsds
(chª, 
ev’tobj
->
±r
);

125 
chªobj
 = 
	`ü—‹Objeù
(
OBJ_STRING
, 
chª
);

126 
	`pubsubPublishMes§ge
(
chªobj
, 
key
);

127 
	`deüRefCouÁ
(
chªobj
);

129 
	`deüRefCouÁ
(
ev’tobj
);

130 
	}
}

	@src/object.c

31 
	~"£rv”.h
"

32 
	~<m©h.h
>

33 
	~<ùy³.h
>

35 #ifdeà
USE_PMDK


36 
	~"obj.h
"

37 
	~"libpmemobj.h
"

38 
	~"libpmem.h
"

41 #ifdeà
__CYGWIN__


42 
	#¡¹Şd
(
a
,
b
è(()
	`¡¹od
(×),(b)))

	)

45 
robj
 *
	$ü—‹Objeù
(
ty³
, *
±r
) {

46 
robj
 *
o
 = 
	`zm®loc
((*o));

47 
o
->
ty³
 =ype;

48 
o
->
’codšg
 = 
OBJ_ENCODING_RAW
;

49 
o
->
±r
 =…tr;

50 
o
->
»fcouÁ
 = 1;

53 
o
->
Ìu
 = 
	`LRU_CLOCK
();

54  
o
;

55 
	}
}

57 #ifdeà
USE_PMDK


58 
robj
 *
	$ü—‹ObjeùPM
(
ty³
, *
±r
) {

59 
robj
 *
o
 = 
	`zm®loc
((*o));

61 
o
->
ty³
 =ype;

62 
o
->
’codšg
 = 
OBJ_ENCODING_RAW
;

63 
o
->
±r
 =…tr;

64 
o
->
»fcouÁ
 = 1;

67 
o
->
Ìu
 = 
	`LRU_CLOCK
();

68  (
robj
 *)
o
;

69 
	}
}

74 
robj
 *
	$ü—‹RawSŒšgObjeù
(cÚ¡ *
±r
, 
size_t
 
Ën
) {

75  
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ewËn
(
±r
,
Ën
));

76 
	}
}

78 #ifdeà
USE_PMDK


82 
robj
 *
	$ü—‹RawSŒšgObjeùPM
(cÚ¡ *
±r
, 
size_t
 
Ën
) {

83  
	`ü—‹ObjeùPM
(
OBJ_STRING
,
	`sd¢ewËnPM
(
±r
,
Ën
));

84 
	}
}

90 
robj
 *
	$ü—‹EmbeddedSŒšgObjeù
(cÚ¡ *
±r
, 
size_t
 
Ën
) {

91 
robj
 *
o
 = 
	`zm®loc
(Ôobj)+(
sdshdr8
)+
Ën
+1);

92 
sdshdr8
 *
sh
 = (*)(
o
+1);

94 
o
->
ty³
 = 
OBJ_STRING
;

95 
o
->
’codšg
 = 
OBJ_ENCODING_EMBSTR
;

96 
o
->
±r
 = 
sh
+1;

97 
o
->
»fcouÁ
 = 1;

98 
o
->
Ìu
 = 
	`LRU_CLOCK
();

100 
sh
->
Ën
 =†en;

101 
sh
->
®loc
 = 
Ën
;

102 
sh
->
æags
 = 
SDS_TYPE_8
;

103 ià(
±r
) {

104 
	`memıy
(
sh
->
buf
,
±r
,
Ën
);

105 
sh
->
buf
[
Ën
] = '\0';

107 
	`mem£t
(
sh
->
buf
,0,
Ën
+1);

109  
o
;

110 
	}
}

112 #ifdeà
USE_PMDK


117 
robj
 *
	$ü—‹EmbeddedSŒšgObjeùPM
(cÚ¡ *
±r
, 
size_t
 
Ën
) {

118 
robj
 *
o
 = 
	`zm®loc
(Ôobj)+(
sdshdr8
)+
Ën
+1);

119 
sdshdr8
 *
sh
 = (*)(
o
+1);

121 
o
->
ty³
 = 
OBJ_STRING
;

122 
o
->
’codšg
 = 
OBJ_ENCODING_EMBSTR
;

123 
o
->
±r
 = 
sh
+1;

124 
o
->
»fcouÁ
 = 1;

125 
o
->
Ìu
 = 
	`LRU_CLOCK
();

127 
sh
->
Ën
 =†en;

128 
sh
->
®loc
 = 
Ën
;

129 
sh
->
æags
 = 
SDS_TYPE_8
;

130 ià(
±r
) {

131 
	`memıy
(
sh
->
buf
,
±r
,
Ën
);

132 
sh
->
buf
[
Ën
] = '\0';

134 
	`mem£t
(
sh
->
buf
,0,
Ën
+1);

136  (
robj
 *)
o
;

137 
	}
}

146 
	#OBJ_ENCODING_EMBSTR_SIZE_LIMIT
 44

	)

147 
robj
 *
	$ü—‹SŒšgObjeù
(cÚ¡ *
±r
, 
size_t
 
Ën
) {

148 ià(
Ën
 <ğ
OBJ_ENCODING_EMBSTR_SIZE_LIMIT
)

149  
	`ü—‹EmbeddedSŒšgObjeù
(
±r
,
Ën
);

151  
	`ü—‹RawSŒšgObjeù
(
±r
,
Ën
);

152 
	}
}

154 
robj
 *
	$ü—‹SŒšgObjeùFromLÚgLÚg
(
v®ue
) {

155 
robj
 *
o
;

156 ià(
v®ue
 >ğ0 && v®u< 
OBJ_SHARED_INTEGERS
) {

157 
	`šüRefCouÁ
(
sh¬ed
.
š‹g”s
[
v®ue
]);

158 
o
 = 
sh¬ed
.
š‹g”s
[
v®ue
];

160 ià(
v®ue
 >ğ
LONG_MIN
 && v®u<ğ
LONG_MAX
) {

161 
o
 = 
	`ü—‹Objeù
(
OBJ_STRING
, 
NULL
);

162 
o
->
’codšg
 = 
OBJ_ENCODING_INT
;

163 
o
->
±r
 = (*)(()
v®ue
);

165 
o
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sdsäomlÚglÚg
(
v®ue
));

168  
o
;

169 
	}
}

177 
robj
 *
	$ü—‹SŒšgObjeùFromLÚgDoubË
(
v®ue
, 
humªä›ndly
) {

178 
buf
[256];

179 
Ën
;

181 ià(
	`isšf
(
v®ue
)) {

184 ià(
v®ue
 > 0) {

185 
	`memıy
(
buf
,"inf",3);

186 
Ën
 = 3;

188 
	`memıy
(
buf
,"-inf",4);

189 
Ën
 = 4;

191 } ià(
humªä›ndly
) {

197 
Ën
 = 
	`¢´štf
(
buf
,(buf),"%.17Lf", 
v®ue
);

199 ià(
	`¡rchr
(
buf
,'.'è!ğ
NULL
) {

200 *
p
 = 
buf
+
Ën
-1;

201 *
p
 == '0') {

202 
p
--;

203 
Ën
--;

205 ià(*
p
 =ğ'.'è
Ën
--;

208 
Ën
 = 
	`¢´štf
(
buf
,(buf),"%.17Lg", 
v®ue
);

210  
	`ü—‹SŒšgObjeù
(
buf
,
Ën
);

211 
	}
}

221 
robj
 *
	$dupSŒšgObjeù
(
robj
 *
o
) {

222 
robj
 *
d
;

224 
	`£rv”As£¹
(
o
->
ty³
 =ğ
OBJ_STRING
);

226 
o
->
’codšg
) {

227 
OBJ_ENCODING_RAW
:

228  
	`ü—‹RawSŒšgObjeù
(
o
->
±r
,
	`sd¦’
(o->ptr));

229 
OBJ_ENCODING_EMBSTR
:

230  
	`ü—‹EmbeddedSŒšgObjeù
(
o
->
±r
,
	`sd¦’
(o->ptr));

231 
OBJ_ENCODING_INT
:

232 
d
 = 
	`ü—‹Objeù
(
OBJ_STRING
, 
NULL
);

233 
d
->
’codšg
 = 
OBJ_ENCODING_INT
;

234 
d
->
±r
 = 
o
->ptr;

235  
d
;

237 
	`£rv”Pªic
("Wrongƒncoding.");

240 
	}
}

242 #ifdeà
USE_PMDK


246 
robj
 *
	$dupSŒšgObjeùPM
(
robj
 *
o
) {

247 
robj
 *
d
;

249 
	`£rv”As£¹
(
o
->
ty³
 =ğ
OBJ_STRING
);

251 
o
->
’codšg
) {

252 
OBJ_ENCODING_RAW
:

253 
OBJ_ENCODING_EMBSTR
:

254  
	`ü—‹RawSŒšgObjeùPM
(
o
->
±r
,
	`sd¦’
(o->ptr));

256 
OBJ_ENCODING_INT
:

257 
d
 = 
	`ü—‹ObjeùPM
(
OBJ_STRING
, 
NULL
);

258 
d
->
’codšg
 = 
OBJ_ENCODING_INT
;

259 
d
->
±r
 = 
o
->ptr;

260  
d
;

262 
	`£rv”Pªic
("Wrongƒncoding.");

265 
	}
}

268 
robj
 *
	$ü—‹Quickli¡Objeù
() {

269 
quickli¡
 *
l
 = 
	`quickli¡C»©e
();

270 
robj
 *
o
 = 
	`ü—‹Objeù
(
OBJ_LIST
,
l
);

271 
o
->
’codšg
 = 
OBJ_ENCODING_QUICKLIST
;

272  
o
;

273 
	}
}

275 
robj
 *
	$ü—‹Zli¡Objeù
() {

276 *
zl
 = 
	`zli¡New
();

277 
robj
 *
o
 = 
	`ü—‹Objeù
(
OBJ_LIST
,
zl
);

278 
o
->
’codšg
 = 
OBJ_ENCODING_ZIPLIST
;

279  
o
;

280 
	}
}

282 
robj
 *
	$ü—‹S‘Objeù
() {

283 
diù
 *
d
 = 
	`diùC»©e
(&
£tDiùTy³
,
NULL
);

284 
robj
 *
o
 = 
	`ü—‹Objeù
(
OBJ_SET
,
d
);

285 
o
->
’codšg
 = 
OBJ_ENCODING_HT
;

286  
o
;

287 
	}
}

289 
robj
 *
	$ü—‹IÁ£tObjeù
() {

290 
št£t
 *
is
 = 
	`št£tNew
();

291 
robj
 *
o
 = 
	`ü—‹Objeù
(
OBJ_SET
,
is
);

292 
o
->
’codšg
 = 
OBJ_ENCODING_INTSET
;

293  
o
;

294 
	}
}

296 
robj
 *
	$ü—‹HashObjeù
() {

297 *
zl
 = 
	`zli¡New
();

298 
robj
 *
o
 = 
	`ü—‹Objeù
(
OBJ_HASH
, 
zl
);

299 
o
->
’codšg
 = 
OBJ_ENCODING_ZIPLIST
;

300  
o
;

301 
	}
}

303 
robj
 *
	$ü—‹Z£tObjeù
() {

304 
z£t
 *
zs
 = 
	`zm®loc
((*zs));

305 
robj
 *
o
;

307 
zs
->
diù
 = 
	`diùC»©e
(&
z£tDiùTy³
,
NULL
);

308 
zs
->
z¦
 = 
	`z¦C»©e
();

309 
o
 = 
	`ü—‹Objeù
(
OBJ_ZSET
,
zs
);

310 
o
->
’codšg
 = 
OBJ_ENCODING_SKIPLIST
;

311  
o
;

312 
	}
}

314 
robj
 *
	$ü—‹Z£tZli¡Objeù
() {

315 *
zl
 = 
	`zli¡New
();

316 
robj
 *
o
 = 
	`ü—‹Objeù
(
OBJ_ZSET
,
zl
);

317 
o
->
’codšg
 = 
OBJ_ENCODING_ZIPLIST
;

318  
o
;

319 
	}
}

321 
	$ä“SŒšgObjeù
(
robj
 *
o
) {

322 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_RAW
) {

323 
	`sdsä“
(
o
->
±r
);

325 
	}
}

327 #ifdeà
USE_PMDK


328 
	$ä“SŒšgObjeùPM
(
robj
 *
o
) {

329 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_RAW
) {

330 
	`sdsä“PM
(
o
->
±r
);

332 
	}
}

335 
	$ä“Li¡Objeù
(
robj
 *
o
) {

336 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

337 
	`quickli¡R–—£
(
o
->
±r
);

339 
	`£rv”Pªic
("Unknown†istƒncodingype");

341 
	}
}

343 
	$ä“S‘Objeù
(
robj
 *
o
) {

344 
o
->
’codšg
) {

345 
OBJ_ENCODING_HT
:

346 
	`diùR–—£
((
diù
*è
o
->
±r
);

348 
OBJ_ENCODING_INTSET
:

349 
	`zä“
(
o
->
±r
);

352 
	`£rv”Pªic
("Unknown setƒncodingype");

354 
	}
}

356 
	$ä“Z£tObjeù
(
robj
 *
o
) {

357 
z£t
 *
zs
;

358 
o
->
’codšg
) {

359 
OBJ_ENCODING_SKIPLIST
:

360 
zs
 = 
o
->
±r
;

361 
	`diùR–—£
(
zs
->
diù
);

362 
	`z¦F»e
(
zs
->
z¦
);

363 
	`zä“
(
zs
);

365 
OBJ_ENCODING_ZIPLIST
:

366 
	`zä“
(
o
->
±r
);

369 
	`£rv”Pªic
("Unknown sorted setƒncoding");

371 
	}
}

373 
	$ä“HashObjeù
(
robj
 *
o
) {

374 
o
->
’codšg
) {

375 
OBJ_ENCODING_HT
:

376 
	`diùR–—£
((
diù
*è
o
->
±r
);

378 
OBJ_ENCODING_ZIPLIST
:

379 
	`zä“
(
o
->
±r
);

382 
	`£rv”Pªic
("Unknown hashƒncodingype");

385 
	}
}

387 
	$šüRefCouÁ
(
robj
 *
o
) {

388 
o
->
»fcouÁ
++;

389 
	}
}

391 
	$deüRefCouÁ
(
robj
 *
o
) {

392 ià(
o
->
»fcouÁ
 <ğ0è
	`£rv”Pªic
("decrRefCount‡gainst„efcount <= 0");

393 ià(
o
->
»fcouÁ
 == 1) {

394 
o
->
ty³
) {

395 
OBJ_STRING
: 
	`ä“SŒšgObjeù
(
o
); ;

396 
OBJ_LIST
: 
	`ä“Li¡Objeù
(
o
); ;

397 
OBJ_SET
: 
	`ä“S‘Objeù
(
o
); ;

398 
OBJ_ZSET
: 
	`ä“Z£tObjeù
(
o
); ;

399 
OBJ_HASH
: 
	`ä“HashObjeù
(
o
); ;

400 : 
	`£rv”Pªic
("Unknown objectype"); ;

402 
	`zä“
(
o
);

404 
o
->
»fcouÁ
--;

406 
	}
}

408 #ifdeà
USE_PMDK


409 
	$deüRefCouÁPM
(
robj
 *
o
) {

410 ià(
o
->
»fcouÁ
 <ğ0è
	`£rv”Pªic
("decrRefCount‡gainst„efcount <= 0");

411 ià(
o
->
»fcouÁ
 == 1) {

412 
o
->
ty³
) {

413 
OBJ_STRING
: 
	`ä“SŒšgObjeùPM
(
o
); ;

414 
OBJ_LIST
: 
	`ä“Li¡Objeù
(
o
); ;

415 
OBJ_SET
: 
	`ä“S‘Objeù
(
o
); ;

416 
OBJ_ZSET
: 
	`ä“Z£tObjeù
(
o
); ;

417 
OBJ_HASH
: 
	`ä“HashObjeù
(
o
); ;

418 : 
	`£rv”Pªic
("Unknown objectype"); ;

420 
	`zä“
(
o
);

422 
o
->
»fcouÁ
--;

424 
	}
}

430 
	$deüRefCouÁVoid
(*
o
) {

431 
	`deüRefCouÁ
(
o
);

432 
	}
}

446 
robj
 *
	$»£tRefCouÁ
(
robj
 *
obj
) {

447 
obj
->
»fcouÁ
 = 0;

448  
obj
;

449 
	}
}

451 
	$checkTy³
(
ş›Á
 *
c
, 
robj
 *
o
, 
ty³
) {

452 ià(
o
->
ty³
 !=ype) {

453 
	`addR•ly
(
c
,
sh¬ed
.
wrÚgty³”r
);

457 
	}
}

459 
	$isObjeùR•»£ÁabËAsLÚgLÚg
(
robj
 *
o
, *
Îv®
) {

460 
	`£rv”As£¹W™hInfo
(
NULL
,
o
,o->
ty³
 =ğ
OBJ_STRING
);

461 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

462 ià(
Îv®
è*Îv® = (è
o
->
±r
;

463  
C_OK
;

465  
	`¡ršg2Î
(
o
->
±r
,
	`sd¦’
(o->±r),
Îv®
è? 
C_OK
 : 
C_ERR
;

467 
	}
}

470 
robj
 *
	$ŒyObjeùEncodšg
(
robj
 *
o
) {

471 
v®ue
;

472 
sds
 
s
 = 
o
->
±r
;

473 
size_t
 
Ën
;

479 
	`£rv”As£¹W™hInfo
(
NULL
,
o
,o->
ty³
 =ğ
OBJ_STRING
);

484 ià(!
	`sdsEncodedObjeù
(
o
))  o;

489 ià(
o
->
»fcouÁ
 > 1)  o;

494 
Ën
 = 
	`sd¦’
(
s
);

495 ià(
Ën
 <ğ20 && 
	`¡ršg2l
(
s
,Ën,&
v®ue
)) {

500 ià((
£rv”
.
maxmemÜy
 == 0 ||

501 (
£rv”
.
maxmemÜy_pŞicy
 !ğ
MAXMEMORY_VOLATILE_LRU
 &&

502 
£rv”
.
maxmemÜy_pŞicy
 !ğ
MAXMEMORY_ALLKEYS_LRU
)) &&

503 
v®ue
 >= 0 &&

504 
v®ue
 < 
OBJ_SHARED_INTEGERS
)

506 
	`deüRefCouÁ
(
o
);

507 
	`šüRefCouÁ
(
sh¬ed
.
š‹g”s
[
v®ue
]);

508  
sh¬ed
.
š‹g”s
[
v®ue
];

510 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_RAW
è
	`sdsä“
(o->
±r
);

511 
o
->
’codšg
 = 
OBJ_ENCODING_INT
;

512 
o
->
±r
 = (*è
v®ue
;

513  
o
;

521 ià(
Ën
 <ğ
OBJ_ENCODING_EMBSTR_SIZE_LIMIT
) {

522 
robj
 *
emb
;

524 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_EMBSTR
)  o;

525 
emb
 = 
	`ü—‹EmbeddedSŒšgObjeù
(
s
,
	`sd¦’
(s));

526 
	`deüRefCouÁ
(
o
);

527  
emb
;

539 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_RAW
 &&

540 
	`sd§va
(
s
è> 
Ën
/10)

542 
o
->
±r
 = 
	`sdsRemoveF»eS·û
(o->ptr);

546  
o
;

547 
	}
}

551 
robj
 *
	$g‘DecodedObjeù
(
robj
 *
o
) {

552 
robj
 *
dec
;

554 ià(
	`sdsEncodedObjeù
(
o
)) {

555 
	`šüRefCouÁ
(
o
);

556  
o
;

558 ià(
o
->
ty³
 =ğ
OBJ_STRING
 && o->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

559 
buf
[32];

561 
	`Î2¡ršg
(
buf
,32,()
o
->
±r
);

562 
dec
 = 
	`ü—‹SŒšgObjeù
(
buf
,
	`¡¾’
(buf));

563  
dec
;

565 
	`£rv”Pªic
("Unknownƒncodingype");

567 
	}
}

577 
	#REDIS_COMPARE_BINARY
 (1<<0)

	)

578 
	#REDIS_COMPARE_COLL
 (1<<1)

	)

580 
	$com·»SŒšgObjeùsW™hFÏgs
(
robj
 *
a
,„obj *
b
, 
æags
) {

581 
	`£rv”As£¹W™hInfo
(
NULL
,
a
,a->
ty³
 =ğ
OBJ_STRING
 && 
b
->type == OBJ_STRING);

582 
buç
[128], 
bufb
[128], *
a¡r
, *
b¡r
;

583 
size_t
 
®’
, 
bËn
, 
mšËn
;

585 ià(
a
 =ğ
b
)  0;

586 ià(
	`sdsEncodedObjeù
(
a
)) {

587 
a¡r
 = 
a
->
±r
;

588 
®’
 = 
	`sd¦’
(
a¡r
);

590 
®’
 = 
	`Î2¡ršg
(
buç
,(buç),(è
a
->
±r
);

591 
a¡r
 = 
buç
;

593 ià(
	`sdsEncodedObjeù
(
b
)) {

594 
b¡r
 = 
b
->
±r
;

595 
bËn
 = 
	`sd¦’
(
b¡r
);

597 
bËn
 = 
	`Î2¡ršg
(
bufb
,(bufb),(è
b
->
±r
);

598 
b¡r
 = 
bufb
;

600 ià(
æags
 & 
REDIS_COMPARE_COLL
) {

601  
	`¡rcŞl
(
a¡r
,
b¡r
);

603 
cmp
;

605 
mšËn
 = (
®’
 < 
bËn
) ?‡len : blen;

606 
cmp
 = 
	`memcmp
(
a¡r
,
b¡r
,
mšËn
);

607 ià(
cmp
 =ğ0è 
®’
-
bËn
;

608  
cmp
;

610 
	}
}

613 
	$com·»SŒšgObjeùs
(
robj
 *
a
,„obj *
b
) {

614  
	`com·»SŒšgObjeùsW™hFÏgs
(
a
,
b
,
REDIS_COMPARE_BINARY
);

615 
	}
}

618 
	$cŞÏ‹SŒšgObjeùs
(
robj
 *
a
,„obj *
b
) {

619  
	`com·»SŒšgObjeùsW™hFÏgs
(
a
,
b
,
REDIS_COMPARE_COLL
);

620 
	}
}

626 
	$equ®SŒšgObjeùs
(
robj
 *
a
,„obj *
b
) {

627 ià(
a
->
’codšg
 =ğ
OBJ_ENCODING_INT
 &&

628 
b
->
’codšg
 =ğ
OBJ_ENCODING_INT
){

631  
a
->
±r
 =ğ
b
->ptr;

633  
	`com·»SŒšgObjeùs
(
a
,
b
) == 0;

635 
	}
}

637 
size_t
 
	$¡ršgObjeùL’
(
robj
 *
o
) {

638 
	`£rv”As£¹W™hInfo
(
NULL
,
o
,o->
ty³
 =ğ
OBJ_STRING
);

639 ià(
	`sdsEncodedObjeù
(
o
)) {

640  
	`sd¦’
(
o
->
±r
);

642  
	`sdig™s10
(()
o
->
±r
);

644 
	}
}

646 
	$g‘DoubËFromObjeù
(
robj
 *
o
, *
rg‘
) {

647 
v®ue
;

648 *
•Œ
;

650 ià(
o
 =ğ
NULL
) {

651 
v®ue
 = 0;

653 
	`£rv”As£¹W™hInfo
(
NULL
,
o
,o->
ty³
 =ğ
OBJ_STRING
);

654 ià(
	`sdsEncodedObjeù
(
o
)) {

655 
”ºo
 = 0;

656 
v®ue
 = 
	`¡¹od
(
o
->
±r
, &
•Œ
);

657 ià(
	`is¥aû
(((*)
o
->
±r
)[0]) ||

658 
•Œ
[0] != '\0' ||

659 (
”ºo
 =ğ
ERANGE
 &&

660 (
v®ue
 =ğ
HUGE_VAL
 || value == -HUGE_VAL || value == 0)) ||

661 
”ºo
 =ğ
EINVAL
 ||

662 
	`i¢ª
(
v®ue
))

663  
C_ERR
;

664 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

665 
v®ue
 = ()
o
->
±r
;

667 
	`£rv”Pªic
("Unknown stringƒncoding");

670 *
rg‘
 = 
v®ue
;

671  
C_OK
;

672 
	}
}

674 
	$g‘DoubËFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
rg‘
, cÚ¡ *
msg
) {

675 
v®ue
;

676 ià(
	`g‘DoubËFromObjeù
(
o
, &
v®ue
è!ğ
C_OK
) {

677 ià(
msg
 !ğ
NULL
) {

678 
	`addR•lyE¼Ü
(
c
,(*)
msg
);

680 
	`addR•lyE¼Ü
(
c
,"value is‚ot‡ valid float");

682  
C_ERR
;

684 *
rg‘
 = 
v®ue
;

685  
C_OK
;

686 
	}
}

688 
	$g‘LÚgDoubËFromObjeù
(
robj
 *
o
, *
rg‘
) {

689 
v®ue
;

690 *
•Œ
;

692 ià(
o
 =ğ
NULL
) {

693 
v®ue
 = 0;

695 
	`£rv”As£¹W™hInfo
(
NULL
,
o
,o->
ty³
 =ğ
OBJ_STRING
);

696 ià(
	`sdsEncodedObjeù
(
o
)) {

697 
”ºo
 = 0;

698 
v®ue
 = 
	`¡¹Şd
(
o
->
±r
, &
•Œ
);

699 ià(
	`is¥aû
(((*)
o
->
±r
)[0]è|| 
•Œ
[0] != '\0' ||

700 
”ºo
 =ğ
ERANGE
 || 
	`i¢ª
(
v®ue
))

701  
C_ERR
;

702 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

703 
v®ue
 = ()
o
->
±r
;

705 
	`£rv”Pªic
("Unknown stringƒncoding");

708 *
rg‘
 = 
v®ue
;

709  
C_OK
;

710 
	}
}

712 
	$g‘LÚgDoubËFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
rg‘
, cÚ¡ *
msg
) {

713 
v®ue
;

714 ià(
	`g‘LÚgDoubËFromObjeù
(
o
, &
v®ue
è!ğ
C_OK
) {

715 ià(
msg
 !ğ
NULL
) {

716 
	`addR•lyE¼Ü
(
c
,(*)
msg
);

718 
	`addR•lyE¼Ü
(
c
,"value is‚ot‡ valid float");

720  
C_ERR
;

722 *
rg‘
 = 
v®ue
;

723  
C_OK
;

724 
	}
}

726 
	$g‘LÚgLÚgFromObjeù
(
robj
 *
o
, *
rg‘
) {

727 
v®ue
;

729 ià(
o
 =ğ
NULL
) {

730 
v®ue
 = 0;

732 
	`£rv”As£¹W™hInfo
(
NULL
,
o
,o->
ty³
 =ğ
OBJ_STRING
);

733 ià(
	`sdsEncodedObjeù
(
o
)) {

734 ià(
	`¡ršg2Î
(
o
->
±r
,
	`sd¦’
(o->±r),&
v®ue
è=ğ0è 
C_ERR
;

735 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

736 
v®ue
 = ()
o
->
±r
;

738 
	`£rv”Pªic
("Unknown stringƒncoding");

741 ià(
rg‘
è*rg‘ = 
v®ue
;

742  
C_OK
;

743 
	}
}

745 
	$g‘LÚgLÚgFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
rg‘
, cÚ¡ *
msg
) {

746 
v®ue
;

747 ià(
	`g‘LÚgLÚgFromObjeù
(
o
, &
v®ue
è!ğ
C_OK
) {

748 ià(
msg
 !ğ
NULL
) {

749 
	`addR•lyE¼Ü
(
c
,(*)
msg
);

751 
	`addR•lyE¼Ü
(
c
,"value is‚ot‡n integer or out of„ange");

753  
C_ERR
;

755 *
rg‘
 = 
v®ue
;

756  
C_OK
;

757 
	}
}

759 
	$g‘LÚgFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
rg‘
, cÚ¡ *
msg
) {

760 
v®ue
;

762 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
, 
o
, &
v®ue
, 
msg
è!ğ
C_OK
è 
C_ERR
;

763 ià(
v®ue
 < 
LONG_MIN
 || v®u> 
LONG_MAX
) {

764 ià(
msg
 !ğ
NULL
) {

765 
	`addR•lyE¼Ü
(
c
,(*)
msg
);

767 
	`addR•lyE¼Ü
(
c
,"value is out of„ange");

769  
C_ERR
;

771 *
rg‘
 = 
v®ue
;

772  
C_OK
;

773 
	}
}

775 *
	$¡rEncodšg
(
’codšg
) {

776 
’codšg
) {

777 
OBJ_ENCODING_RAW
:  "raw";

778 
OBJ_ENCODING_INT
:  "int";

779 
OBJ_ENCODING_HT
:  "hashtable";

780 
OBJ_ENCODING_QUICKLIST
:  "quicklist";

781 
OBJ_ENCODING_ZIPLIST
:  "ziplist";

782 
OBJ_ENCODING_INTSET
:  "intset";

783 
OBJ_ENCODING_SKIPLIST
:  "skiplist";

784 
OBJ_ENCODING_EMBSTR
:  "embstr";

787 
	}
}

791 
	$e¡im©eObjeùIdËTime
(
robj
 *
o
) {

792 
Ìuşock
 = 
	`LRU_CLOCK
();

793 ià(
Ìuşock
 >ğ
o
->
Ìu
) {

794  (
Ìuşock
 - 
o
->
Ìu
è* 
LRU_CLOCK_RESOLUTION
;

796  (
Ìuşock
 + (
LRU_CLOCK_MAX
 - 
o
->
Ìu
)) *

797 
LRU_CLOCK_RESOLUTION
;

799 
	}
}

803 
robj
 *
	$objeùCommªdLookup
(
ş›Á
 *
c
, 
robj
 *
key
) {

804 
diùEÁry
 *
de
;

806 ià((
de
 = 
	`diùFšd
(
c
->
db
->
diù
,
key
->
±r
)è=ğ
NULL
)  NULL;

807  (
robj
*è
	`diùG‘V®
(
de
);

808 
	}
}

810 
robj
 *
	$objeùCommªdLookupOrR•ly
(
ş›Á
 *
c
, 
robj
 *
key
,„obj *
»¶y
) {

811 
robj
 *
o
 = 
	`objeùCommªdLookup
(
c
,
key
);

813 ià(!
o
è
	`addR•ly
(
c
, 
»¶y
);

814  
o
;

815 
	}
}

819 
	$objeùCommªd
(
ş›Á
 *
c
) {

820 
robj
 *
o
;

822 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"»fcouÁ"è&& c->
¬gc
 == 3) {

823 ià((
o
 = 
	`objeùCommªdLookupOrR•ly
(
c
,c->
¬gv
[2],
sh¬ed
.
nuÎbulk
))

824 =ğ
NULL
) ;

825 
	`addR•lyLÚgLÚg
(
c
,
o
->
»fcouÁ
);

826 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"’codšg"è&& c->
¬gc
 == 3) {

827 ià((
o
 = 
	`objeùCommªdLookupOrR•ly
(
c
,c->
¬gv
[2],
sh¬ed
.
nuÎbulk
))

828 =ğ
NULL
) ;

829 
	`addR•lyBulkCSŒšg
(
c
,
	`¡rEncodšg
(
o
->
’codšg
));

830 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"idËtime"è&& c->
¬gc
 == 3) {

831 ià((
o
 = 
	`objeùCommªdLookupOrR•ly
(
c
,c->
¬gv
[2],
sh¬ed
.
nuÎbulk
))

832 =ğ
NULL
) ;

833 
	`addR•lyLÚgLÚg
(
c
,
	`e¡im©eObjeùIdËTime
(
o
)/1000);

835 
	`addR•lyE¼Ü
(
c
,"Syntaxƒrror. Try OBJECT (refcount|encoding|idletime)");

837 
	}
}

	@src/pmem.c

30 #ifdeà
USE_PMDK


31 
	~"£rv”.h
"

32 
	~"obj.h
"

33 
	~"libpmemobj.h
"

34 
	~"ut.h
"

37 
	$pmemRecÚ¡ruù
()

39 
	`TOID
(
»dis_pmem_roÙ
è
roÙ
;

40 
	`TOID
(
key_v®_·œ_PM
è
kv_PM_oid
;

41 
key_v®_·œ_PM
 *
kv_PM
;

42 
diù
 *
d
;

43 *
key
;

44 *
v®
;

45 *
pmem_ba£_addr
;

47 
roÙ
 = 
£rv”
.
pm_roÙoid
;

48 
pmem_ba£_addr
 = (*)
£rv”
.
pm_poŞ
->
addr
;

49 
d
 = 
£rv”
.
db
[0].
diù
;

50 
	`diùEx·nd
(
d
, 
	`D_RO
(
roÙ
)->
num_diù_’Œ›s
);

51 
kv_PM_oid
 = 
	`D_RO
(
roÙ
)->
³_fœ¡
; 
	`TOID_IS_NULL
(kv_PM_oidè=ğ0; kv_PM_oid = D_RO(kv_PM_oid)->
pmem_li¡_Ãxt
){

52 
kv_PM
 = (
key_v®_·œ_PM
 *)(
kv_PM_oid
.
oid
.
off
 + (
ušt64_t
)
pmem_ba£_addr
);

53 
key
 = (*)(
kv_PM
->
key_oid
.
off
 + (
ušt64_t
)
pmem_ba£_addr
);

54 
v®
 = (*)(
kv_PM
->
v®_oid
.
off
 + (
ušt64_t
)
pmem_ba£_addr
);

56 ()
	`diùAddRecÚ¡ruùedPM
(
d
, 
key
, 
v®
);

58  
C_OK
;

59 
	}
}

61 
	$pmemKV·œS‘
(*
key
, *
v®
)

63 
PMEMoid
 *
kv_PM_oid
;

64 
PMEMoid
 
v®_oid
;

65 
key_v®_·œ_PM
 *
kv_PM_p
;

67 
kv_PM_oid
 = 
	`sdsPMEMoidBackReã»nû
((
sds
)
key
);

68 
kv_PM_p
 = (
key_v®_·œ_PM
 *)
	`pmemobj_dœeù
(*
kv_PM_oid
);

70 
v®_oid
.
poŞ_uuid_lo
 = 
£rv”
.pool_uuid_lo;

71 
v®_oid
.
off
 = (
ušt64_t
)
v®
 - (ušt64_t)
£rv”
.
pm_poŞ
->
addr
;

73 
	`TX_ADD_FIELD_DIRECT
(
kv_PM_p
, 
v®_oid
);

74 
kv_PM_p
->
v®_oid
 = val_oid;

76 
	}
}

78 
PMEMoid


79 
	$pmemAddToPmemLi¡
(*
key
, *
v®
)

81 
PMEMoid
 
key_oid
;

82 
PMEMoid
 
v®_oid
;

83 
PMEMoid
 
kv_PM
;

84 
key_v®_·œ_PM
 *
kv_PM_p
;

85 
	`TOID
(
key_v®_·œ_PM
è
ty³d_kv_PM
;

86 
»dis_pmem_roÙ
 *
roÙ
;

88 
key_oid
.
poŞ_uuid_lo
 = 
£rv”
.pool_uuid_lo;

89 
key_oid
.
off
 = (
ušt64_t
)
key
 - (ušt64_t)
£rv”
.
pm_poŞ
->
addr
;

91 
v®_oid
.
poŞ_uuid_lo
 = 
£rv”
.pool_uuid_lo;

92 
v®_oid
.
off
 = (
ušt64_t
)
v®
 - (ušt64_t)
£rv”
.
pm_poŞ
->
addr
;

94 
kv_PM
 = 
	`pmemobj_tx_z®loc
((
key_v®_·œ_PM
), 
pm_ty³_key_v®_·œ_PM
);

95 
kv_PM_p
 = (
key_v®_·œ_PM
 *)
	`pmemobj_dœeù
(
kv_PM
);

96 
kv_PM_p
->
key_oid
 = key_oid;

97 
kv_PM_p
->
v®_oid
 = val_oid;

98 
ty³d_kv_PM
.
oid
 = 
kv_PM
;

100 
roÙ
 = 
	`pmemobj_dœeù
(
£rv”
.
pm_roÙoid
.
oid
);

102 
kv_PM_p
->
pmem_li¡_Ãxt
 = 
roÙ
->
³_fœ¡
;

103 if(!
	`TOID_IS_NULL
(
roÙ
->
³_fœ¡
)) {

104 
key_v®_·œ_PM
 *
h—d
 = 
	`D_RW
(
roÙ
->
³_fœ¡
);

105 
	`TX_ADD_FIELD_DIRECT
(
h—d
,
pmem_li¡_´ev
);

106 
h—d
->
pmem_li¡_´ev
 = 
ty³d_kv_PM
;

109 
	`TX_ADD_DIRECT
(
roÙ
);

110 
roÙ
->
³_fœ¡
 = 
ty³d_kv_PM
;

111 
roÙ
->
num_diù_’Œ›s
++;

113  
kv_PM
;

114 
	}
}

117 
	$pmemRemoveFromPmemLi¡
(
PMEMoid
 
kv_PM_oid
)

119 
	`TOID
(
key_v®_·œ_PM
è
ty³d_kv_PM
;

120 
»dis_pmem_roÙ
 *
roÙ
;

122 
roÙ
 = 
	`pmemobj_dœeù
(
£rv”
.
pm_roÙoid
.
oid
);

124 
ty³d_kv_PM
.
oid
 = 
kv_PM_oid
;

126 if(
	`TOID_EQUALS
(
roÙ
->
³_fœ¡
, 
ty³d_kv_PM
)) {

127 
	`TOID
(
key_v®_·œ_PM
è
ty³d_kv_PM_Ãxt
 = 
	`D_RO
(
ty³d_kv_PM
)->
pmem_li¡_Ãxt
;

128 if(!
	`TOID_IS_NULL
(
ty³d_kv_PM_Ãxt
)){

129 
key_v®_·œ_PM
 *
Ãxt
 = 
	`D_RW
(
ty³d_kv_PM_Ãxt
);

130 
	`TX_ADD_FIELD_DIRECT
(
Ãxt
,
pmem_li¡_´ev
);

131 
Ãxt
->
pmem_li¡_´ev
.
oid
 = 
OID_NULL
;

133 
	`TX_FREE
(
roÙ
->
³_fœ¡
);

134 
	`TX_ADD_DIRECT
(
roÙ
);

135 
roÙ
->
³_fœ¡
 = 
ty³d_kv_PM_Ãxt
;

136 
roÙ
->
num_diù_’Œ›s
--;

140 
	`TOID
(
key_v®_·œ_PM
è
ty³d_kv_PM_´ev
 = 
	`D_RO
(
ty³d_kv_PM
)->
pmem_li¡_´ev
;

141 
	`TOID
(
key_v®_·œ_PM
è
ty³d_kv_PM_Ãxt
 = 
	`D_RO
(
ty³d_kv_PM
)->
pmem_li¡_Ãxt
;

142 if(!
	`TOID_IS_NULL
(
ty³d_kv_PM_´ev
)){

143 
key_v®_·œ_PM
 *
´ev
 = 
	`D_RW
(
ty³d_kv_PM_´ev
);

144 
	`TX_ADD_FIELD_DIRECT
(
´ev
,
pmem_li¡_Ãxt
);

145 
´ev
->
pmem_li¡_Ãxt
 = 
ty³d_kv_PM_Ãxt
;

147 if(!
	`TOID_IS_NULL
(
ty³d_kv_PM_Ãxt
)){

148 
key_v®_·œ_PM
 *
Ãxt
 = 
	`D_RW
(
ty³d_kv_PM_Ãxt
);

149 
	`TX_ADD_FIELD_DIRECT
(
Ãxt
,
pmem_li¡_´ev
);

150 
Ãxt
->
pmem_li¡_´ev
 = 
ty³d_kv_PM_´ev
;

152 
	`TX_FREE
(
ty³d_kv_PM
);

153 
	`TX_ADD_FIELD_DIRECT
(
roÙ
,
num_diù_’Œ›s
);

154 
roÙ
->
num_diù_’Œ›s
--;

157 
	}
}

	@src/pmem.h

30 #iâdeà
__PMEM_H


31 
	#__PMEM_H


	)

33 #ifdeà
USE_PMDK


34 
	skey_v®_·œ_PM
 {

35 
PMEMoid
 
	mkey_oid
;

36 
PMEMoid
 
	mv®_oid
;

37 
TOID
(
key_v®_·œ_PM
è
	mpmem_li¡_Ãxt
;

38 
TOID
(
key_v®_·œ_PM
è
	mpmem_li¡_´ev
;

39 } 
	tkey_v®_·œ_PM
;

41 
pmemRecÚ¡ruù
();

42 
pmemKV·œS‘
(*
key
, *
v®
);

43 
PMEMoid
 
pmemAddToPmemLi¡
(*
key
, *
v®
);

44 
pmemRemoveFromPmemLi¡
(
PMEMoid
 
kv_PM_oid
);

	@src/pqsort.c

40 
	~<sys/ty³s.h
>

42 
	~<”ºo.h
>

43 
	~<¡dlib.h
>

45 
šlše
 *
med3
 (*, *, *,

47 
šlše
 
	`sw­func
 (*, *, 
size_t
, );

49 
	#mš
(
a
, 
b
è×è< (bè?‡ : 
	)
b

54 
	#sw­code
(
TYPE
, 
·rmi
, 
·rmj
, 
n
) { \

55 
size_t
 
i
 = (
n
è/  (
TYPE
); \

56 
TYPE
 *
pi
 = (TYPE *)(*)(
·rmi
); \

57 
TYPE
 *
pj
 = (TYPE *)(*)(
·rmj
); \

59 
TYPE
 
t
 = *
pi
; \

60 *
pi
++ = *
pj
; \

61 *
pj
++ = 
t
; \

62 } --
i
 > 0); \

63 
	}

	)
}

65 
	#SWAPINIT
(
a
, 
es
è
sw­ty³
 = ((*)a - (*)0) % () || \

66 
es
 % (è? 2 :ƒ =ğ()? 0 : 1;

	)

68 
šlše
 

69 
	$sw­func
(*
a
, *
b
, 
size_t
 
n
, 
sw­ty³
)

72 ià(
sw­ty³
 <= 1)

73 
	`sw­code
(, 
a
, 
b
, 
n
)

75 
	`sw­code
(, 
a
, 
b
, 
n
)

76 
	}
}

78 
	#sw­
(
a
, 
b
) \

79 ià(
sw­ty³
 == 0) { \

80 
t
 = *(*)(*)(
a
); \

81 *(*)(*)(
a
èğ*(*)(*)(
b
); \

82 *(*)(*)(
b
èğ
t
; \

84 
	`sw­func
(
a
, 
b
, 
es
, 
sw­ty³
)

	)

86 
	#vecsw­
(
a
, 
b
, 
n
èià(Òè> 0è
	`sw­func
(×), (b), (
size_t
)Ò), 
sw­ty³
)

	)

88 
šlše
 *

89 
	$med3
(*
a
, *
b
, *
c
,

90 (*
cmp
) (const *, const *))

93  
	`cmp
(
a
, 
b
) < 0 ?

94 (
	`cmp
(
b
, 
c
è< 0 ? b : (cmp(
a
, c) < 0 ? c :‡ ))

95 :(
	`cmp
(
b
, 
c
è> 0 ? b : (cmp(
a
, c) < 0 ?‡ : c ));

96 
	}
}

99 
	$_pqsÜt
(*
a
, 
size_t
 
n
, size_ˆ
es
,

100 (*
cmp
è(cÚ¡ *, cÚ¡ *), *
Ìªge
, *
¼ªge
)

102 *
·
, *
pb
, *
pc
, *
pd
, *
¶
, *
pm
, *
²
;

103 
size_t
 
d
, 
r
;

104 
sw­ty³
, 
cmp_»suÉ
;

106 
loİ
: 
	`SWAPINIT
(
a
, 
es
);

107 ià(
n
 < 7) {

108 
pm
 = (*è
a
 + 
es
;…m < (*è¨+ 
n
 *ƒs;…m +=ƒs)

109 
¶
 = 
pm
;…È> (*è
a
 && 
	`cmp
ÕÈ- 
es
,…l) > 0;

110 
¶
 -ğ
es
)

111 
	`sw­
(
¶
,…È- 
es
);

114 
pm
 = (*è
a
 + (
n
 / 2è* 
es
;

115 ià(
n
 > 7) {

116 
¶
 = (*è
a
;

117 
²
 = (*è
a
 + (
n
 - 1è* 
es
;

118 ià(
n
 > 40) {

119 
d
 = (
n
 / 8è* 
es
;

120 
¶
 = 
	`med3
Õl,…È+ 
d
,…È+ 2 * d, 
cmp
);

121 
pm
 = 
	`med3
Õm - 
d
,…m,…m + d, 
cmp
);

122 
²
 = 
	`med3
ÕÀ- 2 * 
d
,…À- d,…n, 
cmp
);

124 
pm
 = 
	`med3
(
¶
,…m, 
²
, 
cmp
);

126 
	`sw­
(
a
, 
pm
);

127 
·
 = 
pb
 = (*è
a
 + 
es
;

129 
pc
 = 
pd
 = (*è
a
 + (
n
 - 1è* 
es
;

131 
pb
 <ğ
pc
 && (
cmp_»suÉ
 = 
	`cmp
Õb, 
a
)) <= 0) {

132 ià(
cmp_»suÉ
 == 0) {

133 
	`sw­
(
·
, 
pb
);

134 
·
 +ğ
es
;

136 
pb
 +ğ
es
;

138 
pb
 <ğ
pc
 && (
cmp_»suÉ
 = 
	`cmp
Õc, 
a
)) >= 0) {

139 ià(
cmp_»suÉ
 == 0) {

140 
	`sw­
(
pc
, 
pd
);

141 
pd
 -ğ
es
;

143 
pc
 -ğ
es
;

145 ià(
pb
 > 
pc
)

147 
	`sw­
(
pb
, 
pc
);

148 
pb
 +ğ
es
;

149 
pc
 -ğ
es
;

152 
²
 = (*è
a
 + 
n
 * 
es
;

153 
r
 = 
	`mš
(
·
 - (*è
a
, 
pb
 -…a);

154 
	`vecsw­
(
a
, 
pb
 - 
r
,„);

155 
r
 = 
	`mš
((
size_t
)(
pd
 - 
pc
), 
²
 -…d - 
es
);

156 
	`vecsw­
(
pb
, 
²
 - 
r
,„);

157 ià((
r
 = 
pb
 - 
·
è> 
es
) {

158 *
_l
 = 
a
, *
_r
 = ((*ï)+
r
-1;

159 ià(!((
Ìªge
 < 
_l
 && 
¼ªge
 < _l) ||

160 (
Ìªge
 > 
_r
 && 
¼ªge
 > _r)))

161 
	`_pqsÜt
(
a
, 
r
 / 
es
,ƒs, 
cmp
, 
Ìªge
, 
¼ªge
);

163 ià((
r
 = 
pd
 - 
pc
è> 
es
) {

164 *
_l
, *
_r
;

167 
a
 = 
²
 - 
r
;

168 
n
 = 
r
 / 
es
;

170 
_l
 = 
a
;

171 
_r
 = ((*)
a
)+
r
-1;

172 ià(!((
Ìªge
 < 
_l
 && 
¼ªge
 < _l) ||

173 (
Ìªge
 > 
_r
 && 
¼ªge
 > _r)))

174 
loİ
;

177 
	}
}

180 
	$pqsÜt
(*
a
, 
size_t
 
n
, size_ˆ
es
,

181 (*
cmp
è(cÚ¡ *, cÚ¡ *), 
size_t
 
Ìªge
, size_ˆ
¼ªge
)

183 
	`_pqsÜt
(
a
,
n
,
es
,
cmp
,((*ï)+(
Ìªge
*es),

184 ((*)
a
)+((
¼ªge
+1)*
es
)-1);

185 
	}
}

	@src/pqsort.h

33 #iâdeà
__PQSORT_H


34 
	#__PQSORT_H


	)

37 
pqsÜt
(*
a
, 
size_t
 
n
, size_ˆ
es
,

38 (*
cmp
è(cÚ¡ *, cÚ¡ *), 
size_t
 
Ìªge
, size_ˆ
¼ªge
);

	@src/pubsub.c

30 
	~"£rv”.h
"

36 
	$ä“PubsubP©‹º
(*
p
) {

37 
pubsubP©‹º
 *
·t
 = 
p
;

39 
	`deüRefCouÁ
(
·t
->
·‰”n
);

40 
	`zä“
(
·t
);

41 
	}
}

43 
	$li¡M©chPubsubP©‹º
(*
a
, *
b
) {

44 
pubsubP©‹º
 *
·
 = 
a
, *
pb
 = 
b
;

46  (
·
->
ş›Á
 =ğ
pb
->client) &&

47 (
	`equ®SŒšgObjeùs
(
·
->
·‰”n
,
pb
->pattern));

48 
	}
}

51 
	$ş›ÁSubsütiÚsCouÁ
(
ş›Á
 *
c
) {

52  
	`diùSize
(
c
->
pubsub_chªÃls
)+

53 
	`li¡L’gth
(
c
->
pubsub_·‰”ns
);

54 
	}
}

58 
	$pubsubSubsüibeChªÃl
(
ş›Á
 *
c
, 
robj
 *
chªÃl
) {

59 
diùEÁry
 *
de
;

60 
li¡
 *
ş›Ás
 = 
NULL
;

61 
»tv®
 = 0;

64 ià(
	`diùAdd
(
c
->
pubsub_chªÃls
,
chªÃl
,
NULL
è=ğ
DICT_OK
) {

65 
»tv®
 = 1;

66 
	`šüRefCouÁ
(
chªÃl
);

68 
de
 = 
	`diùFšd
(
£rv”
.
pubsub_chªÃls
,
chªÃl
);

69 ià(
de
 =ğ
NULL
) {

70 
ş›Ás
 = 
	`li¡C»©e
();

71 
	`diùAdd
(
£rv”
.
pubsub_chªÃls
,
chªÃl
,
ş›Ás
);

72 
	`šüRefCouÁ
(
chªÃl
);

74 
ş›Ás
 = 
	`diùG‘V®
(
de
);

76 
	`li¡AddNodeTa
(
ş›Ás
,
c
);

79 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[3]);

80 
	`addR•ly
(
c
,
sh¬ed
.
subsüibebulk
);

81 
	`addR•lyBulk
(
c
,
chªÃl
);

82 
	`addR•lyLÚgLÚg
(
c
,
	`ş›ÁSubsütiÚsCouÁ
(c));

83  
»tv®
;

84 
	}
}

88 
	$pubsubUnsubsüibeChªÃl
(
ş›Á
 *
c
, 
robj
 *
chªÃl
, 
nÙify
) {

89 
diùEÁry
 *
de
;

90 
li¡
 *
ş›Ás
;

91 
li¡Node
 *
Ê
;

92 
»tv®
 = 0;

95 
	`šüRefCouÁ
(
chªÃl
);

97 ià(
	`diùD–‘e
(
c
->
pubsub_chªÃls
,
chªÃl
è=ğ
DICT_OK
) {

98 
»tv®
 = 1;

100 
de
 = 
	`diùFšd
(
£rv”
.
pubsub_chªÃls
,
chªÃl
);

101 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
de
 != NULL);

102 
ş›Ás
 = 
	`diùG‘V®
(
de
);

103 
Ê
 = 
	`li¡S—rchKey
(
ş›Ás
,
c
);

104 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
Ê
 != NULL);

105 
	`li¡D–Node
(
ş›Ás
,
Ê
);

106 ià(
	`li¡L’gth
(
ş›Ás
) == 0) {

110 
	`diùD–‘e
(
£rv”
.
pubsub_chªÃls
,
chªÃl
);

114 ià(
nÙify
) {

115 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[3]);

116 
	`addR•ly
(
c
,
sh¬ed
.
unsubsüibebulk
);

117 
	`addR•lyBulk
(
c
,
chªÃl
);

118 
	`addR•lyLÚgLÚg
(
c
,
	`diùSize
(c->
pubsub_chªÃls
)+

119 
	`li¡L’gth
(
c
->
pubsub_·‰”ns
));

122 
	`deüRefCouÁ
(
chªÃl
);

123  
»tv®
;

124 
	}
}

127 
	$pubsubSubsüibeP©‹º
(
ş›Á
 *
c
, 
robj
 *
·‰”n
) {

128 
»tv®
 = 0;

130 ià(
	`li¡S—rchKey
(
c
->
pubsub_·‰”ns
,
·‰”n
è=ğ
NULL
) {

131 
»tv®
 = 1;

132 
pubsubP©‹º
 *
·t
;

133 
	`li¡AddNodeTa
(
c
->
pubsub_·‰”ns
,
·‰”n
);

134 
	`šüRefCouÁ
(
·‰”n
);

135 
·t
 = 
	`zm®loc
((*pat));

136 
·t
->
·‰”n
 = 
	`g‘DecodedObjeù
(pattern);

137 
·t
->
ş›Á
 = 
c
;

138 
	`li¡AddNodeTa
(
£rv”
.
pubsub_·‰”ns
,
·t
);

141 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[3]);

142 
	`addR•ly
(
c
,
sh¬ed
.
psubsüibebulk
);

143 
	`addR•lyBulk
(
c
,
·‰”n
);

144 
	`addR•lyLÚgLÚg
(
c
,
	`ş›ÁSubsütiÚsCouÁ
(c));

145  
»tv®
;

146 
	}
}

150 
	$pubsubUnsubsüibeP©‹º
(
ş›Á
 *
c
, 
robj
 *
·‰”n
, 
nÙify
) {

151 
li¡Node
 *
Ê
;

152 
pubsubP©‹º
 
·t
;

153 
»tv®
 = 0;

155 
	`šüRefCouÁ
(
·‰”n
);

156 ià((
Ê
 = 
	`li¡S—rchKey
(
c
->
pubsub_·‰”ns
,
·‰”n
)è!ğ
NULL
) {

157 
»tv®
 = 1;

158 
	`li¡D–Node
(
c
->
pubsub_·‰”ns
,
Ê
);

159 
·t
.
ş›Á
 = 
c
;

160 
·t
.
·‰”n
 =…attern;

161 
Ê
 = 
	`li¡S—rchKey
(
£rv”
.
pubsub_·‰”ns
,&
·t
);

162 
	`li¡D–Node
(
£rv”
.
pubsub_·‰”ns
,
Ê
);

165 ià(
nÙify
) {

166 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[3]);

167 
	`addR•ly
(
c
,
sh¬ed
.
punsubsüibebulk
);

168 
	`addR•lyBulk
(
c
,
·‰”n
);

169 
	`addR•lyLÚgLÚg
(
c
,
	`diùSize
(c->
pubsub_chªÃls
)+

170 
	`li¡L’gth
(
c
->
pubsub_·‰”ns
));

172 
	`deüRefCouÁ
(
·‰”n
);

173  
»tv®
;

174 
	}
}

178 
	$pubsubUnsubsüibeAÎChªÃls
(
ş›Á
 *
c
, 
nÙify
) {

179 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘SaãI‹¿tÜ
(
c
->
pubsub_chªÃls
);

180 
diùEÁry
 *
de
;

181 
couÁ
 = 0;

183 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

184 
robj
 *
chªÃl
 = 
	`diùG‘Key
(
de
);

186 
couÁ
 +ğ
	`pubsubUnsubsüibeChªÃl
(
c
,
chªÃl
,
nÙify
);

189 ià(
nÙify
 && 
couÁ
 == 0) {

190 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[3]);

191 
	`addR•ly
(
c
,
sh¬ed
.
unsubsüibebulk
);

192 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

193 
	`addR•lyLÚgLÚg
(
c
,
	`diùSize
(c->
pubsub_chªÃls
)+

194 
	`li¡L’gth
(
c
->
pubsub_·‰”ns
));

196 
	`diùR–—£I‹¿tÜ
(
di
);

197  
couÁ
;

198 
	}
}

202 
	$pubsubUnsubsüibeAÎP©‹ºs
(
ş›Á
 *
c
, 
nÙify
) {

203 
li¡Node
 *
Ê
;

204 
li¡I‹r
 
li
;

205 
couÁ
 = 0;

207 
	`li¡Rewšd
(
c
->
pubsub_·‰”ns
,&
li
);

208 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

209 
robj
 *
·‰”n
 = 
Ê
->
v®ue
;

211 
couÁ
 +ğ
	`pubsubUnsubsüibeP©‹º
(
c
,
·‰”n
,
nÙify
);

213 ià(
nÙify
 && 
couÁ
 == 0) {

215 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[3]);

216 
	`addR•ly
(
c
,
sh¬ed
.
punsubsüibebulk
);

217 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

218 
	`addR•lyLÚgLÚg
(
c
,
	`diùSize
(c->
pubsub_chªÃls
)+

219 
	`li¡L’gth
(
c
->
pubsub_·‰”ns
));

221  
couÁ
;

222 
	}
}

225 
	$pubsubPublishMes§ge
(
robj
 *
chªÃl
,„obj *
mes§ge
) {

226 
»ûiv”s
 = 0;

227 
diùEÁry
 *
de
;

228 
li¡Node
 *
Ê
;

229 
li¡I‹r
 
li
;

232 
de
 = 
	`diùFšd
(
£rv”
.
pubsub_chªÃls
,
chªÃl
);

233 ià(
de
) {

234 
li¡
 *li¡ = 
	`diùG‘V®
(
de
);

235 
li¡Node
 *
Ê
;

236 
li¡I‹r
 
li
;

238 
	`li¡Rewšd
(
li¡
,&
li
);

239 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

240 
ş›Á
 *
c
 = 
Ê
->
v®ue
;

242 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[3]);

243 
	`addR•ly
(
c
,
sh¬ed
.
mes§gebulk
);

244 
	`addR•lyBulk
(
c
,
chªÃl
);

245 
	`addR•lyBulk
(
c
,
mes§ge
);

246 
»ûiv”s
++;

250 ià(
	`li¡L’gth
(
£rv”
.
pubsub_·‰”ns
)) {

251 
	`li¡Rewšd
(
£rv”
.
pubsub_·‰”ns
,&
li
);

252 
chªÃl
 = 
	`g‘DecodedObjeù
(channel);

253 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

254 
pubsubP©‹º
 *
·t
 = 
Ê
->
v®ue
;

256 ià(
	`¡ršgm©chËn
((*)
·t
->
·‰”n
->
±r
,

257 
	`sd¦’
(
·t
->
·‰”n
->
±r
),

258 (*)
chªÃl
->
±r
,

259 
	`sd¦’
(
chªÃl
->
±r
),0)) {

260 
	`addR•ly
(
·t
->
ş›Á
,
sh¬ed
.
mbulkhdr
[4]);

261 
	`addR•ly
(
·t
->
ş›Á
,
sh¬ed
.
pmes§gebulk
);

262 
	`addR•lyBulk
(
·t
->
ş›Á
,·t->
·‰”n
);

263 
	`addR•lyBulk
(
·t
->
ş›Á
,
chªÃl
);

264 
	`addR•lyBulk
(
·t
->
ş›Á
,
mes§ge
);

265 
»ûiv”s
++;

268 
	`deüRefCouÁ
(
chªÃl
);

270  
»ûiv”s
;

271 
	}
}

277 
	$subsüibeCommªd
(
ş›Á
 *
c
) {

278 
j
;

280 
j
 = 1; j < 
c
->
¬gc
; j++)

281 
	`pubsubSubsüibeChªÃl
(
c
,c->
¬gv
[
j
]);

282 
c
->
æags
 |ğ
CLIENT_PUBSUB
;

283 
	}
}

285 
	$unsubsüibeCommªd
(
ş›Á
 *
c
) {

286 ià(
c
->
¬gc
 == 1) {

287 
	`pubsubUnsubsüibeAÎChªÃls
(
c
,1);

289 
j
;

291 
j
 = 1; j < 
c
->
¬gc
; j++)

292 
	`pubsubUnsubsüibeChªÃl
(
c
,c->
¬gv
[
j
],1);

294 ià(
	`ş›ÁSubsütiÚsCouÁ
(
c
è=ğ0èc->
æags
 &ğ~
CLIENT_PUBSUB
;

295 
	}
}

297 
	$psubsüibeCommªd
(
ş›Á
 *
c
) {

298 
j
;

300 
j
 = 1; j < 
c
->
¬gc
; j++)

301 
	`pubsubSubsüibeP©‹º
(
c
,c->
¬gv
[
j
]);

302 
c
->
æags
 |ğ
CLIENT_PUBSUB
;

303 
	}
}

305 
	$punsubsüibeCommªd
(
ş›Á
 *
c
) {

306 ià(
c
->
¬gc
 == 1) {

307 
	`pubsubUnsubsüibeAÎP©‹ºs
(
c
,1);

309 
j
;

311 
j
 = 1; j < 
c
->
¬gc
; j++)

312 
	`pubsubUnsubsüibeP©‹º
(
c
,c->
¬gv
[
j
],1);

314 ià(
	`ş›ÁSubsütiÚsCouÁ
(
c
è=ğ0èc->
æags
 &ğ~
CLIENT_PUBSUB
;

315 
	}
}

317 
	$publishCommªd
(
ş›Á
 *
c
) {

318 
»ûiv”s
 = 
	`pubsubPublishMes§ge
(
c
->
¬gv
[1],c->argv[2]);

319 ià(
£rv”
.
şu¡”_’abËd
)

320 
	`şu¡”Prİag©ePublish
(
c
->
¬gv
[1],c->argv[2]);

322 
	`fÜûCommªdPrİag©iÚ
(
c
,
PROPAGATE_REPL
);

323 
	`addR•lyLÚgLÚg
(
c
,
»ûiv”s
);

324 
	}
}

327 
	$pubsubCommªd
(
ş›Á
 *
c
) {

328 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"channels") &&

329 (
c
->
¬gc
 == 2 || c->argc ==3))

332 
sds
 
·t
 = (
c
->
¬gc
 =ğ2è? 
NULL
 : c->
¬gv
[2]->
±r
;

333 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘I‹¿tÜ
(
£rv”
.
pubsub_chªÃls
);

334 
diùEÁry
 *
de
;

335 
mbËn
 = 0;

336 *
»¶yËn
;

338 
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

339 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

340 
robj
 *
cobj
 = 
	`diùG‘Key
(
de
);

341 
sds
 
chªÃl
 = 
cobj
->
±r
;

343 ià(!
·t
 || 
	`¡ršgm©chËn
Õ©, 
	`sd¦’
(pat),

344 
chªÃl
, 
	`sd¦’
(channel),0))

346 
	`addR•lyBulk
(
c
,
cobj
);

347 
mbËn
++;

350 
	`diùR–—£I‹¿tÜ
(
di
);

351 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
»¶yËn
,
mbËn
);

352 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"numsub"è&& c->
¬gc
 >= 2) {

354 
j
;

356 
	`addR•lyMuÉiBulkL’
(
c
,(c->
¬gc
-2)*2);

357 
j
 = 2; j < 
c
->
¬gc
; j++) {

358 
li¡
 *
l
 = 
	`diùF‘chV®ue
(
£rv”
.
pubsub_chªÃls
,
c
->
¬gv
[
j
]);

360 
	`addR•lyBulk
(
c
,c->
¬gv
[
j
]);

361 
	`addR•lyLÚgLÚg
(
c
,
l
 ? 
	`li¡L’gth
(l) : 0);

363 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"num·t"è&& c->
¬gc
 == 2) {

365 
	`addR•lyLÚgLÚg
(
c
,
	`li¡L’gth
(
£rv”
.
pubsub_·‰”ns
));

367 
	`addR•lyE¼ÜFÜm©
(
c
,

369 (*)
c
->
¬gv
[1]->
±r
);

371 
	}
}

	@src/quicklist.c

31 
	~<¡ršg.h
>

32 
	~"quickli¡.h
"

33 
	~"zm®loc.h
"

34 
	~"zli¡.h
"

35 
	~"ut.h
"

36 
	~"lzf.h
"

38 #ià
defšed
(
REDIS_TEST
è|| defšed(
REDIS_TEST_VERBOSE
)

39 
	~<¡dio.h
>

42 #iâdeà
REDIS_STATIC


43 
	#REDIS_STATIC
 

	)

47 cÚ¡ 
size_t
 
	gİtimiz©iÚ_Ëv–
[] = {4096, 8192, 16384, 32768, 65536};

51 
	#SIZE_SAFETY_LIMIT
 8192

	)

54 
	#MIN_COMPRESS_BYTES
 48

	)

59 
	#MIN_COMPRESS_IMPROVE
 8

	)

62 #iâdeà
REDIS_TEST_VERBOSE


63 
	#D
(...)

	)

65 
	#D
(...) \

67 
	`´štf
("%s:%s:%d:\t", 
__FILE__
, 
__FUNCTION__
, 
__LINE__
); \

68 
	`´štf
(
__VA_ARGS__
); \

69 
	`´štf
("\n"); \

70 } 0);

	)

74 
	#š™EÁry
(
e
) \

76 (
e
)->
zi
 = (e)->
v®ue
 = 
NULL
; \

77 (
e
)->
lÚgv®
 = -123456789; \

78 (
e
)->
quickli¡
 = 
NULL
; \

79 (
e
)->
node
 = 
NULL
; \

80 (
e
)->
off£t
 = 123456789; \

81 (
e
)->
sz
 = 0; \

82 } 0)

	)

84 #ià
__GNUC__
 >= 3

85 
	#lik–y
(
x
è
	`__butš_ex³ù
(!!(x), 1)

	)

86 
	#uÆik–y
(
x
è
	`__butš_ex³ù
(!!(x), 0)

	)

88 
	#lik–y
(
x
è(x)

	)

89 
	#uÆik–y
(
x
è(x)

	)

94 
quickli¡
 *
	$quickli¡C»©e
() {

95 
quickli¡
 *quicklist;

97 
quickli¡
 = 
	`zm®loc
((*quicklist));

98 
quickli¡
->
h—d
 = quickli¡->

 = 
NULL
;

99 
quickli¡
->
Ën
 = 0;

100 
quickli¡
->
couÁ
 = 0;

101 
quickli¡
->
com´ess
 = 0;

102 
quickli¡
->
fl
 = -2;

103  
quickli¡
;

104 
	}
}

106 
	#COMPRESS_MAX
 (1 << 16)

	)

107 
	$quickli¡S‘Com´essD•th
(
quickli¡
 *quickli¡, 
com´ess
) {

108 ià(
com´ess
 > 
COMPRESS_MAX
) {

109 
com´ess
 = 
COMPRESS_MAX
;

110 } ià(
com´ess
 < 0) {

111 
com´ess
 = 0;

113 
quickli¡
->
com´ess
 = compress;

114 
	}
}

116 
	#FILL_MAX
 (1 << 15)

	)

117 
	$quickli¡S‘Fl
(
quickli¡
 *quickli¡, 
fl
) {

118 ià(
fl
 > 
FILL_MAX
) {

119 
fl
 = 
FILL_MAX
;

120 } ià(
fl
 < -5) {

121 
fl
 = -5;

123 
quickli¡
->
fl
 = fill;

124 
	}
}

126 
	$quickli¡S‘O±iÚs
(
quickli¡
 *quickli¡, 
fl
, 
d•th
) {

127 
	`quickli¡S‘Fl
(
quickli¡
, 
fl
);

128 
	`quickli¡S‘Com´essD•th
(
quickli¡
, 
d•th
);

129 
	}
}

132 
quickli¡
 *
	$quickli¡New
(
fl
, 
com´ess
) {

133 
quickli¡
 *quickli¡ = 
	`quickli¡C»©e
();

134 
	`quickli¡S‘O±iÚs
(
quickli¡
, 
fl
, 
com´ess
);

135  
quickli¡
;

136 
	}
}

138 
REDIS_STATIC
 
quickli¡Node
 *
	$quickli¡C»©eNode
() {

139 
quickli¡Node
 *
node
;

140 
node
 = 
	`zm®loc
((*node));

141 
node
->
zl
 = 
NULL
;

142 
node
->
couÁ
 = 0;

143 
node
->
sz
 = 0;

144 
node
->
Ãxt
 =‚ode->
´ev
 = 
NULL
;

145 
node
->
’codšg
 = 
QUICKLIST_NODE_ENCODING_RAW
;

146 
node
->
cÚš”
 = 
QUICKLIST_NODE_CONTAINER_ZIPLIST
;

147 
node
->
»com´ess
 = 0;

148  
node
;

149 
	}
}

152 
	$quickli¡CouÁ
(
quickli¡
 *
ql
è{  ql->
couÁ
; 
	}
}

155 
	$quickli¡R–—£
(
quickli¡
 *quicklist) {

156 
Ën
;

157 
quickli¡Node
 *
cu¼’t
, *
Ãxt
;

159 
cu¼’t
 = 
quickli¡
->
h—d
;

160 
Ën
 = 
quickli¡
->len;

161 
Ën
--) {

162 
Ãxt
 = 
cu¼’t
->next;

164 
	`zä“
(
cu¼’t
->
zl
);

165 
quickli¡
->
couÁ
 -ğ
cu¼’t
->count;

167 
	`zä“
(
cu¼’t
);

169 
quickli¡
->
Ën
--;

170 
cu¼’t
 = 
Ãxt
;

172 
	`zä“
(
quickli¡
);

173 
	}
}

178 
REDIS_STATIC
 
	$__quickli¡Com´essNode
(
quickli¡Node
 *
node
) {

179 #ifdeà
REDIS_TEST


180 
node
->
©‹m±ed_com´ess
 = 1;

184 ià(
node
->
sz
 < 
MIN_COMPRESS_BYTES
)

187 
quickli¡LZF
 *
lzf
 = 
	`zm®loc
((*lzfè+ 
node
->
sz
);

190 ià(((
lzf
->
sz
 = 
	`lzf_com´ess
(
node
->
zl
,‚ode->sz,†zf->
com´es£d
,

191 
node
->
sz
)) == 0) ||

192 
lzf
->
sz
 + 
MIN_COMPRESS_IMPROVE
 >ğ
node
->sz) {

194 
	`zä“
(
lzf
);

197 
lzf
 = 
	`z»®loc
Özf, (*lzfè+†zf->
sz
);

198 
	`zä“
(
node
->
zl
);

199 
node
->
zl
 = (*)
lzf
;

200 
node
->
’codšg
 = 
QUICKLIST_NODE_ENCODING_LZF
;

201 
node
->
»com´ess
 = 0;

203 
	}
}

206 
	#quickli¡Com´essNode
(
_node
) \

208 ià((
_node
è&& (_node)->
’codšg
 =ğ
QUICKLIST_NODE_ENCODING_RAW
) { \

209 
	`__quickli¡Com´essNode
((
_node
)); \

211 } 0)

	)

215 
REDIS_STATIC
 
	$__quickli¡Decom´essNode
(
quickli¡Node
 *
node
) {

216 #ifdeà
REDIS_TEST


217 
node
->
©‹m±ed_com´ess
 = 0;

220 *
decom´es£d
 = 
	`zm®loc
(
node
->
sz
);

221 
quickli¡LZF
 *
lzf
 = (quickli¡LZF *)
node
->
zl
;

222 ià(
	`lzf_decom´ess
(
lzf
->
com´es£d
,†zf->
sz
, 
decom´es£d
, 
node
->sz) == 0) {

224 
	`zä“
(
decom´es£d
);

227 
	`zä“
(
lzf
);

228 
node
->
zl
 = 
decom´es£d
;

229 
node
->
’codšg
 = 
QUICKLIST_NODE_ENCODING_RAW
;

231 
	}
}

234 
	#quickli¡Decom´essNode
(
_node
) \

236 ià((
_node
è&& (_node)->
’codšg
 =ğ
QUICKLIST_NODE_ENCODING_LZF
) { \

237 
	`__quickli¡Decom´essNode
((
_node
)); \

239 } 0)

	)

242 
	#quickli¡Decom´essNodeFÜU£
(
_node
) \

244 ià((
_node
è&& (_node)->
’codšg
 =ğ
QUICKLIST_NODE_ENCODING_LZF
) { \

245 
	`__quickli¡Decom´essNode
((
_node
)); \

246 (
_node
)->
»com´ess
 = 1; \

248 } 0)

	)

253 
size_t
 
	$quickli¡G‘Lzf
(cÚ¡ 
quickli¡Node
 *
node
, **
d©a
) {

254 
quickli¡LZF
 *
lzf
 = (quickli¡LZF *)
node
->
zl
;

255 *
d©a
 = 
lzf
->
com´es£d
;

256  
lzf
->
sz
;

257 
	}
}

259 
	#quickli¡AÎowsCom´essiÚ
(
_ql
è((_ql)->
com´ess
 !ğ0)

	)

265 
REDIS_STATIC
 
	$__quickli¡Com´ess
(cÚ¡ 
quickli¡
 *quicklist,

266 
quickli¡Node
 *
node
) {

269 ià(!
	`quickli¡AÎowsCom´essiÚ
(
quickli¡
) ||

270 
quickli¡
->
Ën
 < ()(quickli¡->
com´ess
 * 2))

275 ià(
quickli¡
->
com´ess
 == 1) {

276 
quickli¡Node
 *
h
 = 
quickli¡
->
h—d
, *
t
 = quickli¡->

;

277 
	`quickli¡Decom´essNode
(
h
);

278 
	`quickli¡Decom´essNode
(
t
);

279 ià(
h
 !ğ
node
 && 
t
 !=‚ode)

280 
	`quickli¡Com´essNode
(
node
);

282 } ià(
quickli¡
->
com´ess
 == 2) {

283 
quickli¡Node
 *
h
 = 
quickli¡
->
h—d
, *
hn
 = h->
Ãxt
, *
hÂ
 = hn->next;

284 
quickli¡Node
 *
t
 = 
quickli¡
->

, *

 =->
´ev
, *
p
 =p->prev;

285 
	`quickli¡Decom´essNode
(
h
);

286 
	`quickli¡Decom´essNode
(
hn
);

287 
	`quickli¡Decom´essNode
(
t
);

288 
	`quickli¡Decom´essNode
(

);

289 ià(
h
 !ğ
node
 && 
hn
 !ğnod&& 
t
 !ğnod&& 

 !=‚ode) {

290 
	`quickli¡Com´essNode
(
node
);

292 ià(
hÂ
 !ğ
t
) {

293 
	`quickli¡Com´essNode
(
hÂ
);

295 ià(
p
 !ğ
h
) {

296 
	`quickli¡Com´essNode
(
p
);

305 
quickli¡Node
 *
fÜw¬d
 = 
quickli¡
->
h—d
;

306 
quickli¡Node
 *
»v”£
 = 
quickli¡
->

;

307 
d•th
 = 0;

308 
š_d•th
 = 0;

309 
d•th
++ < 
quickli¡
->
com´ess
) {

310 
	`quickli¡Decom´essNode
(
fÜw¬d
);

311 
	`quickli¡Decom´essNode
(
»v”£
);

313 ià(
fÜw¬d
 =ğ
node
 || 
»v”£
 ==‚ode)

314 
š_d•th
 = 1;

316 ià(
fÜw¬d
 =ğ
»v”£
)

319 
fÜw¬d
 = fÜw¬d->
Ãxt
;

320 
»v”£
 =„ev”£->
´ev
;

323 ià(!
š_d•th
)

324 
	`quickli¡Com´essNode
(
node
);

326 ià(
d•th
 > 2) {

328 
	`quickli¡Com´essNode
(
fÜw¬d
);

329 
	`quickli¡Com´essNode
(
»v”£
);

331 
	}
}

333 
	#quickli¡Com´ess
(
_ql
, 
_node
) \

335 ià((
_node
)->
»com´ess
) \

336 
	`quickli¡Com´essNode
((
_node
)); \

338 
	`__quickli¡Com´ess
((
_ql
), (
_node
)); \

339 } 0)

	)

342 
	#quickli¡Recom´essOÆy
(
_ql
, 
_node
) \

344 ià((
_node
)->
»com´ess
) \

345 
	`quickli¡Com´essNode
((
_node
)); \

346 } 0)

	)

352 
REDIS_STATIC
 
	$__quickli¡In£¹Node
(
quickli¡
 *quicklist,

353 
quickli¡Node
 *
Şd_node
,

354 
quickli¡Node
 *
Ãw_node
, 
aá”
) {

355 ià(
aá”
) {

356 
Ãw_node
->
´ev
 = 
Şd_node
;

357 ià(
Şd_node
) {

358 
Ãw_node
->
Ãxt
 = 
Şd_node
->next;

359 ià(
Şd_node
->
Ãxt
)

360 
Şd_node
->
Ãxt
->
´ev
 = 
Ãw_node
;

361 
Şd_node
->
Ãxt
 = 
Ãw_node
;

363 ià(
quickli¡
->

 =ğ
Şd_node
)

364 
quickli¡
->

 = 
Ãw_node
;

366 
Ãw_node
->
Ãxt
 = 
Şd_node
;

367 ià(
Şd_node
) {

368 
Ãw_node
->
´ev
 = 
Şd_node
->prev;

369 ià(
Şd_node
->
´ev
)

370 
Şd_node
->
´ev
->
Ãxt
 = 
Ãw_node
;

371 
Şd_node
->
´ev
 = 
Ãw_node
;

373 ià(
quickli¡
->
h—d
 =ğ
Şd_node
)

374 
quickli¡
->
h—d
 = 
Ãw_node
;

377 ià(
quickli¡
->
Ën
 == 0) {

378 
quickli¡
->
h—d
 = quickli¡->

 = 
Ãw_node
;

381 ià(
Şd_node
)

382 
	`quickli¡Com´ess
(
quickli¡
, 
Şd_node
);

384 
quickli¡
->
Ën
++;

385 
	}
}

388 
REDIS_STATIC
 
	$_quickli¡In£¹NodeBefÜe
(
quickli¡
 *quicklist,

389 
quickli¡Node
 *
Şd_node
,

390 
quickli¡Node
 *
Ãw_node
) {

391 
	`__quickli¡In£¹Node
(
quickli¡
, 
Şd_node
, 
Ãw_node
, 0);

392 
	}
}

394 
REDIS_STATIC
 
	$_quickli¡In£¹NodeAá”
(
quickli¡
 *quicklist,

395 
quickli¡Node
 *
Şd_node
,

396 
quickli¡Node
 *
Ãw_node
) {

397 
	`__quickli¡In£¹Node
(
quickli¡
, 
Şd_node
, 
Ãw_node
, 1);

398 
	}
}

400 
REDIS_STATIC
 

401 
	$_quickli¡NodeSizeM“tsO±imiz©iÚRequœem’t
(cÚ¡ 
size_t
 
sz
,

402 cÚ¡ 
fl
) {

403 ià(
fl
 >= 0)

406 
size_t
 
off£t
 = (-
fl
) - 1;

407 ià(
off£t
 < ((
İtimiz©iÚ_Ëv–
) / (*optimization_level))) {

408 ià(
sz
 <ğ
İtimiz©iÚ_Ëv–
[
off£t
]) {

416 
	}
}

418 
	#sizeM“tsSaãtyLim™
(
sz
è((szè<ğ
SIZE_SAFETY_LIMIT
)

	)

420 
REDIS_STATIC
 
	$_quickli¡NodeAÎowIn£¹
(cÚ¡ 
quickli¡Node
 *
node
,

421 cÚ¡ 
fl
, cÚ¡ 
size_t
 
sz
) {

422 ià(
	`uÆik–y
(!
node
))

425 
zli¡_ov”h—d
;

427 ià(
sz
 < 254)

428 
zli¡_ov”h—d
 = 1;

430 
zli¡_ov”h—d
 = 5;

433 ià(
sz
 < 64)

434 
zli¡_ov”h—d
 += 1;

435 ià(
	`lik–y
(
sz
 < 16384))

436 
zli¡_ov”h—d
 += 2;

438 
zli¡_ov”h—d
 += 5;

441 
Ãw_sz
 = 
node
->
sz
 + sz + 
zli¡_ov”h—d
;

442 ià(
	`lik–y
(
	`_quickli¡NodeSizeM“tsO±imiz©iÚRequœem’t
(
Ãw_sz
, 
fl
)))

444 ià(!
	`sizeM“tsSaãtyLim™
(
Ãw_sz
))

446 ià(()
node
->
couÁ
 < 
fl
)

450 
	}
}

452 
REDIS_STATIC
 
	$_quickli¡NodeAÎowM”ge
(cÚ¡ 
quickli¡Node
 *
a
,

453 cÚ¡ 
quickli¡Node
 *
b
,

454 cÚ¡ 
fl
) {

455 ià(!
a
 || !
b
)

460 
m”ge_sz
 = 
a
->
sz
 + 
b
->sz - 11;

461 ià(
	`lik–y
(
	`_quickli¡NodeSizeM“tsO±imiz©iÚRequœem’t
(
m”ge_sz
, 
fl
)))

463 ià(!
	`sizeM“tsSaãtyLim™
(
m”ge_sz
))

465 ià(()(
a
->
couÁ
 + 
b
->couÁè<ğ
fl
)

469 
	}
}

471 
	#quickli¡NodeUpd©eSz
(
node
) \

473 (
node
)->
sz
 = 
	`zli¡BlobL’
(Òode)->
zl
); \

474 } 0)

	)

480 
	$quickli¡PushH—d
(
quickli¡
 *quickli¡, *
v®ue
, 
size_t
 
sz
) {

481 
quickli¡Node
 *
Üig_h—d
 = 
quickli¡
->
h—d
;

482 ià(
	`lik–y
(

483 
	`_quickli¡NodeAÎowIn£¹
(
quickli¡
->
h—d
, quickli¡->
fl
, 
sz
))) {

484 
quickli¡
->
h—d
->
zl
 =

485 
	`zli¡Push
(
quickli¡
->
h—d
->
zl
, 
v®ue
, 
sz
, 
ZIPLIST_HEAD
);

486 
	`quickli¡NodeUpd©eSz
(
quickli¡
->
h—d
);

488 
quickli¡Node
 *
node
 = 
	`quickli¡C»©eNode
();

489 
node
->
zl
 = 
	`zli¡Push
(
	`zli¡New
(), 
v®ue
, 
sz
, 
ZIPLIST_HEAD
);

491 
	`quickli¡NodeUpd©eSz
(
node
);

492 
	`_quickli¡In£¹NodeBefÜe
(
quickli¡
, quickli¡->
h—d
, 
node
);

494 
quickli¡
->
couÁ
++;

495 
quickli¡
->
h—d
->
couÁ
++;

496  (
Üig_h—d
 !ğ
quickli¡
->
h—d
);

497 
	}
}

503 
	$quickli¡PushTa
(
quickli¡
 *quickli¡, *
v®ue
, 
size_t
 
sz
) {

504 
quickli¡Node
 *
Üig_
 = 
quickli¡
->

;

505 ià(
	`lik–y
(

506 
	`_quickli¡NodeAÎowIn£¹
(
quickli¡
->

, quickli¡->
fl
, 
sz
))) {

507 
quickli¡
->

->
zl
 =

508 
	`zli¡Push
(
quickli¡
->

->
zl
, 
v®ue
, 
sz
, 
ZIPLIST_TAIL
);

509 
	`quickli¡NodeUpd©eSz
(
quickli¡
->

);

511 
quickli¡Node
 *
node
 = 
	`quickli¡C»©eNode
();

512 
node
->
zl
 = 
	`zli¡Push
(
	`zli¡New
(), 
v®ue
, 
sz
, 
ZIPLIST_TAIL
);

514 
	`quickli¡NodeUpd©eSz
(
node
);

515 
	`_quickli¡In£¹NodeAá”
(
quickli¡
, quickli¡->

, 
node
);

517 
quickli¡
->
couÁ
++;

518 
quickli¡
->

->
couÁ
++;

519  (
Üig_
 !ğ
quickli¡
->

);

520 
	}
}

525 
	$quickli¡Aµ’dZli¡
(
quickli¡
 *quickli¡, *
zl
) {

526 
quickli¡Node
 *
node
 = 
	`quickli¡C»©eNode
();

528 
node
->
zl
 = zl;

529 
node
->
couÁ
 = 
	`zli¡L’
Òode->
zl
);

530 
node
->
sz
 = 
	`zli¡BlobL’
(
zl
);

532 
	`_quickli¡In£¹NodeAá”
(
quickli¡
, quickli¡->

, 
node
);

533 
quickli¡
->
couÁ
 +ğ
node
->count;

534 
	}
}

542 
quickli¡
 *
	$quickli¡Aµ’dV®uesFromZli¡
(
quickli¡
 *quicklist,

543 *
zl
) {

544 *
v®ue
;

545 
sz
;

546 
lÚgv®
;

547 
lÚg¡r
[32] = {0};

549 *
p
 = 
	`zli¡Index
(
zl
, 0);

550 
	`zli¡G‘
(
p
, &
v®ue
, &
sz
, &
lÚgv®
)) {

551 ià(!
v®ue
) {

553 
sz
 = 
	`Î2¡ršg
(
lÚg¡r
, ÖÚg¡r), 
lÚgv®
);

554 
v®ue
 = (*)
lÚg¡r
;

556 
	`quickli¡PushTa
(
quickli¡
, 
v®ue
, 
sz
);

557 
p
 = 
	`zli¡Next
(
zl
,…);

559 
	`zä“
(
zl
);

560  
quickli¡
;

561 
	}
}

566 
quickli¡
 *
	$quickli¡C»©eFromZli¡
(
fl
, 
com´ess
,

567 *
zl
) {

568  
	`quickli¡Aµ’dV®uesFromZli¡
(
	`quickli¡New
(
fl
, 
com´ess
), 
zl
);

569 
	}
}

571 
	#quickli¡D–‘eIfEm±y
(
ql
, 
n
) \

573 ià((
n
)->
couÁ
 == 0) { \

574 
	`__quickli¡D–Node
((
ql
), (
n
)); \

575 (
n
èğ
NULL
; \

577 } 0)

	)

579 
REDIS_STATIC
 
	$__quickli¡D–Node
(
quickli¡
 *quicklist,

580 
quickli¡Node
 *
node
) {

581 ià(
node
->
Ãxt
)

582 
node
->
Ãxt
->
´ev
 =‚ode->prev;

583 ià(
node
->
´ev
)

584 
node
->
´ev
->
Ãxt
 =‚ode->next;

586 ià(
node
 =ğ
quickli¡
->

) {

587 
quickli¡
->

 = 
node
->
´ev
;

590 ià(
node
 =ğ
quickli¡
->
h—d
) {

591 
quickli¡
->
h—d
 = 
node
->
Ãxt
;

596 
	`__quickli¡Com´ess
(
quickli¡
, 
NULL
);

598 
quickli¡
->
couÁ
 -ğ
node
->count;

600 
	`zä“
(
node
->
zl
);

601 
	`zä“
(
node
);

602 
quickli¡
->
Ën
--;

603 
	}
}

613 
REDIS_STATIC
 
	$quickli¡D–Index
(
quickli¡
 *quickli¡, 
quickli¡Node
 *
node
,

614 **
p
) {

615 
gÚe
 = 0;

617 
node
->
zl
 = 
	`zli¡D–‘e
Òode->zl, 
p
);

618 
node
->
couÁ
--;

619 ià(
node
->
couÁ
 == 0) {

620 
gÚe
 = 1;

621 
	`__quickli¡D–Node
(
quickli¡
, 
node
);

623 
	`quickli¡NodeUpd©eSz
(
node
);

625 
quickli¡
->
couÁ
--;

627  
gÚe
 ? 1 : 0;

628 
	}
}

634 
	$quickli¡D–EÁry
(
quickli¡I‹r
 *
™”
, 
quickli¡EÁry
 *
’Œy
) {

635 
quickli¡Node
 *
´ev
 = 
’Œy
->
node
->prev;

636 
quickli¡Node
 *
Ãxt
 = 
’Œy
->
node
->next;

637 
d–‘ed_node
 = 
	`quickli¡D–Index
((
quickli¡
 *)
’Œy
->quicklist,

638 
’Œy
->
node
, &’Œy->
zi
);

641 
™”
->
zi
 = 
NULL
;

644 ià(
d–‘ed_node
) {

645 ià(
™”
->
dœeùiÚ
 =ğ
AL_START_HEAD
) {

646 
™”
->
cu¼’t
 = 
Ãxt
;

647 
™”
->
off£t
 = 0;

648 } ià(
™”
->
dœeùiÚ
 =ğ
AL_START_TAIL
) {

649 
™”
->
cu¼’t
 = 
´ev
;

650 
™”
->
off£t
 = -1;

661 
	}
}

667 
	$quickli¡R•ÏûAtIndex
(
quickli¡
 *quickli¡, 
šdex
, *
d©a
,

668 
sz
) {

669 
quickli¡EÁry
 
’Œy
;

670 ià(
	`lik–y
(
	`quickli¡Index
(
quickli¡
, 
šdex
, &
’Œy
))) {

672 
’Œy
.
node
->
zl
 = 
	`zli¡D–‘e
ÓÁry.node->zl, &’Œy.
zi
);

673 
’Œy
.
node
->
zl
 = 
	`zli¡In£¹
ÓÁry.node->zl,ƒÁry.
zi
, 
d©a
, 
sz
);

674 
	`quickli¡NodeUpd©eSz
(
’Œy
.
node
);

675 
	`quickli¡Com´ess
(
quickli¡
, 
’Œy
.
node
);

680 
	}
}

695 
REDIS_STATIC
 
quickli¡Node
 *
	$_quickli¡Zli¡M”ge
(
quickli¡
 *quicklist,

696 
quickli¡Node
 *
a
,

697 
quickli¡Node
 *
b
) {

698 
	`D
("Reque¡ed m”g×,bè(%u, %u)", 
a
->
couÁ
, 
b
->count);

700 
	`quickli¡Decom´essNode
(
a
);

701 
	`quickli¡Decom´essNode
(
b
);

702 ià((
	`zli¡M”ge
(&
a
->
zl
, &
b
->zl))) {

704 
quickli¡Node
 *
k“p
 = 
NULL
, *
nok“p
 = NULL;

705 ià(!
a
->
zl
) {

706 
nok“p
 = 
a
;

707 
k“p
 = 
b
;

708 } ià(!
b
->
zl
) {

709 
nok“p
 = 
b
;

710 
k“p
 = 
a
;

712 
k“p
->
couÁ
 = 
	`zli¡L’
(k“p->
zl
);

713 
	`quickli¡NodeUpd©eSz
(
k“p
);

715 
nok“p
->
couÁ
 = 0;

716 
	`__quickli¡D–Node
(
quickli¡
, 
nok“p
);

717 
	`quickli¡Com´ess
(
quickli¡
, 
k“p
);

718  
k“p
;

721  
NULL
;

723 
	}
}

733 
REDIS_STATIC
 
	$_quickli¡M”geNodes
(
quickli¡
 *quicklist,

734 
quickli¡Node
 *
ûÁ”
) {

735 
fl
 = 
quickli¡
->fill;

736 
quickli¡Node
 *
´ev
, *
´ev_´ev
, *
Ãxt
, *
Ãxt_Ãxt
, *
rg‘
;

737 
´ev
 = 
´ev_´ev
 = 
Ãxt
 = 
Ãxt_Ãxt
 = 
rg‘
 = 
NULL
;

739 ià(
ûÁ”
->
´ev
) {

740 
´ev
 = 
ûÁ”
->prev;

741 ià(
ûÁ”
->
´ev
->prev)

742 
´ev_´ev
 = 
ûÁ”
->
´ev
->prev;

745 ià(
ûÁ”
->
Ãxt
) {

746 
Ãxt
 = 
ûÁ”
->next;

747 ià(
ûÁ”
->
Ãxt
->next)

748 
Ãxt_Ãxt
 = 
ûÁ”
->
Ãxt
->next;

752 ià(
	`_quickli¡NodeAÎowM”ge
(
´ev
, 
´ev_´ev
, 
fl
)) {

753 
	`_quickli¡Zli¡M”ge
(
quickli¡
, 
´ev_´ev
, 
´ev
);

754 
´ev_´ev
 = 
´ev
 = 
NULL
;

758 ià(
	`_quickli¡NodeAÎowM”ge
(
Ãxt
, 
Ãxt_Ãxt
, 
fl
)) {

759 
	`_quickli¡Zli¡M”ge
(
quickli¡
, 
Ãxt
, 
Ãxt_Ãxt
);

760 
Ãxt
 = 
Ãxt_Ãxt
 = 
NULL
;

764 ià(
	`_quickli¡NodeAÎowM”ge
(
ûÁ”
, c’‹r->
´ev
, 
fl
)) {

765 
rg‘
 = 
	`_quickli¡Zli¡M”ge
(
quickli¡
, 
ûÁ”
->
´ev
, center);

766 
ûÁ”
 = 
NULL
;

769 
rg‘
 = 
ûÁ”
;

773 ià(
	`_quickli¡NodeAÎowM”ge
(
rg‘
,¬g‘->
Ãxt
, 
fl
)) {

774 
	`_quickli¡Zli¡M”ge
(
quickli¡
, 
rg‘
,¬g‘->
Ãxt
);

776 
	}
}

797 
REDIS_STATIC
 
quickli¡Node
 *
	$_quickli¡S¶™Node
(
quickli¡Node
 *
node
, 
off£t
,

798 
aá”
) {

799 
size_t
 
zl_sz
 = 
node
->
sz
;

801 
quickli¡Node
 *
Ãw_node
 = 
	`quickli¡C»©eNode
();

802 
Ãw_node
->
zl
 = 
	`zm®loc
(
zl_sz
);

805 
	`memıy
(
Ãw_node
->
zl
, 
node
->zl, 
zl_sz
);

808 
Üig_¡¬t
 = 
aá”
 ? 
off£t
 + 1 : 0;

809 
Üig_ex‹Á
 = 
aá”
 ? -1 : 
off£t
;

810 
Ãw_¡¬t
 = 
aá”
 ? 0 : 
off£t
;

811 
Ãw_ex‹Á
 = 
aá”
 ? 
off£t
 + 1 : -1;

813 
	`D
("Aá” %d (%d);„ªges: [%d, %d], [%d, %d]", 
aá”
, 
off£t
, 
Üig_¡¬t
,

814 
Üig_ex‹Á
, 
Ãw_¡¬t
, 
Ãw_ex‹Á
);

816 
node
->
zl
 = 
	`zli¡D–‘eRªge
Òode->zl, 
Üig_¡¬t
, 
Üig_ex‹Á
);

817 
node
->
couÁ
 = 
	`zli¡L’
Òode->
zl
);

818 
	`quickli¡NodeUpd©eSz
(
node
);

820 
Ãw_node
->
zl
 = 
	`zli¡D–‘eRªge
Òew_node->zl, 
Ãw_¡¬t
, 
Ãw_ex‹Á
);

821 
Ãw_node
->
couÁ
 = 
	`zli¡L’
Òew_node->
zl
);

822 
	`quickli¡NodeUpd©eSz
(
Ãw_node
);

824 
	`D
("Aá” s¶™†’gths: orig (%d),‚ew (%d)", 
node
->
couÁ
, 
Ãw_node
->count);

825  
Ãw_node
;

826 
	}
}

832 
REDIS_STATIC
 
	$_quickli¡In£¹
(
quickli¡
 *quickli¡, 
quickli¡EÁry
 *
’Œy
,

833 *
v®ue
, cÚ¡ 
size_t
 
sz
, 
aá”
) {

834 
fuÎ
 = 0, 
©_
 = 0, 
©_h—d
 = 0, 
fuÎ_Ãxt
 = 0, 
fuÎ_´ev
 = 0;

835 
fl
 = 
quickli¡
->fill;

836 
quickli¡Node
 *
node
 = 
’Œy
->node;

837 
quickli¡Node
 *
Ãw_node
 = 
NULL
;

839 ià(!
node
) {

841 
	`D
("No‚ode given!");

842 
Ãw_node
 = 
	`quickli¡C»©eNode
();

843 
Ãw_node
->
zl
 = 
	`zli¡Push
(
	`zli¡New
(), 
v®ue
, 
sz
, 
ZIPLIST_HEAD
);

844 
	`__quickli¡In£¹Node
(
quickli¡
, 
NULL
, 
Ãw_node
, 
aá”
);

845 
Ãw_node
->
couÁ
++;

846 
quickli¡
->
couÁ
++;

851 ià(!
	`_quickli¡NodeAÎowIn£¹
(
node
, 
fl
, 
sz
)) {

852 
	`D
("Current‚ode is full with count %d with„equested fill %lu",

853 
node
->
couÁ
, 
fl
);

854 
fuÎ
 = 1;

857 ià(
aá”
 && (
’Œy
->
off£t
 =ğ
node
->
couÁ
)) {

858 
	`D
("At Tail of current ziplist");

859 
©_
 = 1;

860 ià(!
	`_quickli¡NodeAÎowIn£¹
(
node
->
Ãxt
, 
fl
, 
sz
)) {

861 
	`D
("Next‚ode is fulloo.");

862 
fuÎ_Ãxt
 = 1;

866 ià(!
aá”
 && (
’Œy
->
off£t
 == 0)) {

867 
	`D
("At Head");

868 
©_h—d
 = 1;

869 ià(!
	`_quickli¡NodeAÎowIn£¹
(
node
->
´ev
, 
fl
, 
sz
)) {

870 
	`D
("Prev‚ode is fulloo.");

871 
fuÎ_´ev
 = 1;

876 ià(!
fuÎ
 && 
aá”
) {

877 
	`D
("Not full, inserting‡fter current…osition.");

878 
	`quickli¡Decom´essNodeFÜU£
(
node
);

879 *
Ãxt
 = 
	`zli¡Next
(
node
->
zl
, 
’Œy
->
zi
);

880 ià(
Ãxt
 =ğ
NULL
) {

881 
node
->
zl
 = 
	`zli¡Push
Òode->zl, 
v®ue
, 
sz
, 
ZIPLIST_TAIL
);

883 
node
->
zl
 = 
	`zli¡In£¹
Òode->zl, 
Ãxt
, 
v®ue
, 
sz
);

885 
node
->
couÁ
++;

886 
	`quickli¡NodeUpd©eSz
(
node
);

887 
	`quickli¡Recom´essOÆy
(
quickli¡
, 
node
);

888 } ià(!
fuÎ
 && !
aá”
) {

889 
	`D
("Not full, inserting before current…osition.");

890 
	`quickli¡Decom´essNodeFÜU£
(
node
);

891 
node
->
zl
 = 
	`zli¡In£¹
Òode->zl, 
’Œy
->
zi
, 
v®ue
, 
sz
);

892 
node
->
couÁ
++;

893 
	`quickli¡NodeUpd©eSz
(
node
);

894 
	`quickli¡Recom´essOÆy
(
quickli¡
, 
node
);

895 } ià(
fuÎ
 && 
©_
 && 
node
->
Ãxt
 && !
fuÎ_Ãxt
 && 
aá”
) {

898 
	`D
("Full‡ndail, but‚ext isn't full; inserting‚ext‚ode head");

899 
Ãw_node
 = 
node
->
Ãxt
;

900 
	`quickli¡Decom´essNodeFÜU£
(
Ãw_node
);

901 
Ãw_node
->
zl
 = 
	`zli¡Push
Òew_node->zl, 
v®ue
, 
sz
, 
ZIPLIST_HEAD
);

902 
Ãw_node
->
couÁ
++;

903 
	`quickli¡NodeUpd©eSz
(
Ãw_node
);

904 
	`quickli¡Recom´essOÆy
(
quickli¡
, 
Ãw_node
);

905 } ià(
fuÎ
 && 
©_h—d
 && 
node
->
´ev
 && !
fuÎ_´ev
 && !
aá”
) {

908 
	`D
("Full‡nd head, but…rev isn't full, inserting…rev‚odeail");

909 
Ãw_node
 = 
node
->
´ev
;

910 
	`quickli¡Decom´essNodeFÜU£
(
Ãw_node
);

911 
Ãw_node
->
zl
 = 
	`zli¡Push
Òew_node->zl, 
v®ue
, 
sz
, 
ZIPLIST_TAIL
);

912 
Ãw_node
->
couÁ
++;

913 
	`quickli¡NodeUpd©eSz
(
Ãw_node
);

914 
	`quickli¡Recom´essOÆy
(
quickli¡
, 
Ãw_node
);

915 } ià(
fuÎ
 && ((
©_
 && 
node
->
Ãxt
 && 
fuÎ_Ãxt
 && 
aá”
) ||

916 (
©_h—d
 && 
node
->
´ev
 && 
fuÎ_´ev
 && !
aá”
))) {

919 
	`D
("\tprovisioning‚ew‚ode...");

920 
Ãw_node
 = 
	`quickli¡C»©eNode
();

921 
Ãw_node
->
zl
 = 
	`zli¡Push
(
	`zli¡New
(), 
v®ue
, 
sz
, 
ZIPLIST_HEAD
);

922 
Ãw_node
->
couÁ
++;

923 
	`quickli¡NodeUpd©eSz
(
Ãw_node
);

924 
	`__quickli¡In£¹Node
(
quickli¡
, 
node
, 
Ãw_node
, 
aá”
);

925 } ià(
fuÎ
) {

928 
	`D
("\tsplitting‚ode...");

929 
	`quickli¡Decom´essNodeFÜU£
(
node
);

930 
Ãw_node
 = 
	`_quickli¡S¶™Node
(
node
, 
’Œy
->
off£t
, 
aá”
);

931 
Ãw_node
->
zl
 = 
	`zli¡Push
Òew_node->zl, 
v®ue
, 
sz
,

932 
aá”
 ? 
ZIPLIST_HEAD
 : 
ZIPLIST_TAIL
);

933 
Ãw_node
->
couÁ
++;

934 
	`quickli¡NodeUpd©eSz
(
Ãw_node
);

935 
	`__quickli¡In£¹Node
(
quickli¡
, 
node
, 
Ãw_node
, 
aá”
);

936 
	`_quickli¡M”geNodes
(
quickli¡
, 
node
);

939 
quickli¡
->
couÁ
++;

940 
	}
}

942 
	$quickli¡In£¹BefÜe
(
quickli¡
 *quickli¡, 
quickli¡EÁry
 *
’Œy
,

943 *
v®ue
, cÚ¡ 
size_t
 
sz
) {

944 
	`_quickli¡In£¹
(
quickli¡
, 
’Œy
, 
v®ue
, 
sz
, 0);

945 
	}
}

947 
	$quickli¡In£¹Aá”
(
quickli¡
 *quickli¡, 
quickli¡EÁry
 *
’Œy
,

948 *
v®ue
, cÚ¡ 
size_t
 
sz
) {

949 
	`_quickli¡In£¹
(
quickli¡
, 
’Œy
, 
v®ue
, 
sz
, 1);

950 
	}
}

958 
	$quickli¡D–Rªge
(
quickli¡
 *quickli¡, cÚ¡ 
¡¬t
,

959 cÚ¡ 
couÁ
) {

960 ià(
couÁ
 <= 0)

963 
ex‹Á
 = 
couÁ
;

965 ià(
¡¬t
 >ğ0 && 
ex‹Á
 > (
quickli¡
->
couÁ
 - start)) {

967 
ex‹Á
 = 
quickli¡
->
couÁ
 - 
¡¬t
;

968 } ià(
¡¬t
 < 0 && 
ex‹Á
 > ()(-start)) {

970 
ex‹Á
 = -
¡¬t
;

973 
quickli¡EÁry
 
’Œy
;

974 ià(!
	`quickli¡Index
(
quickli¡
, 
¡¬t
, &
’Œy
))

977 
	`D
("Quickli¡ d–‘»que¡ fÜ s¹ %ld, couÁ %ld,ƒx‹Á: %ld", 
¡¬t
,

978 
couÁ
, 
ex‹Á
);

979 
quickli¡Node
 *
node
 = 
’Œy
.node;

982 
ex‹Á
) {

983 
quickli¡Node
 *
Ãxt
 = 
node
->next;

985 
d–
;

986 
d–‘e_’tœe_node
 = 0;

987 ià(
’Œy
.
off£t
 =ğ0 && 
ex‹Á
 >ğ
node
->
couÁ
) {

990 
d–‘e_’tœe_node
 = 1;

991 
d–
 = 
node
->
couÁ
;

992 } ià(
’Œy
.
off£t
 >ğ0 && 
ex‹Á
 >ğ
node
->
couÁ
) {

995 
d–
 = 
node
->
couÁ
 - 
’Œy
.
off£t
;

996 } ià(
’Œy
.
off£t
 < 0) {

1002 
d–
 = -
’Œy
.
off£t
;

1007 ià(
d–
 > 
ex‹Á
)

1008 
d–
 = 
ex‹Á
;

1012 
d–
 = 
ex‹Á
;

1015 
	`D
("[%ld]:‡skingo del: %ld because offset: %d; (ENTIRE NODE: %d), "

1017 
ex‹Á
, 
d–
, 
’Œy
.
off£t
, 
d–‘e_’tœe_node
, 
node
->
couÁ
);

1019 ià(
d–‘e_’tœe_node
) {

1020 
	`__quickli¡D–Node
(
quickli¡
, 
node
);

1022 
	`quickli¡Decom´essNodeFÜU£
(
node
);

1023 
node
->
zl
 = 
	`zli¡D–‘eRªge
Òode->zl, 
’Œy
.
off£t
, 
d–
);

1024 
	`quickli¡NodeUpd©eSz
(
node
);

1025 
node
->
couÁ
 -ğ
d–
;

1026 
quickli¡
->
couÁ
 -ğ
d–
;

1027 
	`quickli¡D–‘eIfEm±y
(
quickli¡
, 
node
);

1028 ià(
node
)

1029 
	`quickli¡Recom´essOÆy
(
quickli¡
, 
node
);

1032 
ex‹Á
 -ğ
d–
;

1034 
node
 = 
Ãxt
;

1036 
’Œy
.
off£t
 = 0;

1039 
	}
}

1042 
	$quickli¡Com·»
(*
p1
, *
p2
, 
p2_Ën
) {

1043  
	`zli¡Com·»
(
p1
, 
p2
, 
p2_Ën
);

1044 
	}
}

1048 
quickli¡I‹r
 *
	$quickli¡G‘I‹¿tÜ
(cÚ¡ 
quickli¡
 *quickli¡, 
dœeùiÚ
) {

1049 
quickli¡I‹r
 *
™”
;

1051 
™”
 = 
	`zm®loc
((*iter));

1053 ià(
dœeùiÚ
 =ğ
AL_START_HEAD
) {

1054 
™”
->
cu¼’t
 = 
quickli¡
->
h—d
;

1055 
™”
->
off£t
 = 0;

1056 } ià(
dœeùiÚ
 =ğ
AL_START_TAIL
) {

1057 
™”
->
cu¼’t
 = 
quickli¡
->

;

1058 
™”
->
off£t
 = -1;

1061 
™”
->
dœeùiÚ
 = direction;

1062 
™”
->
quickli¡
 = quicklist;

1064 
™”
->
zi
 = 
NULL
;

1066  
™”
;

1067 
	}
}

1071 
quickli¡I‹r
 *
	$quickli¡G‘I‹¿tÜAtIdx
(cÚ¡ 
quickli¡
 *quicklist,

1072 cÚ¡ 
dœeùiÚ
,

1073 cÚ¡ 
idx
) {

1074 
quickli¡EÁry
 
’Œy
;

1076 ià(
	`quickli¡Index
(
quickli¡
, 
idx
, &
’Œy
)) {

1077 
quickli¡I‹r
 *
ba£
 = 
	`quickli¡G‘I‹¿tÜ
(
quickli¡
, 
dœeùiÚ
);

1078 
ba£
->
zi
 = 
NULL
;

1079 
ba£
->
cu¼’t
 = 
’Œy
.
node
;

1080 
ba£
->
off£t
 = 
’Œy
.offset;

1081  
ba£
;

1083  
NULL
;

1085 
	}
}

1089 
	$quickli¡R–—£I‹¿tÜ
(
quickli¡I‹r
 *
™”
) {

1090 ià(
™”
->
cu¼’t
)

1091 
	`quickli¡Com´ess
(
™”
->
quickli¡
, i‹r->
cu¼’t
);

1093 
	`zä“
(
™”
);

1094 
	}
}

1117 
	$quickli¡Next
(
quickli¡I‹r
 *
™”
, 
quickli¡EÁry
 *
’Œy
) {

1118 
	`š™EÁry
(
’Œy
);

1120 ià(!
™”
) {

1121 
	`D
("Returning because‚o iter!");

1125 
’Œy
->
quickli¡
 = 
™”
->quicklist;

1126 
’Œy
->
node
 = 
™”
->
cu¼’t
;

1128 ià(!
™”
->
cu¼’t
) {

1129 
	`D
("Returning because current‚ode is NULL")

1133 *(*
ÃxtFn
)(*, *èğ
NULL
;

1134 
off£t_upd©e
 = 0;

1136 ià(!
™”
->
zi
) {

1138 
	`quickli¡Decom´essNodeFÜU£
(
™”
->
cu¼’t
);

1139 
™”
->
zi
 = 
	`zli¡Index
(™”->
cu¼’t
->
zl
, i‹r->
off£t
);

1142 ià(
™”
->
dœeùiÚ
 =ğ
AL_START_HEAD
) {

1143 
ÃxtFn
 = 
zli¡Next
;

1144 
off£t_upd©e
 = 1;

1145 } ià(
™”
->
dœeùiÚ
 =ğ
AL_START_TAIL
) {

1146 
ÃxtFn
 = 
zli¡P»v
;

1147 
off£t_upd©e
 = -1;

1149 
™”
->
zi
 = 
	`ÃxtFn
(™”->
cu¼’t
->
zl
, iter->zi);

1150 
™”
->
off£t
 +ğ
off£t_upd©e
;

1153 
’Œy
->
zi
 = 
™”
->zi;

1154 
’Œy
->
off£t
 = 
™”
->offset;

1156 ià(
™”
->
zi
) {

1158 
	`zli¡G‘
(
’Œy
->
zi
, &’Œy->
v®ue
, &’Œy->
sz
, &’Œy->
lÚgv®
);

1163 
	`quickli¡Com´ess
(
™”
->
quickli¡
, i‹r->
cu¼’t
);

1164 ià(
™”
->
dœeùiÚ
 =ğ
AL_START_HEAD
) {

1166 
	`D
("Jumpingo start of‚ext‚ode");

1167 
™”
->
cu¼’t
 = i‹r->cu¼’t->
Ãxt
;

1168 
™”
->
off£t
 = 0;

1169 } ià(
™”
->
dœeùiÚ
 =ğ
AL_START_TAIL
) {

1171 
	`D
("Jumpingoƒnd of…revious‚ode");

1172 
™”
->
cu¼’t
 = i‹r->cu¼’t->
´ev
;

1173 
™”
->
off£t
 = -1;

1175 
™”
->
zi
 = 
NULL
;

1176  
	`quickli¡Next
(
™”
, 
’Œy
);

1178 
	}
}

1186 
quickli¡
 *
	$quickli¡Dup
(
quickli¡
 *
Üig
) {

1187 
quickli¡
 *
cİy
;

1189 
cİy
 = 
	`quickli¡New
(
Üig
->
fl
, orig->
com´ess
);

1191 
quickli¡Node
 *
cu¼’t
 = 
Üig
->
h—d
; current;

1192 
cu¼’t
 = cu¼’t->
Ãxt
) {

1193 
quickli¡Node
 *
node
 = 
	`quickli¡C»©eNode
();

1195 ià(
node
->
’codšg
 =ğ
QUICKLIST_NODE_ENCODING_LZF
) {

1196 
quickli¡LZF
 *
lzf
 = (quickli¡LZF *)
node
->
zl
;

1197 
size_t
 
lzf_sz
 = (*
lzf
è+†zf->
sz
;

1198 
node
->
zl
 = 
	`zm®loc
(
lzf_sz
);

1199 
	`memıy
(
node
->
zl
, 
cu¼’t
->zl, 
lzf_sz
);

1200 } ià(
node
->
’codšg
 =ğ
QUICKLIST_NODE_ENCODING_RAW
) {

1201 
node
->
zl
 = 
	`zm®loc
(
cu¼’t
->
sz
);

1202 
	`memıy
(
node
->
zl
, 
cu¼’t
->zl, cu¼’t->
sz
);

1205 
node
->
couÁ
 = 
cu¼’t
->count;

1206 
cİy
->
couÁ
 +ğ
node
->count;

1207 
node
->
sz
 = 
cu¼’t
->sz;

1208 
node
->
’codšg
 = 
cu¼’t
->encoding;

1210 
	`_quickli¡In£¹NodeAá”
(
cİy
, cİy->

, 
node
);

1214  
cİy
;

1215 
	}
}

1225 
	$quickli¡Index
(cÚ¡ 
quickli¡
 *quickli¡, cÚ¡ 
idx
,

1226 
quickli¡EÁry
 *
’Œy
) {

1227 
quickli¡Node
 *
n
;

1228 
accum
 = 0;

1229 
šdex
;

1230 
fÜw¬d
 = 
idx
 < 0 ? 0 : 1;

1232 
	`š™EÁry
(
’Œy
);

1233 
’Œy
->
quickli¡
 = quicklist;

1235 ià(!
fÜw¬d
) {

1236 
šdex
 = (-
idx
) - 1;

1237 
n
 = 
quickli¡
->

;

1239 
šdex
 = 
idx
;

1240 
n
 = 
quickli¡
->
h—d
;

1243 ià(
šdex
 >ğ
quickli¡
->
couÁ
)

1246 
	`lik–y
(
n
)) {

1247 ià((
accum
 + 
n
->
couÁ
è> 
šdex
) {

1250 
	`D
("Skpšg ov” (%pè%u‡ˆaccum %Îd", (*)
n
,‚->
couÁ
,

1251 
accum
);

1252 
accum
 +ğ
n
->
couÁ
;

1253 
n
 = 
fÜw¬d
 ?‚->
Ãxt
 :‚->
´ev
;

1257 ià(!
n
)

1260 
	`D
("Found‚ode: %°©‡ccum %Îu, idx %Îu, sub+ %Îu, sub- %Îu", (*)
n
,

1261 
accum
, 
šdex
, index -‡ccum, (-index) - 1 +‡ccum);

1263 
’Œy
->
node
 = 
n
;

1264 ià(
fÜw¬d
) {

1266 
’Œy
->
off£t
 = 
šdex
 - 
accum
;

1270 
’Œy
->
off£t
 = (-
šdex
è- 1 + 
accum
;

1273 
	`quickli¡Decom´essNodeFÜU£
(
’Œy
->
node
);

1274 
’Œy
->
zi
 = 
	`zli¡Index
ÓÁry->
node
->
zl
,ƒÁry->
off£t
);

1275 
	`zli¡G‘
(
’Œy
->
zi
, &’Œy->
v®ue
, &’Œy->
sz
, &’Œy->
lÚgv®
);

1279 
	}
}

1282 
	$quickli¡RÙ©e
(
quickli¡
 *quicklist) {

1283 ià(
quickli¡
->
couÁ
 <= 1)

1287 *
p
 = 
	`zli¡Index
(
quickli¡
->

->
zl
, -1);

1288 *
v®ue
;

1289 
lÚgv®
;

1290 
sz
;

1291 
lÚg¡r
[32] = {0};

1292 
	`zli¡G‘
(
p
, &
v®ue
, &
sz
, &
lÚgv®
);

1295 ià(!
v®ue
) {

1297 
sz
 = 
	`Î2¡ršg
(
lÚg¡r
, ÖÚg¡r), 
lÚgv®
);

1298 
v®ue
 = (*)
lÚg¡r
;

1302 
	`quickli¡PushH—d
(
quickli¡
, 
v®ue
, 
sz
);

1307 ià(
quickli¡
->
Ën
 == 1) {

1308 
p
 = 
	`zli¡Index
(
quickli¡
->

->
zl
, -1);

1312 
	`quickli¡D–Index
(
quickli¡
, quickli¡->

, &
p
);

1313 
	}
}

1324 
	$quickli¡PİCu¡om
(
quickli¡
 *quickli¡, 
wh”e
, **
d©a
,

1325 *
sz
, *
sv®
,

1326 *(*
§v”
)(*
d©a
, 
sz
)) {

1327 *
p
;

1328 *
v¡r
;

1329 
vËn
;

1330 
vlÚg
;

1331 
pos
 = (
wh”e
 =ğ
QUICKLIST_HEAD
) ? 0 : -1;

1333 ià(
quickli¡
->
couÁ
 == 0)

1336 ià(
d©a
)

1337 *
d©a
 = 
NULL
;

1338 ià(
sz
)

1339 *
sz
 = 0;

1340 ià(
sv®
)

1341 *
sv®
 = -123456789;

1343 
quickli¡Node
 *
node
;

1344 ià(
wh”e
 =ğ
QUICKLIST_HEAD
 && 
quickli¡
->
h—d
) {

1345 
node
 = 
quickli¡
->
h—d
;

1346 } ià(
wh”e
 =ğ
QUICKLIST_TAIL
 && 
quickli¡
->

) {

1347 
node
 = 
quickli¡
->

;

1352 
p
 = 
	`zli¡Index
(
node
->
zl
, 
pos
);

1353 ià(
	`zli¡G‘
(
p
, &
v¡r
, &
vËn
, &
vlÚg
)) {

1354 ià(
v¡r
) {

1355 ià(
d©a
)

1356 *
d©a
 = 
	`§v”
(
v¡r
, 
vËn
);

1357 ià(
sz
)

1358 *
sz
 = 
vËn
;

1360 ià(
d©a
)

1361 *
d©a
 = 
NULL
;

1362 ià(
sv®
)

1363 *
sv®
 = 
vlÚg
;

1365 
	`quickli¡D–Index
(
quickli¡
, 
node
, &
p
);

1369 
	}
}

1372 
REDIS_STATIC
 *
	$_quickli¡Sav”
(*
d©a
, 
sz
) {

1373 *
v¡r
;

1374 ià(
d©a
) {

1375 
v¡r
 = 
	`zm®loc
(
sz
);

1376 
	`memıy
(
v¡r
, 
d©a
, 
sz
);

1377  
v¡r
;

1379  
NULL
;

1380 
	}
}

1385 
	$quickli¡Pİ
(
quickli¡
 *quickli¡, 
wh”e
, **
d©a
,

1386 *
sz
, *
¦Úg
) {

1387 *
v¡r
;

1388 
vËn
;

1389 
vlÚg
;

1390 ià(
quickli¡
->
couÁ
 == 0)

1392 
»t
 = 
	`quickli¡PİCu¡om
(
quickli¡
, 
wh”e
, &
v¡r
, &
vËn
, &
vlÚg
,

1393 
_quickli¡Sav”
);

1394 ià(
d©a
)

1395 *
d©a
 = 
v¡r
;

1396 ià(
¦Úg
)

1397 *
¦Úg
 = 
vlÚg
;

1398 ià(
sz
)

1399 *
sz
 = 
vËn
;

1400  
»t
;

1401 
	}
}

1404 
	$quickli¡Push
(
quickli¡
 *quickli¡, *
v®ue
, cÚ¡ 
size_t
 
sz
,

1405 
wh”e
) {

1406 ià(
wh”e
 =ğ
QUICKLIST_HEAD
) {

1407 
	`quickli¡PushH—d
(
quickli¡
, 
v®ue
, 
sz
);

1408 } ià(
wh”e
 =ğ
QUICKLIST_TAIL
) {

1409 
	`quickli¡PushTa
(
quickli¡
, 
v®ue
, 
sz
);

1411 
	}
}

1414 #ifdeà
REDIS_TEST


1415 
	~<¡dšt.h
>

1416 
	~<sys/time.h
>

1418 
	#as£¹
(
_e
) \

1420 ià(!(
_e
)) { \

1421 
	`´štf
("\n\n=== ASSERTION FAILED ===\n"); \

1422 
	`´štf
("==> %s:%d '%s' i nÙrue\n", 
__FILE__
, 
__LINE__
, #_e); \

1423 
”r
++; \

1425 } 0)

	)

1427 
	#y–l
(
¡r
, ...è
	`´štf
("ERROR! " sŒ "\n\n", 
__VA_ARGS__
)

	)

1429 
	#OK
 
	`´štf
("\tOK\n")

	)

1431 
	#ERROR
 \

1433 
	`´štf
("\tERROR!\n"); \

1434 
”r
++; \

1435 } 0)

	)

1437 
	#ERR
(
x
, ...) \

1439 
	`´štf
("%s:%s:%d:\t", 
__FILE__
, 
__FUNCTION__
, 
__LINE__
); \

1440 
	`´štf
("ERROR! " 
x
 "\n", 
__VA_ARGS__
); \

1441 
”r
++; \

1442 } 0)

	)

1444 
	#TEST
(
Çme
è
	`´štf
("‹¡ â€” %s\n",‚ame);

	)

1445 
	#TEST_DESC
(
Çme
, ...è
	`´štf
("‹¡ â€” "‚am"\n", 
__VA_ARGS__
);

	)

1447 
	#QL_TEST_VERBOSE
 0

	)

1449 
	#UNUSED
(
x
è()(x)

	)

1450 
	$ql_šfo
(
quickli¡
 *
ql
) {

1451 #ià
QL_TEST_VERBOSE


1452 
	`´štf
("CÚš”†’gth: %lu\n", 
ql
->
Ën
);

1453 
	`´štf
("CÚš” size: %lu\n", 
ql
->
couÁ
);

1454 ià(
ql
->
h—d
)

1455 
	`´štf
("\t(zsizh—d: %d)\n", 
	`zli¡L’
(
ql
->
h—d
->
zl
));

1456 ià(
ql
->

)

1457 
	`´štf
("\t(zsiz: %d)\n", 
	`zli¡L’
(
ql
->

->
zl
));

1458 
	`´štf
("\n");

1460 
	`UNUSED
(
ql
);

1462 
	}
}

1465 
	$u¡ime
() {

1466 
timev®
 
tv
;

1467 
u¡
;

1469 
	`g‘timeofday
(&
tv
, 
NULL
);

1470 
u¡
 = (()
tv
.
tv_£c
) * 1000000;

1471 
u¡
 +ğ
tv
.
tv_u£c
;

1472  
u¡
;

1473 
	}
}

1476 
	$m¡ime
(è{  
	`u¡ime
(è/ 1000; 
	}
}

1482 
	$_™½ršŒ
(
quickli¡
 *
ql
, 
´št
, 
fÜw¬d
) {

1483 
quickli¡I‹r
 *
™”
 =

1484 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
fÜw¬d
 ? 
AL_START_HEAD
 : 
AL_START_TAIL
);

1485 
quickli¡EÁry
 
’Œy
;

1486 
i
 = 0;

1487 
p
 = 0;

1488 
quickli¡Node
 *
´ev
 = 
NULL
;

1489 
	`quickli¡Next
(
™”
, &
’Œy
)) {

1490 ià(
’Œy
.
node
 !ğ
´ev
) {

1492 
p
++;

1493 
´ev
 = 
’Œy
.
node
;

1495 ià(
´št
) {

1496 
	`´štf
("[%3d (%2d)]: [%.*s] (%Îd)\n", 
i
, 
p
, 
’Œy
.
sz
,

1497 (*)
’Œy
.
v®ue
,ƒÁry.
lÚgv®
);

1499 
i
++;

1501 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

1502  
i
;

1503 
	}
}

1504 
	$™½ršŒ
(
quickli¡
 *
ql
, 
´št
) {

1505  
	`_™½ršŒ
(
ql
, 
´št
, 1);

1506 
	}
}

1508 
	$™½ršŒ_»v
(
quickli¡
 *
ql
, 
´št
) {

1509  
	`_™½ršŒ
(
ql
, 
´št
, 0);

1510 
	}
}

1512 
	#ql_v”ify
(
a
, 
b
, 
c
, 
d
, 
e
) \

1514 
”r
 +ğ
	`_ql_v”ify
((
a
), (
b
), (
c
), (
d
), (
e
)); \

1515 } 0)

	)

1518 
	$_ql_v”ify
(
quickli¡
 *
ql
, 
ušt32_t
 
Ën
, ušt32_ˆ
couÁ
,

1519 
ušt32_t
 
h—d_couÁ
, ušt32_ˆ
_couÁ
) {

1520 
”rÜs
 = 0;

1522 
	`ql_šfo
(
ql
);

1523 ià(
Ën
 !ğ
ql
->len) {

1524 
	`y–l
("quickli¡†’gth wrÚg:ƒx³ùed %d, gÙ %u", 
Ën
, 
ql
->len);

1525 
”rÜs
++;

1528 ià(
couÁ
 !ğ
ql
->count) {

1529 
	`y–l
("quickli¡ couÁ wrÚg:ƒx³ùed %d, gÙ %lu", 
couÁ
, 
ql
->count);

1530 
”rÜs
++;

1533 
loİr
 = 
	`™½ršŒ
(
ql
, 0);

1534 ià(
loİr
 !ğ()
ql
->
couÁ
) {

1535 
	`y–l
("quicklist cached count‚ot match‡ctual count:ƒxpected %lu, got "

1537 
ql
->
couÁ
, 
loİr
);

1538 
”rÜs
++;

1541 
¾oİr
 = 
	`™½ršŒ_»v
(
ql
, 0);

1542 ià(
loİr
 !ğ
¾oİr
) {

1543 
	`y–l
("quicklist has different forward counthan„everse count! "

1545 
loİr
, 
¾oİr
);

1546 
”rÜs
++;

1549 ià(
ql
->
Ën
 =ğ0 && !
”rÜs
) {

1550 
OK
;

1551  
”rÜs
;

1554 ià(
ql
->
h—d
 && 
h—d_couÁ
 !ğql->h—d->
couÁ
 &&

1555 
h—d_couÁ
 !ğ
	`zli¡L’
(
ql
->
h—d
->
zl
)) {

1556 
	`y–l
("quicklist head count wrong:ƒxpected %d, "

1558 
h—d_couÁ
, 
ql
->
h—d
->
couÁ
, 
	`zli¡L’
(ql->h—d->
zl
));

1559 
”rÜs
++;

1562 ià(
ql
->

 && 
_couÁ
 !ğql->->
couÁ
 &&

1563 
_couÁ
 !ğ
	`zli¡L’
(
ql
->

->
zl
)) {

1564 
	`y–l
("quicklistail count wrong:ƒxpected %d, "

1566 
_couÁ
, 
ql
->

->
couÁ
, 
	`zli¡L’
(ql->->
zl
));

1567 
”rÜs
++;

1570 ià(
	`quickli¡AÎowsCom´essiÚ
(
ql
)) {

1571 
quickli¡Node
 *
node
 = 
ql
->
h—d
;

1572 
low_¿w
 = 
ql
->
com´ess
;

1573 
high_¿w
 = 
ql
->
Ën
 - ql->
com´ess
;

1575 
©
 = 0;‡ˆ< 
ql
->
Ën
;‡t++, 
node
 =‚ode->
Ãxt
) {

1576 ià(
node
 && (
©
 < 
low_¿w
 ||‡ˆ>ğ
high_¿w
)) {

1577 ià(
node
->
’codšg
 !ğ
QUICKLIST_NODE_ENCODING_RAW
) {

1578 
	`y–l
("Incorrect compression:‚ode %d is "

1581 
©
, 
ql
->
com´ess
, 
low_¿w
, 
high_¿w
, ql->
Ën
, 
node
->
sz
,

1582 
node
->
»com´ess
);

1583 
”rÜs
++;

1586 ià(
node
->
’codšg
 !ğ
QUICKLIST_NODE_ENCODING_LZF
 &&

1587 !
node
->
©‹m±ed_com´ess
) {

1588 
	`y–l
("Incorrect‚on-compression:‚ode %d is NOT "

1591 
©
, 
ql
->
com´ess
, 
low_¿w
, 
high_¿w
, ql->
Ën
, 
node
->
sz
,

1592 
node
->
»com´ess
,‚ode->
©‹m±ed_com´ess
);

1593 
”rÜs
++;

1599 ià(!
”rÜs
)

1600 
OK
;

1601  
”rÜs
;

1602 
	}
}

1605 *
	$g’¡r
(*
´efix
, 
i
) {

1606 
»suÉ
[64] = {0};

1607 
	`¢´štf
(
»suÉ
, ÔesuÉ), "%s%d", 
´efix
, 
i
);

1608  
»suÉ
;

1609 
	}
}

1612 
	$quickli¡Te¡
(
¬gc
, *
¬gv
[]) {

1613 
	`UNUSED
(
¬gc
);

1614 
	`UNUSED
(
¬gv
);

1616 
”r
 = 0;

1617 
İtimize_¡¬t
 =

1618 -()((
İtimiz©iÚ_Ëv–
) / (*optimization_level));

1620 
	`´štf
("S¹šg o±imiz©iÚ off£ˆ©: %d\n", 
İtimize_¡¬t
);

1622 
İtiÚs
[] = {0, 1, 2, 3, 4, 5, 6, 10};

1623 
size_t
 
İtiÚ_couÁ
 = (
İtiÚs
) / (*options);

1624 
ruÁime
[
İtiÚ_couÁ
];

1626 
_i
 = 0; _˜< ()
İtiÚ_couÁ
; _i++) {

1627 
	`´štf
("Te¡šg O±iÚ %d\n", 
İtiÚs
[
_i
]);

1628 
¡¬t
 = 
	`m¡ime
();

1630 
	`TEST
("create†ist") {

1631 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1632 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

1633 
	`quickli¡R–—£
(
ql
);

1636 
	`TEST
("addoail ofƒmpty†ist") {

1637 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1638 
	`quickli¡PushTa
(
ql
, "hello", 6);

1640 
	`ql_v”ify
(
ql
, 1, 1, 1, 1);

1641 
	`quickli¡R–—£
(
ql
);

1644 
	`TEST
("addo head ofƒmpty†ist") {

1645 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1646 
	`quickli¡PushH—d
(
ql
, "hello", 6);

1648 
	`ql_v”ify
(
ql
, 1, 1, 1, 1);

1649 
	`quickli¡R–—£
(
ql
);

1652 
f
 = 
İtimize_¡¬t
; f < 32; f++) {

1653 
	`TEST_DESC
("addØ 5x‡ˆfÈ%d‡ˆcom´es %d", 
f
,

1654 
İtiÚs
[
_i
]) {

1655 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

1656 
i
 = 0; i < 5; i++)

1657 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

1658 ià(
ql
->
couÁ
 != 5)

1659 
ERROR
;

1660 ià(
f
 == 32)

1661 
	`ql_v”ify
(
ql
, 1, 5, 5, 5);

1662 
	`quickli¡R–—£
(
ql
);

1666 
f
 = 
İtimize_¡¬t
; f < 32; f++) {

1667 
	`TEST_DESC
("addØh—d 5x‡ˆfÈ%d‡ˆcom´es %d", 
f
,

1668 
İtiÚs
[
_i
]) {

1669 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

1670 
i
 = 0; i < 5; i++)

1671 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

1672 ià(
ql
->
couÁ
 != 5)

1673 
ERROR
;

1674 ià(
f
 == 32)

1675 
	`ql_v”ify
(
ql
, 1, 5, 5, 5);

1676 
	`quickli¡R–—£
(
ql
);

1680 
f
 = 
İtimize_¡¬t
; f < 512; f++) {

1681 
	`TEST_DESC
("addØ 500x‡ˆfÈ%d‡ˆcom´es %d", 
f
,

1682 
İtiÚs
[
_i
]) {

1683 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

1684 
i
 = 0; i < 500; i++)

1685 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
), 64);

1686 ià(
ql
->
couÁ
 != 500)

1687 
ERROR
;

1688 ià(
f
 == 32)

1689 
	`ql_v”ify
(
ql
, 16, 500, 32, 20);

1690 
	`quickli¡R–—£
(
ql
);

1694 
f
 = 
İtimize_¡¬t
; f < 512; f++) {

1695 
	`TEST_DESC
("addØh—d 500x‡ˆfÈ%d‡ˆcom´es %d", 
f
,

1696 
İtiÚs
[
_i
]) {

1697 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

1698 
i
 = 0; i < 500; i++)

1699 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

1700 ià(
ql
->
couÁ
 != 500)

1701 
ERROR
;

1702 ià(
f
 == 32)

1703 
	`ql_v”ify
(
ql
, 16, 500, 20, 32);

1704 
	`quickli¡R–—£
(
ql
);

1708 
	`TEST
("rotateƒmpty") {

1709 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1710 
	`quickli¡RÙ©e
(
ql
);

1711 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

1712 
	`quickli¡R–—£
(
ql
);

1715 
f
 = 
İtimize_¡¬t
; f < 32; f++) {

1716 
	`TEST
("rotate one val once") {

1717 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

1718 
	`quickli¡PushH—d
(
ql
, "hello", 6);

1719 
	`quickli¡RÙ©e
(
ql
);

1722 
	`ql_v”ify
(
ql
, 1, 1, 1, 1);

1723 
	`quickli¡R–—£
(
ql
);

1727 
f
 = 
İtimize_¡¬t
; f < 3; f++) {

1728 
	`TEST_DESC
("rÙ©500 v® 5000ime © fÈ%d‡ˆcom´es %d", 
f
,

1729 
İtiÚs
[
_i
]) {

1730 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

1731 
	`quickli¡PushH—d
(
ql
, "900", 3);

1732 
	`quickli¡PushH—d
(
ql
, "7000", 4);

1733 
	`quickli¡PushH—d
(
ql
, "-1200", 5);

1734 
	`quickli¡PushH—d
(
ql
, "42", 2);

1735 
i
 = 0; i < 500; i++)

1736 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 64);

1737 
	`ql_šfo
(
ql
);

1738 
i
 = 0; i < 5000; i++) {

1739 
	`ql_šfo
(
ql
);

1740 
	`quickli¡RÙ©e
(
ql
);

1742 ià(
f
 == 1)

1743 
	`ql_v”ify
(
ql
, 504, 504, 1, 1);

1744 ià(
f
 == 2)

1745 
	`ql_v”ify
(
ql
, 252, 504, 2, 2);

1746 ià(
f
 == 32)

1747 
	`ql_v”ify
(
ql
, 16, 504, 32, 24);

1748 
	`quickli¡R–—£
(
ql
);

1752 
	`TEST
("popƒmpty") {

1753 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1754 
	`quickli¡Pİ
(
ql
, 
QUICKLIST_HEAD
, 
NULL
, NULL, NULL);

1755 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

1756 
	`quickli¡R–—£
(
ql
);

1759 
	`TEST
("pop 1 string from 1") {

1760 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1761 *
pİuÏ‹
 = 
	`g’¡r
("hello", 331);

1762 
	`quickli¡PushH—d
(
ql
, 
pİuÏ‹
, 32);

1763 *
d©a
;

1764 
sz
;

1765 
lv
;

1766 
	`ql_šfo
(
ql
);

1767 
	`quickli¡Pİ
(
ql
, 
QUICKLIST_HEAD
, &
d©a
, &
sz
, &
lv
);

1768 
	`as£¹
(
d©a
 !ğ
NULL
);

1769 
	`as£¹
(
sz
 == 32);

1770 ià(
	`¡rcmp
(
pİuÏ‹
, (*)
d©a
))

1771 
	`ERR
("Pİ'd v®u(%.*sèdidn'ˆequ® origš® v®u(%s)", 
sz
,

1772 
d©a
, 
pİuÏ‹
);

1773 
	`zä“
(
d©a
);

1774 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

1775 
	`quickli¡R–—£
(
ql
);

1778 
	`TEST
("pop head 1‚umber from 1") {

1779 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1780 
	`quickli¡PushH—d
(
ql
, "55513", 5);

1781 *
d©a
;

1782 
sz
;

1783 
lv
;

1784 
	`ql_šfo
(
ql
);

1785 
	`quickli¡Pİ
(
ql
, 
QUICKLIST_HEAD
, &
d©a
, &
sz
, &
lv
);

1786 
	`as£¹
(
d©a
 =ğ
NULL
);

1787 
	`as£¹
(
lv
 == 55513);

1788 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

1789 
	`quickli¡R–—£
(
ql
);

1792 
	`TEST
("pop head 500 from 500") {

1793 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1794 
i
 = 0; i < 500; i++)

1795 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

1796 
	`ql_šfo
(
ql
);

1797 
i
 = 0; i < 500; i++) {

1798 *
d©a
;

1799 
sz
;

1800 
lv
;

1801 
»t
 = 
	`quickli¡Pİ
(
ql
, 
QUICKLIST_HEAD
, &
d©a
, &
sz
, &
lv
);

1802 
	`as£¹
(
»t
 == 1);

1803 
	`as£¹
(
d©a
 !ğ
NULL
);

1804 
	`as£¹
(
sz
 == 32);

1805 ià(
	`¡rcmp
(
	`g’¡r
("h–lo", 499 - 
i
), (*)
d©a
))

1806 
	`ERR
("Pop'd value (%.*s) didn'tƒqual original value (%s)",

1807 
sz
, 
d©a
, 
	`g’¡r
("h–lo", 499 - 
i
));

1808 
	`zä“
(
d©a
);

1810 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

1811 
	`quickli¡R–—£
(
ql
);

1814 
	`TEST
("pop head 5000 from 500") {

1815 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1816 
i
 = 0; i < 500; i++)

1817 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

1818 
i
 = 0; i < 5000; i++) {

1819 *
d©a
;

1820 
sz
;

1821 
lv
;

1822 
»t
 = 
	`quickli¡Pİ
(
ql
, 
QUICKLIST_HEAD
, &
d©a
, &
sz
, &
lv
);

1823 ià(
i
 < 500) {

1824 
	`as£¹
(
»t
 == 1);

1825 
	`as£¹
(
d©a
 !ğ
NULL
);

1826 
	`as£¹
(
sz
 == 32);

1827 ià(
	`¡rcmp
(
	`g’¡r
("h–lo", 499 - 
i
), (*)
d©a
))

1828 
	`ERR
("Pop'd value (%.*s) didn'tƒqual original value "

1830 
sz
, 
d©a
, 
	`g’¡r
("h–lo", 499 - 
i
));

1831 
	`zä“
(
d©a
);

1833 
	`as£¹
(
»t
 == 0);

1836 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

1837 
	`quickli¡R–—£
(
ql
);

1840 
	`TEST
("iterate forward over 500†ist") {

1841 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1842 
	`quickli¡S‘Fl
(
ql
, 32);

1843 
i
 = 0; i < 500; i++)

1844 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

1845 
quickli¡I‹r
 *
™”
 = 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
AL_START_HEAD
);

1846 
quickli¡EÁry
 
’Œy
;

1847 
i
 = 499, 
couÁ
 = 0;

1848 
	`quickli¡Next
(
™”
, &
’Œy
)) {

1849 *
h
 = 
	`g’¡r
("h–lo", 
i
);

1850 ià(
	`¡rcmp
((*)
’Œy
.
v®ue
, 
h
))

1851 
	`ERR
("value [%s] didn't match [%s]‡t…osition %d",

1852 
’Œy
.
v®ue
, 
h
, 
i
);

1853 
i
--;

1854 
couÁ
++;

1856 ià(
couÁ
 != 500)

1857 
	`ERR
("Didn'ˆ™”©ov”ƒxaùly 500ƒËm’t (%d)", 
i
);

1858 
	`ql_v”ify
(
ql
, 16, 500, 20, 32);

1859 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

1860 
	`quickli¡R–—£
(
ql
);

1863 
	`TEST
("iterate„everse over 500†ist") {

1864 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1865 
	`quickli¡S‘Fl
(
ql
, 32);

1866 
i
 = 0; i < 500; i++)

1867 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

1868 
quickli¡I‹r
 *
™”
 = 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
AL_START_TAIL
);

1869 
quickli¡EÁry
 
’Œy
;

1870 
i
 = 0;

1871 
	`quickli¡Next
(
™”
, &
’Œy
)) {

1872 *
h
 = 
	`g’¡r
("h–lo", 
i
);

1873 ià(
	`¡rcmp
((*)
’Œy
.
v®ue
, 
h
))

1874 
	`ERR
("value [%s] didn't match [%s]‡t…osition %d",

1875 
’Œy
.
v®ue
, 
h
, 
i
);

1876 
i
++;

1878 ià(
i
 != 500)

1879 
	`ERR
("Didn'ˆ™”©ov”ƒxaùly 500ƒËm’t (%d)", 
i
);

1880 
	`ql_v”ify
(
ql
, 16, 500, 20, 32);

1881 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

1882 
	`quickli¡R–—£
(
ql
);

1885 
	`TEST
("insert before with 0ƒlements") {

1886 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1887 
quickli¡EÁry
 
’Œy
;

1888 
	`quickli¡Index
(
ql
, 0, &
’Œy
);

1889 
	`quickli¡In£¹BefÜe
(
ql
, &
’Œy
, "abc", 4);

1890 
	`ql_v”ify
(
ql
, 1, 1, 1, 1);

1891 
	`quickli¡R–—£
(
ql
);

1894 
	`TEST
("insert‡fter with 0ƒlements") {

1895 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1896 
quickli¡EÁry
 
’Œy
;

1897 
	`quickli¡Index
(
ql
, 0, &
’Œy
);

1898 
	`quickli¡In£¹Aá”
(
ql
, &
’Œy
, "abc", 4);

1899 
	`ql_v”ify
(
ql
, 1, 1, 1, 1);

1900 
	`quickli¡R–—£
(
ql
);

1903 
	`TEST
("insert‡fter 1ƒlement") {

1904 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1905 
	`quickli¡PushH—d
(
ql
, "hello", 6);

1906 
quickli¡EÁry
 
’Œy
;

1907 
	`quickli¡Index
(
ql
, 0, &
’Œy
);

1908 
	`quickli¡In£¹Aá”
(
ql
, &
’Œy
, "abc", 4);

1909 
	`ql_v”ify
(
ql
, 1, 2, 2, 2);

1910 
	`quickli¡R–—£
(
ql
);

1913 
	`TEST
("insert before 1ƒlement") {

1914 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

1915 
	`quickli¡PushH—d
(
ql
, "hello", 6);

1916 
quickli¡EÁry
 
’Œy
;

1917 
	`quickli¡Index
(
ql
, 0, &
’Œy
);

1918 
	`quickli¡In£¹Aá”
(
ql
, &
’Œy
, "abc", 4);

1919 
	`ql_v”ify
(
ql
, 1, 2, 2, 2);

1920 
	`quickli¡R–—£
(
ql
);

1923 
f
 = 
İtimize_¡¬t
; f < 12; f++) {

1924 
	`TEST_DESC
("insert once inƒlements while iterating‡t fill %d‡t "

1926 
f
, 
İtiÚs
[
_i
]) {

1927 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

1928 
	`quickli¡PushTa
(
ql
, "abc", 3);

1929 
	`quickli¡S‘Fl
(
ql
, 1);

1930 
	`quickli¡PushTa
(
ql
, "def", 3);

1931 
	`quickli¡S‘Fl
(
ql
, 
f
);

1932 
	`quickli¡PushTa
(
ql
, "bob", 3);

1933 
	`quickli¡PushTa
(
ql
, "foo", 3);

1934 
	`quickli¡PushTa
(
ql
, "zoo", 3);

1936 
	`™½ršŒ
(
ql
, 0);

1938 
quickli¡I‹r
 *
™”
 = 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
AL_START_HEAD
);

1939 
quickli¡EÁry
 
’Œy
;

1940 
	`quickli¡Next
(
™”
, &
’Œy
)) {

1941 ià(!
	`¡ºcmp
((*)
’Œy
.
v®ue
, "bob", 3)) {

1943 
	`quickli¡In£¹BefÜe
(
ql
, &
’Œy
, "bar", 3);

1947 
	`™½ršŒ
(
ql
, 0);

1950 
	`quickli¡Index
(
ql
, 0, &
’Œy
);

1951 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, "abc", 3))

1952 
	`ERR
("V®u0 didn'ˆm©ch, in¡—d gÙ: %.*s", 
’Œy
.
sz
,

1953 
’Œy
.
v®ue
);

1954 
	`quickli¡Index
(
ql
, 1, &
’Œy
);

1955 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, "def", 3))

1956 
	`ERR
("V®u1 didn'ˆm©ch, in¡—d gÙ: %.*s", 
’Œy
.
sz
,

1957 
’Œy
.
v®ue
);

1958 
	`quickli¡Index
(
ql
, 2, &
’Œy
);

1959 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, "bar", 3))

1960 
	`ERR
("V®u2 didn'ˆm©ch, in¡—d gÙ: %.*s", 
’Œy
.
sz
,

1961 
’Œy
.
v®ue
);

1962 
	`quickli¡Index
(
ql
, 3, &
’Œy
);

1963 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, "bob", 3))

1964 
	`ERR
("V®u3 didn'ˆm©ch, in¡—d gÙ: %.*s", 
’Œy
.
sz
,

1965 
’Œy
.
v®ue
);

1966 
	`quickli¡Index
(
ql
, 4, &
’Œy
);

1967 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, "foo", 3))

1968 
	`ERR
("V®u4 didn'ˆm©ch, in¡—d gÙ: %.*s", 
’Œy
.
sz
,

1969 
’Œy
.
v®ue
);

1970 
	`quickli¡Index
(
ql
, 5, &
’Œy
);

1971 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, "zoo", 3))

1972 
	`ERR
("V®u5 didn'ˆm©ch, in¡—d gÙ: %.*s", 
’Œy
.
sz
,

1973 
’Œy
.
v®ue
);

1974 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

1975 
	`quickli¡R–—£
(
ql
);

1979 
f
 = 
İtimize_¡¬t
; f < 1024; f++) {

1980 
	`TEST_DESC
(

1983 
f
, 
İtiÚs
[
_i
]) {

1984 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

1985 
i
 = 0; i < 500; i++)

1986 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

1987 
i
 = 0; i < 250; i++) {

1988 
quickli¡EÁry
 
’Œy
;

1989 
	`quickli¡Index
(
ql
, 250, &
’Œy
);

1990 
	`quickli¡In£¹BefÜe
(
ql
, &
’Œy
, 
	`g’¡r
("abc", 
i
), 32);

1992 ià(
f
 == 32)

1993 
	`ql_v”ify
(
ql
, 25, 750, 32, 20);

1994 
	`quickli¡R–—£
(
ql
);

1998 
f
 = 
İtimize_¡¬t
; f < 1024; f++) {

1999 
	`TEST_DESC
("insert [after] 250‚ew in middle of 500ƒlements‡t "

2001 
f
, 
İtiÚs
[
_i
]) {

2002 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2003 
i
 = 0; i < 500; i++)

2004 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

2005 
i
 = 0; i < 250; i++) {

2006 
quickli¡EÁry
 
’Œy
;

2007 
	`quickli¡Index
(
ql
, 250, &
’Œy
);

2008 
	`quickli¡In£¹Aá”
(
ql
, &
’Œy
, 
	`g’¡r
("abc", 
i
), 32);

2011 ià(
ql
->
couÁ
 != 750)

2012 
	`ERR
("Li¡ siznÙ 750, buˆ¿th” %ld", 
ql
->
couÁ
);

2014 ià(
f
 == 32)

2015 
	`ql_v”ify
(
ql
, 26, 750, 20, 32);

2016 
	`quickli¡R–—£
(
ql
);

2020 
	`TEST
("duplicateƒmpty†ist") {

2021 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2022 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

2023 
quickli¡
 *
cİy
 = 
	`quickli¡Dup
(
ql
);

2024 
	`ql_v”ify
(
cİy
, 0, 0, 0, 0);

2025 
	`quickli¡R–—£
(
ql
);

2026 
	`quickli¡R–—£
(
cİy
);

2029 
	`TEST
("duplicate†ist of 1ƒlement") {

2030 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2031 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("hello", 3), 32);

2032 
	`ql_v”ify
(
ql
, 1, 1, 1, 1);

2033 
quickli¡
 *
cİy
 = 
	`quickli¡Dup
(
ql
);

2034 
	`ql_v”ify
(
cİy
, 1, 1, 1, 1);

2035 
	`quickli¡R–—£
(
ql
);

2036 
	`quickli¡R–—£
(
cİy
);

2039 
	`TEST
("duplicate†ist of 500") {

2040 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2041 
	`quickli¡S‘Fl
(
ql
, 32);

2042 
i
 = 0; i < 500; i++)

2043 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

2044 
	`ql_v”ify
(
ql
, 16, 500, 20, 32);

2046 
quickli¡
 *
cİy
 = 
	`quickli¡Dup
(
ql
);

2047 
	`ql_v”ify
(
cİy
, 16, 500, 20, 32);

2048 
	`quickli¡R–—£
(
ql
);

2049 
	`quickli¡R–—£
(
cİy
);

2052 
f
 = 
İtimize_¡¬t
; f < 512; f++) {

2053 
	`TEST_DESC
("šdex 1,200 from 500†i¡‡ˆfÈ%d‡ˆcom´es %d", 
f
,

2054 
İtiÚs
[
_i
]) {

2055 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2056 
i
 = 0; i < 500; i++)

2057 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
 + 1), 32);

2058 
quickli¡EÁry
 
’Œy
;

2059 
	`quickli¡Index
(
ql
, 1, &
’Œy
);

2060 ià(!
	`¡rcmp
((*)
’Œy
.
v®ue
, "hello2"))

2061 
OK
;

2063 
	`ERR
("V®ue: %s", 
’Œy
.
v®ue
);

2064 
	`quickli¡Index
(
ql
, 200, &
’Œy
);

2065 ià(!
	`¡rcmp
((*)
’Œy
.
v®ue
, "hello201"))

2066 
OK
;

2068 
	`ERR
("V®ue: %s", 
’Œy
.
v®ue
);

2069 
	`quickli¡R–—£
(
ql
);

2072 
	`TEST_DESC
("šdex -1,-2 from 500†i¡‡ˆfÈ%d‡ˆcom´es %d", 
f
,

2073 
İtiÚs
[
_i
]) {

2074 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2075 
i
 = 0; i < 500; i++)

2076 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
 + 1), 32);

2077 
quickli¡EÁry
 
’Œy
;

2078 
	`quickli¡Index
(
ql
, -1, &
’Œy
);

2079 ià(!
	`¡rcmp
((*)
’Œy
.
v®ue
, "hello500"))

2080 
OK
;

2082 
	`ERR
("V®ue: %s", 
’Œy
.
v®ue
);

2083 
	`quickli¡Index
(
ql
, -2, &
’Œy
);

2084 ià(!
	`¡rcmp
((*)
’Œy
.
v®ue
, "hello499"))

2085 
OK
;

2087 
	`ERR
("V®ue: %s", 
’Œy
.
v®ue
);

2088 
	`quickli¡R–—£
(
ql
);

2091 
	`TEST_DESC
("šdex -100 from 500†i¡‡ˆfÈ%d‡ˆcom´es %d", 
f
,

2092 
İtiÚs
[
_i
]) {

2093 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2094 
i
 = 0; i < 500; i++)

2095 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
 + 1), 32);

2096 
quickli¡EÁry
 
’Œy
;

2097 
	`quickli¡Index
(
ql
, -100, &
’Œy
);

2098 ià(!
	`¡rcmp
((*)
’Œy
.
v®ue
, "hello401"))

2099 
OK
;

2101 
	`ERR
("V®ue: %s", 
’Œy
.
v®ue
);

2102 
	`quickli¡R–—£
(
ql
);

2105 
	`TEST_DESC
("indexoo big +1 from 50†ist‡t fill %d‡t compress %d",

2106 
f
, 
İtiÚs
[
_i
]) {

2107 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2108 
i
 = 0; i < 50; i++)

2109 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
 + 1), 32);

2110 
quickli¡EÁry
 
’Œy
;

2111 ià(
	`quickli¡Index
(
ql
, 50, &
’Œy
))

2112 
	`ERR
("Index found‡ˆ50 w™h 50†i¡: %.*s", 
’Œy
.
sz
,

2113 
’Œy
.
v®ue
);

2115 
OK
;

2116 
	`quickli¡R–—£
(
ql
);

2120 
	`TEST
("delete„angeƒmpty†ist") {

2121 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2122 
	`quickli¡D–Rªge
(
ql
, 5, 20);

2123 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

2124 
	`quickli¡R–—£
(
ql
);

2127 
	`TEST
("delete„ange ofƒntire‚ode in†ist of one‚ode") {

2128 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2129 
i
 = 0; i < 32; i++)

2130 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

2131 
	`ql_v”ify
(
ql
, 1, 32, 32, 32);

2132 
	`quickli¡D–Rªge
(
ql
, 0, 32);

2133 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

2134 
	`quickli¡R–—£
(
ql
);

2137 
	`TEST
("delete„ange ofƒntire‚ode with overflow counts") {

2138 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2139 
i
 = 0; i < 32; i++)

2140 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lo", 
i
), 32);

2141 
	`ql_v”ify
(
ql
, 1, 32, 32, 32);

2142 
	`quickli¡D–Rªge
(
ql
, 0, 128);

2143 
	`ql_v”ify
(
ql
, 0, 0, 0, 0);

2144 
	`quickli¡R–—£
(
ql
);

2147 
	`TEST
("delete middle 100 of 500†ist") {

2148 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2149 
	`quickli¡S‘Fl
(
ql
, 32);

2150 
i
 = 0; i < 500; i++)

2151 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
 + 1), 32);

2152 
	`ql_v”ify
(
ql
, 16, 500, 32, 20);

2153 
	`quickli¡D–Rªge
(
ql
, 200, 100);

2154 
	`ql_v”ify
(
ql
, 14, 400, 32, 20);

2155 
	`quickli¡R–—£
(
ql
);

2158 
	`TEST
("delete‚egative 1 from 500†ist") {

2159 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2160 
	`quickli¡S‘Fl
(
ql
, 32);

2161 
i
 = 0; i < 500; i++)

2162 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
 + 1), 32);

2163 
	`ql_v”ify
(
ql
, 16, 500, 32, 20);

2164 
	`quickli¡D–Rªge
(
ql
, -1, 1);

2165 
	`ql_v”ify
(
ql
, 16, 499, 32, 19);

2166 
	`quickli¡R–—£
(
ql
);

2169 
	`TEST
("delete‚egative 1 from 500†ist with overflow counts") {

2170 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2171 
	`quickli¡S‘Fl
(
ql
, 32);

2172 
i
 = 0; i < 500; i++)

2173 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
 + 1), 32);

2174 
	`ql_v”ify
(
ql
, 16, 500, 32, 20);

2175 
	`quickli¡D–Rªge
(
ql
, -1, 128);

2176 
	`ql_v”ify
(
ql
, 16, 499, 32, 19);

2177 
	`quickli¡R–—£
(
ql
);

2180 
	`TEST
("delete‚egative 100 from 500†ist") {

2181 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2182 
	`quickli¡S‘Fl
(
ql
, 32);

2183 
i
 = 0; i < 500; i++)

2184 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
 + 1), 32);

2185 
	`quickli¡D–Rªge
(
ql
, -100, 100);

2186 
	`ql_v”ify
(
ql
, 13, 400, 32, 16);

2187 
	`quickli¡R–—£
(
ql
);

2190 
	`TEST
("delete -10 count 5 from 50†ist") {

2191 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2192 
	`quickli¡S‘Fl
(
ql
, 32);

2193 
i
 = 0; i < 50; i++)

2194 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lo", 
i
 + 1), 32);

2195 
	`ql_v”ify
(
ql
, 2, 50, 32, 18);

2196 
	`quickli¡D–Rªge
(
ql
, -10, 5);

2197 
	`ql_v”ify
(
ql
, 2, 45, 32, 13);

2198 
	`quickli¡R–—£
(
ql
);

2201 
	`TEST
("numbers only†ist„ead") {

2202 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2203 
	`quickli¡PushTa
(
ql
, "1111", 4);

2204 
	`quickli¡PushTa
(
ql
, "2222", 4);

2205 
	`quickli¡PushTa
(
ql
, "3333", 4);

2206 
	`quickli¡PushTa
(
ql
, "4444", 4);

2207 
	`ql_v”ify
(
ql
, 1, 4, 4, 4);

2208 
quickli¡EÁry
 
’Œy
;

2209 
	`quickli¡Index
(
ql
, 0, &
’Œy
);

2210 ià(
’Œy
.
lÚgv®
 != 1111)

2211 
	`ERR
("NÙ 1111, %Îd", 
’Œy
.
lÚgv®
);

2212 
	`quickli¡Index
(
ql
, 1, &
’Œy
);

2213 ià(
’Œy
.
lÚgv®
 != 2222)

2214 
	`ERR
("NÙ 2222, %Îd", 
’Œy
.
lÚgv®
);

2215 
	`quickli¡Index
(
ql
, 2, &
’Œy
);

2216 ià(
’Œy
.
lÚgv®
 != 3333)

2217 
	`ERR
("NÙ 3333, %Îd", 
’Œy
.
lÚgv®
);

2218 
	`quickli¡Index
(
ql
, 3, &
’Œy
);

2219 ià(
’Œy
.
lÚgv®
 != 4444)

2220 
	`ERR
("NÙ 4444, %Îd", 
’Œy
.
lÚgv®
);

2221 ià(
	`quickli¡Index
(
ql
, 4, &
’Œy
))

2222 
	`ERR
("Index…a¡ƒËm’ts: %Îd", 
’Œy
.
lÚgv®
);

2223 
	`quickli¡Index
(
ql
, -1, &
’Œy
);

2224 ià(
’Œy
.
lÚgv®
 != 4444)

2225 
	`ERR
("NÙ 4444 (»v”£), %Îd", 
’Œy
.
lÚgv®
);

2226 
	`quickli¡Index
(
ql
, -2, &
’Œy
);

2227 ià(
’Œy
.
lÚgv®
 != 3333)

2228 
	`ERR
("NÙ 3333 (»v”£), %Îd", 
’Œy
.
lÚgv®
);

2229 
	`quickli¡Index
(
ql
, -3, &
’Œy
);

2230 ià(
’Œy
.
lÚgv®
 != 2222)

2231 
	`ERR
("NÙ 2222 (»v”£), %Îd", 
’Œy
.
lÚgv®
);

2232 
	`quickli¡Index
(
ql
, -4, &
’Œy
);

2233 ià(
’Œy
.
lÚgv®
 != 1111)

2234 
	`ERR
("NÙ 1111 (»v”£), %Îd", 
’Œy
.
lÚgv®
);

2235 ià(
	`quickli¡Index
(
ql
, -5, &
’Œy
))

2236 
	`ERR
("Index…a¡ƒËm’t Ôev”£), %Îd", 
’Œy
.
lÚgv®
);

2237 
	`quickli¡R–—£
(
ql
);

2240 
	`TEST
("numbers†arger†ist„ead") {

2241 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2242 
	`quickli¡S‘Fl
(
ql
, 32);

2243 
num
[32];

2244 
nums
[5000];

2245 
i
 = 0; i < 5000; i++) {

2246 
nums
[
i
] = -5157318210846258176 + i;

2247 
sz
 = 
	`Î2¡ršg
(
num
, Òum), 
nums
[
i
]);

2248 
	`quickli¡PushTa
(
ql
, 
num
, 
sz
);

2250 
	`quickli¡PushTa
(
ql
, "xxxxxxxxxxxxxxxxxxxx", 20);

2251 
quickli¡EÁry
 
’Œy
;

2252 
i
 = 0; i < 5000; i++) {

2253 
	`quickli¡Index
(
ql
, 
i
, &
’Œy
);

2254 ià(
’Œy
.
lÚgv®
 !ğ
nums
[
i
])

2255 
	`ERR
("[%d] NÙ†Úgv® %Îd buˆ¿th” %Îd", 
i
, 
nums
[i],

2256 
’Œy
.
lÚgv®
);

2257 
’Œy
.
lÚgv®
 = 0xdeadbeef;

2259 
	`quickli¡Index
(
ql
, 5000, &
’Œy
);

2260 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, "xxxxxxxxxxxxxxxxxxxx", 20))

2261 
	`ERR
("SŒšg v®‚Ù m©ch: %s", 
’Œy
.
v®ue
);

2262 
	`ql_v”ify
(
ql
, 157, 5001, 32, 9);

2263 
	`quickli¡R–—£
(
ql
);

2266 
	`TEST
("numbers†arger†ist„ead B") {

2267 
quickli¡
 *
ql
 = 
	`quickli¡New
(-2, 
İtiÚs
[
_i
]);

2268 
	`quickli¡PushTa
(
ql
, "99", 2);

2269 
	`quickli¡PushTa
(
ql
, "98", 2);

2270 
	`quickli¡PushTa
(
ql
, "xxxxxxxxxxxxxxxxxxxx", 20);

2271 
	`quickli¡PushTa
(
ql
, "96", 2);

2272 
	`quickli¡PushTa
(
ql
, "95", 2);

2273 
	`quickli¡R•ÏûAtIndex
(
ql
, 1, "foo", 3);

2274 
	`quickli¡R•ÏûAtIndex
(
ql
, -1, "bar", 3);

2275 
	`quickli¡R–—£
(
ql
);

2276 
OK
;

2279 
f
 = 
İtimize_¡¬t
; f < 16; f++) {

2280 
	`TEST_DESC
("Ìeme¡‡ˆfÈ%d‡ˆcom´es %d", 
f
, 
İtiÚs
[
_i
]) {

2281 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2282 *
wÜds
[] = {"abc", "foo", "bar", "foobar", "foobared",

2284 *
»suÉ
[] = {"abc", "foo", "foobar", "foobared",

2286 *
»suÉB
[] = {"abc", "foo", "foobar",

2288 
i
 = 0; i < 9; i++)

2289 
	`quickli¡PushTa
(
ql
, 
wÜds
[
i
], 
	`¡¾’
(words[i]));

2292 
quickli¡I‹r
 *
™”
 = 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
AL_START_HEAD
);

2293 
quickli¡EÁry
 
’Œy
;

2294 
i
 = 0;

2295 
	`quickli¡Next
(
™”
, &
’Œy
)) {

2296 ià(
	`quickli¡Com·»
(
’Œy
.
zi
, (*)"bar", 3)) {

2297 
	`quickli¡D–EÁry
(
™”
, &
’Œy
);

2299 
i
++;

2301 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

2304 
™”
 = 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
AL_START_HEAD
);

2305 
i
 = 0;

2306 
ok
 = 1;

2307 
	`quickli¡Next
(
™”
, &
’Œy
)) {

2310 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, 
»suÉ
[
i
],ƒÁry.
sz
)) {

2311 
	`ERR
("No match‡t…osition %d, got %.*s instead of %s",

2312 
i
, 
’Œy
.
sz
,ƒÁry.
v®ue
, 
»suÉ
[i]);

2313 
ok
 = 0;

2315 
i
++;

2317 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

2319 
	`quickli¡PushTa
(
ql
, "foo", 3);

2322 
™”
 = 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
AL_START_TAIL
);

2323 
i
 = 0;

2324 
d–
 = 2;

2325 
	`quickli¡Next
(
™”
, &
’Œy
)) {

2326 ià(
	`quickli¡Com·»
(
’Œy
.
zi
, (*)"foo", 3)) {

2327 
	`quickli¡D–EÁry
(
™”
, &
’Œy
);

2328 
d–
--;

2330 ià(!
d–
)

2332 
i
++;

2334 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

2340 
™”
 = 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
AL_START_TAIL
);

2341 
i
 = 0;

2342 
size_t
 
»sB
 = (
»suÉB
) / (*resultB);

2343 
	`quickli¡Next
(
™”
, &
’Œy
)) {

2346 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, 
»suÉB
[
»sB
 - 1 - 
i
],

2347 
’Œy
.
sz
)) {

2348 
	`ERR
("No match‡t…osition %d, got %.*s instead of %s",

2349 
i
, 
’Œy
.
sz
,ƒÁry.
v®ue
, 
»suÉB
[
»sB
 - 1 - i]);

2350 
ok
 = 0;

2352 
i
++;

2355 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

2357 ià(
ok
)

2358 
OK
;

2359 
	`quickli¡R–—£
(
ql
);

2363 
f
 = 
İtimize_¡¬t
; f < 16; f++) {

2364 
	`TEST_DESC
("™”©»v”£ + d–‘© fÈ%d‡ˆcom´es %d", 
f
,

2365 
İtiÚs
[
_i
]) {

2366 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2367 
	`quickli¡PushTa
(
ql
, "abc", 3);

2368 
	`quickli¡PushTa
(
ql
, "def", 3);

2369 
	`quickli¡PushTa
(
ql
, "hij", 3);

2370 
	`quickli¡PushTa
(
ql
, "jkl", 3);

2371 
	`quickli¡PushTa
(
ql
, "oop", 3);

2373 
quickli¡EÁry
 
’Œy
;

2374 
quickli¡I‹r
 *
™”
 = 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
AL_START_TAIL
);

2375 
i
 = 0;

2376 
	`quickli¡Next
(
™”
, &
’Œy
)) {

2377 ià(
	`quickli¡Com·»
(
’Œy
.
zi
, (*)"hij", 3)) {

2378 
	`quickli¡D–EÁry
(
™”
, &
’Œy
);

2380 
i
++;

2382 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

2384 ià(
i
 != 5)

2385 
	`ERR
("Didn'ˆ™”©5imes, i‹¿‹d %dimes.", 
i
);

2388 
™”
 = 
	`quickli¡G‘I‹¿tÜ
(
ql
, 
AL_START_HEAD
);

2389 
i
 = 0;

2390 *
v®s
[] = {"abc", "def", "jkl", "oop"};

2391 
	`quickli¡Next
(
™”
, &
’Œy
)) {

2392 ià(!
	`quickli¡Com·»
(
’Œy
.
zi
, (*)
v®s
[
i
],

2394 
	`ERR
("V®u© %d didn'ˆm©ch %s\n", 
i
, 
v®s
[i]);

2396 
i
++;

2398 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

2399 
	`quickli¡R–—£
(
ql
);

2403 
f
 = 
İtimize_¡¬t
; f < 800; f++) {

2404 
	`TEST_DESC
("™”©Ü‡ˆšdexe¡‡ˆfÈ%d‡ˆcom´es %d", 
f
,

2405 
İtiÚs
[
_i
]) {

2406 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2407 
num
[32];

2408 
nums
[5000];

2409 
i
 = 0; i < 760; i++) {

2410 
nums
[
i
] = -5157318210846258176 + i;

2411 
sz
 = 
	`Î2¡ršg
(
num
, Òum), 
nums
[
i
]);

2412 
	`quickli¡PushTa
(
ql
, 
num
, 
sz
);

2415 
quickli¡EÁry
 
’Œy
;

2416 
quickli¡I‹r
 *
™”
 =

2417 
	`quickli¡G‘I‹¿tÜAtIdx
(
ql
, 
AL_START_HEAD
, 437);

2418 
i
 = 437;

2419 
	`quickli¡Next
(
™”
, &
’Œy
)) {

2420 ià(
’Œy
.
lÚgv®
 !ğ
nums
[
i
])

2421 
	`ERR
("Ex³ùed %Îd, buˆgÙ %Îd", 
’Œy
.
lÚgv®
,

2422 
nums
[
i
]);

2423 
i
++;

2425 
	`quickli¡R–—£I‹¿tÜ
(
™”
);

2426 
	`quickli¡R–—£
(
ql
);

2430 
f
 = 
İtimize_¡¬t
; f < 40; f++) {

2431 
	`TEST_DESC
("Érime¡ A‡ˆfÈ%d‡ˆcom´es %d", 
f
,

2432 
İtiÚs
[
_i
]) {

2433 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2434 
num
[32];

2435 
nums
[5000];

2436 
i
 = 0; i < 32; i++) {

2437 
nums
[
i
] = -5157318210846258176 + i;

2438 
sz
 = 
	`Î2¡ršg
(
num
, Òum), 
nums
[
i
]);

2439 
	`quickli¡PushTa
(
ql
, 
num
, 
sz
);

2441 ià(
f
 == 32)

2442 
	`ql_v”ify
(
ql
, 1, 32, 32, 32);

2444 
	`quickli¡D–Rªge
(
ql
, 0, 25);

2445 
	`quickli¡D–Rªge
(
ql
, 0, 0);

2446 
quickli¡EÁry
 
’Œy
;

2447 
i
 = 0; i < 7; i++) {

2448 
	`quickli¡Index
(
ql
, 
i
, &
’Œy
);

2449 ià(
’Œy
.
lÚgv®
 !ğ
nums
[25 + 
i
])

2450 
	`ERR
("Deleted invalid„ange! Expected %lld but got "

2452 
’Œy
.
lÚgv®
, 
nums
[25 + 
i
]);

2454 ià(
f
 == 32)

2455 
	`ql_v”ify
(
ql
, 1, 7, 7, 7);

2456 
	`quickli¡R–—£
(
ql
);

2460 
f
 = 
İtimize_¡¬t
; f < 40; f++) {

2461 
	`TEST_DESC
("Érime¡ B‡ˆfÈ%d‡ˆcom´es %d", 
f
,

2462 
İtiÚs
[
_i
]) {

2465 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
QUICKLIST_NOCOMPRESS
);

2466 
num
[32];

2467 
nums
[5000];

2468 
i
 = 0; i < 33; i++) {

2469 
nums
[
i
] = i;

2470 
sz
 = 
	`Î2¡ršg
(
num
, Òum), 
nums
[
i
]);

2471 
	`quickli¡PushTa
(
ql
, 
num
, 
sz
);

2473 ià(
f
 == 32)

2474 
	`ql_v”ify
(
ql
, 2, 33, 32, 1);

2476 
	`quickli¡D–Rªge
(
ql
, 0, 5);

2477 
	`quickli¡D–Rªge
(
ql
, -16, 16);

2478 ià(
f
 == 32)

2479 
	`ql_v”ify
(
ql
, 1, 12, 12, 12);

2480 
quickli¡EÁry
 
’Œy
;

2481 
	`quickli¡Index
(
ql
, 0, &
’Œy
);

2482 ià(
’Œy
.
lÚgv®
 != 5)

2483 
	`ERR
("A:†Úgv®‚Ù 5, buˆ%Îd", 
’Œy
.
lÚgv®
);

2485 
OK
;

2486 
	`quickli¡Index
(
ql
, -1, &
’Œy
);

2487 ià(
’Œy
.
lÚgv®
 != 16)

2488 
	`ERR
("B! gÙ in¡—d: %Îd", 
’Œy
.
lÚgv®
);

2490 
OK
;

2491 
	`quickli¡PushTa
(
ql
, "bobobob", 7);

2492 
	`quickli¡Index
(
ql
, -1, &
’Œy
);

2493 ià(
	`¡ºcmp
((*)
’Œy
.
v®ue
, "bobobob", 7))

2494 
	`ERR
("Tail doesn't match bobobob, it's %.*s instead",

2495 
’Œy
.
sz
,ƒÁry.
v®ue
);

2496 
i
 = 0; i < 12; i++) {

2497 
	`quickli¡Index
(
ql
, 
i
, &
’Œy
);

2498 ià(
’Œy
.
lÚgv®
 !ğ
nums
[5 + 
i
])

2499 
	`ERR
("Deleted invalid„ange! Expected %lld but got "

2501 
’Œy
.
lÚgv®
, 
nums
[5 + 
i
]);

2503 
	`quickli¡R–—£
(
ql
);

2507 
f
 = 
İtimize_¡¬t
; f < 40; f++) {

2508 
	`TEST_DESC
("Érime¡ C‡ˆfÈ%d‡ˆcom´es %d", 
f
,

2509 
İtiÚs
[
_i
]) {

2510 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2511 
num
[32];

2512 
nums
[5000];

2513 
i
 = 0; i < 33; i++) {

2514 
nums
[
i
] = -5157318210846258176 + i;

2515 
sz
 = 
	`Î2¡ršg
(
num
, Òum), 
nums
[
i
]);

2516 
	`quickli¡PushTa
(
ql
, 
num
, 
sz
);

2518 ià(
f
 == 32)

2519 
	`ql_v”ify
(
ql
, 2, 33, 32, 1);

2521 
	`quickli¡D–Rªge
(
ql
, 0, 3);

2522 
	`quickli¡D–Rªge
(
ql
, -29,

2524 ià(
f
 == 32)

2525 
	`ql_v”ify
(
ql
, 1, 1, 1, 1);

2526 
quickli¡EÁry
 
’Œy
;

2527 
	`quickli¡Index
(
ql
, 0, &
’Œy
);

2528 ià(
’Œy
.
lÚgv®
 != -5157318210846258173)

2529 
ERROR
;

2531 
OK
;

2532 
	`quickli¡R–—£
(
ql
);

2536 
f
 = 
İtimize_¡¬t
; f < 40; f++) {

2537 
	`TEST_DESC
("Érime¡ D‡ˆfÈ%d‡ˆcom´es %d", 
f
,

2538 
İtiÚs
[
_i
]) {

2539 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
İtiÚs
[
_i
]);

2540 
num
[32];

2541 
nums
[5000];

2542 
i
 = 0; i < 33; i++) {

2543 
nums
[
i
] = -5157318210846258176 + i;

2544 
sz
 = 
	`Î2¡ršg
(
num
, Òum), 
nums
[
i
]);

2545 
	`quickli¡PushTa
(
ql
, 
num
, 
sz
);

2547 ià(
f
 == 32)

2548 
	`ql_v”ify
(
ql
, 2, 33, 32, 1);

2549 
	`quickli¡D–Rªge
(
ql
, -12, 3);

2550 ià(
ql
->
couÁ
 != 30)

2551 
	`ERR
("Didn't deleteƒxactlyhreeƒlements! Count is: %lu",

2552 
ql
->
couÁ
);

2553 
	`quickli¡R–—£
(
ql
);

2557 
f
 = 
İtimize_¡¬t
; f < 72; f++) {

2558 
	`TEST_DESC
("create quicklist from ziplist‡t fill %d‡t compress %d",

2559 
f
, 
İtiÚs
[
_i
]) {

2560 *
zl
 = 
	`zli¡New
();

2561 
nums
[64];

2562 
num
[64];

2563 
i
 = 0; i < 33; i++) {

2564 
nums
[
i
] = -5157318210846258176 + i;

2565 
sz
 = 
	`Î2¡ršg
(
num
, Òum), 
nums
[
i
]);

2566 
zl
 =

2567 
	`zli¡Push
(
zl
, (*)
num
, 
sz
, 
ZIPLIST_TAIL
);

2569 
i
 = 0; i < 33; i++) {

2570 
zl
 = 
	`zli¡Push
(zl, (*)
	`g’¡r
("h–lo", 
i
),

2571 32, 
ZIPLIST_TAIL
);

2573 
quickli¡
 *
ql
 = 
	`quickli¡C»©eFromZli¡
(
f
, 
İtiÚs
[
_i
], 
zl
);

2574 ià(
f
 == 1)

2575 
	`ql_v”ify
(
ql
, 66, 66, 1, 1);

2576 ià(
f
 == 32)

2577 
	`ql_v”ify
(
ql
, 3, 66, 32, 2);

2578 ià(
f
 == 66)

2579 
	`ql_v”ify
(
ql
, 1, 66, 66, 66);

2580 
	`quickli¡R–—£
(
ql
);

2584 
¡İ
 = 
	`m¡ime
();

2585 
ruÁime
[
_i
] = 
¡İ
 - 
¡¬t
;

2589 
li¡_sizes
[] = {250, 251, 500, 999, 1000};

2590 
¡¬t
 = 
	`m¡ime
();

2591 
li¡
 = 0;†i¡ < ()((
li¡_sizes
) / (*list_sizes));

2592 
li¡
++) {

2593 
f
 = 
İtimize_¡¬t
; f < 128; f++) {

2594 
d•th
 = 1; depth < 40; depth++) {

2596 
	`TEST_DESC
("verify specific compression of interior‚odes with "

2599 
li¡_sizes
[
li¡
], 
f
, 
d•th
) {

2600 
quickli¡
 *
ql
 = 
	`quickli¡New
(
f
, 
d•th
);

2601 
i
 = 0; i < 
li¡_sizes
[
li¡
]; i++) {

2602 
	`quickli¡PushTa
(
ql
, 
	`g’¡r
("h–lØTAIL", 
i
 + 1), 64);

2603 
	`quickli¡PushH—d
(
ql
, 
	`g’¡r
("h–lØHEAD", 
i
 + 1), 64);

2606 
quickli¡Node
 *
node
 = 
ql
->
h—d
;

2607 
low_¿w
 = 
ql
->
com´ess
;

2608 
high_¿w
 = 
ql
->
Ën
 - ql->
com´ess
;

2610 
©
 = 0;‡ˆ< 
ql
->
Ën
;

2611 
©
++, 
node
 =‚ode->
Ãxt
) {

2612 ià(
©
 < 
low_¿w
 ||‡ˆ>ğ
high_¿w
) {

2613 ià(
node
->
’codšg
 !ğ
QUICKLIST_NODE_ENCODING_RAW
) {

2614 
	`ERR
("Incorrect compression:‚ode %d is "

2617 
©
, 
d•th
, 
low_¿w
, 
high_¿w
, 
ql
->
Ën
,

2618 
node
->
sz
);

2621 ià(
node
->
’codšg
 !ğ
QUICKLIST_NODE_ENCODING_LZF
) {

2622 
	`ERR
("Incorrect‚on-compression:‚ode %d is NOT "

2625 
©
, 
d•th
, 
low_¿w
, 
high_¿w
, 
ql
->
Ën
,

2626 
node
->
sz
,‚ode->
©‹m±ed_com´ess
);

2630 
	`quickli¡R–—£
(
ql
);

2635 
¡İ
 = 
	`m¡ime
();

2637 
	`´štf
("\n");

2638 
size_t
 
i
 = 0; i < 
İtiÚ_couÁ
; i++)

2639 
	`´štf
("Te¡ Loİ %02d: %0.2à£cÚds.\n", 
İtiÚs
[
i
],

2640 ()
ruÁime
[
i
] / 1000);

2641 
	`´štf
("Com´essiÚs: %0.2à£cÚds.\n", ()(
¡İ
 - 
¡¬t
) / 1000);

2642 
	`´štf
("\n");

2644 ià(!
”r
)

2645 
	`´štf
("ALL TESTS PASSED!\n");

2647 
	`ERR
("SÜry,‚Ù‡Îe¡ ·s£d! IÀçù, %de¡ çed.", 
”r
);

2649  
”r
;

2650 
	}
}

	@src/quicklist.h

31 #iâdeà
__QUICKLIST_H__


32 
	#__QUICKLIST_H__


	)

44 
	squickli¡Node
 {

45 
quickli¡Node
 *
	m´ev
;

46 
quickli¡Node
 *
	mÃxt
;

47 *
	mzl
;

48 
	msz
;

49 
	mcouÁ
 : 16;

50 
	m’codšg
 : 2;

51 
	mcÚš”
 : 2;

52 
	m»com´ess
 : 1;

53 
	m©‹m±ed_com´ess
 : 1;

54 
	mexŒa
 : 10;

55 } 
	tquickli¡Node
;

62 
	squickli¡LZF
 {

63 
	msz
;

64 
	mcom´es£d
[];

65 } 
	tquickli¡LZF
;

73 
	squickli¡
 {

74 
quickli¡Node
 *
	mh—d
;

75 
quickli¡Node
 *
	m
;

76 
	mcouÁ
;

77 
	mËn
;

78 
	mfl
 : 16;

79 
	mcom´ess
 : 16;

80 } 
	tquickli¡
;

82 
	squickli¡I‹r
 {

83 cÚ¡ 
quickli¡
 *
	mquickli¡
;

84 
quickli¡Node
 *
	mcu¼’t
;

85 *
	mzi
;

86 
	moff£t
;

87 
	mdœeùiÚ
;

88 } 
	tquickli¡I‹r
;

90 
	squickli¡EÁry
 {

91 cÚ¡ 
quickli¡
 *
	mquickli¡
;

92 
quickli¡Node
 *
	mnode
;

93 *
	mzi
;

94 *
	mv®ue
;

95 
	mlÚgv®
;

96 
	msz
;

97 
	moff£t
;

98 } 
	tquickli¡EÁry
;

100 
	#QUICKLIST_HEAD
 0

	)

101 
	#QUICKLIST_TAIL
 -1

	)

104 
	#QUICKLIST_NODE_ENCODING_RAW
 1

	)

105 
	#QUICKLIST_NODE_ENCODING_LZF
 2

	)

108 
	#QUICKLIST_NOCOMPRESS
 0

	)

111 
	#QUICKLIST_NODE_CONTAINER_NONE
 1

	)

112 
	#QUICKLIST_NODE_CONTAINER_ZIPLIST
 2

	)

114 
	#quickli¡NodeIsCom´es£d
(
node
) \

115 ((
node
)->
’codšg
 =ğ
QUICKLIST_NODE_ENCODING_LZF
)

	)

118 
quickli¡
 *
quickli¡C»©e
();

119 
quickli¡
 *
quickli¡New
(
fl
, 
com´ess
);

120 
quickli¡S‘Com´essD•th
(
quickli¡
 *quickli¡, 
d•th
);

121 
quickli¡S‘Fl
(
quickli¡
 *quickli¡, 
fl
);

122 
quickli¡S‘O±iÚs
(
quickli¡
 *quickli¡, 
fl
, 
d•th
);

123 
quickli¡R–—£
(
quickli¡
 *quicklist);

124 
quickli¡PushH—d
(
quickli¡
 *quickli¡, *
v®ue
, cÚ¡ 
size_t
 
sz
);

125 
quickli¡PushTa
(
quickli¡
 *quickli¡, *
v®ue
, cÚ¡ 
size_t
 
sz
);

126 
quickli¡Push
(
quickli¡
 *quickli¡, *
v®ue
, cÚ¡ 
size_t
 
sz
,

127 
wh”e
);

128 
quickli¡Aµ’dZli¡
(
quickli¡
 *quickli¡, *
zl
);

129 
quickli¡
 *
quickli¡Aµ’dV®uesFromZli¡
(quicklist *quicklist,

130 *
zl
);

131 
quickli¡
 *
quickli¡C»©eFromZli¡
(
fl
, 
com´ess
,

132 *
zl
);

133 
quickli¡In£¹Aá”
(
quickli¡
 *quickli¡, 
quickli¡EÁry
 *
node
,

134 *
v®ue
, cÚ¡ 
size_t
 
sz
);

135 
quickli¡In£¹BefÜe
(
quickli¡
 *quickli¡, 
quickli¡EÁry
 *
node
,

136 *
v®ue
, cÚ¡ 
size_t
 
sz
);

137 
quickli¡D–EÁry
(
quickli¡I‹r
 *
™”
, 
quickli¡EÁry
 *
’Œy
);

138 
quickli¡R•ÏûAtIndex
(
quickli¡
 *quickli¡, 
šdex
, *
d©a
,

139 
sz
);

140 
quickli¡D–Rªge
(
quickli¡
 *quickli¡, cÚ¡ 
¡¬t
, cÚ¡ 
¡İ
);

141 
quickli¡I‹r
 *
quickli¡G‘I‹¿tÜ
(cÚ¡ 
quickli¡
 *quickli¡, 
dœeùiÚ
);

142 
quickli¡I‹r
 *
quickli¡G‘I‹¿tÜAtIdx
(cÚ¡ 
quickli¡
 *quicklist,

143 
dœeùiÚ
, cÚ¡ 
idx
);

144 
quickli¡Next
(
quickli¡I‹r
 *
™”
, 
quickli¡EÁry
 *
node
);

145 
quickli¡R–—£I‹¿tÜ
(
quickli¡I‹r
 *
™”
);

146 
quickli¡
 *
quickli¡Dup
(quickli¡ *
Üig
);

147 
quickli¡Index
(cÚ¡ 
quickli¡
 *quickli¡, cÚ¡ 
šdex
,

148 
quickli¡EÁry
 *
’Œy
);

149 
quickli¡Rewšd
(
quickli¡
 *quickli¡, 
quickli¡I‹r
 *
li
);

150 
quickli¡RewšdTa
(
quickli¡
 *quickli¡, 
quickli¡I‹r
 *
li
);

151 
quickli¡RÙ©e
(
quickli¡
 *quicklist);

152 
quickli¡PİCu¡om
(
quickli¡
 *quickli¡, 
wh”e
, **
d©a
,

153 *
sz
, *
sv®
,

154 *(*
§v”
)(*
d©a
, 
sz
));

155 
quickli¡Pİ
(
quickli¡
 *quickli¡, 
wh”e
, **
d©a
,

156 *
sz
, *
¦Úg
);

157 
quickli¡CouÁ
(
quickli¡
 *
ql
);

158 
quickli¡Com·»
(*
p1
, *
p2
, 
p2_Ën
);

159 
size_t
 
quickli¡G‘Lzf
(cÚ¡ 
quickli¡Node
 *
node
, **
d©a
);

161 #ifdeà
REDIS_TEST


162 
quickli¡Te¡
(
¬gc
, *
¬gv
[]);

166 
	#AL_START_HEAD
 0

	)

167 
	#AL_START_TAIL
 1

	)

	@src/rand.c

44 
	~<¡dšt.h
>

46 
	#N
 16

	)

47 
	#MASK
 ((1 << (
N
 - 1)è+ (1 << (N - 1)è- 1)

	)

48 
	#LOW
(
x
è(()(xè& 
MASK
)

	)

49 
	#HIGH
(
x
è
	`LOW
((xè>> 
N
)

	)

50 
	#MUL
(
x
, 
y
, 
z
è{ 
št32_t
 
l
 = ()(x) * ()(y); \

51 (
z
)[0] = 
	`LOW
(
l
); (z)[1] = 
	`HIGH
Ö); }

	)

52 
	#CARRY
(
x
, 
y
è((
št32_t
)(xè+ ()(yè> 
MASK
)

	)

53 
	#ADDEQU
(
x
, 
y
, 
z
è(z = 
	`CARRY
(x, (y)), x = 
	`LOW
(x + (y)))

	)

54 
	#X0
 0x330E

	)

55 
	#X1
 0xABCD

	)

56 
	#X2
 0x1234

	)

57 
	#A0
 0xE66D

	)

58 
	#A1
 0xDEEC

	)

59 
	#A2
 0x5

	)

60 
	#C
 0xB

	)

61 
	#SET3
(
x
, 
x0
, 
x1
, 
x2
è((x)[0] = (x0), (x)[1] = (x1), (x)[2] = (x2))

	)

62 
	#SETLOW
(
x
, 
y
, 
n
è
	`SET3
(x, 
	`LOW
((y)[n]), LOW((y)[Ò)+1]), LOW((y)[Ò)+2]))

	)

63 
	#SEED
(
x0
, 
x1
, 
x2
è(
	`SET3
(
x
, x0, x1, x2), SET3(
a
, 
A0
, 
A1
, 
A2
), 
c
 = 
C
)

	)

64 
	#REST
(
v
è
i
 = 0; i < 3; i++è{ 
xsubi
[i] = 
x
[i]; x[i] = 
‹mp
[i]; } \

65  (
v
);

	)

66 
	#HI_BIT
 (1L << (2 * 
N
 - 1))

	)

68 
ušt32_t
 
	gx
[3] = { 
X0
, 
X1
, 
X2
 }, 
	ga
[3] = { 
A0
, 
A1
, 
A2
 }, 
	gc
 = 
C
;

69 
Ãxt
();

71 
št32_t
 
	$»disL¿nd48
() {

72 
	`Ãxt
();

73  (((
št32_t
)
x
[2] << (
N
 - 1)) + (x[1] >> 1));

74 
	}
}

76 
	$»disS¿nd48
(
št32_t
 
£edv®
) {

77 
	`SEED
(
X0
, 
	`LOW
(
£edv®
), 
	`HIGH
(seedval));

78 
	}
}

80 
	$Ãxt
() {

81 
ušt32_t
 
p
[2], 
q
[2], 
r
[2], 
ÿ¼y0
, 
ÿ¼y1
;

83 
	`MUL
(
a
[0], 
x
[0], 
p
);

84 
	`ADDEQU
(
p
[0], 
c
, 
ÿ¼y0
);

85 
	`ADDEQU
(
p
[1], 
ÿ¼y0
, 
ÿ¼y1
);

86 
	`MUL
(
a
[0], 
x
[1], 
q
);

87 
	`ADDEQU
(
p
[1], 
q
[0], 
ÿ¼y0
);

88 
	`MUL
(
a
[1], 
x
[0], 
r
);

89 
x
[2] = 
	`LOW
(
ÿ¼y0
 + 
ÿ¼y1
 + 
	`CARRY
(
p
[1], 
r
[0]è+ 
q
[1] +„[1] +

90 
a
[0] * 
x
[2] +‡[1] * x[1] +‡[2] * x[0]);

91 
x
[1] = 
	`LOW
(
p
[1] + 
r
[0]);

92 
x
[0] = 
	`LOW
(
p
[0]);

93 
	}
}

	@src/rand.h

30 #iâdeà
REDIS_RANDOM_H


31 
	#REDIS_RANDOM_H


	)

33 
št32_t
 
»disL¿nd48
();

34 
»disS¿nd48
(
št32_t
 
£edv®
);

36 
	#REDIS_LRAND48_MAX
 
INT32_MAX


	)

	@src/rdb.c

30 
	~"£rv”.h
"

31 
	~"lzf.h
"

32 
	~"zm­.h
"

33 
	~"’dŸncÚv.h
"

35 
	~<m©h.h
>

36 
	~<sys/ty³s.h
>

37 
	~<sys/time.h
>

38 
	~<sys/»sourû.h
>

39 
	~<sys/wa™.h
>

40 
	~<¬·/š‘.h
>

41 
	~<sys/¡©.h
>

42 
	~<sys/·¿m.h
>

44 
	#RDB_LOAD_NONE
 0

	)

45 
	#RDB_LOAD_ENC
 (1<<0)

	)

46 
	#RDB_LOAD_PLAIN
 (1<<1)

	)

48 
	#rdbEx™R•ÜtCÜru±RDB
(...è
	`rdbCheckTh’Ex™
(
__LINE__
,
__VA_ARGS__
)

	)

50 
rdbCheckMode
;

51 
rdbCheckE¼Ü
(cÚ¡ *
fmt
, ...);

52 
rdbCheckS‘E¼Ü
(cÚ¡ *
fmt
, ...);

54 
	$rdbCheckTh’Ex™
(
lš’um
, *
»asÚ
, ...) {

55 
va_li¡
 
­
;

56 
msg
[1024];

57 
Ën
;

59 
Ën
 = 
	`¢´štf
(
msg
,(msg),

60 "IÁ”ÇÈ”rÜ iÀRDB„—dšg funùiÚ‡ˆrdb.c:%d -> ", 
lš’um
);

61 
	`va_¡¬t
(
­
,
»asÚ
);

62 
	`v¢´štf
(
msg
+
Ën
,(msg)-Ën,
»asÚ
,
­
);

63 
	`va_’d
(
­
);

65 ià(!
rdbCheckMode
) {

66 
	`£rv”Log
(
LL_WARNING
, "%s", 
msg
);

67 *
¬gv
[2] = {"",
£rv”
.
rdb_f’ame
};

68 
	`»dis_check_rdb_maš
(2,
¬gv
);

70 
	`rdbCheckE¼Ü
("%s",
msg
);

72 
	`ex™
(1);

73 
	}
}

75 
	$rdbWr™eRaw
(
rio
 *
rdb
, *
p
, 
size_t
 
Ën
) {

76 ià(
rdb
 && 
	`rioWr™e
Ôdb,
p
,
Ën
) == 0)

78  
Ën
;

79 
	}
}

81 
	$rdbSaveTy³
(
rio
 *
rdb
, 
ty³
) {

82  
	`rdbWr™eRaw
(
rdb
,&
ty³
,1);

83 
	}
}

88 
	$rdbLßdTy³
(
rio
 *
rdb
) {

89 
ty³
;

90 ià(
	`rioR—d
(
rdb
,&
ty³
,1) == 0)  -1;

91  
ty³
;

92 
	}
}

94 
time_t
 
	$rdbLßdTime
(
rio
 *
rdb
) {

95 
št32_t
 
t32
;

96 ià(
	`rioR—d
(
rdb
,&
t32
,4) == 0)  -1;

97  (
time_t
)
t32
;

98 
	}
}

100 
	$rdbSaveMli£cÚdTime
(
rio
 *
rdb
, 
t
) {

101 
št64_t
 
t64
 = (št64_tè
t
;

102  
	`rdbWr™eRaw
(
rdb
,&
t64
,8);

103 
	}
}

105 
	$rdbLßdMli£cÚdTime
(
rio
 *
rdb
) {

106 
št64_t
 
t64
;

107 ià(
	`rioR—d
(
rdb
,&
t64
,8) == 0)  -1;

108  ()
t64
;

109 
	}
}

114 
	$rdbSaveL’
(
rio
 *
rdb
, 
ušt32_t
 
Ën
) {

115 
buf
[2];

116 
size_t
 
nwr™‹n
;

118 ià(
Ën
 < (1<<6)) {

120 
buf
[0] = (
Ën
&0xFF)|(
RDB_6BITLEN
<<6);

121 ià(
	`rdbWr™eRaw
(
rdb
,
buf
,1) == -1)  -1;

122 
nwr™‹n
 = 1;

123 } ià(
Ën
 < (1<<14)) {

125 
buf
[0] = ((
Ën
>>8)&0xFF)|(
RDB_14BITLEN
<<6);

126 
buf
[1] = 
Ën
&0xFF;

127 ià(
	`rdbWr™eRaw
(
rdb
,
buf
,2) == -1)  -1;

128 
nwr™‹n
 = 2;

131 
buf
[0] = (
RDB_32BITLEN
<<6);

132 ià(
	`rdbWr™eRaw
(
rdb
,
buf
,1) == -1)  -1;

133 
Ën
 = 
	`htÚl
(len);

134 ià(
	`rdbWr™eRaw
(
rdb
,&
Ën
,4) == -1)  -1;

135 
nwr™‹n
 = 1+4;

137  
nwr™‹n
;

138 
	}
}

143 
ušt32_t
 
	$rdbLßdL’
(
rio
 *
rdb
, *
i£ncoded
) {

144 
buf
[2];

145 
ušt32_t
 
Ën
;

146 
ty³
;

148 ià(
i£ncoded
) *isencoded = 0;

149 ià(
	`rioR—d
(
rdb
,
buf
,1è=ğ0è 
RDB_LENERR
;

150 
ty³
 = (
buf
[0]&0xC0)>>6;

151 ià(
ty³
 =ğ
RDB_ENCVAL
) {

153 ià(
i£ncoded
) *isencoded = 1;

154  
buf
[0]&0x3F;

155 } ià(
ty³
 =ğ
RDB_6BITLEN
) {

157  
buf
[0]&0x3F;

158 } ià(
ty³
 =ğ
RDB_14BITLEN
) {

160 ià(
	`rioR—d
(
rdb
,
buf
+1,1è=ğ0è 
RDB_LENERR
;

161  ((
buf
[0]&0x3F)<<8)|buf[1];

162 } ià(
ty³
 =ğ
RDB_32BITLEN
) {

164 ià(
	`rioR—d
(
rdb
,&
Ën
,4è=ğ0è 
RDB_LENERR
;

165  
	`Áohl
(
Ën
);

167 
	`rdbEx™R•ÜtCÜru±RDB
(

168 "UnknowÀËngthƒncodšg %d iÀrdbLßdL’()",
ty³
);

171 
	}
}

177 
	$rdbEncodeIÁeg”
(
v®ue
, *
’c
) {

178 ià(
v®ue
 >= -(1<<7) && value <= (1<<7)-1) {

179 
’c
[0] = (
RDB_ENCVAL
<<6)|
RDB_ENC_INT8
;

180 
’c
[1] = 
v®ue
&0xFF;

182 } ià(
v®ue
 >= -(1<<15) && value <= (1<<15)-1) {

183 
’c
[0] = (
RDB_ENCVAL
<<6)|
RDB_ENC_INT16
;

184 
’c
[1] = 
v®ue
&0xFF;

185 
’c
[2] = (
v®ue
>>8)&0xFF;

187 } ià(
v®ue
 >= -(()1<<31) && value <= (()1<<31)-1) {

188 
’c
[0] = (
RDB_ENCVAL
<<6)|
RDB_ENC_INT32
;

189 
’c
[1] = 
v®ue
&0xFF;

190 
’c
[2] = (
v®ue
>>8)&0xFF;

191 
’c
[3] = (
v®ue
>>16)&0xFF;

192 
’c
[4] = (
v®ue
>>24)&0xFF;

197 
	}
}

202 *
	$rdbLßdIÁeg”Objeù
(
rio
 *
rdb
, 
’ùy³
, 
æags
) {

203 
¶aš
 = 
æags
 & 
RDB_LOAD_PLAIN
;

204 
’code
 = 
æags
 & 
RDB_LOAD_ENC
;

205 
’c
[4];

206 
v®
;

208 ià(
’ùy³
 =ğ
RDB_ENC_INT8
) {

209 ià(
	`rioR—d
(
rdb
,
’c
,1è=ğ0è 
NULL
;

210 
v®
 = (sigÃd )
’c
[0];

211 } ià(
’ùy³
 =ğ
RDB_ENC_INT16
) {

212 
ušt16_t
 
v
;

213 ià(
	`rioR—d
(
rdb
,
’c
,2è=ğ0è 
NULL
;

214 
v
 = 
’c
[0]|(enc[1]<<8);

215 
v®
 = (
št16_t
)
v
;

216 } ià(
’ùy³
 =ğ
RDB_ENC_INT32
) {

217 
ušt32_t
 
v
;

218 ià(
	`rioR—d
(
rdb
,
’c
,4è=ğ0è 
NULL
;

219 
v
 = 
’c
[0]|(enc[1]<<8)|(enc[2]<<16)|(enc[3]<<24);

220 
v®
 = (
št32_t
)
v
;

222 
v®
 = 0;

223 
	`rdbEx™R•ÜtCÜru±RDB
("UnknowÀRDB iÁeg”ƒncodšgy³ %d",
’ùy³
);

225 ià(
¶aš
) {

226 
buf
[
LONG_STR_SIZE
], *
p
;

227 
Ën
 = 
	`Î2¡ršg
(
buf
,(buf),
v®
);

228 
p
 = 
	`zm®loc
(
Ën
);

229 
	`memıy
(
p
,
buf
,
Ën
);

230  
p
;

231 } ià(
’code
) {

232  
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
v®
);

234  
	`ü—‹Objeù
(
OBJ_STRING
,
	`sdsäomlÚglÚg
(
v®
));

236 
	}
}

241 
	$rdbTryIÁeg”Encodšg
(*
s
, 
size_t
 
Ën
, *
’c
) {

242 
v®ue
;

243 *
’d±r
, 
buf
[32];

246 
v®ue
 = 
	`¡¹Şl
(
s
, &
’d±r
, 10);

247 ià(
’d±r
[0] != '\0')  0;

248 
	`Î2¡ršg
(
buf
,32,
v®ue
);

252 ià(
	`¡¾’
(
buf
è!ğ
Ën
 || 
	`memcmp
(buf,
s
,len))  0;

254  
	`rdbEncodeIÁeg”
(
v®ue
,
’c
);

255 
	}
}

257 
ssize_t
 
	$rdbSaveLzfBlob
(
rio
 *
rdb
, *
d©a
, 
size_t
 
com´ess_Ën
,

258 
size_t
 
Üigš®_Ën
) {

259 
by‹
;

260 
ssize_t
 
n
, 
nwr™‹n
 = 0;

263 
by‹
 = (
RDB_ENCVAL
<<6)|
RDB_ENC_LZF
;

264 ià((
n
 = 
	`rdbWr™eRaw
(
rdb
,&
by‹
,1)è=ğ-1è
wr™“¼
;

265 
nwr™‹n
 +ğ
n
;

267 ià((
n
 = 
	`rdbSaveL’
(
rdb
,
com´ess_Ën
)è=ğ-1è
wr™“¼
;

268 
nwr™‹n
 +ğ
n
;

270 ià((
n
 = 
	`rdbSaveL’
(
rdb
,
Üigš®_Ën
)è=ğ-1è
wr™“¼
;

271 
nwr™‹n
 +ğ
n
;

273 ià((
n
 = 
	`rdbWr™eRaw
(
rdb
,
d©a
,
com´ess_Ën
)è=ğ-1è
wr™“¼
;

274 
nwr™‹n
 +ğ
n
;

276  
nwr™‹n
;

278 
wr™“¼
:

280 
	}
}

282 
ssize_t
 
	$rdbSaveLzfSŒšgObjeù
(
rio
 *
rdb
, *
s
, 
size_t
 
Ën
) {

283 
size_t
 
com´Ën
, 
ou’
;

284 *
out
;

287 ià(
Ën
 <= 4)  0;

288 
ou’
 = 
Ën
-4;

289 ià((
out
 = 
	`zm®loc
(
ou’
+1)è=ğ
NULL
)  0;

290 
com´Ën
 = 
	`lzf_com´ess
(
s
, 
Ën
, 
out
, 
ou’
);

291 ià(
com´Ën
 == 0) {

292 
	`zä“
(
out
);

295 
ssize_t
 
nwr™‹n
 = 
	`rdbSaveLzfBlob
(
rdb
, 
out
, 
com´Ën
, 
Ën
);

296 
	`zä“
(
out
);

297  
nwr™‹n
;

298 
	}
}

303 *
	$rdbLßdLzfSŒšgObjeù
(
rio
 *
rdb
, 
æags
) {

304 
¶aš
 = 
æags
 & 
RDB_LOAD_PLAIN
;

305 
Ën
, 
ş’
;

306 *
c
 = 
NULL
;

307 
sds
 
v®
 = 
NULL
;

309 ià((
ş’
 = 
	`rdbLßdL’
(
rdb
,
NULL
)è=ğ
RDB_LENERR
)  NULL;

310 ià((
Ën
 = 
	`rdbLßdL’
(
rdb
,
NULL
)è=ğ
RDB_LENERR
)  NULL;

311 ià((
c
 = 
	`zm®loc
(
ş’
)è=ğ
NULL
è
”r
;

314 ià(
¶aš
) {

315 
v®
 = 
	`zm®loc
(
Ën
);

317 ià((
v®
 = 
	`sd¢ewËn
(
NULL
,
Ën
)è=ğNULLè
”r
;

321 ià(
	`rioR—d
(
rdb
,
c
,
ş’
è=ğ0è
”r
;

322 ià(
	`lzf_decom´ess
(
c
,
ş’
,
v®
,
Ën
) == 0) {

323 ià(
rdbCheckMode
è
	`rdbCheckS‘E¼Ü
("Invalid LZF compressed string");

324 
”r
;

326 
	`zä“
(
c
);

328 ià(
¶aš
)

329  
v®
;

331  
	`ü—‹Objeù
(
OBJ_STRING
,
v®
);

332 
”r
:

333 
	`zä“
(
c
);

334 ià(
¶aš
)

335 
	`zä“
(
v®
);

337 
	`sdsä“
(
v®
);

338  
NULL
;

339 
	}
}

343 
ssize_t
 
	$rdbSaveRawSŒšg
(
rio
 *
rdb
, *
s
, 
size_t
 
Ën
) {

344 
’ş’
;

345 
ssize_t
 
n
, 
nwr™‹n
 = 0;

348 ià(
Ën
 <= 11) {

349 
buf
[5];

350 ià((
’ş’
 = 
	`rdbTryIÁeg”Encodšg
((*)
s
,
Ën
,
buf
)) > 0) {

351 ià(
	`rdbWr™eRaw
(
rdb
,
buf
,
’ş’
) == -1)  -1;

352  
’ş’
;

358 ià(
£rv”
.
rdb_com´essiÚ
 && 
Ën
 > 20) {

359 
n
 = 
	`rdbSaveLzfSŒšgObjeù
(
rdb
,
s
,
Ën
);

360 ià(
n
 == -1)  -1;

361 ià(
n
 > 0) ‚;

366 ià((
n
 = 
	`rdbSaveL’
(
rdb
,
Ën
)) == -1)  -1;

367 
nwr™‹n
 +ğ
n
;

368 ià(
Ën
 > 0) {

369 ià(
	`rdbWr™eRaw
(
rdb
,
s
,
Ën
) == -1)  -1;

370 
nwr™‹n
 +ğ
Ën
;

372  
nwr™‹n
;

373 
	}
}

376 
ssize_t
 
	$rdbSaveLÚgLÚgAsSŒšgObjeù
(
rio
 *
rdb
, 
v®ue
) {

377 
buf
[32];

378 
ssize_t
 
n
, 
nwr™‹n
 = 0;

379 
’ş’
 = 
	`rdbEncodeIÁeg”
(
v®ue
,
buf
);

380 ià(
’ş’
 > 0) {

381  
	`rdbWr™eRaw
(
rdb
,
buf
,
’ş’
);

384 
’ş’
 = 
	`Î2¡ršg
((*)
buf
,32,
v®ue
);

385 
	`£rv”As£¹
(
’ş’
 < 32);

386 ià((
n
 = 
	`rdbSaveL’
(
rdb
,
’ş’
)) == -1)  -1;

387 
nwr™‹n
 +ğ
n
;

388 ià((
n
 = 
	`rdbWr™eRaw
(
rdb
,
buf
,
’ş’
)) == -1)  -1;

389 
nwr™‹n
 +ğ
n
;

391  
nwr™‹n
;

392 
	}
}

395 
	$rdbSaveSŒšgObjeù
(
rio
 *
rdb
, 
robj
 *
obj
) {

398 ià(
obj
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

399  
	`rdbSaveLÚgLÚgAsSŒšgObjeù
(
rdb
,()
obj
->
±r
);

401 
	`£rv”As£¹W™hInfo
(
NULL
,
obj
,
	`sdsEncodedObjeù
(obj));

402  
	`rdbSaveRawSŒšg
(
rdb
,
obj
->
±r
,
	`sd¦’
(obj->ptr));

404 
	}
}

417 *
	$rdbG’”icLßdSŒšgObjeù
(
rio
 *
rdb
, 
æags
) {

418 
’code
 = 
æags
 & 
RDB_LOAD_ENC
;

419 
¶aš
 = 
æags
 & 
RDB_LOAD_PLAIN
;

420 
i£ncoded
;

421 
ušt32_t
 
Ën
;

423 
Ën
 = 
	`rdbLßdL’
(
rdb
,&
i£ncoded
);

424 ià(
i£ncoded
) {

425 
Ën
) {

426 
RDB_ENC_INT8
:

427 
RDB_ENC_INT16
:

428 
RDB_ENC_INT32
:

429  
	`rdbLßdIÁeg”Objeù
(
rdb
,
Ën
,
æags
);

430 
RDB_ENC_LZF
:

431  
	`rdbLßdLzfSŒšgObjeù
(
rdb
,
æags
);

433 
	`rdbEx™R•ÜtCÜru±RDB
("UnknowÀRDB sŒšgƒncodšgy³ %d",
Ën
);

437 ià(
Ën
 =ğ
RDB_LENERR
è 
NULL
;

438 ià(!
¶aš
) {

439 
robj
 *
o
 = 
’code
 ? 
	`ü—‹SŒšgObjeù
(
NULL
,
Ën
) :

440 
	`ü—‹RawSŒšgObjeù
(
NULL
,
Ën
);

441 ià(
Ën
 && 
	`rioR—d
(
rdb
,
o
->
±r
,len) == 0) {

442 
	`deüRefCouÁ
(
o
);

443  
NULL
;

445  
o
;

447 *
buf
 = 
	`zm®loc
(
Ën
);

448 ià(
Ën
 && 
	`rioR—d
(
rdb
,
buf
,len) == 0) {

449 
	`zä“
(
buf
);

450  
NULL
;

452  
buf
;

454 
	}
}

456 
robj
 *
	$rdbLßdSŒšgObjeù
(
rio
 *
rdb
) {

457  
	`rdbG’”icLßdSŒšgObjeù
(
rdb
,
RDB_LOAD_NONE
);

458 
	}
}

460 
robj
 *
	$rdbLßdEncodedSŒšgObjeù
(
rio
 *
rdb
) {

461  
	`rdbG’”icLßdSŒšgObjeù
(
rdb
,
RDB_LOAD_ENC
);

462 
	}
}

472 
	$rdbSaveDoubËV®ue
(
rio
 *
rdb
, 
v®
) {

473 
buf
[128];

474 
Ën
;

476 ià(
	`i¢ª
(
v®
)) {

477 
buf
[0] = 253;

478 
Ën
 = 1;

479 } ià(!
	`isfš™e
(
v®
)) {

480 
Ën
 = 1;

481 
buf
[0] = (
v®
 < 0) ? 255 : 254;

483 #ià(
DBL_MANT_DIG
 >ğ52è&& (
LLONG_MAX
 == 0x7fffffffffffffffLL)

493 
mš
 = -4503599627370495;

494 
max
 = 4503599627370496;

495 ià(
v®
 > 
mš
 && v® < 
max
 && val == (()(()val)))

496 
	`Î2¡ršg
((*)
buf
+1,(buf)-1,()
v®
);

499 
	`¢´štf
((*)
buf
+1,(buf)-1,"%.17g",
v®
);

500 
buf
[0] = 
	`¡¾’
((*)buf+1);

501 
Ën
 = 
buf
[0]+1;

503  
	`rdbWr™eRaw
(
rdb
,
buf
,
Ën
);

504 
	}
}

507 
	$rdbLßdDoubËV®ue
(
rio
 *
rdb
, *
v®
) {

508 
buf
[256];

509 
Ën
;

511 ià(
	`rioR—d
(
rdb
,&
Ën
,1) == 0)  -1;

512 
Ën
) {

513 255: *
v®
 = 
R_NegInf
;  0;

514 254: *
v®
 = 
R_PosInf
;  0;

515 253: *
v®
 = 
R_Nª
;  0;

517 ià(
	`rioR—d
(
rdb
,
buf
,
Ën
) == 0)  -1;

518 
buf
[
Ën
] = '\0';

519 
	`ssÿnf
(
buf
, "%lg", 
v®
);

522 
	}
}

525 
	$rdbSaveObjeùTy³
(
rio
 *
rdb
, 
robj
 *
o
) {

526 
o
->
ty³
) {

527 
OBJ_STRING
:

528  
	`rdbSaveTy³
(
rdb
,
RDB_TYPE_STRING
);

529 
OBJ_LIST
:

530 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
)

531  
	`rdbSaveTy³
(
rdb
,
RDB_TYPE_LIST_QUICKLIST
);

533 
	`£rv”Pªic
("Unknown†istƒncoding");

534 
OBJ_SET
:

535 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
)

536  
	`rdbSaveTy³
(
rdb
,
RDB_TYPE_SET_INTSET
);

537 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
)

538  
	`rdbSaveTy³
(
rdb
,
RDB_TYPE_SET
);

540 
	`£rv”Pªic
("Unknown setƒncoding");

541 
OBJ_ZSET
:

542 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
)

543  
	`rdbSaveTy³
(
rdb
,
RDB_TYPE_ZSET_ZIPLIST
);

544 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
)

545  
	`rdbSaveTy³
(
rdb
,
RDB_TYPE_ZSET
);

547 
	`£rv”Pªic
("Unknown sorted setƒncoding");

548 
OBJ_HASH
:

549 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
)

550  
	`rdbSaveTy³
(
rdb
,
RDB_TYPE_HASH_ZIPLIST
);

551 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
)

552  
	`rdbSaveTy³
(
rdb
,
RDB_TYPE_HASH
);

554 
	`£rv”Pªic
("Unknown hashƒncoding");

556 
	`£rv”Pªic
("Unknown objectype");

559 
	}
}

563 
	$rdbLßdObjeùTy³
(
rio
 *
rdb
) {

564 
ty³
;

565 ià((
ty³
 = 
	`rdbLßdTy³
(
rdb
)) == -1)  -1;

566 ià(!
	`rdbIsObjeùTy³
(
ty³
))  -1;

567  
ty³
;

568 
	}
}

571 
ssize_t
 
	$rdbSaveObjeù
(
rio
 *
rdb
, 
robj
 *
o
) {

572 
ssize_t
 
n
 = 0, 
nwr™‹n
 = 0;

574 ià(
o
->
ty³
 =ğ
OBJ_STRING
) {

576 ià((
n
 = 
	`rdbSaveSŒšgObjeù
(
rdb
,
o
)) == -1)  -1;

577 
nwr™‹n
 +ğ
n
;

578 } ià(
o
->
ty³
 =ğ
OBJ_LIST
) {

580 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

581 
quickli¡
 *
ql
 = 
o
->
±r
;

582 
quickli¡Node
 *
node
 = 
ql
->
h—d
;

584 ià((
n
 = 
	`rdbSaveL’
(
rdb
,
ql
->
Ën
)) == -1)  -1;

585 
nwr™‹n
 +ğ
n
;

588 ià(
	`quickli¡NodeIsCom´es£d
(
node
)) {

589 *
d©a
;

590 
size_t
 
com´ess_Ën
 = 
	`quickli¡G‘Lzf
(
node
, &
d©a
);

591 ià((
n
 = 
	`rdbSaveLzfBlob
(
rdb
,
d©a
,
com´ess_Ën
,
node
->
sz
)) == -1)  -1;

592 
nwr™‹n
 +ğ
n
;

594 ià((
n
 = 
	`rdbSaveRawSŒšg
(
rdb
,
node
->
zl
,node->
sz
)) == -1)  -1;

595 
nwr™‹n
 +ğ
n
;

597 } (
node
 =‚ode->
Ãxt
));

599 
	`£rv”Pªic
("Unknown†istƒncoding");

601 } ià(
o
->
ty³
 =ğ
OBJ_SET
) {

603 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

604 
diù
 *
£t
 = 
o
->
±r
;

605 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘I‹¿tÜ
(
£t
);

606 
diùEÁry
 *
de
;

608 ià((
n
 = 
	`rdbSaveL’
(
rdb
,
	`diùSize
(
£t
))) == -1)  -1;

609 
nwr™‹n
 +ğ
n
;

611 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

612 
robj
 *
–eobj
 = 
	`diùG‘Key
(
de
);

613 ià((
n
 = 
	`rdbSaveSŒšgObjeù
(
rdb
,
–eobj
)) == -1)  -1;

614 
nwr™‹n
 +ğ
n
;

616 
	`diùR–—£I‹¿tÜ
(
di
);

617 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

618 
size_t
 
l
 = 
	`št£tBlobL’
((
št£t
*)
o
->
±r
);

620 ià((
n
 = 
	`rdbSaveRawSŒšg
(
rdb
,
o
->
±r
,
l
)) == -1)  -1;

621 
nwr™‹n
 +ğ
n
;

623 
	`£rv”Pªic
("Unknown setƒncoding");

625 } ià(
o
->
ty³
 =ğ
OBJ_ZSET
) {

627 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

628 
size_t
 
l
 = 
	`zli¡BlobL’
((*)
o
->
±r
);

630 ià((
n
 = 
	`rdbSaveRawSŒšg
(
rdb
,
o
->
±r
,
l
)) == -1)  -1;

631 
nwr™‹n
 +ğ
n
;

632 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

633 
z£t
 *
zs
 = 
o
->
±r
;

634 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘I‹¿tÜ
(
zs
->
diù
);

635 
diùEÁry
 *
de
;

637 ià((
n
 = 
	`rdbSaveL’
(
rdb
,
	`diùSize
(
zs
->
diù
))) == -1)  -1;

638 
nwr™‹n
 +ğ
n
;

640 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

641 
robj
 *
–eobj
 = 
	`diùG‘Key
(
de
);

642 *
scÜe
 = 
	`diùG‘V®
(
de
);

644 ià((
n
 = 
	`rdbSaveSŒšgObjeù
(
rdb
,
–eobj
)) == -1)  -1;

645 
nwr™‹n
 +ğ
n
;

646 ià((
n
 = 
	`rdbSaveDoubËV®ue
(
rdb
,*
scÜe
)) == -1)  -1;

647 
nwr™‹n
 +ğ
n
;

649 
	`diùR–—£I‹¿tÜ
(
di
);

651 
	`£rv”Pªic
("Unknown sorted setƒncoding");

653 } ià(
o
->
ty³
 =ğ
OBJ_HASH
) {

655 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

656 
size_t
 
l
 = 
	`zli¡BlobL’
((*)
o
->
±r
);

658 ià((
n
 = 
	`rdbSaveRawSŒšg
(
rdb
,
o
->
±r
,
l
)) == -1)  -1;

659 
nwr™‹n
 +ğ
n
;

661 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

662 
diùI‹¿tÜ
 *
di
 = 
	`diùG‘I‹¿tÜ
(
o
->
±r
);

663 
diùEÁry
 *
de
;

665 ià((
n
 = 
	`rdbSaveL’
(
rdb
,
	`diùSize
((
diù
*)
o
->
±r
))) == -1)  -1;

666 
nwr™‹n
 +ğ
n
;

668 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

669 
robj
 *
key
 = 
	`diùG‘Key
(
de
);

670 
robj
 *
v®
 = 
	`diùG‘V®
(
de
);

672 ià((
n
 = 
	`rdbSaveSŒšgObjeù
(
rdb
,
key
)) == -1)  -1;

673 
nwr™‹n
 +ğ
n
;

674 ià((
n
 = 
	`rdbSaveSŒšgObjeù
(
rdb
,
v®
)) == -1)  -1;

675 
nwr™‹n
 +ğ
n
;

677 
	`diùR–—£I‹¿tÜ
(
di
);

680 
	`£rv”Pªic
("Unknown hashƒncoding");

684 
	`£rv”Pªic
("Unknown objectype");

686  
nwr™‹n
;

687 
	}
}

693 
size_t
 
	$rdbSavedObjeùL’
(
robj
 *
o
) {

694 
ssize_t
 
Ën
 = 
	`rdbSaveObjeù
(
NULL
,
o
);

695 
	`£rv”As£¹W™hInfo
(
NULL
,
o
,
Ën
 != -1);

696  
Ën
;

697 
	}
}

703 
	$rdbSaveKeyV®uePaœ
(
rio
 *
rdb
, 
robj
 *
key
,„obj *
v®
,

704 
expœ‘ime
, 
now
)

707 ià(
expœ‘ime
 != -1) {

709 ià(
expœ‘ime
 < 
now
)  0;

710 ià(
	`rdbSaveTy³
(
rdb
,
RDB_OPCODE_EXPIRETIME_MS
) == -1)  -1;

711 ià(
	`rdbSaveMli£cÚdTime
(
rdb
,
expœ‘ime
) == -1)  -1;

715 ià(
	`rdbSaveObjeùTy³
(
rdb
,
v®
) == -1)  -1;

716 ià(
	`rdbSaveSŒšgObjeù
(
rdb
,
key
) == -1)  -1;

717 ià(
	`rdbSaveObjeù
(
rdb
,
v®
) == -1)  -1;

719 
	}
}

722 
	$rdbSaveAuxF›ld
(
rio
 *
rdb
, *
key
, 
size_t
 
keyËn
, *
v®
, size_ˆ
v®Ën
) {

723 ià(
	`rdbSaveTy³
(
rdb
,
RDB_OPCODE_AUX
) == -1)  -1;

724 ià(
	`rdbSaveRawSŒšg
(
rdb
,
key
,
keyËn
) == -1)  -1;

725 ià(
	`rdbSaveRawSŒšg
(
rdb
,
v®
,
v®Ën
) == -1)  -1;

727 
	}
}

731 
	$rdbSaveAuxF›ldSŒSŒ
(
rio
 *
rdb
, *
key
, *
v®
) {

732  
	`rdbSaveAuxF›ld
(
rdb
,
key
,
	`¡¾’
(key),
v®
,strlen(val));

733 
	}
}

736 
	$rdbSaveAuxF›ldSŒIÁ
(
rio
 *
rdb
, *
key
, 
v®
) {

737 
buf
[
LONG_STR_SIZE
];

738 
vËn
 = 
	`Î2¡ršg
(
buf
,(buf),
v®
);

739  
	`rdbSaveAuxF›ld
(
rdb
,
key
,
	`¡¾’
(key),
buf
,
vËn
);

740 
	}
}

743 
	$rdbSaveInfoAuxF›lds
(
rio
 *
rdb
) {

744 
»dis_b™s
 = ((*) == 8) ? 64 : 32;

747 ià(
	`rdbSaveAuxF›ldSŒSŒ
(
rdb
,"»dis-v”",
REDIS_VERSION
) == -1)  -1;

748 ià(
	`rdbSaveAuxF›ldSŒIÁ
(
rdb
,"»dis-b™s",
»dis_b™s
) == -1)  -1;

749 ià(
	`rdbSaveAuxF›ldSŒIÁ
(
rdb
,"ùime",
	`time
(
NULL
)) == -1)  -1;

750 ià(
	`rdbSaveAuxF›ldSŒIÁ
(
rdb
,"u£d-mem",
	`zm®loc_u£d_memÜy
()) == -1)  -1;

752 
	}
}

762 
	$rdbSaveRio
(
rio
 *
rdb
, *
”rÜ
) {

763 
diùI‹¿tÜ
 *
di
 = 
NULL
;

764 
diùEÁry
 *
de
;

765 
magic
[10];

766 
j
;

767 
now
 = 
	`m¡ime
();

768 
ušt64_t
 
cksum
;

770 ià(
£rv”
.
rdb_checksum
)

771 
rdb
->
upd©e_cksum
 = 
rioG’”icUpd©eChecksum
;

772 
	`¢´štf
(
magic
,(magic),"REDIS%04d",
RDB_VERSION
);

773 ià(
	`rdbWr™eRaw
(
rdb
,
magic
,9è=ğ-1è
w”r
;

774 ià(
	`rdbSaveInfoAuxF›lds
(
rdb
è=ğ-1è
w”r
;

776 
j
 = 0; j < 
£rv”
.
dbnum
; j++) {

777 
»disDb
 *
db
 = 
£rv”
.db+
j
;

778 
diù
 *
d
 = 
db
->dict;

779 ià(
	`diùSize
(
d
) == 0) ;

780 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
d
);

781 ià(!
di
è 
C_ERR
;

784 ià(
	`rdbSaveTy³
(
rdb
,
RDB_OPCODE_SELECTDB
è=ğ-1è
w”r
;

785 ià(
	`rdbSaveL’
(
rdb
,
j
è=ğ-1è
w”r
;

791 
ušt32_t
 
db_size
, 
expœes_size
;

792 
db_size
 = (
	`diùSize
(
db
->
diù
è<ğ
UINT32_MAX
) ?

793 
	`diùSize
(
db
->
diù
) :

794 
UINT32_MAX
;

795 
expœes_size
 = (
	`diùSize
(
db
->
expœes
è<ğ
UINT32_MAX
) ?

796 
	`diùSize
(
db
->
expœes
) :

797 
UINT32_MAX
;

798 ià(
	`rdbSaveTy³
(
rdb
,
RDB_OPCODE_RESIZEDB
è=ğ-1è
w”r
;

799 ià(
	`rdbSaveL’
(
rdb
,
db_size
è=ğ-1è
w”r
;

800 ià(
	`rdbSaveL’
(
rdb
,
expœes_size
è=ğ-1è
w”r
;

803 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

804 
sds
 
key¡r
 = 
	`diùG‘Key
(
de
);

805 
robj
 
key
, *
o
 = 
	`diùG‘V®
(
de
);

806 
expœe
;

808 
	`š™SticSŒšgObjeù
(
key
,
key¡r
);

809 
expœe
 = 
	`g‘Expœe
(
db
,&
key
);

810 ià(
	`rdbSaveKeyV®uePaœ
(
rdb
,&
key
,
o
,
expœe
,
now
è=ğ-1è
w”r
;

812 
	`diùR–—£I‹¿tÜ
(
di
);

814 
di
 = 
NULL
;

817 ià(
	`rdbSaveTy³
(
rdb
,
RDB_OPCODE_EOF
è=ğ-1è
w”r
;

821 
cksum
 = 
rdb
->cksum;

822 
	`mem»v64ifbe
(&
cksum
);

823 ià(
	`rioWr™e
(
rdb
,&
cksum
,8è=ğ0è
w”r
;

824  
C_OK
;

826 
w”r
:

827 ià(
”rÜ
è*”rÜ = 
”ºo
;

828 ià(
di
è
	`diùR–—£I‹¿tÜ
(di);

829  
C_ERR
;

830 
	}
}

840 
	$rdbSaveRioW™hEOFM¬k
(
rio
 *
rdb
, *
”rÜ
) {

841 
eofm¬k
[
RDB_EOF_MARK_SIZE
];

843 
	`g‘RªdomHexCh¬s
(
eofm¬k
,
RDB_EOF_MARK_SIZE
);

844 ià(
”rÜ
) *error = 0;

845 ià(
	`rioWr™e
(
rdb
,"$EOF:",5è=ğ0è
w”r
;

846 ià(
	`rioWr™e
(
rdb
,
eofm¬k
,
RDB_EOF_MARK_SIZE
è=ğ0è
w”r
;

847 ià(
	`rioWr™e
(
rdb
,"\r\n",2è=ğ0è
w”r
;

848 ià(
	`rdbSaveRio
(
rdb
,
”rÜ
è=ğ
C_ERR
è
w”r
;

849 ià(
	`rioWr™e
(
rdb
,
eofm¬k
,
RDB_EOF_MARK_SIZE
è=ğ0è
w”r
;

850  
C_OK
;

852 
w”r
:

854 ià(
”rÜ
 && *”rÜ =ğ0è*”rÜ = 
”ºo
;

855  
C_ERR
;

856 
	}
}

859 
	$rdbSave
(*
f’ame
) {

860 
tmpfe
[256];

861 
cwd
[
MAXPATHLEN
];

862 
FILE
 *
å
;

863 
rio
 
rdb
;

864 
”rÜ
 = 0;

866 
	`¢´štf
(
tmpfe
,256,"‹mp-%d.rdb", (è
	`g‘pid
());

867 
å
 = 
	`fİ’
(
tmpfe
,"w");

868 ià(!
å
) {

869 *
cwdp
 = 
	`g‘cwd
(
cwd
,
MAXPATHLEN
);

870 
	`£rv”Log
(
LL_WARNING
,

873 
f’ame
,

874 
cwdp
 ? cwdp : "unknown",

875 
	`¡»¼Ü
(
”ºo
));

876  
C_ERR
;

879 
	`rioIn™W™hFe
(&
rdb
,
å
);

880 ià(
	`rdbSaveRio
(&
rdb
,&
”rÜ
è=ğ
C_ERR
) {

881 
”ºo
 = 
”rÜ
;

882 
w”r
;

886 ià(
	`fæush
(
å
è=ğ
EOF
è
w”r
;

887 ià(
	`fsync
(
	`f’o
(
å
)è=ğ-1è
w”r
;

888 ià(
	`fşo£
(
å
è=ğ
EOF
è
w”r
;

892 ià(
	`»Çme
(
tmpfe
,
f’ame
) == -1) {

893 *
cwdp
 = 
	`g‘cwd
(
cwd
,
MAXPATHLEN
);

894 
	`£rv”Log
(
LL_WARNING
,

897 
tmpfe
,

898 
f’ame
,

899 
cwdp
 ? cwdp : "unknown",

900 
	`¡»¼Ü
(
”ºo
));

901 
	`uÆšk
(
tmpfe
);

902  
C_ERR
;

905 
	`£rv”Log
(
LL_NOTICE
,"DB saved on disk");

906 
£rv”
.
dœty
 = 0;

907 
£rv”
.
Ï¡§ve
 = 
	`time
(
NULL
);

908 
£rv”
.
Ï¡bg§ve_¡©us
 = 
C_OK
;

909  
C_OK
;

911 
w”r
:

912 
	`£rv”Log
(
LL_WARNING
,"Wr™”rÜ savšg DB oÀdisk: %s", 
	`¡»¼Ü
(
”ºo
));

913 
	`fşo£
(
å
);

914 
	`uÆšk
(
tmpfe
);

915  
C_ERR
;

916 
	}
}

918 
	$rdbSaveBackground
(*
f’ame
) {

919 
pid_t
 
chdpid
;

920 
¡¬t
;

922 ià(
£rv”
.
aof_chd_pid
 !ğ-1 || s”v”.
rdb_chd_pid
 !ğ-1è 
C_ERR
;

924 
£rv”
.
dœty_befÜe_bg§ve
 = s”v”.
dœty
;

925 
£rv”
.
Ï¡bg§ve_Œy
 = 
	`time
(
NULL
);

927 
¡¬t
 = 
	`u¡ime
();

928 ià((
chdpid
 = 
	`fÜk
()) == 0) {

929 
»tv®
;

932 
	`şo£Li¡’šgSock‘s
(0);

933 
	`»disS‘ProcT™Ë
("redis-rdb-bgsave");

934 
»tv®
 = 
	`rdbSave
(
f’ame
);

935 ià(
»tv®
 =ğ
C_OK
) {

936 
size_t
 
´iv©e_dœty
 = 
	`zm®loc_g‘_´iv©e_dœty
();

938 ià(
´iv©e_dœty
) {

939 
	`£rv”Log
(
LL_NOTICE
,

941 
´iv©e_dœty
/(1024*1024));

944 
	`ex™FromChd
((
»tv®
 =ğ
C_OK
) ? 0 : 1);

947 
£rv”
.
¡©_fÜk_time
 = 
	`u¡ime
()-
¡¬t
;

948 
£rv”
.
¡©_fÜk_¿‹
 = (è
	`zm®loc_u£d_memÜy
(è* 1000000 / s”v”.
¡©_fÜk_time
 / (1024*1024*1024);

949 
	`Ï‹ncyAddSam¶eIfN“ded
("fÜk",
£rv”
.
¡©_fÜk_time
/1000);

950 ià(
chdpid
 == -1) {

951 
£rv”
.
Ï¡bg§ve_¡©us
 = 
C_ERR
;

952 
	`£rv”Log
(
LL_WARNING
,"Can't save in background: fork: %s",

953 
	`¡»¼Ü
(
”ºo
));

954  
C_ERR
;

956 
	`£rv”Log
(
LL_NOTICE
,"Background savšg s¹ed by…id %d",
chdpid
);

957 
£rv”
.
rdb_§ve_time_¡¬t
 = 
	`time
(
NULL
);

958 
£rv”
.
rdb_chd_pid
 = 
chdpid
;

959 
£rv”
.
rdb_chd_ty³
 = 
RDB_CHILD_TYPE_DISK
;

960 
	`upd©eDiùResizePŞicy
();

961  
C_OK
;

963  
C_OK
;

964 
	}
}

966 
	$rdbRemoveTempFe
(
pid_t
 
chdpid
) {

967 
tmpfe
[256];

969 
	`¢´štf
(
tmpfe
,Ñmpfe),"‹mp-%d.rdb", (è
chdpid
);

970 
	`uÆšk
(
tmpfe
);

971 
	}
}

975 
robj
 *
	$rdbLßdObjeù
(
rdbty³
, 
rio
 *
rdb
) {

976 
robj
 *
o
 = 
NULL
, *
–e
, *
dec
;

977 
size_t
 
Ën
;

978 
i
;

980 ià(
rdbty³
 =ğ
RDB_TYPE_STRING
) {

982 ià((
o
 = 
	`rdbLßdEncodedSŒšgObjeù
(
rdb
)è=ğ
NULL
)  NULL;

983 
o
 = 
	`ŒyObjeùEncodšg
(o);

984 } ià(
rdbty³
 =ğ
RDB_TYPE_LIST
) {

986 ià((
Ën
 = 
	`rdbLßdL’
(
rdb
,
NULL
)è=ğ
RDB_LENERR
)  NULL;

988 
o
 = 
	`ü—‹Quickli¡Objeù
();

989 
	`quickli¡S‘O±iÚs
(
o
->
±r
, 
£rv”
.
li¡_max_zli¡_size
,

990 
£rv”
.
li¡_com´ess_d•th
);

993 
Ën
--) {

994 ià((
–e
 = 
	`rdbLßdEncodedSŒšgObjeù
(
rdb
)è=ğ
NULL
)  NULL;

995 
dec
 = 
	`g‘DecodedObjeù
(
–e
);

996 
size_t
 
Ën
 = 
	`sd¦’
(
dec
->
±r
);

997 
	`quickli¡PushTa
(
o
->
±r
, 
dec
->±r, 
Ën
);

998 
	`deüRefCouÁ
(
dec
);

999 
	`deüRefCouÁ
(
–e
);

1001 } ià(
rdbty³
 =ğ
RDB_TYPE_SET
) {

1003 ià((
Ën
 = 
	`rdbLßdL’
(
rdb
,
NULL
)è=ğ
RDB_LENERR
)  NULL;

1006 ià(
Ën
 > 
£rv”
.
£t_max_št£t_’Œ›s
) {

1007 
o
 = 
	`ü—‹S‘Objeù
();

1010 ià(
Ën
 > 
DICT_HT_INITIAL_SIZE
)

1011 
	`diùEx·nd
(
o
->
±r
,
Ën
);

1013 
o
 = 
	`ü—‹IÁ£tObjeù
();

1017 
i
 = 0; i < 
Ën
; i++) {

1018 
Îv®
;

1019 ià((
–e
 = 
	`rdbLßdEncodedSŒšgObjeù
(
rdb
)è=ğ
NULL
)  NULL;

1020 
–e
 = 
	`ŒyObjeùEncodšg
(ele);

1022 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

1024 ià(
	`isObjeùR•»£ÁabËAsLÚgLÚg
(
–e
,&
Îv®
è=ğ
C_OK
) {

1025 
o
->
±r
 = 
	`št£tAdd
(o->±r,
Îv®
,
NULL
);

1027 
	`£tTy³CÚv”t
(
o
,
OBJ_ENCODING_HT
);

1028 
	`diùEx·nd
(
o
->
±r
,
Ën
);

1034 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

1035 
	`diùAdd
((
diù
*)
o
->
±r
,
–e
,
NULL
);

1037 
	`deüRefCouÁ
(
–e
);

1040 } ià(
rdbty³
 =ğ
RDB_TYPE_ZSET
) {

1042 
size_t
 
z£’
;

1043 
size_t
 
max––’
 = 0;

1044 
z£t
 *
zs
;

1046 ià((
z£’
 = 
	`rdbLßdL’
(
rdb
,
NULL
)è=ğ
RDB_LENERR
)  NULL;

1047 
o
 = 
	`ü—‹Z£tObjeù
();

1048 
zs
 = 
o
->
±r
;

1051 
z£’
--) {

1052 
robj
 *
–e
;

1053 
scÜe
;

1054 
zskli¡Node
 *
znode
;

1056 ià((
–e
 = 
	`rdbLßdEncodedSŒšgObjeù
(
rdb
)è=ğ
NULL
)  NULL;

1057 
–e
 = 
	`ŒyObjeùEncodšg
(ele);

1058 ià(
	`rdbLßdDoubËV®ue
(
rdb
,&
scÜe
è=ğ-1è 
NULL
;

1061 ià(
	`sdsEncodedObjeù
(
–e
è&& 
	`sd¦’
ÓË->
±r
è> 
max––’
)

1062 
max––’
 = 
	`sd¦’
(
–e
->
±r
);

1064 
znode
 = 
	`z¦In£¹
(
zs
->
z¦
,
scÜe
,
–e
);

1065 
	`diùAdd
(
zs
->
diù
,
–e
,&
znode
->
scÜe
);

1066 
	`šüRefCouÁ
(
–e
);

1070 ià(
	`z£tL’gth
(
o
è<ğ
£rv”
.
z£t_max_zli¡_’Œ›s
 &&

1071 
max––’
 <ğ
£rv”
.
z£t_max_zli¡_v®ue
)

1072 
	`z£tCÚv”t
(
o
,
OBJ_ENCODING_ZIPLIST
);

1073 } ià(
rdbty³
 =ğ
RDB_TYPE_HASH
) {

1074 
size_t
 
Ën
;

1075 
»t
;

1077 
Ën
 = 
	`rdbLßdL’
(
rdb
, 
NULL
);

1078 ià(
Ën
 =ğ
RDB_LENERR
è 
NULL
;

1080 
o
 = 
	`ü—‹HashObjeù
();

1083 ià(
Ën
 > 
£rv”
.
hash_max_zli¡_’Œ›s
)

1084 
	`hashTy³CÚv”t
(
o
, 
OBJ_ENCODING_HT
);

1087 
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
 && 
Ën
 > 0) {

1088 
robj
 *
f›ld
, *
v®ue
;

1090 
Ën
--;

1092 
f›ld
 = 
	`rdbLßdSŒšgObjeù
(
rdb
);

1093 ià(
f›ld
 =ğ
NULL
)  NULL;

1094 
	`£rv”As£¹
(
	`sdsEncodedObjeù
(
f›ld
));

1095 
v®ue
 = 
	`rdbLßdSŒšgObjeù
(
rdb
);

1096 ià(
v®ue
 =ğ
NULL
)  NULL;

1097 
	`£rv”As£¹
(
	`sdsEncodedObjeù
(
v®ue
));

1100 
o
->
±r
 = 
	`zli¡Push
(o->±r, 
f›ld
->±r, 
	`sd¦’
(f›ld->±r), 
ZIPLIST_TAIL
);

1101 
o
->
±r
 = 
	`zli¡Push
(o->±r, 
v®ue
->±r, 
	`sd¦’
(v®ue->±r), 
ZIPLIST_TAIL
);

1103 ià(
	`sd¦’
(
f›ld
->
±r
è> 
£rv”
.
hash_max_zli¡_v®ue
 ||

1104 
	`sd¦’
(
v®ue
->
±r
è> 
£rv”
.
hash_max_zli¡_v®ue
)

1106 
	`deüRefCouÁ
(
f›ld
);

1107 
	`deüRefCouÁ
(
v®ue
);

1108 
	`hashTy³CÚv”t
(
o
, 
OBJ_ENCODING_HT
);

1111 
	`deüRefCouÁ
(
f›ld
);

1112 
	`deüRefCouÁ
(
v®ue
);

1116 
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
 && 
Ën
 > 0) {

1117 
robj
 *
f›ld
, *
v®ue
;

1119 
Ën
--;

1121 
f›ld
 = 
	`rdbLßdEncodedSŒšgObjeù
(
rdb
);

1122 ià(
f›ld
 =ğ
NULL
)  NULL;

1123 
v®ue
 = 
	`rdbLßdEncodedSŒšgObjeù
(
rdb
);

1124 ià(
v®ue
 =ğ
NULL
)  NULL;

1126 
f›ld
 = 
	`ŒyObjeùEncodšg
(field);

1127 
v®ue
 = 
	`ŒyObjeùEncodšg
(value);

1130 
»t
 = 
	`diùAdd
((
diù
*)
o
->
±r
, 
f›ld
, 
v®ue
);

1131 ià(
»t
 =ğ
DICT_ERR
) {

1132 
	`rdbEx™R•ÜtCÜru±RDB
("Duplicate keys detected");

1137 
	`£rv”As£¹
(
Ën
 == 0);

1138 } ià(
rdbty³
 =ğ
RDB_TYPE_LIST_QUICKLIST
) {

1139 ià((
Ën
 = 
	`rdbLßdL’
(
rdb
,
NULL
)è=ğ
RDB_LENERR
)  NULL;

1140 
o
 = 
	`ü—‹Quickli¡Objeù
();

1141 
	`quickli¡S‘O±iÚs
(
o
->
±r
, 
£rv”
.
li¡_max_zli¡_size
,

1142 
£rv”
.
li¡_com´ess_d•th
);

1144 
Ën
--) {

1145 *
zl
 = 
	`rdbG’”icLßdSŒšgObjeù
(
rdb
,
RDB_LOAD_PLAIN
);

1146 ià(
zl
 =ğ
NULL
)  NULL;

1147 
	`quickli¡Aµ’dZli¡
(
o
->
±r
, 
zl
);

1149 } ià(
rdbty³
 =ğ
RDB_TYPE_HASH_ZIPMAP
 ||

1150 
rdbty³
 =ğ
RDB_TYPE_LIST_ZIPLIST
 ||

1151 
rdbty³
 =ğ
RDB_TYPE_SET_INTSET
 ||

1152 
rdbty³
 =ğ
RDB_TYPE_ZSET_ZIPLIST
 ||

1153 
rdbty³
 =ğ
RDB_TYPE_HASH_ZIPLIST
)

1155 *
’coded
 = 
	`rdbG’”icLßdSŒšgObjeù
(
rdb
,
RDB_LOAD_PLAIN
);

1156 ià(
’coded
 =ğ
NULL
)  NULL;

1157 
o
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
’coded
);

1165 
rdbty³
) {

1166 
RDB_TYPE_HASH_ZIPMAP
:

1170 *
zl
 = 
	`zli¡New
();

1171 *
zi
 = 
	`zm­Rewšd
(
o
->
±r
);

1172 *
f¡r
, *
v¡r
;

1173 
æ’
, 
vËn
;

1174 
maxËn
 = 0;

1176 (
zi
 = 
	`zm­Next
(zi, &
f¡r
, &
æ’
, &
v¡r
, &
vËn
)è!ğ
NULL
) {

1177 ià(
æ’
 > 
maxËn
) maxlen = flen;

1178 ià(
vËn
 > 
maxËn
) maxlen = vlen;

1179 
zl
 = 
	`zli¡Push
(zl, 
f¡r
, 
æ’
, 
ZIPLIST_TAIL
);

1180 
zl
 = 
	`zli¡Push
(zl, 
v¡r
, 
vËn
, 
ZIPLIST_TAIL
);

1183 
	`zä“
(
o
->
±r
);

1184 
o
->
±r
 = 
zl
;

1185 
o
->
ty³
 = 
OBJ_HASH
;

1186 
o
->
’codšg
 = 
OBJ_ENCODING_ZIPLIST
;

1188 ià(
	`hashTy³L’gth
(
o
è> 
£rv”
.
hash_max_zli¡_’Œ›s
 ||

1189 
maxËn
 > 
£rv”
.
hash_max_zli¡_v®ue
)

1191 
	`hashTy³CÚv”t
(
o
, 
OBJ_ENCODING_HT
);

1195 
RDB_TYPE_LIST_ZIPLIST
:

1196 
o
->
ty³
 = 
OBJ_LIST
;

1197 
o
->
’codšg
 = 
OBJ_ENCODING_ZIPLIST
;

1198 
	`li¡Ty³CÚv”t
(
o
,
OBJ_ENCODING_QUICKLIST
);

1200 
RDB_TYPE_SET_INTSET
:

1201 
o
->
ty³
 = 
OBJ_SET
;

1202 
o
->
’codšg
 = 
OBJ_ENCODING_INTSET
;

1203 ià(
	`št£tL’
(
o
->
±r
è> 
£rv”
.
£t_max_št£t_’Œ›s
)

1204 
	`£tTy³CÚv”t
(
o
,
OBJ_ENCODING_HT
);

1206 
RDB_TYPE_ZSET_ZIPLIST
:

1207 
o
->
ty³
 = 
OBJ_ZSET
;

1208 
o
->
’codšg
 = 
OBJ_ENCODING_ZIPLIST
;

1209 ià(
	`z£tL’gth
(
o
è> 
£rv”
.
z£t_max_zli¡_’Œ›s
)

1210 
	`z£tCÚv”t
(
o
,
OBJ_ENCODING_SKIPLIST
);

1212 
RDB_TYPE_HASH_ZIPLIST
:

1213 
o
->
ty³
 = 
OBJ_HASH
;

1214 
o
->
’codšg
 = 
OBJ_ENCODING_ZIPLIST
;

1215 ià(
	`hashTy³L’gth
(
o
è> 
£rv”
.
hash_max_zli¡_’Œ›s
)

1216 
	`hashTy³CÚv”t
(
o
, 
OBJ_ENCODING_HT
);

1219 
	`rdbEx™R•ÜtCÜru±RDB
("UnknowÀRDBƒncodšgy³ %d",
rdbty³
);

1223 
	`rdbEx™R•ÜtCÜru±RDB
("UnknowÀRDBƒncodšgy³ %d",
rdbty³
);

1225  
o
;

1226 
	}
}

1230 
	$¡¬tLßdšg
(
FILE
 *
å
) {

1231 
¡©
 
sb
;

1234 
£rv”
.
lßdšg
 = 1;

1235 
£rv”
.
lßdšg_¡¬t_time
 = 
	`time
(
NULL
);

1236 
£rv”
.
lßdšg_lßded_by‹s
 = 0;

1237 ià(
	`f¡©
(
	`f’o
(
å
), &
sb
) == -1) {

1238 
£rv”
.
lßdšg_tÙ®_by‹s
 = 0;

1240 
£rv”
.
lßdšg_tÙ®_by‹s
 = 
sb
.
¡_size
;

1242 
	}
}

1245 
	$lßdšgProg»ss
(
off_t
 
pos
) {

1246 
£rv”
.
lßdšg_lßded_by‹s
 = 
pos
;

1247 ià(
£rv”
.
¡©_³ak_memÜy
 < 
	`zm®loc_u£d_memÜy
())

1248 
£rv”
.
¡©_³ak_memÜy
 = 
	`zm®loc_u£d_memÜy
();

1249 
	}
}

1252 
	$¡İLßdšg
() {

1253 
£rv”
.
lßdšg
 = 0;

1254 
	}
}

1258 
	$rdbLßdProg»ssC®lback
(
rio
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
) {

1259 ià(
£rv”
.
rdb_checksum
)

1260 
	`rioG’”icUpd©eChecksum
(
r
, 
buf
, 
Ën
);

1261 ià(
£rv”
.
lßdšg_´oûss_ev’ts_š‹rv®_by‹s
 &&

1262 (
r
->
´oûs£d_by‹s
 + 
Ën
)/
£rv”
.
lßdšg_´oûss_ev’ts_š‹rv®_by‹s
 >„->processed_bytes/server.loading_process_events_interval_bytes)

1267 
	`upd©eCachedTime
();

1268 ià(
£rv”
.
ma¡”ho¡
 && s”v”.
»¶_¡©e
 =ğ
REPL_STATE_TRANSFER
)

1269 
	`»¶iÿtiÚS’dNewlšeToMa¡”
();

1270 
	`lßdšgProg»ss
(
r
->
´oûs£d_by‹s
);

1271 
	`´oûssEv’tsWheBlocked
();

1273 
	}
}

1275 
	$rdbLßd
(*
f’ame
) {

1276 
ušt32_t
 
dbid
;

1277 
ty³
, 
rdbv”
;

1278 
»disDb
 *
db
 = 
£rv”
.db+0;

1279 
buf
[1024];

1280 
expœ‘ime
, 
now
 = 
	`m¡ime
();

1281 
FILE
 *
å
;

1282 
rio
 
rdb
;

1284 ià((
å
 = 
	`fİ’
(
f’ame
,"r")è=ğ
NULL
è 
C_ERR
;

1286 
	`rioIn™W™hFe
(&
rdb
,
å
);

1287 
rdb
.
upd©e_cksum
 = 
rdbLßdProg»ssC®lback
;

1288 
rdb
.
max_´oûssšg_chunk
 = 
£rv”
.
lßdšg_´oûss_ev’ts_š‹rv®_by‹s
;

1289 ià(
	`rioR—d
(&
rdb
,
buf
,9è=ğ0è
eoã¼
;

1290 
buf
[9] = '\0';

1291 ià(
	`memcmp
(
buf
,"REDIS",5) != 0) {

1292 
	`fşo£
(
å
);

1293 
	`£rv”Log
(
LL_WARNING
,"Wrong signatureryingo†oad DB from file");

1294 
”ºo
 = 
EINVAL
;

1295  
C_ERR
;

1297 
rdbv”
 = 
	`©oi
(
buf
+5);

1298 ià(
rdbv”
 < 1 ||„dbv” > 
RDB_VERSION
) {

1299 
	`fşo£
(
å
);

1300 
	`£rv”Log
(
LL_WARNING
,"Cª'ˆhªdË RDB fÜm© v”siÚ %d",
rdbv”
);

1301 
”ºo
 = 
EINVAL
;

1302  
C_ERR
;

1305 
	`¡¬tLßdšg
(
å
);

1307 
robj
 *
key
, *
v®
;

1308 
expœ‘ime
 = -1;

1311 ià((
ty³
 = 
	`rdbLßdTy³
(&
rdb
)è=ğ-1è
eoã¼
;

1314 ià(
ty³
 =ğ
RDB_OPCODE_EXPIRETIME
) {

1318 ià((
expœ‘ime
 = 
	`rdbLßdTime
(&
rdb
)è=ğ-1è
eoã¼
;

1320 ià((
ty³
 = 
	`rdbLßdTy³
(&
rdb
)è=ğ-1è
eoã¼
;

1323 
expœ‘ime
 *= 1000;

1324 } ià(
ty³
 =ğ
RDB_OPCODE_EXPIRETIME_MS
) {

1327 ià((
expœ‘ime
 = 
	`rdbLßdMli£cÚdTime
(&
rdb
)è=ğ-1è
eoã¼
;

1329 ià((
ty³
 = 
	`rdbLßdTy³
(&
rdb
)è=ğ-1è
eoã¼
;

1330 } ià(
ty³
 =ğ
RDB_OPCODE_EOF
) {

1333 } ià(
ty³
 =ğ
RDB_OPCODE_SELECTDB
) {

1335 ià((
dbid
 = 
	`rdbLßdL’
(&
rdb
,
NULL
)è=ğ
RDB_LENERR
)

1336 
eoã¼
;

1337 ià(
dbid
 >ğ()
£rv”
.
dbnum
) {

1338 
	`£rv”Log
(
LL_WARNING
,

1341 "d©aba£s. Ex™šg\n", 
£rv”
.
dbnum
);

1342 
	`ex™
(1);

1344 
db
 = 
£rv”
.db+
dbid
;

1346 } ià(
ty³
 =ğ
RDB_OPCODE_RESIZEDB
) {

1349 
ušt32_t
 
db_size
, 
expœes_size
;

1350 ià((
db_size
 = 
	`rdbLßdL’
(&
rdb
,
NULL
)è=ğ
RDB_LENERR
)

1351 
eoã¼
;

1352 ià((
expœes_size
 = 
	`rdbLßdL’
(&
rdb
,
NULL
)è=ğ
RDB_LENERR
)

1353 
eoã¼
;

1354 
	`diùEx·nd
(
db
->
diù
,
db_size
);

1355 
	`diùEx·nd
(
db
->
expœes
,
expœes_size
);

1357 } ià(
ty³
 =ğ
RDB_OPCODE_AUX
) {

1363 
robj
 *
auxkey
, *
auxv®
;

1364 ià((
auxkey
 = 
	`rdbLßdSŒšgObjeù
(&
rdb
)è=ğ
NULL
è
eoã¼
;

1365 ià((
auxv®
 = 
	`rdbLßdSŒšgObjeù
(&
rdb
)è=ğ
NULL
è
eoã¼
;

1367 ià(((*)
auxkey
->
±r
)[0] == '%') {

1371 
	`£rv”Log
(
LL_NOTICE
,"RDB '%s': %s",

1372 (*)
auxkey
->
±r
,

1373 (*)
auxv®
->
±r
);

1377 
	`£rv”Log
(
LL_DEBUG
,"Unrecognized RDB AUX field: '%s'",

1378 (*)
auxkey
->
±r
);

1381 
	`deüRefCouÁ
(
auxkey
);

1382 
	`deüRefCouÁ
(
auxv®
);

1387 ià((
key
 = 
	`rdbLßdSŒšgObjeù
(&
rdb
)è=ğ
NULL
è
eoã¼
;

1389 ià((
v®
 = 
	`rdbLßdObjeù
(
ty³
,&
rdb
)è=ğ
NULL
è
eoã¼
;

1395 ià(
£rv”
.
ma¡”ho¡
 =ğ
NULL
 && 
expœ‘ime
 !ğ-1 &&ƒxpœ‘im< 
now
) {

1396 
	`deüRefCouÁ
(
key
);

1397 
	`deüRefCouÁ
(
v®
);

1401 
	`dbAdd
(
db
,
key
,
v®
);

1404 ià(
expœ‘ime
 !ğ-1è
	`£tExpœe
(
db
,
key
,expiretime);

1406 
	`deüRefCouÁ
(
key
);

1409 ià(
rdbv”
 >ğ5 && 
£rv”
.
rdb_checksum
) {

1410 
ušt64_t
 
cksum
, 
ex³ùed
 = 
rdb
.cksum;

1412 ià(
	`rioR—d
(&
rdb
,&
cksum
,8è=ğ0è
eoã¼
;

1413 
	`mem»v64ifbe
(&
cksum
);

1414 ià(
cksum
 == 0) {

1415 
	`£rv”Log
(
LL_WARNING
,"RDB file was saved with checksum disabled:‚o check…erformed.");

1416 } ià(
cksum
 !ğ
ex³ùed
) {

1417 
	`£rv”Log
(
LL_WARNING
,"Wrong RDB checksum. Aborting‚ow.");

1418 
	`rdbEx™R•ÜtCÜru±RDB
("RDB CRCƒrror");

1422 
	`fşo£
(
å
);

1423 
	`¡İLßdšg
();

1424  
C_OK
;

1426 
eoã¼
:

1427 
	`£rv”Log
(
LL_WARNING
,"Short„ead or OOM†oading DB. Unrecoverableƒrror,‡borting‚ow.");

1428 
	`rdbEx™R•ÜtCÜru±RDB
("Unexpected EOF„eading RDB file");

1429  
C_ERR
;

1430 
	}
}

1434 
	$backgroundSaveDÚeHªdËrDisk
(
ex™code
, 
bysigÇl
) {

1435 ià(!
bysigÇl
 && 
ex™code
 == 0) {

1436 
	`£rv”Log
(
LL_NOTICE
,

1438 
£rv”
.
dœty
 = s”v”.dœty - s”v”.
dœty_befÜe_bg§ve
;

1439 
£rv”
.
Ï¡§ve
 = 
	`time
(
NULL
);

1440 
£rv”
.
Ï¡bg§ve_¡©us
 = 
C_OK
;

1441 } ià(!
bysigÇl
 && 
ex™code
 != 0) {

1442 
	`£rv”Log
(
LL_WARNING
, "Background savingƒrror");

1443 
£rv”
.
Ï¡bg§ve_¡©us
 = 
C_ERR
;

1445 
m¡ime_t
 
Ï‹ncy
;

1447 
	`£rv”Log
(
LL_WARNING
,

1448 "Background savšg”mš©ed by sigÇÈ%d", 
bysigÇl
);

1449 
	`Ï‹ncyS¹MÚ™Ü
(
Ï‹ncy
);

1450 
	`rdbRemoveTempFe
(
£rv”
.
rdb_chd_pid
);

1451 
	`Ï‹ncyEndMÚ™Ü
(
Ï‹ncy
);

1452 
	`Ï‹ncyAddSam¶eIfN“ded
("rdb-uÆšk-‹mp-fe",
Ï‹ncy
);

1455 ià(
bysigÇl
 !ğ
SIGUSR1
)

1456 
£rv”
.
Ï¡bg§ve_¡©us
 = 
C_ERR
;

1458 
£rv”
.
rdb_chd_pid
 = -1;

1459 
£rv”
.
rdb_chd_ty³
 = 
RDB_CHILD_TYPE_NONE
;

1460 
£rv”
.
rdb_§ve_time_Ï¡
 = 
	`time
(
NULL
)-£rv”.
rdb_§ve_time_¡¬t
;

1461 
£rv”
.
rdb_§ve_time_¡¬t
 = -1;

1464 
	`upd©eSÏvesWa™šgBg§ve
((!
bysigÇl
 && 
ex™code
 =ğ0è? 
C_OK
 : 
C_ERR
, 
RDB_CHILD_TYPE_DISK
);

1465 
	}
}

1470 
	$backgroundSaveDÚeHªdËrSock‘
(
ex™code
, 
bysigÇl
) {

1471 
ušt64_t
 *
ok_¦aves
;

1473 ià(!
bysigÇl
 && 
ex™code
 == 0) {

1474 
	`£rv”Log
(
LL_NOTICE
,

1476 } ià(!
bysigÇl
 && 
ex™code
 != 0) {

1477 
	`£rv”Log
(
LL_WARNING
, "Backgroundransferƒrror");

1479 
	`£rv”Log
(
LL_WARNING
,

1480 "Background¿nsã¸‹rmš©ed by sigÇÈ%d", 
bysigÇl
);

1482 
£rv”
.
rdb_chd_pid
 = -1;

1483 
£rv”
.
rdb_chd_ty³
 = 
RDB_CHILD_TYPE_NONE
;

1484 
£rv”
.
rdb_§ve_time_¡¬t
 = -1;

1493 
ok_¦aves
 = 
	`zm®loc
((
ušt64_t
));

1494 
ok_¦aves
[0] = 0;

1495 ià(!
bysigÇl
 && 
ex™code
 == 0) {

1496 
»adËn
 = (
ušt64_t
);

1498 ià(
	`»ad
(
£rv”
.
rdb_pe_»ad_»suÉ_äom_chd
, 
ok_¦aves
, 
»adËn
) ==

1499 
»adËn
)

1501 
»adËn
 = 
ok_¦aves
[0]*(
ušt64_t
)*2;

1505 
ok_¦aves
 = 
	`z»®loc
(ok_¦aves,(
ušt64_t
)+
»adËn
);

1506 ià(
»adËn
 &&

1507 
	`»ad
(
£rv”
.
rdb_pe_»ad_»suÉ_äom_chd
, 
ok_¦aves
+1,

1508 
»adËn
) !=„eadlen)

1510 
ok_¦aves
[0] = 0;

1515 
	`şo£
(
£rv”
.
rdb_pe_»ad_»suÉ_äom_chd
);

1516 
	`şo£
(
£rv”
.
rdb_pe_wr™e_»suÉ_to_·»Á
);

1520 
li¡Node
 *
Ê
;

1521 
li¡I‹r
 
li
;

1523 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

1524 (
Ê
 = 
	`li¡Next
(&
li
))) {

1525 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

1527 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_END
) {

1528 
ušt64_t
 
j
;

1529 
”rÜcode
 = 0;

1534 
j
 = 0; j < 
ok_¦aves
[0]; j++) {

1535 ià(
¦ave
->
id
 =ğ
ok_¦aves
[2*
j
+1]) {

1536 
”rÜcode
 = 
ok_¦aves
[2*
j
+2];

1540 ià(
j
 =ğ
ok_¦aves
[0] || 
”rÜcode
 != 0) {

1541 
	`£rv”Log
(
LL_WARNING
,

1543 
	`»¶iÿtiÚG‘SÏveName
(
¦ave
),

1544 (
”rÜcode
 == 0) ? "RDBransfer child‡borted"

1545 : 
	`¡»¼Ü
(
”rÜcode
));

1546 
	`ä“Cl›Á
(
¦ave
);

1548 
	`£rv”Log
(
LL_WARNING
,

1550 
	`»¶iÿtiÚG‘SÏveName
(
¦ave
));

1552 
	`ª‘NÚBlock
(
NULL
,
¦ave
->
fd
);

1553 
	`ª‘S’dTimeout
(
NULL
,
¦ave
->
fd
,0);

1557 
	`zä“
(
ok_¦aves
);

1559 
	`upd©eSÏvesWa™šgBg§ve
((!
bysigÇl
 && 
ex™code
 =ğ0è? 
C_OK
 : 
C_ERR
, 
RDB_CHILD_TYPE_SOCKET
);

1560 
	}
}

1563 
	$backgroundSaveDÚeHªdËr
(
ex™code
, 
bysigÇl
) {

1564 
£rv”
.
rdb_chd_ty³
) {

1565 
RDB_CHILD_TYPE_DISK
:

1566 
	`backgroundSaveDÚeHªdËrDisk
(
ex™code
,
bysigÇl
);

1568 
RDB_CHILD_TYPE_SOCKET
:

1569 
	`backgroundSaveDÚeHªdËrSock‘
(
ex™code
,
bysigÇl
);

1572 
	`£rv”Pªic
("Unknown RDB childype.");

1575 
	}
}

1579 
	$rdbSaveToSÏvesSock‘s
() {

1580 *
fds
;

1581 
ušt64_t
 *
ş›Áids
;

1582 
numfds
;

1583 
li¡Node
 *
Ê
;

1584 
li¡I‹r
 
li
;

1585 
pid_t
 
chdpid
;

1586 
¡¬t
;

1587 
pefds
[2];

1589 ià(
£rv”
.
aof_chd_pid
 !ğ-1 || s”v”.
rdb_chd_pid
 !ğ-1è 
C_ERR
;

1594 ià(
	`pe
(
pefds
è=ğ-1è 
C_ERR
;

1595 
£rv”
.
rdb_pe_»ad_»suÉ_äom_chd
 = 
pefds
[0];

1596 
£rv”
.
rdb_pe_wr™e_»suÉ_to_·»Á
 = 
pefds
[1];

1600 
fds
 = 
	`zm®loc
(()*
	`li¡L’gth
(
£rv”
.
¦aves
));

1604 
ş›Áids
 = 
	`zm®loc
((
ušt64_t
)*
	`li¡L’gth
(
£rv”
.
¦aves
));

1605 
numfds
 = 0;

1607 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

1608 (
Ê
 = 
	`li¡Next
(&
li
))) {

1609 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

1611 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_START
) {

1612 
ş›Áids
[
numfds
] = 
¦ave
->
id
;

1613 
fds
[
numfds
++] = 
¦ave
->
fd
;

1614 
	`»¶iÿtiÚS‘upSÏveFÜFuÎResync
(
¦ave
,
	`g‘PsyncIn™ŸlOff£t
());

1618 
	`ª‘Block
(
NULL
,
¦ave
->
fd
);

1619 
	`ª‘S’dTimeout
(
NULL
,
¦ave
->
fd
,
£rv”
.
»¶_timeout
*1000);

1624 
¡¬t
 = 
	`u¡ime
();

1625 ià((
chdpid
 = 
	`fÜk
()) == 0) {

1627 
»tv®
;

1628 
rio
 
¦ave_sock‘s
;

1630 
	`rioIn™W™hFd£t
(&
¦ave_sock‘s
,
fds
,
numfds
);

1631 
	`zä“
(
fds
);

1633 
	`şo£Li¡’šgSock‘s
(0);

1634 
	`»disS‘ProcT™Ë
("redis-rdb-to-slaves");

1636 
»tv®
 = 
	`rdbSaveRioW™hEOFM¬k
(&
¦ave_sock‘s
,
NULL
);

1637 ià(
»tv®
 =ğ
C_OK
 && 
	`rioFlush
(&
¦ave_sock‘s
) == 0)

1638 
»tv®
 = 
C_ERR
;

1640 ià(
»tv®
 =ğ
C_OK
) {

1641 
size_t
 
´iv©e_dœty
 = 
	`zm®loc_g‘_´iv©e_dœty
();

1643 ià(
´iv©e_dœty
) {

1644 
	`£rv”Log
(
LL_NOTICE
,

1646 
´iv©e_dœty
/(1024*1024));

1664 *
msg
 = 
	`zm®loc
((
ušt64_t
)*(1+2*
numfds
));

1665 
ušt64_t
 *
Ën
 = 
msg
;

1666 
ušt64_t
 *
ids
 = 
Ën
+1;

1667 
j
, 
msgËn
;

1669 *
Ën
 = 
numfds
;

1670 
j
 = 0; j < 
numfds
; j++) {

1671 *
ids
++ = 
ş›Áids
[
j
];

1672 *
ids
++ = 
¦ave_sock‘s
.
io
.
fd£t
.
¡©e
[
j
];

1679 
msgËn
 = (
ušt64_t
)*(1+2*
numfds
);

1680 ià(*
Ën
 == 0 ||

1681 
	`wr™e
(
£rv”
.
rdb_pe_wr™e_»suÉ_to_·»Á
,
msg
,
msgËn
)

1682 !ğ
msgËn
)

1684 
»tv®
 = 
C_ERR
;

1686 
	`zä“
(
msg
);

1688 
	`zä“
(
ş›Áids
);

1689 
	`rioF»eFd£t
(&
¦ave_sock‘s
);

1690 
	`ex™FromChd
((
»tv®
 =ğ
C_OK
) ? 0 : 1);

1693 
£rv”
.
¡©_fÜk_time
 = 
	`u¡ime
()-
¡¬t
;

1694 
£rv”
.
¡©_fÜk_¿‹
 = (è
	`zm®loc_u£d_memÜy
(è* 1000000 / s”v”.
¡©_fÜk_time
 / (1024*1024*1024);

1695 
	`Ï‹ncyAddSam¶eIfN“ded
("fÜk",
£rv”
.
¡©_fÜk_time
/1000);

1696 ià(
chdpid
 == -1) {

1697 
	`£rv”Log
(
LL_WARNING
,"Can't save in background: fork: %s",

1698 
	`¡»¼Ü
(
”ºo
));

1703 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

1704 (
Ê
 = 
	`li¡Next
(&
li
))) {

1705 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

1706 
j
;

1708 
j
 = 0; j < 
numfds
; j++) {

1709 ià(
¦ave
->
id
 =ğ
ş›Áids
[
j
]) {

1710 
¦ave
->
»¶¡©e
 = 
SLAVE_STATE_WAIT_BGSAVE_START
;

1715 
	`şo£
(
pefds
[0]);

1716 
	`şo£
(
pefds
[1]);

1718 
	`£rv”Log
(
LL_NOTICE
,"Background RDBransfer started by…id %d",

1719 
chdpid
);

1720 
£rv”
.
rdb_§ve_time_¡¬t
 = 
	`time
(
NULL
);

1721 
£rv”
.
rdb_chd_pid
 = 
chdpid
;

1722 
£rv”
.
rdb_chd_ty³
 = 
RDB_CHILD_TYPE_SOCKET
;

1723 
	`upd©eDiùResizePŞicy
();

1725 
	`zä“
(
ş›Áids
);

1726 
	`zä“
(
fds
);

1727  (
chdpid
 =ğ-1è? 
C_ERR
 : 
C_OK
;

1729  
C_OK
;

1730 
	}
}

1732 
	$§veCommªd
(
ş›Á
 *
c
) {

1733 ià(
£rv”
.
rdb_chd_pid
 != -1) {

1734 
	`addR•lyE¼Ü
(
c
,"Background save‡lready in…rogress");

1737 ià(
	`rdbSave
(
£rv”
.
rdb_f’ame
è=ğ
C_OK
) {

1738 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1740 
	`addR•ly
(
c
,
sh¬ed
.
”r
);

1742 
	}
}

1745 
	$bg§veCommªd
(
ş›Á
 *
c
) {

1746 
scheduË
 = 0;

1750 ià(
c
->
¬gc
 > 1) {

1751 ià(
c
->
¬gc
 =ğ2 && !
	`¡rÿ£cmp
(c->
¬gv
[1]->
±r
,"schedule")) {

1752 
scheduË
 = 1;

1754 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

1759 ià(
£rv”
.
rdb_chd_pid
 != -1) {

1760 
	`addR•lyE¼Ü
(
c
,"Background save‡lready in…rogress");

1761 } ià(
£rv”
.
aof_chd_pid
 != -1) {

1762 ià(
scheduË
) {

1763 
£rv”
.
rdb_bg§ve_scheduËd
 = 1;

1764 
	`addR•lyStus
(
c
,"Background saving scheduled");

1766 
	`addR•lyE¼Ü
(
c
,

1771 } ià(
	`rdbSaveBackground
(
£rv”
.
rdb_f’ame
è=ğ
C_OK
) {

1772 
	`addR•lyStus
(
c
,"Background saving started");

1774 
	`addR•ly
(
c
,
sh¬ed
.
”r
);

1776 
	}
}

	@src/rdb.h

30 #iâdeà
__RDB_H


31 
	#__RDB_H


	)

33 
	~<¡dio.h
>

34 
	~"rio.h
"

37 
	~"£rv”.h
"

41 
	#RDB_VERSION
 7

	)

56 
	#RDB_6BITLEN
 0

	)

57 
	#RDB_14BITLEN
 1

	)

58 
	#RDB_32BITLEN
 2

	)

59 
	#RDB_ENCVAL
 3

	)

60 
	#RDB_LENERR
 
UINT_MAX


	)

65 
	#RDB_ENC_INT8
 0

	)

66 
	#RDB_ENC_INT16
 1

	)

67 
	#RDB_ENC_INT32
 2

	)

68 
	#RDB_ENC_LZF
 3

	)

72 
	#RDB_TYPE_STRING
 0

	)

73 
	#RDB_TYPE_LIST
 1

	)

74 
	#RDB_TYPE_SET
 2

	)

75 
	#RDB_TYPE_ZSET
 3

	)

76 
	#RDB_TYPE_HASH
 4

	)

80 
	#RDB_TYPE_HASH_ZIPMAP
 9

	)

81 
	#RDB_TYPE_LIST_ZIPLIST
 10

	)

82 
	#RDB_TYPE_SET_INTSET
 11

	)

83 
	#RDB_TYPE_ZSET_ZIPLIST
 12

	)

84 
	#RDB_TYPE_HASH_ZIPLIST
 13

	)

85 
	#RDB_TYPE_LIST_QUICKLIST
 14

	)

89 
	#rdbIsObjeùTy³
(
t
è(Ñ >ğ0 && <ğ4è|| (ˆ>ğ9 && <ğ14))

	)

92 
	#RDB_OPCODE_AUX
 250

	)

93 
	#RDB_OPCODE_RESIZEDB
 251

	)

94 
	#RDB_OPCODE_EXPIRETIME_MS
 252

	)

95 
	#RDB_OPCODE_EXPIRETIME
 253

	)

96 
	#RDB_OPCODE_SELECTDB
 254

	)

97 
	#RDB_OPCODE_EOF
 255

	)

99 
rdbSaveTy³
(
rio
 *
rdb
, 
ty³
);

100 
rdbLßdTy³
(
rio
 *
rdb
);

101 
rdbSaveTime
(
rio
 *
rdb
, 
time_t
 
t
);

102 
time_t
 
rdbLßdTime
(
rio
 *
rdb
);

103 
rdbSaveL’
(
rio
 *
rdb
, 
ušt32_t
 
Ën
);

104 
ušt32_t
 
rdbLßdL’
(
rio
 *
rdb
, *
i£ncoded
);

105 
rdbSaveObjeùTy³
(
rio
 *
rdb
, 
robj
 *
o
);

106 
rdbLßdObjeùTy³
(
rio
 *
rdb
);

107 
rdbLßd
(*
f’ame
);

108 
rdbSaveBackground
(*
f’ame
);

109 
rdbSaveToSÏvesSock‘s
();

110 
rdbRemoveTempFe
(
pid_t
 
chdpid
);

111 
rdbSave
(*
f’ame
);

112 
ssize_t
 
rdbSaveObjeù
(
rio
 *
rdb
, 
robj
 *
o
);

113 
size_t
 
rdbSavedObjeùL’
(
robj
 *
o
);

114 
robj
 *
rdbLßdObjeù
(
ty³
, 
rio
 *
rdb
);

115 
backgroundSaveDÚeHªdËr
(
ex™code
, 
bysigÇl
);

116 
rdbSaveKeyV®uePaœ
(
rio
 *
rdb
, 
robj
 *
key
,„obj *
v®
, 
expœ‘ime
, 
now
);

117 
robj
 *
rdbLßdSŒšgObjeù
(
rio
 *
rdb
);

	@src/redis-benchmark.c

31 
	~"fmaüos.h
"

33 
	~<¡dio.h
>

34 
	~<¡ršg.h
>

35 
	~<¡dlib.h
>

36 
	~<uni¡d.h
>

37 
	~<”ºo.h
>

38 
	~<time.h
>

39 
	~<sys/time.h
>

40 
	~<sigÇl.h
>

41 
	~<as£¹.h
>

43 
	~<sds.h
>

44 
	~"«.h
"

45 
	~"hœedis.h
"

46 
	~"adli¡.h
"

47 
	~"zm®loc.h
"

49 
	#UNUSED
(
V
è((èV)

	)

50 
	#RANDPTR_INITIAL_SIZE
 8

	)

52 
	scÚfig
 {

53 
«Ev’tLoİ
 *
	m–
;

54 cÚ¡ *
	mho¡
;

55 
	mho¡pÜt
;

56 cÚ¡ *
	mho¡sock‘
;

57 
	mnumş›Ás
;

58 
	mliveş›Ás
;

59 
	m»que¡s
;

60 
	m»que¡s_issued
;

61 
	m»que¡s_fšished
;

62 
	mkeysize
;

63 
	md©asize
;

64 
	m¿ndomkeys
;

65 
	m¿ndomkeys_key¥aûËn
;

66 
	mk“·live
;

67 
	mp–še
;

68 
	mshow”rÜs
;

69 
	m¡¬t
;

70 
	mtÙÏ‹ncy
;

71 *
	mÏ‹ncy
;

72 cÚ¡ *
	mt™Ë
;

73 
li¡
 *
	mş›Ás
;

74 
	mqu›t
;

75 
	mcsv
;

76 
	mloİ
;

77 
	midËmode
;

78 
	mdbnum
;

79 
sds
 
	mdbnum¡r
;

80 *
	m‹¡s
;

81 *
	mauth
;

82 } 
	gcÚfig
;

84 
	s_ş›Á
 {

85 
»disCÚ‹xt
 *
	mcÚ‹xt
;

86 
sds
 
	mobuf
;

87 **
	m¿nd±r
;

88 
size_t
 
	m¿ndËn
;

89 
size_t
 
	m¿ndä“
;

90 
size_t
 
	mwr™‹n
;

91 
	m¡¬t
;

92 
	mÏ‹ncy
;

93 
	m³ndšg
;

94 
	m´efix_³ndšg
;

97 
	m´efixËn
;

98 } *
	tş›Á
;

101 
wr™eHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
);

102 
ü—‹MissšgCl›Ás
(
ş›Á
 
c
);

105 
	$u¡ime
() {

106 
timev®
 
tv
;

107 
u¡
;

109 
	`g‘timeofday
(&
tv
, 
NULL
);

110 
u¡
 = (()
tv
.
tv_£c
)*1000000;

111 
u¡
 +ğ
tv
.
tv_u£c
;

112  
u¡
;

113 
	}
}

115 
	$m¡ime
() {

116 
timev®
 
tv
;

117 
m¡
;

119 
	`g‘timeofday
(&
tv
, 
NULL
);

120 
m¡
 = (()
tv
.
tv_£c
)*1000;

121 
m¡
 +ğ
tv
.
tv_u£c
/1000;

122  
m¡
;

123 
	}
}

125 
	$ä“Cl›Á
(
ş›Á
 
c
) {

126 
li¡Node
 *
Ê
;

127 
	`«D–‘eFeEv’t
(
cÚfig
.
–
,
c
->
cÚ‹xt
->
fd
,
AE_WRITABLE
);

128 
	`«D–‘eFeEv’t
(
cÚfig
.
–
,
c
->
cÚ‹xt
->
fd
,
AE_READABLE
);

129 
	`»disF»e
(
c
->
cÚ‹xt
);

130 
	`sdsä“
(
c
->
obuf
);

131 
	`zä“
(
c
->
¿nd±r
);

132 
	`zä“
(
c
);

133 
cÚfig
.
liveş›Ás
--;

134 
Ê
 = 
	`li¡S—rchKey
(
cÚfig
.
ş›Ás
,
c
);

135 
	`as£¹
(
Ê
 !ğ
NULL
);

136 
	`li¡D–Node
(
cÚfig
.
ş›Ás
,
Ê
);

137 
	}
}

139 
	$ä“AÎCl›Ás
() {

140 
li¡Node
 *
Ê
 = 
cÚfig
.
ş›Ás
->
h—d
, *
Ãxt
;

142 
Ê
) {

143 
Ãxt
 = 
Ê
->next;

144 
	`ä“Cl›Á
(
Ê
->
v®ue
);

145 
Ê
 = 
Ãxt
;

147 
	}
}

149 
	$»£tCl›Á
(
ş›Á
 
c
) {

150 
	`«D–‘eFeEv’t
(
cÚfig
.
–
,
c
->
cÚ‹xt
->
fd
,
AE_WRITABLE
);

151 
	`«D–‘eFeEv’t
(
cÚfig
.
–
,
c
->
cÚ‹xt
->
fd
,
AE_READABLE
);

152 
	`«C»©eFeEv’t
(
cÚfig
.
–
,
c
->
cÚ‹xt
->
fd
,
AE_WRITABLE
,
wr™eHªdËr
,c);

153 
c
->
wr™‹n
 = 0;

154 
c
->
³ndšg
 = 
cÚfig
.
p–še
;

155 
	}
}

157 
	$¿ndomizeCl›ÁKey
(
ş›Á
 
c
) {

158 
size_t
 
i
;

160 
i
 = 0; i < 
c
->
¿ndËn
; i++) {

161 *
p
 = 
c
->
¿nd±r
[
i
]+11;

162 
size_t
 
r
 = 
	`¿ndom
(è% 
cÚfig
.
¿ndomkeys_key¥aûËn
;

163 
size_t
 
j
;

165 
j
 = 0; j < 12; j++) {

166 *
p
 = '0'+
r
%10;

167 
r
/=10;

168 
p
--;

171 
	}
}

173 
	$ş›ÁDÚe
(
ş›Á
 
c
) {

174 ià(
cÚfig
.
»que¡s_fšished
 =ğcÚfig.
»que¡s
) {

175 
	`ä“Cl›Á
(
c
);

176 
	`«Stİ
(
cÚfig
.
–
);

179 ià(
cÚfig
.
k“·live
) {

180 
	`»£tCl›Á
(
c
);

182 
cÚfig
.
liveş›Ás
--;

183 
	`ü—‹MissšgCl›Ás
(
c
);

184 
cÚfig
.
liveş›Ás
++;

185 
	`ä“Cl›Á
(
c
);

187 
	}
}

189 
	$»adHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

190 
ş›Á
 
c
 = 
´ivd©a
;

191 *
»¶y
 = 
NULL
;

192 
	`UNUSED
(
–
);

193 
	`UNUSED
(
fd
);

194 
	`UNUSED
(
mask
);

199 ià(
c
->
Ï‹ncy
 < 0èc->Ï‹ncy = 
	`u¡ime
()-(c->
¡¬t
);

201 ià(
	`»disBufãrR—d
(
c
->
cÚ‹xt
è!ğ
REDIS_OK
) {

202 
	`årštf
(
¡d”r
,"E¼Ü: %s\n",
c
->
cÚ‹xt
->
”r¡r
);

203 
	`ex™
(1);

205 
c
->
³ndšg
) {

206 ià(
	`»disG‘R•ly
(
c
->
cÚ‹xt
,&
»¶y
è!ğ
REDIS_OK
) {

207 
	`årštf
(
¡d”r
,"E¼Ü: %s\n",
c
->
cÚ‹xt
->
”r¡r
);

208 
	`ex™
(1);

210 ià(
»¶y
 !ğ
NULL
) {

211 ià(
»¶y
 =ğ(*)
REDIS_REPLY_ERROR
) {

212 
	`årštf
(
¡d”r
,"Unexpectedƒrror„eply,ƒxiting...\n");

213 
	`ex™
(1);

216 ià(
cÚfig
.
show”rÜs
) {

217 
time_t
 
Ï¡”r_time
 = 0;

218 
time_t
 
now
 = 
	`time
(
NULL
);

219 
»disR•ly
 *
r
 = 
»¶y
;

220 ià(
r
->
ty³
 =ğ
REDIS_REPLY_ERROR
 && 
Ï¡”r_time
 !ğ
now
) {

221 
Ï¡”r_time
 = 
now
;

222 
	`´štf
("E¼Ü from s”v”: %s\n", 
r
->
¡r
);

226 
	`ä“R•lyObjeù
(
»¶y
);

228 ià(
c
->
´efix_³ndšg
 > 0) {

229 
c
->
´efix_³ndšg
--;

230 
c
->
³ndšg
--;

232 ià(
c
->
´efixËn
 > 0) {

233 
size_t
 
j
;

234 
	`sd¤ªge
(
c
->
obuf
, c->
´efixËn
, -1);

237 
j
 = 0; j < 
c
->
¿ndËn
; j++)

238 
c
->
¿nd±r
[
j
] -ğc->
´efixËn
;

239 
c
->
´efixËn
 = 0;

244 ià(
cÚfig
.
»que¡s_fšished
 < cÚfig.
»que¡s
)

245 
cÚfig
.
Ï‹ncy
[cÚfig.
»que¡s_fšished
++] = 
c
->latency;

246 
c
->
³ndšg
--;

247 ià(
c
->
³ndšg
 == 0) {

248 
	`ş›ÁDÚe
(
c
);

256 
	}
}

258 
	$wr™eHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

259 
ş›Á
 
c
 = 
´ivd©a
;

260 
	`UNUSED
(
–
);

261 
	`UNUSED
(
fd
);

262 
	`UNUSED
(
mask
);

265 ià(
c
->
wr™‹n
 == 0) {

267 ià(
cÚfig
.
»que¡s_issued
++ >ğcÚfig.
»que¡s
) {

268 
	`ä“Cl›Á
(
c
);

273 ià(
cÚfig
.
¿ndomkeys
è
	`¿ndomizeCl›ÁKey
(
c
);

274 
c
->
¡¬t
 = 
	`u¡ime
();

275 
c
->
Ï‹ncy
 = -1;

278 ià(
	`sd¦’
(
c
->
obuf
è> c->
wr™‹n
) {

279 *
±r
 = 
c
->
obuf
+c->
wr™‹n
;

280 
ssize_t
 
nwr™‹n
 = 
	`wr™e
(
c
->
cÚ‹xt
->
fd
,
±r
,
	`sd¦’
(c->
obuf
)-c->
wr™‹n
);

281 ià(
nwr™‹n
 == -1) {

282 ià(
”ºo
 !ğ
EPIPE
)

283 
	`årštf
(
¡d”r
, "Wr™šgØsock‘: %s\n", 
	`¡»¼Ü
(
”ºo
));

284 
	`ä“Cl›Á
(
c
);

287 
c
->
wr™‹n
 +ğ
nwr™‹n
;

288 ià(
	`sd¦’
(
c
->
obuf
è=ğc->
wr™‹n
) {

289 
	`«D–‘eFeEv’t
(
cÚfig
.
–
,
c
->
cÚ‹xt
->
fd
,
AE_WRITABLE
);

290 
	`«C»©eFeEv’t
(
cÚfig
.
–
,
c
->
cÚ‹xt
->
fd
,
AE_READABLE
,
»adHªdËr
,c);

293 
	}
}

316 
ş›Á
 
	$ü—‹Cl›Á
(*
cmd
, 
size_t
 
Ën
, 
ş›Á
 
äom
) {

317 
j
;

318 
ş›Á
 
c
 = 
	`zm®loc
((
_ş›Á
));

320 ià(
cÚfig
.
ho¡sock‘
 =ğ
NULL
) {

321 
c
->
cÚ‹xt
 = 
	`»disCÚÃùNÚBlock
(
cÚfig
.
ho¡
,cÚfig.
ho¡pÜt
);

323 
c
->
cÚ‹xt
 = 
	`»disCÚÃùUnixNÚBlock
(
cÚfig
.
ho¡sock‘
);

325 ià(
c
->
cÚ‹xt
->
”r
) {

326 
	`årštf
(
¡d”r
,"Could‚ot connecto Redis‡t ");

327 ià(
cÚfig
.
ho¡sock‘
 =ğ
NULL
)

328 
	`årštf
(
¡d”r
,"%s:%d: %s\n",
cÚfig
.
ho¡
,cÚfig.
ho¡pÜt
,
c
->
cÚ‹xt
->
”r¡r
);

330 
	`årštf
(
¡d”r
,"%s: %s\n",
cÚfig
.
ho¡sock‘
,
c
->
cÚ‹xt
->
”r¡r
);

331 
	`ex™
(1);

334 
c
->
cÚ‹xt
->
»ad”
->
maxbuf
 = 0;

339 
c
->
obuf
 = 
	`sd£m±y
();

343 
c
->
´efix_³ndšg
 = 0;

344 ià(
cÚfig
.
auth
) {

345 *
buf
 = 
NULL
;

346 
Ën
 = 
	`»disFÜm©Commªd
(&
buf
, "AUTH %s", 
cÚfig
.
auth
);

347 
c
->
obuf
 = 
	`sdsÿ’
(c->obuf, 
buf
, 
Ën
);

348 
	`ä“
(
buf
);

349 
c
->
´efix_³ndšg
++;

356 ià(
cÚfig
.
dbnum
 != 0) {

357 
c
->
obuf
 = 
	`sdsÿrštf
(c->obuf,"*2\r\n$6\r\nSELECT\r\n$%d\r\n%s\r\n",

358 ()
	`sd¦’
(
cÚfig
.
dbnum¡r
),config.dbnumstr);

359 
c
->
´efix_³ndšg
++;

361 
c
->
´efixËn
 = 
	`sd¦’
(c->
obuf
);

363 ià(
äom
) {

364 
c
->
obuf
 = 
	`sdsÿ’
(c->obuf,

365 
äom
->
obuf
+äom->
´efixËn
,

366 
	`sd¦’
(
äom
->
obuf
)-äom->
´efixËn
);

368 
j
 = 0; j < 
cÚfig
.
p–še
; j++)

369 
c
->
obuf
 = 
	`sdsÿ’
(c->obuf,
cmd
,
Ën
);

372 
c
->
wr™‹n
 = 0;

373 
c
->
³ndšg
 = 
cÚfig
.
p–še
+c->
´efix_³ndšg
;

374 
c
->
¿nd±r
 = 
NULL
;

375 
c
->
¿ndËn
 = 0;

378 ià(
cÚfig
.
¿ndomkeys
) {

379 ià(
äom
) {

380 
c
->
¿ndËn
 = 
äom
->randlen;

381 
c
->
¿ndä“
 = 0;

382 
c
->
¿nd±r
 = 
	`zm®loc
((*)*c->
¿ndËn
);

384 
j
 = 0; j < ()
c
->
¿ndËn
; j++) {

385 
c
->
¿nd±r
[
j
] = c->
obuf
 + (
äom
->randptr[j]-from->obuf);

387 
c
->
¿nd±r
[
j
] +ğc->
´efixËn
 - 
äom
->prefixlen;

390 *
p
 = 
c
->
obuf
;

392 
c
->
¿ndËn
 = 0;

393 
c
->
¿ndä“
 = 
RANDPTR_INITIAL_SIZE
;

394 
c
->
¿nd±r
 = 
	`zm®loc
((*)*c->
¿ndä“
);

395 (
p
 = 
	`¡r¡r
Õ,"__¿nd_št__")è!ğ
NULL
) {

396 ià(
c
->
¿ndä“
 == 0) {

397 
c
->
¿nd±r
 = 
	`z»®loc
(c->¿nd±r,(*)*c->
¿ndËn
*2);

398 
c
->
¿ndä“
 +ğc->
¿ndËn
;

400 
c
->
¿nd±r
[c->
¿ndËn
++] = 
p
;

401 
c
->
¿ndä“
--;

402 
p
 += 12;

406 ià(
cÚfig
.
idËmode
 == 0)

407 
	`«C»©eFeEv’t
(
cÚfig
.
–
,
c
->
cÚ‹xt
->
fd
,
AE_WRITABLE
,
wr™eHªdËr
,c);

408 
	`li¡AddNodeTa
(
cÚfig
.
ş›Ás
,
c
);

409 
cÚfig
.
liveş›Ás
++;

410  
c
;

411 
	}
}

413 
	$ü—‹MissšgCl›Ás
(
ş›Á
 
c
) {

414 
n
 = 0;

416 
cÚfig
.
liveş›Ás
 < cÚfig.
numş›Ás
) {

417 
	`ü—‹Cl›Á
(
NULL
,0,
c
);

420 ià(++
n
 > 64) {

421 
	`u¦“p
(50000);

422 
n
 = 0;

425 
	}
}

427 
	$com·»L©’cy
(cÚ¡ *
a
, cÚ¡ *
b
) {

428  (*(*)
a
)-(*(*)
b
);

429 
	}
}

431 
	$showL©’cyR•Üt
() {

432 
i
, 
cu¾©
 = 0;

433 
³rc
, 
»q³r£c
;

435 
»q³r£c
 = ()
cÚfig
.
»que¡s_fšished
/(()cÚfig.
tÙÏ‹ncy
/1000);

436 ià(!
cÚfig
.
qu›t
 && !cÚfig.
csv
) {

437 
	`´štf
("=====ğ% ======\n", 
cÚfig
.
t™Ë
);

438 
	`´štf
(" %d„eque¡ com¶‘ed iÀ%.2à£cÚds\n", 
cÚfig
.
»que¡s_fšished
,

439 ()
cÚfig
.
tÙÏ‹ncy
/1000);

440 
	`´štf
(" %d…¬®ËÈş›Ás\n", 
cÚfig
.
numş›Ás
);

441 
	`´štf
(" %d by‹ ·ylßd\n", 
cÚfig
.
d©asize
);

442 
	`´štf
(" k“°®ive: %d\n", 
cÚfig
.
k“·live
);

443 
	`´štf
("\n");

445 
	`qsÜt
(
cÚfig
.
Ï‹ncy
,cÚfig.
»que¡s
,(),
com·»L©’cy
);

446 
i
 = 0; i < 
cÚfig
.
»que¡s
; i++) {

447 ià(
cÚfig
.
Ï‹ncy
[
i
]/1000 !ğ
cu¾©
 || i =ğ(cÚfig.
»que¡s
-1)) {

448 
cu¾©
 = 
cÚfig
.
Ï‹ncy
[
i
]/1000;

449 
³rc
 = (()(
i
+1)*100)/
cÚfig
.
»que¡s
;

450 
	`´štf
("%.2f%% <ğ%d mli£cÚds\n", 
³rc
, 
cu¾©
);

453 
	`´štf
("%.2à»que¡ ³¸£cÚd\n\n", 
»q³r£c
);

454 } ià(
cÚfig
.
csv
) {

455 
	`´štf
("\"%s\",\"%.2f\"\n", 
cÚfig
.
t™Ë
, 
»q³r£c
);

457 
	`´štf
("%s: %.2à»que¡ ³¸£cÚd\n", 
cÚfig
.
t™Ë
, 
»q³r£c
);

459 
	}
}

461 
	$b’chm¬k
(*
t™Ë
, *
cmd
, 
Ën
) {

462 
ş›Á
 
c
;

464 
cÚfig
.
t™Ë
 =itle;

465 
cÚfig
.
»que¡s_issued
 = 0;

466 
cÚfig
.
»que¡s_fšished
 = 0;

468 
c
 = 
	`ü—‹Cl›Á
(
cmd
,
Ën
,
NULL
);

469 
	`ü—‹MissšgCl›Ás
(
c
);

471 
cÚfig
.
¡¬t
 = 
	`m¡ime
();

472 
	`«Maš
(
cÚfig
.
–
);

473 
cÚfig
.
tÙÏ‹ncy
 = 
	`m¡ime
()-cÚfig.
¡¬t
;

475 
	`showL©’cyR•Üt
();

476 
	`ä“AÎCl›Ás
();

477 
	}
}

480 
	$·r£O±iÚs
(
¬gc
, cÚ¡ **
¬gv
) {

481 
i
;

482 
Ï¡¬g
;

483 
ex™_¡©us
 = 1;

485 
i
 = 1; i < 
¬gc
; i++) {

486 
Ï¡¬g
 = (
i
 =ğ(
¬gc
-1));

488 ià(!
	`¡rcmp
(
¬gv
[
i
],"-c")) {

489 ià(
Ï¡¬g
è
šv®id
;

490 
cÚfig
.
numş›Ás
 = 
	`©oi
(
¬gv
[++
i
]);

491 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-n")) {

492 ià(
Ï¡¬g
è
šv®id
;

493 
cÚfig
.
»que¡s
 = 
	`©oi
(
¬gv
[++
i
]);

494 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-k")) {

495 ià(
Ï¡¬g
è
šv®id
;

496 
cÚfig
.
k“·live
 = 
	`©oi
(
¬gv
[++
i
]);

497 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-h")) {

498 ià(
Ï¡¬g
è
šv®id
;

499 
cÚfig
.
ho¡
 = 
	`¡rdup
(
¬gv
[++
i
]);

500 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-p")) {

501 ià(
Ï¡¬g
è
šv®id
;

502 
cÚfig
.
ho¡pÜt
 = 
	`©oi
(
¬gv
[++
i
]);

503 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-s")) {

504 ià(
Ï¡¬g
è
šv®id
;

505 
cÚfig
.
ho¡sock‘
 = 
	`¡rdup
(
¬gv
[++
i
]);

506 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-a") ) {

507 ià(
Ï¡¬g
è
šv®id
;

508 
cÚfig
.
auth
 = 
	`¡rdup
(
¬gv
[++
i
]);

509 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-d")) {

510 ià(
Ï¡¬g
è
šv®id
;

511 
cÚfig
.
d©asize
 = 
	`©oi
(
¬gv
[++
i
]);

512 ià(
cÚfig
.
d©asize
 < 1) config.datasize=1;

513 ià(
cÚfig
.
d©asize
 > 1024*1024*1024) config.datasize = 1024*1024*1024;

514 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-P")) {

515 ià(
Ï¡¬g
è
šv®id
;

516 
cÚfig
.
p–še
 = 
	`©oi
(
¬gv
[++
i
]);

517 ià(
cÚfig
.
p–še
 <= 0) config.pipeline=1;

518 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-r")) {

519 ià(
Ï¡¬g
è
šv®id
;

520 
cÚfig
.
¿ndomkeys
 = 1;

521 
cÚfig
.
¿ndomkeys_key¥aûËn
 = 
	`©oi
(
¬gv
[++
i
]);

522 ià(
cÚfig
.
¿ndomkeys_key¥aûËn
 < 0)

523 
cÚfig
.
¿ndomkeys_key¥aûËn
 = 0;

524 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-q")) {

525 
cÚfig
.
qu›t
 = 1;

526 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--csv")) {

527 
cÚfig
.
csv
 = 1;

528 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-l")) {

529 
cÚfig
.
loİ
 = 1;

530 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-I")) {

531 
cÚfig
.
idËmode
 = 1;

532 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-e")) {

533 
cÚfig
.
show”rÜs
 = 1;

534 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-t")) {

535 ià(
Ï¡¬g
è
šv®id
;

541 
cÚfig
.
‹¡s
 = 
	`sd¢ew
(",");

542 
cÚfig
.
‹¡s
 = 
	`sdsÿt
(cÚfig.‹¡s,(*)
¬gv
[++
i
]);

543 
cÚfig
.
‹¡s
 = 
	`sdsÿt
(config.tests,",");

544 
	`sd¡Şow”
(
cÚfig
.
‹¡s
);

545 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--dbnum")) {

546 ià(
Ï¡¬g
è
šv®id
;

547 
cÚfig
.
dbnum
 = 
	`©oi
(
¬gv
[++
i
]);

548 
cÚfig
.
dbnum¡r
 = 
	`sdsäomlÚglÚg
(cÚfig.
dbnum
);

549 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--help")) {

550 
ex™_¡©us
 = 0;

551 
u§ge
;

556 ià(
¬gv
[
i
][0] =ğ'-'è
šv®id
;

557  
i
;

561  
i
;

563 
šv®id
:

564 
	`´štf
("Inv®id o±iÚ \"%s\" o¸İtiÚ‡rgum’ˆmissšg\n\n",
¬gv
[
i
]);

566 
u§ge
:

567 
	`´štf
(

609 
	`ex™
(
ex™_¡©us
);

610 
	}
}

612 
	$showThroughput
(
«Ev’tLoİ
 *
ev’tLoİ
, 
id
, *
ş›ÁD©a
) {

613 
	`UNUSED
(
ev’tLoİ
);

614 
	`UNUSED
(
id
);

615 
	`UNUSED
(
ş›ÁD©a
);

617 ià(
cÚfig
.
liveş›Ás
 == 0) {

618 
	`årštf
(
¡d”r
,"All clients disconnected...‡borting.\n");

619 
	`ex™
(1);

621 ià(
cÚfig
.
csv
)  250;

622 ià(
cÚfig
.
idËmode
 == 1) {

623 
	`´štf
("ş›Ás: %d\r", 
cÚfig
.
liveş›Ás
);

624 
	`fæush
(
¡dout
);

627 
dt
 = ()(
	`m¡ime
()-
cÚfig
.
¡¬t
)/1000.0;

628 
½s
 = ()
cÚfig
.
»que¡s_fšished
/
dt
;

629 
	`´štf
("%s: %.2f\r", 
cÚfig
.
t™Ë
, 
½s
);

630 
	`fæush
(
¡dout
);

632 
	}
}

636 
	$‹¡_is_£Ëùed
(*
Çme
) {

637 
buf
[256];

638 
l
 = 
	`¡¾’
(
Çme
);

640 ià(
cÚfig
.
‹¡s
 =ğ
NULL
)  1;

641 
buf
[0] = ',';

642 
	`memıy
(
buf
+1,
Çme
,
l
);

643 
buf
[
l
+1] = ',';

644 
buf
[
l
+2] = '\0';

645  
	`¡r¡r
(
cÚfig
.
‹¡s
,
buf
è!ğ
NULL
;

646 
	}
}

648 
	$maš
(
¬gc
, cÚ¡ **
¬gv
) {

649 
i
;

650 *
d©a
, *
cmd
;

651 
Ën
;

653 
ş›Á
 
c
;

655 
	`¤ªdom
(
	`time
(
NULL
));

656 
	`sigÇl
(
SIGHUP
, 
SIG_IGN
);

657 
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
);

659 
cÚfig
.
numş›Ás
 = 50;

660 
cÚfig
.
»que¡s
 = 100000;

661 
cÚfig
.
liveş›Ás
 = 0;

662 
cÚfig
.
–
 = 
	`«C»©eEv’tLoİ
(1024*10);

663 
	`«C»©eTimeEv’t
(
cÚfig
.
–
,1,
showThroughput
,
NULL
,NULL);

664 
cÚfig
.
k“·live
 = 1;

665 
cÚfig
.
d©asize
 = 3;

666 
cÚfig
.
p–še
 = 1;

667 
cÚfig
.
show”rÜs
 = 0;

668 
cÚfig
.
¿ndomkeys
 = 0;

669 
cÚfig
.
¿ndomkeys_key¥aûËn
 = 0;

670 
cÚfig
.
qu›t
 = 0;

671 
cÚfig
.
csv
 = 0;

672 
cÚfig
.
loİ
 = 0;

673 
cÚfig
.
idËmode
 = 0;

674 
cÚfig
.
Ï‹ncy
 = 
NULL
;

675 
cÚfig
.
ş›Ás
 = 
	`li¡C»©e
();

676 
cÚfig
.
ho¡
 = "127.0.0.1";

677 
cÚfig
.
ho¡pÜt
 = 6379;

678 
cÚfig
.
ho¡sock‘
 = 
NULL
;

679 
cÚfig
.
‹¡s
 = 
NULL
;

680 
cÚfig
.
dbnum
 = 0;

681 
cÚfig
.
auth
 = 
NULL
;

683 
i
 = 
	`·r£O±iÚs
(
¬gc
,
¬gv
);

684 
¬gc
 -ğ
i
;

685 
¬gv
 +ğ
i
;

687 
cÚfig
.
Ï‹ncy
 = 
	`zm®loc
(()*cÚfig.
»que¡s
);

689 ià(
cÚfig
.
k“·live
 == 0) {

690 
	`´štf
("WARNING: keepalive disabled, you…robably‚eed 'echo 1 > /proc/sys/net/ipv4/tcp_tw_reuse' for Linux‡nd 'sudo sysctl -w‚et.inet.tcp.msl=1000' for Mac OS X in ordero use‡†ot of clients/requests\n");

693 ià(
cÚfig
.
idËmode
) {

694 
	`´štf
("C»©šg %d idË cÚÃùiÚ ªd wa™šg fÜev” (CŒl+C wh’ dÚe)\n", 
cÚfig
.
numş›Ás
);

695 
c
 = 
	`ü—‹Cl›Á
("",0,
NULL
);

696 
	`ü—‹MissšgCl›Ás
(
c
);

697 
	`«Maš
(
cÚfig
.
–
);

702 ià(
¬gc
) {

703 
sds
 
t™Ë
 = 
	`sd¢ew
(
¬gv
[0]);

704 
i
 = 1; i < 
¬gc
; i++) {

705 
t™Ë
 = 
	`sdsÿ’
(title, " ", 1);

706 
t™Ë
 = 
	`sdsÿ’
Ñ™Ë, (*)
¬gv
[
i
], 
	`¡¾’
(argv[i]));

710 
Ën
 = 
	`»disFÜm©CommªdArgv
(&
cmd
,
¬gc
,
¬gv
,
NULL
);

711 
	`b’chm¬k
(
t™Ë
,
cmd
,
Ën
);

712 
	`ä“
(
cmd
);

713 } 
cÚfig
.
loİ
);

719 
d©a
 = 
	`zm®loc
(
cÚfig
.
d©asize
+1);

721 
	`mem£t
(
d©a
,'x',
cÚfig
.
d©asize
);

722 
d©a
[
cÚfig
.
d©asize
] = '\0';

724 ià(
	`‹¡_is_£Ëùed
("ping_inline") ||est_is_selected("ping"))

725 
	`b’chm¬k
("PING_INLINE","PING\r\n",6);

727 ià(
	`‹¡_is_£Ëùed
("ping_mbulk") ||est_is_selected("ping")) {

728 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"PING");

729 
	`b’chm¬k
("PING_BULK",
cmd
,
Ën
);

730 
	`ä“
(
cmd
);

733 ià(
	`‹¡_is_£Ëùed
("set")) {

734 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"SET key:__¿nd_št__ %s",
d©a
);

735 
	`b’chm¬k
("SET",
cmd
,
Ën
);

736 
	`ä“
(
cmd
);

739 ià(
	`‹¡_is_£Ëùed
("get")) {

740 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"GET key:__rand_int__");

741 
	`b’chm¬k
("GET",
cmd
,
Ën
);

742 
	`ä“
(
cmd
);

745 ià(
	`‹¡_is_£Ëùed
("incr")) {

746 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"INCR counter:__rand_int__");

747 
	`b’chm¬k
("INCR",
cmd
,
Ën
);

748 
	`ä“
(
cmd
);

751 ià(
	`‹¡_is_£Ëùed
("lpush")) {

752 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"LPUSH myli¡ %s",
d©a
);

753 
	`b’chm¬k
("LPUSH",
cmd
,
Ën
);

754 
	`ä“
(
cmd
);

757 ià(
	`‹¡_is_£Ëùed
("rpush")) {

758 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"RPUSH myli¡ %s",
d©a
);

759 
	`b’chm¬k
("RPUSH",
cmd
,
Ën
);

760 
	`ä“
(
cmd
);

763 ià(
	`‹¡_is_£Ëùed
("lpop")) {

764 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"LPOP mylist");

765 
	`b’chm¬k
("LPOP",
cmd
,
Ën
);

766 
	`ä“
(
cmd
);

769 ià(
	`‹¡_is_£Ëùed
("rpop")) {

770 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"RPOP mylist");

771 
	`b’chm¬k
("RPOP",
cmd
,
Ën
);

772 
	`ä“
(
cmd
);

775 ià(
	`‹¡_is_£Ëùed
("sadd")) {

776 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,

778 
	`b’chm¬k
("SADD",
cmd
,
Ën
);

779 
	`ä“
(
cmd
);

782 ià(
	`‹¡_is_£Ëùed
("spop")) {

783 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"SPOP myset");

784 
	`b’chm¬k
("SPOP",
cmd
,
Ën
);

785 
	`ä“
(
cmd
);

788 ià(
	`‹¡_is_£Ëùed
("lrange") ||

789 
	`‹¡_is_£Ëùed
("lrange_100") ||

790 
	`‹¡_is_£Ëùed
("lrange_300") ||

791 
	`‹¡_is_£Ëùed
("lrange_500") ||

792 
	`‹¡_is_£Ëùed
("lrange_600"))

794 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"LPUSH myli¡ %s",
d©a
);

795 
	`b’chm¬k
("LPUSH (ÃededØb’chm¬k LRANGE)",
cmd
,
Ën
);

796 
	`ä“
(
cmd
);

799 ià(
	`‹¡_is_£Ëùed
("lrange") ||est_is_selected("lrange_100")) {

800 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"LRANGE mylist 0 99");

801 
	`b’chm¬k
("LRANGE_100 (fœ¡ 100ƒËm’ts)",
cmd
,
Ën
);

802 
	`ä“
(
cmd
);

805 ià(
	`‹¡_is_£Ëùed
("lrange") ||est_is_selected("lrange_300")) {

806 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"LRANGE mylist 0 299");

807 
	`b’chm¬k
("LRANGE_300 (fœ¡ 300ƒËm’ts)",
cmd
,
Ën
);

808 
	`ä“
(
cmd
);

811 ià(
	`‹¡_is_£Ëùed
("lrange") ||est_is_selected("lrange_500")) {

812 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"LRANGE mylist 0 449");

813 
	`b’chm¬k
("LRANGE_500 (fœ¡ 450ƒËm’ts)",
cmd
,
Ën
);

814 
	`ä“
(
cmd
);

817 ià(
	`‹¡_is_£Ëùed
("lrange") ||est_is_selected("lrange_600")) {

818 
Ën
 = 
	`»disFÜm©Commªd
(&
cmd
,"LRANGE mylist 0 599");

819 
	`b’chm¬k
("LRANGE_600 (fœ¡ 600ƒËm’ts)",
cmd
,
Ën
);

820 
	`ä“
(
cmd
);

823 ià(
	`‹¡_is_£Ëùed
("mset")) {

824 cÚ¡ *
¬gv
[21];

825 
¬gv
[0] = "MSET";

826 
i
 = 1; i < 21; i += 2) {

827 
¬gv
[
i
] = "key:__rand_int__";

828 
¬gv
[
i
+1] = 
d©a
;

830 
Ën
 = 
	`»disFÜm©CommªdArgv
(&
cmd
,21,
¬gv
,
NULL
);

831 
	`b’chm¬k
("MSET (10 keys)",
cmd
,
Ën
);

832 
	`ä“
(
cmd
);

835 ià(!
cÚfig
.
csv
è
	`´štf
("\n");

836 } 
cÚfig
.
loİ
);

839 
	}
}

	@src/redis-check-aof.c

31 
	~"fmaüos.h
"

32 
	~<¡dlib.h
>

33 
	~<¡dio.h
>

34 
	~<¡ršg.h
>

35 
	~<uni¡d.h
>

36 
	~<sys/¡©.h
>

37 
	~"cÚfig.h
"

39 
	#ERROR
(...) { \

40 
__buf
[1024]; \

41 
	`¥rštf
(
__buf
, 
__VA_ARGS__
); \

42 
	`¥rštf
(
”rÜ
, "0x%16Îx: %s", ()
•os
, 
__buf
); \

43 }

	)

45 
	g”rÜ
[1024];

46 
off_t
 
	g•os
;

48 
	$cÚsumeNewlše
(*
buf
) {

49 ià(
	`¡ºcmp
(
buf
,"\r\n",2) != 0) {

50 
	`ERROR
("Ex³ùed \\r\\n, gÙ: %02x%02x",
buf
[0],buf[1]);

54 
	}
}

56 
	$»adLÚg
(
FILE
 *
å
, 
´efix
, *
rg‘
) {

57 
buf
[128], *
•Œ
;

58 
•os
 = 
	`á–lo
(
å
);

59 ià(
	`fg‘s
(
buf
,(buf),
å
è=ğ
NULL
) {

62 ià(
buf
[0] !ğ
´efix
) {

63 
	`ERROR
("Ex³ùed…»fix '%c', gÙ: '%c'",
buf
[0],
´efix
);

66 *
rg‘
 = 
	`¡¹Ş
(
buf
+1,&
•Œ
,10);

67  
	`cÚsumeNewlše
(
•Œ
);

68 
	}
}

70 
	$»adBy‹s
(
FILE
 *
å
, *
rg‘
, 
Ëngth
) {

71 
»®
;

72 
•os
 = 
	`á–lo
(
å
);

73 
»®
 = 
	`ä—d
(
rg‘
,1,
Ëngth
,
å
);

74 ià(
»®
 !ğ
Ëngth
) {

75 
	`ERROR
("Ex³ùedØ»ad %ld by‹s, gÙ %ld by‹s",
Ëngth
,
»®
);

79 
	}
}

81 
	$»adSŒšg
(
FILE
 *
å
, ** 
rg‘
) {

82 
Ën
;

83 *
rg‘
 = 
NULL
;

84 ià(!
	`»adLÚg
(
å
,'$',&
Ën
)) {

89 
Ën
 += 2;

90 *
rg‘
 = (*)
	`m®loc
(
Ën
);

91 ià(!
	`»adBy‹s
(
å
,*
rg‘
,
Ën
)) {

94 ià(!
	`cÚsumeNewlše
(*
rg‘
+
Ën
-2)) {

97 (*
rg‘
)[
Ën
-2] = '\0';

99 
	}
}

101 
	$»adArgc
(
FILE
 *
å
, *
rg‘
) {

102  
	`»adLÚg
(
å
,'*',
rg‘
);

103 
	}
}

105 
off_t
 
	$´oûss
(
FILE
 *
å
) {

106 
¬gc
;

107 
off_t
 
pos
 = 0;

108 
i
, 
muÉi
 = 0;

109 *
¡r
;

112 ià(!
muÉi
è
pos
 = 
	`á–lo
(
å
);

113 ià(!
	`»adArgc
(
å
, &
¬gc
)) ;

115 
i
 = 0; i < 
¬gc
; i++) {

116 ià(!
	`»adSŒšg
(
å
,&
¡r
)) ;

117 ià(
i
 == 0) {

118 ià(
	`¡rÿ£cmp
(
¡r
, "multi") == 0) {

119 ià(
muÉi
++) {

120 
	`ERROR
("Unexpected MULTI");

123 } ià(
	`¡rÿ£cmp
(
¡r
, "exec") == 0) {

124 ià(--
muÉi
) {

125 
	`ERROR
("Unexpected EXEC");

130 
	`ä“
(
¡r
);

134 ià(
i
 < 
¬gc
) {

135 ià(
¡r
è
	`ä“
(str);

140 ià(
	`ãof
(
å
è&& 
muÉi
 && 
	`¡¾’
(
”rÜ
) == 0) {

141 
	`ERROR
("Reached EOF before„eading EXEC for MULTI");

143 ià(
	`¡¾’
(
”rÜ
) > 0) {

144 
	`´štf
("%s\n", 
”rÜ
);

146  
pos
;

147 
	}
}

149 
	$maš
(
¬gc
, **
¬gv
) {

150 *
f’ame
;

151 
fix
 = 0;

153 ià(
¬gc
 < 2) {

154 
	`´štf
("U§ge: % [--fix] <fe.aof>\n", 
¬gv
[0]);

155 
	`ex™
(1);

156 } ià(
¬gc
 == 2) {

157 
f’ame
 = 
¬gv
[1];

158 } ià(
¬gc
 == 3) {

159 ià(
	`¡rcmp
(
¬gv
[1],"--fix") != 0) {

160 
	`´štf
("Inv®id‡rgum’t: %s\n", 
¬gv
[1]);

161 
	`ex™
(1);

163 
f’ame
 = 
¬gv
[2];

164 
fix
 = 1;

166 
	`´štf
("Invalid‡rguments\n");

167 
	`ex™
(1);

170 
FILE
 *
å
 = 
	`fİ’
(
f’ame
,"r+");

171 ià(
å
 =ğ
NULL
) {

172 
	`´štf
("CªnÙ o³Àfe: %s\n", 
f’ame
);

173 
	`ex™
(1);

176 
»dis_¡©
 
sb
;

177 ià(
	`»dis_f¡©
(
	`f’o
(
å
),&
sb
) == -1) {

178 
	`´štf
("CªnÙ sˆfe: %s\n", 
f’ame
);

179 
	`ex™
(1);

182 
off_t
 
size
 = 
sb
.
¡_size
;

183 ià(
size
 == 0) {

184 
	`´štf
("Em±y fe: %s\n", 
f’ame
);

185 
	`ex™
(1);

188 
off_t
 
pos
 = 
	`´oûss
(
å
);

189 
off_t
 
diff
 = 
size
-
pos
;

190 
	`´štf
("AOF‡nalyzed: size=%lld, ok_up_to=%lld, diff=%lld\n",

191 (è
size
, (è
pos
, (è
diff
);

192 ià(
diff
 > 0) {

193 ià(
fix
) {

194 
buf
[2];

195 
	`´štf
("Thi wÈshrškhAOF from %Îd by‹s, w™h %Îd by‹s,Ø%Îd by‹s\n",()
size
,()
diff
,()
pos
);

196 
	`´štf
("Continue? [y/N]: ");

197 ià(
	`fg‘s
(
buf
,(buf),
¡dš
è=ğ
NULL
 ||

198 
	`¡ºÿ£cmp
(
buf
,"y",1) != 0) {

199 
	`´štf
("Aborting...\n");

200 
	`ex™
(1);

202 ià(
	`árunÿ‹
(
	`f’o
(
å
), 
pos
) == -1) {

203 
	`´štf
("Failedoruncate AOF\n");

204 
	`ex™
(1);

206 
	`´štf
("Successfullyruncated AOF\n");

209 
	`´štf
("AOF is‚ot valid\n");

210 
	`ex™
(1);

213 
	`´štf
("AOF is valid\n");

216 
	`fşo£
(
å
);

218 
	}
}

	@src/redis-check-rdb.c

30 
	~"£rv”.h
"

31 
	~"rdb.h
"

33 
	~<¡d¬g.h
>

35 
ü—‹Sh¬edObjeùs
();

36 
rdbLßdProg»ssC®lback
(
rio
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
);

37 
rdbLßdMli£cÚdTime
(
rio
 *
rdb
);

38 
	grdbCheckMode
 = 0;

41 
rio
 *
	mrio
;

42 
robj
 *
	mkey
;

43 
	mkey_ty³
;

44 
	mkeys
;

45 
	mexpœes
;

46 
	m®»ady_expœed
;

47 
	mdošg
;

48 
	m”rÜ_£t
;

49 
	m”rÜ
[1024];

50 } 
	grdb¡©e
;

54 
	#RDB_CHECK_DOING_START
 0

	)

55 
	#RDB_CHECK_DOING_READ_TYPE
 1

	)

56 
	#RDB_CHECK_DOING_READ_EXPIRE
 2

	)

57 
	#RDB_CHECK_DOING_READ_KEY
 3

	)

58 
	#RDB_CHECK_DOING_READ_OBJECT_VALUE
 4

	)

59 
	#RDB_CHECK_DOING_CHECK_SUM
 5

	)

60 
	#RDB_CHECK_DOING_READ_LEN
 6

	)

61 
	#RDB_CHECK_DOING_READ_AUX
 7

	)

63 *
	grdb_check_došg_¡ršg
[] = {

74 *
	grdb_ty³_¡ršg
[] = {

92 
	$rdbShowG’”icInfo
() {

93 
	`´štf
("[šfo] %lu key »ad\n", 
rdb¡©e
.
keys
);

94 
	`´štf
("[šfo] %luƒxpœes\n", 
rdb¡©e
.
expœes
);

95 
	`´štf
("[šfo] %lu‡Ì—dyƒxpœed\n", 
rdb¡©e
.
®»ady_expœed
);

96 
	}
}

100 
	$rdbCheckE¼Ü
(cÚ¡ *
fmt
, ...) {

101 
msg
[1024];

102 
va_li¡
 
­
;

104 
	`va_¡¬t
(
­
, 
fmt
);

105 
	`v¢´štf
(
msg
, (msg), 
fmt
, 
­
);

106 
	`va_’d
(
­
);

108 
	`´štf
("--- RDB ERROR DETECTED ---\n");

109 
	`´štf
("[offset %llu] %s\n",

110 (è(
rdb¡©e
.
rio
 ?

111 
rdb¡©e
.
rio
->
´oûs£d_by‹s
 : 0), 
msg
);

112 
	`´štf
("[additional info] While doing: %s\n",

113 
rdb_check_došg_¡ršg
[
rdb¡©e
.
došg
]);

114 ià(
rdb¡©e
.
key
)

115 
	`´štf
("[additional info] Reading key '%s'\n",

116 (*)
rdb¡©e
.
key
->
±r
);

117 ià(
rdb¡©e
.
key_ty³
 != -1)

118 
	`´štf
("[additional info] Readingype %d (%s)\n",

119 
rdb¡©e
.
key_ty³
,

120 (()
rdb¡©e
.
key_ty³
 <

121 (
rdb_ty³_¡ršg
)/(*)) ?

122 
rdb_ty³_¡ršg
[
rdb¡©e
.
key_ty³
] : "unknown");

123 
	`rdbShowG’”icInfo
();

124 
	}
}

127 
	$rdbCheckInfo
(cÚ¡ *
fmt
, ...) {

128 
msg
[1024];

129 
va_li¡
 
­
;

131 
	`va_¡¬t
(
­
, 
fmt
);

132 
	`v¢´štf
(
msg
, (msg), 
fmt
, 
­
);

133 
	`va_’d
(
­
);

135 
	`´štf
("[offset %llu] %s\n",

136 (è(
rdb¡©e
.
rio
 ?

137 
rdb¡©e
.
rio
->
´oûs£d_by‹s
 : 0), 
msg
);

138 
	}
}

142 
	$rdbCheckS‘E¼Ü
(cÚ¡ *
fmt
, ...) {

143 
va_li¡
 
­
;

145 
	`va_¡¬t
(
­
, 
fmt
);

146 
	`v¢´štf
(
rdb¡©e
.
”rÜ
, Ôdb¡©e.”rÜ), 
fmt
, 
­
);

147 
	`va_’d
(
­
);

148 
rdb¡©e
.
”rÜ_£t
 = 1;

149 
	}
}

154 
	$rdbCheckHªdËC¿sh
(
sig
, 
sigšfo_t
 *
šfo
, *
£ü‘
) {

155 
	`UNUSED
(
sig
);

156 
	`UNUSED
(
šfo
);

157 
	`UNUSED
(
£ü‘
);

159 
	`rdbCheckE¼Ü
("Server crash checkinghe specified RDB file!");

160 
	`ex™
(1);

161 
	}
}

163 
	$rdbCheckS‘upSigÇls
() {

164 
sigaùiÚ
 
aù
;

166 
	`sigem±y£t
(&
aù
.
§_mask
);

167 
aù
.
§_æags
 = 
SA_NODEFER
 | 
SA_RESETHAND
 | 
SA_SIGINFO
;

168 
aù
.
§_sigaùiÚ
 = 
rdbCheckHªdËC¿sh
;

169 
	`sigaùiÚ
(
SIGSEGV
, &
aù
, 
NULL
);

170 
	`sigaùiÚ
(
SIGBUS
, &
aù
, 
NULL
);

171 
	`sigaùiÚ
(
SIGFPE
, &
aù
, 
NULL
);

172 
	`sigaùiÚ
(
SIGILL
, &
aù
, 
NULL
);

173 
	}
}

176 
	$»dis_check_rdb
(*
rdbf’ame
) {

177 
ušt64_t
 
dbid
;

178 
ty³
, 
rdbv”
;

179 
buf
[1024];

180 
expœ‘ime
, 
now
 = 
	`m¡ime
();

181 
FILE
 *
å
;

182 
rio
 
rdb
;

184 ià((
å
 = 
	`fİ’
(
rdbf’ame
,"r")è=ğ
NULL
è 
C_ERR
;

186 
	`rioIn™W™hFe
(&
rdb
,
å
);

187 
rdb¡©e
.
rio
 = &
rdb
;

188 
rdb
.
upd©e_cksum
 = 
rdbLßdProg»ssC®lback
;

189 ià(
	`rioR—d
(&
rdb
,
buf
,9è=ğ0è
eoã¼
;

190 
buf
[9] = '\0';

191 ià(
	`memcmp
(
buf
,"REDIS",5) != 0) {

192 
	`rdbCheckE¼Ü
("Wrong signatureryingo†oad DB from file");

195 
rdbv”
 = 
	`©oi
(
buf
+5);

196 ià(
rdbv”
 < 1 ||„dbv” > 
RDB_VERSION
) {

197 
	`rdbCheckE¼Ü
("Cª'ˆhªdË RDB fÜm© v”siÚ %d",
rdbv”
);

201 
	`¡¬tLßdšg
(
å
);

203 
robj
 *
key
, *
v®
;

204 
expœ‘ime
 = -1;

207 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_TYPE
;

208 ià((
ty³
 = 
	`rdbLßdTy³
(&
rdb
)è=ğ-1è
eoã¼
;

211 ià(
ty³
 =ğ
RDB_OPCODE_EXPIRETIME
) {

212 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_EXPIRE
;

216 ià((
expœ‘ime
 = 
	`rdbLßdTime
(&
rdb
)è=ğ-1è
eoã¼
;

218 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_TYPE
;

219 ià((
ty³
 = 
	`rdbLßdTy³
(&
rdb
)è=ğ-1è
eoã¼
;

222 
expœ‘ime
 *= 1000;

223 } ià(
ty³
 =ğ
RDB_OPCODE_EXPIRETIME_MS
) {

226 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_EXPIRE
;

227 ià((
expœ‘ime
 = 
	`rdbLßdMli£cÚdTime
(&
rdb
)è=ğ-1è
eoã¼
;

229 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_TYPE
;

230 ià((
ty³
 = 
	`rdbLßdTy³
(&
rdb
)è=ğ-1è
eoã¼
;

231 } ià(
ty³
 =ğ
RDB_OPCODE_EOF
) {

234 } ià(
ty³
 =ğ
RDB_OPCODE_SELECTDB
) {

236 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_LEN
;

237 ià((
dbid
 = 
	`rdbLßdL’
(&
rdb
,
NULL
)è=ğ
RDB_LENERR
)

238 
eoã¼
;

239 
	`rdbCheckInfo
("S–eùšg DB ID %d", 
dbid
);

241 } ià(
ty³
 =ğ
RDB_OPCODE_RESIZEDB
) {

244 
ušt64_t
 
db_size
, 
expœes_size
;

245 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_LEN
;

246 ià((
db_size
 = 
	`rdbLßdL’
(&
rdb
,
NULL
)è=ğ
RDB_LENERR
)

247 
eoã¼
;

248 ià((
expœes_size
 = 
	`rdbLßdL’
(&
rdb
,
NULL
)è=ğ
RDB_LENERR
)

249 
eoã¼
;

251 } ià(
ty³
 =ğ
RDB_OPCODE_AUX
) {

257 
robj
 *
auxkey
, *
auxv®
;

258 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_AUX
;

259 ià((
auxkey
 = 
	`rdbLßdSŒšgObjeù
(&
rdb
)è=ğ
NULL
è
eoã¼
;

260 ià((
auxv®
 = 
	`rdbLßdSŒšgObjeù
(&
rdb
)è=ğ
NULL
è
eoã¼
;

262 
	`rdbCheckInfo
("AUX FIELD %s = '%s'",

263 (*)
auxkey
->
±r
, (*)
auxv®
->ptr);

264 
	`deüRefCouÁ
(
auxkey
);

265 
	`deüRefCouÁ
(
auxv®
);

268 ià(!
	`rdbIsObjeùTy³
(
ty³
)) {

269 
	`rdbCheckE¼Ü
("Inv®id objeùy³: %d", 
ty³
);

272 
rdb¡©e
.
key_ty³
 = 
ty³
;

276 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_KEY
;

277 ià((
key
 = 
	`rdbLßdSŒšgObjeù
(&
rdb
)è=ğ
NULL
è
eoã¼
;

278 
rdb¡©e
.
key
 = key;

279 
rdb¡©e
.
keys
++;

281 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_READ_OBJECT_VALUE
;

282 ià((
v®
 = 
	`rdbLßdObjeù
(
ty³
,&
rdb
)è=ğ
NULL
è
eoã¼
;

288 ià(
£rv”
.
ma¡”ho¡
 =ğ
NULL
 && 
expœ‘ime
 !ğ-1 &&ƒxpœ‘im< 
now
)

289 
rdb¡©e
.
®»ady_expœed
++;

290 ià(
expœ‘ime
 !ğ-1è
rdb¡©e
.
expœes
++;

291 
rdb¡©e
.
key
 = 
NULL
;

292 
	`deüRefCouÁ
(
key
);

293 
	`deüRefCouÁ
(
v®
);

294 
rdb¡©e
.
key_ty³
 = -1;

297 ià(
rdbv”
 >ğ5 && 
£rv”
.
rdb_checksum
) {

298 
ušt64_t
 
cksum
, 
ex³ùed
 = 
rdb
.cksum;

300 
rdb¡©e
.
došg
 = 
RDB_CHECK_DOING_CHECK_SUM
;

301 ià(
	`rioR—d
(&
rdb
,&
cksum
,8è=ğ0è
eoã¼
;

302 
	`mem»v64ifbe
(&
cksum
);

303 ià(
cksum
 == 0) {

304 
	`rdbCheckInfo
("RDB file was saved with checksum disabled:‚o check…erformed.");

305 } ià(
cksum
 !ğ
ex³ùed
) {

306 
	`rdbCheckE¼Ü
("RDB CRCƒrror");

308 
	`rdbCheckInfo
("Checksum OK");

312 
	`fşo£
(
å
);

315 
eoã¼
:

316 ià(
rdb¡©e
.
”rÜ_£t
) {

317 
	`rdbCheckE¼Ü
(
rdb¡©e
.
”rÜ
);

319 
	`rdbCheckE¼Ü
("Unexpected EOF„eading RDB file");

322 
	}
}

329 
	$»dis_check_rdb_maš
(
¬gc
, **
¬gv
) {

330 ià(
¬gc
 != 2) {

331 
	`årštf
(
¡d”r
, "U§ge: % <rdb-fe-Çme>\n", 
¬gv
[0]);

332 
	`ex™
(1);

334 
	`ü—‹Sh¬edObjeùs
();

335 
£rv”
.
lßdšg_´oûss_ev’ts_š‹rv®_by‹s
 = 0;

336 
rdbCheckMode
 = 1;

337 
	`rdbCheckInfo
("Checkšg RDB f%s", 
¬gv
[1]);

338 
	`rdbCheckS‘upSigÇls
();

339 
»tv®
 = 
	`»dis_check_rdb
(
¬gv
[1]);

340 ià(
»tv®
 == 0) {

341 
	`rdbCheckInfo
("\\o/ RDB†ooks OK! \\o/");

342 
	`rdbShowG’”icInfo
();

344 
	`ex™
(
»tv®
);

345 
	}
}

	@src/redis-cli.c

31 
	~"fmaüos.h
"

32 
	~"v”siÚ.h
"

34 
	~<¡dio.h
>

35 
	~<¡ršg.h
>

36 
	~<¡dlib.h
>

37 
	~<sigÇl.h
>

38 
	~<uni¡d.h
>

39 
	~<time.h
>

40 
	~<ùy³.h
>

41 
	~<”ºo.h
>

42 
	~<sys/¡©.h
>

43 
	~<sys/time.h
>

44 
	~<as£¹.h
>

45 
	~<fú.h
>

46 
	~<lim™s.h
>

47 
	~<m©h.h
>

49 
	~<hœedis.h
>

50 
	~<sds.h
>

51 
	~"zm®loc.h
"

52 
	~"lš’oi£.h
"

53 
	~"h–p.h
"

54 
	~"ª‘.h
"

55 
	~"«.h
"

57 
	#UNUSED
(
V
è((èV)

	)

59 
	#OUTPUT_STANDARD
 0

	)

60 
	#OUTPUT_RAW
 1

	)

61 
	#OUTPUT_CSV
 2

	)

62 
	#REDIS_CLI_KEEPALIVE_INTERVAL
 15

	)

63 
	#REDIS_CLI_DEFAULT_PIPE_TIMEOUT
 30

	)

64 
	#REDIS_CLI_HISTFILE_ENV
 "REDISCLI_HISTFILE"

	)

65 
	#REDIS_CLI_HISTFILE_DEFAULT
 ".»disşi_hi¡Üy"

	)

66 
	#REDIS_CLI_RCFILE_ENV
 "REDISCLI_RCFILE"

	)

67 
	#REDIS_CLI_RCFILE_DEFAULT
 ".»disşœc"

	)

70 
	g¥eùrum_·Ë‰e_cŞÜ_size
 = 19;

71 
	g¥eùrum_·Ë‰e_cŞÜ
[] = {0,233,234,235,237,239,241,243,245,247,144,143,142,184,226,214,208,202,196};

73 
	g¥eùrum_·Ë‰e_mÚo_size
 = 13;

74 
	g¥eùrum_·Ë‰e_mÚo
[] = {0,233,234,235,237,239,241,243,245,247,249,251,253};

77 *
	g¥eùrum_·Ë‰e
;

78 
	g¥eùrum_·Ë‰e_size
;

80 
»disCÚ‹xt
 *
	gcÚ‹xt
;

81 
	scÚfig
 {

82 *
	mho¡
;

83 
	mho¡pÜt
;

84 *
	mho¡sock‘
;

85 
	m»³©
;

86 
	mš‹rv®
;

87 
	mdbnum
;

88 
	mš‹¿ùive
;

89 
	mshutdown
;

90 
	mmÚ™Ü_mode
;

91 
	mpubsub_mode
;

92 
	mÏ‹ncy_mode
;

93 
	mÏ‹ncy_di¡_mode
;

94 
	mÏ‹ncy_hi¡Üy
;

95 
	mÌu_‹¡_mode
;

96 
	mÌu_‹¡_§m¶e_size
;

97 
	mşu¡”_mode
;

98 
	mşu¡”_»issue_commªd
;

99 
	m¦ave_mode
;

100 
	mpe_mode
;

101 
	mpe_timeout
;

102 
	mg‘rdb_mode
;

103 
	m¡©_mode
;

104 
	msÿn_mode
;

105 
	mšŒšsic_Ï‹ncy_mode
;

106 
	mšŒšsic_Ï‹ncy_du¿tiÚ
;

107 *
	m·‰”n
;

108 *
	mrdb_f’ame
;

109 
	mbigkeys
;

110 
	m¡dš¬g
;

111 *
	mauth
;

112 
	mouut
;

113 
sds
 
	mmb_d–im
;

114 
	m´om±
[128];

115 *
	mev®
;

116 
	mev®_ldb
;

117 
	mev®_ldb_sync
;

118 
	mev®_ldb_’d
;

119 
	m’abË_ldb_Ú_ev®
;

120 
	mÏ¡_cmd_ty³
;

121 } 
	gcÚfig
;

124 
	s´ef
 {

125 
	mhšts
;

126 } 
	g´ef
;

128 vŞ©
sig_©omic_t
 
	gfÜû_ÿnûl_loİ
 = 0;

129 
u§ge
();

130 
¦aveMode
();

131 *
»disG™SHA1
();

132 *
»disG™Dœty
();

133 
şiCÚÃù
(
fÜû
);

139 
	$u¡ime
() {

140 
timev®
 
tv
;

141 
u¡
;

143 
	`g‘timeofday
(&
tv
, 
NULL
);

144 
u¡
 = (()
tv
.
tv_£c
)*1000000;

145 
u¡
 +ğ
tv
.
tv_u£c
;

146  
u¡
;

147 
	}
}

149 
	$m¡ime
() {

150  
	`u¡ime
()/1000;

151 
	}
}

153 
	$şiReäeshProm±
() {

154 
Ën
;

156 ià(
cÚfig
.
ev®_ldb
) ;

157 ià(
cÚfig
.
ho¡sock‘
 !ğ
NULL
)

158 
Ën
 = 
	`¢´štf
(
cÚfig
.
´om±
,(config.prompt),"redis %s",

159 
cÚfig
.
ho¡sock‘
);

161 
Ën
 = 
	`ª‘FÜm©Addr
(
cÚfig
.
´om±
, (config.prompt),

162 
cÚfig
.
ho¡
, cÚfig.
ho¡pÜt
);

164 ià(
cÚfig
.
dbnum
 != 0)

165 
Ën
 +ğ
	`¢´štf
(
cÚfig
.
´om±
+len,(config.prompt)-len,"[%d]",

166 
cÚfig
.
dbnum
);

167 
	`¢´štf
(
cÚfig
.
´om±
+
Ën
,(config.prompt)-len,"> ");

168 
	}
}

178 
sds
 
	$g‘DÙfeP©h
(*
’vov”ride
, *
dÙf’ame
) {

179 *
·th
 = 
NULL
;

180 
sds
 
dÙP©h
 = 
NULL
;

183 
·th
 = 
	`g‘’v
(
’vov”ride
);

184 ià(
·th
 !ğ
NULL
 && *path != '\0') {

185 ià(!
	`¡rcmp
("/dev/nuÎ", 
·th
)) {

186  
NULL
;

190 
dÙP©h
 = 
	`sd¢ew
(
·th
);

192 *
home
 = 
	`g‘’v
("HOME");

193 ià(
home
 !ğ
NULL
 && *home != '\0') {

195 
dÙP©h
 = 
	`sdsÿrštf
(
	`sd£m±y
(), "%s/%s", 
home
, 
dÙf’ame
);

198  
dÙP©h
;

199 
	}
}

205 
	#CLI_HELP_COMMAND
 1

	)

206 
	#CLI_HELP_GROUP
 2

	)

209 
	mty³
;

210 
	m¬gc
;

211 
sds
 *
	m¬gv
;

212 
sds
 
	mfuÎ
;

215 
commªdH–p
 *
	mÜg
;

216 } 
	th–pEÁry
;

218 
h–pEÁry
 *
	gh–pEÁr›s
;

219 
	gh–pEÁr›sL’
;

221 
sds
 
	$şiV”siÚ
() {

222 
sds
 
v”siÚ
;

223 
v”siÚ
 = 
	`sdsÿrštf
(
	`sd£m±y
(), "%s", 
REDIS_VERSION
);

226 ià(
	`¡¹Şl
(
	`»disG™SHA1
(),
NULL
,16)) {

227 
v”siÚ
 = 
	`sdsÿrštf
(v”siÚ, " (g™:%s", 
	`»disG™SHA1
());

228 ià(
	`¡¹Şl
(
	`»disG™Dœty
(),
NULL
,10))

229 
v”siÚ
 = 
	`sdsÿrštf
(version, "-dirty");

230 
v”siÚ
 = 
	`sdsÿt
(version, ")");

232  
v”siÚ
;

233 
	}
}

235 
	$şiIn™H–p
() {

236 
commªd¦’
 = (
commªdH–p
)/(commandHelp);

237 
group¦’
 = (
commªdGroups
)/(*);

238 
i
, 
Ën
, 
pos
 = 0;

239 
h–pEÁry
 
tmp
;

241 
h–pEÁr›sL’
 = 
Ën
 = 
commªd¦’
+
group¦’
;

242 
h–pEÁr›s
 = 
	`zm®loc
((
h–pEÁry
)*
Ën
);

244 
i
 = 0; i < 
group¦’
; i++) {

245 
tmp
.
¬gc
 = 1;

246 
tmp
.
¬gv
 = 
	`zm®loc
((
sds
));

247 
tmp
.
¬gv
[0] = 
	`sdsÿrštf
(
	`sd£m±y
(),"@%s",
commªdGroups
[
i
]);

248 
tmp
.
fuÎ
 =mp.
¬gv
[0];

249 
tmp
.
ty³
 = 
CLI_HELP_GROUP
;

250 
tmp
.
Üg
 = 
NULL
;

251 
h–pEÁr›s
[
pos
++] = 
tmp
;

254 
i
 = 0; i < 
commªd¦’
; i++) {

255 
tmp
.
¬gv
 = 
	`sds¥l™¬gs
(
commªdH–p
[
i
].
Çme
,&tmp.
¬gc
);

256 
tmp
.
fuÎ
 = 
	`sd¢ew
(
commªdH–p
[
i
].
Çme
);

257 
tmp
.
ty³
 = 
CLI_HELP_COMMAND
;

258 
tmp
.
Üg
 = &
commªdH–p
[
i
];

259 
h–pEÁr›s
[
pos
++] = 
tmp
;

261 
	}
}

268 
	$şiIÁeg¿‹H–p
() {

269 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
) ;

271 
»disR•ly
 *
»¶y
 = 
	`»disCommªd
(
cÚ‹xt
, "COMMAND");

272 if(
»¶y
 =ğ
NULL
 ||„•ly->
ty³
 !ğ
REDIS_REPLY_ARRAY
) ;

276 
size_t
 
j
 = 0; j < 
»¶y
->
–em’ts
; j++) {

277 
»disR•ly
 *
’Œy
 = 
»¶y
->
–em’t
[
j
];

278 ià(
’Œy
->
ty³
 !ğ
REDIS_REPLY_ARRAY
 ||ƒÁry->
–em’ts
 < 4 ||

279 
’Œy
->
–em’t
[0]->
ty³
 !ğ
REDIS_REPLY_STRING
 ||

280 
’Œy
->
–em’t
[1]->
ty³
 !ğ
REDIS_REPLY_INTEGER
 ||

281 
’Œy
->
–em’t
[3]->
ty³
 !ğ
REDIS_REPLY_INTEGER
) ;

282 *
cmdÇme
 = 
’Œy
->
–em’t
[0]->
¡r
;

283 
i
;

285 
i
 = 0; i < 
h–pEÁr›sL’
; i++) {

286 
h–pEÁry
 *
he
 = 
h–pEÁr›s
+
i
;

287 ià(!
	`¡rÿ£cmp
(
he
->
¬gv
[0],
cmdÇme
))

290 ià(
i
 !ğ
h–pEÁr›sL’
) ;

292 
h–pEÁr›sL’
++;

293 
h–pEÁr›s
 = 
	`z»®loc
(h–pEÁr›s,(
h–pEÁry
)*
h–pEÁr›sL’
);

294 
h–pEÁry
 *
Ãw
 = 
h–pEÁr›s
+(
h–pEÁr›sL’
-1);

296 
Ãw
->
¬gc
 = 1;

297 
Ãw
->
¬gv
 = 
	`zm®loc
((
sds
));

298 
Ãw
->
¬gv
[0] = 
	`sd¢ew
(
cmdÇme
);

299 
Ãw
->
fuÎ
 =‚ew->
¬gv
[0];

300 
Ãw
->
ty³
 = 
CLI_HELP_COMMAND
;

301 
	`sd¡ouµ”
(
Ãw
->
¬gv
[0]);

303 
commªdH–p
 *
ch
 = 
	`zm®loc
((*ch));

304 
ch
->
Çme
 = 
Ãw
->
¬gv
[0];

305 
ch
->
·¿ms
 = 
	`sd£m±y
();

306 
¬gs
 = 
	`Îabs
(
’Œy
->
–em’t
[1]->
š‹g”
);

307 ià(
’Œy
->
–em’t
[3]->
š‹g”
 == 1) {

308 
ch
->
·¿ms
 = 
	`sdsÿt
(ch->params,"key ");

309 
¬gs
--;

311 
¬gs
--è
ch
->
·¿ms
 = 
	`sdsÿt
(ch->params,"arg ");

312 ià(
’Œy
->
–em’t
[1]->
š‹g”
 < 0)

313 
ch
->
·¿ms
 = 
	`sdsÿt
(ch->params,"...options...");

314 
ch
->
summ¬y
 = "Help‚ot‡vailable";

315 
ch
->
group
 = 0;

316 
ch
->
sšû
 = "not known";

317 
Ãw
->
Üg
 = 
ch
;

319 
	`ä“R•lyObjeù
(
»¶y
);

320 
	}
}

323 
	$şiOuutCommªdH–p
(
commªdH–p
 *
h–p
, 
group
) {

324 
	`´štf
("\r\À \x1b[1m%s\x1b[0m \x1b[90m%s\x1b[0m\r\n", 
h–p
->
Çme
, h–p->
·¿ms
);

325 
	`´štf
(" \x1b[33msumm¬y:\x1b[0m %s\r\n", 
h–p
->
summ¬y
);

326 
	`´štf
(" \x1b[33msšû:\x1b[0m %s\r\n", 
h–p
->
sšû
);

327 ià(
group
) {

328 
	`´štf
(" \x1b[33mgroup:\x1b[0m %s\r\n", 
commªdGroups
[
h–p
->
group
]);

330 
	}
}

333 
	$şiOuutG’”icH–p
() {

334 
sds
 
v”siÚ
 = 
	`şiV”siÚ
();

335 
	`´štf
(

347 
v”siÚ


349 
	`sdsä“
(
v”siÚ
);

350 
	}
}

353 
	$şiOuutH–p
(
¬gc
, **
¬gv
) {

354 
i
, 
j
, 
Ën
;

355 
group
 = -1;

356 
h–pEÁry
 *
’Œy
;

357 
commªdH–p
 *
h–p
;

359 ià(
¬gc
 == 0) {

360 
	`şiOuutG’”icH–p
();

362 } ià(
¬gc
 > 0 && 
¬gv
[0][0] == '@') {

363 
Ën
 = (
commªdGroups
)/(*);

364 
i
 = 0; i < 
Ën
; i++) {

365 ià(
	`¡rÿ£cmp
(
¬gv
[0]+1,
commªdGroups
[
i
]) == 0) {

366 
group
 = 
i
;

372 
	`as£¹
(
¬gc
 > 0);

373 
i
 = 0; i < 
h–pEÁr›sL’
; i++) {

374 
’Œy
 = &
h–pEÁr›s
[
i
];

375 ià(
’Œy
->
ty³
 !ğ
CLI_HELP_COMMAND
) ;

377 
h–p
 = 
’Œy
->
Üg
;

378 ià(
group
 == -1) {

380 ià(
¬gc
 =ğ
’Œy
->argc) {

381 
j
 = 0; j < 
¬gc
; j++) {

382 ià(
	`¡rÿ£cmp
(
¬gv
[
j
],
’Œy
->argv[j]) != 0) ;

384 ià(
j
 =ğ
¬gc
) {

385 
	`şiOuutCommªdH–p
(
h–p
,1);

389 ià(
group
 =ğ
h–p
->group) {

390 
	`şiOuutCommªdH–p
(
h–p
,0);

394 
	`´štf
("\r\n");

395 
	}
}

398 
	$com¶‘iÚC®lback
(cÚ¡ *
buf
, 
lš’oi£Com¶‘iÚs
 *
lc
) {

399 
size_t
 
¡¬os
 = 0;

400 
mask
;

401 
i
;

402 
size_t
 
m©chËn
;

403 
sds
 
tmp
;

405 ià(
	`¡ºÿ£cmp
(
buf
,"help ",5) == 0) {

406 
¡¬os
 = 5;

407 
	`is¥aû
(
buf
[
¡¬os
])) startpos++;

408 
mask
 = 
CLI_HELP_COMMAND
 | 
CLI_HELP_GROUP
;

410 
mask
 = 
CLI_HELP_COMMAND
;

413 
i
 = 0; i < 
h–pEÁr›sL’
; i++) {

414 ià(!(
h–pEÁr›s
[
i
].
ty³
 & 
mask
)) ;

416 
m©chËn
 = 
	`¡¾’
(
buf
+
¡¬os
);

417 ià(
	`¡ºÿ£cmp
(
buf
+
¡¬os
,
h–pEÁr›s
[
i
].
fuÎ
,
m©chËn
) == 0) {

418 
tmp
 = 
	`sd¢ewËn
(
buf
,
¡¬os
);

419 
tmp
 = 
	`sdsÿt
Ñmp,
h–pEÁr›s
[
i
].
fuÎ
);

420 
	`lš’oi£AddCom¶‘iÚ
(
lc
,
tmp
);

421 
	`sdsä“
(
tmp
);

424 
	}
}

427 *
	$hštsC®lback
(cÚ¡ *
buf
, *
cŞÜ
, *
bŞd
) {

428 ià(!
´ef
.
hšts
è 
NULL
;

430 
i
, 
¬gc
, 
buæ’
 = 
	`¡¾’
(
buf
);

431 
sds
 *
¬gv
 = 
	`sds¥l™¬gs
(
buf
,&
¬gc
);

432 
’d¥aû
 = 
buæ’
 && 
	`is¥aû
(
buf
[buflen-1]);

435 ià(
¬gc
 == 0) {

436 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

437  
NULL
;

440 
i
 = 0; i < 
h–pEÁr›sL’
; i++) {

441 ià(!(
h–pEÁr›s
[
i
].
ty³
 & 
CLI_HELP_COMMAND
)) ;

443 ià(
	`¡rÿ£cmp
(
¬gv
[0],
h–pEÁr›s
[
i
].
fuÎ
) == 0)

445 *
cŞÜ
 = 90;

446 *
bŞd
 = 0;

447 
sds
 
hšt
 = 
	`sd¢ew
(
h–pEÁr›s
[
i
].
Üg
->
·¿ms
);

451 
tÜemove
 = 
¬gc
-1;

452 
tÜemove
 > 0 && 
	`sd¦’
(
hšt
)) {

453 ià(
hšt
[0] == '[') ;

454 ià(
hšt
[0] =ğ' 'è
tÜemove
--;

455 
	`sd¤ªge
(
hšt
,1,-1);

459 ià(!
’d¥aû
) {

460 
sds
 
Ãwhšt
 = 
	`sd¢ewËn
(" ",1);

461 
Ãwhšt
 = 
	`sdsÿtsds
Òewhšt,
hšt
);

462 
	`sdsä“
(
hšt
);

463 
hšt
 = 
Ãwhšt
;

466 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

467  
hšt
;

470 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

471  
NULL
;

472 
	}
}

474 
	$ä“HštsC®lback
(*
±r
) {

475 
	`sdsä“
(
±r
);

476 
	}
}

483 
	$şiAuth
() {

484 
»disR•ly
 *
»¶y
;

485 ià(
cÚfig
.
auth
 =ğ
NULL
è 
REDIS_OK
;

487 
»¶y
 = 
	`»disCommªd
(
cÚ‹xt
,"AUTH %s",
cÚfig
.
auth
);

488 ià(
»¶y
 !ğ
NULL
) {

489 
	`ä“R•lyObjeù
(
»¶y
);

490  
REDIS_OK
;

492  
REDIS_ERR
;

493 
	}
}

496 
	$şiS–eù
() {

497 
»disR•ly
 *
»¶y
;

498 ià(
cÚfig
.
dbnum
 =ğ0è 
REDIS_OK
;

500 
»¶y
 = 
	`»disCommªd
(
cÚ‹xt
,"SELECT %d",
cÚfig
.
dbnum
);

501 ià(
»¶y
 !ğ
NULL
) {

502 
»suÉ
 = 
REDIS_OK
;

503 ià(
»¶y
->
ty³
 =ğ
REDIS_REPLY_ERROR
è
»suÉ
 = 
REDIS_ERR
;

504 
	`ä“R•lyObjeù
(
»¶y
);

505  
»suÉ
;

507  
REDIS_ERR
;

508 
	}
}

512 
	$şiCÚÃù
(
fÜû
) {

513 ià(
cÚ‹xt
 =ğ
NULL
 || 
fÜû
) {

514 ià(
cÚ‹xt
 !ğ
NULL
) {

515 
	`»disF»e
(
cÚ‹xt
);

518 ià(
cÚfig
.
ho¡sock‘
 =ğ
NULL
) {

519 
cÚ‹xt
 = 
	`»disCÚÃù
(
cÚfig
.
ho¡
,cÚfig.
ho¡pÜt
);

521 
cÚ‹xt
 = 
	`»disCÚÃùUnix
(
cÚfig
.
ho¡sock‘
);

524 ià(
cÚ‹xt
->
”r
) {

525 
	`årštf
(
¡d”r
,"Could‚ot connecto Redis‡t ");

526 ià(
cÚfig
.
ho¡sock‘
 =ğ
NULL
)

527 
	`årštf
(
¡d”r
,"%s:%d: %s\n",
cÚfig
.
ho¡
,cÚfig.
ho¡pÜt
,
cÚ‹xt
->
”r¡r
);

529 
	`årštf
(
¡d”r
,"%s: %s\n",
cÚfig
.
ho¡sock‘
,
cÚ‹xt
->
”r¡r
);

530 
	`»disF»e
(
cÚ‹xt
);

531 
cÚ‹xt
 = 
NULL
;

532  
REDIS_ERR
;

539 
	`ª‘K“pAlive
(
NULL
, 
cÚ‹xt
->
fd
, 
REDIS_CLI_KEEPALIVE_INTERVAL
);

542 ià(
	`şiAuth
(è!ğ
REDIS_OK
)

543  
REDIS_ERR
;

544 ià(
	`şiS–eù
(è!ğ
REDIS_OK
)

545  
REDIS_ERR
;

547  
REDIS_OK
;

548 
	}
}

550 
	$şiPrštCÚ‹xtE¼Ü
() {

551 ià(
cÚ‹xt
 =ğ
NULL
) ;

552 
	`årštf
(
¡d”r
,"E¼Ü: %s\n",
cÚ‹xt
->
”r¡r
);

553 
	}
}

555 
sds
 
	$şiFÜm©R•lyTTY
(
»disR•ly
 *
r
, *
´efix
) {

556 
sds
 
out
 = 
	`sd£m±y
();

557 
r
->
ty³
) {

558 
REDIS_REPLY_ERROR
:

559 
out
 = 
	`sdsÿrštf
(out,"Ó¼Üè%s\n", 
r
->
¡r
);

561 
REDIS_REPLY_STATUS
:

562 
out
 = 
	`sdsÿt
(out,
r
->
¡r
);

563 
out
 = 
	`sdsÿt
(out,"\n");

565 
REDIS_REPLY_INTEGER
:

566 
out
 = 
	`sdsÿrštf
(out,"(š‹g”è%Îd\n",
r
->
š‹g”
);

568 
REDIS_REPLY_STRING
:

571 
out
 = 
	`sdsÿŒ•r
(out,
r
->
¡r
,r->
Ën
);

572 
out
 = 
	`sdsÿt
(out,"\n");

574 
REDIS_REPLY_NIL
:

575 
out
 = 
	`sdsÿt
(out,"(nil)\n");

577 
REDIS_REPLY_ARRAY
:

578 ià(
r
->
–em’ts
 == 0) {

579 
out
 = 
	`sdsÿt
(out,"(empty†ist or set)\n");

581 
i
, 
idxËn
 = 0;

582 
_´efixËn
[16];

583 
_´efixfmt
[16];

584 
sds
 
_´efix
;

585 
sds
 
tmp
;

588 
i
 = 
r
->
–em’ts
;

590 
idxËn
++;

591 
i
 /= 10;

592 } 
i
);

595 
	`mem£t
(
_´efixËn
,' ',
idxËn
+2);

596 
_´efixËn
[
idxËn
+2] = '\0';

597 
_´efix
 = 
	`sdsÿt
(
	`sd¢ew
(
´efix
),
_´efixËn
);

600 
	`¢´štf
(
_´efixfmt
,(_´efixfmt),"%%s%%%udè",
idxËn
);

602 
i
 = 0; i < 
r
->
–em’ts
; i++) {

605 
out
 = 
	`sdsÿrštf
(out,
_´efixfmt
,
i
 =ğ0 ? "" : 
´efix
,i+1);

608 
tmp
 = 
	`şiFÜm©R•lyTTY
(
r
->
–em’t
[
i
],
_´efix
);

609 
out
 = 
	`sdsÿ’
(out,
tmp
,
	`sd¦’
(tmp));

610 
	`sdsä“
(
tmp
);

612 
	`sdsä“
(
_´efix
);

616 
	`årštf
(
¡d”r
,"UnknowÀ»¶yy³: %d\n", 
r
->
ty³
);

617 
	`ex™
(1);

619  
out
;

620 
	}
}

622 
	$isCŞÜT”m
() {

623 *
t
 = 
	`g‘’v
("TERM");

624  
t
 !ğ
NULL
 && 
	`¡r¡r
(t,"xterm") != NULL;

625 
	}
}

629 
sds
 
	$sdsÿtcŞÜ
(
sds
 
o
, *
s
, 
size_t
 
Ën
, *
cŞÜ
) {

630 ià(!
	`isCŞÜT”m
()è 
	`sdsÿ’
(
o
,
s
,
Ën
);

632 
bŞd
 = 
	`¡r¡r
(
cŞÜ
,"bŞd"è!ğ
NULL
;

633 
ccode
 = 37;

634 ià(
	`¡r¡r
(
cŞÜ
,"»d")è
ccode
 = 31;

635 ià(
	`¡r¡r
(
cŞÜ
,"»d")è
ccode
 = 31;

636 ià(
	`¡r¡r
(
cŞÜ
,"g»’")è
ccode
 = 32;

637 ià(
	`¡r¡r
(
cŞÜ
,"y–low")è
ccode
 = 33;

638 ià(
	`¡r¡r
(
cŞÜ
,"blue")è
ccode
 = 34;

639 ià(
	`¡r¡r
(
cŞÜ
,"mag’")è
ccode
 = 35;

640 ià(
	`¡r¡r
(
cŞÜ
,"cyª")è
ccode
 = 36;

641 ià(
	`¡r¡r
(
cŞÜ
,"wh™e")è
ccode
 = 37;

643 
o
 = 
	`sdsÿtfmt
(o,"\033[%i;%i;49m",
bŞd
,
ccode
);

644 
o
 = 
	`sdsÿ’
(o,
s
,
Ën
);

645 
o
 = 
	`sdsÿt
(o,"\033[0m");

646  
o
;

647 
	}
}

651 
sds
 
	$sdsC©CŞÜizedLdbR•ly
(
sds
 
o
, *
s
, 
size_t
 
Ën
) {

652 *
cŞÜ
 = "white";

654 ià(
	`¡r¡r
(
s
,"<debug>")è
cŞÜ
 = "bold";

655 ià(
	`¡r¡r
(
s
,"<»dis>")è
cŞÜ
 = "green";

656 ià(
	`¡r¡r
(
s
,"<»¶y>")è
cŞÜ
 = "cyan";

657 ià(
	`¡r¡r
(
s
,"<”rÜ>")è
cŞÜ
 = "red";

658 ià(
	`¡r¡r
(
s
,"<hšt>")è
cŞÜ
 = "bold";

659 ià(
	`¡r¡r
(
s
,"<v®ue>"è|| sŒ¡r(s,"<»tv®>")è
cŞÜ
 = "magenta";

660 ià(
Ën
 > 4 && 
	`isdig™
(
s
[3])) {

661 ià(
s
[1] =ğ'>'è
cŞÜ
 = "yellow";

662 ià(
s
[2] =ğ'#'è
cŞÜ
 = "bold";

664  
	`sdsÿtcŞÜ
(
o
,
s
,
Ën
,
cŞÜ
);

665 
	}
}

667 
sds
 
	$şiFÜm©R•lyRaw
(
»disR•ly
 *
r
) {

668 
sds
 
out
 = 
	`sd£m±y
(), 
tmp
;

669 
size_t
 
i
;

671 
r
->
ty³
) {

672 
REDIS_REPLY_NIL
:

675 
REDIS_REPLY_ERROR
:

676 
out
 = 
	`sdsÿ’
(out,
r
->
¡r
,r->
Ën
);

677 
out
 = 
	`sdsÿ’
(out,"\n",1);

679 
REDIS_REPLY_STATUS
:

680 
REDIS_REPLY_STRING
:

681 ià(
r
->
ty³
 =ğ
REDIS_REPLY_STATUS
 && 
cÚfig
.
ev®_ldb
) {

687 ià(
	`¡r¡r
(
r
->
¡r
,"<endsession>") ==„->str) {

688 
cÚfig
.
’abË_ldb_Ú_ev®
 = 0;

689 
cÚfig
.
ev®_ldb
 = 0;

690 
cÚfig
.
ev®_ldb_’d
 = 1;

691 
cÚfig
.
ouut
 = 
OUTPUT_STANDARD
;

692 
	`şiReäeshProm±
();

694 
out
 = 
	`sdsC©CŞÜizedLdbR•ly
(out,
r
->
¡r
,r->
Ën
);

697 
out
 = 
	`sdsÿ’
(out,
r
->
¡r
,r->
Ën
);

700 
REDIS_REPLY_INTEGER
:

701 
out
 = 
	`sdsÿrštf
(out,"%Îd",
r
->
š‹g”
);

703 
REDIS_REPLY_ARRAY
:

704 
i
 = 0; i < 
r
->
–em’ts
; i++) {

705 ià(
i
 > 0è
out
 = 
	`sdsÿt
(out,
cÚfig
.
mb_d–im
);

706 
tmp
 = 
	`şiFÜm©R•lyRaw
(
r
->
–em’t
[
i
]);

707 
out
 = 
	`sdsÿ’
(out,
tmp
,
	`sd¦’
(tmp));

708 
	`sdsä“
(
tmp
);

712 
	`årštf
(
¡d”r
,"UnknowÀ»¶yy³: %d\n", 
r
->
ty³
);

713 
	`ex™
(1);

715  
out
;

716 
	}
}

718 
sds
 
	$şiFÜm©R•lyCSV
(
»disR•ly
 *
r
) {

719 
i
;

721 
sds
 
out
 = 
	`sd£m±y
();

722 
r
->
ty³
) {

723 
REDIS_REPLY_ERROR
:

724 
out
 = 
	`sdsÿt
(out,"ERROR,");

725 
out
 = 
	`sdsÿŒ•r
(out,
r
->
¡r
,
	`¡¾’
(r->str));

727 
REDIS_REPLY_STATUS
:

728 
out
 = 
	`sdsÿŒ•r
(out,
r
->
¡r
,r->
Ën
);

730 
REDIS_REPLY_INTEGER
:

731 
out
 = 
	`sdsÿrštf
(out,"%Îd",
r
->
š‹g”
);

733 
REDIS_REPLY_STRING
:

734 
out
 = 
	`sdsÿŒ•r
(out,
r
->
¡r
,r->
Ën
);

736 
REDIS_REPLY_NIL
:

737 
out
 = 
	`sdsÿt
(out,"NIL");

739 
REDIS_REPLY_ARRAY
:

740 
i
 = 0; i < 
r
->
–em’ts
; i++) {

741 
sds
 
tmp
 = 
	`şiFÜm©R•lyCSV
(
r
->
–em’t
[
i
]);

742 
out
 = 
	`sdsÿ’
(out,
tmp
,
	`sd¦’
(tmp));

743 ià(
i
 !ğ
r
->
–em’ts
-1è
out
 = 
	`sdsÿt
(out,",");

744 
	`sdsä“
(
tmp
);

748 
	`årštf
(
¡d”r
,"UnknowÀ»¶yy³: %d\n", 
r
->
ty³
);

749 
	`ex™
(1);

751  
out
;

752 
	}
}

754 
	$şiR—dR•ly
(
ouut_¿w_¡ršgs
) {

755 *
_»¶y
;

756 
»disR•ly
 *
»¶y
;

757 
sds
 
out
 = 
NULL
;

758 
ouut
 = 1;

760 ià(
	`»disG‘R•ly
(
cÚ‹xt
,&
_»¶y
è!ğ
REDIS_OK
) {

761 ià(
cÚfig
.
shutdown
) {

762 
	`»disF»e
(
cÚ‹xt
);

763 
cÚ‹xt
 = 
NULL
;

764  
REDIS_OK
;

766 ià(
cÚfig
.
š‹¿ùive
) {

768 ià(
cÚ‹xt
->
”r
 =ğ
REDIS_ERR_IO
 &&

769 (
”ºo
 =ğ
ECONNRESET
 ||ƒ¼nØ=ğ
EPIPE
))

770  
REDIS_ERR
;

771 ià(
cÚ‹xt
->
”r
 =ğ
REDIS_ERR_EOF
)

772  
REDIS_ERR
;

774 
	`şiPrštCÚ‹xtE¼Ü
();

775 
	`ex™
(1);

776  
REDIS_ERR
;

779 
»¶y
 = (
»disR•ly
*)
_»¶y
;

781 
cÚfig
.
Ï¡_cmd_ty³
 = 
»¶y
->
ty³
;

785 ià(
cÚfig
.
şu¡”_mode
 && 
»¶y
->
ty³
 =ğ
REDIS_REPLY_ERROR
 &&

786 (!
	`¡ºcmp
(
»¶y
->
¡r
,"MOVED",5è|| !
	`¡rcmp
(reply->str,"ASK")))

788 *
p
 = 
»¶y
->
¡r
, *
s
;

789 
¦Ù
;

791 
ouut
 = 0;

797 
s
 = 
	`¡rchr
(
p
,' ');

798 
p
 = 
	`¡rchr
(
s
+1,' ');

799 *
p
 = '\0';

800 
¦Ù
 = 
	`©oi
(
s
+1);

801 
s
 = 
	`¡¼chr
(
p
+1,':');

802 *
s
 = '\0';

803 
	`sdsä“
(
cÚfig
.
ho¡
);

804 
cÚfig
.
ho¡
 = 
	`sd¢ew
(
p
+1);

805 
cÚfig
.
ho¡pÜt
 = 
	`©oi
(
s
+1);

806 ià(
cÚfig
.
š‹¿ùive
)

807 
	`´štf
("-> Redirectedo slot [%d]†ocated‡t %s:%d\n",

808 
¦Ù
, 
cÚfig
.
ho¡
, cÚfig.
ho¡pÜt
);

809 
cÚfig
.
şu¡”_»issue_commªd
 = 1;

810 
	`şiReäeshProm±
();

813 ià(
ouut
) {

814 ià(
ouut_¿w_¡ršgs
) {

815 
out
 = 
	`şiFÜm©R•lyRaw
(
»¶y
);

817 ià(
cÚfig
.
ouut
 =ğ
OUTPUT_RAW
) {

818 
out
 = 
	`şiFÜm©R•lyRaw
(
»¶y
);

819 
out
 = 
	`sdsÿt
(out,"\n");

820 } ià(
cÚfig
.
ouut
 =ğ
OUTPUT_STANDARD
) {

821 
out
 = 
	`şiFÜm©R•lyTTY
(
»¶y
,"");

822 } ià(
cÚfig
.
ouut
 =ğ
OUTPUT_CSV
) {

823 
out
 = 
	`şiFÜm©R•lyCSV
(
»¶y
);

824 
out
 = 
	`sdsÿt
(out,"\n");

827 
	`fwr™e
(
out
,
	`sd¦’
(out),1,
¡dout
);

828 
	`sdsä“
(
out
);

830 
	`ä“R•lyObjeù
(
»¶y
);

831  
REDIS_OK
;

832 
	}
}

834 
	$şiS’dCommªd
(
¬gc
, **
¬gv
, 
»³©
) {

835 *
commªd
 = 
¬gv
[0];

836 
size_t
 *
¬gvËn
;

837 
j
, 
ouut_¿w
;

839 ià(!
cÚfig
.
ev®_ldb
 &&

840 (!
	`¡rÿ£cmp
(
commªd
,"help") || !strcasecmp(command,"?"))) {

841 
	`şiOuutH–p
(--
¬gc
, ++
¬gv
);

842  
REDIS_OK
;

845 ià(
cÚ‹xt
 =ğ
NULL
è 
REDIS_ERR
;

847 
ouut_¿w
 = 0;

848 ià(!
	`¡rÿ£cmp
(
commªd
,"info") ||

849 (
¬gc
 >ğ2 && !
	`¡rÿ£cmp
(
commªd
,"debug") &&

850 ((!
	`¡rÿ£cmp
(
¬gv
[1],"jemalloc") && !strcasecmp(argv[2],"info")) ||

851 !
	`¡rÿ£cmp
(
¬gv
[1],"htstats"))) ||

852 (
¬gc
 =ğ2 && !
	`¡rÿ£cmp
(
commªd
,"cluster") &&

853 (!
	`¡rÿ£cmp
(
¬gv
[1],"nodes") ||

854 !
	`¡rÿ£cmp
(
¬gv
[1],"info"))) ||

855 (
¬gc
 =ğ2 && !
	`¡rÿ£cmp
(
commªd
,"client") &&

856 !
	`¡rÿ£cmp
(
¬gv
[1],"list")) ||

857 (
¬gc
 =ğ3 && !
	`¡rÿ£cmp
(
commªd
,"latency") &&

858 !
	`¡rÿ£cmp
(
¬gv
[1],"graph")) ||

859 (
¬gc
 =ğ2 && !
	`¡rÿ£cmp
(
commªd
,"latency") &&

860 !
	`¡rÿ£cmp
(
¬gv
[1],"doctor")))

862 
ouut_¿w
 = 1;

865 ià(!
	`¡rÿ£cmp
(
commªd
,"shutdown")è
cÚfig
.
shutdown
 = 1;

866 ià(!
	`¡rÿ£cmp
(
commªd
,"mÚ™Ü")è
cÚfig
.
mÚ™Ü_mode
 = 1;

867 ià(!
	`¡rÿ£cmp
(
commªd
,"subscribe") ||

868 !
	`¡rÿ£cmp
(
commªd
,"psubsüibe")è
cÚfig
.
pubsub_mode
 = 1;

869 ià(!
	`¡rÿ£cmp
(
commªd
,"sync") ||

870 !
	`¡rÿ£cmp
(
commªd
,"psync")è
cÚfig
.
¦ave_mode
 = 1;

874 ià(
¬gc
 =ğ3 && !
	`¡rÿ£cmp
(
¬gv
[0],"script") &&

875 !
	`¡rÿ£cmp
(
¬gv
[1],"debug"))

877 ià(!
	`¡rÿ£cmp
(
¬gv
[2],"yes") || !strcasecmp(argv[2],"sync")) {

878 
cÚfig
.
’abË_ldb_Ú_ev®
 = 1;

880 
cÚfig
.
’abË_ldb_Ú_ev®
 = 0;

885 ià(!
	`¡rÿ£cmp
(
commªd
,"ev®"è&& 
cÚfig
.
’abË_ldb_Ú_ev®
) {

886 
cÚfig
.
ev®_ldb
 = 1;

887 
cÚfig
.
ouut
 = 
OUTPUT_RAW
;

891 
¬gvËn
 = 
	`zm®loc
(
¬gc
*(
size_t
));

892 
j
 = 0; j < 
¬gc
; j++)

893 
¬gvËn
[
j
] = 
	`sd¦’
(
¬gv
[j]);

895 
»³©
--) {

896 
	`»disAµ’dCommªdArgv
(
cÚ‹xt
,
¬gc
,(cÚ¡ **)
¬gv
,
¬gvËn
);

897 
cÚfig
.
mÚ™Ü_mode
) {

898 ià(
	`şiR—dR•ly
(
ouut_¿w
è!ğ
REDIS_OK
è
	`ex™
(1);

899 
	`fæush
(
¡dout
);

902 ià(
cÚfig
.
pubsub_mode
) {

903 ià(
cÚfig
.
ouut
 !ğ
OUTPUT_RAW
)

904 
	`´štf
("Reading messages... (press Ctrl-Co quit)\n");

906 ià(
	`şiR—dR•ly
(
ouut_¿w
è!ğ
REDIS_OK
è
	`ex™
(1);

910 ià(
cÚfig
.
¦ave_mode
) {

911 
	`´štf
("Entering slave output mode... (press Ctrl-Co quit)\n");

912 
	`¦aveMode
();

913 
cÚfig
.
¦ave_mode
 = 0;

914 
	`zä“
(
¬gvËn
);

915  
REDIS_ERR
;

918 ià(
	`şiR—dR•ly
(
ouut_¿w
è!ğ
REDIS_OK
) {

919 
	`zä“
(
¬gvËn
);

920  
REDIS_ERR
;

923 ià(!
	`¡rÿ£cmp
(
commªd
,"£Ëù"è&& 
¬gc
 =ğ2 && 
cÚfig
.
Ï¡_cmd_ty³
 !ğ
REDIS_REPLY_ERROR
) {

924 
cÚfig
.
dbnum
 = 
	`©oi
(
¬gv
[1]);

925 
	`şiReäeshProm±
();

926 } ià(!
	`¡rÿ£cmp
(
commªd
,"auth"è&& 
¬gc
 == 2) {

927 
	`şiS–eù
();

930 ià(
cÚfig
.
š‹rv®
è
	`u¦“p
(config.interval);

931 
	`fæush
(
¡dout
);

934 
	`zä“
(
¬gvËn
);

935  
REDIS_OK
;

936 
	}
}

939 
»disR•ly
 *
	$»cÚÃùšgRedisCommªd
(
»disCÚ‹xt
 *
c
, cÚ¡ *
fmt
, ...) {

940 
»disR•ly
 *
»¶y
 = 
NULL
;

941 
Œ›s
 = 0;

942 
va_li¡
 
­
;

944 
	`as£¹
(!
c
->
”r
);

945 
»¶y
 =ğ
NULL
) {

946 
c
->
”r
 & (
REDIS_ERR_IO
 | 
REDIS_ERR_EOF
)) {

947 
	`´štf
("\r\x1b[0K");

948 
	`´štf
("RecÚÃùšg... %d\r", ++
Œ›s
);

949 
	`fæush
(
¡dout
);

951 
	`»disF»e
(
c
);

952 
c
 = 
	`»disCÚÃù
(
cÚfig
.
ho¡
,cÚfig.
ho¡pÜt
);

953 
	`u¦“p
(1000000);

956 
	`va_¡¬t
(
­
,
fmt
);

957 
»¶y
 = 
	`»disvCommªd
(
c
,
fmt
,
­
);

958 
	`va_’d
(
­
);

960 ià(
c
->
”r
 && !(c->”¸& (
REDIS_ERR_IO
 | 
REDIS_ERR_EOF
))) {

961 
	`årštf
(
¡d”r
, "E¼Ü: %s\n", 
c
->
”r¡r
);

962 
	`ex™
(1);

963 } ià(
Œ›s
 > 0) {

964 
	`´štf
("\r\x1b[0K");

968 
cÚ‹xt
 = 
c
;

969  
»¶y
;

970 
	}
}

976 
	$·r£O±iÚs
(
¬gc
, **
¬gv
) {

977 
i
;

979 
i
 = 1; i < 
¬gc
; i++) {

980 
Ï¡¬g
 = 
i
==
¬gc
-1;

982 ià(!
	`¡rcmp
(
¬gv
[
i
],"-h"è&& !
Ï¡¬g
) {

983 
	`sdsä“
(
cÚfig
.
ho¡
);

984 
cÚfig
.
ho¡
 = 
	`sd¢ew
(
¬gv
[++
i
]);

985 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-h"è&& 
Ï¡¬g
) {

986 
	`u§ge
();

987 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--help")) {

988 
	`u§ge
();

989 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-x")) {

990 
cÚfig
.
¡dš¬g
 = 1;

991 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-p"è&& !
Ï¡¬g
) {

992 
cÚfig
.
ho¡pÜt
 = 
	`©oi
(
¬gv
[++
i
]);

993 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-s"è&& !
Ï¡¬g
) {

994 
cÚfig
.
ho¡sock‘
 = 
¬gv
[++
i
];

995 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-r"è&& !
Ï¡¬g
) {

996 
cÚfig
.
»³©
 = 
	`¡¹Şl
(
¬gv
[++
i
],
NULL
,10);

997 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-i"è&& !
Ï¡¬g
) {

998 
£cÚds
 = 
	`©of
(
¬gv
[++
i
]);

999 
cÚfig
.
š‹rv®
 = 
£cÚds
*1000000;

1000 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-n"è&& !
Ï¡¬g
) {

1001 
cÚfig
.
dbnum
 = 
	`©oi
(
¬gv
[++
i
]);

1002 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-a"è&& !
Ï¡¬g
) {

1003 
cÚfig
.
auth
 = 
¬gv
[++
i
];

1004 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--raw")) {

1005 
cÚfig
.
ouut
 = 
OUTPUT_RAW
;

1006 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--no-raw")) {

1007 
cÚfig
.
ouut
 = 
OUTPUT_STANDARD
;

1008 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--csv")) {

1009 
cÚfig
.
ouut
 = 
OUTPUT_CSV
;

1010 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--latency")) {

1011 
cÚfig
.
Ï‹ncy_mode
 = 1;

1012 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--latency-dist")) {

1013 
cÚfig
.
Ï‹ncy_di¡_mode
 = 1;

1014 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--mono")) {

1015 
¥eùrum_·Ë‰e
 = 
¥eùrum_·Ë‰e_mÚo
;

1016 
¥eùrum_·Ë‰e_size
 = 
¥eùrum_·Ë‰e_mÚo_size
;

1017 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--latency-history")) {

1018 
cÚfig
.
Ï‹ncy_mode
 = 1;

1019 
cÚfig
.
Ï‹ncy_hi¡Üy
 = 1;

1020 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--Ìu-‹¡"è&& !
Ï¡¬g
) {

1021 
cÚfig
.
Ìu_‹¡_mode
 = 1;

1022 
cÚfig
.
Ìu_‹¡_§m¶e_size
 = 
	`¡¹Şl
(
¬gv
[++
i
],
NULL
,10);

1023 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--slave")) {

1024 
cÚfig
.
¦ave_mode
 = 1;

1025 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--stat")) {

1026 
cÚfig
.
¡©_mode
 = 1;

1027 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--scan")) {

1028 
cÚfig
.
sÿn_mode
 = 1;

1029 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--·‰”n"è&& !
Ï¡¬g
) {

1030 
cÚfig
.
·‰”n
 = 
¬gv
[++
i
];

1031 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--šŒšsic-Ï‹ncy"è&& !
Ï¡¬g
) {

1032 
cÚfig
.
šŒšsic_Ï‹ncy_mode
 = 1;

1033 
cÚfig
.
šŒšsic_Ï‹ncy_du¿tiÚ
 = 
	`©oi
(
¬gv
[++
i
]);

1034 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--rdb"è&& !
Ï¡¬g
) {

1035 
cÚfig
.
g‘rdb_mode
 = 1;

1036 
cÚfig
.
rdb_f’ame
 = 
¬gv
[++
i
];

1037 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--pipe")) {

1038 
cÚfig
.
pe_mode
 = 1;

1039 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--pe-timeout"è&& !
Ï¡¬g
) {

1040 
cÚfig
.
pe_timeout
 = 
	`©oi
(
¬gv
[++
i
]);

1041 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--bigkeys")) {

1042 
cÚfig
.
bigkeys
 = 1;

1043 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--ev®"è&& !
Ï¡¬g
) {

1044 
cÚfig
.
ev®
 = 
¬gv
[++
i
];

1045 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--ldb")) {

1046 
cÚfig
.
ev®_ldb
 = 1;

1047 
cÚfig
.
ouut
 = 
OUTPUT_RAW
;

1048 } ià(!
	`¡rcmp
(
¬gv
[
i
],"--ldb-sync-mode")) {

1049 
cÚfig
.
ev®_ldb
 = 1;

1050 
cÚfig
.
ev®_ldb_sync
 = 1;

1051 
cÚfig
.
ouut
 = 
OUTPUT_RAW
;

1052 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-c")) {

1053 
cÚfig
.
şu¡”_mode
 = 1;

1054 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-d"è&& !
Ï¡¬g
) {

1055 
	`sdsä“
(
cÚfig
.
mb_d–im
);

1056 
cÚfig
.
mb_d–im
 = 
	`sd¢ew
(
¬gv
[++
i
]);

1057 } ià(!
	`¡rcmp
(
¬gv
[
i
],"-v") || !strcmp(argv[i], "--version")) {

1058 
sds
 
v”siÚ
 = 
	`şiV”siÚ
();

1059 
	`´štf
("»dis-ş˜%s\n", 
v”siÚ
);

1060 
	`sdsä“
(
v”siÚ
);

1061 
	`ex™
(0);

1063 ià(
¬gv
[
i
][0] == '-') {

1064 
	`årštf
(
¡d”r
,

1066 
¬gv
[
i
]);

1067 
	`ex™
(1);

1076 ià(
cÚfig
.
ev®_ldb
 && cÚfig.
ev®
 =ğ
NULL
) {

1077 
	`årštf
(
¡d”r
,"Options --ldb‡nd --ldb-sync-mode„equire --eval.\n");

1078 
	`årštf
(
¡d”r
,"Try % --h–°fÜ mÜšfÜm©iÚ.\n", 
¬gv
[0]);

1079 
	`ex™
(1);

1081  
i
;

1082 
	}
}

1084 
sds
 
	$»adArgFromStdš
() {

1085 
buf
[1024];

1086 
sds
 
¬g
 = 
	`sd£m±y
();

1089 
Ä—d
 = 
	`»ad
(
	`f’o
(
¡dš
),
buf
,1024);

1091 ià(
Ä—d
 == 0) ;

1092 ià(
Ä—d
 == -1) {

1093 
	`³¼Ü
("Reading from standard input");

1094 
	`ex™
(1);

1096 
¬g
 = 
	`sdsÿ’
×rg,
buf
,
Ä—d
);

1098  
¬g
;

1099 
	}
}

1101 
	$u§ge
() {

1102 
sds
 
v”siÚ
 = 
	`şiV”siÚ
();

1103 
	`årštf
(
¡d”r
,

1162 
v”siÚ
, 
REDIS_CLI_DEFAULT_PIPE_TIMEOUT
);

1163 
	`sdsä“
(
v”siÚ
);

1164 
	`ex™
(1);

1165 
	}
}

1168 **
	$cÚv”tToSds
(
couÁ
, ** 
¬gs
) {

1169 
j
;

1170 **
sds
 = 
	`zm®loc
((*)*
couÁ
);

1172 
j
 = 0; j < 
couÁ
; j++)

1173 
sds
[
j
] = 
	`sd¢ew
(
¬gs
[j]);

1175  
sds
;

1176 
	}
}

1178 
	$issueCommªdR•—t
(
¬gc
, **
¬gv
, 
»³©
) {

1180 
cÚfig
.
şu¡”_»issue_commªd
 = 0;

1181 ià(
	`şiS’dCommªd
(
¬gc
,
¬gv
,
»³©
è!ğ
REDIS_OK
) {

1182 
	`şiCÚÃù
(1);

1186 ià(
	`şiS’dCommªd
(
¬gc
,
¬gv
,
»³©
è!ğ
REDIS_OK
) {

1187 
	`şiPrštCÚ‹xtE¼Ü
();

1188  
REDIS_ERR
;

1192 ià(
cÚfig
.
şu¡”_mode
 && cÚfig.
şu¡”_»issue_commªd
) {

1193 
	`şiCÚÃù
(1);

1198  
REDIS_OK
;

1199 
	}
}

1201 
	$issueCommªd
(
¬gc
, **
¬gv
) {

1202  
	`issueCommªdR•—t
(
¬gc
, 
¬gv
, 
cÚfig
.
»³©
);

1203 
	}
}

1211 
sds
 *
	$şiS¶™Args
(*
lše
, *
¬gc
) {

1212 ià(
cÚfig
.
ev®_ldb
 && (
	`¡r¡r
(
lše
,"eval ") ==†ine ||

1213 
	`¡r¡r
(
lše
,"e ") ==†ine))

1215 
sds
 *
¬gv
 = 
	`sds_m®loc
((sds)*2);

1216 *
¬gc
 = 2;

1217 
Ën
 = 
	`¡¾’
(
lše
);

1218 
–’
 = 
lše
[1] == ' ' ? 2 : 5;

1219 
¬gv
[0] = 
	`sd¢ewËn
(
lše
,
–’
-1);

1220 
¬gv
[1] = 
	`sd¢ewËn
(
lše
+
–’
,
Ën
-elen);

1221  
¬gv
;

1223  
	`sds¥l™¬gs
(
lše
,
¬gc
);

1225 
	}
}

1230 
	$şiS‘P»ã»nûs
(**
¬gv
, 
¬gc
, 
š‹¿ùive
) {

1231 ià(!
	`¡rÿ£cmp
(
¬gv
[0],":£t"è&& 
¬gc
 >= 2) {

1232 ià(!
	`¡rÿ£cmp
(
¬gv
[1],"hšts")è
´ef
.
hšts
 = 1;

1233 ià(!
	`¡rÿ£cmp
(
¬gv
[1],"nohšts")è
´ef
.
hšts
 = 0;

1235 
	`´štf
("%sunknown„edis-cli…reference '%s'\n",

1236 
š‹¿ùive
 ? "" : ".redisclirc: ",

1237 
¬gv
[1]);

1240 
	`´štf
("%sunknown„edis-cli internal command '%s'\n",

1241 
š‹¿ùive
 ? "" : ".redisclirc: ",

1242 
¬gv
[0]);

1244 
	}
}

1247 
	$şiLßdP»ã»nûs
() {

1248 
sds
 
rcfe
 = 
	`g‘DÙfeP©h
(
REDIS_CLI_RCFILE_ENV
,
REDIS_CLI_RCFILE_DEFAULT
);

1249 ià(
rcfe
 =ğ
NULL
) ;

1250 
FILE
 *
å
 = 
	`fİ’
(
rcfe
,"r");

1251 
buf
[1024];

1253 ià(
å
) {

1254 
	`fg‘s
(
buf
,(buf),
å
è!ğ
NULL
) {

1255 
sds
 *
¬gv
;

1256 
¬gc
;

1258 
¬gv
 = 
	`sds¥l™¬gs
(
buf
,&
¬gc
);

1259 ià(
¬gc
 > 0è
	`şiS‘P»ã»nûs
(
¬gv
,argc,0);

1260 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

1262 
	`fşo£
(
å
);

1264 
	`sdsä“
(
rcfe
);

1265 
	}
}

1267 
	$»¶
() {

1268 
sds
 
hi¡Üyfe
 = 
NULL
;

1269 
hi¡Üy
 = 0;

1270 *
lše
;

1271 
¬gc
;

1272 
sds
 *
¬gv
;

1276 
	`şiIn™H–p
();

1277 
	`şiIÁeg¿‹H–p
();

1279 
cÚfig
.
š‹¿ùive
 = 1;

1280 
	`lš’oi£S‘MuÉiLše
(1);

1281 
	`lš’oi£S‘Com¶‘iÚC®lback
(
com¶‘iÚC®lback
);

1282 
	`lš’oi£S‘HštsC®lback
(
hštsC®lback
);

1283 
	`lš’oi£S‘F»eHštsC®lback
(
ä“HštsC®lback
);

1286 ià(
	`i§‰y
(
	`f’o
(
¡dš
))) {

1287 
hi¡Üyfe
 = 
	`g‘DÙfeP©h
(
REDIS_CLI_HISTFILE_ENV
,
REDIS_CLI_HISTFILE_DEFAULT
);

1288 ià(
hi¡Üyfe
 !ğ
NULL
) {

1289 
hi¡Üy
 = 1;

1290 
	`lš’oi£Hi¡ÜyLßd
(
hi¡Üyfe
);

1292 
	`şiLßdP»ã»nûs
();

1295 
	`şiReäeshProm±
();

1296 (
lše
 = 
	`lš’oi£
(
cÚ‹xt
 ? 
cÚfig
.
´om±
 : "nÙ cÚÃùed> ")è!ğ
NULL
) {

1297 ià(
lše
[0] != '\0') {

1298 
¬gv
 = 
	`şiS¶™Args
(
lše
,&
¬gc
);

1299 ià(
hi¡Üy
è
	`lš’oi£Hi¡ÜyAdd
(
lše
);

1300 ià(
hi¡Üyfe
è
	`lš’oi£Hi¡ÜySave
(historyfile);

1302 ià(
¬gv
 =ğ
NULL
) {

1303 
	`´štf
("Invalid‡rgument(s)\n");

1304 
	`lš’oi£F»e
(
lše
);

1306 } ià(
¬gc
 > 0) {

1307 ià(
	`¡rÿ£cmp
(
¬gv
[0],"quit") == 0 ||

1308 
	`¡rÿ£cmp
(
¬gv
[0],"exit") == 0)

1310 
	`ex™
(0);

1311 } ià(
¬gv
[0][0] == ':') {

1312 
	`şiS‘P»ã»nûs
(
¬gv
,
¬gc
,1);

1314 } ià(
	`¡rÿ£cmp
(
¬gv
[0],"restart") == 0) {

1315 ià(
cÚfig
.
ev®
) {

1316 
cÚfig
.
ev®_ldb
 = 1;

1317 
cÚfig
.
ouut
 = 
OUTPUT_RAW
;

1320 
	`´štf
("Use 'restart' only in Lua debugging mode.");

1322 } ià(
¬gc
 =ğ3 && !
	`¡rÿ£cmp
(
¬gv
[0],"connect")) {

1323 
	`sdsä“
(
cÚfig
.
ho¡
);

1324 
cÚfig
.
ho¡
 = 
	`sd¢ew
(
¬gv
[1]);

1325 
cÚfig
.
ho¡pÜt
 = 
	`©oi
(
¬gv
[2]);

1326 
	`şiReäeshProm±
();

1327 
	`şiCÚÃù
(1);

1328 } ià(
¬gc
 =ğ1 && !
	`¡rÿ£cmp
(
¬gv
[0],"clear")) {

1329 
	`lš’oi£CË¬Sü“n
();

1331 
¡¬t_time
 = 
	`m¡ime
(), 
–­£d
;

1332 
»³©
, 
sk¬gs
 = 0;

1334 
»³©
 = 
	`©oi
(
¬gv
[0]);

1335 ià(
¬gc
 > 1 && 
»³©
) {

1336 
sk¬gs
 = 1;

1338 
»³©
 = 1;

1341 
	`issueCommªdR•—t
(
¬gc
-
sk¬gs
, 
¬gv
+sk¬gs, 
»³©
);

1345 ià(
cÚfig
.
ev®_ldb_’d
) {

1346 
cÚfig
.
ev®_ldb_’d
 = 0;

1347 
	`şiR—dR•ly
(0);

1348 
	`´štf
("\n(Lua debugging sessionƒnded%s)\n\n",

1349 
cÚfig
.
ev®_ldb_sync
 ? "" :

1353 
–­£d
 = 
	`m¡ime
()-
¡¬t_time
;

1354 ià(
–­£d
 >= 500) {

1355 
	`´štf
("(%.2fs)\n",()
–­£d
/1000);

1360 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

1363 
	`lš’oi£F»e
(
lše
);

1365 
	`ex™
(0);

1366 
	}
}

1368 
	$nÚš‹¿ùive
(
¬gc
, **
¬gv
) {

1369 
»tv®
 = 0;

1370 ià(
cÚfig
.
¡dš¬g
) {

1371 
¬gv
 = 
	`z»®loc
×rgv, (
¬gc
+1)*(*));

1372 
¬gv
[
¬gc
] = 
	`»adArgFromStdš
();

1373 
»tv®
 = 
	`issueCommªd
(
¬gc
+1, 
¬gv
);

1375 
»tv®
 = 
	`issueCommªd
(
¬gc
, 
¬gv
);

1377  
»tv®
;

1378 
	}
}

1384 
	$ev®Mode
(
¬gc
, **
¬gv
) {

1385 
sds
 
süt
 = 
NULL
;

1386 
FILE
 *
å
;

1387 
buf
[1024];

1388 
size_t
 
Ä—d
;

1389 **
¬gv2
;

1390 
j
, 
gÙ_comma
, 
keys
;

1391 
»tv®
 = 
REDIS_OK
;

1394 ià(
cÚfig
.
ev®_ldb
) {

1395 
	`´štf
(

1403 
	`sdsä“
(
süt
);

1404 
süt
 = 
	`sd£m±y
();

1405 
gÙ_comma
 = 0;

1406 
keys
 = 0;

1409 
å
 = 
	`fİ’
(
cÚfig
.
ev®
,"r");

1410 ià(!
å
) {

1411 
	`årštf
(
¡d”r
,

1412 "Cª'ˆİ’ f'%s': %s\n", 
cÚfig
.
ev®
, 
	`¡»¼Ü
(
”ºo
));

1413 
	`ex™
(1);

1415 (
Ä—d
 = 
	`ä—d
(
buf
,1,(buf),
å
)) != 0) {

1416 
süt
 = 
	`sdsÿ’
(süt,
buf
,
Ä—d
);

1418 
	`fşo£
(
å
);

1421 ià(
cÚfig
.
ev®_ldb
) {

1422 
»disR•ly
 *
»¶y
 = 
	`»disCommªd
(
cÚ‹xt
,

1423 
cÚfig
.
ev®_ldb_sync
 ?

1425 ià(
»¶y
è
	`ä“R•lyObjeù
(reply);

1429 
¬gv2
 = 
	`zm®loc
((
sds
)*(
¬gc
+3));

1430 
¬gv2
[0] = 
	`sd¢ew
("EVAL");

1431 
¬gv2
[1] = 
süt
;

1432 
j
 = 0; j < 
¬gc
; j++) {

1433 ià(!
gÙ_comma
 && 
¬gv
[
j
][0] == ',' &&‡rgv[j][1] == 0) {

1434 
gÙ_comma
 = 1;

1437 
¬gv2
[
j
+3-
gÙ_comma
] = 
	`sd¢ew
(
¬gv
[j]);

1438 ià(!
gÙ_comma
è
keys
++;

1440 
¬gv2
[2] = 
	`sdsÿrštf
(
	`sd£m±y
(),"%d",
keys
);

1443 
ev®_ldb
 = 
cÚfig
.eval_ldb;

1444 
»tv®
 = 
	`issueCommªd
(
¬gc
+3-
gÙ_comma
, 
¬gv2
);

1445 ià(
ev®_ldb
) {

1446 ià(!
cÚfig
.
ev®_ldb
) {

1450 
	`´štf
("Eval debugging session can't start:\n");

1451 
	`şiR—dR•ly
(0);

1454 
	`¡ºıy
(
cÚfig
.
´om±
,"lua debugger> ",(config.prompt));

1455 
	`»¶
();

1457 
	`şiCÚÃù
(1);

1458 
	`´štf
("\n");

1464  
»tv®
;

1465 
	}
}

1471 
	#LATENCY_SAMPLE_RATE
 10

	)

1472 
	#LATENCY_HISTORY_DEFAULT_INTERVAL
 15000

	)

1473 
	$Ï‹ncyMode
() {

1474 
»disR•ly
 *
»¶y
;

1475 
¡¬t
, 
Ï‹ncy
, 
mš
 = 0, 
max
 = 0, 
tÙ
 = 0, 
couÁ
 = 0;

1476 
hi¡Üy_š‹rv®
 =

1477 
cÚfig
.
š‹rv®
 ? config.interval/1000 :

1478 
LATENCY_HISTORY_DEFAULT_INTERVAL
;

1479 
avg
;

1480 
hi¡Üy_¡¬t
 = 
	`m¡ime
();

1482 ià(!
cÚ‹xt
è
	`ex™
(1);

1484 
¡¬t
 = 
	`m¡ime
();

1485 
»¶y
 = 
	`»cÚÃùšgRedisCommªd
(
cÚ‹xt
,"PING");

1486 ià(
»¶y
 =ğ
NULL
) {

1487 
	`årštf
(
¡d”r
,"\nI/Oƒrror\n");

1488 
	`ex™
(1);

1490 
Ï‹ncy
 = 
	`m¡ime
()-
¡¬t
;

1491 
	`ä“R•lyObjeù
(
»¶y
);

1492 
couÁ
++;

1493 ià(
couÁ
 == 1) {

1494 
mš
 = 
max
 = 
tÙ
 = 
Ï‹ncy
;

1495 
avg
 = (è
Ï‹ncy
;

1497 ià(
Ï‹ncy
 < 
mš
) min =†atency;

1498 ià(
Ï‹ncy
 > 
max
) max =†atency;

1499 
tÙ
 +ğ
Ï‹ncy
;

1500 
avg
 = (è
tÙ
/
couÁ
;

1502 
	`´štf
("\x1b[0G\x1b[2Kmin: %lld, max: %lld,‡vg: %.2f (%lld samples)",

1503 
mš
, 
max
, 
avg
, 
couÁ
);

1504 
	`fæush
(
¡dout
);

1505 ià(
cÚfig
.
Ï‹ncy_hi¡Üy
 && 
	`m¡ime
()-
hi¡Üy_¡¬t
 > 
hi¡Üy_š‹rv®
)

1507 
	`´štf
(" -- %.2à£cÚd ¿nge\n", ()(
	`m¡ime
()-
hi¡Üy_¡¬t
)/1000);

1508 
hi¡Üy_¡¬t
 = 
	`m¡ime
();

1509 
mš
 = 
max
 = 
tÙ
 = 
couÁ
 = 0;

1511 
	`u¦“p
(
LATENCY_SAMPLE_RATE
 * 1000);

1513 
	}
}

1519 
	#LATENCY_DIST_DEFAULT_INTERVAL
 1000

	)

1522 
	sdi¡§m¶es
 {

1523 
	mmax
;

1524 
	mcouÁ
;

1525 
	mch¬aù”
;

1539 
	$showL©’cyDi¡Sam¶es
(
di¡§m¶es
 *
§m¶es
, 
tÙ
) {

1540 
j
;

1547 
	`´štf
("\033[38;5;0m");

1548 
j
 = 0; ; j++) {

1549 
cŞÜidx
 =

1550 
	`û
((è
§m¶es
[
j
].
couÁ
 / 
tÙ
 * (
¥eùrum_·Ë‰e_size
-1));

1551 
cŞÜ
 = 
¥eùrum_·Ë‰e
[
cŞÜidx
];

1552 
	`´štf
("\033[48;5;%dm%c", ()
cŞÜ
, 
§m¶es
[
j
].
ch¬aù”
);

1553 
§m¶es
[
j
].
couÁ
 = 0;

1554 ià(
§m¶es
[
j
].
max
 == 0) ;

1556 
	`´štf
("\033[0m\n");

1557 
	`fæush
(
¡dout
);

1558 
	}
}

1562 
	$showL©’cyDi¡Leg’d
() {

1563 
j
;

1565 
	`´štf
("---------------------------------------------\n");

1566 
	`´štf
(". - * # .01 .125 .25 .5 milliseconds\n");

1567 
	`´štf
("1,2,3,...,9 from 1o 9 milliseconds\n");

1568 
	`´štf
("A,B,C,D,E 10,20,30,40,50 milliseconds\n");

1569 
	`´štf
("F,G,H,I,J .1,.2,.3,.4,.5 seconds\n");

1570 
	`´štf
("K,L,M,N,O,P,Q,? 1,2,4,8,16,30,60,>60 seconds\n");

1571 
	`´štf
("From 0o 100%%: ");

1572 
j
 = 0; j < 
¥eùrum_·Ë‰e_size
; j++) {

1573 
	`´štf
("\033[48;5;%dm ", 
¥eùrum_·Ë‰e
[
j
]);

1575 
	`´štf
("\033[0m\n");

1576 
	`´štf
("---------------------------------------------\n");

1577 
	}
}

1579 
	$Ï‹ncyDi¡Mode
() {

1580 
»disR•ly
 *
»¶y
;

1581 
¡¬t
, 
Ï‹ncy
, 
couÁ
 = 0;

1582 
hi¡Üy_š‹rv®
 =

1583 
cÚfig
.
š‹rv®
 ? config.interval/1000 :

1584 
LATENCY_DIST_DEFAULT_INTERVAL
;

1585 
hi¡Üy_¡¬t
 = 
	`u¡ime
();

1586 
j
, 
ouuts
 = 0;

1588 
di¡§m¶es
 
§m¶es
[] = {

1625 ià(!
cÚ‹xt
è
	`ex™
(1);

1627 
¡¬t
 = 
	`u¡ime
();

1628 
»¶y
 = 
	`»cÚÃùšgRedisCommªd
(
cÚ‹xt
,"PING");

1629 ià(
»¶y
 =ğ
NULL
) {

1630 
	`årštf
(
¡d”r
,"\nI/Oƒrror\n");

1631 
	`ex™
(1);

1633 
Ï‹ncy
 = 
	`u¡ime
()-
¡¬t
;

1634 
	`ä“R•lyObjeù
(
»¶y
);

1635 
couÁ
++;

1638 
j
 = 0; ; j++) {

1639 ià(
§m¶es
[
j
].
max
 =ğ0 || 
Ï‹ncy
 <= samples[j].max) {

1640 
§m¶es
[
j
].
couÁ
++;

1646 ià(
couÁ
 && (
	`u¡ime
()-
hi¡Üy_¡¬t
)/1000 > 
hi¡Üy_š‹rv®
) {

1647 ià((
ouuts
++ % 20) == 0)

1648 
	`showL©’cyDi¡Leg’d
();

1649 
	`showL©’cyDi¡Sam¶es
(
§m¶es
,
couÁ
);

1650 
hi¡Üy_¡¬t
 = 
	`u¡ime
();

1651 
couÁ
 = 0;

1653 
	`u¦“p
(
LATENCY_SAMPLE_RATE
 * 1000);

1655 
	}
}

1663 
	$£ndSync
(
fd
) {

1668 
buf
[4096], *
p
;

1669 
ssize_t
 
Ä—d
;

1672 ià(
	`wr™e
(
fd
,"SYNC\r\n",6) != 6) {

1673 
	`årštf
(
¡d”r
,"Error writingo master\n");

1674 
	`ex™
(1);

1678 
p
 = 
buf
;

1680 
Ä—d
 = 
	`»ad
(
fd
,
p
,1);

1681 ià(
Ä—d
 <= 0) {

1682 
	`årštf
(
¡d”r
,"Error„eading bulk†ength while SYNCing\n");

1683 
	`ex™
(1);

1685 ià(*
p
 =ğ'\n' &&… !ğ
buf
) ;

1686 ià(*
p
 != '\n')…++;

1688 *
p
 = '\0';

1689 ià(
buf
[0] == '-') {

1690 
	`´štf
("SYNC w™h ma¡” faed: %s\n", 
buf
);

1691 
	`ex™
(1);

1693  
	`¡¹ouÎ
(
buf
+1,
NULL
,10);

1694 
	}
}

1696 
	$¦aveMode
() {

1697 
fd
 = 
cÚ‹xt
->fd;

1698 
·ylßd
 = 
	`£ndSync
(
fd
);

1699 
buf
[1024];

1700 
Üigš®_ouut
 = 
cÚfig
.
ouut
;

1702 
	`årštf
(
¡d”r
,"SYNC with master, discarding %llu "

1703 "by‹ oàbulk¿nsãr...\n", 
·ylßd
);

1706 
·ylßd
) {

1707 
ssize_t
 
Ä—d
;

1709 
Ä—d
 = 
	`»ad
(
fd
,
buf
,(
·ylßd
 > (buf)) ? (buf) :…ayload);

1710 ià(
Ä—d
 <= 0) {

1711 
	`årštf
(
¡d”r
,"Error„eading RDB…ayload while SYNCing\n");

1712 
	`ex™
(1);

1714 
·ylßd
 -ğ
Ä—d
;

1716 
	`årštf
(
¡d”r
,"SYNC done. Logging commands from master.\n");

1719 
cÚfig
.
ouut
 = 
OUTPUT_CSV
;

1720 
	`şiR—dR•ly
(0è=ğ
REDIS_OK
);

1721 
cÚfig
.
ouut
 = 
Üigš®_ouut
;

1722 
	}
}

1730 
	$g‘RDB
() {

1731 
s
 = 
cÚ‹xt
->
fd
;

1732 
fd
;

1733 
·ylßd
 = 
	`£ndSync
(
s
);

1734 
buf
[4096];

1736 
	`årštf
(
¡d”r
,"SYNC sento master, writing %llu byteso '%s'\n",

1737 
·ylßd
, 
cÚfig
.
rdb_f’ame
);

1740 ià(!
	`¡rcmp
(
cÚfig
.
rdb_f’ame
,"-")) {

1741 
fd
 = 
STDOUT_FILENO
;

1743 
fd
 = 
	`İ’
(
cÚfig
.
rdb_f’ame
, 
O_CREAT
|
O_WRONLY
, 0644);

1744 ià(
fd
 == -1) {

1745 
	`årštf
(
¡d”r
, "E¼Ü o³nšg '%s': %s\n", 
cÚfig
.
rdb_f’ame
,

1746 
	`¡»¼Ü
(
”ºo
));

1747 
	`ex™
(1);

1751 
·ylßd
) {

1752 
ssize_t
 
Ä—d
, 
nwr™‹n
;

1754 
Ä—d
 = 
	`»ad
(
s
,
buf
,(
·ylßd
 > (buf)) ? (buf) :…ayload);

1755 ià(
Ä—d
 <= 0) {

1756 
	`årštf
(
¡d”r
,"I/O Error„eading RDB…ayload from socket\n");

1757 
	`ex™
(1);

1759 
nwr™‹n
 = 
	`wr™e
(
fd
, 
buf
, 
Ä—d
);

1760 ià(
nwr™‹n
 !ğ
Ä—d
) {

1761 
	`årštf
(
¡d”r
,"Error writing datao file: %s\n",

1762 
	`¡»¼Ü
(
”ºo
));

1763 
	`ex™
(1);

1765 
·ylßd
 -ğ
Ä—d
;

1767 
	`şo£
(
s
);

1768 
	`fsync
(
fd
);

1769 
	`årštf
(
¡d”r
,"Transfer finished with success.\n");

1770 
	`ex™
(0);

1771 
	}
}

1777 
	#PIPEMODE_WRITE_LOOP_MAX_BYTES
 (128*1024)

	)

1778 
	$peMode
() {

1779 
fd
 = 
cÚ‹xt
->fd;

1780 
”rÜs
 = 0, 
»¶›s
 = 0, 
obuf_Ën
 = 0, 
obuf_pos
 = 0;

1781 
ibuf
[1024*16], 
obuf
[1024*16];

1782 
ª‘”r
[
ANET_ERR_LEN
];

1783 
»disR—d”
 *
»ad”
 = 
	`»disR—d”C»©e
();

1784 
»disR•ly
 *
»¶y
;

1785 
eof
 = 0;

1786 
dÚe
 = 0;

1787 
magic
[20];

1788 
time_t
 
Ï¡_»ad_time
 = 
	`time
(
NULL
);

1790 
	`¤ªd
(
	`time
(
NULL
));

1793 ià(
	`ª‘NÚBlock
(
ª‘”r
,
fd
è=ğ
ANET_ERR
) {

1794 
	`årštf
(
¡d”r
, "Can't sethe socket in‚on blocking mode: %s\n",

1795 
ª‘”r
);

1796 
	`ex™
(1);

1801 !
dÚe
) {

1802 
mask
 = 
AE_READABLE
;

1804 ià(!
eof
 || 
obuf_Ën
 !ğ0è
mask
 |ğ
AE_WRITABLE
;

1805 
mask
 = 
	`«Wa™
(
fd
,mask,1000);

1808 ià(
mask
 & 
AE_READABLE
) {

1809 
ssize_t
 
Ä—d
;

1813 
Ä—d
 = 
	`»ad
(
fd
,
ibuf
,(ibuf));

1814 ià(
Ä—d
 =ğ-1 && 
”ºo
 !ğ
EAGAIN
 &&ƒ¼nØ!ğ
EINTR
) {

1815 
	`årštf
(
¡d”r
, "Error„eading fromhe server: %s\n",

1816 
	`¡»¼Ü
(
”ºo
));

1817 
	`ex™
(1);

1819 ià(
Ä—d
 > 0) {

1820 
	`»disR—d”F“d
(
»ad”
,
ibuf
,
Ä—d
);

1821 
Ï¡_»ad_time
 = 
	`time
(
NULL
);

1823 } 
Ä—d
 > 0);

1827 ià(
	`»disR—d”G‘R•ly
(
»ad”
,(**)&
»¶y
è=ğ
REDIS_ERR
) {

1828 
	`årštf
(
¡d”r
, "Error„eading„eplies from server\n");

1829 
	`ex™
(1);

1831 ià(
»¶y
) {

1832 ià(
»¶y
->
ty³
 =ğ
REDIS_REPLY_ERROR
) {

1833 
	`årštf
(
¡d”r
,"%s\n", 
»¶y
->
¡r
);

1834 
”rÜs
++;

1835 } ià(
eof
 && 
»¶y
->
ty³
 =ğ
REDIS_REPLY_STRING
 &&

1836 
»¶y
->
Ën
 == 20) {

1840 ià(
	`memcmp
(
»¶y
->
¡r
,
magic
,20) == 0) {

1841 
	`´štf
("Last„eply„eceived from server.\n");

1842 
dÚe
 = 1;

1843 
»¶›s
--;

1846 
»¶›s
++;

1847 
	`ä“R•lyObjeù
(
»¶y
);

1849 } 
»¶y
);

1853 ià(
mask
 & 
AE_WRITABLE
) {

1854 
ssize_t
 
loİ_nwr™‹n
 = 0;

1858 ià(
obuf_Ën
 != 0) {

1859 
ssize_t
 
nwr™‹n
 = 
	`wr™e
(
fd
,
obuf
+
obuf_pos
,
obuf_Ën
);

1861 ià(
nwr™‹n
 == -1) {

1862 ià(
”ºo
 !ğ
EAGAIN
 &&ƒ¼nØ!ğ
EINTR
) {

1863 
	`årštf
(
¡d”r
, "Error writingohe server: %s\n",

1864 
	`¡»¼Ü
(
”ºo
));

1865 
	`ex™
(1);

1867 
nwr™‹n
 = 0;

1870 
obuf_Ën
 -ğ
nwr™‹n
;

1871 
obuf_pos
 +ğ
nwr™‹n
;

1872 
loİ_nwr™‹n
 +ğ
nwr™‹n
;

1873 ià(
obuf_Ën
 != 0) ;

1876 ià(
obuf_Ën
 =ğ0 && !
eof
) {

1877 
ssize_t
 
Ä—d
 = 
	`»ad
(
STDIN_FILENO
,
obuf
,(obuf));

1879 ià(
Ä—d
 == 0) {

1884 
echo
[] =

1886 
j
;

1888 
eof
 = 1;

1892 
j
 = 0; j < 20; j++)

1893 
magic
[
j
] = 
	`¿nd
() & 0xff;

1894 
	`memıy
(
echo
+21,
magic
,20);

1895 
	`memıy
(
obuf
,
echo
,(echo)-1);

1896 
obuf_Ën
 = (
echo
)-1;

1897 
obuf_pos
 = 0;

1898 
	`´štf
("All dataransferred. Waiting forhe†ast„eply...\n");

1899 } ià(
Ä—d
 == -1) {

1900 
	`årštf
(
¡d”r
, "Error„eading from stdin: %s\n",

1901 
	`¡»¼Ü
(
”ºo
));

1902 
	`ex™
(1);

1904 
obuf_Ën
 = 
Ä—d
;

1905 
obuf_pos
 = 0;

1908 ià((
obuf_Ën
 =ğ0 && 
eof
) ||

1909 
loİ_nwr™‹n
 > 
PIPEMODE_WRITE_LOOP_MAX_BYTES
) ;

1916 ià(
eof
 && 
cÚfig
.
pe_timeout
 > 0 &&

1917 
	`time
(
NULL
)-
Ï¡_»ad_time
 > 
cÚfig
.
pe_timeout
)

1919 
	`årštf
(
¡d”r
,"No„eplies for %d seconds:ƒxiting.\n",

1920 
cÚfig
.
pe_timeout
);

1921 
”rÜs
++;

1925 
	`»disR—d”F»e
(
»ad”
);

1926 
	`´štf
("”rÜs: %Îd,„•l›s: %Îd\n", 
”rÜs
, 
»¶›s
);

1927 ià(
”rÜs
)

1928 
	`ex™
(1);

1930 
	`ex™
(0);

1931 
	}
}

1937 
	#TYPE_STRING
 0

	)

1938 
	#TYPE_LIST
 1

	)

1939 
	#TYPE_SET
 2

	)

1940 
	#TYPE_HASH
 3

	)

1941 
	#TYPE_ZSET
 4

	)

1942 
	#TYPE_NONE
 5

	)

1944 
»disR•ly
 *
	$£ndSÿn
(*
™
) {

1945 
»disR•ly
 *
»¶y
 = 
	`»disCommªd
(
cÚ‹xt
, "SCAN %Îu", *
™
);

1948 if(
»¶y
 =ğ
NULL
) {

1949 
	`årštf
(
¡d”r
, "\nI/Oƒrror\n");

1950 
	`ex™
(1);

1951 } if(
»¶y
->
ty³
 =ğ
REDIS_REPLY_ERROR
) {

1952 
	`årštf
(
¡d”r
, "SCANƒ¼Ü: %s\n", 
»¶y
->
¡r
);

1953 
	`ex™
(1);

1954 } if(
»¶y
->
ty³
 !ğ
REDIS_REPLY_ARRAY
) {

1955 
	`årštf
(
¡d”r
, "Non ARRAY„esponse from SCAN!\n");

1956 
	`ex™
(1);

1957 } if(
»¶y
->
–em’ts
 != 2) {

1958 
	`årštf
(
¡d”r
, "Invalidƒlement count from SCAN!\n");

1959 
	`ex™
(1);

1963 
	`as£¹
(
»¶y
->
–em’t
[0]->
ty³
 =ğ
REDIS_REPLY_STRING
);

1964 
	`as£¹
(
»¶y
->
–em’t
[1]->
ty³
 =ğ
REDIS_REPLY_ARRAY
);

1967 *
™
 = 
	`¡¹ouÎ
(
»¶y
->
–em’t
[0]->
¡r
, 
NULL
, 10);

1969  
»¶y
;

1970 
	}
}

1972 
	$g‘DbSize
() {

1973 
»disR•ly
 *
»¶y
;

1974 
size
;

1976 
»¶y
 = 
	`»disCommªd
(
cÚ‹xt
, "DBSIZE");

1978 if(
»¶y
 =ğ
NULL
 ||„•ly->
ty³
 !ğ
REDIS_REPLY_INTEGER
) {

1979 
	`årštf
(
¡d”r
, "Couldn't determine DBSIZE!\n");

1980 
	`ex™
(1);

1984 
size
 = 
»¶y
->
š‹g”
;

1985 
	`ä“R•lyObjeù
(
»¶y
);

1987  
size
;

1988 
	}
}

1990 
	$toIÁTy³
(*
key
, *
ty³
) {

1991 if(!
	`¡rcmp
(
ty³
, "string")) {

1992  
TYPE_STRING
;

1993 } if(!
	`¡rcmp
(
ty³
, "list")) {

1994  
TYPE_LIST
;

1995 } if(!
	`¡rcmp
(
ty³
, "set")) {

1996  
TYPE_SET
;

1997 } if(!
	`¡rcmp
(
ty³
, "hash")) {

1998  
TYPE_HASH
;

1999 } if(!
	`¡rcmp
(
ty³
, "zset")) {

2000  
TYPE_ZSET
;

2001 } if(!
	`¡rcmp
(
ty³
, "none")) {

2002  
TYPE_NONE
;

2004 
	`årštf
(
¡d”r
, "UnknowÀty³ '%s' fÜ key '%s'\n", 
ty³
, 
key
);

2005 
	`ex™
(1);

2007 
	}
}

2009 
	$g‘KeyTy³s
(
»disR•ly
 *
keys
, *
ty³s
) {

2010 
»disR•ly
 *
»¶y
;

2011 
i
;

2014 
i
=0;i<
keys
->
–em’ts
;i++) {

2015 
	`»disAµ’dCommªd
(
cÚ‹xt
, "TYPE %s", 
keys
->
–em’t
[
i
]->
¡r
);

2019 
i
=0;i<
keys
->
–em’ts
;i++) {

2020 if(
	`»disG‘R•ly
(
cÚ‹xt
, (**)&
»¶y
)!=
REDIS_OK
) {

2021 
	`årštf
(
¡d”r
, "Error gettingype for key '%s' (%d: %s)\n",

2022 
keys
->
–em’t
[
i
]->
¡r
, 
cÚ‹xt
->
”r
, cÚ‹xt->
”r¡r
);

2023 
	`ex™
(1);

2024 } if(
»¶y
->
ty³
 !ğ
REDIS_REPLY_STATUS
) {

2025 
	`årštf
(
¡d”r
, "Invalid„eplyype (%d) for TYPE on key '%s'!\n",

2026 
»¶y
->
ty³
, 
keys
->
–em’t
[
i
]->
¡r
);

2027 
	`ex™
(1);

2030 
ty³s
[
i
] = 
	`toIÁTy³
(
keys
->
–em’t
[i]->
¡r
, 
»¶y
->str);

2031 
	`ä“R•lyObjeù
(
»¶y
);

2033 
	}
}

2035 
	$g‘KeySizes
(
»disR•ly
 *
keys
, *
ty³s
,

2036 *
sizes
)

2038 
»disR•ly
 *
»¶y
;

2039 *
sizecmds
[] = {"STRLEN","LLEN","SCARD","HLEN","ZCARD"};

2040 
i
;

2043 
i
=0;i<
keys
->
–em’ts
;i++) {

2045 if(
ty³s
[
i
]==
TYPE_NONE
)

2048 
	`»disAµ’dCommªd
(
cÚ‹xt
, "% %s", 
sizecmds
[
ty³s
[
i
]],

2049 
keys
->
–em’t
[
i
]->
¡r
);

2053 
i
=0;i<
keys
->
–em’ts
;i++) {

2055 if(
ty³s
[
i
] =ğ
TYPE_NONE
) {

2056 
sizes
[
i
] = 0;

2061 if(
	`»disG‘R•ly
(
cÚ‹xt
, (**)&
»¶y
)!=
REDIS_OK
) {

2062 
	`årštf
(
¡d”r
, "Error getting size for key '%s' (%d: %s)\n",

2063 
keys
->
–em’t
[
i
]->
¡r
, 
cÚ‹xt
->
”r
, cÚ‹xt->
”r¡r
);

2064 
	`ex™
(1);

2065 } if(
»¶y
->
ty³
 !ğ
REDIS_REPLY_INTEGER
) {

2068 
	`årštf
(
¡d”r
,

2070 
sizecmds
[
ty³s
[
i
]], 
keys
->
–em’t
[i]->
¡r
);

2071 
sizes
[
i
] = 0;

2073 
sizes
[
i
] = 
»¶y
->
š‹g”
;

2076 
	`ä“R•lyObjeù
(
»¶y
);

2078 
	}
}

2080 
	$fšdBigKeys
() {

2081 
bigge¡
[5] = {0}, 
couÁs
[5] = {0}, 
tÙ®size
[5] = {0};

2082 
§m¶ed
 = 0, 
tÙ®_keys
, 
tÙËn
=0, *
sizes
=
NULL
, 
™
=0;

2083 
sds
 
maxkeys
[5] = {0};

2084 *
ty³Çme
[] = {"string","list","set","hash","zset"};

2085 *
ty³un™
[] = {"bytes","items","members","fields","members"};

2086 
»disR•ly
 *
»¶y
, *
keys
;

2087 
¬rsize
=0, 
i
;

2088 
ty³
, *
ty³s
=
NULL
;

2089 
pù
;

2092 
tÙ®_keys
 = 
	`g‘DbSize
();

2095 
	`´štf
("\n# Scanningheƒntire keyspaceo find biggest keys‡s well‡s\n");

2096 
	`´štf
("#‡verage sizes…er keyype. You can use -i 0.1o sleep 0.1 sec\n");

2097 
	`´štf
("#…er 100 SCAN commands (not usually‚eeded).\n\n");

2100 
i
=0;i<
TYPE_NONE
; i++) {

2101 
maxkeys
[
i
] = 
	`sd£m±y
();

2102 if(!
maxkeys
[
i
]) {

2103 
	`årštf
(
¡d”r
, "Failedo‡llocate memory for†argest key‚ames!\n");

2104 
	`ex™
(1);

2111 
pù
 = 100 * ()
§m¶ed
/
tÙ®_keys
;

2114 
»¶y
 = 
	`£ndSÿn
(&
™
);

2115 
keys
 = 
»¶y
->
–em’t
[1];

2118 if(
keys
->
–em’ts
 > 
¬rsize
) {

2119 
ty³s
 = 
	`z»®loc
Ñy³s, ()*
keys
->
–em’ts
);

2120 
sizes
 = 
	`z»®loc
(sizes, ()*
keys
->
–em’ts
);

2122 if(!
ty³s
 || !
sizes
) {

2123 
	`årštf
(
¡d”r
, "Failedo‡llocate storage for keys!\n");

2124 
	`ex™
(1);

2127 
¬rsize
 = 
keys
->
–em’ts
;

2131 
	`g‘KeyTy³s
(
keys
, 
ty³s
);

2132 
	`g‘KeySizes
(
keys
, 
ty³s
, 
sizes
);

2135 
i
=0;i<
keys
->
–em’ts
;i++) {

2136 if((
ty³
 = 
ty³s
[
i
]è=ğ
TYPE_NONE
)

2139 
tÙ®size
[
ty³
] +ğ
sizes
[
i
];

2140 
couÁs
[
ty³
]++;

2141 
tÙËn
 +ğ
keys
->
–em’t
[
i
]->
Ën
;

2142 
§m¶ed
++;

2144 if(
bigge¡
[
ty³
]<
sizes
[
i
]) {

2145 
	`´štf
(

2147 
pù
, 
ty³Çme
[
ty³
], 
keys
->
–em’t
[
i
]->
¡r
, 
sizes
[i],

2148 
ty³un™
[
ty³
]);

2151 
maxkeys
[
ty³
] = 
	`sdsıy
(maxkeys[ty³], 
keys
->
–em’t
[
i
]->
¡r
);

2152 if(!
maxkeys
[
ty³
]) {

2153 
	`årštf
(
¡d”r
, "Failedo‡llocate memory for key!\n");

2154 
	`ex™
(1);

2158 
bigge¡
[
ty³
] = 
sizes
[
i
];

2162 if(
§m¶ed
 % 1000000 == 0) {

2163 
	`´štf
("[%05.2f%%] Sam¶ed %Îu key sØçr\n", 
pù
, 
§m¶ed
);

2168 if(
§m¶ed
 && (§m¶ed %100è=ğ0 && 
cÚfig
.
š‹rv®
) {

2169 
	`u¦“p
(
cÚfig
.
š‹rv®
);

2172 
	`ä“R•lyObjeù
(
»¶y
);

2173 } 
™
 != 0);

2175 if(
ty³s
è
	`zä“
(types);

2176 if(
sizes
è
	`zä“
(sizes);

2179 
	`´štf
("\n-------- summary -------\n\n");

2181 
	`´štf
("Sam¶ed %Îu key šhkey¥aû!\n", 
§m¶ed
);

2182 
	`´štf
("Total key†ength in bytes is %llu (avg†en %.2f)\n\n",

2183 
tÙËn
,ÙËÀ? (éÙËn/
§m¶ed
 : 0);

2186 
i
=0;i<
TYPE_NONE
;i++) {

2187 if(
	`sd¦’
(
maxkeys
[
i
])>0) {

2188 
	`´štf
("Bigge¡ %6 found '%s' ha %Îu %s\n", 
ty³Çme
[
i
], 
maxkeys
[i],

2189 
bigge¡
[
i
], 
ty³un™
[i]);

2193 
	`´štf
("\n");

2195 
i
=0;i<
TYPE_NONE
;i++) {

2196 
	`´štf
("%llu %ss with %llu %s (%05.2f%% of keys,‡vg size %.2f)\n",

2197 
couÁs
[
i
], 
ty³Çme
[i], 
tÙ®size
[i], 
ty³un™
[i],

2198 
§m¶ed
 ? 100 * ()
couÁs
[
i
]/sampled : 0,

2199 
couÁs
[
i
] ? ()
tÙ®size
[i]/counts[i] : 0);

2203 
i
=0;i<
TYPE_NONE
;i++) {

2204 
	`sdsä“
(
maxkeys
[
i
]);

2208 
	`ex™
(0);

2209 
	}
}

2218 *
	$g‘InfoF›ld
(*
šfo
, *
f›ld
) {

2219 *
p
 = 
	`¡r¡r
(
šfo
,
f›ld
);

2220 *
n1
, *
n2
;

2221 *
»suÉ
;

2223 ià(!
p
è 
NULL
;

2224 
p
 +ğ
	`¡¾’
(
f›ld
)+1;

2225 
n1
 = 
	`¡rchr
(
p
,'\r');

2226 
n2
 = 
	`¡rchr
(
p
,',');

2227 ià(
n2
 &&‚2 < 
n1
)‚1 =‚2;

2228 
»suÉ
 = 
	`zm®loc
(()*(
n1
-
p
)+1);

2229 
	`memıy
(
»suÉ
,
p
,(
n1
-p));

2230 
»suÉ
[
n1
-
p
] = '\0';

2231  
»suÉ
;

2232 
	}
}

2236 
	$g‘LÚgInfoF›ld
(*
šfo
, *
f›ld
) {

2237 *
v®ue
 = 
	`g‘InfoF›ld
(
šfo
,
f›ld
);

2238 
l
;

2240 ià(!
v®ue
è 
LONG_MIN
;

2241 
l
 = 
	`¡¹Ş
(
v®ue
,
NULL
,10);

2242 
	`zä“
(
v®ue
);

2243  
l
;

2244 
	}
}

2248 
	$by‹sToHumª
(*
s
, 
n
) {

2249 
d
;

2251 ià(
n
 < 0) {

2252 *
s
 = '-';

2253 
s
++;

2254 
n
 = -n;

2256 ià(
n
 < 1024) {

2258 
	`¥rštf
(
s
,"%ÎdB",
n
);

2260 } ià(
n
 < (1024*1024)) {

2261 
d
 = ()
n
/(1024);

2262 
	`¥rštf
(
s
,"%.2fK",
d
);

2263 } ià(
n
 < (1024LL*1024*1024)) {

2264 
d
 = ()
n
/(1024*1024);

2265 
	`¥rštf
(
s
,"%.2fM",
d
);

2266 } ià(
n
 < (1024LL*1024*1024*1024)) {

2267 
d
 = ()
n
/(1024LL*1024*1024);

2268 
	`¥rštf
(
s
,"%.2fG",
d
);

2270 
	}
}

2272 
	$¡©Mode
() {

2273 
»disR•ly
 *
»¶y
;

2274 
aux
, 
»que¡s
 = 0;

2275 
i
 = 0;

2278 
buf
[64];

2279 
j
;

2281 
»¶y
 = 
	`»cÚÃùšgRedisCommªd
(
cÚ‹xt
,"INFO");

2282 ià(
»¶y
->
ty³
 =ğ
REDIS_REPLY_ERROR
) {

2283 
	`´štf
("ERROR: %s\n", 
»¶y
->
¡r
);

2284 
	`ex™
(1);

2287 ià((
i
++ % 20) == 0) {

2288 
	`´štf
(

2294 
aux
 = 0;

2295 
j
 = 0; j < 20; j++) {

2296 
k
;

2298 
	`¥rštf
(
buf
,"db%d:keys",
j
);

2299 
k
 = 
	`g‘LÚgInfoF›ld
(
»¶y
->
¡r
,
buf
);

2300 ià(
k
 =ğ
LONG_MIN
) ;

2301 
aux
 +ğ
k
;

2303 
	`¥rštf
(
buf
,"%ld",
aux
);

2304 
	`´štf
("%-11s",
buf
);

2307 
aux
 = 
	`g‘LÚgInfoF›ld
(
»¶y
->
¡r
,"used_memory");

2308 
	`by‹sToHumª
(
buf
,
aux
);

2309 
	`´štf
("%-8s",
buf
);

2312 
aux
 = 
	`g‘LÚgInfoF›ld
(
»¶y
->
¡r
,"connected_clients");

2313 
	`¥rštf
(
buf
,"%ld",
aux
);

2314 
	`´štf
(" %-8s",
buf
);

2317 
aux
 = 
	`g‘LÚgInfoF›ld
(
»¶y
->
¡r
,"blocked_clients");

2318 
	`¥rštf
(
buf
,"%ld",
aux
);

2319 
	`´štf
("%-8s",
buf
);

2322 
aux
 = 
	`g‘LÚgInfoF›ld
(
»¶y
->
¡r
,"total_commands_processed");

2323 
	`¥rštf
(
buf
,"%ld (+%ld)",
aux
,
»que¡s
 == 0 ? 0 :‡ux-requests);

2324 
	`´štf
("%-19s",
buf
);

2325 
»que¡s
 = 
aux
;

2328 
aux
 = 
	`g‘LÚgInfoF›ld
(
»¶y
->
¡r
,"total_connections_received");

2329 
	`¥rštf
(
buf
,"%ld",
aux
);

2330 
	`´štf
(" %-12s",
buf
);

2333 
aux
 = 
	`g‘LÚgInfoF›ld
(
»¶y
->
¡r
,"bgsave_in_progress");

2334 
aux
 |ğ
	`g‘LÚgInfoF›ld
(
»¶y
->
¡r
,"aof_rewrite_in_progress") << 1;

2335 
aux
 |ğ
	`g‘LÚgInfoF›ld
(
»¶y
->
¡r
,"loading") << 2;

2336 
aux
) {

2339 
	`´štf
("SAVE");

2342 
	`´štf
("AOF");

2345 
	`´štf
("SAVE+AOF");

2348 
	`´štf
("LOAD");

2352 
	`´štf
("\n");

2353 
	`ä“R•lyObjeù
(
»¶y
);

2354 
	`u¦“p
(
cÚfig
.
š‹rv®
);

2356 
	}
}

2362 
	$sÿnMode
() {

2363 
»disR•ly
 *
»¶y
;

2364 
cur
 = 0;

2367 ià(
cÚfig
.
·‰”n
)

2368 
»¶y
 = 
	`»disCommªd
(
cÚ‹xt
,"SCAN %llu MATCH %s",

2369 
cur
,
cÚfig
.
·‰”n
);

2371 
»¶y
 = 
	`»disCommªd
(
cÚ‹xt
,"SCAN %Îu",
cur
);

2372 ià(
»¶y
 =ğ
NULL
) {

2373 
	`´štf
("I/Oƒrror\n");

2374 
	`ex™
(1);

2375 } ià(
»¶y
->
ty³
 =ğ
REDIS_REPLY_ERROR
) {

2376 
	`´štf
("ERROR: %s\n", 
»¶y
->
¡r
);

2377 
	`ex™
(1);

2379 
j
;

2381 
cur
 = 
	`¡¹ouÎ
(
»¶y
->
–em’t
[0]->
¡r
,
NULL
,10);

2382 
j
 = 0; j < 
»¶y
->
–em’t
[1]->
–em’ts
; j++)

2383 
	`´štf
("%s\n", 
»¶y
->
–em’t
[1]->–em’t[
j
]->
¡r
);

2385 
	`ä“R•lyObjeù
(
»¶y
);

2386 } 
cur
 != 0);

2388 
	`ex™
(0);

2389 
	}
}

2401 
	$pow”LawRªd
(
mš
, 
max
, 
®pha
) {

2402 
¶
, 
r
;

2404 
max
 += 1;

2405 
r
 = (()
	`¿nd
()è/ 
RAND_MAX
;

2406 
¶
 = 
	`pow
(

2407 ((
	`pow
(
max
,
®pha
+1è-…ow(
mš
,®pha+1))*
r
 +…ow(min,alpha+1)),

2408 (1.0/(
®pha
+1)));

2409  (
max
-1-()
¶
)+
mš
;

2410 
	}
}

2414 
	$LRUTe¡G’Key
(*
buf
, 
size_t
 
buæ’
) {

2415 
	`¢´štf
(
buf
, 
buæ’
, "lru:%lld\n",

2416 
	`pow”LawRªd
(1, 
cÚfig
.
Ìu_‹¡_§m¶e_size
, 6.2));

2417 
	}
}

2419 
	#LRU_CYCLE_PERIOD
 1000

	)

2420 
	#LRU_CYCLE_PIPELINE_SIZE
 250

	)

2421 
	$LRUTe¡Mode
() {

2422 
»disR•ly
 *
»¶y
;

2423 
key
[128];

2424 
¡¬t_cyşe
;

2425 
j
;

2427 
	`¤ªd
(
	`time
(
NULL
)^
	`g‘pid
());

2432 
¡¬t_cyşe
 = 
	`m¡ime
();

2433 
h™s
 = 0, 
mis£s
 = 0;

2434 
	`m¡ime
(è- 
¡¬t_cyşe
 < 1000) {

2436 
j
 = 0; j < 
LRU_CYCLE_PIPELINE_SIZE
; j++) {

2437 
	`LRUTe¡G’Key
(
key
,(key));

2438 
	`»disAµ’dCommªd
(
cÚ‹xt
, "SET % v®",
key
);

2440 
j
 = 0; j < 
LRU_CYCLE_PIPELINE_SIZE
; j++)

2441 
	`»disG‘R•ly
(
cÚ‹xt
, (**)&
»¶y
);

2444 
j
 = 0; j < 
LRU_CYCLE_PIPELINE_SIZE
; j++) {

2445 
	`LRUTe¡G’Key
(
key
,(key));

2446 
	`»disAµ’dCommªd
(
cÚ‹xt
, "GET %s",
key
);

2448 
j
 = 0; j < 
LRU_CYCLE_PIPELINE_SIZE
; j++) {

2449 ià(
	`»disG‘R•ly
(
cÚ‹xt
, (**)&
»¶y
è=ğ
REDIS_OK
) {

2450 
»¶y
->
ty³
) {

2451 
REDIS_REPLY_ERROR
:

2452 
	`´štf
("%s\n", 
»¶y
->
¡r
);

2454 
REDIS_REPLY_NIL
:

2455 
mis£s
++;

2458 
h™s
++;

2464 ià(
cÚ‹xt
->
”r
) {

2465 
	`årštf
(
¡d”r
,"I/Oƒrror during LRUest\n");

2466 
	`ex™
(1);

2470 
	`´štf
(

2472 
h™s
+
mis£s
,

2473 
h™s
, ()h™s/(h™s+
mis£s
)*100,

2474 
mis£s
, ()mis£s/(
h™s
+misses)*100);

2476 
	`ex™
(0);

2477 
	}
}

2490 
	$compu‹_som‘hšg_ç¡
() {

2491 
s
[256], 
i
, 
j
, 
t
;

2492 
couÁ
 = 1000, 
k
;

2493 
ouut
 = 0;

2495 
k
 = 0; k < 256; k++è
s
[k] = k;

2497 
i
 = 0;

2498 
j
 = 0;

2499 
couÁ
--) {

2500 
i
++;

2501 
j
 = j + 
s
[
i
];

2502 
t
 = 
s
[
i
];

2503 
s
[
i
] = s[
j
];

2504 
s
[
j
] = 
t
;

2505 
ouut
 +ğ
s
[(s[
i
]+s[
j
])&255];

2507  
ouut
;

2508 
	}
}

2510 
	$šŒšsicL©’cyModeStİ
(
s
) {

2511 
	`UNUSED
(
s
);

2512 
fÜû_ÿnûl_loİ
 = 1;

2513 
	}
}

2515 
	$šŒšsicL©’cyMode
() {

2516 
‹¡_’d
, 
run_time
, 
max_Ï‹ncy
 = 0, 
runs
 = 0;

2518 
run_time
 = 
cÚfig
.
šŒšsic_Ï‹ncy_du¿tiÚ
*1000000;

2519 
‹¡_’d
 = 
	`u¡ime
(è+ 
run_time
;

2520 
	`sigÇl
(
SIGINT
, 
šŒšsicL©’cyModeStİ
);

2523 
¡¬t
, 
’d
, 
Ï‹ncy
;

2525 
¡¬t
 = 
	`u¡ime
();

2526 
	`compu‹_som‘hšg_ç¡
();

2527 
’d
 = 
	`u¡ime
();

2528 
Ï‹ncy
 = 
’d
-
¡¬t
;

2529 
runs
++;

2530 ià(
Ï‹ncy
 <= 0) ;

2533 ià(
Ï‹ncy
 > 
max_Ï‹ncy
) {

2534 
max_Ï‹ncy
 = 
Ï‹ncy
;

2535 
	`´štf
("Max†©’cy sØçr: %Îd miüo£cÚds.\n", 
max_Ï‹ncy
);

2538 
avg_us
 = ()
run_time
/
runs
;

2539 
avg_ns
 = 
avg_us
 * 1e3;

2540 ià(
fÜû_ÿnûl_loİ
 || 
’d
 > 
‹¡_’d
) {

2541 
	`´štf
("\n%lldotal„uns "

2544 
runs
, 
avg_us
, 
avg_ns
);

2545 
	`´štf
("Worst„unook %.0fx†ongerhanhe‡verage†atency.\n",

2546 
max_Ï‹ncy
 / 
avg_us
);

2547 
	`ex™
(0);

2550 
	}
}

2556 
	$maš
(
¬gc
, **
¬gv
) {

2557 
fœ¡¬g
;

2559 
cÚfig
.
ho¡
 = 
	`sd¢ew
("127.0.0.1");

2560 
cÚfig
.
ho¡pÜt
 = 6379;

2561 
cÚfig
.
ho¡sock‘
 = 
NULL
;

2562 
cÚfig
.
»³©
 = 1;

2563 
cÚfig
.
š‹rv®
 = 0;

2564 
cÚfig
.
dbnum
 = 0;

2565 
cÚfig
.
š‹¿ùive
 = 0;

2566 
cÚfig
.
shutdown
 = 0;

2567 
cÚfig
.
mÚ™Ü_mode
 = 0;

2568 
cÚfig
.
pubsub_mode
 = 0;

2569 
cÚfig
.
Ï‹ncy_mode
 = 0;

2570 
cÚfig
.
Ï‹ncy_di¡_mode
 = 0;

2571 
cÚfig
.
Ï‹ncy_hi¡Üy
 = 0;

2572 
cÚfig
.
Ìu_‹¡_mode
 = 0;

2573 
cÚfig
.
Ìu_‹¡_§m¶e_size
 = 0;

2574 
cÚfig
.
şu¡”_mode
 = 0;

2575 
cÚfig
.
¦ave_mode
 = 0;

2576 
cÚfig
.
g‘rdb_mode
 = 0;

2577 
cÚfig
.
¡©_mode
 = 0;

2578 
cÚfig
.
sÿn_mode
 = 0;

2579 
cÚfig
.
šŒšsic_Ï‹ncy_mode
 = 0;

2580 
cÚfig
.
·‰”n
 = 
NULL
;

2581 
cÚfig
.
rdb_f’ame
 = 
NULL
;

2582 
cÚfig
.
pe_mode
 = 0;

2583 
cÚfig
.
pe_timeout
 = 
REDIS_CLI_DEFAULT_PIPE_TIMEOUT
;

2584 
cÚfig
.
bigkeys
 = 0;

2585 
cÚfig
.
¡dš¬g
 = 0;

2586 
cÚfig
.
auth
 = 
NULL
;

2587 
cÚfig
.
ev®
 = 
NULL
;

2588 
cÚfig
.
ev®_ldb
 = 0;

2589 
cÚfig
.
ev®_ldb_’d
 = 0;

2590 
cÚfig
.
ev®_ldb_sync
 = 0;

2591 
cÚfig
.
’abË_ldb_Ú_ev®
 = 0;

2592 
cÚfig
.
Ï¡_cmd_ty³
 = -1;

2594 
´ef
.
hšts
 = 1;

2596 
¥eùrum_·Ë‰e
 = 
¥eùrum_·Ë‰e_cŞÜ
;

2597 
¥eùrum_·Ë‰e_size
 = 
¥eùrum_·Ë‰e_cŞÜ_size
;

2599 ià(!
	`i§‰y
(
	`f’o
(
¡dout
)è&& (
	`g‘’v
("FAKETTY"è=ğ
NULL
))

2600 
cÚfig
.
ouut
 = 
OUTPUT_RAW
;

2602 
cÚfig
.
ouut
 = 
OUTPUT_STANDARD
;

2603 
cÚfig
.
mb_d–im
 = 
	`sd¢ew
("\n");

2605 
fœ¡¬g
 = 
	`·r£O±iÚs
(
¬gc
,
¬gv
);

2606 
¬gc
 -ğ
fœ¡¬g
;

2607 
¬gv
 +ğ
fœ¡¬g
;

2610 ià(
cÚfig
.
Ï‹ncy_mode
) {

2611 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
è
	`ex™
(1);

2612 
	`Ï‹ncyMode
();

2616 ià(
cÚfig
.
Ï‹ncy_di¡_mode
) {

2617 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
è
	`ex™
(1);

2618 
	`Ï‹ncyDi¡Mode
();

2622 ià(
cÚfig
.
¦ave_mode
) {

2623 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
è
	`ex™
(1);

2624 
	`¦aveMode
();

2628 ià(
cÚfig
.
g‘rdb_mode
) {

2629 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
è
	`ex™
(1);

2630 
	`g‘RDB
();

2634 ià(
cÚfig
.
pe_mode
) {

2635 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
è
	`ex™
(1);

2636 
	`peMode
();

2640 ià(
cÚfig
.
bigkeys
) {

2641 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
è
	`ex™
(1);

2642 
	`fšdBigKeys
();

2646 ià(
cÚfig
.
¡©_mode
) {

2647 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
è
	`ex™
(1);

2648 ià(
cÚfig
.
š‹rv®
 == 0) config.interval = 1000000;

2649 
	`¡©Mode
();

2653 ià(
cÚfig
.
sÿn_mode
) {

2654 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
è
	`ex™
(1);

2655 
	`sÿnMode
();

2659 ià(
cÚfig
.
Ìu_‹¡_mode
) {

2660 ià(
	`şiCÚÃù
(0è=ğ
REDIS_ERR
è
	`ex™
(1);

2661 
	`LRUTe¡Mode
();

2665 ià(
cÚfig
.
šŒšsic_Ï‹ncy_mode
è
	`šŒšsicL©’cyMode
();

2668 ià(
¬gc
 =ğ0 && !
cÚfig
.
ev®
) {

2670 
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
);

2674 
	`şiCÚÃù
(0);

2675 
	`»¶
();

2679 ià(
	`şiCÚÃù
(0è!ğ
REDIS_OK
è
	`ex™
(1);

2680 ià(
cÚfig
.
ev®
) {

2681  
	`ev®Mode
(
¬gc
,
¬gv
);

2683  
	`nÚš‹¿ùive
(
¬gc
,
	`cÚv”tToSds
×rgc,
¬gv
));

2685 
	}
}

	@src/redisassert.h

38 #iâdeà
__REDIS_ASSERT_H__


39 
	#__REDIS_ASSERT_H__


	)

41 
	~<uni¡d.h
>

43 
	#as£¹
(
_e
è((_e)?()0 : (
	`_£rv”As£¹
(#_e,
__FILE__
,
__LINE__
),
	`_ex™
(1)))

	)

45 
_£rv”As£¹
(*
e¡r
, *
fe
, 
lše
);

	@src/release.c

34 
	~<¡ršg.h
>

36 
	~"»Ëa£.h
"

37 
	~"v”siÚ.h
"

38 
	~"üc64.h
"

40 *
	$»disG™SHA1
() {

41  
REDIS_GIT_SHA1
;

42 
	}
}

44 *
	$»disG™Dœty
() {

45  
REDIS_GIT_DIRTY
;

46 
	}
}

48 
ušt64_t
 
	$»disBudId
() {

49 *
budid
 = 
REDIS_VERSION
 
REDIS_BUILD_ID
 
REDIS_GIT_DIRTY
 
REDIS_GIT_SHA1
;

51  
	`üc64
(0,(*)
budid
,
	`¡¾’
(buildid));

52 
	}
}

	@src/release.h

1 
	#REDIS_GIT_SHA1
 "7b2e7b5c"

	)

2 
	#REDIS_GIT_DIRTY
 "45458"

	)

3 
	#REDIS_BUILD_ID
 "nvm01-1615342299"

	)

	@src/replication.c

32 
	~"£rv”.h
"

34 
	~<sys/time.h
>

35 
	~<uni¡d.h
>

36 
	~<fú.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/¡©.h
>

40 
»¶iÿtiÚDisÿrdCachedMa¡”
();

41 
»¶iÿtiÚResu¼eùCachedMa¡”
(
Ãwfd
);

42 
»¶iÿtiÚS’dAck
();

43 
putSÏveOÆše
(
ş›Á
 *
¦ave
);

44 
ÿnûlR•liÿtiÚHªdshake
();

52 *
	$»¶iÿtiÚG‘SÏveName
(
ş›Á
 *
c
) {

53 
buf
[
NET_PEER_ID_LEN
];

54 

[
NET_IP_STR_LEN
];

56 

[0] = '\0';

57 
buf
[0] = '\0';

58 ià(
c
->
¦ave_
[0] != '\0' ||

59 
	`ª‘P“rToSŒšg
(
c
->
fd
,

,(),
NULL
) != -1)

62 ià(
c
->
¦ave_
[0] !ğ'\0'è
	`memıy
(

,c->slave_ip,(c->slave_ip));

64 ià(
c
->
¦ave_li¡’šg_pÜt
)

65 
	`ª‘FÜm©Addr
(
buf
,(buf),

,
c
->
¦ave_li¡’šg_pÜt
);

67 
	`¢´štf
(
buf
,(buf),"%s:<unknown-¦ave-pÜt>",

);

69 
	`¢´štf
(
buf
,(buf),"client id #%llu",

70 (è
c
->
id
);

72  
buf
;

73 
	}
}

77 
	$ü—‹R•liÿtiÚBacklog
() {

78 
	`£rv”As£¹
(
£rv”
.
»¶_backlog
 =ğ
NULL
);

79 
£rv”
.
»¶_backlog
 = 
	`zm®loc
(£rv”.
»¶_backlog_size
);

80 
£rv”
.
»¶_backlog_hi¡Ën
 = 0;

81 
£rv”
.
»¶_backlog_idx
 = 0;

86 
£rv”
.
ma¡”_»¶_off£t
++;

91 
£rv”
.
»¶_backlog_off
 = s”v”.
ma¡”_»¶_off£t
+1;

92 
	}
}

100 
	$»sizeR•liÿtiÚBacklog
(
Ãwsize
) {

101 ià(
Ãwsize
 < 
CONFIG_REPL_BACKLOG_MIN_SIZE
)

102 
Ãwsize
 = 
CONFIG_REPL_BACKLOG_MIN_SIZE
;

103 ià(
£rv”
.
»¶_backlog_size
 =ğ
Ãwsize
) ;

105 
£rv”
.
»¶_backlog_size
 = 
Ãwsize
;

106 ià(
£rv”
.
»¶_backlog
 !ğ
NULL
) {

112 
	`zä“
(
£rv”
.
»¶_backlog
);

113 
£rv”
.
»¶_backlog
 = 
	`zm®loc
(£rv”.
»¶_backlog_size
);

114 
£rv”
.
»¶_backlog_hi¡Ën
 = 0;

115 
£rv”
.
»¶_backlog_idx
 = 0;

117 
£rv”
.
»¶_backlog_off
 = s”v”.
ma¡”_»¶_off£t
+1;

119 
	}
}

121 
	$ä“R•liÿtiÚBacklog
() {

122 
	`£rv”As£¹
(
	`li¡L’gth
(
£rv”
.
¦aves
) == 0);

123 
	`zä“
(
£rv”
.
»¶_backlog
);

124 
£rv”
.
»¶_backlog
 = 
NULL
;

125 
	}
}

131 
	$ãedR•liÿtiÚBacklog
(*
±r
, 
size_t
 
Ën
) {

132 *
p
 = 
±r
;

134 
£rv”
.
ma¡”_»¶_off£t
 +ğ
Ën
;

138 
Ën
) {

139 
size_t
 
thi¦’
 = 
£rv”
.
»¶_backlog_size
 - s”v”.
»¶_backlog_idx
;

140 ià(
thi¦’
 > 
Ën
)hislen =†en;

141 
	`memıy
(
£rv”
.
»¶_backlog
+£rv”.
»¶_backlog_idx
,
p
,
thi¦’
);

142 
£rv”
.
»¶_backlog_idx
 +ğ
thi¦’
;

143 ià(
£rv”
.
»¶_backlog_idx
 =ğ£rv”.
»¶_backlog_size
)

144 
£rv”
.
»¶_backlog_idx
 = 0;

145 
Ën
 -ğ
thi¦’
;

146 
p
 +ğ
thi¦’
;

147 
£rv”
.
»¶_backlog_hi¡Ën
 +ğ
thi¦’
;

149 ià(
£rv”
.
»¶_backlog_hi¡Ën
 > s”v”.
»¶_backlog_size
)

150 
£rv”
.
»¶_backlog_hi¡Ën
 = s”v”.
»¶_backlog_size
;

152 
£rv”
.
»¶_backlog_off
 = s”v”.
ma¡”_»¶_off£t
 -

153 
£rv”
.
»¶_backlog_hi¡Ën
 + 1;

154 
	}
}

158 
	$ãedR•liÿtiÚBacklogW™hObjeù
(
robj
 *
o
) {

159 
Î¡r
[
LONG_STR_SIZE
];

160 *
p
;

161 
size_t
 
Ën
;

163 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

164 
Ën
 = 
	`Î2¡ršg
(
Î¡r
,Öl¡r),()
o
->
±r
);

165 
p
 = 
Î¡r
;

167 
Ën
 = 
	`sd¦’
(
o
->
±r
);

168 
p
 = 
o
->
±r
;

170 
	`ãedR•liÿtiÚBacklog
(
p
,
Ën
);

171 
	}
}

173 
	$»¶iÿtiÚF“dSÏves
(
li¡
 *
¦aves
, 
diùid
, 
robj
 **
¬gv
, 
¬gc
) {

174 
li¡Node
 *
Ê
;

175 
li¡I‹r
 
li
;

176 
j
, 
Ën
;

177 
Î¡r
[
LONG_STR_SIZE
];

181 ià(
£rv”
.
»¶_backlog
 =ğ
NULL
 && 
	`li¡L’gth
(
¦aves
) == 0) ;

184 
	`£rv”As£¹
(!(
	`li¡L’gth
(
¦aves
è!ğ0 && 
£rv”
.
»¶_backlog
 =ğ
NULL
));

187 ià(
£rv”
.
¦ave£ldb
 !ğ
diùid
) {

188 
robj
 *
£Ëùcmd
;

191 ià(
diùid
 >ğ0 && diùid < 
PROTO_SHARED_SELECT_CMDS
) {

192 
£Ëùcmd
 = 
sh¬ed
.
£Ëù
[
diùid
];

194 
diùid_Ën
;

196 
diùid_Ën
 = 
	`Î2¡ršg
(
Î¡r
,Öl¡r),
diùid
);

197 
£Ëùcmd
 = 
	`ü—‹Objeù
(
OBJ_STRING
,

198 
	`sdsÿrštf
(
	`sd£m±y
(),

200 
diùid_Ën
, 
Î¡r
));

204 ià(
£rv”
.
»¶_backlog
è
	`ãedR•liÿtiÚBacklogW™hObjeù
(
£Ëùcmd
);

207 
	`li¡Rewšd
(
¦aves
,&
li
);

208 (
Ê
 = 
	`li¡Next
(&
li
))) {

209 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

210 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_START
) ;

211 
	`addR•ly
(
¦ave
,
£Ëùcmd
);

214 ià(
diùid
 < 0 || diùid >ğ
PROTO_SHARED_SELECT_CMDS
)

215 
	`deüRefCouÁ
(
£Ëùcmd
);

217 
£rv”
.
¦ave£ldb
 = 
diùid
;

220 ià(
£rv”
.
»¶_backlog
) {

221 
aux
[
LONG_STR_SIZE
+3];

224 
aux
[0] = '*';

225 
Ën
 = 
	`Î2¡ršg
(
aux
+1,×ux)-1,
¬gc
);

226 
aux
[
Ën
+1] = '\r';

227 
aux
[
Ën
+2] = '\n';

228 
	`ãedR•liÿtiÚBacklog
(
aux
,
Ën
+3);

230 
j
 = 0; j < 
¬gc
; j++) {

231 
objËn
 = 
	`¡ršgObjeùL’
(
¬gv
[
j
]);

236 
aux
[0] = '$';

237 
Ën
 = 
	`Î2¡ršg
(
aux
+1,×ux)-1,
objËn
);

238 
aux
[
Ën
+1] = '\r';

239 
aux
[
Ën
+2] = '\n';

240 
	`ãedR•liÿtiÚBacklog
(
aux
,
Ën
+3);

241 
	`ãedR•liÿtiÚBacklogW™hObjeù
(
¬gv
[
j
]);

242 
	`ãedR•liÿtiÚBacklog
(
aux
+
Ën
+1,2);

247 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

248 (
Ê
 = 
	`li¡Next
(&
li
))) {

249 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

252 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_START
) ;

259 
	`addR•lyMuÉiBulkL’
(
¦ave
,
¬gc
);

263 
j
 = 0; j < 
¬gc
; j++)

264 
	`addR•lyBulk
(
¦ave
,
¬gv
[
j
]);

266 
	}
}

268 
	$»¶iÿtiÚF“dMÚ™Üs
(
ş›Á
 *
c
, 
li¡
 *
mÚ™Üs
, 
diùid
, 
robj
 **
¬gv
, 
¬gc
) {

269 
li¡Node
 *
Ê
;

270 
li¡I‹r
 
li
;

271 
j
;

272 
sds
 
cmd»´
 = 
	`sd¢ew
("+");

273 
robj
 *
cmdobj
;

274 
timev®
 
tv
;

276 
	`g‘timeofday
(&
tv
,
NULL
);

277 
cmd»´
 = 
	`sdsÿrštf
(cmd»´,"%ld.%06ld ",()
tv
.
tv_£c
,(év.
tv_u£c
);

278 ià(
c
->
æags
 & 
CLIENT_LUA
) {

279 
cmd»´
 = 
	`sdsÿrštf
(cmd»´,"[%d†ua] ",
diùid
);

280 } ià(
c
->
æags
 & 
CLIENT_UNIX_SOCKET
) {

281 
cmd»´
 = 
	`sdsÿrštf
(cmd»´,"[%d unix:%s] ",
diùid
,
£rv”
.
unixsock‘
);

283 
cmd»´
 = 
	`sdsÿrštf
(cmd»´,"[%d %s] ",
diùid
,
	`g‘Cl›ÁP“rId
(
c
));

286 
j
 = 0; j < 
¬gc
; j++) {

287 ià(
¬gv
[
j
]->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

288 
cmd»´
 = 
	`sdsÿrštf
(cmd»´, "\"%ld\"", ()
¬gv
[
j
]->
±r
);

290 
cmd»´
 = 
	`sdsÿŒ•r
(cmd»´,(*)
¬gv
[
j
]->
±r
,

291 
	`sd¦’
(
¬gv
[
j
]->
±r
));

293 ià(
j
 !ğ
¬gc
-1)

294 
cmd»´
 = 
	`sdsÿ’
(cmdrepr," ",1);

296 
cmd»´
 = 
	`sdsÿ’
(cmdrepr,"\r\n",2);

297 
cmdobj
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
cmd»´
);

299 
	`li¡Rewšd
(
mÚ™Üs
,&
li
);

300 (
Ê
 = 
	`li¡Next
(&
li
))) {

301 
ş›Á
 *
mÚ™Ü
 = 
Ê
->
v®ue
;

302 
	`addR•ly
(
mÚ™Ü
,
cmdobj
);

304 
	`deüRefCouÁ
(
cmdobj
);

305 
	}
}

309 
	$addR•lyR•liÿtiÚBacklog
(
ş›Á
 *
c
, 
off£t
) {

310 
j
, 
sk
, 
Ën
;

312 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC] SÏv»que¡ off£t: %Îd", 
off£t
);

314 ià(
£rv”
.
»¶_backlog_hi¡Ën
 == 0) {

315 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC] Backlog history†en is zero");

319 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC] Backlog size: %lld",

320 
£rv”
.
»¶_backlog_size
);

321 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC] First byte: %lld",

322 
£rv”
.
»¶_backlog_off
);

323 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC] History†en: %lld",

324 
£rv”
.
»¶_backlog_hi¡Ën
);

325 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC] Current index: %lld",

326 
£rv”
.
»¶_backlog_idx
);

329 
sk
 = 
off£t
 - 
£rv”
.
»¶_backlog_off
;

330 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC] Skpšg: %Îd", 
sk
);

334 
j
 = (
£rv”
.
»¶_backlog_idx
 +

335 (
£rv”
.
»¶_backlog_size
-£rv”.
»¶_backlog_hi¡Ën
)) %

336 
£rv”
.
»¶_backlog_size
;

337 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC] Index oàfœ¡ by‹: %Îd", 
j
);

340 
j
 = (j + 
sk
è% 
£rv”
.
»¶_backlog_size
;

344 
Ën
 = 
£rv”
.
»¶_backlog_hi¡Ën
 - 
sk
;

345 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC] R•lyÙ®†’gth: %Îd", 
Ën
);

346 
Ën
) {

347 
thi¦’
 =

348 ((
£rv”
.
»¶_backlog_size
 - 
j
è< 
Ën
) ?

349 (
£rv”
.
»¶_backlog_size
 - 
j
è: 
Ën
;

351 
	`£rv”Log
(
LL_DEBUG
, "[PSYNC]‡ddR•ly(èËngth: %Îd", 
thi¦’
);

352 
	`addR•lySds
(
c
,
	`sd¢ewËn
(
£rv”
.
»¶_backlog
 + 
j
, 
thi¦’
));

353 
Ën
 -ğ
thi¦’
;

354 
j
 = 0;

356  
£rv”
.
»¶_backlog_hi¡Ën
 - 
sk
;

357 
	}
}

363 
	$g‘PsyncIn™ŸlOff£t
() {

364 
psync_off£t
 = 
£rv”
.
ma¡”_»¶_off£t
;

367 ià(
£rv”
.
»¶_backlog
 =ğ
NULL
è
psync_off£t
++;

368  
psync_off£t
;

369 
	}
}

387 
	$»¶iÿtiÚS‘upSÏveFÜFuÎResync
(
ş›Á
 *
¦ave
, 
off£t
) {

388 
buf
[128];

389 
buæ’
;

391 
¦ave
->
psync_š™Ÿl_off£t
 = 
off£t
;

392 
¦ave
->
»¶¡©e
 = 
SLAVE_STATE_WAIT_BGSAVE_END
;

396 
£rv”
.
¦ave£ldb
 = -1;

400 ià(!(
¦ave
->
æags
 & 
CLIENT_PRE_PSYNC
)) {

401 
buæ’
 = 
	`¢´štf
(
buf
,(buf),"+FULLRESYNC %s %lld\r\n",

402 
£rv”
.
runid
,
off£t
);

403 ià(
	`wr™e
(
¦ave
->
fd
,
buf
,
buæ’
) != buflen) {

404 
	`ä“Cl›ÁAsync
(
¦ave
);

405  
C_ERR
;

408  
C_OK
;

409 
	}
}

416 
	$ma¡”TryP¬tŸlResynchrÚiz©iÚ
(
ş›Á
 *
c
) {

417 
psync_off£t
, 
psync_Ën
;

418 *
ma¡”_runid
 = 
c
->
¬gv
[1]->
±r
;

419 
buf
[128];

420 
buæ’
;

425 ià(
	`¡rÿ£cmp
(
ma¡”_runid
, 
£rv”
.
runid
)) {

427 ià(
ma¡”_runid
[0] != '?') {

428 
	`£rv”Log
(
LL_NOTICE
,"Partial„esynchronization‚ot‡ccepted: "

430 
ma¡”_runid
, 
£rv”
.
runid
);

432 
	`£rv”Log
(
LL_NOTICE
,"Full„esync„equested by slave %s",

433 
	`»¶iÿtiÚG‘SÏveName
(
c
));

435 
Ãed_fuÎ_»sync
;

439 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
psync_off£t
,
NULL
) !=

440 
C_OK
è
Ãed_fuÎ_»sync
;

441 ià(!
£rv”
.
»¶_backlog
 ||

442 
psync_off£t
 < 
£rv”
.
»¶_backlog_off
 ||

443 
psync_off£t
 > (
£rv”
.
»¶_backlog_off
 + s”v”.
»¶_backlog_hi¡Ën
))

445 
	`£rv”Log
(
LL_NOTICE
,

446 "UÇbËØ·¹ŸÈ»synøw™h sÏv% fÜ†ack oàbacklog (SÏv»que¡ was: %Îd).", 
	`»¶iÿtiÚG‘SÏveName
(
c
), 
psync_off£t
);

447 ià(
psync_off£t
 > 
£rv”
.
ma¡”_»¶_off£t
) {

448 
	`£rv”Log
(
LL_WARNING
,

449 "W¬nšg: sÏv% Œ›dØPSYNC w™h‡Àoff£ˆth© i g»©”hªhma¡”„•liÿtiÚ off£t.", 
	`»¶iÿtiÚG‘SÏveName
(
c
));

451 
Ãed_fuÎ_»sync
;

458 
c
->
æags
 |ğ
CLIENT_SLAVE
;

459 
c
->
»¶¡©e
 = 
SLAVE_STATE_ONLINE
;

460 
c
->
»¶_ack_time
 = 
£rv”
.
unixtime
;

461 
c
->
»¶_put_Úlše_Ú_ack
 = 0;

462 
	`li¡AddNodeTa
(
£rv”
.
¦aves
,
c
);

466 
buæ’
 = 
	`¢´štf
(
buf
,(buf),"+CONTINUE\r\n");

467 ià(
	`wr™e
(
c
->
fd
,
buf
,
buæ’
) != buflen) {

468 
	`ä“Cl›ÁAsync
(
c
);

469  
C_OK
;

471 
psync_Ën
 = 
	`addR•lyR•liÿtiÚBacklog
(
c
,
psync_off£t
);

472 
	`£rv”Log
(
LL_NOTICE
,

474 
	`»¶iÿtiÚG‘SÏveName
(
c
),

475 
psync_Ën
, 
psync_off£t
);

480 
	`»äeshGoodSÏvesCouÁ
();

481  
C_OK
;

483 
Ãed_fuÎ_»sync
:

488  
C_ERR
;

489 
	}
}

509 
	$¡¬tBg§veFÜR•liÿtiÚ
(
mšÿ·
) {

510 
»tv®
;

511 
sock‘_rg‘
 = 
£rv”
.
»¶_diskËss_sync
 && (
mšÿ·
 & 
SLAVE_CAPA_EOF
);

512 
li¡I‹r
 
li
;

513 
li¡Node
 *
Ê
;

515 
	`£rv”Log
(
LL_NOTICE
,"Starting BGSAVE for SYNC witharget: %s",

516 
sock‘_rg‘
 ? "slaves sockets" : "disk");

518 ià(
sock‘_rg‘
)

519 
»tv®
 = 
	`rdbSaveToSÏvesSock‘s
();

521 
»tv®
 = 
	`rdbSaveBackground
(
£rv”
.
rdb_f’ame
);

526 ià(
»tv®
 =ğ
C_ERR
) {

527 
	`£rv”Log
(
LL_WARNING
,"BGSAVE for„eplication failed");

528 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

529 (
Ê
 = 
	`li¡Next
(&
li
))) {

530 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

532 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_START
) {

533 
¦ave
->
æags
 &ğ~
CLIENT_SLAVE
;

534 
	`li¡D–Node
(
£rv”
.
¦aves
,
Ê
);

535 
	`addR•lyE¼Ü
(
¦ave
,

537 
¦ave
->
æags
 |ğ
CLIENT_CLOSE_AFTER_REPLY
;

540  
»tv®
;

545 ià(!
sock‘_rg‘
) {

546 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

547 (
Ê
 = 
	`li¡Next
(&
li
))) {

548 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

550 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_START
) {

551 
	`»¶iÿtiÚS‘upSÏveFÜFuÎResync
(
¦ave
,

552 
	`g‘PsyncIn™ŸlOff£t
());

559 ià(
»tv®
 =ğ
C_OK
è
	`»¶iÿtiÚSütCacheFlush
();

560  
»tv®
;

561 
	}
}

564 
	$syncCommªd
(
ş›Á
 *
c
) {

566 ià(
c
->
æags
 & 
CLIENT_SLAVE
) ;

570 ià(
£rv”
.
ma¡”ho¡
 && s”v”.
»¶_¡©e
 !ğ
REPL_STATE_CONNECTED
) {

571 
	`addR•lyE¼Ü
(
c
,"Can't SYNC while‚ot connected with my master");

579 ià(
	`ş›ÁHasP’dšgR•l›s
(
c
)) {

580 
	`addR•lyE¼Ü
(
c
,"SYNC‡nd PSYNC‡re invalid with…ending output");

584 
	`£rv”Log
(
LL_NOTICE
,"Slave %s‡sks for synchronization",

585 
	`»¶iÿtiÚG‘SÏveName
(
c
));

596 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[0]->
±r
,"psync")) {

597 ià(
	`ma¡”TryP¬tŸlResynchrÚiz©iÚ
(
c
è=ğ
C_OK
) {

598 
£rv”
.
¡©_sync_·¹Ÿl_ok
++;

601 *
ma¡”_runid
 = 
c
->
¬gv
[1]->
±r
;

607 ià(
ma¡”_runid
[0] !ğ'?'è
£rv”
.
¡©_sync_·¹Ÿl_”r
++;

613 
c
->
æags
 |ğ
CLIENT_PRE_PSYNC
;

617 
£rv”
.
¡©_sync_fuÎ
++;

621 
c
->
»¶¡©e
 = 
SLAVE_STATE_WAIT_BGSAVE_START
;

622 ià(
£rv”
.
»¶_di§bË_tı_nod–ay
)

623 
	`ª‘Di§bËTıNoD–ay
(
NULL
, 
c
->
fd
);

624 
c
->
»¶dbfd
 = -1;

625 
c
->
æags
 |ğ
CLIENT_SLAVE
;

626 
	`li¡AddNodeTa
(
£rv”
.
¦aves
,
c
);

629 ià(
£rv”
.
rdb_chd_pid
 != -1 &&

630 
£rv”
.
rdb_chd_ty³
 =ğ
RDB_CHILD_TYPE_DISK
)

635 
ş›Á
 *
¦ave
;

636 
li¡Node
 *
Ê
;

637 
li¡I‹r
 
li
;

639 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

640 (
Ê
 = 
	`li¡Next
(&
li
))) {

641 
¦ave
 = 
Ê
->
v®ue
;

642 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_END
) ;

646 ià(
Ê
 && ((
c
->
¦ave_ÿ·
 & 
¦ave
->slave_capa) == slave->slave_capa)) {

649 
	`cİyCl›ÁOuutBufãr
(
c
,
¦ave
);

650 
	`»¶iÿtiÚS‘upSÏveFÜFuÎResync
(
c
,
¦ave
->
psync_š™Ÿl_off£t
);

651 
	`£rv”Log
(
LL_NOTICE
,"Waiting forƒnd of BGSAVE for SYNC");

655 
	`£rv”Log
(
LL_NOTICE
,"Can't‡ttachhe slaveohe current BGSAVE. Waiting for‚ext BGSAVE for SYNC");

659 } ià(
£rv”
.
rdb_chd_pid
 != -1 &&

660 
£rv”
.
rdb_chd_ty³
 =ğ
RDB_CHILD_TYPE_SOCKET
)

665 
	`£rv”Log
(
LL_NOTICE
,"Current BGSAVE has socketarget. Waiting for‚ext BGSAVE for SYNC");

669 ià(
£rv”
.
»¶_diskËss_sync
 && (
c
->
¦ave_ÿ·
 & 
SLAVE_CAPA_EOF
)) {

673 ià(
£rv”
.
»¶_diskËss_sync_d–ay
)

674 
	`£rv”Log
(
LL_NOTICE
,"Delay‚ext BGSAVE for diskless SYNC");

679 ià(
£rv”
.
aof_chd_pid
 == -1) {

680 
	`¡¬tBg§veFÜR•liÿtiÚ
(
c
->
¦ave_ÿ·
);

682 
	`£rv”Log
(
LL_NOTICE
,

689 ià(
	`li¡L’gth
(
£rv”
.
¦aves
è=ğ1 && s”v”.
»¶_backlog
 =ğ
NULL
)

690 
	`ü—‹R•liÿtiÚBacklog
();

692 
	}
}

706 
	$»¶cÚfCommªd
(
ş›Á
 *
c
) {

707 
j
;

709 ià((
c
->
¬gc
 % 2) == 0) {

712 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

717 
j
 = 1; j < 
c
->
¬gc
; j+=2) {

718 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"listening-port")) {

719 
pÜt
;

721 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[
j
+1],

722 &
pÜt
,
NULL
è!ğ
C_OK
))

724 
c
->
¦ave_li¡’šg_pÜt
 = 
pÜt
;

725 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"ip-address")) {

726 
sds
 

 = 
c
->
¬gv
[
j
+1]->
±r
;

727 ià(
	`sd¦’
(

è< (
c
->
¦ave_
)) {

728 
	`memıy
(
c
->
¦ave_
,

,
	`sd¦’
(ip)+1);

730 
	`addR•lyE¼ÜFÜm©
(
c
,"REPLCONF ip-address…rovided by "

731 "¦avš¡ªû i toØlÚg: %zd by‹s", 
	`sd¦’
(

));

734 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"capa")) {

736 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
+1]->
±r
,"eof"))

737 
c
->
¦ave_ÿ·
 |ğ
SLAVE_CAPA_EOF
;

738 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"ack")) {

742 
off£t
;

744 ià(!(
c
->
æags
 & 
CLIENT_SLAVE
)) ;

745 ià((
	`g‘LÚgLÚgFromObjeù
(
c
->
¬gv
[
j
+1], &
off£t
è!ğ
C_OK
))

747 ià(
off£t
 > 
c
->
»¶_ack_off
)

748 
c
->
»¶_ack_off
 = 
off£t
;

749 
c
->
»¶_ack_time
 = 
£rv”
.
unixtime
;

753 ià(
c
->
»¶_put_Úlše_Ú_ack
 && c->
»¶¡©e
 =ğ
SLAVE_STATE_ONLINE
)

754 
	`putSÏveOÆše
(
c
);

757 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"getack")) {

760 ià(
£rv”
.
ma¡”ho¡
 && s”v”.
ma¡”
è
	`»¶iÿtiÚS’dAck
();

763 
	`addR•lyE¼ÜFÜm©
(
c
,"Unrecognized REPLCONF option: %s",

764 (*)
c
->
¬gv
[
j
]->
±r
);

768 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

769 
	}
}

783 
	$putSÏveOÆše
(
ş›Á
 *
¦ave
) {

784 
¦ave
->
»¶¡©e
 = 
SLAVE_STATE_ONLINE
;

785 
¦ave
->
»¶_put_Úlše_Ú_ack
 = 0;

786 
¦ave
->
»¶_ack_time
 = 
£rv”
.
unixtime
;

787 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
, 
¦ave
->
fd
, 
AE_WRITABLE
,

788 
£ndR•lyToCl›Á
, 
¦ave
è=ğ
AE_ERR
) {

789 
	`£rv”Log
(
LL_WARNING
,"UÇbËØ»gi¡” wr™abËƒv’ˆfÜ sÏvbulk¿nsãr: %s", 
	`¡»¼Ü
(
”ºo
));

790 
	`ä“Cl›Á
(
¦ave
);

793 
	`»äeshGoodSÏvesCouÁ
();

794 
	`£rv”Log
(
LL_NOTICE
,"Synchronization with slave %s succeeded",

795 
	`»¶iÿtiÚG‘SÏveName
(
¦ave
));

796 
	}
}

798 
	$£ndBulkToSÏve
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

799 
ş›Á
 *
¦ave
 = 
´ivd©a
;

800 
	`UNUSED
(
–
);

801 
	`UNUSED
(
mask
);

802 
buf
[
PROTO_IOBUF_LEN
];

803 
ssize_t
 
nwr™‹n
, 
buæ’
;

808 ià(
¦ave
->
»¶´—mbË
) {

809 
nwr™‹n
 = 
	`wr™e
(
fd
,
¦ave
->
»¶´—mbË
,
	`sd¦’
(slave->replpreamble));

810 ià(
nwr™‹n
 == -1) {

811 
	`£rv”Log
(
LL_VERBOSE
,"Writeƒrror sending RDB…reambleo slave: %s",

812 
	`¡»¼Ü
(
”ºo
));

813 
	`ä“Cl›Á
(
¦ave
);

816 
£rv”
.
¡©_Ãt_ouut_by‹s
 +ğ
nwr™‹n
;

817 
	`sd¤ªge
(
¦ave
->
»¶´—mbË
,
nwr™‹n
,-1);

818 ià(
	`sd¦’
(
¦ave
->
»¶´—mbË
) == 0) {

819 
	`sdsä“
(
¦ave
->
»¶´—mbË
);

820 
¦ave
->
»¶´—mbË
 = 
NULL
;

828 
	`l£ek
(
¦ave
->
»¶dbfd
,¦ave->
»¶dboff
,
SEEK_SET
);

829 
buæ’
 = 
	`»ad
(
¦ave
->
»¶dbfd
,
buf
,
PROTO_IOBUF_LEN
);

830 ià(
buæ’
 <= 0) {

831 
	`£rv”Log
(
LL_WARNING
,"Readƒrror sending DBo slave: %s",

832 (
buæ’
 =ğ0è? "´em©u» EOF" : 
	`¡»¼Ü
(
”ºo
));

833 
	`ä“Cl›Á
(
¦ave
);

836 ià((
nwr™‹n
 = 
	`wr™e
(
fd
,
buf
,
buæ’
)) == -1) {

837 ià(
”ºo
 !ğ
EAGAIN
) {

838 
	`£rv”Log
(
LL_WARNING
,"Writeƒrror sending DBo slave: %s",

839 
	`¡»¼Ü
(
”ºo
));

840 
	`ä“Cl›Á
(
¦ave
);

844 
¦ave
->
»¶dboff
 +ğ
nwr™‹n
;

845 
£rv”
.
¡©_Ãt_ouut_by‹s
 +ğ
nwr™‹n
;

846 ià(
¦ave
->
»¶dboff
 =ğ¦ave->
»¶dbsize
) {

847 
	`şo£
(
¦ave
->
»¶dbfd
);

848 
¦ave
->
»¶dbfd
 = -1;

849 
	`«D–‘eFeEv’t
(
£rv”
.
–
,
¦ave
->
fd
,
AE_WRITABLE
);

850 
	`putSÏveOÆše
(
¦ave
);

852 
	}
}

868 
	$upd©eSÏvesWa™šgBg§ve
(
bg§v“¼
, 
ty³
) {

869 
li¡Node
 *
Ê
;

870 
¡¬tbg§ve
 = 0;

871 
mšÿ·
 = -1;

872 
li¡I‹r
 
li
;

874 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

875 (
Ê
 = 
	`li¡Next
(&
li
))) {

876 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

878 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_START
) {

879 
¡¬tbg§ve
 = 1;

880 
mšÿ·
 = (mšÿ· =ğ-1è? 
¦ave
->
¦ave_ÿ·
 :

881 (
mšÿ·
 & 
¦ave
->
¦ave_ÿ·
);

882 } ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_END
) {

883 
»dis_¡©
 
buf
;

890 ià(
ty³
 =ğ
RDB_CHILD_TYPE_SOCKET
) {

891 
	`£rv”Log
(
LL_NOTICE
,

893 
	`»¶iÿtiÚG‘SÏveName
(
¦ave
));

899 
¦ave
->
»¶¡©e
 = 
SLAVE_STATE_ONLINE
;

900 
¦ave
->
»¶_put_Úlše_Ú_ack
 = 1;

901 
¦ave
->
»¶_ack_time
 = 
£rv”
.
unixtime
;

903 ià(
bg§v“¼
 !ğ
C_OK
) {

904 
	`ä“Cl›Á
(
¦ave
);

905 
	`£rv”Log
(
LL_WARNING
,"SYNC failed. BGSAVE child„eturned‡nƒrror");

908 ià((
¦ave
->
»¶dbfd
 = 
	`İ’
(
£rv”
.
rdb_f’ame
,
O_RDONLY
)) == -1 ||

909 
	`»dis_f¡©
(
¦ave
->
»¶dbfd
,&
buf
) == -1) {

910 
	`ä“Cl›Á
(
¦ave
);

911 
	`£rv”Log
(
LL_WARNING
,"SYNC faed. Cª'ˆİ’/¡© DB‡á” BGSAVE: %s", 
	`¡»¼Ü
(
”ºo
));

914 
¦ave
->
»¶dboff
 = 0;

915 
¦ave
->
»¶dbsize
 = 
buf
.
¡_size
;

916 
¦ave
->
»¶¡©e
 = 
SLAVE_STATE_SEND_BULK
;

917 
¦ave
->
»¶´—mbË
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"$%lld\r\n",

918 (è
¦ave
->
»¶dbsize
);

920 
	`«D–‘eFeEv’t
(
£rv”
.
–
,
¦ave
->
fd
,
AE_WRITABLE
);

921 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
, 
¦ave
->
fd
, 
AE_WRITABLE
, 
£ndBulkToSÏve
, sÏveè=ğ
AE_ERR
) {

922 
	`ä“Cl›Á
(
¦ave
);

928 ià(
¡¬tbg§ve
è
	`¡¬tBg§veFÜR•liÿtiÚ
(
mšÿ·
);

929 
	}
}

935 
	$¦aveIsInHªdshakeS‹
() {

936  
£rv”
.
»¶_¡©e
 >ğ
REPL_STATE_RECEIVE_PONG
 &&

937 
£rv”
.
»¶_¡©e
 <ğ
REPL_STATE_RECEIVE_PSYNC
;

938 
	}
}

948 
	$»¶iÿtiÚS’dNewlšeToMa¡”
() {

949 
time_t
 
Ãwlše_£Á
;

950 ià(
	`time
(
NULL
è!ğ
Ãwlše_£Á
) {

951 
Ãwlše_£Á
 = 
	`time
(
NULL
);

952 ià(
	`wr™e
(
£rv”
.
»¶_Œªsãr_s
,"\n",1) == -1) {

956 
	}
}

960 
	$»¶iÿtiÚEm±yDbC®lback
(*
´ivd©a
) {

961 
	`UNUSED
(
´ivd©a
);

962 
	`»¶iÿtiÚS’dNewlšeToMa¡”
();

963 
	}
}

968 
	$»¶iÿtiÚC»©eMa¡”Cl›Á
(
fd
) {

969 
£rv”
.
ma¡”
 = 
	`ü—‹Cl›Á
(
fd
);

970 
£rv”
.
ma¡”
->
æags
 |ğ
CLIENT_MASTER
;

971 
£rv”
.
ma¡”
->
auth’tiÿ‹d
 = 1;

972 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_CONNECTED
;

973 
£rv”
.
ma¡”
->
»¶off
 = s”v”.
»¶_ma¡”_š™Ÿl_off£t
;

974 
	`memıy
(
£rv”
.
ma¡”
->
»¶runid
, s”v”.
»¶_ma¡”_runid
,

975 (
£rv”
.
»¶_ma¡”_runid
));

978 ià(
£rv”
.
ma¡”
->
»¶off
 == -1)

979 
£rv”
.
ma¡”
->
æags
 |ğ
CLIENT_PRE_PSYNC
;

980 
	}
}

983 
	#REPL_MAX_WRITTEN_BEFORE_FSYNC
 (1024*1024*8è

	)

984 
	$»adSyncBulkPaylßd
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

985 
buf
[4096];

986 
ssize_t
 
Ä—d
, 
»adËn
;

987 
off_t
 
Ëá
;

988 
	`UNUSED
(
–
);

989 
	`UNUSED
(
´ivd©a
);

990 
	`UNUSED
(
mask
);

994 
eofm¬k
[
CONFIG_RUN_ID_SIZE
];

995 
Ï¡by‹s
[
CONFIG_RUN_ID_SIZE
];

996 
u£m¬k
 = 0;

1000 ià(
£rv”
.
»¶_Œªsãr_size
 == -1) {

1001 ià(
	`syncR—dLše
(
fd
,
buf
,1024,
£rv”
.
»¶_syncio_timeout
*1000) == -1) {

1002 
	`£rv”Log
(
LL_WARNING
,

1004 
	`¡»¼Ü
(
”ºo
));

1005 
”rÜ
;

1008 ià(
buf
[0] == '-') {

1009 
	`£rv”Log
(
LL_WARNING
,

1011 
buf
+1);

1012 
”rÜ
;

1013 } ià(
buf
[0] == '\0') {

1017 
£rv”
.
»¶_Œªsãr_Ï¡io
 = s”v”.
unixtime
;

1019 } ià(
buf
[0] != '$') {

1020 
	`£rv”Log
(
LL_WARNING
,"Bad…rÙocŞ from MASTER,hfœ¡ by‹ i nÙ '$' (w»ûived '%s'),‡» you su»hho¡‡nd…Üˆ¬right?", 
buf
);

1021 
”rÜ
;

1034 ià(
	`¡ºcmp
(
buf
+1,"EOF:",4è=ğ0 && 
	`¡¾’
(buf+5è>ğ
CONFIG_RUN_ID_SIZE
) {

1035 
u£m¬k
 = 1;

1036 
	`memıy
(
eofm¬k
,
buf
+5,
CONFIG_RUN_ID_SIZE
);

1037 
	`mem£t
(
Ï¡by‹s
,0,
CONFIG_RUN_ID_SIZE
);

1040 
£rv”
.
»¶_Œªsãr_size
 = 0;

1041 
	`£rv”Log
(
LL_NOTICE
,

1044 
u£m¬k
 = 0;

1045 
£rv”
.
»¶_Œªsãr_size
 = 
	`¡¹Ş
(
buf
+1,
NULL
,10);

1046 
	`£rv”Log
(
LL_NOTICE
,

1048 (è
£rv”
.
»¶_Œªsãr_size
);

1054 ià(
u£m¬k
) {

1055 
»adËn
 = (
buf
);

1057 
Ëá
 = 
£rv”
.
»¶_Œªsãr_size
 - s”v”.
»¶_Œªsãr_»ad
;

1058 
»adËn
 = (
Ëá
 < (sigÃd)(
buf
)) ?†eft : (signed)(buf);

1061 
Ä—d
 = 
	`»ad
(
fd
,
buf
,
»adËn
);

1062 ià(
Ä—d
 <= 0) {

1063 
	`£rv”Log
(
LL_WARNING
,"I/Oƒrrorryingo sync with MASTER: %s",

1064 (
Ä—d
 =ğ-1è? 
	`¡»¼Ü
(
”ºo
) : "connection†ost");

1065 
	`ÿnûlR•liÿtiÚHªdshake
();

1068 
£rv”
.
¡©_Ãt_šput_by‹s
 +ğ
Ä—d
;

1072 
eof_»ached
 = 0;

1074 ià(
u£m¬k
) {

1076 ià(
Ä—d
 >ğ
CONFIG_RUN_ID_SIZE
) {

1077 
	`memıy
(
Ï¡by‹s
,
buf
+
Ä—d
-
CONFIG_RUN_ID_SIZE
,CONFIG_RUN_ID_SIZE);

1079 
»m
 = 
CONFIG_RUN_ID_SIZE
-
Ä—d
;

1080 
	`memmove
(
Ï¡by‹s
,Ï¡by‹s+
Ä—d
,
»m
);

1081 
	`memıy
(
Ï¡by‹s
+
»m
,
buf
,
Ä—d
);

1083 ià(
	`memcmp
(
Ï¡by‹s
,
eofm¬k
,
CONFIG_RUN_ID_SIZE
è=ğ0è
eof_»ached
 = 1;

1086 
£rv”
.
»¶_Œªsãr_Ï¡io
 = s”v”.
unixtime
;

1087 ià(
	`wr™e
(
£rv”
.
»¶_Œªsãr_fd
,
buf
,
Ä—d
) !=‚read) {

1088 
	`£rv”Log
(
LL_WARNING
,"Wr™”rÜ o¸shÜˆwr™wr™šgØthDB dum°fÃeded fÜ MASTER <-> SLAVE synchrÚiz©iÚ: %s", 
	`¡»¼Ü
(
”ºo
));

1089 
”rÜ
;

1091 
£rv”
.
»¶_Œªsãr_»ad
 +ğ
Ä—d
;

1094 ià(
u£m¬k
 && 
eof_»ached
) {

1095 ià(
	`árunÿ‹
(
£rv”
.
»¶_Œªsãr_fd
,

1096 
£rv”
.
»¶_Œªsãr_»ad
 - 
CONFIG_RUN_ID_SIZE
) == -1)

1098 
	`£rv”Log
(
LL_WARNING
,"E¼ÜrunÿtšghRDB f»ûived fromhma¡” fÜ SYNC: %s", 
	`¡»¼Ü
(
”ºo
));

1099 
”rÜ
;

1106 ià(
£rv”
.
»¶_Œªsãr_»ad
 >=

1107 
£rv”
.
»¶_Œªsãr_Ï¡_fsync_off
 + 
REPL_MAX_WRITTEN_BEFORE_FSYNC
)

1109 
off_t
 
sync_size
 = 
£rv”
.
»¶_Œªsãr_»ad
 -

1110 
£rv”
.
»¶_Œªsãr_Ï¡_fsync_off
;

1111 
	`rdb_fsync_¿nge
(
£rv”
.
»¶_Œªsãr_fd
,

1112 
£rv”
.
»¶_Œªsãr_Ï¡_fsync_off
, 
sync_size
);

1113 
£rv”
.
»¶_Œªsãr_Ï¡_fsync_off
 +ğ
sync_size
;

1117 ià(!
u£m¬k
) {

1118 ià(
£rv”
.
»¶_Œªsãr_»ad
 =ğ£rv”.
»¶_Œªsãr_size
)

1119 
eof_»ached
 = 1;

1122 ià(
eof_»ached
) {

1123 ià(
	`»Çme
(
£rv”
.
»¶_Œªsãr_tmpfe
,£rv”.
rdb_f’ame
) == -1) {

1124 
	`£rv”Log
(
LL_WARNING
,"FaedryšgØ»Çmth‹m°DB iÁØdump.rdb iÀMASTER <-> SLAVE synchrÚiz©iÚ: %s", 
	`¡»¼Ü
(
”ºo
));

1125 
	`ÿnûlR•liÿtiÚHªdshake
();

1128 
	`£rv”Log
(
LL_NOTICE
, "MASTER <-> SLAVE sync: Flushing old data");

1129 
	`sigÇlFlushedDb
(-1);

1130 
	`em±yDb
(
»¶iÿtiÚEm±yDbC®lback
);

1135 
	`«D–‘eFeEv’t
(
£rv”
.
–
,£rv”.
»¶_Œªsãr_s
,
AE_READABLE
);

1136 
	`£rv”Log
(
LL_NOTICE
, "MASTER <-> SLAVE sync: Loading DB in memory");

1137 ià(
	`rdbLßd
(
£rv”
.
rdb_f’ame
è!ğ
C_OK
) {

1138 
	`£rv”Log
(
LL_WARNING
,"Failedryingo†oadhe MASTER synchronization DB from disk");

1139 
	`ÿnûlR•liÿtiÚHªdshake
();

1143 
	`zä“
(
£rv”
.
»¶_Œªsãr_tmpfe
);

1144 
	`şo£
(
£rv”
.
»¶_Œªsãr_fd
);

1145 
	`»¶iÿtiÚC»©eMa¡”Cl›Á
(
£rv”
.
»¶_Œªsãr_s
);

1146 
	`£rv”Log
(
LL_NOTICE
, "MASTER <-> SLAVE sync: Finished with success");

1150 ià(
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
) {

1151 
»Œy
 = 10;

1153 
	`¡İAµ’dOÆy
();

1154 
»Œy
-- && 
	`¡¬tAµ’dOÆy
(è=ğ
C_ERR
) {

1155 
	`£rv”Log
(
LL_WARNING
,"Failedƒnablinghe AOF‡fter successful master synchronization! Trying it‡gain in one second.");

1156 
	`¦“p
(1);

1158 ià(!
»Œy
) {

1159 
	`£rv”Log
(
LL_WARNING
,"FATAL:his slave instance finishedhe synchronization with its master, buthe AOF can't beurned on. Exiting‚ow.");

1160 
	`ex™
(1);

1167 
”rÜ
:

1168 
	`ÿnûlR•liÿtiÚHªdshake
();

1170 
	}
}

1178 
	#SYNC_CMD_READ
 (1<<0)

	)

1179 
	#SYNC_CMD_WRITE
 (1<<1)

	)

1180 
	#SYNC_CMD_FULL
 (
SYNC_CMD_READ
|
SYNC_CMD_WRITE
)

	)

1181 *
	$£ndSynchrÚousCommªd
(
æags
, 
fd
, ...) {

1185 ià(
æags
 & 
SYNC_CMD_WRITE
) {

1186 *
¬g
;

1187 
va_li¡
 
­
;

1188 
sds
 
cmd
 = 
	`sd£m±y
();

1189 
	`va_¡¬t
(
­
,
fd
);

1192 
¬g
 = 
	`va_¬g
(
­
, *);

1193 ià(
¬g
 =ğ
NULL
) ;

1195 ià(
	`sd¦’
(
cmd
è!ğ0ècmd = 
	`sdsÿ’
(cmd," ",1);

1196 
cmd
 = 
	`sdsÿt
(cmd,
¬g
);

1198 
cmd
 = 
	`sdsÿ’
(cmd,"\r\n",2);

1201 ià(
	`syncWr™e
(
fd
,
cmd
,
	`sd¦’
(cmd),
£rv”
.
»¶_syncio_timeout
*1000)

1204 
	`sdsä“
(
cmd
);

1205  
	`sdsÿrštf
(
	`sd£m±y
(),"-Writingo master: %s",

1206 
	`¡»¼Ü
(
”ºo
));

1208 
	`sdsä“
(
cmd
);

1209 
	`va_’d
(
­
);

1213 ià(
æags
 & 
SYNC_CMD_READ
) {

1214 
buf
[256];

1216 ià(
	`syncR—dLše
(
fd
,
buf
,(buf),
£rv”
.
»¶_syncio_timeout
*1000)

1219  
	`sdsÿrštf
(
	`sd£m±y
(),"-Reading from master: %s",

1220 
	`¡»¼Ü
(
”ºo
));

1222 
£rv”
.
»¶_Œªsãr_Ï¡io
 = s”v”.
unixtime
;

1223  
	`sd¢ew
(
buf
);

1225  
NULL
;

1226 
	}
}

1275 
	#PSYNC_WRITE_ERROR
 0

	)

1276 
	#PSYNC_WAIT_REPLY
 1

	)

1277 
	#PSYNC_CONTINUE
 2

	)

1278 
	#PSYNC_FULLRESYNC
 3

	)

1279 
	#PSYNC_NOT_SUPPORTED
 4

	)

1280 
	$¦aveTryP¬tŸlResynchrÚiz©iÚ
(
fd
, 
»ad_»¶y
) {

1281 *
psync_runid
;

1282 
psync_off£t
[32];

1283 
sds
 
»¶y
;

1286 ià(!
»ad_»¶y
) {

1292 
£rv”
.
»¶_ma¡”_š™Ÿl_off£t
 = -1;

1294 ià(
£rv”
.
ÿched_ma¡”
) {

1295 
psync_runid
 = 
£rv”
.
ÿched_ma¡”
->
»¶runid
;

1296 
	`¢´štf
(
psync_off£t
,Õsync_off£t),"%Îd", 
£rv”
.
ÿched_ma¡”
->
»¶off
+1);

1297 
	`£rv”Log
(
LL_NOTICE
,"Tryšg‡…¬tŸÈ»synchrÚiz©iÚ (»que¡ %s:%s).", 
psync_runid
, 
psync_off£t
);

1299 
	`£rv”Log
(
LL_NOTICE
,"Partial„esynchronization‚ot…ossible (no cached master)");

1300 
psync_runid
 = "?";

1301 
	`memıy
(
psync_off£t
,"-1",3);

1305 
»¶y
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_WRITE
,
fd
,"PSYNC",
psync_runid
,
psync_off£t
,
NULL
);

1306 ià(
»¶y
 !ğ
NULL
) {

1307 
	`£rv”Log
(
LL_WARNING
,"UÇbËØ£nd PSYNCØma¡”: %s",
»¶y
);

1308 
	`sdsä“
(
»¶y
);

1309 
	`«D–‘eFeEv’t
(
£rv”
.
–
,
fd
,
AE_READABLE
);

1310  
PSYNC_WRITE_ERROR
;

1312  
PSYNC_WAIT_REPLY
;

1316 
»¶y
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_READ
,
fd
,
NULL
);

1317 ià(
	`sd¦’
(
»¶y
) == 0) {

1320 
	`sdsä“
(
»¶y
);

1321  
PSYNC_WAIT_REPLY
;

1324 
	`«D–‘eFeEv’t
(
£rv”
.
–
,
fd
,
AE_READABLE
);

1326 ià(!
	`¡ºcmp
(
»¶y
,"+FULLRESYNC",11)) {

1327 *
runid
 = 
NULL
, *
off£t
 = NULL;

1331 
runid
 = 
	`¡rchr
(
»¶y
,' ');

1332 ià(
runid
) {

1333 
runid
++;

1334 
off£t
 = 
	`¡rchr
(
runid
,' ');

1335 ià(
off£t
) offset++;

1337 ià(!
runid
 || !
off£t
 || (off£t-runid-1è!ğ
CONFIG_RUN_ID_SIZE
) {

1338 
	`£rv”Log
(
LL_WARNING
,

1344 
	`mem£t
(
£rv”
.
»¶_ma¡”_runid
,0,
CONFIG_RUN_ID_SIZE
+1);

1346 
	`memıy
(
£rv”
.
»¶_ma¡”_runid
, 
runid
, 
off£t
-runid-1);

1347 
£rv”
.
»¶_ma¡”_runid
[
CONFIG_RUN_ID_SIZE
] = '\0';

1348 
£rv”
.
»¶_ma¡”_š™Ÿl_off£t
 = 
	`¡¹Şl
(
off£t
,
NULL
,10);

1349 
	`£rv”Log
(
LL_NOTICE
,"Full„esync from master: %s:%lld",

1350 
£rv”
.
»¶_ma¡”_runid
,

1351 
£rv”
.
»¶_ma¡”_š™Ÿl_off£t
);

1354 
	`»¶iÿtiÚDisÿrdCachedMa¡”
();

1355 
	`sdsä“
(
»¶y
);

1356  
PSYNC_FULLRESYNC
;

1359 ià(!
	`¡ºcmp
(
»¶y
,"+CONTINUE",9)) {

1361 
	`£rv”Log
(
LL_NOTICE
,

1363 
	`sdsä“
(
»¶y
);

1364 
	`»¶iÿtiÚResu¼eùCachedMa¡”
(
fd
);

1365  
PSYNC_CONTINUE
;

1372 ià(
	`¡ºcmp
(
»¶y
,"-ERR",4)) {

1374 
	`£rv”Log
(
LL_WARNING
,

1375 "UÃx³ùed„•lyØPSYNC from ma¡”: %s", 
»¶y
);

1377 
	`£rv”Log
(
LL_NOTICE
,

1379 "”rÜ s‹ (»¶y: %s)", 
»¶y
);

1381 
	`sdsä“
(
»¶y
);

1382 
	`»¶iÿtiÚDisÿrdCachedMa¡”
();

1383  
PSYNC_NOT_SUPPORTED
;

1384 
	}
}

1386 
	$syncW™hMa¡”
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

1387 
tmpfe
[256], *
”r
 = 
NULL
;

1388 
dfd
, 
maxŒ›s
 = 5;

1389 
sock”r
 = 0, 
psync_»suÉ
;

1390 
sockËn_t
 
”¾’
 = (
sock”r
);

1391 
	`UNUSED
(
–
);

1392 
	`UNUSED
(
´ivd©a
);

1393 
	`UNUSED
(
mask
);

1397 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_NONE
) {

1398 
	`şo£
(
fd
);

1403 ià(
	`g‘sockİt
(
fd
, 
SOL_SOCKET
, 
SO_ERROR
, &
sock”r
, &
”¾’
) == -1)

1404 
sock”r
 = 
”ºo
;

1405 ià(
sock”r
) {

1406 
	`£rv”Log
(
LL_WARNING
,"Error condition on socket for SYNC: %s",

1407 
	`¡»¼Ü
(
sock”r
));

1408 
”rÜ
;

1412 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_CONNECTING
) {

1413 
	`£rv”Log
(
LL_NOTICE
,"Non blocking connect for SYNC firedheƒvent.");

1416 
	`«D–‘eFeEv’t
(
£rv”
.
–
,
fd
,
AE_WRITABLE
);

1417 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_RECEIVE_PONG
;

1420 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_WRITE
,
fd
,"PING",
NULL
);

1421 ià(
”r
è
wr™e_”rÜ
;

1426 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_RECEIVE_PONG
) {

1427 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_READ
,
fd
,
NULL
);

1434 ià(
”r
[0] != '+' &&

1435 
	`¡ºcmp
(
”r
,"-NOAUTH",7) != 0 &&

1436 
	`¡ºcmp
(
”r
,"-ERR operation‚ot…ermitted",28) != 0)

1438 
	`£rv”Log
(
LL_WARNING
,"E¼Ü„•lyØPING from ma¡”: '%s'",
”r
);

1439 
	`sdsä“
(
”r
);

1440 
”rÜ
;

1442 
	`£rv”Log
(
LL_NOTICE
,

1445 
	`sdsä“
(
”r
);

1446 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_SEND_AUTH
;

1450 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_SEND_AUTH
) {

1451 ià(
£rv”
.
ma¡”auth
) {

1452 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_WRITE
,
fd
,"AUTH",
£rv”
.
ma¡”auth
,
NULL
);

1453 ià(
”r
è
wr™e_”rÜ
;

1454 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_RECEIVE_AUTH
;

1457 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_SEND_PORT
;

1462 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_RECEIVE_AUTH
) {

1463 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_READ
,
fd
,
NULL
);

1464 ià(
”r
[0] == '-') {

1465 
	`£rv”Log
(
LL_WARNING
,"UÇbËØAUTHØMASTER: %s",
”r
);

1466 
	`sdsä“
(
”r
);

1467 
”rÜ
;

1469 
	`sdsä“
(
”r
);

1470 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_SEND_PORT
;

1475 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_SEND_PORT
) {

1476 
sds
 
pÜt
 = 
	`sdsäomlÚglÚg
(
£rv”
.
¦ave_ªnounû_pÜt
 ?

1477 
£rv”
.
¦ave_ªnounû_pÜt
 : s”v”.
pÜt
);

1478 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_WRITE
,
fd
,"REPLCONF",

1479 "li¡’šg-pÜt",
pÜt
, 
NULL
);

1480 
	`sdsä“
(
pÜt
);

1481 ià(
”r
è
wr™e_”rÜ
;

1482 
	`sdsä“
(
”r
);

1483 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_RECEIVE_PORT
;

1488 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_RECEIVE_PORT
) {

1489 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_READ
,
fd
,
NULL
);

1492 ià(
”r
[0] == '-') {

1493 
	`£rv”Log
(
LL_NOTICE
,"(Non critical) Master does‚ot understand "

1494 "REPLCONF†i¡’šg-pÜt: %s", 
”r
);

1496 
	`sdsä“
(
”r
);

1497 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_SEND_IP
;

1501 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_SEND_IP
 &&

1502 
£rv”
.
¦ave_ªnounû_
 =ğ
NULL
)

1504 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_SEND_CAPA
;

1509 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_SEND_IP
) {

1510 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_WRITE
,
fd
,"REPLCONF",

1511 "-add»ss",
£rv”
.
¦ave_ªnounû_
, 
NULL
);

1512 ià(
”r
è
wr™e_”rÜ
;

1513 
	`sdsä“
(
”r
);

1514 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_RECEIVE_IP
;

1519 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_RECEIVE_IP
) {

1520 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_READ
,
fd
,
NULL
);

1523 ià(
”r
[0] == '-') {

1524 
	`£rv”Log
(
LL_NOTICE
,"(Non critical) Master does‚ot understand "

1525 "REPLCONF ip-add»ss: %s", 
”r
);

1527 
	`sdsä“
(
”r
);

1528 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_SEND_CAPA
;

1535 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_SEND_CAPA
) {

1536 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_WRITE
,
fd
,"REPLCONF",

1537 "ÿ·","eof",
NULL
);

1538 ià(
”r
è
wr™e_”rÜ
;

1539 
	`sdsä“
(
”r
);

1540 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_RECEIVE_CAPA
;

1545 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_RECEIVE_CAPA
) {

1546 
”r
 = 
	`£ndSynchrÚousCommªd
(
SYNC_CMD_READ
,
fd
,
NULL
);

1549 ià(
”r
[0] == '-') {

1550 
	`£rv”Log
(
LL_NOTICE
,"(Non critical) Master does‚ot understand "

1551 "REPLCONF c­a: %s", 
”r
);

1553 
	`sdsä“
(
”r
);

1554 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_SEND_PSYNC
;

1562 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_SEND_PSYNC
) {

1563 ià(
	`¦aveTryP¬tŸlResynchrÚiz©iÚ
(
fd
,0è=ğ
PSYNC_WRITE_ERROR
) {

1564 
”r
 = 
	`sd¢ew
("Writeƒrror sendinghe PSYNC command.");

1565 
wr™e_”rÜ
;

1567 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_RECEIVE_PSYNC
;

1572 ià(
£rv”
.
»¶_¡©e
 !ğ
REPL_STATE_RECEIVE_PSYNC
) {

1573 
	`£rv”Log
(
LL_WARNING
,"syncWithMaster(): state machineƒrror, "

1575 
£rv”
.
»¶_¡©e
);

1576 
”rÜ
;

1579 
psync_»suÉ
 = 
	`¦aveTryP¬tŸlResynchrÚiz©iÚ
(
fd
,1);

1580 ià(
psync_»suÉ
 =ğ
PSYNC_WAIT_REPLY
) ;

1585 ià(
psync_»suÉ
 =ğ
PSYNC_CONTINUE
) {

1586 
	`£rv”Log
(
LL_NOTICE
, "MASTER <-> SLAVE sync: Master‡ccepted‡ Partial Resynchronization.");

1594 
	`discÚÃùSÏves
();

1595 
	`ä“R•liÿtiÚBacklog
();

1600 ià(
psync_»suÉ
 =ğ
PSYNC_NOT_SUPPORTED
) {

1601 
	`£rv”Log
(
LL_NOTICE
,"Retrying with SYNC...");

1602 ià(
	`syncWr™e
(
fd
,"SYNC\r\n",6,
£rv”
.
»¶_syncio_timeout
*1000) == -1) {

1603 
	`£rv”Log
(
LL_WARNING
,"I/Oƒrror writingo MASTER: %s",

1604 
	`¡»¼Ü
(
”ºo
));

1605 
”rÜ
;

1610 
maxŒ›s
--) {

1611 
	`¢´štf
(
tmpfe
,256,

1612 "‹mp-%d.%ld.rdb",()
£rv”
.
unixtime
,()
	`g‘pid
());

1613 
dfd
 = 
	`İ’
(
tmpfe
,
O_CREAT
|
O_WRONLY
|
O_EXCL
,0644);

1614 ià(
dfd
 != -1) ;

1615 
	`¦“p
(1);

1617 ià(
dfd
 == -1) {

1618 
	`£rv”Log
(
LL_WARNING
,"O³nšgh‹m°fÃeded fÜ MASTER <-> SLAVE synchrÚiz©iÚ: %s",
	`¡»¼Ü
(
”ºo
));

1619 
”rÜ
;

1623 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
,
fd
, 
AE_READABLE
,
»adSyncBulkPaylßd
,
NULL
)

1624 =ğ
AE_ERR
)

1626 
	`£rv”Log
(
LL_WARNING
,

1628 
	`¡»¼Ü
(
”ºo
),
fd
);

1629 
”rÜ
;

1632 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_TRANSFER
;

1633 
£rv”
.
»¶_Œªsãr_size
 = -1;

1634 
£rv”
.
»¶_Œªsãr_»ad
 = 0;

1635 
£rv”
.
»¶_Œªsãr_Ï¡_fsync_off
 = 0;

1636 
£rv”
.
»¶_Œªsãr_fd
 = 
dfd
;

1637 
£rv”
.
»¶_Œªsãr_Ï¡io
 = s”v”.
unixtime
;

1638 
£rv”
.
»¶_Œªsãr_tmpfe
 = 
	`z¡rdup
(
tmpfe
);

1641 
”rÜ
:

1642 
	`«D–‘eFeEv’t
(
£rv”
.
–
,
fd
,
AE_READABLE
|
AE_WRITABLE
);

1643 
	`şo£
(
fd
);

1644 
£rv”
.
»¶_Œªsãr_s
 = -1;

1645 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_CONNECT
;

1648 
wr™e_”rÜ
:

1649 
	`£rv”Log
(
LL_WARNING
,"S’dšg commªdØma¡” iÀ»¶iÿtiÚ hªdshake: %s", 
”r
);

1650 
	`sdsä“
(
”r
);

1651 
”rÜ
;

1652 
	}
}

1654 
	$cÚÃùW™hMa¡”
() {

1655 
fd
;

1657 
fd
 = 
	`ª‘TıNÚBlockBe¡EffÜtBšdCÚÃù
(
NULL
,

1658 
£rv”
.
ma¡”ho¡
,£rv”.
ma¡”pÜt
,
NET_FIRST_BIND_ADDR
);

1659 ià(
fd
 == -1) {

1660 
	`£rv”Log
(
LL_WARNING
,"Unableo connecto MASTER: %s",

1661 
	`¡»¼Ü
(
”ºo
));

1662  
C_ERR
;

1665 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
,
fd
,
AE_READABLE
|
AE_WRITABLE
,
syncW™hMa¡”
,
NULL
) ==

1666 
AE_ERR
)

1668 
	`şo£
(
fd
);

1669 
	`£rv”Log
(
LL_WARNING
,"Can't create„eadableƒvent for SYNC");

1670  
C_ERR
;

1673 
£rv”
.
»¶_Œªsãr_Ï¡io
 = s”v”.
unixtime
;

1674 
£rv”
.
»¶_Œªsãr_s
 = 
fd
;

1675 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_CONNECTING
;

1676  
C_OK
;

1677 
	}
}

1683 
	$undoCÚÃùW™hMa¡”
() {

1684 
fd
 = 
£rv”
.
»¶_Œªsãr_s
;

1686 
	`«D–‘eFeEv’t
(
£rv”
.
–
,
fd
,
AE_READABLE
|
AE_WRITABLE
);

1687 
	`şo£
(
fd
);

1688 
£rv”
.
»¶_Œªsãr_s
 = -1;

1689 
	}
}

1694 
	$»¶iÿtiÚAbÜtSyncT¿nsãr
() {

1695 
	`£rv”As£¹
(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_TRANSFER
);

1696 
	`undoCÚÃùW™hMa¡”
();

1697 
	`şo£
(
£rv”
.
»¶_Œªsãr_fd
);

1698 
	`uÆšk
(
£rv”
.
»¶_Œªsãr_tmpfe
);

1699 
	`zä“
(
£rv”
.
»¶_Œªsãr_tmpfe
);

1700 
	}
}

1710 
	$ÿnûlR•liÿtiÚHªdshake
() {

1711 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_TRANSFER
) {

1712 
	`»¶iÿtiÚAbÜtSyncT¿nsãr
();

1713 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_CONNECT
;

1714 } ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_CONNECTING
 ||

1715 
	`¦aveIsInHªdshakeS‹
())

1717 
	`undoCÚÃùW™hMa¡”
();

1718 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_CONNECT
;

1723 
	}
}

1726 
	$»¶iÿtiÚS‘Ma¡”
(*

, 
pÜt
) {

1727 
	`sdsä“
(
£rv”
.
ma¡”ho¡
);

1728 
£rv”
.
ma¡”ho¡
 = 
	`sd¢ew
(

);

1729 
£rv”
.
ma¡”pÜt
 = 
pÜt
;

1730 ià(
£rv”
.
ma¡”
è
	`ä“Cl›Á
(server.master);

1731 
	`discÚÃùAÎBlockedCl›Ás
();

1732 
	`discÚÃùSÏves
();

1733 
	`»¶iÿtiÚDisÿrdCachedMa¡”
();

1734 
	`ä“R•liÿtiÚBacklog
();

1735 
	`ÿnûlR•liÿtiÚHªdshake
();

1736 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_CONNECT
;

1737 
£rv”
.
ma¡”_»¶_off£t
 = 0;

1738 
£rv”
.
»¶_down_sšû
 = 0;

1739 
	}
}

1742 
	$»¶iÿtiÚUn£tMa¡”
() {

1743 ià(
£rv”
.
ma¡”ho¡
 =ğ
NULL
) ;

1744 
	`sdsä“
(
£rv”
.
ma¡”ho¡
);

1745 
£rv”
.
ma¡”ho¡
 = 
NULL
;

1746 ià(
£rv”
.
ma¡”
) {

1747 ià(
	`li¡L’gth
(
£rv”
.
¦aves
) == 0) {

1752 
£rv”
.
ma¡”_»¶_off£t
 = s”v”.
ma¡”
->
»¶off
;

1753 
	`ä“R•liÿtiÚBacklog
();

1755 
	`ä“Cl›Á
(
£rv”
.
ma¡”
);

1757 
	`»¶iÿtiÚDisÿrdCachedMa¡”
();

1758 
	`ÿnûlR•liÿtiÚHªdshake
();

1759 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_NONE
;

1760 
	}
}

1764 
	$»¶iÿtiÚHªdËMa¡”DiscÚÃùiÚ
() {

1765 
£rv”
.
ma¡”
 = 
NULL
;

1766 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_CONNECT
;

1767 
£rv”
.
»¶_down_sšû
 = s”v”.
unixtime
;

1771 
	}
}

1773 
	$¦aveofCommªd
(
ş›Á
 *
c
) {

1776 ià(
£rv”
.
şu¡”_’abËd
) {

1777 
	`addR•lyE¼Ü
(
c
,"SLAVEOF‚ot‡llowed in cluster mode.");

1783 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"no") &&

1784 !
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"one")) {

1785 ià(
£rv”
.
ma¡”ho¡
) {

1786 
	`»¶iÿtiÚUn£tMa¡”
();

1787 
sds
 
ş›Á
 = 
	`ÿtCl›ÁInfoSŒšg
(
	`sd£m±y
(),
c
);

1788 
	`£rv”Log
(
LL_NOTICE
,"MASTER MODEƒnabled (user„equest from '%s')",

1789 
ş›Á
);

1790 
	`sdsä“
(
ş›Á
);

1793 
pÜt
;

1795 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
pÜt
, 
NULL
è!ğ
C_OK
))

1799 ià(
£rv”
.
ma¡”ho¡
 && !
	`¡rÿ£cmp
(£rv”.ma¡”ho¡,
c
->
¬gv
[1]->
±r
)

1800 && 
£rv”
.
ma¡”pÜt
 =ğ
pÜt
) {

1801 
	`£rv”Log
(
LL_NOTICE
,"SLAVE OF would„esult into synchronization withhe master we‡re‡lready connected with. No operation…erformed.");

1802 
	`addR•lySds
(
c
,
	`sd¢ew
("+OK Already connectedo specified master\r\n"));

1807 
	`»¶iÿtiÚS‘Ma¡”
(
c
->
¬gv
[1]->
±r
, 
pÜt
);

1808 
sds
 
ş›Á
 = 
	`ÿtCl›ÁInfoSŒšg
(
	`sd£m±y
(),
c
);

1809 
	`£rv”Log
(
LL_NOTICE
,"SLAVE OF %s:%dƒnabled (user„equest from '%s')",

1810 
£rv”
.
ma¡”ho¡
, s”v”.
ma¡”pÜt
, 
ş›Á
);

1811 
	`sdsä“
(
ş›Á
);

1813 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1814 
	}
}

1819 
	$rŞeCommªd
(
ş›Á
 *
c
) {

1820 ià(
£rv”
.
ma¡”ho¡
 =ğ
NULL
) {

1821 
li¡I‹r
 
li
;

1822 
li¡Node
 *
Ê
;

1823 *
mbcouÁ
;

1824 
¦aves
 = 0;

1826 
	`addR•lyMuÉiBulkL’
(
c
,3);

1827 
	`addR•lyBulkCBufãr
(
c
,"master",6);

1828 
	`addR•lyLÚgLÚg
(
c
,
£rv”
.
ma¡”_»¶_off£t
);

1829 
mbcouÁ
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

1830 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

1831 (
Ê
 = 
	`li¡Next
(&
li
))) {

1832 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

1833 

[
NET_IP_STR_LEN
], *
¦ave
 = 
¦ave
->
¦ave_
;

1835 ià(
¦ave
[0] == '\0') {

1836 ià(
	`ª‘P“rToSŒšg
(
¦ave
->
fd
,

,(),
NULL
) == -1)

1838 
¦ave
 = 

;

1840 ià(
¦ave
->
»¶¡©e
 !ğ
SLAVE_STATE_ONLINE
) ;

1841 
	`addR•lyMuÉiBulkL’
(
c
,3);

1842 
	`addR•lyBulkCSŒšg
(
c
,
¦ave
);

1843 
	`addR•lyBulkLÚgLÚg
(
c
,
¦ave
->
¦ave_li¡’šg_pÜt
);

1844 
	`addR•lyBulkLÚgLÚg
(
c
,
¦ave
->
»¶_ack_off
);

1845 
¦aves
++;

1847 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
mbcouÁ
,
¦aves
);

1849 *
¦ave¡©e
 = 
NULL
;

1851 
	`addR•lyMuÉiBulkL’
(
c
,5);

1852 
	`addR•lyBulkCBufãr
(
c
,"slave",5);

1853 
	`addR•lyBulkCSŒšg
(
c
,
£rv”
.
ma¡”ho¡
);

1854 
	`addR•lyLÚgLÚg
(
c
,
£rv”
.
ma¡”pÜt
);

1855 ià(
	`¦aveIsInHªdshakeS‹
()) {

1856 
¦ave¡©e
 = "handshake";

1858 
£rv”
.
»¶_¡©e
) {

1859 
REPL_STATE_NONE
: 
¦ave¡©e
 = "none"; ;

1860 
REPL_STATE_CONNECT
: 
¦ave¡©e
 = "connect"; ;

1861 
REPL_STATE_CONNECTING
: 
¦ave¡©e
 = "connecting"; ;

1862 
REPL_STATE_TRANSFER
: 
¦ave¡©e
 = "sync"; ;

1863 
REPL_STATE_CONNECTED
: 
¦ave¡©e
 = "connected"; ;

1864 : 
¦ave¡©e
 = "unknown"; ;

1867 
	`addR•lyBulkCSŒšg
(
c
,
¦ave¡©e
);

1868 
	`addR•lyLÚgLÚg
(
c
,
£rv”
.
ma¡”
 ? s”v”.ma¡”->
»¶off
 : -1);

1870 
	}
}

1875 
	$»¶iÿtiÚS’dAck
() {

1876 
ş›Á
 *
c
 = 
£rv”
.
ma¡”
;

1878 ià(
c
 !ğ
NULL
) {

1879 
c
->
æags
 |ğ
CLIENT_MASTER_FORCE_REPLY
;

1880 
	`addR•lyMuÉiBulkL’
(
c
,3);

1881 
	`addR•lyBulkCSŒšg
(
c
,"REPLCONF");

1882 
	`addR•lyBulkCSŒšg
(
c
,"ACK");

1883 
	`addR•lyBulkLÚgLÚg
(
c
,c->
»¶off
);

1884 
c
->
æags
 &ğ~
CLIENT_MASTER_FORCE_REPLY
;

1886 
	}
}

1908 
	$»¶iÿtiÚCacheMa¡”
(
ş›Á
 *
c
) {

1909 
	`£rv”As£¹
(
£rv”
.
ma¡”
 !ğ
NULL
 && s”v”.
ÿched_ma¡”
 == NULL);

1910 
	`£rv”Log
(
LL_NOTICE
,"Cachinghe disconnected master state.");

1913 
	`uÆškCl›Á
(
c
);

1917 
£rv”
.
ÿched_ma¡”
 = s”v”.
ma¡”
;

1920 ià(
c
->
³”id
) {

1921 
	`sdsä“
(
c
->
³”id
);

1922 
c
->
³”id
 = 
NULL
;

1928 
	`»¶iÿtiÚHªdËMa¡”DiscÚÃùiÚ
();

1929 
	}
}

1933 
	$»¶iÿtiÚDisÿrdCachedMa¡”
() {

1934 ià(
£rv”
.
ÿched_ma¡”
 =ğ
NULL
) ;

1936 
	`£rv”Log
(
LL_NOTICE
,"Discarding…reviously cached master state.");

1937 
£rv”
.
ÿched_ma¡”
->
æags
 &ğ~
CLIENT_MASTER
;

1938 
	`ä“Cl›Á
(
£rv”
.
ÿched_ma¡”
);

1939 
£rv”
.
ÿched_ma¡”
 = 
NULL
;

1940 
	}
}

1948 
	$»¶iÿtiÚResu¼eùCachedMa¡”
(
Ãwfd
) {

1949 
£rv”
.
ma¡”
 = s”v”.
ÿched_ma¡”
;

1950 
£rv”
.
ÿched_ma¡”
 = 
NULL
;

1951 
£rv”
.
ma¡”
->
fd
 = 
Ãwfd
;

1952 
£rv”
.
ma¡”
->
æags
 &ğ~(
CLIENT_CLOSE_AFTER_REPLY
|
CLIENT_CLOSE_ASAP
);

1953 
£rv”
.
ma¡”
->
auth’tiÿ‹d
 = 1;

1954 
£rv”
.
ma¡”
->
Ï¡š‹¿ùiÚ
 = s”v”.
unixtime
;

1955 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_CONNECTED
;

1958 
	`li¡AddNodeTa
(
£rv”
.
ş›Ás
,£rv”.
ma¡”
);

1959 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
, 
Ãwfd
, 
AE_READABLE
,

1960 
»adQu”yFromCl›Á
, 
£rv”
.
ma¡”
)) {

1961 
	`£rv”Log
(
LL_WARNING
,"E¼Ü„esu¼eùšghÿched ma¡”, impossibËØaddh»adabË hªdËr: %s", 
	`¡»¼Ü
(
”ºo
));

1962 
	`ä“Cl›ÁAsync
(
£rv”
.
ma¡”
);

1967 ià(
	`ş›ÁHasP’dšgR•l›s
(
£rv”
.
ma¡”
)) {

1968 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
, 
Ãwfd
, 
AE_WRITABLE
,

1969 
£ndR•lyToCl›Á
, 
£rv”
.
ma¡”
)) {

1970 
	`£rv”Log
(
LL_WARNING
,"E¼Ü„esu¼eùšghÿched ma¡”, impossibËØaddhwr™abË hªdËr: %s", 
	`¡»¼Ü
(
”ºo
));

1971 
	`ä“Cl›ÁAsync
(
£rv”
.
ma¡”
);

1974 
	}
}

1981 
	$»äeshGoodSÏvesCouÁ
() {

1982 
li¡I‹r
 
li
;

1983 
li¡Node
 *
Ê
;

1984 
good
 = 0;

1986 ià(!
£rv”
.
»¶_mš_¦aves_to_wr™e
 ||

1987 !
£rv”
.
»¶_mš_¦aves_max_Ïg
) ;

1989 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

1990 (
Ê
 = 
	`li¡Next
(&
li
))) {

1991 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

1992 
time_t
 
Ïg
 = 
£rv”
.
unixtime
 - 
¦ave
->
»¶_ack_time
;

1994 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_ONLINE
 &&

1995 
Ïg
 <ğ
£rv”
.
»¶_mš_¦aves_max_Ïg
è
good
++;

1997 
£rv”
.
»¶_good_¦aves_couÁ
 = 
good
;

1998 
	}
}

2032 
	$»¶iÿtiÚSütCacheIn™
() {

2033 
£rv”
.
»¶_sütÿche_size
 = 10000;

2034 
£rv”
.
»¶_sütÿche_diù
 = 
	`diùC»©e
(&
»¶SütCacheDiùTy³
,
NULL
);

2035 
£rv”
.
»¶_sütÿche_fifo
 = 
	`li¡C»©e
();

2036 
	}
}

2049 
	$»¶iÿtiÚSütCacheFlush
() {

2050 
	`diùEm±y
(
£rv”
.
»¶_sütÿche_diù
,
NULL
);

2051 
	`li¡R–—£
(
£rv”
.
»¶_sütÿche_fifo
);

2052 
£rv”
.
»¶_sütÿche_fifo
 = 
	`li¡C»©e
();

2053 
	}
}

2057 
	$»¶iÿtiÚSütCacheAdd
(
sds
 
sha1
) {

2058 
»tv®
;

2059 
sds
 
key
 = 
	`sdsdup
(
sha1
);

2062 ià(
	`li¡L’gth
(
£rv”
.
»¶_sütÿche_fifo
è=ğ£rv”.
»¶_sütÿche_size
)

2064 
li¡Node
 *
Ê
 = 
	`li¡La¡
(
£rv”
.
»¶_sütÿche_fifo
);

2065 
sds
 
Şde¡
 = 
	`li¡NodeV®ue
(
Ê
);

2067 
»tv®
 = 
	`diùD–‘e
(
£rv”
.
»¶_sütÿche_diù
,
Şde¡
);

2068 
	`£rv”As£¹
(
»tv®
 =ğ
DICT_OK
);

2069 
	`li¡D–Node
(
£rv”
.
»¶_sütÿche_fifo
,
Ê
);

2073 
»tv®
 = 
	`diùAdd
(
£rv”
.
»¶_sütÿche_diù
,
key
,
NULL
);

2074 
	`li¡AddNodeH—d
(
£rv”
.
»¶_sütÿche_fifo
,
key
);

2075 
	`£rv”As£¹
(
»tv®
 =ğ
DICT_OK
);

2076 
	}
}

2080 
	$»¶iÿtiÚSütCacheExi¡s
(
sds
 
sha1
) {

2081  
	`diùFšd
(
£rv”
.
»¶_sütÿche_diù
,
sha1
è!ğ
NULL
;

2082 
	}
}

2114 
	$»¶iÿtiÚReque¡AckFromSÏves
() {

2115 
£rv”
.
g‘_ack_äom_¦aves
 = 1;

2116 
	}
}

2120 
	$»¶iÿtiÚCouÁAcksByOff£t
(
off£t
) {

2121 
li¡I‹r
 
li
;

2122 
li¡Node
 *
Ê
;

2123 
couÁ
 = 0;

2125 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

2126 (
Ê
 = 
	`li¡Next
(&
li
))) {

2127 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

2129 ià(
¦ave
->
»¶¡©e
 !ğ
SLAVE_STATE_ONLINE
) ;

2130 ià(
¦ave
->
»¶_ack_off
 >ğ
off£t
è
couÁ
++;

2132  
couÁ
;

2133 
	}
}

2137 
	$wa™Commªd
(
ş›Á
 *
c
) {

2138 
m¡ime_t
 
timeout
;

2139 
num»¶iÿs
, 
ack»¶iÿs
;

2140 
off£t
 = 
c
->
woff
;

2143 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[1],&
num»¶iÿs
,
NULL
è!ğ
C_OK
)

2145 ià(
	`g‘TimeoutFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
timeout
,
UNIT_MILLISECONDS
)

2146 !ğ
C_OK
) ;

2149 
ack»¶iÿs
 = 
	`»¶iÿtiÚCouÁAcksByOff£t
(
c
->
woff
);

2150 ià(
ack»¶iÿs
 >ğ
num»¶iÿs
 || 
c
->
æags
 & 
CLIENT_MULTI
) {

2151 
	`addR•lyLÚgLÚg
(
c
,
ack»¶iÿs
);

2157 
c
->
bpİ
.
timeout
 =imeout;

2158 
c
->
bpİ
.
»¶off£t
 = 
off£t
;

2159 
c
->
bpİ
.
num»¶iÿs
 =‚umreplicas;

2160 
	`li¡AddNodeTa
(
£rv”
.
ş›Ás_wa™šg_acks
,
c
);

2161 
	`blockCl›Á
(
c
,
BLOCKED_WAIT
);

2165 
	`»¶iÿtiÚReque¡AckFromSÏves
();

2166 
	}
}

2172 
	$unblockCl›ÁWa™šgR•liÿs
(
ş›Á
 *
c
) {

2173 
li¡Node
 *
Ê
 = 
	`li¡S—rchKey
(
£rv”
.
ş›Ás_wa™šg_acks
,
c
);

2174 
	`£rv”As£¹
(
Ê
 !ğ
NULL
);

2175 
	`li¡D–Node
(
£rv”
.
ş›Ás_wa™šg_acks
,
Ê
);

2176 
	}
}

2180 
	$´oûssCl›ÁsWa™šgR•liÿs
() {

2181 
Ï¡_off£t
 = 0;

2182 
Ï¡_num»¶iÿs
 = 0;

2184 
li¡I‹r
 
li
;

2185 
li¡Node
 *
Ê
;

2187 
	`li¡Rewšd
(
£rv”
.
ş›Ás_wa™šg_acks
,&
li
);

2188 (
Ê
 = 
	`li¡Next
(&
li
))) {

2189 
ş›Á
 *
c
 = 
Ê
->
v®ue
;

2195 ià(
Ï¡_off£t
 &&†a¡_off£ˆ> 
c
->
bpİ
.
»¶off£t
 &&

2196 
Ï¡_num»¶iÿs
 > 
c
->
bpİ
.
num»¶iÿs
)

2198 
	`unblockCl›Á
(
c
);

2199 
	`addR•lyLÚgLÚg
(
c
,
Ï¡_num»¶iÿs
);

2201 
num»¶iÿs
 = 
	`»¶iÿtiÚCouÁAcksByOff£t
(
c
->
bpİ
.
»¶off£t
);

2203 ià(
num»¶iÿs
 >ğ
c
->
bpİ
.numreplicas) {

2204 
Ï¡_off£t
 = 
c
->
bpİ
.
»¶off£t
;

2205 
Ï¡_num»¶iÿs
 = 
num»¶iÿs
;

2206 
	`unblockCl›Á
(
c
);

2207 
	`addR•lyLÚgLÚg
(
c
,
num»¶iÿs
);

2211 
	}
}

2215 
	$»¶iÿtiÚG‘SÏveOff£t
() {

2216 
off£t
 = 0;

2218 ià(
£rv”
.
ma¡”ho¡
 !ğ
NULL
) {

2219 ià(
£rv”
.
ma¡”
) {

2220 
off£t
 = 
£rv”
.
ma¡”
->
»¶off
;

2221 } ià(
£rv”
.
ÿched_ma¡”
) {

2222 
off£t
 = 
£rv”
.
ÿched_ma¡”
->
»¶off
;

2229 ià(
off£t
 < 0) offset = 0;

2230  
off£t
;

2231 
	}
}

2236 
	$»¶iÿtiÚCrÚ
() {

2237 
»¶iÿtiÚ_üÚ_loİs
 = 0;

2240 ià(
£rv”
.
ma¡”ho¡
 &&

2241 (
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_CONNECTING
 ||

2242 
	`¦aveIsInHªdshakeS‹
()) &&

2243 (
	`time
(
NULL
)-
£rv”
.
»¶_Œªsãr_Ï¡io
è> s”v”.
»¶_timeout
)

2245 
	`£rv”Log
(
LL_WARNING
,"Timeout connectingohe MASTER...");

2246 
	`ÿnûlR•liÿtiÚHªdshake
();

2250 ià(
£rv”
.
ma¡”ho¡
 && s”v”.
»¶_¡©e
 =ğ
REPL_STATE_TRANSFER
 &&

2251 (
	`time
(
NULL
)-
£rv”
.
»¶_Œªsãr_Ï¡io
è> s”v”.
»¶_timeout
)

2253 
	`£rv”Log
(
LL_WARNING
,"Timeout„eceiving bulk data from MASTER... Ifhe…roblem…ersistsryo sethe 'repl-timeout'…arameter in„edis.confo‡†arger value.");

2254 
	`ÿnûlR•liÿtiÚHªdshake
();

2258 ià(
£rv”
.
ma¡”ho¡
 && s”v”.
»¶_¡©e
 =ğ
REPL_STATE_CONNECTED
 &&

2259 (
	`time
(
NULL
)-
£rv”
.
ma¡”
->
Ï¡š‹¿ùiÚ
è> s”v”.
»¶_timeout
)

2261 
	`£rv”Log
(
LL_WARNING
,"MASTERimeout:‚o data‚or PING„eceived...");

2262 
	`ä“Cl›Á
(
£rv”
.
ma¡”
);

2266 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_CONNECT
) {

2267 
	`£rv”Log
(
LL_NOTICE
,"Connectingo MASTER %s:%d",

2268 
£rv”
.
ma¡”ho¡
, s”v”.
ma¡”pÜt
);

2269 ià(
	`cÚÃùW™hMa¡”
(è=ğ
C_OK
) {

2270 
	`£rv”Log
(
LL_NOTICE
,"MASTER <-> SLAVE sync started");

2277 ià(
£rv”
.
ma¡”ho¡
 && s”v”.
ma¡”
 &&

2278 !(
£rv”
.
ma¡”
->
æags
 & 
CLIENT_PRE_PSYNC
))

2279 
	`»¶iÿtiÚS’dAck
();

2285 
li¡I‹r
 
li
;

2286 
li¡Node
 *
Ê
;

2287 
robj
 *
pšg_¬gv
[1];

2290 ià((
»¶iÿtiÚ_üÚ_loİs
 % 
£rv”
.
»¶_pšg_¦ave_³riod
) == 0) {

2291 
pšg_¬gv
[0] = 
	`ü—‹SŒšgObjeù
("PING",4);

2292 
	`»¶iÿtiÚF“dSÏves
(
£rv”
.
¦aves
, s”v”.
¦ave£ldb
,

2293 
pšg_¬gv
, 1);

2294 
	`deüRefCouÁ
(
pšg_¬gv
[0]);

2303 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

2304 (
Ê
 = 
	`li¡Next
(&
li
))) {

2305 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

2307 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_START
 ||

2308 (
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_END
 &&

2309 
£rv”
.
rdb_chd_ty³
 !ğ
RDB_CHILD_TYPE_SOCKET
))

2311 ià(
	`wr™e
(
¦ave
->
fd
, "\n", 1) == -1) {

2318 ià(
	`li¡L’gth
(
£rv”
.
¦aves
)) {

2319 
li¡I‹r
 
li
;

2320 
li¡Node
 *
Ê
;

2322 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

2323 (
Ê
 = 
	`li¡Next
(&
li
))) {

2324 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

2326 ià(
¦ave
->
»¶¡©e
 !ğ
SLAVE_STATE_ONLINE
) ;

2327 ià(
¦ave
->
æags
 & 
CLIENT_PRE_PSYNC
) ;

2328 ià((
£rv”
.
unixtime
 - 
¦ave
->
»¶_ack_time
è> s”v”.
»¶_timeout
)

2330 
	`£rv”Log
(
LL_WARNING
, "Disconnectingimedout slave: %s",

2331 
	`»¶iÿtiÚG‘SÏveName
(
¦ave
));

2332 
	`ä“Cl›Á
(
¦ave
);

2339 ià(
	`li¡L’gth
(
£rv”
.
¦aves
è=ğ0 && s”v”.
»¶_backlog_time_lim™
 &&

2340 
£rv”
.
»¶_backlog
)

2342 
time_t
 
idË
 = 
£rv”
.
unixtime
 - s”v”.
»¶_no_¦aves_sšû
;

2344 ià(
idË
 > 
£rv”
.
»¶_backlog_time_lim™
) {

2345 
	`ä“R•liÿtiÚBacklog
();

2346 
	`£rv”Log
(
LL_NOTICE
,

2349 (è
£rv”
.
»¶_backlog_time_lim™
);

2356 ià(
	`li¡L’gth
(
£rv”
.
¦aves
) == 0 &&

2357 
£rv”
.
aof_¡©e
 =ğ
AOF_OFF
 &&

2358 
	`li¡L’gth
(
£rv”
.
»¶_sütÿche_fifo
) != 0)

2360 
	`»¶iÿtiÚSütCacheFlush
();

2369 ià(
£rv”
.
rdb_chd_pid
 =ğ-1 && s”v”.
aof_chd_pid
 == -1) {

2370 
time_t
 
idË
, 
max_idË
 = 0;

2371 
¦aves_wa™šg
 = 0;

2372 
mšÿ·
 = -1;

2373 
li¡Node
 *
Ê
;

2374 
li¡I‹r
 
li
;

2376 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

2377 (
Ê
 = 
	`li¡Next
(&
li
))) {

2378 
ş›Á
 *
¦ave
 = 
Ê
->
v®ue
;

2379 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_WAIT_BGSAVE_START
) {

2380 
idË
 = 
£rv”
.
unixtime
 - 
¦ave
->
Ï¡š‹¿ùiÚ
;

2381 ià(
idË
 > 
max_idË
) max_idle = idle;

2382 
¦aves_wa™šg
++;

2383 
mšÿ·
 = (mšÿ· =ğ-1è? 
¦ave
->
¦ave_ÿ·
 :

2384 (
mšÿ·
 & 
¦ave
->
¦ave_ÿ·
);

2388 ià(
¦aves_wa™šg
 &&

2389 (!
£rv”
.
»¶_diskËss_sync
 ||

2390 
max_idË
 > 
£rv”
.
»¶_diskËss_sync_d–ay
))

2395 
	`¡¬tBg§veFÜR•liÿtiÚ
(
mšÿ·
);

2400 
	`»äeshGoodSÏvesCouÁ
();

2401 
»¶iÿtiÚ_üÚ_loİs
++;

2402 
	}
}

	@src/rio.c

48 
	~"fmaüos.h
"

49 
	~<¡ršg.h
>

50 
	~<¡dio.h
>

51 
	~<uni¡d.h
>

52 
	~"rio.h
"

53 
	~"ut.h
"

54 
	~"üc64.h
"

55 
	~"cÚfig.h
"

56 
	~"£rv”.h
"

61 
size_t
 
	$rioBufãrWr™e
(
rio
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
) {

62 
r
->
io
.
bufãr
.
±r
 = 
	`sdsÿ’
Ô->io.bufãr.±r,(*)
buf
,
Ën
);

63 
r
->
io
.
bufãr
.
pos
 +ğ
Ën
;

65 
	}
}

68 
size_t
 
	$rioBufãrR—d
(
rio
 *
r
, *
buf
, 
size_t
 
Ën
) {

69 ià(
	`sd¦’
(
r
->
io
.
bufãr
.
±r
)-r->io.bufãr.
pos
 < 
Ën
)

71 
	`memıy
(
buf
,
r
->
io
.
bufãr
.
±r
+r->io.bufãr.
pos
,
Ën
);

72 
r
->
io
.
bufãr
.
pos
 +ğ
Ën
;

74 
	}
}

77 
off_t
 
	$rioBufãrT–l
(
rio
 *
r
) {

78  
r
->
io
.
bufãr
.
pos
;

79 
	}
}

83 
	$rioBufãrFlush
(
rio
 *
r
) {

84 
	`UNUSED
(
r
);

86 
	}
}

88 cÚ¡ 
rio
 
	grioBufãrIO
 = {

89 
rioBufãrR—d
,

90 
rioBufãrWr™e
,

91 
rioBufãrT–l
,

92 
rioBufãrFlush
,

93 
NULL
,

97 { { 
NULL
, 0 } }

100 
	$rioIn™W™hBufãr
(
rio
 *
r
, 
sds
 
s
) {

101 *
r
 = 
rioBufãrIO
;

102 
r
->
io
.
bufãr
.
±r
 = 
s
;

103 
r
->
io
.
bufãr
.
pos
 = 0;

104 
	}
}

109 
size_t
 
	$rioFeWr™e
(
rio
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
) {

110 
size_t
 
»tv®
;

112 
»tv®
 = 
	`fwr™e
(
buf
,
Ën
,1,
r
->
io
.
fe
.
å
);

113 
r
->
io
.
fe
.
bufã»d
 +ğ
Ën
;

115 ià(
r
->
io
.
fe
.
autosync
 &&

116 
r
->
io
.
fe
.
bufã»d
 >ğr->io.fe.
autosync
)

118 
	`fæush
(
r
->
io
.
fe
.
å
);

119 
	`aof_fsync
(
	`f’o
(
r
->
io
.
fe
.
å
));

120 
r
->
io
.
fe
.
bufã»d
 = 0;

122  
»tv®
;

123 
	}
}

126 
size_t
 
	$rioFeR—d
(
rio
 *
r
, *
buf
, 
size_t
 
Ën
) {

127  
	`ä—d
(
buf
,
Ën
,1,
r
->
io
.
fe
.
å
);

128 
	}
}

131 
off_t
 
	$rioFeT–l
(
rio
 *
r
) {

132  
	`á–lo
(
r
->
io
.
fe
.
å
);

133 
	}
}

137 
	$rioFeFlush
(
rio
 *
r
) {

138  (
	`fæush
(
r
->
io
.
fe
.
å
) == 0) ? 1 : 0;

139 
	}
}

141 cÚ¡ 
rio
 
	grioFeIO
 = {

142 
rioFeR—d
,

143 
rioFeWr™e
,

144 
rioFeT–l
,

145 
rioFeFlush
,

146 
NULL
,

150 { { 
NULL
, 0 } }

153 
	$rioIn™W™hFe
(
rio
 *
r
, 
FILE
 *
å
) {

154 *
r
 = 
rioFeIO
;

155 
r
->
io
.
fe
.
å
 = fp;

156 
r
->
io
.
fe
.
bufã»d
 = 0;

157 
r
->
io
.
fe
.
autosync
 = 0;

158 
	}
}

169 
size_t
 
	$rioFd£tWr™e
(
rio
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
) {

170 
ssize_t
 
»tv®
;

171 
j
;

172 *
p
 = (*è
buf
;

173 
doæush
 = (
buf
 =ğ
NULL
 && 
Ën
 == 0);

177 ià(
Ën
) {

178 
r
->
io
.
fd£t
.
buf
 = 
	`sdsÿ’
Ô->io.fd£t.buf,buf,
Ën
);

179 
Ën
 = 0;

180 ià(
	`sd¦’
(
r
->
io
.
fd£t
.
buf
è> 
PROTO_IOBUF_LEN
è
doæush
 = 1;

183 ià(
doæush
) {

184 
p
 = (*è
r
->
io
.
fd£t
.
buf
;

185 
Ën
 = 
	`sd¦’
(
r
->
io
.
fd£t
.
buf
);

191 
Ën
) {

192 
size_t
 
couÁ
 = 
Ën
 < 1024 ?†en : 1024;

193 
brok’
 = 0;

194 
j
 = 0; j < 
r
->
io
.
fd£t
.
numfds
; j++) {

195 ià(
r
->
io
.
fd£t
.
¡©e
[
j
] != 0) {

197 
brok’
++;

203 
size_t
 
nwr™‹n
 = 0;

204 
nwr™‹n
 !ğ
couÁ
) {

205 
»tv®
 = 
	`wr™e
(
r
->
io
.
fd£t
.
fds
[
j
],
p
+
nwr™‹n
,
couÁ
-nwritten);

206 ià(
»tv®
 <= 0) {

211 ià(
»tv®
 =ğ-1 && 
”ºo
 =ğ
EWOULDBLOCK
è”ºØğ
ETIMEDOUT
;

214 
nwr™‹n
 +ğ
»tv®
;

217 ià(
nwr™‹n
 !ğ
couÁ
) {

219 
r
->
io
.
fd£t
.
¡©e
[
j
] = 
”ºo
;

220 ià(
r
->
io
.
fd£t
.
¡©e
[
j
] =ğ0èr->io.fd£t.¡©e[j] = 
EIO
;

223 ià(
brok’
 =ğ
r
->
io
.
fd£t
.
numfds
)  0;

224 
p
 +ğ
couÁ
;

225 
Ën
 -ğ
couÁ
;

226 
r
->
io
.
fd£t
.
pos
 +ğ
couÁ
;

229 ià(
doæush
è
	`sdsş—r
(
r
->
io
.
fd£t
.
buf
);

231 
	}
}

234 
size_t
 
	$rioFd£tR—d
(
rio
 *
r
, *
buf
, 
size_t
 
Ën
) {

235 
	`UNUSED
(
r
);

236 
	`UNUSED
(
buf
);

237 
	`UNUSED
(
Ën
);

239 
	}
}

242 
off_t
 
	$rioFd£tT–l
(
rio
 *
r
) {

243  
r
->
io
.
fd£t
.
pos
;

244 
	}
}

248 
	$rioFd£tFlush
(
rio
 *
r
) {

251  
	`rioFd£tWr™e
(
r
,
NULL
,0);

252 
	}
}

254 cÚ¡ 
rio
 
	grioFd£tIO
 = {

255 
rioFd£tR—d
,

256 
rioFd£tWr™e
,

257 
rioFd£tT–l
,

258 
rioFd£tFlush
,

259 
NULL
,

263 { { 
NULL
, 0 } }

266 
	$rioIn™W™hFd£t
(
rio
 *
r
, *
fds
, 
numfds
) {

267 
j
;

269 *
r
 = 
rioFd£tIO
;

270 
r
->
io
.
fd£t
.
fds
 = 
	`zm®loc
(()*
numfds
);

271 
r
->
io
.
fd£t
.
¡©e
 = 
	`zm®loc
(()*
numfds
);

272 
	`memıy
(
r
->
io
.
fd£t
.
fds
,fds,()*
numfds
);

273 
j
 = 0; j < 
numfds
; j++è
r
->
io
.
fd£t
.
¡©e
[j] = 0;

274 
r
->
io
.
fd£t
.
numfds
 =‚umfds;

275 
r
->
io
.
fd£t
.
pos
 = 0;

276 
r
->
io
.
fd£t
.
buf
 = 
	`sd£m±y
();

277 
	}
}

280 
	$rioF»eFd£t
(
rio
 *
r
) {

281 
	`zä“
(
r
->
io
.
fd£t
.
fds
);

282 
	`zä“
(
r
->
io
.
fd£t
.
¡©e
);

283 
	`sdsä“
(
r
->
io
.
fd£t
.
buf
);

284 
	}
}

290 
	$rioG’”icUpd©eChecksum
(
rio
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
) {

291 
r
->
cksum
 = 
	`üc64
Ô->cksum,
buf
,
Ën
);

292 
	}
}

302 
	$rioS‘AutoSync
(
rio
 *
r
, 
off_t
 
by‹s
) {

303 
	`£rv”As£¹
(
r
->
»ad
 =ğ
rioFeIO
.read);

304 
r
->
io
.
fe
.
autosync
 = 
by‹s
;

305 
	}
}

313 
size_t
 
	$rioWr™eBulkCouÁ
(
rio
 *
r
, 
´efix
, 
couÁ
) {

314 
cbuf
[128];

315 
ş’
;

317 
cbuf
[0] = 
´efix
;

318 
ş’
 = 1+
	`Î2¡ršg
(
cbuf
+1,(cbuf)-1,
couÁ
);

319 
cbuf
[
ş’
++] = '\r';

320 
cbuf
[
ş’
++] = '\n';

321 ià(
	`rioWr™e
(
r
,
cbuf
,
ş’
) == 0)  0;

322  
ş’
;

323 
	}
}

326 
size_t
 
	$rioWr™eBulkSŒšg
(
rio
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
) {

327 
size_t
 
nwr™‹n
;

329 ià((
nwr™‹n
 = 
	`rioWr™eBulkCouÁ
(
r
,'$',
Ën
)) == 0)  0;

330 ià(
Ën
 > 0 && 
	`rioWr™e
(
r
,
buf
,len) == 0)  0;

331 ià(
	`rioWr™e
(
r
,"\r\n",2) == 0)  0;

332  
nwr™‹n
+
Ën
+2;

333 
	}
}

336 
size_t
 
	$rioWr™eBulkLÚgLÚg
(
rio
 *
r
, 
l
) {

337 
lbuf
[32];

338 
Î’
;

340 
Î’
 = 
	`Î2¡ršg
(
lbuf
,Öbuf),
l
);

341  
	`rioWr™eBulkSŒšg
(
r
,
lbuf
,
Î’
);

342 
	}
}

345 
size_t
 
	$rioWr™eBulkDoubË
(
rio
 *
r
, 
d
) {

346 
dbuf
[128];

347 
dËn
;

349 
dËn
 = 
	`¢´štf
(
dbuf
,(dbuf),"%.17g",
d
);

350  
	`rioWr™eBulkSŒšg
(
r
,
dbuf
,
dËn
);

351 
	}
}

	@src/rio.h

32 #iâdeà
__REDIS_RIO_H


33 
	#__REDIS_RIO_H


	)

35 
	~<¡dio.h
>

36 
	~<¡dšt.h
>

37 
	~"sds.h
"

39 
	s_rio
 {

43 
size_t
 (*
»ad
)(
	m_rio
 *, *
	mbuf
, size_ˆ
	mËn
);

44 
size_t
 (*
wr™e
)(
	m_rio
 *, cÚ¡ *
	mbuf
, size_ˆ
	mËn
);

45 
off_t
 (*
‹Î
)(
	m_rio
 *);

46 (*
	mæush
)(
	m_rio
 *);

52 (*
	mupd©e_cksum
)(
	m_rio
 *, cÚ¡ *
	mbuf
, 
size_t
 
	mËn
);

55 
ušt64_t
 
	mcksum
;

58 
size_t
 
	m´oûs£d_by‹s
;

61 
size_t
 
	mmax_´oûssšg_chunk
;

67 
sds
 
	m±r
;

68 
off_t
 
	mpos
;

69 } 
	mbufãr
;

72 
FILE
 *
	må
;

73 
off_t
 
	mbufã»d
;

74 
off_t
 
	mautosync
;

75 } 
	mfe
;

78 *
	mfds
;

79 *
	m¡©e
;

80 
	mnumfds
;

81 
off_t
 
	mpos
;

82 
sds
 
	mbuf
;

83 } 
	mfd£t
;

84 } 
	mio
;

87 
_rio
 
	trio
;

93 
šlše
 
size_t
 
	$rioWr™e
(
rio
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
) {

94 
Ën
) {

95 
size_t
 
by‹s_to_wr™e
 = (
r
->
max_´oûssšg_chunk
 &&„->max_´oûssšg_chunk < 
Ën
) ?„->max_processing_chunk :†en;

96 ià(
r
->
upd©e_cksum
èr->
	`upd©e_cksum
Ô,
buf
,
by‹s_to_wr™e
);

97 ià(
r
->
	`wr™e
Ô,
buf
,
by‹s_to_wr™e
) == 0)

99 
buf
 = (*)buà+ 
by‹s_to_wr™e
;

100 
Ën
 -ğ
by‹s_to_wr™e
;

101 
r
->
´oûs£d_by‹s
 +ğ
by‹s_to_wr™e
;

104 
	}
}

106 
šlše
 
size_t
 
	$rioR—d
(
rio
 *
r
, *
buf
, 
size_t
 
Ën
) {

107 
Ën
) {

108 
size_t
 
by‹s_to_»ad
 = (
r
->
max_´oûssšg_chunk
 &&„->max_´oûssšg_chunk < 
Ën
) ?„->max_processing_chunk :†en;

109 ià(
r
->
	`»ad
Ô,
buf
,
by‹s_to_»ad
) == 0)

111 ià(
r
->
upd©e_cksum
èr->
	`upd©e_cksum
Ô,
buf
,
by‹s_to_»ad
);

112 
buf
 = (*)buà+ 
by‹s_to_»ad
;

113 
Ën
 -ğ
by‹s_to_»ad
;

114 
r
->
´oûs£d_by‹s
 +ğ
by‹s_to_»ad
;

117 
	}
}

119 
šlše
 
off_t
 
	$rioT–l
(
rio
 *
r
) {

120  
r
->
	`‹Î
(r);

121 
	}
}

123 
šlše
 
	$rioFlush
(
rio
 *
r
) {

124  
r
->
	`æush
(r);

125 
	}
}

127 
rioIn™W™hFe
(
rio
 *
r
, 
FILE
 *
å
);

128 
rioIn™W™hBufãr
(
rio
 *
r
, 
sds
 
s
);

129 
rioIn™W™hFd£t
(
rio
 *
r
, *
fds
, 
numfds
);

131 
rioF»eFd£t
(
rio
 *
r
);

133 
size_t
 
rioWr™eBulkCouÁ
(
rio
 *
r
, 
´efix
, 
couÁ
);

134 
size_t
 
rioWr™eBulkSŒšg
(
rio
 *
r
, cÚ¡ *
buf
, size_ˆ
Ën
);

135 
size_t
 
rioWr™eBulkLÚgLÚg
(
rio
 *
r
, 
l
);

136 
size_t
 
rioWr™eBulkDoubË
(
rio
 *
r
, 
d
);

138 
rioG’”icUpd©eChecksum
(
rio
 *
r
, cÚ¡ *
buf
, 
size_t
 
Ën
);

139 
rioS‘AutoSync
(
rio
 *
r
, 
off_t
 
by‹s
);

	@src/scripting.c

30 
	~"£rv”.h
"

31 
	~"sha1.h
"

32 
	~"¿nd.h
"

33 
	~"şu¡”.h
"

35 
	~<lua.h
>

36 
	~<Ïuxlib.h
>

37 
	~<lu®ib.h
>

38 
	~<ùy³.h
>

39 
	~<m©h.h
>

41 *
»disPrÙocŞToLuaTy³_IÁ
(
lua_S‹
 *
lua
, *
»¶y
);

42 *
»disPrÙocŞToLuaTy³_Bulk
(
lua_S‹
 *
lua
, *
»¶y
);

43 *
»disPrÙocŞToLuaTy³_Stus
(
lua_S‹
 *
lua
, *
»¶y
);

44 *
»disPrÙocŞToLuaTy³_E¼Ü
(
lua_S‹
 *
lua
, *
»¶y
);

45 *
»disPrÙocŞToLuaTy³_MuÉiBulk
(
lua_S‹
 *
lua
, *
»¶y
);

46 
»dis_m©h_¿ndom
 (
lua_S‹
 *
L
);

47 
»dis_m©h_¿ndom£ed
 (
lua_S‹
 *
L
);

48 
ldbIn™
();

49 
ldbDi§bË
(
ş›Á
 *
c
);

50 
ldbEÇbË
(
ş›Á
 *
c
);

51 
ev®G’”icCommªdW™hDebuggšg
(
ş›Á
 *
c
, 
ev®sha
);

52 
luaLdbLšeHook
(
lua_S‹
 *
lua
, 
lua_Debug
 *
¬
);

53 
ldbLog
(
sds
 
’Œy
);

54 
ldbLogRedisR•ly
(*
»¶y
);

55 
sds
 
ldbC©SckV®ue
(sd 
s
, 
lua_S‹
 *
lua
, 
idx
);

58 
	#LDB_BREAKPOINTS_MAX
 64

	)

59 
	#LDB_MAX_LEN_DEFAULT
 256

	)

60 
	sldbS‹
 {

61 
	mfd
;

62 
	maùive
;

63 
	mfÜked
;

64 
li¡
 *
	mlogs
;

65 
li¡
 *
	mŒaûs
;

66 
li¡
 *
	mchd»n
;

67 
	mbp
[
LDB_BREAKPOINTS_MAX
];

68 
	mbpcouÁ
;

69 
	m¡•
;

70 
	mluabp
;

71 
sds
 *
	m¤c
;

72 
	mlšes
;

73 
	mcu¼’še
;

74 
sds
 
	mcbuf
;

75 
size_t
 
	mmaxËn
;

76 
	mmaxËn_hšt_£Á
;

77 } 
	gldb
;

89 
	$sha1hex
(*
dige¡
, *
süt
, 
size_t
 
Ën
) {

90 
SHA1_CTX
 
ùx
;

91 
hash
[20];

92 *
c£t
 = "0123456789abcdef";

93 
j
;

95 
	`SHA1In™
(&
ùx
);

96 
	`SHA1Upd©e
(&
ùx
,(*)
süt
,
Ën
);

97 
	`SHA1Fš®
(
hash
,&
ùx
);

99 
j
 = 0; j < 20; j++) {

100 
dige¡
[
j
*2] = 
c£t
[((
hash
[j]&0xF0)>>4)];

101 
dige¡
[
j
*2+1] = 
c£t
[(
hash
[j]&0xF)];

103 
dige¡
[40] = '\0';

104 
	}
}

127 *
	$»disPrÙocŞToLuaTy³
(
lua_S‹
 *
lua
, * 
»¶y
) {

128 *
p
 = 
»¶y
;

130 *
p
) {

131 ':': 
p
 = 
	`»disPrÙocŞToLuaTy³_IÁ
(
lua
,
»¶y
); ;

132 '$': 
p
 = 
	`»disPrÙocŞToLuaTy³_Bulk
(
lua
,
»¶y
); ;

133 '+': 
p
 = 
	`»disPrÙocŞToLuaTy³_Stus
(
lua
,
»¶y
); ;

134 '-': 
p
 = 
	`»disPrÙocŞToLuaTy³_E¼Ü
(
lua
,
»¶y
); ;

135 '*': 
p
 = 
	`»disPrÙocŞToLuaTy³_MuÉiBulk
(
lua
,
»¶y
); ;

137  
p
;

138 
	}
}

140 *
	$»disPrÙocŞToLuaTy³_IÁ
(
lua_S‹
 *
lua
, *
»¶y
) {

141 *
p
 = 
	`¡rchr
(
»¶y
+1,'\r');

142 
v®ue
;

144 
	`¡ršg2Î
(
»¶y
+1,
p
-»¶y-1,&
v®ue
);

145 
	`lua_pushnumb”
(
lua
,(
lua_Numb”
)
v®ue
);

146  
p
+2;

147 
	}
}

149 *
	$»disPrÙocŞToLuaTy³_Bulk
(
lua_S‹
 *
lua
, *
»¶y
) {

150 *
p
 = 
	`¡rchr
(
»¶y
+1,'\r');

151 
bulkËn
;

153 
	`¡ršg2Î
(
»¶y
+1,
p
-»¶y-1,&
bulkËn
);

154 ià(
bulkËn
 == -1) {

155 
	`lua_pushboŞ—n
(
lua
,0);

156  
p
+2;

158 
	`lua_pushl¡ršg
(
lua
,
p
+2,
bulkËn
);

159  
p
+2+
bulkËn
+2;

161 
	}
}

163 *
	$»disPrÙocŞToLuaTy³_Stus
(
lua_S‹
 *
lua
, *
»¶y
) {

164 *
p
 = 
	`¡rchr
(
»¶y
+1,'\r');

166 
	`lua_ÃwbË
(
lua
);

167 
	`lua_push¡ršg
(
lua
,"ok");

168 
	`lua_pushl¡ršg
(
lua
,
»¶y
+1,
p
-reply-1);

169 
	`lua_£‰abË
(
lua
,-3);

170  
p
+2;

171 
	}
}

173 *
	$»disPrÙocŞToLuaTy³_E¼Ü
(
lua_S‹
 *
lua
, *
»¶y
) {

174 *
p
 = 
	`¡rchr
(
»¶y
+1,'\r');

176 
	`lua_ÃwbË
(
lua
);

177 
	`lua_push¡ršg
(
lua
,"err");

178 
	`lua_pushl¡ršg
(
lua
,
»¶y
+1,
p
-reply-1);

179 
	`lua_£‰abË
(
lua
,-3);

180  
p
+2;

181 
	}
}

183 *
	$»disPrÙocŞToLuaTy³_MuÉiBulk
(
lua_S‹
 *
lua
, *
»¶y
) {

184 *
p
 = 
	`¡rchr
(
»¶y
+1,'\r');

185 
mbulkËn
;

186 
j
 = 0;

188 
	`¡ršg2Î
(
»¶y
+1,
p
-»¶y-1,&
mbulkËn
);

189 
p
 += 2;

190 ià(
mbulkËn
 == -1) {

191 
	`lua_pushboŞ—n
(
lua
,0);

192  
p
;

194 
	`lua_ÃwbË
(
lua
);

195 
j
 = 0; j < 
mbulkËn
; j++) {

196 
	`lua_pushnumb”
(
lua
,
j
+1);

197 
p
 = 
	`»disPrÙocŞToLuaTy³
(
lua
,p);

198 
	`lua_£‰abË
(
lua
,-3);

200  
p
;

201 
	}
}

208 
	$luaPushE¼Ü
(
lua_S‹
 *
lua
, *
”rÜ
) {

209 
lua_Debug
 
dbg
;

213 ià(
ldb
.
aùive
 &&†db.
¡•
) {

214 
	`ldbLog
(
	`sdsÿrštf
(
	`sd£m±y
(),"<”rÜ> %s",
”rÜ
));

217 
	`lua_ÃwbË
(
lua
);

218 
	`lua_push¡ršg
(
lua
,"err");

221 if(
	`lua_g‘¡ack
(
lua
, 1, &
dbg
è&& 
	`lua_g‘šfo
(lua, "nSl", &dbg)) {

222 
sds
 
msg
 = 
	`sdsÿrštf
(
	`sd£m±y
(), "%s: %d: %s",

223 
dbg
.
sourû
, dbg.
cu¼’še
, 
”rÜ
);

224 
	`lua_push¡ršg
(
lua
, 
msg
);

225 
	`sdsä“
(
msg
);

227 
	`lua_push¡ršg
(
lua
, 
”rÜ
);

229 
	`lua_£‰abË
(
lua
,-3);

230 
	}
}

236 
	$luaRai£E¼Ü
(
lua_S‹
 *
lua
) {

237 
	`lua_push¡ršg
(
lua
,"err");

238 
	`lua_g‘bË
(
lua
,-2);

239  
	`lua_”rÜ
(
lua
);

240 
	}
}

248 
	$luaSÜtA¼ay
(
lua_S‹
 *
lua
) {

250 
	`lua_g‘glob®
(
lua
,"table");

251 
	`lua_push¡ršg
(
lua
,"sort");

252 
	`lua_g‘bË
(
lua
,-2);

253 
	`lua_pushv®ue
(
lua
,-3);

254 ià(
	`lua_pÿÎ
(
lua
,1,0,0)) {

261 
	`lua_pİ
(
lua
,1);

262 
	`lua_push¡ršg
(
lua
,"sort");

263 
	`lua_g‘bË
(
lua
,-2);

264 
	`lua_pushv®ue
(
lua
,-3);

265 
	`lua_g‘glob®
(
lua
,"__redis__compare_helper");

267 
	`lua_ÿÎ
(
lua
,2,0);

270 
	`lua_pİ
(
lua
,1);

271 
	}
}

277 
	$luaR•lyToRedisR•ly
(
ş›Á
 *
c
, 
lua_S‹
 *
lua
) {

278 
t
 = 
	`lua_ty³
(
lua
,-1);

280 
t
) {

281 
LUA_TSTRING
:

282 
	`addR•lyBulkCBufãr
(
c
,(*)
	`lua_to¡ršg
(
lua
,-1),
	`lua_¡¾’
(lua,-1));

284 
LUA_TBOOLEAN
:

285 
	`addR•ly
(
c
,
	`lua_toboŞ—n
(
lua
,-1è? 
sh¬ed
.
cÚe
 : sh¬ed.
nuÎbulk
);

287 
LUA_TNUMBER
:

288 
	`addR•lyLÚgLÚg
(
c
,()
	`lua_tÚumb”
(
lua
,-1));

290 
LUA_TTABLE
:

295 
	`lua_push¡ršg
(
lua
,"err");

296 
	`lua_g‘bË
(
lua
,-2);

297 
t
 = 
	`lua_ty³
(
lua
,-1);

298 ià(
t
 =ğ
LUA_TSTRING
) {

299 
sds
 
”r
 = 
	`sd¢ew
(
	`lua_to¡ršg
(
lua
,-1));

300 
	`sdsm­ch¬s
(
”r
,"\r\n"," ",2);

301 
	`addR•lySds
(
c
,
	`sdsÿrštf
(
	`sd£m±y
(),"-%s\r\n",
”r
));

302 
	`sdsä“
(
”r
);

303 
	`lua_pİ
(
lua
,2);

307 
	`lua_pİ
(
lua
,1);

308 
	`lua_push¡ršg
(
lua
,"ok");

309 
	`lua_g‘bË
(
lua
,-2);

310 
t
 = 
	`lua_ty³
(
lua
,-1);

311 ià(
t
 =ğ
LUA_TSTRING
) {

312 
sds
 
ok
 = 
	`sd¢ew
(
	`lua_to¡ršg
(
lua
,-1));

313 
	`sdsm­ch¬s
(
ok
,"\r\n"," ",2);

314 
	`addR•lySds
(
c
,
	`sdsÿrštf
(
	`sd£m±y
(),"+%s\r\n",
ok
));

315 
	`sdsä“
(
ok
);

316 
	`lua_pİ
(
lua
,1);

318 *
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

319 
j
 = 1, 
mbulkËn
 = 0;

321 
	`lua_pİ
(
lua
,1);

323 
	`lua_pushnumb”
(
lua
,
j
++);

324 
	`lua_g‘bË
(
lua
,-2);

325 
t
 = 
	`lua_ty³
(
lua
,-1);

326 ià(
t
 =ğ
LUA_TNIL
) {

327 
	`lua_pİ
(
lua
,1);

330 
	`luaR•lyToRedisR•ly
(
c
, 
lua
);

331 
mbulkËn
++;

333 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
»¶yËn
,
mbulkËn
);

337 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

339 
	`lua_pİ
(
lua
,1);

340 
	}
}

346 
	#LUA_CMD_OBJCACHE_SIZE
 32

	)

347 
	#LUA_CMD_OBJCACHE_MAX_LEN
 64

	)

348 
	$luaRedisG’”icCommªd
(
lua_S‹
 *
lua
, 
¿i£_”rÜ
) {

349 
j
, 
¬gc
 = 
	`lua_g‘tİ
(
lua
);

350 
»disCommªd
 *
cmd
;

351 
ş›Á
 *
c
 = 
£rv”
.
lua_ş›Á
;

352 
sds
 
»¶y
;

355 
robj
 **
¬gv
 = 
NULL
;

356 
¬gv_size
 = 0;

357 
robj
 *
ÿched_objeùs
[
LUA_CMD_OBJCACHE_SIZE
];

358 
size_t
 
ÿched_objeùs_Ën
[
LUA_CMD_OBJCACHE_SIZE
];

359 
šu£
 = 0;

365 ià(
šu£
) {

366 *
»cursiÚ_w¬nšg
 =

369 
	`£rv”Log
(
LL_WARNING
,"%s",
»cursiÚ_w¬nšg
);

370 
	`luaPushE¼Ü
(
lua
,
»cursiÚ_w¬nšg
);

373 
šu£
++;

376 ià(
¬gc
 == 0) {

377 
	`luaPushE¼Ü
(
lua
,

379 
šu£
--;

380  
¿i£_”rÜ
 ? 
	`luaRai£E¼Ü
(
lua
) : 1;

384 ià(
¬gv_size
 < 
¬gc
) {

385 
¬gv
 = 
	`z»®loc
×rgv,(
robj
*)*
¬gc
);

386 
¬gv_size
 = 
¬gc
;

389 
j
 = 0; j < 
¬gc
; j++) {

390 *
obj_s
;

391 
size_t
 
obj_Ën
;

392 
dbuf
[64];

394 ià(
	`lua_ty³
(
lua
,
j
+1è=ğ
LUA_TNUMBER
) {

397 
lua_Numb”
 
num
 = 
	`lua_tÚumb”
(
lua
,
j
+1);

399 
obj_Ën
 = 
	`¢´štf
(
dbuf
,(dbuf),"%.17g",()
num
);

400 
obj_s
 = 
dbuf
;

402 
obj_s
 = (*)
	`lua_tŞ¡ršg
(
lua
,
j
+1,&
obj_Ën
);

403 ià(
obj_s
 =ğ
NULL
) ;

407 ià(
j
 < 
LUA_CMD_OBJCACHE_SIZE
 && 
ÿched_objeùs
[j] &&

408 
ÿched_objeùs_Ën
[
j
] >ğ
obj_Ën
)

410 
sds
 
s
 = 
ÿched_objeùs
[
j
]->
±r
;

411 
¬gv
[
j
] = 
ÿched_objeùs
[j];

412 
ÿched_objeùs
[
j
] = 
NULL
;

413 
	`memıy
(
s
,
obj_s
,
obj_Ën
+1);

414 
	`sds£’
(
s
, 
obj_Ën
);

416 
¬gv
[
j
] = 
	`ü—‹SŒšgObjeù
(
obj_s
, 
obj_Ën
);

423 ià(
j
 !ğ
¬gc
) {

424 
j
--;

425 
j
 >= 0) {

426 
	`deüRefCouÁ
(
¬gv
[
j
]);

427 
j
--;

429 
	`luaPushE¼Ü
(
lua
,

431 
šu£
--;

432  
¿i£_”rÜ
 ? 
	`luaRai£E¼Ü
(
lua
) : 1;

436 
c
->
¬gv
 =‡rgv;

437 
c
->
¬gc
 =‡rgc;

440 ià(
ldb
.
aùive
 &&†db.
¡•
) {

441 
sds
 
cmdlog
 = 
	`sd¢ew
("<redis>");

442 
j
 = 0; j < 
c
->
¬gc
; j++) {

443 ià(
j
 == 10) {

444 
cmdlog
 = 
	`sdsÿrštf
(cmdlog," ... (%d more)",

445 
c
->
¬gc
-
j
-1);

447 
cmdlog
 = 
	`sdsÿ’
(cmdlog," ",1);

448 
cmdlog
 = 
	`sdsÿtsds
(cmdlog,
c
->
¬gv
[
j
]->
±r
);

451 
	`ldbLog
(
cmdlog
);

455 
cmd
 = 
	`lookupCommªd
(
¬gv
[0]->
±r
);

456 ià(!
cmd
 || ((cmd->
¬™y
 > 0 && cmd->¬™y !ğ
¬gc
) ||

457 (
¬gc
 < -
cmd
->
¬™y
)))

459 ià(
cmd
)

460 
	`luaPushE¼Ü
(
lua
,

463 
	`luaPushE¼Ü
(
lua
,"Unknown Redis command called from Lua script");

464 
ş—nup
;

466 
c
->
cmd
 = c->
Ï¡cmd
 = cmd;

469 ià(
cmd
->
æags
 & 
CMD_NOSCRIPT
) {

470 
	`luaPushE¼Ü
(
lua
, "This Redis command is‚ot‡llowed from scripts");

471 
ş—nup
;

477 ià(
cmd
->
æags
 & 
CMD_WRITE
) {

478 ià(
£rv”
.
lua_¿ndom_dœty
 && !£rv”.
lua_»¶iÿ‹_commªds
) {

479 
	`luaPushE¼Ü
(
lua
,

481 
ş—nup
;

482 } ià(
£rv”
.
ma¡”ho¡
 && s”v”.
»¶_¦ave_ro
 &&

483 !
£rv”
.
lßdšg
 &&

484 !(
£rv”
.
lua_ÿÎ”
->
æags
 & 
CLIENT_MASTER
))

486 
	`luaPushE¼Ü
(
lua
, 
sh¬ed
.
ro¦av“¼
->
±r
);

487 
ş—nup
;

488 } ià(
£rv”
.
¡İ_wr™es_Ú_bg§ve_”r
 &&

489 
£rv”
.
§v•¬am¦’
 > 0 &&

490 
£rv”
.
Ï¡bg§ve_¡©us
 =ğ
C_ERR
)

492 
	`luaPushE¼Ü
(
lua
, 
sh¬ed
.
bg§v“¼
->
±r
);

493 
ş—nup
;

501 ià(
£rv”
.
maxmemÜy
 && s”v”.
lua_wr™e_dœty
 == 0 &&

502 (
cmd
->
æags
 & 
CMD_DENYOOM
))

504 ià(
	`ä“MemÜyIfN“ded
(è=ğ
C_ERR
) {

505 
	`luaPushE¼Ü
(
lua
, 
sh¬ed
.
oom”r
->
±r
);

506 
ş—nup
;

510 ià(
cmd
->
æags
 & 
CMD_RANDOM
è
£rv”
.
lua_¿ndom_dœty
 = 1;

511 ià(
cmd
->
æags
 & 
CMD_WRITE
è
£rv”
.
lua_wr™e_dœty
 = 1;

516 ià(
£rv”
.
şu¡”_’abËd
 && !£rv”.
lßdšg
 &&

517 !(
£rv”
.
lua_ÿÎ”
->
æags
 & 
CLIENT_MASTER
))

520 
c
->
æags
 &ğ~(
CLIENT_READONLY
|
CLIENT_ASKING
);

521 
c
->
æags
 |ğ
£rv”
.
lua_ÿÎ”
->æag & (
CLIENT_READONLY
|
CLIENT_ASKING
);

522 ià(
	`g‘NodeByQu”y
(
c
,c->
cmd
,c->
¬gv
,c->
¬gc
,
NULL
,NULL) !=

523 
£rv”
.
şu¡”
->
my£lf
)

525 
	`luaPushE¼Ü
(
lua
,

528 
ş—nup
;

535 ià(
£rv”
.
lua_»¶iÿ‹_commªds
 &&

536 !
£rv”
.
lua_muÉi_em™‹d
 &&

537 
£rv”
.
lua_wr™e_dœty
 &&

538 
£rv”
.
lua_»¶
 !ğ
PROPAGATE_NONE
)

540 
	`execCommªdPrİag©eMuÉi
(
£rv”
.
lua_ÿÎ”
);

541 
£rv”
.
lua_muÉi_em™‹d
 = 1;

545 
ÿÎ_æags
 = 
CMD_CALL_SLOWLOG
 | 
CMD_CALL_STATS
;

546 ià(
£rv”
.
lua_»¶iÿ‹_commªds
) {

548 ià(
£rv”
.
lua_»¶
 & 
PROPAGATE_AOF
)

549 
ÿÎ_æags
 |ğ
CMD_CALL_PROPAGATE_AOF
;

550 ià(
£rv”
.
lua_»¶
 & 
PROPAGATE_REPL
)

551 
ÿÎ_æags
 |ğ
CMD_CALL_PROPAGATE_REPL
;

553 
	`ÿÎ
(
c
,
ÿÎ_æags
);

558 ià(
	`li¡L’gth
(
c
->
»¶y
è=ğ0 && c->
buåos
 < 
PROTO_REPLY_CHUNK_BYTES
) {

562 
c
->
buf
[c->
buåos
] = '\0';

563 
»¶y
 = 
c
->
buf
;

564 
c
->
buåos
 = 0;

566 
»¶y
 = 
	`sd¢ewËn
(
c
->
buf
,c->
buåos
);

567 
c
->
buåos
 = 0;

568 
	`li¡L’gth
(
c
->
»¶y
)) {

569 
robj
 *
o
 = 
	`li¡NodeV®ue
(
	`li¡Fœ¡
(
c
->
»¶y
));

571 
»¶y
 = 
	`sdsÿ’
Ô•ly,
o
->
±r
,
	`sd¦’
(o->ptr));

572 
	`li¡D–Node
(
c
->
»¶y
,
	`li¡Fœ¡
(c->reply));

575 ià(
¿i£_”rÜ
 && 
»¶y
[0] != '-')„aise_error = 0;

576 
	`»disPrÙocŞToLuaTy³
(
lua
,
»¶y
);

579 ià(
ldb
.
aùive
 &&†db.
¡•
)

580 
	`ldbLogRedisR•ly
(
»¶y
);

584 ià((
cmd
->
æags
 & 
CMD_SORT_FOR_SCRIPT
) &&

585 (
£rv”
.
lua_»¶iÿ‹_commªds
 == 0) &&

586 (
»¶y
[0] == '*' &&„eply[1] != '-')) {

587 
	`luaSÜtA¼ay
(
lua
);

589 ià(
»¶y
 !ğ
c
->
buf
è
	`sdsä“
(reply);

590 
c
->
»¶y_by‹s
 = 0;

592 
ş—nup
:

595 
j
 = 0; j < 
c
->
¬gc
; j++) {

596 
robj
 *
o
 = 
c
->
¬gv
[
j
];

601 ià(
j
 < 
LUA_CMD_OBJCACHE_SIZE
 &&

602 
o
->
»fcouÁ
 == 1 &&

603 (
o
->
’codšg
 =ğ
OBJ_ENCODING_RAW
 ||

604 
o
->
’codšg
 =ğ
OBJ_ENCODING_EMBSTR
) &&

605 
	`sd¦’
(
o
->
±r
è<ğ
LUA_CMD_OBJCACHE_MAX_LEN
)

607 
sds
 
s
 = 
o
->
±r
;

608 ià(
ÿched_objeùs
[
j
]è
	`deüRefCouÁ
(cached_objects[j]);

609 
ÿched_objeùs
[
j
] = 
o
;

610 
ÿched_objeùs_Ën
[
j
] = 
	`sd§Îoc
(
s
);

612 
	`deüRefCouÁ
(
o
);

616 ià(
c
->
¬gv
 !=‡rgv) {

617 
	`zä“
(
c
->
¬gv
);

618 
¬gv
 = 
NULL
;

619 
¬gv_size
 = 0;

622 ià(
¿i£_”rÜ
) {

626 
šu£
--;

627  
	`luaRai£E¼Ü
(
lua
);

629 
šu£
--;

631 
	}
}

634 
	$luaRedisC®lCommªd
(
lua_S‹
 *
lua
) {

635  
	`luaRedisG’”icCommªd
(
lua
,1);

636 
	}
}

639 
	$luaRedisPC®lCommªd
(
lua_S‹
 *
lua
) {

640  
	`luaRedisG’”icCommªd
(
lua
,0);

641 
	}
}

645 
	$luaRedisSha1hexCommªd
(
lua_S‹
 *
lua
) {

646 
¬gc
 = 
	`lua_g‘tİ
(
lua
);

647 
dige¡
[41];

648 
size_t
 
Ën
;

649 *
s
;

651 ià(
¬gc
 != 1) {

652 
	`lua_push¡ršg
(
lua
, "wrong‚umber of‡rguments");

653  
	`lua_”rÜ
(
lua
);

656 
s
 = (*)
	`lua_tŞ¡ršg
(
lua
,1,&
Ën
);

657 
	`sha1hex
(
dige¡
,
s
,
Ën
);

658 
	`lua_push¡ršg
(
lua
,
dige¡
);

660 
	}
}

669 
	$luaRedisR‘uºSšgËF›ldTabË
(
lua_S‹
 *
lua
, *
f›ld
) {

670 ià(
	`lua_g‘tİ
(
lua
è!ğ1 || 
	`lua_ty³
Öua,-1è!ğ
LUA_TSTRING
) {

671 
	`luaPushE¼Ü
(
lua
, "wrong‚umber orype of‡rguments");

675 
	`lua_ÃwbË
(
lua
);

676 
	`lua_push¡ršg
(
lua
, 
f›ld
);

677 
	`lua_pushv®ue
(
lua
, -3);

678 
	`lua_£‰abË
(
lua
, -3);

680 
	}
}

683 
	$luaRedisE¼ÜR•lyCommªd
(
lua_S‹
 *
lua
) {

684  
	`luaRedisR‘uºSšgËF›ldTabË
(
lua
,"err");

685 
	}
}

688 
	$luaRedisStusR•lyCommªd
(
lua_S‹
 *
lua
) {

689  
	`luaRedisR‘uºSšgËF›ldTabË
(
lua
,"ok");

690 
	}
}

698 
	$luaRedisR•liÿ‹CommªdsCommªd
(
lua_S‹
 *
lua
) {

699 ià(
£rv”
.
lua_wr™e_dœty
) {

700 
	`lua_pushboŞ—n
(
lua
,0);

702 
£rv”
.
lua_»¶iÿ‹_commªds
 = 1;

706 
	`»disS¿nd48
(
	`¿nd
());

707 
	`lua_pushboŞ—n
(
lua
,1);

710 
	}
}

717 
	$luaRedisB»akpoštCommªd
(
lua_S‹
 *
lua
) {

718 ià(
ldb
.
aùive
) {

719 
ldb
.
luabp
 = 1;

720 
	`lua_pushboŞ—n
(
lua
,1);

722 
	`lua_pushboŞ—n
(
lua
,0);

725 
	}
}

732 
	$luaRedisDebugCommªd
(
lua_S‹
 *
lua
) {

733 ià(!
ldb
.
aùive
)  0;

734 
¬gc
 = 
	`lua_g‘tİ
(
lua
);

735 
sds
 
log
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"<debug>†š%d: ", 
ldb
.
cu¼’še
);

736 
¬gc
--) {

737 
log
 = 
	`ldbC©SckV®ue
Öog,
lua
,-1 - 
¬gc
);

738 ià(
¬gc
 !ğ0è
log
 = 
	`sdsÿ’
(log,", ",2);

740 
	`ldbLog
(
log
);

742 
	}
}

748 
	$luaRedisS‘R•lCommªd
(
lua_S‹
 *
lua
) {

749 
¬gc
 = 
	`lua_g‘tİ
(
lua
);

750 
æags
;

752 ià(
£rv”
.
lua_»¶iÿ‹_commªds
 == 0) {

753 
	`lua_push¡ršg
(
lua
, "You can sethe„eplication behavior only‡fterurning on single commands„eplication with„edis.replicate_commands().");

754  
	`lua_”rÜ
(
lua
);

755 } ià(
¬gc
 != 1) {

756 
	`lua_push¡ršg
(
lua
, "redis.set_repl()„equireswo‡rguments.");

757  
	`lua_”rÜ
(
lua
);

760 
æags
 = 
	`lua_tÚumb”
(
lua
,-1);

761 ià((
æags
 & ~(
PROPAGATE_AOF
|
PROPAGATE_REPL
)) != 0) {

762 
	`lua_push¡ršg
(
lua
, "Invalid„eplication flags. Use REPL_AOF, REPL_SLAVE, REPL_ALL or REPL_NONE.");

763  
	`lua_”rÜ
(
lua
);

765 
£rv”
.
lua_»¶
 = 
æags
;

767 
	}
}

770 
	$luaLogCommªd
(
lua_S‹
 *
lua
) {

771 
j
, 
¬gc
 = 
	`lua_g‘tİ
(
lua
);

772 
Ëv–
;

773 
sds
 
log
;

775 ià(
¬gc
 < 2) {

776 
	`lua_push¡ršg
(
lua
, "redis.log()„equireswo‡rguments or more.");

777  
	`lua_”rÜ
(
lua
);

778 } ià(!
	`lua_i¢umb”
(
lua
,-
¬gc
)) {

779 
	`lua_push¡ršg
(
lua
, "First‡rgument must be‡‚umber (log†evel).");

780  
	`lua_”rÜ
(
lua
);

782 
Ëv–
 = 
	`lua_tÚumb”
(
lua
,-
¬gc
);

783 ià(
Ëv–
 < 
LL_DEBUG
 ||†ev– > 
LL_WARNING
) {

784 
	`lua_push¡ršg
(
lua
, "Invalid debug†evel.");

785  
	`lua_”rÜ
(
lua
);

789 
log
 = 
	`sd£m±y
();

790 
j
 = 1; j < 
¬gc
; j++) {

791 
size_t
 
Ën
;

792 *
s
;

794 
s
 = (*)
	`lua_tŞ¡ršg
(
lua
,(-
¬gc
)+
j
,&
Ën
);

795 ià(
s
) {

796 ià(
j
 !ğ1è
log
 = 
	`sdsÿ’
(log," ",1);

797 
log
 = 
	`sdsÿ’
Öog,
s
,
Ën
);

800 
	`£rv”LogRaw
(
Ëv–
,
log
);

801 
	`sdsä“
(
log
);

803 
	}
}

809 
	$luaLßdLib
(
lua_S‹
 *
lua
, cÚ¡ *
libÇme
, 
lua_CFunùiÚ
 
luafunc
) {

810 
	`lua_pushcfunùiÚ
(
lua
, 
luafunc
);

811 
	`lua_push¡ršg
(
lua
, 
libÇme
);

812 
	`lua_ÿÎ
(
lua
, 1, 0);

813 
	}
}

815 
LUALIB_API
 (
luaİ’_cjsÚ
è(
lua_S‹
 *
L
);

816 
LUALIB_API
 (
luaİ’_¡ruù
è(
lua_S‹
 *
L
);

817 
LUALIB_API
 (
luaİ’_cmsg·ck
è(
lua_S‹
 *
L
);

818 
LUALIB_API
 (
luaİ’_b™
è(
lua_S‹
 *
L
);

820 
	$luaLßdLib¿r›s
(
lua_S‹
 *
lua
) {

821 
	`luaLßdLib
(
lua
, "", 
luaİ’_ba£
);

822 
	`luaLßdLib
(
lua
, 
LUA_TABLIBNAME
, 
luaİ’_bË
);

823 
	`luaLßdLib
(
lua
, 
LUA_STRLIBNAME
, 
luaİ’_¡ršg
);

824 
	`luaLßdLib
(
lua
, 
LUA_MATHLIBNAME
, 
luaİ’_m©h
);

825 
	`luaLßdLib
(
lua
, 
LUA_DBLIBNAME
, 
luaİ’_debug
);

826 
	`luaLßdLib
(
lua
, "cjsÚ", 
luaİ’_cjsÚ
);

827 
	`luaLßdLib
(
lua
, "¡ruù", 
luaİ’_¡ruù
);

828 
	`luaLßdLib
(
lua
, "cmsg·ck", 
luaİ’_cmsg·ck
);

829 
	`luaLßdLib
(
lua
, "b™", 
luaİ’_b™
);

832 
	`luaLßdLib
(
lua
, 
LUA_LOADLIBNAME
, 
luaİ’_·ckage
);

833 
	`luaLßdLib
(
lua
, 
LUA_OSLIBNAME
, 
luaİ’_os
);

835 
	}
}

839 
	$luaRemoveUnsuµÜ‹dFunùiÚs
(
lua_S‹
 *
lua
) {

840 
	`lua_pushn
(
lua
);

841 
	`lua_£tglob®
(
lua
,"loadfile");

842 
	`lua_pushn
(
lua
);

843 
	`lua_£tglob®
(
lua
,"dofile");

844 
	}
}

851 
	$sütšgEÇbËGlob®sPrÙeùiÚ
(
lua_S‹
 *
lua
) {

852 *
s
[32];

853 
sds
 
code
 = 
	`sd£m±y
();

854 
j
 = 0;

858 
s
[
j
++]="local dbg=debug\n";

859 
s
[
j
++]="local mt = {}\n";

860 
s
[
j
++]="setmetatable(_G, mt)\n";

861 
s
[
j
++]="mt.__newindex = function (t,‚, v)\n";

862 
s
[
j
++]=" if dbg.getinfo(2)hen\n";

863 
s
[
j
++]="†ocal w = dbg.getinfo(2, \"S\").what\n";

864 
s
[
j
++]=" if w ~= \"main\"‡nd w ~= \"C\"hen\n";

865 
s
[
j
++]="ƒrror(\"Script‡ttemptedo create global variable '\"..tostring(n)..\"'\", 2)\n";

866 
s
[
j
++]="ƒnd\n";

867 
s
[
j
++]="ƒnd\n";

868 
s
[
j
++]="„awset(t,‚, v)\n";

869 
s
[
j
++]="end\n";

870 
s
[
j
++]="mt.__index = function (t,‚)\n";

871 
s
[
j
++]=" if dbg.getinfo(2)‡nd dbg.getinfo(2, \"S\").what ~= \"C\"hen\n";

872 
s
[
j
++]="ƒrror(\"Script‡ttemptedo‡ccess unexisting global variable '\"..tostring(n)..\"'\", 2)\n";

873 
s
[
j
++]="ƒnd\n";

874 
s
[
j
++]="„eturn„awget(t,‚)\n";

875 
s
[
j
++]="end\n";

876 
s
[
j
++]="debug =‚il\n";

877 
s
[
j
++]=
NULL
;

879 
j
 = 0; 
s
[j] !ğ
NULL
; j++è
code
 = 
	`sdsÿ’
(code,s[j],
	`¡¾’
(s[j]));

880 
	`luaL_lßdbufãr
(
lua
,
code
,
	`sd¦’
(code),"@enable_strict_lua");

881 
	`lua_pÿÎ
(
lua
,0,0,0);

882 
	`sdsä“
(
code
);

883 
	}
}

895 
	$sütšgIn™
(
£tup
) {

896 
lua_S‹
 *
lua
 = 
	`lua_İ’
();

898 ià(
£tup
) {

899 
£rv”
.
lua_ş›Á
 = 
NULL
;

900 
£rv”
.
lua_ÿÎ”
 = 
NULL
;

901 
£rv”
.
lua_timedout
 = 0;

902 
£rv”
.
lua_®ways_»¶iÿ‹_commªds
 = 0;

903 
£rv”
.
lua_time_lim™
 = 
LUA_SCRIPT_TIME_LIMIT
;

904 
	`ldbIn™
();

907 
	`luaLßdLib¿r›s
(
lua
);

908 
	`luaRemoveUnsuµÜ‹dFunùiÚs
(
lua
);

913 
£rv”
.
lua_süts
 = 
	`diùC»©e
(&
shaSütObjeùDiùTy³
,
NULL
);

916 
	`lua_ÃwbË
(
lua
);

919 
	`lua_push¡ršg
(
lua
,"call");

920 
	`lua_pushcfunùiÚ
(
lua
,
luaRedisC®lCommªd
);

921 
	`lua_£‰abË
(
lua
,-3);

924 
	`lua_push¡ršg
(
lua
,"pcall");

925 
	`lua_pushcfunùiÚ
(
lua
,
luaRedisPC®lCommªd
);

926 
	`lua_£‰abË
(
lua
,-3);

929 
	`lua_push¡ršg
(
lua
,"log");

930 
	`lua_pushcfunùiÚ
(
lua
,
luaLogCommªd
);

931 
	`lua_£‰abË
(
lua
,-3);

933 
	`lua_push¡ršg
(
lua
,"LOG_DEBUG");

934 
	`lua_pushnumb”
(
lua
,
LL_DEBUG
);

935 
	`lua_£‰abË
(
lua
,-3);

937 
	`lua_push¡ršg
(
lua
,"LOG_VERBOSE");

938 
	`lua_pushnumb”
(
lua
,
LL_VERBOSE
);

939 
	`lua_£‰abË
(
lua
,-3);

941 
	`lua_push¡ršg
(
lua
,"LOG_NOTICE");

942 
	`lua_pushnumb”
(
lua
,
LL_NOTICE
);

943 
	`lua_£‰abË
(
lua
,-3);

945 
	`lua_push¡ršg
(
lua
,"LOG_WARNING");

946 
	`lua_pushnumb”
(
lua
,
LL_WARNING
);

947 
	`lua_£‰abË
(
lua
,-3);

950 
	`lua_push¡ršg
(
lua
, "sha1hex");

951 
	`lua_pushcfunùiÚ
(
lua
, 
luaRedisSha1hexCommªd
);

952 
	`lua_£‰abË
(
lua
, -3);

955 
	`lua_push¡ršg
(
lua
, "error_reply");

956 
	`lua_pushcfunùiÚ
(
lua
, 
luaRedisE¼ÜR•lyCommªd
);

957 
	`lua_£‰abË
(
lua
, -3);

958 
	`lua_push¡ršg
(
lua
, "status_reply");

959 
	`lua_pushcfunùiÚ
(
lua
, 
luaRedisStusR•lyCommªd
);

960 
	`lua_£‰abË
(
lua
, -3);

963 
	`lua_push¡ršg
(
lua
, "replicate_commands");

964 
	`lua_pushcfunùiÚ
(
lua
, 
luaRedisR•liÿ‹CommªdsCommªd
);

965 
	`lua_£‰abË
(
lua
, -3);

968 
	`lua_push¡ršg
(
lua
,"set_repl");

969 
	`lua_pushcfunùiÚ
(
lua
,
luaRedisS‘R•lCommªd
);

970 
	`lua_£‰abË
(
lua
,-3);

972 
	`lua_push¡ršg
(
lua
,"REPL_NONE");

973 
	`lua_pushnumb”
(
lua
,
PROPAGATE_NONE
);

974 
	`lua_£‰abË
(
lua
,-3);

976 
	`lua_push¡ršg
(
lua
,"REPL_AOF");

977 
	`lua_pushnumb”
(
lua
,
PROPAGATE_AOF
);

978 
	`lua_£‰abË
(
lua
,-3);

980 
	`lua_push¡ršg
(
lua
,"REPL_SLAVE");

981 
	`lua_pushnumb”
(
lua
,
PROPAGATE_REPL
);

982 
	`lua_£‰abË
(
lua
,-3);

984 
	`lua_push¡ršg
(
lua
,"REPL_ALL");

985 
	`lua_pushnumb”
(
lua
,
PROPAGATE_AOF
|
PROPAGATE_REPL
);

986 
	`lua_£‰abË
(
lua
,-3);

989 
	`lua_push¡ršg
(
lua
,"breakpoint");

990 
	`lua_pushcfunùiÚ
(
lua
,
luaRedisB»akpoštCommªd
);

991 
	`lua_£‰abË
(
lua
,-3);

994 
	`lua_push¡ršg
(
lua
,"debug");

995 
	`lua_pushcfunùiÚ
(
lua
,
luaRedisDebugCommªd
);

996 
	`lua_£‰abË
(
lua
,-3);

999 
	`lua_£tglob®
(
lua
,"redis");

1002 
	`lua_g‘glob®
(
lua
,"math");

1004 
	`lua_push¡ršg
(
lua
,"random");

1005 
	`lua_pushcfunùiÚ
(
lua
,
»dis_m©h_¿ndom
);

1006 
	`lua_£‰abË
(
lua
,-3);

1008 
	`lua_push¡ršg
(
lua
,"randomseed");

1009 
	`lua_pushcfunùiÚ
(
lua
,
»dis_m©h_¿ndom£ed
);

1010 
	`lua_£‰abË
(
lua
,-3);

1012 
	`lua_£tglob®
(
lua
,"math");

1017 *
com·»_func
 = "function __redis__compare_helper(a,b)\n"

1022 
	`luaL_lßdbufãr
(
lua
,
com·»_func
,
	`¡¾’
(compare_func),"@cmp_func_def");

1023 
	`lua_pÿÎ
(
lua
,0,0,0);

1031 *
”rh_func
 = "local dbg = debug\n"

1043 
	`luaL_lßdbufãr
(
lua
,
”rh_func
,
	`¡¾’
(errh_func),"@err_handler_def");

1044 
	`lua_pÿÎ
(
lua
,0,0,0);

1051 ià(
£rv”
.
lua_ş›Á
 =ğ
NULL
) {

1052 
£rv”
.
lua_ş›Á
 = 
	`ü—‹Cl›Á
(-1);

1053 
£rv”
.
lua_ş›Á
->
æags
 |ğ
CLIENT_LUA
;

1059 
	`sütšgEÇbËGlob®sPrÙeùiÚ
(
lua
);

1061 
£rv”
.
lua
 =†ua;

1062 
	}
}

1066 
	$sütšgR–—£
() {

1067 
	`diùR–—£
(
£rv”
.
lua_süts
);

1068 
	`lua_şo£
(
£rv”
.
lua
);

1069 
	}
}

1071 
	$sütšgRe£t
() {

1072 
	`sütšgR–—£
();

1073 
	`sütšgIn™
(0);

1074 
	}
}

1078 
	$luaS‘Glob®A¼ay
(
lua_S‹
 *
lua
, *
v¬
, 
robj
 **
–ev
, 
–ec
) {

1079 
j
;

1081 
	`lua_ÃwbË
(
lua
);

1082 
j
 = 0; j < 
–ec
; j++) {

1083 
	`lua_pushl¡ršg
(
lua
,(*)
–ev
[
j
]->
±r
,
	`sd¦’
(elev[j]->ptr));

1084 
	`lua_¿w£ti
(
lua
,-2,
j
+1);

1086 
	`lua_£tglob®
(
lua
,
v¬
);

1087 
	}
}

1099 
	$»dis_m©h_¿ndom
 (
lua_S‹
 *
L
) {

1102 
lua_Numb”
 
r
 = (lua_Numb”)(
	`»disL¿nd48
()%
REDIS_LRAND48_MAX
) /

1103 (
lua_Numb”
)
REDIS_LRAND48_MAX
;

1104 
	`lua_g‘tİ
(
L
)) {

1106 
	`lua_pushnumb”
(
L
, 
r
);

1110 
u
 = 
	`luaL_checkšt
(
L
, 1);

1111 
	`luaL_¬gcheck
(
L
, 1<=
u
, 1, "interval isƒmpty");

1112 
	`lua_pushnumb”
(
L
, 
	`æoÜ
(
r
*
u
)+1);

1116 
l
 = 
	`luaL_checkšt
(
L
, 1);

1117 
u
 = 
	`luaL_checkšt
(
L
, 2);

1118 
	`luaL_¬gcheck
(
L
, 
l
<=
u
, 2, "interval isƒmpty");

1119 
	`lua_pushnumb”
(
L
, 
	`æoÜ
(
r
*(
u
-
l
+1))+l);

1122 :  
	`luaL_”rÜ
(
L
, "wrong‚umber of‡rguments");

1125 
	}
}

1127 
	$»dis_m©h_¿ndom£ed
 (
lua_S‹
 *
L
) {

1128 
	`»disS¿nd48
(
	`luaL_checkšt
(
L
, 1));

1130 
	}
}

1145 
	$luaC»©eFunùiÚ
(
ş›Á
 *
c
, 
lua_S‹
 *
lua
, *
funúame
, 
robj
 *
body
) {

1146 
sds
 
funcdef
 = 
	`sd£m±y
();

1148 
funcdef
 = 
	`sdsÿt
(funcdef,"function ");

1149 
funcdef
 = 
	`sdsÿ’
(funcdef,
funúame
,42);

1150 
funcdef
 = 
	`sdsÿ’
(funcdef,"() ",3);

1151 
funcdef
 = 
	`sdsÿ’
(funcdef,
body
->
±r
,
	`sd¦’
(body->ptr));

1152 
funcdef
 = 
	`sdsÿ’
(funcdef,"\nend",4);

1154 ià(
	`luaL_lßdbufãr
(
lua
,
funcdef
,
	`sd¦’
(funcdef),"@user_script")) {

1155 
	`addR•lyE¼ÜFÜm©
(
c
,"Error compiling script (new function): %s\n",

1156 
	`lua_to¡ršg
(
lua
,-1));

1157 
	`lua_pİ
(
lua
,1);

1158 
	`sdsä“
(
funcdef
);

1159  
C_ERR
;

1161 
	`sdsä“
(
funcdef
);

1162 ià(
	`lua_pÿÎ
(
lua
,0,0,0)) {

1163 
	`addR•lyE¼ÜFÜm©
(
c
,"Error„unning script (new function): %s\n",

1164 
	`lua_to¡ršg
(
lua
,-1));

1165 
	`lua_pİ
(
lua
,1);

1166  
C_ERR
;

1173 
»tv®
 = 
	`diùAdd
(
£rv”
.
lua_süts
,

1174 
	`sd¢ewËn
(
funúame
+2,40),
body
);

1175 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
»tv®
 =ğ
DICT_OK
);

1176 
	`šüRefCouÁ
(
body
);

1178  
C_OK
;

1179 
	}
}

1182 
	$luaMaskCouÁHook
(
lua_S‹
 *
lua
, 
lua_Debug
 *
¬
) {

1183 
–­£d
;

1184 
	`UNUSED
(
¬
);

1185 
	`UNUSED
(
lua
);

1187 
–­£d
 = 
	`m¡ime
(è- 
£rv”
.
lua_time_¡¬t
;

1188 ià(
–­£d
 >ğ
£rv”
.
lua_time_lim™
 && s”v”.
lua_timedout
 == 0) {

1189 
	`£rv”Log
(
LL_WARNING
,"Lu¨¦ow süˆd‘eùed: stÈšƒxecutiÚ‡á” %Îd mli£cÚds. You cªry klšghsüˆusšghSCRIPT KILL commªd.",
–­£d
);

1190 
£rv”
.
lua_timedout
 = 1;

1196 
	`«D–‘eFeEv’t
(
£rv”
.
–
, s”v”.
lua_ÿÎ”
->
fd
, 
AE_READABLE
);

1198 ià(
£rv”
.
lua_timedout
è
	`´oûssEv’tsWheBlocked
();

1199 ià(
£rv”
.
lua_kl
) {

1200 
	`£rv”Log
(
LL_WARNING
,"Lua script killed by user with SCRIPT KILL.");

1201 
	`lua_push¡ršg
(
lua
,"Script killed by user with SCRIPT KILL...");

1202 
	`lua_”rÜ
(
lua
);

1204 
	}
}

1206 
	$ev®G’”icCommªd
(
ş›Á
 *
c
, 
ev®sha
) {

1207 
lua_S‹
 *
lua
 = 
£rv”
.lua;

1208 
funúame
[43];

1209 
numkeys
;

1210 
d–hook
 = 0, 
”r
;

1214 
	`»disS¿nd48
(0);

1224 
£rv”
.
lua_¿ndom_dœty
 = 0;

1225 
£rv”
.
lua_wr™e_dœty
 = 0;

1226 
£rv”
.
lua_»¶iÿ‹_commªds
 = s”v”.
lua_®ways_»¶iÿ‹_commªds
;

1227 
£rv”
.
lua_muÉi_em™‹d
 = 0;

1228 
£rv”
.
lua_»¶
 = 
PROPAGATE_AOF
|
PROPAGATE_REPL
;

1231 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
numkeys
,
NULL
è!ğ
C_OK
)

1233 ià(
numkeys
 > (
c
->
¬gc
 - 3)) {

1234 
	`addR•lyE¼Ü
(
c
,"Number of keys can't be greaterhan‚umber of‡rgs");

1236 } ià(
numkeys
 < 0) {

1237 
	`addR•lyE¼Ü
(
c
,"Number of keys can't be‚egative");

1243 
funúame
[0] = 'f';

1244 
funúame
[1] = '_';

1245 ià(!
ev®sha
) {

1247 
	`sha1hex
(
funúame
+2,
c
->
¬gv
[1]->
±r
,
	`sd¦’
(c->argv[1]->ptr));

1250 
j
;

1251 *
sha
 = 
c
->
¬gv
[1]->
±r
;

1256 
j
 = 0; j < 40; j++)

1257 
funúame
[
j
+2] = (
sha
[j] >= 'A' && sha[j] <= 'Z') ?

1258 
sha
[
j
]+('a'-'A') : sha[j];

1259 
funúame
[42] = '\0';

1263 
	`lua_g‘glob®
(
lua
, "__redis__err__handler");

1266 
	`lua_g‘glob®
(
lua
, 
funúame
);

1267 ià(
	`lua_i¢
(
lua
,-1)) {

1268 
	`lua_pİ
(
lua
,1);

1272 ià(
ev®sha
) {

1273 
	`lua_pİ
(
lua
,1);

1274 
	`addR•ly
(
c
, 
sh¬ed
.
nosü‹¼
);

1277 ià(
	`luaC»©eFunùiÚ
(
c
,
lua
,
funúame
,c->
¬gv
[1]è=ğ
C_ERR
) {

1278 
	`lua_pİ
(
lua
,1);

1284 
	`lua_g‘glob®
(
lua
, 
funúame
);

1285 
	`£rv”As£¹
(!
	`lua_i¢
(
lua
,-1));

1290 
	`luaS‘Glob®A¼ay
(
lua
,"KEYS",
c
->
¬gv
+3,
numkeys
);

1291 
	`luaS‘Glob®A¼ay
(
lua
,"ARGV",
c
->
¬gv
+3+
numkeys
,c->
¬gc
-3-numkeys);

1294 
	`£ËùDb
(
£rv”
.
lua_ş›Á
,
c
->
db
->
id
);

1303 
£rv”
.
lua_ÿÎ”
 = 
c
;

1304 
£rv”
.
lua_time_¡¬t
 = 
	`m¡ime
();

1305 
£rv”
.
lua_kl
 = 0;

1306 ià(
£rv”
.
lua_time_lim™
 > 0 && s”v”.
ma¡”ho¡
 =ğ
NULL
 &&

1307 
ldb
.
aùive
 == 0)

1309 
	`lua_£thook
(
lua
,
luaMaskCouÁHook
,
LUA_MASKCOUNT
,100000);

1310 
d–hook
 = 1;

1311 } ià(
ldb
.
aùive
) {

1312 
	`lua_£thook
(
£rv”
.
lua
,
luaLdbLšeHook
,
LUA_MASKLINE
|
LUA_MASKCOUNT
,100000);

1313 
d–hook
 = 1;

1319 
”r
 = 
	`lua_pÿÎ
(
lua
,0,1,-2);

1322 ià(
d–hook
è
	`lua_£thook
(
lua
,
NULL
,0,0);

1323 ià(
£rv”
.
lua_timedout
) {

1324 
£rv”
.
lua_timedout
 = 0;

1327 
	`«C»©eFeEv’t
(
£rv”
.
–
,
c
->
fd
,
AE_READABLE
,

1328 
»adQu”yFromCl›Á
,
c
);

1330 
£rv”
.
lua_ÿÎ”
 = 
NULL
;

1338 
	#LUA_GC_CYCLE_PERIOD
 50

	)

1340 
gc_couÁ
 = 0;

1342 
gc_couÁ
++;

1343 ià(
gc_couÁ
 =ğ
LUA_GC_CYCLE_PERIOD
) {

1344 
	`lua_gc
(
lua
,
LUA_GCSTEP
,
LUA_GC_CYCLE_PERIOD
);

1345 
gc_couÁ
 = 0;

1349 ià(
”r
) {

1350 
	`addR•lyE¼ÜFÜm©
(
c
,"Error„unning script (callo %s): %s\n",

1351 
funúame
, 
	`lua_to¡ršg
(
lua
,-1));

1352 
	`lua_pİ
(
lua
,2);

1356 
	`luaR•lyToRedisR•ly
(
c
,
lua
);

1357 
	`lua_pİ
(
lua
,1);

1362 ià(
£rv”
.
lua_»¶iÿ‹_commªds
) {

1363 
	`´ev’tCommªdPrİag©iÚ
(
c
);

1364 ià(
£rv”
.
lua_muÉi_em™‹d
) {

1365 
robj
 *
´İ¬gv
[1];

1366 
´İ¬gv
[0] = 
	`ü—‹SŒšgObjeù
("EXEC",4);

1367 
	`®soPrİag©e
(
£rv”
.
execCommªd
,
c
->
db
->
id
,
´İ¬gv
,1,

1368 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

1369 
	`deüRefCouÁ
(
´İ¬gv
[0]);

1383 ià(
ev®sha
 && !
£rv”
.
lua_»¶iÿ‹_commªds
) {

1384 ià(!
	`»¶iÿtiÚSütCacheExi¡s
(
c
->
¬gv
[1]->
±r
)) {

1388 
robj
 *
süt
 = 
	`diùF‘chV®ue
(
£rv”
.
lua_süts
,
c
->
¬gv
[1]->
±r
);

1390 
	`»¶iÿtiÚSütCacheAdd
(
c
->
¬gv
[1]->
±r
);

1391 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
süt
 != NULL);

1392 
	`»wr™eCl›ÁCommªdArgum’t
(
c
,0,

1393 
	`»£tRefCouÁ
(
	`ü—‹SŒšgObjeù
("EVAL",4)));

1394 
	`»wr™eCl›ÁCommªdArgum’t
(
c
,1,
süt
);

1395 
	`fÜûCommªdPrİag©iÚ
(
c
,
PROPAGATE_REPL
|
PROPAGATE_AOF
);

1398 
	}
}

1400 
	$ev®Commªd
(
ş›Á
 *
c
) {

1401 ià(!(
c
->
æags
 & 
CLIENT_LUA_DEBUG
))

1402 
	`ev®G’”icCommªd
(
c
,0);

1404 
	`ev®G’”icCommªdW™hDebuggšg
(
c
,0);

1405 
	}
}

1407 
	$ev®ShaCommªd
(
ş›Á
 *
c
) {

1408 ià(
	`sd¦’
(
c
->
¬gv
[1]->
±r
) != 40) {

1413 
	`addR•ly
(
c
, 
sh¬ed
.
nosü‹¼
);

1416 ià(!(
c
->
æags
 & 
CLIENT_LUA_DEBUG
))

1417 
	`ev®G’”icCommªd
(
c
,1);

1419 
	`addR•lyE¼Ü
(
c
,"Please use EVAL instead of EVALSHA for debugging");

1422 
	}
}

1424 
	$sütCommªd
(
ş›Á
 *
c
) {

1425 ià(
c
->
¬gc
 =ğ2 && !
	`¡rÿ£cmp
(c->
¬gv
[1]->
±r
,"flush")) {

1426 
	`sütšgRe£t
();

1427 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1428 
	`»¶iÿtiÚSütCacheFlush
();

1429 
£rv”
.
dœty
++;

1430 } ià(
c
->
¬gc
 >ğ2 && !
	`¡rÿ£cmp
(c->
¬gv
[1]->
±r
,"exists")) {

1431 
j
;

1433 
	`addR•lyMuÉiBulkL’
(
c
, c->
¬gc
-2);

1434 
j
 = 2; j < 
c
->
¬gc
; j++) {

1435 ià(
	`diùFšd
(
£rv”
.
lua_süts
,
c
->
¬gv
[
j
]->
±r
))

1436 
	`addR•ly
(
c
,
sh¬ed
.
cÚe
);

1438 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

1440 } ià(
c
->
¬gc
 =ğ3 && !
	`¡rÿ£cmp
(c->
¬gv
[1]->
±r
,"load")) {

1441 
funúame
[43];

1442 
sds
 
sha
;

1444 
funúame
[0] = 'f';

1445 
funúame
[1] = '_';

1446 
	`sha1hex
(
funúame
+2,
c
->
¬gv
[2]->
±r
,
	`sd¦’
(c->argv[2]->ptr));

1447 
sha
 = 
	`sd¢ewËn
(
funúame
+2,40);

1448 ià(
	`diùFšd
(
£rv”
.
lua_süts
,
sha
è=ğ
NULL
) {

1449 ià(
	`luaC»©eFunùiÚ
(
c
,
£rv”
.
lua
,
funúame
,c->
¬gv
[2])

1450 =ğ
C_ERR
) {

1451 
	`sdsä“
(
sha
);

1455 
	`addR•lyBulkCBufãr
(
c
,
funúame
+2,40);

1456 
	`sdsä“
(
sha
);

1457 
	`fÜûCommªdPrİag©iÚ
(
c
,
PROPAGATE_REPL
|
PROPAGATE_AOF
);

1458 } ià(
c
->
¬gc
 =ğ2 && !
	`¡rÿ£cmp
(c->
¬gv
[1]->
±r
,"kill")) {

1459 ià(
£rv”
.
lua_ÿÎ”
 =ğ
NULL
) {

1460 
	`addR•lySds
(
c
,
	`sd¢ew
("-NOTBUSY No scripts inƒxecution„ight‚ow.\r\n"));

1461 } ià(
£rv”
.
lua_wr™e_dœty
) {

1462 
	`addR•lySds
(
c
,
	`sd¢ew
("-UNKILLABLE Sorryhe script‡lreadyƒxecuted write commands‡gainsthe dataset. You canƒither waithe scriptermination or killhe server in‡ hard way usinghe SHUTDOWN NOSAVE command.\r\n"));

1464 
£rv”
.
lua_kl
 = 1;

1465 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1467 } ià(
c
->
¬gc
 =ğ3 && !
	`¡rÿ£cmp
(c->
¬gv
[1]->
±r
,"debug")) {

1468 ià(
	`ş›ÁHasP’dšgR•l›s
(
c
)) {

1469 
	`addR•lyE¼Ü
(
c
,"SCRIPT DEBUG must be called outside‡…ipeline");

1472 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"no")) {

1473 
	`ldbDi§bË
(
c
);

1474 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1475 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"yes")) {

1476 
	`ldbEÇbË
(
c
);

1477 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1478 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"sync")) {

1479 
	`ldbEÇbË
(
c
);

1480 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

1481 
c
->
æags
 |ğ
CLIENT_LUA_DEBUG_SYNC
;

1483 
	`addR•lyE¼Ü
(
c
,"Use SCRIPT DEBUG yes/sync/no");

1486 
	`addR•lyE¼Ü
(
c
, "Unknown SCRIPT subcommand or wrong # of‡rgs.");

1488 
	}
}

1495 
	$ldbIn™
() {

1496 
ldb
.
fd
 = -1;

1497 
ldb
.
aùive
 = 0;

1498 
ldb
.
logs
 = 
	`li¡C»©e
();

1499 
	`li¡S‘F»eM‘hod
(
ldb
.
logs
,((*)(*))
sdsä“
);

1500 
ldb
.
chd»n
 = 
	`li¡C»©e
();

1501 
ldb
.
¤c
 = 
NULL
;

1502 
ldb
.
lšes
 = 0;

1503 
ldb
.
cbuf
 = 
	`sd£m±y
();

1504 
	}
}

1507 
	$ldbFlushLog
(
li¡
 *
log
) {

1508 
li¡Node
 *
Ê
;

1510 (
Ê
 = 
	`li¡Fœ¡
(
log
)è!ğ
NULL
)

1511 
	`li¡D–Node
(
log
,
Ê
);

1512 
	}
}

1515 
	$ldbEÇbË
(
ş›Á
 *
c
) {

1516 
c
->
æags
 |ğ
CLIENT_LUA_DEBUG
;

1517 
	`ldbFlushLog
(
ldb
.
logs
);

1518 
ldb
.
fd
 = 
c
->fd;

1519 
ldb
.
¡•
 = 1;

1520 
ldb
.
bpcouÁ
 = 0;

1521 
ldb
.
luabp
 = 0;

1522 
	`sdsä“
(
ldb
.
cbuf
);

1523 
ldb
.
cbuf
 = 
	`sd£m±y
();

1524 
ldb
.
maxËn
 = 
LDB_MAX_LEN_DEFAULT
;

1525 
ldb
.
maxËn_hšt_£Á
 = 0;

1526 
	}
}

1531 
	$ldbDi§bË
(
ş›Á
 *
c
) {

1532 
c
->
æags
 &ğ~(
CLIENT_LUA_DEBUG
|
CLIENT_LUA_DEBUG_SYNC
);

1533 
	}
}

1536 
	$ldbLog
(
sds
 
’Œy
) {

1537 
	`li¡AddNodeTa
(
ldb
.
logs
,
’Œy
);

1538 
	}
}

1544 
	$ldbLogW™hMaxL’
(
sds
 
’Œy
) {

1545 
Œimmed
 = 0;

1546 ià(
ldb
.
maxËn
 && 
	`sd¦’
(
’Œy
) >†db.maxlen) {

1547 
	`sd¤ªge
(
’Œy
,0,
ldb
.
maxËn
-1);

1548 
’Œy
 = 
	`sdsÿ’
(entry," ...",4);

1549 
Œimmed
 = 1;

1551 
	`ldbLog
(
’Œy
);

1552 ià(
Œimmed
 && 
ldb
.
maxËn_hšt_£Á
 == 0) {

1553 
ldb
.
maxËn_hšt_£Á
 = 1;

1554 
	`ldbLog
(
	`sd¢ew
(

1557 
	}
}

1562 
	$ldbS’dLogs
() {

1563 
sds
 
´Ùo
 = 
	`sd£m±y
();

1564 
´Ùo
 = 
	`sdsÿtfmt
ÕrÙo,"*%i\r\n", ()
	`li¡L’gth
(
ldb
.
logs
));

1565 
	`li¡L’gth
(
ldb
.
logs
)) {

1566 
li¡Node
 *
Ê
 = 
	`li¡Fœ¡
(
ldb
.
logs
);

1567 
´Ùo
 = 
	`sdsÿ’
(proto,"+",1);

1568 
	`sdsm­ch¬s
(
Ê
->
v®ue
,"\r\n"," ",2);

1569 
´Ùo
 = 
	`sdsÿtsds
ÕrÙo,
Ê
->
v®ue
);

1570 
´Ùo
 = 
	`sdsÿ’
(proto,"\r\n",2);

1571 
	`li¡D–Node
(
ldb
.
logs
,
Ê
);

1573 ià(
	`wr™e
(
ldb
.
fd
,
´Ùo
,
	`sd¦’
(proto)) == -1) {

1578 
	`sdsä“
(
´Ùo
);

1579 
	}
}

1593 
	$ldbS¹SessiÚ
(
ş›Á
 *
c
) {

1594 
ldb
.
fÜked
 = (
c
->
æags
 & 
CLIENT_LUA_DEBUG_SYNC
) == 0;

1595 ià(
ldb
.
fÜked
) {

1596 
pid_t
 
ı
 = 
	`fÜk
();

1597 ià(
ı
 == -1) {

1598 
	`addR•lyE¼Ü
(
c
,"Fork() failed: can't„un EVAL in debugging mode.");

1600 } ià(
ı
 == 0) {

1602 
sigaùiÚ
 
aù
;

1603 
	`sigem±y£t
(&
aù
.
§_mask
);

1604 
aù
.
§_æags
 = 0;

1605 
aù
.
§_hªdËr
 = 
SIG_IGN
;

1606 
	`sigaùiÚ
(
SIGTERM
, &
aù
, 
NULL
);

1607 
	`sigaùiÚ
(
SIGINT
, &
aù
, 
NULL
);

1612 
	`£rv”Log
(
LL_WARNING
,"Redis forked for debuggingƒval");

1613 
	`şo£Li¡’šgSock‘s
(0);

1616 
	`li¡AddNodeTa
(
ldb
.
chd»n
,(*)()
ı
);

1617 
	`ä“Cl›ÁAsync
(
c
);

1621 
	`£rv”Log
(
LL_WARNING
,

1626 
	`ª‘Block
(
NULL
,
ldb
.
fd
);

1627 
	`ª‘S’dTimeout
(
NULL
,
ldb
.
fd
,5000);

1628 
ldb
.
aùive
 = 1;

1632 
sds
 
¤c¡ršg
 = 
	`sdsdup
(
c
->
¬gv
[1]->
±r
);

1633 
size_t
 
¤ş’
 = 
	`sd¦’
(
¤c¡ršg
);

1634 
¤ş’
 && (
¤c¡ršg
[srclen-1] == '\n' ||

1635 
¤c¡ršg
[
¤ş’
-1] == '\r'))

1637 
¤c¡ršg
[--
¤ş’
] = '\0';

1639 
	`sds£’
(
¤c¡ršg
,
¤ş’
);

1640 
ldb
.
¤c
 = 
	`sds¥l™Ën
(
¤c¡ršg
,
	`sd¦’
(¤c¡ršg),"\n",1,&ldb.
lšes
);

1641 
	`sdsä“
(
¤c¡ršg
);

1643 
	}
}

1647 
	$ldbEndSessiÚ
(
ş›Á
 *
c
) {

1649 
	`ldbLog
(
	`sd¢ew
("<endsession>"));

1650 
	`ldbS’dLogs
();

1653 ià(
ldb
.
fÜked
) {

1654 
	`wr™eToCl›Á
(
c
->
fd
, c, 0);

1655 
	`£rv”Log
(
LL_WARNING
,"Lua debugging session childƒxiting");

1656 
	`ex™FromChd
(0);

1658 
	`£rv”Log
(
LL_WARNING
,

1663 
	`ª‘NÚBlock
(
NULL
,
ldb
.
fd
);

1664 
	`ª‘S’dTimeout
(
NULL
,
ldb
.
fd
,0);

1668 
c
->
æags
 |ğ
CLIENT_CLOSE_AFTER_REPLY
;

1671 
	`sdsä“¥l™»s
(
ldb
.
¤c
,ldb.
lšes
);

1672 
ldb
.
lšes
 = 0;

1673 
ldb
.
aùive
 = 0;

1674 
	}
}

1679 
	$ldbRemoveChd
(
pid_t
 
pid
) {

1680 
li¡Node
 *
Ê
 = 
	`li¡S—rchKey
(
ldb
.
chd»n
,(*)()
pid
);

1681 ià(
Ê
) {

1682 
	`li¡D–Node
(
ldb
.
chd»n
,
Ê
);

1686 
	}
}

1690 
	$ldbP’dšgChd»n
() {

1691  
	`li¡L’gth
(
ldb
.
chd»n
);

1692 
	}
}

1695 
	$ldbKlFÜkedSessiÚs
() {

1696 
li¡I‹r
 
li
;

1697 
li¡Node
 *
Ê
;

1699 
	`li¡Rewšd
(
ldb
.
chd»n
,&
li
);

1700 (
Ê
 = 
	`li¡Next
(&
li
))) {

1701 
pid_t
 
pid
 = (è
Ê
->
v®ue
;

1702 
	`£rv”Log
(
LL_WARNING
,"Klšg debuggšg sessiÚ %ld",()
pid
);

1703 
	`kl
(
pid
,
SIGKILL
);

1705 
	`li¡R–—£
(
ldb
.
chd»n
);

1706 
ldb
.
chd»n
 = 
	`li¡C»©e
();

1707 
	}
}

1711 
	$ev®G’”icCommªdW™hDebuggšg
(
ş›Á
 *
c
, 
ev®sha
) {

1712 ià(
	`ldbS¹SessiÚ
(
c
)) {

1713 
	`ev®G’”icCommªd
(
c
,
ev®sha
);

1714 
	`ldbEndSessiÚ
(
c
);

1716 
	`ldbDi§bË
(
c
);

1718 
	}
}

1722 *
	$ldbG‘SourûLše
(
lše
) {

1723 
idx
 = 
lše
-1;

1724 ià(
idx
 < 0 || idx >ğ
ldb
.
lšes
)  "<out of„ange source code†ine>";

1725  
ldb
.
¤c
[
idx
];

1726 
	}
}

1729 
	$ldbIsB»akpošt
(
lše
) {

1730 
j
;

1732 
j
 = 0; j < 
ldb
.
bpcouÁ
; j++)

1733 ià(
ldb
.
bp
[
j
] =ğ
lše
)  1;

1735 
	}
}

1740 
	$ldbAddB»akpošt
(
lše
) {

1741 ià(
lše
 <ğ0 ||†š> 
ldb
.
lšes
)  0;

1742 ià(!
	`ldbIsB»akpošt
(
lše
è&& 
ldb
.
bpcouÁ
 !ğ
LDB_BREAKPOINTS_MAX
) {

1743 
ldb
.
bp
[ldb.
bpcouÁ
++] = 
lše
;

1747 
	}
}

1751 
	$ldbD–B»akpošt
(
lše
) {

1752 
j
;

1754 
j
 = 0; j < 
ldb
.
bpcouÁ
; j++) {

1755 ià(
ldb
.
bp
[
j
] =ğ
lše
) {

1756 
ldb
.
bpcouÁ
--;

1757 
	`memmove
(
ldb
.
bp
+
j
,ldb.bp+j+1,ldb.
bpcouÁ
-j);

1762 
	}
}

1767 
sds
 *
	$ldbR•lP¬£Commªd
(*
¬gı
) {

1768 
sds
 *
¬gv
 = 
NULL
;

1769 
¬gc
 = 0;

1770 ià(
	`sd¦’
(
ldb
.
cbuf
è=ğ0è 
NULL
;

1774 
sds
 
cİy
 = 
	`sdsdup
(
ldb
.
cbuf
);

1775 *
p
 = 
cİy
;

1782 
p
 = 
	`¡rchr
Õ,'*'); ià(!pè
´ÙÛ¼
;

1783 *
¶’
 = 
p
+1;

1784 
p
 = 
	`¡r¡r
Õ,"\r\n"); ià(!pè
´ÙÛ¼
;

1785 *
p
 = '\0';… += 2;

1786 *
¬gı
 = 
	`©oi
(
¶’
);

1787 ià(*
¬gı
 <ğ0 || *¬gı > 1024è
´ÙÛ¼
;

1790 
¬gv
 = 
	`zm®loc
((
sds
)*(*
¬gı
));

1791 
¬gc
 = 0;

1792 
¬gc
 < *
¬gı
) {

1793 ià(*
p
 !ğ'$'è
´ÙÛ¼
;

1794 
¶’
 = 
p
+1;

1795 
p
 = 
	`¡r¡r
Õ,"\r\n"); ià(!pè
´ÙÛ¼
;

1796 *
p
 = '\0';… += 2;

1797 
¦’
 = 
	`©oi
(
¶’
);

1798 ià(
¦’
 <ğ0 || sËÀ> 1024è
´ÙÛ¼
;

1799 
¬gv
[
¬gc
++] = 
	`sd¢ewËn
(
p
,
¦’
);

1800 
p
 +ğ
¦’
;

1801 ià(
p
[0] !ğ'\r' ||…[1] !ğ'\n'è
´ÙÛ¼
;

1802 
p
 += 2;

1804 
	`sdsä“
(
cİy
);

1805  
¬gv
;

1807 
´ÙÛ¼
:

1808 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

1809 
	`sdsä“
(
cİy
);

1810  
NULL
;

1811 
	}
}

1814 
	$ldbLogSourûLše
(
Êum
) {

1815 *
lše
 = 
	`ldbG‘SourûLše
(
Êum
);

1816 *
´efix
;

1817 
bp
 = 
	`ldbIsB»akpošt
(
Êum
);

1818 
cu¼’t
 = 
ldb
.
cu¼’še
 =ğ
Êum
;

1820 ià(
cu¼’t
 && 
bp
)

1821 
´efix
 = "->#";

1822 ià(
cu¼’t
)

1823 
´efix
 = "-> ";

1824 ià(
bp
)

1825 
´efix
 = " #";

1827 
´efix
 = " ";

1828 
sds
 
thi¦še
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"%s%-3d %s", 
´efix
, 
Êum
, 
lše
);

1829 
	`ldbLog
(
thi¦še
);

1830 
	}
}

1837 
	$ldbLi¡
(
¬ound
, 
cÚ‹xt
) {

1838 
j
;

1840 
j
 = 1; j <ğ
ldb
.
lšes
; j++) {

1841 ià(
¬ound
 !ğ0 && 
	`abs
×round-
j
è> 
cÚ‹xt
) ;

1842 
	`ldbLogSourûLše
(
j
);

1844 
	}
}

1853 
	#LDB_MAX_VALUES_DEPTH
 (
LUA_MINSTACK
/2)

	)

1854 
sds
 
	$ldbC©SckV®ueRec
(
sds
 
s
, 
lua_S‹
 *
lua
, 
idx
, 
Ëv–
) {

1855 
t
 = 
	`lua_ty³
(
lua
,
idx
);

1857 ià(
Ëv–
++ =ğ
LDB_MAX_VALUES_DEPTH
)

1858  
	`sdsÿt
(
s
,"<max„ecursion†evel„eached! Nestedable?>");

1860 
t
) {

1861 
LUA_TSTRING
:

1863 
size_t
 
¡¾
;

1864 *
¡½
 = (*)
	`lua_tŞ¡ršg
(
lua
,
idx
,&
¡¾
);

1865 
s
 = 
	`sdsÿŒ•r
(s,
¡½
,
¡¾
);

1868 
LUA_TBOOLEAN
:

1869 
s
 = 
	`sdsÿt
(s,
	`lua_toboŞ—n
(
lua
,
idx
) ? "true" : "false");

1871 
LUA_TNUMBER
:

1872 
s
 = 
	`sdsÿrštf
(s,"%g",()
	`lua_tÚumb”
(
lua
,
idx
));

1874 
LUA_TNIL
:

1875 
s
 = 
	`sdsÿ’
(s,"nil",3);

1877 
LUA_TTABLE
:

1879 
ex³ùed_šdex
 = 1;

1880 
is_¬¿y
 = 1;

1884 
sds
 
»´1
 = 
	`sd£m±y
();

1885 
sds
 
»´2
 = 
	`sd£m±y
();

1886 
	`lua_pushn
(
lua
);

1887 
	`lua_Ãxt
(
lua
,
idx
-1)) {

1889 ià(
is_¬¿y
 &&

1890 (
	`lua_ty³
(
lua
,-2è!ğ
LUA_TNUMBER
 ||

1891 
	`lua_tÚumb”
(
lua
,-2è!ğ
ex³ùed_šdex
)è
is_¬¿y
 = 0;

1894 
»´1
 = 
	`ldbC©SckV®ueRec
Ô•r1,
lua
,-1,
Ëv–
);

1895 
»´1
 = 
	`sdsÿ’
(repr1,"; ",2);

1897 
»´2
 = 
	`sdsÿ’
(repr2,"[",1);

1898 
»´2
 = 
	`ldbC©SckV®ueRec
Ô•r2,
lua
,-2,
Ëv–
);

1899 
»´2
 = 
	`sdsÿ’
(repr2,"]=",2);

1900 
»´2
 = 
	`ldbC©SckV®ueRec
Ô•r2,
lua
,-1,
Ëv–
);

1901 
»´2
 = 
	`sdsÿ’
(repr2,"; ",2);

1902 
	`lua_pİ
(
lua
,1);

1903 
ex³ùed_šdex
++;

1906 ià(
	`sd¦’
(
»´1
)è
	`sd¤ªge
(repr1,0,-3);

1907 ià(
	`sd¦’
(
»´2
)è
	`sd¤ªge
(repr2,0,-3);

1909 
s
 = 
	`sdsÿ’
(s,"{",1);

1910 
s
 = 
	`sdsÿtsds
(s,
is_¬¿y
 ? 
»´1
 : 
»´2
);

1911 
s
 = 
	`sdsÿ’
(s,"}",1);

1912 
	`sdsä“
(
»´1
);

1913 
	`sdsä“
(
»´2
);

1916 
LUA_TFUNCTION
:

1917 
LUA_TUSERDATA
:

1918 
LUA_TTHREAD
:

1919 
LUA_TLIGHTUSERDATA
:

1921 cÚ¡ *
p
 = 
	`lua_tİoš‹r
(
lua
,
idx
);

1922 *
ty³Çme
 = "unknown";

1923 ià(
t
 =ğ
LUA_TFUNCTION
è
ty³Çme
 = "function";

1924 ià(
t
 =ğ
LUA_TUSERDATA
è
ty³Çme
 = "userdata";

1925 ià(
t
 =ğ
LUA_TTHREAD
è
ty³Çme
 = "thread";

1926 ià(
t
 =ğ
LUA_TLIGHTUSERDATA
è
ty³Çme
 = "light-userdata";

1927 
s
 = 
	`sdsÿrštf
(s,"\"%s@%p\"",
ty³Çme
,
p
);

1931 
s
 = 
	`sdsÿt
(s,"\"<unknown-lua-type>\"");

1934  
s
;

1935 
	}
}

1939 
sds
 
	$ldbC©SckV®ue
(
sds
 
s
, 
lua_S‹
 *
lua
, 
idx
) {

1940  
	`ldbC©SckV®ueRec
(
s
,
lua
,
idx
,0);

1941 
	}
}

1946 
	$ldbLogSckV®ue
(
lua_S‹
 *
lua
, *
´efix
) {

1947 
sds
 
s
 = 
	`sd¢ew
(
´efix
);

1948 
s
 = 
	`ldbC©SckV®ue
(s,
lua
,-1);

1949 
	`ldbLogW™hMaxL’
(
s
);

1950 
	}
}

1952 *
ldbRedisPrÙocŞToHumª_IÁ
(
sds
 *
o
, *
»¶y
);

1953 *
ldbRedisPrÙocŞToHumª_Bulk
(
sds
 *
o
, *
»¶y
);

1954 *
ldbRedisPrÙocŞToHumª_Stus
(
sds
 *
o
, *
»¶y
);

1955 *
ldbRedisPrÙocŞToHumª_MuÉiBulk
(
sds
 *
o
, *
»¶y
);

1962 *
	$ldbRedisPrÙocŞToHumª
(
sds
 *
o
, *
»¶y
) {

1963 *
p
 = 
»¶y
;

1964 *
p
) {

1965 ':': 
p
 = 
	`ldbRedisPrÙocŞToHumª_IÁ
(
o
,
»¶y
); ;

1966 '$': 
p
 = 
	`ldbRedisPrÙocŞToHumª_Bulk
(
o
,
»¶y
); ;

1967 '+': 
p
 = 
	`ldbRedisPrÙocŞToHumª_Stus
(
o
,
»¶y
); ;

1968 '-': 
p
 = 
	`ldbRedisPrÙocŞToHumª_Stus
(
o
,
»¶y
); ;

1969 '*': 
p
 = 
	`ldbRedisPrÙocŞToHumª_MuÉiBulk
(
o
,
»¶y
); ;

1971  
p
;

1972 
	}
}

1977 *
	$ldbRedisPrÙocŞToHumª_IÁ
(
sds
 *
o
, *
»¶y
) {

1978 *
p
 = 
	`¡rchr
(
»¶y
+1,'\r');

1979 *
o
 = 
	`sdsÿ’
(*o,
»¶y
+1,
p
-reply-1);

1980  
p
+2;

1981 
	}
}

1983 *
	$ldbRedisPrÙocŞToHumª_Bulk
(
sds
 *
o
, *
»¶y
) {

1984 *
p
 = 
	`¡rchr
(
»¶y
+1,'\r');

1985 
bulkËn
;

1987 
	`¡ršg2Î
(
»¶y
+1,
p
-»¶y-1,&
bulkËn
);

1988 ià(
bulkËn
 == -1) {

1989 *
o
 = 
	`sdsÿ’
(*o,"NULL",4);

1990  
p
+2;

1992 *
o
 = 
	`sdsÿŒ•r
(*o,
p
+2,
bulkËn
);

1993  
p
+2+
bulkËn
+2;

1995 
	}
}

1997 *
	$ldbRedisPrÙocŞToHumª_Stus
(
sds
 *
o
, *
»¶y
) {

1998 *
p
 = 
	`¡rchr
(
»¶y
+1,'\r');

2000 *
o
 = 
	`sdsÿŒ•r
(*o,
»¶y
,
p
-reply);

2001  
p
+2;

2002 
	}
}

2004 *
	$ldbRedisPrÙocŞToHumª_MuÉiBulk
(
sds
 *
o
, *
»¶y
) {

2005 *
p
 = 
	`¡rchr
(
»¶y
+1,'\r');

2006 
mbulkËn
;

2007 
j
 = 0;

2009 
	`¡ršg2Î
(
»¶y
+1,
p
-»¶y-1,&
mbulkËn
);

2010 
p
 += 2;

2011 ià(
mbulkËn
 == -1) {

2012 *
o
 = 
	`sdsÿ’
(*o,"NULL",4);

2013  
p
;

2015 *
o
 = 
	`sdsÿ’
(*o,"[",1);

2016 
j
 = 0; j < 
mbulkËn
; j++) {

2017 
p
 = 
	`ldbRedisPrÙocŞToHumª
(
o
,p);

2018 ià(
j
 !ğ
mbulkËn
-1è*
o
 = 
	`sdsÿ’
(*o,",",1);

2020 *
o
 = 
	`sdsÿ’
(*o,"]",1);

2021  
p
;

2022 
	}
}

2027 
	$ldbLogRedisR•ly
(*
»¶y
) {

2028 
sds
 
log
 = 
	`sd¢ew
("<reply> ");

2029 
	`ldbRedisPrÙocŞToHumª
(&
log
,
»¶y
);

2030 
	`ldbLogW™hMaxL’
(
log
);

2031 
	}
}

2036 
	$ldbPršt
(
lua_S‹
 *
lua
, *
v¬Çme
) {

2037 
lua_Debug
 
¬
;

2039 
l
 = 0;

2040 
	`lua_g‘¡ack
(
lua
,
l
,&
¬
) != 0) {

2041 
l
++;

2042 cÚ¡ *
Çme
;

2043 
i
 = 1;

2044 (
Çme
 = 
	`lua_g‘loÿl
(
lua
,&
¬
,
i
)è!ğ
NULL
) {

2045 
i
++;

2046 ià(
	`¡rcmp
(
v¬Çme
,
Çme
) == 0) {

2047 
	`ldbLogSckV®ue
(
lua
,"<value> ");

2048 
	`lua_pİ
(
lua
,1);

2051 
	`lua_pİ
(
lua
,1);

2057 ià(!
	`¡rcmp
(
v¬Çme
,"ARGV") || !strcmp(varname,"KEYS")) {

2058 
	`lua_g‘glob®
(
lua
, 
v¬Çme
);

2059 
	`ldbLogSckV®ue
(
lua
,"<value> ");

2060 
	`lua_pİ
(
lua
,1);

2062 
	`ldbLog
(
	`sd¢ew
("No such variable."));

2064 
	}
}

2068 
	$ldbPrštAÎ
(
lua_S‹
 *
lua
) {

2069 
lua_Debug
 
¬
;

2070 
v¬s
 = 0;

2072 ià(
	`lua_g‘¡ack
(
lua
,0,&
¬
) != 0) {

2073 cÚ¡ *
Çme
;

2074 
i
 = 1;

2075 (
Çme
 = 
	`lua_g‘loÿl
(
lua
,&
¬
,
i
)è!ğ
NULL
) {

2076 
i
++;

2077 ià(!
	`¡r¡r
(
Çme
,"(*temporary)")) {

2078 
sds
 
´efix
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"<v®ue> % ğ",
Çme
);

2079 
	`ldbLogSckV®ue
(
lua
,
´efix
);

2080 
	`sdsä“
(
´efix
);

2081 
v¬s
++;

2083 
	`lua_pİ
(
lua
,1);

2087 ià(
v¬s
 == 0) {

2088 
	`ldbLog
(
	`sd¢ew
("No†ocal variables inhe current context."));

2090 
	}
}

2093 
	$ldbB»ak
(
sds
 *
¬gv
, 
¬gc
) {

2094 ià(
¬gc
 == 1) {

2095 ià(
ldb
.
bpcouÁ
 == 0) {

2096 
	`ldbLog
(
	`sd¢ew
("No breakpoints set. Use 'b <line>'o‡dd one."));

2099 
	`ldbLog
(
	`sdsÿtfmt
(
	`sd£m±y
(),"%˜b»akpošt £t:",
ldb
.
bpcouÁ
));

2100 
j
;

2101 
j
 = 0; j < 
ldb
.
bpcouÁ
; j++)

2102 
	`ldbLogSourûLše
(
ldb
.
bp
[
j
]);

2105 
j
;

2106 
j
 = 1; j < 
¬gc
; j++) {

2107 *
¬g
 = 
¬gv
[
j
];

2108 
lše
;

2109 ià(!
	`¡ršg2l
(
¬g
,
	`sd¦’
×rg),&
lše
)) {

2110 
	`ldbLog
(
	`sdsÿtfmt
(
	`sd£m±y
(),"Inv®id‡rgum’t:'%s'",
¬g
));

2112 ià(
lše
 == 0) {

2113 
ldb
.
bpcouÁ
 = 0;

2114 
	`ldbLog
(
	`sd¢ew
("All breakpoints„emoved."));

2115 } ià(
lše
 > 0) {

2116 ià(
ldb
.
bpcouÁ
 =ğ
LDB_BREAKPOINTS_MAX
) {

2117 
	`ldbLog
(
	`sd¢ew
("Too many breakpoints set."));

2118 } ià(
	`ldbAddB»akpošt
(
lše
)) {

2119 
	`ldbLi¡
(
lše
,1);

2121 
	`ldbLog
(
	`sd¢ew
("Wrong†ine‚umber."));

2123 } ià(
lše
 < 0) {

2124 ià(
	`ldbD–B»akpošt
(-
lše
))

2125 
	`ldbLog
(
	`sd¢ew
("Breakpoint„emoved."));

2127 
	`ldbLog
(
	`sd¢ew
("No breakpoint inhe specified†ine."));

2132 
	}
}

2137 
	$ldbEv®
(
lua_S‹
 *
lua
, 
sds
 *
¬gv
, 
¬gc
) {

2139 
sds
 
code
 = 
	`sdsjošsds
(
¬gv
+1,
¬gc
-1," ",1);

2140 
sds
 
ex´
 = 
	`sdsÿtsds
(
	`sd¢ew
("»tuº "),
code
);

2143 ià(
	`luaL_lßdbufãr
(
lua
,
ex´
,
	`sd¦’
(expr),"@ldb_eval")) {

2144 
	`lua_pİ
(
lua
,1);

2146 ià(
	`luaL_lßdbufãr
(
lua
,
code
,
	`sd¦’
(code),"@ldb_eval")) {

2147 
	`ldbLog
(
	`sdsÿtfmt
(
	`sd£m±y
(),"<”rÜ> %s",
	`lua_to¡ršg
(
lua
,-1)));

2148 
	`lua_pİ
(
lua
,1);

2149 
	`sdsä“
(
code
);

2155 
	`sdsä“
(
code
);

2156 
	`sdsä“
(
ex´
);

2157 ià(
	`lua_pÿÎ
(
lua
,0,1,0)) {

2158 
	`ldbLog
(
	`sdsÿtfmt
(
	`sd£m±y
(),"<”rÜ> %s",
	`lua_to¡ršg
(
lua
,-1)));

2159 
	`lua_pİ
(
lua
,1);

2162 
	`ldbLogSckV®ue
(
lua
,"<retval> ");

2163 
	`lua_pİ
(
lua
,1);

2164 
	}
}

2170 
	$ldbRedis
(
lua_S‹
 *
lua
, 
sds
 *
¬gv
, 
¬gc
) {

2171 
j
, 
§ved_rc
 = 
£rv”
.
lua_»¶iÿ‹_commªds
;

2173 
	`lua_g‘glob®
(
lua
,"redis");

2174 
	`lua_push¡ršg
(
lua
,"call");

2175 
	`lua_g‘bË
(
lua
,-2);

2176 
j
 = 1; j < 
¬gc
; j++)

2177 
	`lua_pushl¡ršg
(
lua
,
¬gv
[
j
],
	`sd¦’
(argv[j]));

2178 
ldb
.
¡•
 = 1;

2179 
£rv”
.
lua_»¶iÿ‹_commªds
 = 1;

2180 
	`lua_pÿÎ
(
lua
,
¬gc
-1,1,0);

2181 
ldb
.
¡•
 = 0;

2182 
£rv”
.
lua_»¶iÿ‹_commªds
 = 
§ved_rc
;

2183 
	`lua_pİ
(
lua
,2);

2184 
	}
}

2188 
	$ldbT¿û
(
lua_S‹
 *
lua
) {

2189 
lua_Debug
 
¬
;

2190 
Ëv–
 = 0;

2192 
	`lua_g‘¡ack
(
lua
,
Ëv–
,&
¬
)) {

2193 
	`lua_g‘šfo
(
lua
,"SÆ",&
¬
);

2194 if(
	`¡r¡r
(
¬
.
shÜt_¤c
,"u£r_süt"è!ğ
NULL
) {

2195 
	`ldbLog
(
	`sdsÿrštf
(
	`sd£m±y
(),"%s %s:",

2196 (
Ëv–
 == 0) ? "In" : "From",

2197 
¬
.
Çme
 ?‡r.name : "top†evel"));

2198 
	`ldbLogSourûLše
(
¬
.
cu¼’še
);

2200 
Ëv–
++;

2202 ià(
Ëv–
 == 0) {

2203 
	`ldbLog
(
	`sd¢ew
("<error> Can't„etrieve Lua stack."));

2205 
	}
}

2209 
	$ldbMaxËn
(
sds
 *
¬gv
, 
¬gc
) {

2210 ià(
¬gc
 == 2) {

2211 
Ãwv®
 = 
	`©oi
(
¬gv
[1]);

2212 
ldb
.
maxËn_hšt_£Á
 = 1;

2213 ià(
Ãwv®
 != 0 &&‚ewval <= 60)‚ewval = 60;

2214 
ldb
.
maxËn
 = 
Ãwv®
;

2216 ià(
ldb
.
maxËn
) {

2217 
	`ldbLog
(
	`sdsÿrštf
(
	`sd£m±y
(),"<v®ue>„•l› ¬Œunÿ‹d‡ˆ%d by‹s.",()
ldb
.
maxËn
));

2219 
	`ldbLog
(
	`sdsÿrštf
(
	`sd£m±y
(),"<value>„eplies‡re unlimited."));

2221 
	}
}

2226 
	$ldbR•l
(
lua_S‹
 *
lua
) {

2227 
sds
 *
¬gv
;

2228 
¬gc
;

2233 (
¬gv
 = 
	`ldbR•lP¬£Commªd
(&
¬gc
)è=ğ
NULL
) {

2234 
buf
[1024];

2235 
Ä—d
 = 
	`»ad
(
ldb
.
fd
,
buf
,(buf));

2236 ià(
Ä—d
 <= 0) {

2239 
ldb
.
¡•
 = 0;

2240 
ldb
.
bpcouÁ
 = 0;

2241  
C_ERR
;

2243 
ldb
.
cbuf
 = 
	`sdsÿ’
Ödb.cbuf,
buf
,
Ä—d
);

2247 
	`sdsä“
(
ldb
.
cbuf
);

2248 
ldb
.
cbuf
 = 
	`sd£m±y
();

2251 ià(!
	`¡rÿ£cmp
(
¬gv
[0],"h") || !strcasecmp(argv[0],"help")) {

2252 
	`ldbLog
(
	`sd¢ew
("Redis Lua debugger help:"));

2253 
	`ldbLog
(
	`sd¢ew
("[h]elp Showhis help."));

2254 
	`ldbLog
(
	`sd¢ew
("[s]tep Run current†ine‡nd stop‡gain."));

2255 
	`ldbLog
(
	`sd¢ew
("[n]ext Alias for step."));

2256 
	`ldbLog
(
	`sd¢ew
("[c]continue Runill‚ext breakpoint."));

2257 
	`ldbLog
(
	`sd¢ew
("[l]list List source code‡round current†ine."));

2258 
	`ldbLog
(
	`sd¢ew
("[l]list [line] List source code‡round [line]."));

2259 
	`ldbLog
(
	`sd¢ew
("†ine = 0 means: current…osition."));

2260 
	`ldbLog
(
	`sd¢ew
("[l]list [line] [ctx] Inhis form [ctx] specifies how many†ines"));

2261 
	`ldbLog
(
	`sd¢ew
("o show before/after [line]."));

2262 
	`ldbLog
(
	`sd¢ew
("[w]hole List‡ll source code. Alias for 'list 1 1000000'."));

2263 
	`ldbLog
(
	`sd¢ew
("[p]rint Show‡llhe†ocal variables."));

2264 
	`ldbLog
(
	`sd¢ew
("[p]rint <var> Showhe value ofhe specified variable."));

2265 
	`ldbLog
(
	`sd¢ew
(" Can‡lso show global vars KEYS‡nd ARGV."));

2266 
	`ldbLog
(
	`sd¢ew
("[b]reak Show‡ll breakpoints."));

2267 
	`ldbLog
(
	`sd¢ew
("[b]reak <line> Add‡ breakpointohe specified†ine."));

2268 
	`ldbLog
(
	`sd¢ew
("[b]reak -<line> Remove breakpoint fromhe specified†ine."));

2269 
	`ldbLog
(
	`sd¢ew
("[b]reak 0 Remove‡ll breakpoints."));

2270 
	`ldbLog
(
	`sd¢ew
("[t]race Show‡ backtrace."));

2271 
	`ldbLog
(
	`sd¢ew
("[e]eval <code> Execute some Lua code (in‡ different callframe)."));

2272 
	`ldbLog
(
	`sd¢ew
("[r]edis <cmd> Execute‡ Redis command."));

2273 
	`ldbLog
(
	`sd¢ew
("[m]axlen [len] Trim†ogged Redis„eplies‡nd Lua var dumpso†en."));

2274 
	`ldbLog
(
	`sd¢ew
(" Specifying zero‡s <len> means unlimited."));

2275 
	`ldbLog
(
	`sd¢ew
("[a]abort Stopheƒxecution ofhe script. In sync"));

2276 
	`ldbLog
(
	`sd¢ew
(" mode dataset changes will be„etained."));

2277 
	`ldbLog
(
	`sd¢ew
(""));

2278 
	`ldbLog
(
	`sd¢ew
("Debugger functions you can call from Lua scripts:"));

2279 
	`ldbLog
(
	`sd¢ew
("redis.debug() Produce†ogs inhe debugger console."));

2280 
	`ldbLog
(
	`sd¢ew
("redis.breakpoint() Stopƒxecution†ike ifhere was‡ breakpoing."));

2281 
	`ldbLog
(
	`sd¢ew
(" inhe‚ext†ine of code."));

2282 
	`ldbS’dLogs
();

2283 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"s") || !strcasecmp(argv[0],"step") ||

2284 !
	`¡rÿ£cmp
(
¬gv
[0],"n") || !strcasecmp(argv[0],"next")) {

2285 
ldb
.
¡•
 = 1;

2287 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"c") || !strcasecmp(argv[0],"continue")){

2289 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"t") || !strcasecmp(argv[0],"trace")) {

2290 
	`ldbT¿û
(
lua
);

2291 
	`ldbS’dLogs
();

2292 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"m") || !strcasecmp(argv[0],"maxlen")) {

2293 
	`ldbMaxËn
(
¬gv
,
¬gc
);

2294 
	`ldbS’dLogs
();

2295 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"b") || !strcasecmp(argv[0],"break")) {

2296 
	`ldbB»ak
(
¬gv
,
¬gc
);

2297 
	`ldbS’dLogs
();

2298 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"e") || !strcasecmp(argv[0],"eval")) {

2299 
	`ldbEv®
(
lua
,
¬gv
,
¬gc
);

2300 
	`ldbS’dLogs
();

2301 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"a") || !strcasecmp(argv[0],"abort")) {

2302 
	`lua_push¡ršg
(
lua
, "script‡borted for user„equest");

2303 
	`lua_”rÜ
(
lua
);

2304 } ià(
¬gc
 > 1 &&

2305 (!
	`¡rÿ£cmp
(
¬gv
[0],"r") || !strcasecmp(argv[0],"redis"))) {

2306 
	`ldbRedis
(
lua
,
¬gv
,
¬gc
);

2307 
	`ldbS’dLogs
();

2308 } ià((!
	`¡rÿ£cmp
(
¬gv
[0],"p") || !strcasecmp(argv[0],"print"))) {

2309 ià(
¬gc
 == 2)

2310 
	`ldbPršt
(
lua
,
¬gv
[1]);

2312 
	`ldbPrštAÎ
(
lua
);

2313 
	`ldbS’dLogs
();

2314 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"l") || !strcasecmp(argv[0],"list")){

2315 
¬ound
 = 
ldb
.
cu¼’še
, 
ùx
 = 5;

2316 ià(
¬gc
 > 1) {

2317 
num
 = 
	`©oi
(
¬gv
[1]);

2318 ià(
num
 > 0è
¬ound
 =‚um;

2320 ià(
¬gc
 > 2è
ùx
 = 
	`©oi
(
¬gv
[2]);

2321 
	`ldbLi¡
(
¬ound
,
ùx
);

2322 
	`ldbS’dLogs
();

2323 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"w") || !strcasecmp(argv[0],"whole")){

2324 
	`ldbLi¡
(1,1000000);

2325 
	`ldbS’dLogs
();

2327 
	`ldbLog
(
	`sd¢ew
("<error> Unknown Redis Lua debugger command or "

2329 
	`ldbS’dLogs
();

2333 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

2337 
	`sdsä“¥l™»s
(
¬gv
,
¬gc
);

2338  
C_OK
;

2339 
	}
}

2343 
	$luaLdbLšeHook
(
lua_S‹
 *
lua
, 
lua_Debug
 *
¬
) {

2344 
	`lua_g‘¡ack
(
lua
,0,
¬
);

2345 
	`lua_g‘šfo
(
lua
,"Sl",
¬
);

2346 
ldb
.
cu¼’še
 = 
¬
->currentline;

2348 
bp
 = 
	`ldbIsB»akpošt
(
ldb
.
cu¼’še
è||†db.
luabp
;

2349 
timeout
 = 0;

2352 if(
	`¡r¡r
(
¬
->
shÜt_¤c
,"u£r_süt"è=ğ
NULL
) ;

2355 ià(
¬
->
ev’t
 =ğ
LUA_HOOKCOUNT
 && 
ldb
.
¡•
 =ğ0 && 
bp
 == 0) {

2356 
m¡ime_t
 
–­£d
 = 
	`m¡ime
(è- 
£rv”
.
lua_time_¡¬t
;

2357 
m¡ime_t
 
tim–im™
 = 
£rv”
.
lua_time_lim™
 ?

2358 
£rv”
.
lua_time_lim™
 : 5000;

2359 ià(
–­£d
 >ğ
tim–im™
) {

2360 
timeout
 = 1;

2361 
ldb
.
¡•
 = 1;

2367 ià(
ldb
.
¡•
 || 
bp
) {

2368 *
»asÚ
 = "step over";

2369 ià(
bp
è
»asÚ
 = 
ldb
.
luabp
 ? "redis.breakpoint() called" :

2371 ià(
timeout
è
»asÚ
 = "timeout„eached, infinite†oop?";

2372 
ldb
.
¡•
 = 0;

2373 
ldb
.
luabp
 = 0;

2374 
	`ldbLog
(
	`sdsÿrštf
(
	`sd£m±y
(),

2376 
ldb
.
cu¼’še
, 
»asÚ
));

2377 
	`ldbLogSourûLše
(
ldb
.
cu¼’še
);

2378 
	`ldbS’dLogs
();

2379 ià(
	`ldbR•l
(
lua
è=ğ
C_ERR
 && 
timeout
) {

2383 
	`lua_push¡ršg
(
lua
, "timeout during Lua debugging with client closing connection");

2384 
	`lua_”rÜ
(
lua
);

2386 
£rv”
.
lua_time_¡¬t
 = 
	`m¡ime
();

2388 
	}
}

	@src/sds.c

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ršg.h
>

36 
	~<ùy³.h
>

37 
	~<as£¹.h
>

38 
	~"sds.h
"

39 
	~"sd§Îoc.h
"

41 #ifdeà
USE_PMDK


42 
	~"£rv”.h
"

43 
ušt64_t
 
	gPM_TYPE_SDS
;

46 
šlše
 
	$sdsHdrSize
(
ty³
) {

47 
ty³
&
SDS_TYPE_MASK
) {

48 
SDS_TYPE_5
:

49  (
sdshdr5
);

50 
SDS_TYPE_8
:

51  (
sdshdr8
);

52 
SDS_TYPE_16
:

53  (
sdshdr16
);

54 
SDS_TYPE_32
:

55  (
sdshdr32
);

56 
SDS_TYPE_64
:

57  (
sdshdr64
);

60 
	}
}

62 
šlše
 
	$sdsReqTy³
(
size_t
 
¡ršg_size
) {

63 ià(
¡ršg_size
 < 1<<5)

64  
SDS_TYPE_5
;

65 ià(
¡ršg_size
 < 1<<8)

66  
SDS_TYPE_8
;

67 ià(
¡ršg_size
 < 1<<16)

68  
SDS_TYPE_16
;

69 ià(
¡ršg_size
 < 1ll<<32)

70  
SDS_TYPE_32
;

71  
SDS_TYPE_64
;

72 
	}
}

86 
sds
 
	$sd¢ewËn
(cÚ¡ *
š™
, 
size_t
 
š™Ën
) {

87 *
sh
;

88 
sds
 
s
;

89 
ty³
 = 
	`sdsReqTy³
(
š™Ën
);

92 ià(
ty³
 =ğ
SDS_TYPE_5
 && 
š™Ën
 =ğ0èty³ = 
SDS_TYPE_8
;

93 
hd¾’
 = 
	`sdsHdrSize
(
ty³
);

94 *
å
;

96 
sh
 = 
	`s_m®loc
(
hd¾’
+
š™Ën
+1);

97 ià(!
š™
)

98 
	`mem£t
(
sh
, 0, 
hd¾’
+
š™Ën
+1);

99 ià(
sh
 =ğ
NULL
)  NULL;

100 
s
 = (*)
sh
+
hd¾’
;

101 
å
 = ((*)
s
)-1;

102 
ty³
) {

103 
SDS_TYPE_5
: {

104 *
å
 = 
ty³
 | (
š™Ën
 << 
SDS_TYPE_BITS
);

107 
SDS_TYPE_8
: {

108 
	`SDS_HDR_VAR
(8,
s
);

109 
sh
->
Ën
 = 
š™Ën
;

110 
sh
->
®loc
 = 
š™Ën
;

111 *
å
 = 
ty³
;

114 
SDS_TYPE_16
: {

115 
	`SDS_HDR_VAR
(16,
s
);

116 
sh
->
Ën
 = 
š™Ën
;

117 
sh
->
®loc
 = 
š™Ën
;

118 *
å
 = 
ty³
;

121 
SDS_TYPE_32
: {

122 
	`SDS_HDR_VAR
(32,
s
);

123 
sh
->
Ën
 = 
š™Ën
;

124 
sh
->
®loc
 = 
š™Ën
;

125 *
å
 = 
ty³
;

128 
SDS_TYPE_64
: {

129 
	`SDS_HDR_VAR
(64,
s
);

130 
sh
->
Ën
 = 
š™Ën
;

131 
sh
->
®loc
 = 
š™Ën
;

132 *
å
 = 
ty³
;

136 ià(
š™Ën
 && 
š™
)

137 
	`memıy
(
s
, 
š™
, 
š™Ën
);

138 
s
[
š™Ën
] = '\0';

139  
s
;

140 
	}
}

142 #ifdeà
USE_PMDK


155 
sds
 
	$sd¢ewËnPM
(cÚ¡ *
š™
, 
size_t
 
š™Ën
) {

156 *
sh
;

157 
sds
 
s
;

158 
ty³
 = 
	`sdsReqTy³
(
š™Ën
);

159 
PMEMoid
 
oid
;

162 ià(
ty³
 =ğ
SDS_TYPE_5
 && 
š™Ën
 =ğ0èty³ = 
SDS_TYPE_8
;

163 
hd¾’
 = 
	`sdsHdrSize
(
ty³
);

164 *
å
;

166 
hd¾’
 +ğ(
PMEMoid
);

167 
oid
 = 
	`pmemobj_tx_z®loc
((
hd¾’
+
š™Ën
+1),
PM_TYPE_SDS
);

168 
sh
 = 
	`pmemobj_dœeù
(
oid
);

170 ià(!
š™
)

171 
	`mem£t
(
sh
, 0, 
hd¾’
+
š™Ën
+1);

172 ià(
sh
 =ğ
NULL
)  NULL;

173 
s
 = (*)
sh
+
hd¾’
;

174 
å
 = ((*)
s
)-1;

175 
ty³
) {

176 
SDS_TYPE_5
: {

177 *
å
 = 
ty³
 | (
š™Ën
 << 
SDS_TYPE_BITS
);

180 
SDS_TYPE_8
: {

181 
	`SDS_HDR_VAR
(8,
s
);

182 
sh
->
Ën
 = 
š™Ën
;

183 
sh
->
®loc
 = 
š™Ën
;

184 *
å
 = 
ty³
;

187 
SDS_TYPE_16
: {

188 
	`SDS_HDR_VAR
(16,
s
);

189 
sh
->
Ën
 = 
š™Ën
;

190 
sh
->
®loc
 = 
š™Ën
;

191 *
å
 = 
ty³
;

194 
SDS_TYPE_32
: {

195 
	`SDS_HDR_VAR
(32,
s
);

196 
sh
->
Ën
 = 
š™Ën
;

197 
sh
->
®loc
 = 
š™Ën
;

198 *
å
 = 
ty³
;

201 
SDS_TYPE_64
: {

202 
	`SDS_HDR_VAR
(64,
s
);

203 
sh
->
Ën
 = 
š™Ën
;

204 
sh
->
®loc
 = 
š™Ën
;

205 *
å
 = 
ty³
;

209 ià(
š™Ën
 && 
š™
)

210 
	`memıy
(
s
, 
š™
, 
š™Ën
);

211 
s
[
š™Ën
] = '\0';

212  
s
;

213 
	}
}

215 
PMEMoid
 *
	$sdsPMEMoidBackReã»nû
(
sds
 
s
)

217 *
p
;

218 
p
 = (
u_ch¬
 *)
s
 - 
	`sdsHdrSize
(s[-1]è- (
PMEMoid
);

219  (
PMEMoid
 *)
p
;

220 
	}
}

225 
sds
 
	$sd£m±y
() {

226  
	`sd¢ewËn
("",0);

227 
	}
}

230 
sds
 
	$sd¢ew
(cÚ¡ *
š™
) {

231 
size_t
 
š™Ën
 = (
š™
 =ğ
NULL
è? 0 : 
	`¡¾’
(init);

232  
	`sd¢ewËn
(
š™
, 
š™Ën
);

233 
	}
}

236 
sds
 
	$sdsdup
(cÚ¡ 
sds
 
s
) {

237  
	`sd¢ewËn
(
s
, 
	`sd¦’
(s));

238 
	}
}

240 #ifdeà
USE_PMDK


242 
sds
 
	$sdsdupPM
(cÚ¡ 
sds
 
s
, **
oid_»ã»nû
) {

243 
sds
 
Ãw_sds
;

244 
Ãw_sds
 = 
	`sd¢ewËnPM
(
s
, 
	`sd¦’
(s));

245 *
oid_»ã»nû
 = (*)
	`sdsPMEMoidBackReã»nû
(
Ãw_sds
);

246  
Ãw_sds
;

247 
	}
}

251 
	$sdsä“
(
sds
 
s
) {

252 ià(
s
 =ğ
NULL
) ;

253 
	`s_ä“
((*)
s
-
	`sdsHdrSize
(s[-1]));

254 
	}
}

256 #ifdeà
USE_PMDK


258 
	$sdsä“PM
(
sds
 
s
) {

259 
PMEMoid
 
oid
;

260 ià(
s
 =ğ
NULL
) ;

261 ià(
£rv”
.
³rsi¡’t
) {

262 
oid
.
off
 = (
ušt64_t
)((*)
s
-
	`sdsHdrSize
(s[-1])è- (
PMEMoid
è- (ušt64_t)
£rv”
.
pm_poŞ
;

263 
oid
.
poŞ_uuid_lo
 = 
£rv”
.pool_uuid_lo;

264 
	`pmemobj_tx_ä“
(
oid
);

266 
	`s_ä“
((*)
s
-
	`sdsHdrSize
(s[-1]));

268 
	}
}

285 
	$sdsupd©–’
(
sds
 
s
) {

286 
»®Ën
 = 
	`¡¾’
(
s
);

287 
	`sds£’
(
s
, 
»®Ën
);

288 
	}
}

294 
	$sdsş—r
(
sds
 
s
) {

295 
	`sds£’
(
s
, 0);

296 
s
[0] = '\0';

297 
	}
}

305 
sds
 
	$sdsMakeRoomFÜ
(
sds
 
s
, 
size_t
 
addËn
) {

306 *
sh
, *
Ãwsh
;

307 
size_t
 
ava
 = 
	`sd§va
(
s
);

308 
size_t
 
Ën
, 
ÃwËn
;

309 
ty³
, 
Şdty³
 = 
s
[-1] & 
SDS_TYPE_MASK
;

310 
hd¾’
;

313 ià(
ava
 >ğ
addËn
è 
s
;

315 
Ën
 = 
	`sd¦’
(
s
);

316 
sh
 = (*)
s
-
	`sdsHdrSize
(
Şdty³
);

317 
ÃwËn
 = (
Ën
+
addËn
);

318 ià(
ÃwËn
 < 
SDS_MAX_PREALLOC
)

319 
ÃwËn
 *= 2;

321 
ÃwËn
 +ğ
SDS_MAX_PREALLOC
;

323 
ty³
 = 
	`sdsReqTy³
(
ÃwËn
);

328 ià(
ty³
 =ğ
SDS_TYPE_5
èty³ = 
SDS_TYPE_8
;

330 
hd¾’
 = 
	`sdsHdrSize
(
ty³
);

331 ià(
Şdty³
==
ty³
) {

332 
Ãwsh
 = 
	`s_»®loc
(
sh
, 
hd¾’
+
ÃwËn
+1);

333 ià(
Ãwsh
 =ğ
NULL
)  NULL;

334 
s
 = (*)
Ãwsh
+
hd¾’
;

338 
Ãwsh
 = 
	`s_m®loc
(
hd¾’
+
ÃwËn
+1);

339 ià(
Ãwsh
 =ğ
NULL
)  NULL;

340 
	`memıy
((*)
Ãwsh
+
hd¾’
, 
s
, 
Ën
+1);

341 
	`s_ä“
(
sh
);

342 
s
 = (*)
Ãwsh
+
hd¾’
;

343 
s
[-1] = 
ty³
;

344 
	`sds£’
(
s
, 
Ën
);

346 
	`sds£Îoc
(
s
, 
ÃwËn
);

347  
s
;

348 
	}
}

356 
sds
 
	$sdsRemoveF»eS·û
(
sds
 
s
) {

357 *
sh
, *
Ãwsh
;

358 
ty³
, 
Şdty³
 = 
s
[-1] & 
SDS_TYPE_MASK
;

359 
hd¾’
;

360 
size_t
 
Ën
 = 
	`sd¦’
(
s
);

361 
sh
 = (*)
s
-
	`sdsHdrSize
(
Şdty³
);

363 
ty³
 = 
	`sdsReqTy³
(
Ën
);

364 
hd¾’
 = 
	`sdsHdrSize
(
ty³
);

365 ià(
Şdty³
==
ty³
) {

366 
Ãwsh
 = 
	`s_»®loc
(
sh
, 
hd¾’
+
Ën
+1);

367 ià(
Ãwsh
 =ğ
NULL
)  NULL;

368 
s
 = (*)
Ãwsh
+
hd¾’
;

370 
Ãwsh
 = 
	`s_m®loc
(
hd¾’
+
Ën
+1);

371 ià(
Ãwsh
 =ğ
NULL
)  NULL;

372 
	`memıy
((*)
Ãwsh
+
hd¾’
, 
s
, 
Ën
+1);

373 
	`s_ä“
(
sh
);

374 
s
 = (*)
Ãwsh
+
hd¾’
;

375 
s
[-1] = 
ty³
;

376 
	`sds£’
(
s
, 
Ën
);

378 
	`sds£Îoc
(
s
, 
Ën
);

379  
s
;

380 
	}
}

389 
size_t
 
	$sdsAÎocSize
(
sds
 
s
) {

390 
size_t
 
®loc
 = 
	`sd§Îoc
(
s
);

391  
	`sdsHdrSize
(
s
[-1])+
®loc
+1;

392 
	}
}

396 *
	$sdsAÎocPŒ
(
sds
 
s
) {

397  (*è(
s
-
	`sdsHdrSize
(s[-1]));

398 
	}
}

423 
	$sdsInüL’
(
sds
 
s
, 
šü
) {

424 
æags
 = 
s
[-1];

425 
size_t
 
Ën
;

426 
æags
&
SDS_TYPE_MASK
) {

427 
SDS_TYPE_5
: {

428 *
å
 = ((*)
s
)-1;

429 
ŞdËn
 = 
	`SDS_TYPE_5_LEN
(
æags
);

430 
	`as£¹
((
šü
 > 0 && 
ŞdËn
+incr < 32) || (incr < 0 && oldlen >= ()(-incr)));

431 *
å
 = 
SDS_TYPE_5
 | ((
ŞdËn
+
šü
è<< 
SDS_TYPE_BITS
);

432 
Ën
 = 
ŞdËn
+
šü
;

435 
SDS_TYPE_8
: {

436 
	`SDS_HDR_VAR
(8,
s
);

437 
	`as£¹
((
šü
 >ğ0 && 
sh
->
®loc
-sh->
Ën
 >= incr) || (incr < 0 && sh->len >= ()(-incr)));

438 
Ën
 = (
sh
->ËÀ+ğ
šü
);

441 
SDS_TYPE_16
: {

442 
	`SDS_HDR_VAR
(16,
s
);

443 
	`as£¹
((
šü
 >ğ0 && 
sh
->
®loc
-sh->
Ën
 >= incr) || (incr < 0 && sh->len >= ()(-incr)));

444 
Ën
 = (
sh
->ËÀ+ğ
šü
);

447 
SDS_TYPE_32
: {

448 
	`SDS_HDR_VAR
(32,
s
);

449 
	`as£¹
((
šü
 >ğ0 && 
sh
->
®loc
-sh->
Ën
 >= ()incr) || (incr < 0 && sh->len >= ()(-incr)));

450 
Ën
 = (
sh
->ËÀ+ğ
šü
);

453 
SDS_TYPE_64
: {

454 
	`SDS_HDR_VAR
(64,
s
);

455 
	`as£¹
((
šü
 >ğ0 && 
sh
->
®loc
-sh->
Ën
 >ğ(
ušt64_t
)incr) || (incr < 0 && sh->len >= (uint64_t)(-incr)));

456 
Ën
 = (
sh
->ËÀ+ğ
šü
);

459 : 
Ën
 = 0;

461 
s
[
Ën
] = '\0';

462 
	}
}

469 
sds
 
	$sdsgrowz”o
(
sds
 
s
, 
size_t
 
Ën
) {

470 
size_t
 
cu¾’
 = 
	`sd¦’
(
s
);

472 ià(
Ën
 <ğ
cu¾’
è 
s
;

473 
s
 = 
	`sdsMakeRoomFÜ
(s,
Ën
-
cu¾’
);

474 ià(
s
 =ğ
NULL
)  NULL;

477 
	`mem£t
(
s
+
cu¾’
,0,(
Ën
-curlen+1));

478 
	`sds£’
(
s
, 
Ën
);

479  
s
;

480 
	}
}

487 
sds
 
	$sdsÿ’
(
sds
 
s
, cÚ¡ *
t
, 
size_t
 
Ën
) {

488 
size_t
 
cu¾’
 = 
	`sd¦’
(
s
);

490 
s
 = 
	`sdsMakeRoomFÜ
(s,
Ën
);

491 ià(
s
 =ğ
NULL
)  NULL;

492 
	`memıy
(
s
+
cu¾’
, 
t
, 
Ën
);

493 
	`sds£’
(
s
, 
cu¾’
+
Ën
);

494 
s
[
cu¾’
+
Ën
] = '\0';

495  
s
;

496 
	}
}

502 
sds
 
	$sdsÿt
(
sds
 
s
, cÚ¡ *
t
) {

503  
	`sdsÿ’
(
s
, 
t
, 
	`¡¾’
(t));

504 
	}
}

510 
sds
 
	$sdsÿtsds
(
sds
 
s
, cÚ¡ sd 
t
) {

511  
	`sdsÿ’
(
s
, 
t
, 
	`sd¦’
(t));

512 
	}
}

516 
sds
 
	$sdsıyËn
(
sds
 
s
, cÚ¡ *
t
, 
size_t
 
Ën
) {

517 ià(
	`sd§Îoc
(
s
è< 
Ën
) {

518 
s
 = 
	`sdsMakeRoomFÜ
(s,
Ën
-
	`sd¦’
(s));

519 ià(
s
 =ğ
NULL
)  NULL;

521 
	`memıy
(
s
, 
t
, 
Ën
);

522 
s
[
Ën
] = '\0';

523 
	`sds£’
(
s
, 
Ën
);

524  
s
;

525 
	}
}

529 
sds
 
	$sdsıy
(
sds
 
s
, cÚ¡ *
t
) {

530  
	`sdsıyËn
(
s
, 
t
, 
	`¡¾’
(t));

531 
	}
}

539 
	#SDS_LLSTR_SIZE
 21

	)

540 
	$sd¦l2¡r
(*
s
, 
v®ue
) {

541 *
p
, 
aux
;

542 
v
;

543 
size_t
 
l
;

547 
v
 = (
v®ue
 < 0) ? -value : value;

548 
p
 = 
s
;

550 *
p
++ = '0'+(
v
%10);

551 
v
 /= 10;

552 } 
v
);

553 ià(
v®ue
 < 0è*
p
++ = '-';

556 
l
 = 
p
-
s
;

557 *
p
 = '\0';

560 
p
--;

561 
s
 < 
p
) {

562 
aux
 = *
s
;

563 *
s
 = *
p
;

564 *
p
 = 
aux
;

565 
s
++;

566 
p
--;

568  
l
;

569 
	}
}

572 
	$sdsuÎ2¡r
(*
s
, 
v
) {

573 *
p
, 
aux
;

574 
size_t
 
l
;

578 
p
 = 
s
;

580 *
p
++ = '0'+(
v
%10);

581 
v
 /= 10;

582 } 
v
);

585 
l
 = 
p
-
s
;

586 *
p
 = '\0';

589 
p
--;

590 
s
 < 
p
) {

591 
aux
 = *
s
;

592 *
s
 = *
p
;

593 *
p
 = 
aux
;

594 
s
++;

595 
p
--;

597  
l
;

598 
	}
}

604 
sds
 
	$sdsäomlÚglÚg
(
v®ue
) {

605 
buf
[
SDS_LLSTR_SIZE
];

606 
Ën
 = 
	`sd¦l2¡r
(
buf
,
v®ue
);

608  
	`sd¢ewËn
(
buf
,
Ën
);

609 
	}
}

612 
sds
 
	$sdsÿtv´štf
(
sds
 
s
, cÚ¡ *
fmt
, 
va_li¡
 
­
) {

613 
va_li¡
 
ıy
;

614 
¡©icbuf
[1024], *
buf
 = sticbuf, *
t
;

615 
size_t
 
buæ’
 = 
	`¡¾’
(
fmt
)*2;

619 ià(
buæ’
 > (
¡©icbuf
)) {

620 
buf
 = 
	`s_m®loc
(
buæ’
);

621 ià(
buf
 =ğ
NULL
)  NULL;

623 
buæ’
 = (
¡©icbuf
);

629 
buf
[
buæ’
-2] = '\0';

630 
	`va_cİy
(
ıy
,
­
);

631 
	`v¢´štf
(
buf
, 
buæ’
, 
fmt
, 
ıy
);

632 
	`va_’d
(
ıy
);

633 ià(
buf
[
buæ’
-2] != '\0') {

634 ià(
buf
 !ğ
¡©icbuf
è
	`s_ä“
(buf);

635 
buæ’
 *= 2;

636 
buf
 = 
	`s_m®loc
(
buæ’
);

637 ià(
buf
 =ğ
NULL
)  NULL;

644 
t
 = 
	`sdsÿt
(
s
, 
buf
);

645 ià(
buf
 !ğ
¡©icbuf
è
	`s_ä“
(buf);

646  
t
;

647 
	}
}

665 
sds
 
	$sdsÿrštf
(
sds
 
s
, cÚ¡ *
fmt
, ...) {

666 
va_li¡
 
­
;

667 *
t
;

668 
	`va_¡¬t
(
­
, 
fmt
);

669 
t
 = 
	`sdsÿtv´štf
(
s
,
fmt
,
­
);

670 
	`va_’d
(
­
);

671  
t
;

672 
	}
}

690 
sds
 
	$sdsÿtfmt
(
sds
 
s
, cÚ¡ *
fmt
, ...) {

691 
size_t
 
š™Ën
 = 
	`sd¦’
(
s
);

692 cÚ¡ *
f
 = 
fmt
;

693 
i
;

694 
va_li¡
 
­
;

696 
	`va_¡¬t
(
­
,
fmt
);

697 
f
 = 
fmt
;

698 
i
 = 
š™Ën
;

699 *
f
) {

700 
Ãxt
, *
¡r
;

701 
size_t
 
l
;

702 
num
;

703 
unum
;

706 ià(
	`sd§va
(
s
)==0) {

707 
s
 = 
	`sdsMakeRoomFÜ
(s,1);

710 *
f
) {

712 
Ãxt
 = *(
f
+1);

713 
f
++;

714 
Ãxt
) {

717 
¡r
 = 
	`va_¬g
(
­
,*);

718 
l
 = (
Ãxt
 =ğ's'è? 
	`¡¾’
(
¡r
è: 
	`sd¦’
(str);

719 ià(
	`sd§va
(
s
è< 
l
) {

720 
s
 = 
	`sdsMakeRoomFÜ
(s,
l
);

722 
	`memıy
(
s
+
i
,
¡r
,
l
);

723 
	`sdsšş’
(
s
,
l
);

724 
i
 +ğ
l
;

728 ià(
Ãxt
 == 'i')

729 
num
 = 
	`va_¬g
(
­
,);

731 
num
 = 
	`va_¬g
(
­
,);

733 
buf
[
SDS_LLSTR_SIZE
];

734 
l
 = 
	`sd¦l2¡r
(
buf
,
num
);

735 ià(
	`sd§va
(
s
è< 
l
) {

736 
s
 = 
	`sdsMakeRoomFÜ
(s,
l
);

738 
	`memıy
(
s
+
i
,
buf
,
l
);

739 
	`sdsšş’
(
s
,
l
);

740 
i
 +ğ
l
;

745 ià(
Ãxt
 == 'u')

746 
unum
 = 
	`va_¬g
(
­
,);

748 
unum
 = 
	`va_¬g
(
­
,);

750 
buf
[
SDS_LLSTR_SIZE
];

751 
l
 = 
	`sdsuÎ2¡r
(
buf
,
unum
);

752 ià(
	`sd§va
(
s
è< 
l
) {

753 
s
 = 
	`sdsMakeRoomFÜ
(s,
l
);

755 
	`memıy
(
s
+
i
,
buf
,
l
);

756 
	`sdsšş’
(
s
,
l
);

757 
i
 +ğ
l
;

761 
s
[
i
++] = 
Ãxt
;

762 
	`sdsšş’
(
s
,1);

767 
s
[
i
++] = *
f
;

768 
	`sdsšş’
(
s
,1);

771 
f
++;

773 
	`va_’d
(
­
);

776 
s
[
i
] = '\0';

777  
s
;

778 
	}
}

794 
sds
 
	$sd¡rim
(
sds
 
s
, cÚ¡ *
c£t
) {

795 *
¡¬t
, *
’d
, *
¥
, *
•
;

796 
size_t
 
Ën
;

798 
¥
 = 
¡¬t
 = 
s
;

799 
•
 = 
’d
 = 
s
+
	`sd¦’
(s)-1;

800 
¥
 <ğ
’d
 && 
	`¡rchr
(
c£t
, *sp)) sp++;

801 
•
 > 
¥
 && 
	`¡rchr
(
c£t
, *ep))ƒp--;

802 
Ën
 = (
¥
 > 
•
) ? 0 : ((ep-sp)+1);

803 ià(
s
 !ğ
¥
è
	`memmove
(s, sp, 
Ën
);

804 
s
[
Ën
] = '\0';

805 
	`sds£’
(
s
,
Ën
);

806  
s
;

807 
	}
}

825 
	$sd¤ªge
(
sds
 
s
, 
¡¬t
, 
’d
) {

826 
size_t
 
ÃwËn
, 
Ën
 = 
	`sd¦’
(
s
);

828 ià(
Ën
 == 0) ;

829 ià(
¡¬t
 < 0) {

830 
¡¬t
 = 
Ën
+start;

831 ià(
¡¬t
 < 0) start = 0;

833 ià(
’d
 < 0) {

834 
’d
 = 
Ën
+end;

835 ià(
’d
 < 0)ƒnd = 0;

837 
ÃwËn
 = (
¡¬t
 > 
’d
) ? 0 : (end-start)+1;

838 ià(
ÃwËn
 != 0) {

839 ià(
¡¬t
 >ğ(sigÃd)
Ën
) {

840 
ÃwËn
 = 0;

841 } ià(
’d
 >ğ(sigÃd)
Ën
) {

842 
’d
 = 
Ën
-1;

843 
ÃwËn
 = (
¡¬t
 > 
’d
) ? 0 : (end-start)+1;

846 
¡¬t
 = 0;

848 ià(
¡¬t
 && 
ÃwËn
è
	`memmove
(
s
, s+start,‚ewlen);

849 
s
[
ÃwËn
] = 0;

850 
	`sds£’
(
s
,
ÃwËn
);

851 
	}
}

854 
	$sd¡Şow”
(
sds
 
s
) {

855 
Ën
 = 
	`sd¦’
(
s
), 
j
;

857 
j
 = 0; j < 
Ën
; j++è
s
[j] = 
	`tŞow”
(s[j]);

858 
	}
}

861 
	$sd¡ouµ”
(
sds
 
s
) {

862 
Ën
 = 
	`sd¦’
(
s
), 
j
;

864 
j
 = 0; j < 
Ën
; j++è
s
[j] = 
	`touµ”
(s[j]);

865 
	}
}

878 
	$sdscmp
(cÚ¡ 
sds
 
s1
, cÚ¡ sd 
s2
) {

879 
size_t
 
l1
, 
l2
, 
mšËn
;

880 
cmp
;

882 
l1
 = 
	`sd¦’
(
s1
);

883 
l2
 = 
	`sd¦’
(
s2
);

884 
mšËn
 = (
l1
 < 
l2
) ?†1 :†2;

885 
cmp
 = 
	`memcmp
(
s1
,
s2
,
mšËn
);

886 ià(
cmp
 =ğ0è 
l1
-
l2
;

887  
cmp
;

888 
	}
}

906 
sds
 *
	$sds¥l™Ën
(cÚ¡ *
s
, 
Ën
, cÚ¡ *
£p
, 
£¶’
, *
couÁ
) {

907 
–em’ts
 = 0, 
¦Ùs
 = 5, 
¡¬t
 = 0, 
j
;

908 
sds
 *
tok’s
;

910 ià(
£¶’
 < 1 || 
Ën
 < 0è 
NULL
;

912 
tok’s
 = 
	`s_m®loc
((
sds
)*
¦Ùs
);

913 ià(
tok’s
 =ğ
NULL
)  NULL;

915 ià(
Ën
 == 0) {

916 *
couÁ
 = 0;

917  
tok’s
;

919 
j
 = 0; j < (
Ën
-(
£¶’
-1)); j++) {

921 ià(
¦Ùs
 < 
–em’ts
+2) {

922 
sds
 *
Ãwtok’s
;

924 
¦Ùs
 *= 2;

925 
Ãwtok’s
 = 
	`s_»®loc
(
tok’s
,(
sds
)*
¦Ùs
);

926 ià(
Ãwtok’s
 =ğ
NULL
è
ş—nup
;

927 
tok’s
 = 
Ãwtok’s
;

930 ià((
£¶’
 =ğ1 && *(
s
+
j
è=ğ
£p
[0]è|| (
	`memcmp
(s+j,sep,seplen) == 0)) {

931 
tok’s
[
–em’ts
] = 
	`sd¢ewËn
(
s
+
¡¬t
,
j
-start);

932 ià(
tok’s
[
–em’ts
] =ğ
NULL
è
ş—nup
;

933 
–em’ts
++;

934 
¡¬t
 = 
j
+
£¶’
;

935 
j
 = j+
£¶’
-1;

939 
tok’s
[
–em’ts
] = 
	`sd¢ewËn
(
s
+
¡¬t
,
Ën
-start);

940 ià(
tok’s
[
–em’ts
] =ğ
NULL
è
ş—nup
;

941 
–em’ts
++;

942 *
couÁ
 = 
–em’ts
;

943  
tok’s
;

945 
ş—nup
:

947 
i
;

948 
i
 = 0; i < 
–em’ts
; i++è
	`sdsä“
(
tok’s
[i]);

949 
	`s_ä“
(
tok’s
);

950 *
couÁ
 = 0;

951  
NULL
;

953 
	}
}

956 
	$sdsä“¥l™»s
(
sds
 *
tok’s
, 
couÁ
) {

957 ià(!
tok’s
) ;

958 
couÁ
--)

959 
	`sdsä“
(
tok’s
[
couÁ
]);

960 
	`s_ä“
(
tok’s
);

961 
	}
}

969 
sds
 
	$sdsÿŒ•r
(
sds
 
s
, cÚ¡ *
p
, 
size_t
 
Ën
) {

970 
s
 = 
	`sdsÿ’
(s,"\"",1);

971 
Ën
--) {

972 *
p
) {

975 
s
 = 
	`sdsÿrštf
(s,"\\%c",*
p
);

977 '\n': 
s
 = 
	`sdsÿ’
(s,"\\n",2); ;

978 '\r': 
s
 = 
	`sdsÿ’
(s,"\\r",2); ;

979 '\t': 
s
 = 
	`sdsÿ’
(s,"\\t",2); ;

980 '\a': 
s
 = 
	`sdsÿ’
(s,"\\a",2); ;

981 '\b': 
s
 = 
	`sdsÿ’
(s,"\\b",2); ;

983 ià(
	`i¥ršt
(*
p
))

984 
s
 = 
	`sdsÿrštf
(s,"%c",*
p
);

986 
s
 = 
	`sdsÿrštf
(s,"\\x%02x",()*
p
);

989 
p
++;

991  
	`sdsÿ’
(
s
,"\"",1);

992 
	}
}

996 
	$is_hex_dig™
(
c
) {

997  (
c
 >= '0' && c <= '9') || (c >= 'a' && c <= 'f') ||

998 (
c
 >= 'A' && c <= 'F');

999 
	}
}

1003 
	$hex_dig™_to_št
(
c
) {

1004 
c
) {

1023 
	}
}

1044 
sds
 *
	$sds¥l™¬gs
(cÚ¡ *
lše
, *
¬gc
) {

1045 cÚ¡ *
p
 = 
lše
;

1046 *
cu¼’t
 = 
NULL
;

1047 **
veùÜ
 = 
NULL
;

1049 *
¬gc
 = 0;

1052 *
p
 && 
	`is¥aû
(*p))…++;

1053 ià(*
p
) {

1055 
šq
=0;

1056 
šsq
=0;

1057 
dÚe
=0;

1059 ià(
cu¼’t
 =ğ
NULL
ècu¼’ˆğ
	`sd£m±y
();

1060 !
dÚe
) {

1061 ià(
šq
) {

1062 ià(*
p
 == '\\' && *(p+1) == 'x' &&

1063 
	`is_hex_dig™
(*(
p
+2)) &&

1064 
	`is_hex_dig™
(*(
p
+3)))

1066 
by‹
;

1068 
by‹
 = (
	`hex_dig™_to_št
(*(
p
+2))*16)+

1069 
	`hex_dig™_to_št
(*(
p
+3));

1070 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,(*)&
by‹
,1);

1071 
p
 += 3;

1072 } ià(*
p
 == '\\' && *(p+1)) {

1073 
c
;

1075 
p
++;

1076 *
p
) {

1077 'n': 
c
 = '\n'; ;

1078 'r': 
c
 = '\r'; ;

1079 't': 
c
 = '\t'; ;

1080 'b': 
c
 = '\b'; ;

1081 'a': 
c
 = '\a'; ;

1082 : 
c
 = *
p
; ;

1084 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,&
c
,1);

1085 } ià(*
p
 == '"') {

1088 ià(*(
p
+1è&& !
	`is¥aû
(*Õ+1))è
”r
;

1089 
dÚe
=1;

1090 } ià(!*
p
) {

1092 
”r
;

1094 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,
p
,1);

1096 } ià(
šsq
) {

1097 ià(*
p
 == '\\' && *(p+1) == '\'') {

1098 
p
++;

1099 
cu¼’t
 = 
	`sdsÿ’
(current,"'",1);

1100 } ià(*
p
 == '\'') {

1103 ià(*(
p
+1è&& !
	`is¥aû
(*Õ+1))è
”r
;

1104 
dÚe
=1;

1105 } ià(!*
p
) {

1107 
”r
;

1109 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,
p
,1);

1112 *
p
) {

1118 
dÚe
=1;

1121 
šq
=1;

1124 
šsq
=1;

1127 
cu¼’t
 = 
	`sdsÿ’
(cu¼’t,
p
,1);

1131 ià(*
p
)…++;

1134 
veùÜ
 = 
	`s_»®loc
(veùÜ,((*
¬gc
)+1)*(*));

1135 
veùÜ
[*
¬gc
] = 
cu¼’t
;

1136 (*
¬gc
)++;

1137 
cu¼’t
 = 
NULL
;

1140 ià(
veùÜ
 =ğ
NULL
èveùÜ = 
	`s_m®loc
((*));

1141  
veùÜ
;

1145 
”r
:

1146 (*
¬gc
)--)

1147 
	`sdsä“
(
veùÜ
[*
¬gc
]);

1148 
	`s_ä“
(
veùÜ
);

1149 ià(
cu¼’t
è
	`sdsä“
(current);

1150 *
¬gc
 = 0;

1151  
NULL
;

1152 
	}
}

1163 
sds
 
	$sdsm­ch¬s
(
sds
 
s
, cÚ¡ *
äom
, cÚ¡ *
to
, 
size_t
 
£’
) {

1164 
size_t
 
j
, 
i
, 
l
 = 
	`sd¦’
(
s
);

1166 
j
 = 0; j < 
l
; j++) {

1167 
i
 = 0; i < 
£’
; i++) {

1168 ià(
s
[
j
] =ğ
äom
[
i
]) {

1169 
s
[
j
] = 
to
[
i
];

1174  
s
;

1175 
	}
}

1179 
sds
 
	$sdsjoš
(**
¬gv
, 
¬gc
, *
£p
) {

1180 
sds
 
još
 = 
	`sd£m±y
();

1181 
j
;

1183 
j
 = 0; j < 
¬gc
; j++) {

1184 
još
 = 
	`sdsÿt
(još, 
¬gv
[
j
]);

1185 ià(
j
 !ğ
¬gc
-1è
još
 = 
	`sdsÿt
(još,
£p
);

1187  
još
;

1188 
	}
}

1191 
sds
 
	$sdsjošsds
(
sds
 *
¬gv
, 
¬gc
, cÚ¡ *
£p
, 
size_t
 
£¶’
) {

1192 
sds
 
još
 = 
	`sd£m±y
();

1193 
j
;

1195 
j
 = 0; j < 
¬gc
; j++) {

1196 
još
 = 
	`sdsÿtsds
(još, 
¬gv
[
j
]);

1197 ià(
j
 !ğ
¬gc
-1è
još
 = 
	`sdsÿ’
(još,
£p
,
£¶’
);

1199  
još
;

1200 
	}
}

1207 *
	$sds_m®loc
(
size_t
 
size
è{  
	`s_m®loc
(size); 
	}
}

1208 *
	$sds_»®loc
(*
±r
, 
size_t
 
size
è{  
	`s_»®loc
ÕŒ,size); 
	}
}

1209 
	$sds_ä“
(*
±r
è{ 
	`s_ä“
ÕŒ); 
	}
}

1211 #ià
defšed
(
SDS_TEST_MAIN
)

1212 
	~<¡dio.h
>

1213 
	~"‹¡h–p.h
"

1214 
	~"lim™s.h
"

1216 
	#UNUSED
(
x
è()(x)

	)

1217 
	$sdsTe¡
() {

1219 
sds
 
x
 = 
	`sd¢ew
("foo"), 
y
;

1221 
	`‹¡_cÚd
("Create‡ string‡nd obtainhe†ength",

1222 
	`sd¦’
(
x
è=ğ3 && 
	`memcmp
(x,"foo\0",4) == 0)

1224 
	`sdsä“
(
x
);

1225 
x
 = 
	`sd¢ewËn
("foo",2);

1226 
	`‹¡_cÚd
("Create‡ string with specified†ength",

1227 
	`sd¦’
(
x
è=ğ2 && 
	`memcmp
(x,"fo\0",3) == 0)

1229 
x
 = 
	`sdsÿt
(x,"bar");

1230 
	`‹¡_cÚd
("Strings concatenation",

1231 
	`sd¦’
(
x
è=ğ5 && 
	`memcmp
(x,"fobar\0",6) == 0);

1233 
x
 = 
	`sdsıy
(x,"a");

1234 
	`‹¡_cÚd
("sdscpy()‡gainst‡n originally†onger string",

1235 
	`sd¦’
(
x
è=ğ1 && 
	`memcmp
(x,"a\0",2) == 0)

1237 
x
 = 
	`sdsıy
(x,"xyzxxxxxxxxxxyyyyyyyyyykkkkkkkkkk");

1238 
	`‹¡_cÚd
("sdscpy()‡gainst‡n originally shorter string",

1239 
	`sd¦’
(
x
) == 33 &&

1240 
	`memcmp
(
x
,"xyzxxxxxxxxxxyyyyyyyyyykkkkkkkkkk\0",33) == 0)

1242 
	`sdsä“
(
x
);

1243 
x
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"%d",123);

1244 
	`‹¡_cÚd
("sdscatprintf() seems working inhe base case",

1245 
	`sd¦’
(
x
è=ğ3 && 
	`memcmp
(x,"123\0",4) == 0)

1247 
	`sdsä“
(
x
);

1248 
x
 = 
	`sd¢ew
("--");

1249 
x
 = 
	`sdsÿtfmt
(x, "H–lØ% WÜld %I,%I--", "Hi!", 
LLONG_MIN
,
LLONG_MAX
);

1250 
	`‹¡_cÚd
("sdscatfmt() seems working inhe base case",

1251 
	`sd¦’
(
x
) == 60 &&

1252 
	`memcmp
(
x
,"--Hello Hi! World -9223372036854775808,"

1254 
	`´štf
("[%s]\n",
x
);

1256 
	`sdsä“
(
x
);

1257 
x
 = 
	`sd¢ew
("--");

1258 
x
 = 
	`sdsÿtfmt
(x, "%u,%U--", 
UINT_MAX
, 
ULLONG_MAX
);

1259 
	`‹¡_cÚd
("sdscatfmt() seems working with unsigned‚umbers",

1260 
	`sd¦’
(
x
) == 35 &&

1261 
	`memcmp
(
x
,"--4294967295,18446744073709551615--",35) == 0)

1263 
	`sdsä“
(
x
);

1264 
x
 = 
	`sd¢ew
(" x ");

1265 
	`sd¡rim
(
x
," x");

1266 
	`‹¡_cÚd
("sdstrim() works when‡ll chars match",

1267 
	`sd¦’
(
x
) == 0)

1269 
	`sdsä“
(
x
);

1270 
x
 = 
	`sd¢ew
(" x ");

1271 
	`sd¡rim
(
x
," ");

1272 
	`‹¡_cÚd
("sdstrim() works when‡ single char„emains",

1273 
	`sd¦’
(
x
) == 1 && x[0] == 'x')

1275 
	`sdsä“
(
x
);

1276 
x
 = 
	`sd¢ew
("xxciaoyyy");

1277 
	`sd¡rim
(
x
,"xy");

1278 
	`‹¡_cÚd
("sdstrim() correctlyrims characters",

1279 
	`sd¦’
(
x
è=ğ4 && 
	`memcmp
(x,"ciao\0",5) == 0)

1281 
y
 = 
	`sdsdup
(
x
);

1282 
	`sd¤ªge
(
y
,1,1);

1283 
	`‹¡_cÚd
("sdsrange(...,1,1)",

1284 
	`sd¦’
(
y
è=ğ1 && 
	`memcmp
(y,"i\0",2) == 0)

1286 
	`sdsä“
(
y
);

1287 
y
 = 
	`sdsdup
(
x
);

1288 
	`sd¤ªge
(
y
,1,-1);

1289 
	`‹¡_cÚd
("sdsrange(...,1,-1)",

1290 
	`sd¦’
(
y
è=ğ3 && 
	`memcmp
(y,"iao\0",4) == 0)

1292 
	`sdsä“
(
y
);

1293 
y
 = 
	`sdsdup
(
x
);

1294 
	`sd¤ªge
(
y
,-2,-1);

1295 
	`‹¡_cÚd
("sdsrange(...,-2,-1)",

1296 
	`sd¦’
(
y
è=ğ2 && 
	`memcmp
(y,"ao\0",3) == 0)

1298 
	`sdsä“
(
y
);

1299 
y
 = 
	`sdsdup
(
x
);

1300 
	`sd¤ªge
(
y
,2,1);

1301 
	`‹¡_cÚd
("sdsrange(...,2,1)",

1302 
	`sd¦’
(
y
è=ğ0 && 
	`memcmp
(y,"\0",1) == 0)

1304 
	`sdsä“
(
y
);

1305 
y
 = 
	`sdsdup
(
x
);

1306 
	`sd¤ªge
(
y
,1,100);

1307 
	`‹¡_cÚd
("sdsrange(...,1,100)",

1308 
	`sd¦’
(
y
è=ğ3 && 
	`memcmp
(y,"iao\0",4) == 0)

1310 
	`sdsä“
(
y
);

1311 
y
 = 
	`sdsdup
(
x
);

1312 
	`sd¤ªge
(
y
,100,100);

1313 
	`‹¡_cÚd
("sdsrange(...,100,100)",

1314 
	`sd¦’
(
y
è=ğ0 && 
	`memcmp
(y,"\0",1) == 0)

1316 
	`sdsä“
(
y
);

1317 
	`sdsä“
(
x
);

1318 
x
 = 
	`sd¢ew
("foo");

1319 
y
 = 
	`sd¢ew
("foa");

1320 
	`‹¡_cÚd
("sdscmp(foo,fß)", 
	`sdscmp
(
x
,
y
) > 0)

1322 
	`sdsä“
(
y
);

1323 
	`sdsä“
(
x
);

1324 
x
 = 
	`sd¢ew
("bar");

1325 
y
 = 
	`sd¢ew
("bar");

1326 
	`‹¡_cÚd
("sdscmp(b¬,b¬)", 
	`sdscmp
(
x
,
y
) == 0)

1328 
	`sdsä“
(
y
);

1329 
	`sdsä“
(
x
);

1330 
x
 = 
	`sd¢ew
("aar");

1331 
y
 = 
	`sd¢ew
("bar");

1332 
	`‹¡_cÚd
("sdscmp(b¬,b¬)", 
	`sdscmp
(
x
,
y
) < 0)

1334 
	`sdsä“
(
y
);

1335 
	`sdsä“
(
x
);

1336 
x
 = 
	`sd¢ewËn
("\a\n\0foo\r",7);

1337 
y
 = 
	`sdsÿŒ•r
(
	`sd£m±y
(),
x
,
	`sd¦’
(x));

1338 
	`‹¡_cÚd
("sdscatrepr(...data...)",

1339 
	`memcmp
(
y
,"\"\\a\\n\\x00foo\\r\"",15) == 0)

1342 
Şdä“
;

1343 *
p
;

1344 
¡•
 = 10, 
j
, 
i
;

1346 
	`sdsä“
(
x
);

1347 
	`sdsä“
(
y
);

1348 
x
 = 
	`sd¢ew
("0");

1349 
	`‹¡_cÚd
("sd¢ew(èä“/ËÀbufãrs", 
	`sd¦’
(
x
è=ğ1 && 
	`sd§va
(x) == 0);

1353 
i
 = 0; i < 10; i++) {

1354 
ŞdËn
 = 
	`sd¦’
(
x
);

1355 
x
 = 
	`sdsMakeRoomFÜ
(x,
¡•
);

1356 
ty³
 = 
x
[-1]&
SDS_TYPE_MASK
;

1358 
	`‹¡_cÚd
("sdsMakeRoomFÜ(èËn", 
	`sd¦’
(
x
è=ğ
ŞdËn
);

1359 ià(
ty³
 !ğ
SDS_TYPE_5
) {

1360 
	`‹¡_cÚd
("sdsMakeRoomFÜ(èä“", 
	`sd§va
(
x
è>ğ
¡•
);

1361 
Şdä“
 = 
	`sd§va
(
x
);

1363 
p
 = 
x
+
ŞdËn
;

1364 
j
 = 0; j < 
¡•
; j++) {

1365 
p
[
j
] = 'A'+j;

1367 
	`sdsInüL’
(
x
,
¡•
);

1369 
	`‹¡_cÚd
("sdsMakeRoomFor() content",

1370 
	`memcmp
("0ABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJABCDEFGHIJ",
x
,101) == 0);

1371 
	`‹¡_cÚd
("sdsMakeRoomFÜ(èfš®†’gth",
	`sd¦’
(
x
)==101);

1373 
	`sdsä“
(
x
);

1376 
	`‹¡_»pÜt
()

1378 
	}
}

1381 #ifdeà
SDS_TEST_MAIN


1382 
	$maš
() {

1383  
	`sdsTe¡
();

1384 
	}
}

	@src/sds.h

33 #iâdeà
__SDS_H


34 
	#__SDS_H


	)

36 
	#SDS_MAX_PREALLOC
 (1024*1024)

	)

38 
	~<sys/ty³s.h
>

39 
	~<¡d¬g.h
>

40 
	~<¡dšt.h
>

42 #ifdeà
USE_PMDK


43 
	~"libpmemobj.h
"

46 *
	tsds
;

50 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr5
 {

51 
	gæags
;

52 
	gbuf
[];

54 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr8
 {

55 
ušt8_t
 
	gËn
;

56 
ušt8_t
 
	g®loc
;

57 
	gæags
;

58 
	gbuf
[];

60 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr16
 {

61 
ušt16_t
 
	gËn
;

62 
ušt16_t
 
	g®loc
;

63 
	gæags
;

64 
	gbuf
[];

66 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr32
 {

67 
ušt32_t
 
	gËn
;

68 
ušt32_t
 
	g®loc
;

69 
	gæags
;

70 
	gbuf
[];

72 
__©Œibu‹__
 ((
__·cked__
)è
	gsdshdr64
 {

73 
ušt64_t
 
	gËn
;

74 
ušt64_t
 
	g®loc
;

75 
	gæags
;

76 
	gbuf
[];

79 
	#SDS_TYPE_5
 0

	)

80 
	#SDS_TYPE_8
 1

	)

81 
	#SDS_TYPE_16
 2

	)

82 
	#SDS_TYPE_32
 3

	)

83 
	#SDS_TYPE_64
 4

	)

84 
	#SDS_TYPE_MASK
 7

	)

85 
	#SDS_TYPE_BITS
 3

	)

86 
	#SDS_HDR_VAR
(
T
,
s
è
sdshdr
##T *
sh
 = (*)((s)-((sdshdr##T)));

	)

87 
	#SDS_HDR
(
T
,
s
è((
sdshdr
##T *)((s)-((sdshdr##T))))

	)

88 
	#SDS_TYPE_5_LEN
(
f
è((f)>>
SDS_TYPE_BITS
)

	)

90 
šlše
 
size_t
 
	$sd¦’
(cÚ¡ 
sds
 
s
) {

91 
æags
 = 
s
[-1];

92 
æags
&
SDS_TYPE_MASK
) {

93 
SDS_TYPE_5
:

94  
	`SDS_TYPE_5_LEN
(
æags
);

95 
SDS_TYPE_8
:

96  
	`SDS_HDR
(8,
s
)->
Ën
;

97 
SDS_TYPE_16
:

98  
	`SDS_HDR
(16,
s
)->
Ën
;

99 
SDS_TYPE_32
:

100  
	`SDS_HDR
(32,
s
)->
Ën
;

101 
SDS_TYPE_64
:

102  
	`SDS_HDR
(64,
s
)->
Ën
;

105 
	}
}

107 
šlše
 
size_t
 
	$sd§va
(cÚ¡ 
sds
 
s
) {

108 
æags
 = 
s
[-1];

109 
æags
&
SDS_TYPE_MASK
) {

110 
SDS_TYPE_5
: {

113 
SDS_TYPE_8
: {

114 
	`SDS_HDR_VAR
(8,
s
);

115  
sh
->
®loc
 - sh->
Ën
;

117 
SDS_TYPE_16
: {

118 
	`SDS_HDR_VAR
(16,
s
);

119  
sh
->
®loc
 - sh->
Ën
;

121 
SDS_TYPE_32
: {

122 
	`SDS_HDR_VAR
(32,
s
);

123  
sh
->
®loc
 - sh->
Ën
;

125 
SDS_TYPE_64
: {

126 
	`SDS_HDR_VAR
(64,
s
);

127  
sh
->
®loc
 - sh->
Ën
;

131 
	}
}

133 
šlše
 
	$sds£’
(
sds
 
s
, 
size_t
 
ÃwËn
) {

134 
æags
 = 
s
[-1];

135 
æags
&
SDS_TYPE_MASK
) {

136 
SDS_TYPE_5
:

138 *
å
 = ((*)
s
)-1;

139 *
å
 = 
SDS_TYPE_5
 | (
ÃwËn
 << 
SDS_TYPE_BITS
);

142 
SDS_TYPE_8
:

143 
	`SDS_HDR
(8,
s
)->
Ën
 = 
ÃwËn
;

145 
SDS_TYPE_16
:

146 
	`SDS_HDR
(16,
s
)->
Ën
 = 
ÃwËn
;

148 
SDS_TYPE_32
:

149 
	`SDS_HDR
(32,
s
)->
Ën
 = 
ÃwËn
;

151 
SDS_TYPE_64
:

152 
	`SDS_HDR
(64,
s
)->
Ën
 = 
ÃwËn
;

155 
	}
}

157 
šlše
 
	$sdsšş’
(
sds
 
s
, 
size_t
 
šc
) {

158 
æags
 = 
s
[-1];

159 
æags
&
SDS_TYPE_MASK
) {

160 
SDS_TYPE_5
:

162 *
å
 = ((*)
s
)-1;

163 
ÃwËn
 = 
	`SDS_TYPE_5_LEN
(
æags
)+
šc
;

164 *
å
 = 
SDS_TYPE_5
 | (
ÃwËn
 << 
SDS_TYPE_BITS
);

167 
SDS_TYPE_8
:

168 
	`SDS_HDR
(8,
s
)->
Ën
 +ğ
šc
;

170 
SDS_TYPE_16
:

171 
	`SDS_HDR
(16,
s
)->
Ën
 +ğ
šc
;

173 
SDS_TYPE_32
:

174 
	`SDS_HDR
(32,
s
)->
Ën
 +ğ
šc
;

176 
SDS_TYPE_64
:

177 
	`SDS_HDR
(64,
s
)->
Ën
 +ğ
šc
;

180 
	}
}

183 
šlše
 
size_t
 
	$sd§Îoc
(cÚ¡ 
sds
 
s
) {

184 
æags
 = 
s
[-1];

185 
æags
&
SDS_TYPE_MASK
) {

186 
SDS_TYPE_5
:

187  
	`SDS_TYPE_5_LEN
(
æags
);

188 
SDS_TYPE_8
:

189  
	`SDS_HDR
(8,
s
)->
®loc
;

190 
SDS_TYPE_16
:

191  
	`SDS_HDR
(16,
s
)->
®loc
;

192 
SDS_TYPE_32
:

193  
	`SDS_HDR
(32,
s
)->
®loc
;

194 
SDS_TYPE_64
:

195  
	`SDS_HDR
(64,
s
)->
®loc
;

198 
	}
}

200 
šlše
 
	$sds£Îoc
(
sds
 
s
, 
size_t
 
ÃwËn
) {

201 
æags
 = 
s
[-1];

202 
æags
&
SDS_TYPE_MASK
) {

203 
SDS_TYPE_5
:

206 
SDS_TYPE_8
:

207 
	`SDS_HDR
(8,
s
)->
®loc
 = 
ÃwËn
;

209 
SDS_TYPE_16
:

210 
	`SDS_HDR
(16,
s
)->
®loc
 = 
ÃwËn
;

212 
SDS_TYPE_32
:

213 
	`SDS_HDR
(32,
s
)->
®loc
 = 
ÃwËn
;

215 
SDS_TYPE_64
:

216 
	`SDS_HDR
(64,
s
)->
®loc
 = 
ÃwËn
;

219 
	}
}

221 
sds
 
sd¢ewËn
(cÚ¡ *
š™
, 
size_t
 
š™Ën
);

222 
sds
 
sd¢ew
(cÚ¡ *
š™
);

223 
sds
 
sd£m±y
();

224 
sds
 
sdsdup
(cÚ¡ sd 
s
);

225 
sdsä“
(
sds
 
s
);

226 
sds
 
sdsgrowz”o
(sd 
s
, 
size_t
 
Ën
);

227 
sds
 
sdsÿ’
(sd 
s
, cÚ¡ *
t
, 
size_t
 
Ën
);

228 
sds
 
sdsÿt
(sd 
s
, cÚ¡ *
t
);

229 
sds
 
sdsÿtsds
(sd 
s
, cÚ¡ sd 
t
);

230 
sds
 
sdsıyËn
(sd 
s
, cÚ¡ *
t
, 
size_t
 
Ën
);

231 
sds
 
sdsıy
(sd 
s
, cÚ¡ *
t
);

233 #ifdeà
USE_PMDK


234 
sds
 
sd¢ewËnPM
(cÚ¡ *
š™
, 
size_t
 
š™Ën
);

235 
sds
 
sdsdupPM
(cÚ¡ sd 
s
, **
oid_»ã»nû
);

236 
sdsä“PM
(
sds
 
s
);

237 
PMEMoid
 *
sdsPMEMoidBackReã»nû
(
sds
 
s
);

240 
sds
 
sdsÿtv´štf
(sd 
s
, cÚ¡ *
fmt
, 
va_li¡
 
­
);

241 #ifdeà
__GNUC__


242 
sds
 
	$sdsÿrštf
(
sds
 
s
, cÚ¡ *
fmt
, ...)

243 
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 2, 3)));

245 
sds
 
	`sdsÿrštf
(sd 
s
, cÚ¡ *
fmt
, ...);

248 
sds
 
	`sdsÿtfmt
(sd 
s
, cÚ¡ *
fmt
, ...);

249 
sds
 
	`sd¡rim
(sd 
s
, cÚ¡ *
c£t
);

250 
	`sd¤ªge
(
sds
 
s
, 
¡¬t
, 
’d
);

251 
	`sdsupd©–’
(
sds
 
s
);

252 
	`sdsş—r
(
sds
 
s
);

253 
	`sdscmp
(cÚ¡ 
sds
 
s1
, cÚ¡ sd 
s2
);

254 
sds
 *
	`sds¥l™Ën
(cÚ¡ *
s
, 
Ën
, cÚ¡ *
£p
, 
£¶’
, *
couÁ
);

255 
	`sdsä“¥l™»s
(
sds
 *
tok’s
, 
couÁ
);

256 
	`sd¡Şow”
(
sds
 
s
);

257 
	`sd¡ouµ”
(
sds
 
s
);

258 
sds
 
	`sdsäomlÚglÚg
(
v®ue
);

259 
sds
 
	`sdsÿŒ•r
(sd 
s
, cÚ¡ *
p
, 
size_t
 
Ën
);

260 
sds
 *
	`sds¥l™¬gs
(cÚ¡ *
lše
, *
¬gc
);

261 
sds
 
	`sdsm­ch¬s
(sd 
s
, cÚ¡ *
äom
, cÚ¡ *
to
, 
size_t
 
£’
);

262 
sds
 
	`sdsjoš
(**
¬gv
, 
¬gc
, *
£p
);

263 
sds
 
	`sdsjošsds
(sd *
¬gv
, 
¬gc
, cÚ¡ *
£p
, 
size_t
 
£¶’
);

266 
sds
 
	`sdsMakeRoomFÜ
(sd 
s
, 
size_t
 
addËn
);

267 
	`sdsInüL’
(
sds
 
s
, 
šü
);

268 
sds
 
	`sdsRemoveF»eS·û
(sd 
s
);

269 
size_t
 
	`sdsAÎocSize
(
sds
 
s
);

270 *
	`sdsAÎocPŒ
(
sds
 
s
);

276 *
	`sds_m®loc
(
size_t
 
size
);

277 *
	`sds_»®loc
(*
±r
, 
size_t
 
size
);

278 
	`sds_ä“
(*
±r
);

280 #ifdeà
REDIS_TEST


281 
	`sdsTe¡
(
¬gc
, *
¬gv
[]);

	@src/sdsalloc.h

39 
	~"zm®loc.h
"

40 
	#s_m®loc
 
zm®loc


	)

41 
	#s_»®loc
 
z»®loc


	)

42 
	#s_ä“
 
zä“


	)

	@src/sentinel.c

31 
	~"£rv”.h
"

32 
	~"hœedis.h
"

33 
	~"async.h
"

35 
	~<ùy³.h
>

36 
	~<¬·/š‘.h
>

37 
	~<sys/sock‘.h
>

38 
	~<sys/wa™.h
>

39 
	~<fú.h
>

41 **
’vœÚ
;

43 
	#REDIS_SENTINEL_PORT
 26379

	)

48 
	s£Áš–Addr
 {

49 *
	m
;

50 
	mpÜt
;

51 } 
	t£Áš–Addr
;

54 
	#SRI_MASTER
 (1<<0)

	)

55 
	#SRI_SLAVE
 (1<<1)

	)

56 
	#SRI_SENTINEL
 (1<<2)

	)

57 
	#SRI_S_DOWN
 (1<<3è

	)

58 
	#SRI_O_DOWN
 (1<<4è

	)

59 
	#SRI_MASTER_DOWN
 (1<<5è

	)

61 
	#SRI_FAILOVER_IN_PROGRESS
 (1<<6è

	)

63 
	#SRI_PROMOTED
 (1<<7è

	)

64 
	#SRI_RECONF_SENT
 (1<<8è

	)

65 
	#SRI_RECONF_INPROG
 (1<<9è

	)

66 
	#SRI_RECONF_DONE
 (1<<10è

	)

67 
	#SRI_FORCE_FAILOVER
 (1<<11è

	)

68 
	#SRI_SCRIPT_KILL_SENT
 (1<<12è

	)

71 
	#SENTINEL_INFO_PERIOD
 10000

	)

72 
	#SENTINEL_PING_PERIOD
 1000

	)

73 
	#SENTINEL_ASK_PERIOD
 1000

	)

74 
	#SENTINEL_PUBLISH_PERIOD
 2000

	)

75 
	#SENTINEL_DEFAULT_DOWN_AFTER
 30000

	)

76 
	#SENTINEL_HELLO_CHANNEL
 "__£Áš–__:h–lo"

	)

77 
	#SENTINEL_TILT_TRIGGER
 2000

	)

78 
	#SENTINEL_TILT_PERIOD
 (
SENTINEL_PING_PERIOD
*30)

	)

79 
	#SENTINEL_DEFAULT_SLAVE_PRIORITY
 100

	)

80 
	#SENTINEL_SLAVE_RECONF_TIMEOUT
 10000

	)

81 
	#SENTINEL_DEFAULT_PARALLEL_SYNCS
 1

	)

82 
	#SENTINEL_MIN_LINK_RECONNECT_PERIOD
 15000

	)

83 
	#SENTINEL_DEFAULT_FAILOVER_TIMEOUT
 (60*3*1000)

	)

84 
	#SENTINEL_MAX_PENDING_COMMANDS
 100

	)

85 
	#SENTINEL_ELECTION_TIMEOUT
 10000

	)

86 
	#SENTINEL_MAX_DESYNC
 1000

	)

89 
	#SENTINEL_FAILOVER_STATE_NONE
 0

	)

90 
	#SENTINEL_FAILOVER_STATE_WAIT_START
 1

	)

91 
	#SENTINEL_FAILOVER_STATE_SELECT_SLAVE
 2

	)

92 
	#SENTINEL_FAILOVER_STATE_SEND_SLAVEOF_NOONE
 3

	)

93 
	#SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
 4

	)

94 
	#SENTINEL_FAILOVER_STATE_RECONF_SLAVES
 5

	)

95 
	#SENTINEL_FAILOVER_STATE_UPDATE_CONFIG
 6

	)

97 
	#SENTINEL_MASTER_LINK_STATUS_UP
 0

	)

98 
	#SENTINEL_MASTER_LINK_STATUS_DOWN
 1

	)

103 
	#SENTINEL_NO_FLAGS
 0

	)

104 
	#SENTINEL_GENERATE_EVENT
 (1<<16)

	)

105 
	#SENTINEL_LEADER
 (1<<17)

	)

106 
	#SENTINEL_OBSERVER
 (1<<18)

	)

109 
	#SENTINEL_SCRIPT_NONE
 0

	)

110 
	#SENTINEL_SCRIPT_RUNNING
 1

	)

111 
	#SENTINEL_SCRIPT_MAX_QUEUE
 256

	)

112 
	#SENTINEL_SCRIPT_MAX_RUNNING
 16

	)

113 
	#SENTINEL_SCRIPT_MAX_RUNTIME
 60000

	)

114 
	#SENTINEL_SCRIPT_MAX_RETRY
 10

	)

115 
	#SENTINEL_SCRIPT_RETRY_DELAY
 30000

	)

118 
	#SENTINEL_SIMFAILURE_NONE
 0

	)

119 
	#SENTINEL_SIMFAILURE_CRASH_AFTER_ELECTION
 (1<<0)

	)

120 
	#SENTINEL_SIMFAILURE_CRASH_AFTER_PROMOTION
 (1<<1)

	)

136 
	sš¡ªûLšk
 {

137 
	m»fcouÁ
;

138 
	mdiscÚÃùed
;

139 
	m³ndšg_commªds
;

140 
»disAsyncCÚ‹xt
 *
	mcc
;

141 
»disAsyncCÚ‹xt
 *
	mpc
;

142 
m¡ime_t
 
	mcc_cÚn_time
;

143 
m¡ime_t
 
	mpc_cÚn_time
;

144 
m¡ime_t
 
	mpc_Ï¡_aùiv™y
;

145 
m¡ime_t
 
	mÏ¡_ava_time
;

147 
m¡ime_t
 
	maù_pšg_time
;

152 
m¡ime_t
 
	mÏ¡_pšg_time
;

156 
m¡ime_t
 
	mÏ¡_pÚg_time
;

159 
m¡ime_t
 
	mÏ¡_»cÚn_time
;

161 } 
	tš¡ªûLšk
;

163 
	s£Áš–RedisIn¡ªû
 {

164 
	mæags
;

165 *
	mÇme
;

166 *
	mrunid
;

167 
ušt64_t
 
	mcÚfig_•och
;

168 
£Áš–Addr
 *
	maddr
;

169 
š¡ªûLšk
 *
	mlšk
;

170 
m¡ime_t
 
	mÏ¡_pub_time
;

171 
m¡ime_t
 
	mÏ¡_h–lo_time
;

174 
m¡ime_t
 
	mÏ¡_ma¡”_down_»¶y_time
;

176 
m¡ime_t
 
	ms_down_sšû_time
;

177 
m¡ime_t
 
	mo_down_sšû_time
;

178 
m¡ime_t
 
	mdown_aá”_³riod
;

179 
m¡ime_t
 
	mšfo_»äesh
;

186 
	mrŞe_»pÜ‹d
;

187 
m¡ime_t
 
	mrŞe_»pÜ‹d_time
;

188 
m¡ime_t
 
	m¦ave_cÚf_chªge_time
;

191 
diù
 *
	m£Áš–s
;

192 
diù
 *
	m¦aves
;

193 
	mquÜum
;

194 
	m·¿Î–_syncs
;

195 *
	mauth_·ss
;

198 
m¡ime_t
 
	mma¡”_lšk_down_time
;

199 
	m¦ave_´iÜ™y
;

200 
m¡ime_t
 
	m¦ave_»cÚf_£Á_time
;

201 
£Áš–RedisIn¡ªû
 *
	mma¡”
;

202 *
	m¦ave_ma¡”_ho¡
;

203 
	m¦ave_ma¡”_pÜt
;

204 
	m¦ave_ma¡”_lšk_¡©us
;

205 
	m¦ave_»¶_off£t
;

207 *
	mËad”
;

211 
ušt64_t
 
	mËad”_•och
;

212 
ušt64_t
 
	mçov”_•och
;

213 
	mçov”_¡©e
;

214 
m¡ime_t
 
	mçov”_¡©e_chªge_time
;

215 
m¡ime_t
 
	mçov”_¡¬t_time
;

216 
m¡ime_t
 
	mçov”_timeout
;

217 
m¡ime_t
 
	mçov”_d–ay_logged
;

219 
£Áš–RedisIn¡ªû
 *
	m´omÙed_¦ave
;

222 *
	mnÙifiÿtiÚ_süt
;

223 *
	mş›Á_»cÚfig_süt
;

224 
sds
 
	mšfo
;

225 } 
	t£Áš–RedisIn¡ªû
;

228 
	s£Áš–S‹
 {

229 
	mmyid
[
CONFIG_RUN_ID_SIZE
+1];

230 
ušt64_t
 
	mcu¼’t_•och
;

231 
diù
 *
	mma¡”s
;

234 
	mtt
;

235 
	mruÂšg_süts
;

236 
m¡ime_t
 
	mtt_¡¬t_time
;

237 
m¡ime_t
 
	m´evious_time
;

238 
li¡
 *
	msüts_queue
;

239 *
	mªnounû_
;

241 
	mªnounû_pÜt
;

243 
	msimçu»_æags
;

244 } 
	g£Áš–
;

247 
	s£Áš–SütJob
 {

248 
	mæags
;

249 
	m»Œy_num
;

250 **
	m¬gv
;

251 
m¡ime_t
 
	m¡¬t_time
;

256 
pid_t
 
	mpid
;

257 } 
	t£Áš–SütJob
;

264 
	s»disAeEv’ts
 {

265 
»disAsyncCÚ‹xt
 *
	mcÚ‹xt
;

266 
«Ev’tLoİ
 *
	mloİ
;

267 
	mfd
;

268 
	m»adšg
, 
	mwr™šg
;

269 } 
	t»disAeEv’ts
;

271 
	$»disAeR—dEv’t
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

272 (()
–
); (()
fd
); (()
mask
);

274 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

275 
	`»disAsyncHªdËR—d
(
e
->
cÚ‹xt
);

276 
	}
}

278 
	$»disAeWr™eEv’t
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
) {

279 (()
–
); (()
fd
); (()
mask
);

281 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

282 
	`»disAsyncHªdËWr™e
(
e
->
cÚ‹xt
);

283 
	}
}

285 
	$»disAeAddR—d
(*
´ivd©a
) {

286 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

287 
«Ev’tLoİ
 *
loİ
 = 
e
->loop;

288 ià(!
e
->
»adšg
) {

289 
e
->
»adšg
 = 1;

290 
	`«C»©eFeEv’t
(
loİ
,
e
->
fd
,
AE_READABLE
,
»disAeR—dEv’t
,e);

292 
	}
}

294 
	$»disAeD–R—d
(*
´ivd©a
) {

295 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

296 
«Ev’tLoİ
 *
loİ
 = 
e
->loop;

297 ià(
e
->
»adšg
) {

298 
e
->
»adšg
 = 0;

299 
	`«D–‘eFeEv’t
(
loİ
,
e
->
fd
,
AE_READABLE
);

301 
	}
}

303 
	$»disAeAddWr™e
(*
´ivd©a
) {

304 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

305 
«Ev’tLoİ
 *
loİ
 = 
e
->loop;

306 ià(!
e
->
wr™šg
) {

307 
e
->
wr™šg
 = 1;

308 
	`«C»©eFeEv’t
(
loİ
,
e
->
fd
,
AE_WRITABLE
,
»disAeWr™eEv’t
,e);

310 
	}
}

312 
	$»disAeD–Wr™e
(*
´ivd©a
) {

313 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

314 
«Ev’tLoİ
 *
loİ
 = 
e
->loop;

315 ià(
e
->
wr™šg
) {

316 
e
->
wr™šg
 = 0;

317 
	`«D–‘eFeEv’t
(
loİ
,
e
->
fd
,
AE_WRITABLE
);

319 
	}
}

321 
	$»disAeCËªup
(*
´ivd©a
) {

322 
»disAeEv’ts
 *
e
 = (»disAeEv’ts*)
´ivd©a
;

323 
	`»disAeD–R—d
(
´ivd©a
);

324 
	`»disAeD–Wr™e
(
´ivd©a
);

325 
	`zä“
(
e
);

326 
	}
}

328 
	$»disAeA‰ach
(
«Ev’tLoİ
 *
loİ
, 
»disAsyncCÚ‹xt
 *
ac
) {

329 
»disCÚ‹xt
 *
c
 = &(
ac
->c);

330 
»disAeEv’ts
 *
e
;

333 ià(
ac
->
ev
.
d©a
 !ğ
NULL
)

334  
C_ERR
;

337 
e
 = (
»disAeEv’ts
*)
	`zm®loc
((*e));

338 
e
->
cÚ‹xt
 = 
ac
;

339 
e
->
loİ
 =†oop;

340 
e
->
fd
 = 
c
->fd;

341 
e
->
»adšg
 =ƒ->
wr™šg
 = 0;

344 
ac
->
ev
.
addR—d
 = 
»disAeAddR—d
;

345 
ac
->
ev
.
d–R—d
 = 
»disAeD–R—d
;

346 
ac
->
ev
.
addWr™e
 = 
»disAeAddWr™e
;

347 
ac
->
ev
.
d–Wr™e
 = 
»disAeD–Wr™e
;

348 
ac
->
ev
.
ş—nup
 = 
»disAeCËªup
;

349 
ac
->
ev
.
d©a
 = 
e
;

351  
C_OK
;

352 
	}
}

356 
£Áš–LškE¡ablishedC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
);

357 
£Áš–DiscÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
);

358 
£Áš–ReûiveH–loMes§ges
(
»disAsyncCÚ‹xt
 *
c
, *
»¶y
, *
´ivd©a
);

359 
£Áš–RedisIn¡ªû
 *
£Áš–G‘Ma¡”ByName
(*
Çme
);

360 *
£Áš–G‘SubjeùiveL—d”
(
£Áš–RedisIn¡ªû
 *
ma¡”
);

361 *
£Áš–G‘ObjeùiveL—d”
(
£Áš–RedisIn¡ªû
 *
ma¡”
);

362 
ye¢Ùoi
(*
s
);

363 
š¡ªûLškCÚÃùiÚE¼Ü
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
);

364 cÚ¡ *
£Áš–RedisIn¡ªûTy³SŒ
(
£Áš–RedisIn¡ªû
 *
ri
);

365 
£Áš–AbÜtFaov”
(
£Áš–RedisIn¡ªû
 *
ri
);

366 
£Áš–Ev’t
(
Ëv–
, *
ty³
, 
£Áš–RedisIn¡ªû
 *
ri
, cÚ¡ *
fmt
, ...);

367 
£Áš–RedisIn¡ªû
 *
£Áš–S–eùSÏve
(£Áš–RedisIn¡ªû *
ma¡”
);

368 
£Áš–ScheduËSütExecutiÚ
(*
·th
, ...);

369 
£Áš–S¹Faov”
(
£Áš–RedisIn¡ªû
 *
ma¡”
);

370 
£Áš–DisÿrdR•lyC®lback
(
»disAsyncCÚ‹xt
 *
c
, *
»¶y
, *
´ivd©a
);

371 
£Áš–S’dSÏveOf
(
£Áš–RedisIn¡ªû
 *
ri
, *
ho¡
, 
pÜt
);

372 *
£Áš–VÙeL—d”
(
£Áš–RedisIn¡ªû
 *
ma¡”
, 
ušt64_t
 
»q_•och
, *
»q_runid
, ušt64_ˆ*
Ëad”_•och
);

373 
£Áš–FlushCÚfig
();

374 
£Áš–G’”©eIn™ŸlMÚ™ÜEv’ts
();

375 
£Áš–S’dPšg
(
£Áš–RedisIn¡ªû
 *
ri
);

376 
£Áš–FÜûH–loUpd©eFÜMa¡”
(
£Áš–RedisIn¡ªû
 *
ma¡”
);

377 
£Áš–RedisIn¡ªû
 *
g‘S’tš–RedisIn¡ªûByAddrAndRunID
(
diù
 *
š¡ªûs
, *

, 
pÜt
, *
runid
);

378 
£Áš–SimFau»C¿sh
();

382 
diùSdsHash
(cÚ¡ *
key
);

383 
diùSdsKeyCom·»
(*
´ivd©a
, cÚ¡ *
key1
, cÚ¡ *
key2
);

384 
»Ëa£S’tš–RedisIn¡ªû
(
£Áš–RedisIn¡ªû
 *
ri
);

386 
	$diùIn¡ªûsV®De¡ruùÜ
 (*
´ivd©a
, *
obj
) {

387 
	`UNUSED
(
´ivd©a
);

388 
	`»Ëa£S’tš–RedisIn¡ªû
(
obj
);

389 
	}
}

395 
diùTy³
 
	gš¡ªûsDiùTy³
 = {

396 
diùSdsHash
,

397 
NULL
,

398 
NULL
,

399 
diùSdsKeyCom·»
,

400 
NULL
,

401 
diùIn¡ªûsV®De¡ruùÜ


408 
diùTy³
 
	gËad”VÙesDiùTy³
 = {

409 
diùSdsHash
,

410 
NULL
,

411 
NULL
,

412 
diùSdsKeyCom·»
,

413 
NULL
,

414 
NULL


419 
£Áš–Commªd
(
ş›Á
 *
c
);

420 
£Áš–InfoCommªd
(
ş›Á
 *
c
);

421 
£Áš–S‘Commªd
(
ş›Á
 *
c
);

422 
£Áš–PublishCommªd
(
ş›Á
 *
c
);

423 
£Áš–RŞeCommªd
(
ş›Á
 *
c
);

425 
»disCommªd
 
	g£Áš–cmds
[] = {

426 {"pšg",
pšgCommªd
,1,"",0,
NULL
,0,0,0,0,0},

427 {"£Áš–",
£Áš–Commªd
,-2,"",0,
NULL
,0,0,0,0,0},

428 {"subsüibe",
subsüibeCommªd
,-2,"",0,
NULL
,0,0,0,0,0},

429 {"unsubsüibe",
unsubsüibeCommªd
,-1,"",0,
NULL
,0,0,0,0,0},

430 {"psubsüibe",
psubsüibeCommªd
,-2,"",0,
NULL
,0,0,0,0,0},

431 {"punsubsüibe",
punsubsüibeCommªd
,-1,"",0,
NULL
,0,0,0,0,0},

432 {"publish",
£Áš–PublishCommªd
,3,"",0,
NULL
,0,0,0,0,0},

433 {"šfo",
£Áš–InfoCommªd
,-1,"",0,
NULL
,0,0,0,0,0},

434 {"rŞe",
£Áš–RŞeCommªd
,1,"l",0,
NULL
,0,0,0,0,0},

435 {"ş›Á",
ş›ÁCommªd
,-2,"rs",0,
NULL
,0,0,0,0,0},

436 {"shutdown",
shutdownCommªd
,-1,"",0,
NULL
,0,0,0,0,0}

441 
	$š™S’tš–CÚfig
() {

442 
£rv”
.
pÜt
 = 
REDIS_SENTINEL_PORT
;

443 
	}
}

446 
	$š™S’tš–
() {

447 
j
;

451 
	`diùEm±y
(
£rv”
.
commªds
,
NULL
);

452 
j
 = 0; j < (
£Áš–cmds
)/(sentinelcmds[0]); j++) {

453 
»tv®
;

454 
»disCommªd
 *
cmd
 = 
£Áš–cmds
+
j
;

456 
»tv®
 = 
	`diùAdd
(
£rv”
.
commªds
, 
	`sd¢ew
(
cmd
->
Çme
), cmd);

457 
	`£rv”As£¹
(
»tv®
 =ğ
DICT_OK
);

461 
£Áš–
.
cu¼’t_•och
 = 0;

462 
£Áš–
.
ma¡”s
 = 
	`diùC»©e
(&
š¡ªûsDiùTy³
,
NULL
);

463 
£Áš–
.
tt
 = 0;

464 
£Áš–
.
tt_¡¬t_time
 = 0;

465 
£Áš–
.
´evious_time
 = 
	`m¡ime
();

466 
£Áš–
.
ruÂšg_süts
 = 0;

467 
£Áš–
.
süts_queue
 = 
	`li¡C»©e
();

468 
£Áš–
.
ªnounû_
 = 
NULL
;

469 
£Áš–
.
ªnounû_pÜt
 = 0;

470 
£Áš–
.
simçu»_æags
 = 
SENTINEL_SIMFAILURE_NONE
;

471 
	`mem£t
(
£Áš–
.
myid
,0,(sentinel.myid));

472 
	}
}

476 
	$£Áš–IsRuÂšg
() {

477 
j
;

479 ià(
£rv”
.
cÚfigfe
 =ğ
NULL
) {

480 
	`£rv”Log
(
LL_WARNING
,

482 
	`ex™
(1);

483 } ià(
	`acûss
(
£rv”
.
cÚfigfe
,
W_OK
) == -1) {

484 
	`£rv”Log
(
LL_WARNING
,

486 
£rv”
.
cÚfigfe
,
	`¡»¼Ü
(
”ºo
));

487 
	`ex™
(1);

493 
j
 = 0; j < 
CONFIG_RUN_ID_SIZE
; j++)

494 ià(
£Áš–
.
myid
[
j
] != 0) ;

496 ià(
j
 =ğ
CONFIG_RUN_ID_SIZE
) {

498 
	`g‘RªdomHexCh¬s
(
£Áš–
.
myid
,
CONFIG_RUN_ID_SIZE
);

499 
	`£Áš–FlushCÚfig
();

503 
	`£rv”Log
(
LL_WARNING
,"S’tš– ID i %s", 
£Áš–
.
myid
);

507 
	`£Áš–G’”©eIn™ŸlMÚ™ÜEv’ts
();

508 
	}
}

517 
£Áš–Addr
 *
	$ü—‹S’tš–Addr
(*
ho¡Çme
, 
pÜt
) {

518 

[
NET_IP_STR_LEN
];

519 
£Áš–Addr
 *
§
;

521 ià(
pÜt
 < 0 ||…ort > 65535) {

522 
”ºo
 = 
EINVAL
;

523  
NULL
;

525 ià(
	`ª‘ResŞve
(
NULL
,
ho¡Çme
,

,()è=ğ
ANET_ERR
) {

526 
”ºo
 = 
ENOENT
;

527  
NULL
;

529 
§
 = 
	`zm®loc
((*sa));

530 
§
->

 = 
	`sd¢ew
(ip);

531 
§
->
pÜt
 =…ort;

532  
§
;

533 
	}
}

536 
£Áš–Addr
 *
	$dupS’tš–Addr
(
£Áš–Addr
 *
¤c
) {

537 
£Áš–Addr
 *
§
;

539 
§
 = 
	`zm®loc
((*sa));

540 
§
->

 = 
	`sd¢ew
(
¤c
->ip);

541 
§
->
pÜt
 = 
¤c
->port;

542  
§
;

543 
	}
}

546 
	$»Ëa£S’tš–Addr
(
£Áš–Addr
 *
§
) {

547 
	`sdsä“
(
§
->

);

548 
	`zä“
(
§
);

549 
	}
}

552 
	$£Áš–AddrIsEqu®
(
£Áš–Addr
 *
a
, s’tš–Add¸*
b
) {

553  
a
->
pÜt
 =ğ
b
->pÜˆ&& !
	`¡rÿ£cmp
×->

,b->ip);

554 
	}
}

582 
	$£Áš–Ev’t
(
Ëv–
, *
ty³
, 
£Áš–RedisIn¡ªû
 *
ri
,

583 cÚ¡ *
fmt
, ...) {

584 
va_li¡
 
­
;

585 
msg
[
LOG_MAX_LEN
];

586 
robj
 *
chªÃl
, *
·ylßd
;

589 ià(
fmt
[0] == '%' && fmt[1] == '@') {

590 
£Áš–RedisIn¡ªû
 *
ma¡”
 = (
ri
->
æags
 & 
SRI_MASTER
) ?

591 
NULL
 : 
ri
->
ma¡”
;

593 ià(
ma¡”
) {

594 
	`¢´štf
(
msg
, (msg), "%s %s %s %d @ %s %s %d",

595 
	`£Áš–RedisIn¡ªûTy³SŒ
(
ri
),

596 
ri
->
Çme
,„i->
addr
->

,„i->addr->
pÜt
,

597 
ma¡”
->
Çme
, ma¡”->
addr
->

, ma¡”->addr->
pÜt
);

599 
	`¢´štf
(
msg
, (msg), "%s %s %s %d",

600 
	`£Áš–RedisIn¡ªûTy³SŒ
(
ri
),

601 
ri
->
Çme
,„i->
addr
->

,„i->addr->
pÜt
);

603 
fmt
 += 2;

605 
msg
[0] = '\0';

609 ià(
fmt
[0] != '\0') {

610 
	`va_¡¬t
(
­
, 
fmt
);

611 
	`v¢´štf
(
msg
+
	`¡¾’
(msg), (msg)-¡¾’(msg), 
fmt
, 
­
);

612 
	`va_’d
(
­
);

616 ià(
Ëv–
 >ğ
£rv”
.
v”bos™y
)

617 
	`£rv”Log
(
Ëv–
,"% %s",
ty³
,
msg
);

620 ià(
Ëv–
 !ğ
LL_DEBUG
) {

621 
chªÃl
 = 
	`ü—‹SŒšgObjeù
(
ty³
,
	`¡¾’
(type));

622 
·ylßd
 = 
	`ü—‹SŒšgObjeù
(
msg
,
	`¡¾’
(msg));

623 
	`pubsubPublishMes§ge
(
chªÃl
,
·ylßd
);

624 
	`deüRefCouÁ
(
chªÃl
);

625 
	`deüRefCouÁ
(
·ylßd
);

629 ià(
Ëv–
 =ğ
LL_WARNING
 && 
ri
 !ğ
NULL
) {

630 
£Áš–RedisIn¡ªû
 *
ma¡”
 = (
ri
->
æags
 & 
SRI_MASTER
) ?

631 
ri
 :„i->
ma¡”
;

632 ià(
ma¡”
 && ma¡”->
nÙifiÿtiÚ_süt
) {

633 
	`£Áš–ScheduËSütExecutiÚ
(
ma¡”
->
nÙifiÿtiÚ_süt
,

634 
ty³
,
msg
,
NULL
);

637 
	}
}

643 
	$£Áš–G’”©eIn™ŸlMÚ™ÜEv’ts
() {

644 
diùI‹¿tÜ
 *
di
;

645 
diùEÁry
 *
de
;

647 
di
 = 
	`diùG‘I‹¿tÜ
(
£Áš–
.
ma¡”s
);

648 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

649 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

650 
	`£Áš–Ev’t
(
LL_WARNING
,"+mÚ™Ü",
ri
,"%@ quÜum %d",ri->
quÜum
);

652 
	`diùR–—£I‹¿tÜ
(
di
);

653 
	}
}

658 
	$£Áš–R–—£SütJob
(
£Áš–SütJob
 *
sj
) {

659 
j
 = 0;

661 
sj
->
¬gv
[
j
]è
	`sdsä“
(sj->argv[j++]);

662 
	`zä“
(
sj
->
¬gv
);

663 
	`zä“
(
sj
);

664 
	}
}

666 
	#SENTINEL_SCRIPT_MAX_ARGS
 16

	)

667 
	$£Áš–ScheduËSütExecutiÚ
(*
·th
, ...) {

668 
va_li¡
 
­
;

669 *
¬gv
[
SENTINEL_SCRIPT_MAX_ARGS
+1];

670 
¬gc
 = 1;

671 
£Áš–SütJob
 *
sj
;

673 
	`va_¡¬t
(
­
, 
·th
);

674 
¬gc
 < 
SENTINEL_SCRIPT_MAX_ARGS
) {

675 
¬gv
[
¬gc
] = 
	`va_¬g
(
­
,*);

676 ià(!
¬gv
[
¬gc
]) ;

677 
¬gv
[
¬gc
] = 
	`sd¢ew
(argv[argc]);

678 
¬gc
++;

680 
	`va_’d
(
­
);

681 
¬gv
[0] = 
	`sd¢ew
(
·th
);

683 
sj
 = 
	`zm®loc
((*sj));

684 
sj
->
æags
 = 
SENTINEL_SCRIPT_NONE
;

685 
sj
->
»Œy_num
 = 0;

686 
sj
->
¬gv
 = 
	`zm®loc
((*)*(
¬gc
+1));

687 
sj
->
¡¬t_time
 = 0;

688 
sj
->
pid
 = 0;

689 
	`memıy
(
sj
->
¬gv
,¬gv,(*)*(
¬gc
+1));

691 
	`li¡AddNodeTa
(
£Áš–
.
süts_queue
,
sj
);

694 ià(
	`li¡L’gth
(
£Áš–
.
süts_queue
è> 
SENTINEL_SCRIPT_MAX_QUEUE
) {

695 
li¡Node
 *
Ê
;

696 
li¡I‹r
 
li
;

698 
	`li¡Rewšd
(
£Áš–
.
süts_queue
,&
li
);

699 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

700 
sj
 = 
Ê
->
v®ue
;

702 ià(
sj
->
æags
 & 
SENTINEL_SCRIPT_RUNNING
) ;

704 
	`li¡D–Node
(
£Áš–
.
süts_queue
,
Ê
);

705 
	`£Áš–R–—£SütJob
(
sj
);

708 
	`£rv”As£¹
(
	`li¡L’gth
(
£Áš–
.
süts_queue
) <=

709 
SENTINEL_SCRIPT_MAX_QUEUE
);

711 
	}
}

715 
li¡Node
 *
	$£Áš–G‘SütLi¡NodeByPid
(
pid_t
 
pid
) {

716 
li¡Node
 *
Ê
;

717 
li¡I‹r
 
li
;

719 
	`li¡Rewšd
(
£Áš–
.
süts_queue
,&
li
);

720 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

721 
£Áš–SütJob
 *
sj
 = 
Ê
->
v®ue
;

723 ià((
sj
->
æags
 & 
SENTINEL_SCRIPT_RUNNING
è&& sj->
pid
 ==…id)

724  
Ê
;

726  
NULL
;

727 
	}
}

731 
	$£Áš–RunP’dšgSüts
() {

732 
li¡Node
 *
Ê
;

733 
li¡I‹r
 
li
;

734 
m¡ime_t
 
now
 = 
	`m¡ime
();

738 
	`li¡Rewšd
(
£Áš–
.
süts_queue
,&
li
);

739 
£Áš–
.
ruÂšg_süts
 < 
SENTINEL_SCRIPT_MAX_RUNNING
 &&

740 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
)

742 
£Áš–SütJob
 *
sj
 = 
Ê
->
v®ue
;

743 
pid_t
 
pid
;

746 ià(
sj
->
æags
 & 
SENTINEL_SCRIPT_RUNNING
) ;

749 ià(
sj
->
¡¬t_time
 && sj->¡¬t_tim> 
now
) ;

751 
sj
->
æags
 |ğ
SENTINEL_SCRIPT_RUNNING
;

752 
sj
->
¡¬t_time
 = 
	`m¡ime
();

753 
sj
->
»Œy_num
++;

754 
pid
 = 
	`fÜk
();

756 ià(
pid
 == -1) {

760 
	`£Áš–Ev’t
(
LL_WARNING
,"-süt-”rÜ",
NULL
,

761 "% %d %d", 
sj
->
¬gv
[0], 99, 0);

762 
sj
->
æags
 &ğ~
SENTINEL_SCRIPT_RUNNING
;

763 
sj
->
pid
 = 0;

764 } ià(
pid
 == 0) {

766 
	`execve
(
sj
->
¬gv
[0],sj->¬gv,
’vœÚ
);

768 
	`_ex™
(2);

770 
£Áš–
.
ruÂšg_süts
++;

771 
sj
->
pid
 =…id;

772 
	`£Áš–Ev’t
(
LL_DEBUG
,"+süt-chd",
NULL
,"%ld",()
pid
);

775 
	}
}

784 
m¡ime_t
 
	$£Áš–SütR‘ryD–ay
(
»Œy_num
) {

785 
m¡ime_t
 
d–ay
 = 
SENTINEL_SCRIPT_RETRY_DELAY
;

787 
»Œy_num
-- > 1è
d–ay
 *= 2;

788  
d–ay
;

789 
	}
}

795 
	$£Áš–CŞËùT”mš©edSüts
() {

796 
¡©loc
;

797 
pid_t
 
pid
;

799 (
pid
 = 
	`wa™3
(&
¡©loc
,
WNOHANG
,
NULL
)) > 0) {

800 
ex™code
 = 
	`WEXITSTATUS
(
¡©loc
);

801 
bysigÇl
 = 0;

802 
li¡Node
 *
Ê
;

803 
£Áš–SütJob
 *
sj
;

805 ià(
	`WIFSIGNALED
(
¡©loc
)è
bysigÇl
 = 
	`WTERMSIG
(statloc);

806 
	`£Áš–Ev’t
(
LL_DEBUG
,"-süt-chd",
NULL
,"%ld %d %d",

807 ()
pid
, 
ex™code
, 
bysigÇl
);

809 
Ê
 = 
	`£Áš–G‘SütLi¡NodeByPid
(
pid
);

810 ià(
Ê
 =ğ
NULL
) {

811 
	`£rv”Log
(
LL_WARNING
,"wa™3(è»tuºed‡…id (%ldèwÿn'ˆfšd iÀou¸süt executiÚ queue!", ()
pid
);

814 
sj
 = 
Ê
->
v®ue
;

819 ià((
bysigÇl
 || 
ex™code
 == 1) &&

820 
sj
->
»Œy_num
 !ğ
SENTINEL_SCRIPT_MAX_RETRY
)

822 
sj
->
æags
 &ğ~
SENTINEL_SCRIPT_RUNNING
;

823 
sj
->
pid
 = 0;

824 
sj
->
¡¬t_time
 = 
	`m¡ime
() +

825 
	`£Áš–SütR‘ryD–ay
(
sj
->
»Œy_num
);

829 ià(
bysigÇl
 || 
ex™code
 != 0) {

830 
	`£Áš–Ev’t
(
LL_WARNING
,"-süt-”rÜ",
NULL
,

831 "% %d %d", 
sj
->
¬gv
[0], 
bysigÇl
, 
ex™code
);

833 
	`li¡D–Node
(
£Áš–
.
süts_queue
,
Ê
);

834 
	`£Áš–R–—£SütJob
(
sj
);

835 
£Áš–
.
ruÂšg_süts
--;

838 
	}
}

842 
	$£Áš–KlTimedoutSüts
() {

843 
li¡Node
 *
Ê
;

844 
li¡I‹r
 
li
;

845 
m¡ime_t
 
now
 = 
	`m¡ime
();

847 
	`li¡Rewšd
(
£Áš–
.
süts_queue
,&
li
);

848 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

849 
£Áš–SütJob
 *
sj
 = 
Ê
->
v®ue
;

851 ià(
sj
->
æags
 & 
SENTINEL_SCRIPT_RUNNING
 &&

852 (
now
 - 
sj
->
¡¬t_time
è> 
SENTINEL_SCRIPT_MAX_RUNTIME
)

854 
	`£Áš–Ev’t
(
LL_WARNING
,"-süt-timeout",
NULL
,"%s %ld",

855 
sj
->
¬gv
[0], ()sj->
pid
);

856 
	`kl
(
sj
->
pid
,
SIGKILL
);

859 
	}
}

862 
	$£Áš–P’dšgSütsCommªd
(
ş›Á
 *
c
) {

863 
li¡Node
 *
Ê
;

864 
li¡I‹r
 
li
;

866 
	`addR•lyMuÉiBulkL’
(
c
,
	`li¡L’gth
(
£Áš–
.
süts_queue
));

867 
	`li¡Rewšd
(
£Áš–
.
süts_queue
,&
li
);

868 (
Ê
 = 
	`li¡Next
(&
li
)è!ğ
NULL
) {

869 
£Áš–SütJob
 *
sj
 = 
Ê
->
v®ue
;

870 
j
 = 0;

872 
	`addR•lyMuÉiBulkL’
(
c
,10);

874 
	`addR•lyBulkCSŒšg
(
c
,"argv");

875 
sj
->
¬gv
[
j
]) j++;

876 
	`addR•lyMuÉiBulkL’
(
c
,
j
);

877 
j
 = 0;

878 
sj
->
¬gv
[
j
]è
	`addR•lyBulkCSŒšg
(
c
,sj->argv[j++]);

880 
	`addR•lyBulkCSŒšg
(
c
,"flags");

881 
	`addR•lyBulkCSŒšg
(
c
,

882 (
sj
->
æags
 & 
SENTINEL_SCRIPT_RUNNING
) ? "running" : "scheduled");

884 
	`addR•lyBulkCSŒšg
(
c
,"pid");

885 
	`addR•lyBulkLÚgLÚg
(
c
,
sj
->
pid
);

887 ià(
sj
->
æags
 & 
SENTINEL_SCRIPT_RUNNING
) {

888 
	`addR•lyBulkCSŒšg
(
c
,"run-time");

889 
	`addR•lyBulkLÚgLÚg
(
c
,
	`m¡ime
(è- 
sj
->
¡¬t_time
);

891 
m¡ime_t
 
d–ay
 = 
sj
->
¡¬t_time
 ? (sj->¡¬t_time-
	`m¡ime
()) : 0;

892 ià(
d–ay
 < 0) delay = 0;

893 
	`addR•lyBulkCSŒšg
(
c
,"run-delay");

894 
	`addR•lyBulkLÚgLÚg
(
c
,
d–ay
);

897 
	`addR•lyBulkCSŒšg
(
c
,"retry-num");

898 
	`addR•lyBulkLÚgLÚg
(
c
,
sj
->
»Œy_num
);

900 
	}
}

914 
	$£Áš–C®lCl›ÁRecÚfSüt
(
£Áš–RedisIn¡ªû
 *
ma¡”
, 
rŞe
, *
¡©e
, 
£Áš–Addr
 *
äom
, s’tš–Add¸*
to
) {

915 
äompÜt
[32], 
tİÜt
[32];

917 ià(
ma¡”
->
ş›Á_»cÚfig_süt
 =ğ
NULL
) ;

918 
	`Î2¡ršg
(
äompÜt
,(äompÜt),
äom
->
pÜt
);

919 
	`Î2¡ršg
(
tİÜt
,ÑİÜt),
to
->
pÜt
);

920 
	`£Áš–ScheduËSütExecutiÚ
(
ma¡”
->
ş›Á_»cÚfig_süt
,

921 
ma¡”
->
Çme
,

922 (
rŞe
 =ğ
SENTINEL_LEADER
) ? "leader" : "observer",

923 
¡©e
, 
äom
->

, 
äompÜt
, 
to
->, 
tİÜt
, 
NULL
);

924 
	}
}

929 
š¡ªûLšk
 *
	$ü—‹In¡ªûLšk
() {

930 
š¡ªûLšk
 *
lšk
 = 
	`zm®loc
((*link));

932 
lšk
->
»fcouÁ
 = 1;

933 
lšk
->
discÚÃùed
 = 1;

934 
lšk
->
³ndšg_commªds
 = 0;

935 
lšk
->
cc
 = 
NULL
;

936 
lšk
->
pc
 = 
NULL
;

937 
lšk
->
cc_cÚn_time
 = 0;

938 
lšk
->
pc_cÚn_time
 = 0;

939 
lšk
->
Ï¡_»cÚn_time
 = 0;

940 
lšk
->
pc_Ï¡_aùiv™y
 = 0;

945 
lšk
->
aù_pšg_time
 = 
	`m¡ime
();

946 
lšk
->
Ï¡_pšg_time
 = 0;

947 
lšk
->
Ï¡_ava_time
 = 
	`m¡ime
();

948 
lšk
->
Ï¡_pÚg_time
 = 
	`m¡ime
();

949  
lšk
;

950 
	}
}

953 
	$š¡ªûLškClo£CÚÃùiÚ
(
š¡ªûLšk
 *
lšk
, 
»disAsyncCÚ‹xt
 *
c
) {

954 ià(
c
 =ğ
NULL
) ;

956 ià(
lšk
->
cc
 =ğ
c
) {

957 
lšk
->
cc
 = 
NULL
;

958 
lšk
->
³ndšg_commªds
 = 0;

960 ià(
lšk
->
pc
 =ğ
c
èlšk->pøğ
NULL
;

961 
c
->
d©a
 = 
NULL
;

962 
lšk
->
discÚÃùed
 = 1;

963 
	`»disAsyncF»e
(
c
);

964 
	}
}

974 
š¡ªûLšk
 *
	$»Ëa£In¡ªûLšk
(
š¡ªûLšk
 *
lšk
, 
£Áš–RedisIn¡ªû
 *
ri
)

976 
	`£rv”As£¹
(
lšk
->
»fcouÁ
 > 0);

977 
lšk
->
»fcouÁ
--;

978 ià(
lšk
->
»fcouÁ
 != 0) {

979 ià(
ri
 &&„i->
lšk
->
cc
) {

985 
»disC®lback
 *
cb
;

986 
»disC®lbackLi¡
 *
ÿÎbacks
 = &
lšk
->
cc
->
»¶›s
;

988 
cb
 = 
ÿÎbacks
->
h—d
;

989 
cb
) {

990 ià(
cb
->
´ivd©a
 =ğ
ri
) {

991 
cb
->
â
 = 
£Áš–DisÿrdR•lyC®lback
;

992 
cb
->
´ivd©a
 = 
NULL
;

994 
cb
 = cb->
Ãxt
;

997  
lšk
;

1000 
	`š¡ªûLškClo£CÚÃùiÚ
(
lšk
,lšk->
cc
);

1001 
	`š¡ªûLškClo£CÚÃùiÚ
(
lšk
,lšk->
pc
);

1002 
	`zä“
(
lšk
);

1003  
NULL
;

1004 
	}
}

1018 
	$£Áš–TryCÚÃùiÚSh¬šg
(
£Áš–RedisIn¡ªû
 *
ri
) {

1019 
	`£rv”As£¹
(
ri
->
æags
 & 
SRI_SENTINEL
);

1020 
diùI‹¿tÜ
 *
di
;

1021 
diùEÁry
 *
de
;

1023 ià(
ri
->
runid
 =ğ
NULL
è 
C_ERR
;

1024 ià(
ri
->
lšk
->
»fcouÁ
 > 1è 
C_ERR
;

1026 
di
 = 
	`diùG‘I‹¿tÜ
(
£Áš–
.
ma¡”s
);

1027 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1028 
£Áš–RedisIn¡ªû
 *
ma¡”
 = 
	`diùG‘V®
(
de
), *
m©ch
;

1031 ià(
ma¡”
 =ğ
ri
->master) ;

1032 
m©ch
 = 
	`g‘S’tš–RedisIn¡ªûByAddrAndRunID
(
ma¡”
->
£Áš–s
,

1033 
NULL
,0,
ri
->
runid
);

1034 ià(
m©ch
 =ğ
NULL
) ;

1035 ià(
m©ch
 =ğ
ri
) ;

1039 
	`»Ëa£In¡ªûLšk
(
ri
->
lšk
,
NULL
);

1040 
ri
->
lšk
 = 
m©ch
->link;

1041 
m©ch
->
lšk
->
»fcouÁ
++;

1042  
C_OK
;

1044 
	`diùR–—£I‹¿tÜ
(
di
);

1045  
C_ERR
;

1046 
	}
}

1054 
	$£Áš–Upd©eS’tš–Add»ssInAÎMa¡”s
(
£Áš–RedisIn¡ªû
 *
ri
) {

1055 
	`£rv”As£¹
(
ri
->
æags
 & 
SRI_SENTINEL
);

1056 
diùI‹¿tÜ
 *
di
;

1057 
diùEÁry
 *
de
;

1058 
»cÚfigu»d
 = 0;

1060 
di
 = 
	`diùG‘I‹¿tÜ
(
£Áš–
.
ma¡”s
);

1061 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1062 
£Áš–RedisIn¡ªû
 *
ma¡”
 = 
	`diùG‘V®
(
de
), *
m©ch
;

1063 
m©ch
 = 
	`g‘S’tš–RedisIn¡ªûByAddrAndRunID
(
ma¡”
->
£Áš–s
,

1064 
NULL
,0,
ri
->
runid
);

1067 ià(
m©ch
 =ğ
NULL
) ;

1070 ià(
m©ch
->
lšk
->
cc
 !ğ
NULL
)

1071 
	`š¡ªûLškClo£CÚÃùiÚ
(
m©ch
->
lšk
,m©ch->lšk->
cc
);

1072 ià(
m©ch
->
lšk
->
pc
 !ğ
NULL
)

1073 
	`š¡ªûLškClo£CÚÃùiÚ
(
m©ch
->
lšk
,m©ch->lšk->
pc
);

1075 ià(
m©ch
 =ğ
ri
) ;

1079 
	`»Ëa£S’tš–Addr
(
m©ch
->
addr
);

1080 
m©ch
->
addr
 = 
	`dupS’tš–Addr
(
ri
->addr);

1081 
»cÚfigu»d
++;

1083 
	`diùR–—£I‹¿tÜ
(
di
);

1084 ià(
»cÚfigu»d
)

1085 
	`£Áš–Ev’t
(
LL_NOTICE
,"+£Áš–-add»ss-upd©e", 
ri
,

1086 "%@ %d‡dd™iÚ® m©chšg in¡ªûs", 
»cÚfigu»d
);

1087  
»cÚfigu»d
;

1088 
	}
}

1096 
	$š¡ªûLškCÚÃùiÚE¼Ü
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
) {

1097 
š¡ªûLšk
 *
lšk
 = 
c
->
d©a
;

1098 
pubsub
;

1100 ià(!
lšk
) ;

1102 
pubsub
 = (
lšk
->
pc
 =ğ
c
);

1103 ià(
pubsub
)

1104 
lšk
->
pc
 = 
NULL
;

1106 
lšk
->
cc
 = 
NULL
;

1107 
lšk
->
discÚÃùed
 = 1;

1108 
	}
}

1112 
	$£Áš–LškE¡ablishedC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

1113 ià(
¡©us
 !ğ
C_OK
è
	`š¡ªûLškCÚÃùiÚE¼Ü
(
c
);

1114 
	}
}

1116 
	$£Áš–DiscÚÃùC®lback
(cÚ¡ 
»disAsyncCÚ‹xt
 *
c
, 
¡©us
) {

1117 
	`UNUSED
(
¡©us
);

1118 
	`š¡ªûLškCÚÃùiÚE¼Ü
(
c
);

1119 
	}
}

1145 
£Áš–RedisIn¡ªû
 *
	$ü—‹S’tš–RedisIn¡ªû
(*
Çme
, 
æags
, *
ho¡Çme
, 
pÜt
, 
quÜum
, 
£Áš–RedisIn¡ªû
 *
ma¡”
) {

1146 
£Áš–RedisIn¡ªû
 *
ri
;

1147 
£Áš–Addr
 *
addr
;

1148 
diù
 *
bË
 = 
NULL
;

1149 
¦av’ame
[
NET_PEER_ID_LEN
], *
sd¢ame
;

1151 
	`£rv”As£¹
(
æags
 & (
SRI_MASTER
|
SRI_SLAVE
|
SRI_SENTINEL
));

1152 
	`£rv”As£¹
((
æags
 & 
SRI_MASTER
è|| 
ma¡”
 !ğ
NULL
);

1155 
addr
 = 
	`ü—‹S’tš–Addr
(
ho¡Çme
,
pÜt
);

1156 ià(
addr
 =ğ
NULL
)  NULL;

1159 ià(
æags
 & 
SRI_SLAVE
) {

1160 
	`ª‘FÜm©Addr
(
¦av’ame
, (¦av’ame), 
ho¡Çme
, 
pÜt
);

1161 
Çme
 = 
¦av’ame
;

1168 ià(
æags
 & 
SRI_MASTER
è
bË
 = 
£Áš–
.
ma¡”s
;

1169 ià(
æags
 & 
SRI_SLAVE
è
bË
 = 
ma¡”
->
¦aves
;

1170 ià(
æags
 & 
SRI_SENTINEL
è
bË
 = 
ma¡”
->
£Áš–s
;

1171 
sd¢ame
 = 
	`sd¢ew
(
Çme
);

1172 ià(
	`diùFšd
(
bË
,
sd¢ame
)) {

1173 
	`»Ëa£S’tš–Addr
(
addr
);

1174 
	`sdsä“
(
sd¢ame
);

1175 
”ºo
 = 
EBUSY
;

1176  
NULL
;

1180 
ri
 = 
	`zm®loc
((*ri));

1183 
ri
->
æags
 = flags;

1184 
ri
->
Çme
 = 
sd¢ame
;

1185 
ri
->
runid
 = 
NULL
;

1186 
ri
->
cÚfig_•och
 = 0;

1187 
ri
->
addr
 =‡ddr;

1188 
ri
->
lšk
 = 
	`ü—‹In¡ªûLšk
();

1189 
ri
->
Ï¡_pub_time
 = 
	`m¡ime
();

1190 
ri
->
Ï¡_h–lo_time
 = 
	`m¡ime
();

1191 
ri
->
Ï¡_ma¡”_down_»¶y_time
 = 
	`m¡ime
();

1192 
ri
->
s_down_sšû_time
 = 0;

1193 
ri
->
o_down_sšû_time
 = 0;

1194 
ri
->
down_aá”_³riod
 = 
ma¡”
 ? master->down_after_period :

1195 
SENTINEL_DEFAULT_DOWN_AFTER
;

1196 
ri
->
ma¡”_lšk_down_time
 = 0;

1197 
ri
->
auth_·ss
 = 
NULL
;

1198 
ri
->
¦ave_´iÜ™y
 = 
SENTINEL_DEFAULT_SLAVE_PRIORITY
;

1199 
ri
->
¦ave_»cÚf_£Á_time
 = 0;

1200 
ri
->
¦ave_ma¡”_ho¡
 = 
NULL
;

1201 
ri
->
¦ave_ma¡”_pÜt
 = 0;

1202 
ri
->
¦ave_ma¡”_lšk_¡©us
 = 
SENTINEL_MASTER_LINK_STATUS_DOWN
;

1203 
ri
->
¦ave_»¶_off£t
 = 0;

1204 
ri
->
£Áš–s
 = 
	`diùC»©e
(&
š¡ªûsDiùTy³
,
NULL
);

1205 
ri
->
quÜum
 = quorum;

1206 
ri
->
·¿Î–_syncs
 = 
SENTINEL_DEFAULT_PARALLEL_SYNCS
;

1207 
ri
->
ma¡”
 = master;

1208 
ri
->
¦aves
 = 
	`diùC»©e
(&
š¡ªûsDiùTy³
,
NULL
);

1209 
ri
->
šfo_»äesh
 = 0;

1212 
ri
->
Ëad”
 = 
NULL
;

1213 
ri
->
Ëad”_•och
 = 0;

1214 
ri
->
çov”_•och
 = 0;

1215 
ri
->
çov”_¡©e
 = 
SENTINEL_FAILOVER_STATE_NONE
;

1216 
ri
->
çov”_¡©e_chªge_time
 = 0;

1217 
ri
->
çov”_¡¬t_time
 = 0;

1218 
ri
->
çov”_timeout
 = 
SENTINEL_DEFAULT_FAILOVER_TIMEOUT
;

1219 
ri
->
çov”_d–ay_logged
 = 0;

1220 
ri
->
´omÙed_¦ave
 = 
NULL
;

1221 
ri
->
nÙifiÿtiÚ_süt
 = 
NULL
;

1222 
ri
->
ş›Á_»cÚfig_süt
 = 
NULL
;

1223 
ri
->
šfo
 = 
NULL
;

1226 
ri
->
rŞe_»pÜ‹d
 =„i->
æags
 & (
SRI_MASTER
|
SRI_SLAVE
);

1227 
ri
->
rŞe_»pÜ‹d_time
 = 
	`m¡ime
();

1228 
ri
->
¦ave_cÚf_chªge_time
 = 
	`m¡ime
();

1231 
	`diùAdd
(
bË
, 
ri
->
Çme
,„i);

1232  
ri
;

1233 
	}
}

1239 
	$»Ëa£S’tš–RedisIn¡ªû
(
£Áš–RedisIn¡ªû
 *
ri
) {

1241 
	`diùR–—£
(
ri
->
£Áš–s
);

1242 
	`diùR–—£
(
ri
->
¦aves
);

1245 
	`»Ëa£In¡ªûLšk
(
ri
->
lšk
,ri);

1248 
	`sdsä“
(
ri
->
Çme
);

1249 
	`sdsä“
(
ri
->
runid
);

1250 
	`sdsä“
(
ri
->
nÙifiÿtiÚ_süt
);

1251 
	`sdsä“
(
ri
->
ş›Á_»cÚfig_süt
);

1252 
	`sdsä“
(
ri
->
¦ave_ma¡”_ho¡
);

1253 
	`sdsä“
(
ri
->
Ëad”
);

1254 
	`sdsä“
(
ri
->
auth_·ss
);

1255 
	`sdsä“
(
ri
->
šfo
);

1256 
	`»Ëa£S’tš–Addr
(
ri
->
addr
);

1259 ià((
ri
->
æags
 & 
SRI_SLAVE
è&& (ri->æag & 
SRI_PROMOTED
è&&„i->
ma¡”
)

1260 
ri
->
ma¡”
->
´omÙed_¦ave
 = 
NULL
;

1262 
	`zä“
(
ri
);

1263 
	}
}

1266 
£Áš–RedisIn¡ªû
 *
	$£Áš–RedisIn¡ªûLookupSÏve
(

1267 
£Áš–RedisIn¡ªû
 *
ri
, *

, 
pÜt
)

1269 
sds
 
key
;

1270 
£Áš–RedisIn¡ªû
 *
¦ave
;

1271 
buf
[
NET_PEER_ID_LEN
];

1273 
	`£rv”As£¹
(
ri
->
æags
 & 
SRI_MASTER
);

1274 
	`ª‘FÜm©Addr
(
buf
,(buf),

,
pÜt
);

1275 
key
 = 
	`sd¢ew
(
buf
);

1276 
¦ave
 = 
	`diùF‘chV®ue
(
ri
->
¦aves
,
key
);

1277 
	`sdsä“
(
key
);

1278  
¦ave
;

1279 
	}
}

1282 cÚ¡ *
	$£Áš–RedisIn¡ªûTy³SŒ
(
£Áš–RedisIn¡ªû
 *
ri
) {

1283 ià(
ri
->
æags
 & 
SRI_MASTER
)  "master";

1284 ià(
ri
->
æags
 & 
SRI_SLAVE
)  "slave";

1285 ià(
ri
->
æags
 & 
SRI_SENTINEL
)  "sentinel";

1287 
	}
}

1300 
	$»moveM©chšgS’tš–FromMa¡”
(
£Áš–RedisIn¡ªû
 *
ma¡”
, *
runid
) {

1301 
diùI‹¿tÜ
 *
di
;

1302 
diùEÁry
 *
de
;

1303 
»moved
 = 0;

1305 ià(
runid
 =ğ
NULL
)  0;

1307 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
ma¡”
->
£Áš–s
);

1308 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1309 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

1311 ià(
ri
->
runid
 && 
	`¡rcmp
(ri->runid,runid) == 0) {

1312 
	`diùD–‘e
(
ma¡”
->
£Áš–s
,
ri
->
Çme
);

1313 
»moved
++;

1316 
	`diùR–—£I‹¿tÜ
(
di
);

1317  
»moved
;

1318 
	}
}

1326 
£Áš–RedisIn¡ªû
 *
	$g‘S’tš–RedisIn¡ªûByAddrAndRunID
(
diù
 *
š¡ªûs
, *

, 
pÜt
, *
runid
) {

1327 
diùI‹¿tÜ
 *
di
;

1328 
diùEÁry
 *
de
;

1329 
£Áš–RedisIn¡ªû
 *
š¡ªû
 = 
NULL
;

1331 
	`£rv”As£¹
(

 || 
runid
);

1332 
di
 = 
	`diùG‘I‹¿tÜ
(
š¡ªûs
);

1333 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1334 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

1336 ià(
runid
 && !
ri
->runid) ;

1337 ià((
runid
 =ğ
NULL
 || 
	`¡rcmp
(
ri
->runid,„unid) == 0) &&

1338 (

 =ğ
NULL
 || (
	`¡rcmp
(
ri
->
addr
->ip, ip) == 0 &&

1339 
ri
->
addr
->
pÜt
 ==…ort)))

1341 
š¡ªû
 = 
ri
;

1345 
	`diùR–—£I‹¿tÜ
(
di
);

1346  
š¡ªû
;

1347 
	}
}

1350 
£Áš–RedisIn¡ªû
 *
	$£Áš–G‘Ma¡”ByName
(*
Çme
) {

1351 
£Áš–RedisIn¡ªû
 *
ri
;

1352 
sds
 
sd¢ame
 = 
	`sd¢ew
(
Çme
);

1354 
ri
 = 
	`diùF‘chV®ue
(
£Áš–
.
ma¡”s
,
sd¢ame
);

1355 
	`sdsä“
(
sd¢ame
);

1356  
ri
;

1357 
	}
}

1360 
	$£Áš–AddFÏgsToDiùOfRedisIn¡ªûs
(
diù
 *
š¡ªûs
, 
æags
) {

1361 
diùI‹¿tÜ
 *
di
;

1362 
diùEÁry
 *
de
;

1364 
di
 = 
	`diùG‘I‹¿tÜ
(
š¡ªûs
);

1365 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1366 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

1367 
ri
->
æags
 |= flags;

1369 
	`diùR–—£I‹¿tÜ
(
di
);

1370 
	}
}

1374 
	$£Áš–D–FÏgsToDiùOfRedisIn¡ªûs
(
diù
 *
š¡ªûs
, 
æags
) {

1375 
diùI‹¿tÜ
 *
di
;

1376 
diùEÁry
 *
de
;

1378 
di
 = 
	`diùG‘I‹¿tÜ
(
š¡ªûs
);

1379 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1380 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

1381 
ri
->
æags
 &= ~flags;

1383 
	`diùR–—£I‹¿tÜ
(
di
);

1384 
	}
}

1397 
	#SENTINEL_RESET_NO_SENTINELS
 (1<<0)

	)

1398 
	$£Áš–Re£tMa¡”
(
£Áš–RedisIn¡ªû
 *
ri
, 
æags
) {

1399 
	`£rv”As£¹
(
ri
->
æags
 & 
SRI_MASTER
);

1400 
	`diùR–—£
(
ri
->
¦aves
);

1401 
ri
->
¦aves
 = 
	`diùC»©e
(&
š¡ªûsDiùTy³
,
NULL
);

1402 ià(!(
æags
 & 
SENTINEL_RESET_NO_SENTINELS
)) {

1403 
	`diùR–—£
(
ri
->
£Áš–s
);

1404 
ri
->
£Áš–s
 = 
	`diùC»©e
(&
š¡ªûsDiùTy³
,
NULL
);

1406 
	`š¡ªûLškClo£CÚÃùiÚ
(
ri
->
lšk
,ri->lšk->
cc
);

1407 
	`š¡ªûLškClo£CÚÃùiÚ
(
ri
->
lšk
,ri->lšk->
pc
);

1408 
ri
->
æags
 &ğ
SRI_MASTER
;

1409 ià(
ri
->
Ëad”
) {

1410 
	`sdsä“
(
ri
->
Ëad”
);

1411 
ri
->
Ëad”
 = 
NULL
;

1413 
ri
->
çov”_¡©e
 = 
SENTINEL_FAILOVER_STATE_NONE
;

1414 
ri
->
çov”_¡©e_chªge_time
 = 0;

1415 
ri
->
çov”_¡¬t_time
 = 0;

1416 
ri
->
´omÙed_¦ave
 = 
NULL
;

1417 
	`sdsä“
(
ri
->
runid
);

1418 
	`sdsä“
(
ri
->
¦ave_ma¡”_ho¡
);

1419 
ri
->
runid
 = 
NULL
;

1420 
ri
->
¦ave_ma¡”_ho¡
 = 
NULL
;

1421 
ri
->
lšk
->
aù_pšg_time
 = 
	`m¡ime
();

1422 
ri
->
lšk
->
Ï¡_pšg_time
 = 0;

1423 
ri
->
lšk
->
Ï¡_ava_time
 = 
	`m¡ime
();

1424 
ri
->
lšk
->
Ï¡_pÚg_time
 = 
	`m¡ime
();

1425 
ri
->
rŞe_»pÜ‹d_time
 = 
	`m¡ime
();

1426 
ri
->
rŞe_»pÜ‹d
 = 
SRI_MASTER
;

1427 ià(
æags
 & 
SENTINEL_GENERATE_EVENT
)

1428 
	`£Áš–Ev’t
(
LL_WARNING
,"+»£t-ma¡”",
ri
,"%@");

1429 
	}
}

1433 
	$£Áš–Re£tMa¡”sByP©‹º
(*
·‰”n
, 
æags
) {

1434 
diùI‹¿tÜ
 *
di
;

1435 
diùEÁry
 *
de
;

1436 
»£t
 = 0;

1438 
di
 = 
	`diùG‘I‹¿tÜ
(
£Áš–
.
ma¡”s
);

1439 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1440 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

1442 ià(
ri
->
Çme
) {

1443 ià(
	`¡ršgm©ch
(
·‰”n
,
ri
->
Çme
,0)) {

1444 
	`£Áš–Re£tMa¡”
(
ri
,
æags
);

1445 
»£t
++;

1449 
	`diùR–—£I‹¿tÜ
(
di
);

1450  
»£t
;

1451 
	}
}

1460 
	$£Áš–Re£tMa¡”AndChªgeAdd»ss
(
£Áš–RedisIn¡ªû
 *
ma¡”
, *

, 
pÜt
) {

1461 
£Áš–Addr
 *
Şdaddr
, *
Ãwaddr
;

1462 
£Áš–Addr
 **
¦aves
 = 
NULL
;

1463 
num¦aves
 = 0, 
j
;

1464 
diùI‹¿tÜ
 *
di
;

1465 
diùEÁry
 *
de
;

1467 
Ãwaddr
 = 
	`ü—‹S’tš–Addr
(

,
pÜt
);

1468 ià(
Ãwaddr
 =ğ
NULL
è 
C_ERR
;

1472 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
¦aves
);

1473 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1474 
£Áš–RedisIn¡ªû
 *
¦ave
 = 
	`diùG‘V®
(
de
);

1476 ià(
	`£Áš–AddrIsEqu®
(
¦ave
->
addr
,
Ãwaddr
)) ;

1477 
¦aves
 = 
	`z»®loc
(¦aves,(
£Áš–Addr
*)*(
num¦aves
+1));

1478 
¦aves
[
num¦aves
++] = 
	`ü—‹S’tš–Addr
(
¦ave
->
addr
->

,

1479 
¦ave
->
addr
->
pÜt
);

1481 
	`diùR–—£I‹¿tÜ
(
di
);

1486 ià(!
	`£Áš–AddrIsEqu®
(
Ãwaddr
,
ma¡”
->
addr
)) {

1487 
¦aves
 = 
	`z»®loc
(¦aves,(
£Áš–Addr
*)*(
num¦aves
+1));

1488 
¦aves
[
num¦aves
++] = 
	`ü—‹S’tš–Addr
(
ma¡”
->
addr
->

,

1489 
ma¡”
->
addr
->
pÜt
);

1493 
	`£Áš–Re£tMa¡”
(
ma¡”
,
SENTINEL_RESET_NO_SENTINELS
);

1494 
Şdaddr
 = 
ma¡”
->
addr
;

1495 
ma¡”
->
addr
 = 
Ãwaddr
;

1496 
ma¡”
->
o_down_sšû_time
 = 0;

1497 
ma¡”
->
s_down_sšû_time
 = 0;

1500 
j
 = 0; j < 
num¦aves
; j++) {

1501 
£Áš–RedisIn¡ªû
 *
¦ave
;

1503 
¦ave
 = 
	`ü—‹S’tš–RedisIn¡ªû
(
NULL
,
SRI_SLAVE
,
¦aves
[
j
]->

,

1504 
¦aves
[
j
]->
pÜt
, 
ma¡”
->
quÜum
, master);

1505 
	`»Ëa£S’tš–Addr
(
¦aves
[
j
]);

1506 ià(
¦ave
è
	`£Áš–Ev’t
(
LL_NOTICE
,"+slave",slave,"%@");

1508 
	`zä“
(
¦aves
);

1512 
	`»Ëa£S’tš–Addr
(
Şdaddr
);

1513 
	`£Áš–FlushCÚfig
();

1514  
C_OK
;

1515 
	}
}

1519 
	$£Áš–RedisIn¡ªûNoDownFÜ
(
£Áš–RedisIn¡ªû
 *
ri
, 
m¡ime_t
 
ms
) {

1520 
m¡ime_t
 
mo¡_»ûÁ
;

1522 
mo¡_»ûÁ
 = 
ri
->
s_down_sšû_time
;

1523 ià(
ri
->
o_down_sšû_time
 > 
mo¡_»ûÁ
)

1524 
mo¡_»ûÁ
 = 
ri
->
o_down_sšû_time
;

1525  
mo¡_»ûÁ
 =ğ0 || (
	`m¡ime
(è- mo¡_»ûÁè> 
ms
;

1526 
	}
}

1530 
£Áš–Addr
 *
	$£Áš–G‘Cu¼’tMa¡”Add»ss
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

1536 ià((
ma¡”
->
æags
 & 
SRI_FAILOVER_IN_PROGRESS
) &&

1537 
ma¡”
->
´omÙed_¦ave
 &&

1538 
ma¡”
->
çov”_¡©e
 >ğ
SENTINEL_FAILOVER_STATE_RECONF_SLAVES
)

1540  
ma¡”
->
´omÙed_¦ave
->
addr
;

1542  
ma¡”
->
addr
;

1544 
	}
}

1548 
	$£Áš–Prİag©eDownAá”P”iod
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

1549 
diùI‹¿tÜ
 *
di
;

1550 
diùEÁry
 *
de
;

1551 
j
;

1552 
diù
 *
d
[] = {
ma¡”
->
¦aves
, ma¡”->
£Áš–s
, 
NULL
};

1554 
j
 = 0; 
d
[j]; j++) {

1555 
di
 = 
	`diùG‘I‹¿tÜ
(
d
[
j
]);

1556 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1557 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

1558 
ri
->
down_aá”_³riod
 = 
ma¡”
->down_after_period;

1560 
	`diùR–—£I‹¿tÜ
(
di
);

1562 
	}
}

1564 *
	$£Áš–G‘In¡ªûTy³SŒšg
(
£Áš–RedisIn¡ªû
 *
ri
) {

1565 ià(
ri
->
æags
 & 
SRI_MASTER
)  "master";

1566 ià(
ri
->
æags
 & 
SRI_SLAVE
)  "slave";

1567 ià(
ri
->
æags
 & 
SRI_SENTINEL
)  "sentinel";

1569 
	}
}

1572 *
	$£Áš–HªdËCÚfigu¿tiÚ
(**
¬gv
, 
¬gc
) {

1573 
£Áš–RedisIn¡ªû
 *
ri
;

1575 ià(!
	`¡rÿ£cmp
(
¬gv
[0],"mÚ™Ü"è&& 
¬gc
 == 5) {

1577 
quÜum
 = 
	`©oi
(
¬gv
[4]);

1579 ià(
quÜum
 <= 0)  "Quorum must be 1 or greater.";

1580 ià(
	`ü—‹S’tš–RedisIn¡ªû
(
¬gv
[1],
SRI_MASTER
,argv[2],

1581 
	`©oi
(
¬gv
[3]),
quÜum
,
NULL
) == NULL)

1583 
”ºo
) {

1584 
EBUSY
:  "Duplicated master‚ame.";

1585 
ENOENT
:  "Can't„esolve master instance hostname.";

1586 
EINVAL
:  "Invalid…ort‚umber";

1589 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"down-aá”-mli£cÚds"è&& 
¬gc
 == 3) {

1591 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1592 ià(!
ri
)  "No such master with specified‚ame.";

1593 
ri
->
down_aá”_³riod
 = 
	`©oi
(
¬gv
[2]);

1594 ià(
ri
->
down_aá”_³riod
 <= 0)

1596 
	`£Áš–Prİag©eDownAá”P”iod
(
ri
);

1597 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"çov”-timeout"è&& 
¬gc
 == 3) {

1599 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1600 ià(!
ri
)  "No such master with specified‚ame.";

1601 
ri
->
çov”_timeout
 = 
	`©oi
(
¬gv
[2]);

1602 ià(
ri
->
çov”_timeout
 <= 0)

1604 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"·¿Î–-syncs"è&& 
¬gc
 == 3) {

1606 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1607 ià(!
ri
)  "No such master with specified‚ame.";

1608 
ri
->
·¿Î–_syncs
 = 
	`©oi
(
¬gv
[2]);

1609 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"nÙifiÿtiÚ-süt"è&& 
¬gc
 == 3) {

1611 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1612 ià(!
ri
)  "No such master with specified‚ame.";

1613 ià(
	`acûss
(
¬gv
[2],
X_OK
) == -1)

1615 
ri
->
nÙifiÿtiÚ_süt
 = 
	`sd¢ew
(
¬gv
[2]);

1616 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"ş›Á-»cÚfig-süt"è&& 
¬gc
 == 3) {

1618 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1619 ià(!
ri
)  "No such master with specified‚ame.";

1620 ià(
	`acûss
(
¬gv
[2],
X_OK
) == -1)

1623 
ri
->
ş›Á_»cÚfig_süt
 = 
	`sd¢ew
(
¬gv
[2]);

1624 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"auth-·ss"è&& 
¬gc
 == 3) {

1626 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1627 ià(!
ri
)  "No such master with specified‚ame.";

1628 
ri
->
auth_·ss
 = 
	`sd¢ew
(
¬gv
[2]);

1629 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"cu¼’t-•och"è&& 
¬gc
 == 2) {

1631 
cu¼’t_•och
 = 
	`¡¹ouÎ
(
¬gv
[1],
NULL
,10);

1632 ià(
cu¼’t_•och
 > 
£Áš–
.current_epoch)

1633 
£Áš–
.
cu¼’t_•och
 = current_epoch;

1634 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"myid"è&& 
¬gc
 == 2) {

1635 ià(
	`¡¾’
(
¬gv
[1]è!ğ
CONFIG_RUN_ID_SIZE
)

1637 
	`memıy
(
£Áš–
.
myid
,
¬gv
[1],
CONFIG_RUN_ID_SIZE
);

1638 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"cÚfig-•och"è&& 
¬gc
 == 3) {

1640 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1641 ià(!
ri
)  "No such master with specified‚ame.";

1642 
ri
->
cÚfig_•och
 = 
	`¡¹ouÎ
(
¬gv
[2],
NULL
,10);

1646 ià(
ri
->
cÚfig_•och
 > 
£Áš–
.
cu¼’t_•och
)

1647 
£Áš–
.
cu¼’t_•och
 = 
ri
->
cÚfig_•och
;

1648 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"Ëad”-•och"è&& 
¬gc
 == 3) {

1650 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1651 ià(!
ri
)  "No such master with specified‚ame.";

1652 
ri
->
Ëad”_•och
 = 
	`¡¹ouÎ
(
¬gv
[2],
NULL
,10);

1653 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"known-¦ave"è&& 
¬gc
 == 4) {

1654 
£Áš–RedisIn¡ªû
 *
¦ave
;

1657 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1658 ià(!
ri
)  "No such master with specified‚ame.";

1659 ià((
¦ave
 = 
	`ü—‹S’tš–RedisIn¡ªû
(
NULL
,
SRI_SLAVE
,
¬gv
[2],

1660 
	`©oi
(
¬gv
[3]), 
ri
->
quÜum
,„i)è=ğ
NULL
)

1664 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"known-sentinel") &&

1665 (
¬gc
 == 4 ||‡rgc == 5)) {

1666 
£Áš–RedisIn¡ªû
 *
si
;

1668 ià(
¬gc
 == 5) {

1670 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
¬gv
[1]);

1671 ià(!
ri
)  "No such master with specified‚ame.";

1672 ià((
si
 = 
	`ü—‹S’tš–RedisIn¡ªû
(
¬gv
[4],
SRI_SENTINEL
,argv[2],

1673 
	`©oi
(
¬gv
[3]), 
ri
->
quÜum
,„i)è=ğ
NULL
)

1677 
si
->
runid
 = 
	`sd¢ew
(
¬gv
[4]);

1678 
	`£Áš–TryCÚÃùiÚSh¬šg
(
si
);

1680 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"ªnounû-"è&& 
¬gc
 == 2) {

1682 ià(
	`¡¾’
(
¬gv
[1]))

1683 
£Áš–
.
ªnounû_
 = 
	`sd¢ew
(
¬gv
[1]);

1684 } ià(!
	`¡rÿ£cmp
(
¬gv
[0],"ªnounû-pÜt"è&& 
¬gc
 == 2) {

1686 
£Áš–
.
ªnounû_pÜt
 = 
	`©oi
(
¬gv
[1]);

1690  
NULL
;

1691 
	}
}

1698 
	$»wr™eCÚfigS’tš–O±iÚ
(
»wr™eCÚfigS‹
 *
¡©e
) {

1699 
diùI‹¿tÜ
 *
di
, *
di2
;

1700 
diùEÁry
 *
de
;

1701 
sds
 
lše
;

1704 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(), "£Áš– myid %s", 
£Áš–
.
myid
);

1705 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1708 
di
 = 
	`diùG‘I‹¿tÜ
(
£Áš–
.
ma¡”s
);

1709 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

1710 
£Áš–RedisIn¡ªû
 *
ma¡”
, *
ri
;

1711 
£Áš–Addr
 *
ma¡”_addr
;

1714 
ma¡”
 = 
	`diùG‘V®
(
de
);

1715 
ma¡”_addr
 = 
	`£Áš–G‘Cu¼’tMa¡”Add»ss
(
ma¡”
);

1716 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"sentinel monitor %s %s %d %d",

1717 
ma¡”
->
Çme
, 
ma¡”_addr
->

, ma¡”_addr->
pÜt
,

1718 
ma¡”
->
quÜum
);

1719 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1722 ià(
ma¡”
->
down_aá”_³riod
 !ğ
SENTINEL_DEFAULT_DOWN_AFTER
) {

1723 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1725 
ma¡”
->
Çme
, (èma¡”->
down_aá”_³riod
);

1726 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1730 ià(
ma¡”
->
çov”_timeout
 !ğ
SENTINEL_DEFAULT_FAILOVER_TIMEOUT
) {

1731 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1733 
ma¡”
->
Çme
, (èma¡”->
çov”_timeout
);

1734 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1738 ià(
ma¡”
->
·¿Î–_syncs
 !ğ
SENTINEL_DEFAULT_PARALLEL_SYNCS
) {

1739 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1741 
ma¡”
->
Çme
, ma¡”->
·¿Î–_syncs
);

1742 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1746 ià(
ma¡”
->
nÙifiÿtiÚ_süt
) {

1747 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1749 
ma¡”
->
Çme
, ma¡”->
nÙifiÿtiÚ_süt
);

1750 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1754 ià(
ma¡”
->
ş›Á_»cÚfig_süt
) {

1755 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1757 
ma¡”
->
Çme
, ma¡”->
ş›Á_»cÚfig_süt
);

1758 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1762 ià(
ma¡”
->
auth_·ss
) {

1763 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1765 
ma¡”
->
Çme
, ma¡”->
auth_·ss
);

1766 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1770 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1772 
ma¡”
->
Çme
, (èma¡”->
cÚfig_•och
);

1773 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1776 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1778 
ma¡”
->
Çme
, (èma¡”->
Ëad”_•och
);

1779 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1782 
di2
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
¦aves
);

1783 (
de
 = 
	`diùNext
(
di2
)è!ğ
NULL
) {

1784 
£Áš–Addr
 *
¦ave_addr
;

1786 
ri
 = 
	`diùG‘V®
(
de
);

1787 
¦ave_addr
 = 
ri
->
addr
;

1794 ià(
	`£Áš–AddrIsEqu®
(
¦ave_addr
,
ma¡”_addr
))

1795 
¦ave_addr
 = 
ma¡”
->
addr
;

1796 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1798 
ma¡”
->
Çme
, 
¦ave_addr
->

, sÏve_addr->
pÜt
);

1799 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1801 
	`diùR–—£I‹¿tÜ
(
di2
);

1804 
di2
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
£Áš–s
);

1805 (
de
 = 
	`diùNext
(
di2
)è!ğ
NULL
) {

1806 
ri
 = 
	`diùG‘V®
(
de
);

1807 ià(
ri
->
runid
 =ğ
NULL
) ;

1808 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1810 
ma¡”
->
Çme
, 
ri
->
addr
->

,„i->addr->
pÜt
,„i->
runid
);

1811 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1813 
	`diùR–—£I‹¿tÜ
(
di2
);

1817 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),

1818 "£Áš– cu¼’t-•och %Îu", (è
£Áš–
.
cu¼’t_•och
);

1819 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1822 ià(
£Áš–
.
ªnounû_
) {

1823 
lše
 = 
	`sd¢ew
("sentinel‡nnounce-ip ");

1824 
lše
 = 
	`sdsÿŒ•r
Öše, 
£Áš–
.
ªnounû_
, 
	`sd¦’
(sentinel.announce_ip));

1825 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1829 ià(
£Áš–
.
ªnounû_pÜt
) {

1830 
lše
 = 
	`sdsÿrštf
(
	`sd£m±y
(),"sentinel‡nnounce-port %d",

1831 
£Áš–
.
ªnounû_pÜt
);

1832 
	`»wr™eCÚfigRewr™eLše
(
¡©e
,"£Áš–",
lše
,1);

1835 
	`diùR–—£I‹¿tÜ
(
di
);

1836 
	}
}

1845 
	$£Áš–FlushCÚfig
() {

1846 
fd
 = -1;

1847 
§ved_hz
 = 
£rv”
.
hz
;

1848 
»wr™e_¡©us
;

1850 
£rv”
.
hz
 = 
CONFIG_DEFAULT_HZ
;

1851 
»wr™e_¡©us
 = 
	`»wr™eCÚfig
(
£rv”
.
cÚfigfe
);

1852 
£rv”
.
hz
 = 
§ved_hz
;

1854 ià(
»wr™e_¡©us
 =ğ-1è
w”r
;

1855 ià((
fd
 = 
	`İ’
(
£rv”
.
cÚfigfe
,
O_RDONLY
)è=ğ-1è
w”r
;

1856 ià(
	`fsync
(
fd
è=ğ-1è
w”r
;

1857 ià(
	`şo£
(
fd
è=ğ
EOF
è
w”r
;

1860 
w”r
:

1861 ià(
fd
 !ğ-1è
	`şo£
(fd);

1862 
	`£rv”Log
(
LL_WARNING
,"WARNING: S’tš– wa nÙ‡bËØ§vthÃw cÚfigu¿tiÚ oÀdisk!!!: %s", 
	`¡»¼Ü
(
”ºo
));

1863 
	}
}

1873 
	$£Áš–S’dAuthIfN“ded
(
£Áš–RedisIn¡ªû
 *
ri
, 
»disAsyncCÚ‹xt
 *
c
) {

1874 *
auth_·ss
 = (
ri
->
æags
 & 
SRI_MASTER
) ?„i->auth_pass :

1875 
ri
->
ma¡”
->
auth_·ss
;

1877 ià(
auth_·ss
) {

1878 ià(
	`»disAsyncCommªd
(
c
, 
£Áš–DisÿrdR•lyC®lback
, 
ri
, "AUTH %s",

1879 
auth_·ss
è=ğ
C_OK
è
ri
->
lšk
->
³ndšg_commªds
++;

1881 
	}
}

1889 
	$£Áš–S‘Cl›ÁName
(
£Áš–RedisIn¡ªû
 *
ri
, 
»disAsyncCÚ‹xt
 *
c
, *
ty³
) {

1890 
Çme
[64];

1892 
	`¢´štf
(
Çme
,Òame),"£Áš–-%.8s-%s",
£Áš–
.
myid
,
ty³
);

1893 ià(
	`»disAsyncCommªd
(
c
, 
£Áš–DisÿrdR•lyC®lback
, 
ri
,

1894 "CLIENT SETNAME %s", 
Çme
è=ğ
C_OK
)

1896 
ri
->
lšk
->
³ndšg_commªds
++;

1898 
	}
}

1903 
	$£Áš–RecÚÃùIn¡ªû
(
£Áš–RedisIn¡ªû
 *
ri
) {

1904 ià(
ri
->
lšk
->
discÚÃùed
 == 0) ;

1905 ià(
ri
->
addr
->
pÜt
 == 0) ;

1906 
š¡ªûLšk
 *
lšk
 = 
ri
->link;

1907 
m¡ime_t
 
now
 = 
	`m¡ime
();

1909 ià(
now
 - 
ri
->
lšk
->
Ï¡_»cÚn_time
 < 
SENTINEL_PING_PERIOD
) ;

1910 
ri
->
lšk
->
Ï¡_»cÚn_time
 = 
now
;

1913 ià(
lšk
->
cc
 =ğ
NULL
) {

1914 
lšk
->
cc
 = 
	`»disAsyncCÚÃùBšd
(
ri
->
addr
->

,ri->addr->
pÜt
,
NET_FIRST_BIND_ADDR
);

1915 ià(
lšk
->
cc
->
”r
) {

1916 
	`£Áš–Ev’t
(
LL_DEBUG
,"-cmd-lšk-»cÚÃùiÚ",
ri
,"%@ #%s",

1917 
lšk
->
cc
->
”r¡r
);

1918 
	`š¡ªûLškClo£CÚÃùiÚ
(
lšk
,lšk->
cc
);

1920 
lšk
->
³ndšg_commªds
 = 0;

1921 
lšk
->
cc_cÚn_time
 = 
	`m¡ime
();

1922 
lšk
->
cc
->
d©a
 =†ink;

1923 
	`»disAeA‰ach
(
£rv”
.
–
,
lšk
->
cc
);

1924 
	`»disAsyncS‘CÚÃùC®lback
(
lšk
->
cc
,

1925 
£Áš–LškE¡ablishedC®lback
);

1926 
	`»disAsyncS‘DiscÚÃùC®lback
(
lšk
->
cc
,

1927 
£Áš–DiscÚÃùC®lback
);

1928 
	`£Áš–S’dAuthIfN“ded
(
ri
,
lšk
->
cc
);

1929 
	`£Áš–S‘Cl›ÁName
(
ri
,
lšk
->
cc
,"cmd");

1932 
	`£Áš–S’dPšg
(
ri
);

1936 ià((
ri
->
æags
 & (
SRI_MASTER
|
SRI_SLAVE
)è&& 
lšk
->
pc
 =ğ
NULL
) {

1937 
lšk
->
pc
 = 
	`»disAsyncCÚÃùBšd
(
ri
->
addr
->

,ri->addr->
pÜt
,
NET_FIRST_BIND_ADDR
);

1938 ià(
lšk
->
pc
->
”r
) {

1939 
	`£Áš–Ev’t
(
LL_DEBUG
,"-pubsub-lšk-»cÚÃùiÚ",
ri
,"%@ #%s",

1940 
lšk
->
pc
->
”r¡r
);

1941 
	`š¡ªûLškClo£CÚÃùiÚ
(
lšk
,lšk->
pc
);

1943 
»tv®
;

1945 
lšk
->
pc_cÚn_time
 = 
	`m¡ime
();

1946 
lšk
->
pc
->
d©a
 =†ink;

1947 
	`»disAeA‰ach
(
£rv”
.
–
,
lšk
->
pc
);

1948 
	`»disAsyncS‘CÚÃùC®lback
(
lšk
->
pc
,

1949 
£Áš–LškE¡ablishedC®lback
);

1950 
	`»disAsyncS‘DiscÚÃùC®lback
(
lšk
->
pc
,

1951 
£Áš–DiscÚÃùC®lback
);

1952 
	`£Áš–S’dAuthIfN“ded
(
ri
,
lšk
->
pc
);

1953 
	`£Áš–S‘Cl›ÁName
(
ri
,
lšk
->
pc
,"pubsub");

1955 
»tv®
 = 
	`»disAsyncCommªd
(
lšk
->
pc
,

1956 
£Áš–ReûiveH–loMes§ges
, 
ri
, "SUBSCRIBE %s",

1957 
SENTINEL_HELLO_CHANNEL
);

1958 ià(
»tv®
 !ğ
C_OK
) {

1961 
	`š¡ªûLškClo£CÚÃùiÚ
(
lšk
,lšk->
pc
);

1968 ià(
lšk
->
cc
 && (
ri
->
æags
 & 
SRI_SENTINEL
 ||†šk->
pc
))

1969 
lšk
->
discÚÃùed
 = 0;

1970 
	}
}

1979 
	$£Áš–Ma¡”LooksSªe
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

1981 
ma¡”
->
æags
 & 
SRI_MASTER
 &&

1982 
ma¡”
->
rŞe_»pÜ‹d
 =ğ
SRI_MASTER
 &&

1983 (
ma¡”
->
æags
 & (
SRI_S_DOWN
|
SRI_O_DOWN
)) == 0 &&

1984 (
	`m¡ime
(è- 
ma¡”
->
šfo_»äesh
è< 
SENTINEL_INFO_PERIOD
*2;

1985 
	}
}

1988 
	$£Áš–ReäeshIn¡ªûInfo
(
£Áš–RedisIn¡ªû
 *
ri
, cÚ¡ *
šfo
) {

1989 
sds
 *
lšes
;

1990 
numlšes
, 
j
;

1991 
rŞe
 = 0;

1994 
	`sdsä“
(
ri
->
šfo
);

1995 
ri
->
šfo
 = 
	`sd¢ew
(info);

1999 
ri
->
ma¡”_lšk_down_time
 = 0;

2002 
lšes
 = 
	`sds¥l™Ën
(
šfo
,
	`¡¾’
(šfo),"\r\n",2,&
numlšes
);

2003 
j
 = 0; j < 
numlšes
; j++) {

2004 
£Áš–RedisIn¡ªû
 *
¦ave
;

2005 
sds
 
l
 = 
lšes
[
j
];

2008 ià(
	`sd¦’
(
l
è>ğ47 && !
	`memcmp
(l,"run_id:",7)) {

2009 ià(
ri
->
runid
 =ğ
NULL
) {

2010 
ri
->
runid
 = 
	`sd¢ewËn
(
l
+7,40);

2012 ià(
	`¡ºcmp
(
ri
->
runid
,
l
+7,40) != 0) {

2013 
	`£Áš–Ev’t
(
LL_NOTICE
,"+»boÙ",
ri
,"%@");

2014 
	`sdsä“
(
ri
->
runid
);

2015 
ri
->
runid
 = 
	`sd¢ewËn
(
l
+7,40);

2022 ià((
ri
->
æags
 & 
SRI_MASTER
) &&

2023 
	`sd¦’
(
l
) >= 7 &&

2024 !
	`memcmp
(
l
,"¦ave",5è&& 
	`isdig™
(l[5]))

2026 *

, *
pÜt
, *
’d
;

2028 ià(
	`¡r¡r
(
l
,"="è=ğ
NULL
) {

2030 

 = 
	`¡rchr
(
l
,':'); if (!ip) ;

2031 

++;

2032 
pÜt
 = 
	`¡rchr
(

,','); if (!port) ;

2033 *
pÜt
 = '\0';

2034 
pÜt
++;

2035 
’d
 = 
	`¡rchr
(
pÜt
,','); if (!end) ;

2036 *
’d
 = '\0';

2039 

 = 
	`¡r¡r
(
l
,"ip="); if (!ip) ;

2040 

 += 3;

2041 
pÜt
 = 
	`¡r¡r
(
l
,"port="); if (!port) ;

2042 
pÜt
 += 5;

2044 
’d
 = 
	`¡rchr
(

,','); if (end) *end = '\0';

2045 
’d
 = 
	`¡rchr
(
pÜt
,','); if (end) *end = '\0';

2050 ià(
	`£Áš–RedisIn¡ªûLookupSÏve
(
ri
,

,
	`©oi
(
pÜt
)è=ğ
NULL
) {

2051 ià((
¦ave
 = 
	`ü—‹S’tš–RedisIn¡ªû
(
NULL
,
SRI_SLAVE
,

,

2052 
	`©oi
(
pÜt
), 
ri
->
quÜum
,„i)è!ğ
NULL
)

2054 
	`£Áš–Ev’t
(
LL_NOTICE
,"+¦ave",
¦ave
,"%@");

2055 
	`£Áš–FlushCÚfig
();

2061 ià(
	`sd¦’
(
l
) >= 32 &&

2062 !
	`memcmp
(
l
,"master_link_down_since_seconds",30))

2064 
ri
->
ma¡”_lšk_down_time
 = 
	`¡¹Şl
(
l
+31,
NULL
,10)*1000;

2068 ià(!
	`memcmp
(
l
,"rŞe:ma¡”",11)è
rŞe
 = 
SRI_MASTER
;

2069 ià(!
	`memcmp
(
l
,"rŞe:¦ave",10)è
rŞe
 = 
SRI_SLAVE
;

2071 ià(
rŞe
 =ğ
SRI_SLAVE
) {

2073 ià(
	`sd¦’
(
l
è>ğ12 && !
	`memcmp
(l,"master_host:",12)) {

2074 ià(
ri
->
¦ave_ma¡”_ho¡
 =ğ
NULL
 ||

2075 
	`¡rÿ£cmp
(
l
+12,
ri
->
¦ave_ma¡”_ho¡
))

2077 
	`sdsä“
(
ri
->
¦ave_ma¡”_ho¡
);

2078 
ri
->
¦ave_ma¡”_ho¡
 = 
	`sd¢ew
(
l
+12);

2079 
ri
->
¦ave_cÚf_chªge_time
 = 
	`m¡ime
();

2084 ià(
	`sd¦’
(
l
è>ğ12 && !
	`memcmp
(l,"master_port:",12)) {

2085 
¦ave_ma¡”_pÜt
 = 
	`©oi
(
l
+12);

2087 ià(
ri
->
¦ave_ma¡”_pÜt
 != slave_master_port) {

2088 
ri
->
¦ave_ma¡”_pÜt
 = slave_master_port;

2089 
ri
->
¦ave_cÚf_chªge_time
 = 
	`m¡ime
();

2094 ià(
	`sd¦’
(
l
è>ğ19 && !
	`memcmp
(l,"master_link_status:",19)) {

2095 
ri
->
¦ave_ma¡”_lšk_¡©us
 =

2096 (
	`¡rÿ£cmp
(
l
+19,"up") == 0) ?

2097 
SENTINEL_MASTER_LINK_STATUS_UP
 :

2098 
SENTINEL_MASTER_LINK_STATUS_DOWN
;

2102 ià(
	`sd¦’
(
l
è>ğ15 && !
	`memcmp
(l,"slave_priority:",15))

2103 
ri
->
¦ave_´iÜ™y
 = 
	`©oi
(
l
+15);

2106 ià(
	`sd¦’
(
l
è>ğ18 && !
	`memcmp
(l,"slave_repl_offset:",18))

2107 
ri
->
¦ave_»¶_off£t
 = 
	`¡¹ouÎ
(
l
+18,
NULL
,10);

2110 
ri
->
šfo_»äesh
 = 
	`m¡ime
();

2111 
	`sdsä“¥l™»s
(
lšes
,
numlšes
);

2118 ià(
rŞe
 !ğ
ri
->
rŞe_»pÜ‹d
) {

2119 
ri
->
rŞe_»pÜ‹d_time
 = 
	`m¡ime
();

2120 
ri
->
rŞe_»pÜ‹d
 = 
rŞe
;

2121 ià(
rŞe
 =ğ
SRI_SLAVE
è
ri
->
¦ave_cÚf_chªge_time
 = 
	`m¡ime
();

2124 
	`£Áš–Ev’t
(
LL_VERBOSE
,

2125 ((
ri
->
æags
 & (
SRI_MASTER
|
SRI_SLAVE
)è=ğ
rŞe
) ?

2127 
ri
, "%@‚ew„eported„ole is %s",

2128 
rŞe
 =ğ
SRI_MASTER
 ? "master" : "slave",

2129 
ri
->
æags
 & 
SRI_MASTER
 ? "master" : "slave");

2134 ià(
£Áš–
.
tt
) ;

2137 ià((
ri
->
æags
 & 
SRI_MASTER
è&& 
rŞe
 =ğ
SRI_SLAVE
) {

2144 ià((
ri
->
æags
 & 
SRI_SLAVE
è&& 
rŞe
 =ğ
SRI_MASTER
) {

2147 ià((
ri
->
æags
 & 
SRI_PROMOTED
) &&

2148 (
ri
->
ma¡”
->
æags
 & 
SRI_FAILOVER_IN_PROGRESS
) &&

2149 (
ri
->
ma¡”
->
çov”_¡©e
 ==

2150 
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
))

2157 
ri
->
ma¡”
->
cÚfig_•och
 =„i->ma¡”->
çov”_•och
;

2158 
ri
->
ma¡”
->
çov”_¡©e
 = 
SENTINEL_FAILOVER_STATE_RECONF_SLAVES
;

2159 
ri
->
ma¡”
->
çov”_¡©e_chªge_time
 = 
	`m¡ime
();

2160 
	`£Áš–FlushCÚfig
();

2161 
	`£Áš–Ev’t
(
LL_WARNING
,"+´omÙed-¦ave",
ri
,"%@");

2162 ià(
£Áš–
.
simçu»_æags
 &

2163 
SENTINEL_SIMFAILURE_CRASH_AFTER_PROMOTION
)

2164 
	`£Áš–SimFau»C¿sh
();

2165 
	`£Áš–Ev’t
(
LL_WARNING
,"+failover-state-reconf-slaves",

2166 
ri
->
ma¡”
,"%@");

2167 
	`£Áš–C®lCl›ÁRecÚfSüt
(
ri
->
ma¡”
,
SENTINEL_LEADER
,

2168 "¡¬t",
ri
->
ma¡”
->
addr
,ri->addr);

2169 
	`£Áš–FÜûH–loUpd©eFÜMa¡”
(
ri
->
ma¡”
);

2174 
m¡ime_t
 
wa™_time
 = 
SENTINEL_PUBLISH_PERIOD
*4;

2176 ià(!(
ri
->
æags
 & 
SRI_PROMOTED
) &&

2177 
	`£Áš–Ma¡”LooksSªe
(
ri
->
ma¡”
) &&

2178 
	`£Áš–RedisIn¡ªûNoDownFÜ
(
ri
,
wa™_time
) &&

2179 
	`m¡ime
(è- 
ri
->
rŞe_»pÜ‹d_time
 > 
wa™_time
)

2181 
»tv®
 = 
	`£Áš–S’dSÏveOf
(
ri
,

2182 
ri
->
ma¡”
->
addr
->

,

2183 
ri
->
ma¡”
->
addr
->
pÜt
);

2184 ià(
»tv®
 =ğ
C_OK
)

2185 
	`£Áš–Ev’t
(
LL_NOTICE
,"+cÚv”t-to-¦ave",
ri
,"%@");

2191 ià((
ri
->
æags
 & 
SRI_SLAVE
) &&

2192 
rŞe
 =ğ
SRI_SLAVE
 &&

2193 (
ri
->
¦ave_ma¡”_pÜt
 !ğri->
ma¡”
->
addr
->
pÜt
 ||

2194 
	`¡rÿ£cmp
(
ri
->
¦ave_ma¡”_ho¡
,ri->
ma¡”
->
addr
->

)))

2196 
m¡ime_t
 
wa™_time
 = 
ri
->
ma¡”
->
çov”_timeout
;

2200 ià(
	`£Áš–Ma¡”LooksSªe
(
ri
->
ma¡”
) &&

2201 
	`£Áš–RedisIn¡ªûNoDownFÜ
(
ri
,
wa™_time
) &&

2202 
	`m¡ime
(è- 
ri
->
¦ave_cÚf_chªge_time
 > 
wa™_time
)

2204 
»tv®
 = 
	`£Áš–S’dSÏveOf
(
ri
,

2205 
ri
->
ma¡”
->
addr
->

,

2206 
ri
->
ma¡”
->
addr
->
pÜt
);

2207 ià(
»tv®
 =ğ
C_OK
)

2208 
	`£Áš–Ev’t
(
LL_NOTICE
,"+fix-¦ave-cÚfig",
ri
,"%@");

2214 ià((
ri
->
æags
 & 
SRI_SLAVE
è&& 
rŞe
 == SRI_SLAVE &&

2215 (
ri
->
æags
 & (
SRI_RECONF_SENT
|
SRI_RECONF_INPROG
)))

2218 ià((
ri
->
æags
 & 
SRI_RECONF_SENT
) &&

2219 
ri
->
¦ave_ma¡”_ho¡
 &&

2220 
	`¡rcmp
(
ri
->
¦ave_ma¡”_ho¡
,

2221 
ri
->
ma¡”
->
´omÙed_¦ave
->
addr
->

) == 0 &&

2222 
ri
->
¦ave_ma¡”_pÜt
 =ğri->
ma¡”
->
´omÙed_¦ave
->
addr
->
pÜt
)

2224 
ri
->
æags
 &ğ~
SRI_RECONF_SENT
;

2225 
ri
->
æags
 |ğ
SRI_RECONF_INPROG
;

2226 
	`£Áš–Ev’t
(
LL_NOTICE
,"+¦ave-»cÚf-š´og",
ri
,"%@");

2230 ià((
ri
->
æags
 & 
SRI_RECONF_INPROG
) &&

2231 
ri
->
¦ave_ma¡”_lšk_¡©us
 =ğ
SENTINEL_MASTER_LINK_STATUS_UP
)

2233 
ri
->
æags
 &ğ~
SRI_RECONF_INPROG
;

2234 
ri
->
æags
 |ğ
SRI_RECONF_DONE
;

2235 
	`£Áš–Ev’t
(
LL_NOTICE
,"+¦ave-»cÚf-dÚe",
ri
,"%@");

2238 
	}
}

2240 
	$£Áš–InfoR•lyC®lback
(
»disAsyncCÚ‹xt
 *
c
, *
»¶y
, *
´ivd©a
) {

2241 
£Áš–RedisIn¡ªû
 *
ri
 = 
´ivd©a
;

2242 
š¡ªûLšk
 *
lšk
 = 
c
->
d©a
;

2243 
»disR•ly
 *
r
;

2245 ià(!
»¶y
 || !
lšk
) ;

2246 
lšk
->
³ndšg_commªds
--;

2247 
r
 = 
»¶y
;

2249 ià(
r
->
ty³
 =ğ
REDIS_REPLY_STRING
)

2250 
	`£Áš–ReäeshIn¡ªûInfo
(
ri
,
r
->
¡r
);

2251 
	}
}

2255 
	$£Áš–DisÿrdR•lyC®lback
(
»disAsyncCÚ‹xt
 *
c
, *
»¶y
, *
´ivd©a
) {

2256 
š¡ªûLšk
 *
lšk
 = 
c
->
d©a
;

2257 
	`UNUSED
(
»¶y
);

2258 
	`UNUSED
(
´ivd©a
);

2260 ià(
lšk
èlšk->
³ndšg_commªds
--;

2261 
	}
}

2263 
	$£Áš–PšgR•lyC®lback
(
»disAsyncCÚ‹xt
 *
c
, *
»¶y
, *
´ivd©a
) {

2264 
£Áš–RedisIn¡ªû
 *
ri
 = 
´ivd©a
;

2265 
š¡ªûLšk
 *
lšk
 = 
c
->
d©a
;

2266 
»disR•ly
 *
r
;

2268 ià(!
»¶y
 || !
lšk
) ;

2269 
lšk
->
³ndšg_commªds
--;

2270 
r
 = 
»¶y
;

2272 ià(
r
->
ty³
 =ğ
REDIS_REPLY_STATUS
 ||

2273 
r
->
ty³
 =ğ
REDIS_REPLY_ERROR
) {

2276 ià(
	`¡ºcmp
(
r
->
¡r
,"PONG",4) == 0 ||

2277 
	`¡ºcmp
(
r
->
¡r
,"LOADING",7) == 0 ||

2278 
	`¡ºcmp
(
r
->
¡r
,"MASTERDOWN",10) == 0)

2280 
lšk
->
Ï¡_ava_time
 = 
	`m¡ime
();

2281 
lšk
->
aù_pšg_time
 = 0;

2285 ià(
	`¡ºcmp
(
r
->
¡r
,"BUSY",4) == 0 &&

2286 (
ri
->
æags
 & 
SRI_S_DOWN
) &&

2287 !(
ri
->
æags
 & 
SRI_SCRIPT_KILL_SENT
))

2289 ià(
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

2290 
£Áš–DisÿrdR•lyC®lback
, 
ri
,

2291 "SCRIPT KILL"è=ğ
C_OK
)

2292 
ri
->
lšk
->
³ndšg_commªds
++;

2293 
ri
->
æags
 |ğ
SRI_SCRIPT_KILL_SENT
;

2297 
lšk
->
Ï¡_pÚg_time
 = 
	`m¡ime
();

2298 
	}
}

2302 
	$£Áš–PublishR•lyC®lback
(
»disAsyncCÚ‹xt
 *
c
, *
»¶y
, *
´ivd©a
) {

2303 
£Áš–RedisIn¡ªû
 *
ri
 = 
´ivd©a
;

2304 
š¡ªûLšk
 *
lšk
 = 
c
->
d©a
;

2305 
»disR•ly
 *
r
;

2307 ià(!
»¶y
 || !
lšk
) ;

2308 
lšk
->
³ndšg_commªds
--;

2309 
r
 = 
»¶y
;

2313 ià(
r
->
ty³
 !ğ
REDIS_REPLY_ERROR
)

2314 
ri
->
Ï¡_pub_time
 = 
	`m¡ime
();

2315 
	}
}

2322 
	$£Áš–ProûssH–loMes§ge
(*
h–lo
, 
h–lo_Ën
) {

2326 
numtok’s
, 
pÜt
, 
»moved
, 
ma¡”_pÜt
;

2327 
ušt64_t
 
cu¼’t_•och
, 
ma¡”_cÚfig_•och
;

2328 **
tok’
 = 
	`sds¥l™Ën
(
h–lo
, 
h–lo_Ën
, ",", 1, &
numtok’s
);

2329 
£Áš–RedisIn¡ªû
 *
si
, *
ma¡”
;

2331 ià(
numtok’s
 == 8) {

2333 
ma¡”
 = 
	`£Áš–G‘Ma¡”ByName
(
tok’
[4]);

2334 ià(!
ma¡”
è
ş—nup
;

2337 
pÜt
 = 
	`©oi
(
tok’
[1]);

2338 
ma¡”_pÜt
 = 
	`©oi
(
tok’
[6]);

2339 
si
 = 
	`g‘S’tš–RedisIn¡ªûByAddrAndRunID
(

2340 
ma¡”
->
£Áš–s
,
tok’
[0],
pÜt
,token[2]);

2341 
cu¼’t_•och
 = 
	`¡¹ouÎ
(
tok’
[3],
NULL
,10);

2342 
ma¡”_cÚfig_•och
 = 
	`¡¹ouÎ
(
tok’
[7],
NULL
,10);

2344 ià(!
si
) {

2348 
»moved
 = 
	`»moveM©chšgS’tš–FromMa¡”
(
ma¡”
,
tok’
[2]);

2349 ià(
»moved
) {

2350 
	`£Áš–Ev’t
(
LL_NOTICE
,"+£Áš–-add»ss-sw™ch",
ma¡”
,

2351 "%@ i°% pÜˆ%d fÜ %s", 
tok’
[0],
pÜt
,token[2]);

2357 
£Áš–RedisIn¡ªû
 *
Ùh”
 =

2358 
	`g‘S’tš–RedisIn¡ªûByAddrAndRunID
(

2359 
ma¡”
->
£Áš–s
, 
tok’
[0],
pÜt
,
NULL
);

2360 ià(
Ùh”
) {

2361 
	`£Áš–Ev’t
(
LL_NOTICE
,"+£Áš–-šv®id-addr",
Ùh”
,"%@");

2362 
Ùh”
->
addr
->
pÜt
 = 0;

2363 
	`£Áš–Upd©eS’tš–Add»ssInAÎMa¡”s
(
Ùh”
);

2368 
si
 = 
	`ü—‹S’tš–RedisIn¡ªû
(
tok’
[2],
SRI_SENTINEL
,

2369 
tok’
[0],
pÜt
,
ma¡”
->
quÜum
,master);

2371 ià(
si
) {

2372 ià(!
»moved
è
	`£Áš–Ev’t
(
LL_NOTICE
,"+£Áš–",
si
,"%@");

2376 
si
->
runid
 = 
	`sd¢ew
(
tok’
[2]);

2377 
	`£Áš–TryCÚÃùiÚSh¬šg
(
si
);

2378 ià(
»moved
è
	`£Áš–Upd©eS’tš–Add»ssInAÎMa¡”s
(
si
);

2379 
	`£Áš–FlushCÚfig
();

2384 ià(
cu¼’t_•och
 > 
£Áš–
.current_epoch) {

2385 
£Áš–
.
cu¼’t_•och
 = current_epoch;

2386 
	`£Áš–FlushCÚfig
();

2387 
	`£Áš–Ev’t
(
LL_WARNING
,"+Ãw-•och",
ma¡”
,"%llu",

2388 (è
£Áš–
.
cu¼’t_•och
);

2392 ià(
si
 && 
ma¡”
->
cÚfig_•och
 < 
ma¡”_cÚfig_•och
) {

2393 
ma¡”
->
cÚfig_•och
 = 
ma¡”_cÚfig_•och
;

2394 ià(
ma¡”_pÜt
 !ğ
ma¡”
->
addr
->
pÜt
 ||

2395 
	`¡rcmp
(
ma¡”
->
addr
->

, 
tok’
[5]))

2397 
£Áš–Addr
 *
Şd_addr
;

2399 
	`£Áš–Ev’t
(
LL_WARNING
,"+cÚfig-upd©e-äom",
si
,"%@");

2400 
	`£Áš–Ev’t
(
LL_WARNING
,"+switch-master",

2401 
ma¡”
,"%s %s %d %s %d",

2402 
ma¡”
->
Çme
,

2403 
ma¡”
->
addr
->

, ma¡”->addr->
pÜt
,

2404 
tok’
[5], 
ma¡”_pÜt
);

2406 
Şd_addr
 = 
	`dupS’tš–Addr
(
ma¡”
->
addr
);

2407 
	`£Áš–Re£tMa¡”AndChªgeAdd»ss
(
ma¡”
, 
tok’
[5], 
ma¡”_pÜt
);

2408 
	`£Áš–C®lCl›ÁRecÚfSüt
(
ma¡”
,

2409 
SENTINEL_OBSERVER
,"start",

2410 
Şd_addr
,
ma¡”
->
addr
);

2411 
	`»Ëa£S’tš–Addr
(
Şd_addr
);

2416 ià(
si
èsi->
Ï¡_h–lo_time
 = 
	`m¡ime
();

2419 
ş—nup
:

2420 
	`sdsä“¥l™»s
(
tok’
,
numtok’s
);

2421 
	}
}

2426 
	$£Áš–ReûiveH–loMes§ges
(
»disAsyncCÚ‹xt
 *
c
, *
»¶y
, *
´ivd©a
) {

2427 
£Áš–RedisIn¡ªû
 *
ri
 = 
´ivd©a
;

2428 
»disR•ly
 *
r
;

2429 
	`UNUSED
(
c
);

2431 ià(!
»¶y
 || !
ri
) ;

2432 
r
 = 
»¶y
;

2437 
ri
->
lšk
->
pc_Ï¡_aùiv™y
 = 
	`m¡ime
();

2441 ià(
r
->
ty³
 !ğ
REDIS_REPLY_ARRAY
 ||

2442 
r
->
–em’ts
 != 3 ||

2443 
r
->
–em’t
[0]->
ty³
 !ğ
REDIS_REPLY_STRING
 ||

2444 
r
->
–em’t
[1]->
ty³
 !ğ
REDIS_REPLY_STRING
 ||

2445 
r
->
–em’t
[2]->
ty³
 !ğ
REDIS_REPLY_STRING
 ||

2446 
	`¡rcmp
(
r
->
–em’t
[0]->
¡r
,"message") != 0) ;

2449 ià(
	`¡r¡r
(
r
->
–em’t
[2]->
¡r
,
£Áš–
.
myid
è!ğ
NULL
) ;

2451 
	`£Áš–ProûssH–loMes§ge
(
r
->
–em’t
[2]->
¡r
,„->–em’t[2]->
Ën
);

2452 
	}
}

2465 
	$£Áš–S’dH–lo
(
£Áš–RedisIn¡ªû
 *
ri
) {

2466 

[
NET_IP_STR_LEN
];

2467 
·ylßd
[
NET_IP_STR_LEN
+1024];

2468 
»tv®
;

2469 *
ªnounû_
;

2470 
ªnounû_pÜt
;

2471 
£Áš–RedisIn¡ªû
 *
ma¡”
 = (
ri
->
æags
 & 
SRI_MASTER
) ?„i :„i->master;

2472 
£Áš–Addr
 *
ma¡”_addr
 = 
	`£Áš–G‘Cu¼’tMa¡”Add»ss
(
ma¡”
);

2474 ià(
ri
->
lšk
->
discÚÃùed
è 
C_ERR
;

2478 ià(
£Áš–
.
ªnounû_
) {

2479 
ªnounû_
 = 
£Áš–
.announce_ip;

2481 ià(
	`ª‘SockName
(
ri
->
lšk
->
cc
->
c
.
fd
,

,(),
NULL
) == -1)

2482  
C_ERR
;

2483 
ªnounû_
 = 

;

2485 
ªnounû_pÜt
 = 
£Áš–
.announce_port ?

2486 
£Áš–
.
ªnounû_pÜt
 : 
£rv”
.
pÜt
;

2489 
	`¢´štf
(
·ylßd
,(payload),

2492 
ªnounû_
, 
ªnounû_pÜt
, 
£Áš–
.
myid
,

2493 (è
£Áš–
.
cu¼’t_•och
,

2495 
ma¡”
->
Çme
,
ma¡”_addr
->

,ma¡”_addr->
pÜt
,

2496 (è
ma¡”
->
cÚfig_•och
);

2497 
»tv®
 = 
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

2498 
£Áš–PublishR•lyC®lback
, 
ri
, "PUBLISH %s %s",

2499 
SENTINEL_HELLO_CHANNEL
,
·ylßd
);

2500 ià(
»tv®
 !ğ
C_OK
è 
C_ERR
;

2501 
ri
->
lšk
->
³ndšg_commªds
++;

2502  
C_OK
;

2503 
	}
}

2507 
	$£Áš–FÜûH–loUpd©eDiùOfRedisIn¡ªûs
(
diù
 *
š¡ªûs
) {

2508 
diùI‹¿tÜ
 *
di
;

2509 
diùEÁry
 *
de
;

2511 
di
 = 
	`diùG‘SaãI‹¿tÜ
(
š¡ªûs
);

2512 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

2513 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

2514 ià(
ri
->
Ï¡_pub_time
 >ğ(
SENTINEL_PUBLISH_PERIOD
+1))

2515 
ri
->
Ï¡_pub_time
 -ğ(
SENTINEL_PUBLISH_PERIOD
+1);

2517 
	`diùR–—£I‹¿tÜ
(
di
);

2518 
	}
}

2528 
	$£Áš–FÜûH–loUpd©eFÜMa¡”
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

2529 ià(!(
ma¡”
->
æags
 & 
SRI_MASTER
)è 
C_ERR
;

2530 ià(
ma¡”
->
Ï¡_pub_time
 >ğ(
SENTINEL_PUBLISH_PERIOD
+1))

2531 
ma¡”
->
Ï¡_pub_time
 -ğ(
SENTINEL_PUBLISH_PERIOD
+1);

2532 
	`£Áš–FÜûH–loUpd©eDiùOfRedisIn¡ªûs
(
ma¡”
->
£Áš–s
);

2533 
	`£Áš–FÜûH–loUpd©eDiùOfRedisIn¡ªûs
(
ma¡”
->
¦aves
);

2534  
C_OK
;

2535 
	}
}

2542 
	$£Áš–S’dPšg
(
£Áš–RedisIn¡ªû
 *
ri
) {

2543 
»tv®
 = 
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

2544 
£Áš–PšgR•lyC®lback
, 
ri
, "PING");

2545 ià(
»tv®
 =ğ
C_OK
) {

2546 
ri
->
lšk
->
³ndšg_commªds
++;

2547 
ri
->
lšk
->
Ï¡_pšg_time
 = 
	`m¡ime
();

2551 ià(
ri
->
lšk
->
aù_pšg_time
 == 0)

2552 
ri
->
lšk
->
aù_pšg_time
 =„i->lšk->
Ï¡_pšg_time
;

2557 
	}
}

2561 
	$£Áš–S’dP”iodicCommªds
(
£Áš–RedisIn¡ªû
 *
ri
) {

2562 
m¡ime_t
 
now
 = 
	`m¡ime
();

2563 
m¡ime_t
 
šfo_³riod
, 
pšg_³riod
;

2564 
»tv®
;

2568 ià(
ri
->
lšk
->
discÚÃùed
) ;

2576 ià(
ri
->
lšk
->
³ndšg_commªds
 >=

2577 
SENTINEL_MAX_PENDING_COMMANDS
 * 
ri
->
lšk
->
»fcouÁ
) ;

2587 ià((
ri
->
æags
 & 
SRI_SLAVE
) &&

2588 ((
ri
->
ma¡”
->
æags
 & (
SRI_O_DOWN
|
SRI_FAILOVER_IN_PROGRESS
)) ||

2589 (
ri
->
ma¡”_lšk_down_time
 != 0)))

2591 
šfo_³riod
 = 1000;

2593 
šfo_³riod
 = 
SENTINEL_INFO_PERIOD
;

2599 
pšg_³riod
 = 
ri
->
down_aá”_³riod
;

2600 ià(
pšg_³riod
 > 
SENTINEL_PING_PERIOD
)…ing_period = SENTINEL_PING_PERIOD;

2602 ià((
ri
->
æags
 & 
SRI_SENTINEL
) == 0 &&

2603 (
ri
->
šfo_»äesh
 == 0 ||

2604 (
now
 - 
ri
->
šfo_»äesh
è> 
šfo_³riod
))

2607 
»tv®
 = 
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

2608 
£Áš–InfoR•lyC®lback
, 
ri
, "INFO");

2609 ià(
»tv®
 =ğ
C_OK
è
ri
->
lšk
->
³ndšg_commªds
++;

2610 } ià((
now
 - 
ri
->
lšk
->
Ï¡_pÚg_time
è> 
pšg_³riod
 &&

2611 (
now
 - 
ri
->
lšk
->
Ï¡_pšg_time
è> 
pšg_³riod
/2) {

2613 
	`£Áš–S’dPšg
(
ri
);

2614 } ià((
now
 - 
ri
->
Ï¡_pub_time
è> 
SENTINEL_PUBLISH_PERIOD
) {

2616 
	`£Áš–S’dH–lo
(
ri
);

2618 
	}
}

2622 cÚ¡ *
	$£Áš–Faov”S‹SŒ
(
¡©e
) {

2623 
¡©e
) {

2624 
SENTINEL_FAILOVER_STATE_NONE
:  "none";

2625 
SENTINEL_FAILOVER_STATE_WAIT_START
:  "wait_start";

2626 
SENTINEL_FAILOVER_STATE_SELECT_SLAVE
:  "select_slave";

2627 
SENTINEL_FAILOVER_STATE_SEND_SLAVEOF_NOONE
:  "send_slaveof_noone";

2628 
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
:  "wait_promotion";

2629 
SENTINEL_FAILOVER_STATE_RECONF_SLAVES
:  "reconf_slaves";

2630 
SENTINEL_FAILOVER_STATE_UPDATE_CONFIG
:  "update_config";

2633 
	}
}

2636 
	$addR•lyS’tš–RedisIn¡ªû
(
ş›Á
 *
c
, 
£Áš–RedisIn¡ªû
 *
ri
) {

2637 *
æags
 = 
	`sd£m±y
();

2638 *
mbl
;

2639 
f›lds
 = 0;

2641 
mbl
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

2643 
	`addR•lyBulkCSŒšg
(
c
,"name");

2644 
	`addR•lyBulkCSŒšg
(
c
,
ri
->
Çme
);

2645 
f›lds
++;

2647 
	`addR•lyBulkCSŒšg
(
c
,"ip");

2648 
	`addR•lyBulkCSŒšg
(
c
,
ri
->
addr
->

);

2649 
f›lds
++;

2651 
	`addR•lyBulkCSŒšg
(
c
,"port");

2652 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
addr
->
pÜt
);

2653 
f›lds
++;

2655 
	`addR•lyBulkCSŒšg
(
c
,"runid");

2656 
	`addR•lyBulkCSŒšg
(
c
,
ri
->
runid
 ?„i->runid : "");

2657 
f›lds
++;

2659 
	`addR•lyBulkCSŒšg
(
c
,"flags");

2660 ià(
ri
->
æags
 & 
SRI_S_DOWN
èæag ğ
	`sdsÿt
(flags,"s_down,");

2661 ià(
ri
->
æags
 & 
SRI_O_DOWN
èæag ğ
	`sdsÿt
(flags,"o_down,");

2662 ià(
ri
->
æags
 & 
SRI_MASTER
èæag ğ
	`sdsÿt
(flags,"master,");

2663 ià(
ri
->
æags
 & 
SRI_SLAVE
èæag ğ
	`sdsÿt
(flags,"slave,");

2664 ià(
ri
->
æags
 & 
SRI_SENTINEL
èæag ğ
	`sdsÿt
(flags,"sentinel,");

2665 ià(
ri
->
lšk
->
discÚÃùed
è
æags
 = 
	`sdsÿt
(flags,"disconnected,");

2666 ià(
ri
->
æags
 & 
SRI_MASTER_DOWN
èæag ğ
	`sdsÿt
(flags,"master_down,");

2667 ià(
ri
->
æags
 & 
SRI_FAILOVER_IN_PROGRESS
)

2668 
æags
 = 
	`sdsÿt
(flags,"failover_in_progress,");

2669 ià(
ri
->
æags
 & 
SRI_PROMOTED
èæag ğ
	`sdsÿt
(flags,"promoted,");

2670 ià(
ri
->
æags
 & 
SRI_RECONF_SENT
èæag ğ
	`sdsÿt
(flags,"reconf_sent,");

2671 ià(
ri
->
æags
 & 
SRI_RECONF_INPROG
èæag ğ
	`sdsÿt
(flags,"reconf_inprog,");

2672 ià(
ri
->
æags
 & 
SRI_RECONF_DONE
èæag ğ
	`sdsÿt
(flags,"reconf_done,");

2674 ià(
	`sd¦’
(
æags
è!ğ0è
	`sd¤ªge
(flags,0,-2);

2675 
	`addR•lyBulkCSŒšg
(
c
,
æags
);

2676 
	`sdsä“
(
æags
);

2677 
f›lds
++;

2679 
	`addR•lyBulkCSŒšg
(
c
,"link-pending-commands");

2680 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
lšk
->
³ndšg_commªds
);

2681 
f›lds
++;

2683 
	`addR•lyBulkCSŒšg
(
c
,"link-refcount");

2684 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
lšk
->
»fcouÁ
);

2685 
f›lds
++;

2687 ià(
ri
->
æags
 & 
SRI_FAILOVER_IN_PROGRESS
) {

2688 
	`addR•lyBulkCSŒšg
(
c
,"failover-state");

2689 
	`addR•lyBulkCSŒšg
(
c
,(*)
	`£Áš–Faov”S‹SŒ
(
ri
->
çov”_¡©e
));

2690 
f›lds
++;

2693 
	`addR•lyBulkCSŒšg
(
c
,"last-ping-sent");

2694 
	`addR•lyBulkLÚgLÚg
(
c
,

2695 
ri
->
lšk
->
aù_pšg_time
 ? (
	`m¡ime
() -„i->link->act_ping_time) : 0);

2696 
f›lds
++;

2698 
	`addR•lyBulkCSŒšg
(
c
,"last-ok-ping-reply");

2699 
	`addR•lyBulkLÚgLÚg
(
c
,
	`m¡ime
(è- 
ri
->
lšk
->
Ï¡_ava_time
);

2700 
f›lds
++;

2702 
	`addR•lyBulkCSŒšg
(
c
,"last-ping-reply");

2703 
	`addR•lyBulkLÚgLÚg
(
c
,
	`m¡ime
(è- 
ri
->
lšk
->
Ï¡_pÚg_time
);

2704 
f›lds
++;

2706 ià(
ri
->
æags
 & 
SRI_S_DOWN
) {

2707 
	`addR•lyBulkCSŒšg
(
c
,"s-down-time");

2708 
	`addR•lyBulkLÚgLÚg
(
c
,
	`m¡ime
()-
ri
->
s_down_sšû_time
);

2709 
f›lds
++;

2712 ià(
ri
->
æags
 & 
SRI_O_DOWN
) {

2713 
	`addR•lyBulkCSŒšg
(
c
,"o-down-time");

2714 
	`addR•lyBulkLÚgLÚg
(
c
,
	`m¡ime
()-
ri
->
o_down_sšû_time
);

2715 
f›lds
++;

2718 
	`addR•lyBulkCSŒšg
(
c
,"down-after-milliseconds");

2719 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
down_aá”_³riod
);

2720 
f›lds
++;

2723 ià(
ri
->
æags
 & (
SRI_MASTER
|
SRI_SLAVE
)) {

2724 
	`addR•lyBulkCSŒšg
(
c
,"info-refresh");

2725 
	`addR•lyBulkLÚgLÚg
(
c
,
	`m¡ime
(è- 
ri
->
šfo_»äesh
);

2726 
f›lds
++;

2728 
	`addR•lyBulkCSŒšg
(
c
,"role-reported");

2729 
	`addR•lyBulkCSŒšg
(
c
, (
ri
->
rŞe_»pÜ‹d
 =ğ
SRI_MASTER
) ? "master" :

2731 
f›lds
++;

2733 
	`addR•lyBulkCSŒšg
(
c
,"role-reported-time");

2734 
	`addR•lyBulkLÚgLÚg
(
c
,
	`m¡ime
(è- 
ri
->
rŞe_»pÜ‹d_time
);

2735 
f›lds
++;

2739 ià(
ri
->
æags
 & 
SRI_MASTER
) {

2740 
	`addR•lyBulkCSŒšg
(
c
,"config-epoch");

2741 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
cÚfig_•och
);

2742 
f›lds
++;

2744 
	`addR•lyBulkCSŒšg
(
c
,"num-slaves");

2745 
	`addR•lyBulkLÚgLÚg
(
c
,
	`diùSize
(
ri
->
¦aves
));

2746 
f›lds
++;

2748 
	`addR•lyBulkCSŒšg
(
c
,"num-other-sentinels");

2749 
	`addR•lyBulkLÚgLÚg
(
c
,
	`diùSize
(
ri
->
£Áš–s
));

2750 
f›lds
++;

2752 
	`addR•lyBulkCSŒšg
(
c
,"quorum");

2753 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
quÜum
);

2754 
f›lds
++;

2756 
	`addR•lyBulkCSŒšg
(
c
,"failover-timeout");

2757 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
çov”_timeout
);

2758 
f›lds
++;

2760 
	`addR•lyBulkCSŒšg
(
c
,"parallel-syncs");

2761 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
·¿Î–_syncs
);

2762 
f›lds
++;

2764 ià(
ri
->
nÙifiÿtiÚ_süt
) {

2765 
	`addR•lyBulkCSŒšg
(
c
,"notification-script");

2766 
	`addR•lyBulkCSŒšg
(
c
,
ri
->
nÙifiÿtiÚ_süt
);

2767 
f›lds
++;

2770 ià(
ri
->
ş›Á_»cÚfig_süt
) {

2771 
	`addR•lyBulkCSŒšg
(
c
,"client-reconfig-script");

2772 
	`addR•lyBulkCSŒšg
(
c
,
ri
->
ş›Á_»cÚfig_süt
);

2773 
f›lds
++;

2778 ià(
ri
->
æags
 & 
SRI_SLAVE
) {

2779 
	`addR•lyBulkCSŒšg
(
c
,"master-link-down-time");

2780 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
ma¡”_lšk_down_time
);

2781 
f›lds
++;

2783 
	`addR•lyBulkCSŒšg
(
c
,"master-link-status");

2784 
	`addR•lyBulkCSŒšg
(
c
,

2785 (
ri
->
¦ave_ma¡”_lšk_¡©us
 =ğ
SENTINEL_MASTER_LINK_STATUS_UP
) ?

2787 
f›lds
++;

2789 
	`addR•lyBulkCSŒšg
(
c
,"master-host");

2790 
	`addR•lyBulkCSŒšg
(
c
,

2791 
ri
->
¦ave_ma¡”_ho¡
 ?„i->slave_master_host : "?");

2792 
f›lds
++;

2794 
	`addR•lyBulkCSŒšg
(
c
,"master-port");

2795 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
¦ave_ma¡”_pÜt
);

2796 
f›lds
++;

2798 
	`addR•lyBulkCSŒšg
(
c
,"slave-priority");

2799 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
¦ave_´iÜ™y
);

2800 
f›lds
++;

2802 
	`addR•lyBulkCSŒšg
(
c
,"slave-repl-offset");

2803 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
¦ave_»¶_off£t
);

2804 
f›lds
++;

2808 ià(
ri
->
æags
 & 
SRI_SENTINEL
) {

2809 
	`addR•lyBulkCSŒšg
(
c
,"last-hello-message");

2810 
	`addR•lyBulkLÚgLÚg
(
c
,
	`m¡ime
(è- 
ri
->
Ï¡_h–lo_time
);

2811 
f›lds
++;

2813 
	`addR•lyBulkCSŒšg
(
c
,"voted-leader");

2814 
	`addR•lyBulkCSŒšg
(
c
,
ri
->
Ëad”
 ?„i->leader : "?");

2815 
f›lds
++;

2817 
	`addR•lyBulkCSŒšg
(
c
,"voted-leader-epoch");

2818 
	`addR•lyBulkLÚgLÚg
(
c
,
ri
->
Ëad”_•och
);

2819 
f›lds
++;

2822 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
mbl
,
f›lds
*2);

2823 
	}
}

2827 
	$addR•lyDiùOfRedisIn¡ªûs
(
ş›Á
 *
c
, 
diù
 *
š¡ªûs
) {

2828 
diùI‹¿tÜ
 *
di
;

2829 
diùEÁry
 *
de
;

2831 
di
 = 
	`diùG‘I‹¿tÜ
(
š¡ªûs
);

2832 
	`addR•lyMuÉiBulkL’
(
c
,
	`diùSize
(
š¡ªûs
));

2833 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

2834 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

2836 
	`addR•lyS’tš–RedisIn¡ªû
(
c
,
ri
);

2838 
	`diùR–—£I‹¿tÜ
(
di
);

2839 
	}
}

2844 
£Áš–RedisIn¡ªû
 *
	$£Áš–G‘Ma¡”ByNameOrR•lyE¼Ü
(
ş›Á
 *
c
,

2845 
robj
 *
Çme
)

2847 
£Áš–RedisIn¡ªû
 *
ri
;

2849 
ri
 = 
	`diùF‘chV®ue
(
£Áš–
.
ma¡”s
,
Çme
->
±r
);

2850 ià(!
ri
) {

2851 
	`addR•lyE¼Ü
(
c
,"No such master withhat‚ame");

2852  
NULL
;

2854  
ri
;

2855 
	}
}

2857 
	#SENTINEL_ISQR_OK
 0

	)

2858 
	#SENTINEL_ISQR_NOQUORUM
 (1<<0)

	)

2859 
	#SENTINEL_ISQR_NOAUTH
 (1<<1)

	)

2860 
	$£Áš–IsQuÜumR—chabË
(
£Áš–RedisIn¡ªû
 *
ma¡”
, *
u§bË±r
) {

2861 
diùI‹¿tÜ
 *
di
;

2862 
diùEÁry
 *
de
;

2863 
u§bË
 = 1;

2864 
»suÉ
 = 
SENTINEL_ISQR_OK
;

2865 
vÙ”s
 = 
	`diùSize
(
ma¡”
->
£Áš–s
)+1;

2867 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
£Áš–s
);

2868 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

2869 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

2871 ià(
ri
->
æags
 & (
SRI_S_DOWN
|
SRI_O_DOWN
)) ;

2872 
u§bË
++;

2874 
	`diùR–—£I‹¿tÜ
(
di
);

2876 ià(
u§bË
 < ()
ma¡”
->
quÜum
è
»suÉ
 |ğ
SENTINEL_ISQR_NOQUORUM
;

2877 ià(
u§bË
 < 
vÙ”s
/2+1è
»suÉ
 |ğ
SENTINEL_ISQR_NOAUTH
;

2878 ià(
u§bË±r
è*u§bË±¸ğ
u§bË
;

2879  
»suÉ
;

2880 
	}
}

2882 
	$£Áš–Commªd
(
ş›Á
 *
c
) {

2883 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"masters")) {

2885 ià(
c
->
¬gc
 !ğ2è
num¬g£¼
;

2886 
	`addR•lyDiùOfRedisIn¡ªûs
(
c
,
£Áš–
.
ma¡”s
);

2887 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"master")) {

2889 
£Áš–RedisIn¡ªû
 *
ri
;

2891 ià(
c
->
¬gc
 !ğ3è
num¬g£¼
;

2892 ià((
ri
 = 
	`£Áš–G‘Ma¡”ByNameOrR•lyE¼Ü
(
c
,c->
¬gv
[2]))

2893 =ğ
NULL
) ;

2894 
	`addR•lyS’tš–RedisIn¡ªû
(
c
,
ri
);

2895 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"slaves")) {

2897 
£Áš–RedisIn¡ªû
 *
ri
;

2899 ià(
c
->
¬gc
 !ğ3è
num¬g£¼
;

2900 ià((
ri
 = 
	`£Áš–G‘Ma¡”ByNameOrR•lyE¼Ü
(
c
,c->
¬gv
[2])è=ğ
NULL
)

2902 
	`addR•lyDiùOfRedisIn¡ªûs
(
c
,
ri
->
¦aves
);

2903 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"sentinels")) {

2905 
£Áš–RedisIn¡ªû
 *
ri
;

2907 ià(
c
->
¬gc
 !ğ3è
num¬g£¼
;

2908 ià((
ri
 = 
	`£Áš–G‘Ma¡”ByNameOrR•lyE¼Ü
(
c
,c->
¬gv
[2])è=ğ
NULL
)

2910 
	`addR•lyDiùOfRedisIn¡ªûs
(
c
,
ri
->
£Áš–s
);

2911 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"is-master-down-by-addr")) {

2929 
£Áš–RedisIn¡ªû
 *
ri
;

2930 
»q_•och
;

2931 
ušt64_t
 
Ëad”_•och
 = 0;

2932 *
Ëad”
 = 
NULL
;

2933 
pÜt
;

2934 
isdown
 = 0;

2936 ià(
c
->
¬gc
 !ğ6è
num¬g£¼
;

2937 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
pÜt
,
NULL
è!ğ
C_OK
 ||

2938 
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[4],&
»q_•och
,
NULL
)

2939 !ğ
C_OK
)

2941 
ri
 = 
	`g‘S’tš–RedisIn¡ªûByAddrAndRunID
(
£Áš–
.
ma¡”s
,

2942 
c
->
¬gv
[2]->
±r
,
pÜt
,
NULL
);

2946 ià(!
£Áš–
.
tt
 && 
ri
 && (ri->
æags
 & 
SRI_S_DOWN
) &&

2947 (
ri
->
æags
 & 
SRI_MASTER
))

2948 
isdown
 = 1;

2952 ià(
ri
 &&„i->
æags
 & 
SRI_MASTER
 && 
	`¡rÿ£cmp
(
c
->
¬gv
[5]->
±r
,"*")) {

2953 
Ëad”
 = 
	`£Áš–VÙeL—d”
(
ri
,(
ušt64_t
)
»q_•och
,

2954 
c
->
¬gv
[5]->
±r
,

2955 &
Ëad”_•och
);

2960 
	`addR•lyMuÉiBulkL’
(
c
,3);

2961 
	`addR•ly
(
c
, 
isdown
 ? 
sh¬ed
.
cÚe
 : sh¬ed.
cz”o
);

2962 
	`addR•lyBulkCSŒšg
(
c
, 
Ëad”
 ?†eader : "*");

2963 
	`addR•lyLÚgLÚg
(
c
, ()
Ëad”_•och
);

2964 ià(
Ëad”
è
	`sdsä“
(leader);

2965 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"reset")) {

2967 ià(
c
->
¬gc
 !ğ3è
num¬g£¼
;

2968 
	`addR•lyLÚgLÚg
(
c
,
	`£Áš–Re£tMa¡”sByP©‹º
(c->
¬gv
[2]->
±r
,
SENTINEL_GENERATE_EVENT
));

2969 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"get-master-addr-by-name")) {

2971 
£Áš–RedisIn¡ªû
 *
ri
;

2973 ià(
c
->
¬gc
 !ğ3è
num¬g£¼
;

2974 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
c
->
¬gv
[2]->
±r
);

2975 ià(
ri
 =ğ
NULL
) {

2976 
	`addR•ly
(
c
,
sh¬ed
.
nuÎmuÉibulk
);

2978 
£Áš–Addr
 *
addr
 = 
	`£Áš–G‘Cu¼’tMa¡”Add»ss
(
ri
);

2980 
	`addR•lyMuÉiBulkL’
(
c
,2);

2981 
	`addR•lyBulkCSŒšg
(
c
,
addr
->

);

2982 
	`addR•lyBulkLÚgLÚg
(
c
,
addr
->
pÜt
);

2984 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"failover")) {

2986 
£Áš–RedisIn¡ªû
 *
ri
;

2988 ià(
c
->
¬gc
 !ğ3è
num¬g£¼
;

2989 ià((
ri
 = 
	`£Áš–G‘Ma¡”ByNameOrR•lyE¼Ü
(
c
,c->
¬gv
[2])è=ğ
NULL
)

2991 ià(
ri
->
æags
 & 
SRI_FAILOVER_IN_PROGRESS
) {

2992 
	`addR•lySds
(
c
,
	`sd¢ew
("-INPROG Failover‡lready in…rogress\r\n"));

2995 ià(
	`£Áš–S–eùSÏve
(
ri
è=ğ
NULL
) {

2996 
	`addR•lySds
(
c
,
	`sd¢ew
("-NOGOODSLAVE No suitable slaveo…romote\r\n"));

2999 
	`£rv”Log
(
LL_WARNING
,"Executing user„equested FAILOVER of '%s'",

3000 
ri
->
Çme
);

3001 
	`£Áš–S¹Faov”
(
ri
);

3002 
ri
->
æags
 |ğ
SRI_FORCE_FAILOVER
;

3003 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3004 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"pending-scripts")) {

3007 ià(
c
->
¬gc
 !ğ2è
num¬g£¼
;

3008 
	`£Áš–P’dšgSütsCommªd
(
c
);

3009 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"monitor")) {

3011 
£Áš–RedisIn¡ªû
 *
ri
;

3012 
quÜum
, 
pÜt
;

3013 

[
NET_IP_STR_LEN
];

3015 ià(
c
->
¬gc
 !ğ6è
num¬g£¼
;

3016 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[5],&
quÜum
,"Invalid quorum")

3017 !ğ
C_OK
) ;

3018 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[4],&
pÜt
,"Invalid…ort")

3019 !ğ
C_OK
) ;

3021 ià(
quÜum
 <= 0) {

3022 
	`addR•lyE¼Ü
(
c
, "Quorum must be 1 or greater.");

3029 ià(
	`ª‘ResŞveIP
(
NULL
,
c
->
¬gv
[3]->
±r
,

,()è=ğ
ANET_ERR
) {

3030 
	`addR•lyE¼Ü
(
c
,"Invalid IP‡ddress specified");

3035 
ri
 = 
	`ü—‹S’tš–RedisIn¡ªû
(
c
->
¬gv
[2]->
±r
,
SRI_MASTER
,

3036 
c
->
¬gv
[3]->
±r
,
pÜt
,
quÜum
,
NULL
);

3037 ià(
ri
 =ğ
NULL
) {

3038 
”ºo
) {

3039 
EBUSY
:

3040 
	`addR•lyE¼Ü
(
c
,"Duplicated master‚ame");

3042 
EINVAL
:

3043 
	`addR•lyE¼Ü
(
c
,"Invalid…ort‚umber");

3046 
	`addR•lyE¼Ü
(
c
,"Unspecifiedƒrror‡ddinghe instance");

3050 
	`£Áš–FlushCÚfig
();

3051 
	`£Áš–Ev’t
(
LL_WARNING
,"+mÚ™Ü",
ri
,"%@ quÜum %d",ri->
quÜum
);

3052 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3054 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"flushconfig")) {

3055 ià(
c
->
¬gc
 !ğ2è
num¬g£¼
;

3056 
	`£Áš–FlushCÚfig
();

3057 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3059 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"remove")) {

3061 
£Áš–RedisIn¡ªû
 *
ri
;

3063 ià(
c
->
¬gc
 !ğ3è
num¬g£¼
;

3064 ià((
ri
 = 
	`£Áš–G‘Ma¡”ByNameOrR•lyE¼Ü
(
c
,c->
¬gv
[2]))

3065 =ğ
NULL
) ;

3066 
	`£Áš–Ev’t
(
LL_WARNING
,"-mÚ™Ü",
ri
,"%@");

3067 
	`diùD–‘e
(
£Áš–
.
ma¡”s
,
c
->
¬gv
[2]->
±r
);

3068 
	`£Áš–FlushCÚfig
();

3069 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3070 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"ckquorum")) {

3072 
£Áš–RedisIn¡ªû
 *
ri
;

3073 
u§bË
;

3075 ià(
c
->
¬gc
 !ğ3è
num¬g£¼
;

3076 ià((
ri
 = 
	`£Áš–G‘Ma¡”ByNameOrR•lyE¼Ü
(
c
,c->
¬gv
[2]))

3077 =ğ
NULL
) ;

3078 
»suÉ
 = 
	`£Áš–IsQuÜumR—chabË
(
ri
,&
u§bË
);

3079 ià(
»suÉ
 =ğ
SENTINEL_ISQR_OK
) {

3080 
	`addR•lySds
(
c
, 
	`sdsÿtfmt
(
	`sd£m±y
(),

3082 "ÿÀb»ached\r\n",
u§bË
));

3084 
sds
 
e
 = 
	`sdsÿtfmt
(
	`sd£m±y
(),

3085 "-NOQUORUM %˜u§bË S’tš–s. ",
u§bË
);

3086 ià(
»suÉ
 & 
SENTINEL_ISQR_NOQUORUM
)

3087 
e
 = 
	`sdsÿt
(e,"Notƒnough‡vailable Sentinelso„eachhe"

3089 ià(
»suÉ
 & 
SENTINEL_ISQR_NOAUTH
) {

3090 ià(
»suÉ
 & 
SENTINEL_ISQR_NOQUORUM
è
e
 = 
	`sdsÿt
(e,". ");

3091 
e
 = 
	`sdsÿt
(e, "Notƒnough‡vailable Sentinelso„eachhe"

3094 
e
 = 
	`sdsÿt
(e,"\r\n");

3095 
	`addR•lySds
(
c
,
e
);

3097 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"set")) {

3098 ià(
c
->
¬gc
 < 3 || c->¬gø% 2 =ğ0è
num¬g£¼
;

3099 
	`£Áš–S‘Commªd
(
c
);

3100 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"info-cache")) {

3102 ià(
c
->
¬gc
 < 2è
num¬g£¼
;

3103 
m¡ime_t
 
now
 = 
	`m¡ime
();

3108 
diùTy³
 
cİy_k“³r
 = 
š¡ªûsDiùTy³
;

3109 
cİy_k“³r
.
v®De¡ruùÜ
 = 
NULL
;

3110 
diù
 *
ma¡”s_loÿl
 = 
£Áš–
.
ma¡”s
;

3111 ià(
c
->
¬gc
 > 2) {

3112 
ma¡”s_loÿl
 = 
	`diùC»©e
(&
cİy_k“³r
, 
NULL
);

3114 
i
 = 2; i < 
c
->
¬gc
; i++) {

3115 
£Áš–RedisIn¡ªû
 *
ri
;

3116 
ri
 = 
	`£Áš–G‘Ma¡”ByName
(
c
->
¬gv
[
i
]->
±r
);

3117 ià(!
ri
) ;

3118 
	`diùAdd
(
ma¡”s_loÿl
, 
ri
->
Çme
,„i);

3130 
	`addR•lyMuÉiBulkL’
(
c
,
	`diùSize
(
ma¡”s_loÿl
) * 2);

3132 
diùI‹¿tÜ
 *
di
;

3133 
diùEÁry
 *
de
;

3134 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”s_loÿl
);

3135 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3136 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

3137 
	`addR•lyBulkCBufãr
(
c
,
ri
->
Çme
,
	`¡¾’
(ri->name));

3138 
	`addR•lyMuÉiBulkL’
(
c
,
	`diùSize
(
ri
->
¦aves
) + 1);

3139 
	`addR•lyMuÉiBulkL’
(
c
,2);

3140 
	`addR•lyLÚgLÚg
(
c
, 
now
 - 
ri
->
šfo_»äesh
);

3141 ià(
ri
->
šfo
)

3142 
	`addR•lyBulkCBufãr
(
c
,
ri
->
šfo
,
	`sd¦’
(ri->info));

3144 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

3146 
diùI‹¿tÜ
 *
sdi
;

3147 
diùEÁry
 *
sde
;

3148 
sdi
 = 
	`diùG‘I‹¿tÜ
(
ri
->
¦aves
);

3149 (
sde
 = 
	`diùNext
(
sdi
)è!ğ
NULL
) {

3150 
£Áš–RedisIn¡ªû
 *
¤i
 = 
	`diùG‘V®
(
sde
);

3151 
	`addR•lyMuÉiBulkL’
(
c
,2);

3152 
	`addR•lyLÚgLÚg
(
c
, 
now
 - 
¤i
->
šfo_»äesh
);

3153 ià(
¤i
->
šfo
)

3154 
	`addR•lyBulkCBufãr
(
c
,
¤i
->
šfo
,
	`sd¦’
(sri->info));

3156 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

3158 
	`diùR–—£I‹¿tÜ
(
sdi
);

3160 
	`diùR–—£I‹¿tÜ
(
di
);

3161 ià(
ma¡”s_loÿl
 !ğ
£Áš–
.
ma¡”s
è
	`diùR–—£
(masters_local);

3162 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"simulate-failure")) {

3164 
j
;

3166 
£Áš–
.
simçu»_æags
 = 
SENTINEL_SIMFAILURE_NONE
;

3167 
j
 = 2; j < 
c
->
¬gc
; j++) {

3168 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"crash-after-election")) {

3169 
£Áš–
.
simçu»_æags
 |=

3170 
SENTINEL_SIMFAILURE_CRASH_AFTER_ELECTION
;

3171 
	`£rv”Log
(
LL_WARNING
,"Failure simulation:his Sentinel "

3174 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"crash-after-promotion")) {

3175 
£Áš–
.
simçu»_æags
 |=

3176 
SENTINEL_SIMFAILURE_CRASH_AFTER_PROMOTION
;

3177 
	`£rv”Log
(
LL_WARNING
,"Failure simulation:his Sentinel "

3179 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"help")) {

3180 
	`addR•lyMuÉiBulkL’
(
c
,2);

3181 
	`addR•lyBulkCSŒšg
(
c
,"crash-after-election");

3182 
	`addR•lyBulkCSŒšg
(
c
,"crash-after-promotion");

3184 
	`addR•lyE¼Ü
(
c
,"Unknown failure simulation specified");

3188 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3190 
	`addR•lyE¼ÜFÜm©
(
c
,"Unknown sentinel subcommand '%s'",

3191 (*)
c
->
¬gv
[1]->
±r
);

3195 
num¬g£¼
:

3196 
	`addR•lyE¼ÜFÜm©
(
c
,"Wrong‚umber of‡rguments for 'sentinel %s'",

3197 (*)
c
->
¬gv
[1]->
±r
);

3198 
	}
}

3200 
	#šfo_£ùiÚ_äom_»dis
(
£ùiÚ_Çme
) do { \

3201 ià(
def£ùiÚs
 || 
®l£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,
£ùiÚ_Çme
)) { \

3202 
sds
 
»dis£ùiÚ
; \

3203 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n"); \

3204 
»dis£ùiÚ
 = 
	`g’RedisInfoSŒšg
(
£ùiÚ_Çme
); \

3205 
šfo
 = 
	`sdsÿ’
(šfo,
»dis£ùiÚ
,
	`sd¦’
(redissection)); \

3206 
	`sdsä“
(
»dis£ùiÚ
); \

3208 } 0)

	)

3211 
	$£Áš–InfoCommªd
(
ş›Á
 *
c
) {

3212 ià(
c
->
¬gc
 > 2) {

3213 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

3217 
def£ùiÚs
 = 0, 
®l£ùiÚs
 = 0;

3218 *
£ùiÚ
 = 
c
->
¬gc
 =ğ2 ? c->
¬gv
[1]->
±r
 : 
NULL
;

3219 ià(
£ùiÚ
) {

3220 
®l£ùiÚs
 = !
	`¡rÿ£cmp
(
£ùiÚ
,"all");

3221 
def£ùiÚs
 = !
	`¡rÿ£cmp
(
£ùiÚ
,"default");

3223 
def£ùiÚs
 = 1;

3226 
£ùiÚs
 = 0;

3227 
sds
 
šfo
 = 
	`sd£m±y
();

3229 
	`šfo_£ùiÚ_äom_»dis
("server");

3230 
	`šfo_£ùiÚ_äom_»dis
("clients");

3231 
	`šfo_£ùiÚ_äom_»dis
("cpu");

3232 
	`šfo_£ùiÚ_äom_»dis
("stats");

3234 ià(
def£ùiÚs
 || 
®l£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"sentinel")) {

3235 
diùI‹¿tÜ
 *
di
;

3236 
diùEÁry
 *
de
;

3237 
ma¡”_id
 = 0;

3239 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

3240 
šfo
 = 
	`sdsÿrštf
(info,

3247 
	`diùSize
(
£Áš–
.
ma¡”s
),

3248 
£Áš–
.
tt
,

3249 
£Áš–
.
ruÂšg_süts
,

3250 
	`li¡L’gth
(
£Áš–
.
süts_queue
),

3251 
£Áš–
.
simçu»_æags
);

3253 
di
 = 
	`diùG‘I‹¿tÜ
(
£Áš–
.
ma¡”s
);

3254 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3255 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

3256 *
¡©us
 = "ok";

3258 ià(
ri
->
æags
 & 
SRI_O_DOWN
è
¡©us
 = "odown";

3259 ià(
ri
->
æags
 & 
SRI_S_DOWN
è
¡©us
 = "sdown";

3260 
šfo
 = 
	`sdsÿrštf
(info,

3263 
ma¡”_id
++, 
ri
->
Çme
, 
¡©us
,

3264 
ri
->
addr
->

,„i->addr->
pÜt
,

3265 
	`diùSize
(
ri
->
¦aves
),

3266 
	`diùSize
(
ri
->
£Áš–s
)+1);

3268 
	`diùR–—£I‹¿tÜ
(
di
);

3271 
	`addR•lyBulkSds
(
c
, 
šfo
);

3272 
	}
}

3276 
	$£Áš–RŞeCommªd
(
ş›Á
 *
c
) {

3277 
diùI‹¿tÜ
 *
di
;

3278 
diùEÁry
 *
de
;

3280 
	`addR•lyMuÉiBulkL’
(
c
,2);

3281 
	`addR•lyBulkCBufãr
(
c
,"sentinel",8);

3282 
	`addR•lyMuÉiBulkL’
(
c
,
	`diùSize
(
£Áš–
.
ma¡”s
));

3284 
di
 = 
	`diùG‘I‹¿tÜ
(
£Áš–
.
ma¡”s
);

3285 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3286 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

3288 
	`addR•lyBulkCSŒšg
(
c
,
ri
->
Çme
);

3290 
	`diùR–—£I‹¿tÜ
(
di
);

3291 
	}
}

3294 
	$£Áš–S‘Commªd
(
ş›Á
 *
c
) {

3295 
£Áš–RedisIn¡ªû
 *
ri
;

3296 
j
, 
chªges
 = 0;

3297 *
İtiÚ
, *
v®ue
;

3299 ià((
ri
 = 
	`£Áš–G‘Ma¡”ByNameOrR•lyE¼Ü
(
c
,c->
¬gv
[2]))

3300 =ğ
NULL
) ;

3303 
j
 = 3; j < 
c
->
¬gc
; j += 2) {

3304 
İtiÚ
 = 
c
->
¬gv
[
j
]->
±r
;

3305 
v®ue
 = 
c
->
¬gv
[
j
+1]->
±r
;

3306 
robj
 *
o
 = 
c
->
¬gv
[
j
+1];

3307 
Î
;

3309 ià(!
	`¡rÿ£cmp
(
İtiÚ
,"down-after-milliseconds")) {

3311 ià(
	`g‘LÚgLÚgFromObjeù
(
o
,&
Î
è=ğ
C_ERR
 ||†l <= 0)

3312 
badfmt
;

3313 
ri
->
down_aá”_³riod
 = 
Î
;

3314 
	`£Áš–Prİag©eDownAá”P”iod
(
ri
);

3315 
chªges
++;

3316 } ià(!
	`¡rÿ£cmp
(
İtiÚ
,"failover-timeout")) {

3318 ià(
	`g‘LÚgLÚgFromObjeù
(
o
,&
Î
è=ğ
C_ERR
 ||†l <= 0)

3319 
badfmt
;

3320 
ri
->
çov”_timeout
 = 
Î
;

3321 
chªges
++;

3322 } ià(!
	`¡rÿ£cmp
(
İtiÚ
,"parallel-syncs")) {

3324 ià(
	`g‘LÚgLÚgFromObjeù
(
o
,&
Î
è=ğ
C_ERR
 ||†l <= 0)

3325 
badfmt
;

3326 
ri
->
·¿Î–_syncs
 = 
Î
;

3327 
chªges
++;

3328 } ià(!
	`¡rÿ£cmp
(
İtiÚ
,"notification-script")) {

3330 ià(
	`¡¾’
(
v®ue
è&& 
	`acûss
(v®ue,
X_OK
) == -1) {

3331 
	`addR•lyE¼Ü
(
c
,

3333 ià(
chªges
è
	`£Áš–FlushCÚfig
();

3336 
	`sdsä“
(
ri
->
nÙifiÿtiÚ_süt
);

3337 
ri
->
nÙifiÿtiÚ_süt
 = 
	`¡¾’
(
v®ue
è? 
	`sd¢ew
(v®ueè: 
NULL
;

3338 
chªges
++;

3339 } ià(!
	`¡rÿ£cmp
(
İtiÚ
,"client-reconfig-script")) {

3341 ià(
	`¡¾’
(
v®ue
è&& 
	`acûss
(v®ue,
X_OK
) == -1) {

3342 
	`addR•lyE¼Ü
(
c
,

3345 ià(
chªges
è
	`£Áš–FlushCÚfig
();

3348 
	`sdsä“
(
ri
->
ş›Á_»cÚfig_süt
);

3349 
ri
->
ş›Á_»cÚfig_süt
 = 
	`¡¾’
(
v®ue
è? 
	`sd¢ew
(v®ueè: 
NULL
;

3350 
chªges
++;

3351 } ià(!
	`¡rÿ£cmp
(
İtiÚ
,"auth-pass")) {

3353 
	`sdsä“
(
ri
->
auth_·ss
);

3354 
ri
->
auth_·ss
 = 
	`¡¾’
(
v®ue
è? 
	`sd¢ew
(v®ueè: 
NULL
;

3355 
chªges
++;

3356 } ià(!
	`¡rÿ£cmp
(
İtiÚ
,"quorum")) {

3358 ià(
	`g‘LÚgLÚgFromObjeù
(
o
,&
Î
è=ğ
C_ERR
 ||†l <= 0)

3359 
badfmt
;

3360 
ri
->
quÜum
 = 
Î
;

3361 
chªges
++;

3363 
	`addR•lyE¼ÜFÜm©
(
c
,"Unknown option '%s' for SENTINEL SET",

3364 
İtiÚ
);

3365 ià(
chªges
è
	`£Áš–FlushCÚfig
();

3368 
	`£Áš–Ev’t
(
LL_WARNING
,"+£t",
ri
,"%@ % %s",
İtiÚ
,
v®ue
);

3371 ià(
chªges
è
	`£Áš–FlushCÚfig
();

3372 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3375 
badfmt
:

3376 ià(
chªges
è
	`£Áš–FlushCÚfig
();

3377 
	`addR•lyE¼ÜFÜm©
(
c
,"Invalid‡rgument '%s' for SENTINEL SET '%s'",

3378 
v®ue
, 
İtiÚ
);

3379 
	}
}

3387 
	$£Áš–PublishCommªd
(
ş›Á
 *
c
) {

3388 ià(
	`¡rcmp
(
c
->
¬gv
[1]->
±r
,
SENTINEL_HELLO_CHANNEL
)) {

3389 
	`addR•lyE¼Ü
(
c
, "Only HELLO messages‡re‡ccepted by Sentinel instances.");

3392 
	`£Áš–ProûssH–loMes§ge
(
c
->
¬gv
[2]->
±r
,
	`sd¦’
(c->argv[2]->ptr));

3393 
	`addR•lyLÚgLÚg
(
c
,1);

3394 
	}
}

3399 
	$£Áš–CheckSubjeùiv–yDown
(
£Áš–RedisIn¡ªû
 *
ri
) {

3400 
m¡ime_t
 
–­£d
 = 0;

3402 ià(
ri
->
lšk
->
aù_pšg_time
)

3403 
–­£d
 = 
	`m¡ime
(è- 
ri
->
lšk
->
aù_pšg_time
;

3404 ià(
ri
->
lšk
->
discÚÃùed
)

3405 
–­£d
 = 
	`m¡ime
(è- 
ri
->
lšk
->
Ï¡_ava_time
;

3413 ià(
ri
->
lšk
->
cc
 &&

3414 (
	`m¡ime
(è- 
ri
->
lšk
->
cc_cÚn_time
) >

3415 
SENTINEL_MIN_LINK_RECONNECT_PERIOD
 &&

3416 
ri
->
lšk
->
aù_pšg_time
 != 0 &&

3419 (
	`m¡ime
(è- 
ri
->
lšk
->
aù_pšg_time
è> (ri->
down_aá”_³riod
/2) &&

3420 (
	`m¡ime
(è- 
ri
->
lšk
->
Ï¡_pÚg_time
è> (ri->
down_aá”_³riod
/2))

3422 
	`š¡ªûLškClo£CÚÃùiÚ
(
ri
->
lšk
,ri->lšk->
cc
);

3430 ià(
ri
->
lšk
->
pc
 &&

3431 (
	`m¡ime
(è- 
ri
->
lšk
->
pc_cÚn_time
) >

3432 
SENTINEL_MIN_LINK_RECONNECT_PERIOD
 &&

3433 (
	`m¡ime
(è- 
ri
->
lšk
->
pc_Ï¡_aùiv™y
è> (
SENTINEL_PUBLISH_PERIOD
*3))

3435 
	`š¡ªûLškClo£CÚÃùiÚ
(
ri
->
lšk
,ri->lšk->
pc
);

3444 ià(
–­£d
 > 
ri
->
down_aá”_³riod
 ||

3445 (
ri
->
æags
 & 
SRI_MASTER
 &&

3446 
ri
->
rŞe_»pÜ‹d
 =ğ
SRI_SLAVE
 &&

3447 
	`m¡ime
(è- 
ri
->
rŞe_»pÜ‹d_time
 >

3448 (
ri
->
down_aá”_³riod
+
SENTINEL_INFO_PERIOD
*2)))

3451 ià((
ri
->
æags
 & 
SRI_S_DOWN
) == 0) {

3452 
	`£Áš–Ev’t
(
LL_WARNING
,"+sdown",
ri
,"%@");

3453 
ri
->
s_down_sšû_time
 = 
	`m¡ime
();

3454 
ri
->
æags
 |ğ
SRI_S_DOWN
;

3458 ià(
ri
->
æags
 & 
SRI_S_DOWN
) {

3459 
	`£Áš–Ev’t
(
LL_WARNING
,"-sdown",
ri
,"%@");

3460 
ri
->
æags
 &ğ~(
SRI_S_DOWN
|
SRI_SCRIPT_KILL_SENT
);

3463 
	}
}

3471 
	$£Áš–CheckObjeùiv–yDown
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

3472 
diùI‹¿tÜ
 *
di
;

3473 
diùEÁry
 *
de
;

3474 
quÜum
 = 0, 
odown
 = 0;

3476 ià(
ma¡”
->
æags
 & 
SRI_S_DOWN
) {

3478 
quÜum
 = 1;

3480 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
£Áš–s
);

3481 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3482 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

3484 ià(
ri
->
æags
 & 
SRI_MASTER_DOWN
è
quÜum
++;

3486 
	`diùR–—£I‹¿tÜ
(
di
);

3487 ià(
quÜum
 >ğ
ma¡”
->quÜumè
odown
 = 1;

3491 ià(
odown
) {

3492 ià((
ma¡”
->
æags
 & 
SRI_O_DOWN
) == 0) {

3493 
	`£Áš–Ev’t
(
LL_WARNING
,"+odown",
ma¡”
,"%@ #quorum %d/%d",

3494 
quÜum
, 
ma¡”
->quorum);

3495 
ma¡”
->
æags
 |ğ
SRI_O_DOWN
;

3496 
ma¡”
->
o_down_sšû_time
 = 
	`m¡ime
();

3499 ià(
ma¡”
->
æags
 & 
SRI_O_DOWN
) {

3500 
	`£Áš–Ev’t
(
LL_WARNING
,"-odown",
ma¡”
,"%@");

3501 
ma¡”
->
æags
 &ğ~
SRI_O_DOWN
;

3504 
	}
}

3508 
	$£Áš–ReûiveIsMa¡”DownR•ly
(
»disAsyncCÚ‹xt
 *
c
, *
»¶y
, *
´ivd©a
) {

3509 
£Áš–RedisIn¡ªû
 *
ri
 = 
´ivd©a
;

3510 
š¡ªûLšk
 *
lšk
 = 
c
->
d©a
;

3511 
»disR•ly
 *
r
;

3513 ià(!
»¶y
 || !
lšk
) ;

3514 
lšk
->
³ndšg_commªds
--;

3515 
r
 = 
»¶y
;

3520 ià(
r
->
ty³
 =ğ
REDIS_REPLY_ARRAY
 &&„->
–em’ts
 == 3 &&

3521 
r
->
–em’t
[0]->
ty³
 =ğ
REDIS_REPLY_INTEGER
 &&

3522 
r
->
–em’t
[1]->
ty³
 =ğ
REDIS_REPLY_STRING
 &&

3523 
r
->
–em’t
[2]->
ty³
 =ğ
REDIS_REPLY_INTEGER
)

3525 
ri
->
Ï¡_ma¡”_down_»¶y_time
 = 
	`m¡ime
();

3526 ià(
r
->
–em’t
[0]->
š‹g”
 == 1) {

3527 
ri
->
æags
 |ğ
SRI_MASTER_DOWN
;

3529 
ri
->
æags
 &ğ~
SRI_MASTER_DOWN
;

3531 ià(
	`¡rcmp
(
r
->
–em’t
[1]->
¡r
,"*")) {

3534 
	`sdsä“
(
ri
->
Ëad”
);

3535 ià(()
ri
->
Ëad”_•och
 !ğ
r
->
–em’t
[2]->
š‹g”
)

3536 
	`£rv”Log
(
LL_WARNING
,

3537 "% vÙed fÜ % %Îu", 
ri
->
Çme
,

3538 
r
->
–em’t
[1]->
¡r
,

3539 (è
r
->
–em’t
[2]->
š‹g”
);

3540 
ri
->
Ëad”
 = 
	`sd¢ew
(
r
->
–em’t
[1]->
¡r
);

3541 
ri
->
Ëad”_•och
 = 
r
->
–em’t
[2]->
š‹g”
;

3544 
	}
}

3550 
	#SENTINEL_ASK_FORCED
 (1<<0)

	)

3551 
	$£Áš–AskMa¡”S‹ToOth”S’tš–s
(
£Áš–RedisIn¡ªû
 *
ma¡”
, 
æags
) {

3552 
diùI‹¿tÜ
 *
di
;

3553 
diùEÁry
 *
de
;

3555 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
£Áš–s
);

3556 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3557 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

3558 
m¡ime_t
 
–­£d
 = 
	`m¡ime
(è- 
ri
->
Ï¡_ma¡”_down_»¶y_time
;

3559 
pÜt
[32];

3560 
»tv®
;

3563 ià(
–­£d
 > 
SENTINEL_ASK_PERIOD
*5) {

3564 
ri
->
æags
 &ğ~
SRI_MASTER_DOWN
;

3565 
	`sdsä“
(
ri
->
Ëad”
);

3566 
ri
->
Ëad”
 = 
NULL
;

3574 ià((
ma¡”
->
æags
 & 
SRI_S_DOWN
) == 0) ;

3575 ià(
ri
->
lšk
->
discÚÃùed
) ;

3576 ià(!(
æags
 & 
SENTINEL_ASK_FORCED
) &&

3577 
	`m¡ime
(è- 
ri
->
Ï¡_ma¡”_down_»¶y_time
 < 
SENTINEL_ASK_PERIOD
)

3581 
	`Î2¡ršg
(
pÜt
,ÕÜt),
ma¡”
->
addr
->port);

3582 
»tv®
 = 
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

3583 
£Áš–ReûiveIsMa¡”DownR•ly
, 
ri
,

3585 
ma¡”
->
addr
->

, 
pÜt
,

3586 
£Áš–
.
cu¼’t_•och
,

3587 (
ma¡”
->
çov”_¡©e
 > 
SENTINEL_FAILOVER_STATE_NONE
) ?

3588 
£Áš–
.
myid
 : "*");

3589 ià(
»tv®
 =ğ
C_OK
è
ri
->
lšk
->
³ndšg_commªds
++;

3591 
	`diùR–—£I‹¿tÜ
(
di
);

3592 
	}
}

3597 
	$£Áš–SimFau»C¿sh
() {

3598 
	`£rv”Log
(
LL_WARNING
,

3600 
	`ex™
(99);

3601 
	}
}

3608 *
	$£Áš–VÙeL—d”
(
£Áš–RedisIn¡ªû
 *
ma¡”
, 
ušt64_t
 
»q_•och
, *
»q_runid
, ušt64_ˆ*
Ëad”_•och
) {

3609 ià(
»q_•och
 > 
£Áš–
.
cu¼’t_•och
) {

3610 
£Áš–
.
cu¼’t_•och
 = 
»q_•och
;

3611 
	`£Áš–FlushCÚfig
();

3612 
	`£Áš–Ev’t
(
LL_WARNING
,"+Ãw-•och",
ma¡”
,"%llu",

3613 (è
£Áš–
.
cu¼’t_•och
);

3616 ià(
ma¡”
->
Ëad”_•och
 < 
»q_•och
 && 
£Áš–
.
cu¼’t_•och
 <=„eq_epoch)

3618 
	`sdsä“
(
ma¡”
->
Ëad”
);

3619 
ma¡”
->
Ëad”
 = 
	`sd¢ew
(
»q_runid
);

3620 
ma¡”
->
Ëad”_•och
 = 
£Áš–
.
cu¼’t_•och
;

3621 
	`£Áš–FlushCÚfig
();

3622 
	`£Áš–Ev’t
(
LL_WARNING
,"+vÙe-fÜ-Ëad”",
ma¡”
,"%s %llu",

3623 
ma¡”
->
Ëad”
, (èma¡”->
Ëad”_•och
);

3627 ià(
	`¡rÿ£cmp
(
ma¡”
->
Ëad”
,
£Áš–
.
myid
))

3628 
ma¡”
->
çov”_¡¬t_time
 = 
	`m¡ime
()+
	`¿nd
()%
SENTINEL_MAX_DESYNC
;

3631 *
Ëad”_•och
 = 
ma¡”
->leader_epoch;

3632  
ma¡”
->
Ëad”
 ? 
	`sd¢ew
(ma¡”->Ëad”è: 
NULL
;

3633 
	}
}

3635 
	s£Áš–L—d”
 {

3636 *
	mrunid
;

3637 
	mvÙes
;

3642 
	$£Áš–L—d”Inü
(
diù
 *
couÁ”s
, *
runid
) {

3643 
diùEÁry
 *
de
 = 
	`diùFšd
(
couÁ”s
,
runid
);

3644 
ušt64_t
 
Şdv®
;

3646 ià(
de
) {

3647 
Şdv®
 = 
	`diùG‘UnsigÃdIÁeg”V®
(
de
);

3648 
	`diùS‘UnsigÃdIÁeg”V®
(
de
,
Şdv®
+1);

3649  
Şdv®
+1;

3651 
de
 = 
	`diùAddRaw
(
couÁ”s
,
runid
);

3652 
	`£rv”As£¹
(
de
 !ğ
NULL
);

3653 
	`diùS‘UnsigÃdIÁeg”V®
(
de
,1);

3656 
	}
}

3664 *
	$£Áš–G‘L—d”
(
£Áš–RedisIn¡ªû
 *
ma¡”
, 
ušt64_t
 
•och
) {

3665 
diù
 *
couÁ”s
;

3666 
diùI‹¿tÜ
 *
di
;

3667 
diùEÁry
 *
de
;

3668 
vÙ”s
 = 0, 
vÙ”s_quÜum
;

3669 *
myvÙe
;

3670 *
wšÃr
 = 
NULL
;

3671 
ušt64_t
 
Ëad”_•och
;

3672 
ušt64_t
 
max_vÙes
 = 0;

3674 
	`£rv”As£¹
(
ma¡”
->
æags
 & (
SRI_O_DOWN
|
SRI_FAILOVER_IN_PROGRESS
));

3675 
couÁ”s
 = 
	`diùC»©e
(&
Ëad”VÙesDiùTy³
,
NULL
);

3677 
vÙ”s
 = 
	`diùSize
(
ma¡”
->
£Áš–s
)+1;

3680 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
£Áš–s
);

3681 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3682 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

3683 ià(
ri
->
Ëad”
 !ğ
NULL
 &&„i->
Ëad”_•och
 =ğ
£Áš–
.
cu¼’t_•och
)

3684 
	`£Áš–L—d”Inü
(
couÁ”s
,
ri
->
Ëad”
);

3686 
	`diùR–—£I‹¿tÜ
(
di
);

3691 
di
 = 
	`diùG‘I‹¿tÜ
(
couÁ”s
);

3692 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3693 
ušt64_t
 
vÙes
 = 
	`diùG‘UnsigÃdIÁeg”V®
(
de
);

3695 ià(
vÙes
 > 
max_vÙes
) {

3696 
max_vÙes
 = 
vÙes
;

3697 
wšÃr
 = 
	`diùG‘Key
(
de
);

3700 
	`diùR–—£I‹¿tÜ
(
di
);

3705 ià(
wšÃr
)

3706 
myvÙe
 = 
	`£Áš–VÙeL—d”
(
ma¡”
,
•och
,
wšÃr
,&
Ëad”_•och
);

3708 
myvÙe
 = 
	`£Áš–VÙeL—d”
(
ma¡”
,
•och
,
£Áš–
.
myid
,&
Ëad”_•och
);

3710 ià(
myvÙe
 && 
Ëad”_•och
 =ğ
•och
) {

3711 
ušt64_t
 
vÙes
 = 
	`£Áš–L—d”Inü
(
couÁ”s
,
myvÙe
);

3713 ià(
vÙes
 > 
max_vÙes
) {

3714 
max_vÙes
 = 
vÙes
;

3715 
wšÃr
 = 
myvÙe
;

3719 
vÙ”s_quÜum
 = 
vÙ”s
/2+1;

3720 ià(
wšÃr
 && (
max_vÙes
 < 
vÙ”s_quÜum
 || max_vÙe < 
ma¡”
->
quÜum
))

3721 
wšÃr
 = 
NULL
;

3723 
wšÃr
 = wšÃ¸? 
	`sd¢ew
(wšÃrè: 
NULL
;

3724 
	`sdsä“
(
myvÙe
);

3725 
	`diùR–—£
(
couÁ”s
);

3726  
wšÃr
;

3727 
	}
}

3739 
	$£Áš–S’dSÏveOf
(
£Áš–RedisIn¡ªû
 *
ri
, *
ho¡
, 
pÜt
) {

3740 
pÜt¡r
[32];

3741 
»tv®
;

3743 
	`Î2¡ršg
(
pÜt¡r
,ÕÜt¡r),
pÜt
);

3747 ià(
ho¡
 =ğ
NULL
) {

3748 
ho¡
 = "NO";

3749 
	`memıy
(
pÜt¡r
,"ONE",4);

3762 
»tv®
 = 
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

3763 
£Áš–DisÿrdR•lyC®lback
, 
ri
, "MULTI");

3764 ià(
»tv®
 =ğ
C_ERR
) „etval;

3765 
ri
->
lšk
->
³ndšg_commªds
++;

3767 
»tv®
 = 
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

3768 
£Áš–DisÿrdR•lyC®lback
, 
ri
, "SLAVEOF % %s", 
ho¡
, 
pÜt¡r
);

3769 ià(
»tv®
 =ğ
C_ERR
) „etval;

3770 
ri
->
lšk
->
³ndšg_commªds
++;

3772 
»tv®
 = 
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

3773 
£Áš–DisÿrdR•lyC®lback
, 
ri
, "CONFIG REWRITE");

3774 ià(
»tv®
 =ğ
C_ERR
) „etval;

3775 
ri
->
lšk
->
³ndšg_commªds
++;

3782 
»tv®
 = 
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

3783 
£Áš–DisÿrdR•lyC®lback
, 
ri
, "CLIENT KILL TYPE‚ormal");

3784 ià(
»tv®
 =ğ
C_ERR
) „etval;

3785 
ri
->
lšk
->
³ndšg_commªds
++;

3787 
»tv®
 = 
	`»disAsyncCommªd
(
ri
->
lšk
->
cc
,

3788 
£Áš–DisÿrdR•lyC®lback
, 
ri
, "EXEC");

3789 ià(
»tv®
 =ğ
C_ERR
) „etval;

3790 
ri
->
lšk
->
³ndšg_commªds
++;

3792  
C_OK
;

3793 
	}
}

3796 
	$£Áš–S¹Faov”
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

3797 
	`£rv”As£¹
(
ma¡”
->
æags
 & 
SRI_MASTER
);

3799 
ma¡”
->
çov”_¡©e
 = 
SENTINEL_FAILOVER_STATE_WAIT_START
;

3800 
ma¡”
->
æags
 |ğ
SRI_FAILOVER_IN_PROGRESS
;

3801 
ma¡”
->
çov”_•och
 = ++
£Áš–
.
cu¼’t_•och
;

3802 
	`£Áš–Ev’t
(
LL_WARNING
,"+Ãw-•och",
ma¡”
,"%llu",

3803 (è
£Áš–
.
cu¼’t_•och
);

3804 
	`£Áš–Ev’t
(
LL_WARNING
,"+Œy-çov”",
ma¡”
,"%@");

3805 
ma¡”
->
çov”_¡¬t_time
 = 
	`m¡ime
()+
	`¿nd
()%
SENTINEL_MAX_DESYNC
;

3806 
ma¡”
->
çov”_¡©e_chªge_time
 = 
	`m¡ime
();

3807 
	}
}

3820 
	$£Áš–S¹Faov”IfN“ded
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

3822 ià(!(
ma¡”
->
æags
 & 
SRI_O_DOWN
))  0;

3825 ià(
ma¡”
->
æags
 & 
SRI_FAILOVER_IN_PROGRESS
)  0;

3828 ià(
	`m¡ime
(è- 
ma¡”
->
çov”_¡¬t_time
 <

3829 
ma¡”
->
çov”_timeout
*2)

3831 ià(
ma¡”
->
çov”_d–ay_logged
 !ğma¡”->
çov”_¡¬t_time
) {

3832 
time_t
 
şock
 = (
ma¡”
->
çov”_¡¬t_time
 +

3833 
ma¡”
->
çov”_timeout
*2) / 1000;

3834 
ùimebuf
[26];

3836 
	`ùime_r
(&
şock
,
ùimebuf
);

3837 
ùimebuf
[24] = '\0';

3838 
ma¡”
->
çov”_d–ay_logged
 = ma¡”->
çov”_¡¬t_time
;

3839 
	`£rv”Log
(
LL_WARNING
,

3841 
ùimebuf
);

3846 
	`£Áš–S¹Faov”
(
ma¡”
);

3848 
	}
}

3882 
	$com·»SÏvesFÜPromÙiÚ
(cÚ¡ *
a
, cÚ¡ *
b
) {

3883 
£Áš–RedisIn¡ªû
 **
§
 = (£Áš–RedisIn¡ªû **)
a
,

3884 **
sb
 = (
£Áš–RedisIn¡ªû
 **)
b
;

3885 *
§_runid
, *
sb_runid
;

3887 ià((*
§
)->
¦ave_´iÜ™y
 !ğ(*
sb
)->slave_priority)

3888  (*
§
)->
¦ave_´iÜ™y
 - (*
sb
)->slave_priority;

3892 ià((*
§
)->
¦ave_»¶_off£t
 > (*
sb
)->slave_repl_offset) {

3894 } ià((*
§
)->
¦ave_»¶_off£t
 < (*
sb
)->slave_repl_offset) {

3902 
§_runid
 = (*
§
)->
runid
;

3903 
sb_runid
 = (*
sb
)->
runid
;

3904 ià(
§_runid
 =ğ
NULL
 && 
sb_runid
 == NULL)  0;

3905 ià(
§_runid
 =ğ
NULL
)  1;

3906 ià(
sb_runid
 =ğ
NULL
)  -1;

3907  
	`¡rÿ£cmp
(
§_runid
, 
sb_runid
);

3908 
	}
}

3910 
£Áš–RedisIn¡ªû
 *
	$£Áš–S–eùSÏve
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

3911 
£Áš–RedisIn¡ªû
 **
š¡ªû
 =

3912 
	`zm®loc
((
š¡ªû
[0])*
	`diùSize
(
ma¡”
->
¦aves
));

3913 
£Áš–RedisIn¡ªû
 *
£Ëùed
 = 
NULL
;

3914 
š¡ªûs
 = 0;

3915 
diùI‹¿tÜ
 *
di
;

3916 
diùEÁry
 *
de
;

3917 
m¡ime_t
 
max_ma¡”_down_time
 = 0;

3919 ià(
ma¡”
->
æags
 & 
SRI_S_DOWN
)

3920 
max_ma¡”_down_time
 +ğ
	`m¡ime
(è- 
ma¡”
->
s_down_sšû_time
;

3921 
max_ma¡”_down_time
 +ğ
ma¡”
->
down_aá”_³riod
 * 10;

3923 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
¦aves
);

3924 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

3925 
£Áš–RedisIn¡ªû
 *
¦ave
 = 
	`diùG‘V®
(
de
);

3926 
m¡ime_t
 
šfo_v®id™y_time
;

3928 ià(
¦ave
->
æags
 & (
SRI_S_DOWN
|
SRI_O_DOWN
)) ;

3929 ià(
¦ave
->
lšk
->
discÚÃùed
) ;

3930 ià(
	`m¡ime
(è- 
¦ave
->
lšk
->
Ï¡_ava_time
 > 
SENTINEL_PING_PERIOD
*5) ;

3931 ià(
¦ave
->
¦ave_´iÜ™y
 == 0) ;

3936 ià(
ma¡”
->
æags
 & 
SRI_S_DOWN
)

3937 
šfo_v®id™y_time
 = 
SENTINEL_PING_PERIOD
*5;

3939 
šfo_v®id™y_time
 = 
SENTINEL_INFO_PERIOD
*3;

3940 ià(
	`m¡ime
(è- 
¦ave
->
šfo_»äesh
 > 
šfo_v®id™y_time
) ;

3941 ià(
¦ave
->
ma¡”_lšk_down_time
 > 
max_ma¡”_down_time
) ;

3942 
š¡ªû
[
š¡ªûs
++] = 
¦ave
;

3944 
	`diùR–—£I‹¿tÜ
(
di
);

3945 ià(
š¡ªûs
) {

3946 
	`qsÜt
(
š¡ªû
,
š¡ªûs
,(
£Áš–RedisIn¡ªû
*),

3947 
com·»SÏvesFÜPromÙiÚ
);

3948 
£Ëùed
 = 
š¡ªû
[0];

3950 
	`zä“
(
š¡ªû
);

3951  
£Ëùed
;

3952 
	}
}

3955 
	$£Áš–Faov”Wa™S¹
(
£Áš–RedisIn¡ªû
 *
ri
) {

3956 *
Ëad”
;

3957 
i¦—d”
;

3960 
Ëad”
 = 
	`£Áš–G‘L—d”
(
ri
,„i->
çov”_•och
);

3961 
i¦—d”
 = 
Ëad”
 && 
	`¡rÿ£cmp
Ö—d”,
£Áš–
.
myid
) == 0;

3962 
	`sdsä“
(
Ëad”
);

3966 ià(!
i¦—d”
 && !(
ri
->
æags
 & 
SRI_FORCE_FAILOVER
)) {

3967 
–eùiÚ_timeout
 = 
SENTINEL_ELECTION_TIMEOUT
;

3971 ià(
–eùiÚ_timeout
 > 
ri
->
çov”_timeout
)

3972 
–eùiÚ_timeout
 = 
ri
->
çov”_timeout
;

3974 ià(
	`m¡ime
(è- 
ri
->
çov”_¡¬t_time
 > 
–eùiÚ_timeout
) {

3975 
	`£Áš–Ev’t
(
LL_WARNING
,"-çov”-abÜt-nÙ-–eùed",
ri
,"%@");

3976 
	`£Áš–AbÜtFaov”
(
ri
);

3980 
	`£Áš–Ev’t
(
LL_WARNING
,"+–eùed-Ëad”",
ri
,"%@");

3981 ià(
£Áš–
.
simçu»_æags
 & 
SENTINEL_SIMFAILURE_CRASH_AFTER_ELECTION
)

3982 
	`£Áš–SimFau»C¿sh
();

3983 
ri
->
çov”_¡©e
 = 
SENTINEL_FAILOVER_STATE_SELECT_SLAVE
;

3984 
ri
->
çov”_¡©e_chªge_time
 = 
	`m¡ime
();

3985 
	`£Áš–Ev’t
(
LL_WARNING
,"+çov”-¡©e-£Ëù-¦ave",
ri
,"%@");

3986 
	}
}

3988 
	$£Áš–Faov”S–eùSÏve
(
£Áš–RedisIn¡ªû
 *
ri
) {

3989 
£Áš–RedisIn¡ªû
 *
¦ave
 = 
	`£Áš–S–eùSÏve
(
ri
);

3993 ià(
¦ave
 =ğ
NULL
) {

3994 
	`£Áš–Ev’t
(
LL_WARNING
,"-çov”-abÜt-no-good-¦ave",
ri
,"%@");

3995 
	`£Áš–AbÜtFaov”
(
ri
);

3997 
	`£Áš–Ev’t
(
LL_WARNING
,"+£Ëùed-¦ave",
¦ave
,"%@");

3998 
¦ave
->
æags
 |ğ
SRI_PROMOTED
;

3999 
ri
->
´omÙed_¦ave
 = 
¦ave
;

4000 
ri
->
çov”_¡©e
 = 
SENTINEL_FAILOVER_STATE_SEND_SLAVEOF_NOONE
;

4001 
ri
->
çov”_¡©e_chªge_time
 = 
	`m¡ime
();

4002 
	`£Áš–Ev’t
(
LL_NOTICE
,"+failover-state-send-slaveof-noone",

4003 
¦ave
, "%@");

4005 
	}
}

4007 
	$£Áš–Faov”S’dSÏveOfNoOÃ
(
£Áš–RedisIn¡ªû
 *
ri
) {

4008 
»tv®
;

4013 ià(
ri
->
´omÙed_¦ave
->
lšk
->
discÚÃùed
) {

4014 ià(
	`m¡ime
(è- 
ri
->
çov”_¡©e_chªge_time
 >„i->
çov”_timeout
) {

4015 
	`£Áš–Ev’t
(
LL_WARNING
,"-çov”-abÜt-¦ave-timeout",
ri
,"%@");

4016 
	`£Áš–AbÜtFaov”
(
ri
);

4025 
»tv®
 = 
	`£Áš–S’dSÏveOf
(
ri
->
´omÙed_¦ave
,
NULL
,0);

4026 ià(
»tv®
 !ğ
C_OK
) ;

4027 
	`£Áš–Ev’t
(
LL_NOTICE
, "+failover-state-wait-promotion",

4028 
ri
->
´omÙed_¦ave
,"%@");

4029 
ri
->
çov”_¡©e
 = 
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
;

4030 
ri
->
çov”_¡©e_chªge_time
 = 
	`m¡ime
();

4031 
	}
}

4035 
	$£Áš–Faov”Wa™PromÙiÚ
(
£Áš–RedisIn¡ªû
 *
ri
) {

4038 ià(
	`m¡ime
(è- 
ri
->
çov”_¡©e_chªge_time
 >„i->
çov”_timeout
) {

4039 
	`£Áš–Ev’t
(
LL_WARNING
,"-çov”-abÜt-¦ave-timeout",
ri
,"%@");

4040 
	`£Áš–AbÜtFaov”
(
ri
);

4042 
	}
}

4044 
	$£Áš–Faov”D‘eùEnd
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

4045 
nÙ_»cÚfigu»d
 = 0, 
timeout
 = 0;

4046 
diùI‹¿tÜ
 *
di
;

4047 
diùEÁry
 *
de
;

4048 
m¡ime_t
 
–­£d
 = 
	`m¡ime
(è- 
ma¡”
->
çov”_¡©e_chªge_time
;

4052 ià(
ma¡”
->
´omÙed_¦ave
 =ğ
NULL
 ||

4053 
ma¡”
->
´omÙed_¦ave
->
æags
 & 
SRI_S_DOWN
) ;

4057 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
¦aves
);

4058 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

4059 
£Áš–RedisIn¡ªû
 *
¦ave
 = 
	`diùG‘V®
(
de
);

4061 ià(
¦ave
->
æags
 & (
SRI_PROMOTED
|
SRI_RECONF_DONE
)) ;

4062 ià(
¦ave
->
æags
 & 
SRI_S_DOWN
) ;

4063 
nÙ_»cÚfigu»d
++;

4065 
	`diùR–—£I‹¿tÜ
(
di
);

4068 ià(
–­£d
 > 
ma¡”
->
çov”_timeout
) {

4069 
nÙ_»cÚfigu»d
 = 0;

4070 
timeout
 = 1;

4071 
	`£Áš–Ev’t
(
LL_WARNING
,"+çov”-’d-fÜ-timeout",
ma¡”
,"%@");

4074 ià(
nÙ_»cÚfigu»d
 == 0) {

4075 
	`£Áš–Ev’t
(
LL_WARNING
,"+çov”-’d",
ma¡”
,"%@");

4076 
ma¡”
->
çov”_¡©e
 = 
SENTINEL_FAILOVER_STATE_UPDATE_CONFIG
;

4077 
ma¡”
->
çov”_¡©e_chªge_time
 = 
	`m¡ime
();

4083 ià(
timeout
) {

4084 
diùI‹¿tÜ
 *
di
;

4085 
diùEÁry
 *
de
;

4087 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
¦aves
);

4088 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

4089 
£Áš–RedisIn¡ªû
 *
¦ave
 = 
	`diùG‘V®
(
de
);

4090 
»tv®
;

4092 ià(
¦ave
->
æags
 & (
SRI_RECONF_DONE
|
SRI_RECONF_SENT
)) ;

4093 ià(
¦ave
->
lšk
->
discÚÃùed
) ;

4095 
»tv®
 = 
	`£Áš–S’dSÏveOf
(
¦ave
,

4096 
ma¡”
->
´omÙed_¦ave
->
addr
->

,

4097 
ma¡”
->
´omÙed_¦ave
->
addr
->
pÜt
);

4098 ià(
»tv®
 =ğ
C_OK
) {

4099 
	`£Áš–Ev’t
(
LL_NOTICE
,"+¦ave-»cÚf-£Á-be",
¦ave
,"%@");

4100 
¦ave
->
æags
 |ğ
SRI_RECONF_SENT
;

4103 
	`diùR–—£I‹¿tÜ
(
di
);

4105 
	}
}

4109 
	$£Áš–Faov”RecÚfNextSÏve
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

4110 
diùI‹¿tÜ
 *
di
;

4111 
diùEÁry
 *
de
;

4112 
š_´og»ss
 = 0;

4114 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
¦aves
);

4115 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

4116 
£Áš–RedisIn¡ªû
 *
¦ave
 = 
	`diùG‘V®
(
de
);

4118 ià(
¦ave
->
æags
 & (
SRI_RECONF_SENT
|
SRI_RECONF_INPROG
))

4119 
š_´og»ss
++;

4121 
	`diùR–—£I‹¿tÜ
(
di
);

4123 
di
 = 
	`diùG‘I‹¿tÜ
(
ma¡”
->
¦aves
);

4124 
š_´og»ss
 < 
ma¡”
->
·¿Î–_syncs
 &&

4125 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
)

4127 
£Áš–RedisIn¡ªû
 *
¦ave
 = 
	`diùG‘V®
(
de
);

4128 
»tv®
;

4131 ià(
¦ave
->
æags
 & (
SRI_PROMOTED
|
SRI_RECONF_DONE
)) ;

4137 ià((
¦ave
->
æags
 & 
SRI_RECONF_SENT
) &&

4138 (
	`m¡ime
(è- 
¦ave
->
¦ave_»cÚf_£Á_time
) >

4139 
SENTINEL_SLAVE_RECONF_TIMEOUT
)

4141 
	`£Áš–Ev’t
(
LL_NOTICE
,"-¦ave-»cÚf-£Á-timeout",
¦ave
,"%@");

4142 
¦ave
->
æags
 &ğ~
SRI_RECONF_SENT
;

4143 
¦ave
->
æags
 |ğ
SRI_RECONF_DONE
;

4148 ià(
¦ave
->
æags
 & (
SRI_RECONF_SENT
|
SRI_RECONF_INPROG
)) ;

4149 ià(
¦ave
->
lšk
->
discÚÃùed
) ;

4152 
»tv®
 = 
	`£Áš–S’dSÏveOf
(
¦ave
,

4153 
ma¡”
->
´omÙed_¦ave
->
addr
->

,

4154 
ma¡”
->
´omÙed_¦ave
->
addr
->
pÜt
);

4155 ià(
»tv®
 =ğ
C_OK
) {

4156 
¦ave
->
æags
 |ğ
SRI_RECONF_SENT
;

4157 
¦ave
->
¦ave_»cÚf_£Á_time
 = 
	`m¡ime
();

4158 
	`£Áš–Ev’t
(
LL_NOTICE
,"+¦ave-»cÚf-£Á",
¦ave
,"%@");

4159 
š_´og»ss
++;

4162 
	`diùR–—£I‹¿tÜ
(
di
);

4165 
	`£Áš–Faov”D‘eùEnd
(
ma¡”
);

4166 
	}
}

4171 
	$£Áš–Faov”Sw™chToPromÙedSÏve
(
£Áš–RedisIn¡ªû
 *
ma¡”
) {

4172 
£Áš–RedisIn¡ªû
 *
»f
 = 
ma¡”
->
´omÙed_¦ave
 ?

4173 
ma¡”
->
´omÙed_¦ave
 : master;

4175 
	`£Áš–Ev’t
(
LL_WARNING
,"+sw™ch-ma¡”",
ma¡”
,"%s %s %d %s %d",

4176 
ma¡”
->
Çme
, ma¡”->
addr
->

, ma¡”->addr->
pÜt
,

4177 
»f
->
addr
->

,„ef->addr->
pÜt
);

4179 
	`£Áš–Re£tMa¡”AndChªgeAdd»ss
(
ma¡”
,
»f
->
addr
->

,»f->addr->
pÜt
);

4180 
	}
}

4182 
	$£Áš–Faov”S‹Machše
(
£Áš–RedisIn¡ªû
 *
ri
) {

4183 
	`£rv”As£¹
(
ri
->
æags
 & 
SRI_MASTER
);

4185 ià(!(
ri
->
æags
 & 
SRI_FAILOVER_IN_PROGRESS
)) ;

4187 
ri
->
çov”_¡©e
) {

4188 
SENTINEL_FAILOVER_STATE_WAIT_START
:

4189 
	`£Áš–Faov”Wa™S¹
(
ri
);

4191 
SENTINEL_FAILOVER_STATE_SELECT_SLAVE
:

4192 
	`£Áš–Faov”S–eùSÏve
(
ri
);

4194 
SENTINEL_FAILOVER_STATE_SEND_SLAVEOF_NOONE
:

4195 
	`£Áš–Faov”S’dSÏveOfNoOÃ
(
ri
);

4197 
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
:

4198 
	`£Áš–Faov”Wa™PromÙiÚ
(
ri
);

4200 
SENTINEL_FAILOVER_STATE_RECONF_SLAVES
:

4201 
	`£Áš–Faov”RecÚfNextSÏve
(
ri
);

4204 
	}
}

4211 
	$£Áš–AbÜtFaov”
(
£Áš–RedisIn¡ªû
 *
ri
) {

4212 
	`£rv”As£¹
(
ri
->
æags
 & 
SRI_FAILOVER_IN_PROGRESS
);

4213 
	`£rv”As£¹
(
ri
->
çov”_¡©e
 <ğ
SENTINEL_FAILOVER_STATE_WAIT_PROMOTION
);

4215 
ri
->
æags
 &ğ~(
SRI_FAILOVER_IN_PROGRESS
|
SRI_FORCE_FAILOVER
);

4216 
ri
->
çov”_¡©e
 = 
SENTINEL_FAILOVER_STATE_NONE
;

4217 
ri
->
çov”_¡©e_chªge_time
 = 
	`m¡ime
();

4218 ià(
ri
->
´omÙed_¦ave
) {

4219 
ri
->
´omÙed_¦ave
->
æags
 &ğ~
SRI_PROMOTED
;

4220 
ri
->
´omÙed_¦ave
 = 
NULL
;

4222 
	}
}

4230 
	$£Áš–HªdËRedisIn¡ªû
(
£Áš–RedisIn¡ªû
 *
ri
) {

4233 
	`£Áš–RecÚÃùIn¡ªû
(
ri
);

4234 
	`£Áš–S’dP”iodicCommªds
(
ri
);

4240 ià(
£Áš–
.
tt
) {

4241 ià(
	`m¡ime
()-
£Áš–
.
tt_¡¬t_time
 < 
SENTINEL_TILT_PERIOD
) ;

4242 
£Áš–
.
tt
 = 0;

4243 
	`£Áš–Ev’t
(
LL_WARNING
,"-tt",
NULL
,"#tilt modeƒxited");

4247 
	`£Áš–CheckSubjeùiv–yDown
(
ri
);

4250 ià(
ri
->
æags
 & (
SRI_MASTER
|
SRI_SLAVE
)) {

4255 ià(
ri
->
æags
 & 
SRI_MASTER
) {

4256 
	`£Áš–CheckObjeùiv–yDown
(
ri
);

4257 ià(
	`£Áš–S¹Faov”IfN“ded
(
ri
))

4258 
	`£Áš–AskMa¡”S‹ToOth”S’tš–s
(
ri
,
SENTINEL_ASK_FORCED
);

4259 
	`£Áš–Faov”S‹Machše
(
ri
);

4260 
	`£Áš–AskMa¡”S‹ToOth”S’tš–s
(
ri
,
SENTINEL_NO_FLAGS
);

4262 
	}
}

4266 
	$£Áš–HªdËDiùOfRedisIn¡ªûs
(
diù
 *
š¡ªûs
) {

4267 
diùI‹¿tÜ
 *
di
;

4268 
diùEÁry
 *
de
;

4269 
£Áš–RedisIn¡ªû
 *
sw™ch_to_´omÙed
 = 
NULL
;

4272 
di
 = 
	`diùG‘I‹¿tÜ
(
š¡ªûs
);

4273 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

4274 
£Áš–RedisIn¡ªû
 *
ri
 = 
	`diùG‘V®
(
de
);

4276 
	`£Áš–HªdËRedisIn¡ªû
(
ri
);

4277 ià(
ri
->
æags
 & 
SRI_MASTER
) {

4278 
	`£Áš–HªdËDiùOfRedisIn¡ªûs
(
ri
->
¦aves
);

4279 
	`£Áš–HªdËDiùOfRedisIn¡ªûs
(
ri
->
£Áš–s
);

4280 ià(
ri
->
çov”_¡©e
 =ğ
SENTINEL_FAILOVER_STATE_UPDATE_CONFIG
) {

4281 
sw™ch_to_´omÙed
 = 
ri
;

4285 ià(
sw™ch_to_´omÙed
)

4286 
	`£Áš–Faov”Sw™chToPromÙedSÏve
(
sw™ch_to_´omÙed
);

4287 
	`diùR–—£I‹¿tÜ
(
di
);

4288 
	}
}

4309 
	$£Áš–CheckTtCÚd™iÚ
() {

4310 
m¡ime_t
 
now
 = 
	`m¡ime
();

4311 
m¡ime_t
 
d–
 = 
now
 - 
£Áš–
.
´evious_time
;

4313 ià(
d–
 < 0 || d– > 
SENTINEL_TILT_TRIGGER
) {

4314 
£Áš–
.
tt
 = 1;

4315 
£Áš–
.
tt_¡¬t_time
 = 
	`m¡ime
();

4316 
	`£Áš–Ev’t
(
LL_WARNING
,"+tt",
NULL
,"#tilt modeƒntered");

4318 
£Áš–
.
´evious_time
 = 
	`m¡ime
();

4319 
	}
}

4321 
	$£Áš–Tim”
() {

4322 
	`£Áš–CheckTtCÚd™iÚ
();

4323 
	`£Áš–HªdËDiùOfRedisIn¡ªûs
(
£Áš–
.
ma¡”s
);

4324 
	`£Áš–RunP’dšgSüts
();

4325 
	`£Áš–CŞËùT”mš©edSüts
();

4326 
	`£Áš–KlTimedoutSüts
();

4334 
£rv”
.
hz
 = 
CONFIG_DEFAULT_HZ
 + 
	`¿nd
() % CONFIG_DEFAULT_HZ;

4335 
	}
}

	@src/server.c

30 
	~"£rv”.h
"

31 
	~"şu¡”.h
"

32 
	~"¦owlog.h
"

33 
	~"bio.h
"

34 
	~"Ï‹ncy.h
"

36 
	~<time.h
>

37 
	~<sigÇl.h
>

38 
	~<sys/wa™.h
>

39 
	~<”ºo.h
>

40 
	~<as£¹.h
>

41 
	~<ùy³.h
>

42 
	~<¡d¬g.h
>

43 
	~<¬·/š‘.h
>

44 
	~<sys/¡©.h
>

45 
	~<fú.h
>

46 
	~<sys/time.h
>

47 
	~<sys/»sourû.h
>

48 
	~<sys/uio.h
>

49 
	~<sys/un.h
>

50 
	~<lim™s.h
>

51 
	~<æßt.h
>

52 
	~<m©h.h
>

53 
	~<sys/»sourû.h
>

54 
	~<sys/ut¢ame.h
>

55 
	~<loÿË.h
>

56 
	~<sys/sock‘.h
>

60 
sh¬edObjeùsSŒuù
 
	gsh¬ed
;

66 
	gR_Z”o
, 
	gR_PosInf
, 
	gR_NegInf
, 
	gR_Nª
;

71 
ušt64_t
 
	gpm_ty³_roÙ_ty³_id
;

72 
ušt64_t
 
	gpm_ty³_key_v®_·œ_PM
;

73 
»disS”v”
 
	g£rv”
;

127 
»disCommªd
 
	g»disCommªdTabË
[] = {

128 {"g‘",
g‘Commªd
,2,"rF",0,
NULL
,1,1,1,0,0},

129 {"£t",
£tCommªd
,-3,"wm",0,
NULL
,1,1,1,0,0},

130 {"£Šx",
£ŠxCommªd
,3,"wmF",0,
NULL
,1,1,1,0,0},

131 {"£‹x",
£‹xCommªd
,4,"wm",0,
NULL
,1,1,1,0,0},

132 {"p£‹x",
p£‹xCommªd
,4,"wm",0,
NULL
,1,1,1,0,0},

133 {"­³nd",
­³ndCommªd
,3,"wm",0,
NULL
,1,1,1,0,0},

134 {"¡¾’",
¡¾’Commªd
,2,"rF",0,
NULL
,1,1,1,0,0},

135 {"d–",
d–Commªd
,-2,"w",0,
NULL
,1,-1,1,0,0},

136 {"exi¡s",
exi¡sCommªd
,-2,"rF",0,
NULL
,1,-1,1,0,0},

137 {"£tb™",
£tb™Commªd
,4,"wm",0,
NULL
,1,1,1,0,0},

138 {"g‘b™",
g‘b™Commªd
,3,"rF",0,
NULL
,1,1,1,0,0},

139 {"b™f›ld",
b™f›ldCommªd
,-2,"wm",0,
NULL
,1,1,1,0,0},

140 {"£Œªge",
£ŒªgeCommªd
,4,"wm",0,
NULL
,1,1,1,0,0},

141 {"g‘¿nge",
g‘¿ngeCommªd
,4,"r",0,
NULL
,1,1,1,0,0},

142 {"sub¡r",
g‘¿ngeCommªd
,4,"r",0,
NULL
,1,1,1,0,0},

143 {"šü",
šüCommªd
,2,"wmF",0,
NULL
,1,1,1,0,0},

144 {"deü",
deüCommªd
,2,"wmF",0,
NULL
,1,1,1,0,0},

145 {"mg‘",
mg‘Commªd
,-2,"r",0,
NULL
,1,-1,1,0,0},

146 {"½ush",
½ushCommªd
,-3,"wmF",0,
NULL
,1,1,1,0,0},

147 {"Íush",
ÍushCommªd
,-3,"wmF",0,
NULL
,1,1,1,0,0},

148 {"½ushx",
½ushxCommªd
,3,"wmF",0,
NULL
,1,1,1,0,0},

149 {"Íushx",
ÍushxCommªd
,3,"wmF",0,
NULL
,1,1,1,0,0},

150 {"lš£¹",
lš£¹Commªd
,5,"wm",0,
NULL
,1,1,1,0,0},

151 {"½İ",
½İCommªd
,2,"wF",0,
NULL
,1,1,1,0,0},

152 {"Íİ",
ÍİCommªd
,2,"wF",0,
NULL
,1,1,1,0,0},

153 {"b½İ",
b½İCommªd
,-3,"ws",0,
NULL
,1,1,1,0,0},

154 {"b½İÍush",
b½İÍushCommªd
,4,"wms",0,
NULL
,1,2,1,0,0},

155 {"bÍİ",
bÍİCommªd
,-3,"ws",0,
NULL
,1,-2,1,0,0},

156 {"Î’",
Î’Commªd
,2,"rF",0,
NULL
,1,1,1,0,0},

157 {"lšdex",
lšdexCommªd
,3,"r",0,
NULL
,1,1,1,0,0},

158 {"l£t",
l£tCommªd
,4,"wm",0,
NULL
,1,1,1,0,0},

159 {"Ìªge",
ÌªgeCommªd
,4,"r",0,
NULL
,1,1,1,0,0},

160 {"Érim",
ÉrimCommªd
,4,"w",0,
NULL
,1,1,1,0,0},

161 {"Ìem",
ÌemCommªd
,4,"w",0,
NULL
,1,1,1,0,0},

162 {"½İÍush",
½İÍushCommªd
,3,"wm",0,
NULL
,1,2,1,0,0},

163 {"§dd",
§ddCommªd
,-3,"wmF",0,
NULL
,1,1,1,0,0},

164 {"¤em",
¤emCommªd
,-3,"wF",0,
NULL
,1,1,1,0,0},

165 {"smove",
smoveCommªd
,4,"wF",0,
NULL
,1,2,1,0,0},

166 {"sismemb”",
sismemb”Commªd
,3,"rF",0,
NULL
,1,1,1,0,0},

167 {"sÿrd",
sÿrdCommªd
,2,"rF",0,
NULL
,1,1,1,0,0},

168 {"¥İ",
¥İCommªd
,-2,"wRF",0,
NULL
,1,1,1,0,0},

169 {"¤ªdmemb”",
¤ªdmemb”Commªd
,-2,"rR",0,
NULL
,1,1,1,0,0},

170 {"sš‹r",
sš‹rCommªd
,-2,"rS",0,
NULL
,1,-1,1,0,0},

171 {"sš‹r¡Üe",
sš‹r¡ÜeCommªd
,-3,"wm",0,
NULL
,1,-1,1,0,0},

172 {"suniÚ",
suniÚCommªd
,-2,"rS",0,
NULL
,1,-1,1,0,0},

173 {"suniÚ¡Üe",
suniÚ¡ÜeCommªd
,-3,"wm",0,
NULL
,1,-1,1,0,0},

174 {"sdiff",
sdiffCommªd
,-2,"rS",0,
NULL
,1,-1,1,0,0},

175 {"sdiff¡Üe",
sdiff¡ÜeCommªd
,-3,"wm",0,
NULL
,1,-1,1,0,0},

176 {"smemb”s",
sš‹rCommªd
,2,"rS",0,
NULL
,1,1,1,0,0},

177 {"ssÿn",
ssÿnCommªd
,-3,"rR",0,
NULL
,1,1,1,0,0},

178 {"zadd",
zaddCommªd
,-4,"wmF",0,
NULL
,1,1,1,0,0},

179 {"zšüby",
zšübyCommªd
,4,"wmF",0,
NULL
,1,1,1,0,0},

180 {"z»m",
z»mCommªd
,-3,"wF",0,
NULL
,1,1,1,0,0},

181 {"z»m¿ngebyscÜe",
z»m¿ngebyscÜeCommªd
,4,"w",0,
NULL
,1,1,1,0,0},

182 {"z»m¿ngeby¿nk",
z»m¿ngeby¿nkCommªd
,4,"w",0,
NULL
,1,1,1,0,0},

183 {"z»m¿ngebyËx",
z»m¿ngebyËxCommªd
,4,"w",0,
NULL
,1,1,1,0,0},

184 {"zuniÚ¡Üe",
zuniÚ¡ÜeCommªd
,-4,"wm",0,
zuniÚIÁ”G‘Keys
,0,0,0,0,0},

185 {"zš‹r¡Üe",
zš‹r¡ÜeCommªd
,-4,"wm",0,
zuniÚIÁ”G‘Keys
,0,0,0,0,0},

186 {"z¿nge",
z¿ngeCommªd
,-4,"r",0,
NULL
,1,1,1,0,0},

187 {"z¿ngebyscÜe",
z¿ngebyscÜeCommªd
,-4,"r",0,
NULL
,1,1,1,0,0},

188 {"z»v¿ngebyscÜe",
z»v¿ngebyscÜeCommªd
,-4,"r",0,
NULL
,1,1,1,0,0},

189 {"z¿ngebyËx",
z¿ngebyËxCommªd
,-4,"r",0,
NULL
,1,1,1,0,0},

190 {"z»v¿ngebyËx",
z»v¿ngebyËxCommªd
,-4,"r",0,
NULL
,1,1,1,0,0},

191 {"zcouÁ",
zcouÁCommªd
,4,"rF",0,
NULL
,1,1,1,0,0},

192 {"zËxcouÁ",
zËxcouÁCommªd
,4,"rF",0,
NULL
,1,1,1,0,0},

193 {"z»v¿nge",
z»v¿ngeCommªd
,-4,"r",0,
NULL
,1,1,1,0,0},

194 {"zÿrd",
zÿrdCommªd
,2,"rF",0,
NULL
,1,1,1,0,0},

195 {"zscÜe",
zscÜeCommªd
,3,"rF",0,
NULL
,1,1,1,0,0},

196 {"z¿nk",
z¿nkCommªd
,3,"rF",0,
NULL
,1,1,1,0,0},

197 {"z»v¿nk",
z»v¿nkCommªd
,3,"rF",0,
NULL
,1,1,1,0,0},

198 {"zsÿn",
zsÿnCommªd
,-3,"rR",0,
NULL
,1,1,1,0,0},

199 {"h£t",
h£tCommªd
,4,"wmF",0,
NULL
,1,1,1,0,0},

200 {"h£Šx",
h£ŠxCommªd
,4,"wmF",0,
NULL
,1,1,1,0,0},

201 {"hg‘",
hg‘Commªd
,3,"rF",0,
NULL
,1,1,1,0,0},

202 {"hm£t",
hm£tCommªd
,-4,"wm",0,
NULL
,1,1,1,0,0},

203 {"hmg‘",
hmg‘Commªd
,-3,"r",0,
NULL
,1,1,1,0,0},

204 {"hšüby",
hšübyCommªd
,4,"wmF",0,
NULL
,1,1,1,0,0},

205 {"hšübyæßt",
hšübyæßtCommªd
,4,"wmF",0,
NULL
,1,1,1,0,0},

206 {"hd–",
hd–Commªd
,-3,"wF",0,
NULL
,1,1,1,0,0},

207 {"hËn",
hËnCommªd
,2,"rF",0,
NULL
,1,1,1,0,0},

208 {"h¡¾’",
h¡¾’Commªd
,3,"rF",0,
NULL
,1,1,1,0,0},

209 {"hkeys",
hkeysCommªd
,2,"rS",0,
NULL
,1,1,1,0,0},

210 {"hv®s",
hv®sCommªd
,2,"rS",0,
NULL
,1,1,1,0,0},

211 {"hg‘®l",
hg‘®lCommªd
,2,"r",0,
NULL
,1,1,1,0,0},

212 {"hexi¡s",
hexi¡sCommªd
,3,"rF",0,
NULL
,1,1,1,0,0},

213 {"hsÿn",
hsÿnCommªd
,-3,"rR",0,
NULL
,1,1,1,0,0},

214 {"šüby",
šübyCommªd
,3,"wmF",0,
NULL
,1,1,1,0,0},

215 {"deüby",
deübyCommªd
,3,"wmF",0,
NULL
,1,1,1,0,0},

216 {"šübyæßt",
šübyæßtCommªd
,3,"wmF",0,
NULL
,1,1,1,0,0},

217 {"g‘£t",
g‘£tCommªd
,3,"wm",0,
NULL
,1,1,1,0,0},

218 {"m£t",
m£tCommªd
,-3,"wm",0,
NULL
,1,-1,2,0,0},

219 {"m£Šx",
m£ŠxCommªd
,-3,"wm",0,
NULL
,1,-1,2,0,0},

220 {"¿ndomkey",
¿ndomkeyCommªd
,1,"rR",0,
NULL
,0,0,0,0,0},

221 {"£Ëù",
£ËùCommªd
,2,"lF",0,
NULL
,0,0,0,0,0},

222 {"move",
moveCommªd
,3,"wF",0,
NULL
,1,1,1,0,0},

223 {"»Çme",
»ÇmeCommªd
,3,"w",0,
NULL
,1,2,1,0,0},

224 {"»Çm’x",
»Çm’xCommªd
,3,"wF",0,
NULL
,1,2,1,0,0},

225 {"expœe",
expœeCommªd
,3,"wF",0,
NULL
,1,1,1,0,0},

226 {"expœ—t",
expœ—tCommªd
,3,"wF",0,
NULL
,1,1,1,0,0},

227 {"³xpœe",
³xpœeCommªd
,3,"wF",0,
NULL
,1,1,1,0,0},

228 {"³xpœ—t",
³xpœ—tCommªd
,3,"wF",0,
NULL
,1,1,1,0,0},

229 {"keys",
keysCommªd
,2,"rS",0,
NULL
,0,0,0,0,0},

230 {"sÿn",
sÿnCommªd
,-2,"rR",0,
NULL
,0,0,0,0,0},

231 {"dbsize",
dbsizeCommªd
,1,"rF",0,
NULL
,0,0,0,0,0},

232 {"auth",
authCommªd
,2,"¦tF",0,
NULL
,0,0,0,0,0},

233 {"pšg",
pšgCommªd
,-1,"tF",0,
NULL
,0,0,0,0,0},

234 {"echo",
echoCommªd
,2,"F",0,
NULL
,0,0,0,0,0},

235 {"§ve",
§veCommªd
,1,"as",0,
NULL
,0,0,0,0,0},

236 {"bg§ve",
bg§veCommªd
,-1,"a",0,
NULL
,0,0,0,0,0},

237 {"bg»wr™—of",
bg»wr™—ofCommªd
,1,"a",0,
NULL
,0,0,0,0,0},

238 {"shutdown",
shutdownCommªd
,-1,"®t",0,
NULL
,0,0,0,0,0},

239 {"Ï¡§ve",
Ï¡§veCommªd
,1,"RF",0,
NULL
,0,0,0,0,0},

240 {"ty³",
ty³Commªd
,2,"rF",0,
NULL
,1,1,1,0,0},

241 {"muÉi",
muÉiCommªd
,1,"sF",0,
NULL
,0,0,0,0,0},

242 {"exec",
execCommªd
,1,"sM",0,
NULL
,0,0,0,0,0},

243 {"disÿrd",
disÿrdCommªd
,1,"sF",0,
NULL
,0,0,0,0,0},

244 {"sync",
syncCommªd
,1,"¬s",0,
NULL
,0,0,0,0,0},

245 {"psync",
syncCommªd
,3,"¬s",0,
NULL
,0,0,0,0,0},

246 {"»¶cÚf",
»¶cÚfCommªd
,-1,"a¦t",0,
NULL
,0,0,0,0,0},

247 {"æushdb",
æushdbCommªd
,1,"w",0,
NULL
,0,0,0,0,0},

248 {"æush®l",
æush®lCommªd
,1,"w",0,
NULL
,0,0,0,0,0},

249 {"sÜt",
sÜtCommªd
,-2,"wm",0,
sÜtG‘Keys
,1,1,1,0,0},

250 {"šfo",
šfoCommªd
,-1,"É",0,
NULL
,0,0,0,0,0},

251 {"mÚ™Ü",
mÚ™ÜCommªd
,1,"as",0,
NULL
,0,0,0,0,0},

252 {"‰l",
‰lCommªd
,2,"rF",0,
NULL
,1,1,1,0,0},

253 {"touch",
touchCommªd
,-2,"rF",0,
NULL
,1,1,1,0,0},

254 {"±",
±Commªd
,2,"rF",0,
NULL
,1,1,1,0,0},

255 {"³rsi¡",
³rsi¡Commªd
,2,"wF",0,
NULL
,1,1,1,0,0},

256 {"¦aveof",
¦aveofCommªd
,3,"a¡",0,
NULL
,0,0,0,0,0},

257 {"rŞe",
rŞeCommªd
,1,"l¡",0,
NULL
,0,0,0,0,0},

258 {"debug",
debugCommªd
,-1,"as",0,
NULL
,0,0,0,0,0},

259 {"cÚfig",
cÚfigCommªd
,-2,"Ït",0,
NULL
,0,0,0,0,0},

260 {"subsüibe",
subsüibeCommªd
,-2,"p¦t",0,
NULL
,0,0,0,0,0},

261 {"unsubsüibe",
unsubsüibeCommªd
,-1,"p¦t",0,
NULL
,0,0,0,0,0},

262 {"psubsüibe",
psubsüibeCommªd
,-2,"p¦t",0,
NULL
,0,0,0,0,0},

263 {"punsubsüibe",
punsubsüibeCommªd
,-1,"p¦t",0,
NULL
,0,0,0,0,0},

264 {"publish",
publishCommªd
,3,"¶tF",0,
NULL
,0,0,0,0,0},

265 {"pubsub",
pubsubCommªd
,-2,"¶tR",0,
NULL
,0,0,0,0,0},

266 {"w©ch",
w©chCommªd
,-2,"sF",0,
NULL
,1,-1,1,0,0},

267 {"unw©ch",
unw©chCommªd
,1,"sF",0,
NULL
,0,0,0,0,0},

268 {"şu¡”",
şu¡”Commªd
,-2,"a",0,
NULL
,0,0,0,0,0},

269 {"»¡Üe",
»¡ÜeCommªd
,-4,"wm",0,
NULL
,1,1,1,0,0},

270 {"»¡Üe-askšg",
»¡ÜeCommªd
,-4,"wmk",0,
NULL
,1,1,1,0,0},

271 {"mig¿‹",
mig¿‹Commªd
,-6,"w",0,
mig¿‹G‘Keys
,0,0,0,0,0},

272 {"askšg",
askšgCommªd
,1,"F",0,
NULL
,0,0,0,0,0},

273 {"»adÚly",
»adÚlyCommªd
,1,"F",0,
NULL
,0,0,0,0,0},

274 {"»adwr™e",
»adwr™eCommªd
,1,"F",0,
NULL
,0,0,0,0,0},

275 {"dump",
dumpCommªd
,2,"r",0,
NULL
,1,1,1,0,0},

276 {"objeù",
objeùCommªd
,3,"r",0,
NULL
,2,2,2,0,0},

277 {"ş›Á",
ş›ÁCommªd
,-2,"as",0,
NULL
,0,0,0,0,0},

278 {"ev®",
ev®Commªd
,-3,"s",0,
ev®G‘Keys
,0,0,0,0,0},

279 {"ev®sha",
ev®ShaCommªd
,-3,"s",0,
ev®G‘Keys
,0,0,0,0,0},

280 {"¦owlog",
¦owlogCommªd
,-2,"a",0,
NULL
,0,0,0,0,0},

281 {"süt",
sütCommªd
,-2,"s",0,
NULL
,0,0,0,0,0},

282 {"time",
timeCommªd
,1,"RF",0,
NULL
,0,0,0,0,0},

283 {"b™İ",
b™İCommªd
,-4,"wm",0,
NULL
,2,-1,1,0,0},

284 {"b™couÁ",
b™couÁCommªd
,-2,"r",0,
NULL
,1,1,1,0,0},

285 {"b™pos",
b™posCommªd
,-3,"r",0,
NULL
,1,1,1,0,0},

286 {"wa™",
wa™Commªd
,3,"s",0,
NULL
,0,0,0,0,0},

287 {"commªd",
commªdCommªd
,0,"É",0,
NULL
,0,0,0,0,0},

288 {"geßdd",
geßddCommªd
,-5,"wm",0,
NULL
,1,1,1,0,0},

289 {"geÜadius",
geÜadiusCommªd
,-6,"w",0,
NULL
,1,1,1,0,0},

290 {"geÜadiusbymemb”",
geÜadiusByMemb”Commªd
,-5,"w",0,
NULL
,1,1,1,0,0},

291 {"geohash",
geohashCommªd
,-2,"r",0,
NULL
,1,1,1,0,0},

292 {"geİos",
geİosCommªd
,-2,"r",0,
NULL
,1,1,1,0,0},

293 {"geodi¡",
geodi¡Commªd
,-4,"r",0,
NULL
,1,1,1,0,0},

294 {"pf£láe¡",
pf£láe¡Commªd
,1,"a",0,
NULL
,0,0,0,0,0},

295 {"pçdd",
pçddCommªd
,-2,"wmF",0,
NULL
,1,1,1,0,0},

296 {"pfcouÁ",
pfcouÁCommªd
,-2,"r",0,
NULL
,1,-1,1,0,0},

297 {"pfm”ge",
pfm”geCommªd
,-2,"wm",0,
NULL
,1,-1,1,0,0},

298 {"pfdebug",
pfdebugCommªd
,-3,"w",0,
NULL
,0,0,0,0,0},

299 {"po¡",
£cur™yW¬nšgCommªd
,-1,"É",0,
NULL
,0,0,0,0,0},

300 {"ho¡:",
£cur™yW¬nšgCommªd
,-1,"É",0,
NULL
,0,0,0,0,0},

301 {"Ï‹ncy",
Ï‹ncyCommªd
,-2,"a¦t",0,
NULL
,0,0,0,0,0}

304 
eviùiÚPoŞEÁry
 *
eviùiÚPoŞAÎoc
();

310 
	$£rv”LogRaw
(
Ëv–
, cÚ¡ *
msg
) {

311 cÚ¡ 
sy¦ogLev–M­
[] = { 
LOG_DEBUG
, 
LOG_INFO
, 
LOG_NOTICE
, 
LOG_WARNING
 };

312 cÚ¡ *
c
 = ".-*#";

313 
FILE
 *
å
;

314 
buf
[64];

315 
¿wmode
 = (
Ëv–
 & 
LL_RAW
);

316 
log_to_¡dout
 = 
£rv”
.
logfe
[0] == '\0';

318 
Ëv–
 &= 0xff;

319 ià(
Ëv–
 < 
£rv”
.
v”bos™y
) ;

321 
å
 = 
log_to_¡dout
 ? 
¡dout
 : 
	`fİ’
(
£rv”
.
logfe
,"a");

322 ià(!
å
) ;

324 ià(
¿wmode
) {

325 
	`årštf
(
å
,"%s",
msg
);

327 
off
;

328 
timev®
 
tv
;

329 
rŞe_ch¬
;

330 
pid_t
 
pid
 = 
	`g‘pid
();

332 
	`g‘timeofday
(&
tv
,
NULL
);

333 
off
 = 
	`¡ráime
(
buf
,(buf),"%d %b %H:%M:%S.",
	`loÿÉime
(&
tv
.
tv_£c
));

334 
	`¢´štf
(
buf
+
off
,(buf)-off,"%03d",()
tv
.
tv_u£c
/1000);

335 ià(
£rv”
.
£Áš–_mode
) {

336 
rŞe_ch¬
 = 'X';

337 } ià(
pid
 !ğ
£rv”
.pid) {

338 
rŞe_ch¬
 = 'C';

340 
rŞe_ch¬
 = (
£rv”
.
ma¡”ho¡
 ? 'S':'M');

342 
	`årštf
(
å
,"%d:%c %s %c %s\n",

343 ()
	`g‘pid
(),
rŞe_ch¬
, 
buf
,
c
[
Ëv–
],
msg
);

345 
	`fæush
(
å
);

347 ià(!
log_to_¡dout
è
	`fşo£
(
å
);

348 ià(
£rv”
.
sy¦og_’abËd
è
	`sy¦og
(
sy¦ogLev–M­
[
Ëv–
], "%s", 
msg
);

349 
	}
}

354 
	$£rv”Log
(
Ëv–
, cÚ¡ *
fmt
, ...) {

355 
va_li¡
 
­
;

356 
msg
[
LOG_MAX_LEN
];

358 ià((
Ëv–
&0xffè< 
£rv”
.
v”bos™y
) ;

360 
	`va_¡¬t
(
­
, 
fmt
);

361 
	`v¢´štf
(
msg
, (msg), 
fmt
, 
­
);

362 
	`va_’d
(
­
);

364 
	`£rv”LogRaw
(
Ëv–
,
msg
);

365 
	}
}

373 
	$£rv”LogFromHªdËr
(
Ëv–
, cÚ¡ *
msg
) {

374 
fd
;

375 
log_to_¡dout
 = 
£rv”
.
logfe
[0] == '\0';

376 
buf
[64];

378 ià((
Ëv–
&0xffè< 
£rv”
.
v”bos™y
 || (
log_to_¡dout
 && s”v”.
d«mÚize
))

380 
fd
 = 
log_to_¡dout
 ? 
STDOUT_FILENO
 :

381 
	`İ’
(
£rv”
.
logfe
, 
O_APPEND
|
O_CREAT
|
O_WRONLY
, 0644);

382 ià(
fd
 == -1) ;

383 
	`Î2¡ršg
(
buf
,(buf),
	`g‘pid
());

384 ià(
	`wr™e
(
fd
,
buf
,
	`¡¾’
(buf)è=ğ-1è
”r
;

385 ià(
	`wr™e
(
fd
,":sigÇl-hªdË¸(",17è=ğ-1è
”r
;

386 
	`Î2¡ršg
(
buf
,(buf),
	`time
(
NULL
));

387 ià(
	`wr™e
(
fd
,
buf
,
	`¡¾’
(buf)è=ğ-1è
”r
;

388 ià(
	`wr™e
(
fd
,"è",2è=ğ-1è
”r
;

389 ià(
	`wr™e
(
fd
,
msg
,
	`¡¾’
(msg)è=ğ-1è
”r
;

390 ià(
	`wr™e
(
fd
,"\n",1è=ğ-1è
”r
;

391 
”r
:

392 ià(!
log_to_¡dout
è
	`şo£
(
fd
);

393 
	}
}

396 
	$u¡ime
() {

397 
timev®
 
tv
;

398 
u¡
;

400 
	`g‘timeofday
(&
tv
, 
NULL
);

401 
u¡
 = (()
tv
.
tv_£c
)*1000000;

402 
u¡
 +ğ
tv
.
tv_u£c
;

403  
u¡
;

404 
	}
}

407 
m¡ime_t
 
	$m¡ime
() {

408  
	`u¡ime
()/1000;

409 
	}
}

415 
	$ex™FromChd
(
»tcode
) {

416 #ifdeà
COVERAGE_TEST


417 
	`ex™
(
»tcode
);

419 
	`_ex™
(
»tcode
);

421 
	}
}

429 
	$diùVªÏF»e
(*
´ivd©a
, *
v®
)

431 
	`DICT_NOTUSED
(
´ivd©a
);

432 
	`zä“
(
v®
);

433 
	}
}

435 
	$diùLi¡De¡ruùÜ
(*
´ivd©a
, *
v®
)

437 
	`DICT_NOTUSED
(
´ivd©a
);

438 
	`li¡R–—£
((
li¡
*)
v®
);

439 
	}
}

441 
	$diùSdsKeyCom·»
(*
´ivd©a
, cÚ¡ *
key1
,

442 cÚ¡ *
key2
)

444 
l1
,
l2
;

445 
	`DICT_NOTUSED
(
´ivd©a
);

447 
l1
 = 
	`sd¦’
((
sds
)
key1
);

448 
l2
 = 
	`sd¦’
((
sds
)
key2
);

449 ià(
l1
 !ğ
l2
)  0;

450  
	`memcmp
(
key1
, 
key2
, 
l1
) == 0;

451 
	}
}

455 
	$diùSdsKeyCa£Com·»
(*
´ivd©a
, cÚ¡ *
key1
,

456 cÚ¡ *
key2
)

458 
	`DICT_NOTUSED
(
´ivd©a
);

460  
	`¡rÿ£cmp
(
key1
, 
key2
) == 0;

461 
	}
}

463 
	$diùObjeùDe¡ruùÜ
(*
´ivd©a
, *
v®
)

465 
	`DICT_NOTUSED
(
´ivd©a
);

467 ià(
v®
 =ğ
NULL
) ;

468 
	`deüRefCouÁ
(
v®
);

469 
	}
}

471 #ifdeà
USE_PMDK


472 
	$diùObjeùDe¡ruùÜPM
(*
´ivd©a
, *
v®
)

474 
	`DICT_NOTUSED
(
´ivd©a
);

476 ià(
v®
 =ğ
NULL
)

479 
	`TX_BEGIN
(
£rv”
.
pm_poŞ
) {

480 
	`deüRefCouÁPM
(
v®
);

481 } 
TX_ONABORT
 {

482 
	`£rv”Log
(
LL_WARNING
,"ERROR: deüem’tšghPM„eàcouÁ faed (%s)", 
__func__
);

483 } 
TX_END


484 
	}
}

487 
	$diùSdsDe¡ruùÜ
(*
´ivd©a
, *
v®
)

489 
	`DICT_NOTUSED
(
´ivd©a
);

491 
	`sdsä“
(
v®
);

492 
	}
}

494 #ifdeà
USE_PMDK


495 
	$diùSdsDe¡ruùÜPM
(*
´ivd©a
, *
v®
)

497 
PMEMoid
 *
kv_PM_oid
;

499 
	`DICT_NOTUSED
(
´ivd©a
);

501 
	`TX_BEGIN
(
£rv”
.
pm_poŞ
) {

502 
kv_PM_oid
 = 
	`sdsPMEMoidBackReã»nû
(
v®
);

503 
	`sdsä“PM
(
v®
);

504 
	`pmemRemoveFromPmemLi¡
(*
kv_PM_oid
);

505 } 
TX_ONABORT
 {

506 
	`£rv”Log
(
LL_WARNING
,"ERROR:„emovšg‡À–em’ˆäom PM faed (%s)", 
__func__
);

507 } 
TX_END


508 
	}
}

511 
	$diùObjKeyCom·»
(*
´ivd©a
, cÚ¡ *
key1
,

512 cÚ¡ *
key2
)

514 cÚ¡ 
robj
 *
o1
 = 
key1
, *
o2
 = 
key2
;

515  
	`diùSdsKeyCom·»
(
´ivd©a
,
o1
->
±r
,
o2
->ptr);

516 
	}
}

518 
	$diùObjHash
(cÚ¡ *
key
) {

519 cÚ¡ 
robj
 *
o
 = 
key
;

520  
	`diùG’HashFunùiÚ
(
o
->
±r
, 
	`sd¦’
((
sds
)o->ptr));

521 
	}
}

523 
	$diùSdsHash
(cÚ¡ *
key
) {

524  
	`diùG’HashFunùiÚ
((*)
key
, 
	`sd¦’
((*)key));

525 
	}
}

527 
	$diùSdsCa£Hash
(cÚ¡ *
key
) {

528  
	`diùG’Ca£HashFunùiÚ
((*)
key
, 
	`sd¦’
((*)key));

529 
	}
}

531 
	$diùEncObjKeyCom·»
(*
´ivd©a
, cÚ¡ *
key1
,

532 cÚ¡ *
key2
)

534 
robj
 *
o1
 = (robj*è
key1
, *
o2
 = (robj*è
key2
;

535 
cmp
;

537 ià(
o1
->
’codšg
 =ğ
OBJ_ENCODING_INT
 &&

538 
o2
->
’codšg
 =ğ
OBJ_ENCODING_INT
)

539  
o1
->
±r
 =ğ
o2
->ptr;

541 
o1
 = 
	`g‘DecodedObjeù
(o1);

542 
o2
 = 
	`g‘DecodedObjeù
(o2);

543 
cmp
 = 
	`diùSdsKeyCom·»
(
´ivd©a
,
o1
->
±r
,
o2
->ptr);

544 
	`deüRefCouÁ
(
o1
);

545 
	`deüRefCouÁ
(
o2
);

546  
cmp
;

547 
	}
}

549 
	$diùEncObjHash
(cÚ¡ *
key
) {

550 
robj
 *
o
 = (robj*è
key
;

552 ià(
	`sdsEncodedObjeù
(
o
)) {

553  
	`diùG’HashFunùiÚ
(
o
->
±r
, 
	`sd¦’
((
sds
)o->ptr));

555 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

556 
buf
[32];

557 
Ën
;

559 
Ën
 = 
	`Î2¡ršg
(
buf
,32,()
o
->
±r
);

560  
	`diùG’HashFunùiÚ
((*)
buf
, 
Ën
);

562 
hash
;

564 
o
 = 
	`g‘DecodedObjeù
(o);

565 
hash
 = 
	`diùG’HashFunùiÚ
(
o
->
±r
, 
	`sd¦’
((
sds
)o->ptr));

566 
	`deüRefCouÁ
(
o
);

567  
hash
;

570 
	}
}

573 
diùTy³
 
	g£tDiùTy³
 = {

574 
diùEncObjHash
,

575 
NULL
,

576 
NULL
,

577 
diùEncObjKeyCom·»
,

578 
diùObjeùDe¡ruùÜ
,

579 
NULL


583 
diùTy³
 
	gz£tDiùTy³
 = {

584 
diùEncObjHash
,

585 
NULL
,

586 
NULL
,

587 
diùEncObjKeyCom·»
,

588 
diùObjeùDe¡ruùÜ
,

589 
NULL


593 
diùTy³
 
	gdbDiùTy³
 = {

594 
diùSdsHash
,

595 
NULL
,

596 
NULL
,

597 
diùSdsKeyCom·»
,

598 
diùSdsDe¡ruùÜ
,

599 
diùObjeùDe¡ruùÜ


602 #ifdeà
USE_PMDK


604 
diùTy³
 
	gdbDiùTy³PM
 = {

605 
diùSdsHash
,

606 
NULL
,

607 
NULL
,

608 
diùSdsKeyCom·»
,

609 
diùSdsDe¡ruùÜPM
,

610 
diùObjeùDe¡ruùÜPM


615 
diùTy³
 
	gshaSütObjeùDiùTy³
 = {

616 
diùSdsCa£Hash
,

617 
NULL
,

618 
NULL
,

619 
diùSdsKeyCa£Com·»
,

620 
diùSdsDe¡ruùÜ
,

621 
diùObjeùDe¡ruùÜ


625 
diùTy³
 
	gkey±rDiùTy³
 = {

626 
diùSdsHash
,

627 
NULL
,

628 
NULL
,

629 
diùSdsKeyCom·»
,

630 
NULL
,

631 
NULL


635 
diùTy³
 
	gcommªdTabËDiùTy³
 = {

636 
diùSdsCa£Hash
,

637 
NULL
,

638 
NULL
,

639 
diùSdsKeyCa£Com·»
,

640 
diùSdsDe¡ruùÜ
,

641 
NULL


645 
diùTy³
 
	ghashDiùTy³
 = {

646 
diùEncObjHash
,

647 
NULL
,

648 
NULL
,

649 
diùEncObjKeyCom·»
,

650 
diùObjeùDe¡ruùÜ
,

651 
diùObjeùDe¡ruùÜ


657 
diùTy³
 
	gkeyli¡DiùTy³
 = {

658 
diùObjHash
,

659 
NULL
,

660 
NULL
,

661 
diùObjKeyCom·»
,

662 
diùObjeùDe¡ruùÜ
,

663 
diùLi¡De¡ruùÜ


668 
diùTy³
 
	gşu¡”NodesDiùTy³
 = {

669 
diùSdsHash
,

670 
NULL
,

671 
NULL
,

672 
diùSdsKeyCom·»
,

673 
diùSdsDe¡ruùÜ
,

674 
NULL


680 
diùTy³
 
	gşu¡”NodesBÏckLi¡DiùTy³
 = {

681 
diùSdsCa£Hash
,

682 
NULL
,

683 
NULL
,

684 
diùSdsKeyCa£Com·»
,

685 
diùSdsDe¡ruùÜ
,

686 
NULL


690 
diùTy³
 
	gmig¿‹CacheDiùTy³
 = {

691 
diùSdsHash
,

692 
NULL
,

693 
NULL
,

694 
diùSdsKeyCom·»
,

695 
diùSdsDe¡ruùÜ
,

696 
NULL


702 
diùTy³
 
	g»¶SütCacheDiùTy³
 = {

703 
diùSdsCa£Hash
,

704 
NULL
,

705 
NULL
,

706 
diùSdsKeyCa£Com·»
,

707 
diùSdsDe¡ruùÜ
,

708 
NULL


711 
	$htN“dsResize
(
diù
 *dict) {

712 
size
, 
u£d
;

714 
size
 = 
	`diùSlÙs
(
diù
);

715 
u£d
 = 
	`diùSize
(
diù
);

716  (
size
 > 
DICT_HT_INITIAL_SIZE
 &&

717 (
u£d
*100/
size
 < 
HASHTABLE_MIN_FILL
));

718 
	}
}

722 
	$ŒyResizeHashTabËs
(
dbid
) {

723 ià(
	`htN“dsResize
(
£rv”
.
db
[
dbid
].
diù
))

724 
	`diùResize
(
£rv”
.
db
[
dbid
].
diù
);

725 ià(
	`htN“dsResize
(
£rv”
.
db
[
dbid
].
expœes
))

726 
	`diùResize
(
£rv”
.
db
[
dbid
].
expœes
);

727 
	}
}

736 
	$šüem’ÎyRehash
(
dbid
) {

738 ià(
	`diùIsRehashšg
(
£rv”
.
db
[
dbid
].
diù
)) {

739 
	`diùRehashMli£cÚds
(
£rv”
.
db
[
dbid
].
diù
,1);

743 ià(
	`diùIsRehashšg
(
£rv”
.
db
[
dbid
].
expœes
)) {

744 
	`diùRehashMli£cÚds
(
£rv”
.
db
[
dbid
].
expœes
,1);

748 
	}
}

756 
	$upd©eDiùResizePŞicy
() {

757 ià(
£rv”
.
rdb_chd_pid
 =ğ-1 && s”v”.
aof_chd_pid
 == -1)

758 
	`diùEÇbËResize
();

760 
	`diùDi§bËResize
();

761 
	}
}

776 
	$aùiveExpœeCyşeTryExpœe
(
»disDb
 *
db
, 
diùEÁry
 *
de
, 
now
) {

777 
t
 = 
	`diùG‘SigÃdIÁeg”V®
(
de
);

778 ià(
now
 > 
t
) {

779 
sds
 
key
 = 
	`diùG‘Key
(
de
);

780 
robj
 *
keyobj
 = 
	`ü—‹SŒšgObjeù
(
key
,
	`sd¦’
(key));

782 
	`´İag©eExpœe
(
db
,
keyobj
);

783 
	`dbD–‘e
(
db
,
keyobj
);

784 
	`nÙifyKey¥aûEv’t
(
NOTIFY_EXPIRED
,

785 "expœed",
keyobj
,
db
->
id
);

786 
	`deüRefCouÁ
(
keyobj
);

787 
£rv”
.
¡©_expœedkeys
++;

792 
	}
}

816 
	$aùiveExpœeCyşe
(
ty³
) {

819 
cu¼’t_db
 = 0;

820 
tim–im™_ex™
 = 0;

821 
Ï¡_ç¡_cyşe
 = 0;

823 
j
, 
™”©iÚ
 = 0;

824 
dbs_³r_ÿÎ
 = 
CRON_DBS_PER_CALL
;

825 
¡¬t
 = 
	`u¡ime
(), 
tim–im™
;

827 ià(
ty³
 =ğ
ACTIVE_EXPIRE_CYCLE_FAST
) {

831 ià(!
tim–im™_ex™
) ;

832 ià(
¡¬t
 < 
Ï¡_ç¡_cyşe
 + 
ACTIVE_EXPIRE_CYCLE_FAST_DURATION
*2) ;

833 
Ï¡_ç¡_cyşe
 = 
¡¬t
;

843 ià(
dbs_³r_ÿÎ
 > 
£rv”
.
dbnum
 || 
tim–im™_ex™
)

844 
dbs_³r_ÿÎ
 = 
£rv”
.
dbnum
;

850 
tim–im™
 = 1000000*
ACTIVE_EXPIRE_CYCLE_SLOW_TIME_PERC
/
£rv”
.
hz
/100;

851 
tim–im™_ex™
 = 0;

852 ià(
tim–im™
 <= 0)imelimit = 1;

854 ià(
ty³
 =ğ
ACTIVE_EXPIRE_CYCLE_FAST
)

855 
tim–im™
 = 
ACTIVE_EXPIRE_CYCLE_FAST_DURATION
;

857 
j
 = 0; j < 
dbs_³r_ÿÎ
; j++) {

858 
expœed
;

859 
»disDb
 *
db
 = 
£rv”
.db+(
cu¼’t_db
 % s”v”.
dbnum
);

864 
cu¼’t_db
++;

869 
num
, 
¦Ùs
;

870 
now
, 
‰l_sum
;

871 
‰l_§m¶es
;

874 ià((
num
 = 
	`diùSize
(
db
->
expœes
)) == 0) {

875 
db
->
avg_‰l
 = 0;

878 
¦Ùs
 = 
	`diùSlÙs
(
db
->
expœes
);

879 
now
 = 
	`m¡ime
();

884 ià(
num
 && 
¦Ùs
 > 
DICT_HT_INITIAL_SIZE
 &&

885 (
num
*100/
¦Ùs
 < 1)) ;

889 
expœed
 = 0;

890 
‰l_sum
 = 0;

891 
‰l_§m¶es
 = 0;

893 ià(
num
 > 
ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP
)

894 
num
 = 
ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP
;

896 
num
--) {

897 
diùEÁry
 *
de
;

898 
‰l
;

900 ià((
de
 = 
	`diùG‘RªdomKey
(
db
->
expœes
)è=ğ
NULL
) ;

901 
‰l
 = 
	`diùG‘SigÃdIÁeg”V®
(
de
)-
now
;

902 ià(
	`aùiveExpœeCyşeTryExpœe
(
db
,
de
,
now
)è
expœed
++;

903 ià(
‰l
 > 0) {

905 
‰l_sum
 +ğ
‰l
;

906 
‰l_§m¶es
++;

911 ià(
‰l_§m¶es
) {

912 
avg_‰l
 = 
‰l_sum
/
‰l_§m¶es
;

917 ià(
db
->
avg_‰l
 == 0) db->avg_ttl =‡vg_ttl;

918 
db
->
avg_‰l
 = (db->avg_ttl/50)*49 + (avg_ttl/50);

924 
™”©iÚ
++;

925 ià((
™”©iÚ
 & 0xf) == 0) {

926 
–­£d
 = 
	`u¡ime
()-
¡¬t
;

928 
	`Ï‹ncyAddSam¶eIfN“ded
("expœe-cyşe",
–­£d
/1000);

929 ià(
–­£d
 > 
tim–im™
è
tim–im™_ex™
 = 1;

931 ià(
tim–im™_ex™
) ;

934 } 
expœed
 > 
ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP
/4);

936 
	}
}

938 
	$g‘LRUClock
() {

939  (
	`m¡ime
()/
LRU_CLOCK_RESOLUTION
è& 
LRU_CLOCK_MAX
;

940 
	}
}

943 
	$ŒackIn¡ªÃousM‘ric
(
m‘ric
, 
cu¼’t_»adšg
) {

944 
t
 = 
	`m¡ime
(è- 
£rv”
.
š¡_m‘ric
[
m‘ric
].
Ï¡_§m¶e_time
;

945 
İs
 = 
cu¼’t_»adšg
 -

946 
£rv”
.
š¡_m‘ric
[
m‘ric
].
Ï¡_§m¶e_couÁ
;

947 
İs_£c
;

949 
İs_£c
 = 
t
 > 0 ? (
İs
*1000/t) : 0;

951 
£rv”
.
š¡_m‘ric
[
m‘ric
].
§m¶es
[£rv”.š¡_m‘ric[m‘ric].
idx
] =

952 
İs_£c
;

953 
£rv”
.
š¡_m‘ric
[
m‘ric
].
idx
++;

954 
£rv”
.
š¡_m‘ric
[
m‘ric
].
idx
 %ğ
STATS_METRIC_SAMPLES
;

955 
£rv”
.
š¡_m‘ric
[
m‘ric
].
Ï¡_§m¶e_time
 = 
	`m¡ime
();

956 
£rv”
.
š¡_m‘ric
[
m‘ric
].
Ï¡_§m¶e_couÁ
 = 
cu¼’t_»adšg
;

957 
	}
}

960 
	$g‘In¡ªÃousM‘ric
(
m‘ric
) {

961 
j
;

962 
sum
 = 0;

964 
j
 = 0; j < 
STATS_METRIC_SAMPLES
; j++)

965 
sum
 +ğ
£rv”
.
š¡_m‘ric
[
m‘ric
].
§m¶es
[
j
];

966  
sum
 / 
STATS_METRIC_SAMPLES
;

967 
	}
}

973 
	$ş›ÁsCrÚHªdËTimeout
(
ş›Á
 *
c
, 
m¡ime_t
 
now_ms
) {

974 
time_t
 
now
 = 
now_ms
/1000;

976 ià(
£rv”
.
maxidËtime
 &&

977 !(
c
->
æags
 & 
CLIENT_SLAVE
) &&

978 !(
c
->
æags
 & 
CLIENT_MASTER
) &&

979 !(
c
->
æags
 & 
CLIENT_BLOCKED
) &&

980 !(
c
->
æags
 & 
CLIENT_PUBSUB
) &&

981 (
now
 - 
c
->
Ï¡š‹¿ùiÚ
 > 
£rv”
.
maxidËtime
))

983 
	`£rv”Log
(
LL_VERBOSE
,"Closing idle client");

984 
	`ä“Cl›Á
(
c
);

986 } ià(
c
->
æags
 & 
CLIENT_BLOCKED
) {

991 ià(
c
->
bpİ
.
timeout
 !ğ0 && c->bpİ.timeouˆ< 
now_ms
) {

993 
	`»¶yToBlockedCl›ÁTimedOut
(
c
);

994 
	`unblockCl›Á
(
c
);

995 } ià(
£rv”
.
şu¡”_’abËd
) {

998 ià(
	`şu¡”RedœeùBlockedCl›ÁIfN“ded
(
c
))

999 
	`unblockCl›Á
(
c
);

1003 
	}
}

1009 
	$ş›ÁsCrÚResizeQu”yBufãr
(
ş›Á
 *
c
) {

1010 
size_t
 
qu”ybuf_size
 = 
	`sdsAÎocSize
(
c
->
qu”ybuf
);

1011 
time_t
 
idËtime
 = 
£rv”
.
unixtime
 - 
c
->
Ï¡š‹¿ùiÚ
;

1016 ià(((
qu”ybuf_size
 > 
PROTO_MBULK_BIG_ARG
) &&

1017 (
qu”ybuf_size
/(
c
->
qu”ybuf_³ak
+1)) > 2) ||

1018 (
qu”ybuf_size
 > 1024 && 
idËtime
 > 2))

1021 ià(
	`sd§va
(
c
->
qu”ybuf
) > 1024) {

1022 
c
->
qu”ybuf
 = 
	`sdsRemoveF»eS·û
(c->querybuf);

1027 
c
->
qu”ybuf_³ak
 = 0;

1029 
	}
}

1031 
	#CLIENTS_CRON_MIN_ITERATIONS
 5

	)

1032 
	$ş›ÁsCrÚ
() {

1037 
numş›Ás
 = 
	`li¡L’gth
(
£rv”
.
ş›Ás
);

1038 
™”©iÚs
 = 
numş›Ás
/
£rv”
.
hz
;

1039 
m¡ime_t
 
now
 = 
	`m¡ime
();

1044 ià(
™”©iÚs
 < 
CLIENTS_CRON_MIN_ITERATIONS
)

1045 
™”©iÚs
 = (
numş›Ás
 < 
CLIENTS_CRON_MIN_ITERATIONS
) ?

1046 
numş›Ás
 : 
CLIENTS_CRON_MIN_ITERATIONS
;

1048 
	`li¡L’gth
(
£rv”
.
ş›Ás
è&& 
™”©iÚs
--) {

1049 
ş›Á
 *
c
;

1050 
li¡Node
 *
h—d
;

1055 
	`li¡RÙ©e
(
£rv”
.
ş›Ás
);

1056 
h—d
 = 
	`li¡Fœ¡
(
£rv”
.
ş›Ás
);

1057 
c
 = 
	`li¡NodeV®ue
(
h—d
);

1061 ià(
	`ş›ÁsCrÚHªdËTimeout
(
c
,
now
)) ;

1062 ià(
	`ş›ÁsCrÚResizeQu”yBufãr
(
c
)) ;

1064 
	}
}

1069 
	$d©aba£sCrÚ
() {

1072 ià(
£rv”
.
aùive_expœe_’abËd
 && s”v”.
ma¡”ho¡
 =ğ
NULL
)

1073 
	`aùiveExpœeCyşe
(
ACTIVE_EXPIRE_CYCLE_SLOW
);

1078 ià(
£rv”
.
rdb_chd_pid
 =ğ-1 && s”v”.
aof_chd_pid
 == -1) {

1082 
»size_db
 = 0;

1083 
»hash_db
 = 0;

1084 
dbs_³r_ÿÎ
 = 
CRON_DBS_PER_CALL
;

1085 
j
;

1088 ià(
dbs_³r_ÿÎ
 > 
£rv”
.
dbnum
) dbs_per_call = server.dbnum;

1091 
j
 = 0; j < 
dbs_³r_ÿÎ
; j++) {

1092 
	`ŒyResizeHashTabËs
(
»size_db
 % 
£rv”
.
dbnum
);

1093 
»size_db
++;

1097 ià(
£rv”
.
aùiv”ehashšg
) {

1098 
j
 = 0; j < 
dbs_³r_ÿÎ
; j++) {

1099 
wÜk_dÚe
 = 
	`šüem’ÎyRehash
(
»hash_db
 % 
£rv”
.
dbnum
);

1100 
»hash_db
++;

1101 ià(
wÜk_dÚe
) {

1109 
	}
}

1115 
	$upd©eCachedTime
() {

1116 
£rv”
.
unixtime
 = 
	`time
(
NULL
);

1117 
£rv”
.
m¡ime
 = 
	`m¡ime
();

1118 
	}
}

1139 
	$£rv”CrÚ
(
«Ev’tLoİ
 *
ev’tLoİ
, 
id
, *
ş›ÁD©a
) {

1140 
j
;

1141 
	`UNUSED
(
ev’tLoİ
);

1142 
	`UNUSED
(
id
);

1143 
	`UNUSED
(
ş›ÁD©a
);

1147 ià(
£rv”
.
w©chdog_³riod
è
	`w©chdogScheduËSigÇl
(server.watchdog_period);

1150 
	`upd©eCachedTime
();

1152 
	`run_w™h_³riod
(100) {

1153 
	`ŒackIn¡ªÃousM‘ric
(
STATS_METRIC_COMMAND
,
£rv”
.
¡©_numcommªds
);

1154 
	`ŒackIn¡ªÃousM‘ric
(
STATS_METRIC_NET_INPUT
,

1155 
£rv”
.
¡©_Ãt_šput_by‹s
);

1156 
	`ŒackIn¡ªÃousM‘ric
(
STATS_METRIC_NET_OUTPUT
,

1157 
£rv”
.
¡©_Ãt_ouut_by‹s
);

1171 
£rv”
.
Ìuşock
 = 
	`g‘LRUClock
();

1174 ià(
	`zm®loc_u£d_memÜy
(è> 
£rv”
.
¡©_³ak_memÜy
)

1175 
£rv”
.
¡©_³ak_memÜy
 = 
	`zm®loc_u£d_memÜy
();

1178 
£rv”
.
»sid’t_£t_size
 = 
	`zm®loc_g‘_rss
();

1182 ià(
£rv”
.
shutdown_a§p
) {

1183 ià(
	`´•¬eFÜShutdown
(
SHUTDOWN_NOFLAGS
è=ğ
C_OK
è
	`ex™
(0);

1184 
	`£rv”Log
(
LL_WARNING
,"SIGTERM„eceived butƒrrorsryingo shut downhe server, checkhe†ogs for more information");

1185 
£rv”
.
shutdown_a§p
 = 0;

1189 
	`run_w™h_³riod
(5000) {

1190 
j
 = 0; j < 
£rv”
.
dbnum
; j++) {

1191 
size
, 
u£d
, 
vkeys
;

1193 
size
 = 
	`diùSlÙs
(
£rv”
.
db
[
j
].
diù
);

1194 
u£d
 = 
	`diùSize
(
£rv”
.
db
[
j
].
diù
);

1195 
vkeys
 = 
	`diùSize
(
£rv”
.
db
[
j
].
expœes
);

1196 ià(
u£d
 || 
vkeys
) {

1197 
	`£rv”Log
(
LL_VERBOSE
,"DB %d: %Îd key (%Îd vŞ©eèš %Îd slÙ HT.",
j
,
u£d
,
vkeys
,
size
);

1204 ià(!
£rv”
.
£Áš–_mode
) {

1205 
	`run_w™h_³riod
(5000) {

1206 
	`£rv”Log
(
LL_VERBOSE
,

1208 
	`li¡L’gth
(
£rv”
.
ş›Ás
)-li¡L’gth(£rv”.
¦aves
),

1209 
	`li¡L’gth
(
£rv”
.
¦aves
),

1210 
	`zm®loc_u£d_memÜy
());

1215 
	`ş›ÁsCrÚ
();

1218 
	`d©aba£sCrÚ
();

1222 ià(
£rv”
.
rdb_chd_pid
 =ğ-1 && s”v”.
aof_chd_pid
 == -1 &&

1223 
£rv”
.
aof_»wr™e_scheduËd
)

1225 
	`»wr™eAµ’dOÆyFeBackground
();

1229 ià(
£rv”
.
rdb_chd_pid
 !ğ-1 || s”v”.
aof_chd_pid
 != -1 ||

1230 
	`ldbP’dšgChd»n
())

1232 
¡©loc
;

1233 
pid_t
 
pid
;

1235 ià((
pid
 = 
	`wa™3
(&
¡©loc
,
WNOHANG
,
NULL
)) != 0) {

1236 
ex™code
 = 
	`WEXITSTATUS
(
¡©loc
);

1237 
bysigÇl
 = 0;

1239 ià(
	`WIFSIGNALED
(
¡©loc
)è
bysigÇl
 = 
	`WTERMSIG
(statloc);

1241 ià(
pid
 == -1) {

1242 
	`£rv”Log
(
LL_WARNING
,"wait3()„eturned‡nƒrror: %s. "

1244 
	`¡»¼Ü
(
”ºo
),

1245 (è
£rv”
.
rdb_chd_pid
,

1246 (è
£rv”
.
aof_chd_pid
);

1247 } ià(
pid
 =ğ
£rv”
.
rdb_chd_pid
) {

1248 
	`backgroundSaveDÚeHªdËr
(
ex™code
,
bysigÇl
);

1249 } ià(
pid
 =ğ
£rv”
.
aof_chd_pid
) {

1250 
	`backgroundRewr™eDÚeHªdËr
(
ex™code
,
bysigÇl
);

1252 ià(!
	`ldbRemoveChd
(
pid
)) {

1253 
	`£rv”Log
(
LL_WARNING
,

1255 ()
pid
);

1258 
	`upd©eDiùResizePŞicy
();

1263 
j
 = 0; j < 
£rv”
.
§v•¬am¦’
; j++) {

1264 
§v•¬am
 *
¥
 = 
£rv”
.
§v•¬ams
+
j
;

1270 ià(
£rv”
.
dœty
 >ğ
¥
->
chªges
 &&

1271 
£rv”
.
unixtime
-£rv”.
Ï¡§ve
 > 
¥
->
£cÚds
 &&

1272 (
£rv”
.
unixtime
-£rv”.
Ï¡bg§ve_Œy
 >

1273 
CONFIG_BGSAVE_RETRY_DELAY
 ||

1274 
£rv”
.
Ï¡bg§ve_¡©us
 =ğ
C_OK
))

1276 
	`£rv”Log
(
LL_NOTICE
,"%d changes in %d seconds. Saving...",

1277 
¥
->
chªges
, ()¥->
£cÚds
);

1278 
	`rdbSaveBackground
(
£rv”
.
rdb_f’ame
);

1284 ià(
£rv”
.
rdb_chd_pid
 == -1 &&

1285 
£rv”
.
aof_chd_pid
 == -1 &&

1286 
£rv”
.
aof_»wr™e_³rc
 &&

1287 
£rv”
.
aof_cu¼’t_size
 > s”v”.
aof_»wr™e_mš_size
)

1289 
ba£
 = 
£rv”
.
aof_»wr™e_ba£_size
 ?

1290 
£rv”
.
aof_»wr™e_ba£_size
 : 1;

1291 
growth
 = (
£rv”
.
aof_cu¼’t_size
*100/
ba£
) - 100;

1292 ià(
growth
 >ğ
£rv”
.
aof_»wr™e_³rc
) {

1293 
	`£rv”Log
(
LL_NOTICE
,"S¹šg‡utom©iø»wr™šg oàAOF oÀ%Îd%% growth",
growth
);

1294 
	`»wr™eAµ’dOÆyFeBackground
();

1302 ià(
£rv”
.
aof_æush_po¡pÚed_¡¬t
è
	`æushAµ’dOÆyFe
(0);

1308 
	`run_w™h_³riod
(1000) {

1309 ià(
£rv”
.
aof_Ï¡_wr™e_¡©us
 =ğ
C_ERR
)

1310 
	`æushAµ’dOÆyFe
(0);

1314 
	`ä“Cl›ÁsInAsyncF»eQueue
();

1317 
	`ş›ÁsA»Pau£d
();

1321 
	`run_w™h_³riod
(1000è
	`»¶iÿtiÚCrÚ
();

1324 
	`run_w™h_³riod
(100) {

1325 ià(
£rv”
.
şu¡”_’abËd
è
	`şu¡”CrÚ
();

1329 
	`run_w™h_³riod
(100) {

1330 ià(
£rv”
.
£Áš–_mode
è
	`£Áš–Tim”
();

1334 
	`run_w™h_³riod
(1000) {

1335 
	`mig¿‹Clo£TimedoutSock‘s
();

1345 ià(
£rv”
.
rdb_chd_pid
 =ğ-1 && s”v”.
aof_chd_pid
 == -1 &&

1346 
£rv”
.
rdb_bg§ve_scheduËd
 &&

1347 (
£rv”
.
unixtime
-£rv”.
Ï¡bg§ve_Œy
 > 
CONFIG_BGSAVE_RETRY_DELAY
 ||

1348 
£rv”
.
Ï¡bg§ve_¡©us
 =ğ
C_OK
))

1350 ià(
	`rdbSaveBackground
(
£rv”
.
rdb_f’ame
è=ğ
C_OK
)

1351 
£rv”
.
rdb_bg§ve_scheduËd
 = 0;

1354 
£rv”
.
üÚloİs
++;

1355  1000/
£rv”
.
hz
;

1356 
	}
}

1361 
	$befÜeSË•
(
«Ev’tLoİ
 *
ev’tLoİ
) {

1362 
	`UNUSED
(
ev’tLoİ
);

1368 ià(
£rv”
.
şu¡”_’abËd
è
	`şu¡”BefÜeSË•
();

1372 ià(
£rv”
.
aùive_expœe_’abËd
 && s”v”.
ma¡”ho¡
 =ğ
NULL
)

1373 
	`aùiveExpœeCyşe
(
ACTIVE_EXPIRE_CYCLE_FAST
);

1377 ià(
£rv”
.
g‘_ack_äom_¦aves
) {

1378 
robj
 *
¬gv
[3];

1380 
¬gv
[0] = 
	`ü—‹SŒšgObjeù
("REPLCONF",8);

1381 
¬gv
[1] = 
	`ü—‹SŒšgObjeù
("GETACK",6);

1382 
¬gv
[2] = 
	`ü—‹SŒšgObjeù
("*",1);

1383 
	`»¶iÿtiÚF“dSÏves
(
£rv”
.
¦aves
, s”v”.
¦ave£ldb
, 
¬gv
, 3);

1384 
	`deüRefCouÁ
(
¬gv
[0]);

1385 
	`deüRefCouÁ
(
¬gv
[1]);

1386 
	`deüRefCouÁ
(
¬gv
[2]);

1387 
£rv”
.
g‘_ack_äom_¦aves
 = 0;

1392 ià(
	`li¡L’gth
(
£rv”
.
ş›Ás_wa™šg_acks
))

1393 
	`´oûssCl›ÁsWa™šgR•liÿs
();

1396 ià(
	`li¡L’gth
(
£rv”
.
unblocked_ş›Ás
))

1397 
	`´oûssUnblockedCl›Ás
();

1400 
	`æushAµ’dOÆyFe
(0);

1403 
	`hªdËCl›ÁsW™hP’dšgWr™es
();

1404 
	}
}

1408 
	$ü—‹Sh¬edObjeùs
() {

1409 
j
;

1411 
sh¬ed
.
ülf
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("\r\n"));

1412 
sh¬ed
.
ok
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("+OK\r\n"));

1413 
sh¬ed
.
”r
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("-ERR\r\n"));

1414 
sh¬ed
.
em±ybulk
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("$0\r\n\r\n"));

1415 
sh¬ed
.
cz”o
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(":0\r\n"));

1416 
sh¬ed
.
cÚe
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(":1\r\n"));

1417 
sh¬ed
.
úegÚe
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(":-1\r\n"));

1418 
sh¬ed
.
nuÎbulk
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("$-1\r\n"));

1419 
sh¬ed
.
nuÎmuÉibulk
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("*-1\r\n"));

1420 
sh¬ed
.
em±ymuÉibulk
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("*0\r\n"));

1421 
sh¬ed
.
pÚg
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("+PONG\r\n"));

1422 
sh¬ed
.
queued
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("+QUEUED\r\n"));

1423 
sh¬ed
.
em±ysÿn
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("*2\r\n$1\r\n0\r\n*0\r\n"));

1424 
sh¬ed
.
wrÚgty³”r
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1426 
sh¬ed
.
nokey”r
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1428 
sh¬ed
.
syÁax”r
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1430 
sh¬ed
.
§meobjeù”r
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1432 
sh¬ed
.
outoäªg“¼
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1434 
sh¬ed
.
nosü‹¼
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1436 
sh¬ed
.
lßdšg”r
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1438 
sh¬ed
.
¦owsü‹¼
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1440 
sh¬ed
.
ma¡”dowÃ¼
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1442 
sh¬ed
.
bg§v“¼
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1444 
sh¬ed
.
ro¦av“¼
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1446 
sh¬ed
.
nßuth”r
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1448 
sh¬ed
.
oom”r
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1450 
sh¬ed
.
exeÿbÜ‹¼
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1452 
sh¬ed
.
nÜ•liÿ£¼
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1454 
sh¬ed
.
busykey”r
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(

1456 
sh¬ed
.
¥aû
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(" "));

1457 
sh¬ed
.
cŞÚ
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
(":"));

1458 
sh¬ed
.
¶us
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ew
("+"));

1460 
j
 = 0; j < 
PROTO_SHARED_SELECT_CMDS
; j++) {

1461 
diùid_¡r
[64];

1462 
diùid_Ën
;

1464 
diùid_Ën
 = 
	`Î2¡ršg
(
diùid_¡r
,(diùid_¡r),
j
);

1465 
sh¬ed
.
£Ëù
[
j
] = 
	`ü—‹Objeù
(
OBJ_STRING
,

1466 
	`sdsÿrštf
(
	`sd£m±y
(),

1468 
diùid_Ën
, 
diùid_¡r
));

1470 
sh¬ed
.
mes§gebulk
 = 
	`ü—‹SŒšgObjeù
("$7\r\nmessage\r\n",13);

1471 
sh¬ed
.
pmes§gebulk
 = 
	`ü—‹SŒšgObjeù
("$8\r\npmessage\r\n",14);

1472 
sh¬ed
.
subsüibebulk
 = 
	`ü—‹SŒšgObjeù
("$9\r\nsubscribe\r\n",15);

1473 
sh¬ed
.
unsubsüibebulk
 = 
	`ü—‹SŒšgObjeù
("$11\r\nunsubscribe\r\n",18);

1474 
sh¬ed
.
psubsüibebulk
 = 
	`ü—‹SŒšgObjeù
("$10\r\npsubscribe\r\n",17);

1475 
sh¬ed
.
punsubsüibebulk
 = 
	`ü—‹SŒšgObjeù
("$12\r\npunsubscribe\r\n",19);

1476 
sh¬ed
.
d–
 = 
	`ü—‹SŒšgObjeù
("DEL",3);

1477 
sh¬ed
.
½İ
 = 
	`ü—‹SŒšgObjeù
("RPOP",4);

1478 
sh¬ed
.
Íİ
 = 
	`ü—‹SŒšgObjeù
("LPOP",4);

1479 
sh¬ed
.
Íush
 = 
	`ü—‹SŒšgObjeù
("LPUSH",5);

1480 
j
 = 0; j < 
OBJ_SHARED_INTEGERS
; j++) {

1481 
sh¬ed
.
š‹g”s
[
j
] = 
	`ü—‹Objeù
(
OBJ_STRING
,(*)()j);

1482 
sh¬ed
.
š‹g”s
[
j
]->
’codšg
 = 
OBJ_ENCODING_INT
;

1484 
j
 = 0; j < 
OBJ_SHARED_BULKHDR_LEN
; j++) {

1485 
sh¬ed
.
mbulkhdr
[
j
] = 
	`ü—‹Objeù
(
OBJ_STRING
,

1486 
	`sdsÿrštf
(
	`sd£m±y
(),"*%d\r\n",
j
));

1487 
sh¬ed
.
bulkhdr
[
j
] = 
	`ü—‹Objeù
(
OBJ_STRING
,

1488 
	`sdsÿrštf
(
	`sd£m±y
(),"$%d\r\n",
j
));

1494 
sh¬ed
.
mš¡ršg
 = 
	`ü—‹SŒšgObjeù
("minstring",9);

1495 
sh¬ed
.
max¡ršg
 = 
	`ü—‹SŒšgObjeù
("maxstring",9);

1496 
	}
}

1498 
	$š™S”v”CÚfig
() {

1499 
j
;

1501 
	`g‘RªdomHexCh¬s
(
£rv”
.
runid
,
CONFIG_RUN_ID_SIZE
);

1502 
£rv”
.
cÚfigfe
 = 
NULL
;

1503 
£rv”
.
execubË
 = 
NULL
;

1504 
£rv”
.
hz
 = 
CONFIG_DEFAULT_HZ
;

1505 
£rv”
.
runid
[
CONFIG_RUN_ID_SIZE
] = '\0';

1506 
£rv”
.
¬ch_b™s
 = (() == 8) ? 64 : 32;

1507 
£rv”
.
pÜt
 = 
CONFIG_DEFAULT_SERVER_PORT
;

1508 
£rv”
.
tı_backlog
 = 
CONFIG_DEFAULT_TCP_BACKLOG
;

1509 
£rv”
.
bšdaddr_couÁ
 = 0;

1510 
£rv”
.
unixsock‘
 = 
NULL
;

1511 
£rv”
.
unixsock‘³rm
 = 
CONFIG_DEFAULT_UNIX_SOCKET_PERM
;

1512 
£rv”
.
fd_couÁ
 = 0;

1513 
£rv”
.
sofd
 = -1;

1514 
£rv”
.
´Ùeùed_mode
 = 
CONFIG_DEFAULT_PROTECTED_MODE
;

1515 
£rv”
.
dbnum
 = 
CONFIG_DEFAULT_DBNUM
;

1516 
£rv”
.
v”bos™y
 = 
CONFIG_DEFAULT_VERBOSITY
;

1517 
£rv”
.
maxidËtime
 = 
CONFIG_DEFAULT_CLIENT_TIMEOUT
;

1518 
£rv”
.
tık“·live
 = 
CONFIG_DEFAULT_TCP_KEEPALIVE
;

1519 
£rv”
.
aùive_expœe_’abËd
 = 1;

1520 
£rv”
.
ş›Á_max_qu”ybuf_Ën
 = 
PROTO_MAX_QUERYBUF_LEN
;

1521 
£rv”
.
§v•¬ams
 = 
NULL
;

1522 
£rv”
.
lßdšg
 = 0;

1523 
£rv”
.
logfe
 = 
	`z¡rdup
(
CONFIG_DEFAULT_LOGFILE
);

1524 
£rv”
.
sy¦og_’abËd
 = 
CONFIG_DEFAULT_SYSLOG_ENABLED
;

1525 
£rv”
.
sy¦og_id’t
 = 
	`z¡rdup
(
CONFIG_DEFAULT_SYSLOG_IDENT
);

1526 
£rv”
.
sy¦og_çc™y
 = 
LOG_LOCAL0
;

1527 
£rv”
.
d«mÚize
 = 
CONFIG_DEFAULT_DAEMONIZE
;

1528 #ifdeà
USE_PMDK


1529 
£rv”
.
pm_fe_·th
 = 
NULL
;

1530 
£rv”
.
pm_fe_size
 = 
CONFIG_DEFAULT_PM_FILE_SIZE
;

1531 
£rv”
.
pm_»cÚ¡ruù_»quœed
 = 
çl£
;

1533 
£rv”
.
su³rvi£d
 = 0;

1534 
£rv”
.
su³rvi£d_mode
 = 
SUPERVISED_NONE
;

1535 
£rv”
.
aof_¡©e
 = 
AOF_OFF
;

1536 
£rv”
.
aof_fsync
 = 
CONFIG_DEFAULT_AOF_FSYNC
;

1537 
£rv”
.
aof_no_fsync_Ú_»wr™e
 = 
CONFIG_DEFAULT_AOF_NO_FSYNC_ON_REWRITE
;

1538 
£rv”
.
aof_»wr™e_³rc
 = 
AOF_REWRITE_PERC
;

1539 
£rv”
.
aof_»wr™e_mš_size
 = 
AOF_REWRITE_MIN_SIZE
;

1540 
£rv”
.
aof_»wr™e_ba£_size
 = 0;

1541 
£rv”
.
aof_»wr™e_scheduËd
 = 0;

1542 
£rv”
.
aof_Ï¡_fsync
 = 
	`time
(
NULL
);

1543 
£rv”
.
aof_»wr™e_time_Ï¡
 = -1;

1544 
£rv”
.
aof_»wr™e_time_¡¬t
 = -1;

1545 
£rv”
.
aof_Ï¡bg»wr™e_¡©us
 = 
C_OK
;

1546 
£rv”
.
aof_d–ayed_fsync
 = 0;

1547 
£rv”
.
aof_fd
 = -1;

1548 
£rv”
.
aof_£Ëùed_db
 = -1;

1549 
£rv”
.
aof_æush_po¡pÚed_¡¬t
 = 0;

1550 
£rv”
.
aof_»wr™e_šüem’l_fsync
 = 
CONFIG_DEFAULT_AOF_REWRITE_INCREMENTAL_FSYNC
;

1551 
£rv”
.
aof_lßd_Œunÿ‹d
 = 
CONFIG_DEFAULT_AOF_LOAD_TRUNCATED
;

1552 
£rv”
.
pidfe
 = 
NULL
;

1553 
£rv”
.
rdb_f’ame
 = 
	`z¡rdup
(
CONFIG_DEFAULT_RDB_FILENAME
);

1554 
£rv”
.
aof_f’ame
 = 
	`z¡rdup
(
CONFIG_DEFAULT_AOF_FILENAME
);

1555 
£rv”
.
»quœ•ass
 = 
NULL
;

1556 
£rv”
.
rdb_com´essiÚ
 = 
CONFIG_DEFAULT_RDB_COMPRESSION
;

1557 
£rv”
.
rdb_checksum
 = 
CONFIG_DEFAULT_RDB_CHECKSUM
;

1558 
£rv”
.
¡İ_wr™es_Ú_bg§ve_”r
 = 
CONFIG_DEFAULT_STOP_WRITES_ON_BGSAVE_ERROR
;

1559 
£rv”
.
aùiv”ehashšg
 = 
CONFIG_DEFAULT_ACTIVE_REHASHING
;

1560 
£rv”
.
nÙify_key¥aû_ev’ts
 = 0;

1561 
£rv”
.
maxş›Ás
 = 
CONFIG_DEFAULT_MAX_CLIENTS
;

1562 
£rv”
.
bpİ_blocked_ş›Ás
 = 0;

1563 
£rv”
.
maxmemÜy
 = 
CONFIG_DEFAULT_MAXMEMORY
;

1564 
£rv”
.
maxmemÜy_pŞicy
 = 
CONFIG_DEFAULT_MAXMEMORY_POLICY
;

1565 
£rv”
.
maxmemÜy_§m¶es
 = 
CONFIG_DEFAULT_MAXMEMORY_SAMPLES
;

1566 
£rv”
.
hash_max_zli¡_’Œ›s
 = 
OBJ_HASH_MAX_ZIPLIST_ENTRIES
;

1567 
£rv”
.
hash_max_zli¡_v®ue
 = 
OBJ_HASH_MAX_ZIPLIST_VALUE
;

1568 
£rv”
.
li¡_max_zli¡_size
 = 
OBJ_LIST_MAX_ZIPLIST_SIZE
;

1569 
£rv”
.
li¡_com´ess_d•th
 = 
OBJ_LIST_COMPRESS_DEPTH
;

1570 
£rv”
.
£t_max_št£t_’Œ›s
 = 
OBJ_SET_MAX_INTSET_ENTRIES
;

1571 
£rv”
.
z£t_max_zli¡_’Œ›s
 = 
OBJ_ZSET_MAX_ZIPLIST_ENTRIES
;

1572 
£rv”
.
z£t_max_zli¡_v®ue
 = 
OBJ_ZSET_MAX_ZIPLIST_VALUE
;

1573 
£rv”
.
hÎ_¥¬£_max_by‹s
 = 
CONFIG_DEFAULT_HLL_SPARSE_MAX_BYTES
;

1574 
£rv”
.
shutdown_a§p
 = 0;

1575 
£rv”
.
»¶_pšg_¦ave_³riod
 = 
CONFIG_DEFAULT_REPL_PING_SLAVE_PERIOD
;

1576 
£rv”
.
»¶_timeout
 = 
CONFIG_DEFAULT_REPL_TIMEOUT
;

1577 
£rv”
.
»¶_mš_¦aves_to_wr™e
 = 
CONFIG_DEFAULT_MIN_SLAVES_TO_WRITE
;

1578 
£rv”
.
»¶_mš_¦aves_max_Ïg
 = 
CONFIG_DEFAULT_MIN_SLAVES_MAX_LAG
;

1579 
£rv”
.
şu¡”_’abËd
 = 0;

1580 
£rv”
.
şu¡”_node_timeout
 = 
CLUSTER_DEFAULT_NODE_TIMEOUT
;

1581 
£rv”
.
şu¡”_mig¿tiÚ_b¬r›r
 = 
CLUSTER_DEFAULT_MIGRATION_BARRIER
;

1582 
£rv”
.
şu¡”_¦ave_v®id™y_çùÜ
 = 
CLUSTER_DEFAULT_SLAVE_VALIDITY
;

1583 
£rv”
.
şu¡”_»quœe_fuÎ_cov”age
 = 
CLUSTER_DEFAULT_REQUIRE_FULL_COVERAGE
;

1584 
£rv”
.
şu¡”_cÚfigfe
 = 
	`z¡rdup
(
CONFIG_DEFAULT_CLUSTER_CONFIG_FILE
);

1585 
£rv”
.
mig¿‹_ÿched_sock‘s
 = 
	`diùC»©e
(&
mig¿‹CacheDiùTy³
,
NULL
);

1586 
£rv”
.
Ãxt_ş›Á_id
 = 1;

1587 
£rv”
.
lßdšg_´oûss_ev’ts_š‹rv®_by‹s
 = (1024*1024*2);

1589 
£rv”
.
Ìuşock
 = 
	`g‘LRUClock
();

1590 
	`»£tS”v”SaveP¬ams
();

1592 
	`­³ndS”v”SaveP¬ams
(60*60,1);

1593 
	`­³ndS”v”SaveP¬ams
(300,100);

1594 
	`­³ndS”v”SaveP¬ams
(60,10000);

1596 
£rv”
.
ma¡”auth
 = 
NULL
;

1597 
£rv”
.
ma¡”ho¡
 = 
NULL
;

1598 
£rv”
.
ma¡”pÜt
 = 6379;

1599 
£rv”
.
ma¡”
 = 
NULL
;

1600 
£rv”
.
ÿched_ma¡”
 = 
NULL
;

1601 
£rv”
.
»¶_ma¡”_š™Ÿl_off£t
 = -1;

1602 
£rv”
.
»¶_¡©e
 = 
REPL_STATE_NONE
;

1603 
£rv”
.
»¶_syncio_timeout
 = 
CONFIG_REPL_SYNCIO_TIMEOUT
;

1604 
£rv”
.
»¶_£rve_¡®e_d©a
 = 
CONFIG_DEFAULT_SLAVE_SERVE_STALE_DATA
;

1605 
£rv”
.
»¶_¦ave_ro
 = 
CONFIG_DEFAULT_SLAVE_READ_ONLY
;

1606 
£rv”
.
»¶_down_sšû
 = 0;

1607 
£rv”
.
»¶_di§bË_tı_nod–ay
 = 
CONFIG_DEFAULT_REPL_DISABLE_TCP_NODELAY
;

1608 
£rv”
.
»¶_diskËss_sync
 = 
CONFIG_DEFAULT_REPL_DISKLESS_SYNC
;

1609 
£rv”
.
»¶_diskËss_sync_d–ay
 = 
CONFIG_DEFAULT_REPL_DISKLESS_SYNC_DELAY
;

1610 
£rv”
.
¦ave_´iÜ™y
 = 
CONFIG_DEFAULT_SLAVE_PRIORITY
;

1611 
£rv”
.
¦ave_ªnounû_
 = 
CONFIG_DEFAULT_SLAVE_ANNOUNCE_IP
;

1612 
£rv”
.
¦ave_ªnounû_pÜt
 = 
CONFIG_DEFAULT_SLAVE_ANNOUNCE_PORT
;

1613 
£rv”
.
ma¡”_»¶_off£t
 = 0;

1616 
£rv”
.
»¶_backlog
 = 
NULL
;

1617 
£rv”
.
»¶_backlog_size
 = 
CONFIG_DEFAULT_REPL_BACKLOG_SIZE
;

1618 
£rv”
.
»¶_backlog_hi¡Ën
 = 0;

1619 
£rv”
.
»¶_backlog_idx
 = 0;

1620 
£rv”
.
»¶_backlog_off
 = 0;

1621 
£rv”
.
»¶_backlog_time_lim™
 = 
CONFIG_DEFAULT_REPL_BACKLOG_TIME_LIMIT
;

1622 
£rv”
.
»¶_no_¦aves_sšû
 = 
	`time
(
NULL
);

1625 
j
 = 0; j < 
CLIENT_TYPE_OBUF_COUNT
; j++)

1626 
£rv”
.
ş›Á_obuf_lim™s
[
j
] = 
ş›ÁBufãrLim™sDeçuÉs
[j];

1629 
R_Z”o
 = 0.0;

1630 
R_PosInf
 = 1.0/
R_Z”o
;

1631 
R_NegInf
 = -1.0/
R_Z”o
;

1632 
R_Nª
 = 
R_Z”o
/R_Zero;

1637 
£rv”
.
commªds
 = 
	`diùC»©e
(&
commªdTabËDiùTy³
,
NULL
);

1638 
£rv”
.
Üig_commªds
 = 
	`diùC»©e
(&
commªdTabËDiùTy³
,
NULL
);

1639 
	`pİuÏ‹CommªdTabË
();

1640 
£rv”
.
d–Commªd
 = 
	`lookupCommªdByCSŒšg
("del");

1641 
£rv”
.
muÉiCommªd
 = 
	`lookupCommªdByCSŒšg
("multi");

1642 
£rv”
.
ÍushCommªd
 = 
	`lookupCommªdByCSŒšg
("lpush");

1643 
£rv”
.
ÍİCommªd
 = 
	`lookupCommªdByCSŒšg
("lpop");

1644 
£rv”
.
½İCommªd
 = 
	`lookupCommªdByCSŒšg
("rpop");

1645 
£rv”
.
¤emCommªd
 = 
	`lookupCommªdByCSŒšg
("srem");

1646 
£rv”
.
execCommªd
 = 
	`lookupCommªdByCSŒšg
("exec");

1649 
£rv”
.
¦owlog_log_¦ow”_thª
 = 
CONFIG_DEFAULT_SLOWLOG_LOG_SLOWER_THAN
;

1650 
£rv”
.
¦owlog_max_Ën
 = 
CONFIG_DEFAULT_SLOWLOG_MAX_LEN
;

1653 
£rv”
.
Ï‹ncy_mÚ™Ü_th»shŞd
 = 
CONFIG_DEFAULT_LATENCY_MONITOR_THRESHOLD
;

1656 
£rv”
.
as£¹_çed
 = "<no‡ssertion failed>";

1657 
£rv”
.
as£¹_fe
 = "<no file>";

1658 
£rv”
.
as£¹_lše
 = 0;

1659 
£rv”
.
bug_»pÜt_¡¬t
 = 0;

1660 
£rv”
.
w©chdog_³riod
 = 0;

1661 
	}
}

1663 **
’vœÚ
;

1680 
	$»¡¬tS”v”
(
æags
, 
m¡ime_t
 
d–ay
) {

1681 
j
;

1685 ià(
	`acûss
(
£rv”
.
execubË
,
X_OK
è=ğ-1è 
C_ERR
;

1688 ià(
æags
 & 
RESTART_SERVER_CONFIG_REWRITE
 &&

1689 
£rv”
.
cÚfigfe
 &&

1690 
	`»wr™eCÚfig
(
£rv”
.
cÚfigfe
è=ğ-1è 
C_ERR
;

1693 ià(
æags
 & 
RESTART_SERVER_GRACEFULLY
 &&

1694 
	`´•¬eFÜShutdown
(
SHUTDOWN_NOFLAGS
è!ğ
C_OK
è 
C_ERR
;

1698 
j
 = 3; j < ()
£rv”
.
maxş›Ás
 + 1024; j++è
	`şo£
(j);

1701 ià(
d–ay
è
	`u¦“p
(delay*1000);

1702 
	`execve
(
£rv”
.
execubË
,£rv”.
exec_¬gv
,
’vœÚ
);

1705 
	`_ex™
(1);

1707  
C_ERR
;

1708 
	}
}

1718 
	$adju¡O³nFesLim™
() {

1719 
¾im_t
 
maxfes
 = 
£rv”
.
maxş›Ás
+
CONFIG_MIN_RESERVED_FDS
;

1720 
¾im™
 
lim™
;

1722 ià(
	`g‘¾im™
(
RLIMIT_NOFILE
,&
lim™
) == -1) {

1723 
	`£rv”Log
(
LL_WARNING
,"Unableo obtainhe current NOFILE†imit (%s),‡ssuming 1024‡nd settinghe max clients configuration‡ccordingly.",

1724 
	`¡»¼Ü
(
”ºo
));

1725 
£rv”
.
maxş›Ás
 = 1024-
CONFIG_MIN_RESERVED_FDS
;

1727 
¾im_t
 
Şdlim™
 = 
lim™
.
¾im_cur
;

1731 ià(
Şdlim™
 < 
maxfes
) {

1732 
¾im_t
 
be¡lim™
;

1733 
£Œlim™_”rÜ
 = 0;

1737 
be¡lim™
 = 
maxfes
;

1738 
be¡lim™
 > 
Şdlim™
) {

1739 
¾im_t
 
deü_¡•
 = 16;

1741 
lim™
.
¾im_cur
 = 
be¡lim™
;

1742 
lim™
.
¾im_max
 = 
be¡lim™
;

1743 ià(
	`£Œlim™
(
RLIMIT_NOFILE
,&
lim™
) != -1) ;

1744 
£Œlim™_”rÜ
 = 
”ºo
;

1748 ià(
be¡lim™
 < 
deü_¡•
) ;

1749 
be¡lim™
 -ğ
deü_¡•
;

1754 ià(
be¡lim™
 < 
Şdlim™
) bestlimit = oldlimit;

1756 ià(
be¡lim™
 < 
maxfes
) {

1757 
Şd_maxş›Ás
 = 
£rv”
.
maxş›Ás
;

1758 
£rv”
.
maxş›Ás
 = 
be¡lim™
-
CONFIG_MIN_RESERVED_FDS
;

1759 ià(
£rv”
.
maxş›Ás
 < 1) {

1760 
	`£rv”Log
(
LL_WARNING
,"Your current 'ulimit -n' "

1764 (è
Şdlim™
,

1765 (è
maxfes
);

1766 
	`ex™
(1);

1768 
	`£rv”Log
(
LL_WARNING
,"You„equested maxclients of %d "

1770 
Şd_maxş›Ás
,

1771 (è
maxfes
);

1772 
	`£rv”Log
(
LL_WARNING
,"Server can't set maximum open files "

1774 (è
maxfes
, 
	`¡»¼Ü
(
£Œlim™_”rÜ
));

1775 
	`£rv”Log
(
LL_WARNING
,"Current maximum open files is %llu. "

1779 (è
be¡lim™
, 
£rv”
.
maxş›Ás
);

1781 
	`£rv”Log
(
LL_NOTICE
,"Increased maximum‚umber of open files "

1783 (è
maxfes
,

1784 (è
Şdlim™
);

1788 
	}
}

1792 
	$checkTıBacklogS‘tšgs
() {

1793 #ifdeà
HAVE_PROC_SOMAXCONN


1794 
FILE
 *
å
 = 
	`fİ’
("/proc/sys/net/core/somaxconn","r");

1795 
buf
[1024];

1796 ià(!
å
) ;

1797 ià(
	`fg‘s
(
buf
,(buf),
å
è!ğ
NULL
) {

1798 
somaxcÚn
 = 
	`©oi
(
buf
);

1799 ià(
somaxcÚn
 > 0 && somaxcÚÀ< 
£rv”
.
tı_backlog
) {

1800 
	`£rv”Log
(
LL_WARNING
,"WARNING: ThTCP backlog s‘tšg oà%d cªnÙ b’fÜûd beÿu£ /´oc/sys/Ãt/cÜe/somaxcÚÀi £ˆtØthlow” v®uoà%d.", 
£rv”
.
tı_backlog
, 
somaxcÚn
);

1803 
	`fşo£
(
å
);

1805 
	}
}

1825 
	$li¡’ToPÜt
(
pÜt
, *
fds
, *
couÁ
) {

1826 
j
;

1830 ià(
£rv”
.
bšdaddr_couÁ
 =ğ0è£rv”.
bšdaddr
[0] = 
NULL
;

1831 
j
 = 0; j < 
£rv”
.
bšdaddr_couÁ
 || j == 0; j++) {

1832 ià(
£rv”
.
bšdaddr
[
j
] =ğ
NULL
) {

1833 
unsuµÜ‹d
 = 0;

1836 
fds
[*
couÁ
] = 
	`ª‘Tı6S”v”
(
£rv”
.
Ã‹¼
,
pÜt
,
NULL
,

1837 
£rv”
.
tı_backlog
);

1838 ià(
fds
[*
couÁ
] !ğ
ANET_ERR
) {

1839 
	`ª‘NÚBlock
(
NULL
,
fds
[*
couÁ
]);

1840 (*
couÁ
)++;

1841 } ià(
”ºo
 =ğ
EAFNOSUPPORT
) {

1842 
unsuµÜ‹d
++;

1843 
	`£rv”Log
(
LL_WARNING
,"Not†isteningo IPv6: unsupproted");

1846 ià(*
couÁ
 =ğ1 || 
unsuµÜ‹d
) {

1848 
fds
[*
couÁ
] = 
	`ª‘TıS”v”
(
£rv”
.
Ã‹¼
,
pÜt
,
NULL
,

1849 
£rv”
.
tı_backlog
);

1850 ià(
fds
[*
couÁ
] !ğ
ANET_ERR
) {

1851 
	`ª‘NÚBlock
(
NULL
,
fds
[*
couÁ
]);

1852 (*
couÁ
)++;

1853 } ià(
”ºo
 =ğ
EAFNOSUPPORT
) {

1854 
unsuµÜ‹d
++;

1855 
	`£rv”Log
(
LL_WARNING
,"Not†isteningo IPv4: unsupproted");

1861 ià(*
couÁ
 + 
unsuµÜ‹d
 == 2) ;

1862 } ià(
	`¡rchr
(
£rv”
.
bšdaddr
[
j
],':')) {

1864 
fds
[*
couÁ
] = 
	`ª‘Tı6S”v”
(
£rv”
.
Ã‹¼
,
pÜt
,£rv”.
bšdaddr
[
j
],

1865 
£rv”
.
tı_backlog
);

1868 
fds
[*
couÁ
] = 
	`ª‘TıS”v”
(
£rv”
.
Ã‹¼
,
pÜt
,£rv”.
bšdaddr
[
j
],

1869 
£rv”
.
tı_backlog
);

1871 ià(
fds
[*
couÁ
] =ğ
ANET_ERR
) {

1872 
	`£rv”Log
(
LL_WARNING
,

1874 
£rv”
.
bšdaddr
[
j
] ? server.bindaddr[j] : "*",

1875 
pÜt
, 
£rv”
.
Ã‹¼
);

1876  
C_ERR
;

1878 
	`ª‘NÚBlock
(
NULL
,
fds
[*
couÁ
]);

1879 (*
couÁ
)++;

1881  
C_OK
;

1882 
	}
}

1887 
	$»£tS”v”Sts
() {

1888 
j
;

1890 
£rv”
.
¡©_numcommªds
 = 0;

1891 
£rv”
.
¡©_numcÚÃùiÚs
 = 0;

1892 
£rv”
.
¡©_expœedkeys
 = 0;

1893 
£rv”
.
¡©_eviùedkeys
 = 0;

1894 
£rv”
.
¡©_key¥aû_mis£s
 = 0;

1895 
£rv”
.
¡©_key¥aû_h™s
 = 0;

1896 
£rv”
.
¡©_fÜk_time
 = 0;

1897 
£rv”
.
¡©_fÜk_¿‹
 = 0;

1898 
£rv”
.
¡©_»jeùed_cÚn
 = 0;

1899 
£rv”
.
¡©_sync_fuÎ
 = 0;

1900 
£rv”
.
¡©_sync_·¹Ÿl_ok
 = 0;

1901 
£rv”
.
¡©_sync_·¹Ÿl_”r
 = 0;

1902 
j
 = 0; j < 
STATS_METRIC_COUNT
; j++) {

1903 
£rv”
.
š¡_m‘ric
[
j
].
idx
 = 0;

1904 
£rv”
.
š¡_m‘ric
[
j
].
Ï¡_§m¶e_time
 = 
	`m¡ime
();

1905 
£rv”
.
š¡_m‘ric
[
j
].
Ï¡_§m¶e_couÁ
 = 0;

1906 
	`mem£t
(
£rv”
.
š¡_m‘ric
[
j
].
§m¶es
,0,

1907 (
£rv”
.
š¡_m‘ric
[
j
].
§m¶es
));

1909 
£rv”
.
¡©_Ãt_šput_by‹s
 = 0;

1910 
£rv”
.
¡©_Ãt_ouut_by‹s
 = 0;

1911 
£rv”
.
aof_d–ayed_fsync
 = 0;

1912 
	}
}

1914 
	$š™S”v”
() {

1915 
j
;

1917 
	`sigÇl
(
SIGHUP
, 
SIG_IGN
);

1918 
	`sigÇl
(
SIGPIPE
, 
SIG_IGN
);

1919 
	`£tupSigÇlHªdËrs
();

1921 ià(
£rv”
.
sy¦og_’abËd
) {

1922 
	`İ’log
(
£rv”
.
sy¦og_id’t
, 
LOG_PID
 | 
LOG_NDELAY
 | 
LOG_NOWAIT
,

1923 
£rv”
.
sy¦og_çc™y
);

1926 
£rv”
.
pid
 = 
	`g‘pid
();

1927 
£rv”
.
cu¼’t_ş›Á
 = 
NULL
;

1928 
£rv”
.
ş›Ás
 = 
	`li¡C»©e
();

1929 
£rv”
.
ş›Ás_to_şo£
 = 
	`li¡C»©e
();

1930 
£rv”
.
¦aves
 = 
	`li¡C»©e
();

1931 
£rv”
.
mÚ™Üs
 = 
	`li¡C»©e
();

1932 
£rv”
.
ş›Ás_³ndšg_wr™e
 = 
	`li¡C»©e
();

1933 
£rv”
.
¦ave£ldb
 = -1;

1934 
£rv”
.
unblocked_ş›Ás
 = 
	`li¡C»©e
();

1935 
£rv”
.
»ady_keys
 = 
	`li¡C»©e
();

1936 
£rv”
.
ş›Ás_wa™šg_acks
 = 
	`li¡C»©e
();

1937 
£rv”
.
g‘_ack_äom_¦aves
 = 0;

1938 
£rv”
.
ş›Ás_·u£d
 = 0;

1939 
£rv”
.
sy¡em_memÜy_size
 = 
	`zm®loc_g‘_memÜy_size
();

1941 
	`ü—‹Sh¬edObjeùs
();

1942 
	`adju¡O³nFesLim™
();

1943 
£rv”
.
–
 = 
	`«C»©eEv’tLoİ
(£rv”.
maxş›Ás
+
CONFIG_FDSET_INCR
);

1944 
£rv”
.
db
 = 
	`zm®loc
((
»disDb
)*£rv”.
dbnum
);

1947 ià(
£rv”
.
pÜt
 != 0 &&

1948 
	`li¡’ToPÜt
(
£rv”
.
pÜt
,£rv”.
fd
,&£rv”.
fd_couÁ
è=ğ
C_ERR
)

1949 
	`ex™
(1);

1952 ià(
£rv”
.
unixsock‘
 !ğ
NULL
) {

1953 
	`uÆšk
(
£rv”
.
unixsock‘
);

1954 
£rv”
.
sofd
 = 
	`ª‘UnixS”v”
(£rv”.
Ã‹¼
,£rv”.
unixsock‘
,

1955 
£rv”
.
unixsock‘³rm
, s”v”.
tı_backlog
);

1956 ià(
£rv”
.
sofd
 =ğ
ANET_ERR
) {

1957 
	`£rv”Log
(
LL_WARNING
, "O³nšg Unix sock‘: %s", 
£rv”
.
Ã‹¼
);

1958 
	`ex™
(1);

1960 
	`ª‘NÚBlock
(
NULL
,
£rv”
.
sofd
);

1964 ià(
£rv”
.
fd_couÁ
 =ğ0 && s”v”.
sofd
 < 0) {

1965 
	`£rv”Log
(
LL_WARNING
, "Configuredo‚ot†isten‡nywhere,ƒxiting.");

1966 
	`ex™
(1);

1970 
j
 = 0; j < 
£rv”
.
dbnum
; j++) {

1971 #ifdeà
USE_PMDK


1972 ià(
£rv”
.
³rsi¡’t
) {

1973 
£rv”
.
db
[
j
].
diù
 = 
	`diùC»©e
(&
dbDiùTy³PM
,
NULL
);

1975 
pm_ty³_roÙ_ty³_id
 = 
	`TOID_TYPE_NUM
(
»dis_pmem_roÙ
);

1976 
pm_ty³_key_v®_·œ_PM
 = 
	`TOID_TYPE_NUM
(
key_v®_·œ_PM
);

1979 
£rv”
.
db
[
j
].
diù
 = 
	`diùC»©e
(&
dbDiùTy³
,
NULL
);

1980 
£rv”
.
db
[
j
].
expœes
 = 
	`diùC»©e
(&
key±rDiùTy³
,
NULL
);

1981 
£rv”
.
db
[
j
].
blockšg_keys
 = 
	`diùC»©e
(&
keyli¡DiùTy³
,
NULL
);

1982 
£rv”
.
db
[
j
].
»ady_keys
 = 
	`diùC»©e
(&
£tDiùTy³
,
NULL
);

1983 
£rv”
.
db
[
j
].
w©ched_keys
 = 
	`diùC»©e
(&
keyli¡DiùTy³
,
NULL
);

1984 
£rv”
.
db
[
j
].
eviùiÚ_poŞ
 = 
	`eviùiÚPoŞAÎoc
();

1985 
£rv”
.
db
[
j
].
id
 = j;

1986 
£rv”
.
db
[
j
].
avg_‰l
 = 0;

1988 
£rv”
.
pubsub_chªÃls
 = 
	`diùC»©e
(&
keyli¡DiùTy³
,
NULL
);

1989 
£rv”
.
pubsub_·‰”ns
 = 
	`li¡C»©e
();

1990 
	`li¡S‘F»eM‘hod
(
£rv”
.
pubsub_·‰”ns
,
ä“PubsubP©‹º
);

1991 
	`li¡S‘M©chM‘hod
(
£rv”
.
pubsub_·‰”ns
,
li¡M©chPubsubP©‹º
);

1992 
£rv”
.
üÚloİs
 = 0;

1993 
£rv”
.
rdb_chd_pid
 = -1;

1994 
£rv”
.
aof_chd_pid
 = -1;

1995 
£rv”
.
rdb_chd_ty³
 = 
RDB_CHILD_TYPE_NONE
;

1996 
£rv”
.
rdb_bg§ve_scheduËd
 = 0;

1997 
	`aofRewr™eBufãrRe£t
();

1998 
£rv”
.
aof_buf
 = 
	`sd£m±y
();

1999 
£rv”
.
Ï¡§ve
 = 
	`time
(
NULL
);

2000 
£rv”
.
Ï¡bg§ve_Œy
 = 0;

2001 
£rv”
.
rdb_§ve_time_Ï¡
 = -1;

2002 
£rv”
.
rdb_§ve_time_¡¬t
 = -1;

2003 
£rv”
.
dœty
 = 0;

2004 
	`»£tS”v”Sts
();

2006 
£rv”
.
¡©_¡¬‰ime
 = 
	`time
(
NULL
);

2007 
£rv”
.
¡©_³ak_memÜy
 = 0;

2008 
£rv”
.
»sid’t_£t_size
 = 0;

2009 
£rv”
.
Ï¡bg§ve_¡©us
 = 
C_OK
;

2010 
£rv”
.
aof_Ï¡_wr™e_¡©us
 = 
C_OK
;

2011 
£rv”
.
aof_Ï¡_wr™e_”ºo
 = 0;

2012 
£rv”
.
»¶_good_¦aves_couÁ
 = 0;

2013 
	`upd©eCachedTime
();

2017 if(
	`«C»©eTimeEv’t
(
£rv”
.
–
, 1, 
£rv”CrÚ
, 
NULL
, NULLè=ğ
AE_ERR
) {

2018 
	`£rv”Pªic
("Can't createhe serverCronimeƒvent.");

2019 
	`ex™
(1);

2024 
j
 = 0; j < 
£rv”
.
fd_couÁ
; j++) {

2025 ià(
	`«C»©eFeEv’t
(
£rv”
.
–
, s”v”.
fd
[
j
], 
AE_READABLE
,

2026 
acû±TıHªdËr
,
NULL
è=ğ
AE_ERR
)

2028 
	`£rv”Pªic
(

2032 ià(
£rv”
.
sofd
 > 0 && 
	`«C»©eFeEv’t
(£rv”.
–
,£rv”.sofd,
AE_READABLE
,

2033 
acû±UnixHªdËr
,
NULL
è=ğ
AE_ERR
è
	`£rv”Pªic
("Unrecoverableƒrror creating server.sofd fileƒvent.");

2036 ià(
£rv”
.
aof_¡©e
 =ğ
AOF_ON
) {

2037 
£rv”
.
aof_fd
 = 
	`İ’
(£rv”.
aof_f’ame
,

2038 
O_WRONLY
|
O_APPEND
|
O_CREAT
,0644);

2039 ià(
£rv”
.
aof_fd
 == -1) {

2040 
	`£rv”Log
(
LL_WARNING
, "Can't openhe‡ppend-only file: %s",

2041 
	`¡»¼Ü
(
”ºo
));

2042 
	`ex™
(1);

2050 ià(
£rv”
.
¬ch_b™s
 =ğ32 && s”v”.
maxmemÜy
 == 0) {

2051 
	`£rv”Log
(
LL_WARNING
,"Warning: 32 bit instance detected but‚o memory†imit set. Setting 3 GB maxmemory†imit with 'noeviction'…olicy‚ow.");

2052 
£rv”
.
maxmemÜy
 = 3072LL*(1024*1024);

2053 
£rv”
.
maxmemÜy_pŞicy
 = 
MAXMEMORY_NO_EVICTION
;

2056 ià(
£rv”
.
şu¡”_’abËd
è
	`şu¡”In™
();

2057 
	`»¶iÿtiÚSütCacheIn™
();

2058 
	`sütšgIn™
(1);

2059 
	`¦owlogIn™
();

2060 
	`Ï‹ncyMÚ™ÜIn™
();

2061 
	`bioIn™
();

2062 
	}
}

2066 
	$pİuÏ‹CommªdTabË
() {

2067 
j
;

2068 
numcommªds
 = (
»disCommªdTabË
)/(
»disCommªd
);

2070 
j
 = 0; j < 
numcommªds
; j++) {

2071 
»disCommªd
 *
c
 = 
»disCommªdTabË
+
j
;

2072 *
f
 = 
c
->
sæags
;

2073 
»tv®1
, 
»tv®2
;

2075 *
f
 != '\0') {

2076 *
f
) {

2077 'w': 
c
->
æags
 |ğ
CMD_WRITE
; ;

2078 'r': 
c
->
æags
 |ğ
CMD_READONLY
; ;

2079 'm': 
c
->
æags
 |ğ
CMD_DENYOOM
; ;

2080 'a': 
c
->
æags
 |ğ
CMD_ADMIN
; ;

2081 'p': 
c
->
æags
 |ğ
CMD_PUBSUB
; ;

2082 's': 
c
->
æags
 |ğ
CMD_NOSCRIPT
; ;

2083 'R': 
c
->
æags
 |ğ
CMD_RANDOM
; ;

2084 'S': 
c
->
æags
 |ğ
CMD_SORT_FOR_SCRIPT
; ;

2085 'l': 
c
->
æags
 |ğ
CMD_LOADING
; ;

2086 't': 
c
->
æags
 |ğ
CMD_STALE
; ;

2087 'M': 
c
->
æags
 |ğ
CMD_SKIP_MONITOR
; ;

2088 'k': 
c
->
æags
 |ğ
CMD_ASKING
; ;

2089 'F': 
c
->
æags
 |ğ
CMD_FAST
; ;

2090 : 
	`£rv”Pªic
("Unsupported command flag"); ;

2092 
f
++;

2095 
»tv®1
 = 
	`diùAdd
(
£rv”
.
commªds
, 
	`sd¢ew
(
c
->
Çme
), c);

2098 
»tv®2
 = 
	`diùAdd
(
£rv”
.
Üig_commªds
, 
	`sd¢ew
(
c
->
Çme
), c);

2099 
	`£rv”As£¹
(
»tv®1
 =ğ
DICT_OK
 && 
»tv®2
 == DICT_OK);

2101 
	}
}

2103 
	$»£tCommªdTabËSts
() {

2104 
numcommªds
 = (
»disCommªdTabË
)/(
»disCommªd
);

2105 
j
;

2107 
j
 = 0; j < 
numcommªds
; j++) {

2108 
»disCommªd
 *
c
 = 
»disCommªdTabË
+
j
;

2110 
c
->
miüo£cÚds
 = 0;

2111 
c
->
ÿÎs
 = 0;

2113 
	}
}

2117 
	$»disOpA¼ayIn™
(
»disOpA¼ay
 *
ß
) {

2118 
ß
->
İs
 = 
NULL
;

2119 
ß
->
numİs
 = 0;

2120 
	}
}

2122 
	$»disOpA¼ayAµ’d
(
»disOpA¼ay
 *
ß
, 
»disCommªd
 *
cmd
, 
dbid
,

2123 
robj
 **
¬gv
, 
¬gc
, 
rg‘
)

2125 
»disOp
 *
İ
;

2127 
ß
->
İs
 = 
	`z»®loc
(ß->İs,(
»disOp
)*(ß->
numİs
+1));

2128 
İ
 = 
ß
->
İs
+ß->
numİs
;

2129 
İ
->
cmd
 = cmd;

2130 
İ
->
dbid
 = dbid;

2131 
İ
->
¬gv
 =‡rgv;

2132 
İ
->
¬gc
 =‡rgc;

2133 
İ
->
rg‘
 =arget;

2134 
ß
->
numİs
++;

2135  
ß
->
numİs
;

2136 
	}
}

2138 
	$»disOpA¼ayF»e
(
»disOpA¼ay
 *
ß
) {

2139 
ß
->
numİs
) {

2140 
j
;

2141 
»disOp
 *
İ
;

2143 
ß
->
numİs
--;

2144 
İ
 = 
ß
->
İs
+ß->
numİs
;

2145 
j
 = 0; j < 
İ
->
¬gc
; j++)

2146 
	`deüRefCouÁ
(
İ
->
¬gv
[
j
]);

2147 
	`zä“
(
İ
->
¬gv
);

2149 
	`zä“
(
ß
->
İs
);

2150 
	}
}

2154 
»disCommªd
 *
	$lookupCommªd
(
sds
 
Çme
) {

2155  
	`diùF‘chV®ue
(
£rv”
.
commªds
, 
Çme
);

2156 
	}
}

2158 
»disCommªd
 *
	$lookupCommªdByCSŒšg
(*
s
) {

2159 
»disCommªd
 *
cmd
;

2160 
sds
 
Çme
 = 
	`sd¢ew
(
s
);

2162 
cmd
 = 
	`diùF‘chV®ue
(
£rv”
.
commªds
, 
Çme
);

2163 
	`sdsä“
(
Çme
);

2164  
cmd
;

2165 
	}
}

2174 
»disCommªd
 *
	$lookupCommªdOrOrigš®
(
sds
 
Çme
) {

2175 
»disCommªd
 *
cmd
 = 
	`diùF‘chV®ue
(
£rv”
.
commªds
, 
Çme
);

2177 ià(!
cmd
ècmd = 
	`diùF‘chV®ue
(
£rv”
.
Üig_commªds
,
Çme
);

2178  
cmd
;

2179 
	}
}

2192 
	$´İag©e
(
»disCommªd
 *
cmd
, 
dbid
, 
robj
 **
¬gv
, 
¬gc
,

2193 
æags
)

2195 ià(
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
 && 
æags
 & 
PROPAGATE_AOF
)

2196 
	`ãedAµ’dOÆyFe
(
cmd
,
dbid
,
¬gv
,
¬gc
);

2197 ià(
æags
 & 
PROPAGATE_REPL
)

2198 
	`»¶iÿtiÚF“dSÏves
(
£rv”
.
¦aves
,
dbid
,
¬gv
,
¬gc
);

2199 
	}
}

2213 
	$®soPrİag©e
(
»disCommªd
 *
cmd
, 
dbid
, 
robj
 **
¬gv
, 
¬gc
,

2214 
rg‘
)

2216 
robj
 **
¬gvcİy
;

2217 
j
;

2219 ià(
£rv”
.
lßdšg
) ;

2221 
¬gvcİy
 = 
	`zm®loc
((
robj
*)*
¬gc
);

2222 
j
 = 0; j < 
¬gc
; j++) {

2223 
¬gvcİy
[
j
] = 
¬gv
[j];

2224 
	`šüRefCouÁ
(
¬gv
[
j
]);

2226 
	`»disOpA¼ayAµ’d
(&
£rv”
.
®so_´İag©e
,
cmd
,
dbid
,
¬gvcİy
,
¬gc
,
rg‘
);

2227 
	}
}

2232 
	$fÜûCommªdPrİag©iÚ
(
ş›Á
 *
c
, 
æags
) {

2233 ià(
æags
 & 
PROPAGATE_REPL
è
c
->æag |ğ
CLIENT_FORCE_REPL
;

2234 ià(
æags
 & 
PROPAGATE_AOF
è
c
->æag |ğ
CLIENT_FORCE_AOF
;

2235 
	}
}

2240 
	$´ev’tCommªdPrİag©iÚ
(
ş›Á
 *
c
) {

2241 
c
->
æags
 |ğ
CLIENT_PREVENT_PROP
;

2242 
	}
}

2245 
	$´ev’tCommªdAOF
(
ş›Á
 *
c
) {

2246 
c
->
æags
 |ğ
CLIENT_PREVENT_AOF_PROP
;

2247 
	}
}

2250 
	$´ev’tCommªdR•liÿtiÚ
(
ş›Á
 *
c
) {

2251 
c
->
æags
 |ğ
CLIENT_PREVENT_REPL_PROP
;

2252 
	}
}

2291 
	$ÿÎ
(
ş›Á
 *
c
, 
æags
) {

2292 
dœty
, 
¡¬t
, 
du¿tiÚ
;

2293 
ş›Á_Şd_æags
 = 
c
->
æags
;

2297 ià(
	`li¡L’gth
(
£rv”
.
mÚ™Üs
) &&

2298 !
£rv”
.
lßdšg
 &&

2299 !(
c
->
cmd
->
æags
 & (
CMD_SKIP_MONITOR
|
CMD_ADMIN
)))

2301 
	`»¶iÿtiÚF“dMÚ™Üs
(
c
,
£rv”
.
mÚ™Üs
,c->
db
->
id
,c->
¬gv
,c->
¬gc
);

2306 
c
->
æags
 &ğ~(
CLIENT_FORCE_AOF
|
CLIENT_FORCE_REPL
|
CLIENT_PREVENT_PROP
);

2307 
	`»disOpA¼ayIn™
(&
£rv”
.
®so_´İag©e
);

2310 
dœty
 = 
£rv”
.dirty;

2311 
¡¬t
 = 
	`u¡ime
();

2312 
c
->
cmd
->
	`´oc
(c);

2313 
du¿tiÚ
 = 
	`u¡ime
()-
¡¬t
;

2314 
dœty
 = 
£rv”
.dirty-dirty;

2315 ià(
dœty
 < 0) dirty = 0;

2319 ià(
£rv”
.
lßdšg
 && 
c
->
æags
 & 
CLIENT_LUA
)

2320 
æags
 &ğ~(
CMD_CALL_SLOWLOG
 | 
CMD_CALL_STATS
);

2325 ià(
c
->
æags
 & 
CLIENT_LUA
 && 
£rv”
.
lua_ÿÎ”
) {

2326 ià(
c
->
æags
 & 
CLIENT_FORCE_REPL
)

2327 
£rv”
.
lua_ÿÎ”
->
æags
 |ğ
CLIENT_FORCE_REPL
;

2328 ià(
c
->
æags
 & 
CLIENT_FORCE_AOF
)

2329 
£rv”
.
lua_ÿÎ”
->
æags
 |ğ
CLIENT_FORCE_AOF
;

2334 ià(
æags
 & 
CMD_CALL_SLOWLOG
 && 
c
->
cmd
->
´oc
 !ğ
execCommªd
) {

2335 *
Ï‹ncy_ev’t
 = (
c
->
cmd
->
æags
 & 
CMD_FAST
) ?

2337 
	`Ï‹ncyAddSam¶eIfN“ded
(
Ï‹ncy_ev’t
,
du¿tiÚ
/1000);

2338 
	`¦owlogPushEÁryIfN“ded
(
c
->
¬gv
,c->
¬gc
,
du¿tiÚ
);

2340 ià(
æags
 & 
CMD_CALL_STATS
) {

2341 
c
->
Ï¡cmd
->
miüo£cÚds
 +ğ
du¿tiÚ
;

2342 
c
->
Ï¡cmd
->
ÿÎs
++;

2346 ià(
æags
 & 
CMD_CALL_PROPAGATE
 &&

2347 (
c
->
æags
 & 
CLIENT_PREVENT_PROP
) != CLIENT_PREVENT_PROP)

2349 
´İag©e_æags
 = 
PROPAGATE_NONE
;

2353 ià(
dœty
è
´İag©e_æags
 |ğ(
PROPAGATE_AOF
|
PROPAGATE_REPL
);

2357 ià(
c
->
æags
 & 
CLIENT_FORCE_REPL
è
´İag©e_æags
 |ğ
PROPAGATE_REPL
;

2358 ià(
c
->
æags
 & 
CLIENT_FORCE_AOF
è
´İag©e_æags
 |ğ
PROPAGATE_AOF
;

2363 ià(
c
->
æags
 & 
CLIENT_PREVENT_REPL_PROP
 ||

2364 !(
æags
 & 
CMD_CALL_PROPAGATE_REPL
))

2365 
´İag©e_æags
 &ğ~
PROPAGATE_REPL
;

2366 ià(
c
->
æags
 & 
CLIENT_PREVENT_AOF_PROP
 ||

2367 !(
æags
 & 
CMD_CALL_PROPAGATE_AOF
))

2368 
´İag©e_æags
 &ğ~
PROPAGATE_AOF
;

2372 ià(
´İag©e_æags
 !ğ
PROPAGATE_NONE
)

2373 
	`´İag©e
(
c
->
cmd
,c->
db
->
id
,c->
¬gv
,c->
¬gc
,
´İag©e_æags
);

2378 
c
->
æags
 &ğ~(
CLIENT_FORCE_AOF
|
CLIENT_FORCE_REPL
|
CLIENT_PREVENT_PROP
);

2379 
c
->
æags
 |ğ
ş›Á_Şd_æags
 &

2380 (
CLIENT_FORCE_AOF
|
CLIENT_FORCE_REPL
|
CLIENT_PREVENT_PROP
);

2385 ià(
£rv”
.
®so_´İag©e
.
numİs
) {

2386 
j
;

2387 
»disOp
 *
rİ
;

2389 ià(
æags
 & 
CMD_CALL_PROPAGATE
) {

2390 
j
 = 0; j < 
£rv”
.
®so_´İag©e
.
numİs
; j++) {

2391 
rİ
 = &
£rv”
.
®so_´İag©e
.
İs
[
j
];

2392 
rg‘
 = 
rİ
->target;

2394 ià(!(
æags
&
CMD_CALL_PROPAGATE_AOF
)è
rg‘
 &ğ~
PROPAGATE_AOF
;

2395 ià(!(
æags
&
CMD_CALL_PROPAGATE_REPL
)è
rg‘
 &ğ~
PROPAGATE_REPL
;

2396 ià(
rg‘
)

2397 
	`´İag©e
(
rİ
->
cmd
,rİ->
dbid
,rİ->
¬gv
,rİ->
¬gc
,
rg‘
);

2400 
	`»disOpA¼ayF»e
(&
£rv”
.
®so_´İag©e
);

2402 
£rv”
.
¡©_numcommªds
++;

2403 
	}
}

2413 
	$´oûssCommªd
(
ş›Á
 *
c
) {

2418 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[0]->
±r
,"quit")) {

2419 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

2420 
c
->
æags
 |ğ
CLIENT_CLOSE_AFTER_REPLY
;

2421  
C_ERR
;

2426 
c
->
cmd
 = c->
Ï¡cmd
 = 
	`lookupCommªd
(c->
¬gv
[0]->
±r
);

2427 ià(!
c
->
cmd
) {

2428 
	`æagT¿n§ùiÚ
(
c
);

2429 
	`addR•lyE¼ÜFÜm©
(
c
,"unknown command '%s'",

2430 (*)
c
->
¬gv
[0]->
±r
);

2431  
C_OK
;

2432 } ià((
c
->
cmd
->
¬™y
 > 0 && c->cmd->¬™y !ğc->
¬gc
) ||

2433 (
c
->
¬gc
 < -c->
cmd
->
¬™y
)) {

2434 
	`æagT¿n§ùiÚ
(
c
);

2435 
	`addR•lyE¼ÜFÜm©
(
c
,"wrong‚umber of‡rguments for '%s' command",

2436 
c
->
cmd
->
Çme
);

2437  
C_OK
;

2441 ià(
£rv”
.
»quœ•ass
 && !
c
->
auth’tiÿ‹d
 && c->
cmd
->
´oc
 !ğ
authCommªd
)

2443 
	`æagT¿n§ùiÚ
(
c
);

2444 
	`addR•ly
(
c
,
sh¬ed
.
nßuth”r
);

2445  
C_OK
;

2452 ià(
£rv”
.
şu¡”_’abËd
 &&

2453 !(
c
->
æags
 & 
CLIENT_MASTER
) &&

2454 !(
c
->
æags
 & 
CLIENT_LUA
 &&

2455 
£rv”
.
lua_ÿÎ”
->
æags
 & 
CLIENT_MASTER
) &&

2456 !(
c
->
cmd
->
g‘keys_´oc
 =ğ
NULL
 && c->cmd->
fœ¡key
 == 0 &&

2457 
c
->
cmd
->
´oc
 !ğ
execCommªd
))

2459 
hash¦Ù
;

2460 
”rÜ_code
;

2461 
şu¡”Node
 *
n
 = 
	`g‘NodeByQu”y
(
c
,c->
cmd
,c->
¬gv
,c->
¬gc
,

2462 &
hash¦Ù
,&
”rÜ_code
);

2463 ià(
n
 =ğ
NULL
 ||‚ !ğ
£rv”
.
şu¡”
->
my£lf
) {

2464 ià(
c
->
cmd
->
´oc
 =ğ
execCommªd
) {

2465 
	`disÿrdT¿n§ùiÚ
(
c
);

2467 
	`æagT¿n§ùiÚ
(
c
);

2469 
	`şu¡”RedœeùCl›Á
(
c
,
n
,
hash¦Ù
,
”rÜ_code
);

2470  
C_OK
;

2479 ià(
£rv”
.
maxmemÜy
) {

2480 
»tv®
 = 
	`ä“MemÜyIfN“ded
();

2483 ià(
£rv”
.
cu¼’t_ş›Á
 =ğ
NULL
è 
C_ERR
;

2487 ià((
c
->
cmd
->
æags
 & 
CMD_DENYOOM
è&& 
»tv®
 =ğ
C_ERR
) {

2488 
	`æagT¿n§ùiÚ
(
c
);

2489 
	`addR•ly
(
c
, 
sh¬ed
.
oom”r
);

2490  
C_OK
;

2496 ià(((
£rv”
.
¡İ_wr™es_Ú_bg§ve_”r
 &&

2497 
£rv”
.
§v•¬am¦’
 > 0 &&

2498 
£rv”
.
Ï¡bg§ve_¡©us
 =ğ
C_ERR
) ||

2499 
£rv”
.
aof_Ï¡_wr™e_¡©us
 =ğ
C_ERR
) &&

2500 
£rv”
.
ma¡”ho¡
 =ğ
NULL
 &&

2501 (
c
->
cmd
->
æags
 & 
CMD_WRITE
 ||

2502 
c
->
cmd
->
´oc
 =ğ
pšgCommªd
))

2504 
	`æagT¿n§ùiÚ
(
c
);

2505 ià(
£rv”
.
aof_Ï¡_wr™e_¡©us
 =ğ
C_OK
)

2506 
	`addR•ly
(
c
, 
sh¬ed
.
bg§v“¼
);

2508 
	`addR•lySds
(
c
,

2509 
	`sdsÿrštf
(
	`sd£m±y
(),

2511 
	`¡»¼Ü
(
£rv”
.
aof_Ï¡_wr™e_”ºo
)));

2512  
C_OK
;

2517 ià(
£rv”
.
ma¡”ho¡
 =ğ
NULL
 &&

2518 
£rv”
.
»¶_mš_¦aves_to_wr™e
 &&

2519 
£rv”
.
»¶_mš_¦aves_max_Ïg
 &&

2520 
c
->
cmd
->
æags
 & 
CMD_WRITE
 &&

2521 
£rv”
.
»¶_good_¦aves_couÁ
 < s”v”.
»¶_mš_¦aves_to_wr™e
)

2523 
	`æagT¿n§ùiÚ
(
c
);

2524 
	`addR•ly
(
c
, 
sh¬ed
.
nÜ•liÿ£¼
);

2525  
C_OK
;

2530 ià(
£rv”
.
ma¡”ho¡
 && s”v”.
»¶_¦ave_ro
 &&

2531 !(
c
->
æags
 & 
CLIENT_MASTER
) &&

2532 
c
->
cmd
->
æags
 & 
CMD_WRITE
)

2534 
	`addR•ly
(
c
, 
sh¬ed
.
ro¦av“¼
);

2535  
C_OK
;

2539 ià(
c
->
æags
 & 
CLIENT_PUBSUB
 &&

2540 
c
->
cmd
->
´oc
 !ğ
pšgCommªd
 &&

2541 
c
->
cmd
->
´oc
 !ğ
subsüibeCommªd
 &&

2542 
c
->
cmd
->
´oc
 !ğ
unsubsüibeCommªd
 &&

2543 
c
->
cmd
->
´oc
 !ğ
psubsüibeCommªd
 &&

2544 
c
->
cmd
->
´oc
 !ğ
punsubsüibeCommªd
) {

2545 
	`addR•lyE¼Ü
(
c
,"only (P)SUBSCRIBE / (P)UNSUBSCRIBE / PING / QUIT‡llowed inhis context");

2546  
C_OK
;

2551 ià(
£rv”
.
ma¡”ho¡
 && s”v”.
»¶_¡©e
 !ğ
REPL_STATE_CONNECTED
 &&

2552 
£rv”
.
»¶_£rve_¡®e_d©a
 == 0 &&

2553 !(
c
->
cmd
->
æags
 & 
CMD_STALE
))

2555 
	`æagT¿n§ùiÚ
(
c
);

2556 
	`addR•ly
(
c
, 
sh¬ed
.
ma¡”dowÃ¼
);

2557  
C_OK
;

2562 ià(
£rv”
.
lßdšg
 && !(
c
->
cmd
->
æags
 & 
CMD_LOADING
)) {

2563 
	`addR•ly
(
c
, 
sh¬ed
.
lßdšg”r
);

2564  
C_OK
;

2568 ià(
£rv”
.
lua_timedout
 &&

2569 
c
->
cmd
->
´oc
 !ğ
authCommªd
 &&

2570 
c
->
cmd
->
´oc
 !ğ
»¶cÚfCommªd
 &&

2571 !(
c
->
cmd
->
´oc
 =ğ
shutdownCommªd
 &&

2572 
c
->
¬gc
 == 2 &&

2573 
	`tŞow”
(((*)
c
->
¬gv
[1]->
±r
)[0]) == 'n') &&

2574 !(
c
->
cmd
->
´oc
 =ğ
sütCommªd
 &&

2575 
c
->
¬gc
 == 2 &&

2576 
	`tŞow”
(((*)
c
->
¬gv
[1]->
±r
)[0]) == 'k'))

2578 
	`æagT¿n§ùiÚ
(
c
);

2579 
	`addR•ly
(
c
, 
sh¬ed
.
¦owsü‹¼
);

2580  
C_OK
;

2584 ià(
c
->
æags
 & 
CLIENT_MULTI
 &&

2585 
c
->
cmd
->
´oc
 !ğ
execCommªd
 && c->cmd->´oø!ğ
disÿrdCommªd
 &&

2586 
c
->
cmd
->
´oc
 !ğ
muÉiCommªd
 && c->cmd->´oø!ğ
w©chCommªd
)

2588 
	`queueMuÉiCommªd
(
c
);

2589 
	`addR•ly
(
c
,
sh¬ed
.
queued
);

2591 
	`ÿÎ
(
c
,
CMD_CALL_FULL
);

2592 
c
->
woff
 = 
£rv”
.
ma¡”_»¶_off£t
;

2593 ià(
	`li¡L’gth
(
£rv”
.
»ady_keys
))

2594 
	`hªdËCl›ÁsBlockedOnLi¡s
();

2596  
C_OK
;

2597 
	}
}

2603 
	$şo£Li¡’šgSock‘s
(
uÆšk_unix_sock‘
) {

2604 
j
;

2606 
j
 = 0; j < 
£rv”
.
fd_couÁ
; j++è
	`şo£
(£rv”.
fd
[j]);

2607 ià(
£rv”
.
sofd
 !ğ-1è
	`şo£
(server.sofd);

2608 ià(
£rv”
.
şu¡”_’abËd
)

2609 
j
 = 0; j < 
£rv”
.
cfd_couÁ
; j++è
	`şo£
(£rv”.
cfd
[j]);

2610 ià(
uÆšk_unix_sock‘
 && 
£rv”
.
unixsock‘
) {

2611 
	`£rv”Log
(
LL_NOTICE
,"Removinghe unix socket file.");

2612 
	`uÆšk
(
£rv”
.
unixsock‘
);

2614 
	}
}

2616 
	$´•¬eFÜShutdown
(
æags
) {

2617 
§ve
 = 
æags
 & 
SHUTDOWN_SAVE
;

2618 
no§ve
 = 
æags
 & 
SHUTDOWN_NOSAVE
;

2620 
	`£rv”Log
(
LL_WARNING
,"User„equested shutdown...");

2623 
	`ldbKlFÜkedSessiÚs
();

2628 ià(
£rv”
.
rdb_chd_pid
 != -1) {

2629 
	`£rv”Log
(
LL_WARNING
,"There is‡ child saving‡n .rdb. Killing it!");

2630 
	`kl
(
£rv”
.
rdb_chd_pid
,
SIGUSR1
);

2631 
	`rdbRemoveTempFe
(
£rv”
.
rdb_chd_pid
);

2634 ià(
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
) {

2637 ià(
£rv”
.
aof_chd_pid
 != -1) {

2640 ià(
£rv”
.
aof_¡©e
 =ğ
AOF_WAIT_REWRITE
) {

2641 
	`£rv”Log
(
LL_WARNING
, "Writing initial AOF, can'tƒxit.");

2642  
C_ERR
;

2644 
	`£rv”Log
(
LL_WARNING
,

2646 
	`kl
(
£rv”
.
aof_chd_pid
,
SIGUSR1
);

2649 
	`£rv”Log
(
LL_NOTICE
,"Calling fsync() onhe AOF file.");

2650 
	`aof_fsync
(
£rv”
.
aof_fd
);

2654 ià((
£rv”
.
§v•¬am¦’
 > 0 && !
no§ve
è|| 
§ve
) {

2655 
	`£rv”Log
(
LL_NOTICE
,"Savinghe final RDB snapshot beforeƒxiting.");

2657 ià(
	`rdbSave
(
£rv”
.
rdb_f’ame
è!ğ
C_OK
) {

2663 
	`£rv”Log
(
LL_WARNING
,"Errorryingo savehe DB, can'tƒxit.");

2664  
C_ERR
;

2669 ià(
£rv”
.
d«mÚize
 || s”v”.
pidfe
) {

2670 
	`£rv”Log
(
LL_NOTICE
,"Removinghe…id file.");

2671 
	`uÆšk
(
£rv”
.
pidfe
);

2676 
	`æushSÏvesOuutBufãrs
();

2679 
	`şo£Li¡’šgSock‘s
(1);

2680 
	`£rv”Log
(
LL_WARNING
,"%s is‚ow„eadyoƒxit, bye bye...",

2681 
£rv”
.
£Áš–_mode
 ? "Sentinel" : "Redis");

2682  
C_OK
;

2683 
	}
}

2696 
	$time_šd•’d’t_¡rcmp
(*
a
, *
b
) {

2697 
buç
[
CONFIG_AUTHPASS_MAX_LEN
], 
bufb
[CONFIG_AUTHPASS_MAX_LEN];

2702 
®’
 = 
	`¡¾’
(
a
);

2703 
bËn
 = 
	`¡¾’
(
b
);

2704 
j
;

2705 
diff
 = 0;

2710 ià(
®’
 > (
buç
è|| 
bËn
 > (
bufb
))  1;

2712 
	`mem£t
(
buç
,0,(bufa));

2713 
	`mem£t
(
bufb
,0,(bufb));

2716 
	`memıy
(
buç
,
a
,
®’
);

2717 
	`memıy
(
bufb
,
b
,
bËn
);

2721 
j
 = 0; j < (
buç
); j++) {

2722 
diff
 |ğ(
buç
[
j
] ^ 
bufb
[j]);

2725 
diff
 |ğ
®’
 ^ 
bËn
;

2726  
diff
;

2727 
	}
}

2729 
	$authCommªd
(
ş›Á
 *
c
) {

2730 ià(!
£rv”
.
»quœ•ass
) {

2731 
	`addR•lyE¼Ü
(
c
,"Client sent AUTH, but‚o…assword is set");

2732 } ià(!
	`time_šd•’d’t_¡rcmp
(
c
->
¬gv
[1]->
±r
, 
£rv”
.
»quœ•ass
)) {

2733 
c
->
auth’tiÿ‹d
 = 1;

2734 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

2736 
c
->
auth’tiÿ‹d
 = 0;

2737 
	`addR•lyE¼Ü
(
c
,"invalid…assword");

2739 
	}
}

2743 
	$pšgCommªd
(
ş›Á
 *
c
) {

2745 ià(
c
->
¬gc
 > 2) {

2746 
	`addR•lyE¼ÜFÜm©
(
c
,"wrong‚umber of‡rguments for '%s' command",

2747 
c
->
cmd
->
Çme
);

2751 ià(
c
->
æags
 & 
CLIENT_PUBSUB
) {

2752 
	`addR•ly
(
c
,
sh¬ed
.
mbulkhdr
[2]);

2753 
	`addR•lyBulkCBufãr
(
c
,"pong",4);

2754 ià(
c
->
¬gc
 == 1)

2755 
	`addR•lyBulkCBufãr
(
c
,"",0);

2757 
	`addR•lyBulk
(
c
,c->
¬gv
[1]);

2759 ià(
c
->
¬gc
 == 1)

2760 
	`addR•ly
(
c
,
sh¬ed
.
pÚg
);

2762 
	`addR•lyBulk
(
c
,c->
¬gv
[1]);

2764 
	}
}

2766 
	$echoCommªd
(
ş›Á
 *
c
) {

2767 
	`addR•lyBulk
(
c
,c->
¬gv
[1]);

2768 
	}
}

2770 
	$timeCommªd
(
ş›Á
 *
c
) {

2771 
timev®
 
tv
;

2775 
	`g‘timeofday
(&
tv
,
NULL
);

2776 
	`addR•lyMuÉiBulkL’
(
c
,2);

2777 
	`addR•lyBulkLÚgLÚg
(
c
,
tv
.
tv_£c
);

2778 
	`addR•lyBulkLÚgLÚg
(
c
,
tv
.
tv_u£c
);

2779 
	}
}

2782 
	$addR•lyCommªdFÏg
(
ş›Á
 *
c
, 
»disCommªd
 *
cmd
, 
f
, *
»¶y
) {

2783 ià(
cmd
->
æags
 & 
f
) {

2784 
	`addR•lyStus
(
c
, 
»¶y
);

2788 
	}
}

2791 
	$addR•lyCommªd
(
ş›Á
 *
c
, 
»disCommªd
 *
cmd
) {

2792 ià(!
cmd
) {

2793 
	`addR•ly
(
c
, 
sh¬ed
.
nuÎbulk
);

2796 
	`addR•lyMuÉiBulkL’
(
c
, 6);

2797 
	`addR•lyBulkCSŒšg
(
c
, 
cmd
->
Çme
);

2798 
	`addR•lyLÚgLÚg
(
c
, 
cmd
->
¬™y
);

2800 
æagcouÁ
 = 0;

2801 *
æagËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

2802 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_WRITE
, "write");

2803 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_READONLY
, "readonly");

2804 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_DENYOOM
, "denyoom");

2805 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_ADMIN
, "admin");

2806 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_PUBSUB
, "pubsub");

2807 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_NOSCRIPT
, "noscript");

2808 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_RANDOM
, "random");

2809 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_SORT_FOR_SCRIPT
,"sort_for_script");

2810 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_LOADING
, "loading");

2811 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_STALE
, "stale");

2812 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_SKIP_MONITOR
, "skip_monitor");

2813 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_ASKING
, "asking");

2814 
æagcouÁ
 +ğ
	`addR•lyCommªdFÏg
(
c
,
cmd
,
CMD_FAST
, "fast");

2815 ià(
cmd
->
g‘keys_´oc
) {

2816 
	`addR•lyStus
(
c
, "movablekeys");

2817 
æagcouÁ
 += 1;

2819 
	`£tDeã¼edMuÉiBulkL’gth
(
c
, 
æagËn
, 
æagcouÁ
);

2821 
	`addR•lyLÚgLÚg
(
c
, 
cmd
->
fœ¡key
);

2822 
	`addR•lyLÚgLÚg
(
c
, 
cmd
->
Ï¡key
);

2823 
	`addR•lyLÚgLÚg
(
c
, 
cmd
->
key¡•
);

2825 
	}
}

2828 
	$commªdCommªd
(
ş›Á
 *
c
) {

2829 
diùI‹¿tÜ
 *
di
;

2830 
diùEÁry
 *
de
;

2832 ià(
c
->
¬gc
 == 1) {

2833 
	`addR•lyMuÉiBulkL’
(
c
, 
	`diùSize
(
£rv”
.
commªds
));

2834 
di
 = 
	`diùG‘I‹¿tÜ
(
£rv”
.
commªds
);

2835 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

2836 
	`addR•lyCommªd
(
c
, 
	`diùG‘V®
(
de
));

2838 
	`diùR–—£I‹¿tÜ
(
di
);

2839 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
, "info")) {

2840 
i
;

2841 
	`addR•lyMuÉiBulkL’
(
c
, c->
¬gc
-2);

2842 
i
 = 2; i < 
c
->
¬gc
; i++) {

2843 
	`addR•lyCommªd
(
c
, 
	`diùF‘chV®ue
(
£rv”
.
commªds
, c->
¬gv
[
i
]->
±r
));

2845 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
, "couÁ"è&& c->
¬gc
 == 2) {

2846 
	`addR•lyLÚgLÚg
(
c
, 
	`diùSize
(
£rv”
.
commªds
));

2847 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"g‘keys"è&& c->
¬gc
 >= 3) {

2848 
»disCommªd
 *
cmd
 = 
	`lookupCommªd
(
c
->
¬gv
[2]->
±r
);

2849 *
keys
, 
numkeys
, 
j
;

2851 ià(!
cmd
) {

2852 
	`addR•lyE¼ÜFÜm©
(
c
,"Invalid command specified");

2854 } ià((
cmd
->
¬™y
 > 0 && cmd->¬™y !ğ
c
->
¬gc
-2) ||

2855 ((
c
->
¬gc
-2è< -
cmd
->
¬™y
))

2857 
	`addR•lyE¼Ü
(
c
,"Invalid‚umber of‡rguments specified for command");

2861 
keys
 = 
	`g‘KeysFromCommªd
(
cmd
,
c
->
¬gv
+2,c->
¬gc
-2,&
numkeys
);

2862 
	`addR•lyMuÉiBulkL’
(
c
,
numkeys
);

2863 
j
 = 0; j < 
numkeys
; j++è
	`addR•lyBulk
(
c
,c->
¬gv
[
keys
[j]+2]);

2864 
	`g‘KeysF»eResuÉ
(
keys
);

2866 
	`addR•lyE¼Ü
(
c
, "Unknown subcommand or wrong‚umber of‡rguments.");

2869 
	}
}

2873 
	$by‹sToHumª
(*
s
, 
n
) {

2874 
d
;

2876 ià(
n
 < 1024) {

2878 
	`¥rštf
(
s
,"%ÎuB",
n
);

2880 } ià(
n
 < (1024*1024)) {

2881 
d
 = ()
n
/(1024);

2882 
	`¥rštf
(
s
,"%.2fK",
d
);

2883 } ià(
n
 < (1024LL*1024*1024)) {

2884 
d
 = ()
n
/(1024*1024);

2885 
	`¥rštf
(
s
,"%.2fM",
d
);

2886 } ià(
n
 < (1024LL*1024*1024*1024)) {

2887 
d
 = ()
n
/(1024LL*1024*1024);

2888 
	`¥rštf
(
s
,"%.2fG",
d
);

2889 } ià(
n
 < (1024LL*1024*1024*1024*1024)) {

2890 
d
 = ()
n
/(1024LL*1024*1024*1024);

2891 
	`¥rštf
(
s
,"%.2fT",
d
);

2892 } ià(
n
 < (1024LL*1024*1024*1024*1024*1024)) {

2893 
d
 = ()
n
/(1024LL*1024*1024*1024*1024);

2894 
	`¥rštf
(
s
,"%.2fP",
d
);

2897 
	`¥rštf
(
s
,"%ÎuB",
n
);

2899 
	}
}

2904 
sds
 
	$g’RedisInfoSŒšg
(*
£ùiÚ
) {

2905 
sds
 
šfo
 = 
	`sd£m±y
();

2906 
time_t
 
u±ime
 = 
£rv”
.
unixtime
-£rv”.
¡©_¡¬‰ime
;

2907 
j
, 
numcommªds
;

2908 
ru§ge
 
£lf_ru
, 
c_ru
;

2909 
lŞ
, 
bib
;

2910 
®l£ùiÚs
 = 0, 
def£ùiÚs
 = 0;

2911 
£ùiÚs
 = 0;

2913 ià(
£ùiÚ
 =ğ
NULL
) section = "default";

2914 
®l£ùiÚs
 = 
	`¡rÿ£cmp
(
£ùiÚ
,"all") == 0;

2915 
def£ùiÚs
 = 
	`¡rÿ£cmp
(
£ùiÚ
,"default") == 0;

2917 
	`g‘ru§ge
(
RUSAGE_SELF
, &
£lf_ru
);

2918 
	`g‘ru§ge
(
RUSAGE_CHILDREN
, &
c_ru
);

2919 
	`g‘Cl›ÁsMaxBufãrs
(&
lŞ
,&
bib
);

2922 ià(
®l£ùiÚs
 || 
def£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"server")) {

2923 
ÿÎ_uÇme
 = 1;

2924 
ut¢ame
 
Çme
;

2925 *
mode
;

2927 ià(
£rv”
.
şu¡”_’abËd
è
mode
 = "cluster";

2928 ià(
£rv”
.
£Áš–_mode
è
mode
 = "sentinel";

2929 
mode
 = "standalone";

2931 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

2933 ià(
ÿÎ_uÇme
) {

2935 
	`uÇme
(&
Çme
);

2936 
ÿÎ_uÇme
 = 0;

2939 
šfo
 = 
	`sdsÿrštf
(info,

2959 
REDIS_VERSION
,

2960 
	`»disG™SHA1
(),

2961 
	`¡¹Ş
(
	`»disG™Dœty
(),
NULL
,10) > 0,

2962 (è
	`»disBudId
(),

2963 
mode
,

2964 
Çme
.
sy¢ame
,‚ame.
»Ëa£
,‚ame.
machše
,

2965 
£rv”
.
¬ch_b™s
,

2966 
	`«G‘ApiName
(),

2967 #ifdeà
__GNUC__


2968 
__GNUC__
,
__GNUC_MINOR__
,
__GNUC_PATCHLEVEL__
,

2972 (è
	`g‘pid
(),

2973 
£rv”
.
runid
,

2974 
£rv”
.
pÜt
,

2975 (
štmax_t
)
u±ime
,

2976 (
štmax_t
)(
u±ime
/(3600*24)),

2977 
£rv”
.
hz
,

2978 (è
£rv”
.
Ìuşock
,

2979 
£rv”
.
execubË
 ? server.executable : "",

2980 
£rv”
.
cÚfigfe
 ? server.configfile : "");

2984 ià(
®l£ùiÚs
 || 
def£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"clients")) {

2985 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

2986 
šfo
 = 
	`sdsÿrštf
(info,

2992 
	`li¡L’gth
(
£rv”
.
ş›Ás
)-li¡L’gth(£rv”.
¦aves
),

2993 
lŞ
, 
bib
,

2994 
£rv”
.
bpİ_blocked_ş›Ás
);

2998 ià(
®l£ùiÚs
 || 
def£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"memory")) {

2999 
hmem
[64];

3000 
³ak_hmem
[64];

3001 
tÙ®_sy¡em_hmem
[64];

3002 
u£d_memÜy_lua_hmem
[64];

3003 
u£d_memÜy_rss_hmem
[64];

3004 
maxmemÜy_hmem
[64];

3005 
size_t
 
zm®loc_u£d
 = 
	`zm®loc_u£d_memÜy
();

3006 
size_t
 
tÙ®_sy¡em_mem
 = 
£rv”
.
sy¡em_memÜy_size
;

3007 cÚ¡ *
eviù_pŞicy
 = 
	`eviùPŞicyToSŒšg
();

3008 
memÜy_lua
 = ()
	`lua_gc
(
£rv”
.
lua
,
LUA_GCCOUNT
,0)*1024;

3014 ià(
zm®loc_u£d
 > 
£rv”
.
¡©_³ak_memÜy
)

3015 
£rv”
.
¡©_³ak_memÜy
 = 
zm®loc_u£d
;

3017 
	`by‹sToHumª
(
hmem
,
zm®loc_u£d
);

3018 
	`by‹sToHumª
(
³ak_hmem
,
£rv”
.
¡©_³ak_memÜy
);

3019 
	`by‹sToHumª
(
tÙ®_sy¡em_hmem
,
tÙ®_sy¡em_mem
);

3020 
	`by‹sToHumª
(
u£d_memÜy_lua_hmem
,
memÜy_lua
);

3021 
	`by‹sToHumª
(
u£d_memÜy_rss_hmem
,
£rv”
.
»sid’t_£t_size
);

3022 
	`by‹sToHumª
(
maxmemÜy_hmem
,
£rv”
.
maxmemÜy
);

3024 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

3025 
šfo
 = 
	`sdsÿrštf
(info,

3042 
zm®loc_u£d
,

3043 
hmem
,

3044 
£rv”
.
»sid’t_£t_size
,

3045 
u£d_memÜy_rss_hmem
,

3046 
£rv”
.
¡©_³ak_memÜy
,

3047 
³ak_hmem
,

3048 ()
tÙ®_sy¡em_mem
,

3049 
tÙ®_sy¡em_hmem
,

3050 
memÜy_lua
,

3051 
u£d_memÜy_lua_hmem
,

3052 
£rv”
.
maxmemÜy
,

3053 
maxmemÜy_hmem
,

3054 
eviù_pŞicy
,

3055 
	`zm®loc_g‘_äagm’tiÚ_¿tio
(
£rv”
.
»sid’t_£t_size
),

3056 
ZMALLOC_LIB


3061 ià(
®l£ùiÚs
 || 
def£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"persistence")) {

3062 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

3063 
šfo
 = 
	`sdsÿrštf
(info,

3079 
£rv”
.
lßdšg
,

3080 
£rv”
.
dœty
,

3081 
£rv”
.
rdb_chd_pid
 != -1,

3082 (
štmax_t
)
£rv”
.
Ï¡§ve
,

3083 (
£rv”
.
Ï¡bg§ve_¡©us
 =ğ
C_OK
) ? "ok" : "err",

3084 (
štmax_t
)
£rv”
.
rdb_§ve_time_Ï¡
,

3085 (
štmax_t
)((
£rv”
.
rdb_chd_pid
 == -1) ?

3086 -1 : 
	`time
(
NULL
)-
£rv”
.
rdb_§ve_time_¡¬t
),

3087 
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
,

3088 
£rv”
.
aof_chd_pid
 != -1,

3089 
£rv”
.
aof_»wr™e_scheduËd
,

3090 (
štmax_t
)
£rv”
.
aof_»wr™e_time_Ï¡
,

3091 (
štmax_t
)((
£rv”
.
aof_chd_pid
 == -1) ?

3092 -1 : 
	`time
(
NULL
)-
£rv”
.
aof_»wr™e_time_¡¬t
),

3093 (
£rv”
.
aof_Ï¡bg»wr™e_¡©us
 =ğ
C_OK
) ? "ok" : "err",

3094 (
£rv”
.
aof_Ï¡_wr™e_¡©us
 =ğ
C_OK
) ? "ok" : "err");

3096 ià(
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
) {

3097 
šfo
 = 
	`sdsÿrštf
(info,

3105 (è
£rv”
.
aof_cu¼’t_size
,

3106 (è
£rv”
.
aof_»wr™e_ba£_size
,

3107 
£rv”
.
aof_»wr™e_scheduËd
,

3108 
	`sd¦’
(
£rv”
.
aof_buf
),

3109 
	`aofRewr™eBufãrSize
(),

3110 
	`bioP’dšgJobsOfTy³
(
BIO_AOF_FSYNC
),

3111 
£rv”
.
aof_d–ayed_fsync
);

3114 ià(
£rv”
.
lßdšg
) {

3115 
³rc
;

3116 
time_t
 
‘a
, 
–­£d
;

3117 
off_t
 
»maššg_by‹s
 = 
£rv”
.
lßdšg_tÙ®_by‹s
-

3118 
£rv”
.
lßdšg_lßded_by‹s
;

3120 
³rc
 = (()
£rv”
.
lßdšg_lßded_by‹s
 /

3121 (
£rv”
.
lßdšg_tÙ®_by‹s
+1)) * 100;

3123 
–­£d
 = 
	`time
(
NULL
)-
£rv”
.
lßdšg_¡¬t_time
;

3124 ià(
–­£d
 == 0) {

3125 
‘a
 = 1;

3128 
‘a
 = (
–­£d
*
»maššg_by‹s
)/(
£rv”
.
lßdšg_lßded_by‹s
+1);

3131 
šfo
 = 
	`sdsÿrštf
(info,

3137 (
štmax_t
è
£rv”
.
lßdšg_¡¬t_time
,

3138 (è
£rv”
.
lßdšg_tÙ®_by‹s
,

3139 (è
£rv”
.
lßdšg_lßded_by‹s
,

3140 
³rc
,

3141 (
štmax_t
)
‘a


3147 ià(
®l£ùiÚs
 || 
def£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"stats")) {

3148 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

3149 
šfo
 = 
	`sdsÿrštf
(info,

3170 
£rv”
.
¡©_numcÚÃùiÚs
,

3171 
£rv”
.
¡©_numcommªds
,

3172 
	`g‘In¡ªÃousM‘ric
(
STATS_METRIC_COMMAND
),

3173 
£rv”
.
¡©_Ãt_šput_by‹s
,

3174 
£rv”
.
¡©_Ãt_ouut_by‹s
,

3175 ()
	`g‘In¡ªÃousM‘ric
(
STATS_METRIC_NET_INPUT
)/1024,

3176 ()
	`g‘In¡ªÃousM‘ric
(
STATS_METRIC_NET_OUTPUT
)/1024,

3177 
£rv”
.
¡©_»jeùed_cÚn
,

3178 
£rv”
.
¡©_sync_fuÎ
,

3179 
£rv”
.
¡©_sync_·¹Ÿl_ok
,

3180 
£rv”
.
¡©_sync_·¹Ÿl_”r
,

3181 
£rv”
.
¡©_expœedkeys
,

3182 
£rv”
.
¡©_eviùedkeys
,

3183 
£rv”
.
¡©_key¥aû_h™s
,

3184 
£rv”
.
¡©_key¥aû_mis£s
,

3185 
	`diùSize
(
£rv”
.
pubsub_chªÃls
),

3186 
	`li¡L’gth
(
£rv”
.
pubsub_·‰”ns
),

3187 
£rv”
.
¡©_fÜk_time
,

3188 
	`diùSize
(
£rv”
.
mig¿‹_ÿched_sock‘s
));

3192 ià(
®l£ùiÚs
 || 
def£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"replication")) {

3193 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

3194 
šfo
 = 
	`sdsÿrštf
(info,

3197 
£rv”
.
ma¡”ho¡
 =ğ
NULL
 ? "master" : "slave");

3198 ià(
£rv”
.
ma¡”ho¡
) {

3199 
¦ave_»¶_off£t
 = 1;

3201 ià(
£rv”
.
ma¡”
)

3202 
¦ave_»¶_off£t
 = 
£rv”
.
ma¡”
->
»¶off
;

3203 ià(
£rv”
.
ÿched_ma¡”
)

3204 
¦ave_»¶_off£t
 = 
£rv”
.
ÿched_ma¡”
->
»¶off
;

3206 
šfo
 = 
	`sdsÿrštf
(info,

3213 ,
£rv”
.
ma¡”ho¡
,

3214 
£rv”
.
ma¡”pÜt
,

3215 (
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_CONNECTED
) ?

3217 
£rv”
.
ma¡”
 ?

3218 (()(
£rv”
.
unixtime
-£rv”.
ma¡”
->
Ï¡š‹¿ùiÚ
)) : -1,

3219 
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_TRANSFER
,

3220 
¦ave_»¶_off£t


3223 ià(
£rv”
.
»¶_¡©e
 =ğ
REPL_STATE_TRANSFER
) {

3224 
šfo
 = 
	`sdsÿrštf
(info,

3228 (
£rv”
.
»¶_Œªsãr_size
 - s”v”.
»¶_Œªsãr_»ad
),

3229 ()(
£rv”
.
unixtime
-£rv”.
»¶_Œªsãr_Ï¡io
)

3233 ià(
£rv”
.
»¶_¡©e
 !ğ
REPL_STATE_CONNECTED
) {

3234 
šfo
 = 
	`sdsÿrštf
(info,

3236 (
štmax_t
)
£rv”
.
unixtime
-£rv”.
»¶_down_sšû
);

3238 
šfo
 = 
	`sdsÿrštf
(info,

3241 
£rv”
.
¦ave_´iÜ™y
,

3242 
£rv”
.
»¶_¦ave_ro
);

3245 
šfo
 = 
	`sdsÿrštf
(info,

3247 
	`li¡L’gth
(
£rv”
.
¦aves
));

3251 ià(
£rv”
.
»¶_mš_¦aves_to_wr™e
 &&

3252 
£rv”
.
»¶_mš_¦aves_max_Ïg
) {

3253 
šfo
 = 
	`sdsÿrštf
(info,

3255 
£rv”
.
»¶_good_¦aves_couÁ
);

3258 ià(
	`li¡L’gth
(
£rv”
.
¦aves
)) {

3259 
¦aveid
 = 0;

3260 
li¡Node
 *
Ê
;

3261 
li¡I‹r
 
li
;

3263 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

3264 (
Ê
 = 
	`li¡Next
(&
li
))) {

3265 
ş›Á
 *
¦ave
 = 
	`li¡NodeV®ue
(
Ê
);

3266 *
¡©e
 = 
NULL
;

3267 

[
NET_IP_STR_LEN
], *
¦ave
 = 
¦ave
->
¦ave_
;

3268 
pÜt
;

3269 
Ïg
 = 0;

3271 ià(
¦ave
[0] == '\0') {

3272 ià(
	`ª‘P“rToSŒšg
(
¦ave
->
fd
,

,(),&
pÜt
) == -1)

3274 
¦ave
 = 

;

3276 
¦ave
->
»¶¡©e
) {

3277 
SLAVE_STATE_WAIT_BGSAVE_START
:

3278 
SLAVE_STATE_WAIT_BGSAVE_END
:

3279 
¡©e
 = "wait_bgsave";

3281 
SLAVE_STATE_SEND_BULK
:

3282 
¡©e
 = "send_bulk";

3284 
SLAVE_STATE_ONLINE
:

3285 
¡©e
 = "online";

3288 ià(
¡©e
 =ğ
NULL
) ;

3289 ià(
¦ave
->
»¶¡©e
 =ğ
SLAVE_STATE_ONLINE
)

3290 
Ïg
 = 
	`time
(
NULL
è- 
¦ave
->
»¶_ack_time
;

3292 
šfo
 = 
	`sdsÿrštf
(info,

3295 
¦aveid
,
¦ave
,
¦ave
->
¦ave_li¡’šg_pÜt
,
¡©e
,

3296 
¦ave
->
»¶_ack_off
, 
Ïg
);

3297 
¦aveid
++;

3300 
šfo
 = 
	`sdsÿrštf
(info,

3306 
£rv”
.
ma¡”_»¶_off£t
,

3307 
£rv”
.
»¶_backlog
 !ğ
NULL
,

3308 
£rv”
.
»¶_backlog_size
,

3309 
£rv”
.
»¶_backlog_off
,

3310 
£rv”
.
»¶_backlog_hi¡Ën
);

3314 ià(
®l£ùiÚs
 || 
def£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"cpu")) {

3315 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

3316 
šfo
 = 
	`sdsÿrštf
(info,

3322 ()
£lf_ru
.
ru_¡ime
.
tv_£c
+()£lf_ru.ru_¡ime.
tv_u£c
/1000000,

3323 ()
£lf_ru
.
ru_utime
.
tv_£c
+()£lf_ru.ru_utime.
tv_u£c
/1000000,

3324 ()
c_ru
.
ru_¡ime
.
tv_£c
+()c_ru.ru_¡ime.
tv_u£c
/1000000,

3325 ()
c_ru
.
ru_utime
.
tv_£c
+()c_ru.ru_utime.
tv_u£c
/1000000);

3329 ià(
®l£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"commandstats")) {

3330 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

3331 
šfo
 = 
	`sdsÿrštf
(info, "# Commandstats\r\n");

3332 
numcommªds
 = (
»disCommªdTabË
)/(
»disCommªd
);

3333 
j
 = 0; j < 
numcommªds
; j++) {

3334 
»disCommªd
 *
c
 = 
»disCommªdTabË
+
j
;

3336 ià(!
c
->
ÿÎs
) ;

3337 
šfo
 = 
	`sdsÿrštf
(info,

3339 
c
->
Çme
, c->
ÿÎs
, c->
miüo£cÚds
,

3340 (
c
->
ÿÎs
 =ğ0è? 0 : (()c->
miüo£cÚds
/c->calls));

3345 ià(
®l£ùiÚs
 || 
def£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"cluster")) {

3346 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

3347 
šfo
 = 
	`sdsÿrštf
(info,

3350 
£rv”
.
şu¡”_’abËd
);

3354 ià(
®l£ùiÚs
 || 
def£ùiÚs
 || !
	`¡rÿ£cmp
(
£ùiÚ
,"keyspace")) {

3355 ià(
£ùiÚs
++è
šfo
 = 
	`sdsÿt
(info,"\r\n");

3356 
šfo
 = 
	`sdsÿrštf
(info, "# Keyspace\r\n");

3357 
j
 = 0; j < 
£rv”
.
dbnum
; j++) {

3358 
keys
, 
vkeys
;

3360 
keys
 = 
	`diùSize
(
£rv”
.
db
[
j
].
diù
);

3361 
vkeys
 = 
	`diùSize
(
£rv”
.
db
[
j
].
expœes
);

3362 ià(
keys
 || 
vkeys
) {

3363 
šfo
 = 
	`sdsÿrštf
(info,

3365 
j
, 
keys
, 
vkeys
, 
£rv”
.
db
[j].
avg_‰l
);

3369  
šfo
;

3370 
	}
}

3372 
	$šfoCommªd
(
ş›Á
 *
c
) {

3373 *
£ùiÚ
 = 
c
->
¬gc
 =ğ2 ? c->
¬gv
[1]->
±r
 : "default";

3375 ià(
c
->
¬gc
 > 2) {

3376 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

3379 
	`addR•lyBulkSds
(
c
, 
	`g’RedisInfoSŒšg
(
£ùiÚ
));

3380 
	}
}

3382 
	$mÚ™ÜCommªd
(
ş›Á
 *
c
) {

3384 ià(
c
->
æags
 & 
CLIENT_SLAVE
) ;

3386 
c
->
æags
 |ğ(
CLIENT_SLAVE
|
CLIENT_MONITOR
);

3387 
	`li¡AddNodeTa
(
£rv”
.
mÚ™Üs
,
c
);

3388 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

3389 
	}
}

3432 
eviùiÚPoŞEÁry
 *
	$eviùiÚPoŞAÎoc
() {

3433 
eviùiÚPoŞEÁry
 *
•
;

3434 
j
;

3436 
•
 = 
	`zm®loc
((*•)*
MAXMEMORY_EVICTION_POOL_SIZE
);

3437 
j
 = 0; j < 
MAXMEMORY_EVICTION_POOL_SIZE
; j++) {

3438 
•
[
j
].
idË
 = 0;

3439 
•
[
j
].
key
 = 
NULL
;

3441  
•
;

3442 
	}
}

3453 
	#EVICTION_SAMPLES_ARRAY_SIZE
 16

	)

3454 
	$eviùiÚPoŞPİuÏ‹
(
diù
 *
§m¶ediù
, diù *
keydiù
, 
eviùiÚPoŞEÁry
 *
poŞ
) {

3455 
j
, 
k
, 
couÁ
;

3456 
diùEÁry
 *
_§m¶es
[
EVICTION_SAMPLES_ARRAY_SIZE
];

3457 
diùEÁry
 **
§m¶es
;

3461 ià(
£rv”
.
maxmemÜy_§m¶es
 <ğ
EVICTION_SAMPLES_ARRAY_SIZE
) {

3462 
§m¶es
 = 
_§m¶es
;

3464 
§m¶es
 = 
	`zm®loc
((§m¶es[0])*
£rv”
.
maxmemÜy_§m¶es
);

3467 
couÁ
 = 
	`diùG‘SomeKeys
(
§m¶ediù
,
§m¶es
,
£rv”
.
maxmemÜy_§m¶es
);

3468 
j
 = 0; j < 
couÁ
; j++) {

3469 
idË
;

3470 
sds
 
key
;

3471 
robj
 *
o
;

3472 
diùEÁry
 *
de
;

3474 
de
 = 
§m¶es
[
j
];

3475 
key
 = 
	`diùG‘Key
(
de
);

3479 ià(
§m¶ediù
 !ğ
keydiù
è
de
 = 
	`diùFšd
(keydiù, 
key
);

3480 
o
 = 
	`diùG‘V®
(
de
);

3481 
idË
 = 
	`e¡im©eObjeùIdËTime
(
o
);

3486 
k
 = 0;

3487 
k
 < 
MAXMEMORY_EVICTION_POOL_SIZE
 &&

3488 
poŞ
[
k
].
key
 &&

3489 
poŞ
[
k
].
idË
 < idle) k++;

3490 ià(
k
 =ğ0 && 
poŞ
[
MAXMEMORY_EVICTION_POOL_SIZE
-1].
key
 !ğ
NULL
) {

3494 } ià(
k
 < 
MAXMEMORY_EVICTION_POOL_SIZE
 && 
poŞ
[k].
key
 =ğ
NULL
) {

3499 ià(
poŞ
[
MAXMEMORY_EVICTION_POOL_SIZE
-1].
key
 =ğ
NULL
) {

3502 
	`memmove
(
poŞ
+
k
+1,pool+k,

3503 (
poŞ
[0])*(
MAXMEMORY_EVICTION_POOL_SIZE
-
k
-1));

3506 
k
--;

3509 
	`sdsä“
(
poŞ
[0].
key
);

3510 
	`memmove
(
poŞ
,poŞ+1,ÕoŞ[0])*
k
);

3513 
poŞ
[
k
].
key
 = 
	`sdsdup
(key);

3514 
poŞ
[
k
].
idË
 = idle;

3516 ià(
§m¶es
 !ğ
_§m¶es
è
	`zä“
(samples);

3517 
	}
}

3519 
	$ä“MemÜyIfN“ded
() {

3520 
size_t
 
mem_u£d
, 
mem_toä“
, 
mem_ä“d
;

3521 
¦aves
 = 
	`li¡L’gth
(
£rv”
.slaves);

3522 
m¡ime_t
 
Ï‹ncy
, 
eviùiÚ_Ï‹ncy
;

3526 
mem_u£d
 = 
	`zm®loc_u£d_memÜy
();

3527 ià(
¦aves
) {

3528 
li¡I‹r
 
li
;

3529 
li¡Node
 *
Ê
;

3531 
	`li¡Rewšd
(
£rv”
.
¦aves
,&
li
);

3532 (
Ê
 = 
	`li¡Next
(&
li
))) {

3533 
ş›Á
 *
¦ave
 = 
	`li¡NodeV®ue
(
Ê
);

3534 
obuf_by‹s
 = 
	`g‘Cl›ÁOuutBufãrMemÜyU§ge
(
¦ave
);

3535 ià(
obuf_by‹s
 > 
mem_u£d
)

3536 
mem_u£d
 = 0;

3538 
mem_u£d
 -ğ
obuf_by‹s
;

3541 ià(
£rv”
.
aof_¡©e
 !ğ
AOF_OFF
) {

3542 
mem_u£d
 -ğ
	`sd¦’
(
£rv”
.
aof_buf
);

3543 
mem_u£d
 -ğ
	`aofRewr™eBufãrSize
();

3547 ià(
mem_u£d
 <ğ
£rv”
.
maxmemÜy
è 
C_OK
;

3549 ià(
£rv”
.
maxmemÜy_pŞicy
 =ğ
MAXMEMORY_NO_EVICTION
)

3550  
C_ERR
;

3553 
mem_toä“
 = 
mem_u£d
 - 
£rv”
.
maxmemÜy
;

3554 
mem_ä“d
 = 0;

3555 
	`Ï‹ncyS¹MÚ™Ü
(
Ï‹ncy
);

3556 
mem_ä“d
 < 
mem_toä“
) {

3557 
j
, 
k
, 
keys_ä“d
 = 0;

3559 
j
 = 0; j < 
£rv”
.
dbnum
; j++) {

3560 
be¡v®
 = 0;

3561 
sds
 
be¡key
 = 
NULL
;

3562 
diùEÁry
 *
de
;

3563 
»disDb
 *
db
 = 
£rv”
.db+
j
;

3564 
diù
 *dict;

3566 ià(
£rv”
.
maxmemÜy_pŞicy
 =ğ
MAXMEMORY_ALLKEYS_LRU
 ||

3567 
£rv”
.
maxmemÜy_pŞicy
 =ğ
MAXMEMORY_ALLKEYS_RANDOM
)

3569 
diù
 = 
£rv”
.
db
[
j
].dict;

3571 
diù
 = 
£rv”
.
db
[
j
].
expœes
;

3573 ià(
	`diùSize
(
diù
) == 0) ;

3576 ià(
£rv”
.
maxmemÜy_pŞicy
 =ğ
MAXMEMORY_ALLKEYS_RANDOM
 ||

3577 
£rv”
.
maxmemÜy_pŞicy
 =ğ
MAXMEMORY_VOLATILE_RANDOM
)

3579 
de
 = 
	`diùG‘RªdomKey
(
diù
);

3580 
be¡key
 = 
	`diùG‘Key
(
de
);

3584 ià(
£rv”
.
maxmemÜy_pŞicy
 =ğ
MAXMEMORY_ALLKEYS_LRU
 ||

3585 
£rv”
.
maxmemÜy_pŞicy
 =ğ
MAXMEMORY_VOLATILE_LRU
)

3587 
eviùiÚPoŞEÁry
 *
poŞ
 = 
db
->
eviùiÚ_poŞ
;

3589 
be¡key
 =ğ
NULL
) {

3590 
	`eviùiÚPoŞPİuÏ‹
(
diù
, 
db
->diù, db->
eviùiÚ_poŞ
);

3592 
k
 = 
MAXMEMORY_EVICTION_POOL_SIZE
-1; k >= 0; k--) {

3593 ià(
poŞ
[
k
].
key
 =ğ
NULL
) ;

3594 
de
 = 
	`diùFšd
(
diù
,
poŞ
[
k
].
key
);

3597 
	`sdsä“
(
poŞ
[
k
].
key
);

3599 
	`memmove
(
poŞ
+
k
,pool+k+1,

3600 (
poŞ
[0])*(
MAXMEMORY_EVICTION_POOL_SIZE
-
k
-1));

3603 
poŞ
[
MAXMEMORY_EVICTION_POOL_SIZE
-1].
key
 = 
NULL
;

3604 
poŞ
[
MAXMEMORY_EVICTION_POOL_SIZE
-1].
idË
 = 0;

3608 ià(
de
) {

3609 
be¡key
 = 
	`diùG‘Key
(
de
);

3620 ià(
£rv”
.
maxmemÜy_pŞicy
 =ğ
MAXMEMORY_VOLATILE_TTL
) {

3621 
k
 = 0; k < 
£rv”
.
maxmemÜy_§m¶es
; k++) {

3622 
sds
 
thiskey
;

3623 
thisv®
;

3625 
de
 = 
	`diùG‘RªdomKey
(
diù
);

3626 
thiskey
 = 
	`diùG‘Key
(
de
);

3627 
thisv®
 = (è
	`diùG‘V®
(
de
);

3631 ià(
be¡key
 =ğ
NULL
 || 
thisv®
 < 
be¡v®
) {

3632 
be¡key
 = 
thiskey
;

3633 
be¡v®
 = 
thisv®
;

3639 ià(
be¡key
) {

3640 
d–
;

3642 
robj
 *
keyobj
 = 
	`ü—‹SŒšgObjeù
(
be¡key
,
	`sd¦’
(bestkey));

3643 
	`´İag©eExpœe
(
db
,
keyobj
);

3652 
d–
 = (è
	`zm®loc_u£d_memÜy
();

3653 
	`Ï‹ncyS¹MÚ™Ü
(
eviùiÚ_Ï‹ncy
);

3654 
	`dbD–‘e
(
db
,
keyobj
);

3655 
	`Ï‹ncyEndMÚ™Ü
(
eviùiÚ_Ï‹ncy
);

3656 
	`Ï‹ncyAddSam¶eIfN“ded
("eviùiÚ-d–",
eviùiÚ_Ï‹ncy
);

3657 
	`Ï‹ncyRemoveNe¡edEv’t
(
Ï‹ncy
,
eviùiÚ_Ï‹ncy
);

3658 
d–
 -ğ(è
	`zm®loc_u£d_memÜy
();

3659 
mem_ä“d
 +ğ
d–
;

3660 
£rv”
.
¡©_eviùedkeys
++;

3661 
	`nÙifyKey¥aûEv’t
(
NOTIFY_EVICTED
, "evicted",

3662 
keyobj
, 
db
->
id
);

3663 
	`deüRefCouÁ
(
keyobj
);

3664 
keys_ä“d
++;

3670 ià(
¦aves
è
	`æushSÏvesOuutBufãrs
();

3673 ià(!
keys_ä“d
) {

3674 
	`Ï‹ncyEndMÚ™Ü
(
Ï‹ncy
);

3675 
	`Ï‹ncyAddSam¶eIfN“ded
("eviùiÚ-cyşe",
Ï‹ncy
);

3676  
C_ERR
;

3679 
	`Ï‹ncyEndMÚ™Ü
(
Ï‹ncy
);

3680 
	`Ï‹ncyAddSam¶eIfN“ded
("eviùiÚ-cyşe",
Ï‹ncy
);

3681  
C_OK
;

3682 
	}
}

3686 #ifdeà
__lšux__


3687 
	$lšuxOv”comm™MemÜyV®ue
() {

3688 
FILE
 *
å
 = 
	`fİ’
("/proc/sys/vm/overcommit_memory","r");

3689 
buf
[64];

3691 ià(!
å
)  -1;

3692 ià(
	`fg‘s
(
buf
,64,
å
è=ğ
NULL
) {

3693 
	`fşo£
(
å
);

3696 
	`fşo£
(
å
);

3698  
	`©oi
(
buf
);

3699 
	}
}

3701 
	$lšuxMemÜyW¬nšgs
() {

3702 ià(
	`lšuxOv”comm™MemÜyV®ue
() == 0) {

3703 
	`£rv”Log
(
LL_WARNING
,"WARNING overcommit_memory is seto 0! Background save may fail under†ow memory condition. To fixhis issue‡dd 'vm.overcommit_memory = 1'o /etc/sysctl.conf‡ndhen„eboot or„unhe command 'sysctl vm.overcommit_memory=1' forhisoakeƒffect.");

3705 ià(
	`THPIsEÇbËd
()) {

3706 
	`£rv”Log
(
LL_WARNING
,"WARNING you have Transparent Huge Pages (THP) supportƒnabled in your kernel. This will create†atency‡nd memory usage issues with Redis. To fixhis issue„unhe command 'echo‚ever > /sys/kernel/mm/transparent_hugepage/enabled'‡s„oot,‡nd‡dd ito your /etc/rc.local in ordero„etainhe setting‡fter‡„eboot. Redis must be„estarted‡fter THP is disabled.");

3708 
	}
}

3711 
	$ü—‹PidFe
() {

3714 ià(!
£rv”
.
pidfe
è£rv”.pidfğ
	`z¡rdup
(
CONFIG_DEFAULT_PID_FILE
);

3717 
FILE
 *
å
 = 
	`fİ’
(
£rv”
.
pidfe
,"w");

3718 ià(
å
) {

3719 
	`årštf
(
å
,"%d\n",()
	`g‘pid
());

3720 
	`fşo£
(
å
);

3722 
	}
}

3724 
	$d«mÚize
() {

3725 
fd
;

3727 ià(
	`fÜk
(è!ğ0è
	`ex™
(0);

3728 
	`£tsid
();

3733 ià((
fd
 = 
	`İ’
("/dev/nuÎ", 
O_RDWR
, 0)) != -1) {

3734 
	`dup2
(
fd
, 
STDIN_FILENO
);

3735 
	`dup2
(
fd
, 
STDOUT_FILENO
);

3736 
	`dup2
(
fd
, 
STDERR_FILENO
);

3737 ià(
fd
 > 
STDERR_FILENO
è
	`şo£
(fd);

3739 
	}
}

3741 
	$v”siÚ
() {

3742 
	`´štf
("Redis server v=%s sha=%s:%d malloc=%s bits=%d build=%llx\n",

3743 
REDIS_VERSION
,

3744 
	`»disG™SHA1
(),

3745 
	`©oi
(
	`»disG™Dœty
()) > 0,

3746 
ZMALLOC_LIB
,

3748 (è
	`»disBudId
());

3749 
	`ex™
(0);

3750 
	}
}

3752 
	$u§ge
() {

3753 
	`årštf
(
¡d”r
,"Usage: ./redis-server [/path/to/redis.conf] [options]\n");

3754 
	`årštf
(
¡d”r
," ./redis-server - (read config from stdin)\n");

3755 
	`årštf
(
¡d”r
," ./redis-server -v or --version\n");

3756 
	`årštf
(
¡d”r
," ./redis-server -h or --help\n");

3757 
	`årštf
(
¡d”r
," ./redis-server --test-memory <megabytes>\n\n");

3758 
	`årštf
(
¡d”r
,"Examples:\n");

3759 
	`årštf
(
¡d”r
," ./redis-server (runhe server with default conf)\n");

3760 
	`årštf
(
¡d”r
," ./redis-server /etc/redis/6379.conf\n");

3761 
	`årštf
(
¡d”r
," ./redis-server --port 7777\n");

3762 
	`årštf
(
¡d”r
," ./redis-server --port 7777 --slaveof 127.0.0.1 8888\n");

3763 
	`årštf
(
¡d”r
," ./redis-server /etc/myredis.conf --loglevel verbose\n\n");

3764 
	`årštf
(
¡d”r
,"Sentinel mode:\n");

3765 
	`årštf
(
¡d”r
," ./redis-server /etc/sentinel.conf --sentinel\n");

3766 
	`ex™
(1);

3767 
	}
}

3769 
	$»disAsciiA¹
() {

3770 
	~"asciogo.h
"

3771 *
buf
 = 
	`zm®loc
(1024*16);

3772 *
mode
;

3774 ià(
£rv”
.
şu¡”_’abËd
è
mode
 = "cluster";

3775 ià(
£rv”
.
£Áš–_mode
è
mode
 = "sentinel";

3776 
mode
 = "standalone";

3778 ià(
£rv”
.
sy¦og_’abËd
) {

3779 
	`£rv”Log
(
LL_NOTICE
,

3781 
REDIS_VERSION
,

3782 
	`»disG™SHA1
(),

3783 
	`¡¹Ş
(
	`»disG™Dœty
(),
NULL
,10) > 0,

3785 
mode
, 
£rv”
.
pÜt
,

3786 (è
	`g‘pid
()

3789 
	`¢´štf
(
buf
,1024*16,
ascii_logo
,

3790 
REDIS_VERSION
,

3791 
	`»disG™SHA1
(),

3792 
	`¡¹Ş
(
	`»disG™Dœty
(),
NULL
,10) > 0,

3794 
mode
, 
£rv”
.
pÜt
,

3795 (è
	`g‘pid
()

3797 
	`£rv”LogRaw
(
LL_NOTICE
|
LL_RAW
,
buf
);

3799 
	`zä“
(
buf
);

3800 
	}
}

3802 
	$sigShutdownHªdËr
(
sig
) {

3803 *
msg
;

3805 
sig
) {

3806 
SIGINT
:

3807 
msg
 = "Received SIGINT scheduling shutdown...";

3809 
SIGTERM
:

3810 
msg
 = "Received SIGTERM scheduling shutdown...";

3813 
msg
 = "Received shutdown signal, scheduling shutdown...";

3820 ià(
£rv”
.
shutdown_a§p
 && 
sig
 =ğ
SIGINT
) {

3821 
	`£rv”LogFromHªdËr
(
LL_WARNING
, "You insist...ƒxiting‚ow.");

3822 
	`rdbRemoveTempFe
(
	`g‘pid
());

3823 
	`ex™
(1);

3824 } ià(
£rv”
.
lßdšg
) {

3825 
	`ex™
(0);

3828 
	`£rv”LogFromHªdËr
(
LL_WARNING
, 
msg
);

3829 
£rv”
.
shutdown_a§p
 = 1;

3830 
	}
}

3832 
	$£tupSigÇlHªdËrs
() {

3833 
sigaùiÚ
 
aù
;

3837 
	`sigem±y£t
(&
aù
.
§_mask
);

3838 
aù
.
§_æags
 = 0;

3839 
aù
.
§_hªdËr
 = 
sigShutdownHªdËr
;

3840 
	`sigaùiÚ
(
SIGTERM
, &
aù
, 
NULL
);

3841 
	`sigaùiÚ
(
SIGINT
, &
aù
, 
NULL
);

3843 #ifdeà
HAVE_BACKTRACE


3844 
	`sigem±y£t
(&
aù
.
§_mask
);

3845 
aù
.
§_æags
 = 
SA_NODEFER
 | 
SA_RESETHAND
 | 
SA_SIGINFO
;

3846 
aù
.
§_sigaùiÚ
 = 
sig£gvHªdËr
;

3848 
	`sigaùiÚ
(
SIGBUS
, &
aù
, 
NULL
);

3849 
	`sigaùiÚ
(
SIGFPE
, &
aù
, 
NULL
);

3850 
	`sigaùiÚ
(
SIGILL
, &
aù
, 
NULL
);

3853 
	}
}

3855 
mem‹¡
(
size_t
 
megaby‹s
, 
·s£s
);

3859 
	$checkFÜS’tš–Mode
(
¬gc
, **
¬gv
) {

3860 
j
;

3862 ià(
	`¡r¡r
(
¬gv
[0],"»dis-£Áš–"è!ğ
NULL
)  1;

3863 
j
 = 1; j < 
¬gc
; j++)

3864 ià(!
	`¡rcmp
(
¬gv
[
j
],"--sentinel"))  1;

3866 
	}
}

3869 
	$lßdD©aFromDisk
() {

3870 
¡¬t
 = 
	`u¡ime
();

3871 ià(
£rv”
.
aof_¡©e
 =ğ
AOF_ON
) {

3872 ià(
	`lßdAµ’dOÆyFe
(
£rv”
.
aof_f’ame
è=ğ
C_OK
)

3873 
	`£rv”Log
(
LL_NOTICE
,"DB†ßded from‡µ’d oÆy fe: %.3à£cÚds",()(
	`u¡ime
()-
¡¬t
)/1000000);

3875 ià(
	`rdbLßd
(
£rv”
.
rdb_f’ame
è=ğ
C_OK
) {

3876 
	`£rv”Log
(
LL_NOTICE
,"DB†oaded from disk: %.3f seconds",

3877 ()(
	`u¡ime
()-
¡¬t
)/1000000);

3878 } ià(
”ºo
 !ğ
ENOENT
) {

3879 
	`£rv”Log
(
LL_WARNING
,"F©®ƒ¼Ü†ßdšghDB: %s. Ex™šg.",
	`¡»¼Ü
(
”ºo
));

3880 
	`ex™
(1);

3883 
	}
}

3885 
	$»disOutOfMemÜyHªdËr
(
size_t
 
®loÿtiÚ_size
) {

3886 
	`£rv”Log
(
LL_WARNING
,"Out Of Memory‡llocating %zu bytes!",

3887 
®loÿtiÚ_size
);

3888 
	`£rv”Pªic
("Redis‡borting for OUT OF MEMORY");

3889 
	}
}

3891 
	$»disS‘ProcT™Ë
(*
t™Ë
) {

3892 #ifdeà
USE_SETPROCTITLE


3893 *
£rv”_mode
 = "";

3894 ià(
£rv”
.
şu¡”_’abËd
è
£rv”_mode
 = " [cluster]";

3895 ià(
£rv”
.
£Áš–_mode
è
£rv”_mode
 = " [sentinel]";

3897 
	`£roù™Ë
("%s %s:%d%s",

3898 
t™Ë
,

3899 
£rv”
.
bšdaddr_couÁ
 ? s”v”.
bšdaddr
[0] : "*",

3900 
£rv”
.
pÜt
,

3901 
£rv”_mode
);

3903 
	`UNUSED
(
t™Ë
);

3905 
	}
}

3911 
	$»disSu³rvi£dUp¡¬t
() {

3912 cÚ¡ *
up¡¬t_job
 = 
	`g‘’v
("UPSTART_JOB");

3914 ià(!
up¡¬t_job
) {

3915 
	`£rv”Log
(
LL_WARNING
,

3920 
	`£rv”Log
(
LL_NOTICE
, "supervised by upstart, will stopo signal„eadiness");

3921 
	`¿i£
(
SIGSTOP
);

3922 
	`un£‹nv
("UPSTART_JOB");

3924 
	}
}

3926 
	$»disSu³rvi£dSy¡emd
() {

3927 cÚ¡ *
nÙify_sock‘
 = 
	`g‘’v
("NOTIFY_SOCKET");

3928 
fd
 = 1;

3929 
sockaddr_un
 
su
;

3930 
iovec
 
iov
;

3931 
msghdr
 
hdr
;

3932 
£ndto_æags
 = 0;

3934 ià(!
nÙify_sock‘
) {

3935 
	`£rv”Log
(
LL_WARNING
,

3940 ià((
	`¡rchr
("@/", 
nÙify_sock‘
[0])è=ğ
NULL
 || 
	`¡¾’
(notify_socket) < 2) {

3944 
	`£rv”Log
(
LL_NOTICE
, "supervised by systemd, will signal„eadiness");

3945 ià((
fd
 = 
	`sock‘
(
AF_UNIX
, 
SOCK_DGRAM
, 0)) == -1) {

3946 
	`£rv”Log
(
LL_WARNING
,

3947 "Cª'ˆcÚÃùØsy¡emd sock‘ %s", 
nÙify_sock‘
);

3951 
	`mem£t
(&
su
, 0, (su));

3952 
su
.
sun_çmy
 = 
AF_UNIX
;

3953 
	`¡ºıy
 (
su
.
sun_·th
, 
nÙify_sock‘
, (su.sun_path) -1);

3954 
su
.
sun_·th
[(su.sun_path) - 1] = '\0';

3956 ià(
nÙify_sock‘
[0] == '@')

3957 
su
.
sun_·th
[0] = '\0';

3959 
	`mem£t
(&
iov
, 0, (iov));

3960 
iov
.
iov_ba£
 = "READY=1";

3961 
iov
.
iov_Ën
 = 
	`¡¾’
("READY=1");

3963 
	`mem£t
(&
hdr
, 0, (hdr));

3964 
hdr
.
msg_Çme
 = &
su
;

3965 
hdr
.
msg_Çm–’
 = 
	`off£tof
(
sockaddr_un
, 
sun_·th
) +

3966 
	`¡¾’
(
nÙify_sock‘
);

3967 
hdr
.
msg_iov
 = &
iov
;

3968 
hdr
.
msg_iovËn
 = 1;

3970 
	`un£‹nv
("NOTIFY_SOCKET");

3971 #ifdeà
HAVE_MSG_NOSIGNAL


3972 
£ndto_æags
 |ğ
MSG_NOSIGNAL
;

3974 ià(
	`£ndmsg
(
fd
, &
hdr
, 
£ndto_æags
) < 0) {

3975 
	`£rv”Log
(
LL_WARNING
, "Can't send‚otificationo systemd");

3976 
	`şo£
(
fd
);

3979 
	`şo£
(
fd
);

3981 
	}
}

3983 
	$»disIsSu³rvi£d
(
mode
) {

3984 ià(
mode
 =ğ
SUPERVISED_AUTODETECT
) {

3985 cÚ¡ *
up¡¬t_job
 = 
	`g‘’v
("UPSTART_JOB");

3986 cÚ¡ *
nÙify_sock‘
 = 
	`g‘’v
("NOTIFY_SOCKET");

3988 ià(
up¡¬t_job
) {

3989 
	`»disSu³rvi£dUp¡¬t
();

3990 } ià(
nÙify_sock‘
) {

3991 
	`»disSu³rvi£dSy¡emd
();

3993 } ià(
mode
 =ğ
SUPERVISED_UPSTART
) {

3994  
	`»disSu³rvi£dUp¡¬t
();

3995 } ià(
mode
 =ğ
SUPERVISED_SYSTEMD
) {

3996  
	`»disSu³rvi£dSy¡emd
();

4000 
	}
}

4002 #ifdeà
USE_PMDK


4003 
	$š™P”si¡’tMemÜy
() {

4004 
PMEMoid
 
oid
;

4005 
»dis_pmem_roÙ
 *
roÙ
;

4008 
¡¬t
 = 
	`u¡ime
();

4009 
pmfe_hmem
[64];

4010 
	`by‹sToHumª
(
pmfe_hmem
, 
£rv”
.
pm_fe_size
);

4011 
	`£rv”Log
(
LL_NOTICE
,"Start init Persistent memory file %s size %s",

4012 
£rv”
.
pm_fe_·th
, 
pmfe_hmem
);

4015 
£rv”
.
pm_poŞ
 = 
	`pmemobj_ü—‹
(£rv”.
pm_fe_·th
, 
PM_LAYOUT_NAME
, s”v”.
pm_fe_size
, 0666);

4017 ià(
£rv”
.
pm_poŞ
 =ğ
NULL
) {

4019 
£rv”
.
pm_poŞ
 = 
	`pmemobj_İ’
(£rv”.
pm_fe_·th
, 
PM_LAYOUT_NAME
);

4020 
£rv”
.
pm_roÙoid
 = 
	`POBJ_ROOT
(£rv”.
pm_poŞ
, 
»dis_pmem_roÙ
);

4021 
£rv”
.
pm_»cÚ¡ruù_»quœed
 = 
Œue
;

4023 ià(
£rv”
.
pm_poŞ
 =ğ
NULL
) {

4024 
	`£rv”Log
(
LL_WARNING
,"Cannot init…ersistent memory…oolset file "

4025 "% siz%s", 
£rv”
.
pm_fe_·th
, 
pmfe_hmem
);

4026 
	`ex™
(1);

4029 
£rv”
.
pm_roÙoid
 = 
	`POBJ_ROOT
(£rv”.
pm_poŞ
, 
»dis_pmem_roÙ
);

4030 
roÙ
 = 
	`pmemobj_dœeù
(
£rv”
.
pm_roÙoid
.
oid
);

4031 
roÙ
->
num_diù_’Œ›s
 = 0;

4035 
oid
 = 
	`pmemobj_roÙ
(
£rv”
.
pm_poŞ
, 1);

4036 
£rv”
.
poŞ_uuid_lo
 = 
oid
.pool_uuid_lo;

4038 
	`£rv”Log
(
LL_NOTICE
,"Init Persistent memory file %sime %.3f "

4040 
£rv”
.
pm_fe_·th
,

4041 ()(
	`u¡ime
()-
¡¬t
)/1000000);

4042 
£rv”
.
³rsi¡’t
 = 
Œue
;

4044 
	`»£tS”v”SaveP¬ams
();

4045 
	}
}

4048 
	$maš
(
¬gc
, **
¬gv
) {

4049 
timev®
 
tv
;

4050 
j
;

4051 
	`·vi£_š¡rum’t_begš
();

4052 
	`·vi£_»cov”y_begš
();

4054 #ifdeà
REDIS_TEST


4055 ià(
¬gc
 =ğ3 && !
	`¡rÿ£cmp
(
¬gv
[1], "test")) {

4056 ià(!
	`¡rÿ£cmp
(
¬gv
[2], "ziplist")) {

4057  
	`zli¡Te¡
(
¬gc
, 
¬gv
);

4058 } ià(!
	`¡rÿ£cmp
(
¬gv
[2], "quicklist")) {

4059 
	`quickli¡Te¡
(
¬gc
, 
¬gv
);

4060 } ià(!
	`¡rÿ£cmp
(
¬gv
[2], "intset")) {

4061  
	`št£tTe¡
(
¬gc
, 
¬gv
);

4062 } ià(!
	`¡rÿ£cmp
(
¬gv
[2], "zipmap")) {

4063  
	`zm­Te¡
(
¬gc
, 
¬gv
);

4064 } ià(!
	`¡rÿ£cmp
(
¬gv
[2], "sha1test")) {

4065  
	`sha1Te¡
(
¬gc
, 
¬gv
);

4066 } ià(!
	`¡rÿ£cmp
(
¬gv
[2], "util")) {

4067  
	`utTe¡
(
¬gc
, 
¬gv
);

4068 } ià(!
	`¡rÿ£cmp
(
¬gv
[2], "sds")) {

4069  
	`sdsTe¡
(
¬gc
, 
¬gv
);

4070 } ià(!
	`¡rÿ£cmp
(
¬gv
[2], "endianconv")) {

4071  
	`’dŸncÚvTe¡
(
¬gc
, 
¬gv
);

4072 } ià(!
	`¡rÿ£cmp
(
¬gv
[2], "crc64")) {

4073  
	`üc64Te¡
(
¬gc
, 
¬gv
);

4081 #ifdeà
INIT_SETPROCTITLE_REPLACEMENT


4082 
	`¥t_š™
(
¬gc
, 
¬gv
);

4084 
	`£oÿË
(
LC_COLLATE
,"");

4085 
	`zm®loc_’abË_th»ad_§ãÃss
();

4086 
	`zm®loc_£t_oom_hªdËr
(
»disOutOfMemÜyHªdËr
);

4087 
	`¤ªd
(
	`time
(
NULL
)^
	`g‘pid
());

4088 
	`g‘timeofday
(&
tv
,
NULL
);

4089 
	`diùS‘HashFunùiÚS“d
(
tv
.
tv_£c
^tv.
tv_u£c
^
	`g‘pid
());

4090 
£rv”
.
£Áš–_mode
 = 
	`checkFÜS’tš–Mode
(
¬gc
,
¬gv
);

4091 
	`š™S”v”CÚfig
();

4095 
£rv”
.
execubË
 = 
	`g‘AbsŞu‹P©h
(
¬gv
[0]);

4096 
£rv”
.
exec_¬gv
 = 
	`zm®loc
((*)*(
¬gc
+1));

4097 
£rv”
.
exec_¬gv
[
¬gc
] = 
NULL
;

4098 
j
 = 0; j < 
¬gc
; j++è
£rv”
.
exec_¬gv
[j] = 
	`z¡rdup
(
¬gv
[j]);

4103 ià(
£rv”
.
£Áš–_mode
) {

4104 
	`š™S’tš–CÚfig
();

4105 
	`š™S’tš–
();

4111 ià(
	`¡r¡r
(
¬gv
[0],"»dis-check-rdb"è!ğ
NULL
)

4112 
	`»dis_check_rdb_maš
(
¬gc
,
¬gv
);

4114 ià(
¬gc
 >= 2) {

4115 
j
 = 1;

4116 
sds
 
İtiÚs
 = 
	`sd£m±y
();

4117 *
cÚfigfe
 = 
NULL
;

4120 ià(
	`¡rcmp
(
¬gv
[1], "-v") == 0 ||

4121 
	`¡rcmp
(
¬gv
[1], "--v”siÚ"è=ğ0è
	`v”siÚ
();

4122 ià(
	`¡rcmp
(
¬gv
[1], "--help") == 0 ||

4123 
	`¡rcmp
(
¬gv
[1], "-h"è=ğ0è
	`u§ge
();

4124 ià(
	`¡rcmp
(
¬gv
[1], "--test-memory") == 0) {

4125 ià(
¬gc
 == 3) {

4126 
	`mem‹¡
(
	`©oi
(
¬gv
[2]),50);

4127 
	`ex™
(0);

4129 
	`årštf
(
¡d”r
,"Please specifyhe‡mount of memoryoest in megabytes.\n");

4130 
	`årštf
(
¡d”r
,"Example: ./redis-server --test-memory 4096\n\n");

4131 
	`ex™
(1);

4136 ià(
¬gv
[
j
][0] != '-' ||‡rgv[j][1] != '-') {

4137 
cÚfigfe
 = 
¬gv
[
j
];

4138 
£rv”
.
cÚfigfe
 = 
	`g‘AbsŞu‹P©h
(configfile);

4141 
	`zä“
(
£rv”
.
exec_¬gv
[
j
]);

4142 
£rv”
.
exec_¬gv
[
j
] = 
	`z¡rdup
(£rv”.
cÚfigfe
);

4143 
j
++;

4150 
j
 !ğ
¬gc
) {

4151 ià(
¬gv
[
j
][0] == '-' &&‡rgv[j][1] == '-') {

4153 ià(!
	`¡rcmp
(
¬gv
[
j
], "--check-rdb")) {

4155 
j
++;

4158 ià(
	`sd¦’
(
İtiÚs
)èİtiÚ ğ
	`sdsÿt
(options,"\n");

4159 
İtiÚs
 = 
	`sdsÿt
(İtiÚs,
¬gv
[
j
]+2);

4160 
İtiÚs
 = 
	`sdsÿt
(options," ");

4163 
İtiÚs
 = 
	`sdsÿŒ•r
(İtiÚs,
¬gv
[
j
],
	`¡¾’
(argv[j]));

4164 
İtiÚs
 = 
	`sdsÿt
(options," ");

4166 
j
++;

4168 ià(
£rv”
.
£Áš–_mode
 && 
cÚfigfe
 && *configfile == '-') {

4169 
	`£rv”Log
(
LL_WARNING
,

4171 
	`£rv”Log
(
LL_WARNING
,

4173 
	`ex™
(1);

4175 
	`»£tS”v”SaveP¬ams
();

4176 
	`lßdS”v”CÚfig
(
cÚfigfe
,
İtiÚs
);

4177 
	`sdsä“
(
İtiÚs
);

4179 
	`£rv”Log
(
LL_WARNING
, "W¬nšg:‚ØcÚfig f¥ecif›d, usšghdeçuÉ cÚfig. IÀÜd”Ø¥ecify‡ cÚfig fu£ % /·th/to/%s.cÚf", 
¬gv
[0], 
£rv”
.
£Áš–_mode
 ? "sentinel" : "redis");

4182 
£rv”
.
su³rvi£d
 = 
	`»disIsSu³rvi£d
(£rv”.
su³rvi£d_mode
);

4183 
background
 = 
£rv”
.
d«mÚize
 && !£rv”.
su³rvi£d
;

4184 ià(
background
è
	`d«mÚize
();

4186 #ifdeà
USE_PMDK


4187 ià(
£rv”
.
pm_fe_·th
) {

4188 
	`š™P”si¡’tMemÜy
();

4192 
	`š™S”v”
();

4193 ià(
background
 || 
£rv”
.
pidfe
è
	`ü—‹PidFe
();

4194 
	`»disS‘ProcT™Ë
(
¬gv
[0]);

4195 
	`»disAsciiA¹
();

4196 
	`checkTıBacklogS‘tšgs
();

4198 ià(!
£rv”
.
£Áš–_mode
) {

4200 
	`£rv”Log
(
LL_WARNING
,"S”v” s¹ed, Redi v”siÚ " 
REDIS_VERSION
);

4201 #ifdeà
__lšux__


4202 
	`lšuxMemÜyW¬nšgs
();

4204 
	`lßdD©aFromDisk
();

4205 #ifdeà
USE_PMDK


4206 ià(
£rv”
.
pm_»cÚ¡ruù_»quœed
) {

4207 
¡¬t
 = 
	`u¡ime
();

4208 ià(
	`pmemRecÚ¡ruù
(è=ğ
C_OK
) {

4209 
	`£rv”Log
(
LL_NOTICE
,"DB†ßded from PMEM: %.3à£cÚds",()(
	`u¡ime
()-
¡¬t
)/1000000);

4210 } ià(
”ºo
 !ğ
ENOENT
) {

4211 
	`£rv”Log
(
LL_WARNING
,"F©®ƒ¼Ü†ßdšghDB from PMEM: %s. Ex™šg.",
	`¡»¼Ü
(
”ºo
));

4212 
	`ex™
(1);

4216 ià(
£rv”
.
şu¡”_’abËd
) {

4217 ià(
	`v”ifyClu¡”CÚfigW™hD©a
(è=ğ
C_ERR
) {

4218 
	`£rv”Log
(
LL_WARNING
,

4221 
	`ex™
(1);

4224 ià(
£rv”
.
fd_couÁ
 > 0)

4225 
	`£rv”Log
(
LL_NOTICE
,"Th£rv” i now„—dyØacû± cÚÃùiÚ Ú…Üˆ%d", 
£rv”
.
pÜt
);

4226 ià(
£rv”
.
sofd
 > 0)

4227 
	`£rv”Log
(
LL_NOTICE
,"Th£rv” i now„—dyØacû± cÚÃùiÚ © %s", 
£rv”
.
unixsock‘
);

4229 
	`£Áš–IsRuÂšg
();

4233 ià(
£rv”
.
maxmemÜy
 > 0 && server.maxmemory < 1024*1024) {

4234 
	`£rv”Log
(
LL_WARNING
,"WARNING: You s³cif›d‡ maxmemÜy v®uth© i Ës thª 1MB (cu¼’ˆv®ui %Îu by‹s). A» you su»hi i wh© you„—Îy wªt?", 
£rv”
.
maxmemÜy
);

4237 
	`«S‘BefÜeSË•Proc
(
£rv”
.
–
,
befÜeSË•
);

4239 
	`·vi£_»cov”y_’d
();

4240 
	`«Maš
(
£rv”
.
–
);

4241 
	`·vi£_š¡rum’t_’d
();

4242 
	`«D–‘eEv’tLoİ
(
£rv”
.
–
);

4244 
	}
}

	@src/server.h

30 #iâdeà
__REDIS_H


31 
	#__REDIS_H


	)

33 
	~"fmaüos.h
"

34 
	~"cÚfig.h
"

35 
	~"sŞ¬isfixes.h
"

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<¡ršg.h
>

40 
	~<time.h
>

41 
	~<lim™s.h
>

42 
	~<uni¡d.h
>

43 
	~<”ºo.h
>

44 
	~<š‰y³s.h
>

45 
	~<±h»ad.h
>

46 
	~<sy¦og.h
>

47 
	~<Ãtš‘/š.h
>

48 
	~<lua.h
>

49 
	~<sigÇl.h
>

51 #ifdeà
USE_PMDK


52 
	~<¡dboŞ.h
>

53 
	~<sys/queue.h
>

54 
	~"libpmemobj.h
"

55 
	~"·vi£_š‹rçû.h
"

57 
	#PM_LAYOUT_NAME
 "¡Üe_db"

	)

59 
POBJ_LAYOUT_BEGIN
(
¡Üe_db
);

60 
POBJ_LAYOUT_TOID
(
¡Üe_db
, 
»dis_pmem_roÙ
);

61 
POBJ_LAYOUT_TOID
(
¡Üe_db
, 
key_v®_·œ_PM
);

62 
POBJ_LAYOUT_END
(
¡Üe_db
);

64 
	~"pmem.h
"

66 
ušt64_t
 
pm_ty³_roÙ_ty³_id
;

67 
ušt64_t
 
pm_ty³_key_v®_·œ_PM
;

68 
ušt64_t
 
pm_ty³_sds_ty³_id
;

69 
ušt64_t
 
pm_ty³_emb_sds_ty³_id
;

72 
	#PM_TYPE_KEY_VAL_PAIR_PM
 
pm_ty³_key_v®_·œ_PM


	)

74 
	#PM_TYPE_SDS
 
pm_ty³_sds_ty³_id


	)

76 
	#PM_TYPE_EMB_SDS
 
pm_ty³_emb_sds_ty³_id


	)

78 
	s»dis_pmem_roÙ
 {

79 
ušt64_t
 
	mnum_diù_’Œ›s
;

80 
TOID
(
key_v®_·œ_PM
è
	m³_fœ¡
;

85 
	tm¡ime_t
;

87 
	~"«.h
"

88 
	~"sds.h
"

89 
	~"diù.h
"

90 
	~"adli¡.h
"

91 
	~"zm®loc.h
"

92 
	~"ª‘.h
"

93 
	~"zli¡.h
"

94 
	~"št£t.h
"

95 
	~"v”siÚ.h
"

96 
	~"ut.h
"

97 
	~"Ï‹ncy.h
"

98 
	~"¥¬klše.h
"

99 
	~"quickli¡.h
"

102 
	~"zm­.h
"

103 
	~"sha1.h
"

104 
	~"’dŸncÚv.h
"

105 
	~"üc64.h
"

109 
	#C_OK
 0

	)

110 
	#C_ERR
 -1

	)

113 
	#CONFIG_DEFAULT_HZ
 10

	)

114 
	#CONFIG_MIN_HZ
 1

	)

115 
	#CONFIG_MAX_HZ
 500

	)

116 
	#CONFIG_DEFAULT_SERVER_PORT
 6379

	)

117 
	#CONFIG_DEFAULT_TCP_BACKLOG
 511

	)

118 
	#CONFIG_DEFAULT_CLIENT_TIMEOUT
 0

	)

119 
	#CONFIG_DEFAULT_DBNUM
 16

	)

120 
	#CONFIG_MAX_LINE
 1024

	)

121 
	#CRON_DBS_PER_CALL
 16

	)

122 
	#NET_MAX_WRITES_PER_EVENT
 (1024*64)

	)

123 
	#PROTO_SHARED_SELECT_CMDS
 10

	)

124 
	#OBJ_SHARED_INTEGERS
 10000

	)

125 
	#OBJ_SHARED_BULKHDR_LEN
 32

	)

126 
	#LOG_MAX_LEN
 1024

	)

127 
	#AOF_REWRITE_PERC
 100

	)

128 
	#AOF_REWRITE_MIN_SIZE
 (64*1024*1024)

	)

129 
	#AOF_REWRITE_ITEMS_PER_CMD
 64

	)

130 
	#CONFIG_DEFAULT_SLOWLOG_LOG_SLOWER_THAN
 10000

	)

131 
	#CONFIG_DEFAULT_SLOWLOG_MAX_LEN
 128

	)

132 
	#CONFIG_DEFAULT_MAX_CLIENTS
 10000

	)

133 
	#CONFIG_AUTHPASS_MAX_LEN
 512

	)

134 
	#CONFIG_DEFAULT_SLAVE_PRIORITY
 100

	)

135 
	#CONFIG_DEFAULT_REPL_TIMEOUT
 60

	)

136 
	#CONFIG_DEFAULT_REPL_PING_SLAVE_PERIOD
 10

	)

137 
	#CONFIG_RUN_ID_SIZE
 40

	)

138 
	#RDB_EOF_MARK_SIZE
 40

	)

139 
	#CONFIG_DEFAULT_REPL_BACKLOG_SIZE
 (1024*1024è

	)

140 
	#CONFIG_DEFAULT_REPL_BACKLOG_TIME_LIMIT
 (60*60è

	)

141 
	#CONFIG_REPL_BACKLOG_MIN_SIZE
 (1024*16è

	)

142 
	#CONFIG_BGSAVE_RETRY_DELAY
 5

	)

143 
	#CONFIG_DEFAULT_PID_FILE
 "/v¬/run/»dis.pid"

	)

144 
	#CONFIG_DEFAULT_SYSLOG_IDENT
 "»dis"

	)

145 
	#CONFIG_DEFAULT_CLUSTER_CONFIG_FILE
 "nodes.cÚf"

	)

146 
	#CONFIG_DEFAULT_DAEMONIZE
 0

	)

147 
	#CONFIG_DEFAULT_UNIX_SOCKET_PERM
 0

	)

148 
	#CONFIG_DEFAULT_TCP_KEEPALIVE
 300

	)

149 
	#CONFIG_DEFAULT_PROTECTED_MODE
 1

	)

150 
	#CONFIG_DEFAULT_LOGFILE
 ""

	)

151 
	#CONFIG_DEFAULT_SYSLOG_ENABLED
 0

	)

152 
	#CONFIG_DEFAULT_STOP_WRITES_ON_BGSAVE_ERROR
 1

	)

153 
	#CONFIG_DEFAULT_RDB_COMPRESSION
 1

	)

154 
	#CONFIG_DEFAULT_RDB_CHECKSUM
 1

	)

155 
	#CONFIG_DEFAULT_RDB_FILENAME
 "dump.rdb"

	)

156 
	#CONFIG_DEFAULT_REPL_DISKLESS_SYNC
 0

	)

157 
	#CONFIG_DEFAULT_REPL_DISKLESS_SYNC_DELAY
 5

	)

158 
	#CONFIG_DEFAULT_SLAVE_SERVE_STALE_DATA
 1

	)

159 
	#CONFIG_DEFAULT_SLAVE_READ_ONLY
 1

	)

160 
	#CONFIG_DEFAULT_SLAVE_ANNOUNCE_IP
 
NULL


	)

161 
	#CONFIG_DEFAULT_SLAVE_ANNOUNCE_PORT
 0

	)

162 
	#CONFIG_DEFAULT_REPL_DISABLE_TCP_NODELAY
 0

	)

163 
	#CONFIG_DEFAULT_MAXMEMORY
 0

	)

164 
	#CONFIG_DEFAULT_MAXMEMORY_SAMPLES
 5

	)

165 
	#CONFIG_DEFAULT_AOF_FILENAME
 "­³ndÚly.aof"

	)

166 
	#CONFIG_DEFAULT_AOF_NO_FSYNC_ON_REWRITE
 0

	)

167 
	#CONFIG_DEFAULT_AOF_LOAD_TRUNCATED
 1

	)

168 
	#CONFIG_DEFAULT_ACTIVE_REHASHING
 1

	)

169 
	#CONFIG_DEFAULT_AOF_REWRITE_INCREMENTAL_FSYNC
 1

	)

170 
	#CONFIG_DEFAULT_MIN_SLAVES_TO_WRITE
 0

	)

171 
	#CONFIG_DEFAULT_MIN_SLAVES_MAX_LAG
 10

	)

172 
	#NET_IP_STR_LEN
 46

	)

173 
	#NET_PEER_ID_LEN
 (
NET_IP_STR_LEN
+32è

	)

174 
	#CONFIG_BINDADDR_MAX
 16

	)

175 
	#CONFIG_MIN_RESERVED_FDS
 32

	)

176 
	#CONFIG_DEFAULT_LATENCY_MONITOR_THRESHOLD
 0

	)

178 #ifdeà
USE_PMDK


179 
	#CONFIG_MIN_PM_FILE_SIZE
 
PMEMOBJ_MIN_POOL


	)

180 
	#CONFIG_DEFAULT_PM_FILE_SIZE
 (1024*1024*1024è

	)

183 
	#ACTIVE_EXPIRE_CYCLE_LOOKUPS_PER_LOOP
 20

	)

184 
	#ACTIVE_EXPIRE_CYCLE_FAST_DURATION
 1000

	)

185 
	#ACTIVE_EXPIRE_CYCLE_SLOW_TIME_PERC
 25

	)

186 
	#ACTIVE_EXPIRE_CYCLE_SLOW
 0

	)

187 
	#ACTIVE_EXPIRE_CYCLE_FAST
 1

	)

190 
	#STATS_METRIC_SAMPLES
 16

	)

191 
	#STATS_METRIC_COMMAND
 0

	)

192 
	#STATS_METRIC_NET_INPUT
 1

	)

193 
	#STATS_METRIC_NET_OUTPUT
 2

	)

194 
	#STATS_METRIC_COUNT
 3

	)

197 
	#PROTO_MAX_QUERYBUF_LEN
 (1024*1024*1024è

	)

198 
	#PROTO_IOBUF_LEN
 (1024*16è

	)

199 
	#PROTO_REPLY_CHUNK_BYTES
 (16*1024è

	)

200 
	#PROTO_INLINE_MAX_SIZE
 (1024*64è

	)

201 
	#PROTO_MBULK_BIG_ARG
 (1024*32)

	)

202 
	#LONG_STR_SIZE
 21

	)

203 
	#AOF_AUTOSYNC_BYTES
 (1024*1024*32è

	)

209 
	#CONFIG_FDSET_INCR
 (
CONFIG_MIN_RESERVED_FDS
+96)

	)

212 
	#HASHTABLE_MIN_FILL
 10

	)

216 
	#CMD_WRITE
 1

	)

217 
	#CMD_READONLY
 2

	)

218 
	#CMD_DENYOOM
 4

	)

219 
	#CMD_NOT_USED_1
 8

	)

220 
	#CMD_ADMIN
 16

	)

221 
	#CMD_PUBSUB
 32

	)

222 
	#CMD_NOSCRIPT
 64

	)

223 
	#CMD_RANDOM
 128

	)

224 
	#CMD_SORT_FOR_SCRIPT
 256

	)

225 
	#CMD_LOADING
 512

	)

226 
	#CMD_STALE
 1024

	)

227 
	#CMD_SKIP_MONITOR
 2048

	)

228 
	#CMD_ASKING
 4096

	)

229 
	#CMD_FAST
 8192

	)

232 
	#OBJ_STRING
 0

	)

233 
	#OBJ_LIST
 1

	)

234 
	#OBJ_SET
 2

	)

235 
	#OBJ_ZSET
 3

	)

236 
	#OBJ_HASH
 4

	)

241 
	#OBJ_ENCODING_RAW
 0

	)

242 
	#OBJ_ENCODING_INT
 1

	)

243 
	#OBJ_ENCODING_HT
 2

	)

244 
	#OBJ_ENCODING_ZIPMAP
 3

	)

245 
	#OBJ_ENCODING_LINKEDLIST
 4

	)

246 
	#OBJ_ENCODING_ZIPLIST
 5

	)

247 
	#OBJ_ENCODING_INTSET
 6

	)

248 
	#OBJ_ENCODING_SKIPLIST
 7

	)

249 
	#OBJ_ENCODING_EMBSTR
 8

	)

250 
	#OBJ_ENCODING_QUICKLIST
 9

	)

265 
	#RDB_6BITLEN
 0

	)

266 
	#RDB_14BITLEN
 1

	)

267 
	#RDB_32BITLEN
 2

	)

268 
	#RDB_ENCVAL
 3

	)

269 
	#RDB_LENERR
 
UINT_MAX


	)

274 
	#RDB_ENC_INT8
 0

	)

275 
	#RDB_ENC_INT16
 1

	)

276 
	#RDB_ENC_INT32
 2

	)

277 
	#RDB_ENC_LZF
 3

	)

280 
	#AOF_OFF
 0

	)

281 
	#AOF_ON
 1

	)

282 
	#AOF_WAIT_REWRITE
 2

	)

285 
	#CLIENT_SLAVE
 (1<<0è

	)

286 
	#CLIENT_MASTER
 (1<<1è

	)

287 
	#CLIENT_MONITOR
 (1<<2è

	)

288 
	#CLIENT_MULTI
 (1<<3è

	)

289 
	#CLIENT_BLOCKED
 (1<<4è

	)

290 
	#CLIENT_DIRTY_CAS
 (1<<5è

	)

291 
	#CLIENT_CLOSE_AFTER_REPLY
 (1<<6è

	)

292 
	#CLIENT_UNBLOCKED
 (1<<7è

	)

294 
	#CLIENT_LUA
 (1<<8è

	)

295 
	#CLIENT_ASKING
 (1<<9è

	)

296 
	#CLIENT_CLOSE_ASAP
 (1<<10)

	)

297 
	#CLIENT_UNIX_SOCKET
 (1<<11è

	)

298 
	#CLIENT_DIRTY_EXEC
 (1<<12è

	)

299 
	#CLIENT_MASTER_FORCE_REPLY
 (1<<13è

	)

300 
	#CLIENT_FORCE_AOF
 (1<<14è

	)

301 
	#CLIENT_FORCE_REPL
 (1<<15è

	)

302 
	#CLIENT_PRE_PSYNC
 (1<<16è

	)

303 
	#CLIENT_READONLY
 (1<<17è

	)

304 
	#CLIENT_PUBSUB
 (1<<18è

	)

305 
	#CLIENT_PREVENT_AOF_PROP
 (1<<19è

	)

306 
	#CLIENT_PREVENT_REPL_PROP
 (1<<20è

	)

307 
	#CLIENT_PREVENT_PROP
 (
CLIENT_PREVENT_AOF_PROP
|
CLIENT_PREVENT_REPL_PROP
)

	)

308 
	#CLIENT_PENDING_WRITE
 (1<<21è

	)

310 
	#CLIENT_REPLY_OFF
 (1<<22è

	)

311 
	#CLIENT_REPLY_SKIP_NEXT
 (1<<23è

	)

312 
	#CLIENT_REPLY_SKIP
 (1<<24è

	)

313 
	#CLIENT_LUA_DEBUG
 (1<<25è

	)

314 
	#CLIENT_LUA_DEBUG_SYNC
 (1<<26è

	)

318 
	#BLOCKED_NONE
 0

	)

319 
	#BLOCKED_LIST
 1

	)

320 
	#BLOCKED_WAIT
 2

	)

323 
	#PROTO_REQ_INLINE
 1

	)

324 
	#PROTO_REQ_MULTIBULK
 2

	)

328 
	#CLIENT_TYPE_NORMAL
 0

	)

329 
	#CLIENT_TYPE_SLAVE
 1

	)

330 
	#CLIENT_TYPE_PUBSUB
 2

	)

331 
	#CLIENT_TYPE_MASTER
 3

	)

332 
	#CLIENT_TYPE_OBUF_COUNT
 3

	)

338 
	#REPL_STATE_NONE
 0

	)

339 
	#REPL_STATE_CONNECT
 1

	)

340 
	#REPL_STATE_CONNECTING
 2

	)

342 
	#REPL_STATE_RECEIVE_PONG
 3

	)

343 
	#REPL_STATE_SEND_AUTH
 4

	)

344 
	#REPL_STATE_RECEIVE_AUTH
 5

	)

345 
	#REPL_STATE_SEND_PORT
 6

	)

346 
	#REPL_STATE_RECEIVE_PORT
 7

	)

347 
	#REPL_STATE_SEND_IP
 8

	)

348 
	#REPL_STATE_RECEIVE_IP
 9

	)

349 
	#REPL_STATE_SEND_CAPA
 10

	)

350 
	#REPL_STATE_RECEIVE_CAPA
 11

	)

351 
	#REPL_STATE_SEND_PSYNC
 12

	)

352 
	#REPL_STATE_RECEIVE_PSYNC
 13

	)

354 
	#REPL_STATE_TRANSFER
 14

	)

355 
	#REPL_STATE_CONNECTED
 15

	)

361 
	#SLAVE_STATE_WAIT_BGSAVE_START
 6

	)

362 
	#SLAVE_STATE_WAIT_BGSAVE_END
 7

	)

363 
	#SLAVE_STATE_SEND_BULK
 8

	)

364 
	#SLAVE_STATE_ONLINE
 9

	)

367 
	#SLAVE_CAPA_NONE
 0

	)

368 
	#SLAVE_CAPA_EOF
 (1<<0è

	)

371 
	#CONFIG_REPL_SYNCIO_TIMEOUT
 5

	)

374 
	#REDIS_LIST_HEAD
 0

	)

375 
	#REDIS_LIST_TAIL
 1

	)

378 
	#SORT_OP_GET
 0

	)

381 
	#LL_DEBUG
 0

	)

382 
	#LL_VERBOSE
 1

	)

383 
	#LL_NOTICE
 2

	)

384 
	#LL_WARNING
 3

	)

385 
	#LL_RAW
 (1<<10è

	)

386 
	#CONFIG_DEFAULT_VERBOSITY
 
LL_NOTICE


	)

389 
	#SUPERVISED_NONE
 0

	)

390 
	#SUPERVISED_AUTODETECT
 1

	)

391 
	#SUPERVISED_SYSTEMD
 2

	)

392 
	#SUPERVISED_UPSTART
 3

	)

395 
	#UNUSED
(
V
è((èV)

	)

397 
	#ZSKIPLIST_MAXLEVEL
 32

	)

398 
	#ZSKIPLIST_P
 0.25

	)

401 
	#AOF_FSYNC_NO
 0

	)

402 
	#AOF_FSYNC_ALWAYS
 1

	)

403 
	#AOF_FSYNC_EVERYSEC
 2

	)

404 
	#CONFIG_DEFAULT_AOF_FSYNC
 
AOF_FSYNC_EVERYSEC


	)

407 
	#OBJ_HASH_MAX_ZIPLIST_ENTRIES
 512

	)

408 
	#OBJ_HASH_MAX_ZIPLIST_VALUE
 64

	)

409 
	#OBJ_SET_MAX_INTSET_ENTRIES
 512

	)

410 
	#OBJ_ZSET_MAX_ZIPLIST_ENTRIES
 128

	)

411 
	#OBJ_ZSET_MAX_ZIPLIST_VALUE
 64

	)

414 
	#OBJ_LIST_MAX_ZIPLIST_SIZE
 -2

	)

415 
	#OBJ_LIST_COMPRESS_DEPTH
 0

	)

418 
	#CONFIG_DEFAULT_HLL_SPARSE_MAX_BYTES
 3000

	)

421 
	#SET_OP_UNION
 0

	)

422 
	#SET_OP_DIFF
 1

	)

423 
	#SET_OP_INTER
 2

	)

426 
	#MAXMEMORY_VOLATILE_LRU
 0

	)

427 
	#MAXMEMORY_VOLATILE_TTL
 1

	)

428 
	#MAXMEMORY_VOLATILE_RANDOM
 2

	)

429 
	#MAXMEMORY_ALLKEYS_LRU
 3

	)

430 
	#MAXMEMORY_ALLKEYS_RANDOM
 4

	)

431 
	#MAXMEMORY_NO_EVICTION
 5

	)

432 
	#CONFIG_DEFAULT_MAXMEMORY_POLICY
 
MAXMEMORY_NO_EVICTION


	)

435 
	#LUA_SCRIPT_TIME_LIMIT
 5000

	)

438 
	#UNIT_SECONDS
 0

	)

439 
	#UNIT_MILLISECONDS
 1

	)

442 
	#SHUTDOWN_NOFLAGS
 0

	)

443 
	#SHUTDOWN_SAVE
 1

	)

445 
	#SHUTDOWN_NOSAVE
 2

	)

448 
	#CMD_CALL_NONE
 0

	)

449 
	#CMD_CALL_SLOWLOG
 (1<<0)

	)

450 
	#CMD_CALL_STATS
 (1<<1)

	)

451 
	#CMD_CALL_PROPAGATE_AOF
 (1<<2)

	)

452 
	#CMD_CALL_PROPAGATE_REPL
 (1<<3)

	)

453 
	#CMD_CALL_PROPAGATE
 (
CMD_CALL_PROPAGATE_AOF
|
CMD_CALL_PROPAGATE_REPL
)

	)

454 
	#CMD_CALL_FULL
 (
CMD_CALL_SLOWLOG
 | 
CMD_CALL_STATS
 | 
CMD_CALL_PROPAGATE
)

	)

457 
	#PROPAGATE_NONE
 0

	)

458 
	#PROPAGATE_AOF
 1

	)

459 
	#PROPAGATE_REPL
 2

	)

462 
	#RDB_CHILD_TYPE_NONE
 0

	)

463 
	#RDB_CHILD_TYPE_DISK
 1

	)

464 
	#RDB_CHILD_TYPE_SOCKET
 2

	)

468 
	#NOTIFY_KEYSPACE
 (1<<0è

	)

469 
	#NOTIFY_KEYEVENT
 (1<<1è

	)

470 
	#NOTIFY_GENERIC
 (1<<2è

	)

471 
	#NOTIFY_STRING
 (1<<3è

	)

472 
	#NOTIFY_LIST
 (1<<4è

	)

473 
	#NOTIFY_SET
 (1<<5è

	)

474 
	#NOTIFY_HASH
 (1<<6è

	)

475 
	#NOTIFY_ZSET
 (1<<7è

	)

476 
	#NOTIFY_EXPIRED
 (1<<8è

	)

477 
	#NOTIFY_EVICTED
 (1<<9è

	)

478 
	#NOTIFY_ALL
 (
NOTIFY_GENERIC
 | 
NOTIFY_STRING
 | 
NOTIFY_LIST
 | 
NOTIFY_SET
 | 
NOTIFY_HASH
 | 
NOTIFY_ZSET
 | 
NOTIFY_EXPIRED
 | 
NOTIFY_EVICTED
è

	)

481 
	#NET_FIRST_BIND_ADDR
 (
£rv”
.
bšdaddr_couÁ
 ? s”v”.
bšdaddr
[0] : 
NULL
)

	)

486 
	#run_w™h_³riod
(
_ms_
èià((_ms_ <ğ1000/
£rv”
.
hz
è|| !(£rv”.
üÚloİs
%((_ms_)/(1000/£rv”.hz))))

	)

489 
	#£rv”As£¹W™hInfo
(
_c
,
_o
,
_e
è((_e)?()0 : (
	`_£rv”As£¹W™hInfo
(_c,_o,#_e,
__FILE__
,
__LINE__
),
	`_ex™
(1)))

	)

490 
	#£rv”As£¹
(
_e
è((_e)?()0 : (
	`_£rv”As£¹
(#_e,
__FILE__
,
__LINE__
),
	`_ex™
(1)))

	)

491 
	#£rv”Pªic
(
_e
è
	`_£rv”Pªic
(#_e,
__FILE__
,
__LINE__
),
	`_ex™
(1)

	)

500 
	#LRU_BITS
 24

	)

501 
	#LRU_CLOCK_MAX
 ((1<<
LRU_BITS
)-1è

	)

502 
	#LRU_CLOCK_RESOLUTION
 1000

	)

503 
	s»disObjeù
 {

504 
	mty³
:4;

505 
	m’codšg
:4;

506 
	mÌu
:
LRU_BITS
;

507 
	m»fcouÁ
;

508 *
	m±r
;

509 } 
	trobj
;

515 
	#LRU_CLOCK
(è((1000/
£rv”
.
hz
 <ğ
LRU_CLOCK_RESOLUTION
è? s”v”.
Ìuşock
 : 
	`g‘LRUClock
())

	)

521 
	#š™SticSŒšgObjeù
(
_v¬
,
_±r
) do { \

522 
_v¬
.
»fcouÁ
 = 1; \

523 
_v¬
.
ty³
 = 
OBJ_STRING
; \

524 
_v¬
.
’codšg
 = 
OBJ_ENCODING_RAW
; \

525 
_v¬
.
±r
 = 
_±r
; \

526 } 0)

	)

535 
	#MAXMEMORY_EVICTION_POOL_SIZE
 16

	)

536 
	seviùiÚPoŞEÁry
 {

537 
	midË
;

538 
sds
 
	mkey
;

544 
	s»disDb
 {

545 
diù
 *
	mdiù
;

546 
diù
 *
	mexpœes
;

547 
diù
 *
	mblockšg_keys
;

548 
diù
 *
	m»ady_keys
;

549 
diù
 *
	mw©ched_keys
;

550 
eviùiÚPoŞEÁry
 *
	meviùiÚ_poŞ
;

551 
	mid
;

552 
	mavg_‰l
;

553 } 
	t»disDb
;

556 
	smuÉiCmd
 {

557 
robj
 **
	m¬gv
;

558 
	m¬gc
;

559 
»disCommªd
 *
	mcmd
;

560 } 
	tmuÉiCmd
;

562 
	smuÉiS‹
 {

563 
muÉiCmd
 *
	mcommªds
;

564 
	mcouÁ
;

565 
	mmš»¶iÿs
;

566 
time_t
 
	mmš»¶iÿs_timeout
;

567 } 
	tmuÉiS‹
;

571 
	sblockšgS‹
 {

573 
m¡ime_t
 
	mtimeout
;

577 
diù
 *
	mkeys
;

579 
robj
 *
	mrg‘
;

583 
	mnum»¶iÿs
;

584 
	m»¶off£t
;

585 } 
	tblockšgS‹
;

598 
	s»adyLi¡
 {

599 
»disDb
 *
	mdb
;

600 
robj
 *
	mkey
;

601 } 
	t»adyLi¡
;

605 
	sş›Á
 {

606 
ušt64_t
 
	mid
;

607 
	mfd
;

608 
»disDb
 *
	mdb
;

609 
	mdiùid
;

610 
robj
 *
	mÇme
;

611 
sds
 
	mqu”ybuf
;

612 
size_t
 
	mqu”ybuf_³ak
;

613 
	m¬gc
;

614 
robj
 **
	m¬gv
;

615 
»disCommªd
 *
	mcmd
, *
	mÏ¡cmd
;

616 
	m»qty³
;

617 
	mmuÉibulkËn
;

618 
	mbulkËn
;

619 
li¡
 *
	m»¶y
;

620 
	m»¶y_by‹s
;

621 
size_t
 
	m£ÁËn
;

623 
time_t
 
	mùime
;

624 
time_t
 
	mÏ¡š‹¿ùiÚ
;

625 
time_t
 
	mobuf_soá_lim™_»ached_time
;

626 
	mæags
;

627 
	mauth’tiÿ‹d
;

628 
	m»¶¡©e
;

629 
	m»¶_put_Úlše_Ú_ack
;

630 
	m»¶dbfd
;

631 
off_t
 
	m»¶dboff
;

632 
off_t
 
	m»¶dbsize
;

633 
sds
 
	m»¶´—mbË
;

634 
	m»¶off
;

635 
	m»¶_ack_off
;

636 
	m»¶_ack_time
;

637 
	mpsync_š™Ÿl_off£t
;

640 
	m»¶runid
[
CONFIG_RUN_ID_SIZE
+1];

641 
	m¦ave_li¡’šg_pÜt
;

642 
	m¦ave_
[
NET_IP_STR_LEN
];

643 
	m¦ave_ÿ·
;

644 
muÉiS‹
 
	mm¡©e
;

645 
	mbty³
;

646 
blockšgS‹
 
	mbpİ
;

647 
	mwoff
;

648 
li¡
 *
	mw©ched_keys
;

649 
diù
 *
	mpubsub_chªÃls
;

650 
li¡
 *
	mpubsub_·‰”ns
;

651 
sds
 
	m³”id
;

654 
	mbuåos
;

655 
	mbuf
[
PROTO_REPLY_CHUNK_BYTES
];

656 } 
	tş›Á
;

658 
	s§v•¬am
 {

659 
time_t
 
	m£cÚds
;

660 
	mchªges
;

663 
	ssh¬edObjeùsSŒuù
 {

664 
robj
 *
	mülf
, *
	mok
, *
	m”r
, *
	mem±ybulk
, *
	mcz”o
, *
	mcÚe
, *
	múegÚe
, *
	mpÚg
, *
	m¥aû
,

665 *
	mcŞÚ
, *
	mnuÎbulk
, *
	mnuÎmuÉibulk
, *
	mqueued
,

666 *
	mem±ymuÉibulk
, *
	mwrÚgty³”r
, *
	mnokey”r
, *
	msyÁax”r
, *
	m§meobjeù”r
,

667 *
	moutoäªg“¼
, *
	mnosü‹¼
, *
	mlßdšg”r
, *
	m¦owsü‹¼
, *
	mbg§v“¼
,

668 *
	mma¡”dowÃ¼
, *
	mro¦av“¼
, *
	mexeÿbÜ‹¼
, *
	mnßuth”r
, *
	mnÜ•liÿ£¼
,

669 *
	mbusykey”r
, *
	moom”r
, *
	m¶us
, *
	mmes§gebulk
, *
	mpmes§gebulk
, *
	msubsüibebulk
,

670 *
	munsubsüibebulk
, *
	mpsubsüibebulk
, *
	mpunsubsüibebulk
, *
	md–
, *
	m½İ
, *
	mÍİ
,

671 *
	mÍush
, *
	mem±ysÿn
, *
	mmš¡ršg
, *
	mmax¡ršg
,

672 *
	m£Ëù
[
PROTO_SHARED_SELECT_CMDS
],

673 *
	mš‹g”s
[
OBJ_SHARED_INTEGERS
],

674 *
	mmbulkhdr
[
OBJ_SHARED_BULKHDR_LEN
],

675 *
	mbulkhdr
[
OBJ_SHARED_BULKHDR_LEN
];

679 
	szskli¡Node
 {

680 
robj
 *
	mobj
;

681 
	mscÜe
;

682 
zskli¡Node
 *
	mbackw¬d
;

683 
	szskli¡Lev–
 {

684 
zskli¡Node
 *
	mfÜw¬d
;

685 
	m¥ª
;

686 } 
	mËv–
[];

687 } 
	tzskli¡Node
;

689 
	szskli¡
 {

690 
zskli¡Node
 *
	mh—d”
, *
	m
;

691 
	mËngth
;

692 
	mËv–
;

693 } 
	tzskli¡
;

695 
	sz£t
 {

696 
diù
 *
	mdiù
;

697 
zskli¡
 *
	mz¦
;

698 } 
	tz£t
;

700 
	sş›ÁBufãrLim™sCÚfig
 {

701 
	mh¬d_lim™_by‹s
;

702 
	msoá_lim™_by‹s
;

703 
time_t
 
	msoá_lim™_£cÚds
;

704 } 
	tş›ÁBufãrLim™sCÚfig
;

706 
ş›ÁBufãrLim™sCÚfig
 
ş›ÁBufãrLim™sDeçuÉs
[
CLIENT_TYPE_OBUF_COUNT
];

714 
	s»disOp
 {

715 
robj
 **
	m¬gv
;

716 
	m¬gc
, 
	mdbid
, 
	mrg‘
;

717 
»disCommªd
 *
	mcmd
;

718 } 
	t»disOp
;

727 
	s»disOpA¼ay
 {

728 
»disOp
 *
	mİs
;

729 
	mnumİs
;

730 } 
	t»disOpA¼ay
;

736 
	gşu¡”S‹
;

740 #ifdeà
_AIX


741 #undeà
hz


744 
	s»disS”v”
 {

746 
pid_t
 
	mpid
;

747 *
	mcÚfigfe
;

748 *
	mexecubË
;

749 **
	mexec_¬gv
;

750 
	mhz
;

751 
»disDb
 *
	mdb
;

752 
diù
 *
	mcommªds
;

753 
diù
 *
	mÜig_commªds
;

754 
«Ev’tLoİ
 *
	m–
;

755 
	mÌuşock
:
LRU_BITS
;

756 
	mshutdown_a§p
;

757 
	maùiv”ehashšg
;

758 *
	m»quœ•ass
;

759 *
	mpidfe
;

760 
	m¬ch_b™s
;

761 
	müÚloİs
;

762 
	mrunid
[
CONFIG_RUN_ID_SIZE
+1];

763 
	m£Áš–_mode
;

765 
	mpÜt
;

766 
	mtı_backlog
;

767 *
	mbšdaddr
[
CONFIG_BINDADDR_MAX
];

768 
	mbšdaddr_couÁ
;

769 *
	munixsock‘
;

770 
mode_t
 
	munixsock‘³rm
;

771 
	mfd
[
CONFIG_BINDADDR_MAX
];

772 
	mfd_couÁ
;

773 
	msofd
;

774 
	mcfd
[
CONFIG_BINDADDR_MAX
];

775 
	mcfd_couÁ
;

776 
li¡
 *
	mş›Ás
;

777 
li¡
 *
	mş›Ás_to_şo£
;

778 
li¡
 *
	mş›Ás_³ndšg_wr™e
;

779 
li¡
 *
	m¦aves
, *
	mmÚ™Üs
;

780 
ş›Á
 *
	mcu¼’t_ş›Á
;

781 
	mş›Ás_·u£d
;

782 
m¡ime_t
 
	mş›Ás_·u£_’d_time
;

783 
	mÃ‹¼
[
ANET_ERR_LEN
];

784 
diù
 *
	mmig¿‹_ÿched_sock‘s
;

785 
ušt64_t
 
	mÃxt_ş›Á_id
;

786 
	m´Ùeùed_mode
;

788 
	mlßdšg
;

789 
off_t
 
	mlßdšg_tÙ®_by‹s
;

790 
off_t
 
	mlßdšg_lßded_by‹s
;

791 
time_t
 
	mlßdšg_¡¬t_time
;

792 
off_t
 
	mlßdšg_´oûss_ev’ts_š‹rv®_by‹s
;

794 
»disCommªd
 *
	md–Commªd
, *
	mmuÉiCommªd
, *
	mÍushCommªd
, *
	mÍİCommªd
,

795 *
	m½İCommªd
, *
	m¤emCommªd
, *
	mexecCommªd
;

797 
time_t
 
	m¡©_¡¬‰ime
;

798 
	m¡©_numcommªds
;

799 
	m¡©_numcÚÃùiÚs
;

800 
	m¡©_expœedkeys
;

801 
	m¡©_eviùedkeys
;

802 
	m¡©_key¥aû_h™s
;

803 
	m¡©_key¥aû_mis£s
;

804 
size_t
 
	m¡©_³ak_memÜy
;

805 
	m¡©_fÜk_time
;

806 
	m¡©_fÜk_¿‹
;

807 
	m¡©_»jeùed_cÚn
;

808 
	m¡©_sync_fuÎ
;

809 
	m¡©_sync_·¹Ÿl_ok
;

810 
	m¡©_sync_·¹Ÿl_”r
;

811 
li¡
 *
	m¦owlog
;

812 
	m¦owlog_’Œy_id
;

813 
	m¦owlog_log_¦ow”_thª
;

814 
	m¦owlog_max_Ën
;

815 
size_t
 
	m»sid’t_£t_size
;

816 
	m¡©_Ãt_šput_by‹s
;

817 
	m¡©_Ãt_ouut_by‹s
;

821 
	mÏ¡_§m¶e_time
;

822 
	mÏ¡_§m¶e_couÁ
;

823 
	m§m¶es
[
STATS_METRIC_SAMPLES
];

824 
	midx
;

825 } 
	mš¡_m‘ric
[
STATS_METRIC_COUNT
];

827 
	mv”bos™y
;

828 
	mmaxidËtime
;

829 
	mtık“·live
;

830 
	maùive_expœe_’abËd
;

831 
size_t
 
	mş›Á_max_qu”ybuf_Ën
;

832 
	mdbnum
;

833 
	msu³rvi£d
;

834 
	msu³rvi£d_mode
;

835 
	md«mÚize
;

836 
ş›ÁBufãrLim™sCÚfig
 
	mş›Á_obuf_lim™s
[
CLIENT_TYPE_OBUF_COUNT
];

837 #ifdeà
USE_PMDK


839 * 
	mpm_fe_·th
;

840 
size_t
 
	mpm_fe_size
;

841 
boŞ
 
	m³rsi¡’t
;

842 
boŞ
 
	mpm_»cÚ¡ruù_»quœed
;

843 
PMEMobjpoŞ
 *
	mpm_poŞ
;

844 
TOID
(
»dis_pmem_roÙ
è
	mpm_roÙoid
;

845 
ušt64_t
 
	mpoŞ_uuid_lo
;

848 
	maof_¡©e
;

849 
	maof_fsync
;

850 *
	maof_f’ame
;

851 
	maof_no_fsync_Ú_»wr™e
;

852 
	maof_»wr™e_³rc
;

853 
off_t
 
	maof_»wr™e_mš_size
;

854 
off_t
 
	maof_»wr™e_ba£_size
;

855 
off_t
 
	maof_cu¼’t_size
;

856 
	maof_»wr™e_scheduËd
;

857 
pid_t
 
	maof_chd_pid
;

858 
li¡
 *
	maof_»wr™e_buf_blocks
;

859 
sds
 
	maof_buf
;

860 
	maof_fd
;

861 
	maof_£Ëùed_db
;

862 
time_t
 
	maof_æush_po¡pÚed_¡¬t
;

863 
time_t
 
	maof_Ï¡_fsync
;

864 
time_t
 
	maof_»wr™e_time_Ï¡
;

865 
time_t
 
	maof_»wr™e_time_¡¬t
;

866 
	maof_Ï¡bg»wr™e_¡©us
;

867 
	maof_d–ayed_fsync
;

868 
	maof_»wr™e_šüem’l_fsync
;

869 
	maof_Ï¡_wr™e_¡©us
;

870 
	maof_Ï¡_wr™e_”ºo
;

871 
	maof_lßd_Œunÿ‹d
;

873 
	maof_pe_wr™e_d©a_to_chd
;

874 
	maof_pe_»ad_d©a_äom_·»Á
;

875 
	maof_pe_wr™e_ack_to_·»Á
;

876 
	maof_pe_»ad_ack_äom_chd
;

877 
	maof_pe_wr™e_ack_to_chd
;

878 
	maof_pe_»ad_ack_äom_·»Á
;

879 
	maof_¡İ_£ndšg_diff
;

881 
sds
 
	maof_chd_diff
;

883 
	mdœty
;

884 
	mdœty_befÜe_bg§ve
;

885 
pid_t
 
	mrdb_chd_pid
;

886 
§v•¬am
 *
	m§v•¬ams
;

887 
	m§v•¬am¦’
;

888 *
	mrdb_f’ame
;

889 
	mrdb_com´essiÚ
;

890 
	mrdb_checksum
;

891 
time_t
 
	mÏ¡§ve
;

892 
time_t
 
	mÏ¡bg§ve_Œy
;

893 
time_t
 
	mrdb_§ve_time_Ï¡
;

894 
time_t
 
	mrdb_§ve_time_¡¬t
;

895 
	mrdb_bg§ve_scheduËd
;

896 
	mrdb_chd_ty³
;

897 
	mÏ¡bg§ve_¡©us
;

898 
	m¡İ_wr™es_Ú_bg§ve_”r
;

899 
	mrdb_pe_wr™e_»suÉ_to_·»Á
;

900 
	mrdb_pe_»ad_»suÉ_äom_chd
;

902 
»disOpA¼ay
 
	m®so_´İag©e
;

904 *
	mlogfe
;

905 
	msy¦og_’abËd
;

906 *
	msy¦og_id’t
;

907 
	msy¦og_çc™y
;

909 
	m¦ave£ldb
;

910 
	mma¡”_»¶_off£t
;

911 
	m»¶_pšg_¦ave_³riod
;

912 *
	m»¶_backlog
;

913 
	m»¶_backlog_size
;

914 
	m»¶_backlog_hi¡Ën
;

915 
	m»¶_backlog_idx
;

916 
	m»¶_backlog_off
;

918 
time_t
 
	m»¶_backlog_time_lim™
;

920 
time_t
 
	m»¶_no_¦aves_sšû
;

922 
	m»¶_mš_¦aves_to_wr™e
;

923 
	m»¶_mš_¦aves_max_Ïg
;

924 
	m»¶_good_¦aves_couÁ
;

925 
	m»¶_diskËss_sync
;

926 
	m»¶_diskËss_sync_d–ay
;

928 *
	mma¡”auth
;

929 *
	mma¡”ho¡
;

930 
	mma¡”pÜt
;

931 
	m»¶_timeout
;

932 
ş›Á
 *
	mma¡”
;

933 
ş›Á
 *
	mÿched_ma¡”
;

934 
	m»¶_syncio_timeout
;

935 
	m»¶_¡©e
;

936 
off_t
 
	m»¶_Œªsãr_size
;

937 
off_t
 
	m»¶_Œªsãr_»ad
;

938 
off_t
 
	m»¶_Œªsãr_Ï¡_fsync_off
;

939 
	m»¶_Œªsãr_s
;

940 
	m»¶_Œªsãr_fd
;

941 *
	m»¶_Œªsãr_tmpfe
;

942 
time_t
 
	m»¶_Œªsãr_Ï¡io
;

943 
	m»¶_£rve_¡®e_d©a
;

944 
	m»¶_¦ave_ro
;

945 
time_t
 
	m»¶_down_sšû
;

946 
	m»¶_di§bË_tı_nod–ay
;

947 
	m¦ave_´iÜ™y
;

948 
	m¦ave_ªnounû_pÜt
;

949 *
	m¦ave_ªnounû_
;

950 
	m»¶_ma¡”_runid
[
CONFIG_RUN_ID_SIZE
+1];

951 
	m»¶_ma¡”_š™Ÿl_off£t
;

953 
diù
 *
	m»¶_sütÿche_diù
;

954 
li¡
 *
	m»¶_sütÿche_fifo
;

955 
	m»¶_sütÿche_size
;

957 
li¡
 *
	mş›Ás_wa™šg_acks
;

958 
	mg‘_ack_äom_¦aves
;

960 
	mmaxş›Ás
;

961 
	mmaxmemÜy
;

962 
	mmaxmemÜy_pŞicy
;

963 
	mmaxmemÜy_§m¶es
;

965 
	mbpİ_blocked_ş›Ás
;

966 
li¡
 *
	munblocked_ş›Ás
;

967 
li¡
 *
	m»ady_keys
;

970 
	msÜt_desc
;

971 
	msÜt_®pha
;

972 
	msÜt_by·‰”n
;

973 
	msÜt_¡Üe
;

975 
size_t
 
	mhash_max_zli¡_’Œ›s
;

976 
size_t
 
	mhash_max_zli¡_v®ue
;

977 
size_t
 
	m£t_max_št£t_’Œ›s
;

978 
size_t
 
	mz£t_max_zli¡_’Œ›s
;

979 
size_t
 
	mz£t_max_zli¡_v®ue
;

980 
size_t
 
	mhÎ_¥¬£_max_by‹s
;

982 
	mli¡_max_zli¡_size
;

983 
	mli¡_com´ess_d•th
;

985 
time_t
 
	munixtime
;

986 
	mm¡ime
;

988 
diù
 *
	mpubsub_chªÃls
;

989 
li¡
 *
	mpubsub_·‰”ns
;

990 
	mnÙify_key¥aû_ev’ts
;

993 
	mşu¡”_’abËd
;

994 
m¡ime_t
 
	mşu¡”_node_timeout
;

995 *
	mşu¡”_cÚfigfe
;

996 
şu¡”S‹
 *
	mşu¡”
;

997 
	mşu¡”_mig¿tiÚ_b¬r›r
;

998 
	mşu¡”_¦ave_v®id™y_çùÜ
;

999 
	mşu¡”_»quœe_fuÎ_cov”age
;

1002 
lua_S‹
 *
	mlua
;

1003 
ş›Á
 *
	mlua_ş›Á
;

1004 
ş›Á
 *
	mlua_ÿÎ”
;

1005 
diù
 *
	mlua_süts
;

1006 
m¡ime_t
 
	mlua_time_lim™
;

1007 
m¡ime_t
 
	mlua_time_¡¬t
;

1008 
	mlua_wr™e_dœty
;

1010 
	mlua_¿ndom_dœty
;

1012 
	mlua_»¶iÿ‹_commªds
;

1013 
	mlua_muÉi_em™‹d
;

1014 
	mlua_»¶
;

1015 
	mlua_timedout
;

1017 
	mlua_kl
;

1018 
	mlua_®ways_»¶iÿ‹_commªds
;

1020 
	mÏ‹ncy_mÚ™Ü_th»shŞd
;

1021 
diù
 *
	mÏ‹ncy_ev’ts
;

1023 *
	mas£¹_çed
;

1024 *
	mas£¹_fe
;

1025 
	mas£¹_lše
;

1026 
	mbug_»pÜt_¡¬t
;

1027 
	mw©chdog_³riod
;

1029 
size_t
 
	msy¡em_memÜy_size
;

1032 
	spubsubP©‹º
 {

1033 
ş›Á
 *
	mş›Á
;

1034 
robj
 *
	m·‰”n
;

1035 } 
	tpubsubP©‹º
;

1037 
	t»disCommªdProc
(
	tş›Á
 *
	tc
);

1038 *
	t»disG‘KeysProc
(
	t»disCommªd
 *
	tcmd
, 
	trobj
 **
	t¬gv
, 
	t¬gc
, *
	tnumkeys
);

1039 
	s»disCommªd
 {

1040 *
	mÇme
;

1041 
»disCommªdProc
 *
	m´oc
;

1042 
	m¬™y
;

1043 *
	msæags
;

1044 
	mæags
;

1047 
»disG‘KeysProc
 *
	mg‘keys_´oc
;

1049 
	mfœ¡key
;

1050 
	mÏ¡key
;

1051 
	mkey¡•
;

1052 
	mmiüo£cÚds
, 
	mÿÎs
;

1055 
	s»disFunùiÚSym
 {

1056 *
	mÇme
;

1057 
	mpoš‹r
;

1060 
	s_»disSÜtObjeù
 {

1061 
robj
 *
	mobj
;

1063 
	mscÜe
;

1064 
robj
 *
	mcmpobj
;

1065 } 
	mu
;

1066 } 
	t»disSÜtObjeù
;

1068 
	s_»disSÜtO³¿tiÚ
 {

1069 
	mty³
;

1070 
robj
 *
	m·‰”n
;

1071 } 
	t»disSÜtO³¿tiÚ
;

1075 
robj
 *
	msubjeù
;

1076 
	m’codšg
;

1077 
	mdœeùiÚ
;

1078 
quickli¡I‹r
 *
	m™”
;

1079 } 
	tli¡Ty³I‹¿tÜ
;

1083 
li¡Ty³I‹¿tÜ
 *
	mli
;

1084 
quickli¡EÁry
 
	m’Œy
;

1085 } 
	tli¡Ty³EÁry
;

1089 
robj
 *
	msubjeù
;

1090 
	m’codšg
;

1091 
	mii
;

1092 
diùI‹¿tÜ
 *
	mdi
;

1093 } 
	t£tTy³I‹¿tÜ
;

1100 
robj
 *
	msubjeù
;

1101 
	m’codšg
;

1103 *
	måŒ
, *
	mv±r
;

1105 
diùI‹¿tÜ
 *
	mdi
;

1106 
diùEÁry
 *
	mde
;

1107 } 
	thashTy³I‹¿tÜ
;

1109 
	#OBJ_HASH_KEY
 1

	)

1110 
	#OBJ_HASH_VALUE
 2

	)

1116 
»disS”v”
 
£rv”
;

1117 
sh¬edObjeùsSŒuù
 
sh¬ed
;

1118 
diùTy³
 
£tDiùTy³
;

1119 
diùTy³
 
z£tDiùTy³
;

1120 
diùTy³
 
şu¡”NodesDiùTy³
;

1121 
diùTy³
 
şu¡”NodesBÏckLi¡DiùTy³
;

1122 
diùTy³
 
dbDiùTy³
;

1123 
diùTy³
 
shaSütObjeùDiùTy³
;

1124 
R_Z”o
, 
R_PosInf
, 
R_NegInf
, 
R_Nª
;

1125 
diùTy³
 
hashDiùTy³
;

1126 
diùTy³
 
»¶SütCacheDiùTy³
;

1133 
u¡ime
();

1134 
m¡ime
();

1135 
g‘RªdomHexCh¬s
(*
p
, 
Ën
);

1136 
ušt64_t
 
üc64
(ušt64_ˆ
üc
, cÚ¡ *
s
, ušt64_ˆ
l
);

1137 
ex™FromChd
(
»tcode
);

1138 
size_t
 
»disPİcouÁ
(*
s
, 
couÁ
);

1139 
»disS‘ProcT™Ë
(*
t™Ë
);

1142 
ş›Á
 *
ü—‹Cl›Á
(
fd
);

1143 
şo£TimedoutCl›Ás
();

1144 
ä“Cl›Á
(
ş›Á
 *
c
);

1145 
ä“Cl›ÁAsync
(
ş›Á
 *
c
);

1146 
»£tCl›Á
(
ş›Á
 *
c
);

1147 
£ndR•lyToCl›Á
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
);

1148 *
addDeã¼edMuÉiBulkL’gth
(
ş›Á
 *
c
);

1149 
£tDeã¼edMuÉiBulkL’gth
(
ş›Á
 *
c
, *
node
, 
Ëngth
);

1150 
´oûssIÅutBufãr
(
ş›Á
 *
c
);

1151 
acû±HªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
);

1152 
acû±TıHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
);

1153 
acû±UnixHªdËr
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
);

1154 
»adQu”yFromCl›Á
(
«Ev’tLoİ
 *
–
, 
fd
, *
´ivd©a
, 
mask
);

1155 
addR•lyBulk
(
ş›Á
 *
c
, 
robj
 *
obj
);

1156 
addR•lyBulkCSŒšg
(
ş›Á
 *
c
, cÚ¡ *
s
);

1157 
addR•lyBulkCBufãr
(
ş›Á
 *
c
, cÚ¡ *
p
, 
size_t
 
Ën
);

1158 
addR•lyBulkLÚgLÚg
(
ş›Á
 *
c
, 
Î
);

1159 
addR•ly
(
ş›Á
 *
c
, 
robj
 *
obj
);

1160 
addR•lySds
(
ş›Á
 *
c
, 
sds
 
s
);

1161 
addR•lyBulkSds
(
ş›Á
 *
c
, 
sds
 
s
);

1162 
addR•lyE¼Ü
(
ş›Á
 *
c
, cÚ¡ *
”r
);

1163 
addR•lyStus
(
ş›Á
 *
c
, cÚ¡ *
¡©us
);

1164 
addR•lyDoubË
(
ş›Á
 *
c
, 
d
);

1165 
addR•lyHumªLÚgDoubË
(
ş›Á
 *
c
, 
d
);

1166 
addR•lyLÚgLÚg
(
ş›Á
 *
c
, 
Î
);

1167 
addR•lyMuÉiBulkL’
(
ş›Á
 *
c
, 
Ëngth
);

1168 
cİyCl›ÁOuutBufãr
(
ş›Á
 *
d¡
, cl›Á *
¤c
);

1169 *
dupCl›ÁR•lyV®ue
(*
o
);

1170 
g‘Cl›ÁsMaxBufãrs
(*
lÚge¡_ouut_li¡
,

1171 *
bigge¡_šput_bufãr
);

1172 *
g‘Cl›ÁP“rId
(
ş›Á
 *client);

1173 
sds
 
ÿtCl›ÁInfoSŒšg
(sd 
s
, 
ş›Á
 *client);

1174 
sds
 
g‘AÎCl›ÁsInfoSŒšg
();

1175 
»wr™eCl›ÁCommªdVeùÜ
(
ş›Á
 *
c
, 
¬gc
, ...);

1176 
»wr™eCl›ÁCommªdArgum’t
(
ş›Á
 *
c
, 
i
, 
robj
 *
Ãwv®
);

1177 
»¶aûCl›ÁCommªdVeùÜ
(
ş›Á
 *
c
, 
¬gc
, 
robj
 **
¬gv
);

1178 
g‘Cl›ÁOuutBufãrMemÜyU§ge
(
ş›Á
 *
c
);

1179 
ä“Cl›ÁsInAsyncF»eQueue
();

1180 
asyncClo£Cl›ÁOnOuutBufãrLim™R—ched
(
ş›Á
 *
c
);

1181 
g‘Cl›ÁTy³
(
ş›Á
 *
c
);

1182 
g‘Cl›ÁTy³ByName
(*
Çme
);

1183 *
g‘Cl›ÁTy³Name
(
şass
);

1184 
æushSÏvesOuutBufãrs
();

1185 
discÚÃùSÏves
();

1186 
li¡’ToPÜt
(
pÜt
, *
fds
, *
couÁ
);

1187 
·u£Cl›Ás
(
m¡ime_t
 
du¿tiÚ
);

1188 
ş›ÁsA»Pau£d
();

1189 
´oûssEv’tsWheBlocked
();

1190 
hªdËCl›ÁsW™hP’dšgWr™es
();

1191 
ş›ÁHasP’dšgR•l›s
(
ş›Á
 *
c
);

1192 
uÆškCl›Á
(
ş›Á
 *
c
);

1193 
wr™eToCl›Á
(
fd
, 
ş›Á
 *
c
, 
hªdËr_š¡®Ëd
);

1195 #ifdeà
__GNUC__


1196 
	$addR•lyE¼ÜFÜm©
(
ş›Á
 *
c
, cÚ¡ *
fmt
, ...)

1197 
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 2, 3)));

1198 
	$addR•lyStusFÜm©
(
ş›Á
 *
c
, cÚ¡ *
fmt
, ...)

1199 
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 2, 3)));

1201 
	`addR•lyE¼ÜFÜm©
(
ş›Á
 *
c
, cÚ¡ *
fmt
, ...);

1202 
	`addR•lyStusFÜm©
(
ş›Á
 *
c
, cÚ¡ *
fmt
, ...);

1206 
	`li¡Ty³TryCÚv”siÚ
(
robj
 *
subjeù
,„obj *
v®ue
);

1207 
	`li¡Ty³Push
(
robj
 *
subjeù
,„obj *
v®ue
, 
wh”e
);

1208 
robj
 *
	`li¡Ty³Pİ
Ôobj *
subjeù
, 
wh”e
);

1209 
	`li¡Ty³L’gth
(
robj
 *
subjeù
);

1210 
li¡Ty³I‹¿tÜ
 *
	`li¡Ty³In™I‹¿tÜ
(
robj
 *
subjeù
, 
šdex
, 
dœeùiÚ
);

1211 
	`li¡Ty³R–—£I‹¿tÜ
(
li¡Ty³I‹¿tÜ
 *
li
);

1212 
	`li¡Ty³Next
(
li¡Ty³I‹¿tÜ
 *
li
, 
li¡Ty³EÁry
 *
’Œy
);

1213 
robj
 *
	`li¡Ty³G‘
(
li¡Ty³EÁry
 *
’Œy
);

1214 
	`li¡Ty³In£¹
(
li¡Ty³EÁry
 *
’Œy
, 
robj
 *
v®ue
, 
wh”e
);

1215 
	`li¡Ty³Equ®
(
li¡Ty³EÁry
 *
’Œy
, 
robj
 *
o
);

1216 
	`li¡Ty³D–‘e
(
li¡Ty³I‹¿tÜ
 *
™”
, 
li¡Ty³EÁry
 *
’Œy
);

1217 
	`li¡Ty³CÚv”t
(
robj
 *
subjeù
, 
’c
);

1218 
	`unblockCl›ÁWa™šgD©a
(
ş›Á
 *
c
);

1219 
	`hªdËCl›ÁsBlockedOnLi¡s
();

1220 
	`pİG’”icCommªd
(
ş›Á
 *
c
, 
wh”e
);

1221 
	`sigÇlLi¡AsR—dy
(
»disDb
 *
db
, 
robj
 *
key
);

1224 
	`unw©chAÎKeys
(
ş›Á
 *
c
);

1225 
	`š™Cl›ÁMuÉiS‹
(
ş›Á
 *
c
);

1226 
	`ä“Cl›ÁMuÉiS‹
(
ş›Á
 *
c
);

1227 
	`queueMuÉiCommªd
(
ş›Á
 *
c
);

1228 
	`touchW©chedKey
(
»disDb
 *
db
, 
robj
 *
key
);

1229 
	`touchW©chedKeysOnFlush
(
dbid
);

1230 
	`disÿrdT¿n§ùiÚ
(
ş›Á
 *
c
);

1231 
	`æagT¿n§ùiÚ
(
ş›Á
 *
c
);

1232 
	`execCommªdPrİag©eMuÉi
(
ş›Á
 *
c
);

1235 
	`deüRefCouÁ
(
robj
 *
o
);

1236 
	`deüRefCouÁVoid
(*
o
);

1237 
	`šüRefCouÁ
(
robj
 *
o
);

1238 
robj
 *
	`»£tRefCouÁ
Ôobj *
obj
);

1239 
	`ä“SŒšgObjeù
(
robj
 *
o
);

1240 
	`ä“Li¡Objeù
(
robj
 *
o
);

1241 
	`ä“S‘Objeù
(
robj
 *
o
);

1242 
	`ä“Z£tObjeù
(
robj
 *
o
);

1243 
	`ä“HashObjeù
(
robj
 *
o
);

1244 
robj
 *
	`ü—‹Objeù
(
ty³
, *
±r
);

1245 
robj
 *
	`ü—‹SŒšgObjeù
(cÚ¡ *
±r
, 
size_t
 
Ën
);

1246 
robj
 *
	`ü—‹RawSŒšgObjeù
(cÚ¡ *
±r
, 
size_t
 
Ën
);

1247 
robj
 *
	`ü—‹EmbeddedSŒšgObjeù
(cÚ¡ *
±r
, 
size_t
 
Ën
);

1248 
robj
 *
	`dupSŒšgObjeù
Ôobj *
o
);

1249 
	`isObjeùR•»£ÁabËAsLÚgLÚg
(
robj
 *
o
, *
ÎÚgv®
);

1250 
robj
 *
	`ŒyObjeùEncodšg
Ôobj *
o
);

1251 
robj
 *
	`g‘DecodedObjeù
Ôobj *
o
);

1252 
size_t
 
	`¡ršgObjeùL’
(
robj
 *
o
);

1253 
robj
 *
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
v®ue
);

1254 
robj
 *
	`ü—‹SŒšgObjeùFromLÚgDoubË
(
v®ue
, 
humªä›ndly
);

1255 
robj
 *
	`ü—‹Quickli¡Objeù
();

1256 
robj
 *
	`ü—‹Zli¡Objeù
();

1257 
robj
 *
	`ü—‹S‘Objeù
();

1258 
robj
 *
	`ü—‹IÁ£tObjeù
();

1259 
robj
 *
	`ü—‹HashObjeù
();

1260 
robj
 *
	`ü—‹Z£tObjeù
();

1261 
robj
 *
	`ü—‹Z£tZli¡Objeù
();

1262 
	`g‘LÚgFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
rg‘
, cÚ¡ *
msg
);

1263 
	`checkTy³
(
ş›Á
 *
c
, 
robj
 *
o
, 
ty³
);

1264 
	`g‘LÚgLÚgFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
rg‘
, cÚ¡ *
msg
);

1265 
	`g‘DoubËFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
rg‘
, cÚ¡ *
msg
);

1266 
	`g‘LÚgLÚgFromObjeù
(
robj
 *
o
, *
rg‘
);

1267 
	`g‘LÚgDoubËFromObjeù
(
robj
 *
o
, *
rg‘
);

1268 
	`g‘LÚgDoubËFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
rg‘
, cÚ¡ *
msg
);

1269 *
	`¡rEncodšg
(
’codšg
);

1270 
	`com·»SŒšgObjeùs
(
robj
 *
a
,„obj *
b
);

1271 
	`cŞÏ‹SŒšgObjeùs
(
robj
 *
a
,„obj *
b
);

1272 
	`equ®SŒšgObjeùs
(
robj
 *
a
,„obj *
b
);

1273 
	`e¡im©eObjeùIdËTime
(
robj
 *
o
);

1274 
	#sdsEncodedObjeù
(
obj±r
è(obj±r->
’codšg
 =ğ
OBJ_ENCODING_RAW
 || obj±r->’codšg =ğ
OBJ_ENCODING_EMBSTR
)

	)

1276 #ifdeà
USE_PMDK


1278 
	`deüRefCouÁPM
(
robj
 *
o
);

1279 
	`ä“SŒšgObjeùPM
(
robj
 *
o
);

1280 
robj
 *
	`ü—‹ObjeùPM
(
ty³
, *
±r
);

1281 
robj
 *
	`ü—‹RawSŒšgObjeùPM
(cÚ¡ *
±r
, 
size_t
 
Ën
);

1282 
robj
 *
	`dupSŒšgObjeùPM
Ôobj *
o
);

1286 
ssize_t
 
	`syncWr™e
(
fd
, *
±r
, ssize_ˆ
size
, 
timeout
);

1287 
ssize_t
 
	`syncR—d
(
fd
, *
±r
, ssize_ˆ
size
, 
timeout
);

1288 
ssize_t
 
	`syncR—dLše
(
fd
, *
±r
, ssize_ˆ
size
, 
timeout
);

1291 
	`»¶iÿtiÚF“dSÏves
(
li¡
 *
¦aves
, 
diùid
, 
robj
 **
¬gv
, 
¬gc
);

1292 
	`»¶iÿtiÚF“dMÚ™Üs
(
ş›Á
 *
c
, 
li¡
 *
mÚ™Üs
, 
diùid
, 
robj
 **
¬gv
, 
¬gc
);

1293 
	`upd©eSÏvesWa™šgBg§ve
(
bg§v“¼
, 
ty³
);

1294 
	`»¶iÿtiÚCrÚ
();

1295 
	`»¶iÿtiÚHªdËMa¡”DiscÚÃùiÚ
();

1296 
	`»¶iÿtiÚCacheMa¡”
(
ş›Á
 *
c
);

1297 
	`»sizeR•liÿtiÚBacklog
(
Ãwsize
);

1298 
	`»¶iÿtiÚS‘Ma¡”
(*

, 
pÜt
);

1299 
	`»¶iÿtiÚUn£tMa¡”
();

1300 
	`»äeshGoodSÏvesCouÁ
();

1301 
	`»¶iÿtiÚSütCacheIn™
();

1302 
	`»¶iÿtiÚSütCacheFlush
();

1303 
	`»¶iÿtiÚSütCacheAdd
(
sds
 
sha1
);

1304 
	`»¶iÿtiÚSütCacheExi¡s
(
sds
 
sha1
);

1305 
	`´oûssCl›ÁsWa™šgR•liÿs
();

1306 
	`unblockCl›ÁWa™šgR•liÿs
(
ş›Á
 *
c
);

1307 
	`»¶iÿtiÚCouÁAcksByOff£t
(
off£t
);

1308 
	`»¶iÿtiÚS’dNewlšeToMa¡”
();

1309 
	`»¶iÿtiÚG‘SÏveOff£t
();

1310 *
	`»¶iÿtiÚG‘SÏveName
(
ş›Á
 *
c
);

1311 
	`g‘PsyncIn™ŸlOff£t
();

1312 
	`»¶iÿtiÚS‘upSÏveFÜFuÎResync
(
ş›Á
 *
¦ave
, 
off£t
);

1315 
	`¡¬tLßdšg
(
FILE
 *
å
);

1316 
	`lßdšgProg»ss
(
off_t
 
pos
);

1317 
	`¡İLßdšg
();

1320 
	~"rdb.h
"

1323 
	`æushAµ’dOÆyFe
(
fÜû
);

1324 
	`ãedAµ’dOÆyFe
(
»disCommªd
 *
cmd
, 
diùid
, 
robj
 **
¬gv
, 
¬gc
);

1325 
	`aofRemoveTempFe
(
pid_t
 
chdpid
);

1326 
	`»wr™eAµ’dOÆyFeBackground
();

1327 
	`lßdAµ’dOÆyFe
(*
f’ame
);

1328 
	`¡İAµ’dOÆy
();

1329 
	`¡¬tAµ’dOÆy
();

1330 
	`backgroundRewr™eDÚeHªdËr
(
ex™code
, 
bysigÇl
);

1331 
	`aofRewr™eBufãrRe£t
();

1332 
	`aofRewr™eBufãrSize
();

1338 
mš
, 
max
;

1339 
mšex
, 
maxex
;

1340 } 
	tz¿nge¥ec
;

1344 
robj
 *
mš
, *
max
;

1345 
mšex
, 
maxex
;

1346 } 
	tzËx¿nge¥ec
;

1348 
zskli¡
 *
	`z¦C»©e
();

1349 
	`z¦F»e
(
zskli¡
 *
z¦
);

1350 
zskli¡Node
 *
	`z¦In£¹
(
zskli¡
 *
z¦
, 
scÜe
, 
robj
 *
obj
);

1351 *
	`zzlIn£¹
(*
zl
, 
robj
 *
–e
, 
scÜe
);

1352 
	`z¦D–‘e
(
zskli¡
 *
z¦
, 
scÜe
, 
robj
 *
obj
);

1353 
zskli¡Node
 *
	`z¦Fœ¡InRªge
(
zskli¡
 *
z¦
, 
z¿nge¥ec
 *
¿nge
);

1354 
zskli¡Node
 *
	`z¦La¡InRªge
(
zskli¡
 *
z¦
, 
z¿nge¥ec
 *
¿nge
);

1355 
	`zzlG‘ScÜe
(*
¥Œ
);

1356 
	`zzlNext
(*
zl
, **
•Œ
, **
¥Œ
);

1357 
	`zzlP»v
(*
zl
, **
•Œ
, **
¥Œ
);

1358 
	`z£tL’gth
(
robj
 *
zobj
);

1359 
	`z£tCÚv”t
(
robj
 *
zobj
, 
’codšg
);

1360 
	`z£tCÚv”tToZli¡IfN“ded
(
robj
 *
zobj
, 
size_t
 
max––’
);

1361 
	`z£tScÜe
(
robj
 *
zobj
,„obj *
memb”
, *
scÜe
);

1362 
	`z¦G‘Rªk
(
zskli¡
 *
z¦
, 
scÜe
, 
robj
 *
o
);

1365 
	`ä“MemÜyIfN“ded
();

1366 
	`´oûssCommªd
(
ş›Á
 *
c
);

1367 
	`£tupSigÇlHªdËrs
();

1368 
»disCommªd
 *
	`lookupCommªd
(
sds
 
Çme
);

1369 
»disCommªd
 *
	`lookupCommªdByCSŒšg
(*
s
);

1370 
»disCommªd
 *
	`lookupCommªdOrOrigš®
(
sds
 
Çme
);

1371 
	`ÿÎ
(
ş›Á
 *
c
, 
æags
);

1372 
	`´İag©e
(
»disCommªd
 *
cmd
, 
dbid
, 
robj
 **
¬gv
, 
¬gc
, 
æags
);

1373 
	`®soPrİag©e
(
»disCommªd
 *
cmd
, 
dbid
, 
robj
 **
¬gv
, 
¬gc
, 
rg‘
);

1374 
	`fÜûCommªdPrİag©iÚ
(
ş›Á
 *
c
, 
æags
);

1375 
	`´ev’tCommªdPrİag©iÚ
(
ş›Á
 *
c
);

1376 
	`´ev’tCommªdAOF
(
ş›Á
 *
c
);

1377 
	`´ev’tCommªdR•liÿtiÚ
(
ş›Á
 *
c
);

1378 
	`´•¬eFÜShutdown
();

1379 #ifdeà
__GNUC__


1380 
	$£rv”Log
(
Ëv–
, cÚ¡ *
fmt
, ...)

1381 
	`__©Œibu‹__
((
	`fÜm©
(
´štf
, 2, 3)));

1383 
	`£rv”Log
(
Ëv–
, cÚ¡ *
fmt
, ...);

1385 
	`£rv”LogRaw
(
Ëv–
, cÚ¡ *
msg
);

1386 
	`£rv”LogFromHªdËr
(
Ëv–
, cÚ¡ *
msg
);

1387 
	`u§ge
();

1388 
	`upd©eDiùResizePŞicy
();

1389 
	`htN“dsResize
(
diù
 *dict);

1390 
	`pİuÏ‹CommªdTabË
();

1391 
	`»£tCommªdTabËSts
();

1392 
	`adju¡O³nFesLim™
();

1393 
	`şo£Li¡’šgSock‘s
(
uÆšk_unix_sock‘
);

1394 
	`upd©eCachedTime
();

1395 
	`»£tS”v”Sts
();

1396 
	`g‘LRUClock
();

1397 cÚ¡ *
	`eviùPŞicyToSŒšg
();

1399 
	#RESTART_SERVER_NONE
 0

	)

1400 
	#RESTART_SERVER_GRACEFULLY
 (1<<0è

	)

1401 
	#RESTART_SERVER_CONFIG_REWRITE
 (1<<1è

	)

1402 
	`»¡¬tS”v”
(
æags
, 
m¡ime_t
 
d–ay
);

1405 
robj
 *
	`£tTy³C»©e
Ôobj *
v®ue
);

1406 
	`£tTy³Add
(
robj
 *
subjeù
,„obj *
v®ue
);

1407 
	`£tTy³Remove
(
robj
 *
subjeù
,„obj *
v®ue
);

1408 
	`£tTy³IsMemb”
(
robj
 *
subjeù
,„obj *
v®ue
);

1409 
£tTy³I‹¿tÜ
 *
	`£tTy³In™I‹¿tÜ
(
robj
 *
subjeù
);

1410 
	`£tTy³R–—£I‹¿tÜ
(
£tTy³I‹¿tÜ
 *
si
);

1411 
	`£tTy³Next
(
£tTy³I‹¿tÜ
 *
si
, 
robj
 **
obj–e
, 
št64_t
 *
Î–e
);

1412 
robj
 *
	`£tTy³NextObjeù
(
£tTy³I‹¿tÜ
 *
si
);

1413 
	`£tTy³RªdomEËm’t
(
robj
 *
£tobj
,„obj **
obj–e
, 
št64_t
 *
Î–e
);

1414 
	`£tTy³RªdomEËm’ts
(
robj
 *
£t
, 
couÁ
,„obj *
aux_£t
);

1415 
	`£tTy³Size
(
robj
 *
subjeù
);

1416 
	`£tTy³CÚv”t
(
robj
 *
subjeù
, 
’c
);

1419 
	`hashTy³CÚv”t
(
robj
 *
o
, 
’c
);

1420 
	`hashTy³TryCÚv”siÚ
(
robj
 *
subjeù
,„obj **
¬gv
, 
¡¬t
, 
’d
);

1421 
	`hashTy³TryObjeùEncodšg
(
robj
 *
subjeù
,„obj **
o1
,„obj **
o2
);

1422 
robj
 *
	`hashTy³G‘Objeù
Ôobj *
o
,„obj *
key
);

1423 
	`hashTy³Exi¡s
(
robj
 *
o
,„obj *
key
);

1424 
	`hashTy³S‘
(
robj
 *
o
,„obj *
key
,„obj *
v®ue
);

1425 
	`hashTy³D–‘e
(
robj
 *
o
,„obj *
key
);

1426 
	`hashTy³L’gth
(
robj
 *
o
);

1427 
hashTy³I‹¿tÜ
 *
	`hashTy³In™I‹¿tÜ
(
robj
 *
subjeù
);

1428 
	`hashTy³R–—£I‹¿tÜ
(
hashTy³I‹¿tÜ
 *
hi
);

1429 
	`hashTy³Next
(
hashTy³I‹¿tÜ
 *
hi
);

1430 
	`hashTy³Cu¼’tFromZli¡
(
hashTy³I‹¿tÜ
 *
hi
, 
wh©
,

1431 **
v¡r
,

1432 *
vËn
,

1433 *
vÎ
);

1434 
	`hashTy³Cu¼’tFromHashTabË
(
hashTy³I‹¿tÜ
 *
hi
, 
wh©
, 
robj
 **
d¡
);

1435 
robj
 *
	`hashTy³Cu¼’tObjeù
(
hashTy³I‹¿tÜ
 *
hi
, 
wh©
);

1436 
robj
 *
	`hashTy³LookupWr™eOrC»©e
(
ş›Á
 *
c
,„obj *
key
);

1439 
	`pubsubUnsubsüibeAÎChªÃls
(
ş›Á
 *
c
, 
nÙify
);

1440 
	`pubsubUnsubsüibeAÎP©‹ºs
(
ş›Á
 *
c
, 
nÙify
);

1441 
	`ä“PubsubP©‹º
(*
p
);

1442 
	`li¡M©chPubsubP©‹º
(*
a
, *
b
);

1443 
	`pubsubPublishMes§ge
(
robj
 *
chªÃl
,„obj *
mes§ge
);

1446 
	`nÙifyKey¥aûEv’t
(
ty³
, *
ev’t
, 
robj
 *
key
, 
dbid
);

1447 
	`key¥aûEv’tsSŒšgToFÏgs
(*
şas£s
);

1448 
sds
 
	`key¥aûEv’tsFÏgsToSŒšg
(
æags
);

1451 
	`lßdS”v”CÚfig
(*
f’ame
, *
İtiÚs
);

1452 
	`­³ndS”v”SaveP¬ams
(
time_t
 
£cÚds
, 
chªges
);

1453 
	`»£tS”v”SaveP¬ams
();

1454 
»wr™eCÚfigS‹
;

1455 
	`»wr™eCÚfigRewr™eLše
(
»wr™eCÚfigS‹
 *
¡©e
, cÚ¡ *
İtiÚ
, 
sds
 
lše
, 
fÜû
);

1456 
	`»wr™eCÚfig
(*
·th
);

1459 
	`»moveExpœe
(
»disDb
 *
db
, 
robj
 *
key
);

1460 
	`´İag©eExpœe
(
»disDb
 *
db
, 
robj
 *
key
);

1461 
	`expœeIfN“ded
(
»disDb
 *
db
, 
robj
 *
key
);

1462 
	`g‘Expœe
(
»disDb
 *
db
, 
robj
 *
key
);

1463 
	`£tExpœe
(
»disDb
 *
db
, 
robj
 *
key
, 
wh’
);

1464 
robj
 *
	`lookupKey
(
»disDb
 *
db
,„obj *
key
, 
æags
);

1465 
robj
 *
	`lookupKeyR—d
(
»disDb
 *
db
,„obj *
key
);

1466 
robj
 *
	`lookupKeyWr™e
(
»disDb
 *
db
,„obj *
key
);

1467 
robj
 *
	`lookupKeyR—dOrR•ly
(
ş›Á
 *
c
,„obj *
key
,„obj *
»¶y
);

1468 
robj
 *
	`lookupKeyWr™eOrR•ly
(
ş›Á
 *
c
,„obj *
key
,„obj *
»¶y
);

1469 
robj
 *
	`lookupKeyR—dW™hFÏgs
(
»disDb
 *
db
,„obj *
key
, 
æags
);

1470 
	#LOOKUP_NONE
 0

	)

1471 
	#LOOKUP_NOTOUCH
 (1<<0)

	)

1472 
	`dbAdd
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
);

1473 
	`dbAddPM
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
);

1474 
	`dbOv”wr™e
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
);

1475 
	`dbOv”wr™ePM
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
);

1476 
	`£tKey
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
);

1477 
	`£tKeyPM
(
»disDb
 *
db
, 
robj
 *
key
,„obj *
v®
);

1478 
	`dbExi¡s
(
»disDb
 *
db
, 
robj
 *
key
);

1479 
robj
 *
	`dbRªdomKey
(
»disDb
 *
db
);

1480 
	`dbD–‘e
(
»disDb
 *
db
, 
robj
 *
key
);

1481 
robj
 *
	`dbUnsh¬eSŒšgV®ue
(
»disDb
 *
db
,„obj *
key
,„obj *
o
);

1482 
	`em±yDb
((
ÿÎback
)(*));

1483 
	`£ËùDb
(
ş›Á
 *
c
, 
id
);

1484 
	`sigÇlModif›dKey
(
»disDb
 *
db
, 
robj
 *
key
);

1485 
	`sigÇlFlushedDb
(
dbid
);

1486 
	`g‘KeysInSlÙ
(
hash¦Ù
, 
robj
 **
keys
, 
couÁ
);

1487 
	`couÁKeysInSlÙ
(
hash¦Ù
);

1488 
	`d–KeysInSlÙ
(
hash¦Ù
);

1489 
	`v”ifyClu¡”CÚfigW™hD©a
();

1490 
	`sÿnG’”icCommªd
(
ş›Á
 *
c
, 
robj
 *
o
, 
cursÜ
);

1491 
	`·r£SÿnCursÜOrR•ly
(
ş›Á
 *
c
, 
robj
 *
o
, *
cursÜ
);

1494 *
	`g‘KeysFromCommªd
(
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
numkeys
);

1495 
	`g‘KeysF»eResuÉ
(*
»suÉ
);

1496 *
	`zuniÚIÁ”G‘Keys
(
»disCommªd
 *
cmd
,
robj
 **
¬gv
, 
¬gc
, *
numkeys
);

1497 *
	`ev®G‘Keys
(
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
numkeys
);

1498 *
	`sÜtG‘Keys
(
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
numkeys
);

1499 *
	`mig¿‹G‘Keys
(
»disCommªd
 *
cmd
, 
robj
 **
¬gv
, 
¬gc
, *
numkeys
);

1502 
	`şu¡”In™
();

1503 
	`üc16
(cÚ¡ *
buf
, 
Ën
);

1504 
	`keyHashSlÙ
(*
key
, 
keyËn
);

1505 
	`şu¡”CrÚ
();

1506 
	`şu¡”Prİag©ePublish
(
robj
 *
chªÃl
,„obj *
mes§ge
);

1507 
	`mig¿‹Clo£TimedoutSock‘s
();

1508 
	`şu¡”BefÜeSË•
();

1511 
	`š™S’tš–CÚfig
();

1512 
	`š™S’tš–
();

1513 
	`£Áš–Tim”
();

1514 *
	`£Áš–HªdËCÚfigu¿tiÚ
(**
¬gv
, 
¬gc
);

1515 
	`£Áš–IsRuÂšg
();

1518 
	`»dis_check_rdb
(*
rdbf’ame
);

1519 
	`»dis_check_rdb_maš
(
¬gc
, **
¬gv
);

1522 
	`sütšgIn™
(
£tup
);

1523 
	`ldbRemoveChd
(
pid_t
 
pid
);

1524 
	`ldbKlFÜkedSessiÚs
();

1525 
	`ldbP’dšgChd»n
();

1528 
	`´oûssUnblockedCl›Ás
();

1529 
	`blockCl›Á
(
ş›Á
 *
c
, 
bty³
);

1530 
	`unblockCl›Á
(
ş›Á
 *
c
);

1531 
	`»¶yToBlockedCl›ÁTimedOut
(
ş›Á
 *
c
);

1532 
	`g‘TimeoutFromObjeùOrR•ly
(
ş›Á
 *
c
, 
robj
 *
objeù
, 
m¡ime_t
 *
timeout
, 
un™
);

1533 
	`discÚÃùAÎBlockedCl›Ás
();

1536 *
	`»disG™SHA1
();

1537 *
	`»disG™Dœty
();

1538 
ušt64_t
 
	`»disBudId
();

1541 
	`authCommªd
(
ş›Á
 *
c
);

1542 
	`pšgCommªd
(
ş›Á
 *
c
);

1543 
	`echoCommªd
(
ş›Á
 *
c
);

1544 
	`commªdCommªd
(
ş›Á
 *
c
);

1545 
	`£tCommªd
(
ş›Á
 *
c
);

1546 
	`£ŠxCommªd
(
ş›Á
 *
c
);

1547 
	`£‹xCommªd
(
ş›Á
 *
c
);

1548 
	`p£‹xCommªd
(
ş›Á
 *
c
);

1549 
	`g‘Commªd
(
ş›Á
 *
c
);

1550 
	`d–Commªd
(
ş›Á
 *
c
);

1551 
	`exi¡sCommªd
(
ş›Á
 *
c
);

1552 
	`£tb™Commªd
(
ş›Á
 *
c
);

1553 
	`g‘b™Commªd
(
ş›Á
 *
c
);

1554 
	`b™f›ldCommªd
(
ş›Á
 *
c
);

1555 
	`£ŒªgeCommªd
(
ş›Á
 *
c
);

1556 
	`g‘¿ngeCommªd
(
ş›Á
 *
c
);

1557 
	`šüCommªd
(
ş›Á
 *
c
);

1558 
	`deüCommªd
(
ş›Á
 *
c
);

1559 
	`šübyCommªd
(
ş›Á
 *
c
);

1560 
	`deübyCommªd
(
ş›Á
 *
c
);

1561 
	`šübyæßtCommªd
(
ş›Á
 *
c
);

1562 
	`£ËùCommªd
(
ş›Á
 *
c
);

1563 
	`¿ndomkeyCommªd
(
ş›Á
 *
c
);

1564 
	`keysCommªd
(
ş›Á
 *
c
);

1565 
	`sÿnCommªd
(
ş›Á
 *
c
);

1566 
	`dbsizeCommªd
(
ş›Á
 *
c
);

1567 
	`Ï¡§veCommªd
(
ş›Á
 *
c
);

1568 
	`§veCommªd
(
ş›Á
 *
c
);

1569 
	`bg§veCommªd
(
ş›Á
 *
c
);

1570 
	`bg»wr™—ofCommªd
(
ş›Á
 *
c
);

1571 
	`shutdownCommªd
(
ş›Á
 *
c
);

1572 
	`moveCommªd
(
ş›Á
 *
c
);

1573 
	`»ÇmeCommªd
(
ş›Á
 *
c
);

1574 
	`»Çm’xCommªd
(
ş›Á
 *
c
);

1575 
	`ÍushCommªd
(
ş›Á
 *
c
);

1576 
	`½ushCommªd
(
ş›Á
 *
c
);

1577 
	`ÍushxCommªd
(
ş›Á
 *
c
);

1578 
	`½ushxCommªd
(
ş›Á
 *
c
);

1579 
	`lš£¹Commªd
(
ş›Á
 *
c
);

1580 
	`ÍİCommªd
(
ş›Á
 *
c
);

1581 
	`½İCommªd
(
ş›Á
 *
c
);

1582 
	`Î’Commªd
(
ş›Á
 *
c
);

1583 
	`lšdexCommªd
(
ş›Á
 *
c
);

1584 
	`ÌªgeCommªd
(
ş›Á
 *
c
);

1585 
	`ÉrimCommªd
(
ş›Á
 *
c
);

1586 
	`ty³Commªd
(
ş›Á
 *
c
);

1587 
	`l£tCommªd
(
ş›Á
 *
c
);

1588 
	`§ddCommªd
(
ş›Á
 *
c
);

1589 
	`¤emCommªd
(
ş›Á
 *
c
);

1590 
	`smoveCommªd
(
ş›Á
 *
c
);

1591 
	`sismemb”Commªd
(
ş›Á
 *
c
);

1592 
	`sÿrdCommªd
(
ş›Á
 *
c
);

1593 
	`¥İCommªd
(
ş›Á
 *
c
);

1594 
	`¤ªdmemb”Commªd
(
ş›Á
 *
c
);

1595 
	`sš‹rCommªd
(
ş›Á
 *
c
);

1596 
	`sš‹r¡ÜeCommªd
(
ş›Á
 *
c
);

1597 
	`suniÚCommªd
(
ş›Á
 *
c
);

1598 
	`suniÚ¡ÜeCommªd
(
ş›Á
 *
c
);

1599 
	`sdiffCommªd
(
ş›Á
 *
c
);

1600 
	`sdiff¡ÜeCommªd
(
ş›Á
 *
c
);

1601 
	`ssÿnCommªd
(
ş›Á
 *
c
);

1602 
	`syncCommªd
(
ş›Á
 *
c
);

1603 
	`æushdbCommªd
(
ş›Á
 *
c
);

1604 
	`æush®lCommªd
(
ş›Á
 *
c
);

1605 
	`sÜtCommªd
(
ş›Á
 *
c
);

1606 
	`ÌemCommªd
(
ş›Á
 *
c
);

1607 
	`½İÍushCommªd
(
ş›Á
 *
c
);

1608 
	`šfoCommªd
(
ş›Á
 *
c
);

1609 
	`mg‘Commªd
(
ş›Á
 *
c
);

1610 
	`mÚ™ÜCommªd
(
ş›Á
 *
c
);

1611 
	`expœeCommªd
(
ş›Á
 *
c
);

1612 
	`expœ—tCommªd
(
ş›Á
 *
c
);

1613 
	`³xpœeCommªd
(
ş›Á
 *
c
);

1614 
	`³xpœ—tCommªd
(
ş›Á
 *
c
);

1615 
	`g‘£tCommªd
(
ş›Á
 *
c
);

1616 
	`‰lCommªd
(
ş›Á
 *
c
);

1617 
	`touchCommªd
(
ş›Á
 *
c
);

1618 
	`±Commªd
(
ş›Á
 *
c
);

1619 
	`³rsi¡Commªd
(
ş›Á
 *
c
);

1620 
	`¦aveofCommªd
(
ş›Á
 *
c
);

1621 
	`rŞeCommªd
(
ş›Á
 *
c
);

1622 
	`debugCommªd
(
ş›Á
 *
c
);

1623 
	`m£tCommªd
(
ş›Á
 *
c
);

1624 
	`m£ŠxCommªd
(
ş›Á
 *
c
);

1625 
	`zaddCommªd
(
ş›Á
 *
c
);

1626 
	`zšübyCommªd
(
ş›Á
 *
c
);

1627 
	`z¿ngeCommªd
(
ş›Á
 *
c
);

1628 
	`z¿ngebyscÜeCommªd
(
ş›Á
 *
c
);

1629 
	`z»v¿ngebyscÜeCommªd
(
ş›Á
 *
c
);

1630 
	`z¿ngebyËxCommªd
(
ş›Á
 *
c
);

1631 
	`z»v¿ngebyËxCommªd
(
ş›Á
 *
c
);

1632 
	`zcouÁCommªd
(
ş›Á
 *
c
);

1633 
	`zËxcouÁCommªd
(
ş›Á
 *
c
);

1634 
	`z»v¿ngeCommªd
(
ş›Á
 *
c
);

1635 
	`zÿrdCommªd
(
ş›Á
 *
c
);

1636 
	`z»mCommªd
(
ş›Á
 *
c
);

1637 
	`zscÜeCommªd
(
ş›Á
 *
c
);

1638 
	`z»m¿ngebyscÜeCommªd
(
ş›Á
 *
c
);

1639 
	`z»m¿ngebyËxCommªd
(
ş›Á
 *
c
);

1640 
	`muÉiCommªd
(
ş›Á
 *
c
);

1641 
	`execCommªd
(
ş›Á
 *
c
);

1642 
	`disÿrdCommªd
(
ş›Á
 *
c
);

1643 
	`bÍİCommªd
(
ş›Á
 *
c
);

1644 
	`b½İCommªd
(
ş›Á
 *
c
);

1645 
	`b½İÍushCommªd
(
ş›Á
 *
c
);

1646 
	`­³ndCommªd
(
ş›Á
 *
c
);

1647 
	`¡¾’Commªd
(
ş›Á
 *
c
);

1648 
	`z¿nkCommªd
(
ş›Á
 *
c
);

1649 
	`z»v¿nkCommªd
(
ş›Á
 *
c
);

1650 
	`h£tCommªd
(
ş›Á
 *
c
);

1651 
	`h£ŠxCommªd
(
ş›Á
 *
c
);

1652 
	`hg‘Commªd
(
ş›Á
 *
c
);

1653 
	`hm£tCommªd
(
ş›Á
 *
c
);

1654 
	`hmg‘Commªd
(
ş›Á
 *
c
);

1655 
	`hd–Commªd
(
ş›Á
 *
c
);

1656 
	`hËnCommªd
(
ş›Á
 *
c
);

1657 
	`h¡¾’Commªd
(
ş›Á
 *
c
);

1658 
	`z»m¿ngeby¿nkCommªd
(
ş›Á
 *
c
);

1659 
	`zuniÚ¡ÜeCommªd
(
ş›Á
 *
c
);

1660 
	`zš‹r¡ÜeCommªd
(
ş›Á
 *
c
);

1661 
	`zsÿnCommªd
(
ş›Á
 *
c
);

1662 
	`hkeysCommªd
(
ş›Á
 *
c
);

1663 
	`hv®sCommªd
(
ş›Á
 *
c
);

1664 
	`hg‘®lCommªd
(
ş›Á
 *
c
);

1665 
	`hexi¡sCommªd
(
ş›Á
 *
c
);

1666 
	`hsÿnCommªd
(
ş›Á
 *
c
);

1667 
	`cÚfigCommªd
(
ş›Á
 *
c
);

1668 
	`hšübyCommªd
(
ş›Á
 *
c
);

1669 
	`hšübyæßtCommªd
(
ş›Á
 *
c
);

1670 
	`subsüibeCommªd
(
ş›Á
 *
c
);

1671 
	`unsubsüibeCommªd
(
ş›Á
 *
c
);

1672 
	`psubsüibeCommªd
(
ş›Á
 *
c
);

1673 
	`punsubsüibeCommªd
(
ş›Á
 *
c
);

1674 
	`publishCommªd
(
ş›Á
 *
c
);

1675 
	`pubsubCommªd
(
ş›Á
 *
c
);

1676 
	`w©chCommªd
(
ş›Á
 *
c
);

1677 
	`unw©chCommªd
(
ş›Á
 *
c
);

1678 
	`şu¡”Commªd
(
ş›Á
 *
c
);

1679 
	`»¡ÜeCommªd
(
ş›Á
 *
c
);

1680 
	`mig¿‹Commªd
(
ş›Á
 *
c
);

1681 
	`askšgCommªd
(
ş›Á
 *
c
);

1682 
	`»adÚlyCommªd
(
ş›Á
 *
c
);

1683 
	`»adwr™eCommªd
(
ş›Á
 *
c
);

1684 
	`dumpCommªd
(
ş›Á
 *
c
);

1685 
	`objeùCommªd
(
ş›Á
 *
c
);

1686 
	`ş›ÁCommªd
(
ş›Á
 *
c
);

1687 
	`ev®Commªd
(
ş›Á
 *
c
);

1688 
	`ev®ShaCommªd
(
ş›Á
 *
c
);

1689 
	`sütCommªd
(
ş›Á
 *
c
);

1690 
	`timeCommªd
(
ş›Á
 *
c
);

1691 
	`b™İCommªd
(
ş›Á
 *
c
);

1692 
	`b™couÁCommªd
(
ş›Á
 *
c
);

1693 
	`b™posCommªd
(
ş›Á
 *
c
);

1694 
	`»¶cÚfCommªd
(
ş›Á
 *
c
);

1695 
	`wa™Commªd
(
ş›Á
 *
c
);

1696 
	`geÛncodeCommªd
(
ş›Á
 *
c
);

1697 
	`geodecodeCommªd
(
ş›Á
 *
c
);

1698 
	`geÜadiusByMemb”Commªd
(
ş›Á
 *
c
);

1699 
	`geÜadiusCommªd
(
ş›Á
 *
c
);

1700 
	`geßddCommªd
(
ş›Á
 *
c
);

1701 
	`geohashCommªd
(
ş›Á
 *
c
);

1702 
	`geİosCommªd
(
ş›Á
 *
c
);

1703 
	`geodi¡Commªd
(
ş›Á
 *
c
);

1704 
	`pf£láe¡Commªd
(
ş›Á
 *
c
);

1705 
	`pçddCommªd
(
ş›Á
 *
c
);

1706 
	`pfcouÁCommªd
(
ş›Á
 *
c
);

1707 
	`pfm”geCommªd
(
ş›Á
 *
c
);

1708 
	`pfdebugCommªd
(
ş›Á
 *
c
);

1709 
	`Ï‹ncyCommªd
(
ş›Á
 *
c
);

1710 
	`£cur™yW¬nšgCommªd
(
ş›Á
 *
c
);

1712 #ià
	`defšed
(
__GNUC__
)

1713 *
	$ÿÎoc
(
size_t
 
couÁ
, size_ˆ
size
è
	`__©Œibu‹__
 ((
d•»ÿ‹d
));

1714 
	$ä“
(*
±r
è
	`__©Œibu‹__
 ((
d•»ÿ‹d
));

1715 *
	$m®loc
(
size_t
 
size
è
	`__©Œibu‹__
 ((
d•»ÿ‹d
));

1716 *
	$»®loc
(*
±r
, 
size_t
 
size
è
	`__©Œibu‹__
 ((
d•»ÿ‹d
));

1720 
	`_£rv”As£¹W™hInfo
(
ş›Á
 *
c
, 
robj
 *
o
, *
e¡r
, *
fe
, 
lše
);

1721 
	`_£rv”As£¹
(*
e¡r
, *
fe
, 
lše
);

1722 
	`_£rv”Pªic
(*
msg
, *
fe
, 
lše
);

1723 
	`bugR•ÜtS¹
();

1724 
	`£rv”LogObjeùDebugInfo
(
robj
 *
o
);

1725 
	`sig£gvHªdËr
(
sig
, 
sigšfo_t
 *
šfo
, *
£ü‘
);

1726 
sds
 
	`g’RedisInfoSŒšg
(*
£ùiÚ
);

1727 
	`’abËW©chdog
(
³riod
);

1728 
	`di§bËW©chdog
();

1729 
	`w©chdogScheduËSigÇl
(
³riod
);

1730 
	`£rv”LogHexDump
(
Ëv–
, *
desü
, *
v®ue
, 
size_t
 
Ën
);

1731 
	`mem‹¡_´e£rvšg_‹¡
(*
m
, 
size_t
 
by‹s
, 
·s£s
);

1733 
	#»disDebug
(
fmt
, ...) \

1734 
	`´štf
("DEBUG %s:%d > " 
fmt
 "\n", 
__FILE__
, 
__LINE__
, 
__VA_ARGS__
)

	)

1735 
	#»disDebugM¬k
() \

1736 
	`´štf
("-- MARK %s:%d --\n", 
__FILE__
, 
__LINE__
)

	)

	@src/setproctitle.c

28 #iâdeà
_GNU_SOURCE


29 
	#_GNU_SOURCE


	)

32 
	~<¡ddef.h
>

33 
	~<¡d¬g.h
>

34 
	~<¡dlib.h
>

35 
	~<¡dio.h
>

37 
	~<¡ršg.h
>

39 
	~<”ºo.h
>

41 #ià!
defšed
(
HAVE_SETPROCTITLE
)

42 
	#HAVE_SETPROCTITLE
 (
defšed
 
__N‘BSD__
 || defšed 
__F»eBSD__
 || defšed 
__O³nBSD__
)

	)

46 #ià!
HAVE_SETPROCTITLE


47 #ià(
defšed
 
__lšux
 || defšed 
__APPLE__
)

49 **
’vœÚ
;

53 cÚ¡ *
	m¬g0
;

56 *
	mba£
, *
	m’d
;

59 *
	mnul
;

61 
_BoŞ
 
	m»£t
;

62 
	m”rÜ
;

63 } 
	gSPT
;

66 #iâdeà
SPT_MIN


67 
	#SPT_MIN
(
a
, 
b
è((×è< (b))? (aè: (b))

	)

70 
šlše
 
size_t
 
	$¥t_mš
(
size_t
 
a
, size_ˆ
b
) {

71  
	`SPT_MIN
(
a
, 
b
);

72 
	}
}

79 
	$¥t_ş—»nv
() {

80 #ià
__GLIBC__


81 
	`ş—»nv
();

85 **
’vœÚ
;

86 **
tmp
;

88 ià(!(
tmp
 = 
	`m®loc
( *tmp)))

89  
”ºo
;

91 
tmp
[0] = 
NULL
;

92 
’vœÚ
 = 
tmp
;

96 
	}
}

99 
	$¥t_cİy’v
(*
Şd’v
[]) {

100 **
’vœÚ
;

101 *
eq
;

102 
i
, 
”rÜ
;

104 ià(
’vœÚ
 !ğ
Şd’v
)

107 ià((
”rÜ
 = 
	`¥t_ş—»nv
()))

108 
”rÜ
;

110 
i
 = 0; 
Şd’v
[i]; i++) {

111 ià(!(
eq
 = 
	`¡rchr
(
Şd’v
[
i
], '=')))

114 *
eq
 = '\0';

115 
”rÜ
 = (0 !ğ
	`£‹nv
(
Şd’v
[
i
], 
eq
 + 1, 1))? 
”ºo
 : 0;

116 *
eq
 = '=';

118 ià(
”rÜ
)

119 
”rÜ
;

123 
”rÜ
:

124 
’vœÚ
 = 
Şd’v
;

126  
”rÜ
;

127 
	}
}

130 
	$¥t_cİy¬gs
(
¬gc
, *
¬gv
[]) {

131 *
tmp
;

132 
i
;

134 
i
 = 1; i < 
¬gc
 || (˜>ğ¬gø&& 
¬gv
[i]); i++) {

135 ià(!
¬gv
[
i
])

138 ià(!(
tmp
 = 
	`¡rdup
(
¬gv
[
i
])))

139  
”ºo
;

141 
¬gv
[
i
] = 
tmp
;

145 
	}
}

148 
	$¥t_š™
(
¬gc
, *
¬gv
[]) {

149 **
’vp
 = 
’vœÚ
;

150 *
ba£
, *
’d
, *
nul
, *
tmp
;

151 
i
, 
”rÜ
;

153 ià(!(
ba£
 = 
¬gv
[0]))

156 
nul
 = &
ba£
[
	`¡¾’
(base)];

157 
’d
 = 
nul
 + 1;

159 
i
 = 0; i < 
¬gc
 || (˜>ğ¬gø&& 
¬gv
[i]); i++) {

160 ià(!
¬gv
[
i
] ||‡rgv[i] < 
’d
)

163 
’d
 = 
¬gv
[
i
] + 
	`¡¾’
(argv[i]) + 1;

166 
i
 = 0; 
’vp
[i]; i++) {

167 ià(
’vp
[
i
] < 
’d
)

170 
’d
 = 
’vp
[
i
] + 
	`¡¾’
(envp[i]) + 1;

173 ià(!(
SPT
.
¬g0
 = 
	`¡rdup
(
¬gv
[0])))

174 
sy”r
;

176 #ià
__GLIBC__


177 ià(!(
tmp
 = 
	`¡rdup
(
´og¿m_švoÿtiÚ_Çme
)))

178 
sy”r
;

180 
´og¿m_švoÿtiÚ_Çme
 = 
tmp
;

182 ià(!(
tmp
 = 
	`¡rdup
(
´og¿m_švoÿtiÚ_shÜt_Çme
)))

183 
sy”r
;

185 
´og¿m_švoÿtiÚ_shÜt_Çme
 = 
tmp
;

186 #–ià
__APPLE__


187 ià(!(
tmp
 = 
	`¡rdup
(
	`g‘´ogÇme
())))

188 
sy”r
;

190 
	`£rogÇme
(
tmp
);

194 ià((
”rÜ
 = 
	`¥t_cİy’v
(
’vp
)))

195 
”rÜ
;

197 ià((
”rÜ
 = 
	`¥t_cİy¬gs
(
¬gc
, 
¬gv
)))

198 
”rÜ
;

200 
SPT
.
nul
 =‚ul;

201 
SPT
.
ba£
 = base;

202 
SPT
.
’d
 =ƒnd;

205 
sy”r
:

206 
”rÜ
 = 
”ºo
;

207 
”rÜ
:

208 
SPT
.
”rÜ
 =ƒrror;

209 
	}
}

212 #iâdeà
SPT_MAXTITLE


213 
	#SPT_MAXTITLE
 255

	)

216 
	$£roù™Ë
(cÚ¡ *
fmt
, ...) {

217 
buf
[
SPT_MAXTITLE
 + 1];

218 
va_li¡
 
­
;

219 *
nul
;

220 
Ën
, 
”rÜ
;

222 ià(!
SPT
.
ba£
)

225 ià(
fmt
) {

226 
	`va_¡¬t
(
­
, 
fmt
);

227 
Ën
 = 
	`v¢´štf
(
buf
,  buf, 
fmt
, 
­
);

228 
	`va_’d
(
­
);

230 
Ën
 = 
	`¢´štf
(
buf
,  buf, "%s", 
SPT
.
¬g0
);

233 ià(
Ën
 <= 0)

234 { 
”rÜ
 = 
”ºo
; error; }

236 ià(!
SPT
.
»£t
) {

237 
	`mem£t
(
SPT
.
ba£
, 0, SPT.
’d
 - SPT.base);

238 
SPT
.
»£t
 = 1;

240 
	`mem£t
(
SPT
.
ba£
, 0, 
	`¥t_mš
( 
buf
, SPT.
’d
 - SPT.base));

243 
Ën
 = 
	`¥t_mš
Ö’, s±_mš( 
buf
, 
SPT
.
’d
 - SPT.
ba£
) - 1);

244 
	`memıy
(
SPT
.
ba£
, 
buf
, 
Ën
);

245 
nul
 = &
SPT
.
ba£
[
Ën
];

247 ià(
nul
 < 
SPT
.nul) {

248 *
SPT
.
nul
 = '.';

249 } ià(
nul
 =ğ
SPT
.nuÈ&& &nul[1] < SPT.
’d
) {

250 *
SPT
.
nul
 = ' ';

251 *++
nul
 = '\0';

255 
”rÜ
:

256 
SPT
.
”rÜ
 =ƒrror;

257 
	}
}

	@src/sha1.c

22 
	#SHA1HANDSOFF


	)

24 
	~<¡dio.h
>

25 
	~<¡ršg.h
>

26 
	~<¡dšt.h
>

27 
	~"sŞ¬isfixes.h
"

28 
	~"sha1.h
"

29 
	~"cÚfig.h
"

31 
	#rŞ
(
v®ue
, 
b™s
è(((v®ueè<< (b™s)è| ((v®ueè>> (32 - (b™s))))

	)

35 #ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN


36 
	#blk0
(
i
è(
block
->
l
[i] = (
	`rŞ
(block->l[i],24)&0xFF00FF00) \

37 |(
	`rŞ
(
block
->
l
[
i
],8)&0x00FF00FF))

	)

38 #–ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


39 
	#blk0
(
i
è
block
->
l
[i]

	)

43 
	#blk
(
i
è(
block
->
l
[i&15] = 
	`rŞ
(block->l[(i+13)&15]^block->l[(i+8)&15] \

44 ^
block
->
l
[(
i
+2)&15]^block->l[i&15],1))

	)

47 
	#R0
(
v
,
w
,
x
,
y
,
z
,
i
èz+=((w&(x^y))^y)+
	`blk0
(i)+0x5A827999+
	`rŞ
(v,5);wôŞ(w,30);

	)

48 
	#R1
(
v
,
w
,
x
,
y
,
z
,
i
èz+=((w&(x^y))^y)+
	`blk
(i)+0x5A827999+
	`rŞ
(v,5);wôŞ(w,30);

	)

49 
	#R2
(
v
,
w
,
x
,
y
,
z
,
i
èz+=(w^x^y)+
	`blk
(i)+0x6ED9EBA1+
	`rŞ
(v,5);wôŞ(w,30);

	)

50 
	#R3
(
v
,
w
,
x
,
y
,
z
,
i
èz+=(((w|x)&y)|(w&x))+
	`blk
(i)+0x8F1BBCDC+
	`rŞ
(v,5);wôŞ(w,30);

	)

51 
	#R4
(
v
,
w
,
x
,
y
,
z
,
i
èz+=(w^x^y)+
	`blk
(i)+0xCA62C1D6+
	`rŞ
(v,5);wôŞ(w,30);

	)

56 
	$SHA1T¿nsfÜm
(
ušt32_t
 
¡©e
[5], cÚ¡ 
bufãr
[64])

58 
ušt32_t
 
a
, 
b
, 
c
, 
d
, 
e
;

60 
c
[64];

61 
ušt32_t
 
l
[16];

62 } 
	tCHAR64LONG16
;

63 #ifdeà
SHA1HANDSOFF


64 
CHAR64LONG16
 
block
[1];

65 
	`memıy
(
block
, 
bufãr
, 64);

72 
CHAR64LONG16
* 
block
 = (cÚ¡ CHAR64LONG16*)
bufãr
;

75 
a
 = 
¡©e
[0];

76 
b
 = 
¡©e
[1];

77 
c
 = 
¡©e
[2];

78 
d
 = 
¡©e
[3];

79 
e
 = 
¡©e
[4];

81 
	`R0
(
a
,
b
,
c
,
d
,
e
, 0); R0(e,a,b,c,d, 1); R0(d,e,a,b,c, 2); R0(c,d,e,a,b, 3);

82 
	`R0
(
b
,
c
,
d
,
e
,
a
, 4); R0(a,b,c,d,e, 5); R0(e,a,b,c,d, 6); R0(d,e,a,b,c, 7);

83 
	`R0
(
c
,
d
,
e
,
a
,
b
, 8); R0(b,c,d,e,a, 9); R0(a,b,c,d,e,10); R0(e,a,b,c,d,11);

84 
	`R0
(
d
,
e
,
a
,
b
,
c
,12); R0(c,d,e,a,b,13); R0(b,c,d,e,a,14); R0(a,b,c,d,e,15);

85 
	`R1
(
e
,
a
,
b
,
c
,
d
,16); R1(d,e,a,b,c,17); R1(c,d,e,a,b,18); R1(b,c,d,e,a,19);

86 
	`R2
(
a
,
b
,
c
,
d
,
e
,20); R2(e,a,b,c,d,21); R2(d,e,a,b,c,22); R2(c,d,e,a,b,23);

87 
	`R2
(
b
,
c
,
d
,
e
,
a
,24); R2(a,b,c,d,e,25); R2(e,a,b,c,d,26); R2(d,e,a,b,c,27);

88 
	`R2
(
c
,
d
,
e
,
a
,
b
,28); R2(b,c,d,e,a,29); R2(a,b,c,d,e,30); R2(e,a,b,c,d,31);

89 
	`R2
(
d
,
e
,
a
,
b
,
c
,32); R2(c,d,e,a,b,33); R2(b,c,d,e,a,34); R2(a,b,c,d,e,35);

90 
	`R2
(
e
,
a
,
b
,
c
,
d
,36); R2(d,e,a,b,c,37); R2(c,d,e,a,b,38); R2(b,c,d,e,a,39);

91 
	`R3
(
a
,
b
,
c
,
d
,
e
,40); R3(e,a,b,c,d,41); R3(d,e,a,b,c,42); R3(c,d,e,a,b,43);

92 
	`R3
(
b
,
c
,
d
,
e
,
a
,44); R3(a,b,c,d,e,45); R3(e,a,b,c,d,46); R3(d,e,a,b,c,47);

93 
	`R3
(
c
,
d
,
e
,
a
,
b
,48); R3(b,c,d,e,a,49); R3(a,b,c,d,e,50); R3(e,a,b,c,d,51);

94 
	`R3
(
d
,
e
,
a
,
b
,
c
,52); R3(c,d,e,a,b,53); R3(b,c,d,e,a,54); R3(a,b,c,d,e,55);

95 
	`R3
(
e
,
a
,
b
,
c
,
d
,56); R3(d,e,a,b,c,57); R3(c,d,e,a,b,58); R3(b,c,d,e,a,59);

96 
	`R4
(
a
,
b
,
c
,
d
,
e
,60); R4(e,a,b,c,d,61); R4(d,e,a,b,c,62); R4(c,d,e,a,b,63);

97 
	`R4
(
b
,
c
,
d
,
e
,
a
,64); R4(a,b,c,d,e,65); R4(e,a,b,c,d,66); R4(d,e,a,b,c,67);

98 
	`R4
(
c
,
d
,
e
,
a
,
b
,68); R4(b,c,d,e,a,69); R4(a,b,c,d,e,70); R4(e,a,b,c,d,71);

99 
	`R4
(
d
,
e
,
a
,
b
,
c
,72); R4(c,d,e,a,b,73); R4(b,c,d,e,a,74); R4(a,b,c,d,e,75);

100 
	`R4
(
e
,
a
,
b
,
c
,
d
,76); R4(d,e,a,b,c,77); R4(c,d,e,a,b,78); R4(b,c,d,e,a,79);

102 
¡©e
[0] +ğ
a
;

103 
¡©e
[1] +ğ
b
;

104 
¡©e
[2] +ğ
c
;

105 
¡©e
[3] +ğ
d
;

106 
¡©e
[4] +ğ
e
;

108 
a
 = 
b
 = 
c
 = 
d
 = 
e
 = 0;

109 #ifdeà
SHA1HANDSOFF


110 
	`mem£t
(
block
, '\0', (block));

112 
	}
}

117 
	$SHA1In™
(
SHA1_CTX
* 
cÚ‹xt
)

120 
cÚ‹xt
->
¡©e
[0] = 0x67452301;

121 
cÚ‹xt
->
¡©e
[1] = 0xEFCDAB89;

122 
cÚ‹xt
->
¡©e
[2] = 0x98BADCFE;

123 
cÚ‹xt
->
¡©e
[3] = 0x10325476;

124 
cÚ‹xt
->
¡©e
[4] = 0xC3D2E1F0;

125 
cÚ‹xt
->
couÁ
[0] = context->count[1] = 0;

126 
	}
}

131 
	$SHA1Upd©e
(
SHA1_CTX
* 
cÚ‹xt
, cÚ¡ * 
d©a
, 
ušt32_t
 
Ën
)

133 
ušt32_t
 
i
, 
j
;

135 
j
 = 
cÚ‹xt
->
couÁ
[0];

136 ià((
cÚ‹xt
->
couÁ
[0] +ğ
Ën
 << 3è< 
j
)

137 
cÚ‹xt
->
couÁ
[1]++;

138 
cÚ‹xt
->
couÁ
[1] +ğ(
Ën
>>29);

139 
j
 = (j >> 3) & 63;

140 ià((
j
 + 
Ën
) > 63) {

141 
	`memıy
(&
cÚ‹xt
->
bufãr
[
j
], 
d©a
, (
i
 = 64-j));

142 
	`SHA1T¿nsfÜm
(
cÚ‹xt
->
¡©e
, cÚ‹xt->
bufãr
);

143  ; 
i
 + 63 < 
Ën
; i += 64) {

144 
	`SHA1T¿nsfÜm
(
cÚ‹xt
->
¡©e
, &
d©a
[
i
]);

146 
j
 = 0;

148 
i
 = 0;

149 
	`memıy
(&
cÚ‹xt
->
bufãr
[
j
], &
d©a
[
i
], 
Ën
 - i);

150 
	}
}

155 
	$SHA1Fš®
(
dige¡
[20], 
SHA1_CTX
* 
cÚ‹xt
)

157 
i
;

158 
fš®couÁ
[8];

159 
c
;

167 *
fı
 = &
fš®couÁ
[8];

169 
i
 = 0; i < 2; i++)

171 
ušt32_t
 
t
 = 
cÚ‹xt
->
couÁ
[
i
];

172 
j
;

174 
j
 = 0; j < 4; 
t
 >>= 8, j++)

175 *--
fı
 = (è
t
;

178 
i
 = 0; i < 8; i++) {

179 
fš®couÁ
[
i
] = ()((
cÚ‹xt
->
couÁ
[(i >= 4 ? 0 : 1)]

180 >> ((3-(
i
 & 3)) * 8) ) & 255);

183 
c
 = 0200;

184 
	`SHA1Upd©e
(
cÚ‹xt
, &
c
, 1);

185 (
cÚ‹xt
->
couÁ
[0] & 504) != 448) {

186 
c
 = 0000;

187 
	`SHA1Upd©e
(
cÚ‹xt
, &
c
, 1);

189 
	`SHA1Upd©e
(
cÚ‹xt
, 
fš®couÁ
, 8);

190 
i
 = 0; i < 20; i++) {

191 
dige¡
[
i
] = ()

192 ((
cÚ‹xt
->
¡©e
[
i
>>2] >> ((3-(i & 3)) * 8) ) & 255);

195 
	`mem£t
(
cÚ‹xt
, '\0', (*context));

196 
	`mem£t
(&
fš®couÁ
, '\0', (finalcount));

197 
	}
}

200 #ifdeà
REDIS_TEST


201 
	#BUFSIZE
 4096

	)

203 
	#UNUSED
(
x
è()(x)

	)

204 
	$sha1Te¡
(
¬gc
, **
¬gv
)

206 
SHA1_CTX
 
ùx
;

207 
hash
[20], 
buf
[
BUFSIZE
];

208 
i
;

210 
	`UNUSED
(
¬gc
);

211 
	`UNUSED
(
¬gv
);

213 
i
=0;i<
BUFSIZE
;i++)

214 
buf
[
i
] = i;

216 
	`SHA1In™
(&
ùx
);

217 
i
=0;i<1000;i++)

218 
	`SHA1Upd©e
(&
ùx
, 
buf
, 
BUFSIZE
);

219 
	`SHA1Fš®
(
hash
, &
ùx
);

221 
	`´štf
("SHA1=");

222 
i
=0;i<20;i++)

223 
	`´štf
("%02x", 
hash
[
i
]);

224 
	`´štf
("\n");

226 
	}
}

	@src/sha1.h

1 #iâdeà
SHA1_H


2 
	#SHA1_H


	)

11 
ušt32_t
 
	m¡©e
[5];

12 
ušt32_t
 
	mcouÁ
[2];

13 
	mbufãr
[64];

14 } 
	tSHA1_CTX
;

16 
SHA1T¿nsfÜm
(
ušt32_t
 
¡©e
[5], cÚ¡ 
bufãr
[64]);

17 
SHA1In™
(
SHA1_CTX
* 
cÚ‹xt
);

18 
SHA1Upd©e
(
SHA1_CTX
* 
cÚ‹xt
, cÚ¡ * 
d©a
, 
ušt32_t
 
Ën
);

19 
SHA1Fš®
(
dige¡
[20], 
SHA1_CTX
* 
cÚ‹xt
);

21 #ifdeà
REDIS_TEST


22 
sha1Te¡
(
¬gc
, **
¬gv
);

	@src/slowlog.c

42 
	~"£rv”.h
"

43 
	~"¦owlog.h
"

48 
¦owlogEÁry
 *
	$¦owlogC»©eEÁry
(
robj
 **
¬gv
, 
¬gc
, 
du¿tiÚ
) {

49 
¦owlogEÁry
 *
£
 = 
	`zm®loc
((*se));

50 
j
, 
¦¬gc
 = 
¬gc
;

52 ià(
¦¬gc
 > 
SLOWLOG_ENTRY_MAX_ARGC
) slargc = SLOWLOG_ENTRY_MAX_ARGC;

53 
£
->
¬gc
 = 
¦¬gc
;

54 
£
->
¬gv
 = 
	`zm®loc
((
robj
*)*
¦¬gc
);

55 
j
 = 0; j < 
¦¬gc
; j++) {

59 ià(
¦¬gc
 !ğ
¬gc
 && 
j
 == slargc-1) {

60 
£
->
¬gv
[
j
] = 
	`ü—‹Objeù
(
OBJ_STRING
,

61 
	`sdsÿrštf
(
	`sd£m±y
(),"... (%d more‡rguments)",

62 
¬gc
-
¦¬gc
+1));

65 ià(
¬gv
[
j
]->
ty³
 =ğ
OBJ_STRING
 &&

66 
	`sdsEncodedObjeù
(
¬gv
[
j
]) &&

67 
	`sd¦’
(
¬gv
[
j
]->
±r
è> 
SLOWLOG_ENTRY_MAX_STRING
)

69 
sds
 
s
 = 
	`sd¢ewËn
(
¬gv
[
j
]->
±r
, 
SLOWLOG_ENTRY_MAX_STRING
);

71 
s
 = 
	`sdsÿrštf
(s,"... (%lu more bytes)",

73 
	`sd¦’
(
¬gv
[
j
]->
±r
è- 
SLOWLOG_ENTRY_MAX_STRING
);

74 
£
->
¬gv
[
j
] = 
	`ü—‹Objeù
(
OBJ_STRING
,
s
);

76 
£
->
¬gv
[
j
] =‡rgv[j];

77 
	`šüRefCouÁ
(
¬gv
[
j
]);

81 
£
->
time
 = 
	`time
(
NULL
);

82 
£
->
du¿tiÚ
 = duration;

83 
£
->
id
 = 
£rv”
.
¦owlog_’Œy_id
++;

84  
£
;

85 
	}
}

91 
	$¦owlogF»eEÁry
(*
£±r
) {

92 
¦owlogEÁry
 *
£
 = 
£±r
;

93 
j
;

95 
j
 = 0; j < 
£
->
¬gc
; j++)

96 
	`deüRefCouÁ
(
£
->
¬gv
[
j
]);

97 
	`zä“
(
£
->
¬gv
);

98 
	`zä“
(
£
);

99 
	}
}

103 
	$¦owlogIn™
() {

104 
£rv”
.
¦owlog
 = 
	`li¡C»©e
();

105 
£rv”
.
¦owlog_’Œy_id
 = 0;

106 
	`li¡S‘F»eM‘hod
(
£rv”
.
¦owlog
,
¦owlogF»eEÁry
);

107 
	}
}

112 
	$¦owlogPushEÁryIfN“ded
(
robj
 **
¬gv
, 
¬gc
, 
du¿tiÚ
) {

113 ià(
£rv”
.
¦owlog_log_¦ow”_thª
 < 0) ;

114 ià(
du¿tiÚ
 >ğ
£rv”
.
¦owlog_log_¦ow”_thª
)

115 
	`li¡AddNodeH—d
(
£rv”
.
¦owlog
,
	`¦owlogC»©eEÁry
(
¬gv
,
¬gc
,
du¿tiÚ
));

118 
	`li¡L’gth
(
£rv”
.
¦owlog
è> s”v”.
¦owlog_max_Ën
)

119 
	`li¡D–Node
(
£rv”
.
¦owlog
,
	`li¡La¡
(server.slowlog));

120 
	}
}

123 
	$¦owlogRe£t
() {

124 
	`li¡L’gth
(
£rv”
.
¦owlog
) > 0)

125 
	`li¡D–Node
(
£rv”
.
¦owlog
,
	`li¡La¡
(server.slowlog));

126 
	}
}

130 
	$¦owlogCommªd
(
ş›Á
 *
c
) {

131 ià(
c
->
¬gc
 =ğ2 && !
	`¡rÿ£cmp
(c->
¬gv
[1]->
±r
,"reset")) {

132 
	`¦owlogRe£t
();

133 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

134 } ià(
c
->
¬gc
 =ğ2 && !
	`¡rÿ£cmp
(c->
¬gv
[1]->
±r
,"len")) {

135 
	`addR•lyLÚgLÚg
(
c
,
	`li¡L’gth
(
£rv”
.
¦owlog
));

136 } ià((
c
->
¬gc
 == 2 || c->argc == 3) &&

137 !
	`¡rÿ£cmp
(
c
->
¬gv
[1]->
±r
,"get"))

139 
couÁ
 = 10, 
£Á
 = 0;

140 
li¡I‹r
 
li
;

141 *
tÙ’Œ›s
;

142 
li¡Node
 *
Ê
;

143 
¦owlogEÁry
 *
£
;

145 ià(
c
->
¬gc
 == 3 &&

146 
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
couÁ
,
NULL
è!ğ
C_OK
)

149 
	`li¡Rewšd
(
£rv”
.
¦owlog
,&
li
);

150 
tÙ’Œ›s
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

151 
couÁ
-- && (
Ê
 = 
	`li¡Next
(&
li
))) {

152 
j
;

154 
£
 = 
Ê
->
v®ue
;

155 
	`addR•lyMuÉiBulkL’
(
c
,4);

156 
	`addR•lyLÚgLÚg
(
c
,
£
->
id
);

157 
	`addR•lyLÚgLÚg
(
c
,
£
->
time
);

158 
	`addR•lyLÚgLÚg
(
c
,
£
->
du¿tiÚ
);

159 
	`addR•lyMuÉiBulkL’
(
c
,
£
->
¬gc
);

160 
j
 = 0; j < 
£
->
¬gc
; j++)

161 
	`addR•lyBulk
(
c
,
£
->
¬gv
[
j
]);

162 
£Á
++;

164 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
tÙ’Œ›s
,
£Á
);

166 
	`addR•lyE¼Ü
(
c
,

169 
	}
}

	@src/slowlog.h

30 
	#SLOWLOG_ENTRY_MAX_ARGC
 32

	)

31 
	#SLOWLOG_ENTRY_MAX_STRING
 128

	)

34 
	s¦owlogEÁry
 {

35 
robj
 **
	m¬gv
;

36 
	m¬gc
;

37 
	mid
;

38 
	mdu¿tiÚ
;

39 
time_t
 
	mtime
;

40 } 
	t¦owlogEÁry
;

43 
¦owlogIn™
();

44 
¦owlogPushEÁryIfN“ded
(
robj
 **
¬gv
, 
¬gc
, 
du¿tiÚ
);

47 
¦owlogCommªd
(
ş›Á
 *
c
);

	@src/solarisfixes.h

31 #ià
defšed
(
__sun
)

33 #ià
defšed
(
__GNUC__
)

34 
	~<m©h.h
>

35 #undeà
i¢ª


36 
	#i¢ª
(
x
) \

37 
	`__ex‹nsiÚ__
({ 
	`__ty³of
 (
x
è
__x_a
 = (x); \

38 
	`__butš_ex³ù
(
__x_a
 !ğ__x_a, 0); })

	)

40 #undeà
isfš™e


41 
	#isfš™e
(
x
) \

42 
	`__ex‹nsiÚ__
 ({ 
	`__ty³of
 (
x
è
__x_f
 = (x); \

43 
	`__butš_ex³ù
(!
	`i¢ª
(
__x_f
 - __x_f), 1); })

	)

45 #undeà
isšf


46 
	#isšf
(
x
) \

47 
	`__ex‹nsiÚ__
 ({ 
	`__ty³of
 (
x
è
__x_i
 = (x); \

48 
	`__butš_ex³ù
(!
	`i¢ª
(
__x_i
è&& !
	`isfš™e
(__x_i), 0); })

	)

50 
	#u_št
 
ušt


	)

51 
	#u_št32_t
 
ušt32_t


	)

	@src/sort.c

32 
	~"£rv”.h
"

33 
	~"pqsÜt.h
"

34 
	~<m©h.h
>

36 
zskli¡Node
* 
z¦G‘EËm’tByRªk
(
zskli¡
 *
z¦
, 
¿nk
);

38 
»disSÜtO³¿tiÚ
 *
	$ü—‹SÜtO³¿tiÚ
(
ty³
, 
robj
 *
·‰”n
) {

39 
»disSÜtO³¿tiÚ
 *
so
 = 
	`zm®loc
((*so));

40 
so
->
ty³
 =ype;

41 
so
->
·‰”n
 =…attern;

42  
so
;

43 
	}
}

61 
robj
 *
	$lookupKeyByP©‹º
(
»disDb
 *
db
, 
robj
 *
·‰”n
,„obj *
sub¡
) {

62 *
p
, *
f
, *
k
;

63 
sds
 
¥©
, 
ssub
;

64 
robj
 *
keyobj
, *
f›ldobj
 = 
NULL
, *
o
;

65 
´efixËn
, 
subËn
, 
po¡fixËn
, 
f›ldËn
;

69 
¥©
 = 
·‰”n
->
±r
;

70 ià(
¥©
[0] == '#' && spat[1] == '\0') {

71 
	`šüRefCouÁ
(
sub¡
);

72  
sub¡
;

78 
sub¡
 = 
	`g‘DecodedObjeù
(subst);

79 
ssub
 = 
sub¡
->
±r
;

83 
p
 = 
	`¡rchr
(
¥©
,'*');

84 ià(!
p
) {

85 
	`deüRefCouÁ
(
sub¡
);

86  
NULL
;

90 ià((
f
 = 
	`¡r¡r
(
p
+1, "->")è!ğ
NULL
 && *(f+2) != '\0') {

91 
f›ldËn
 = 
	`sd¦’
(
¥©
)-(
f
-spat)-2;

92 
f›ldobj
 = 
	`ü—‹SŒšgObjeù
(
f
+2,
f›ldËn
);

94 
f›ldËn
 = 0;

98 
´efixËn
 = 
p
-
¥©
;

99 
subËn
 = 
	`sd¦’
(
ssub
);

100 
po¡fixËn
 = 
	`sd¦’
(
¥©
)-(
´efixËn
+1)-(
f›ldËn
 ? fieldlen+2 : 0);

101 
keyobj
 = 
	`ü—‹SŒšgObjeù
(
NULL
,
´efixËn
+
subËn
+
po¡fixËn
);

102 
k
 = 
keyobj
->
±r
;

103 
	`memıy
(
k
,
¥©
,
´efixËn
);

104 
	`memıy
(
k
+
´efixËn
,
ssub
,
subËn
);

105 
	`memıy
(
k
+
´efixËn
+
subËn
,
p
+1,
po¡fixËn
);

106 
	`deüRefCouÁ
(
sub¡
);

109 
o
 = 
	`lookupKeyR—d
(
db
,
keyobj
);

110 ià(
o
 =ğ
NULL
è
noobj
;

112 ià(
f›ldobj
) {

113 ià(
o
->
ty³
 !ğ
OBJ_HASH
è
noobj
;

117 
o
 = 
	`hashTy³G‘Objeù
(o, 
f›ldobj
);

119 ià(
o
->
ty³
 !ğ
OBJ_STRING
è
noobj
;

123 
	`šüRefCouÁ
(
o
);

125 
	`deüRefCouÁ
(
keyobj
);

126 ià(
f›ldobj
è
	`deüRefCouÁ
(fieldobj);

127  
o
;

129 
noobj
:

130 
	`deüRefCouÁ
(
keyobj
);

131 ià(
f›ldËn
è
	`deüRefCouÁ
(
f›ldobj
);

132  
NULL
;

133 
	}
}

138 
	$sÜtCom·»
(cÚ¡ *
s1
, cÚ¡ *
s2
) {

139 cÚ¡ 
»disSÜtObjeù
 *
so1
 = 
s1
, *
so2
 = 
s2
;

140 
cmp
;

142 ià(!
£rv”
.
sÜt_®pha
) {

144 ià(
so1
->
u
.
scÜe
 > 
so2
->u.score) {

145 
cmp
 = 1;

146 } ià(
so1
->
u
.
scÜe
 < 
so2
->u.score) {

147 
cmp
 = -1;

152 
cmp
 = 
	`com·»SŒšgObjeùs
(
so1
->
obj
,
so2
->obj);

156 ià(
£rv”
.
sÜt_by·‰”n
) {

157 ià(!
so1
->
u
.
cmpobj
 || !
so2
->u.cmpobj) {

159 ià(
so1
->
u
.
cmpobj
 =ğ
so2
->u.cmpobj)

160 
cmp
 = 0;

161 ià(
so1
->
u
.
cmpobj
 =ğ
NULL
)

162 
cmp
 = -1;

164 
cmp
 = 1;

167 ià(
£rv”
.
sÜt_¡Üe
) {

168 
cmp
 = 
	`com·»SŒšgObjeùs
(
so1
->
u
.
cmpobj
,
so2
->u.cmpobj);

172 
cmp
 = 
	`¡rcŞl
(
so1
->
u
.
cmpobj
->
±r
,
so2
->u.cmpobj->ptr);

177 ià(
£rv”
.
sÜt_¡Üe
) {

178 
cmp
 = 
	`com·»SŒšgObjeùs
(
so1
->
obj
,
so2
->obj);

180 
cmp
 = 
	`cŞÏ‹SŒšgObjeùs
(
so1
->
obj
,
so2
->obj);

184  
£rv”
.
sÜt_desc
 ? -
cmp
 : cmp;

185 
	}
}

189 
	$sÜtCommªd
(
ş›Á
 *
c
) {

190 
li¡
 *
İ”©iÚs
;

191 
ouu’
 = 0;

192 
desc
 = 0, 
®pha
 = 0;

193 
lim™_¡¬t
 = 0, 
lim™_couÁ
 = -1, 
¡¬t
, 
’d
;

194 
j
, 
dÚtsÜt
 = 0, 
veùÜËn
;

195 
g‘İ
 = 0;

196 
št_cÚv”tiÚ_”rÜ
 = 0;

197 
syÁax_”rÜ
 = 0;

198 
robj
 *
sÜtv®
, *
sÜtby
 = 
NULL
, *
¡Üekey
 = NULL;

199 
»disSÜtObjeù
 *
veùÜ
;

202 
sÜtv®
 = 
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[1]);

203 ià(
sÜtv®
 && sÜtv®->
ty³
 !ğ
OBJ_SET
 &&

204 
sÜtv®
->
ty³
 !ğ
OBJ_LIST
 &&

205 
sÜtv®
->
ty³
 !ğ
OBJ_ZSET
)

207 
	`addR•ly
(
c
,
sh¬ed
.
wrÚgty³”r
);

213 
İ”©iÚs
 = 
	`li¡C»©e
();

214 
	`li¡S‘F»eM‘hod
(
İ”©iÚs
,
zä“
);

215 
j
 = 2;

220 ià(
sÜtv®
)

221 
	`šüRefCouÁ
(
sÜtv®
);

223 
sÜtv®
 = 
	`ü—‹Quickli¡Objeù
();

226 
j
 < 
c
->
¬gc
) {

227 
Ëá¬gs
 = 
c
->
¬gc
-
j
-1;

228 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"asc")) {

229 
desc
 = 0;

230 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"desc")) {

231 
desc
 = 1;

232 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"alpha")) {

233 
®pha
 = 1;

234 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"lim™"è&& 
Ëá¬gs
 >= 2) {

235 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[
j
+1], &
lim™_¡¬t
, 
NULL
)

236 !ğ
C_OK
) ||

237 (
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[
j
+2], &
lim™_couÁ
, 
NULL
)

238 !ğ
C_OK
))

240 
syÁax_”rÜ
++;

243 
j
+=2;

244 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"¡Üe"è&& 
Ëá¬gs
 >= 1) {

245 
¡Üekey
 = 
c
->
¬gv
[
j
+1];

246 
j
++;

247 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"by"è&& 
Ëá¬gs
 >= 1) {

248 
sÜtby
 = 
c
->
¬gv
[
j
+1];

251 ià(
	`¡rchr
(
c
->
¬gv
[
j
+1]->
±r
,'*'è=ğ
NULL
) {

252 
dÚtsÜt
 = 1;

256 ià(
£rv”
.
şu¡”_’abËd
) {

257 
	`addR•lyE¼Ü
(
c
,"BY option of SORT denied in Cluster mode.");

258 
syÁax_”rÜ
++;

262 
j
++;

263 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"g‘"è&& 
Ëá¬gs
 >= 1) {

264 ià(
£rv”
.
şu¡”_’abËd
) {

265 
	`addR•lyE¼Ü
(
c
,"GET option of SORT denied in Cluster mode.");

266 
syÁax_”rÜ
++;

269 
	`li¡AddNodeTa
(
İ”©iÚs
,
	`ü—‹SÜtO³¿tiÚ
(

270 
SORT_OP_GET
,
c
->
¬gv
[
j
+1]));

271 
g‘İ
++;

272 
j
++;

274 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

275 
syÁax_”rÜ
++;

278 
j
++;

282 ià(
syÁax_”rÜ
) {

283 
	`deüRefCouÁ
(
sÜtv®
);

284 
	`li¡R–—£
(
İ”©iÚs
);

294 ià(
dÚtsÜt
 &&

295 
sÜtv®
->
ty³
 =ğ
OBJ_SET
 &&

296 (
¡Üekey
 || 
c
->
æags
 & 
CLIENT_LUA
))

299 
dÚtsÜt
 = 0;

300 
®pha
 = 1;

301 
sÜtby
 = 
NULL
;

305 ià(
sÜtv®
->
ty³
 =ğ
OBJ_ZSET
)

306 
	`z£tCÚv”t
(
sÜtv®
, 
OBJ_ENCODING_SKIPLIST
);

309 
sÜtv®
->
ty³
) {

310 
OBJ_LIST
: 
veùÜËn
 = 
	`li¡Ty³L’gth
(
sÜtv®
); ;

311 
OBJ_SET
: 
veùÜËn
 = 
	`£tTy³Size
(
sÜtv®
); ;

312 
OBJ_ZSET
: 
veùÜËn
 = 
	`diùSize
(((
z£t
*)
sÜtv®
->
±r
)->
diù
); ;

313 : 
veùÜËn
 = 0; 
	`£rv”Pªic
("Bad SORType");

317 
¡¬t
 = (
lim™_¡¬t
 < 0) ? 0 :†imit_start;

318 
’d
 = (
lim™_couÁ
 < 0è? 
veùÜËn
-1 : 
¡¬t
+limit_count-1;

319 ià(
¡¬t
 >ğ
veùÜËn
) {

320 
¡¬t
 = 
veùÜËn
-1;

321 
’d
 = 
veùÜËn
-2;

323 ià(
’d
 >ğ
veùÜËn
)ƒnd = vectorlen-1;

335 ià((
sÜtv®
->
ty³
 =ğ
OBJ_ZSET
 || sÜtv®->ty³ =ğ
OBJ_LIST
) &&

336 
dÚtsÜt
 &&

337 (
¡¬t
 !ğ0 || 
’d
 !ğ
veùÜËn
-1))

339 
veùÜËn
 = 
’d
-
¡¬t
+1;

343 
veùÜ
 = 
	`zm®loc
((
»disSÜtObjeù
)*
veùÜËn
);

344 
j
 = 0;

346 ià(
sÜtv®
->
ty³
 =ğ
OBJ_LIST
 && 
dÚtsÜt
) {

353 ià(
’d
 >ğ
¡¬t
) {

354 
li¡Ty³I‹¿tÜ
 *
li
;

355 
li¡Ty³EÁry
 
’Œy
;

356 
li
 = 
	`li¡Ty³In™I‹¿tÜ
(
sÜtv®
,

357 
desc
 ? ()(
	`li¡Ty³L’gth
(
sÜtv®
è- 
¡¬t
 - 1) : start,

358 
desc
 ? 
REDIS_LIST_HEAD
 : 
REDIS_LIST_TAIL
);

360 
j
 < 
veùÜËn
 && 
	`li¡Ty³Next
(
li
,&
’Œy
)) {

361 
veùÜ
[
j
].
obj
 = 
	`li¡Ty³G‘
(&
’Œy
);

362 
veùÜ
[
j
].
u
.
scÜe
 = 0;

363 
veùÜ
[
j
].
u
.
cmpobj
 = 
NULL
;

364 
j
++;

366 
	`li¡Ty³R–—£I‹¿tÜ
(
li
);

368 
’d
 -ğ
¡¬t
;

369 
¡¬t
 = 0;

371 } ià(
sÜtv®
->
ty³
 =ğ
OBJ_LIST
) {

372 
li¡Ty³I‹¿tÜ
 *
li
 = 
	`li¡Ty³In™I‹¿tÜ
(
sÜtv®
,0,
REDIS_LIST_TAIL
);

373 
li¡Ty³EÁry
 
’Œy
;

374 
	`li¡Ty³Next
(
li
,&
’Œy
)) {

375 
veùÜ
[
j
].
obj
 = 
	`li¡Ty³G‘
(&
’Œy
);

376 
veùÜ
[
j
].
u
.
scÜe
 = 0;

377 
veùÜ
[
j
].
u
.
cmpobj
 = 
NULL
;

378 
j
++;

380 
	`li¡Ty³R–—£I‹¿tÜ
(
li
);

381 } ià(
sÜtv®
->
ty³
 =ğ
OBJ_SET
) {

382 
£tTy³I‹¿tÜ
 *
si
 = 
	`£tTy³In™I‹¿tÜ
(
sÜtv®
);

383 
robj
 *
–e
;

384 (
–e
 = 
	`£tTy³NextObjeù
(
si
)è!ğ
NULL
) {

385 
veùÜ
[
j
].
obj
 = 
–e
;

386 
veùÜ
[
j
].
u
.
scÜe
 = 0;

387 
veùÜ
[
j
].
u
.
cmpobj
 = 
NULL
;

388 
j
++;

390 
	`£tTy³R–—£I‹¿tÜ
(
si
);

391 } ià(
sÜtv®
->
ty³
 =ğ
OBJ_ZSET
 && 
dÚtsÜt
) {

399 
z£t
 *
zs
 = 
sÜtv®
->
±r
;

400 
zskli¡
 *
z¦
 = 
zs
->zsl;

401 
zskli¡Node
 *
Ê
;

402 
robj
 *
–e
;

403 
¿ng–’
 = 
veùÜËn
;

406 ià(
desc
) {

407 
z£’
 = 
	`diùSize
(((
z£t
*)
sÜtv®
->
±r
)->
diù
);

409 
Ê
 = 
z¦
->

;

410 ià(
¡¬t
 > 0)

411 
Ê
 = 
	`z¦G‘EËm’tByRªk
(
z¦
,
z£’
-
¡¬t
);

413 
Ê
 = 
z¦
->
h—d”
->
Ëv–
[0].
fÜw¬d
;

414 ià(
¡¬t
 > 0)

415 
Ê
 = 
	`z¦G‘EËm’tByRªk
(
z¦
,
¡¬t
+1);

418 
¿ng–’
--) {

419 
	`£rv”As£¹W™hInfo
(
c
,
sÜtv®
,
Ê
 !ğ
NULL
);

420 
–e
 = 
Ê
->
obj
;

421 
veùÜ
[
j
].
obj
 = 
–e
;

422 
veùÜ
[
j
].
u
.
scÜe
 = 0;

423 
veùÜ
[
j
].
u
.
cmpobj
 = 
NULL
;

424 
j
++;

425 
Ê
 = 
desc
 ?†n->
backw¬d
 :†n->
Ëv–
[0].
fÜw¬d
;

428 
’d
 -ğ
¡¬t
;

429 
¡¬t
 = 0;

430 } ià(
sÜtv®
->
ty³
 =ğ
OBJ_ZSET
) {

431 
diù
 *
£t
 = ((
z£t
*)
sÜtv®
->
±r
)->dict;

432 
diùI‹¿tÜ
 *
di
;

433 
diùEÁry
 *
£‹Ë
;

434 
di
 = 
	`diùG‘I‹¿tÜ
(
£t
);

435 (
£‹Ë
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

436 
veùÜ
[
j
].
obj
 = 
	`diùG‘Key
(
£‹Ë
);

437 
veùÜ
[
j
].
u
.
scÜe
 = 0;

438 
veùÜ
[
j
].
u
.
cmpobj
 = 
NULL
;

439 
j
++;

441 
	`diùR–—£I‹¿tÜ
(
di
);

443 
	`£rv”Pªic
("Unknownype");

445 
	`£rv”As£¹W™hInfo
(
c
,
sÜtv®
,
j
 =ğ
veùÜËn
);

448 ià(
dÚtsÜt
 == 0) {

449 
j
 = 0; j < 
veùÜËn
; j++) {

450 
robj
 *
byv®
;

451 ià(
sÜtby
) {

453 
byv®
 = 
	`lookupKeyByP©‹º
(
c
->
db
,
sÜtby
,
veùÜ
[
j
].
obj
);

454 ià(!
byv®
) ;

457 
byv®
 = 
veùÜ
[
j
].
obj
;

460 ià(
®pha
) {

461 ià(
sÜtby
è
veùÜ
[
j
].
u
.
cmpobj
 = 
	`g‘DecodedObjeù
(
byv®
);

463 ià(
	`sdsEncodedObjeù
(
byv®
)) {

464 *
•Œ
;

466 
veùÜ
[
j
].
u
.
scÜe
 = 
	`¡¹od
(
byv®
->
±r
,&
•Œ
);

467 ià(
•Œ
[0] !ğ'\0' || 
”ºo
 =ğ
ERANGE
 ||

468 
	`i¢ª
(
veùÜ
[
j
].
u
.
scÜe
))

470 
št_cÚv”tiÚ_”rÜ
 = 1;

472 } ià(
byv®
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

476 
veùÜ
[
j
].
u
.
scÜe
 = ()
byv®
->
±r
;

478 
	`£rv”As£¹W™hInfo
(
c
,
sÜtv®
,1 != 1);

484 ià(
sÜtby
) {

485 
	`deüRefCouÁ
(
byv®
);

490 ià(
dÚtsÜt
 == 0) {

491 
£rv”
.
sÜt_desc
 = 
desc
;

492 
£rv”
.
sÜt_®pha
 = 
®pha
;

493 
£rv”
.
sÜt_by·‰”n
 = 
sÜtby
 ? 1 : 0;

494 
£rv”
.
sÜt_¡Üe
 = 
¡Üekey
 ? 1 : 0;

495 ià(
sÜtby
 && (
¡¬t
 !ğ0 || 
’d
 !ğ
veùÜËn
-1))

496 
	`pqsÜt
(
veùÜ
,
veùÜËn
,(
»disSÜtObjeù
),
sÜtCom·»
, 
¡¬t
,
’d
);

498 
	`qsÜt
(
veùÜ
,
veùÜËn
,(
»disSÜtObjeù
),
sÜtCom·»
);

503 
ouu’
 = 
g‘İ
 ? g‘İ*(
’d
-
¡¬t
+1) :ƒnd-start+1;

504 ià(
št_cÚv”tiÚ_”rÜ
) {

505 
	`addR•lyE¼Ü
(
c
,"One or more scores can't be converted into double");

506 } ià(
¡Üekey
 =ğ
NULL
) {

508 
	`addR•lyMuÉiBulkL’
(
c
,
ouu’
);

509 
j
 = 
¡¬t
; j <ğ
’d
; j++) {

510 
li¡Node
 *
Ê
;

511 
li¡I‹r
 
li
;

513 ià(!
g‘İ
è
	`addR•lyBulk
(
c
,
veùÜ
[
j
].
obj
);

514 
	`li¡Rewšd
(
İ”©iÚs
,&
li
);

515 (
Ê
 = 
	`li¡Next
(&
li
))) {

516 
»disSÜtO³¿tiÚ
 *
sİ
 = 
Ê
->
v®ue
;

517 
robj
 *
v®
 = 
	`lookupKeyByP©‹º
(
c
->
db
,
sİ
->
·‰”n
,

518 
veùÜ
[
j
].
obj
);

520 ià(
sİ
->
ty³
 =ğ
SORT_OP_GET
) {

521 ià(!
v®
) {

522 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

524 
	`addR•lyBulk
(
c
,
v®
);

525 
	`deüRefCouÁ
(
v®
);

529 
	`£rv”As£¹W™hInfo
(
c
,
sÜtv®
,
sİ
->
ty³
 =ğ
SORT_OP_GET
);

534 
robj
 *
sobj
 = 
	`ü—‹Quickli¡Objeù
();

537 
j
 = 
¡¬t
; j <ğ
’d
; j++) {

538 
li¡Node
 *
Ê
;

539 
li¡I‹r
 
li
;

541 ià(!
g‘İ
) {

542 
	`li¡Ty³Push
(
sobj
,
veùÜ
[
j
].
obj
,
REDIS_LIST_TAIL
);

544 
	`li¡Rewšd
(
İ”©iÚs
,&
li
);

545 (
Ê
 = 
	`li¡Next
(&
li
))) {

546 
»disSÜtO³¿tiÚ
 *
sİ
 = 
Ê
->
v®ue
;

547 
robj
 *
v®
 = 
	`lookupKeyByP©‹º
(
c
->
db
,
sİ
->
·‰”n
,

548 
veùÜ
[
j
].
obj
);

550 ià(
sİ
->
ty³
 =ğ
SORT_OP_GET
) {

551 ià(!
v®
èv® = 
	`ü—‹SŒšgObjeù
("",0);

556 
	`li¡Ty³Push
(
sobj
,
v®
,
REDIS_LIST_TAIL
);

557 
	`deüRefCouÁ
(
v®
);

560 
	`£rv”As£¹W™hInfo
(
c
,
sÜtv®
,
sİ
->
ty³
 =ğ
SORT_OP_GET
);

565 ià(
ouu’
) {

566 
	`£tKey
(
c
->
db
,
¡Üekey
,
sobj
);

567 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,"sÜt¡Üe",
¡Üekey
,

568 
c
->
db
->
id
);

569 
£rv”
.
dœty
 +ğ
ouu’
;

570 } ià(
	`dbD–‘e
(
c
->
db
,
¡Üekey
)) {

571 
	`sigÇlModif›dKey
(
c
->
db
,
¡Üekey
);

572 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
¡Üekey
,
c
->
db
->
id
);

573 
£rv”
.
dœty
++;

575 
	`deüRefCouÁ
(
sobj
);

576 
	`addR•lyLÚgLÚg
(
c
,
ouu’
);

580 ià(
sÜtv®
->
ty³
 =ğ
OBJ_LIST
 || sÜtv®->ty³ =ğ
OBJ_SET
)

581 
j
 = 0; j < 
veùÜËn
; j++)

582 
	`deüRefCouÁ
(
veùÜ
[
j
].
obj
);

583 
	`deüRefCouÁ
(
sÜtv®
);

584 
	`li¡R–—£
(
İ”©iÚs
);

585 
j
 = 0; j < 
veùÜËn
; j++) {

586 ià(
®pha
 && 
veùÜ
[
j
].
u
.
cmpobj
)

587 
	`deüRefCouÁ
(
veùÜ
[
j
].
u
.
cmpobj
);

589 
	`zä“
(
veùÜ
);

590 
	}
}

	@src/sparkline.c

33 
	~"£rv”.h
"

35 
	~<m©h.h
>

39 
	gch¬£t
[] = "_-`";

40 
	gch¬£t_fl
[] = "_o#";

41 
	gch¬£t_Ën
 = (
ch¬£t
)-1;

42 
	gÏb–_m¬gš_tİ
 = 1;

57 
£qu’û
 *
	$ü—‹S·rklšeSequ’û
() {

58 
£qu’û
 *
£q
 = 
	`zm®loc
((*seq));

59 
£q
->
Ëngth
 = 0;

60 
£q
->
§m¶es
 = 
NULL
;

61  
£q
;

62 
	}
}

65 
	$¥¬klšeSequ’ûAddSam¶e
(
£qu’û
 *
£q
, 
v®ue
, *
Ïb–
) {

66 
Ïb–
 = (Ïb– =ğ
NULL
 ||†ab–[0] =ğ'\0'è? NULL : 
	`z¡rdup
(label);

67 ià(
£q
->
Ëngth
 == 0) {

68 
£q
->
mš
 = seq->
max
 = 
v®ue
;

70 ià(
v®ue
 < 
£q
->
mš
) seq->min = value;

71 ià(
v®ue
 > 
£q
->
max
) seq->max = value;

73 
£q
->
§m¶es
 = 
	`z»®loc
(£q->§m¶es,(
§m¶e
)*(£q->
Ëngth
+1));

74 
£q
->
§m¶es
[£q->
Ëngth
].
v®ue
 = value;

75 
£q
->
§m¶es
[£q->
Ëngth
].
Ïb–
 =†abel;

76 
£q
->
Ëngth
++;

77 ià(
Ïb–
è
£q
->
Ïb–s
++;

78 
	}
}

81 
	$ä“S·rklšeSequ’û
(
£qu’û
 *
£q
) {

82 
j
;

84 
j
 = 0; j < 
£q
->
Ëngth
; j++)

85 
	`zä“
(
£q
->
§m¶es
[
j
].
Ïb–
);

86 
	`zä“
(
£q
->
§m¶es
);

87 
	`zä“
(
£q
);

88 
	}
}

97 
sds
 
	$¥¬klšeR’d”Rªge
(
sds
 
ouut
, 
£qu’û
 *
£q
, 
rows
, 
off£t
, 
Ën
, 
æags
) {

98 
j
;

99 
»lmax
 = 
£q
->
max
 - seq->
mš
;

100 
¡•s
 = 
ch¬£t_Ën
*
rows
;

101 
row
 = 0;

102 *
ch¬s
 = 
	`zm®loc
(
Ën
);

103 
loİ
 = 1;

104 
İt_fl
 = 
æags
 & 
SPARKLINE_FILL
;

105 
İt_log
 = 
æags
 & 
SPARKLINE_LOG_SCALE
;

107 ià(
İt_log
) {

108 
»lmax
 = 
	`log
(relmax+1);

109 } ià(
»lmax
 == 0) {

110 
»lmax
 = 1;

113 
loİ
) {

114 
loİ
 = 0;

115 
	`mem£t
(
ch¬s
,' ',
Ën
);

116 
j
 = 0; j < 
Ën
; j++) {

117 
§m¶e
 *
s
 = &
£q
->
§m¶es
[
j
+
off£t
];

118 
»lv®
 = 
s
->
v®ue
 - 
£q
->
mš
;

119 
¡•
;

121 ià(
İt_log
è
»lv®
 = 
	`log
(relval+1);

122 
¡•
 = (è(
»lv®
*
¡•s
)/
»lmax
;

123 ià(
¡•
 < 0) step = 0;

124 ià(
¡•
 >ğ
¡•s
) step = steps-1;

126 ià(
row
 < 
rows
) {

128 
ch¬idx
 = 
¡•
-((
rows
-
row
-1)*
ch¬£t_Ën
);

129 
loİ
 = 1;

130 ià(
ch¬idx
 >ğ0 && ch¬idx < 
ch¬£t_Ën
) {

131 
ch¬s
[
j
] = 
İt_fl
 ? 
ch¬£t_fl
[
ch¬idx
] :

132 
ch¬£t
[
ch¬idx
];

133 } if(
İt_fl
 && 
ch¬idx
 >ğ
ch¬£t_Ën
) {

134 
ch¬s
[
j
] = '|';

138 ià(
£q
->
Ïb–s
 && 
row
-
rows
 < 
Ïb–_m¬gš_tİ
) {

139 
loİ
 = 1;

143 ià(
s
->
Ïb–
) {

144 
Ïb–_Ën
 = 
	`¡¾’
(
s
->
Ïb–
);

145 
Ïb–_ch¬
 = 
row
 - 
rows
 - 
Ïb–_m¬gš_tİ
;

147 ià(
Ïb–_Ën
 > 
Ïb–_ch¬
) {

148 
loİ
 = 1;

149 
ch¬s
[
j
] = 
s
->
Ïb–
[
Ïb–_ch¬
];

154 ià(
loİ
) {

155 
row
++;

156 
ouut
 = 
	`sdsÿ’
(ouut,
ch¬s
,
Ën
);

157 
ouut
 = 
	`sdsÿ’
(output,"\n",1);

160 
	`zä“
(
ch¬s
);

161  
ouut
;

162 
	}
}

165 
sds
 
	$¥¬klšeR’d”
(
sds
 
ouut
, 
£qu’û
 *
£q
, 
cŞumns
, 
rows
, 
æags
) {

166 
j
;

168 
j
 = 0; j < 
£q
->
Ëngth
; j +ğ
cŞumns
) {

169 
subËn
 = (
£q
->
Ëngth
-
j
è< 
cŞumns
 ? (seq->length-j) : columns;

171 ià(
j
 !ğ0è
ouut
 = 
	`sdsÿ’
(output,"\n",1);

172 
ouut
 = 
	`¥¬klšeR’d”Rªge
(ouut, 
£q
, 
rows
, 
j
, 
subËn
, 
æags
);

174  
ouut
;

175 
	}
}

	@src/sparkline.h

30 #iâdeà
__SPARKLINE_H


31 
	#__SPARKLINE_H


	)

34 
	s§m¶e
 {

35 
	mv®ue
;

36 *
	mÏb–
;

39 
	s£qu’û
 {

40 
	mËngth
;

41 
	mÏb–s
;

42 
§m¶e
 *
	m§m¶es
;

43 
	mmš
, 
	mmax
;

46 
	#SPARKLINE_NO_FLAGS
 0

	)

47 
	#SPARKLINE_FILL
 1

	)

48 
	#SPARKLINE_LOG_SCALE
 2

	)

50 
£qu’û
 *
ü—‹S·rklšeSequ’û
();

51 
¥¬klšeSequ’ûAddSam¶e
(
£qu’û
 *
£q
, 
v®ue
, *
Ïb–
);

52 
ä“S·rklšeSequ’û
(
£qu’û
 *
£q
);

53 
sds
 
¥¬klšeR’d”Rªge
(sd 
ouut
, 
£qu’û
 *
£q
, 
rows
, 
off£t
, 
Ën
, 
æags
);

54 
sds
 
¥¬klšeR’d”
(sd 
ouut
, 
£qu’û
 *
£q
, 
cŞumns
, 
rows
, 
æags
);

	@src/syncio.c

31 
	~"£rv”.h
"

43 
	#SYNCIO__RESOLUTION
 10

	)

49 
ssize_t
 
	$syncWr™e
(
fd
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

50 
ssize_t
 
nwr™‹n
, 
»t
 = 
size
;

51 
¡¬t
 = 
	`m¡ime
();

52 
»maššg
 = 
timeout
;

55 
wa™
 = (
»maššg
 > 
SYNCIO__RESOLUTION
) ?

56 
»maššg
 : 
SYNCIO__RESOLUTION
;

57 
–­£d
;

61 
nwr™‹n
 = 
	`wr™e
(
fd
,
±r
,
size
);

62 ià(
nwr™‹n
 == -1) {

63 ià(
”ºo
 !ğ
EAGAIN
)  -1;

65 
±r
 +ğ
nwr™‹n
;

66 
size
 -ğ
nwr™‹n
;

68 ià(
size
 =ğ0è 
»t
;

71 
	`«Wa™
(
fd
,
AE_WRITABLE
,
wa™
);

72 
–­£d
 = 
	`m¡ime
(è- 
¡¬t
;

73 ià(
–­£d
 >ğ
timeout
) {

74 
”ºo
 = 
ETIMEDOUT
;

77 
»maššg
 = 
timeout
 - 
–­£d
;

79 
	}
}

85 
ssize_t
 
	$syncR—d
(
fd
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

86 
ssize_t
 
Ä—d
, 
tÙ»ad
 = 0;

87 
¡¬t
 = 
	`m¡ime
();

88 
»maššg
 = 
timeout
;

90 ià(
size
 == 0)  0;

92 
wa™
 = (
»maššg
 > 
SYNCIO__RESOLUTION
) ?

93 
»maššg
 : 
SYNCIO__RESOLUTION
;

94 
–­£d
;

98 
Ä—d
 = 
	`»ad
(
fd
,
±r
,
size
);

99 ià(
Ä—d
 == 0)  -1;

100 ià(
Ä—d
 == -1) {

101 ià(
”ºo
 !ğ
EAGAIN
)  -1;

103 
±r
 +ğ
Ä—d
;

104 
size
 -ğ
Ä—d
;

105 
tÙ»ad
 +ğ
Ä—d
;

107 ià(
size
 =ğ0è 
tÙ»ad
;

110 
	`«Wa™
(
fd
,
AE_READABLE
,
wa™
);

111 
–­£d
 = 
	`m¡ime
(è- 
¡¬t
;

112 ià(
–­£d
 >ğ
timeout
) {

113 
”ºo
 = 
ETIMEDOUT
;

116 
»maššg
 = 
timeout
 - 
–­£d
;

118 
	}
}

125 
ssize_t
 
	$syncR—dLše
(
fd
, *
±r
, 
ssize_t
 
size
, 
timeout
) {

126 
ssize_t
 
Ä—d
 = 0;

128 
size
--;

129 
size
) {

130 
c
;

132 ià(
	`syncR—d
(
fd
,&
c
,1,
timeout
) == -1)  -1;

133 ià(
c
 == '\n') {

134 *
±r
 = '\0';

135 ià(
Ä—d
 && *(
±r
-1) == '\r') *(ptr-1) = '\0';

136  
Ä—d
;

138 *
±r
++ = 
c
;

139 *
±r
 = '\0';

140 
Ä—d
++;

142 
size
--;

144  
Ä—d
;

145 
	}
}

	@src/t_hash.c

30 
	~"£rv”.h
"

31 
	~<m©h.h
>

40 
	$hashTy³TryCÚv”siÚ
(
robj
 *
o
,„obj **
¬gv
, 
¡¬t
, 
’d
) {

41 
i
;

43 ià(
o
->
’codšg
 !ğ
OBJ_ENCODING_ZIPLIST
) ;

45 
i
 = 
¡¬t
; i <ğ
’d
; i++) {

46 ià(
	`sdsEncodedObjeù
(
¬gv
[
i
]) &&

47 
	`sd¦’
(
¬gv
[
i
]->
±r
è> 
£rv”
.
hash_max_zli¡_v®ue
)

49 
	`hashTy³CÚv”t
(
o
, 
OBJ_ENCODING_HT
);

53 
	}
}

56 
	$hashTy³TryObjeùEncodšg
(
robj
 *
subjeù
,„obj **
o1
,„obj **
o2
) {

57 ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

58 ià(
o1
è*o1 = 
	`ŒyObjeùEncodšg
(*o1);

59 ià(
o2
è*o2 = 
	`ŒyObjeùEncodšg
(*o2);

61 
	}
}

65 
	$hashTy³G‘FromZli¡
(
robj
 *
o
,„obj *
f›ld
,

66 **
v¡r
,

67 *
vËn
,

68 *
vÎ
)

70 *
zl
, *
åŒ
 = 
NULL
, *
v±r
 = NULL;

71 
»t
;

73 
	`£rv”As£¹
(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
);

75 
f›ld
 = 
	`g‘DecodedObjeù
(field);

77 
zl
 = 
o
->
±r
;

78 
åŒ
 = 
	`zli¡Index
(
zl
, 
ZIPLIST_HEAD
);

79 ià(
åŒ
 !ğ
NULL
) {

80 
åŒ
 = 
	`zli¡Fšd
(åŒ, 
f›ld
->
±r
, 
	`sd¦’
(field->ptr), 1);

81 ià(
åŒ
 !ğ
NULL
) {

83 
v±r
 = 
	`zli¡Next
(
zl
, 
åŒ
);

84 
	`£rv”As£¹
(
v±r
 !ğ
NULL
);

88 
	`deüRefCouÁ
(
f›ld
);

90 ià(
v±r
 !ğ
NULL
) {

91 
»t
 = 
	`zli¡G‘
(
v±r
, 
v¡r
, 
vËn
, 
vÎ
);

92 
	`£rv”As£¹
(
»t
);

97 
	}
}

101 
	$hashTy³G‘FromHashTabË
(
robj
 *
o
,„obj *
f›ld
,„obj **
v®ue
) {

102 
diùEÁry
 *
de
;

104 
	`£rv”As£¹
(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
);

106 
de
 = 
	`diùFšd
(
o
->
±r
, 
f›ld
);

107 ià(
de
 =ğ
NULL
)  -1;

108 *
v®ue
 = 
	`diùG‘V®
(
de
);

110 
	}
}

118 
robj
 *
	$hashTy³G‘Objeù
(
robj
 *
o
,„obj *
f›ld
) {

119 
robj
 *
v®ue
 = 
NULL
;

121 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

122 *
v¡r
 = 
NULL
;

123 
vËn
 = 
UINT_MAX
;

124 
vÎ
 = 
LLONG_MAX
;

126 ià(
	`hashTy³G‘FromZli¡
(
o
, 
f›ld
, &
v¡r
, &
vËn
, &
vÎ
) == 0) {

127 ià(
v¡r
) {

128 
v®ue
 = 
	`ü—‹SŒšgObjeù
((*)
v¡r
, 
vËn
);

130 
v®ue
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
vÎ
);

133 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

134 
robj
 *
aux
;

136 ià(
	`hashTy³G‘FromHashTabË
(
o
, 
f›ld
, &
aux
) == 0) {

137 
	`šüRefCouÁ
(
aux
);

138 
v®ue
 = 
aux
;

141 
	`£rv”Pªic
("Unknown hashƒncoding");

143  
v®ue
;

144 
	}
}

149 
size_t
 
	$hashTy³G‘V®ueL’gth
(
robj
 *
o
,„obj *
f›ld
) {

150 
size_t
 
Ën
 = 0;

151 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

152 *
v¡r
 = 
NULL
;

153 
vËn
 = 
UINT_MAX
;

154 
vÎ
 = 
LLONG_MAX
;

156 ià(
	`hashTy³G‘FromZli¡
(
o
, 
f›ld
, &
v¡r
, &
vËn
, &
vÎ
) == 0)

157 
Ën
 = 
v¡r
 ? 
vËn
 : 
	`sdig™s10
(
vÎ
);

158 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

159 
robj
 *
aux
;

161 ià(
	`hashTy³G‘FromHashTabË
(
o
, 
f›ld
, &
aux
) == 0)

162 
Ën
 = 
	`¡ršgObjeùL’
(
aux
);

164 
	`£rv”Pªic
("Unknown hashƒncoding");

166  
Ën
;

167 
	}
}

171 
	$hashTy³Exi¡s
(
robj
 *
o
,„obj *
f›ld
) {

172 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

173 *
v¡r
 = 
NULL
;

174 
vËn
 = 
UINT_MAX
;

175 
vÎ
 = 
LLONG_MAX
;

177 ià(
	`hashTy³G‘FromZli¡
(
o
, 
f›ld
, &
v¡r
, &
vËn
, &
vÎ
) == 0)  1;

178 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

179 
robj
 *
aux
;

181 ià(
	`hashTy³G‘FromHashTabË
(
o
, 
f›ld
, &
aux
) == 0)  1;

183 
	`£rv”Pªic
("Unknown hashƒncoding");

186 
	}
}

192 
	$hashTy³S‘
(
robj
 *
o
,„obj *
f›ld
,„obj *
v®ue
) {

193 
upd©e
 = 0;

195 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

196 *
zl
, *
åŒ
, *
v±r
;

198 
f›ld
 = 
	`g‘DecodedObjeù
(field);

199 
v®ue
 = 
	`g‘DecodedObjeù
(value);

201 
zl
 = 
o
->
±r
;

202 
åŒ
 = 
	`zli¡Index
(
zl
, 
ZIPLIST_HEAD
);

203 ià(
åŒ
 !ğ
NULL
) {

204 
åŒ
 = 
	`zli¡Fšd
(åŒ, 
f›ld
->
±r
, 
	`sd¦’
(field->ptr), 1);

205 ià(
åŒ
 !ğ
NULL
) {

207 
v±r
 = 
	`zli¡Next
(
zl
, 
åŒ
);

208 
	`£rv”As£¹
(
v±r
 !ğ
NULL
);

209 
upd©e
 = 1;

212 
zl
 = 
	`zli¡D–‘e
(zl, &
v±r
);

215 
zl
 = 
	`zli¡In£¹
(zl, 
v±r
, 
v®ue
->
±r
, 
	`sd¦’
(value->ptr));

219 ià(!
upd©e
) {

221 
zl
 = 
	`zli¡Push
(zl, 
f›ld
->
±r
, 
	`sd¦’
(f›ld->±r), 
ZIPLIST_TAIL
);

222 
zl
 = 
	`zli¡Push
(zl, 
v®ue
->
±r
, 
	`sd¦’
(v®ue->±r), 
ZIPLIST_TAIL
);

224 
o
->
±r
 = 
zl
;

225 
	`deüRefCouÁ
(
f›ld
);

226 
	`deüRefCouÁ
(
v®ue
);

229 ià(
	`hashTy³L’gth
(
o
è> 
£rv”
.
hash_max_zli¡_’Œ›s
)

230 
	`hashTy³CÚv”t
(
o
, 
OBJ_ENCODING_HT
);

231 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

232 ià(
	`diùR•Ïû
(
o
->
±r
, 
f›ld
, 
v®ue
)) {

233 
	`šüRefCouÁ
(
f›ld
);

235 
upd©e
 = 1;

237 
	`šüRefCouÁ
(
v®ue
);

239 
	`£rv”Pªic
("Unknown hashƒncoding");

241  
upd©e
;

242 
	}
}

246 
	$hashTy³D–‘e
(
robj
 *
o
,„obj *
f›ld
) {

247 
d–‘ed
 = 0;

249 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

250 *
zl
, *
åŒ
;

252 
f›ld
 = 
	`g‘DecodedObjeù
(field);

254 
zl
 = 
o
->
±r
;

255 
åŒ
 = 
	`zli¡Index
(
zl
, 
ZIPLIST_HEAD
);

256 ià(
åŒ
 !ğ
NULL
) {

257 
åŒ
 = 
	`zli¡Fšd
(åŒ, 
f›ld
->
±r
, 
	`sd¦’
(field->ptr), 1);

258 ià(
åŒ
 !ğ
NULL
) {

259 
zl
 = 
	`zli¡D–‘e
(zl,&
åŒ
);

260 
zl
 = 
	`zli¡D–‘e
(zl,&
åŒ
);

261 
o
->
±r
 = 
zl
;

262 
d–‘ed
 = 1;

266 
	`deüRefCouÁ
(
f›ld
);

268 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

269 ià(
	`diùD–‘e
((
diù
*)
o
->
±r
, 
f›ld
è=ğ
C_OK
) {

270 
d–‘ed
 = 1;

273 ià(
	`htN“dsResize
(
o
->
±r
)è
	`diùResize
(o->ptr);

277 
	`£rv”Pªic
("Unknown hashƒncoding");

280  
d–‘ed
;

281 
	}
}

284 
	$hashTy³L’gth
(
robj
 *
o
) {

285 
Ëngth
 = 
ULONG_MAX
;

287 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

288 
Ëngth
 = 
	`zli¡L’
(
o
->
±r
) / 2;

289 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

290 
Ëngth
 = 
	`diùSize
((
diù
*)
o
->
±r
);

292 
	`£rv”Pªic
("Unknown hashƒncoding");

295  
Ëngth
;

296 
	}
}

298 
hashTy³I‹¿tÜ
 *
	$hashTy³In™I‹¿tÜ
(
robj
 *
subjeù
) {

299 
hashTy³I‹¿tÜ
 *
hi
 = 
	`zm®loc
((hashTypeIterator));

300 
hi
->
subjeù
 = subject;

301 
hi
->
’codšg
 = 
subjeù
->encoding;

303 ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

304 
hi
->
åŒ
 = 
NULL
;

305 
hi
->
v±r
 = 
NULL
;

306 } ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

307 
hi
->
di
 = 
	`diùG‘I‹¿tÜ
(
subjeù
->
±r
);

309 
	`£rv”Pªic
("Unknown hashƒncoding");

312  
hi
;

313 
	}
}

315 
	$hashTy³R–—£I‹¿tÜ
(
hashTy³I‹¿tÜ
 *
hi
) {

316 ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

317 
	`diùR–—£I‹¿tÜ
(
hi
->
di
);

320 
	`zä“
(
hi
);

321 
	}
}

325 
	$hashTy³Next
(
hashTy³I‹¿tÜ
 *
hi
) {

326 ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

327 *
zl
;

328 *
åŒ
, *
v±r
;

330 
zl
 = 
hi
->
subjeù
->
±r
;

331 
åŒ
 = 
hi
->fptr;

332 
v±r
 = 
hi
->vptr;

334 ià(
åŒ
 =ğ
NULL
) {

336 
	`£rv”As£¹
(
v±r
 =ğ
NULL
);

337 
åŒ
 = 
	`zli¡Index
(
zl
, 0);

340 
	`£rv”As£¹
(
v±r
 !ğ
NULL
);

341 
åŒ
 = 
	`zli¡Next
(
zl
, 
v±r
);

343 ià(
åŒ
 =ğ
NULL
è 
C_ERR
;

346 
v±r
 = 
	`zli¡Next
(
zl
, 
åŒ
);

347 
	`£rv”As£¹
(
v±r
 !ğ
NULL
);

350 
hi
->
åŒ
 = fptr;

351 
hi
->
v±r
 = vptr;

352 } ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

353 ià((
hi
->
de
 = 
	`diùNext
(hi->
di
)è=ğ
NULL
è 
C_ERR
;

355 
	`£rv”Pªic
("Unknown hashƒncoding");

357  
C_OK
;

358 
	}
}

362 
	$hashTy³Cu¼’tFromZli¡
(
hashTy³I‹¿tÜ
 *
hi
, 
wh©
,

363 **
v¡r
,

364 *
vËn
,

365 *
vÎ
)

367 
»t
;

369 
	`£rv”As£¹
(
hi
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
);

371 ià(
wh©
 & 
OBJ_HASH_KEY
) {

372 
»t
 = 
	`zli¡G‘
(
hi
->
åŒ
, 
v¡r
, 
vËn
, 
vÎ
);

373 
	`£rv”As£¹
(
»t
);

375 
»t
 = 
	`zli¡G‘
(
hi
->
v±r
, 
v¡r
, 
vËn
, 
vÎ
);

376 
	`£rv”As£¹
(
»t
);

378 
	}
}

382 
	$hashTy³Cu¼’tFromHashTabË
(
hashTy³I‹¿tÜ
 *
hi
, 
wh©
, 
robj
 **
d¡
) {

383 
	`£rv”As£¹
(
hi
->
’codšg
 =ğ
OBJ_ENCODING_HT
);

385 ià(
wh©
 & 
OBJ_HASH_KEY
) {

386 *
d¡
 = 
	`diùG‘Key
(
hi
->
de
);

388 *
d¡
 = 
	`diùG‘V®
(
hi
->
de
);

390 
	}
}

395 
robj
 *
	$hashTy³Cu¼’tObjeù
(
hashTy³I‹¿tÜ
 *
hi
, 
wh©
) {

396 
robj
 *
d¡
;

398 ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

399 *
v¡r
 = 
NULL
;

400 
vËn
 = 
UINT_MAX
;

401 
vÎ
 = 
LLONG_MAX
;

403 
	`hashTy³Cu¼’tFromZli¡
(
hi
, 
wh©
, &
v¡r
, &
vËn
, &
vÎ
);

404 ià(
v¡r
) {

405 
d¡
 = 
	`ü—‹SŒšgObjeù
((*)
v¡r
, 
vËn
);

407 
d¡
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
vÎ
);

409 } ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

410 
	`hashTy³Cu¼’tFromHashTabË
(
hi
, 
wh©
, &
d¡
);

411 
	`šüRefCouÁ
(
d¡
);

413 
	`£rv”Pªic
("Unknown hashƒncoding");

415  
d¡
;

416 
	}
}

418 
robj
 *
	$hashTy³LookupWr™eOrC»©e
(
ş›Á
 *
c
, 
robj
 *
key
) {

419 
robj
 *
o
 = 
	`lookupKeyWr™e
(
c
->
db
,
key
);

420 ià(
o
 =ğ
NULL
) {

421 
o
 = 
	`ü—‹HashObjeù
();

422 
	`dbAdd
(
c
->
db
,
key
,
o
);

424 ià(
o
->
ty³
 !ğ
OBJ_HASH
) {

425 
	`addR•ly
(
c
,
sh¬ed
.
wrÚgty³”r
);

426  
NULL
;

429  
o
;

430 
	}
}

432 
	$hashTy³CÚv”tZli¡
(
robj
 *
o
, 
’c
) {

433 
	`£rv”As£¹
(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
);

435 ià(
’c
 =ğ
OBJ_ENCODING_ZIPLIST
) {

438 } ià(
’c
 =ğ
OBJ_ENCODING_HT
) {

439 
hashTy³I‹¿tÜ
 *
hi
;

440 
diù
 *dict;

441 
»t
;

443 
hi
 = 
	`hashTy³In™I‹¿tÜ
(
o
);

444 
diù
 = 
	`diùC»©e
(&
hashDiùTy³
, 
NULL
);

446 
	`hashTy³Next
(
hi
è!ğ
C_ERR
) {

447 
robj
 *
f›ld
, *
v®ue
;

449 
f›ld
 = 
	`hashTy³Cu¼’tObjeù
(
hi
, 
OBJ_HASH_KEY
);

450 
f›ld
 = 
	`ŒyObjeùEncodšg
(field);

451 
v®ue
 = 
	`hashTy³Cu¼’tObjeù
(
hi
, 
OBJ_HASH_VALUE
);

452 
v®ue
 = 
	`ŒyObjeùEncodšg
(value);

453 
»t
 = 
	`diùAdd
(
diù
, 
f›ld
, 
v®ue
);

454 ià(
»t
 !ğ
DICT_OK
) {

455 
	`£rv”LogHexDump
(
LL_WARNING
,"ziplist with dupƒlements dump",

456 
o
->
±r
,
	`zli¡BlobL’
(o->ptr));

457 
	`£rv”As£¹
(
»t
 =ğ
DICT_OK
);

461 
	`hashTy³R–—£I‹¿tÜ
(
hi
);

462 
	`zä“
(
o
->
±r
);

464 
o
->
’codšg
 = 
OBJ_ENCODING_HT
;

465 
o
->
±r
 = 
diù
;

468 
	`£rv”Pªic
("Unknown hashƒncoding");

470 
	}
}

472 
	$hashTy³CÚv”t
(
robj
 *
o
, 
’c
) {

473 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

474 
	`hashTy³CÚv”tZli¡
(
o
, 
’c
);

475 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

476 
	`£rv”Pªic
("Not implemented");

478 
	`£rv”Pªic
("Unknown hashƒncoding");

480 
	}
}

486 
	$h£tCommªd
(
ş›Á
 *
c
) {

487 
upd©e
;

488 
robj
 *
o
;

490 ià((
o
 = 
	`hashTy³LookupWr™eOrC»©e
(
c
,c->
¬gv
[1])è=ğ
NULL
) ;

491 
	`hashTy³TryCÚv”siÚ
(
o
,
c
->
¬gv
,2,3);

492 
	`hashTy³TryObjeùEncodšg
(
o
,&
c
->
¬gv
[2], &c->argv[3]);

493 
upd©e
 = 
	`hashTy³S‘
(
o
,
c
->
¬gv
[2],c->argv[3]);

494 
	`addR•ly
(
c
, 
upd©e
 ? 
sh¬ed
.
cz”o
 : sh¬ed.
cÚe
);

495 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

496 
	`nÙifyKey¥aûEv’t
(
NOTIFY_HASH
,"h£t",
c
->
¬gv
[1],c->
db
->
id
);

497 
£rv”
.
dœty
++;

498 
	}
}

500 
	$h£ŠxCommªd
(
ş›Á
 *
c
) {

501 
robj
 *
o
;

502 ià((
o
 = 
	`hashTy³LookupWr™eOrC»©e
(
c
,c->
¬gv
[1])è=ğ
NULL
) ;

503 
	`hashTy³TryCÚv”siÚ
(
o
,
c
->
¬gv
,2,3);

505 ià(
	`hashTy³Exi¡s
(
o
, 
c
->
¬gv
[2])) {

506 
	`addR•ly
(
c
, 
sh¬ed
.
cz”o
);

508 
	`hashTy³TryObjeùEncodšg
(
o
,&
c
->
¬gv
[2], &c->argv[3]);

509 
	`hashTy³S‘
(
o
,
c
->
¬gv
[2],c->argv[3]);

510 
	`addR•ly
(
c
, 
sh¬ed
.
cÚe
);

511 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

512 
	`nÙifyKey¥aûEv’t
(
NOTIFY_HASH
,"h£t",
c
->
¬gv
[1],c->
db
->
id
);

513 
£rv”
.
dœty
++;

515 
	}
}

517 
	$hm£tCommªd
(
ş›Á
 *
c
) {

518 
i
;

519 
robj
 *
o
;

521 ià((
c
->
¬gc
 % 2) == 1) {

522 
	`addR•lyE¼Ü
(
c
,"wrong‚umber of‡rguments for HMSET");

526 ià((
o
 = 
	`hashTy³LookupWr™eOrC»©e
(
c
,c->
¬gv
[1])è=ğ
NULL
) ;

527 
	`hashTy³TryCÚv”siÚ
(
o
,
c
->
¬gv
,2,c->
¬gc
-1);

528 
i
 = 2; i < 
c
->
¬gc
; i += 2) {

529 
	`hashTy³TryObjeùEncodšg
(
o
,&
c
->
¬gv
[
i
], &c->argv[i+1]);

530 
	`hashTy³S‘
(
o
,
c
->
¬gv
[
i
],c->argv[i+1]);

532 
	`addR•ly
(
c
, 
sh¬ed
.
ok
);

533 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

534 
	`nÙifyKey¥aûEv’t
(
NOTIFY_HASH
,"h£t",
c
->
¬gv
[1],c->
db
->
id
);

535 
£rv”
.
dœty
++;

536 
	}
}

538 
	$hšübyCommªd
(
ş›Á
 *
c
) {

539 
v®ue
, 
šü
, 
Şdv®ue
;

540 
robj
 *
o
, *
cu¼’t
, *
Ãw
;

542 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
šü
,
NULL
è!ğ
C_OK
) ;

543 ià((
o
 = 
	`hashTy³LookupWr™eOrC»©e
(
c
,c->
¬gv
[1])è=ğ
NULL
) ;

544 ià((
cu¼’t
 = 
	`hashTy³G‘Objeù
(
o
,
c
->
¬gv
[2])è!ğ
NULL
) {

545 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,
cu¼’t
,&
v®ue
,

546 "hash v®ui nÙ‡Àš‹g”"è!ğ
C_OK
) {

547 
	`deüRefCouÁ
(
cu¼’t
);

550 
	`deüRefCouÁ
(
cu¼’t
);

552 
v®ue
 = 0;

555 
Şdv®ue
 = 
v®ue
;

556 ià((
šü
 < 0 && 
Şdv®ue
 < 0 && inü < (
LLONG_MIN
-oldvalue)) ||

557 (
šü
 > 0 && 
Şdv®ue
 > 0 && inü > (
LLONG_MAX
-oldvalue))) {

558 
	`addR•lyE¼Ü
(
c
,"increment or decrement would overflow");

561 
v®ue
 +ğ
šü
;

562 
Ãw
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
v®ue
);

563 
	`hashTy³TryObjeùEncodšg
(
o
,&
c
->
¬gv
[2],
NULL
);

564 
	`hashTy³S‘
(
o
,
c
->
¬gv
[2],
Ãw
);

565 
	`deüRefCouÁ
(
Ãw
);

566 
	`addR•lyLÚgLÚg
(
c
,
v®ue
);

567 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

568 
	`nÙifyKey¥aûEv’t
(
NOTIFY_HASH
,"hšüby",
c
->
¬gv
[1],c->
db
->
id
);

569 
£rv”
.
dœty
++;

570 
	}
}

572 
	$hšübyæßtCommªd
(
ş›Á
 *
c
) {

573 
v®ue
, 
šü
;

574 
robj
 *
o
, *
cu¼’t
, *
Ãw
, *
aux
;

576 ià(
	`g‘LÚgDoubËFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
šü
,
NULL
è!ğ
C_OK
) ;

577 ià((
o
 = 
	`hashTy³LookupWr™eOrC»©e
(
c
,c->
¬gv
[1])è=ğ
NULL
) ;

578 ià((
cu¼’t
 = 
	`hashTy³G‘Objeù
(
o
,
c
->
¬gv
[2])è!ğ
NULL
) {

579 ià(
	`g‘LÚgDoubËFromObjeùOrR•ly
(
c
,
cu¼’t
,&
v®ue
,

580 "hash v®ui nÙ‡ v®id flßt"è!ğ
C_OK
) {

581 
	`deüRefCouÁ
(
cu¼’t
);

584 
	`deüRefCouÁ
(
cu¼’t
);

586 
v®ue
 = 0;

589 
v®ue
 +ğ
šü
;

590 
Ãw
 = 
	`ü—‹SŒšgObjeùFromLÚgDoubË
(
v®ue
,1);

591 
	`hashTy³TryObjeùEncodšg
(
o
,&
c
->
¬gv
[2],
NULL
);

592 
	`hashTy³S‘
(
o
,
c
->
¬gv
[2],
Ãw
);

593 
	`addR•lyBulk
(
c
,
Ãw
);

594 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

595 
	`nÙifyKey¥aûEv’t
(
NOTIFY_HASH
,"hšübyæßt",
c
->
¬gv
[1],c->
db
->
id
);

596 
£rv”
.
dœty
++;

601 
aux
 = 
	`ü—‹SŒšgObjeù
("HSET",4);

602 
	`»wr™eCl›ÁCommªdArgum’t
(
c
,0,
aux
);

603 
	`deüRefCouÁ
(
aux
);

604 
	`»wr™eCl›ÁCommªdArgum’t
(
c
,3,
Ãw
);

605 
	`deüRefCouÁ
(
Ãw
);

606 
	}
}

608 
	$addHashF›ldToR•ly
(
ş›Á
 *
c
, 
robj
 *
o
,„obj *
f›ld
) {

609 
»t
;

611 ià(
o
 =ğ
NULL
) {

612 
	`addR•ly
(
c
, 
sh¬ed
.
nuÎbulk
);

616 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

617 *
v¡r
 = 
NULL
;

618 
vËn
 = 
UINT_MAX
;

619 
vÎ
 = 
LLONG_MAX
;

621 
»t
 = 
	`hashTy³G‘FromZli¡
(
o
, 
f›ld
, &
v¡r
, &
vËn
, &
vÎ
);

622 ià(
»t
 < 0) {

623 
	`addR•ly
(
c
, 
sh¬ed
.
nuÎbulk
);

625 ià(
v¡r
) {

626 
	`addR•lyBulkCBufãr
(
c
, 
v¡r
, 
vËn
);

628 
	`addR•lyBulkLÚgLÚg
(
c
, 
vÎ
);

632 } ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

633 
robj
 *
v®ue
;

635 
»t
 = 
	`hashTy³G‘FromHashTabË
(
o
, 
f›ld
, &
v®ue
);

636 ià(
»t
 < 0) {

637 
	`addR•ly
(
c
, 
sh¬ed
.
nuÎbulk
);

639 
	`addR•lyBulk
(
c
, 
v®ue
);

643 
	`£rv”Pªic
("Unknown hashƒncoding");

645 
	}
}

647 
	$hg‘Commªd
(
ş›Á
 *
c
) {

648 
robj
 *
o
;

650 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
nuÎbulk
)è=ğ
NULL
 ||

651 
	`checkTy³
(
c
,
o
,
OBJ_HASH
)) ;

653 
	`addHashF›ldToR•ly
(
c
, 
o
, c->
¬gv
[2]);

654 
	}
}

656 
	$hmg‘Commªd
(
ş›Á
 *
c
) {

657 
robj
 *
o
;

658 
i
;

662 
o
 = 
	`lookupKeyR—d
(
c
->
db
, c->
¬gv
[1]);

663 ià(
o
 !ğ
NULL
 && o->
ty³
 !ğ
OBJ_HASH
) {

664 
	`addR•ly
(
c
, 
sh¬ed
.
wrÚgty³”r
);

668 
	`addR•lyMuÉiBulkL’
(
c
, c->
¬gc
-2);

669 
i
 = 2; i < 
c
->
¬gc
; i++) {

670 
	`addHashF›ldToR•ly
(
c
, 
o
, c->
¬gv
[
i
]);

672 
	}
}

674 
	$hd–Commªd
(
ş›Á
 *
c
) {

675 
robj
 *
o
;

676 
j
, 
d–‘ed
 = 0, 
key»moved
 = 0;

678 ià((
o
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

679 
	`checkTy³
(
c
,
o
,
OBJ_HASH
)) ;

681 
j
 = 2; j < 
c
->
¬gc
; j++) {

682 ià(
	`hashTy³D–‘e
(
o
,
c
->
¬gv
[
j
])) {

683 
d–‘ed
++;

684 ià(
	`hashTy³L’gth
(
o
) == 0) {

685 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

686 
key»moved
 = 1;

691 ià(
d–‘ed
) {

692 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

693 
	`nÙifyKey¥aûEv’t
(
NOTIFY_HASH
,"hd–",
c
->
¬gv
[1],c->
db
->
id
);

694 ià(
key»moved
)

695 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
c
->
¬gv
[1],

696 
c
->
db
->
id
);

697 
£rv”
.
dœty
 +ğ
d–‘ed
;

699 
	`addR•lyLÚgLÚg
(
c
,
d–‘ed
);

700 
	}
}

702 
	$hËnCommªd
(
ş›Á
 *
c
) {

703 
robj
 *
o
;

705 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

706 
	`checkTy³
(
c
,
o
,
OBJ_HASH
)) ;

708 
	`addR•lyLÚgLÚg
(
c
,
	`hashTy³L’gth
(
o
));

709 
	}
}

711 
	$h¡¾’Commªd
(
ş›Á
 *
c
) {

712 
robj
 *
o
;

714 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

715 
	`checkTy³
(
c
,
o
,
OBJ_HASH
)) ;

716 
	`addR•lyLÚgLÚg
(
c
,
	`hashTy³G‘V®ueL’gth
(
o
,c->
¬gv
[2]));

717 
	}
}

719 
	$addHashI‹¿tÜCursÜToR•ly
(
ş›Á
 *
c
, 
hashTy³I‹¿tÜ
 *
hi
, 
wh©
) {

720 ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

721 *
v¡r
 = 
NULL
;

722 
vËn
 = 
UINT_MAX
;

723 
vÎ
 = 
LLONG_MAX
;

725 
	`hashTy³Cu¼’tFromZli¡
(
hi
, 
wh©
, &
v¡r
, &
vËn
, &
vÎ
);

726 ià(
v¡r
) {

727 
	`addR•lyBulkCBufãr
(
c
, 
v¡r
, 
vËn
);

729 
	`addR•lyBulkLÚgLÚg
(
c
, 
vÎ
);

732 } ià(
hi
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

733 
robj
 *
v®ue
;

735 
	`hashTy³Cu¼’tFromHashTabË
(
hi
, 
wh©
, &
v®ue
);

736 
	`addR•lyBulk
(
c
, 
v®ue
);

739 
	`£rv”Pªic
("Unknown hashƒncoding");

741 
	}
}

743 
	$g’”icHg‘®lCommªd
(
ş›Á
 *
c
, 
æags
) {

744 
robj
 *
o
;

745 
hashTy³I‹¿tÜ
 *
hi
;

746 
muÉl›r
 = 0;

747 
Ëngth
, 
couÁ
 = 0;

749 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
em±ymuÉibulk
)è=ğ
NULL


750 || 
	`checkTy³
(
c
,
o
,
OBJ_HASH
)) ;

752 ià(
æags
 & 
OBJ_HASH_KEY
è
muÉl›r
++;

753 ià(
æags
 & 
OBJ_HASH_VALUE
è
muÉl›r
++;

755 
Ëngth
 = 
	`hashTy³L’gth
(
o
è* 
muÉl›r
;

756 
	`addR•lyMuÉiBulkL’
(
c
, 
Ëngth
);

758 
hi
 = 
	`hashTy³In™I‹¿tÜ
(
o
);

759 
	`hashTy³Next
(
hi
è!ğ
C_ERR
) {

760 ià(
æags
 & 
OBJ_HASH_KEY
) {

761 
	`addHashI‹¿tÜCursÜToR•ly
(
c
, 
hi
, 
OBJ_HASH_KEY
);

762 
couÁ
++;

764 ià(
æags
 & 
OBJ_HASH_VALUE
) {

765 
	`addHashI‹¿tÜCursÜToR•ly
(
c
, 
hi
, 
OBJ_HASH_VALUE
);

766 
couÁ
++;

770 
	`hashTy³R–—£I‹¿tÜ
(
hi
);

771 
	`£rv”As£¹
(
couÁ
 =ğ
Ëngth
);

772 
	}
}

774 
	$hkeysCommªd
(
ş›Á
 *
c
) {

775 
	`g’”icHg‘®lCommªd
(
c
,
OBJ_HASH_KEY
);

776 
	}
}

778 
	$hv®sCommªd
(
ş›Á
 *
c
) {

779 
	`g’”icHg‘®lCommªd
(
c
,
OBJ_HASH_VALUE
);

780 
	}
}

782 
	$hg‘®lCommªd
(
ş›Á
 *
c
) {

783 
	`g’”icHg‘®lCommªd
(
c
,
OBJ_HASH_KEY
|
OBJ_HASH_VALUE
);

784 
	}
}

786 
	$hexi¡sCommªd
(
ş›Á
 *
c
) {

787 
robj
 *
o
;

788 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

789 
	`checkTy³
(
c
,
o
,
OBJ_HASH
)) ;

791 
	`addR•ly
(
c
, 
	`hashTy³Exi¡s
(
o
,c->
¬gv
[2]è? 
sh¬ed
.
cÚe
 : sh¬ed.
cz”o
);

792 
	}
}

794 
	$hsÿnCommªd
(
ş›Á
 *
c
) {

795 
robj
 *
o
;

796 
cursÜ
;

798 ià(
	`·r£SÿnCursÜOrR•ly
(
c
,c->
¬gv
[2],&
cursÜ
è=ğ
C_ERR
) ;

799 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
em±ysÿn
)è=ğ
NULL
 ||

800 
	`checkTy³
(
c
,
o
,
OBJ_HASH
)) ;

801 
	`sÿnG’”icCommªd
(
c
,
o
,
cursÜ
);

802 
	}
}

	@src/t_list.c

30 
	~"£rv”.h
"

41 
	$li¡Ty³Push
(
robj
 *
subjeù
,„obj *
v®ue
, 
wh”e
) {

42 ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

43 
pos
 = (
wh”e
 =ğ
REDIS_LIST_HEAD
è? 
QUICKLIST_HEAD
 : 
QUICKLIST_TAIL
;

44 
v®ue
 = 
	`g‘DecodedObjeù
(value);

45 
size_t
 
Ën
 = 
	`sd¦’
(
v®ue
->
±r
);

46 
	`quickli¡Push
(
subjeù
->
±r
, 
v®ue
->±r, 
Ën
, 
pos
);

47 
	`deüRefCouÁ
(
v®ue
);

49 
	`£rv”Pªic
("Unknown†istƒncoding");

51 
	}
}

53 *
	$li¡PİSav”
(*
d©a
, 
sz
) {

54  
	`ü—‹SŒšgObjeù
((*)
d©a
,
sz
);

55 
	}
}

57 
robj
 *
	$li¡Ty³Pİ
(
robj
 *
subjeù
, 
wh”e
) {

58 
vlÚg
;

59 
robj
 *
v®ue
 = 
NULL
;

61 
ql_wh”e
 = 
wh”e
 =ğ
REDIS_LIST_HEAD
 ? 
QUICKLIST_HEAD
 : 
QUICKLIST_TAIL
;

62 ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

63 ià(
	`quickli¡PİCu¡om
(
subjeù
->
±r
, 
ql_wh”e
, (**)&
v®ue
,

64 
NULL
, &
vlÚg
, 
li¡PİSav”
)) {

65 ià(!
v®ue
)

66 
v®ue
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
vlÚg
);

69 
	`£rv”Pªic
("Unknown†istƒncoding");

71  
v®ue
;

72 
	}
}

74 
	$li¡Ty³L’gth
(
robj
 *
subjeù
) {

75 ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

76  
	`quickli¡CouÁ
(
subjeù
->
±r
);

78 
	`£rv”Pªic
("Unknown†istƒncoding");

80 
	}
}

83 
li¡Ty³I‹¿tÜ
 *
	$li¡Ty³In™I‹¿tÜ
(
robj
 *
subjeù
, 
šdex
,

84 
dœeùiÚ
) {

85 
li¡Ty³I‹¿tÜ
 *
li
 = 
	`zm®loc
((listTypeIterator));

86 
li
->
subjeù
 = subject;

87 
li
->
’codšg
 = 
subjeù
->encoding;

88 
li
->
dœeùiÚ
 = direction;

89 
li
->
™”
 = 
NULL
;

92 
™”_dœeùiÚ
 =

93 
dœeùiÚ
 =ğ
REDIS_LIST_HEAD
 ? 
AL_START_TAIL
 : 
AL_START_HEAD
;

94 ià(
li
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

95 
li
->
™”
 = 
	`quickli¡G‘I‹¿tÜAtIdx
Öi->
subjeù
->
±r
,

96 
™”_dœeùiÚ
, 
šdex
);

98 
	`£rv”Pªic
("Unknown†istƒncoding");

100  
li
;

101 
	}
}

104 
	$li¡Ty³R–—£I‹¿tÜ
(
li¡Ty³I‹¿tÜ
 *
li
) {

105 
	`zä“
(
li
->
™”
);

106 
	`zä“
(
li
);

107 
	}
}

112 
	$li¡Ty³Next
(
li¡Ty³I‹¿tÜ
 *
li
, 
li¡Ty³EÁry
 *
’Œy
) {

114 
	`£rv”As£¹
(
li
->
subjeù
->
’codšg
 ==†i->encoding);

116 
’Œy
->
li
 =†i;

117 ià(
li
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

118  
	`quickli¡Next
(
li
->
™”
, &
’Œy
->entry);

120 
	`£rv”Pªic
("Unknown†istƒncoding");

123 
	}
}

126 
robj
 *
	$li¡Ty³G‘
(
li¡Ty³EÁry
 *
’Œy
) {

127 
robj
 *
v®ue
 = 
NULL
;

128 ià(
’Œy
->
li
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

129 ià(
’Œy
->’Œy.
v®ue
) {

130 
v®ue
 = 
	`ü—‹SŒšgObjeù
((*)
’Œy
->entry.value,

131 
’Œy
->’Œy.
sz
);

133 
v®ue
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
’Œy
->’Œy.
lÚgv®
);

136 
	`£rv”Pªic
("Unknown†istƒncoding");

138  
v®ue
;

139 
	}
}

141 
	$li¡Ty³In£¹
(
li¡Ty³EÁry
 *
’Œy
, 
robj
 *
v®ue
, 
wh”e
) {

142 ià(
’Œy
->
li
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

143 
v®ue
 = 
	`g‘DecodedObjeù
(value);

144 
sds
 
¡r
 = 
v®ue
->
±r
;

145 
size_t
 
Ën
 = 
	`sd¦’
(
¡r
);

146 ià(
wh”e
 =ğ
REDIS_LIST_TAIL
) {

147 
	`quickli¡In£¹Aá”
((
quickli¡
 *)
’Œy
->entry.quicklist,

148 &
’Œy
->’Œy, 
¡r
, 
Ën
);

149 } ià(
wh”e
 =ğ
REDIS_LIST_HEAD
) {

150 
	`quickli¡In£¹BefÜe
((
quickli¡
 *)
’Œy
->entry.quicklist,

151 &
’Œy
->’Œy, 
¡r
, 
Ën
);

153 
	`deüRefCouÁ
(
v®ue
);

155 
	`£rv”Pªic
("Unknown†istƒncoding");

157 
	}
}

160 
	$li¡Ty³Equ®
(
li¡Ty³EÁry
 *
’Œy
, 
robj
 *
o
) {

161 ià(
’Œy
->
li
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

162 
	`£rv”As£¹W™hInfo
(
NULL
,
o
,
	`sdsEncodedObjeù
(o));

163  
	`quickli¡Com·»
(
’Œy
->’Œy.
zi
,
o
->
±r
,
	`sd¦’
(o->ptr));

165 
	`£rv”Pªic
("Unknown†istƒncoding");

167 
	}
}

170 
	$li¡Ty³D–‘e
(
li¡Ty³I‹¿tÜ
 *
™”
, 
li¡Ty³EÁry
 *
’Œy
) {

171 ià(
’Œy
->
li
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

172 
	`quickli¡D–EÁry
(
™”
->™”, &
’Œy
->entry);

174 
	`£rv”Pªic
("Unknown†istƒncoding");

176 
	}
}

179 
	$li¡Ty³CÚv”t
(
robj
 *
subjeù
, 
’c
) {

180 
	`£rv”As£¹W™hInfo
(
NULL
,
subjeù
,subjeù->
ty³
==
OBJ_LIST
);

181 
	`£rv”As£¹W™hInfo
(
NULL
,
subjeù
,subjeù->
’codšg
==
OBJ_ENCODING_ZIPLIST
);

183 ià(
’c
 =ğ
OBJ_ENCODING_QUICKLIST
) {

184 
size_t
 
zËn
 = 
£rv”
.
li¡_max_zli¡_size
;

185 
d•th
 = 
£rv”
.
li¡_com´ess_d•th
;

186 
subjeù
->
±r
 = 
	`quickli¡C»©eFromZli¡
(
zËn
, 
d•th
, subject->ptr);

187 
subjeù
->
’codšg
 = 
OBJ_ENCODING_QUICKLIST
;

189 
	`£rv”Pªic
("Unsupported†ist conversion");

191 
	}
}

197 
	$pushG’”icCommªd
(
ş›Á
 *
c
, 
wh”e
) {

198 
j
, 
wa™šg
 = 0, 
pushed
 = 0;

199 
robj
 *
lobj
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

201 ià(
lobj
 &&†obj->
ty³
 !ğ
OBJ_LIST
) {

202 
	`addR•ly
(
c
,
sh¬ed
.
wrÚgty³”r
);

206 
j
 = 2; j < 
c
->
¬gc
; j++) {

207 
c
->
¬gv
[
j
] = 
	`ŒyObjeùEncodšg
(c->argv[j]);

208 ià(!
lobj
) {

209 
lobj
 = 
	`ü—‹Quickli¡Objeù
();

210 
	`quickli¡S‘O±iÚs
(
lobj
->
±r
, 
£rv”
.
li¡_max_zli¡_size
,

211 
£rv”
.
li¡_com´ess_d•th
);

212 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],
lobj
);

214 
	`li¡Ty³Push
(
lobj
,
c
->
¬gv
[
j
],
wh”e
);

215 
pushed
++;

217 
	`addR•lyLÚgLÚg
(
c
, 
wa™šg
 + (
lobj
 ? 
	`li¡Ty³L’gth
(lobj) : 0));

218 ià(
pushed
) {

219 *
ev’t
 = (
wh”e
 =ğ
REDIS_LIST_HEAD
) ? "lpush" : "rpush";

221 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

222 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,
ev’t
,
c
->
¬gv
[1],c->
db
->
id
);

224 
£rv”
.
dœty
 +ğ
pushed
;

225 
	}
}

227 
	$ÍushCommªd
(
ş›Á
 *
c
) {

228 
	`pushG’”icCommªd
(
c
,
REDIS_LIST_HEAD
);

229 
	}
}

231 
	$½ushCommªd
(
ş›Á
 *
c
) {

232 
	`pushG’”icCommªd
(
c
,
REDIS_LIST_TAIL
);

233 
	}
}

235 
	$pushxG’”icCommªd
(
ş›Á
 *
c
, 
robj
 *
»fv®
,„obj *
v®
, 
wh”e
) {

236 
robj
 *
subjeù
;

237 
li¡Ty³I‹¿tÜ
 *
™”
;

238 
li¡Ty³EÁry
 
’Œy
;

239 
š£¹ed
 = 0;

241 ià((
subjeù
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

242 
	`checkTy³
(
c
,
subjeù
,
OBJ_LIST
)) ;

244 ià(
»fv®
 !ğ
NULL
) {

246 
™”
 = 
	`li¡Ty³In™I‹¿tÜ
(
subjeù
,0,
REDIS_LIST_TAIL
);

247 
	`li¡Ty³Next
(
™”
,&
’Œy
)) {

248 ià(
	`li¡Ty³Equ®
(&
’Œy
,
»fv®
)) {

249 
	`li¡Ty³In£¹
(&
’Œy
,
v®
,
wh”e
);

250 
š£¹ed
 = 1;

254 
	`li¡Ty³R–—£I‹¿tÜ
(
™”
);

256 ià(
š£¹ed
) {

257 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

258 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,"linsert",

259 
c
->
¬gv
[1],c->
db
->
id
);

260 
£rv”
.
dœty
++;

263 
	`addR•ly
(
c
,
sh¬ed
.
úegÚe
);

267 *
ev’t
 = (
wh”e
 =ğ
REDIS_LIST_HEAD
) ? "lpush" : "rpush";

269 
	`li¡Ty³Push
(
subjeù
,
v®
,
wh”e
);

270 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

271 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,
ev’t
,
c
->
¬gv
[1],c->
db
->
id
);

272 
£rv”
.
dœty
++;

275 
	`addR•lyLÚgLÚg
(
c
,
	`li¡Ty³L’gth
(
subjeù
));

276 
	}
}

278 
	$ÍushxCommªd
(
ş›Á
 *
c
) {

279 
c
->
¬gv
[2] = 
	`ŒyObjeùEncodšg
(c->argv[2]);

280 
	`pushxG’”icCommªd
(
c
,
NULL
,c->
¬gv
[2],
REDIS_LIST_HEAD
);

281 
	}
}

283 
	$½ushxCommªd
(
ş›Á
 *
c
) {

284 
c
->
¬gv
[2] = 
	`ŒyObjeùEncodšg
(c->argv[2]);

285 
	`pushxG’”icCommªd
(
c
,
NULL
,c->
¬gv
[2],
REDIS_LIST_TAIL
);

286 
	}
}

288 
	$lš£¹Commªd
(
ş›Á
 *
c
) {

289 
c
->
¬gv
[4] = 
	`ŒyObjeùEncodšg
(c->argv[4]);

290 ià(
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"after") == 0) {

291 
	`pushxG’”icCommªd
(
c
,c->
¬gv
[3],c->¬gv[4],
REDIS_LIST_TAIL
);

292 } ià(
	`¡rÿ£cmp
(
c
->
¬gv
[2]->
±r
,"before") == 0) {

293 
	`pushxG’”icCommªd
(
c
,c->
¬gv
[3],c->¬gv[4],
REDIS_LIST_HEAD
);

295 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

297 
	}
}

299 
	$Î’Commªd
(
ş›Á
 *
c
) {

300 
robj
 *
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
);

301 ià(
o
 =ğ
NULL
 || 
	`checkTy³
(
c
,o,
OBJ_LIST
)) ;

302 
	`addR•lyLÚgLÚg
(
c
,
	`li¡Ty³L’gth
(
o
));

303 
	}
}

305 
	$lšdexCommªd
(
ş›Á
 *
c
) {

306 
robj
 *
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
nuÎbulk
);

307 ià(
o
 =ğ
NULL
 || 
	`checkTy³
(
c
,o,
OBJ_LIST
)) ;

308 
šdex
;

309 
robj
 *
v®ue
 = 
NULL
;

311 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
šdex
, 
NULL
è!ğ
C_OK
))

314 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

315 
quickli¡EÁry
 
’Œy
;

316 ià(
	`quickli¡Index
(
o
->
±r
, 
šdex
, &
’Œy
)) {

317 ià(
’Œy
.
v®ue
) {

318 
v®ue
 = 
	`ü—‹SŒšgObjeù
((*)
’Œy
.v®ue,’Œy.
sz
);

320 
v®ue
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
’Œy
.
lÚgv®
);

322 
	`addR•lyBulk
(
c
,
v®ue
);

323 
	`deüRefCouÁ
(
v®ue
);

325 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

328 
	`£rv”Pªic
("Unknown†istƒncoding");

330 
	}
}

332 
	$l£tCommªd
(
ş›Á
 *
c
) {

333 
robj
 *
o
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
nokey”r
);

334 ià(
o
 =ğ
NULL
 || 
	`checkTy³
(
c
,o,
OBJ_LIST
)) ;

335 
šdex
;

336 
robj
 *
v®ue
 = 
c
->
¬gv
[3];

338 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
šdex
, 
NULL
è!ğ
C_OK
))

341 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

342 
quickli¡
 *
ql
 = 
o
->
±r
;

343 
»¶aûd
 = 
	`quickli¡R•ÏûAtIndex
(
ql
, 
šdex
,

344 
v®ue
->
±r
, 
	`sd¦’
(value->ptr));

345 ià(!
»¶aûd
) {

346 
	`addR•ly
(
c
,
sh¬ed
.
outoäªg“¼
);

348 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

349 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

350 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,"l£t",
c
->
¬gv
[1],c->
db
->
id
);

351 
£rv”
.
dœty
++;

354 
	`£rv”Pªic
("Unknown†istƒncoding");

356 
	}
}

358 
	$pİG’”icCommªd
(
ş›Á
 *
c
, 
wh”e
) {

359 
robj
 *
o
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
nuÎbulk
);

360 ià(
o
 =ğ
NULL
 || 
	`checkTy³
(
c
,o,
OBJ_LIST
)) ;

362 
robj
 *
v®ue
 = 
	`li¡Ty³Pİ
(
o
,
wh”e
);

363 ià(
v®ue
 =ğ
NULL
) {

364 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

366 *
ev’t
 = (
wh”e
 =ğ
REDIS_LIST_HEAD
) ? "lpop" : "rpop";

368 
	`addR•lyBulk
(
c
,
v®ue
);

369 
	`deüRefCouÁ
(
v®ue
);

370 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,
ev’t
,
c
->
¬gv
[1],c->
db
->
id
);

371 ià(
	`li¡Ty³L’gth
(
o
) == 0) {

372 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"del",

373 
c
->
¬gv
[1],c->
db
->
id
);

374 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

376 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

377 
£rv”
.
dœty
++;

379 
	}
}

381 
	$ÍİCommªd
(
ş›Á
 *
c
) {

382 
	`pİG’”icCommªd
(
c
,
REDIS_LIST_HEAD
);

383 
	}
}

385 
	$½İCommªd
(
ş›Á
 *
c
) {

386 
	`pİG’”icCommªd
(
c
,
REDIS_LIST_TAIL
);

387 
	}
}

389 
	$ÌªgeCommªd
(
ş›Á
 *
c
) {

390 
robj
 *
o
;

391 
¡¬t
, 
’d
, 
Î’
, 
¿ng–’
;

393 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
¡¬t
, 
NULL
è!ğ
C_OK
) ||

394 (
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[3], &
’d
, 
NULL
è!ğ
C_OK
)) ;

396 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
em±ymuÉibulk
)è=ğ
NULL


397 || 
	`checkTy³
(
c
,
o
,
OBJ_LIST
)) ;

398 
Î’
 = 
	`li¡Ty³L’gth
(
o
);

401 ià(
¡¬t
 < 0è¡¬ˆğ
Î’
+start;

402 ià(
’d
 < 0è’d = 
Î’
+end;

403 ià(
¡¬t
 < 0) start = 0;

407 ià(
¡¬t
 > 
’d
 || s¹ >ğ
Î’
) {

408 
	`addR•ly
(
c
,
sh¬ed
.
em±ymuÉibulk
);

411 ià(
’d
 >ğ
Î’
)ƒnd =†len-1;

412 
¿ng–’
 = (
’d
-
¡¬t
)+1;

415 
	`addR•lyMuÉiBulkL’
(
c
,
¿ng–’
);

416 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

417 
li¡Ty³I‹¿tÜ
 *
™”
 = 
	`li¡Ty³In™I‹¿tÜ
(
o
, 
¡¬t
, 
REDIS_LIST_TAIL
);

419 
¿ng–’
--) {

420 
li¡Ty³EÁry
 
’Œy
;

421 
	`li¡Ty³Next
(
™”
, &
’Œy
);

422 
quickli¡EÁry
 *
qe
 = &
’Œy
.entry;

423 ià(
qe
->
v®ue
) {

424 
	`addR•lyBulkCBufãr
(
c
,
qe
->
v®ue
,qe->
sz
);

426 
	`addR•lyBulkLÚgLÚg
(
c
,
qe
->
lÚgv®
);

429 
	`li¡Ty³R–—£I‹¿tÜ
(
™”
);

431 
	`£rv”Pªic
("Listƒncoding is‚ot QUICKLIST!");

433 
	}
}

435 
	$ÉrimCommªd
(
ş›Á
 *
c
) {

436 
robj
 *
o
;

437 
¡¬t
, 
’d
, 
Î’
, 
Érim
, 
¹rim
;

439 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
¡¬t
, 
NULL
è!ğ
C_OK
) ||

440 (
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[3], &
’d
, 
NULL
è!ğ
C_OK
)) ;

442 ià((
o
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
ok
)è=ğ
NULL
 ||

443 
	`checkTy³
(
c
,
o
,
OBJ_LIST
)) ;

444 
Î’
 = 
	`li¡Ty³L’gth
(
o
);

447 ià(
¡¬t
 < 0è¡¬ˆğ
Î’
+start;

448 ià(
’d
 < 0è’d = 
Î’
+end;

449 ià(
¡¬t
 < 0) start = 0;

453 ià(
¡¬t
 > 
’d
 || s¹ >ğ
Î’
) {

455 
Érim
 = 
Î’
;

456 
¹rim
 = 0;

458 ià(
’d
 >ğ
Î’
)ƒnd =†len-1;

459 
Érim
 = 
¡¬t
;

460 
¹rim
 = 
Î’
-
’d
-1;

464 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_QUICKLIST
) {

465 
	`quickli¡D–Rªge
(
o
->
±r
,0,
Érim
);

466 
	`quickli¡D–Rªge
(
o
->
±r
,-
¹rim
,rtrim);

468 
	`£rv”Pªic
("Unknown†istƒncoding");

471 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,"Érim",
c
->
¬gv
[1],c->
db
->
id
);

472 ià(
	`li¡Ty³L’gth
(
o
) == 0) {

473 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

474 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
c
->
¬gv
[1],c->
db
->
id
);

476 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

477 
£rv”
.
dœty
++;

478 
	`addR•ly
(
c
,
sh¬ed
.
ok
);

479 
	}
}

481 
	$ÌemCommªd
(
ş›Á
 *
c
) {

482 
robj
 *
subjeù
, *
obj
;

483 
obj
 = 
c
->
¬gv
[3];

484 
tÜemove
;

485 
»moved
 = 0;

487 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
tÜemove
, 
NULL
è!ğ
C_OK
))

490 
subjeù
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
);

491 ià(
subjeù
 =ğ
NULL
 || 
	`checkTy³
(
c
,subjeù,
OBJ_LIST
)) ;

493 
li¡Ty³I‹¿tÜ
 *
li
;

494 ià(
tÜemove
 < 0) {

495 
tÜemove
 = -toremove;

496 
li
 = 
	`li¡Ty³In™I‹¿tÜ
(
subjeù
,-1,
REDIS_LIST_HEAD
);

498 
li
 = 
	`li¡Ty³In™I‹¿tÜ
(
subjeù
,0,
REDIS_LIST_TAIL
);

501 
li¡Ty³EÁry
 
’Œy
;

502 
	`li¡Ty³Next
(
li
,&
’Œy
)) {

503 ià(
	`li¡Ty³Equ®
(&
’Œy
,
obj
)) {

504 
	`li¡Ty³D–‘e
(
li
, &
’Œy
);

505 
£rv”
.
dœty
++;

506 
»moved
++;

507 ià(
tÜemove
 && 
»moved
 ==oremove) ;

510 
	`li¡Ty³R–—£I‹¿tÜ
(
li
);

512 ià(
»moved
) {

513 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

514 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"Ìem",
c
->
¬gv
[1],c->
db
->
id
);

517 ià(
	`li¡Ty³L’gth
(
subjeù
) == 0) {

518 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

519 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
c
->
¬gv
[1],c->
db
->
id
);

522 
	`addR•lyLÚgLÚg
(
c
,
»moved
);

523 
	}
}

541 
	$½İÍushHªdËPush
(
ş›Á
 *
c
, 
robj
 *
d¡key
,„obj *
d¡obj
,„obj *
v®ue
) {

543 ià(!
d¡obj
) {

544 
d¡obj
 = 
	`ü—‹Quickli¡Objeù
();

545 
	`quickli¡S‘O±iÚs
(
d¡obj
->
±r
, 
£rv”
.
li¡_max_zli¡_size
,

546 
£rv”
.
li¡_com´ess_d•th
);

547 
	`dbAdd
(
c
->
db
,
d¡key
,
d¡obj
);

549 
	`sigÇlModif›dKey
(
c
->
db
,
d¡key
);

550 
	`li¡Ty³Push
(
d¡obj
,
v®ue
,
REDIS_LIST_HEAD
);

551 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,"Íush",
d¡key
,
c
->
db
->
id
);

553 
	`addR•lyBulk
(
c
,
v®ue
);

554 
	}
}

556 
	$½İÍushCommªd
(
ş›Á
 *
c
) {

557 
robj
 *
sobj
, *
v®ue
;

558 ià((
sobj
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
nuÎbulk
)è=ğ
NULL
 ||

559 
	`checkTy³
(
c
,
sobj
,
OBJ_LIST
)) ;

561 ià(
	`li¡Ty³L’gth
(
sobj
) == 0) {

564 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

566 
robj
 *
dobj
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[2]);

567 
robj
 *
touchedkey
 = 
c
->
¬gv
[1];

569 ià(
dobj
 && 
	`checkTy³
(
c
,dobj,
OBJ_LIST
)) ;

570 
v®ue
 = 
	`li¡Ty³Pİ
(
sobj
,
REDIS_LIST_TAIL
);

574 
	`šüRefCouÁ
(
touchedkey
);

575 
	`½İÍushHªdËPush
(
c
,c->
¬gv
[2],
dobj
,
v®ue
);

578 
	`deüRefCouÁ
(
v®ue
);

581 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,"½İ",
touchedkey
,
c
->
db
->
id
);

582 ià(
	`li¡Ty³L’gth
(
sobj
) == 0) {

583 
	`dbD–‘e
(
c
->
db
,
touchedkey
);

584 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"del",

585 
touchedkey
,
c
->
db
->
id
);

587 
	`sigÇlModif›dKey
(
c
->
db
,
touchedkey
);

588 
	`deüRefCouÁ
(
touchedkey
);

589 
£rv”
.
dœty
++;

591 
	}
}

616 
	$blockFÜKeys
(
ş›Á
 *
c
, 
robj
 **
keys
, 
numkeys
, 
m¡ime_t
 
timeout
,„obj *
rg‘
) {

617 
diùEÁry
 *
de
;

618 
li¡
 *
l
;

619 
j
;

621 
c
->
bpİ
.
timeout
 =imeout;

622 
c
->
bpİ
.
rg‘
 =arget;

624 ià(
rg‘
 !ğ
NULL
è
	`šüRefCouÁ
(target);

626 
j
 = 0; j < 
numkeys
; j++) {

628 ià(
	`diùAdd
(
c
->
bpİ
.
keys
,keys[
j
],
NULL
è!ğ
DICT_OK
) ;

629 
	`šüRefCouÁ
(
keys
[
j
]);

632 
de
 = 
	`diùFšd
(
c
->
db
->
blockšg_keys
,
keys
[
j
]);

633 ià(
de
 =ğ
NULL
) {

634 
»tv®
;

637 
l
 = 
	`li¡C»©e
();

638 
»tv®
 = 
	`diùAdd
(
c
->
db
->
blockšg_keys
,
keys
[
j
],
l
);

639 
	`šüRefCouÁ
(
keys
[
j
]);

640 
	`£rv”As£¹W™hInfo
(
c
,
keys
[
j
],
»tv®
 =ğ
DICT_OK
);

642 
l
 = 
	`diùG‘V®
(
de
);

644 
	`li¡AddNodeTa
(
l
,
c
);

646 
	`blockCl›Á
(
c
,
BLOCKED_LIST
);

647 
	}
}

651 
	$unblockCl›ÁWa™šgD©a
(
ş›Á
 *
c
) {

652 
diùEÁry
 *
de
;

653 
diùI‹¿tÜ
 *
di
;

654 
li¡
 *
l
;

656 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`diùSize
(c->
bpİ
.
keys
) != 0);

657 
di
 = 
	`diùG‘I‹¿tÜ
(
c
->
bpİ
.
keys
);

659 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

660 
robj
 *
key
 = 
	`diùG‘Key
(
de
);

663 
l
 = 
	`diùF‘chV®ue
(
c
->
db
->
blockšg_keys
,
key
);

664 
	`£rv”As£¹W™hInfo
(
c
,
key
,
l
 !ğ
NULL
);

665 
	`li¡D–Node
(
l
,
	`li¡S—rchKey
Ö,
c
));

667 ià(
	`li¡L’gth
(
l
) == 0)

668 
	`diùD–‘e
(
c
->
db
->
blockšg_keys
,
key
);

670 
	`diùR–—£I‹¿tÜ
(
di
);

673 
	`diùEm±y
(
c
->
bpİ
.
keys
,
NULL
);

674 ià(
c
->
bpİ
.
rg‘
) {

675 
	`deüRefCouÁ
(
c
->
bpİ
.
rg‘
);

676 
c
->
bpİ
.
rg‘
 = 
NULL
;

678 
	}
}

687 
	$sigÇlLi¡AsR—dy
(
»disDb
 *
db
, 
robj
 *
key
) {

688 
»adyLi¡
 *
¾
;

691 ià(
	`diùFšd
(
db
->
blockšg_keys
,
key
è=ğ
NULL
) ;

694 ià(
	`diùFšd
(
db
->
»ady_keys
,
key
è!ğ
NULL
) ;

697 
¾
 = 
	`zm®loc
((*rl));

698 
¾
->
key
 = key;

699 
¾
->
db
 = db;

700 
	`šüRefCouÁ
(
key
);

701 
	`li¡AddNodeTa
(
£rv”
.
»ady_keys
,
¾
);

706 
	`šüRefCouÁ
(
key
);

707 
	`£rv”As£¹
(
	`diùAdd
(
db
->
»ady_keys
,
key
,
NULL
è=ğ
DICT_OK
);

708 
	}
}

729 
	$£rveCl›ÁBlockedOnLi¡
(
ş›Á
 *
»ûiv”
, 
robj
 *
key
,„obj *
d¡key
, 
»disDb
 *
db
,„obj *
v®ue
, 
wh”e
)

731 
robj
 *
¬gv
[3];

733 ià(
d¡key
 =ğ
NULL
) {

735 
¬gv
[0] = (
wh”e
 =ğ
REDIS_LIST_HEAD
è? 
sh¬ed
.
Íİ
 :

736 
sh¬ed
.
½İ
;

737 
¬gv
[1] = 
key
;

738 
	`´İag©e
((
wh”e
 =ğ
REDIS_LIST_HEAD
) ?

739 
£rv”
.
ÍİCommªd
 : s”v”.
½İCommªd
,

740 
db
->
id
,
¬gv
,2,
PROPAGATE_AOF
|
PROPAGATE_REPL
);

743 
	`addR•lyMuÉiBulkL’
(
»ûiv”
,2);

744 
	`addR•lyBulk
(
»ûiv”
,
key
);

745 
	`addR•lyBulk
(
»ûiv”
,
v®ue
);

748 
robj
 *
d¡obj
 =

749 
	`lookupKeyWr™e
(
»ûiv”
->
db
,
d¡key
);

750 ià(!(
d¡obj
 &&

751 
	`checkTy³
(
»ûiv”
,
d¡obj
,
OBJ_LIST
)))

754 
¬gv
[0] = 
sh¬ed
.
½İ
;

755 
¬gv
[1] = 
key
;

756 
	`´İag©e
(
£rv”
.
½İCommªd
,

757 
db
->
id
,
¬gv
,2,

758 
PROPAGATE_AOF
|

759 
PROPAGATE_REPL
);

760 
	`½İÍushHªdËPush
(
»ûiv”
,
d¡key
,
d¡obj
,

761 
v®ue
);

763 
¬gv
[0] = 
sh¬ed
.
Íush
;

764 
¬gv
[1] = 
d¡key
;

765 
¬gv
[2] = 
v®ue
;

766 
	`´İag©e
(
£rv”
.
ÍushCommªd
,

767 
db
->
id
,
¬gv
,3,

768 
PROPAGATE_AOF
|

769 
PROPAGATE_REPL
);

773  
C_ERR
;

776  
C_OK
;

777 
	}
}

789 
	$hªdËCl›ÁsBlockedOnLi¡s
() {

790 
	`li¡L’gth
(
£rv”
.
»ady_keys
) != 0) {

791 
li¡
 *
l
;

797 
l
 = 
£rv”
.
»ady_keys
;

798 
£rv”
.
»ady_keys
 = 
	`li¡C»©e
();

800 
	`li¡L’gth
(
l
) != 0) {

801 
li¡Node
 *
Ê
 = 
	`li¡Fœ¡
(
l
);

802 
»adyLi¡
 *
¾
 = 
Ê
->
v®ue
;

806 
	`diùD–‘e
(
¾
->
db
->
»ady_keys
,¾->
key
);

810 
robj
 *
o
 = 
	`lookupKeyWr™e
(
¾
->
db
,¾->
key
);

811 ià(
o
 !ğ
NULL
 && o->
ty³
 =ğ
OBJ_LIST
) {

812 
diùEÁry
 *
de
;

816 
de
 = 
	`diùFšd
(
¾
->
db
->
blockšg_keys
,¾->
key
);

817 ià(
de
) {

818 
li¡
 *
ş›Ás
 = 
	`diùG‘V®
(
de
);

819 
numş›Ás
 = 
	`li¡L’gth
(
ş›Ás
);

821 
numş›Ás
--) {

822 
li¡Node
 *
ş›Ánode
 = 
	`li¡Fœ¡
(
ş›Ás
);

823 
ş›Á
 *
»ûiv”
 = 
ş›Ánode
->
v®ue
;

824 
robj
 *
d¡key
 = 
»ûiv”
->
bpİ
.
rg‘
;

825 
wh”e
 = (
»ûiv”
->
Ï¡cmd
 &&

826 
»ûiv”
->
Ï¡cmd
->
´oc
 =ğ
bÍİCommªd
) ?

827 
REDIS_LIST_HEAD
 : 
REDIS_LIST_TAIL
;

828 
robj
 *
v®ue
 = 
	`li¡Ty³Pİ
(
o
,
wh”e
);

830 ià(
v®ue
) {

834 ià(
d¡key
è
	`šüRefCouÁ
(dstkey);

835 
	`unblockCl›Á
(
»ûiv”
);

837 ià(
	`£rveCl›ÁBlockedOnLi¡
(
»ûiv”
,

838 
¾
->
key
,
d¡key
,¾->
db
,
v®ue
,

839 
wh”e
è=ğ
C_ERR
)

843 
	`li¡Ty³Push
(
o
,
v®ue
,
wh”e
);

846 ià(
d¡key
è
	`deüRefCouÁ
(dstkey);

847 
	`deüRefCouÁ
(
v®ue
);

854 ià(
	`li¡Ty³L’gth
(
o
) == 0) {

855 
	`dbD–‘e
(
¾
->
db
,¾->
key
);

862 
	`deüRefCouÁ
(
¾
->
key
);

863 
	`zä“
(
¾
);

864 
	`li¡D–Node
(
l
,
Ê
);

866 
	`li¡R–—£
(
l
);

868 
	}
}

871 
	$blockšgPİG’”icCommªd
(
ş›Á
 *
c
, 
wh”e
) {

872 
robj
 *
o
;

873 
m¡ime_t
 
timeout
;

874 
j
;

876 ià(
	`g‘TimeoutFromObjeùOrR•ly
(
c
,c->
¬gv
[c->
¬gc
-1],&
timeout
,
UNIT_SECONDS
)

877 !ğ
C_OK
) ;

879 
j
 = 1; j < 
c
->
¬gc
-1; j++) {

880 
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[
j
]);

881 ià(
o
 !ğ
NULL
) {

882 ià(
o
->
ty³
 !ğ
OBJ_LIST
) {

883 
	`addR•ly
(
c
,
sh¬ed
.
wrÚgty³”r
);

886 ià(
	`li¡Ty³L’gth
(
o
) != 0) {

888 *
ev’t
 = (
wh”e
 =ğ
REDIS_LIST_HEAD
) ? "lpop" : "rpop";

889 
robj
 *
v®ue
 = 
	`li¡Ty³Pİ
(
o
,
wh”e
);

890 
	`£rv”As£¹
(
v®ue
 !ğ
NULL
);

892 
	`addR•lyMuÉiBulkL’
(
c
,2);

893 
	`addR•lyBulk
(
c
,c->
¬gv
[
j
]);

894 
	`addR•lyBulk
(
c
,
v®ue
);

895 
	`deüRefCouÁ
(
v®ue
);

896 
	`nÙifyKey¥aûEv’t
(
NOTIFY_LIST
,
ev’t
,

897 
c
->
¬gv
[
j
],c->
db
->
id
);

898 ià(
	`li¡Ty³L’gth
(
o
) == 0) {

899 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[
j
]);

900 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"del",

901 
c
->
¬gv
[
j
],c->
db
->
id
);

903 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[
j
]);

904 
£rv”
.
dœty
++;

907 
	`»wr™eCl›ÁCommªdVeùÜ
(
c
,2,

908 (
wh”e
 =ğ
REDIS_LIST_HEAD
è? 
sh¬ed
.
Íİ
 : sh¬ed.
½İ
,

909 
c
->
¬gv
[
j
]);

918 ià(
c
->
æags
 & 
CLIENT_MULTI
) {

919 
	`addR•ly
(
c
,
sh¬ed
.
nuÎmuÉibulk
);

924 
	`blockFÜKeys
(
c
, c->
¬gv
 + 1, c->
¬gc
 - 2, 
timeout
, 
NULL
);

925 
	}
}

927 
	$bÍİCommªd
(
ş›Á
 *
c
) {

928 
	`blockšgPİG’”icCommªd
(
c
,
REDIS_LIST_HEAD
);

929 
	}
}

931 
	$b½İCommªd
(
ş›Á
 *
c
) {

932 
	`blockšgPİG’”icCommªd
(
c
,
REDIS_LIST_TAIL
);

933 
	}
}

935 
	$b½İÍushCommªd
(
ş›Á
 *
c
) {

936 
m¡ime_t
 
timeout
;

938 ià(
	`g‘TimeoutFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
timeout
,
UNIT_SECONDS
)

939 !ğ
C_OK
) ;

941 
robj
 *
key
 = 
	`lookupKeyWr™e
(
c
->
db
, c->
¬gv
[1]);

943 ià(
key
 =ğ
NULL
) {

944 ià(
c
->
æags
 & 
CLIENT_MULTI
) {

947 
	`addR•ly
(
c
, 
sh¬ed
.
nuÎbulk
);

950 
	`blockFÜKeys
(
c
, c->
¬gv
 + 1, 1, 
timeout
, c->argv[2]);

953 ià(
key
->
ty³
 !ğ
OBJ_LIST
) {

954 
	`addR•ly
(
c
, 
sh¬ed
.
wrÚgty³”r
);

958 
	`£rv”As£¹W™hInfo
(
c
,
key
,
	`li¡Ty³L’gth
(key) > 0);

959 
	`½İÍushCommªd
(
c
);

962 
	}
}

	@src/t_set.c

30 
	~"£rv”.h
"

36 
suniÚDiffG’”icCommªd
(
ş›Á
 *
c
, 
robj
 **
£tkeys
, 
£Šum
,

37 
robj
 *
d¡key
, 
İ
);

42 
robj
 *
	$£tTy³C»©e
(
robj
 *
v®ue
) {

43 ià(
	`isObjeùR•»£ÁabËAsLÚgLÚg
(
v®ue
,
NULL
è=ğ
C_OK
)

44  
	`ü—‹IÁ£tObjeù
();

45  
	`ü—‹S‘Objeù
();

46 
	}
}

53 
	$£tTy³Add
(
robj
 *
subjeù
,„obj *
v®ue
) {

54 
Îv®
;

55 ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

56 ià(
	`diùAdd
(
subjeù
->
±r
,
v®ue
,
NULL
è=ğ
DICT_OK
) {

57 
	`šüRefCouÁ
(
v®ue
);

60 } ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

61 ià(
	`isObjeùR•»£ÁabËAsLÚgLÚg
(
v®ue
,&
Îv®
è=ğ
C_OK
) {

62 
ušt8_t
 
sucûss
 = 0;

63 
subjeù
->
±r
 = 
	`št£tAdd
(subjeù->±r,
Îv®
,&
sucûss
);

64 ià(
sucûss
) {

67 ià(
	`št£tL’
(
subjeù
->
±r
è> 
£rv”
.
£t_max_št£t_’Œ›s
)

68 
	`£tTy³CÚv”t
(
subjeù
,
OBJ_ENCODING_HT
);

73 
	`£tTy³CÚv”t
(
subjeù
,
OBJ_ENCODING_HT
);

77 
	`£rv”As£¹W™hInfo
(
NULL
,
v®ue
,

78 
	`diùAdd
(
subjeù
->
±r
,
v®ue
,
NULL
è=ğ
DICT_OK
);

79 
	`šüRefCouÁ
(
v®ue
);

83 
	`£rv”Pªic
("Unknown setƒncoding");

86 
	}
}

88 
	$£tTy³Remove
(
robj
 *
£tobj
,„obj *
v®ue
) {

89 
Îv®
;

90 ià(
£tobj
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

91 ià(
	`diùD–‘e
(
£tobj
->
±r
,
v®ue
è=ğ
DICT_OK
) {

92 ià(
	`htN“dsResize
(
£tobj
->
±r
)è
	`diùResize
(setobj->ptr);

95 } ià(
£tobj
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

96 ià(
	`isObjeùR•»£ÁabËAsLÚgLÚg
(
v®ue
,&
Îv®
è=ğ
C_OK
) {

97 
sucûss
;

98 
£tobj
->
±r
 = 
	`št£tRemove
(£tobj->±r,
Îv®
,&
sucûss
);

99 ià(
sucûss
)  1;

102 
	`£rv”Pªic
("Unknown setƒncoding");

105 
	}
}

107 
	$£tTy³IsMemb”
(
robj
 *
subjeù
,„obj *
v®ue
) {

108 
Îv®
;

109 ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

110  
	`diùFšd
((
diù
*)
subjeù
->
±r
,
v®ue
è!ğ
NULL
;

111 } ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

112 ià(
	`isObjeùR•»£ÁabËAsLÚgLÚg
(
v®ue
,&
Îv®
è=ğ
C_OK
) {

113  
	`št£tFšd
((
št£t
*)
subjeù
->
±r
,
Îv®
);

116 
	`£rv”Pªic
("Unknown setƒncoding");

119 
	}
}

121 
£tTy³I‹¿tÜ
 *
	$£tTy³In™I‹¿tÜ
(
robj
 *
subjeù
) {

122 
£tTy³I‹¿tÜ
 *
si
 = 
	`zm®loc
((setTypeIterator));

123 
si
->
subjeù
 = subject;

124 
si
->
’codšg
 = 
subjeù
->encoding;

125 ià(
si
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

126 
si
->
di
 = 
	`diùG‘I‹¿tÜ
(
subjeù
->
±r
);

127 } ià(
si
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

128 
si
->
ii
 = 0;

130 
	`£rv”Pªic
("Unknown setƒncoding");

132  
si
;

133 
	}
}

135 
	$£tTy³R–—£I‹¿tÜ
(
£tTy³I‹¿tÜ
 *
si
) {

136 ià(
si
->
’codšg
 =ğ
OBJ_ENCODING_HT
)

137 
	`diùR–—£I‹¿tÜ
(
si
->
di
);

138 
	`zä“
(
si
);

139 
	}
}

156 
	$£tTy³Next
(
£tTy³I‹¿tÜ
 *
si
, 
robj
 **
obj–e
, 
št64_t
 *
Î–e
) {

157 ià(
si
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

158 
diùEÁry
 *
de
 = 
	`diùNext
(
si
->
di
);

159 ià(
de
 =ğ
NULL
)  -1;

160 *
obj–e
 = 
	`diùG‘Key
(
de
);

161 *
Î–e
 = -123456789;

162 } ià(
si
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

163 ià(!
	`št£tG‘
(
si
->
subjeù
->
±r
,si->
ii
++,
Î–e
))

165 *
obj–e
 = 
NULL
;

167 
	`£rv”Pªic
("Wrong setƒncoding in setTypeNext");

169  
si
->
’codšg
;

170 
	}
}

179 
robj
 *
	$£tTy³NextObjeù
(
£tTy³I‹¿tÜ
 *
si
) {

180 
št64_t
 
š‹Ë
;

181 
robj
 *
obj–e
;

182 
’codšg
;

184 
’codšg
 = 
	`£tTy³Next
(
si
,&
obj–e
,&
š‹Ë
);

185 
’codšg
) {

186 -1:  
NULL
;

187 
OBJ_ENCODING_INTSET
:

188  
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
š‹Ë
);

189 
OBJ_ENCODING_HT
:

190 
	`šüRefCouÁ
(
obj–e
);

191  
obj–e
;

193 
	`£rv”Pªic
("Unsupportedƒncoding");

195  
NULL
;

196 
	}
}

215 
	$£tTy³RªdomEËm’t
(
robj
 *
£tobj
,„obj **
obj–e
, 
št64_t
 *
Î–e
) {

216 ià(
£tobj
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

217 
diùEÁry
 *
de
 = 
	`diùG‘RªdomKey
(
£tobj
->
±r
);

218 *
obj–e
 = 
	`diùG‘Key
(
de
);

219 *
Î–e
 = -123456789;

220 } ià(
£tobj
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

221 *
Î–e
 = 
	`št£tRªdom
(
£tobj
->
±r
);

222 *
obj–e
 = 
NULL
;

224 
	`£rv”Pªic
("Unknown setƒncoding");

226  
£tobj
->
’codšg
;

227 
	}
}

229 
	$£tTy³Size
(
robj
 *
subjeù
) {

230 ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

231  
	`diùSize
((
diù
*)
subjeù
->
±r
);

232 } ià(
subjeù
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

233  
	`št£tL’
((
št£t
*)
subjeù
->
±r
);

235 
	`£rv”Pªic
("Unknown setƒncoding");

237 
	}
}

242 
	$£tTy³CÚv”t
(
robj
 *
£tobj
, 
’c
) {

243 
£tTy³I‹¿tÜ
 *
si
;

244 
	`£rv”As£¹W™hInfo
(
NULL
,
£tobj
,£tobj->
ty³
 =ğ
OBJ_SET
 &&

245 
£tobj
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
);

247 ià(
’c
 =ğ
OBJ_ENCODING_HT
) {

248 
št64_t
 
š‹Ë
;

249 
diù
 *
d
 = 
	`diùC»©e
(&
£tDiùTy³
,
NULL
);

250 
robj
 *
–em’t
;

253 
	`diùEx·nd
(
d
,
	`št£tL’
(
£tobj
->
±r
));

256 
si
 = 
	`£tTy³In™I‹¿tÜ
(
£tobj
);

257 
	`£tTy³Next
(
si
,&
–em’t
,&
š‹Ë
) != -1) {

258 
–em’t
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
š‹Ë
);

259 
	`£rv”As£¹W™hInfo
(
NULL
,
–em’t
,

260 
	`diùAdd
(
d
,
–em’t
,
NULL
è=ğ
DICT_OK
);

262 
	`£tTy³R–—£I‹¿tÜ
(
si
);

264 
£tobj
->
’codšg
 = 
OBJ_ENCODING_HT
;

265 
	`zä“
(
£tobj
->
±r
);

266 
£tobj
->
±r
 = 
d
;

268 
	`£rv”Pªic
("Unsupported set conversion");

270 
	}
}

272 
	$§ddCommªd
(
ş›Á
 *
c
) {

273 
robj
 *
£t
;

274 
j
, 
added
 = 0;

276 
£t
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

277 ià(
£t
 =ğ
NULL
) {

278 
£t
 = 
	`£tTy³C»©e
(
c
->
¬gv
[2]);

279 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],
£t
);

281 ià(
£t
->
ty³
 !ğ
OBJ_SET
) {

282 
	`addR•ly
(
c
,
sh¬ed
.
wrÚgty³”r
);

287 
j
 = 2; j < 
c
->
¬gc
; j++) {

288 
c
->
¬gv
[
j
] = 
	`ŒyObjeùEncodšg
(c->argv[j]);

289 ià(
	`£tTy³Add
(
£t
,
c
->
¬gv
[
j
])è
added
++;

291 ià(
added
) {

292 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

293 
	`nÙifyKey¥aûEv’t
(
NOTIFY_SET
,"§dd",
c
->
¬gv
[1],c->
db
->
id
);

295 
£rv”
.
dœty
 +ğ
added
;

296 
	`addR•lyLÚgLÚg
(
c
,
added
);

297 
	}
}

299 
	$¤emCommªd
(
ş›Á
 *
c
) {

300 
robj
 *
£t
;

301 
j
, 
d–‘ed
 = 0, 
key»moved
 = 0;

303 ià((
£t
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

304 
	`checkTy³
(
c
,
£t
,
OBJ_SET
)) ;

306 
j
 = 2; j < 
c
->
¬gc
; j++) {

307 ià(
	`£tTy³Remove
(
£t
,
c
->
¬gv
[
j
])) {

308 
d–‘ed
++;

309 ià(
	`£tTy³Size
(
£t
) == 0) {

310 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

311 
key»moved
 = 1;

316 ià(
d–‘ed
) {

317 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

318 
	`nÙifyKey¥aûEv’t
(
NOTIFY_SET
,"¤em",
c
->
¬gv
[1],c->
db
->
id
);

319 ià(
key»moved
)

320 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
c
->
¬gv
[1],

321 
c
->
db
->
id
);

322 
£rv”
.
dœty
 +ğ
d–‘ed
;

324 
	`addR•lyLÚgLÚg
(
c
,
d–‘ed
);

325 
	}
}

327 
	$smoveCommªd
(
ş›Á
 *
c
) {

328 
robj
 *
¤c£t
, *
d¡£t
, *
–e
;

329 
¤c£t
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

330 
d¡£t
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[2]);

331 
–e
 = 
c
->
¬gv
[3] = 
	`ŒyObjeùEncodšg
(c->argv[3]);

334 ià(
¤c£t
 =ğ
NULL
) {

335 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

341 ià(
	`checkTy³
(
c
,
¤c£t
,
OBJ_SET
) ||

342 (
d¡£t
 && 
	`checkTy³
(
c
,d¡£t,
OBJ_SET
))) ;

345 ià(
¤c£t
 =ğ
d¡£t
) {

346 
	`addR•ly
(
c
,
	`£tTy³IsMemb”
(
¤c£t
,
–e
è? 
sh¬ed
.
cÚe
 : sh¬ed.
cz”o
);

351 ià(!
	`£tTy³Remove
(
¤c£t
,
–e
)) {

352 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

355 
	`nÙifyKey¥aûEv’t
(
NOTIFY_SET
,"¤em",
c
->
¬gv
[1],c->
db
->
id
);

358 ià(
	`£tTy³Size
(
¤c£t
) == 0) {

359 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

360 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
c
->
¬gv
[1],c->
db
->
id
);

364 ià(!
d¡£t
) {

365 
d¡£t
 = 
	`£tTy³C»©e
(
–e
);

366 
	`dbAdd
(
c
->
db
,c->
¬gv
[2],
d¡£t
);

369 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

370 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[2]);

371 
£rv”
.
dœty
++;

374 ià(
	`£tTy³Add
(
d¡£t
,
–e
)) {

375 
£rv”
.
dœty
++;

376 
	`nÙifyKey¥aûEv’t
(
NOTIFY_SET
,"§dd",
c
->
¬gv
[2],c->
db
->
id
);

378 
	`addR•ly
(
c
,
sh¬ed
.
cÚe
);

379 
	}
}

381 
	$sismemb”Commªd
(
ş›Á
 *
c
) {

382 
robj
 *
£t
;

384 ià((
£t
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

385 
	`checkTy³
(
c
,
£t
,
OBJ_SET
)) ;

387 
c
->
¬gv
[2] = 
	`ŒyObjeùEncodšg
(c->argv[2]);

388 ià(
	`£tTy³IsMemb”
(
£t
,
c
->
¬gv
[2]))

389 
	`addR•ly
(
c
,
sh¬ed
.
cÚe
);

391 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

392 
	}
}

394 
	$sÿrdCommªd
(
ş›Á
 *
c
) {

395 
robj
 *
o
;

397 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

398 
	`checkTy³
(
c
,
o
,
OBJ_SET
)) ;

400 
	`addR•lyLÚgLÚg
(
c
,
	`£tTy³Size
(
o
));

401 
	}
}

409 
	#SPOP_MOVE_STRATEGY_MUL
 5

	)

411 
	$¥İW™hCouÁCommªd
(
ş›Á
 *
c
) {

412 
l
;

413 
couÁ
, 
size
;

414 
robj
 *
£t
;

417 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
l
,
NULL
è!ğ
C_OK
) ;

418 ià(
l
 >= 0) {

419 
couÁ
 = (è
l
;

421 
	`addR•ly
(
c
,
sh¬ed
.
outoäªg“¼
);

427 ià((
£t
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
em±ymuÉibulk
))

428 =ğ
NULL
 || 
	`checkTy³
(
c
,
£t
,
OBJ_SET
)) ;

432 ià(
couÁ
 == 0) {

433 
	`addR•ly
(
c
,
sh¬ed
.
em±ymuÉibulk
);

437 
size
 = 
	`£tTy³Size
(
£t
);

440 
	`nÙifyKey¥aûEv’t
(
NOTIFY_SET
,"¥İ",
c
->
¬gv
[1],c->
db
->
id
);

441 
£rv”
.
dœty
 +ğ
couÁ
;

446 ià(
couÁ
 >ğ
size
) {

448 
	`suniÚDiffG’”icCommªd
(
c
,c->
¬gv
+1,1,
NULL
,
SET_OP_UNION
);

451 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

452 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
c
->
¬gv
[1],c->
db
->
id
);

455 
	`»wr™eCl›ÁCommªdVeùÜ
(
c
,2,
sh¬ed
.
d–
,c->
¬gv
[1]);

456 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

457 
£rv”
.
dœty
++;

464 
robj
 *
´İ¬gv
[3];

465 
´İ¬gv
[0] = 
	`ü—‹SŒšgObjeù
("SREM",4);

466 
´İ¬gv
[1] = 
c
->
¬gv
[1];

467 
	`addR•lyMuÉiBulkL’
(
c
,
couÁ
);

470 
robj
 *
obj–e
;

471 
’codšg
;

472 
št64_t
 
Î–e
;

473 
»maššg
 = 
size
-
couÁ
;

482 ià(
»maššg
*
SPOP_MOVE_STRATEGY_MUL
 > 
couÁ
) {

483 
couÁ
--) {

484 
’codšg
 = 
	`£tTy³RªdomEËm’t
(
£t
,&
obj–e
,&
Î–e
);

485 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

486 
obj–e
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
Î–e
);

488 
	`šüRefCouÁ
(
obj–e
);

492 
	`addR•lyBulk
(
c
,
obj–e
);

493 
	`£tTy³Remove
(
£t
,
obj–e
);

496 
´İ¬gv
[2] = 
obj–e
;

497 
	`®soPrİag©e
(
£rv”
.
¤emCommªd
,
c
->
db
->
id
,
´İ¬gv
,3,

498 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

499 
	`deüRefCouÁ
(
obj–e
);

510 
robj
 *
Ãw£t
 = 
NULL
;

513 
»maššg
--) {

514 
’codšg
 = 
	`£tTy³RªdomEËm’t
(
£t
,&
obj–e
,&
Î–e
);

515 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

516 
obj–e
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
Î–e
);

518 
	`šüRefCouÁ
(
obj–e
);

520 ià(!
Ãw£t
èÃw£ˆğ
	`£tTy³C»©e
(
obj–e
);

521 
	`£tTy³Add
(
Ãw£t
,
obj–e
);

522 
	`£tTy³Remove
(
£t
,
obj–e
);

523 
	`deüRefCouÁ
(
obj–e
);

527 
	`šüRefCouÁ
(
£t
);

528 
	`dbOv”wr™e
(
c
->
db
,c->
¬gv
[1],
Ãw£t
);

531 
£tTy³I‹¿tÜ
 *
si
;

532 
si
 = 
	`£tTy³In™I‹¿tÜ
(
£t
);

533 (
’codšg
 = 
	`£tTy³Next
(
si
,&
obj–e
,&
Î–e
)) != -1) {

534 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

535 
obj–e
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
Î–e
);

537 
	`šüRefCouÁ
(
obj–e
);

539 
	`addR•lyBulk
(
c
,
obj–e
);

542 
´İ¬gv
[2] = 
obj–e
;

543 
	`®soPrİag©e
(
£rv”
.
¤emCommªd
,
c
->
db
->
id
,
´İ¬gv
,3,

544 
PROPAGATE_AOF
|
PROPAGATE_REPL
);

546 
	`deüRefCouÁ
(
obj–e
);

548 
	`£tTy³R–—£I‹¿tÜ
(
si
);

549 
	`deüRefCouÁ
(
£t
);

556 
	`deüRefCouÁ
(
´İ¬gv
[0]);

557 
	`´ev’tCommªdPrİag©iÚ
(
c
);

558 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

559 
£rv”
.
dœty
++;

560 
	}
}

562 
	$¥İCommªd
(
ş›Á
 *
c
) {

563 
robj
 *
£t
, *
–e
, *
aux
;

564 
št64_t
 
Î–e
;

565 
’codšg
;

567 ià(
c
->
¬gc
 == 3) {

568 
	`¥İW™hCouÁCommªd
(
c
);

570 } ià(
c
->
¬gc
 > 3) {

571 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

577 ià((
£t
 = 
	`lookupKeyWr™eOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
nuÎbulk
)è=ğ
NULL
 ||

578 
	`checkTy³
(
c
,
£t
,
OBJ_SET
)) ;

581 
’codšg
 = 
	`£tTy³RªdomEËm’t
(
£t
,&
–e
,&
Î–e
);

584 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

585 
–e
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
Î–e
);

586 
£t
->
±r
 = 
	`št£tRemove
(£t->±r,
Î–e
,
NULL
);

588 
	`šüRefCouÁ
(
–e
);

589 
	`£tTy³Remove
(
£t
,
–e
);

592 
	`nÙifyKey¥aûEv’t
(
NOTIFY_SET
,"¥İ",
c
->
¬gv
[1],c->
db
->
id
);

595 
aux
 = 
	`ü—‹SŒšgObjeù
("SREM",4);

596 
	`»wr™eCl›ÁCommªdVeùÜ
(
c
,3,
aux
,c->
¬gv
[1],
–e
);

597 
	`deüRefCouÁ
(
–e
);

598 
	`deüRefCouÁ
(
aux
);

601 
	`addR•lyBulk
(
c
,
–e
);

604 ià(
	`£tTy³Size
(
£t
) == 0) {

605 
	`dbD–‘e
(
c
->
db
,c->
¬gv
[1]);

606 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
c
->
¬gv
[1],c->
db
->
id
);

610 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

611 
£rv”
.
dœty
++;

612 
	}
}

620 
	#SRANDMEMBER_SUB_STRATEGY_MUL
 3

	)

622 
	$¤ªdmemb”W™hCouÁCommªd
(
ş›Á
 *
c
) {

623 
l
;

624 
couÁ
, 
size
;

625 
uniq
 = 1;

626 
robj
 *
£t
, *
–e
;

627 
št64_t
 
Î–e
;

628 
’codšg
;

630 
diù
 *
d
;

632 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
l
,
NULL
è!ğ
C_OK
) ;

633 ià(
l
 >= 0) {

634 
couÁ
 = (è
l
;

638 
couÁ
 = -
l
;

639 
uniq
 = 0;

642 ià((
£t
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
em±ymuÉibulk
))

643 =ğ
NULL
 || 
	`checkTy³
(
c
,
£t
,
OBJ_SET
)) ;

644 
size
 = 
	`£tTy³Size
(
£t
);

647 ià(
couÁ
 == 0) {

648 
	`addR•ly
(
c
,
sh¬ed
.
em±ymuÉibulk
);

656 ià(!
uniq
) {

657 
	`addR•lyMuÉiBulkL’
(
c
,
couÁ
);

658 
couÁ
--) {

659 
’codšg
 = 
	`£tTy³RªdomEËm’t
(
£t
,&
–e
,&
Î–e
);

660 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

661 
	`addR•lyBulkLÚgLÚg
(
c
,
Î–e
);

663 
	`addR•lyBulk
(
c
,
–e
);

672 ià(
couÁ
 >ğ
size
) {

673 
	`suniÚDiffG’”icCommªd
(
c
,c->
¬gv
+1,1,
NULL
,
SET_OP_UNION
);

678 
d
 = 
	`diùC»©e
(&
£tDiùTy³
,
NULL
);

689 ià(
couÁ
*
SRANDMEMBER_SUB_STRATEGY_MUL
 > 
size
) {

690 
£tTy³I‹¿tÜ
 *
si
;

693 
si
 = 
	`£tTy³In™I‹¿tÜ
(
£t
);

694 (
’codšg
 = 
	`£tTy³Next
(
si
,&
–e
,&
Î–e
)) != -1) {

695 
»tv®
 = 
DICT_ERR
;

697 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

698 
»tv®
 = 
	`diùAdd
(
d
,
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
Î–e
),
NULL
);

700 
»tv®
 = 
	`diùAdd
(
d
,
	`dupSŒšgObjeù
(
–e
),
NULL
);

702 
	`£rv”As£¹
(
»tv®
 =ğ
DICT_OK
);

704 
	`£tTy³R–—£I‹¿tÜ
(
si
);

705 
	`£rv”As£¹
(
	`diùSize
(
d
è=ğ
size
);

708 
size
 > 
couÁ
) {

709 
diùEÁry
 *
de
;

711 
de
 = 
	`diùG‘RªdomKey
(
d
);

712 
	`diùD–‘e
(
d
,
	`diùG‘Key
(
de
));

713 
size
--;

722 
added
 = 0;

724 
added
 < 
couÁ
) {

725 
’codšg
 = 
	`£tTy³RªdomEËm’t
(
£t
,&
–e
,&
Î–e
);

726 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

727 
–e
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
Î–e
);

729 
–e
 = 
	`dupSŒšgObjeù
(ele);

734 ià(
	`diùAdd
(
d
,
–e
,
NULL
è=ğ
DICT_OK
)

735 
added
++;

737 
	`deüRefCouÁ
(
–e
);

743 
diùI‹¿tÜ
 *
di
;

744 
diùEÁry
 *
de
;

746 
	`addR•lyMuÉiBulkL’
(
c
,
couÁ
);

747 
di
 = 
	`diùG‘I‹¿tÜ
(
d
);

748 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
)

749 
	`addR•lyBulk
(
c
,
	`diùG‘Key
(
de
));

750 
	`diùR–—£I‹¿tÜ
(
di
);

751 
	`diùR–—£
(
d
);

753 
	}
}

755 
	$¤ªdmemb”Commªd
(
ş›Á
 *
c
) {

756 
robj
 *
£t
, *
–e
;

757 
št64_t
 
Î–e
;

758 
’codšg
;

760 ià(
c
->
¬gc
 == 3) {

761 
	`¤ªdmemb”W™hCouÁCommªd
(
c
);

763 } ià(
c
->
¬gc
 > 3) {

764 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

768 ià((
£t
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
nuÎbulk
)è=ğ
NULL
 ||

769 
	`checkTy³
(
c
,
£t
,
OBJ_SET
)) ;

771 
’codšg
 = 
	`£tTy³RªdomEËm’t
(
£t
,&
–e
,&
Î–e
);

772 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

773 
	`addR•lyBulkLÚgLÚg
(
c
,
Î–e
);

775 
	`addR•lyBulk
(
c
,
–e
);

777 
	}
}

779 
	$qsÜtCom·»S‘sByC¬dš®™y
(cÚ¡ *
s1
, cÚ¡ *
s2
) {

780  
	`£tTy³Size
(*(
robj
**)
s1
)-£tTy³Size(*Ôobj**)
s2
);

781 
	}
}

785 
	$qsÜtCom·»S‘sByRevC¬dš®™y
(cÚ¡ *
s1
, cÚ¡ *
s2
) {

786 
robj
 *
o1
 = *Ôobj**)
s1
, *
o2
 = *Ôobj**)
s2
;

788  (
o2
 ? 
	`£tTy³Size
(o2è: 0è- (
o1
 ? setTypeSize(o1) : 0);

789 
	}
}

791 
	$sš‹rG’”icCommªd
(
ş›Á
 *
c
, 
robj
 **
£tkeys
,

792 
£Šum
, 
robj
 *
d¡key
) {

793 
robj
 **
£ts
 = 
	`zm®loc
(Ôobj*)*
£Šum
);

794 
£tTy³I‹¿tÜ
 *
si
;

795 
robj
 *
–eobj
, *
d¡£t
 = 
NULL
;

796 
št64_t
 
štobj
;

797 *
»¶yËn
 = 
NULL
;

798 
j
, 
ÿrdš®™y
 = 0;

799 
’codšg
;

801 
j
 = 0; j < 
£Šum
; j++) {

802 
robj
 *
£tobj
 = 
d¡key
 ?

803 
	`lookupKeyWr™e
(
c
->
db
,
£tkeys
[
j
]) :

804 
	`lookupKeyR—d
(
c
->
db
,
£tkeys
[
j
]);

805 ià(!
£tobj
) {

806 
	`zä“
(
£ts
);

807 ià(
d¡key
) {

808 ià(
	`dbD–‘e
(
c
->
db
,
d¡key
)) {

809 
	`sigÇlModif›dKey
(
c
->
db
,
d¡key
);

810 
£rv”
.
dœty
++;

812 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

814 
	`addR•ly
(
c
,
sh¬ed
.
em±ymuÉibulk
);

818 ià(
	`checkTy³
(
c
,
£tobj
,
OBJ_SET
)) {

819 
	`zä“
(
£ts
);

822 
£ts
[
j
] = 
£tobj
;

826 
	`qsÜt
(
£ts
,
£Šum
,(
robj
*),
qsÜtCom·»S‘sByC¬dš®™y
);

833 ià(!
d¡key
) {

834 
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

838 
d¡£t
 = 
	`ü—‹IÁ£tObjeù
();

844 
si
 = 
	`£tTy³In™I‹¿tÜ
(
£ts
[0]);

845 (
’codšg
 = 
	`£tTy³Next
(
si
,&
–eobj
,&
štobj
)) != -1) {

846 
j
 = 1; j < 
£Šum
; j++) {

847 ià(
£ts
[
j
] == sets[0]) ;

848 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

850 ià(
£ts
[
j
]->
’codšg
 =ğ
OBJ_ENCODING_INTSET
 &&

851 !
	`št£tFšd
((
št£t
*)
£ts
[
j
]->
±r
,
štobj
))

857 } ià(
£ts
[
j
]->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

858 
–eobj
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
štobj
);

859 ià(!
	`£tTy³IsMemb”
(
£ts
[
j
],
–eobj
)) {

860 
	`deüRefCouÁ
(
–eobj
);

863 
	`deüRefCouÁ
(
–eobj
);

865 } ià(
’codšg
 =ğ
OBJ_ENCODING_HT
) {

869 ià(
–eobj
->
’codšg
 =ğ
OBJ_ENCODING_INT
 &&

870 
£ts
[
j
]->
’codšg
 =ğ
OBJ_ENCODING_INTSET
 &&

871 !
	`št£tFšd
((
št£t
*)
£ts
[
j
]->
±r
,()
–eobj
->ptr))

876 } ià(!
	`£tTy³IsMemb”
(
£ts
[
j
],
–eobj
)) {

883 ià(
j
 =ğ
£Šum
) {

884 ià(!
d¡key
) {

885 ià(
’codšg
 =ğ
OBJ_ENCODING_HT
)

886 
	`addR•lyBulk
(
c
,
–eobj
);

888 
	`addR•lyBulkLÚgLÚg
(
c
,
štobj
);

889 
ÿrdš®™y
++;

891 ià(
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

892 
–eobj
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
štobj
);

893 
	`£tTy³Add
(
d¡£t
,
–eobj
);

894 
	`deüRefCouÁ
(
–eobj
);

896 
	`£tTy³Add
(
d¡£t
,
–eobj
);

901 
	`£tTy³R–—£I‹¿tÜ
(
si
);

903 ià(
d¡key
) {

906 
d–‘ed
 = 
	`dbD–‘e
(
c
->
db
,
d¡key
);

907 ià(
	`£tTy³Size
(
d¡£t
) > 0) {

908 
	`dbAdd
(
c
->
db
,
d¡key
,
d¡£t
);

909 
	`addR•lyLÚgLÚg
(
c
,
	`£tTy³Size
(
d¡£t
));

910 
	`nÙifyKey¥aûEv’t
(
NOTIFY_SET
,"sinterstore",

911 
d¡key
,
c
->
db
->
id
);

913 
	`deüRefCouÁ
(
d¡£t
);

914 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

915 ià(
d–‘ed
)

916 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"del",

917 
d¡key
,
c
->
db
->
id
);

919 
	`sigÇlModif›dKey
(
c
->
db
,
d¡key
);

920 
£rv”
.
dœty
++;

922 
	`£tDeã¼edMuÉiBulkL’gth
(
c
,
»¶yËn
,
ÿrdš®™y
);

924 
	`zä“
(
£ts
);

925 
	}
}

927 
	$sš‹rCommªd
(
ş›Á
 *
c
) {

928 
	`sš‹rG’”icCommªd
(
c
,c->
¬gv
+1,c->
¬gc
-1,
NULL
);

929 
	}
}

931 
	$sš‹r¡ÜeCommªd
(
ş›Á
 *
c
) {

932 
	`sš‹rG’”icCommªd
(
c
,c->
¬gv
+2,c->
¬gc
-2,c->argv[1]);

933 
	}
}

935 
	#SET_OP_UNION
 0

	)

936 
	#SET_OP_DIFF
 1

	)

937 
	#SET_OP_INTER
 2

	)

939 
	$suniÚDiffG’”icCommªd
(
ş›Á
 *
c
, 
robj
 **
£tkeys
, 
£Šum
,

940 
robj
 *
d¡key
, 
İ
) {

941 
robj
 **
£ts
 = 
	`zm®loc
(Ôobj*)*
£Šum
);

942 
£tTy³I‹¿tÜ
 *
si
;

943 
robj
 *
–e
, *
d¡£t
 = 
NULL
;

944 
j
, 
ÿrdš®™y
 = 0;

945 
diff_®go
 = 1;

947 
j
 = 0; j < 
£Šum
; j++) {

948 
robj
 *
£tobj
 = 
d¡key
 ?

949 
	`lookupKeyWr™e
(
c
->
db
,
£tkeys
[
j
]) :

950 
	`lookupKeyR—d
(
c
->
db
,
£tkeys
[
j
]);

951 ià(!
£tobj
) {

952 
£ts
[
j
] = 
NULL
;

955 ià(
	`checkTy³
(
c
,
£tobj
,
OBJ_SET
)) {

956 
	`zä“
(
£ts
);

959 
£ts
[
j
] = 
£tobj
;

971 ià(
İ
 =ğ
SET_OP_DIFF
 && 
£ts
[0]) {

972 
®go_Úe_wÜk
 = 0, 
®go_two_wÜk
 = 0;

974 
j
 = 0; j < 
£Šum
; j++) {

975 ià(
£ts
[
j
] =ğ
NULL
) ;

977 
®go_Úe_wÜk
 +ğ
	`£tTy³Size
(
£ts
[0]);

978 
®go_two_wÜk
 +ğ
	`£tTy³Size
(
£ts
[
j
]);

983 
®go_Úe_wÜk
 /= 2;

984 
diff_®go
 = (
®go_Úe_wÜk
 <ğ
®go_two_wÜk
) ? 1 : 2;

986 ià(
diff_®go
 =ğ1 && 
£Šum
 > 1) {

990 
	`qsÜt
(
£ts
+1,
£Šum
-1,(
robj
*),

991 
qsÜtCom·»S‘sByRevC¬dš®™y
);

998 
d¡£t
 = 
	`ü—‹IÁ£tObjeù
();

1000 ià(
İ
 =ğ
SET_OP_UNION
) {

1003 
j
 = 0; j < 
£Šum
; j++) {

1004 ià(!
£ts
[
j
]) ;

1006 
si
 = 
	`£tTy³In™I‹¿tÜ
(
£ts
[
j
]);

1007 (
–e
 = 
	`£tTy³NextObjeù
(
si
)è!ğ
NULL
) {

1008 ià(
	`£tTy³Add
(
d¡£t
,
–e
)è
ÿrdš®™y
++;

1009 
	`deüRefCouÁ
(
–e
);

1011 
	`£tTy³R–—£I‹¿tÜ
(
si
);

1013 } ià(
İ
 =ğ
SET_OP_DIFF
 && 
£ts
[0] && 
diff_®go
 == 1) {

1022 
si
 = 
	`£tTy³In™I‹¿tÜ
(
£ts
[0]);

1023 (
–e
 = 
	`£tTy³NextObjeù
(
si
)è!ğ
NULL
) {

1024 
j
 = 1; j < 
£Šum
; j++) {

1025 ià(!
£ts
[
j
]) ;

1026 ià(
£ts
[
j
] == sets[0]) ;

1027 ià(
	`£tTy³IsMemb”
(
£ts
[
j
],
–e
)) ;

1029 ià(
j
 =ğ
£Šum
) {

1031 
	`£tTy³Add
(
d¡£t
,
–e
);

1032 
ÿrdš®™y
++;

1034 
	`deüRefCouÁ
(
–e
);

1036 
	`£tTy³R–—£I‹¿tÜ
(
si
);

1037 } ià(
İ
 =ğ
SET_OP_DIFF
 && 
£ts
[0] && 
diff_®go
 == 2) {

1045 
j
 = 0; j < 
£Šum
; j++) {

1046 ià(!
£ts
[
j
]) ;

1048 
si
 = 
	`£tTy³In™I‹¿tÜ
(
£ts
[
j
]);

1049 (
–e
 = 
	`£tTy³NextObjeù
(
si
)è!ğ
NULL
) {

1050 ià(
j
 == 0) {

1051 ià(
	`£tTy³Add
(
d¡£t
,
–e
)è
ÿrdš®™y
++;

1053 ià(
	`£tTy³Remove
(
d¡£t
,
–e
)è
ÿrdš®™y
--;

1055 
	`deüRefCouÁ
(
–e
);

1057 
	`£tTy³R–—£I‹¿tÜ
(
si
);

1061 ià(
ÿrdš®™y
 == 0) ;

1066 ià(!
d¡key
) {

1067 
	`addR•lyMuÉiBulkL’
(
c
,
ÿrdš®™y
);

1068 
si
 = 
	`£tTy³In™I‹¿tÜ
(
d¡£t
);

1069 (
–e
 = 
	`£tTy³NextObjeù
(
si
)è!ğ
NULL
) {

1070 
	`addR•lyBulk
(
c
,
–e
);

1071 
	`deüRefCouÁ
(
–e
);

1073 
	`£tTy³R–—£I‹¿tÜ
(
si
);

1074 
	`deüRefCouÁ
(
d¡£t
);

1078 
d–‘ed
 = 
	`dbD–‘e
(
c
->
db
,
d¡key
);

1079 ià(
	`£tTy³Size
(
d¡£t
) > 0) {

1080 
	`dbAdd
(
c
->
db
,
d¡key
,
d¡£t
);

1081 
	`addR•lyLÚgLÚg
(
c
,
	`£tTy³Size
(
d¡£t
));

1082 
	`nÙifyKey¥aûEv’t
(
NOTIFY_SET
,

1083 
İ
 =ğ
SET_OP_UNION
 ? "sunionstore" : "sdiffstore",

1084 
d¡key
,
c
->
db
->
id
);

1086 
	`deüRefCouÁ
(
d¡£t
);

1087 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

1088 ià(
d–‘ed
)

1089 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"del",

1090 
d¡key
,
c
->
db
->
id
);

1092 
	`sigÇlModif›dKey
(
c
->
db
,
d¡key
);

1093 
£rv”
.
dœty
++;

1095 
	`zä“
(
£ts
);

1096 
	}
}

1098 
	$suniÚCommªd
(
ş›Á
 *
c
) {

1099 
	`suniÚDiffG’”icCommªd
(
c
,c->
¬gv
+1,c->
¬gc
-1,
NULL
,
SET_OP_UNION
);

1100 
	}
}

1102 
	$suniÚ¡ÜeCommªd
(
ş›Á
 *
c
) {

1103 
	`suniÚDiffG’”icCommªd
(
c
,c->
¬gv
+2,c->
¬gc
-2,c->¬gv[1],
SET_OP_UNION
);

1104 
	}
}

1106 
	$sdiffCommªd
(
ş›Á
 *
c
) {

1107 
	`suniÚDiffG’”icCommªd
(
c
,c->
¬gv
+1,c->
¬gc
-1,
NULL
,
SET_OP_DIFF
);

1108 
	}
}

1110 
	$sdiff¡ÜeCommªd
(
ş›Á
 *
c
) {

1111 
	`suniÚDiffG’”icCommªd
(
c
,c->
¬gv
+2,c->
¬gc
-2,c->¬gv[1],
SET_OP_DIFF
);

1112 
	}
}

1114 
	$ssÿnCommªd
(
ş›Á
 *
c
) {

1115 
robj
 *
£t
;

1116 
cursÜ
;

1118 ià(
	`·r£SÿnCursÜOrR•ly
(
c
,c->
¬gv
[2],&
cursÜ
è=ğ
C_ERR
) ;

1119 ià((
£t
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
em±ysÿn
)è=ğ
NULL
 ||

1120 
	`checkTy³
(
c
,
£t
,
OBJ_SET
)) ;

1121 
	`sÿnG’”icCommªd
(
c
,
£t
,
cursÜ
);

1122 
	}
}

	@src/t_string.c

30 
	~"£rv”.h
"

31 
	~<m©h.h
>

37 
	$checkSŒšgL’gth
(
ş›Á
 *
c
, 
size
) {

38 ià(
size
 > 512*1024*1024) {

39 
	`addR•lyE¼Ü
(
c
,"stringƒxceeds maximum‡llowed size (512MB)");

40  
C_ERR
;

42  
C_OK
;

43 
	}
}

61 
	#OBJ_SET_NO_FLAGS
 0

	)

62 
	#OBJ_SET_NX
 (1<<0è

	)

63 
	#OBJ_SET_XX
 (1<<1è

	)

64 
	#OBJ_SET_EX
 (1<<2è

	)

65 
	#OBJ_SET_PX
 (1<<3è

	)

67 
	$£tG’”icCommªd
(
ş›Á
 *
c
, 
æags
, 
robj
 *
key
,„obj *
v®
,„obj *
expœe
, 
un™
,„obj *
ok_»¶y
,„obj *
abÜt_»¶y
) {

68 
mli£cÚds
 = 0;

69 #ifdeà
USE_PMDK


70 
robj
* 
ÃwV®
 = 0;

73 ià(
expœe
) {

74 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
, 
expœe
, &
mli£cÚds
, 
NULL
è!ğ
C_OK
)

76 ià(
mli£cÚds
 <= 0) {

77 
	`addR•lyE¼ÜFÜm©
(
c
,"šv®idƒxpœtimš %s",c->
cmd
->
Çme
);

80 ià(
un™
 =ğ
UNIT_SECONDS
è
mli£cÚds
 *= 1000;

83 ià((
æags
 & 
OBJ_SET_NX
 && 
	`lookupKeyWr™e
(
c
->
db
,
key
è!ğ
NULL
) ||

84 (
æags
 & 
OBJ_SET_XX
 && 
	`lookupKeyWr™e
(
c
->
db
,
key
è=ğ
NULL
))

86 
	`addR•ly
(
c
, 
abÜt_»¶y
 ?‡bÜt_»¶y : 
sh¬ed
.
nuÎbulk
);

89 #ifdeà
USE_PMDK


90 ià(
£rv”
.
³rsi¡’t
) {

91 
”rÜ
 = 0;

94 
	`TX_BEGIN
(
£rv”
.
pm_poŞ
) {

95 
ÃwV®
 = 
	`dupSŒšgObjeùPM
(
v®
);

98 
	`£tKeyPM
(
c
->
db
,
key
,
ÃwV®
);

99 } 
TX_ONABORT
 {

100 
”rÜ
 = 1;

101 } 
TX_END


103 ià(
”rÜ
) {

104 
	`addR•lyE¼Ü
(
c
, "setting key in PM failed!");

108 
	`£tKey
(
c
->
db
,
key
,
v®
);

111 
	`£tKey
(
c
->
db
,
key
,
v®
);

113 
£rv”
.
dœty
++;

114 ià(
expœe
è
	`£tExpœe
(
c
->
db
,
key
,
	`m¡ime
()+
mli£cÚds
);

115 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"£t",
key
,
c
->
db
->
id
);

116 ià(
expœe
è
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,

117 "expœe",
key
,
c
->
db
->
id
);

118 
	`addR•ly
(
c
, 
ok_»¶y
 ? ok_»¶y : 
sh¬ed
.
ok
);

119 
	}
}

122 
	$£tCommªd
(
ş›Á
 *
c
) {

123 
j
;

124 
robj
 *
expœe
 = 
NULL
;

125 
un™
 = 
UNIT_SECONDS
;

126 
æags
 = 
OBJ_SET_NO_FLAGS
;

128 
j
 = 3; j < 
c
->
¬gc
; j++) {

129 *
a
 = 
c
->
¬gv
[
j
]->
±r
;

130 
robj
 *
Ãxt
 = (
j
 =ğ
c
->
¬gc
-1è? 
NULL
 : c->
¬gv
[j+1];

132 ià((
a
[0] == 'n' ||‡[0] == 'N') &&

133 (
a
[1] == 'x' ||‡[1] == 'X') &&‡[2] == '\0' &&

134 !(
æags
 & 
OBJ_SET_XX
))

136 
æags
 |ğ
OBJ_SET_NX
;

137 } ià((
a
[0] == 'x' ||‡[0] == 'X') &&

138 (
a
[1] == 'x' ||‡[1] == 'X') &&‡[2] == '\0' &&

139 !(
æags
 & 
OBJ_SET_NX
))

141 
æags
 |ğ
OBJ_SET_XX
;

142 } ià((
a
[0] == 'e' ||‡[0] == 'E') &&

143 (
a
[1] == 'x' ||‡[1] == 'X') &&‡[2] == '\0' &&

144 !(
æags
 & 
OBJ_SET_PX
è&& 
Ãxt
)

146 
æags
 |ğ
OBJ_SET_EX
;

147 
un™
 = 
UNIT_SECONDS
;

148 
expœe
 = 
Ãxt
;

149 
j
++;

150 } ià((
a
[0] == 'p' ||‡[0] == 'P') &&

151 (
a
[1] == 'x' ||‡[1] == 'X') &&‡[2] == '\0' &&

152 !(
æags
 & 
OBJ_SET_EX
è&& 
Ãxt
)

154 
æags
 |ğ
OBJ_SET_PX
;

155 
un™
 = 
UNIT_MILLISECONDS
;

156 
expœe
 = 
Ãxt
;

157 
j
++;

159 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

164 
c
->
¬gv
[2] = 
	`ŒyObjeùEncodšg
(c->argv[2]);

165 
	`£tG’”icCommªd
(
c
,
æags
,c->
¬gv
[1],c->¬gv[2],
expœe
,
un™
,
NULL
,NULL); 
	`ıavi£_tx_’d
();

166 
	}
}

168 
	$£ŠxCommªd
(
ş›Á
 *
c
) {

169 
c
->
¬gv
[2] = 
	`ŒyObjeùEncodšg
(c->argv[2]);

170 
	`£tG’”icCommªd
(
c
,
OBJ_SET_NX
,c->
¬gv
[1],c->¬gv[2],
NULL
,0,
sh¬ed
.
cÚe
,sh¬ed.
cz”o
);

171 
	}
}

173 
	$£‹xCommªd
(
ş›Á
 *
c
) {

174 
c
->
¬gv
[3] = 
	`ŒyObjeùEncodšg
(c->argv[3]);

175 
	`£tG’”icCommªd
(
c
,
OBJ_SET_NO_FLAGS
,c->
¬gv
[1],c->¬gv[3],c->¬gv[2],
UNIT_SECONDS
,
NULL
,NULL);

176 
	}
}

178 
	$p£‹xCommªd
(
ş›Á
 *
c
) {

179 
c
->
¬gv
[3] = 
	`ŒyObjeùEncodšg
(c->argv[3]);

180 
	`£tG’”icCommªd
(
c
,
OBJ_SET_NO_FLAGS
,c->
¬gv
[1],c->¬gv[3],c->¬gv[2],
UNIT_MILLISECONDS
,
NULL
,NULL);

181 
	}
}

183 
	$g‘G’”icCommªd
(
ş›Á
 *
c
) {

184 
robj
 *
o
;

186 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
nuÎbulk
)è=ğ
NULL
)

187  
C_OK
;

189 ià(
o
->
ty³
 !ğ
OBJ_STRING
) {

190 
	`addR•ly
(
c
,
sh¬ed
.
wrÚgty³”r
);

191  
C_ERR
;

193 
	`addR•lyBulk
(
c
,
o
);

194  
C_OK
;

196 
	}
}

198 
	$g‘Commªd
(
ş›Á
 *
c
) {

199 
	`g‘G’”icCommªd
(
c
);

200 
	}
}

202 
	$g‘£tCommªd
(
ş›Á
 *
c
) {

203 ià(
	`g‘G’”icCommªd
(
c
è=ğ
C_ERR
) ;

204 
c
->
¬gv
[2] = 
	`ŒyObjeùEncodšg
(c->argv[2]);

205 
	`£tKey
(
c
->
db
,c->
¬gv
[1],c->argv[2]);

206 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"£t",
c
->
¬gv
[1],c->
db
->
id
);

207 
£rv”
.
dœty
++;

208 
	}
}

210 
	$£ŒªgeCommªd
(
ş›Á
 *
c
) {

211 
robj
 *
o
;

212 
off£t
;

213 
sds
 
v®ue
 = 
c
->
¬gv
[3]->
±r
;

215 ià(
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
off£t
,
NULL
è!ğ
C_OK
)

218 ià(
off£t
 < 0) {

219 
	`addR•lyE¼Ü
(
c
,"offset is out of„ange");

223 
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

224 ià(
o
 =ğ
NULL
) {

226 ià(
	`sd¦’
(
v®ue
) == 0) {

227 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

232 ià(
	`checkSŒšgL’gth
(
c
,
off£t
+
	`sd¦’
(
v®ue
)è!ğ
C_OK
)

235 
o
 = 
	`ü—‹Objeù
(
OBJ_STRING
,
	`sd¢ewËn
(
NULL
, 
off£t
+
	`sd¦’
(
v®ue
)));

236 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],
o
);

238 
size_t
 
Ş’
;

241 ià(
	`checkTy³
(
c
,
o
,
OBJ_STRING
))

245 
Ş’
 = 
	`¡ršgObjeùL’
(
o
);

246 ià(
	`sd¦’
(
v®ue
) == 0) {

247 
	`addR•lyLÚgLÚg
(
c
,
Ş’
);

252 ià(
	`checkSŒšgL’gth
(
c
,
off£t
+
	`sd¦’
(
v®ue
)è!ğ
C_OK
)

256 
o
 = 
	`dbUnsh¬eSŒšgV®ue
(
c
->
db
,c->
¬gv
[1],o);

259 ià(
	`sd¦’
(
v®ue
) > 0) {

260 
o
->
±r
 = 
	`sdsgrowz”o
(o->±r,
off£t
+
	`sd¦’
(
v®ue
));

261 
	`memıy
((*)
o
->
±r
+
off£t
,
v®ue
,
	`sd¦’
(value));

262 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

263 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,

264 "£Œªge",
c
->
¬gv
[1],c->
db
->
id
);

265 
£rv”
.
dœty
++;

267 
	`addR•lyLÚgLÚg
(
c
,
	`sd¦’
(
o
->
±r
));

268 
	}
}

270 
	$g‘¿ngeCommªd
(
ş›Á
 *
c
) {

271 
robj
 *
o
;

272 
¡¬t
, 
’d
;

273 *
¡r
, 
Îbuf
[32];

274 
size_t
 
¡¾’
;

276 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
¡¬t
,
NULL
è!ğ
C_OK
)

278 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
’d
,
NULL
è!ğ
C_OK
)

280 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
em±ybulk
)è=ğ
NULL
 ||

281 
	`checkTy³
(
c
,
o
,
OBJ_STRING
)) ;

283 ià(
o
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

284 
¡r
 = 
Îbuf
;

285 
¡¾’
 = 
	`Î2¡ršg
(
Îbuf
,Ölbuf),()
o
->
±r
);

287 
¡r
 = 
o
->
±r
;

288 
¡¾’
 = 
	`sd¦’
(
¡r
);

292 ià(
¡¬t
 < 0 && 
’d
 < 0 && start >ƒnd) {

293 
	`addR•ly
(
c
,
sh¬ed
.
em±ybulk
);

296 ià(
¡¬t
 < 0è¡¬ˆğ
¡¾’
+start;

297 ià(
’d
 < 0è’d = 
¡¾’
+end;

298 ià(
¡¬t
 < 0) start = 0;

299 ià(
’d
 < 0)ƒnd = 0;

300 ià(()
’d
 >ğ
¡¾’
)ƒnd = strlen-1;

304 ià(
¡¬t
 > 
’d
 || 
¡¾’
 == 0) {

305 
	`addR•ly
(
c
,
sh¬ed
.
em±ybulk
);

307 
	`addR•lyBulkCBufãr
(
c
,(*)
¡r
+
¡¬t
,
’d
-start+1);

309 
	}
}

311 
	$mg‘Commªd
(
ş›Á
 *
c
) {

312 
j
;

314 
	`addR•lyMuÉiBulkL’
(
c
,c->
¬gc
-1);

315 
j
 = 1; j < 
c
->
¬gc
; j++) {

316 
robj
 *
o
 = 
	`lookupKeyR—d
(
c
->
db
,c->
¬gv
[
j
]);

317 ià(
o
 =ğ
NULL
) {

318 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

320 ià(
o
->
ty³
 !ğ
OBJ_STRING
) {

321 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

323 
	`addR•lyBulk
(
c
,
o
);

327 
	}
}

329 
	$m£tG’”icCommªd
(
ş›Á
 *
c
, 
nx
) {

330 
j
, 
busykeys
 = 0;

332 ià((
c
->
¬gc
 % 2) == 0) {

333 
	`addR•lyE¼Ü
(
c
,"wrong‚umber of‡rguments for MSET");

338 ià(
nx
) {

339 
j
 = 1; j < 
c
->
¬gc
; j += 2) {

340 ià(
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[
j
]è!ğ
NULL
) {

341 
busykeys
++;

344 ià(
busykeys
) {

345 
	`addR•ly
(
c
, 
sh¬ed
.
cz”o
);

350 
j
 = 1; j < 
c
->
¬gc
; j += 2) {

351 
c
->
¬gv
[
j
+1] = 
	`ŒyObjeùEncodšg
(c->argv[j+1]);

352 
	`£tKey
(
c
->
db
,c->
¬gv
[
j
],c->argv[j+1]);

353 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"£t",
c
->
¬gv
[
j
],c->
db
->
id
);

355 
£rv”
.
dœty
 +ğ(
c
->
¬gc
-1)/2;

356 
	`addR•ly
(
c
, 
nx
 ? 
sh¬ed
.
cÚe
 : sh¬ed.
ok
);

357 
	}
}

359 
	$m£tCommªd
(
ş›Á
 *
c
) {

360 
	`m£tG’”icCommªd
(
c
,0);

361 
	}
}

363 
	$m£ŠxCommªd
(
ş›Á
 *
c
) {

364 
	`m£tG’”icCommªd
(
c
,1);

365 
	}
}

367 
	$šüDeüCommªd
(
ş›Á
 *
c
, 
šü
) {

368 
v®ue
, 
Şdv®ue
;

369 
robj
 *
o
, *
Ãw
;

371 
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

372 ià(
o
 !ğ
NULL
 && 
	`checkTy³
(
c
,o,
OBJ_STRING
)) ;

373 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
,
o
,&
v®ue
,
NULL
è!ğ
C_OK
) ;

375 
Şdv®ue
 = 
v®ue
;

376 ià((
šü
 < 0 && 
Şdv®ue
 < 0 && inü < (
LLONG_MIN
-oldvalue)) ||

377 (
šü
 > 0 && 
Şdv®ue
 > 0 && inü > (
LLONG_MAX
-oldvalue))) {

378 
	`addR•lyE¼Ü
(
c
,"increment or decrement would overflow");

381 
v®ue
 +ğ
šü
;

383 ià(
o
 && o->
»fcouÁ
 =ğ1 && o->
’codšg
 =ğ
OBJ_ENCODING_INT
 &&

384 (
v®ue
 < 0 || v®u>ğ
OBJ_SHARED_INTEGERS
) &&

385 
v®ue
 >ğ
LONG_MIN
 && v®u<ğ
LONG_MAX
)

387 
Ãw
 = 
o
;

388 
o
->
±r
 = (*)(()
v®ue
);

390 
Ãw
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
v®ue
);

391 ià(
o
) {

392 
	`dbOv”wr™e
(
c
->
db
,c->
¬gv
[1],
Ãw
);

394 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],
Ãw
);

397 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

398 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"šüby",
c
->
¬gv
[1],c->
db
->
id
);

399 
£rv”
.
dœty
++;

400 
	`addR•ly
(
c
,
sh¬ed
.
cŞÚ
);

401 
	`addR•ly
(
c
,
Ãw
);

402 
	`addR•ly
(
c
,
sh¬ed
.
ülf
);

403 
	}
}

405 
	$šüCommªd
(
ş›Á
 *
c
) {

406 
	`šüDeüCommªd
(
c
,1);

407 
	}
}

409 
	$deüCommªd
(
ş›Á
 *
c
) {

410 
	`šüDeüCommªd
(
c
,-1);

411 
	}
}

413 
	$šübyCommªd
(
ş›Á
 *
c
) {

414 
šü
;

416 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
šü
, 
NULL
è!ğ
C_OK
) ;

417 
	`šüDeüCommªd
(
c
,
šü
);

418 
	}
}

420 
	$deübyCommªd
(
ş›Á
 *
c
) {

421 
šü
;

423 ià(
	`g‘LÚgLÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
šü
, 
NULL
è!ğ
C_OK
) ;

424 
	`šüDeüCommªd
(
c
,-
šü
);

425 
	}
}

427 
	$šübyæßtCommªd
(
ş›Á
 *
c
) {

428 
šü
, 
v®ue
;

429 
robj
 *
o
, *
Ãw
, *
aux
;

431 
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

432 ià(
o
 !ğ
NULL
 && 
	`checkTy³
(
c
,o,
OBJ_STRING
)) ;

433 ià(
	`g‘LÚgDoubËFromObjeùOrR•ly
(
c
,
o
,&
v®ue
,
NULL
è!ğ
C_OK
 ||

434 
	`g‘LÚgDoubËFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
šü
,
NULL
è!ğ
C_OK
)

437 
v®ue
 +ğ
šü
;

438 ià(
	`i¢ª
(
v®ue
è|| 
	`isšf
(value)) {

439 
	`addR•lyE¼Ü
(
c
,"increment would…roduce NaN or Infinity");

442 
Ãw
 = 
	`ü—‹SŒšgObjeùFromLÚgDoubË
(
v®ue
,1);

443 ià(
o
)

444 
	`dbOv”wr™e
(
c
->
db
,c->
¬gv
[1],
Ãw
);

446 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],
Ãw
);

447 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

448 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"šübyæßt",
c
->
¬gv
[1],c->
db
->
id
);

449 
£rv”
.
dœty
++;

450 
	`addR•lyBulk
(
c
,
Ãw
);

455 
aux
 = 
	`ü—‹SŒšgObjeù
("SET",3);

456 
	`»wr™eCl›ÁCommªdArgum’t
(
c
,0,
aux
);

457 
	`deüRefCouÁ
(
aux
);

458 
	`»wr™eCl›ÁCommªdArgum’t
(
c
,2,
Ãw
);

459 
	}
}

461 
	$­³ndCommªd
(
ş›Á
 *
c
) {

462 
size_t
 
tÙËn
;

463 
robj
 *
o
, *
­³nd
;

465 
o
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[1]);

466 ià(
o
 =ğ
NULL
) {

468 
c
->
¬gv
[2] = 
	`ŒyObjeùEncodšg
(c->argv[2]);

469 
	`dbAdd
(
c
->
db
,c->
¬gv
[1],c->argv[2]);

470 
	`šüRefCouÁ
(
c
->
¬gv
[2]);

471 
tÙËn
 = 
	`¡ršgObjeùL’
(
c
->
¬gv
[2]);

474 ià(
	`checkTy³
(
c
,
o
,
OBJ_STRING
))

478 
­³nd
 = 
c
->
¬gv
[2];

479 
tÙËn
 = 
	`¡ršgObjeùL’
(
o
)+
	`sd¦’
(
­³nd
->
±r
);

480 ià(
	`checkSŒšgL’gth
(
c
,
tÙËn
è!ğ
C_OK
)

484 
o
 = 
	`dbUnsh¬eSŒšgV®ue
(
c
->
db
,c->
¬gv
[1],o);

485 
o
->
±r
 = 
	`sdsÿ’
(o->±r,
­³nd
->±r,
	`sd¦’
(append->ptr));

486 
tÙËn
 = 
	`sd¦’
(
o
->
±r
);

488 
	`sigÇlModif›dKey
(
c
->
db
,c->
¬gv
[1]);

489 
	`nÙifyKey¥aûEv’t
(
NOTIFY_STRING
,"­³nd",
c
->
¬gv
[1],c->
db
->
id
);

490 
£rv”
.
dœty
++;

491 
	`addR•lyLÚgLÚg
(
c
,
tÙËn
);

492 
	}
}

494 
	$¡¾’Commªd
(
ş›Á
 *
c
) {

495 
robj
 *
o
;

496 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

497 
	`checkTy³
(
c
,
o
,
OBJ_STRING
)) ;

498 
	`addR•lyLÚgLÚg
(
c
,
	`¡ršgObjeùL’
(
o
));

499 
	}
}

	@src/t_zset.c

52 
	~"£rv”.h
"

53 
	~<m©h.h
>

55 
z¦LexV®ueG‹Mš
(
robj
 *
v®ue
, 
zËx¿nge¥ec
 *
¥ec
);

56 
z¦LexV®ueL‹Max
(
robj
 *
v®ue
, 
zËx¿nge¥ec
 *
¥ec
);

58 
zskli¡Node
 *
	$z¦C»©eNode
(
Ëv–
, 
scÜe
, 
robj
 *
obj
) {

59 
zskli¡Node
 *
zn
 = 
	`zm®loc
((*zn)+
Ëv–
*(
zskli¡Lev–
));

60 
zn
->
scÜe
 = score;

61 
zn
->
obj
 = obj;

62  
zn
;

63 
	}
}

65 
zskli¡
 *
	$z¦C»©e
() {

66 
j
;

67 
zskli¡
 *
z¦
;

69 
z¦
 = 
	`zm®loc
((*zsl));

70 
z¦
->
Ëv–
 = 1;

71 
z¦
->
Ëngth
 = 0;

72 
z¦
->
h—d”
 = 
	`z¦C»©eNode
(
ZSKIPLIST_MAXLEVEL
,0,
NULL
);

73 
j
 = 0; j < 
ZSKIPLIST_MAXLEVEL
; j++) {

74 
z¦
->
h—d”
->
Ëv–
[
j
].
fÜw¬d
 = 
NULL
;

75 
z¦
->
h—d”
->
Ëv–
[
j
].
¥ª
 = 0;

77 
z¦
->
h—d”
->
backw¬d
 = 
NULL
;

78 
z¦
->

 = 
NULL
;

79  
z¦
;

80 
	}
}

82 
	$z¦F»eNode
(
zskli¡Node
 *
node
) {

83 
	`deüRefCouÁ
(
node
->
obj
);

84 
	`zä“
(
node
);

85 
	}
}

87 
	$z¦F»e
(
zskli¡
 *
z¦
) {

88 
zskli¡Node
 *
node
 = 
z¦
->
h—d”
->
Ëv–
[0].
fÜw¬d
, *
Ãxt
;

90 
	`zä“
(
z¦
->
h—d”
);

91 
node
) {

92 
Ãxt
 = 
node
->
Ëv–
[0].
fÜw¬d
;

93 
	`z¦F»eNode
(
node
);

94 
node
 = 
Ãxt
;

96 
	`zä“
(
z¦
);

97 
	}
}

103 
	$z¦RªdomLev–
() {

104 
Ëv–
 = 1;

105 (
	`¿ndom
()&0xFFFFè< (
ZSKIPLIST_P
 * 0xFFFF))

106 
Ëv–
 += 1;

107  (
Ëv–
<
ZSKIPLIST_MAXLEVEL
) ?†evel : ZSKIPLIST_MAXLEVEL;

108 
	}
}

110 
zskli¡Node
 *
	$z¦In£¹
(
zskli¡
 *
z¦
, 
scÜe
, 
robj
 *
obj
) {

111 
zskli¡Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

112 
¿nk
[
ZSKIPLIST_MAXLEVEL
];

113 
i
, 
Ëv–
;

115 
	`£rv”As£¹
(!
	`i¢ª
(
scÜe
));

116 
x
 = 
z¦
->
h—d”
;

117 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

119 
¿nk
[
i
] = i =ğ(
z¦
->
Ëv–
-1) ? 0 :„ank[i+1];

120 
x
->
Ëv–
[
i
].
fÜw¬d
 &&

121 (
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
 < score ||

122 (
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
 == score &&

123 
	`com·»SŒšgObjeùs
(
x
->
Ëv–
[
i
].
fÜw¬d
->
obj
,obj) < 0))) {

124 
¿nk
[
i
] +ğ
x
->
Ëv–
[i].
¥ª
;

125 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

127 
upd©e
[
i
] = 
x
;

133 
Ëv–
 = 
	`z¦RªdomLev–
();

134 ià(
Ëv–
 > 
z¦
->level) {

135 
i
 = 
z¦
->
Ëv–
; i <†evel; i++) {

136 
¿nk
[
i
] = 0;

137 
upd©e
[
i
] = 
z¦
->
h—d”
;

138 
upd©e
[
i
]->
Ëv–
[i].
¥ª
 = 
z¦
->
Ëngth
;

140 
z¦
->
Ëv–
 =†evel;

142 
x
 = 
	`z¦C»©eNode
(
Ëv–
,
scÜe
,
obj
);

143 
i
 = 0; i < 
Ëv–
; i++) {

144 
x
->
Ëv–
[
i
].
fÜw¬d
 = 
upd©e
[i]->level[i].forward;

145 
upd©e
[
i
]->
Ëv–
[i].
fÜw¬d
 = 
x
;

148 
x
->
Ëv–
[
i
].
¥ª
 = 
upd©e
[i]->Ëv–[i].¥ª - (
¿nk
[0] -„ank[i]);

149 
upd©e
[
i
]->
Ëv–
[i].
¥ª
 = (
¿nk
[0] -„ank[i]) + 1;

153 
i
 = 
Ëv–
; i < 
z¦
->level; i++) {

154 
upd©e
[
i
]->
Ëv–
[i].
¥ª
++;

157 
x
->
backw¬d
 = (
upd©e
[0] =ğ
z¦
->
h—d”
è? 
NULL
 : update[0];

158 ià(
x
->
Ëv–
[0].
fÜw¬d
)

159 
x
->
Ëv–
[0].
fÜw¬d
->
backw¬d
 = x;

161 
z¦
->

 = 
x
;

162 
z¦
->
Ëngth
++;

163  
x
;

164 
	}
}

167 
	$z¦D–‘eNode
(
zskli¡
 *
z¦
, 
zskli¡Node
 *
x
, zskli¡Nod**
upd©e
) {

168 
i
;

169 
i
 = 0; i < 
z¦
->
Ëv–
; i++) {

170 ià(
upd©e
[
i
]->
Ëv–
[i].
fÜw¬d
 =ğ
x
) {

171 
upd©e
[
i
]->
Ëv–
[i].
¥ª
 +ğ
x
->level[i].span - 1;

172 
upd©e
[
i
]->
Ëv–
[i].
fÜw¬d
 = 
x
->level[i].forward;

174 
upd©e
[
i
]->
Ëv–
[i].
¥ª
 -= 1;

177 ià(
x
->
Ëv–
[0].
fÜw¬d
) {

178 
x
->
Ëv–
[0].
fÜw¬d
->
backw¬d
 = x->backward;

180 
z¦
->

 = 
x
->
backw¬d
;

182 
z¦
->
Ëv–
 > 1 && z¦->
h—d”
->Ëv–[z¦->Ëv–-1].
fÜw¬d
 =ğ
NULL
)

183 
z¦
->
Ëv–
--;

184 
z¦
->
Ëngth
--;

185 
	}
}

188 
	$z¦D–‘e
(
zskli¡
 *
z¦
, 
scÜe
, 
robj
 *
obj
) {

189 
zskli¡Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

190 
i
;

192 
x
 = 
z¦
->
h—d”
;

193 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

194 
x
->
Ëv–
[
i
].
fÜw¬d
 &&

195 (
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
 < score ||

196 (
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
 == score &&

197 
	`com·»SŒšgObjeùs
(
x
->
Ëv–
[
i
].
fÜw¬d
->
obj
,obj) < 0)))

198 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

199 
upd©e
[
i
] = 
x
;

203 
x
 = x->
Ëv–
[0].
fÜw¬d
;

204 ià(
x
 && 
scÜe
 =ğx->scÜ&& 
	`equ®SŒšgObjeùs
(x->
obj
,obj)) {

205 
	`z¦D–‘eNode
(
z¦
, 
x
, 
upd©e
);

206 
	`z¦F»eNode
(
x
);

210 
	}
}

212 
	$z¦V®ueG‹Mš
(
v®ue
, 
z¿nge¥ec
 *
¥ec
) {

213  
¥ec
->
mšex
 ? (
v®ue
 > s³c->
mš
) : (value >= spec->min);

214 
	}
}

216 
	$z¦V®ueL‹Max
(
v®ue
, 
z¿nge¥ec
 *
¥ec
) {

217  
¥ec
->
maxex
 ? (
v®ue
 < s³c->
max
) : (value <= spec->max);

218 
	}
}

221 
	$z¦IsInRªge
(
zskli¡
 *
z¦
, 
z¿nge¥ec
 *
¿nge
) {

222 
zskli¡Node
 *
x
;

225 ià(
¿nge
->
mš
 >„ªge->
max
 ||

226 (
¿nge
->
mš
 =ğ¿nge->
max
 && (¿nge->
mšex
 ||„ªge->
maxex
)))

228 
x
 = 
z¦
->

;

229 ià(
x
 =ğ
NULL
 || !
	`z¦V®ueG‹Mš
(x->
scÜe
,
¿nge
))

231 
x
 = 
z¦
->
h—d”
->
Ëv–
[0].
fÜw¬d
;

232 ià(
x
 =ğ
NULL
 || !
	`z¦V®ueL‹Max
(x->
scÜe
,
¿nge
))

235 
	}
}

239 
zskli¡Node
 *
	$z¦Fœ¡InRªge
(
zskli¡
 *
z¦
, 
z¿nge¥ec
 *
¿nge
) {

240 
zskli¡Node
 *
x
;

241 
i
;

244 ià(!
	`z¦IsInRªge
(
z¦
,
¿nge
)è 
NULL
;

246 
x
 = 
z¦
->
h—d”
;

247 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

249 
x
->
Ëv–
[
i
].
fÜw¬d
 &&

250 !
	`z¦V®ueG‹Mš
(
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
,
¿nge
))

251 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

255 
x
 = x->
Ëv–
[0].
fÜw¬d
;

256 
	`£rv”As£¹
(
x
 !ğ
NULL
);

259 ià(!
	`z¦V®ueL‹Max
(
x
->
scÜe
,
¿nge
)è 
NULL
;

260  
x
;

261 
	}
}

265 
zskli¡Node
 *
	$z¦La¡InRªge
(
zskli¡
 *
z¦
, 
z¿nge¥ec
 *
¿nge
) {

266 
zskli¡Node
 *
x
;

267 
i
;

270 ià(!
	`z¦IsInRªge
(
z¦
,
¿nge
)è 
NULL
;

272 
x
 = 
z¦
->
h—d”
;

273 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

275 
x
->
Ëv–
[
i
].
fÜw¬d
 &&

276 
	`z¦V®ueL‹Max
(
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
,
¿nge
))

277 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

281 
	`£rv”As£¹
(
x
 !ğ
NULL
);

284 ià(!
	`z¦V®ueG‹Mš
(
x
->
scÜe
,
¿nge
)è 
NULL
;

285  
x
;

286 
	}
}

292 
	$z¦D–‘eRªgeByScÜe
(
zskli¡
 *
z¦
, 
z¿nge¥ec
 *
¿nge
, 
diù
 *dict) {

293 
zskli¡Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

294 
»moved
 = 0;

295 
i
;

297 
x
 = 
z¦
->
h—d”
;

298 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

299 
x
->
Ëv–
[
i
].
fÜw¬d
 && (
¿nge
->
mšex
 ?

300 
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
 <ğ
¿nge
->
mš
 :

301 
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
 < 
¿nge
->
mš
))

302 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

303 
upd©e
[
i
] = 
x
;

307 
x
 = x->
Ëv–
[0].
fÜw¬d
;

310 
x
 &&

311 (
¿nge
->
maxex
 ? 
x
->
scÜe
 <„ªge->
max
 : x->score <=„ange->max))

313 
zskli¡Node
 *
Ãxt
 = 
x
->
Ëv–
[0].
fÜw¬d
;

314 
	`z¦D–‘eNode
(
z¦
,
x
,
upd©e
);

315 
	`diùD–‘e
(
diù
,
x
->
obj
);

316 
	`z¦F»eNode
(
x
);

317 
»moved
++;

318 
x
 = 
Ãxt
;

320  
»moved
;

321 
	}
}

323 
	$z¦D–‘eRªgeByLex
(
zskli¡
 *
z¦
, 
zËx¿nge¥ec
 *
¿nge
, 
diù
 *dict) {

324 
zskli¡Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

325 
»moved
 = 0;

326 
i
;

329 
x
 = 
z¦
->
h—d”
;

330 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

331 
x
->
Ëv–
[
i
].
fÜw¬d
 &&

332 !
	`z¦LexV®ueG‹Mš
(
x
->
Ëv–
[
i
].
fÜw¬d
->
obj
,
¿nge
))

333 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

334 
upd©e
[
i
] = 
x
;

338 
x
 = x->
Ëv–
[0].
fÜw¬d
;

341 
x
 && 
	`z¦LexV®ueL‹Max
(x->
obj
,
¿nge
)) {

342 
zskli¡Node
 *
Ãxt
 = 
x
->
Ëv–
[0].
fÜw¬d
;

343 
	`z¦D–‘eNode
(
z¦
,
x
,
upd©e
);

344 
	`diùD–‘e
(
diù
,
x
->
obj
);

345 
	`z¦F»eNode
(
x
);

346 
»moved
++;

347 
x
 = 
Ãxt
;

349  
»moved
;

350 
	}
}

354 
	$z¦D–‘eRªgeByRªk
(
zskli¡
 *
z¦
, 
¡¬t
, 
’d
, 
diù
 *dict) {

355 
zskli¡Node
 *
upd©e
[
ZSKIPLIST_MAXLEVEL
], *
x
;

356 
Œav”£d
 = 0, 
»moved
 = 0;

357 
i
;

359 
x
 = 
z¦
->
h—d”
;

360 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

361 
x
->
Ëv–
[
i
].
fÜw¬d
 && (
Œav”£d
 + x->Ëv–[i].
¥ª
è< 
¡¬t
) {

362 
Œav”£d
 +ğ
x
->
Ëv–
[
i
].
¥ª
;

363 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

365 
upd©e
[
i
] = 
x
;

368 
Œav”£d
++;

369 
x
 = x->
Ëv–
[0].
fÜw¬d
;

370 
x
 && 
Œav”£d
 <ğ
’d
) {

371 
zskli¡Node
 *
Ãxt
 = 
x
->
Ëv–
[0].
fÜw¬d
;

372 
	`z¦D–‘eNode
(
z¦
,
x
,
upd©e
);

373 
	`diùD–‘e
(
diù
,
x
->
obj
);

374 
	`z¦F»eNode
(
x
);

375 
»moved
++;

376 
Œav”£d
++;

377 
x
 = 
Ãxt
;

379  
»moved
;

380 
	}
}

386 
	$z¦G‘Rªk
(
zskli¡
 *
z¦
, 
scÜe
, 
robj
 *
o
) {

387 
zskli¡Node
 *
x
;

388 
¿nk
 = 0;

389 
i
;

391 
x
 = 
z¦
->
h—d”
;

392 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

393 
x
->
Ëv–
[
i
].
fÜw¬d
 &&

394 (
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
 < score ||

395 (
x
->
Ëv–
[
i
].
fÜw¬d
->
scÜe
 == score &&

396 
	`com·»SŒšgObjeùs
(
x
->
Ëv–
[
i
].
fÜw¬d
->
obj
,
o
) <= 0))) {

397 
¿nk
 +ğ
x
->
Ëv–
[
i
].
¥ª
;

398 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

402 ià(
x
->
obj
 && 
	`equ®SŒšgObjeùs
(x->obj,
o
)) {

403  
¿nk
;

407 
	}
}

410 
zskli¡Node
* 
	$z¦G‘EËm’tByRªk
(
zskli¡
 *
z¦
, 
¿nk
) {

411 
zskli¡Node
 *
x
;

412 
Œav”£d
 = 0;

413 
i
;

415 
x
 = 
z¦
->
h—d”
;

416 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

417 
x
->
Ëv–
[
i
].
fÜw¬d
 && (
Œav”£d
 + x->Ëv–[i].
¥ª
è<ğ
¿nk
)

419 
Œav”£d
 +ğ
x
->
Ëv–
[
i
].
¥ª
;

420 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

422 ià(
Œav”£d
 =ğ
¿nk
) {

423  
x
;

426  
NULL
;

427 
	}
}

430 
	$z¦P¬£Rªge
(
robj
 *
mš
,„obj *
max
, 
z¿nge¥ec
 *
¥ec
) {

431 *
•Œ
;

432 
¥ec
->
mšex
 = s³c->
maxex
 = 0;

438 ià(
mš
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

439 
¥ec
->
mš
 = ()mš->
±r
;

441 ià(((*)
mš
->
±r
)[0] == '(') {

442 
¥ec
->
mš
 = 
	`¡¹od
((*)mš->
±r
+1,&
•Œ
);

443 ià(
•Œ
[0] !ğ'\0' || 
	`i¢ª
(
¥ec
->
mš
)è 
C_ERR
;

444 
¥ec
->
mšex
 = 1;

446 
¥ec
->
mš
 = 
	`¡¹od
((*)mš->
±r
,&
•Œ
);

447 ià(
•Œ
[0] !ğ'\0' || 
	`i¢ª
(
¥ec
->
mš
)è 
C_ERR
;

450 ià(
max
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

451 
¥ec
->
max
 = ()max->
±r
;

453 ià(((*)
max
->
±r
)[0] == '(') {

454 
¥ec
->
max
 = 
	`¡¹od
((*)max->
±r
+1,&
•Œ
);

455 ià(
•Œ
[0] !ğ'\0' || 
	`i¢ª
(
¥ec
->
max
)è 
C_ERR
;

456 
¥ec
->
maxex
 = 1;

458 
¥ec
->
max
 = 
	`¡¹od
((*)max->
±r
,&
•Œ
);

459 ià(
•Œ
[0] !ğ'\0' || 
	`i¢ª
(
¥ec
->
max
)è 
C_ERR
;

463  
C_OK
;

464 
	}
}

481 
	$z¦P¬£LexRªgeI‹m
(
robj
 *
™em
,„obj **
de¡
, *
ex
) {

482 *
c
 = 
™em
->
±r
;

484 
c
[0]) {

486 ià(
c
[1] !ğ'\0'è 
C_ERR
;

487 *
ex
 = 0;

488 *
de¡
 = 
sh¬ed
.
max¡ršg
;

489 
	`šüRefCouÁ
(
sh¬ed
.
max¡ršg
);

490  
C_OK
;

492 ià(
c
[1] !ğ'\0'è 
C_ERR
;

493 *
ex
 = 0;

494 *
de¡
 = 
sh¬ed
.
mš¡ršg
;

495 
	`šüRefCouÁ
(
sh¬ed
.
mš¡ršg
);

496  
C_OK
;

498 *
ex
 = 1;

499 *
de¡
 = 
	`ü—‹SŒšgObjeù
(
c
+1,
	`sd¦’
(c)-1);

500  
C_OK
;

502 *
ex
 = 0;

503 *
de¡
 = 
	`ü—‹SŒšgObjeù
(
c
+1,
	`sd¦’
(c)-1);

504  
C_OK
;

506  
C_ERR
;

508 
	}
}

515 
	$z¦P¬£LexRªge
(
robj
 *
mš
,„obj *
max
, 
zËx¿nge¥ec
 *
¥ec
) {

518 ià(
mš
->
’codšg
 =ğ
OBJ_ENCODING_INT
 ||

519 
max
->
’codšg
 =ğ
OBJ_ENCODING_INT
è 
C_ERR
;

521 
¥ec
->
mš
 = s³c->
max
 = 
NULL
;

522 ià(
	`z¦P¬£LexRªgeI‹m
(
mš
, &
¥ec
->mš, &¥ec->
mšex
è=ğ
C_ERR
 ||

523 
	`z¦P¬£LexRªgeI‹m
(
max
, &
¥ec
->max, &¥ec->
maxex
è=ğ
C_ERR
) {

524 ià(
¥ec
->
mš
è
	`deüRefCouÁ
(spec->min);

525 ià(
¥ec
->
max
è
	`deüRefCouÁ
(spec->max);

526  
C_ERR
;

528  
C_OK
;

530 
	}
}

534 
	$z¦F»eLexRªge
(
zËx¿nge¥ec
 *
¥ec
) {

535 
	`deüRefCouÁ
(
¥ec
->
mš
);

536 
	`deüRefCouÁ
(
¥ec
->
max
);

537 
	}
}

542 
	$com·»SŒšgObjeùsFÜLexRªge
(
robj
 *
a
,„obj *
b
) {

543 ià(
a
 =ğ
b
)  0;

545 ià(
a
 =ğ
sh¬ed
.
mš¡ršg
 || 
b
 =ğsh¬ed.
max¡ršg
)  -1;

546 ià(
a
 =ğ
sh¬ed
.
max¡ršg
 || 
b
 =ğsh¬ed.
mš¡ršg
)  1;

547  
	`com·»SŒšgObjeùs
(
a
,
b
);

548 
	}
}

550 
	$z¦LexV®ueG‹Mš
(
robj
 *
v®ue
, 
zËx¿nge¥ec
 *
¥ec
) {

551  
¥ec
->
mšex
 ?

552 (
	`com·»SŒšgObjeùsFÜLexRªge
(
v®ue
,
¥ec
->
mš
) > 0) :

553 (
	`com·»SŒšgObjeùsFÜLexRªge
(
v®ue
,
¥ec
->
mš
) >= 0);

554 
	}
}

556 
	$z¦LexV®ueL‹Max
(
robj
 *
v®ue
, 
zËx¿nge¥ec
 *
¥ec
) {

557  
¥ec
->
maxex
 ?

558 (
	`com·»SŒšgObjeùsFÜLexRªge
(
v®ue
,
¥ec
->
max
) < 0) :

559 (
	`com·»SŒšgObjeùsFÜLexRªge
(
v®ue
,
¥ec
->
max
) <= 0);

560 
	}
}

563 
	$z¦IsInLexRªge
(
zskli¡
 *
z¦
, 
zËx¿nge¥ec
 *
¿nge
) {

564 
zskli¡Node
 *
x
;

567 ià(
	`com·»SŒšgObjeùsFÜLexRªge
(
¿nge
->
mš
,¿nge->
max
) > 1 ||

568 (
	`com·»SŒšgObjeùs
(
¿nge
->
mš
,¿nge->
max
) == 0 &&

569 (
¿nge
->
mšex
 ||„ªge->
maxex
)))

571 
x
 = 
z¦
->

;

572 ià(
x
 =ğ
NULL
 || !
	`z¦LexV®ueG‹Mš
(x->
obj
,
¿nge
))

574 
x
 = 
z¦
->
h—d”
->
Ëv–
[0].
fÜw¬d
;

575 ià(
x
 =ğ
NULL
 || !
	`z¦LexV®ueL‹Max
(x->
obj
,
¿nge
))

578 
	}
}

582 
zskli¡Node
 *
	$z¦Fœ¡InLexRªge
(
zskli¡
 *
z¦
, 
zËx¿nge¥ec
 *
¿nge
) {

583 
zskli¡Node
 *
x
;

584 
i
;

587 ià(!
	`z¦IsInLexRªge
(
z¦
,
¿nge
)è 
NULL
;

589 
x
 = 
z¦
->
h—d”
;

590 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

592 
x
->
Ëv–
[
i
].
fÜw¬d
 &&

593 !
	`z¦LexV®ueG‹Mš
(
x
->
Ëv–
[
i
].
fÜw¬d
->
obj
,
¿nge
))

594 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

598 
x
 = x->
Ëv–
[0].
fÜw¬d
;

599 
	`£rv”As£¹
(
x
 !ğ
NULL
);

602 ià(!
	`z¦LexV®ueL‹Max
(
x
->
obj
,
¿nge
)è 
NULL
;

603  
x
;

604 
	}
}

608 
zskli¡Node
 *
	$z¦La¡InLexRªge
(
zskli¡
 *
z¦
, 
zËx¿nge¥ec
 *
¿nge
) {

609 
zskli¡Node
 *
x
;

610 
i
;

613 ià(!
	`z¦IsInLexRªge
(
z¦
,
¿nge
)è 
NULL
;

615 
x
 = 
z¦
->
h—d”
;

616 
i
 = 
z¦
->
Ëv–
-1; i >= 0; i--) {

618 
x
->
Ëv–
[
i
].
fÜw¬d
 &&

619 
	`z¦LexV®ueL‹Max
(
x
->
Ëv–
[
i
].
fÜw¬d
->
obj
,
¿nge
))

620 
x
 = x->
Ëv–
[
i
].
fÜw¬d
;

624 
	`£rv”As£¹
(
x
 !ğ
NULL
);

627 ià(!
	`z¦LexV®ueG‹Mš
(
x
->
obj
,
¿nge
)è 
NULL
;

628  
x
;

629 
	}
}

635 
	$zzlG‘ScÜe
(*
¥Œ
) {

636 *
v¡r
;

637 
vËn
;

638 
vlÚg
;

639 
buf
[128];

640 
scÜe
;

642 
	`£rv”As£¹
(
¥Œ
 !ğ
NULL
);

643 
	`£rv”As£¹
(
	`zli¡G‘
(
¥Œ
,&
v¡r
,&
vËn
,&
vlÚg
));

645 ià(
v¡r
) {

646 
	`memıy
(
buf
,
v¡r
,
vËn
);

647 
buf
[
vËn
] = '\0';

648 
scÜe
 = 
	`¡¹od
(
buf
,
NULL
);

650 
scÜe
 = 
vlÚg
;

653  
scÜe
;

654 
	}
}

659 
robj
 *
	$zli¡G‘Objeù
(*
¥Œ
) {

660 *
v¡r
;

661 
vËn
;

662 
vlÚg
;

664 
	`£rv”As£¹
(
¥Œ
 !ğ
NULL
);

665 
	`£rv”As£¹
(
	`zli¡G‘
(
¥Œ
,&
v¡r
,&
vËn
,&
vlÚg
));

667 ià(
v¡r
) {

668  
	`ü—‹SŒšgObjeù
((*)
v¡r
,
vËn
);

670  
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
vlÚg
);

672 
	}
}

675 
	$zzlCom·»EËm’ts
(*
•Œ
, *
c¡r
, 
ş’
) {

676 *
v¡r
;

677 
vËn
;

678 
vlÚg
;

679 
vbuf
[32];

680 
mšËn
, 
cmp
;

682 
	`£rv”As£¹
(
	`zli¡G‘
(
•Œ
,&
v¡r
,&
vËn
,&
vlÚg
));

683 ià(
v¡r
 =ğ
NULL
) {

685 
vËn
 = 
	`Î2¡ršg
((*)
vbuf
,(vbuf),
vlÚg
);

686 
v¡r
 = 
vbuf
;

689 
mšËn
 = (
vËn
 < 
ş’
) ? vlen : clen;

690 
cmp
 = 
	`memcmp
(
v¡r
,
c¡r
,
mšËn
);

691 ià(
cmp
 =ğ0è 
vËn
-
ş’
;

692  
cmp
;

693 
	}
}

695 
	$zzlL’gth
(*
zl
) {

696  
	`zli¡L’
(
zl
)/2;

697 
	}
}

701 
	$zzlNext
(*
zl
, **
•Œ
, **
¥Œ
) {

702 *
_•Œ
, *
_¥Œ
;

703 
	`£rv”As£¹
(*
•Œ
 !ğ
NULL
 && *
¥Œ
 != NULL);

705 
_•Œ
 = 
	`zli¡Next
(
zl
,*
¥Œ
);

706 ià(
_•Œ
 !ğ
NULL
) {

707 
_¥Œ
 = 
	`zli¡Next
(
zl
,
_•Œ
);

708 
	`£rv”As£¹
(
_¥Œ
 !ğ
NULL
);

711 
_¥Œ
 = 
NULL
;

714 *
•Œ
 = 
_•Œ
;

715 *
¥Œ
 = 
_¥Œ
;

716 
	}
}

720 
	$zzlP»v
(*
zl
, **
•Œ
, **
¥Œ
) {

721 *
_•Œ
, *
_¥Œ
;

722 
	`£rv”As£¹
(*
•Œ
 !ğ
NULL
 && *
¥Œ
 != NULL);

724 
_¥Œ
 = 
	`zli¡P»v
(
zl
,*
•Œ
);

725 ià(
_¥Œ
 !ğ
NULL
) {

726 
_•Œ
 = 
	`zli¡P»v
(
zl
,
_¥Œ
);

727 
	`£rv”As£¹
(
_•Œ
 !ğ
NULL
);

730 
_•Œ
 = 
NULL
;

733 *
•Œ
 = 
_•Œ
;

734 *
¥Œ
 = 
_¥Œ
;

735 
	}
}

739 
	$zzlIsInRªge
(*
zl
, 
z¿nge¥ec
 *
¿nge
) {

740 *
p
;

741 
scÜe
;

744 ià(
¿nge
->
mš
 >„ªge->
max
 ||

745 (
¿nge
->
mš
 =ğ¿nge->
max
 && (¿nge->
mšex
 ||„ªge->
maxex
)))

748 
p
 = 
	`zli¡Index
(
zl
,-1);

749 ià(
p
 =ğ
NULL
)  0;

750 
scÜe
 = 
	`zzlG‘ScÜe
(
p
);

751 ià(!
	`z¦V®ueG‹Mš
(
scÜe
,
¿nge
))

754 
p
 = 
	`zli¡Index
(
zl
,1);

755 
	`£rv”As£¹
(
p
 !ğ
NULL
);

756 
scÜe
 = 
	`zzlG‘ScÜe
(
p
);

757 ià(!
	`z¦V®ueL‹Max
(
scÜe
,
¿nge
))

761 
	}
}

765 *
	$zzlFœ¡InRªge
(*
zl
, 
z¿nge¥ec
 *
¿nge
) {

766 *
•Œ
 = 
	`zli¡Index
(
zl
,0), *
¥Œ
;

767 
scÜe
;

770 ià(!
	`zzlIsInRªge
(
zl
,
¿nge
)è 
NULL
;

772 
•Œ
 !ğ
NULL
) {

773 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

774 
	`£rv”As£¹
(
¥Œ
 !ğ
NULL
);

776 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

777 ià(
	`z¦V®ueG‹Mš
(
scÜe
,
¿nge
)) {

779 ià(
	`z¦V®ueL‹Max
(
scÜe
,
¿nge
))

780  
•Œ
;

781  
NULL
;

785 
•Œ
 = 
	`zli¡Next
(
zl
,
¥Œ
);

788  
NULL
;

789 
	}
}

793 *
	$zzlLa¡InRªge
(*
zl
, 
z¿nge¥ec
 *
¿nge
) {

794 *
•Œ
 = 
	`zli¡Index
(
zl
,-2), *
¥Œ
;

795 
scÜe
;

798 ià(!
	`zzlIsInRªge
(
zl
,
¿nge
)è 
NULL
;

800 
•Œ
 !ğ
NULL
) {

801 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

802 
	`£rv”As£¹
(
¥Œ
 !ğ
NULL
);

804 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

805 ià(
	`z¦V®ueL‹Max
(
scÜe
,
¿nge
)) {

807 ià(
	`z¦V®ueG‹Mš
(
scÜe
,
¿nge
))

808  
•Œ
;

809  
NULL
;

814 
¥Œ
 = 
	`zli¡P»v
(
zl
,
•Œ
);

815 ià(
¥Œ
 !ğ
NULL
)

816 
	`£rv”As£¹
((
•Œ
 = 
	`zli¡P»v
(
zl
,
¥Œ
)è!ğ
NULL
);

818 
•Œ
 = 
NULL
;

821  
NULL
;

822 
	}
}

824 
	$zzlLexV®ueG‹Mš
(*
p
, 
zËx¿nge¥ec
 *
¥ec
) {

825 
robj
 *
v®ue
 = 
	`zli¡G‘Objeù
(
p
);

826 
»s
 = 
	`z¦LexV®ueG‹Mš
(
v®ue
,
¥ec
);

827 
	`deüRefCouÁ
(
v®ue
);

828  
»s
;

829 
	}
}

831 
	$zzlLexV®ueL‹Max
(*
p
, 
zËx¿nge¥ec
 *
¥ec
) {

832 
robj
 *
v®ue
 = 
	`zli¡G‘Objeù
(
p
);

833 
»s
 = 
	`z¦LexV®ueL‹Max
(
v®ue
,
¥ec
);

834 
	`deüRefCouÁ
(
v®ue
);

835  
»s
;

836 
	}
}

840 
	$zzlIsInLexRªge
(*
zl
, 
zËx¿nge¥ec
 *
¿nge
) {

841 *
p
;

844 ià(
	`com·»SŒšgObjeùsFÜLexRªge
(
¿nge
->
mš
,¿nge->
max
) > 1 ||

845 (
	`com·»SŒšgObjeùs
(
¿nge
->
mš
,¿nge->
max
) == 0 &&

846 (
¿nge
->
mšex
 ||„ªge->
maxex
)))

849 
p
 = 
	`zli¡Index
(
zl
,-2);

850 ià(
p
 =ğ
NULL
)  0;

851 ià(!
	`zzlLexV®ueG‹Mš
(
p
,
¿nge
))

854 
p
 = 
	`zli¡Index
(
zl
,0);

855 
	`£rv”As£¹
(
p
 !ğ
NULL
);

856 ià(!
	`zzlLexV®ueL‹Max
(
p
,
¿nge
))

860 
	}
}

864 *
	$zzlFœ¡InLexRªge
(*
zl
, 
zËx¿nge¥ec
 *
¿nge
) {

865 *
•Œ
 = 
	`zli¡Index
(
zl
,0), *
¥Œ
;

868 ià(!
	`zzlIsInLexRªge
(
zl
,
¿nge
)è 
NULL
;

870 
•Œ
 !ğ
NULL
) {

871 ià(
	`zzlLexV®ueG‹Mš
(
•Œ
,
¿nge
)) {

873 ià(
	`zzlLexV®ueL‹Max
(
•Œ
,
¿nge
))

874  
•Œ
;

875  
NULL
;

879 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

880 
	`£rv”As£¹
(
¥Œ
 !ğ
NULL
);

881 
•Œ
 = 
	`zli¡Next
(
zl
,
¥Œ
);

884  
NULL
;

885 
	}
}

889 *
	$zzlLa¡InLexRªge
(*
zl
, 
zËx¿nge¥ec
 *
¿nge
) {

890 *
•Œ
 = 
	`zli¡Index
(
zl
,-2), *
¥Œ
;

893 ià(!
	`zzlIsInLexRªge
(
zl
,
¿nge
)è 
NULL
;

895 
•Œ
 !ğ
NULL
) {

896 ià(
	`zzlLexV®ueL‹Max
(
•Œ
,
¿nge
)) {

898 ià(
	`zzlLexV®ueG‹Mš
(
•Œ
,
¿nge
))

899  
•Œ
;

900  
NULL
;

905 
¥Œ
 = 
	`zli¡P»v
(
zl
,
•Œ
);

906 ià(
¥Œ
 !ğ
NULL
)

907 
	`£rv”As£¹
((
•Œ
 = 
	`zli¡P»v
(
zl
,
¥Œ
)è!ğ
NULL
);

909 
•Œ
 = 
NULL
;

912  
NULL
;

913 
	}
}

915 *
	$zzlFšd
(*
zl
, 
robj
 *
–e
, *
scÜe
) {

916 *
•Œ
 = 
	`zli¡Index
(
zl
,0), *
¥Œ
;

918 
–e
 = 
	`g‘DecodedObjeù
(ele);

919 
•Œ
 !ğ
NULL
) {

920 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

921 
	`£rv”As£¹W™hInfo
(
NULL
,
–e
,
¥Œ
 != NULL);

923 ià(
	`zli¡Com·»
(
•Œ
,
–e
->
±r
,
	`sd¦’
(ele->ptr))) {

925 ià(
scÜe
 !ğ
NULL
è*scÜğ
	`zzlG‘ScÜe
(
¥Œ
);

926 
	`deüRefCouÁ
(
–e
);

927  
•Œ
;

931 
•Œ
 = 
	`zli¡Next
(
zl
,
¥Œ
);

934 
	`deüRefCouÁ
(
–e
);

935  
NULL
;

936 
	}
}

940 *
	$zzlD–‘e
(*
zl
, *
•Œ
) {

941 *
p
 = 
•Œ
;

944 
zl
 = 
	`zli¡D–‘e
(zl,&
p
);

945 
zl
 = 
	`zli¡D–‘e
(zl,&
p
);

946  
zl
;

947 
	}
}

949 *
	$zzlIn£¹At
(*
zl
, *
•Œ
, 
robj
 *
–e
, 
scÜe
) {

950 *
¥Œ
;

951 
scÜebuf
[128];

952 
scÜ–’
;

953 
size_t
 
off£t
;

955 
	`£rv”As£¹W™hInfo
(
NULL
,
–e
,
	`sdsEncodedObjeù
(ele));

956 
scÜ–’
 = 
	`d2¡ršg
(
scÜebuf
,(scÜebuf),
scÜe
);

957 ià(
•Œ
 =ğ
NULL
) {

958 
zl
 = 
	`zli¡Push
(zl,
–e
->
±r
,
	`sd¦’
ÓË->±r),
ZIPLIST_TAIL
);

959 
zl
 = 
	`zli¡Push
(zl,(*)
scÜebuf
,
scÜ–’
,
ZIPLIST_TAIL
);

962 
off£t
 = 
•Œ
-
zl
;

963 
zl
 = 
	`zli¡In£¹
(zl,
•Œ
,
–e
->
±r
,
	`sd¦’
(ele->ptr));

964 
•Œ
 = 
zl
+
off£t
;

967 
	`£rv”As£¹W™hInfo
(
NULL
,
–e
,(
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
)) != NULL);

968 
zl
 = 
	`zli¡In£¹
(zl,
¥Œ
,(*)
scÜebuf
,
scÜ–’
);

971  
zl
;

972 
	}
}

976 *
	$zzlIn£¹
(*
zl
, 
robj
 *
–e
, 
scÜe
) {

977 *
•Œ
 = 
	`zli¡Index
(
zl
,0), *
¥Œ
;

978 
s
;

980 
–e
 = 
	`g‘DecodedObjeù
(ele);

981 
•Œ
 !ğ
NULL
) {

982 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

983 
	`£rv”As£¹W™hInfo
(
NULL
,
–e
,
¥Œ
 != NULL);

984 
s
 = 
	`zzlG‘ScÜe
(
¥Œ
);

986 ià(
s
 > 
scÜe
) {

990 
zl
 = 
	`zzlIn£¹At
(zl,
•Œ
,
–e
,
scÜe
);

992 } ià(
s
 =ğ
scÜe
) {

994 ià(
	`zzlCom·»EËm’ts
(
•Œ
,
–e
->
±r
,
	`sd¦’
(ele->ptr)) > 0) {

995 
zl
 = 
	`zzlIn£¹At
(zl,
•Œ
,
–e
,
scÜe
);

1001 
•Œ
 = 
	`zli¡Next
(
zl
,
¥Œ
);

1005 ià(
•Œ
 =ğ
NULL
)

1006 
zl
 = 
	`zzlIn£¹At
(zl,
NULL
,
–e
,
scÜe
);

1008 
	`deüRefCouÁ
(
–e
);

1009  
zl
;

1010 
	}
}

1012 *
	$zzlD–‘eRªgeByScÜe
(*
zl
, 
z¿nge¥ec
 *
¿nge
, *
d–‘ed
) {

1013 *
•Œ
, *
¥Œ
;

1014 
scÜe
;

1015 
num
 = 0;

1017 ià(
d–‘ed
 !ğ
NULL
) *deleted = 0;

1019 
•Œ
 = 
	`zzlFœ¡InRªge
(
zl
,
¿nge
);

1020 ià(
•Œ
 =ğ
NULL
è 
zl
;

1024 (
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
)è!ğ
NULL
) {

1025 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

1026 ià(
	`z¦V®ueL‹Max
(
scÜe
,
¿nge
)) {

1028 
zl
 = 
	`zli¡D–‘e
(zl,&
•Œ
);

1029 
zl
 = 
	`zli¡D–‘e
(zl,&
•Œ
);

1030 
num
++;

1037 ià(
d–‘ed
 !ğ
NULL
è*d–‘ed = 
num
;

1038  
zl
;

1039 
	}
}

1041 *
	$zzlD–‘eRªgeByLex
(*
zl
, 
zËx¿nge¥ec
 *
¿nge
, *
d–‘ed
) {

1042 *
•Œ
, *
¥Œ
;

1043 
num
 = 0;

1045 ià(
d–‘ed
 !ğ
NULL
) *deleted = 0;

1047 
•Œ
 = 
	`zzlFœ¡InLexRªge
(
zl
,
¿nge
);

1048 ià(
•Œ
 =ğ
NULL
è 
zl
;

1052 (
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
)è!ğ
NULL
) {

1053 ià(
	`zzlLexV®ueL‹Max
(
•Œ
,
¿nge
)) {

1055 
zl
 = 
	`zli¡D–‘e
(zl,&
•Œ
);

1056 
zl
 = 
	`zli¡D–‘e
(zl,&
•Œ
);

1057 
num
++;

1064 ià(
d–‘ed
 !ğ
NULL
è*d–‘ed = 
num
;

1065  
zl
;

1066 
	}
}

1070 *
	$zzlD–‘eRªgeByRªk
(*
zl
, 
¡¬t
, 
’d
, *
d–‘ed
) {

1071 
num
 = (
’d
-
¡¬t
)+1;

1072 ià(
d–‘ed
è*d–‘ed = 
num
;

1073 
zl
 = 
	`zli¡D–‘eRªge
(zl,2*(
¡¬t
-1),2*
num
);

1074  
zl
;

1075 
	}
}

1081 
	$z£tL’gth
(
robj
 *
zobj
) {

1082 
Ëngth
 = -1;

1083 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1084 
Ëngth
 = 
	`zzlL’gth
(
zobj
->
±r
);

1085 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1086 
Ëngth
 = ((
z£t
*)
zobj
->
±r
)->
z¦
->length;

1088 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1090  
Ëngth
;

1091 
	}
}

1093 
	$z£tCÚv”t
(
robj
 *
zobj
, 
’codšg
) {

1094 
z£t
 *
zs
;

1095 
zskli¡Node
 *
node
, *
Ãxt
;

1096 
robj
 *
–e
;

1097 
scÜe
;

1099 ià(
zobj
->
’codšg
 ==ƒncoding) ;

1100 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1101 *
zl
 = 
zobj
->
±r
;

1102 *
•Œ
, *
¥Œ
;

1103 *
v¡r
;

1104 
vËn
;

1105 
vlÚg
;

1107 ià(
’codšg
 !ğ
OBJ_ENCODING_SKIPLIST
)

1108 
	`£rv”Pªic
("Unknownargetƒncoding");

1110 
zs
 = 
	`zm®loc
((*zs));

1111 
zs
->
diù
 = 
	`diùC»©e
(&
z£tDiùTy³
,
NULL
);

1112 
zs
->
z¦
 = 
	`z¦C»©e
();

1114 
•Œ
 = 
	`zli¡Index
(
zl
,0);

1115 
	`£rv”As£¹W™hInfo
(
NULL
,
zobj
,
•Œ
 != NULL);

1116 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

1117 
	`£rv”As£¹W™hInfo
(
NULL
,
zobj
,
¥Œ
 != NULL);

1119 
•Œ
 !ğ
NULL
) {

1120 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

1121 
	`£rv”As£¹W™hInfo
(
NULL
,
zobj
,
	`zli¡G‘
(
•Œ
,&
v¡r
,&
vËn
,&
vlÚg
));

1122 ià(
v¡r
 =ğ
NULL
)

1123 
–e
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(
vlÚg
);

1125 
–e
 = 
	`ü—‹SŒšgObjeù
((*)
v¡r
,
vËn
);

1128 
node
 = 
	`z¦In£¹
(
zs
->
z¦
,
scÜe
,
–e
);

1129 
	`£rv”As£¹W™hInfo
(
NULL
,
zobj
,
	`diùAdd
(
zs
->
diù
,
–e
,&
node
->
scÜe
è=ğ
DICT_OK
);

1130 
	`šüRefCouÁ
(
–e
);

1131 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

1134 
	`zä“
(
zobj
->
±r
);

1135 
zobj
->
±r
 = 
zs
;

1136 
zobj
->
’codšg
 = 
OBJ_ENCODING_SKIPLIST
;

1137 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1138 *
zl
 = 
	`zli¡New
();

1140 ià(
’codšg
 !ğ
OBJ_ENCODING_ZIPLIST
)

1141 
	`£rv”Pªic
("Unknownargetƒncoding");

1145 
zs
 = 
zobj
->
±r
;

1146 
	`diùR–—£
(
zs
->
diù
);

1147 
node
 = 
zs
->
z¦
->
h—d”
->
Ëv–
[0].
fÜw¬d
;

1148 
	`zä“
(
zs
->
z¦
->
h—d”
);

1149 
	`zä“
(
zs
->
z¦
);

1151 
node
) {

1152 
–e
 = 
	`g‘DecodedObjeù
(
node
->
obj
);

1153 
zl
 = 
	`zzlIn£¹At
(zl,
NULL
,
–e
,
node
->
scÜe
);

1154 
	`deüRefCouÁ
(
–e
);

1156 
Ãxt
 = 
node
->
Ëv–
[0].
fÜw¬d
;

1157 
	`z¦F»eNode
(
node
);

1158 
node
 = 
Ãxt
;

1161 
	`zä“
(
zs
);

1162 
zobj
->
±r
 = 
zl
;

1163 
zobj
->
’codšg
 = 
OBJ_ENCODING_ZIPLIST
;

1165 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1167 
	}
}

1172 
	$z£tCÚv”tToZli¡IfN“ded
(
robj
 *
zobj
, 
size_t
 
max––’
) {

1173 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) ;

1174 
z£t
 *z£ˆğ
zobj
->
±r
;

1176 ià(
z£t
->
z¦
->
Ëngth
 <ğ
£rv”
.
z£t_max_zli¡_’Œ›s
 &&

1177 
max––’
 <ğ
£rv”
.
z£t_max_zli¡_v®ue
)

1178 
	`z£tCÚv”t
(
zobj
,
OBJ_ENCODING_ZIPLIST
);

1179 
	}
}

1185 
	$z£tScÜe
(
robj
 *
zobj
,„obj *
memb”
, *
scÜe
) {

1186 ià(!
zobj
 || !
memb”
è 
C_ERR
;

1188 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1189 ià(
	`zzlFšd
(
zobj
->
±r
, 
memb”
, 
scÜe
è=ğ
NULL
è 
C_ERR
;

1190 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1191 
z£t
 *
zs
 = 
zobj
->
±r
;

1192 
diùEÁry
 *
de
 = 
	`diùFšd
(
zs
->
diù
, 
memb”
);

1193 ià(
de
 =ğ
NULL
è 
C_ERR
;

1194 *
scÜe
 = *(*)
	`diùG‘V®
(
de
);

1196 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1198  
C_OK
;

1199 
	}
}

1206 
	#ZADD_NONE
 0

	)

1207 
	#ZADD_INCR
 (1<<0è

	)

1208 
	#ZADD_NX
 (1<<1è

	)

1209 
	#ZADD_XX
 (1<<2è

	)

1210 
	#ZADD_CH
 (1<<3è

	)

1211 
	$zaddG’”icCommªd
(
ş›Á
 *
c
, 
æags
) {

1212 *
ÇÃ¼
 = "resulting score is‚ot‡‚umber (NaN)";

1213 
robj
 *
key
 = 
c
->
¬gv
[1];

1214 
robj
 *
–e
;

1215 
robj
 *
zobj
;

1216 
robj
 *
curobj
;

1217 
scÜe
 = 0, *
scÜes
 = 
NULL
, 
curscÜe
 = 0.0;

1218 
j
, 
–em’ts
;

1219 
scÜeidx
 = 0;

1223 
added
 = 0;

1224 
upd©ed
 = 0;

1225 
´oûs£d
 = 0;

1230 
scÜeidx
 = 2;

1231 
scÜeidx
 < 
c
->
¬gc
) {

1232 *
İt
 = 
c
->
¬gv
[
scÜeidx
]->
±r
;

1233 ià(!
	`¡rÿ£cmp
(
İt
,"nx")è
æags
 |ğ
ZADD_NX
;

1234 ià(!
	`¡rÿ£cmp
(
İt
,"xx")è
æags
 |ğ
ZADD_XX
;

1235 ià(!
	`¡rÿ£cmp
(
İt
,"ch")è
æags
 |ğ
ZADD_CH
;

1236 ià(!
	`¡rÿ£cmp
(
İt
,"šü")è
æags
 |ğ
ZADD_INCR
;

1238 
scÜeidx
++;

1242 
šü
 = (
æags
 & 
ZADD_INCR
) != 0;

1243 
nx
 = (
æags
 & 
ZADD_NX
) != 0;

1244 
xx
 = (
æags
 & 
ZADD_XX
) != 0;

1245 
ch
 = (
æags
 & 
ZADD_CH
) != 0;

1249 
–em’ts
 = 
c
->
¬gc
-
scÜeidx
;

1250 ià(
–em’ts
 % 2 || !elements) {

1251 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

1254 
–em’ts
 /= 2;

1257 ià(
nx
 && 
xx
) {

1258 
	`addR•lyE¼Ü
(
c
,

1263 ià(
šü
 && 
–em’ts
 > 1) {

1264 
	`addR•lyE¼Ü
(
c
,

1272 
scÜes
 = 
	`zm®loc
(()*
–em’ts
);

1273 
j
 = 0; j < 
–em’ts
; j++) {

1274 ià(
	`g‘DoubËFromObjeùOrR•ly
(
c
,c->
¬gv
[
scÜeidx
+
j
*2],&
scÜes
[j],
NULL
)

1275 !ğ
C_OK
è
ş—nup
;

1279 
zobj
 = 
	`lookupKeyWr™e
(
c
->
db
,
key
);

1280 ià(
zobj
 =ğ
NULL
) {

1281 ià(
xx
è
»¶y_to_ş›Á
;

1282 ià(
£rv”
.
z£t_max_zli¡_’Œ›s
 == 0 ||

1283 
£rv”
.
z£t_max_zli¡_v®ue
 < 
	`sd¦’
(
c
->
¬gv
[
scÜeidx
+1]->
±r
))

1285 
zobj
 = 
	`ü—‹Z£tObjeù
();

1287 
zobj
 = 
	`ü—‹Z£tZli¡Objeù
();

1289 
	`dbAdd
(
c
->
db
,
key
,
zobj
);

1291 ià(
zobj
->
ty³
 !ğ
OBJ_ZSET
) {

1292 
	`addR•ly
(
c
,
sh¬ed
.
wrÚgty³”r
);

1293 
ş—nup
;

1297 
j
 = 0; j < 
–em’ts
; j++) {

1298 
scÜe
 = 
scÜes
[
j
];

1300 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1301 *
•Œ
;

1304 
–e
 = 
c
->
¬gv
[
scÜeidx
+1+
j
*2];

1305 ià((
•Œ
 = 
	`zzlFšd
(
zobj
->
±r
,
–e
,&
curscÜe
)è!ğ
NULL
) {

1306 ià(
nx
) ;

1307 ià(
šü
) {

1308 
scÜe
 +ğ
curscÜe
;

1309 ià(
	`i¢ª
(
scÜe
)) {

1310 
	`addR•lyE¼Ü
(
c
,
ÇÃ¼
);

1311 
ş—nup
;

1316 ià(
scÜe
 !ğ
curscÜe
) {

1317 
zobj
->
±r
 = 
	`zzlD–‘e
(zobj->±r,
•Œ
);

1318 
zobj
->
±r
 = 
	`zzlIn£¹
(zobj->±r,
–e
,
scÜe
);

1319 
£rv”
.
dœty
++;

1320 
upd©ed
++;

1322 
´oûs£d
++;

1323 } ià(!
xx
) {

1326 
zobj
->
±r
 = 
	`zzlIn£¹
(zobj->±r,
–e
,
scÜe
);

1327 ià(
	`zzlL’gth
(
zobj
->
±r
è> 
£rv”
.
z£t_max_zli¡_’Œ›s
)

1328 
	`z£tCÚv”t
(
zobj
,
OBJ_ENCODING_SKIPLIST
);

1329 ià(
	`sd¦’
(
–e
->
±r
è> 
£rv”
.
z£t_max_zli¡_v®ue
)

1330 
	`z£tCÚv”t
(
zobj
,
OBJ_ENCODING_SKIPLIST
);

1331 
£rv”
.
dœty
++;

1332 
added
++;

1333 
´oûs£d
++;

1335 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1336 
z£t
 *
zs
 = 
zobj
->
±r
;

1337 
zskli¡Node
 *
znode
;

1338 
diùEÁry
 *
de
;

1340 
–e
 = 
c
->
¬gv
[
scÜeidx
+1+
j
*2] =

1341 
	`ŒyObjeùEncodšg
(
c
->
¬gv
[
scÜeidx
+1+
j
*2]);

1342 
de
 = 
	`diùFšd
(
zs
->
diù
,
–e
);

1343 ià(
de
 !ğ
NULL
) {

1344 ià(
nx
) ;

1345 
curobj
 = 
	`diùG‘Key
(
de
);

1346 
curscÜe
 = *(*)
	`diùG‘V®
(
de
);

1348 ià(
šü
) {

1349 
scÜe
 +ğ
curscÜe
;

1350 ià(
	`i¢ª
(
scÜe
)) {

1351 
	`addR•lyE¼Ü
(
c
,
ÇÃ¼
);

1354 
ş—nup
;

1361 ià(
scÜe
 !ğ
curscÜe
) {

1362 
	`£rv”As£¹W™hInfo
(
c
,
curobj
,
	`z¦D–‘e
(
zs
->
z¦
,
curscÜe
,curobj));

1363 
znode
 = 
	`z¦In£¹
(
zs
->
z¦
,
scÜe
,
curobj
);

1364 
	`šüRefCouÁ
(
curobj
);

1365 
	`diùG‘V®
(
de
èğ&
znode
->
scÜe
;

1366 
£rv”
.
dœty
++;

1367 
upd©ed
++;

1369 
´oûs£d
++;

1370 } ià(!
xx
) {

1371 
znode
 = 
	`z¦In£¹
(
zs
->
z¦
,
scÜe
,
–e
);

1372 
	`šüRefCouÁ
(
–e
);

1373 
	`£rv”As£¹W™hInfo
(
c
,
NULL
,
	`diùAdd
(
zs
->
diù
,
–e
,&
znode
->
scÜe
è=ğ
DICT_OK
);

1374 
	`šüRefCouÁ
(
–e
);

1375 
£rv”
.
dœty
++;

1376 
added
++;

1377 
´oûs£d
++;

1380 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1384 
»¶y_to_ş›Á
:

1385 ià(
šü
) {

1386 ià(
´oûs£d
)

1387 
	`addR•lyDoubË
(
c
,
scÜe
);

1389 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

1391 
	`addR•lyLÚgLÚg
(
c
,
ch
 ? 
added
+
upd©ed
 :‡dded);

1394 
ş—nup
:

1395 
	`zä“
(
scÜes
);

1396 ià(
added
 || 
upd©ed
) {

1397 
	`sigÇlModif›dKey
(
c
->
db
,
key
);

1398 
	`nÙifyKey¥aûEv’t
(
NOTIFY_ZSET
,

1399 
šü
 ? "zšü" : "zadd", 
key
, 
c
->
db
->
id
);

1401 
	}
}

1403 
	$zaddCommªd
(
ş›Á
 *
c
) {

1404 
	`zaddG’”icCommªd
(
c
,
ZADD_NONE
);

1405 
	}
}

1407 
	$zšübyCommªd
(
ş›Á
 *
c
) {

1408 
	`zaddG’”icCommªd
(
c
,
ZADD_INCR
);

1409 
	}
}

1411 
	$z»mCommªd
(
ş›Á
 *
c
) {

1412 
robj
 *
key
 = 
c
->
¬gv
[1];

1413 
robj
 *
zobj
;

1414 
d–‘ed
 = 0, 
key»moved
 = 0, 
j
;

1416 ià((
zobj
 = 
	`lookupKeyWr™eOrR•ly
(
c
,
key
,
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

1417 
	`checkTy³
(
c
,
zobj
,
OBJ_ZSET
)) ;

1419 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1420 *
•Œ
;

1422 
j
 = 2; j < 
c
->
¬gc
; j++) {

1423 ià((
•Œ
 = 
	`zzlFšd
(
zobj
->
±r
,
c
->
¬gv
[
j
],
NULL
)) != NULL) {

1424 
d–‘ed
++;

1425 
zobj
->
±r
 = 
	`zzlD–‘e
(zobj->±r,
•Œ
);

1426 ià(
	`zzlL’gth
(
zobj
->
±r
) == 0) {

1427 
	`dbD–‘e
(
c
->
db
,
key
);

1428 
key»moved
 = 1;

1433 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1434 
z£t
 *
zs
 = 
zobj
->
±r
;

1435 
diùEÁry
 *
de
;

1436 
scÜe
;

1438 
j
 = 2; j < 
c
->
¬gc
; j++) {

1439 
de
 = 
	`diùFšd
(
zs
->
diù
,
c
->
¬gv
[
j
]);

1440 ià(
de
 !ğ
NULL
) {

1441 
d–‘ed
++;

1444 
scÜe
 = *(*)
	`diùG‘V®
(
de
);

1445 
	`£rv”As£¹W™hInfo
(
c
,c->
¬gv
[
j
],
	`z¦D–‘e
(
zs
->
z¦
,
scÜe
,c->argv[j]));

1448 
	`diùD–‘e
(
zs
->
diù
,
c
->
¬gv
[
j
]);

1449 ià(
	`htN“dsResize
(
zs
->
diù
)è
	`diùResize
(zs->dict);

1450 ià(
	`diùSize
(
zs
->
diù
) == 0) {

1451 
	`dbD–‘e
(
c
->
db
,
key
);

1452 
key»moved
 = 1;

1458 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1461 ià(
d–‘ed
) {

1462 
	`nÙifyKey¥aûEv’t
(
NOTIFY_ZSET
,"z»m",
key
,
c
->
db
->
id
);

1463 ià(
key»moved
)

1464 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
key
,
c
->
db
->
id
);

1465 
	`sigÇlModif›dKey
(
c
->
db
,
key
);

1466 
£rv”
.
dœty
 +ğ
d–‘ed
;

1468 
	`addR•lyLÚgLÚg
(
c
,
d–‘ed
);

1469 
	}
}

1472 
	#ZRANGE_RANK
 0

	)

1473 
	#ZRANGE_SCORE
 1

	)

1474 
	#ZRANGE_LEX
 2

	)

1475 
	$z»m¿ngeG’”icCommªd
(
ş›Á
 *
c
, 
¿ng‘y³
) {

1476 
robj
 *
key
 = 
c
->
¬gv
[1];

1477 
robj
 *
zobj
;

1478 
key»moved
 = 0;

1479 
d–‘ed
 = 0;

1480 
z¿nge¥ec
 
¿nge
;

1481 
zËx¿nge¥ec
 
Ëx¿nge
;

1482 
¡¬t
, 
’d
, 
Î’
;

1485 ià(
¿ng‘y³
 =ğ
ZRANGE_RANK
) {

1486 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[2],&
¡¬t
,
NULL
è!ğ
C_OK
) ||

1487 (
	`g‘LÚgFromObjeùOrR•ly
(
c
,c->
¬gv
[3],&
’d
,
NULL
è!ğ
C_OK
))

1489 } ià(
¿ng‘y³
 =ğ
ZRANGE_SCORE
) {

1490 ià(
	`z¦P¬£Rªge
(
c
->
¬gv
[2],c->¬gv[3],&
¿nge
è!ğ
C_OK
) {

1491 
	`addR•lyE¼Ü
(
c
,"min or max is‚ot‡ float");

1494 } ià(
¿ng‘y³
 =ğ
ZRANGE_LEX
) {

1495 ià(
	`z¦P¬£LexRªge
(
c
->
¬gv
[2],c->¬gv[3],&
Ëx¿nge
è!ğ
C_OK
) {

1496 
	`addR•lyE¼Ü
(
c
,"min or max‚ot valid string„ange item");

1502 ià((
zobj
 = 
	`lookupKeyWr™eOrR•ly
(
c
,
key
,
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

1503 
	`checkTy³
(
c
,
zobj
,
OBJ_ZSET
)è
ş—nup
;

1505 ià(
¿ng‘y³
 =ğ
ZRANGE_RANK
) {

1507 
Î’
 = 
	`z£tL’gth
(
zobj
);

1508 ià(
¡¬t
 < 0è¡¬ˆğ
Î’
+start;

1509 ià(
’d
 < 0è’d = 
Î’
+end;

1510 ià(
¡¬t
 < 0) start = 0;

1514 ià(
¡¬t
 > 
’d
 || s¹ >ğ
Î’
) {

1515 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

1516 
ş—nup
;

1518 ià(
’d
 >ğ
Î’
)ƒnd =†len-1;

1522 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1523 
¿ng‘y³
) {

1524 
ZRANGE_RANK
:

1525 
zobj
->
±r
 = 
	`zzlD–‘eRªgeByRªk
(zobj->±r,
¡¬t
+1,
’d
+1,&
d–‘ed
);

1527 
ZRANGE_SCORE
:

1528 
zobj
->
±r
 = 
	`zzlD–‘eRªgeByScÜe
(zobj->±r,&
¿nge
,&
d–‘ed
);

1530 
ZRANGE_LEX
:

1531 
zobj
->
±r
 = 
	`zzlD–‘eRªgeByLex
(zobj->±r,&
Ëx¿nge
,&
d–‘ed
);

1534 ià(
	`zzlL’gth
(
zobj
->
±r
) == 0) {

1535 
	`dbD–‘e
(
c
->
db
,
key
);

1536 
key»moved
 = 1;

1538 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1539 
z£t
 *
zs
 = 
zobj
->
±r
;

1540 
¿ng‘y³
) {

1541 
ZRANGE_RANK
:

1542 
d–‘ed
 = 
	`z¦D–‘eRªgeByRªk
(
zs
->
z¦
,
¡¬t
+1,
’d
+1,zs->
diù
);

1544 
ZRANGE_SCORE
:

1545 
d–‘ed
 = 
	`z¦D–‘eRªgeByScÜe
(
zs
->
z¦
,&
¿nge
,zs->
diù
);

1547 
ZRANGE_LEX
:

1548 
d–‘ed
 = 
	`z¦D–‘eRªgeByLex
(
zs
->
z¦
,&
Ëx¿nge
,zs->
diù
);

1551 ià(
	`htN“dsResize
(
zs
->
diù
)è
	`diùResize
(zs->dict);

1552 ià(
	`diùSize
(
zs
->
diù
) == 0) {

1553 
	`dbD–‘e
(
c
->
db
,
key
);

1554 
key»moved
 = 1;

1557 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1561 ià(
d–‘ed
) {

1562 *
ev’t
[3] = {"zremrangebyrank","zremrangebyscore","zremrangebylex"};

1563 
	`sigÇlModif›dKey
(
c
->
db
,
key
);

1564 
	`nÙifyKey¥aûEv’t
(
NOTIFY_ZSET
,
ev’t
[
¿ng‘y³
],
key
,
c
->
db
->
id
);

1565 ià(
key»moved
)

1566 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
key
,
c
->
db
->
id
);

1568 
£rv”
.
dœty
 +ğ
d–‘ed
;

1569 
	`addR•lyLÚgLÚg
(
c
,
d–‘ed
);

1571 
ş—nup
:

1572 ià(
¿ng‘y³
 =ğ
ZRANGE_LEX
è
	`z¦F»eLexRªge
(&
Ëx¿nge
);

1573 
	}
}

1575 
	$z»m¿ngeby¿nkCommªd
(
ş›Á
 *
c
) {

1576 
	`z»m¿ngeG’”icCommªd
(
c
,
ZRANGE_RANK
);

1577 
	}
}

1579 
	$z»m¿ngebyscÜeCommªd
(
ş›Á
 *
c
) {

1580 
	`z»m¿ngeG’”icCommªd
(
c
,
ZRANGE_SCORE
);

1581 
	}
}

1583 
	$z»m¿ngebyËxCommªd
(
ş›Á
 *
c
) {

1584 
	`z»m¿ngeG’”icCommªd
(
c
,
ZRANGE_LEX
);

1585 
	}
}

1588 
robj
 *
	msubjeù
;

1589 
	mty³
;

1590 
	m’codšg
;

1591 
	mweight
;

1595 
	u_™”£t
 {

1597 
št£t
 *
	mis
;

1598 
	mii
;

1599 } 
	mis
;

1601 
diù
 *
	mdiù
;

1602 
diùI‹¿tÜ
 *
	mdi
;

1603 
diùEÁry
 *
	mde
;

1604 } 
	mht
;

1605 } 
	m£t
;

1608 
	u_™”z£t
 {

1610 *
	mzl
;

1611 *
	m•Œ
, *
	m¥Œ
;

1612 } 
	mzl
;

1614 
z£t
 *
	mzs
;

1615 
zskli¡Node
 *
	mnode
;

1616 } 
	m¦
;

1617 } 
	mz£t
;

1618 } 
	m™”
;

1619 } 
	tz£tİ¤c
;

1628 
	#OPVAL_DIRTY_ROBJ
 1

	)

1629 
	#OPVAL_DIRTY_LL
 2

	)

1630 
	#OPVAL_VALID_LL
 4

	)

1634 
	mæags
;

1635 
	m_buf
[32];

1636 
robj
 *
	m–e
;

1637 *
	me¡r
;

1638 
	m–’
;

1639 
	m–l
;

1640 
	mscÜe
;

1641 } 
	tz£tİv®
;

1643 
_™”£t
 
	t™”£t
;

1644 
_™”z£t
 
	t™”z£t
;

1646 
	$zuiIn™I‹¿tÜ
(
z£tİ¤c
 *
İ
) {

1647 ià(
İ
->
subjeù
 =ğ
NULL
)

1650 ià(
İ
->
ty³
 =ğ
OBJ_SET
) {

1651 
™”£t
 *
™
 = &
İ
->
™”
.
£t
;

1652 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

1653 
™
->
is
.i ğ
İ
->
subjeù
->
±r
;

1654 
™
->
is
.
ii
 = 0;

1655 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

1656 
™
->
ht
.
diù
 = 
İ
->
subjeù
->
±r
;

1657 
™
->
ht
.
di
 = 
	`diùG‘I‹¿tÜ
(
İ
->
subjeù
->
±r
);

1658 
™
->
ht
.
de
 = 
	`diùNext
(™->ht.
di
);

1660 
	`£rv”Pªic
("Unknown setƒncoding");

1662 } ià(
İ
->
ty³
 =ğ
OBJ_ZSET
) {

1663 
™”z£t
 *
™
 = &
İ
->
™”
.
z£t
;

1664 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1665 
™
->
zl
.zÈğ
İ
->
subjeù
->
±r
;

1666 
™
->
zl
.
•Œ
 = 
	`zli¡Index
(it->zl.zl,0);

1667 ià(
™
->
zl
.
•Œ
 !ğ
NULL
) {

1668 
™
->
zl
.
¥Œ
 = 
	`zli¡Next
(™->zl.zl,™->zl.
•Œ
);

1669 
	`£rv”As£¹
(
™
->
zl
.
¥Œ
 !ğ
NULL
);

1671 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1672 
™
->
¦
.
zs
 = 
İ
->
subjeù
->
±r
;

1673 
™
->
¦
.
node
 = it->¦.
zs
->
z¦
->
h—d”
->
Ëv–
[0].
fÜw¬d
;

1675 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1678 
	`£rv”Pªic
("Unsupportedype");

1680 
	}
}

1682 
	$zuiCË¬I‹¿tÜ
(
z£tİ¤c
 *
İ
) {

1683 ià(
İ
->
subjeù
 =ğ
NULL
)

1686 ià(
İ
->
ty³
 =ğ
OBJ_SET
) {

1687 
™”£t
 *
™
 = &
İ
->
™”
.
£t
;

1688 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

1689 
	`UNUSED
(
™
);

1690 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

1691 
	`diùR–—£I‹¿tÜ
(
™
->
ht
.
di
);

1693 
	`£rv”Pªic
("Unknown setƒncoding");

1695 } ià(
İ
->
ty³
 =ğ
OBJ_ZSET
) {

1696 
™”z£t
 *
™
 = &
İ
->
™”
.
z£t
;

1697 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1698 
	`UNUSED
(
™
);

1699 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1700 
	`UNUSED
(
™
);

1702 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1705 
	`£rv”Pªic
("Unsupportedype");

1707 
	}
}

1709 
	$zuiL’gth
(
z£tİ¤c
 *
İ
) {

1710 ià(
İ
->
subjeù
 =ğ
NULL
)

1713 ià(
İ
->
ty³
 =ğ
OBJ_SET
) {

1714 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

1715  
	`št£tL’
(
İ
->
subjeù
->
±r
);

1716 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

1717 
diù
 *
ht
 = 
İ
->
subjeù
->
±r
;

1718  
	`diùSize
(
ht
);

1720 
	`£rv”Pªic
("Unknown setƒncoding");

1722 } ià(
İ
->
ty³
 =ğ
OBJ_ZSET
) {

1723 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1724  
	`zzlL’gth
(
İ
->
subjeù
->
±r
);

1725 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1726 
z£t
 *
zs
 = 
İ
->
subjeù
->
±r
;

1727  
zs
->
z¦
->
Ëngth
;

1729 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1732 
	`£rv”Pªic
("Unsupportedype");

1734 
	}
}

1739 
	$zuiNext
(
z£tİ¤c
 *
İ
, 
z£tİv®
 *
v®
) {

1740 ià(
İ
->
subjeù
 =ğ
NULL
)

1743 ià(
v®
->
æags
 & 
OPVAL_DIRTY_ROBJ
)

1744 
	`deüRefCouÁ
(
v®
->
–e
);

1746 
	`mem£t
(
v®
,0,(
z£tİv®
));

1748 ià(
İ
->
ty³
 =ğ
OBJ_SET
) {

1749 
™”£t
 *
™
 = &
İ
->
™”
.
£t
;

1750 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

1751 
št64_t
 
–l
;

1753 ià(!
	`št£tG‘
(
™
->
is
.is,™->is.
ii
,&
–l
))

1755 
v®
->
–l
 =ƒll;

1756 
v®
->
scÜe
 = 1.0;

1759 
™
->
is
.
ii
++;

1760 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

1761 ià(
™
->
ht
.
de
 =ğ
NULL
)

1763 
v®
->
–e
 = 
	`diùG‘Key
(
™
->
ht
.
de
);

1764 
v®
->
scÜe
 = 1.0;

1767 
™
->
ht
.
de
 = 
	`diùNext
(™->ht.
di
);

1769 
	`£rv”Pªic
("Unknown setƒncoding");

1771 } ià(
İ
->
ty³
 =ğ
OBJ_ZSET
) {

1772 
™”z£t
 *
™
 = &
İ
->
™”
.
z£t
;

1773 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1775 ià(
™
->
zl
.
•Œ
 =ğ
NULL
 || it->zl.
¥Œ
 == NULL)

1777 
	`£rv”As£¹
(
	`zli¡G‘
(
™
->
zl
.
•Œ
,&
v®
->
e¡r
,&v®->
–’
,&v®->
–l
));

1778 
v®
->
scÜe
 = 
	`zzlG‘ScÜe
(
™
->
zl
.
¥Œ
);

1781 
	`zzlNext
(
™
->
zl
.zl,&™->zl.
•Œ
,&™->zl.
¥Œ
);

1782 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1783 ià(
™
->
¦
.
node
 =ğ
NULL
)

1785 
v®
->
–e
 = 
™
->
¦
.
node
->
obj
;

1786 
v®
->
scÜe
 = 
™
->
¦
.
node
->score;

1789 
™
->
¦
.
node
 = it->¦.node->
Ëv–
[0].
fÜw¬d
;

1791 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1794 
	`£rv”Pªic
("Unsupportedype");

1797 
	}
}

1799 
	$zuiLÚgLÚgFromV®ue
(
z£tİv®
 *
v®
) {

1800 ià(!(
v®
->
æags
 & 
OPVAL_DIRTY_LL
)) {

1801 
v®
->
æags
 |ğ
OPVAL_DIRTY_LL
;

1803 ià(
v®
->
–e
 !ğ
NULL
) {

1804 ià(
v®
->
–e
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

1805 
v®
->
–l
 = ()v®->
–e
->
±r
;

1806 
v®
->
æags
 |ğ
OPVAL_VALID_LL
;

1807 } ià(
	`sdsEncodedObjeù
(
v®
->
–e
)) {

1808 ià(
	`¡ršg2Î
(
v®
->
–e
->
±r
,
	`sd¦’
(v®->–e->±r),&v®->
–l
))

1809 
v®
->
æags
 |ğ
OPVAL_VALID_LL
;

1811 
	`£rv”Pªic
("Unsupportedƒlementƒncoding");

1813 } ià(
v®
->
e¡r
 !ğ
NULL
) {

1814 ià(
	`¡ršg2Î
((*)
v®
->
e¡r
,v®->
–’
,&v®->
–l
))

1815 
v®
->
æags
 |ğ
OPVAL_VALID_LL
;

1818 
v®
->
æags
 |ğ
OPVAL_VALID_LL
;

1821  
v®
->
æags
 & 
OPVAL_VALID_LL
;

1822 
	}
}

1824 
robj
 *
	$zuiObjeùFromV®ue
(
z£tİv®
 *
v®
) {

1825 ià(
v®
->
–e
 =ğ
NULL
) {

1826 ià(
v®
->
e¡r
 !ğ
NULL
) {

1827 
v®
->
–e
 = 
	`ü—‹SŒšgObjeù
((*)v®->
e¡r
,v®->
–’
);

1829 
v®
->
–e
 = 
	`ü—‹SŒšgObjeùFromLÚgLÚg
(v®->
–l
);

1831 
v®
->
æags
 |ğ
OPVAL_DIRTY_ROBJ
;

1833  
v®
->
–e
;

1834 
	}
}

1836 
	$zuiBufãrFromV®ue
(
z£tİv®
 *
v®
) {

1837 ià(
v®
->
e¡r
 =ğ
NULL
) {

1838 ià(
v®
->
–e
 !ğ
NULL
) {

1839 ià(
v®
->
–e
->
’codšg
 =ğ
OBJ_ENCODING_INT
) {

1840 
v®
->
–’
 = 
	`Î2¡ršg
((*)v®->
_buf
,(v®->_buf),()v®->
–e
->
±r
);

1841 
v®
->
e¡r
 = v®->
_buf
;

1842 } ià(
	`sdsEncodedObjeù
(
v®
->
–e
)) {

1843 
v®
->
–’
 = 
	`sd¦’
(v®->
–e
->
±r
);

1844 
v®
->
e¡r
 = v®->
–e
->
±r
;

1846 
	`£rv”Pªic
("Unsupportedƒlementƒncoding");

1849 
v®
->
–’
 = 
	`Î2¡ršg
((*)v®->
_buf
,(v®->_buf),v®->
–l
);

1850 
v®
->
e¡r
 = v®->
_buf
;

1854 
	}
}

1858 
	$zuiFšd
(
z£tİ¤c
 *
İ
, 
z£tİv®
 *
v®
, *
scÜe
) {

1859 ià(
İ
->
subjeù
 =ğ
NULL
)

1862 ià(
İ
->
ty³
 =ğ
OBJ_SET
) {

1863 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_INTSET
) {

1864 ià(
	`zuiLÚgLÚgFromV®ue
(
v®
) &&

1865 
	`št£tFšd
(
İ
->
subjeù
->
±r
,
v®
->
–l
))

1867 *
scÜe
 = 1.0;

1872 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_HT
) {

1873 
diù
 *
ht
 = 
İ
->
subjeù
->
±r
;

1874 
	`zuiObjeùFromV®ue
(
v®
);

1875 ià(
	`diùFšd
(
ht
,
v®
->
–e
è!ğ
NULL
) {

1876 *
scÜe
 = 1.0;

1882 
	`£rv”Pªic
("Unknown setƒncoding");

1884 } ià(
İ
->
ty³
 =ğ
OBJ_ZSET
) {

1885 
	`zuiObjeùFromV®ue
(
v®
);

1887 ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

1888 ià(
	`zzlFšd
(
İ
->
subjeù
->
±r
,
v®
->
–e
,
scÜe
è!ğ
NULL
) {

1894 } ià(
İ
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

1895 
z£t
 *
zs
 = 
İ
->
subjeù
->
±r
;

1896 
diùEÁry
 *
de
;

1897 ià((
de
 = 
	`diùFšd
(
zs
->
diù
,
v®
->
–e
)è!ğ
NULL
) {

1898 *
scÜe
 = *(*)
	`diùG‘V®
(
de
);

1904 
	`£rv”Pªic
("Unknown sorted setƒncoding");

1907 
	`£rv”Pªic
("Unsupportedype");

1909 
	}
}

1911 
	$zuiCom·»ByC¬dš®™y
(cÚ¡ *
s1
, cÚ¡ *
s2
) {

1912  
	`zuiL’gth
((
z£tİ¤c
*)
s1
è- zuiL’gth((z£tİ¤c*)
s2
);

1913 
	}
}

1915 
	#REDIS_AGGR_SUM
 1

	)

1916 
	#REDIS_AGGR_MIN
 2

	)

1917 
	#REDIS_AGGR_MAX
 3

	)

1918 
	#zuniÚIÁ”DiùV®ue
(
_e
è(
	`diùG‘V®
(_eè=ğ
NULL
 ? 1.0 : *(*)diùG‘V®(_e))

	)

1920 
šlše
 
	$zuniÚIÁ”Agg»g©e
(*
rg‘
, 
v®
, 
agg»g©e
) {

1921 ià(
agg»g©e
 =ğ
REDIS_AGGR_SUM
) {

1922 *
rg‘
 = *rg‘ + 
v®
;

1926 ià(
	`i¢ª
(*
rg‘
)) *target = 0.0;

1927 } ià(
agg»g©e
 =ğ
REDIS_AGGR_MIN
) {

1928 *
rg‘
 = 
v®
 < *target ? val : *target;

1929 } ià(
agg»g©e
 =ğ
REDIS_AGGR_MAX
) {

1930 *
rg‘
 = 
v®
 > *target ? val : *target;

1933 
	`£rv”Pªic
("Unknown ZUNION/INTER‡ggregateype");

1935 
	}
}

1937 
	$zuniÚIÁ”G’”icCommªd
(
ş›Á
 *
c
, 
robj
 *
d¡key
, 
İ
) {

1938 
i
, 
j
;

1939 
£Šum
;

1940 
agg»g©e
 = 
REDIS_AGGR_SUM
;

1941 
z£tİ¤c
 *
¤c
;

1942 
z£tİv®
 
zv®
;

1943 
robj
 *
tmp
;

1944 
max––’
 = 0;

1945 
robj
 *
d¡obj
;

1946 
z£t
 *
d¡z£t
;

1947 
zskli¡Node
 *
znode
;

1948 
touched
 = 0;

1951 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
£Šum
, 
NULL
è!ğ
C_OK
))

1954 ià(
£Šum
 < 1) {

1955 
	`addR•lyE¼Ü
(
c
,

1961 ià(
£Šum
 > 
c
->
¬gc
-3) {

1962 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

1967 
¤c
 = 
	`zÿÎoc
((
z£tİ¤c
è* 
£Šum
);

1968 
i
 = 0, 
j
 = 3; i < 
£Šum
; i++, j++) {

1969 
robj
 *
obj
 = 
	`lookupKeyWr™e
(
c
->
db
,c->
¬gv
[
j
]);

1970 ià(
obj
 !ğ
NULL
) {

1971 ià(
obj
->
ty³
 !ğ
OBJ_ZSET
 && obj->ty³ !ğ
OBJ_SET
) {

1972 
	`zä“
(
¤c
);

1973 
	`addR•ly
(
c
,
sh¬ed
.
wrÚgty³”r
);

1977 
¤c
[
i
].
subjeù
 = 
obj
;

1978 
¤c
[
i
].
ty³
 = 
obj
->type;

1979 
¤c
[
i
].
’codšg
 = 
obj
->encoding;

1981 
¤c
[
i
].
subjeù
 = 
NULL
;

1985 
¤c
[
i
].
weight
 = 1.0;

1989 ià(
j
 < 
c
->
¬gc
) {

1990 
»maššg
 = 
c
->
¬gc
 - 
j
;

1992 
»maššg
) {

1993 ià(
»maššg
 >ğ(
£Šum
 + 1è&& !
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"weights")) {

1994 
j
++; 
»maššg
--;

1995 
i
 = 0; i < 
£Šum
; i++, 
j
++, 
»maššg
--) {

1996 ià(
	`g‘DoubËFromObjeùOrR•ly
(
c
,c->
¬gv
[
j
],&
¤c
[
i
].
weight
,

1997 "weighˆv®ui nÙ‡ flßt"è!ğ
C_OK
)

1999 
	`zä“
(
¤c
);

2003 } ià(
»maššg
 >ğ2 && !
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"aggregate")) {

2004 
j
++; 
»maššg
--;

2005 ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"sum")) {

2006 
agg»g©e
 = 
REDIS_AGGR_SUM
;

2007 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"min")) {

2008 
agg»g©e
 = 
REDIS_AGGR_MIN
;

2009 } ià(!
	`¡rÿ£cmp
(
c
->
¬gv
[
j
]->
±r
,"max")) {

2010 
agg»g©e
 = 
REDIS_AGGR_MAX
;

2012 
	`zä“
(
¤c
);

2013 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

2016 
j
++; 
»maššg
--;

2018 
	`zä“
(
¤c
);

2019 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

2027 
	`qsÜt
(
¤c
,
£Šum
,(
z£tİ¤c
),
zuiCom·»ByC¬dš®™y
);

2029 
d¡obj
 = 
	`ü—‹Z£tObjeù
();

2030 
d¡z£t
 = 
d¡obj
->
±r
;

2031 
	`mem£t
(&
zv®
, 0, (zval));

2033 ià(
İ
 =ğ
SET_OP_INTER
) {

2035 ià(
	`zuiL’gth
(&
¤c
[0]) > 0) {

2038 
	`zuiIn™I‹¿tÜ
(&
¤c
[0]);

2039 
	`zuiNext
(&
¤c
[0],&
zv®
)) {

2040 
scÜe
, 
v®ue
;

2042 
scÜe
 = 
¤c
[0].
weight
 * 
zv®
.score;

2043 ià(
	`i¢ª
(
scÜe
)) score = 0;

2045 
j
 = 1; j < 
£Šum
; j++) {

2048 ià(
¤c
[
j
].
subjeù
 == src[0].subject) {

2049 
v®ue
 = 
zv®
.
scÜe
*
¤c
[
j
].
weight
;

2050 
	`zuniÚIÁ”Agg»g©e
(&
scÜe
,
v®ue
,
agg»g©e
);

2051 } ià(
	`zuiFšd
(&
¤c
[
j
],&
zv®
,&
v®ue
)) {

2052 
v®ue
 *ğ
¤c
[
j
].
weight
;

2053 
	`zuniÚIÁ”Agg»g©e
(&
scÜe
,
v®ue
,
agg»g©e
);

2060 ià(
j
 =ğ
£Šum
) {

2061 
tmp
 = 
	`zuiObjeùFromV®ue
(&
zv®
);

2062 
znode
 = 
	`z¦In£¹
(
d¡z£t
->
z¦
,
scÜe
,
tmp
);

2063 
	`šüRefCouÁ
(
tmp
);

2064 
	`diùAdd
(
d¡z£t
->
diù
,
tmp
,&
znode
->
scÜe
);

2065 
	`šüRefCouÁ
(
tmp
);

2067 ià(
	`sdsEncodedObjeù
(
tmp
)) {

2068 ià(
	`sd¦’
(
tmp
->
±r
è> 
max––’
)

2069 
max––’
 = 
	`sd¦’
(
tmp
->
±r
);

2073 
	`zuiCË¬I‹¿tÜ
(&
¤c
[0]);

2075 } ià(
İ
 =ğ
SET_OP_UNION
) {

2076 
diù
 *
accumuÏtÜ
 = 
	`diùC»©e
(&
£tDiùTy³
,
NULL
);

2077 
diùI‹¿tÜ
 *
di
;

2078 
diùEÁry
 *
de
;

2079 
scÜe
;

2081 ià(
£Šum
) {

2084 
	`diùEx·nd
(
accumuÏtÜ
,
	`zuiL’gth
(&
¤c
[
£Šum
-1]));

2089 
i
 = 0; i < 
£Šum
; i++) {

2090 ià(
	`zuiL’gth
(&
¤c
[
i
]) == 0) ;

2092 
	`zuiIn™I‹¿tÜ
(&
¤c
[
i
]);

2093 
	`zuiNext
(&
¤c
[
i
],&
zv®
)) {

2095 
scÜe
 = 
¤c
[
i
].
weight
 * 
zv®
.score;

2096 ià(
	`i¢ª
(
scÜe
)) score = 0;

2099 
de
 = 
	`diùFšd
(
accumuÏtÜ
,
	`zuiObjeùFromV®ue
(&
zv®
));

2101 ià(
de
 =ğ
NULL
) {

2102 
tmp
 = 
	`zuiObjeùFromV®ue
(&
zv®
);

2106 ià(
	`sdsEncodedObjeù
(
tmp
)) {

2107 ià(
	`sd¦’
(
tmp
->
±r
è> 
max––’
)

2108 
max––’
 = 
	`sd¦’
(
tmp
->
±r
);

2111 
de
 = 
	`diùAddRaw
(
accumuÏtÜ
,
tmp
);

2112 
	`šüRefCouÁ
(
tmp
);

2113 
	`diùS‘DoubËV®
(
de
,
scÜe
);

2121 
	`zuniÚIÁ”Agg»g©e
(&
de
->
v
.
d
,
scÜe
,
agg»g©e
);

2124 
	`zuiCË¬I‹¿tÜ
(&
¤c
[
i
]);

2128 
di
 = 
	`diùG‘I‹¿tÜ
(
accumuÏtÜ
);

2133 
	`diùEx·nd
(
d¡z£t
->
diù
,
	`diùSize
(
accumuÏtÜ
));

2135 (
de
 = 
	`diùNext
(
di
)è!ğ
NULL
) {

2136 
robj
 *
–e
 = 
	`diùG‘Key
(
de
);

2137 
scÜe
 = 
	`diùG‘DoubËV®
(
de
);

2138 
znode
 = 
	`z¦In£¹
(
d¡z£t
->
z¦
,
scÜe
,
–e
);

2139 
	`šüRefCouÁ
(
–e
);

2140 
	`diùAdd
(
d¡z£t
->
diù
,
–e
,&
znode
->
scÜe
);

2141 
	`šüRefCouÁ
(
–e
);

2143 
	`diùR–—£I‹¿tÜ
(
di
);

2146 
	`diùR–—£
(
accumuÏtÜ
);

2148 
	`£rv”Pªic
("Unknown operator");

2151 ià(
	`dbD–‘e
(
c
->
db
,
d¡key
))

2152 
touched
 = 1;

2153 ià(
d¡z£t
->
z¦
->
Ëngth
) {

2154 
	`z£tCÚv”tToZli¡IfN“ded
(
d¡obj
,
max––’
);

2155 
	`dbAdd
(
c
->
db
,
d¡key
,
d¡obj
);

2156 
	`addR•lyLÚgLÚg
(
c
,
	`z£tL’gth
(
d¡obj
));

2157 
	`sigÇlModif›dKey
(
c
->
db
,
d¡key
);

2158 
	`nÙifyKey¥aûEv’t
(
NOTIFY_ZSET
,

2159 (
İ
 =ğ
SET_OP_UNION
) ? "zunionstore" : "zinterstore",

2160 
d¡key
,
c
->
db
->
id
);

2161 
£rv”
.
dœty
++;

2163 
	`deüRefCouÁ
(
d¡obj
);

2164 
	`addR•ly
(
c
,
sh¬ed
.
cz”o
);

2165 ià(
touched
) {

2166 
	`sigÇlModif›dKey
(
c
->
db
,
d¡key
);

2167 
	`nÙifyKey¥aûEv’t
(
NOTIFY_GENERIC
,"d–",
d¡key
,
c
->
db
->
id
);

2168 
£rv”
.
dœty
++;

2171 
	`zä“
(
¤c
);

2172 
	}
}

2174 
	$zuniÚ¡ÜeCommªd
(
ş›Á
 *
c
) {

2175 
	`zuniÚIÁ”G’”icCommªd
(
c
,c->
¬gv
[1], 
SET_OP_UNION
);

2176 
	}
}

2178 
	$zš‹r¡ÜeCommªd
(
ş›Á
 *
c
) {

2179 
	`zuniÚIÁ”G’”icCommªd
(
c
,c->
¬gv
[1], 
SET_OP_INTER
);

2180 
	}
}

2182 
	$z¿ngeG’”icCommªd
(
ş›Á
 *
c
, 
»v”£
) {

2183 
robj
 *
key
 = 
c
->
¬gv
[1];

2184 
robj
 *
zobj
;

2185 
w™hscÜes
 = 0;

2186 
¡¬t
;

2187 
’d
;

2188 
Î’
;

2189 
¿ng–’
;

2191 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[2], &
¡¬t
, 
NULL
è!ğ
C_OK
) ||

2192 (
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[3], &
’d
, 
NULL
è!ğ
C_OK
)) ;

2194 ià(
c
->
¬gc
 =ğ5 && !
	`¡rÿ£cmp
(c->
¬gv
[4]->
±r
,"withscores")) {

2195 
w™hscÜes
 = 1;

2196 } ià(
c
->
¬gc
 >= 5) {

2197 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

2201 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
,
key
,
sh¬ed
.
em±ymuÉibulk
)è=ğ
NULL


2202 || 
	`checkTy³
(
c
,
zobj
,
OBJ_ZSET
)) ;

2205 
Î’
 = 
	`z£tL’gth
(
zobj
);

2206 ià(
¡¬t
 < 0è¡¬ˆğ
Î’
+start;

2207 ià(
’d
 < 0è’d = 
Î’
+end;

2208 ià(
¡¬t
 < 0) start = 0;

2212 ià(
¡¬t
 > 
’d
 || s¹ >ğ
Î’
) {

2213 
	`addR•ly
(
c
,
sh¬ed
.
em±ymuÉibulk
);

2216 ià(
’d
 >ğ
Î’
)ƒnd =†len-1;

2217 
¿ng–’
 = (
’d
-
¡¬t
)+1;

2220 
	`addR•lyMuÉiBulkL’
(
c
, 
w™hscÜes
 ? (
¿ng–’
*2) :„angelen);

2222 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

2223 *
zl
 = 
zobj
->
±r
;

2224 *
•Œ
, *
¥Œ
;

2225 *
v¡r
;

2226 
vËn
;

2227 
vlÚg
;

2229 ià(
»v”£
)

2230 
•Œ
 = 
	`zli¡Index
(
zl
,-2-(2*
¡¬t
));

2232 
•Œ
 = 
	`zli¡Index
(
zl
,2*
¡¬t
);

2234 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
•Œ
 !ğ
NULL
);

2235 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

2237 
¿ng–’
--) {

2238 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
•Œ
 !ğ
NULL
 && 
¥Œ
 != NULL);

2239 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
	`zli¡G‘
(
•Œ
,&
v¡r
,&
vËn
,&
vlÚg
));

2240 ià(
v¡r
 =ğ
NULL
)

2241 
	`addR•lyBulkLÚgLÚg
(
c
,
vlÚg
);

2243 
	`addR•lyBulkCBufãr
(
c
,
v¡r
,
vËn
);

2245 ià(
w™hscÜes
)

2246 
	`addR•lyDoubË
(
c
,
	`zzlG‘ScÜe
(
¥Œ
));

2248 ià(
»v”£
)

2249 
	`zzlP»v
(
zl
,&
•Œ
,&
¥Œ
);

2251 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

2254 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

2255 
z£t
 *
zs
 = 
zobj
->
±r
;

2256 
zskli¡
 *
z¦
 = 
zs
->zsl;

2257 
zskli¡Node
 *
Ê
;

2258 
robj
 *
–e
;

2261 ià(
»v”£
) {

2262 
Ê
 = 
z¦
->

;

2263 ià(
¡¬t
 > 0)

2264 
Ê
 = 
	`z¦G‘EËm’tByRªk
(
z¦
,
Î’
-
¡¬t
);

2266 
Ê
 = 
z¦
->
h—d”
->
Ëv–
[0].
fÜw¬d
;

2267 ià(
¡¬t
 > 0)

2268 
Ê
 = 
	`z¦G‘EËm’tByRªk
(
z¦
,
¡¬t
+1);

2271 
¿ng–’
--) {

2272 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
Ê
 !ğ
NULL
);

2273 
–e
 = 
Ê
->
obj
;

2274 
	`addR•lyBulk
(
c
,
–e
);

2275 ià(
w™hscÜes
)

2276 
	`addR•lyDoubË
(
c
,
Ê
->
scÜe
);

2277 
Ê
 = 
»v”£
 ?†n->
backw¬d
 :†n->
Ëv–
[0].
fÜw¬d
;

2280 
	`£rv”Pªic
("Unknown sorted setƒncoding");

2282 
	}
}

2284 
	$z¿ngeCommªd
(
ş›Á
 *
c
) {

2285 
	`z¿ngeG’”icCommªd
(
c
,0);

2286 
	}
}

2288 
	$z»v¿ngeCommªd
(
ş›Á
 *
c
) {

2289 
	`z¿ngeG’”icCommªd
(
c
,1);

2290 
	}
}

2293 
	$g’”icZ¿ngebyscÜeCommªd
(
ş›Á
 *
c
, 
»v”£
) {

2294 
z¿nge¥ec
 
¿nge
;

2295 
robj
 *
key
 = 
c
->
¬gv
[1];

2296 
robj
 *
zobj
;

2297 
off£t
 = 0, 
lim™
 = -1;

2298 
w™hscÜes
 = 0;

2299 
¿ng–’
 = 0;

2300 *
»¶yËn
 = 
NULL
;

2301 
mšidx
, 
maxidx
;

2304 ià(
»v”£
) {

2306 
maxidx
 = 2; 
mšidx
 = 3;

2309 
mšidx
 = 2; 
maxidx
 = 3;

2312 ià(
	`z¦P¬£Rªge
(
c
->
¬gv
[
mšidx
],c->¬gv[
maxidx
],&
¿nge
è!ğ
C_OK
) {

2313 
	`addR•lyE¼Ü
(
c
,"min or max is‚ot‡ float");

2319 ià(
c
->
¬gc
 > 4) {

2320 
»maššg
 = 
c
->
¬gc
 - 4;

2321 
pos
 = 4;

2323 
»maššg
) {

2324 ià(
»maššg
 >ğ1 && !
	`¡rÿ£cmp
(
c
->
¬gv
[
pos
]->
±r
,"withscores")) {

2325 
pos
++; 
»maššg
--;

2326 
w™hscÜes
 = 1;

2327 } ià(
»maššg
 >ğ3 && !
	`¡rÿ£cmp
(
c
->
¬gv
[
pos
]->
±r
,"limit")) {

2328 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[
pos
+1], &
off£t
, 
NULL
è!ğ
C_OK
) ||

2329 (
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[
pos
+2], &
lim™
, 
NULL
è!ğ
C_OK
)) ;

2330 
pos
 +ğ3; 
»maššg
 -= 3;

2332 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

2339 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
,
key
,
sh¬ed
.
em±ymuÉibulk
)è=ğ
NULL
 ||

2340 
	`checkTy³
(
c
,
zobj
,
OBJ_ZSET
)) ;

2342 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

2343 *
zl
 = 
zobj
->
±r
;

2344 *
•Œ
, *
¥Œ
;

2345 *
v¡r
;

2346 
vËn
;

2347 
vlÚg
;

2348 
scÜe
;

2351 ià(
»v”£
) {

2352 
•Œ
 = 
	`zzlLa¡InRªge
(
zl
,&
¿nge
);

2354 
•Œ
 = 
	`zzlFœ¡InRªge
(
zl
,&
¿nge
);

2358 ià(
•Œ
 =ğ
NULL
) {

2359 
	`addR•ly
(
c
, 
sh¬ed
.
em±ymuÉibulk
);

2364 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
•Œ
 !ğ
NULL
);

2365 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

2370 
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

2374 
•Œ
 && 
off£t
--) {

2375 ià(
»v”£
) {

2376 
	`zzlP»v
(
zl
,&
•Œ
,&
¥Œ
);

2378 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

2382 
•Œ
 && 
lim™
--) {

2383 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

2386 ià(
»v”£
) {

2387 ià(!
	`z¦V®ueG‹Mš
(
scÜe
,&
¿nge
)) ;

2389 ià(!
	`z¦V®ueL‹Max
(
scÜe
,&
¿nge
)) ;

2393 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
	`zli¡G‘
(
•Œ
,&
v¡r
,&
vËn
,&
vlÚg
));

2395 
¿ng–’
++;

2396 ià(
v¡r
 =ğ
NULL
) {

2397 
	`addR•lyBulkLÚgLÚg
(
c
,
vlÚg
);

2399 
	`addR•lyBulkCBufãr
(
c
,
v¡r
,
vËn
);

2402 ià(
w™hscÜes
) {

2403 
	`addR•lyDoubË
(
c
,
scÜe
);

2407 ià(
»v”£
) {

2408 
	`zzlP»v
(
zl
,&
•Œ
,&
¥Œ
);

2410 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

2413 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

2414 
z£t
 *
zs
 = 
zobj
->
±r
;

2415 
zskli¡
 *
z¦
 = 
zs
->zsl;

2416 
zskli¡Node
 *
Ê
;

2419 ià(
»v”£
) {

2420 
Ê
 = 
	`z¦La¡InRªge
(
z¦
,&
¿nge
);

2422 
Ê
 = 
	`z¦Fœ¡InRªge
(
z¦
,&
¿nge
);

2426 ià(
Ê
 =ğ
NULL
) {

2427 
	`addR•ly
(
c
, 
sh¬ed
.
em±ymuÉibulk
);

2434 
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

2438 
Ê
 && 
off£t
--) {

2439 ià(
»v”£
) {

2440 
Ê
 =†n->
backw¬d
;

2442 
Ê
 =†n->
Ëv–
[0].
fÜw¬d
;

2446 
Ê
 && 
lim™
--) {

2448 ià(
»v”£
) {

2449 ià(!
	`z¦V®ueG‹Mš
(
Ê
->
scÜe
,&
¿nge
)) ;

2451 ià(!
	`z¦V®ueL‹Max
(
Ê
->
scÜe
,&
¿nge
)) ;

2454 
¿ng–’
++;

2455 
	`addR•lyBulk
(
c
,
Ê
->
obj
);

2457 ià(
w™hscÜes
) {

2458 
	`addR•lyDoubË
(
c
,
Ê
->
scÜe
);

2462 ià(
»v”£
) {

2463 
Ê
 =†n->
backw¬d
;

2465 
Ê
 =†n->
Ëv–
[0].
fÜw¬d
;

2469 
	`£rv”Pªic
("Unknown sorted setƒncoding");

2472 ià(
w™hscÜes
) {

2473 
¿ng–’
 *= 2;

2476 
	`£tDeã¼edMuÉiBulkL’gth
(
c
, 
»¶yËn
, 
¿ng–’
);

2477 
	}
}

2479 
	$z¿ngebyscÜeCommªd
(
ş›Á
 *
c
) {

2480 
	`g’”icZ¿ngebyscÜeCommªd
(
c
,0);

2481 
	}
}

2483 
	$z»v¿ngebyscÜeCommªd
(
ş›Á
 *
c
) {

2484 
	`g’”icZ¿ngebyscÜeCommªd
(
c
,1);

2485 
	}
}

2487 
	$zcouÁCommªd
(
ş›Á
 *
c
) {

2488 
robj
 *
key
 = 
c
->
¬gv
[1];

2489 
robj
 *
zobj
;

2490 
z¿nge¥ec
 
¿nge
;

2491 
couÁ
 = 0;

2494 ià(
	`z¦P¬£Rªge
(
c
->
¬gv
[2],c->¬gv[3],&
¿nge
è!ğ
C_OK
) {

2495 
	`addR•lyE¼Ü
(
c
,"min or max is‚ot‡ float");

2500 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
, 
key
, 
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

2501 
	`checkTy³
(
c
, 
zobj
, 
OBJ_ZSET
)) ;

2503 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

2504 *
zl
 = 
zobj
->
±r
;

2505 *
•Œ
, *
¥Œ
;

2506 
scÜe
;

2509 
•Œ
 = 
	`zzlFœ¡InRªge
(
zl
,&
¿nge
);

2512 ià(
•Œ
 =ğ
NULL
) {

2513 
	`addR•ly
(
c
, 
sh¬ed
.
cz”o
);

2518 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

2519 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

2520 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
	`z¦V®ueL‹Max
(
scÜe
,&
¿nge
));

2523 
•Œ
) {

2524 
scÜe
 = 
	`zzlG‘ScÜe
(
¥Œ
);

2527 ià(!
	`z¦V®ueL‹Max
(
scÜe
,&
¿nge
)) {

2530 
couÁ
++;

2531 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

2534 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

2535 
z£t
 *
zs
 = 
zobj
->
±r
;

2536 
zskli¡
 *
z¦
 = 
zs
->zsl;

2537 
zskli¡Node
 *
zn
;

2538 
¿nk
;

2541 
zn
 = 
	`z¦Fœ¡InRªge
(
z¦
, &
¿nge
);

2544 ià(
zn
 !ğ
NULL
) {

2545 
¿nk
 = 
	`z¦G‘Rªk
(
z¦
, 
zn
->
scÜe
, zn->
obj
);

2546 
couÁ
 = (
z¦
->
Ëngth
 - (
¿nk
 - 1));

2549 
zn
 = 
	`z¦La¡InRªge
(
z¦
, &
¿nge
);

2552 ià(
zn
 !ğ
NULL
) {

2553 
¿nk
 = 
	`z¦G‘Rªk
(
z¦
, 
zn
->
scÜe
, zn->
obj
);

2554 
couÁ
 -ğ(
z¦
->
Ëngth
 - 
¿nk
);

2558 
	`£rv”Pªic
("Unknown sorted setƒncoding");

2561 
	`addR•lyLÚgLÚg
(
c
, 
couÁ
);

2562 
	}
}

2564 
	$zËxcouÁCommªd
(
ş›Á
 *
c
) {

2565 
robj
 *
key
 = 
c
->
¬gv
[1];

2566 
robj
 *
zobj
;

2567 
zËx¿nge¥ec
 
¿nge
;

2568 
couÁ
 = 0;

2571 ià(
	`z¦P¬£LexRªge
(
c
->
¬gv
[2],c->¬gv[3],&
¿nge
è!ğ
C_OK
) {

2572 
	`addR•lyE¼Ü
(
c
,"min or max‚ot valid string„ange item");

2577 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
, 
key
, 
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

2578 
	`checkTy³
(
c
, 
zobj
, 
OBJ_ZSET
))

2580 
	`z¦F»eLexRªge
(&
¿nge
);

2584 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

2585 *
zl
 = 
zobj
->
±r
;

2586 *
•Œ
, *
¥Œ
;

2589 
•Œ
 = 
	`zzlFœ¡InLexRªge
(
zl
,&
¿nge
);

2592 ià(
•Œ
 =ğ
NULL
) {

2593 
	`z¦F»eLexRªge
(&
¿nge
);

2594 
	`addR•ly
(
c
, 
sh¬ed
.
cz”o
);

2599 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

2600 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
	`zzlLexV®ueL‹Max
(
•Œ
,&
¿nge
));

2603 
•Œ
) {

2605 ià(!
	`zzlLexV®ueL‹Max
(
•Œ
,&
¿nge
)) {

2608 
couÁ
++;

2609 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

2612 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

2613 
z£t
 *
zs
 = 
zobj
->
±r
;

2614 
zskli¡
 *
z¦
 = 
zs
->zsl;

2615 
zskli¡Node
 *
zn
;

2616 
¿nk
;

2619 
zn
 = 
	`z¦Fœ¡InLexRªge
(
z¦
, &
¿nge
);

2622 ià(
zn
 !ğ
NULL
) {

2623 
¿nk
 = 
	`z¦G‘Rªk
(
z¦
, 
zn
->
scÜe
, zn->
obj
);

2624 
couÁ
 = (
z¦
->
Ëngth
 - (
¿nk
 - 1));

2627 
zn
 = 
	`z¦La¡InLexRªge
(
z¦
, &
¿nge
);

2630 ià(
zn
 !ğ
NULL
) {

2631 
¿nk
 = 
	`z¦G‘Rªk
(
z¦
, 
zn
->
scÜe
, zn->
obj
);

2632 
couÁ
 -ğ(
z¦
->
Ëngth
 - 
¿nk
);

2636 
	`£rv”Pªic
("Unknown sorted setƒncoding");

2639 
	`z¦F»eLexRªge
(&
¿nge
);

2640 
	`addR•lyLÚgLÚg
(
c
, 
couÁ
);

2641 
	}
}

2644 
	$g’”icZ¿ngebyËxCommªd
(
ş›Á
 *
c
, 
»v”£
) {

2645 
zËx¿nge¥ec
 
¿nge
;

2646 
robj
 *
key
 = 
c
->
¬gv
[1];

2647 
robj
 *
zobj
;

2648 
off£t
 = 0, 
lim™
 = -1;

2649 
¿ng–’
 = 0;

2650 *
»¶yËn
 = 
NULL
;

2651 
mšidx
, 
maxidx
;

2654 ià(
»v”£
) {

2656 
maxidx
 = 2; 
mšidx
 = 3;

2659 
mšidx
 = 2; 
maxidx
 = 3;

2662 ià(
	`z¦P¬£LexRªge
(
c
->
¬gv
[
mšidx
],c->¬gv[
maxidx
],&
¿nge
è!ğ
C_OK
) {

2663 
	`addR•lyE¼Ü
(
c
,"min or max‚ot valid string„ange item");

2669 ià(
c
->
¬gc
 > 4) {

2670 
»maššg
 = 
c
->
¬gc
 - 4;

2671 
pos
 = 4;

2673 
»maššg
) {

2674 ià(
»maššg
 >ğ3 && !
	`¡rÿ£cmp
(
c
->
¬gv
[
pos
]->
±r
,"limit")) {

2675 ià((
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[
pos
+1], &
off£t
, 
NULL
è!ğ
C_OK
) ||

2676 (
	`g‘LÚgFromObjeùOrR•ly
(
c
, c->
¬gv
[
pos
+2], &
lim™
, 
NULL
è!ğ
C_OK
)) ;

2677 
pos
 +ğ3; 
»maššg
 -= 3;

2679 
	`z¦F»eLexRªge
(&
¿nge
);

2680 
	`addR•ly
(
c
,
sh¬ed
.
syÁax”r
);

2687 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
,
key
,
sh¬ed
.
em±ymuÉibulk
)è=ğ
NULL
 ||

2688 
	`checkTy³
(
c
,
zobj
,
OBJ_ZSET
))

2690 
	`z¦F»eLexRªge
(&
¿nge
);

2694 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

2695 *
zl
 = 
zobj
->
±r
;

2696 *
•Œ
, *
¥Œ
;

2697 *
v¡r
;

2698 
vËn
;

2699 
vlÚg
;

2702 ià(
»v”£
) {

2703 
•Œ
 = 
	`zzlLa¡InLexRªge
(
zl
,&
¿nge
);

2705 
•Œ
 = 
	`zzlFœ¡InLexRªge
(
zl
,&
¿nge
);

2709 ià(
•Œ
 =ğ
NULL
) {

2710 
	`addR•ly
(
c
, 
sh¬ed
.
em±ymuÉibulk
);

2711 
	`z¦F»eLexRªge
(&
¿nge
);

2716 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
•Œ
 !ğ
NULL
);

2717 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

2722 
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

2726 
•Œ
 && 
off£t
--) {

2727 ià(
»v”£
) {

2728 
	`zzlP»v
(
zl
,&
•Œ
,&
¥Œ
);

2730 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

2734 
•Œ
 && 
lim™
--) {

2736 ià(
»v”£
) {

2737 ià(!
	`zzlLexV®ueG‹Mš
(
•Œ
,&
¿nge
)) ;

2739 ià(!
	`zzlLexV®ueL‹Max
(
•Œ
,&
¿nge
)) ;

2744 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
	`zli¡G‘
(
•Œ
,&
v¡r
,&
vËn
,&
vlÚg
));

2746 
¿ng–’
++;

2747 ià(
v¡r
 =ğ
NULL
) {

2748 
	`addR•lyBulkLÚgLÚg
(
c
,
vlÚg
);

2750 
	`addR•lyBulkCBufãr
(
c
,
v¡r
,
vËn
);

2754 ià(
»v”£
) {

2755 
	`zzlP»v
(
zl
,&
•Œ
,&
¥Œ
);

2757 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

2760 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

2761 
z£t
 *
zs
 = 
zobj
->
±r
;

2762 
zskli¡
 *
z¦
 = 
zs
->zsl;

2763 
zskli¡Node
 *
Ê
;

2766 ià(
»v”£
) {

2767 
Ê
 = 
	`z¦La¡InLexRªge
(
z¦
,&
¿nge
);

2769 
Ê
 = 
	`z¦Fœ¡InLexRªge
(
z¦
,&
¿nge
);

2773 ià(
Ê
 =ğ
NULL
) {

2774 
	`addR•ly
(
c
, 
sh¬ed
.
em±ymuÉibulk
);

2775 
	`z¦F»eLexRªge
(&
¿nge
);

2782 
»¶yËn
 = 
	`addDeã¼edMuÉiBulkL’gth
(
c
);

2786 
Ê
 && 
off£t
--) {

2787 ià(
»v”£
) {

2788 
Ê
 =†n->
backw¬d
;

2790 
Ê
 =†n->
Ëv–
[0].
fÜw¬d
;

2794 
Ê
 && 
lim™
--) {

2796 ià(
»v”£
) {

2797 ià(!
	`z¦LexV®ueG‹Mš
(
Ê
->
obj
,&
¿nge
)) ;

2799 ià(!
	`z¦LexV®ueL‹Max
(
Ê
->
obj
,&
¿nge
)) ;

2802 
¿ng–’
++;

2803 
	`addR•lyBulk
(
c
,
Ê
->
obj
);

2806 ià(
»v”£
) {

2807 
Ê
 =†n->
backw¬d
;

2809 
Ê
 =†n->
Ëv–
[0].
fÜw¬d
;

2813 
	`£rv”Pªic
("Unknown sorted setƒncoding");

2816 
	`z¦F»eLexRªge
(&
¿nge
);

2817 
	`£tDeã¼edMuÉiBulkL’gth
(
c
, 
»¶yËn
, 
¿ng–’
);

2818 
	}
}

2820 
	$z¿ngebyËxCommªd
(
ş›Á
 *
c
) {

2821 
	`g’”icZ¿ngebyËxCommªd
(
c
,0);

2822 
	}
}

2824 
	$z»v¿ngebyËxCommªd
(
ş›Á
 *
c
) {

2825 
	`g’”icZ¿ngebyËxCommªd
(
c
,1);

2826 
	}
}

2828 
	$zÿrdCommªd
(
ş›Á
 *
c
) {

2829 
robj
 *
key
 = 
c
->
¬gv
[1];

2830 
robj
 *
zobj
;

2832 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
,
key
,
sh¬ed
.
cz”o
)è=ğ
NULL
 ||

2833 
	`checkTy³
(
c
,
zobj
,
OBJ_ZSET
)) ;

2835 
	`addR•lyLÚgLÚg
(
c
,
	`z£tL’gth
(
zobj
));

2836 
	}
}

2838 
	$zscÜeCommªd
(
ş›Á
 *
c
) {

2839 
robj
 *
key
 = 
c
->
¬gv
[1];

2840 
robj
 *
zobj
;

2841 
scÜe
;

2843 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
,
key
,
sh¬ed
.
nuÎbulk
)è=ğ
NULL
 ||

2844 
	`checkTy³
(
c
,
zobj
,
OBJ_ZSET
)) ;

2846 ià(
	`z£tScÜe
(
zobj
,
c
->
¬gv
[2],&
scÜe
è=ğ
C_ERR
) {

2847 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

2849 
	`addR•lyDoubË
(
c
,
scÜe
);

2851 
	}
}

2853 
	$z¿nkG’”icCommªd
(
ş›Á
 *
c
, 
»v”£
) {

2854 
robj
 *
key
 = 
c
->
¬gv
[1];

2855 
robj
 *
–e
 = 
c
->
¬gv
[2];

2856 
robj
 *
zobj
;

2857 
Î’
;

2858 
¿nk
;

2860 ià((
zobj
 = 
	`lookupKeyR—dOrR•ly
(
c
,
key
,
sh¬ed
.
nuÎbulk
)è=ğ
NULL
 ||

2861 
	`checkTy³
(
c
,
zobj
,
OBJ_ZSET
)) ;

2862 
Î’
 = 
	`z£tL’gth
(
zobj
);

2864 
	`£rv”As£¹W™hInfo
(
c
,
–e
,
	`sdsEncodedObjeù
(ele));

2866 ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_ZIPLIST
) {

2867 *
zl
 = 
zobj
->
±r
;

2868 *
•Œ
, *
¥Œ
;

2870 
•Œ
 = 
	`zli¡Index
(
zl
,0);

2871 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
•Œ
 !ğ
NULL
);

2872 
¥Œ
 = 
	`zli¡Next
(
zl
,
•Œ
);

2873 
	`£rv”As£¹W™hInfo
(
c
,
zobj
,
¥Œ
 !ğ
NULL
);

2875 
¿nk
 = 1;

2876 
•Œ
 !ğ
NULL
) {

2877 ià(
	`zli¡Com·»
(
•Œ
,
–e
->
±r
,
	`sd¦’
(ele->ptr)))

2879 
¿nk
++;

2880 
	`zzlNext
(
zl
,&
•Œ
,&
¥Œ
);

2883 ià(
•Œ
 !ğ
NULL
) {

2884 ià(
»v”£
)

2885 
	`addR•lyLÚgLÚg
(
c
,
Î’
-
¿nk
);

2887 
	`addR•lyLÚgLÚg
(
c
,
¿nk
-1);

2889 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

2891 } ià(
zobj
->
’codšg
 =ğ
OBJ_ENCODING_SKIPLIST
) {

2892 
z£t
 *
zs
 = 
zobj
->
±r
;

2893 
zskli¡
 *
z¦
 = 
zs
->zsl;

2894 
diùEÁry
 *
de
;

2895 
scÜe
;

2897 
–e
 = 
c
->
¬gv
[2];

2898 
de
 = 
	`diùFšd
(
zs
->
diù
,
–e
);

2899 ià(
de
 !ğ
NULL
) {

2900 
scÜe
 = *(*)
	`diùG‘V®
(
de
);

2901 
¿nk
 = 
	`z¦G‘Rªk
(
z¦
,
scÜe
,
–e
);

2902 
	`£rv”As£¹W™hInfo
(
c
,
–e
,
¿nk
);

2903 ià(
»v”£
)

2904 
	`addR•lyLÚgLÚg
(
c
,
Î’
-
¿nk
);

2906 
	`addR•lyLÚgLÚg
(
c
,
¿nk
-1);

2908 
	`addR•ly
(
c
,
sh¬ed
.
nuÎbulk
);

2911 
	`£rv”Pªic
("Unknown sorted setƒncoding");

2913 
	}
}

2915 
	$z¿nkCommªd
(
ş›Á
 *
c
) {

2916 
	`z¿nkG’”icCommªd
(
c
, 0);

2917 
	}
}

2919 
	$z»v¿nkCommªd
(
ş›Á
 *
c
) {

2920 
	`z¿nkG’”icCommªd
(
c
, 1);

2921 
	}
}

2923 
	$zsÿnCommªd
(
ş›Á
 *
c
) {

2924 
robj
 *
o
;

2925 
cursÜ
;

2927 ià(
	`·r£SÿnCursÜOrR•ly
(
c
,c->
¬gv
[2],&
cursÜ
è=ğ
C_ERR
) ;

2928 ià((
o
 = 
	`lookupKeyR—dOrR•ly
(
c
,c->
¬gv
[1],
sh¬ed
.
em±ysÿn
)è=ğ
NULL
 ||

2929 
	`checkTy³
(
c
,
o
,
OBJ_ZSET
)) ;

2930 
	`sÿnG’”icCommªd
(
c
,
o
,
cursÜ
);

2931 
	}
}

	@src/testhelp.h

39 #iâdeà
__TESTHELP_H


40 
	#__TESTHELP_H


	)

42 
	g__çed_‹¡s
 = 0;

43 
	g__‹¡_num
 = 0;

44 
	#‹¡_cÚd
(
desü
,
_c
) do { \

45 
__‹¡_num
++; 
	`´štf
("%d - %s: ", __‹¡_num, 
desü
); \

46 if(
_c
è
	`´štf
("PASSED\n"); {´štf("FAILED\n"); 
__çed_‹¡s
++;} \

47 } 0);

	)

48 
	#‹¡_»pÜt
() do { \

49 
	`´štf
("%de¡s, %d…as£d, %d faed\n", 
__‹¡_num
, \

50 
__‹¡_num
-
__çed_‹¡s
, __failed_tests); \

51 ià(
__çed_‹¡s
) { \

52 
	`´štf
("=== WARNING === We have failedests here...\n"); \

53 
	`ex™
(1); \

55 } 0);

	)

	@src/util.c

30 
	~"fmaüos.h
"

31 
	~<¡dlib.h
>

32 
	~<¡dio.h
>

33 
	~<¡ršg.h
>

34 
	~<ùy³.h
>

35 
	~<lim™s.h
>

36 
	~<m©h.h
>

37 
	~<uni¡d.h
>

38 
	~<sys/time.h
>

39 
	~<æßt.h
>

40 
	~<¡dšt.h
>

41 
	~<”ºo.h
>

43 
	~"ut.h
"

44 
	~"sha1.h
"

47 
	$¡ršgm©chËn
(cÚ¡ *
·‰”n
, 
·‰”nL’
,

48 cÚ¡ *
¡ršg
, 
¡ršgL’
, 
noÿ£
)

50 
·‰”nL’
) {

51 
·‰”n
[0]) {

53 
·‰”n
[1] == '*') {

54 
·‰”n
++;

55 
·‰”nL’
--;

57 ià(
·‰”nL’
 == 1)

59 
¡ršgL’
) {

60 ià(
	`¡ršgm©chËn
(
·‰”n
+1, 
·‰”nL’
-1,

61 
¡ršg
, 
¡ršgL’
, 
noÿ£
))

63 
¡ršg
++;

64 
¡ršgL’
--;

69 ià(
¡ršgL’
 == 0)

71 
¡ršg
++;

72 
¡ršgL’
--;

76 
nÙ
, 
m©ch
;

78 
·‰”n
++;

79 
·‰”nL’
--;

80 
nÙ
 = 
·‰”n
[0] == '^';

81 ià(
nÙ
) {

82 
·‰”n
++;

83 
·‰”nL’
--;

85 
m©ch
 = 0;

87 ià(
·‰”n
[0] == '\\') {

88 
·‰”n
++;

89 
·‰”nL’
--;

90 ià(
·‰”n
[0] =ğ
¡ršg
[0])

91 
m©ch
 = 1;

92 } ià(
·‰”n
[0] == ']') {

94 } ià(
·‰”nL’
 == 0) {

95 
·‰”n
--;

96 
·‰”nL’
++;

98 } ià(
·‰”n
[1] =ğ'-' && 
·‰”nL’
 >= 3) {

99 
¡¬t
 = 
·‰”n
[0];

100 
’d
 = 
·‰”n
[2];

101 
c
 = 
¡ršg
[0];

102 ià(
¡¬t
 > 
’d
) {

103 
t
 = 
¡¬t
;

104 
¡¬t
 = 
’d
;

105 
’d
 = 
t
;

107 ià(
noÿ£
) {

108 
¡¬t
 = 
	`tŞow”
(start);

109 
’d
 = 
	`tŞow”
(end);

110 
c
 = 
	`tŞow”
(c);

112 
·‰”n
 += 2;

113 
·‰”nL’
 -= 2;

114 ià(
c
 >ğ
¡¬t
 && c <ğ
’d
)

115 
m©ch
 = 1;

117 ià(!
noÿ£
) {

118 ià(
·‰”n
[0] =ğ
¡ršg
[0])

119 
m©ch
 = 1;

121 ià(
	`tŞow”
(()
·‰”n
[0]è=ğtŞow”(()
¡ršg
[0]))

122 
m©ch
 = 1;

125 
·‰”n
++;

126 
·‰”nL’
--;

128 ià(
nÙ
)

129 
m©ch
 = !match;

130 ià(!
m©ch
)

132 
¡ršg
++;

133 
¡ršgL’
--;

137 ià(
·‰”nL’
 >= 2) {

138 
·‰”n
++;

139 
·‰”nL’
--;

143 ià(!
noÿ£
) {

144 ià(
·‰”n
[0] !ğ
¡ršg
[0])

147 ià(
	`tŞow”
(()
·‰”n
[0]è!ğtŞow”(()
¡ršg
[0]))

150 
¡ršg
++;

151 
¡ršgL’
--;

154 
·‰”n
++;

155 
·‰”nL’
--;

156 ià(
¡ršgL’
 == 0) {

157 *
·‰”n
 == '*') {

158 
·‰”n
++;

159 
·‰”nL’
--;

164 ià(
·‰”nL’
 =ğ0 && 
¡ršgL’
 == 0)

167 
	}
}

169 
	$¡ršgm©ch
(cÚ¡ *
·‰”n
, cÚ¡ *
¡ršg
, 
noÿ£
) {

170  
	`¡ršgm©chËn
(
·‰”n
,
	`¡¾’
Õ©‹º),
¡ršg
,¡¾’(¡ršg),
noÿ£
);

171 
	}
}

180 
	$memtŞl
(cÚ¡ *
p
, *
”r
) {

181 cÚ¡ *
u
;

182 
buf
[128];

183 
mul
;

184 
v®
;

185 
dig™s
;

187 ià(
”r
) *err = 0;

190 
u
 = 
p
;

191 ià(*
u
 == '-') u++;

192 *
u
 && 
	`isdig™
(*u)) u++;

193 ià(*
u
 =ğ'\0' || !
	`¡rÿ£cmp
(u,"b")) {

194 
mul
 = 1;

195 } ià(!
	`¡rÿ£cmp
(
u
,"k")) {

196 
mul
 = 1000;

197 } ià(!
	`¡rÿ£cmp
(
u
,"kb")) {

198 
mul
 = 1024;

199 } ià(!
	`¡rÿ£cmp
(
u
,"m")) {

200 
mul
 = 1000*1000;

201 } ià(!
	`¡rÿ£cmp
(
u
,"mb")) {

202 
mul
 = 1024*1024;

203 } ià(!
	`¡rÿ£cmp
(
u
,"g")) {

204 
mul
 = 1000L*1000*1000;

205 } ià(!
	`¡rÿ£cmp
(
u
,"gb")) {

206 
mul
 = 1024L*1024*1024;

208 ià(
”r
) *err = 1;

214 
dig™s
 = 
u
-
p
;

215 ià(
dig™s
 >ğ(
buf
)) {

216 ià(
”r
) *err = 1;

219 
	`memıy
(
buf
,
p
,
dig™s
);

220 
buf
[
dig™s
] = '\0';

222 *
’d±r
;

223 
”ºo
 = 0;

224 
v®
 = 
	`¡¹Şl
(
buf
,&
’d±r
,10);

225 ià((
v®
 =ğ0 && 
”ºo
 =ğ
EINVAL
è|| *
’d±r
 != '\0') {

226 ià(
”r
) *err = 1;

229  
v®
*
mul
;

230 
	}
}

234 
ušt32_t
 
	$dig™s10
(
ušt64_t
 
v
) {

235 ià(
v
 < 10)  1;

236 ià(
v
 < 100)  2;

237 ià(
v
 < 1000)  3;

238 ià(
v
 < 1000000000000UL) {

239 ià(
v
 < 100000000UL) {

240 ià(
v
 < 1000000) {

241 ià(
v
 < 10000)  4;

242  5 + (
v
 >= 100000);

244  7 + (
v
 >= 10000000UL);

246 ià(
v
 < 10000000000UL) {

247  9 + (
v
 >= 1000000000UL);

249  11 + (
v
 >= 100000000000UL);

251  12 + 
	`dig™s10
(
v
 / 1000000000000UL);

252 
	}
}

255 
ušt32_t
 
	$sdig™s10
(
št64_t
 
v
) {

256 ià(
v
 < 0) {

258 
ušt64_t
 
uv
 = (
v
 !ğ
LLONG_MIN
) ?

259 (
ušt64_t
)-
v
 : ((ušt64_tè
LLONG_MAX
)+1;

260  
	`dig™s10
(
uv
)+1;

262  
	`dig™s10
(
v
);

264 
	}
}

277 
	$Î2¡ršg
(* 
d¡
, 
size_t
 
d¡Ën
, 
sv®ue
) {

278 cÚ¡ 
dig™s
[201] =

284 
Ãg©ive
;

285 
v®ue
;

289 ià(
sv®ue
 < 0) {

290 ià(
sv®ue
 !ğ
LLONG_MIN
) {

291 
v®ue
 = -
sv®ue
;

293 
v®ue
 = ((è
LLONG_MAX
)+1;

295 
Ãg©ive
 = 1;

297 
v®ue
 = 
sv®ue
;

298 
Ãg©ive
 = 0;

302 
ušt32_t
 cÚ¡ 
Ëngth
 = 
	`dig™s10
(
v®ue
)+
Ãg©ive
;

303 ià(
Ëngth
 >ğ
d¡Ën
)  0;

306 
ušt32_t
 
Ãxt
 = 
Ëngth
;

307 
d¡
[
Ãxt
] = '\0';

308 
Ãxt
--;

309 
v®ue
 >= 100) {

310 cÚ¡ 
i
 = (
v®ue
 % 100) * 2;

311 
v®ue
 /= 100;

312 
d¡
[
Ãxt
] = 
dig™s
[
i
 + 1];

313 
d¡
[
Ãxt
 - 1] = 
dig™s
[
i
];

314 
Ãxt
 -= 2;

318 ià(
v®ue
 < 10) {

319 
d¡
[
Ãxt
] = '0' + (
ušt32_t
è
v®ue
;

321 
i
 = (
ušt32_t
è
v®ue
 * 2;

322 
d¡
[
Ãxt
] = 
dig™s
[
i
 + 1];

323 
d¡
[
Ãxt
 - 1] = 
dig™s
[
i
];

327 ià(
Ãg©ive
è
d¡
[0] = '-';

328  
Ëngth
;

329 
	}
}

334 
	$¡ršg2Î
(cÚ¡ *
s
, 
size_t
 
¦’
, *
v®ue
) {

335 cÚ¡ *
p
 = 
s
;

336 
size_t
 
¶’
 = 0;

337 
Ãg©ive
 = 0;

338 
v
;

340 ià(
¶’
 =ğ
¦’
)

344 ià(
¦’
 =ğ1 && 
p
[0] == '0') {

345 ià(
v®ue
 !ğ
NULL
) *value = 0;

349 ià(
p
[0] == '-') {

350 
Ãg©ive
 = 1;

351 
p
++; 
¶’
++;

354 ià(
¶’
 =ğ
¦’
)

359 ià(
p
[0] >= '1' &&…[0] <= '9') {

360 
v
 = 
p
[0]-'0';

361 
p
++; 
¶’
++;

362 } ià(
p
[0] =ğ'0' && 
¦’
 == 1) {

363 *
v®ue
 = 0;

369 
¶’
 < 
¦’
 && 
p
[0] >= '0' &&…[0] <= '9') {

370 ià(
v
 > (
ULLONG_MAX
 / 10))

372 
v
 *= 10;

374 ià(
v
 > (
ULLONG_MAX
 - (
p
[0]-'0')))

376 
v
 +ğ
p
[0]-'0';

378 
p
++; 
¶’
++;

382 ià(
¶’
 < 
¦’
)

385 ià(
Ãg©ive
) {

386 ià(
v
 > (()(-(
LLONG_MIN
+1))+1))

388 ià(
v®ue
 !ğ
NULL
è*v®uğ-
v
;

390 ià(
v
 > 
LLONG_MAX
)

392 ià(
v®ue
 !ğ
NULL
è*v®uğ
v
;

395 
	}
}

400 
	$¡ršg2l
(cÚ¡ *
s
, 
size_t
 
¦’
, *
lv®
) {

401 
Îv®
;

403 ià(!
	`¡ršg2Î
(
s
,
¦’
,&
Îv®
))

406 ià(
Îv®
 < 
LONG_MIN
 ||†lv® > 
LONG_MAX
)

409 *
lv®
 = ()
Îv®
;

411 
	}
}

415 
	$d2¡ršg
(*
buf
, 
size_t
 
Ën
, 
v®ue
) {

416 ià(
	`i¢ª
(
v®ue
)) {

417 
Ën
 = 
	`¢´štf
(
buf
,len,"nan");

418 } ià(
	`isšf
(
v®ue
)) {

419 ià(
v®ue
 < 0)

420 
Ën
 = 
	`¢´štf
(
buf
,len,"-inf");

422 
Ën
 = 
	`¢´štf
(
buf
,len,"inf");

423 } ià(
v®ue
 == 0) {

425 ià(1.0/
v®ue
 < 0)

426 
Ën
 = 
	`¢´štf
(
buf
,len,"-0");

428 
Ën
 = 
	`¢´štf
(
buf
,len,"0");

430 #ià(
DBL_MANT_DIG
 >ğ52è&& (
LLONG_MAX
 == 0x7fffffffffffffffLL)

440 
mš
 = -4503599627370495;

441 
max
 = 4503599627370496;

442 ià(
v®ue
 > 
mš
 && v®u< 
max
 && value == (()(()value)))

443 
Ën
 = 
	`Î2¡ršg
(
buf
,Ën,()
v®ue
);

446 
Ën
 = 
	`¢´štf
(
buf
,Ën,"%.17g",
v®ue
);

449  
Ën
;

450 
	}
}

456 
	$g‘RªdomHexCh¬s
(*
p
, 
Ën
) {

457 *
ch¬£t
 = "0123456789abcdef";

458 
j
;

461 
£ed_š™Ÿlized
 = 0;

462 
£ed
[20];

463 
ušt64_t
 
couÁ”
 = 0;

465 ià(!
£ed_š™Ÿlized
) {

470 
FILE
 *
å
 = 
	`fİ’
("/dev/urandom","r");

471 ià(
å
 && 
	`ä—d
(
£ed
,(seed),1,fp) == 1)

472 
£ed_š™Ÿlized
 = 1;

473 ià(
å
è
	`fşo£
(fp);

476 ià(
£ed_š™Ÿlized
) {

477 
Ën
) {

478 
dige¡
[20];

479 
SHA1_CTX
 
ùx
;

480 
cİyËn
 = 
Ën
 > 20 ? 20 :†en;

482 
	`SHA1In™
(&
ùx
);

483 
	`SHA1Upd©e
(&
ùx
, 
£ed
, (seed));

484 
	`SHA1Upd©e
(&
ùx
, (*)&
couÁ”
,(counter));

485 
	`SHA1Fš®
(
dige¡
, &
ùx
);

486 
couÁ”
++;

488 
	`memıy
(
p
,
dige¡
,
cİyËn
);

490 
j
 = 0; j < 
cİyËn
; j++è
p
[j] = 
ch¬£t
[p[j] & 0x0F];

491 
Ën
 -ğ
cİyËn
;

492 
p
 +ğ
cİyËn
;

498 *
x
 = 
p
;

499 
l
 = 
Ën
;

500 
timev®
 
tv
;

501 
pid_t
 
pid
 = 
	`g‘pid
();

504 
	`g‘timeofday
(&
tv
,
NULL
);

505 ià(
l
 >ğ(
tv
.
tv_u£c
)) {

506 
	`memıy
(
x
,&
tv
.
tv_u£c
,(tv.tv_usec));

507 
l
 -ğ(
tv
.
tv_u£c
);

508 
x
 +ğ(
tv
.
tv_u£c
);

510 ià(
l
 >ğ(
tv
.
tv_£c
)) {

511 
	`memıy
(
x
,&
tv
.
tv_£c
,(tv.tv_sec));

512 
l
 -ğ(
tv
.
tv_£c
);

513 
x
 +ğ(
tv
.
tv_£c
);

515 ià(
l
 >ğ(
pid
)) {

516 
	`memıy
(
x
,&
pid
,(pid));

517 
l
 -ğ(
pid
);

518 
x
 +ğ(
pid
);

522 
j
 = 0; j < 
Ën
; j++) {

523 
p
[
j
] ^ğ
	`¿nd
();

524 
p
[
j
] = 
ch¬£t
[p[j] & 0x0F];

527 
	}
}

536 
sds
 
	$g‘AbsŞu‹P©h
(*
f’ame
) {

537 
cwd
[1024];

538 
sds
 
ab¥©h
;

539 
sds
 
»Í©h
 = 
	`sd¢ew
(
f’ame
);

541 
»Í©h
 = 
	`sd¡rim
(relpath," \r\n\t");

542 ià(
»Í©h
[0] == '/') „elpath;

545 ià(
	`g‘cwd
(
cwd
,(cwd)è=ğ
NULL
) {

546 
	`sdsä“
(
»Í©h
);

547  
NULL
;

549 
ab¥©h
 = 
	`sd¢ew
(
cwd
);

550 ià(
	`sd¦’
(
ab¥©h
) &&‡bspath[sdslen(abspath)-1] != '/')

551 
ab¥©h
 = 
	`sdsÿt
(abspath,"/");

559 
	`sd¦’
(
»Í©h
) >= 3 &&

560 
»Í©h
[0] == '.' &&„elpath[1] == '.' &&„elpath[2] == '/')

562 
	`sd¤ªge
(
»Í©h
,3,-1);

563 ià(
	`sd¦’
(
ab¥©h
) > 1) {

564 *
p
 = 
ab¥©h
 + 
	`sd¦’
(abspath)-2;

565 
ŒimËn
 = 1;

567 *
p
 != '/') {

568 
p
--;

569 
ŒimËn
++;

571 
	`sd¤ªge
(
ab¥©h
,0,-(
ŒimËn
+1));

576 
ab¥©h
 = 
	`sdsÿtsds
×b¥©h,
»Í©h
);

577 
	`sdsä“
(
»Í©h
);

578  
ab¥©h
;

579 
	}
}

585 
	$·thIsBa£Name
(*
·th
) {

586  
	`¡rchr
(
·th
,'/'è=ğ
NULL
 && strchr(path,'\\') == NULL;

587 
	}
}

589 #ifdeà
REDIS_TEST


590 
	~<as£¹.h
>

592 
	$‹¡_¡ršg2Î
() {

593 
buf
[32];

594 
v
;

597 
	`¡rıy
(
buf
,"+1");

598 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

601 
	`¡rıy
(
buf
," 1");

602 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

605 
	`¡rıy
(
buf
,"1 ");

606 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

609 
	`¡rıy
(
buf
,"01");

610 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

612 
	`¡rıy
(
buf
,"-1");

613 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

614 
	`as£¹
(
v
 == -1);

616 
	`¡rıy
(
buf
,"0");

617 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

618 
	`as£¹
(
v
 == 0);

620 
	`¡rıy
(
buf
,"1");

621 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

622 
	`as£¹
(
v
 == 1);

624 
	`¡rıy
(
buf
,"99");

625 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

626 
	`as£¹
(
v
 == 99);

628 
	`¡rıy
(
buf
,"-99");

629 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

630 
	`as£¹
(
v
 == -99);

632 
	`¡rıy
(
buf
,"-9223372036854775808");

633 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

634 
	`as£¹
(
v
 =ğ
LLONG_MIN
);

636 
	`¡rıy
(
buf
,"-9223372036854775809");

637 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

639 
	`¡rıy
(
buf
,"9223372036854775807");

640 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

641 
	`as£¹
(
v
 =ğ
LLONG_MAX
);

643 
	`¡rıy
(
buf
,"9223372036854775808");

644 
	`as£¹
(
	`¡ršg2Î
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

645 
	}
}

647 
	$‹¡_¡ršg2l
() {

648 
buf
[32];

649 
v
;

652 
	`¡rıy
(
buf
,"+1");

653 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

656 
	`¡rıy
(
buf
,"01");

657 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

659 
	`¡rıy
(
buf
,"-1");

660 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

661 
	`as£¹
(
v
 == -1);

663 
	`¡rıy
(
buf
,"0");

664 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

665 
	`as£¹
(
v
 == 0);

667 
	`¡rıy
(
buf
,"1");

668 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

669 
	`as£¹
(
v
 == 1);

671 
	`¡rıy
(
buf
,"99");

672 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

673 
	`as£¹
(
v
 == 99);

675 
	`¡rıy
(
buf
,"-99");

676 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

677 
	`as£¹
(
v
 == -99);

679 #ià
LONG_MAX
 !ğ
LLONG_MAX


680 
	`¡rıy
(
buf
,"-2147483648");

681 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

682 
	`as£¹
(
v
 =ğ
LONG_MIN
);

684 
	`¡rıy
(
buf
,"-2147483649");

685 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

687 
	`¡rıy
(
buf
,"2147483647");

688 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 1);

689 
	`as£¹
(
v
 =ğ
LONG_MAX
);

691 
	`¡rıy
(
buf
,"2147483648");

692 
	`as£¹
(
	`¡ršg2l
(
buf
,
	`¡¾’
(buf),&
v
) == 0);

694 
	}
}

696 
	$‹¡_Î2¡ršg
() {

697 
buf
[32];

698 
v
;

699 
sz
;

701 
v
 = 0;

702 
sz
 = 
	`Î2¡ršg
(
buf
,  buf, 
v
);

703 
	`as£¹
(
sz
 == 1);

704 
	`as£¹
(!
	`¡rcmp
(
buf
, "0"));

706 
v
 = -1;

707 
sz
 = 
	`Î2¡ršg
(
buf
,  buf, 
v
);

708 
	`as£¹
(
sz
 == 2);

709 
	`as£¹
(!
	`¡rcmp
(
buf
, "-1"));

711 
v
 = 99;

712 
sz
 = 
	`Î2¡ršg
(
buf
,  buf, 
v
);

713 
	`as£¹
(
sz
 == 2);

714 
	`as£¹
(!
	`¡rcmp
(
buf
, "99"));

716 
v
 = -99;

717 
sz
 = 
	`Î2¡ršg
(
buf
,  buf, 
v
);

718 
	`as£¹
(
sz
 == 3);

719 
	`as£¹
(!
	`¡rcmp
(
buf
, "-99"));

721 
v
 = -2147483648;

722 
sz
 = 
	`Î2¡ršg
(
buf
,  buf, 
v
);

723 
	`as£¹
(
sz
 == 11);

724 
	`as£¹
(!
	`¡rcmp
(
buf
, "-2147483648"));

726 
v
 = 
LLONG_MIN
;

727 
sz
 = 
	`Î2¡ršg
(
buf
,  buf, 
v
);

728 
	`as£¹
(
sz
 == 20);

729 
	`as£¹
(!
	`¡rcmp
(
buf
, "-9223372036854775808"));

731 
v
 = 
LLONG_MAX
;

732 
sz
 = 
	`Î2¡ršg
(
buf
,  buf, 
v
);

733 
	`as£¹
(
sz
 == 19);

734 
	`as£¹
(!
	`¡rcmp
(
buf
, "9223372036854775807"));

735 
	}
}

737 
	#UNUSED
(
x
è()(x)

	)

738 
	$utTe¡
(
¬gc
, **
¬gv
) {

739 
	`UNUSED
(
¬gc
);

740 
	`UNUSED
(
¬gv
);

742 
	`‹¡_¡ršg2Î
();

743 
	`‹¡_¡ršg2l
();

744 
	`‹¡_Î2¡ršg
();

746 
	}
}

	@src/util.h

30 #iâdeà
__REDIS_UTIL_H


31 
	#__REDIS_UTIL_H


	)

33 
	~<¡dšt.h
>

34 
	~"sds.h
"

36 
¡ršgm©chËn
(cÚ¡ *
p
, 
¶’
, cÚ¡ *
s
, 
¦’
, 
noÿ£
);

37 
¡ršgm©ch
(cÚ¡ *
p
, cÚ¡ *
s
, 
noÿ£
);

38 
memtŞl
(cÚ¡ *
p
, *
”r
);

39 
ušt32_t
 
dig™s10
(
ušt64_t
 
v
);

40 
ušt32_t
 
sdig™s10
(
št64_t
 
v
);

41 
Î2¡ršg
(*
s
, 
size_t
 
Ën
, 
v®ue
);

42 
¡ršg2Î
(cÚ¡ *
s
, 
size_t
 
¦’
, *
v®ue
);

43 
¡ršg2l
(cÚ¡ *
s
, 
size_t
 
¦’
, *
v®ue
);

44 
d2¡ršg
(*
buf
, 
size_t
 
Ën
, 
v®ue
);

45 
sds
 
g‘AbsŞu‹P©h
(*
f’ame
);

46 
·thIsBa£Name
(*
·th
);

48 #ifdeà
REDIS_TEST


49 
utTe¡
(
¬gc
, **
¬gv
);

	@src/version.h

1 
	#REDIS_VERSION
 "3.2.703_NVML"

	)

	@src/ziplist.c

104 
	~<¡dio.h
>

105 
	~<¡dlib.h
>

106 
	~<¡ršg.h
>

107 
	~<¡dšt.h
>

108 
	~<lim™s.h
>

109 
	~"zm®loc.h
"

110 
	~"ut.h
"

111 
	~"zli¡.h
"

112 
	~"’dŸncÚv.h
"

113 
	~"»di§s£¹.h
"

115 
	#ZIP_END
 255

	)

116 
	#ZIP_BIGLEN
 254

	)

119 
	#ZIP_STR_MASK
 0xc0

	)

120 
	#ZIP_INT_MASK
 0x30

	)

121 
	#ZIP_STR_06B
 (0 << 6)

	)

122 
	#ZIP_STR_14B
 (1 << 6)

	)

123 
	#ZIP_STR_32B
 (2 << 6)

	)

124 
	#ZIP_INT_16B
 (0xc0 | 0<<4)

	)

125 
	#ZIP_INT_32B
 (0xc0 | 1<<4)

	)

126 
	#ZIP_INT_64B
 (0xc0 | 2<<4)

	)

127 
	#ZIP_INT_24B
 (0xc0 | 3<<4)

	)

128 
	#ZIP_INT_8B
 0xã

	)

130 
	#ZIP_INT_IMM_MASK
 0x0f

	)

131 
	#ZIP_INT_IMM_MIN
 0xf1

	)

132 
	#ZIP_INT_IMM_MAX
 0xfd

	)

133 
	#ZIP_INT_IMM_VAL
(
v
è(v & 
ZIP_INT_IMM_MASK
)

	)

135 
	#INT24_MAX
 0x7fffff

	)

136 
	#INT24_MIN
 (-
INT24_MAX
 - 1)

	)

139 
	#ZIP_IS_STR
(
’c
è((Óncè& 
ZIP_STR_MASK
è< ZIP_STR_MASK)

	)

142 
	#ZIPLIST_BYTES
(
zl
è(*((
ušt32_t
*)(zl)))

	)

143 
	#ZIPLIST_TAIL_OFFSET
(
zl
è(*((
ušt32_t
*)((zl)+(ušt32_t))))

	)

144 
	#ZIPLIST_LENGTH
(
zl
è(*((
ušt16_t
*)((zl)+(
ušt32_t
)*2)))

	)

145 
	#ZIPLIST_HEADER_SIZE
 ((
ušt32_t
)*2+(
ušt16_t
))

	)

146 
	#ZIPLIST_END_SIZE
 ((
ušt8_t
))

	)

147 
	#ZIPLIST_ENTRY_HEAD
(
zl
è((zl)+
ZIPLIST_HEADER_SIZE
)

	)

148 
	#ZIPLIST_ENTRY_TAIL
(
zl
è((zl)+
	`šŒev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(zl)))

	)

149 
	#ZIPLIST_ENTRY_END
(
zl
è((zl)+
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(zl))-1)

	)

153 
	#ZIPLIST_INCR_LENGTH
(
zl
,
šü
) { \

154 ià(
	`ZIPLIST_LENGTH
(
zl
è< 
UINT16_MAX
) \

155 
	`ZIPLIST_LENGTH
(
zl
èğ
	`šŒev16ifbe
(šŒev16ifbe(ZIPLIST_LENGTH(zl))+
šü
); \

156 }

	)

158 
	szËÁry
 {

159 
	m´ev¿wËnsize
, 
	m´ev¿wËn
;

160 
	mËnsize
, 
	mËn
;

161 
	mh—d”size
;

162 
	m’codšg
;

163 *
	mp
;

164 } 
	tzËÁry
;

166 
	#ZIPLIST_ENTRY_ZERO
(
zË
) { \

167 (
zË
)->
´ev¿wËnsize
 = (zË)->
´ev¿wËn
 = 0; \

168 (
zË
)->
Ënsize
 = (zË)->
Ën
 = (zË)->
h—d”size
 = 0; \

169 (
zË
)->
’codšg
 = 0; \

170 (
zË
)->
p
 = 
NULL
; \

171 }

	)

175 
	#ZIP_ENTRY_ENCODING
(
±r
, 
’codšg
) do { \

176 (
’codšg
èğ(
±r
[0]); \

177 ià((
’codšg
è< 
ZIP_STR_MASK
) (encoding) &= ZIP_STR_MASK; \

178 } 0)

	)

180 
zli¡R•r
(*
zl
);

183 
	$zIÁSize
(
’codšg
) {

184 
’codšg
) {

185 
ZIP_INT_8B
:  1;

186 
ZIP_INT_16B
:  2;

187 
ZIP_INT_24B
:  3;

188 
ZIP_INT_32B
:  4;

189 
ZIP_INT_64B
:  8;

192 
	`as£¹
(
NULL
);

194 
	}
}

198 
	$zEncodeL’gth
(*
p
, 
’codšg
, 
¿wËn
) {

199 
Ën
 = 1, 
buf
[5];

201 ià(
	`ZIP_IS_STR
(
’codšg
)) {

204 ià(
¿wËn
 <= 0x3f) {

205 ià(!
p
è 
Ën
;

206 
buf
[0] = 
ZIP_STR_06B
 | 
¿wËn
;

207 } ià(
¿wËn
 <= 0x3fff) {

208 
Ën
 += 1;

209 ià(!
p
è 
Ën
;

210 
buf
[0] = 
ZIP_STR_14B
 | ((
¿wËn
 >> 8) & 0x3f);

211 
buf
[1] = 
¿wËn
 & 0xff;

213 
Ën
 += 4;

214 ià(!
p
è 
Ën
;

215 
buf
[0] = 
ZIP_STR_32B
;

216 
buf
[1] = (
¿wËn
 >> 24) & 0xff;

217 
buf
[2] = (
¿wËn
 >> 16) & 0xff;

218 
buf
[3] = (
¿wËn
 >> 8) & 0xff;

219 
buf
[4] = 
¿wËn
 & 0xff;

223 ià(!
p
è 
Ën
;

224 
buf
[0] = 
’codšg
;

228 
	`memıy
(
p
,
buf
,
Ën
);

229  
Ën
;

230 
	}
}

236 
	#ZIP_DECODE_LENGTH
(
±r
, 
’codšg
, 
Ënsize
, 
Ën
) do { \

237 
	`ZIP_ENTRY_ENCODING
((
±r
), (
’codšg
)); \

238 ià((
’codšg
è< 
ZIP_STR_MASK
) { \

239 ià((
’codšg
è=ğ
ZIP_STR_06B
) { \

240 (
Ënsize
) = 1; \

241 (
Ën
èğ(
±r
)[0] & 0x3f; \

242 } ià((
’codšg
è=ğ
ZIP_STR_14B
) { \

243 (
Ënsize
) = 2; \

244 (
Ën
èğ(((
±r
)[0] & 0x3f) << 8) | (ptr)[1]; \

245 } ià(
’codšg
 =ğ
ZIP_STR_32B
) { \

246 (
Ënsize
) = 5; \

247 (
Ën
èğ((
±r
)[1] << 24) | \

248 ((
±r
)[2] << 16) | \

249 ((
±r
)[3] << 8) | \

250 ((
±r
)[4]); \

252 
	`as£¹
(
NULL
); \

255 (
Ënsize
) = 1; \

256 (
Ën
èğ
	`zIÁSize
(
’codšg
); \

258 } 0);

	)

262 
	$zP»vEncodeL’gth
(*
p
, 
Ën
) {

263 ià(
p
 =ğ
NULL
) {

264  (
Ën
 < 
ZIP_BIGLEN
) ? 1 : (len)+1;

266 ià(
Ën
 < 
ZIP_BIGLEN
) {

267 
p
[0] = 
Ën
;

270 
p
[0] = 
ZIP_BIGLEN
;

271 
	`memıy
(
p
+1,&
Ën
,(len));

272 
	`mem»v32ifbe
(
p
+1);

273  1+(
Ën
);

276 
	}
}

280 
	$zP»vEncodeL’gthFÜûL¬ge
(*
p
, 
Ën
) {

281 ià(
p
 =ğ
NULL
) ;

282 
p
[0] = 
ZIP_BIGLEN
;

283 
	`memıy
(
p
+1,&
Ën
,(len));

284 
	`mem»v32ifbe
(
p
+1);

285 
	}
}

289 
	#ZIP_DECODE_PREVLENSIZE
(
±r
, 
´evËnsize
) do { \

290 ià((
±r
)[0] < 
ZIP_BIGLEN
) { \

291 (
´evËnsize
) = 1; \

293 (
´evËnsize
) = 5; \

295 } 0);

	)

299 
	#ZIP_DECODE_PREVLEN
(
±r
, 
´evËnsize
, 
´evËn
) do { \

300 
	`ZIP_DECODE_PREVLENSIZE
(
±r
, 
´evËnsize
); \

301 ià((
´evËnsize
) == 1) { \

302 (
´evËn
èğ(
±r
)[0]; \

303 } ià((
´evËnsize
) == 5) { \

304 
	`as£¹
(((
´evËnsize
)) == 4); \

305 
	`memıy
(&(
´evËn
), ((*)(
±r
)) + 1, 4); \

306 
	`mem»v32ifbe
(&
´evËn
); \

308 } 0);

	)

312 
	$zP»vL’By‹Diff
(*
p
, 
Ën
) {

313 
´evËnsize
;

314 
	`ZIP_DECODE_PREVLENSIZE
(
p
, 
´evËnsize
);

315  
	`zP»vEncodeL’gth
(
NULL
, 
Ën
è- 
´evËnsize
;

316 
	}
}

319 
	$zRawEÁryL’gth
(*
p
) {

320 
´evËnsize
, 
’codšg
, 
Ënsize
, 
Ën
;

321 
	`ZIP_DECODE_PREVLENSIZE
(
p
, 
´evËnsize
);

322 
	`ZIP_DECODE_LENGTH
(
p
 + 
´evËnsize
, 
’codšg
, 
Ënsize
, 
Ën
);

323  
´evËnsize
 + 
Ënsize
 + 
Ën
;

324 
	}
}

328 
	$zTryEncodšg
(*
’Œy
, 
’ŒyËn
, *
v
, *
’codšg
) {

329 
v®ue
;

331 ià(
’ŒyËn
 >= 32 ||ƒntrylen == 0)  0;

332 ià(
	`¡ršg2Î
((*)
’Œy
,
’ŒyËn
,&
v®ue
)) {

335 ià(
v®ue
 >= 0 && value <= 12) {

336 *
’codšg
 = 
ZIP_INT_IMM_MIN
+
v®ue
;

337 } ià(
v®ue
 >ğ
INT8_MIN
 && v®u<ğ
INT8_MAX
) {

338 *
’codšg
 = 
ZIP_INT_8B
;

339 } ià(
v®ue
 >ğ
INT16_MIN
 && v®u<ğ
INT16_MAX
) {

340 *
’codšg
 = 
ZIP_INT_16B
;

341 } ià(
v®ue
 >ğ
INT24_MIN
 && v®u<ğ
INT24_MAX
) {

342 *
’codšg
 = 
ZIP_INT_24B
;

343 } ià(
v®ue
 >ğ
INT32_MIN
 && v®u<ğ
INT32_MAX
) {

344 *
’codšg
 = 
ZIP_INT_32B
;

346 *
’codšg
 = 
ZIP_INT_64B
;

348 *
v
 = 
v®ue
;

352 
	}
}

355 
	$zSaveIÁeg”
(*
p
, 
št64_t
 
v®ue
, 
’codšg
) {

356 
št16_t
 
i16
;

357 
št32_t
 
i32
;

358 
št64_t
 
i64
;

359 ià(
’codšg
 =ğ
ZIP_INT_8B
) {

360 ((
št8_t
*)
p
)[0] = (št8_t)
v®ue
;

361 } ià(
’codšg
 =ğ
ZIP_INT_16B
) {

362 
i16
 = 
v®ue
;

363 
	`memıy
(
p
,&
i16
,(i16));

364 
	`mem»v16ifbe
(
p
);

365 } ià(
’codšg
 =ğ
ZIP_INT_24B
) {

366 
i32
 = 
v®ue
<<8;

367 
	`mem»v32ifbe
(&
i32
);

368 
	`memıy
(
p
,((
ušt8_t
*)&
i32
)+1,(i32)-(uint8_t));

369 } ià(
’codšg
 =ğ
ZIP_INT_32B
) {

370 
i32
 = 
v®ue
;

371 
	`memıy
(
p
,&
i32
,(i32));

372 
	`mem»v32ifbe
(
p
);

373 } ià(
’codšg
 =ğ
ZIP_INT_64B
) {

374 
i64
 = 
v®ue
;

375 
	`memıy
(
p
,&
i64
,(i64));

376 
	`mem»v64ifbe
(
p
);

377 } ià(
’codšg
 >ğ
ZIP_INT_IMM_MIN
 &&ƒncodšg <ğ
ZIP_INT_IMM_MAX
) {

380 
	`as£¹
(
NULL
);

382 
	}
}

385 
št64_t
 
	$zLßdIÁeg”
(*
p
, 
’codšg
) {

386 
št16_t
 
i16
;

387 
št32_t
 
i32
;

388 
št64_t
 
i64
, 
»t
 = 0;

389 ià(
’codšg
 =ğ
ZIP_INT_8B
) {

390 
»t
 = ((
št8_t
*)
p
)[0];

391 } ià(
’codšg
 =ğ
ZIP_INT_16B
) {

392 
	`memıy
(&
i16
,
p
,(i16));

393 
	`mem»v16ifbe
(&
i16
);

394 
»t
 = 
i16
;

395 } ià(
’codšg
 =ğ
ZIP_INT_32B
) {

396 
	`memıy
(&
i32
,
p
,(i32));

397 
	`mem»v32ifbe
(&
i32
);

398 
»t
 = 
i32
;

399 } ià(
’codšg
 =ğ
ZIP_INT_24B
) {

400 
i32
 = 0;

401 
	`memıy
(((
ušt8_t
*)&
i32
)+1,
p
,(i32)-(uint8_t));

402 
	`mem»v32ifbe
(&
i32
);

403 
»t
 = 
i32
>>8;

404 } ià(
’codšg
 =ğ
ZIP_INT_64B
) {

405 
	`memıy
(&
i64
,
p
,(i64));

406 
	`mem»v64ifbe
(&
i64
);

407 
»t
 = 
i64
;

408 } ià(
’codšg
 >ğ
ZIP_INT_IMM_MIN
 &&ƒncodšg <ğ
ZIP_INT_IMM_MAX
) {

409 
»t
 = (
’codšg
 & 
ZIP_INT_IMM_MASK
)-1;

411 
	`as£¹
(
NULL
);

413  
»t
;

414 
	}
}

417 
	$zEÁry
(*
p
, 
zËÁry
 *
e
) {

419 
	`ZIP_DECODE_PREVLEN
(
p
, 
e
->
´ev¿wËnsize
,ƒ->
´ev¿wËn
);

420 
	`ZIP_DECODE_LENGTH
(
p
 + 
e
->
´ev¿wËnsize
,ƒ->
’codšg
,ƒ->
Ënsize
,ƒ->
Ën
);

421 
e
->
h—d”size
 =ƒ->
´ev¿wËnsize
 +ƒ->
Ënsize
;

422 
e
->
p
 =…;

423 
	}
}

426 *
	$zli¡New
() {

427 
by‹s
 = 
ZIPLIST_HEADER_SIZE
+1;

428 *
zl
 = 
	`zm®loc
(
by‹s
);

429 
	`ZIPLIST_BYTES
(
zl
èğ
	`šŒev32ifbe
(
by‹s
);

430 
	`ZIPLIST_TAIL_OFFSET
(
zl
èğ
	`šŒev32ifbe
(
ZIPLIST_HEADER_SIZE
);

431 
	`ZIPLIST_LENGTH
(
zl
) = 0;

432 
zl
[
by‹s
-1] = 
ZIP_END
;

433  
zl
;

434 
	}
}

437 *
	$zli¡Resize
(*
zl
, 
Ën
) {

438 
zl
 = 
	`z»®loc
(zl,
Ën
);

439 
	`ZIPLIST_BYTES
(
zl
èğ
	`šŒev32ifbe
(
Ën
);

440 
zl
[
Ën
-1] = 
ZIP_END
;

441  
zl
;

442 
	}
}

464 *
	$__zli¡CasÿdeUpd©e
(*
zl
, *
p
) {

465 
size_t
 
cu¾’
 = 
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(
zl
)), 
¿wËn
, 
¿wËnsize
;

466 
size_t
 
off£t
, 
noff£t
, 
exŒa
;

467 *
Å
;

468 
zËÁry
 
cur
, 
Ãxt
;

470 
p
[0] !ğ
ZIP_END
) {

471 
	`zEÁry
(
p
, &
cur
);

472 
¿wËn
 = 
cur
.
h—d”size
 + cur.
Ën
;

473 
¿wËnsize
 = 
	`zP»vEncodeL’gth
(
NULL
,
¿wËn
);

476 ià(
p
[
¿wËn
] =ğ
ZIP_END
) ;

477 
	`zEÁry
(
p
+
¿wËn
, &
Ãxt
);

480 ià(
Ãxt
.
´ev¿wËn
 =ğ
¿wËn
) ;

482 ià(
Ãxt
.
´ev¿wËnsize
 < 
¿wËnsize
) {

485 
off£t
 = 
p
-
zl
;

486 
exŒa
 = 
¿wËnsize
-
Ãxt
.
´ev¿wËnsize
;

487 
zl
 = 
	`zli¡Resize
(zl,
cu¾’
+
exŒa
);

488 
p
 = 
zl
+
off£t
;

491 
Å
 = 
p
+
¿wËn
;

492 
noff£t
 = 
Å
-
zl
;

495 ià((
zl
+
	`šŒev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(zl))è!ğ
Å
) {

496 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

497 
	`šŒev32ifbe
(šŒev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))+
exŒa
);

501 
	`memmove
(
Å
+
¿wËnsize
,

502 
Å
+
Ãxt
.
´ev¿wËnsize
,

503 
cu¾’
-
noff£t
-
Ãxt
.
´ev¿wËnsize
-1);

504 
	`zP»vEncodeL’gth
(
Å
,
¿wËn
);

507 
p
 +ğ
¿wËn
;

508 
cu¾’
 +ğ
exŒa
;

510 ià(
Ãxt
.
´ev¿wËnsize
 > 
¿wËnsize
) {

513 
	`zP»vEncodeL’gthFÜûL¬ge
(
p
+
¿wËn
,rawlen);

515 
	`zP»vEncodeL’gth
(
p
+
¿wËn
,rawlen);

522  
zl
;

523 
	}
}

526 *
	$__zli¡D–‘e
(*
zl
, *
p
, 
num
) {

527 
i
, 
tÙËn
, 
d–‘ed
 = 0;

528 
size_t
 
off£t
;

529 
Ãxtdiff
 = 0;

530 
zËÁry
 
fœ¡
, 

;

532 
	`zEÁry
(
p
, &
fœ¡
);

533 
i
 = 0; 
p
[0] !ğ
ZIP_END
 && i < 
num
; i++) {

534 
p
 +ğ
	`zRawEÁryL’gth
(p);

535 
d–‘ed
++;

538 
tÙËn
 = 
p
-
fœ¡
.p;

539 ià(
tÙËn
 > 0) {

540 ià(
p
[0] !ğ
ZIP_END
) {

545 
Ãxtdiff
 = 
	`zP»vL’By‹Diff
(
p
,
fœ¡
.
´ev¿wËn
);

546 
p
 -ğ
Ãxtdiff
;

547 
	`zP»vEncodeL’gth
(
p
,
fœ¡
.
´ev¿wËn
);

550 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

551 
	`šŒev32ifbe
(šŒev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))-
tÙËn
);

556 
	`zEÁry
(
p
, &

);

557 ià(
p
[

.
h—d”size
+.
Ën
] !ğ
ZIP_END
) {

558 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

559 
	`šŒev32ifbe
(šŒev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))+
Ãxtdiff
);

563 
	`memmove
(
fœ¡
.
p
,p,

564 
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(
zl
))-(
p
-zl)-1);

567 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

568 
	`šŒev32ifbe
((
fœ¡
.
p
-
zl
)-fœ¡.
´ev¿wËn
);

572 
off£t
 = 
fœ¡
.
p
-
zl
;

573 
zl
 = 
	`zli¡Resize
(zl, 
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(zl))-
tÙËn
+
Ãxtdiff
);

574 
	`ZIPLIST_INCR_LENGTH
(
zl
,-
d–‘ed
);

575 
p
 = 
zl
+
off£t
;

579 ià(
Ãxtdiff
 != 0)

580 
zl
 = 
	`__zli¡CasÿdeUpd©e
(zl,
p
);

582  
zl
;

583 
	}
}

586 *
	$__zli¡In£¹
(*
zl
, *
p
, *
s
, 
¦’
) {

587 
size_t
 
cu¾’
 = 
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(
zl
)), 
»qËn
;

588 
´evËnsize
, 
´evËn
 = 0;

589 
size_t
 
off£t
;

590 
Ãxtdiff
 = 0;

591 
’codšg
 = 0;

592 
v®ue
 = 123456789;

595 
zËÁry
 

;

598 ià(
p
[0] !ğ
ZIP_END
) {

599 
	`ZIP_DECODE_PREVLEN
(
p
, 
´evËnsize
, 
´evËn
);

601 *
±a
 = 
	`ZIPLIST_ENTRY_TAIL
(
zl
);

602 ià(
±a
[0] !ğ
ZIP_END
) {

603 
´evËn
 = 
	`zRawEÁryL’gth
(
±a
);

608 ià(
	`zTryEncodšg
(
s
,
¦’
,&
v®ue
,&
’codšg
)) {

610 
»qËn
 = 
	`zIÁSize
(
’codšg
);

614 
»qËn
 = 
¦’
;

618 
»qËn
 +ğ
	`zP»vEncodeL’gth
(
NULL
,
´evËn
);

619 
»qËn
 +ğ
	`zEncodeL’gth
(
NULL
,
’codšg
,
¦’
);

624 
fÜûÏrge
 = 0;

625 
Ãxtdiff
 = (
p
[0] !ğ
ZIP_END
è? 
	`zP»vL’By‹Diff
Õ,
»qËn
) : 0;

626 ià(
Ãxtdiff
 =ğ-4 && 
»qËn
 < 4) {

627 
Ãxtdiff
 = 0;

628 
fÜûÏrge
 = 1;

632 
off£t
 = 
p
-
zl
;

633 
zl
 = 
	`zli¡Resize
(zl,
cu¾’
+
»qËn
+
Ãxtdiff
);

634 
p
 = 
zl
+
off£t
;

637 ià(
p
[0] !ğ
ZIP_END
) {

639 
	`memmove
(
p
+
»qËn
,p-
Ãxtdiff
,
cu¾’
-
off£t
-1+nextdiff);

642 ià(
fÜûÏrge
)

643 
	`zP»vEncodeL’gthFÜûL¬ge
(
p
+
»qËn
,reqlen);

645 
	`zP»vEncodeL’gth
(
p
+
»qËn
,reqlen);

648 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

649 
	`šŒev32ifbe
(šŒev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))+
»qËn
);

654 
	`zEÁry
(
p
+
»qËn
, &

);

655 ià(
p
[
»qËn
+

.
h—d”size
+.
Ën
] !ğ
ZIP_END
) {

656 
	`ZIPLIST_TAIL_OFFSET
(
zl
) =

657 
	`šŒev32ifbe
(šŒev32ifbe(
	`ZIPLIST_TAIL_OFFSET
(
zl
))+
Ãxtdiff
);

661 
	`ZIPLIST_TAIL_OFFSET
(
zl
èğ
	`šŒev32ifbe
(
p
-zl);

666 ià(
Ãxtdiff
 != 0) {

667 
off£t
 = 
p
-
zl
;

668 
zl
 = 
	`__zli¡CasÿdeUpd©e
(zl,
p
+
»qËn
);

669 
p
 = 
zl
+
off£t
;

673 
p
 +ğ
	`zP»vEncodeL’gth
Õ,
´evËn
);

674 
p
 +ğ
	`zEncodeL’gth
Õ,
’codšg
,
¦’
);

675 ià(
	`ZIP_IS_STR
(
’codšg
)) {

676 
	`memıy
(
p
,
s
,
¦’
);

678 
	`zSaveIÁeg”
(
p
,
v®ue
,
’codšg
);

680 
	`ZIPLIST_INCR_LENGTH
(
zl
,1);

681  
zl
;

682 
	}
}

699 *
	$zli¡M”ge
(**
fœ¡
, **
£cÚd
) {

701 ià(
fœ¡
 =ğ
NULL
 || *fœ¡ =ğNULL || 
£cÚd
 == NULL || *second == NULL)

702  
NULL
;

705 ià(*
fœ¡
 =ğ*
£cÚd
)

706  
NULL
;

708 
size_t
 
fœ¡_by‹s
 = 
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(*
fœ¡
));

709 
size_t
 
fœ¡_Ën
 = 
	`šŒev16ifbe
(
	`ZIPLIST_LENGTH
(*
fœ¡
));

711 
size_t
 
£cÚd_by‹s
 = 
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(*
£cÚd
));

712 
size_t
 
£cÚd_Ën
 = 
	`šŒev16ifbe
(
	`ZIPLIST_LENGTH
(*
£cÚd
));

714 
­³nd
;

715 *
sourû
, *
rg‘
;

716 
size_t
 
rg‘_by‹s
, 
sourû_by‹s
;

720 ià(
fœ¡_Ën
 >ğ
£cÚd_Ën
) {

722 
rg‘
 = *
fœ¡
;

723 
rg‘_by‹s
 = 
fœ¡_by‹s
;

724 
sourû
 = *
£cÚd
;

725 
sourû_by‹s
 = 
£cÚd_by‹s
;

726 
­³nd
 = 1;

729 
rg‘
 = *
£cÚd
;

730 
rg‘_by‹s
 = 
£cÚd_by‹s
;

731 
sourû
 = *
fœ¡
;

732 
sourû_by‹s
 = 
fœ¡_by‹s
;

733 
­³nd
 = 0;

737 
size_t
 
zlby‹s
 = 
fœ¡_by‹s
 + 
£cÚd_by‹s
 -

738 
ZIPLIST_HEADER_SIZE
 - 
ZIPLIST_END_SIZE
;

739 
size_t
 
zÎ’gth
 = 
fœ¡_Ën
 + 
£cÚd_Ën
;

742 
zÎ’gth
 = zÎ’gth < 
UINT16_MAX
 ? zllength : UINT16_MAX;

745 
size_t
 
fœ¡_off£t
 = 
	`šŒev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(*
fœ¡
));

746 
size_t
 
£cÚd_off£t
 = 
	`šŒev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(*
£cÚd
));

749 
rg‘
 = 
	`z»®loc
Ñ¬g‘, 
zlby‹s
);

750 ià(
­³nd
) {

754 
	`memıy
(
rg‘
 + 
rg‘_by‹s
 - 
ZIPLIST_END_SIZE
,

755 
sourû
 + 
ZIPLIST_HEADER_SIZE
,

756 
sourû_by‹s
 - 
ZIPLIST_HEADER_SIZE
);

762 
	`memmove
(
rg‘
 + 
sourû_by‹s
 - 
ZIPLIST_END_SIZE
,

763 
rg‘
 + 
ZIPLIST_HEADER_SIZE
,

764 
rg‘_by‹s
 - 
ZIPLIST_HEADER_SIZE
);

765 
	`memıy
(
rg‘
, 
sourû
, 
sourû_by‹s
 - 
ZIPLIST_END_SIZE
);

769 
	`ZIPLIST_BYTES
(
rg‘
èğ
	`šŒev32ifbe
(
zlby‹s
);

770 
	`ZIPLIST_LENGTH
(
rg‘
èğ
	`šŒev16ifbe
(
zÎ’gth
);

776 
	`ZIPLIST_TAIL_OFFSET
(
rg‘
èğ
	`šŒev32ifbe
(

777 (
fœ¡_by‹s
 - 
ZIPLIST_END_SIZE
) +

778 (
£cÚd_off£t
 - 
ZIPLIST_HEADER_SIZE
));

784 
rg‘
 = 
	`__zli¡CasÿdeUpd©e
Ñ¬g‘,¬g‘+
fœ¡_off£t
);

787 ià(
­³nd
) {

788 
	`zä“
(*
£cÚd
);

789 *
£cÚd
 = 
NULL
;

790 *
fœ¡
 = 
rg‘
;

792 
	`zä“
(*
fœ¡
);

793 *
fœ¡
 = 
NULL
;

794 *
£cÚd
 = 
rg‘
;

796  
rg‘
;

797 
	}
}

799 *
	$zli¡Push
(*
zl
, *
s
, 
¦’
, 
wh”e
) {

800 *
p
;

801 
p
 = (
wh”e
 =ğ
ZIPLIST_HEAD
è? 
	`ZIPLIST_ENTRY_HEAD
(
zl
è: 
	`ZIPLIST_ENTRY_END
(zl);

802  
	`__zli¡In£¹
(
zl
,
p
,
s
,
¦’
);

803 
	}
}

808 *
	$zli¡Index
(*
zl
, 
šdex
) {

809 *
p
;

810 
´evËnsize
, 
´evËn
 = 0;

811 ià(
šdex
 < 0) {

812 
šdex
 = (-index)-1;

813 
p
 = 
	`ZIPLIST_ENTRY_TAIL
(
zl
);

814 ià(
p
[0] !ğ
ZIP_END
) {

815 
	`ZIP_DECODE_PREVLEN
(
p
, 
´evËnsize
, 
´evËn
);

816 
´evËn
 > 0 && 
šdex
--) {

817 
p
 -ğ
´evËn
;

818 
	`ZIP_DECODE_PREVLEN
(
p
, 
´evËnsize
, 
´evËn
);

822 
p
 = 
	`ZIPLIST_ENTRY_HEAD
(
zl
);

823 
p
[0] !ğ
ZIP_END
 && 
šdex
--) {

824 
p
 +ğ
	`zRawEÁryL’gth
(p);

827  (
p
[0] =ğ
ZIP_END
 || 
šdex
 > 0è? 
NULL
 :…;

828 
	}
}

836 *
	$zli¡Next
(*
zl
, *
p
) {

837 ((è
zl
);

842 ià(
p
[0] =ğ
ZIP_END
) {

843  
NULL
;

846 
p
 +ğ
	`zRawEÁryL’gth
(p);

847 ià(
p
[0] =ğ
ZIP_END
) {

848  
NULL
;

851  
p
;

852 
	}
}

855 *
	$zli¡P»v
(*
zl
, *
p
) {

856 
´evËnsize
, 
´evËn
 = 0;

861 ià(
p
[0] =ğ
ZIP_END
) {

862 
p
 = 
	`ZIPLIST_ENTRY_TAIL
(
zl
);

863  (
p
[0] =ğ
ZIP_END
è? 
NULL
 :…;

864 } ià(
p
 =ğ
	`ZIPLIST_ENTRY_HEAD
(
zl
)) {

865  
NULL
;

867 
	`ZIP_DECODE_PREVLEN
(
p
, 
´evËnsize
, 
´evËn
);

868 
	`as£¹
(
´evËn
 > 0);

869  
p
-
´evËn
;

871 
	}
}

877 
	$zli¡G‘
(*
p
, **
s¡r
, *
¦’
, *
sv®
) {

878 
zËÁry
 
’Œy
;

879 ià(
p
 =ğ
NULL
 ||…[0] =ğ
ZIP_END
)  0;

880 ià(
s¡r
è*s¡¸ğ
NULL
;

882 
	`zEÁry
(
p
, &
’Œy
);

883 ià(
	`ZIP_IS_STR
(
’Œy
.
’codšg
)) {

884 ià(
s¡r
) {

885 *
¦’
 = 
’Œy
.
Ën
;

886 *
s¡r
 = 
p
+
’Œy
.
h—d”size
;

889 ià(
sv®
) {

890 *
sv®
 = 
	`zLßdIÁeg”
(
p
+
’Œy
.
h—d”size
,’Œy.
’codšg
);

894 
	}
}

897 *
	$zli¡In£¹
(*
zl
, *
p
, *
s
, 
¦’
) {

898  
	`__zli¡In£¹
(
zl
,
p
,
s
,
¦’
);

899 
	}
}

904 *
	$zli¡D–‘e
(*
zl
, **
p
) {

905 
size_t
 
off£t
 = *
p
-
zl
;

906 
zl
 = 
	`__zli¡D–‘e
(zl,*
p
,1);

912 *
p
 = 
zl
+
off£t
;

913  
zl
;

914 
	}
}

917 *
	$zli¡D–‘eRªge
(*
zl
, 
šdex
, 
num
) {

918 *
p
 = 
	`zli¡Index
(
zl
,
šdex
);

919  (
p
 =ğ
NULL
è? 
zl
 : 
	`__zli¡D–‘e
(zl,p,
num
);

920 
	}
}

924 
	$zli¡Com·»
(*
p
, *
s¡r
, 
¦’
) {

925 
zËÁry
 
’Œy
;

926 
£ncodšg
;

927 
zv®
, 
sv®
;

928 ià(
p
[0] =ğ
ZIP_END
)  0;

930 
	`zEÁry
(
p
, &
’Œy
);

931 ià(
	`ZIP_IS_STR
(
’Œy
.
’codšg
)) {

933 ià(
’Œy
.
Ën
 =ğ
¦’
) {

934  
	`memcmp
(
p
+
’Œy
.
h—d”size
,
s¡r
,
¦’
) == 0;

941 ià(
	`zTryEncodšg
(
s¡r
,
¦’
,&
sv®
,&
£ncodšg
)) {

942 
zv®
 = 
	`zLßdIÁeg”
(
p
+
’Œy
.
h—d”size
,’Œy.
’codšg
);

943  
zv®
 =ğ
sv®
;

947 
	}
}

951 *
	$zli¡Fšd
(*
p
, *
v¡r
, 
vËn
, 
sk
) {

952 
skút
 = 0;

953 
v’codšg
 = 0;

954 
vÎ
 = 0;

956 
p
[0] !ğ
ZIP_END
) {

957 
´evËnsize
, 
’codšg
, 
Ënsize
, 
Ën
;

958 *
q
;

960 
	`ZIP_DECODE_PREVLENSIZE
(
p
, 
´evËnsize
);

961 
	`ZIP_DECODE_LENGTH
(
p
 + 
´evËnsize
, 
’codšg
, 
Ënsize
, 
Ën
);

962 
q
 = 
p
 + 
´evËnsize
 + 
Ënsize
;

964 ià(
skút
 == 0) {

966 ià(
	`ZIP_IS_STR
(
’codšg
)) {

967 ià(
Ën
 =ğ
vËn
 && 
	`memcmp
(
q
, 
v¡r
, vlen) == 0) {

968  
p
;

974 ià(
v’codšg
 == 0) {

975 ià(!
	`zTryEncodšg
(
v¡r
, 
vËn
, &
vÎ
, &
v’codšg
)) {

979 
v’codšg
 = 
UCHAR_MAX
;

982 
	`as£¹
(
v’codšg
);

988 ià(
v’codšg
 !ğ
UCHAR_MAX
) {

989 
Î
 = 
	`zLßdIÁeg”
(
q
, 
’codšg
);

990 ià(
Î
 =ğ
vÎ
) {

991  
p
;

997 
skút
 = 
sk
;

1000 
skút
--;

1004 
p
 = 
q
 + 
Ën
;

1007  
NULL
;

1008 
	}
}

1011 
	$zli¡L’
(*
zl
) {

1012 
Ën
 = 0;

1013 ià(
	`šŒev16ifbe
(
	`ZIPLIST_LENGTH
(
zl
)è< 
UINT16_MAX
) {

1014 
Ën
 = 
	`šŒev16ifbe
(
	`ZIPLIST_LENGTH
(
zl
));

1016 *
p
 = 
zl
+
ZIPLIST_HEADER_SIZE
;

1017 *
p
 !ğ
ZIP_END
) {

1018 
p
 +ğ
	`zRawEÁryL’gth
(p);

1019 
Ën
++;

1023 ià(
Ën
 < 
UINT16_MAX
è
	`ZIPLIST_LENGTH
(
zl
èğ
	`šŒev16ifbe
(len);

1025  
Ën
;

1026 
	}
}

1029 
size_t
 
	$zli¡BlobL’
(*
zl
) {

1030  
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(
zl
));

1031 
	}
}

1033 
	$zli¡R•r
(*
zl
) {

1034 *
p
;

1035 
šdex
 = 0;

1036 
zËÁry
 
’Œy
;

1038 
	`´štf
(

1042 
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(
zl
)),

1043 
	`šŒev16ifbe
(
	`ZIPLIST_LENGTH
(
zl
)),

1044 
	`šŒev32ifbe
(
	`ZIPLIST_TAIL_OFFSET
(
zl
)));

1045 
p
 = 
	`ZIPLIST_ENTRY_HEAD
(
zl
);

1046 *
p
 !ğ
ZIP_END
) {

1047 
	`zEÁry
(
p
, &
’Œy
);

1048 
	`´štf
(

1059 ()
p
,

1060 
šdex
,

1061 (è(
p
-
zl
),

1062 
’Œy
.
h—d”size
+’Œy.
Ën
,

1063 
’Œy
.
h—d”size
,

1064 
’Œy
.
´ev¿wËn
,

1065 
’Œy
.
´ev¿wËnsize
,

1066 
’Œy
.
Ën
);

1067 
p
 +ğ
’Œy
.
h—d”size
;

1068 ià(
	`ZIP_IS_STR
(
’Œy
.
’codšg
)) {

1069 ià(
’Œy
.
Ën
 > 40) {

1070 ià(
	`fwr™e
(
p
,40,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1071 
	`´štf
("...");

1073 ià(
’Œy
.
Ën
 &&

1074 
	`fwr™e
(
p
,
’Œy
.
Ën
,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1077 
	`´štf
("%Îd", (è
	`zLßdIÁeg”
(
p
,
’Œy
.
’codšg
));

1079 
	`´štf
("\n");

1080 
p
 +ğ
’Œy
.
Ën
;

1081 
šdex
++;

1083 
	`´štf
("{end}\n\n");

1084 
	}
}

1086 #ifdeà
REDIS_TEST


1087 
	~<sys/time.h
>

1088 
	~"adli¡.h
"

1089 
	~"sds.h
"

1091 
	#debug
(
f
, ...è{ ià(
DEBUG
è
	`´štf
(f, 
__VA_ARGS__
); }

	)

1093 *
	$ü—‹Li¡
() {

1094 *
zl
 = 
	`zli¡New
();

1095 
zl
 = 
	`zli¡Push
(zl, (*)"foo", 3, 
ZIPLIST_TAIL
);

1096 
zl
 = 
	`zli¡Push
(zl, (*)"quux", 4, 
ZIPLIST_TAIL
);

1097 
zl
 = 
	`zli¡Push
(zl, (*)"h–lo", 5, 
ZIPLIST_HEAD
);

1098 
zl
 = 
	`zli¡Push
(zl, (*)"1024", 4, 
ZIPLIST_TAIL
);

1099  
zl
;

1100 
	}
}

1102 *
	$ü—‹IÁLi¡
() {

1103 *
zl
 = 
	`zli¡New
();

1104 
buf
[32];

1106 
	`¥rštf
(
buf
, "100");

1107 
zl
 = 
	`zli¡Push
(zl, (*)
buf
, 
	`¡¾’
(buf), 
ZIPLIST_TAIL
);

1108 
	`¥rštf
(
buf
, "128000");

1109 
zl
 = 
	`zli¡Push
(zl, (*)
buf
, 
	`¡¾’
(buf), 
ZIPLIST_TAIL
);

1110 
	`¥rštf
(
buf
, "-100");

1111 
zl
 = 
	`zli¡Push
(zl, (*)
buf
, 
	`¡¾’
(buf), 
ZIPLIST_HEAD
);

1112 
	`¥rštf
(
buf
, "4294967296");

1113 
zl
 = 
	`zli¡Push
(zl, (*)
buf
, 
	`¡¾’
(buf), 
ZIPLIST_HEAD
);

1114 
	`¥rštf
(
buf
, "non integer");

1115 
zl
 = 
	`zli¡Push
(zl, (*)
buf
, 
	`¡¾’
(buf), 
ZIPLIST_TAIL
);

1116 
	`¥rštf
(
buf
, "much much†onger‚on integer");

1117 
zl
 = 
	`zli¡Push
(zl, (*)
buf
, 
	`¡¾’
(buf), 
ZIPLIST_TAIL
);

1118  
zl
;

1119 
	}
}

1121 
	$u£c
() {

1122 
timev®
 
tv
;

1123 
	`g‘timeofday
(&
tv
,
NULL
);

1124  ((()
tv
.
tv_£c
)*1000000)+tv.
tv_u£c
;

1125 
	}
}

1127 
	$¡»ss
(
pos
, 
num
, 
maxsize
, 
dnum
) {

1128 
i
,
j
,
k
;

1129 *
zl
;

1130 
pos¡r
[2][5] = { "HEAD", "TAIL" };

1131 
¡¬t
;

1132 
i
 = 0; i < 
maxsize
; i+=
dnum
) {

1133 
zl
 = 
	`zli¡New
();

1134 
j
 = 0; j < 
i
; j++) {

1135 
zl
 = 
	`zli¡Push
(zl,(*)"quux",4,
ZIPLIST_TAIL
);

1139 
¡¬t
 = 
	`u£c
();

1140 
k
 = 0; k < 
num
; k++) {

1141 
zl
 = 
	`zli¡Push
(zl,(*)"quux",4,
pos
);

1142 
zl
 = 
	`zli¡D–‘eRªge
(zl,0,1);

1144 
	`´štf
("List size: %8d, bytes: %8d, %dx…ush+pop (%s): %6lld usec\n",

1145 
i
,
	`šŒev32ifbe
(
	`ZIPLIST_BYTES
(
zl
)),
num
,
pos¡r
[
pos
],
	`u£c
()-
¡¬t
);

1146 
	`zä“
(
zl
);

1148 
	}
}

1150 *
	$pİ
(*
zl
, 
wh”e
) {

1151 *
p
, *
v¡r
;

1152 
vËn
;

1153 
vlÚg
;

1155 
p
 = 
	`zli¡Index
(
zl
,
wh”e
 =ğ
ZIPLIST_HEAD
 ? 0 : -1);

1156 ià(
	`zli¡G‘
(
p
,&
v¡r
,&
vËn
,&
vlÚg
)) {

1157 ià(
wh”e
 =ğ
ZIPLIST_HEAD
)

1158 
	`´štf
("Pop head: ");

1160 
	`´štf
("Popail: ");

1162 ià(
v¡r
) {

1163 ià(
vËn
 && 
	`fwr™e
(
v¡r
,vËn,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1166 
	`´štf
("%Îd", 
vlÚg
);

1169 
	`´štf
("\n");

1170  
	`zli¡D–‘e
(
zl
,&
p
);

1172 
	`´štf
("ERROR: Could‚ot…op\n");

1173 
	`ex™
(1);

1175 
	}
}

1177 
	$¿nd¡ršg
(*
rg‘
, 
mš
, 
max
) {

1178 
p
 = 0;

1179 
Ën
 = 
mš
+
	`¿nd
()%(
max
-min+1);

1180 
mšv®
, 
maxv®
;

1181 
	`¿nd
() % 3) {

1183 
mšv®
 = 0;

1184 
maxv®
 = 255;

1187 
mšv®
 = 48;

1188 
maxv®
 = 122;

1191 
mšv®
 = 48;

1192 
maxv®
 = 52;

1195 
	`as£¹
(
NULL
);

1198 
p
 < 
Ën
)

1199 
rg‘
[
p
++] = 
mšv®
+
	`¿nd
()%(
maxv®
-minval+1);

1200  
Ën
;

1201 
	}
}

1203 
	$v”ify
(*
zl
, 
zËÁry
 *
e
) {

1204 
Ën
 = 
	`zli¡L’
(
zl
);

1205 
zËÁry
 
_e
;

1207 
	`ZIPLIST_ENTRY_ZERO
(&
_e
);

1209 
i
 = 0; i < 
Ën
; i++) {

1210 
	`mem£t
(&
e
[
i
], 0, (
zËÁry
));

1211 
	`zEÁry
(
	`zli¡Index
(
zl
, 
i
), &
e
[i]);

1213 
	`mem£t
(&
_e
, 0, (
zËÁry
));

1214 
	`zEÁry
(
	`zli¡Index
(
zl
, -
Ën
+
i
), &
_e
);

1216 
	`as£¹
(
	`memcmp
(&
e
[
i
], &
_e
, (
zËÁry
)) == 0);

1218 
	}
}

1220 
	$zli¡Te¡
(
¬gc
, **
¬gv
) {

1221 *
zl
, *
p
;

1222 *
’Œy
;

1223 
–’
;

1224 
v®ue
;

1227 ià(
¬gc
 == 2)

1228 
	`¤ªd
(
	`©oi
(
¬gv
[1]));

1230 
zl
 = 
	`ü—‹IÁLi¡
();

1231 
	`zli¡R•r
(
zl
);

1233 
	`zä“
(
zl
);

1235 
zl
 = 
	`ü—‹Li¡
();

1236 
	`zli¡R•r
(
zl
);

1238 
zl
 = 
	`pİ
(zl,
ZIPLIST_TAIL
);

1239 
	`zli¡R•r
(
zl
);

1241 
zl
 = 
	`pİ
(zl,
ZIPLIST_HEAD
);

1242 
	`zli¡R•r
(
zl
);

1244 
zl
 = 
	`pİ
(zl,
ZIPLIST_TAIL
);

1245 
	`zli¡R•r
(
zl
);

1247 
zl
 = 
	`pİ
(zl,
ZIPLIST_TAIL
);

1248 
	`zli¡R•r
(
zl
);

1250 
	`zä“
(
zl
);

1252 
	`´štf
("Getƒlement‡t index 3:\n");

1254 
zl
 = 
	`ü—‹Li¡
();

1255 
p
 = 
	`zli¡Index
(
zl
, 3);

1256 ià(!
	`zli¡G‘
(
p
, &
’Œy
, &
–’
, &
v®ue
)) {

1257 
	`´štf
("ERROR: Could‚ot‡ccess index 3\n");

1260 ià(
’Œy
) {

1261 ià(
–’
 && 
	`fwr™e
(
’Œy
,–’,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1262 
	`´štf
("\n");

1264 
	`´štf
("%Îd\n", 
v®ue
);

1266 
	`´štf
("\n");

1267 
	`zä“
(
zl
);

1270 
	`´štf
("Getƒlement‡t index 4 (out of„ange):\n");

1272 
zl
 = 
	`ü—‹Li¡
();

1273 
p
 = 
	`zli¡Index
(
zl
, 4);

1274 ià(
p
 =ğ
NULL
) {

1275 
	`´štf
("Noƒntry\n");

1277 
	`´štf
("ERROR: Ouˆoà¿ngšdex should„‘uº NULL,„‘uºed off£t: %ld\n", 
p
-
zl
);

1280 
	`´štf
("\n");

1281 
	`zä“
(
zl
);

1284 
	`´štf
("Getƒlement‡t index -1 (lastƒlement):\n");

1286 
zl
 = 
	`ü—‹Li¡
();

1287 
p
 = 
	`zli¡Index
(
zl
, -1);

1288 ià(!
	`zli¡G‘
(
p
, &
’Œy
, &
–’
, &
v®ue
)) {

1289 
	`´štf
("ERROR: Could‚ot‡ccess index -1\n");

1292 ià(
’Œy
) {

1293 ià(
–’
 && 
	`fwr™e
(
’Œy
,–’,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1294 
	`´štf
("\n");

1296 
	`´štf
("%Îd\n", 
v®ue
);

1298 
	`´štf
("\n");

1299 
	`zä“
(
zl
);

1302 
	`´štf
("Getƒlement‡t index -4 (firstƒlement):\n");

1304 
zl
 = 
	`ü—‹Li¡
();

1305 
p
 = 
	`zli¡Index
(
zl
, -4);

1306 ià(!
	`zli¡G‘
(
p
, &
’Œy
, &
–’
, &
v®ue
)) {

1307 
	`´štf
("ERROR: Could‚ot‡ccess index -4\n");

1310 ià(
’Œy
) {

1311 ià(
–’
 && 
	`fwr™e
(
’Œy
,–’,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1312 
	`´štf
("\n");

1314 
	`´štf
("%Îd\n", 
v®ue
);

1316 
	`´štf
("\n");

1317 
	`zä“
(
zl
);

1320 
	`´štf
("Getƒlement‡t index -5 (reverse out of„ange):\n");

1322 
zl
 = 
	`ü—‹Li¡
();

1323 
p
 = 
	`zli¡Index
(
zl
, -5);

1324 ià(
p
 =ğ
NULL
) {

1325 
	`´štf
("Noƒntry\n");

1327 
	`´štf
("ERROR: Ouˆoà¿ngšdex should„‘uº NULL,„‘uºed off£t: %ld\n", 
p
-
zl
);

1330 
	`´štf
("\n");

1331 
	`zä“
(
zl
);

1334 
	`´štf
("Iterate†ist from 0oƒnd:\n");

1336 
zl
 = 
	`ü—‹Li¡
();

1337 
p
 = 
	`zli¡Index
(
zl
, 0);

1338 
	`zli¡G‘
(
p
, &
’Œy
, &
–’
, &
v®ue
)) {

1339 
	`´štf
("Entry: ");

1340 ià(
’Œy
) {

1341 ià(
–’
 && 
	`fwr™e
(
’Œy
,–’,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1343 
	`´štf
("%Îd", 
v®ue
);

1345 
p
 = 
	`zli¡Next
(
zl
,p);

1346 
	`´štf
("\n");

1348 
	`´štf
("\n");

1349 
	`zä“
(
zl
);

1352 
	`´štf
("Iterate†ist from 1oƒnd:\n");

1354 
zl
 = 
	`ü—‹Li¡
();

1355 
p
 = 
	`zli¡Index
(
zl
, 1);

1356 
	`zli¡G‘
(
p
, &
’Œy
, &
–’
, &
v®ue
)) {

1357 
	`´štf
("Entry: ");

1358 ià(
’Œy
) {

1359 ià(
–’
 && 
	`fwr™e
(
’Œy
,–’,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1361 
	`´štf
("%Îd", 
v®ue
);

1363 
p
 = 
	`zli¡Next
(
zl
,p);

1364 
	`´štf
("\n");

1366 
	`´štf
("\n");

1367 
	`zä“
(
zl
);

1370 
	`´štf
("Iterate†ist from 2oƒnd:\n");

1372 
zl
 = 
	`ü—‹Li¡
();

1373 
p
 = 
	`zli¡Index
(
zl
, 2);

1374 
	`zli¡G‘
(
p
, &
’Œy
, &
–’
, &
v®ue
)) {

1375 
	`´štf
("Entry: ");

1376 ià(
’Œy
) {

1377 ià(
–’
 && 
	`fwr™e
(
’Œy
,–’,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1379 
	`´štf
("%Îd", 
v®ue
);

1381 
p
 = 
	`zli¡Next
(
zl
,p);

1382 
	`´štf
("\n");

1384 
	`´štf
("\n");

1385 
	`zä“
(
zl
);

1388 
	`´štf
("Iterate starting out of„ange:\n");

1390 
zl
 = 
	`ü—‹Li¡
();

1391 
p
 = 
	`zli¡Index
(
zl
, 4);

1392 ià(!
	`zli¡G‘
(
p
, &
’Œy
, &
–’
, &
v®ue
)) {

1393 
	`´štf
("Noƒntry\n");

1395 
	`´štf
("ERROR\n");

1397 
	`´štf
("\n");

1398 
	`zä“
(
zl
);

1401 
	`´štf
("Iterate from backo front:\n");

1403 
zl
 = 
	`ü—‹Li¡
();

1404 
p
 = 
	`zli¡Index
(
zl
, -1);

1405 
	`zli¡G‘
(
p
, &
’Œy
, &
–’
, &
v®ue
)) {

1406 
	`´štf
("Entry: ");

1407 ià(
’Œy
) {

1408 ià(
–’
 && 
	`fwr™e
(
’Œy
,–’,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1410 
	`´štf
("%Îd", 
v®ue
);

1412 
p
 = 
	`zli¡P»v
(
zl
,p);

1413 
	`´štf
("\n");

1415 
	`´štf
("\n");

1416 
	`zä“
(
zl
);

1419 
	`´štf
("Iterate from backo front, deleting‡ll items:\n");

1421 
zl
 = 
	`ü—‹Li¡
();

1422 
p
 = 
	`zli¡Index
(
zl
, -1);

1423 
	`zli¡G‘
(
p
, &
’Œy
, &
–’
, &
v®ue
)) {

1424 
	`´štf
("Entry: ");

1425 ià(
’Œy
) {

1426 ià(
–’
 && 
	`fwr™e
(
’Œy
,–’,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

1428 
	`´štf
("%Îd", 
v®ue
);

1430 
zl
 = 
	`zli¡D–‘e
(zl,&
p
);

1431 
p
 = 
	`zli¡P»v
(
zl
,p);

1432 
	`´štf
("\n");

1434 
	`´štf
("\n");

1435 
	`zä“
(
zl
);

1438 
	`´štf
("Delete inclusive„ange 0,0:\n");

1440 
zl
 = 
	`ü—‹Li¡
();

1441 
zl
 = 
	`zli¡D–‘eRªge
(zl, 0, 1);

1442 
	`zli¡R•r
(
zl
);

1443 
	`zä“
(
zl
);

1446 
	`´štf
("Delete inclusive„ange 0,1:\n");

1448 
zl
 = 
	`ü—‹Li¡
();

1449 
zl
 = 
	`zli¡D–‘eRªge
(zl, 0, 2);

1450 
	`zli¡R•r
(
zl
);

1451 
	`zä“
(
zl
);

1454 
	`´štf
("Delete inclusive„ange 1,2:\n");

1456 
zl
 = 
	`ü—‹Li¡
();

1457 
zl
 = 
	`zli¡D–‘eRªge
(zl, 1, 2);

1458 
	`zli¡R•r
(
zl
);

1459 
	`zä“
(
zl
);

1462 
	`´štf
("Delete with start index out of„ange:\n");

1464 
zl
 = 
	`ü—‹Li¡
();

1465 
zl
 = 
	`zli¡D–‘eRªge
(zl, 5, 1);

1466 
	`zli¡R•r
(
zl
);

1467 
	`zä“
(
zl
);

1470 
	`´štf
("Delete with‚um overflow:\n");

1472 
zl
 = 
	`ü—‹Li¡
();

1473 
zl
 = 
	`zli¡D–‘eRªge
(zl, 1, 5);

1474 
	`zli¡R•r
(
zl
);

1475 
	`zä“
(
zl
);

1478 
	`´štf
("Delete foo while iterating:\n");

1480 
zl
 = 
	`ü—‹Li¡
();

1481 
p
 = 
	`zli¡Index
(
zl
,0);

1482 
	`zli¡G‘
(
p
,&
’Œy
,&
–’
,&
v®ue
)) {

1483 ià(
’Œy
 && 
	`¡ºcmp
("foo",(*ëÁry,
–’
) == 0) {

1484 
	`´štf
("Delete foo\n");

1485 
zl
 = 
	`zli¡D–‘e
(zl,&
p
);

1487 
	`´štf
("Entry: ");

1488 ià(
’Œy
) {

1489 ià(
–’
 && 
	`fwr™e
(
’Œy
,–’,1,
¡dout
) == 0)

1490 
	`³¼Ü
("fwrite");

1492 
	`´štf
("%Îd",
v®ue
);

1494 
p
 = 
	`zli¡Next
(
zl
,p);

1495 
	`´štf
("\n");

1498 
	`´štf
("\n");

1499 
	`zli¡R•r
(
zl
);

1500 
	`zä“
(
zl
);

1503 
	`´štf
("Regressionest for >255 byte strings:\n");

1505 
v1
[257] = {0}, 
v2
[257] = {0};

1506 
	`mem£t
(
v1
,'x',256);

1507 
	`mem£t
(
v2
,'y',256);

1508 
zl
 = 
	`zli¡New
();

1509 
zl
 = 
	`zli¡Push
(zl,(*)
v1
,
	`¡¾’
(v1),
ZIPLIST_TAIL
);

1510 
zl
 = 
	`zli¡Push
(zl,(*)
v2
,
	`¡¾’
(v2),
ZIPLIST_TAIL
);

1513 
p
 = 
	`zli¡Index
(
zl
,0);

1514 
	`as£¹
(
	`zli¡G‘
(
p
,&
’Œy
,&
–’
,&
v®ue
));

1515 
	`as£¹
(
	`¡ºcmp
(
v1
,(*)
’Œy
,
–’
) == 0);

1516 
p
 = 
	`zli¡Index
(
zl
,1);

1517 
	`as£¹
(
	`zli¡G‘
(
p
,&
’Œy
,&
–’
,&
v®ue
));

1518 
	`as£¹
(
	`¡ºcmp
(
v2
,(*)
’Œy
,
–’
) == 0);

1519 
	`´štf
("SUCCESS\n\n");

1520 
	`zä“
(
zl
);

1523 
	`´štf
("Regressionest deleting‚exto†astƒntries:\n");

1525 
v
[3][257] = {{0}};

1526 
zËÁry
 
e
[3] = {{.
´ev¿wËnsize
 = 0, .
´ev¿wËn
 = 0, .
Ënsize
 = 0,

1527 .
Ën
 = 0, .
h—d”size
 = 0, .
’codšg
 = 0, .
p
 = 
NULL
}};

1528 
size_t
 
i
;

1530 
i
 = 0; i < ((
v
)/(v[0])); i++) {

1531 
	`mem£t
(
v
[
i
], 'a' + i, (v[0]));

1534 
v
[0][256] = '\0';

1535 
v
[1][ 1] = '\0';

1536 
v
[2][256] = '\0';

1538 
zl
 = 
	`zli¡New
();

1539 
i
 = 0; i < ((
v
)/(v[0])); i++) {

1540 
zl
 = 
	`zli¡Push
(zl, (*è
v
[
i
], 
	`¡¾’
(v[i]), 
ZIPLIST_TAIL
);

1543 
	`v”ify
(
zl
, 
e
);

1545 
	`as£¹
(
e
[0].
´ev¿wËnsize
 == 1);

1546 
	`as£¹
(
e
[1].
´ev¿wËnsize
 == 5);

1547 
	`as£¹
(
e
[2].
´ev¿wËnsize
 == 1);

1550 *
p
 = 
e
[1].p;

1551 
zl
 = 
	`zli¡D–‘e
(zl, &
p
);

1553 
	`v”ify
(
zl
, 
e
);

1555 
	`as£¹
(
e
[0].
´ev¿wËnsize
 == 1);

1556 
	`as£¹
(
e
[1].
´ev¿wËnsize
 == 5);

1558 
	`´štf
("SUCCESS\n\n");

1559 
	`zä“
(
zl
);

1562 
	`´štf
("Create†ong†ist‡nd check indices:\n");

1564 
zl
 = 
	`zli¡New
();

1565 
buf
[32];

1566 
i
,
Ën
;

1567 
i
 = 0; i < 1000; i++) {

1568 
Ën
 = 
	`¥rštf
(
buf
,"%d",
i
);

1569 
zl
 = 
	`zli¡Push
(zl,(*)
buf
,
Ën
,
ZIPLIST_TAIL
);

1571 
i
 = 0; i < 1000; i++) {

1572 
p
 = 
	`zli¡Index
(
zl
,
i
);

1573 
	`as£¹
(
	`zli¡G‘
(
p
,
NULL
,NULL,&
v®ue
));

1574 
	`as£¹
(
i
 =ğ
v®ue
);

1576 
p
 = 
	`zli¡Index
(
zl
,-
i
-1);

1577 
	`as£¹
(
	`zli¡G‘
(
p
,
NULL
,NULL,&
v®ue
));

1578 
	`as£¹
(999-
i
 =ğ
v®ue
);

1580 
	`´štf
("SUCCESS\n\n");

1581 
	`zä“
(
zl
);

1584 
	`´štf
("Compare strings with ziplistƒntries:\n");

1586 
zl
 = 
	`ü—‹Li¡
();

1587 
p
 = 
	`zli¡Index
(
zl
,0);

1588 ià(!
	`zli¡Com·»
(
p
,(*)"hello",5)) {

1589 
	`´štf
("ERROR:‚ot \"hello\"\n");

1592 ià(
	`zli¡Com·»
(
p
,(*)"hella",5)) {

1593 
	`´štf
("ERROR: \"hella\"\n");

1597 
p
 = 
	`zli¡Index
(
zl
,3);

1598 ià(!
	`zli¡Com·»
(
p
,(*)"1024",4)) {

1599 
	`´štf
("ERROR:‚ot \"1024\"\n");

1602 ià(
	`zli¡Com·»
(
p
,(*)"1025",4)) {

1603 
	`´štf
("ERROR: \"1025\"\n");

1606 
	`´štf
("SUCCESS\n\n");

1607 
	`zä“
(
zl
);

1610 
	`´štf
("Mergeest:\n");

1613 
zl
 = 
	`ü—‹Li¡
();

1614 *
zl2
 = 
	`ü—‹Li¡
();

1616 *
zl3
 = 
	`zli¡New
();

1617 *
zl4
 = 
	`zli¡New
();

1619 ià(
	`zli¡M”ge
(&
zl4
, &zl4)) {

1620 
	`´štf
("ERROR: Allowed merging of one ziplist into itself.\n");

1625 
zl4
 = 
	`zli¡M”ge
(&
zl3
, &zl4);

1626 
	`zli¡R•r
(
zl4
);

1627 ià(
	`zli¡L’
(
zl4
)) {

1628 
	`´štf
("ERROR: Mergingwoƒmpty ziplists createdƒntries.\n");

1631 
	`zä“
(
zl4
);

1633 
zl2
 = 
	`zli¡M”ge
(&
zl
, &zl2);

1635 
	`zli¡R•r
(
zl2
);

1637 ià(
	`zli¡L’
(
zl2
) != 8) {

1638 
	`´štf
("ERROR: M”ged†’gth‚Ù 8, but: %u\n", 
	`zli¡L’
(
zl2
));

1642 
p
 = 
	`zli¡Index
(
zl2
,0);

1643 ià(!
	`zli¡Com·»
(
p
,(*)"hello",5)) {

1644 
	`´štf
("ERROR:‚ot \"hello\"\n");

1647 ià(
	`zli¡Com·»
(
p
,(*)"hella",5)) {

1648 
	`´štf
("ERROR: \"hella\"\n");

1652 
p
 = 
	`zli¡Index
(
zl2
,3);

1653 ià(!
	`zli¡Com·»
(
p
,(*)"1024",4)) {

1654 
	`´štf
("ERROR:‚ot \"1024\"\n");

1657 ià(
	`zli¡Com·»
(
p
,(*)"1025",4)) {

1658 
	`´štf
("ERROR: \"1025\"\n");

1662 
p
 = 
	`zli¡Index
(
zl2
,4);

1663 ià(!
	`zli¡Com·»
(
p
,(*)"hello",5)) {

1664 
	`´štf
("ERROR:‚ot \"hello\"\n");

1667 ià(
	`zli¡Com·»
(
p
,(*)"hella",5)) {

1668 
	`´štf
("ERROR: \"hella\"\n");

1672 
p
 = 
	`zli¡Index
(
zl2
,7);

1673 ià(!
	`zli¡Com·»
(
p
,(*)"1024",4)) {

1674 
	`´štf
("ERROR:‚ot \"1024\"\n");

1677 ià(
	`zli¡Com·»
(
p
,(*)"1025",4)) {

1678 
	`´štf
("ERROR: \"1025\"\n");

1681 
	`´štf
("SUCCESS\n\n");

1682 
	`zä“
(
zl
);

1685 
	`´štf
("Stress with„andom…ayloads of differentƒncoding:\n");

1687 
i
,
j
,
Ën
,
wh”e
;

1688 *
p
;

1689 
buf
[1024];

1690 
buæ’
;

1691 
li¡
 *
»f
;

1692 
li¡Node
 *
»âode
;

1695 *
s¡r
;

1696 
¦’
;

1697 
sv®
;

1699 
i
 = 0; i < 20000; i++) {

1700 
zl
 = 
	`zli¡New
();

1701 
»f
 = 
	`li¡C»©e
();

1702 
	`li¡S‘F»eM‘hod
(
»f
,((*)(*))
sdsä“
);

1703 
Ën
 = 
	`¿nd
() % 256;

1706 
j
 = 0; j < 
Ën
; j++) {

1707 
wh”e
 = (
	`¿nd
(è& 1è? 
ZIPLIST_HEAD
 : 
ZIPLIST_TAIL
;

1708 ià(
	`¿nd
() % 2) {

1709 
buæ’
 = 
	`¿nd¡ršg
(
buf
,1,(buf)-1);

1711 
	`¿nd
() % 3) {

1713 
buæ’
 = 
	`¥rštf
(
buf
,"%Îd",(0LL + 
	`¿nd
()) >> 20);

1716 
buæ’
 = 
	`¥rštf
(
buf
,"%Îd",(0LL + 
	`¿nd
()));

1719 
buæ’
 = 
	`¥rštf
(
buf
,"%Îd",(0LL + 
	`¿nd
()) << 20);

1722 
	`as£¹
(
NULL
);

1727 
zl
 = 
	`zli¡Push
(zl, (*)
buf
, 
buæ’
, 
wh”e
);

1730 ià(
wh”e
 =ğ
ZIPLIST_HEAD
) {

1731 
	`li¡AddNodeH—d
(
»f
,
	`sd¢ewËn
(
buf
, 
buæ’
));

1732 } ià(
wh”e
 =ğ
ZIPLIST_TAIL
) {

1733 
	`li¡AddNodeTa
(
»f
,
	`sd¢ewËn
(
buf
, 
buæ’
));

1735 
	`as£¹
(
NULL
);

1739 
	`as£¹
(
	`li¡L’gth
(
»f
è=ğ
	`zli¡L’
(
zl
));

1740 
j
 = 0; j < 
Ën
; j++) {

1743 
p
 = 
	`zli¡Index
(
zl
,
j
);

1744 
»âode
 = 
	`li¡Index
(
»f
,
j
);

1746 
	`as£¹
(
	`zli¡G‘
(
p
,&
s¡r
,&
¦’
,&
sv®
));

1747 ià(
s¡r
 =ğ
NULL
) {

1748 
buæ’
 = 
	`¥rštf
(
buf
,"%Îd",
sv®
);

1750 
buæ’
 = 
¦’
;

1751 
	`memıy
(
buf
,
s¡r
,
buæ’
);

1752 
buf
[
buæ’
] = '\0';

1754 
	`as£¹
(
	`memcmp
(
buf
,
	`li¡NodeV®ue
(
»âode
),
buæ’
) == 0);

1756 
	`zä“
(
zl
);

1757 
	`li¡R–—£
(
»f
);

1759 
	`´štf
("SUCCESS\n\n");

1762 
	`´štf
("Stress with variable ziplist size:\n");

1764 
	`¡»ss
(
ZIPLIST_HEAD
,100000,16384,256);

1765 
	`¡»ss
(
ZIPLIST_TAIL
,100000,16384,256);

1769 
	}
}

	@src/ziplist.h

31 #iâdeà
_ZIPLIST_H


32 
	#_ZIPLIST_H


	)

34 
	#ZIPLIST_HEAD
 0

	)

35 
	#ZIPLIST_TAIL
 1

	)

37 *
zli¡New
();

38 *
zli¡M”ge
(**
fœ¡
, **
£cÚd
);

39 *
zli¡Push
(*
zl
, *
s
, 
¦’
, 
wh”e
);

40 *
zli¡Index
(*
zl
, 
šdex
);

41 *
zli¡Next
(*
zl
, *
p
);

42 *
zli¡P»v
(*
zl
, *
p
);

43 
zli¡G‘
(*
p
, **
sv®
, *
¦’
, *
lv®
);

44 *
zli¡In£¹
(*
zl
, *
p
, *
s
, 
¦’
);

45 *
zli¡D–‘e
(*
zl
, **
p
);

46 *
zli¡D–‘eRªge
(*
zl
, 
šdex
, 
num
);

47 
zli¡Com·»
(*
p
, *
s
, 
¦’
);

48 *
zli¡Fšd
(*
p
, *
v¡r
, 
vËn
, 
sk
);

49 
zli¡L’
(*
zl
);

50 
size_t
 
zli¡BlobL’
(*
zl
);

52 #ifdeà
REDIS_TEST


53 
zli¡Te¡
(
¬gc
, *
¬gv
[]);

	@src/zipmap.c

78 
	~<¡dio.h
>

79 
	~<¡ršg.h
>

80 
	~"zm®loc.h
"

81 
	~"’dŸncÚv.h
"

83 
	#ZIPMAP_BIGLEN
 254

	)

84 
	#ZIPMAP_END
 255

	)

88 
	#ZIPMAP_VALUE_MAX_FREE
 4

	)

93 
	#ZIPMAP_LEN_BYTES
(
_l
è(((_lè< 
ZIPMAP_BIGLEN
è? 1 : ()+1)

	)

96 *
	$zm­New
() {

97 *
zm
 = 
	`zm®loc
(2);

99 
zm
[0] = 0;

100 
zm
[1] = 
ZIPMAP_END
;

101  
zm
;

102 
	}
}

105 
	$zm­DecodeL’gth
(*
p
) {

106 
Ën
 = *
p
;

108 ià(
Ën
 < 
ZIPMAP_BIGLEN
) †en;

109 
	`memıy
(&
Ën
,
p
+1,());

110 
	`mem»v32ifbe
(&
Ën
);

111  
Ën
;

112 
	}
}

116 
	$zm­EncodeL’gth
(*
p
, 
Ën
) {

117 ià(
p
 =ğ
NULL
) {

118  
	`ZIPMAP_LEN_BYTES
(
Ën
);

120 ià(
Ën
 < 
ZIPMAP_BIGLEN
) {

121 
p
[0] = 
Ën
;

124 
p
[0] = 
ZIPMAP_BIGLEN
;

125 
	`memıy
(
p
+1,&
Ën
,(len));

126 
	`mem»v32ifbe
(
p
+1);

127  1+(
Ën
);

130 
	}
}

138 *
	$zm­LookupRaw
(*
zm
, *
key
, 
kËn
, *
tÙËn
) {

139 *
p
 = 
zm
+1, *
k
 = 
NULL
;

140 
l
,
Î’
;

142 *
p
 !ğ
ZIPMAP_END
) {

143 
ä“
;

146 
l
 = 
	`zm­DecodeL’gth
(
p
);

147 
Î’
 = 
	`zm­EncodeL’gth
(
NULL
,
l
);

148 ià(
key
 !ğ
NULL
 && 
k
 =ğNULL && 
l
 =ğ
kËn
 && !
	`memcmp
(
p
+
Î’
,key,l)) {

151 ià(
tÙËn
 !ğ
NULL
) {

152 
k
 = 
p
;

154  
p
;

157 
p
 +ğ
Î’
+
l
;

159 
l
 = 
	`zm­DecodeL’gth
(
p
);

160 
p
 +ğ
	`zm­EncodeL’gth
(
NULL
,
l
);

161 
ä“
 = 
p
[0];

162 
p
 +ğ
l
+1+
ä“
;

164 ià(
tÙËn
 !ğ
NULL
è*tÙËÀğ()(
p
-
zm
)+1;

165  
k
;

166 
	}
}

168 
	$zm­RequœedL’gth
(
kËn
, 
vËn
) {

169 
l
;

171 
l
 = 
kËn
+
vËn
+3;

172 ià(
kËn
 >ğ
ZIPMAP_BIGLEN
è
l
 += 4;

173 ià(
vËn
 >ğ
ZIPMAP_BIGLEN
è
l
 += 4;

174  
l
;

175 
	}
}

178 
	$zm­RawKeyL’gth
(*
p
) {

179 
l
 = 
	`zm­DecodeL’gth
(
p
);

180  
	`zm­EncodeL’gth
(
NULL
,
l
) +†;

181 
	}
}

185 
	$zm­RawV®ueL’gth
(*
p
) {

186 
l
 = 
	`zm­DecodeL’gth
(
p
);

187 
u£d
;

189 
u£d
 = 
	`zm­EncodeL’gth
(
NULL
,
l
);

190 
u£d
 +ğ
p
[u£d] + 1 + 
l
;

191  
u£d
;

192 
	}
}

197 
	$zm­RawEÁryL’gth
(*
p
) {

198 
l
 = 
	`zm­RawKeyL’gth
(
p
);

199  
l
 + 
	`zm­RawV®ueL’gth
(
p
+l);

200 
	}
}

202 
šlše
 *
	$zm­Resize
(*
zm
, 
Ën
) {

203 
zm
 = 
	`z»®loc
(zm, 
Ën
);

204 
zm
[
Ën
-1] = 
ZIPMAP_END
;

205  
zm
;

206 
	}
}

211 *
	$zm­S‘
(*
zm
, *
key
, 
kËn
, *
v®
, 
vËn
, *
upd©e
) {

212 
zmËn
, 
off£t
;

213 
ä“Ën
, 
»qËn
 = 
	`zm­RequœedL’gth
(
kËn
,
vËn
);

214 
em±y
, 
vem±y
;

215 *
p
;

217 
ä“Ën
 = 
»qËn
;

218 ià(
upd©e
) *update = 0;

219 
p
 = 
	`zm­LookupRaw
(
zm
,
key
,
kËn
,&
zmËn
);

220 ià(
p
 =ğ
NULL
) {

222 
zm
 = 
	`zm­Resize
(zm, 
zmËn
+
»qËn
);

223 
p
 = 
zm
+
zmËn
-1;

224 
zmËn
 = zmËn+
»qËn
;

227 ià(
zm
[0] < 
ZIPMAP_BIGLEN
) zm[0]++;

231 ià(
upd©e
) *update = 1;

232 
ä“Ën
 = 
	`zm­RawEÁryL’gth
(
p
);

233 ià(
ä“Ën
 < 
»qËn
) {

237 
off£t
 = 
p
-
zm
;

238 
zm
 = 
	`zm­Resize
(zm, 
zmËn
-
ä“Ën
+
»qËn
);

239 
p
 = 
zm
+
off£t
;

243 
	`memmove
(
p
+
»qËn
,…+
ä“Ën
, 
zmËn
-(
off£t
+freelen+1));

244 
zmËn
 = zmËn-
ä“Ën
+
»qËn
;

245 
ä“Ën
 = 
»qËn
;

253 
em±y
 = 
ä“Ën
-
»qËn
;

254 ià(
em±y
 >ğ
ZIPMAP_VALUE_MAX_FREE
) {

257 
off£t
 = 
p
-
zm
;

258 
	`memmove
(
p
+
»qËn
,…+
ä“Ën
, 
zmËn
-(
off£t
+freelen+1));

259 
zmËn
 -ğ
em±y
;

260 
zm
 = 
	`zm­Resize
(zm, 
zmËn
);

261 
p
 = 
zm
+
off£t
;

262 
vem±y
 = 0;

264 
vem±y
 = 
em±y
;

269 
p
 +ğ
	`zm­EncodeL’gth
Õ,
kËn
);

270 
	`memıy
(
p
,
key
,
kËn
);

271 
p
 +ğ
kËn
;

273 
p
 +ğ
	`zm­EncodeL’gth
Õ,
vËn
);

274 *
p
++ = 
vem±y
;

275 
	`memıy
(
p
,
v®
,
vËn
);

276  
zm
;

277 
	}
}

281 *
	$zm­D–
(*
zm
, *
key
, 
kËn
, *
d–‘ed
) {

282 
zmËn
, 
ä“Ën
;

283 *
p
 = 
	`zm­LookupRaw
(
zm
,
key
,
kËn
,&
zmËn
);

284 ià(
p
) {

285 
ä“Ën
 = 
	`zm­RawEÁryL’gth
(
p
);

286 
	`memmove
(
p
,…+
ä“Ën
, 
zmËn
-(Õ-
zm
)+freelen+1));

287 
zm
 = 
	`zm­Resize
(zm, 
zmËn
-
ä“Ën
);

290 ià(
zm
[0] < 
ZIPMAP_BIGLEN
) zm[0]--;

292 ià(
d–‘ed
) *deleted = 1;

294 ià(
d–‘ed
) *deleted = 0;

296  
zm
;

297 
	}
}

300 *
	$zm­Rewšd
(*
zm
) {

301  
zm
+1;

302 
	}
}

315 *
	$zm­Next
(*
zm
, **
key
, *
kËn
, **
v®ue
, *
vËn
) {

316 ià(
zm
[0] =ğ
ZIPMAP_END
è 
NULL
;

317 ià(
key
) {

318 *
key
 = 
zm
;

319 *
kËn
 = 
	`zm­DecodeL’gth
(
zm
);

320 *
key
 +ğ
	`ZIPMAP_LEN_BYTES
(*
kËn
);

322 
zm
 +ğ
	`zm­RawKeyL’gth
(zm);

323 ià(
v®ue
) {

324 *
v®ue
 = 
zm
+1;

325 *
vËn
 = 
	`zm­DecodeL’gth
(
zm
);

326 *
v®ue
 +ğ
	`ZIPMAP_LEN_BYTES
(*
vËn
);

328 
zm
 +ğ
	`zm­RawV®ueL’gth
(zm);

329  
zm
;

330 
	}
}

334 
	$zm­G‘
(*
zm
, *
key
, 
kËn
, **
v®ue
, *
vËn
) {

335 *
p
;

337 ià((
p
 = 
	`zm­LookupRaw
(
zm
,
key
,
kËn
,
NULL
)) == NULL)  0;

338 
p
 +ğ
	`zm­RawKeyL’gth
(p);

339 *
vËn
 = 
	`zm­DecodeL’gth
(
p
);

340 *
v®ue
 = 
p
 + 
	`ZIPMAP_LEN_BYTES
(*
vËn
) + 1;

342 
	}
}

345 
	$zm­Exi¡s
(*
zm
, *
key
, 
kËn
) {

346  
	`zm­LookupRaw
(
zm
,
key
,
kËn
,
NULL
) != NULL;

347 
	}
}

350 
	$zm­L’
(*
zm
) {

351 
Ën
 = 0;

352 ià(
zm
[0] < 
ZIPMAP_BIGLEN
) {

353 
Ën
 = 
zm
[0];

355 *
p
 = 
	`zm­Rewšd
(
zm
);

356 (
p
 = 
	`zm­Next
Õ,
NULL
,NULL,NULL,NULL)è!ğNULLè
Ën
++;

359 ià(
Ën
 < 
ZIPMAP_BIGLEN
è
zm
[0] =†en;

361  
Ën
;

362 
	}
}

367 
size_t
 
	$zm­BlobL’
(*
zm
) {

368 
tÙËn
;

369 
	`zm­LookupRaw
(
zm
,
NULL
,0,&
tÙËn
);

370  
tÙËn
;

371 
	}
}

373 #ifdeà
REDIS_TEST


374 
	$zm­R•r
(*
p
) {

375 
l
;

377 
	`´štf
("{¡©u %u}",*
p
++);

379 ià(
p
[0] =ğ
ZIPMAP_END
) {

380 
	`´štf
("{end}");

383 
e
;

385 
l
 = 
	`zm­DecodeL’gth
(
p
);

386 
	`´štf
("{key %u}",
l
);

387 
p
 +ğ
	`zm­EncodeL’gth
(
NULL
,
l
);

388 ià(
l
 !ğ0 && 
	`fwr™e
(
p
,l,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

389 
p
 +ğ
l
;

391 
l
 = 
	`zm­DecodeL’gth
(
p
);

392 
	`´štf
("{v®u%u}",
l
);

393 
p
 +ğ
	`zm­EncodeL’gth
(
NULL
,
l
);

394 
e
 = *
p
++;

395 ià(
l
 !ğ0 && 
	`fwr™e
(
p
,l,1,
¡dout
è=ğ0è
	`³¼Ü
("fwrite");

396 
p
 +ğ
l
+
e
;

397 ià(
e
) {

398 
	`´štf
("[");

399 
e
--è
	`´štf
(".");

400 
	`´štf
("]");

404 
	`´štf
("\n");

405 
	}
}

407 
	#UNUSED
(
x
è()(x)

	)

408 
	$zm­Te¡
(
¬gc
, *
¬gv
[]) {

409 *
zm
;

411 
	`UNUSED
(
¬gc
);

412 
	`UNUSED
(
¬gv
);

414 
zm
 = 
	`zm­New
();

416 
zm
 = 
	`zm­S‘
(zm,(*è"Çme",4, (*è"foo",3,
NULL
);

417 
zm
 = 
	`zm­S‘
(zm,(*è"suºame",7, (*è"foo",3,
NULL
);

418 
zm
 = 
	`zm­S‘
(zm,(*è"age",3, (*è"foo",3,
NULL
);

419 
	`zm­R•r
(
zm
);

421 
zm
 = 
	`zm­S‘
(zm,(*è"h–lo",5, (*è"wÜld!",6,
NULL
);

422 
zm
 = 
	`zm­S‘
(zm,(*è"foo",3, (*è"b¬",3,
NULL
);

423 
zm
 = 
	`zm­S‘
(zm,(*è"foo",3, (*è"!",1,
NULL
);

424 
	`zm­R•r
(
zm
);

425 
zm
 = 
	`zm­S‘
(zm,(*è"foo",3, (*è"12345",5,
NULL
);

426 
	`zm­R•r
(
zm
);

427 
zm
 = 
	`zm­S‘
(zm,(*è"Ãw",3, (*è"xx",2,
NULL
);

428 
zm
 = 
	`zm­S‘
(zm,(*è"nov®",5, (*è"",0,
NULL
);

429 
	`zm­R•r
(
zm
);

430 
zm
 = 
	`zm­D–
(zm,(*è"Ãw",3,
NULL
);

431 
	`zm­R•r
(
zm
);

433 
	`´štf
("\nLook up†arge key:\n");

435 
buf
[512];

436 *
v®ue
;

437 
vËn
, 
i
;

438 
i
 = 0; i < 512; i++è
buf
[i] = 'a';

440 
zm
 = 
	`zm­S‘
(zm,
buf
,512,(*è"lÚg",4,
NULL
);

441 ià(
	`zm­G‘
(
zm
,
buf
,512,&
v®ue
,&
vËn
)) {

442 
	`´štf
(" <long key> is‡ssociatedohe %d bytes value: %.*s\n",

443 
vËn
, vËn, 
v®ue
);

447 
	`´štf
("\nPerform‡ direct†ookup:\n");

449 *
v®ue
;

450 
vËn
;

452 ià(
	`zm­G‘
(
zm
,(*è"foo",3,&
v®ue
,&
vËn
)) {

453 
	`´štf
(" foo is‡ssociatedohe %d bytes value: %.*s\n",

454 
vËn
, vËn, 
v®ue
);

457 
	`´štf
("\nIteratehroughƒlements:\n");

459 *
i
 = 
	`zm­Rewšd
(
zm
);

460 *
key
, *
v®ue
;

461 
kËn
, 
vËn
;

463 (
i
 = 
	`zm­Next
(i,&
key
,&
kËn
,&
v®ue
,&
vËn
)è!ğ
NULL
) {

464 
	`´štf
(" %d:%.* => %d:%.*s\n", 
kËn
, kËn, 
key
, 
vËn
, vËn, 
v®ue
);

468 
	}
}

	@src/zipmap.h

35 #iâdeà
_ZIPMAP_H


36 
	#_ZIPMAP_H


	)

38 *
zm­New
();

39 *
zm­S‘
(*
zm
, *
key
, 
kËn
, *
v®
, 
vËn
, *
upd©e
);

40 *
zm­D–
(*
zm
, *
key
, 
kËn
, *
d–‘ed
);

41 *
zm­Rewšd
(*
zm
);

42 *
zm­Next
(*
zm
, **
key
, *
kËn
, **
v®ue
, *
vËn
);

43 
zm­G‘
(*
zm
, *
key
, 
kËn
, **
v®ue
, *
vËn
);

44 
zm­Exi¡s
(*
zm
, *
key
, 
kËn
);

45 
zm­L’
(*
zm
);

46 
size_t
 
zm­BlobL’
(*
zm
);

47 
zm­R•r
(*
p
);

49 #ifdeà
REDIS_TEST


50 
zm­Te¡
(
¬gc
, *
¬gv
[]);

	@src/zmalloc.c

31 
	~<¡dio.h
>

32 
	~<¡dlib.h
>

38 
	$zlibc_ä“
(*
±r
) {

39 
	`ä“
(
±r
);

40 
	}
}

42 
	~<¡ršg.h
>

43 
	~<±h»ad.h
>

44 
	~"cÚfig.h
"

45 
	~"zm®loc.h
"

47 #ifdeà
HAVE_MALLOC_SIZE


48 
	#PREFIX_SIZE
 (0)

	)

50 #ià
defšed
(
__sun
è|| defšed(
__¥¬c
è|| defšed(
__¥¬c__
)

51 
	#PREFIX_SIZE
 (())

	)

53 
	#PREFIX_SIZE
 ((
size_t
))

	)

58 #ià
defšed
(
USE_TCMALLOC
)

59 
	#m®loc
(
size
è
	`tc_m®loc
(size)

	)

60 
	#ÿÎoc
(
couÁ
,
size
è
	`tc_ÿÎoc
(couÁ,size)

	)

61 
	#»®loc
(
±r
,
size
è
	`tc_»®loc
ÕŒ,size)

	)

62 
	#ä“
(
±r
è
	`tc_ä“
ÕŒ)

	)

63 #–ià
defšed
(
USE_JEMALLOC
)

64 
	#m®loc
(
size
è
	`je_m®loc
(size)

	)

65 
	#ÿÎoc
(
couÁ
,
size
è
	`je_ÿÎoc
(couÁ,size)

	)

66 
	#»®loc
(
±r
,
size
è
	`je_»®loc
ÕŒ,size)

	)

67 
	#ä“
(
±r
è
	`je_ä“
ÕŒ)

	)

70 #ià
defšed
(
__ATOMIC_RELAXED
)

71 
	#upd©e_zm®loc_¡©_add
(
__n
è
	`__©omic_add_ãtch
(&
u£d_memÜy
, (__n), 
__ATOMIC_RELAXED
)

	)

72 
	#upd©e_zm®loc_¡©_sub
(
__n
è
	`__©omic_sub_ãtch
(&
u£d_memÜy
, (__n), 
__ATOMIC_RELAXED
)

	)

73 #–ià
defšed
(
HAVE_ATOMIC
)

74 
	#upd©e_zm®loc_¡©_add
(
__n
è
	`__sync_add_ªd_ãtch
(&
u£d_memÜy
, (__n))

	)

75 
	#upd©e_zm®loc_¡©_sub
(
__n
è
	`__sync_sub_ªd_ãtch
(&
u£d_memÜy
, (__n))

	)

77 
	#upd©e_zm®loc_¡©_add
(
__n
) do { \

78 
	`±h»ad_mu‹x_lock
(&
u£d_memÜy_mu‹x
); \

79 
u£d_memÜy
 +ğ(
__n
); \

80 
	`±h»ad_mu‹x_uÆock
(&
u£d_memÜy_mu‹x
); \

81 } 0)

	)

83 
	#upd©e_zm®loc_¡©_sub
(
__n
) do { \

84 
	`±h»ad_mu‹x_lock
(&
u£d_memÜy_mu‹x
); \

85 
u£d_memÜy
 -ğ(
__n
); \

86 
	`±h»ad_mu‹x_uÆock
(&
u£d_memÜy_mu‹x
); \

87 } 0)

	)

91 
	#upd©e_zm®loc_¡©_®loc
(
__n
) do { \

92 
size_t
 
_n
 = (
__n
); \

93 ià(
_n
&(()-1)) _n += ()-(_n&(()-1)); \

94 ià(
zm®loc_th»ad_§ã
) { \

95 
	`upd©e_zm®loc_¡©_add
(
_n
); \

97 
u£d_memÜy
 +ğ
_n
; \

99 } 0)

	)

101 
	#upd©e_zm®loc_¡©_ä“
(
__n
) do { \

102 
size_t
 
_n
 = (
__n
); \

103 ià(
_n
&(()-1)) _n += ()-(_n&(()-1)); \

104 ià(
zm®loc_th»ad_§ã
) { \

105 
	`upd©e_zm®loc_¡©_sub
(
_n
); \

107 
u£d_memÜy
 -ğ
_n
; \

109 } 0)

	)

111 
size_t
 
	gu£d_memÜy
 = 0;

112 
	gzm®loc_th»ad_§ã
 = 0;

113 
±h»ad_mu‹x_t
 
	gu£d_memÜy_mu‹x
 = 
PTHREAD_MUTEX_INITIALIZER
;

115 
	$zm®loc_deçuÉ_oom
(
size_t
 
size
) {

116 
	`årštf
(
¡d”r
, "zmalloc: Out of memoryryingo‡llocate %zu bytes\n",

117 
size
);

118 
	`fæush
(
¡d”r
);

119 
	`abÜt
();

120 
	}
}

122 (*
zm®loc_oom_hªdËr
)(
size_t
èğ
zm®loc_deçuÉ_oom
;

124 *
	$zm®loc
(
size_t
 
size
) {

125 *
±r
 = 
	`m®loc
(
size
+
PREFIX_SIZE
);

127 ià(!
±r
è
	`zm®loc_oom_hªdËr
(
size
);

128 #ifdeà
HAVE_MALLOC_SIZE


129 
	`upd©e_zm®loc_¡©_®loc
(
	`zm®loc_size
(
±r
));

130  
±r
;

132 *((
size_t
*)
±r
èğ
size
;

133 
	`upd©e_zm®loc_¡©_®loc
(
size
+
PREFIX_SIZE
);

134  (*)
±r
+
PREFIX_SIZE
;

136 
	}
}

138 *
	$zÿÎoc
(
size_t
 
size
) {

139 *
±r
 = 
	`ÿÎoc
(1, 
size
+
PREFIX_SIZE
);

141 ià(!
±r
è
	`zm®loc_oom_hªdËr
(
size
);

142 #ifdeà
HAVE_MALLOC_SIZE


143 
	`upd©e_zm®loc_¡©_®loc
(
	`zm®loc_size
(
±r
));

144  
±r
;

146 *((
size_t
*)
±r
èğ
size
;

147 
	`upd©e_zm®loc_¡©_®loc
(
size
+
PREFIX_SIZE
);

148  (*)
±r
+
PREFIX_SIZE
;

150 
	}
}

152 *
	$z»®loc
(*
±r
, 
size_t
 
size
) {

153 #iâdeà
HAVE_MALLOC_SIZE


154 *
»®±r
;

156 
size_t
 
Şdsize
;

157 *
Ãw±r
;

159 ià(
±r
 =ğ
NULL
è 
	`zm®loc
(
size
);

160 #ifdeà
HAVE_MALLOC_SIZE


161 
Şdsize
 = 
	`zm®loc_size
(
±r
);

162 
Ãw±r
 = 
	`»®loc
(
±r
,
size
);

163 ià(!
Ãw±r
è
	`zm®loc_oom_hªdËr
(
size
);

165 
	`upd©e_zm®loc_¡©_ä“
(
Şdsize
);

166 
	`upd©e_zm®loc_¡©_®loc
(
	`zm®loc_size
(
Ãw±r
));

167  
Ãw±r
;

169 
»®±r
 = (*)
±r
-
PREFIX_SIZE
;

170 
Şdsize
 = *((
size_t
*)
»®±r
);

171 
Ãw±r
 = 
	`»®loc
(
»®±r
,
size
+
PREFIX_SIZE
);

172 ià(!
Ãw±r
è
	`zm®loc_oom_hªdËr
(
size
);

174 *((
size_t
*)
Ãw±r
èğ
size
;

175 
	`upd©e_zm®loc_¡©_ä“
(
Şdsize
);

176 
	`upd©e_zm®loc_¡©_®loc
(
size
);

177  (*)
Ãw±r
+
PREFIX_SIZE
;

179 
	}
}

184 #iâdeà
HAVE_MALLOC_SIZE


185 
size_t
 
	$zm®loc_size
(*
±r
) {

186 *
»®±r
 = (*)
±r
-
PREFIX_SIZE
;

187 
size_t
 
size
 = *((size_t*)
»®±r
);

190 ià(
size
&(()-1)) size += ()-(size&(()-1));

191  
size
+
PREFIX_SIZE
;

192 
	}
}

195 
	$zä“
(*
±r
) {

196 #iâdeà
HAVE_MALLOC_SIZE


197 *
»®±r
;

198 
size_t
 
Şdsize
;

201 ià(
±r
 =ğ
NULL
) ;

202 #ifdeà
HAVE_MALLOC_SIZE


203 
	`upd©e_zm®loc_¡©_ä“
(
	`zm®loc_size
(
±r
));

204 
	`ä“
(
±r
);

206 
»®±r
 = (*)
±r
-
PREFIX_SIZE
;

207 
Şdsize
 = *((
size_t
*)
»®±r
);

208 
	`upd©e_zm®loc_¡©_ä“
(
Şdsize
+
PREFIX_SIZE
);

209 
	`ä“
(
»®±r
);

211 
	}
}

213 *
	$z¡rdup
(cÚ¡ *
s
) {

214 
size_t
 
l
 = 
	`¡¾’
(
s
)+1;

215 *
p
 = 
	`zm®loc
(
l
);

217 
	`memıy
(
p
,
s
,
l
);

218  
p
;

219 
	}
}

221 
size_t
 
	$zm®loc_u£d_memÜy
() {

222 
size_t
 
um
;

224 ià(
zm®loc_th»ad_§ã
) {

225 #ià
	`defšed
(
__ATOMIC_RELAXED
è|| defšed(
HAVE_ATOMIC
)

226 
um
 = 
	`upd©e_zm®loc_¡©_add
(0);

228 
	`±h»ad_mu‹x_lock
(&
u£d_memÜy_mu‹x
);

229 
um
 = 
u£d_memÜy
;

230 
	`±h»ad_mu‹x_uÆock
(&
u£d_memÜy_mu‹x
);

234 
um
 = 
u£d_memÜy
;

237  
um
;

238 
	}
}

240 
	$zm®loc_’abË_th»ad_§ãÃss
() {

241 
zm®loc_th»ad_§ã
 = 1;

242 
	}
}

244 
	$zm®loc_£t_oom_hªdËr
((*
oom_hªdËr
)(
size_t
)) {

245 
zm®loc_oom_hªdËr
 = 
oom_hªdËr
;

246 
	}
}

258 #ià
defšed
(
HAVE_PROC_STAT
)

259 
	~<uni¡d.h
>

260 
	~<sys/ty³s.h
>

261 
	~<sys/¡©.h
>

262 
	~<fú.h
>

264 
size_t
 
	$zm®loc_g‘_rss
() {

265 
·ge
 = 
	`syscÚf
(
_SC_PAGESIZE
);

266 
size_t
 
rss
;

267 
buf
[4096];

268 
f’ame
[256];

269 
fd
, 
couÁ
;

270 *
p
, *
x
;

272 
	`¢´štf
(
f’ame
,256,"/´oc/%d/¡©",
	`g‘pid
());

273 ià((
fd
 = 
	`İ’
(
f’ame
,
O_RDONLY
)) == -1)  0;

274 ià(
	`»ad
(
fd
,
buf
,4096) <= 0) {

275 
	`şo£
(
fd
);

278 
	`şo£
(
fd
);

280 
p
 = 
buf
;

281 
couÁ
 = 23;

282 
p
 && 
couÁ
--) {

283 
p
 = 
	`¡rchr
(p,' ');

284 ià(
p
)…++;

286 ià(!
p
)  0;

287 
x
 = 
	`¡rchr
(
p
,' ');

288 ià(!
x
)  0;

289 *
x
 = '\0';

291 
rss
 = 
	`¡¹Şl
(
p
,
NULL
,10);

292 
rss
 *ğ
·ge
;

293  
rss
;

294 
	}
}

295 #–ià
defšed
(
HAVE_TASKINFO
)

296 
	~<uni¡d.h
>

297 
	~<¡dio.h
>

298 
	~<¡dlib.h
>

299 
	~<sys/ty³s.h
>

300 
	~<sys/sysùl.h
>

301 
	~<mach/sk.h
>

302 
	~<mach/mach_š™.h
>

304 
size_t
 
	$zm®loc_g‘_rss
() {

305 
sk_t
 
sk
 = 
MACH_PORT_NULL
;

306 
sk_basic_šfo
 
t_šfo
;

307 
mach_msg_ty³_numb”_t
 
t_šfo_couÁ
 = 
TASK_BASIC_INFO_COUNT
;

309 ià(
	`sk_fÜ_pid
(
	`cu¼’t_sk
(), 
	`g‘pid
(), &
sk
è!ğ
KERN_SUCCESS
)

311 
	`sk_šfo
(
sk
, 
TASK_BASIC_INFO
, (
sk_šfo_t
)&
t_šfo
, &
t_šfo_couÁ
);

313  
t_šfo
.
»sid’t_size
;

314 
	}
}

316 
size_t
 
	$zm®loc_g‘_rss
() {

322  
	`zm®loc_u£d_memÜy
();

323 
	}
}

327 
	$zm®loc_g‘_äagm’tiÚ_¿tio
(
size_t
 
rss
) {

328  ()
rss
/
	`zm®loc_u£d_memÜy
();

329 
	}
}

337 #ià
defšed
(
HAVE_PROC_SMAPS
)

338 
size_t
 
	$zm®loc_g‘_sm­_by‹s_by_f›ld
(*
f›ld
) {

339 
lše
[1024];

340 
size_t
 
by‹s
 = 0;

341 
FILE
 *
å
 = 
	`fİ’
("/proc/self/smaps","r");

342 
æ’
 = 
	`¡¾’
(
f›ld
);

344 ià(!
å
)  0;

345 
	`fg‘s
(
lše
,Öše),
å
è!ğ
NULL
) {

346 ià(
	`¡ºcmp
(
lše
,
f›ld
,
æ’
) == 0) {

347 *
p
 = 
	`¡rchr
(
lše
,'k');

348 ià(
p
) {

349 *
p
 = '\0';

350 
by‹s
 +ğ
	`¡¹Ş
(
lše
+
æ’
,
NULL
,10) * 1024;

354 
	`fşo£
(
å
);

355  
by‹s
;

356 
	}
}

358 
size_t
 
	$zm®loc_g‘_sm­_by‹s_by_f›ld
(*
f›ld
) {

359 ((è
f›ld
);

361 
	}
}

364 
size_t
 
	$zm®loc_g‘_´iv©e_dœty
() {

365  
	`zm®loc_g‘_sm­_by‹s_by_f›ld
("Private_Dirty:");

366 
	}
}

381 
size_t
 
	$zm®loc_g‘_memÜy_size
() {

382 #ià
	`defšed
(
__unix__
è|| defšed(
__unix
è|| defšed(
unix
) || \

383 (
	`defšed
(
__APPLE__
è&& defšed(
__MACH__
))

384 #ià
	`defšed
(
CTL_HW
è&& (defšed(
HW_MEMSIZE
è|| defšed(
HW_PHYSMEM64
))

385 
mib
[2];

386 
mib
[0] = 
CTL_HW
;

387 #ià
	`defšed
(
HW_MEMSIZE
)

388 
mib
[1] = 
HW_MEMSIZE
;

389 #–ià
	`defšed
(
HW_PHYSMEM64
)

390 
mib
[1] = 
HW_PHYSMEM64
;

392 
št64_t
 
size
 = 0;

393 
size_t
 
Ën
 = (
size
);

394 ià(
	`sysùl
Ğ
mib
, 2, &
size
, &
Ën
, 
NULL
, 0) == 0)

395  (
size_t
)
size
;

398 #–ià
	`defšed
(
_SC_PHYS_PAGES
è&& defšed(
_SC_PAGESIZE
)

400  (
size_t
)
	`syscÚf
(
_SC_PHYS_PAGES
è* (size_t)syscÚf(
_SC_PAGESIZE
);

402 #–ià
	`defšed
(
CTL_HW
è&& (defšed(
HW_PHYSMEM
è|| defšed(
HW_REALMEM
))

404 
mib
[2];

405 
mib
[0] = 
CTL_HW
;

406 #ià
	`defšed
(
HW_REALMEM
)

407 
mib
[1] = 
HW_REALMEM
;

408 #–ià
	`defšed
(
HW_PYSMEM
)

409 
mib
[1] = 
HW_PHYSMEM
;

411 
size
 = 0;

412 
size_t
 
Ën
 = (
size
);

413 ià(
	`sysùl
(
mib
, 2, &
size
, &
Ën
, 
NULL
, 0) == 0)

414  (
size_t
)
size
;

421 
	}
}

	@src/zmalloc.h

31 #iâdeà
__ZMALLOC_H


32 
	#__ZMALLOC_H


	)

35 
	#__x¡r
(
s
è
	`__¡r
(s)

	)

36 
	#__¡r
(
s
è#s

	)

38 #ià
defšed
(
USE_TCMALLOC
)

39 
	#ZMALLOC_LIB
 ("tcm®loc-" 
	`__x¡r
(
TC_VERSION_MAJOR
è"." __x¡r(
TC_VERSION_MINOR
))

	)

40 
	~<googË/tcm®loc.h
>

41 #ià(
TC_VERSION_MAJOR
 =ğ1 && 
TC_VERSION_MINOR
 >= 6) || (TC_VERSION_MAJOR > 1)

42 
	#HAVE_MALLOC_SIZE
 1

	)

43 
	#zm®loc_size
(
p
è
	`tc_m®loc_size
Õ)

	)

48 #–ià
defšed
(
USE_JEMALLOC
)

49 
	#ZMALLOC_LIB
 ("jem®loc-" 
	`__x¡r
(
JEMALLOC_VERSION_MAJOR
è"." __x¡r(
JEMALLOC_VERSION_MINOR
è"." __x¡r(
JEMALLOC_VERSION_BUGFIX
))

	)

50 
	~<jem®loc/jem®loc.h
>

51 #ià(
JEMALLOC_VERSION_MAJOR
 =ğ2 && 
JEMALLOC_VERSION_MINOR
 >= 1) || (JEMALLOC_VERSION_MAJOR > 2)

52 
	#HAVE_MALLOC_SIZE
 1

	)

53 
	#zm®loc_size
(
p
è
	`je_m®loc_u§bË_size
Õ)

	)

58 #–ià
defšed
(
__APPLE__
)

59 
	~<m®loc/m®loc.h
>

60 
	#HAVE_MALLOC_SIZE
 1

	)

61 
	#zm®loc_size
(
p
è
	`m®loc_size
Õ)

	)

64 #iâdeà
ZMALLOC_LIB


65 
	#ZMALLOC_LIB
 "libc"

	)

68 *
zm®loc
(
size_t
 
size
);

69 *
zÿÎoc
(
size_t
 
size
);

70 *
z»®loc
(*
±r
, 
size_t
 
size
);

71 
zä“
(*
±r
);

72 *
z¡rdup
(cÚ¡ *
s
);

73 
size_t
 
zm®loc_u£d_memÜy
();

74 
zm®loc_’abË_th»ad_§ãÃss
();

75 
zm®loc_£t_oom_hªdËr
((*
oom_hªdËr
)(
size_t
));

76 
	`zm®loc_g‘_äagm’tiÚ_¿tio
(
size_t
 
rss
);

77 
size_t
 
	`zm®loc_g‘_rss
();

78 
size_t
 
	`zm®loc_g‘_´iv©e_dœty
();

79 
size_t
 
	`zm®loc_g‘_sm­_by‹s_by_f›ld
(*
f›ld
);

80 
size_t
 
	`zm®loc_g‘_memÜy_size
();

81 
	`zlibc_ä“
(*
±r
);

83 #iâdeà
HAVE_MALLOC_SIZE


84 
size_t
 
	`zm®loc_size
(*
±r
);

	@utils/corrupt_rdb.c

7 
	~<¡dio.h
>

8 
	~<fú.h
>

9 
	~<sys/¡©.h
>

10 
	~<¡dlib.h
>

11 
	~<uni¡d.h
>

12 
	~<time.h
>

14 
	$maš
(
¬gc
, **
¬gv
) {

15 
¡©
 stat;

16 
fd
, 
cyşes
;

18 ià(
¬gc
 != 3) {

19 
	`årštf
(
¡d”r
,"Usage: <filename> <cycles>\n");

20 
	`ex™
(1);

23 
	`¤ªd
(
	`time
(
NULL
));

24 
cyşes
 = 
	`©oi
(
¬gv
[2]);

25 
fd
 = 
	`İ’
("dump.rdb",
O_RDWR
);

26 ià(
fd
 == -1) {

27 
	`³¼Ü
("open");

28 
	`ex™
(1);

30 
	`f¡©
(
fd
,&
¡©
);

32 
cyşes
--) {

33 
buf
[32];

34 
off£t
 = 
	`¿nd
()%
¡©
.
¡_size
;

35 
wr™–’
 = 1+
	`¿nd
()%31;

36 
j
;

38 
j
 = 0; j < 
wr™–’
; j++è
buf
[j] = ()
	`¿nd
();

39 
	`l£ek
(
fd
,
off£t
,
SEEK_SET
);

40 
	`´štf
("Wr™šg %d by‹ © off£ˆ%lu\n", 
wr™–’
, 
off£t
);

41 
	`wr™e
(
fd
,
buf
,
wr™–’
);

44 
	}
}

	@utils/hashtable/rehashing.c

1 
	~"»dis.h
"

2 
	~"diù.h
"

4 
	$_»disAs£¹
(*
x
, *
y
, 
l
) {

5 
	`´štf
("ASSERT: % % %d\n",
x
,
y
,
l
);

6 
	`ex™
(1);

7 
	}
}

9 
	$diùKeyHash
(cÚ¡ *
keyp
) {

10 
key
 = ()
keyp
;

11 
key
 = 
	`diùG’HashFunùiÚ
(&key,(key));

12 
key
 += ~(key << 15);

13 
key
 ^= (key >> 10);

14 
key
 += (key << 3);

15 
key
 ^= (key >> 6);

16 
key
 += ~(key << 11);

17 
key
 ^= (key >> 16);

18  
key
;

19 
	}
}

21 
	$diùKeyCom·»
(*
´ivd©a
, cÚ¡ *
key1
, cÚ¡ *
key2
) {

22 
k1
 = ()
key1
;

23 
k2
 = ()
key2
;

24  
k1
 =ğ
k2
;

25 
	}
}

27 
diùTy³
 
	gdiùTy³Te¡
 = {

28 
diùKeyHash
,

29 
NULL
,

30 
NULL
,

31 
diùKeyCom·»
,

32 
NULL
,

33 
NULL


36 
	$showBuck‘s
(
diùht
 
ht
) {

37 ià(
ht
.
bË
 =ğ
NULL
) {

38 
	`´štf
("NULL\n");

40 
j
;

41 
j
 = 0; j < 
ht
.
size
; j++) {

42 
	`´štf
("%c", 
ht
.
bË
[
j
] ? '1' : '0');

44 
	`´štf
("\n");

46 
	}
}

48 
	$show
(
diù
 *
d
) {

49 
j
;

50 ià(
d
->
»hashidx
 != -1) {

51 
	`´štf
("rhidx: ");

52 
j
 = 0; j < 
d
->
»hashidx
; j++)

53 
	`´štf
(".");

54 
	`´štf
("|\n");

56 
	`´štf
("ht[0]: ");

57 
	`showBuck‘s
(
d
->
ht
[0]);

58 
	`´štf
("ht[1]: ");

59 
	`showBuck‘s
(
d
->
ht
[1]);

60 
	`´štf
("\n");

61 
	}
}

63 
	$sÜtPoš‹rs
(cÚ¡ *
a
, cÚ¡ *
b
) {

64 
Ï
, 
lb
;

66 
Ï
 = (è(*((
diùEÁry
**)
a
));

67 
lb
 = (è(*((
diùEÁry
**)
b
));

68  
Ï
-
lb
;

69 
	}
}

71 
	$¡»ssG‘Keys
(
diù
 *
d
, 
times
, *
³rãù_run
, *
­´ox_run
) {

72 
j
;

74 
diùEÁry
 **
des
 = 
	`zm®loc
((diùEÁry*)*
	`diùSize
(
d
));

75 
j
 = 0; j < 
times
; j++) {

76 
»que¡ed
 = 
	`¿nd
(è% (
	`diùSize
(
d
)+1);

77 
»tuºed
 = 
	`diùG‘SomeKeys
(
d
, 
des
, 
»que¡ed
);

78 
dup
 = 0;

80 
	`qsÜt
(
des
,
»tuºed
,(
diùEÁry
*),
sÜtPoš‹rs
);

81 ià(
»tuºed
 > 1) {

82 
i
;

83 
i
 = 0; i < 
»tuºed
-1; i++) {

84 ià(
des
[
i
] =ğdes[i+1]è
dup
++;

88 ià(
»que¡ed
 =ğ
»tuºed
 && 
dup
 == 0) {

89 (*
³rãù_run
)++;

91 (*
­´ox_run
)++;

92 
	`´štf
("Requested,„eturned, duplicated: %d %d %d\n",

93 
»que¡ed
, 
»tuºed
, 
dup
);

96 
	`zä“
(
des
);

97 
	}
}

99 
	#MAX1
 120

	)

100 
	#MAX2
 1000

	)

101 
	$maš
() {

102 
diù
 *
d
 = 
	`diùC»©e
(&
diùTy³Te¡
,
NULL
);

103 
i
;

104 
	`¤ªd
(
	`time
(
NULL
));

106 
i
 = 0; i < 
MAX1
; i++) {

107 
	`diùAdd
(
d
,(*)
i
,
NULL
);

108 
	`show
(
d
);

110 
	`´štf
("Size: %d\n", ()
	`diùSize
(
d
));

112 
i
 = 0; i < 
MAX1
; i++) {

113 
	`diùD–‘e
(
d
,(*)
i
);

114 
	`diùResize
(
d
);

115 
	`show
(
d
);

117 
	`diùR–—£
(
d
);

119 
d
 = 
	`diùC»©e
(&
diùTy³Te¡
,
NULL
);

121 
	`´štf
("Stressesting dictGetSomeKeys\n");

122 
³rãù_run
 = 0, 
­´ox_run
 = 0;

124 
i
 = 0; i < 
MAX2
; i++) {

125 
	`diùAdd
(
d
,(*)
i
,
NULL
);

126 
	`¡»ssG‘Keys
(
d
,100,&
³rãù_run
,&
­´ox_run
);

129 
i
 = 0; i < 
MAX2
; i++) {

130 
	`diùD–‘e
(
d
,(*)
i
);

131 
	`diùResize
(
d
);

132 
	`¡»ssG‘Keys
(
d
,100,&
³rãù_run
,&
­´ox_run
);

135 
	`´štf
("dictGetSomeKey, %d…erfect„uns, %d‡pproximated„uns\n",

136 
³rãù_run
, 
­´ox_run
);

138 
	`diùR–—£
(
d
);

140 
	`´štf
("TEST PASSED!\n");

142 
	}
}

	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/arpa/inet.h

18 #iâdeà
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<Ãtš‘/š.h
>

25 #iâdeà
__sockËn_t_defšed


26 
__sockËn_t
 
	tsockËn_t
;

27 
	#__sockËn_t_defšed


	)

30 
__BEGIN_DECLS


34 
š_addr_t
 
	$š‘_addr
 (cÚ¡ *
__ı
è
__THROW
;

37 
š_addr_t
 
	$š‘_Êaof
 (
š_addr
 
__š
è
__THROW
;

41 
š_addr
 
	$š‘_mak—ddr
 (
š_addr_t
 
__Ãt
, in_addr_ˆ
__ho¡
)

42 
__THROW
;

45 
š_addr_t
 
	$š‘_Ãtof
 (
š_addr
 
__š
è
__THROW
;

49 
š_addr_t
 
	$š‘_ÃtwÜk
 (cÚ¡ *
__ı
è
__THROW
;

53 *
	$š‘_Áß
 (
š_addr
 
__š
è
__THROW
;

58 
	$š‘_±Ú
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

59 *
__»¡riù
 
__buf
è
__THROW
;

64 cÚ¡ *
	$š‘_Áİ
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

65 *
__»¡riù
 
__buf
, 
sockËn_t
 
__Ën
)

66 
__THROW
;

70 #ifdeà
__USE_MISC


73 
	$š‘_©Ú
 (cÚ¡ *
__ı
, 
š_addr
 *
__šp
è
__THROW
;

77 *
	$š‘_Ã
 (
š_addr_t
 
__Ãt
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

82 *
	$š‘_Ãt_Áİ
 (
__af
, cÚ¡ *
__ı
, 
__b™s
,

83 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

88 
	$š‘_Ãt_±Ú
 (
__af
, cÚ¡ *
__ı
,

89 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

94 
	$š‘_n§p_addr
 (cÚ¡ *
__ı
,

95 *
__buf
, 
__Ën
è
__THROW
;

99 *
	$š‘_n§p_Áß
 (
__Ën
, cÚ¡ *
__ı
,

100 *
__buf
è
__THROW
;

103 
__END_DECLS


	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


91 #ià
defšed
 
__ılu¥lus


92 
	#as£¹
(
ex´
) \

93 (
¡©ic_ÿ¡
 <
boŞ
> (
ex´
) \

95 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #–ià!
defšed
 
__GNUC__
 || defšed 
__STRICT_ANSI__


97 
	#as£¹
(
ex´
) \

98 ((
ex´
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

107 
	#as£¹
(
ex´
) \

108 ((è ((
ex´
è? 1 : 0), 
	`__ex‹nsiÚ__
 ({ \

109 ià(
ex´
) \

112 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
); \

113 
	}
}))

	)

116 #ifdef 
__USE_GNU


117 
	#as£¹_³¼Ü
(
”ºum
) \

118 (!(
”ºum
) \

119 ? 
	`__ASSERT_VOID_CAST
 (0) \

120 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

128 #ià
defšed
 
__ılu¥lus
 ? 
__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

129 
	#__ASSERT_FUNCTION
 
__ex‹nsiÚ__
 
__PRETTY_FUNCTION__


	)

131 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

132 
	#__ASSERT_FUNCTION
 
__func__


	)

134 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

141 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


142 #undeà
¡©ic_as£¹


143 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

108 
__exùy³
 (
i§Êum
);

109 
__exùy³
 (
i§Íha
);

110 
__exùy³
 (
isúŒl
);

111 
__exùy³
 (
isdig™
);

112 
__exùy³
 (
i¦ow”
);

113 
__exùy³
 (
isg¿ph
);

114 
__exùy³
 (
i¥ršt
);

115 
__exùy³
 (
i¥unù
);

116 
__exùy³
 (
is¥aû
);

117 
__exùy³
 (
isuµ”
);

118 
__exùy³
 (
isxdig™
);

122 
	$tŞow”
 (
__c
è
__THROW
;

125 
	$touµ”
 (
__c
è
__THROW
;

129 #ifdef 
__USE_ISOC99


130 
	`__exùy³
 (
isbÏnk
);

133 #ifdeà
__USE_GNU


135 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

138 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


142 
	$i§scii
 (
__c
è
__THROW
;

146 
	$tßscii
 (
__c
è
__THROW
;

150 
	`__exùy³
 (
_touµ”
);

151 
	`__exùy³
 (
_tŞow”
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

156 (
__ex‹nsiÚ__
 \

157 ({ 
__»s
; \

158 ià( (
c
) > 1) \

160 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

166 
__»s
 = 
f
 
¬gs
; \

169 
__»s
 = (
a
)[(è(
c
)]; \

170 
__»s
; 
	}
}))

	)

172 #ià!
defšed
 
__NO_CTYPE


173 #ifdeà
__isùy³_f


174 
	$__isùy³_f
 (
®num
)

175 
	$__isùy³_f
 (
®pha
)

176 
	$__isùy³_f
 (
úŒl
)

177 
	$__isùy³_f
 (
dig™
)

178 
	$__isùy³_f
 (
low”
)

179 
	$__isùy³_f
 (
g¿ph
)

180 
	$__isùy³_f
 (
´št
)

181 
	$__isùy³_f
 (
punù
)

182 
	$__isùy³_f
 (
¥aû
)

183 
	$__isùy³_f
 (
uµ”
)

184 
	$__isùy³_f
 (
xdig™
)

185 #ifdeà
__USE_ISOC99


186 
	$__isùy³_f
 (
bÏnk
)

188 #–ià
defšed
 
__isùy³


189 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

190 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

191 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

192 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

193 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

194 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

195 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

196 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

197 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

198 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

199 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

200 #ifdeà
__USE_ISOC99


201 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

205 #ifdeà
__USE_EXTERN_INLINES


206 
__ex‹º_šlše
 

207 
	`__NTH
 (
	$tŞow”
 (
__c
))

209  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

210 
	}
}

212 
__ex‹º_šlše
 

213 
__NTH
 (
	$touµ”
 (
__c
))

215  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

216 
	}
}

219 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


220 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

221 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

224 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


225 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

226 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

228 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

229 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

235 #ifdeà
__USE_XOPEN2K8


237 
	~<b™s/ty³s/loÿË_t.h
>

241 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

242 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

244 
	#__exùy³_l
(
Çme
) \

245 
	`Çme
 (, 
loÿË_t
è
__THROW


	)

251 
__exùy³_l
 (
i§Êum_l
);

252 
__exùy³_l
 (
i§Íha_l
);

253 
__exùy³_l
 (
isúŒl_l
);

254 
__exùy³_l
 (
isdig™_l
);

255 
__exùy³_l
 (
i¦ow”_l
);

256 
__exùy³_l
 (
isg¿ph_l
);

257 
__exùy³_l
 (
i¥ršt_l
);

258 
__exùy³_l
 (
i¥unù_l
);

259 
__exùy³_l
 (
is¥aû_l
);

260 
__exùy³_l
 (
isuµ”_l
);

261 
__exùy³_l
 (
isxdig™_l
);

263 
__exùy³_l
 (
isbÏnk_l
);

267 
	$__tŞow”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

268 
	$tŞow”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

271 
	$__touµ”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

272 
	$touµ”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

274 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


275 
	#__tŞow”_l
(
c
, 
loÿË
) \

276 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

277 
	#__touµ”_l
(
c
, 
loÿË
) \

278 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

279 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

280 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

284 #iâdeà
__NO_CTYPE


285 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

286 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

287 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

288 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

289 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

290 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

291 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

292 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

293 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

294 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

295 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

297 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

299 #ifdeà
__USE_MISC


300 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

301 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

304 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

305 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

306 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

307 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

308 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

309 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

310 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

311 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

312 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

313 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

314 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

316 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

318 #ifdeà
__USE_MISC


319 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

320 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

327 
__END_DECLS


	@/usr/include/dlfcn.h

19 #iâdef 
_DLFCN_H


20 
	#_DLFCN_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

27 
	~<b™s/dlfú.h
>

30 #ifdeà
__USE_GNU


35 
	#RTLD_NEXT
 ((*è-1l)

	)

40 
	#RTLD_DEFAULT
 ((*è0)

	)

44 
	tLmid_t
;

47 
	#LM_ID_BASE
 0

	)

48 
	#LM_ID_NEWLM
 -1

	)

52 
__BEGIN_DECLS


56 *
	$dlİ’
 (cÚ¡ *
__fe
, 
__mode
è
__THROWNL
;

60 
	$dlşo£
 (*
__hªdË
è
__THROWNL
 
	`__nÚnuÎ
 ((1));

64 *
	$dlsym
 (*
__»¡riù
 
__hªdË
,

65 cÚ¡ *
__»¡riù
 
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((2));

67 #ifdeà
__USE_GNU


69 *
	$dlmİ’
 (
Lmid_t
 
__nsid
, cÚ¡ *
__fe
, 
__mode
è
__THROWNL
;

73 *
	$dlvsym
 (*
__»¡riù
 
__hªdË
,

74 cÚ¡ *
__»¡riù
 
__Çme
,

75 cÚ¡ *
__»¡riù
 
__v”siÚ
)

76 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

82 *
	$dË¼Ü
 (è
__THROW
;

85 #ifdeà
__USE_GNU


90 cÚ¡ *
dli_âame
;

91 *
dli_fba£
;

92 cÚ¡ *
dli_¢ame
;

93 *
dli_§ddr
;

94 } 
	tDl_šfo
;

98 
	$dÏddr
 (cÚ¡ *
__add»ss
, 
Dl_šfo
 *
__šfo
)

99 
__THROW
 
	`__nÚnuÎ
 ((2));

102 
	$dÏddr1
 (cÚ¡ *
__add»ss
, 
Dl_šfo
 *
__šfo
,

103 **
__exŒa_šfo
, 
__æags
è
__THROW
 
	`__nÚnuÎ
 ((2));

111 
RTLD_DL_SYMENT
 = 1,

114 
RTLD_DL_LINKMAP
 = 2

123 
	$dlšfo
 (*
__»¡riù
 
__hªdË
,

124 
__»que¡
, *
__»¡riù
 
__¬g
)

125 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

131 
RTLD_DI_LMID
 = 1,

135 
RTLD_DI_LINKMAP
 = 2,

137 
RTLD_DI_CONFIGADDR
 = 3,

144 
RTLD_DI_SERINFO
 = 4,

145 
RTLD_DI_SERINFOSIZE
 = 5,

149 
RTLD_DI_ORIGIN
 = 6,

151 
RTLD_DI_PROFILENAME
 = 7,

152 
RTLD_DI_PROFILEOUT
 = 8,

157 
RTLD_DI_TLS_MODID
 = 9,

163 
RTLD_DI_TLS_DATA
 = 10,

165 
RTLD_DI_MAX
 = 10

173 *
dls_Çme
;

174 
dls_æags
;

175 } 
	tDl_£½©h
;

181 
size_t
 
dls_size
;

182 
dls_út
;

183 
Dl_£½©h
 
dls_£½©h
[1];

184 } 
	tDl_£ršfo
;

188 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_MISC


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_MISC
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

61 
	~<b™s/ušŠ-id’t™y.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

80 
	#htobe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

81 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

82 
	#be16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

83 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

85 
	#htobe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

86 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

87 
	#be32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

88 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

90 
	#htobe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

91 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

92 
	#be64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

93 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


23 
	#_ERRNO_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/”ºo.h
>

32 #iâdeà
__ASSEMBLER__


34 
__BEGIN_DECLS


37 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
__©Œibu‹_cÚ¡__
;

38 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

40 #ifdeà
__USE_GNU


45 *
´og¿m_švoÿtiÚ_Çme
;

46 *
´og¿m_švoÿtiÚ_shÜt_Çme
;

50 #iâdeà
__”rÜ_t_defšed


51 
	#__”rÜ_t_defšed
 1

	)

52 
	t”rÜ_t
;

57 
__END_DECLS


	@/usr/include/event.h

27 #iâdeà
EVENT1_EVENT_H_INCLUDED_


28 
	#EVENT1_EVENT_H_INCLUDED_


	)

40 #ifdeà
__ılu¥lus


44 
	~<ev’t2/ev’t-cÚfig.h
>

45 #ifdeà
EVENT__HAVE_SYS_TYPES_H


46 
	~<sys/ty³s.h
>

48 #ifdeà
EVENT__HAVE_SYS_TIME_H


49 
	~<sys/time.h
>

51 #ifdeà
EVENT__HAVE_STDINT_H


52 
	~<¡dšt.h
>

54 
	~<¡d¬g.h
>

57 
	~<evut.h
>

59 #ifdeà
_WIN32


60 #iâdeà
WIN32_LEAN_AND_MEAN


61 
	#WIN32_LEAN_AND_MEAN


	)

63 
	~<wšsock2.h
>

64 
	~<wšdows.h
>

65 #undeà
WIN32_LEAN_AND_MEAN


68 
	~<ev’t2/ev’t_¡ruù.h
>

69 
	~<ev’t2/ev’t.h
>

70 
	~<ev’t2/ev’t_com·t.h
>

71 
	~<ev’t2/bufãr.h
>

72 
	~<ev’t2/bufãr_com·t.h
>

73 
	~<ev’t2/bufã»v’t.h
>

74 
	~<ev’t2/bufã»v’t_¡ruù.h
>

75 
	~<ev’t2/bufã»v’t_com·t.h
>

76 
	~<ev’t2/g.h
>

77 
	~<ev’t2/g_com·t.h
>

79 #ifdeà
__ılu¥lus


	@/usr/include/execinfo.h

18 #iâdeà
_EXECINFO_H


19 
	#_EXECINFO_H
 1

	)

21 
	~<ã©u»s.h
>

23 
__BEGIN_DECLS


27 
	$backŒaû
 (**
__¬¿y
, 
__size
è
	`__nÚnuÎ
 ((1));

32 **
	$backŒaû_symbŞs
 (*cÚ¡ *
__¬¿y
, 
__size
)

33 
__THROW
 
	`__nÚnuÎ
 ((1));

38 
	$backŒaû_symbŞs_fd
 (*cÚ¡ *
__¬¿y
, 
__size
, 
__fd
)

39 
__THROW
 
	`__nÚnuÎ
 ((1));

41 
__END_DECLS


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

39 #ifdeà
__O_TMPFILE


40 
	#__OPEN_NEEDS_MODE
(
oæag
) \

41 (((
oæag
è& 
O_CREAT
è!ğ0 || ((oæagè& 
__O_TMPFILE
è=ğ__O_TMPFILE)

	)

43 
	#__OPEN_NEEDS_MODE
(
oæag
è(((oæagè& 
O_CREAT
è!ğ0)

	)

49 #iâdeà
__mode_t_defšed


50 
__mode_t
 
	tmode_t
;

51 
	#__mode_t_defšed


	)

54 #iâdeà
__off_t_defšed


55 #iâdeà
__USE_FILE_OFFSET64


56 
__off_t
 
	toff_t
;

58 
__off64_t
 
	toff_t
;

60 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

68 #iâdeà
__pid_t_defšed


69 
__pid_t
 
	tpid_t
;

70 
	#__pid_t_defšed


	)

74 #ifdeà
__USE_XOPEN2K8


75 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

77 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


78 
	~<b™s/¡©.h
>

80 
	#S_IFMT
 
__S_IFMT


	)

81 
	#S_IFDIR
 
__S_IFDIR


	)

82 
	#S_IFCHR
 
__S_IFCHR


	)

83 
	#S_IFBLK
 
__S_IFBLK


	)

84 
	#S_IFREG
 
__S_IFREG


	)

85 #ifdeà
__S_IFIFO


86 
	#S_IFIFO
 
__S_IFIFO


	)

88 #ifdeà
__S_IFLNK


89 
	#S_IFLNK
 
__S_IFLNK


	)

91 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


92 
	#S_IFSOCK
 
__S_IFSOCK


	)

97 
	#S_ISUID
 
__S_ISUID


	)

98 
	#S_ISGID
 
__S_ISGID


	)

100 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


102 
	#S_ISVTX
 
__S_ISVTX


	)

105 
	#S_IRUSR
 
__S_IREAD


	)

106 
	#S_IWUSR
 
__S_IWRITE


	)

107 
	#S_IXUSR
 
__S_IEXEC


	)

109 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

111 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

112 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

113 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

115 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

117 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

118 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

119 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

121 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

124 #ifdef 
__USE_MISC


125 #iâdeà
R_OK


128 
	#R_OK
 4

	)

129 
	#W_OK
 2

	)

130 
	#X_OK
 1

	)

131 
	#F_OK
 0

	)

136 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


137 
	#SEEK_SET
 0

	)

138 
	#SEEK_CUR
 1

	)

139 
	#SEEK_END
 2

	)

147 
fú
 (
__fd
, 
__cmd
, ...);

156 #iâdeà
__USE_FILE_OFFSET64


157 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

159 #ifdeà
__REDIRECT


160 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

161 
	`__nÚnuÎ
 ((1));

163 
	#İ’
 
İ’64


	)

166 #ifdeà
__USE_LARGEFILE64


167 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

170 #ifdeà
__USE_ATFILE


180 #iâdeà
__USE_FILE_OFFSET64


181 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

182 
	`__nÚnuÎ
 ((2));

184 #ifdeà
__REDIRECT


185 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

186 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

188 
	#İ’©
 
İ’©64


	)

191 #ifdeà
__USE_LARGEFILE64


192 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

193 
	`__nÚnuÎ
 ((2));

202 #iâdeà
__USE_FILE_OFFSET64


203 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

205 #ifdeà
__REDIRECT


206 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

207 
ü—t64
è
	`__nÚnuÎ
 ((1));

209 
	#ü—t
 
ü—t64


	)

212 #ifdeà
__USE_LARGEFILE64


213 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

216 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

217 && !
defšed
 
__USE_POSIX
))

226 
	#F_ULOCK
 0

	)

227 
	#F_LOCK
 1

	)

228 
	#F_TLOCK
 2

	)

229 
	#F_TEST
 3

	)

231 #iâdeà
__USE_FILE_OFFSET64


232 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

234 #ifdeà
__REDIRECT


235 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

237 
	#lockf
 
lockf64


	)

240 #ifdeà
__USE_LARGEFILE64


241 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

245 #ifdeà
__USE_XOPEN2K


248 #iâdeà
__USE_FILE_OFFSET64


249 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

250 
__advi£
è
__THROW
;

252 #ifdeà
__REDIRECT_NTH


253 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

254 
__off64_t
 
__Ën
, 
__advi£
),

255 
posix_çdvi£64
);

257 
	#posix_çdvi£
 
posix_çdvi£64


	)

260 #ifdeà
__USE_LARGEFILE64


261 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

262 
__advi£
è
__THROW
;

270 #iâdeà
__USE_FILE_OFFSET64


271 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

273 #ifdeà
__REDIRECT


274 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

275 
__off64_t
 
__Ën
),

276 
posix_çÎoÿ‹64
);

278 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

281 #ifdeà
__USE_LARGEFILE64


282 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

288 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

289 && 
defšed
 
__va_¬g_·ck_Ën


290 
	~<b™s/fú2.h
>

293 
__END_DECLS


	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

119 #undeà
__USE_ISOC11


120 #undeà
__USE_ISOC99


121 #undeà
__USE_ISOC95


122 #undeà
__USE_ISOCXX11


123 #undeà
__USE_POSIX


124 #undeà
__USE_POSIX2


125 #undeà
__USE_POSIX199309


126 #undeà
__USE_POSIX199506


127 #undeà
__USE_XOPEN


128 #undeà
__USE_XOPEN_EXTENDED


129 #undeà
__USE_UNIX98


130 #undeà
__USE_XOPEN2K


131 #undeà
__USE_XOPEN2KXSI


132 #undeà
__USE_XOPEN2K8


133 #undeà
__USE_XOPEN2K8XSI


134 #undeà
__USE_LARGEFILE


135 #undeà
__USE_LARGEFILE64


136 #undeà
__USE_FILE_OFFSET64


137 #undeà
__USE_MISC


138 #undeà
__USE_ATFILE


139 #undeà
__USE_GNU


140 #undeà
__USE_FORTIFY_LEVEL


141 #undeà
__KERNEL_STRICT_NAMES


142 #undeà
__GLIBC_USE_DEPRECATED_GETS


146 #iâdeà
_LOOSE_KERNEL_NAMES


147 
	#__KERNEL_STRICT_NAMES


	)

157 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


158 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

159 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

161 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

168 #ià
defšed
 
__şªg_majÜ__
 && defšed 
__şªg_mšÜ__


169 
	#__glibc_şªg_´”eq
(
maj
, 
mš
) \

170 ((
__şªg_majÜ__
 << 16è+ 
__şªg_mšÜ__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

172 
	#__glibc_şªg_´”eq
(
maj
, 
mš
è0

	)

176 
	#__GLIBC_USE
(
F
è
__GLIBC_USE_
 ## 
	)
F

182 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

183 && !
defšed
 
	g_DEFAULT_SOURCE


185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

190 #ifdeà
_GNU_SOURCE


191 #undeà
_ISOC95_SOURCE


192 
	#_ISOC95_SOURCE
 1

	)

193 #undeà
_ISOC99_SOURCE


194 
	#_ISOC99_SOURCE
 1

	)

195 #undeà
_ISOC11_SOURCE


196 
	#_ISOC11_SOURCE
 1

	)

197 #undeà
_POSIX_SOURCE


198 
	#_POSIX_SOURCE
 1

	)

199 #undeà
_POSIX_C_SOURCE


200 
	#_POSIX_C_SOURCE
 200809L

	)

201 #undeà
_XOPEN_SOURCE


202 
	#_XOPEN_SOURCE
 700

	)

203 #undeà
_XOPEN_SOURCE_EXTENDED


204 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

205 #undeà
_LARGEFILE64_SOURCE


206 
	#_LARGEFILE64_SOURCE
 1

	)

207 #undeà
_DEFAULT_SOURCE


208 
	#_DEFAULT_SOURCE
 1

	)

209 #undeà
_ATFILE_SOURCE


210 
	#_ATFILE_SOURCE
 1

	)

215 #ià(
defšed
 
_DEFAULT_SOURCE
 \

216 || (!
defšed
 
	g__STRICT_ANSI__
 \

217 && !
defšed
 
	g_ISOC99_SOURCE
 \

218 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

219 && !
defšed
 
	g_XOPEN_SOURCE
))

220 #undeà
_DEFAULT_SOURCE


221 
	#_DEFAULT_SOURCE
 1

	)

225 #ià(
defšed
 
_ISOC11_SOURCE
 \

226 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

227 
	#__USE_ISOC11
 1

	)

231 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

232 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

233 
	#__USE_ISOC99
 1

	)

237 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

238 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

239 
	#__USE_ISOC95
 1

	)

242 #ifdeà
__ılu¥lus


244 #ià
__ılu¥lus
 >= 201703L

245 
	#__USE_ISOC11
 1

	)

249 #ià
__ılu¥lus
 >ğ201103L || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__


250 
	#__USE_ISOCXX11
 1

	)

251 
	#__USE_ISOC99
 1

	)

258 #ifdeà
_DEFAULT_SOURCE


259 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


260 
	#__USE_POSIX_IMPLICITLY
 1

	)

262 #undeà
_POSIX_SOURCE


263 
	#_POSIX_SOURCE
 1

	)

264 #undeà
_POSIX_C_SOURCE


265 
	#_POSIX_C_SOURCE
 200809L

	)

268 #ià((!
defšed
 
__STRICT_ANSI__
 \

269 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

270 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

271 
	#_POSIX_SOURCE
 1

	)

272 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

273 
	#_POSIX_C_SOURCE
 2

	)

274 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

275 
	#_POSIX_C_SOURCE
 199506L

	)

276 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

277 
	#_POSIX_C_SOURCE
 200112L

	)

279 
	#_POSIX_C_SOURCE
 200809L

	)

281 
	#__USE_POSIX_IMPLICITLY
 1

	)

290 #ià((!
defšed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

291 && (
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE
))

292 
	#_POSIX_SOURCE
 1

	)

293 #undeà
_POSIX_C_SOURCE


294 
	#_POSIX_C_SOURCE
 199506L

	)

297 #ià(
defšed
 
_POSIX_SOURCE
 \

298 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

299 || 
defšed
 
_XOPEN_SOURCE
)

300 
	#__USE_POSIX
 1

	)

303 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


304 
	#__USE_POSIX2
 1

	)

307 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

308 
	#__USE_POSIX199309
 1

	)

311 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

312 
	#__USE_POSIX199506
 1

	)

315 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

316 
	#__USE_XOPEN2K
 1

	)

317 #undeà
__USE_ISOC95


318 
	#__USE_ISOC95
 1

	)

319 #undeà
__USE_ISOC99


320 
	#__USE_ISOC99
 1

	)

323 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

324 
	#__USE_XOPEN2K8
 1

	)

325 #undeà
_ATFILE_SOURCE


326 
	#_ATFILE_SOURCE
 1

	)

329 #ifdef 
_XOPEN_SOURCE


330 
	#__USE_XOPEN
 1

	)

331 #ià(
_XOPEN_SOURCE
 - 0) >= 500

332 
	#__USE_XOPEN_EXTENDED
 1

	)

333 
	#__USE_UNIX98
 1

	)

334 #undeà
_LARGEFILE_SOURCE


335 
	#_LARGEFILE_SOURCE
 1

	)

336 #ià(
_XOPEN_SOURCE
 - 0) >= 600

337 #ià(
_XOPEN_SOURCE
 - 0) >= 700

338 
	#__USE_XOPEN2K8
 1

	)

339 
	#__USE_XOPEN2K8XSI
 1

	)

341 
	#__USE_XOPEN2K
 1

	)

342 
	#__USE_XOPEN2KXSI
 1

	)

343 #undeà
__USE_ISOC95


344 
	#__USE_ISOC95
 1

	)

345 #undeà
__USE_ISOC99


346 
	#__USE_ISOC99
 1

	)

349 #ifdeà
_XOPEN_SOURCE_EXTENDED


350 
	#__USE_XOPEN_EXTENDED
 1

	)

355 #ifdeà
_LARGEFILE_SOURCE


356 
	#__USE_LARGEFILE
 1

	)

359 #ifdeà
_LARGEFILE64_SOURCE


360 
	#__USE_LARGEFILE64
 1

	)

363 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

364 
	#__USE_FILE_OFFSET64
 1

	)

367 #ià
defšed
 
_DEFAULT_SOURCE


368 
	#__USE_MISC
 1

	)

371 #ifdef 
_ATFILE_SOURCE


372 
	#__USE_ATFILE
 1

	)

375 #ifdef 
_GNU_SOURCE


376 
	#__USE_GNU
 1

	)

379 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

380 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

381 #ià
_FORTIFY_SOURCE
 > 1

382 
	#__USE_FORTIFY_LEVEL
 2

	)

384 
	#__USE_FORTIFY_LEVEL
 1

	)

387 
	#__USE_FORTIFY_LEVEL
 0

	)

394 #ià
defšed
 
__ılu¥lus
 ? __ılu¥lu >ğ201402L : defšed 
__USE_ISOC11


395 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

397 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

402 
	~<¡dc-´edef.h
>

410 #undeà
__GNU_LIBRARY__


411 
	#__GNU_LIBRARY__
 6

	)

415 
	#__GLIBC__
 2

	)

416 
	#__GLIBC_MINOR__
 27

	)

418 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

419 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

422 #iâdeà
__ASSEMBLER__


423 #iâdeà
_SYS_CDEFS_H


424 
	~<sys/cdefs.h
>

429 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


430 
	#__USE_LARGEFILE
 1

	)

431 
	#__USE_LARGEFILE64
 1

	)

437 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

438 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

439 && 
defšed
 
	g__ex‹º_šlše


440 
	#__USE_EXTERN_INLINES
 1

	)

448 
	~<gnu/¡ubs.h
>

	@/usr/include/inttypes.h

22 #iâdeà
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<¡dšt.h
>

30 #iâdeà
____gwch¬_t_defšed


31 #ifdeà
__ılu¥lus


32 
	#__gwch¬_t
 
wch¬_t


	)

33 #–ià
defšed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

36 
	#__Ãed_wch¬_t


	)

37 
	~<¡ddef.h
>

38 
wch¬_t
 
	t__gwch¬_t
;

40 
	#____gwch¬_t_defšed
 1

	)

43 #ià
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Î"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #ià
__WORDSIZE
 == 64

273 
	mquÙ
;

274 
	m»m
;

275 } 
	timaxdiv_t
;

282 
__ex‹nsiÚ__
 
	mquÙ
;

283 
__ex‹nsiÚ__
 
	m»m
;

284 } 
	timaxdiv_t
;

290 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

294 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

297 
štmax_t
 
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

298 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

301 
uštmax_t
 
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

302 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

305 
štmax_t
 
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

306 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

307 
__THROW
;

310 
uštmax_t
 
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

311 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

312 
__THROW
;

314 #ifdeà
__USE_EXTERN_INLINES


316 #ià
__WORDSIZE
 == 64

318 
	$__¡¹Ş_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

319 **
__»¡riù
 
__’d±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

323 
__ex‹º_šlše
 
štmax_t


324 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

325 
ba£
))

327  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

328 
	}
}

330 
	$__¡¹oul_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 ** 
__»¡riù
 
__’d±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

335 
__ex‹º_šlše
 
uštmax_t


336 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

337 
ba£
))

339  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc¡Ş_š‹º®
 (cÚ¡ 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

343 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

347 
__ex‹º_šlše
 
štmax_t


348 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

349 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

351  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc¡oul_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

355 
__»¡riù
 
__ÅŒ
,

356 
__gwch¬_t
 **

357 
__»¡riù
 
__’d±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

361 
__ex‹º_šlše
 
uštmax_t


362 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

363 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

365  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

366 
	}
}

370 
__ex‹nsiÚ__


371 
	$__¡¹Şl_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

372 **
__»¡riù
 
__’d±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

376 
__ex‹º_šlše
 
štmax_t


377 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

378 
ba£
))

380  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

381 
	}
}

383 
__ex‹nsiÚ__


384 
	$__¡¹ouÎ_š‹º®
 (const *

385 
__»¡riù
 
__ÅŒ
,

387 
__»¡riù
 
__’d±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

392 
__ex‹º_šlše
 
uštmax_t


393 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

394 
ba£
))

396  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

397 
	}
}

399 
__ex‹nsiÚ__


400 
	$__wc¡Şl_š‹º®
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

401 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

405 
__ex‹º_šlše
 
štmax_t


406 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

407 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

409  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

410 
	}
}

413 
__ex‹nsiÚ__


414 
	$__wc¡ouÎ_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

415 
__»¡riù
 
__ÅŒ
,

416 
__gwch¬_t
 **

417 
__»¡riù
 
__’d±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

422 
__ex‹º_šlše
 
uštmax_t


423 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

424 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

426  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

42 #iâdeà
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<b™s/wÜdsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifdeà
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #ià
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #ià
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifdeà
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


124 #šşude_Ãxˆ<
lim™s
.
h
>

130 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


131 #iâdeà
LLONG_MIN


132 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

134 #iâdeà
LLONG_MAX


135 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

137 #iâdeà
ULLONG_MAX


138 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

145 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

146 #iâdeà
CHAR_WIDTH


147 
	#CHAR_WIDTH
 8

	)

149 #iâdeà
SCHAR_WIDTH


150 
	#SCHAR_WIDTH
 8

	)

152 #iâdeà
UCHAR_WIDTH


153 
	#UCHAR_WIDTH
 8

	)

155 #iâdeà
SHRT_WIDTH


156 
	#SHRT_WIDTH
 16

	)

158 #iâdeà
USHRT_WIDTH


159 
	#USHRT_WIDTH
 16

	)

161 #iâdeà
INT_WIDTH


162 
	#INT_WIDTH
 32

	)

164 #iâdeà
UINT_WIDTH


165 
	#UINT_WIDTH
 32

	)

167 #iâdeà
LONG_WIDTH


168 
	#LONG_WIDTH
 
__WORDSIZE


	)

170 #iâdeà
ULONG_WIDTH


171 
	#ULONG_WIDTH
 
__WORDSIZE


	)

173 #iâdeà
LLONG_WIDTH


174 
	#LLONG_WIDTH
 64

	)

176 #iâdeà
ULLONG_WIDTH


177 
	#ULLONG_WIDTH
 64

	)

181 #ifdef 
__USE_POSIX


183 
	~<b™s/posix1_lim.h
>

186 #ifdef 
__USE_POSIX2


187 
	~<b™s/posix2_lim.h
>

190 #ifdef 
__USE_XOPEN


191 
	~<b™s/xİ’_lim.h
>

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 266002

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
è((×è<< 16è+ ((bè<< 8è+ (c))

	)

	@/usr/include/locale.h

22 #iâdef 
_LOCALE_H


23 
	#_LOCALE_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	#__Ãed_NULL


	)

28 
	~<¡ddef.h
>

29 
	~<b™s/loÿË.h
>

31 
	g__BEGIN_DECLS


35 
	#LC_CTYPE
 
__LC_CTYPE


	)

36 
	#LC_NUMERIC
 
__LC_NUMERIC


	)

37 
	#LC_TIME
 
__LC_TIME


	)

38 
	#LC_COLLATE
 
__LC_COLLATE


	)

39 
	#LC_MONETARY
 
__LC_MONETARY


	)

40 
	#LC_MESSAGES
 
__LC_MESSAGES


	)

41 
	#LC_ALL
 
__LC_ALL


	)

42 
	#LC_PAPER
 
__LC_PAPER


	)

43 
	#LC_NAME
 
__LC_NAME


	)

44 
	#LC_ADDRESS
 
__LC_ADDRESS


	)

45 
	#LC_TELEPHONE
 
__LC_TELEPHONE


	)

46 
	#LC_MEASUREMENT
 
__LC_MEASUREMENT


	)

47 
	#LC_IDENTIFICATION
 
__LC_IDENTIFICATION


	)

51 
	slcÚv


55 *
	mdecim®_pošt
;

56 *
	mthou§nds_£p
;

62 *
	mgroupšg
;

68 *
	mšt_cu¼_symbŞ
;

69 *
	mcu¼’cy_symbŞ
;

70 *
	mmÚ_decim®_pošt
;

71 *
	mmÚ_thou§nds_£p
;

72 *
	mmÚ_groupšg
;

73 *
	mpos™ive_sign
;

74 *
	mÃg©ive_sign
;

75 
	mšt_äac_dig™s
;

76 
	mäac_dig™s
;

78 
	mp_cs_´eûdes
;

80 
	mp_£p_by_¥aû
;

82 
	mn_cs_´eûdes
;

84 
	mn_£p_by_¥aû
;

91 
	mp_sign_po¢
;

92 
	mn_sign_po¢
;

93 #ifdeà
__USE_ISOC99


95 
	mšt_p_cs_´eûdes
;

97 
	mšt_p_£p_by_¥aû
;

99 
	mšt_n_cs_´eûdes
;

101 
	mšt_n_£p_by_¥aû
;

108 
	mšt_p_sign_po¢
;

109 
	mšt_n_sign_po¢
;

111 
	m__št_p_cs_´eûdes
;

112 
	m__št_p_£p_by_¥aû
;

113 
	m__št_n_cs_´eûdes
;

114 
	m__št_n_£p_by_¥aû
;

115 
	m__št_p_sign_po¢
;

116 
	m__št_n_sign_po¢
;

122 *
	$£oÿË
 (
__ÿ‹gÜy
, cÚ¡ *
__loÿË
è
__THROW
;

125 
lcÚv
 *
	$loÿËcÚv
 (è
__THROW
;

128 #ifdef 
__USE_XOPEN2K8


135 
	~<b™s/ty³s/loÿË_t.h
>

141 
loÿË_t
 
	$ÃwloÿË
 (
__ÿ‹gÜy_mask
, cÚ¡ *
__loÿË
,

142 
loÿË_t
 
__ba£
è
__THROW
;

148 
	#LC_CTYPE_MASK
 (1 << 
__LC_CTYPE
)

	)

149 
	#LC_NUMERIC_MASK
 (1 << 
__LC_NUMERIC
)

	)

150 
	#LC_TIME_MASK
 (1 << 
__LC_TIME
)

	)

151 
	#LC_COLLATE_MASK
 (1 << 
__LC_COLLATE
)

	)

152 
	#LC_MONETARY_MASK
 (1 << 
__LC_MONETARY
)

	)

153 
	#LC_MESSAGES_MASK
 (1 << 
__LC_MESSAGES
)

	)

154 
	#LC_PAPER_MASK
 (1 << 
__LC_PAPER
)

	)

155 
	#LC_NAME_MASK
 (1 << 
__LC_NAME
)

	)

156 
	#LC_ADDRESS_MASK
 (1 << 
__LC_ADDRESS
)

	)

157 
	#LC_TELEPHONE_MASK
 (1 << 
__LC_TELEPHONE
)

	)

158 
	#LC_MEASUREMENT_MASK
 (1 << 
__LC_MEASUREMENT
)

	)

159 
	#LC_IDENTIFICATION_MASK
 (1 << 
__LC_IDENTIFICATION
)

	)

160 
	#LC_ALL_MASK
 (
LC_CTYPE_MASK
 \

161 | 
LC_NUMERIC_MASK
 \

162 | 
LC_TIME_MASK
 \

163 | 
LC_COLLATE_MASK
 \

164 | 
LC_MONETARY_MASK
 \

165 | 
LC_MESSAGES_MASK
 \

166 | 
LC_PAPER_MASK
 \

167 | 
LC_NAME_MASK
 \

168 | 
LC_ADDRESS_MASK
 \

169 | 
LC_TELEPHONE_MASK
 \

170 | 
LC_MEASUREMENT_MASK
 \

171 | 
LC_IDENTIFICATION_MASK
 \

172 )

	)

176 
loÿË_t
 
	$du¶oÿË
 (
loÿË_t
 
__d©a£t
è
__THROW
;

180 
	$ä“loÿË
 (
loÿË_t
 
__d©a£t
è
__THROW
;

187 
loÿË_t
 
	$u£loÿË
 (
loÿË_t
 
__d©a£t
è
__THROW
;

191 
	#LC_GLOBAL_LOCALE
 ((
loÿË_t
è-1L)

	)

195 
__END_DECLS


	@/usr/include/malloc.h

19 #iâdeà
_MALLOC_H


20 
	#_MALLOC_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<¡ddef.h
>

24 
	~<¡dio.h
>

26 #ifdeà
_LIBC


27 
	#__MALLOC_HOOK_VOLATILE


	)

28 
	#__MALLOC_DEPRECATED


	)

30 
	#__MALLOC_HOOK_VOLATILE
 vŞ©e

	)

31 
	#__MALLOC_DEPRECATED
 
__©Œibu‹_d•»ÿ‹d__


	)

35 
__BEGIN_DECLS


38 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

41 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

42 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

49 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

50 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

57 *
	$»®loÿ¼ay
 (*
__±r
, 
size_t
 
__nmemb
, size_ˆ
__size
)

58 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

61 
	$ä“
 (*
__±r
è
__THROW
;

64 *
	$mem®ign
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

65 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

68 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

72 *
	$pv®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

76 *(*
__mÜecÜe
è(
±rdiff_t
 
__size
);

79 *
	$__deçuÉ_mÜecÜe
 (
±rdiff_t
 
__size
)

80 
__THROW
 
__©Œibu‹_m®loc__
;

84 
	sm®lšfo


86 
¬’a
;

87 
Üdblks
;

88 
smblks
;

89 
hblks
;

90 
hblkhd
;

91 
usmblks
;

92 
fsmblks
;

93 
uÜdblks
;

94 
fÜdblks
;

95 
k“pco¡
;

99 
m®lšfo
 
	$m®lšfo
 (è
__THROW
;

102 #iâdeà
M_MXFAST


103 
	#M_MXFAST
 1

	)

105 #iâdeà
M_NLBLKS


106 
	#M_NLBLKS
 2

	)

108 #iâdeà
M_GRAIN


109 
	#M_GRAIN
 3

	)

111 #iâdeà
M_KEEP


112 
	#M_KEEP
 4

	)

116 
	#M_TRIM_THRESHOLD
 -1

	)

117 
	#M_TOP_PAD
 -2

	)

118 
	#M_MMAP_THRESHOLD
 -3

	)

119 
	#M_MMAP_MAX
 -4

	)

120 
	#M_CHECK_ACTION
 -5

	)

121 
	#M_PERTURB
 -6

	)

122 
	#M_ARENA_TEST
 -7

	)

123 
	#M_ARENA_MAX
 -8

	)

126 
	$m®lİt
 (
__·¿m
, 
__v®
è
__THROW
;

130 
	$m®loc_Œim
 (
size_t
 
__·d
è
__THROW
;

134 
size_t
 
	$m®loc_u§bË_size
 (*
__±r
è
__THROW
;

137 
	$m®loc_¡©s
 (è
__THROW
;

140 
	$m®loc_šfo
 (
__İtiÚs
, 
FILE
 *
__å
è
__THROW
;

143 (*
__MALLOC_HOOK_VOLATILE
 
__ä“_hook
è(*
__±r
,

145 
__MALLOC_DEPRECATED
;

146 *(*
__MALLOC_HOOK_VOLATILE
 
__m®loc_hook
)(
size_t
 
__size
,

148 
__MALLOC_DEPRECATED
;

149 *(*
__MALLOC_HOOK_VOLATILE
 
__»®loc_hook
)(*
__±r
,

150 
size_t
 
__size
,

152 
__MALLOC_DEPRECATED
;

153 *(*
__MALLOC_HOOK_VOLATILE
 
__mem®ign_hook
)(
size_t
 
__®ignm’t
,

154 
size_t
 
__size
,

156 
__MALLOC_DEPRECATED
;

157 (*
__MALLOC_HOOK_VOLATILE
 
__aá”_mÜecÜe_hook
) ();

160 
	$__m®loc_check_š™
 (è
__THROW
 
__MALLOC_DEPRECATED
;

163 
__END_DECLS


	@/usr/include/math.h

23 #iâdef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 #ià
defšed
 
log
 && defšed 
__GNUC__


30 #w¬nšg 
A
 
maüo
 
ÿÎed
 
log
 
was
 
®»ady
 
defšed
 
wh’
 <
m©h
.
h
> wa 
šşuded
.

31 #w¬nšg 
This
 
wl
 
ÿu£
 
comp©iÚ
 
´obËms
.

34 
	g__BEGIN_DECLS


37 
	~<b™s/ty³s.h
>

40 
	~<b™s/m©h-veùÜ.h
>

43 
	~<b™s/æßŠ.h
>

47 #ià
__GNUC_PREREQ
 (3, 3)

48 
	#HUGE_VAL
 (
	`__butš_huge_v®
 ())

	)

55 
	#HUGE_VAL
 1e10000

	)

57 #ifdeà
__USE_ISOC99


58 #ià
__GNUC_PREREQ
 (3, 3)

59 
	#HUGE_VALF
 (
	`__butš_huge_v®f
 ())

	)

60 
	#HUGE_VALL
 (
	`__butš_huge_v®l
 ())

	)

62 
	#HUGE_VALF
 1e10000f

	)

63 
	#HUGE_VALL
 1e10000L

	)

66 #ià
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

67 
	#HUGE_VAL_F16
 (
	`__butš_huge_v®f16
 ())

	)

69 #ià
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

70 
	#HUGE_VAL_F32
 (
	`__butš_huge_v®f32
 ())

	)

72 #ià
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

73 
	#HUGE_VAL_F64
 (
	`__butš_huge_v®f64
 ())

	)

75 #ià
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

76 
	#HUGE_VAL_F128
 (
	`__butš_huge_v®f128
 ())

	)

78 #ià
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

79 
	#HUGE_VAL_F32X
 (
	`__butš_huge_v®f32x
 ())

	)

81 #ià
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

82 
	#HUGE_VAL_F64X
 (
	`__butš_huge_v®f64x
 ())

	)

84 #ià
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

85 
	#HUGE_VAL_F128X
 (
	`__butš_huge_v®f128x
 ())

	)

88 #ifdeà
__USE_ISOC99


90 #ià
__GNUC_PREREQ
 (3, 3)

91 
	#INFINITY
 (
	`__butš_šff
 ())

	)

93 
	#INFINITY
 
HUGE_VALF


	)

97 #ià
__GNUC_PREREQ
 (3, 3)

98 
	#NAN
 (
	`__butš_Çnf
 (""))

	)

103 
	#NAN
 (0.0à/ 0.0f)

	)

107 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

109 #ià
__GNUC_PREREQ
 (3, 3)

110 
	#SNANF
 (
	`__butš_Çnsf
 (""))

	)

111 
	#SNAN
 (
	`__butš_Çns
 (""))

	)

112 
	#SNANL
 (
	`__butš_Çn¦
 (""))

	)

115 #ià
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

116 
	#SNANF16
 (
	`__butš_Çnsf16
 (""))

	)

118 #ià
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

119 
	#SNANF32
 (
	`__butš_Çnsf32
 (""))

	)

121 #ià
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

122 
	#SNANF64
 (
	`__butš_Çnsf64
 (""))

	)

124 #ià
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

125 
	#SNANF128
 (
	`__butš_Çnsf128
 (""))

	)

127 #ià
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

128 
	#SNANF32X
 (
	`__butš_Çnsf32x
 (""))

	)

130 #ià
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

131 
	#SNANF64X
 (
	`__butš_Çnsf64x
 (""))

	)

133 #ià
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
	#SNANF128X
 (
	`__butš_Çnsf128x
 (""))

	)

138 
	~<b™s/æt-ev®-m‘hod.h
>

140 #ifdeà
__USE_ISOC99


148 #ià
__GLIBC_FLT_EVAL_METHOD
 == 0 || __GLIBC_FLT_EVAL_METHOD == 16

149 
	tæßt_t
;

150 
	tdoubË_t
;

151 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 1

152 
	tæßt_t
;

153 
	tdoubË_t
;

154 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 2

155 
	tæßt_t
;

156 
	tdoubË_t
;

157 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 32

158 
_Flßt32
 
	tæßt_t
;

159 
	tdoubË_t
;

160 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 33

161 
_Flßt32x
 
	tæßt_t
;

162 
_Flßt32x
 
	tdoubË_t
;

163 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 64

164 
_Flßt64
 
	tæßt_t
;

165 
_Flßt64
 
	tdoubË_t
;

166 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 65

167 
_Flßt64x
 
	tæßt_t
;

168 
_Flßt64x
 
	tdoubË_t
;

169 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 128

170 
_Flßt128
 
	tæßt_t
;

171 
_Flßt128
 
	tdoubË_t
;

172 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 129

173 
_Flßt128x
 
	tæßt_t
;

174 
_Flßt128x
 
	tdoubË_t
;

190 
	~<b™s/å-logb.h
>

191 #ifdeà
__USE_ISOC99


192 #ià
__FP_LOGB0_IS_MIN


193 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

195 
	#FP_ILOGB0
 (-2147483647)

	)

197 #ià
__FP_LOGBNAN_IS_MIN


198 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

200 
	#FP_ILOGBNAN
 2147483647

	)

203 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

204 #ià
__WORDSIZE
 == 32

205 
	#__FP_LONG_MAX
 0x7fffffffL

	)

207 
	#__FP_LONG_MAX
 0x7fffffffffffffffL

	)

209 #ià
__FP_LOGB0_IS_MIN


210 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
 - 1)

	)

212 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
)

	)

214 #ià
__FP_LOGBNAN_IS_MIN


215 
	#FP_LLOGBNAN
 (-
__FP_LONG_MAX
 - 1)

	)

217 
	#FP_LLOGBNAN
 
__FP_LONG_MAX


	)

233 
	~<b™s/å-ç¡.h
>

235 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

239 
	mFP_INT_UPWARD
 =

240 
	#FP_INT_UPWARD
 0

	)

241 
FP_INT_UPWARD
,

242 
	mFP_INT_DOWNWARD
 =

243 
	#FP_INT_DOWNWARD
 1

	)

244 
FP_INT_DOWNWARD
,

245 
	mFP_INT_TOWARDZERO
 =

246 
	#FP_INT_TOWARDZERO
 2

	)

247 
FP_INT_TOWARDZERO
,

248 
	mFP_INT_TONEARESTFROMZERO
 =

249 
	#FP_INT_TONEARESTFROMZERO
 3

	)

250 
FP_INT_TONEARESTFROMZERO
,

251 
	mFP_INT_TONEAREST
 =

252 
	#FP_INT_TONEAREST
 4

	)

253 
FP_INT_TONEAREST
,

262 
	#__SIMD_DECL
(
funùiÚ
è
	`__CONCAT
 (
__DECL_SIMD_
, funùiÚ)

	)

264 
	#__MATHCALL_VEC
(
funùiÚ
, 
suffix
, 
¬gs
) \

265 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funùiÚ
, 
suffix
)) \

266 
	`__MATHCALL
 (
funùiÚ
, 
suffix
, 
¬gs
)

	)

268 
	#__MATHDECL_VEC
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

269 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funùiÚ
, 
suffix
)) \

270 
	`__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
)

	)

272 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

273 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

274 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

275 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

276 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

277 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

278 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

279 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

280 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

281 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

282 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

283 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

285 
	#_MdoubË_
 

	)

286 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

287 
	#__MATH_DECLARING_DOUBLE
 1

	)

288 
	#__MATH_DECLARING_FLOATN
 0

	)

289 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

290 
	~<b™s/m©hÿÎs.h
>

291 #undeà
_MdoubË_


292 #undeà
__MATH_PRECNAME


293 #undeà
__MATH_DECLARING_DOUBLE


294 #undeà
__MATH_DECLARING_FLOATN


296 #ifdeà
__USE_ISOC99


302 
	#_MdoubË_
 

	)

303 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

304 
	#__MATH_DECLARING_DOUBLE
 0

	)

305 
	#__MATH_DECLARING_FLOATN
 0

	)

306 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

307 
	~<b™s/m©hÿÎs.h
>

308 #undeà
_MdoubË_


309 #undeà
__MATH_PRECNAME


310 #undeà
__MATH_DECLARING_DOUBLE


311 #undeà
__MATH_DECLARING_FLOATN


313 #ià!(
defšed
 
__NO_LONG_DOUBLE_MATH
 && defšed 
_LIBC
) \

314 || 
defšed
 
__LDBL_COMPAT
 \

315 || 
defšed
 
_LIBC_TEST


316 #ifdeà
__LDBL_COMPAT


318 #ifdeà
__USE_ISOC99


319 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

320 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

321 #ifdeà
__REDIRECT_NTH


322 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

323 
__Ædbl_Ãx‰ow¬df
)

324 
	`__©Œibu‹__
 ((
__cÚ¡__
));

325 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

326 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

327 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

328 (
__x
, 
__y
),

329 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

333 #undeà
__MATHDECL_1


334 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

335 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

336 
¬gs
, 
®Ÿs
)

	)

337 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

338 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

344 
	#_MdoubË_
 

	)

345 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

346 
	#__MATH_DECLARING_DOUBLE
 0

	)

347 
	#__MATH_DECLARING_FLOATN
 0

	)

348 
	#__MATH_DECLARE_LDOUBLE
 1

	)

349 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

350 
	~<b™s/m©hÿÎs.h
>

351 #undeà
_MdoubË_


352 #undeà
__MATH_PRECNAME


353 #undeà
__MATH_DECLARING_DOUBLE


354 #undeà
__MATH_DECLARING_FLOATN


363 #ià
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
defšed
 
_LIBC
)

364 
	#_MdoubË_
 
_Flßt16


	)

365 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f16
##
	)
r

366 
	#__MATH_DECLARING_DOUBLE
 0

	)

367 
	#__MATH_DECLARING_FLOATN
 1

	)

368 #ià
__HAVE_DISTINCT_FLOAT16


369 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

371 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

372 
	~<b™s/m©hÿÎs.h
>

374 #undeà
_MdoubË_


375 #undeà
__MATH_PRECNAME


376 #undeà
__MATH_DECLARING_DOUBLE


377 #undeà
__MATH_DECLARING_FLOATN


380 #ià
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
defšed
 
_LIBC
)

381 
	#_MdoubË_
 
_Flßt32


	)

382 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f32
##
	)
r

383 
	#__MATH_DECLARING_DOUBLE
 0

	)

384 
	#__MATH_DECLARING_FLOATN
 1

	)

385 #ià
__HAVE_DISTINCT_FLOAT32


386 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

388 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

389 
	~<b™s/m©hÿÎs.h
>

391 #undeà
_MdoubË_


392 #undeà
__MATH_PRECNAME


393 #undeà
__MATH_DECLARING_DOUBLE


394 #undeà
__MATH_DECLARING_FLOATN


397 #ià
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
defšed
 
_LIBC
)

398 
	#_MdoubË_
 
_Flßt64


	)

399 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f64
##
	)
r

400 
	#__MATH_DECLARING_DOUBLE
 0

	)

401 
	#__MATH_DECLARING_FLOATN
 1

	)

402 #ià
__HAVE_DISTINCT_FLOAT64


403 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

405 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

406 
	~<b™s/m©hÿÎs.h
>

408 #undeà
_MdoubË_


409 #undeà
__MATH_PRECNAME


410 #undeà
__MATH_DECLARING_DOUBLE


411 #undeà
__MATH_DECLARING_FLOATN


414 #ià
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
defšed
 
_LIBC
)

415 
	#_MdoubË_
 
_Flßt128


	)

416 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f128
##
	)
r

417 
	#__MATH_DECLARING_DOUBLE
 0

	)

418 
	#__MATH_DECLARING_FLOATN
 1

	)

419 #ià
__HAVE_DISTINCT_FLOAT128


420 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

422 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

423 
	~<b™s/m©hÿÎs.h
>

425 #undeà
_MdoubË_


426 #undeà
__MATH_PRECNAME


427 #undeà
__MATH_DECLARING_DOUBLE


428 #undeà
__MATH_DECLARING_FLOATN


431 #ià
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
defšed
 
_LIBC
)

432 
	#_MdoubË_
 
_Flßt32x


	)

433 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f32x
##
	)
r

434 
	#__MATH_DECLARING_DOUBLE
 0

	)

435 
	#__MATH_DECLARING_FLOATN
 1

	)

436 #ià
__HAVE_DISTINCT_FLOAT32X


437 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

439 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

440 
	~<b™s/m©hÿÎs.h
>

442 #undeà
_MdoubË_


443 #undeà
__MATH_PRECNAME


444 #undeà
__MATH_DECLARING_DOUBLE


445 #undeà
__MATH_DECLARING_FLOATN


448 #ià
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
defšed
 
_LIBC
)

449 
	#_MdoubË_
 
_Flßt64x


	)

450 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f64x
##
	)
r

451 
	#__MATH_DECLARING_DOUBLE
 0

	)

452 
	#__MATH_DECLARING_FLOATN
 1

	)

453 #ià
__HAVE_DISTINCT_FLOAT64X


454 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

456 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

457 
	~<b™s/m©hÿÎs.h
>

459 #undeà
_MdoubË_


460 #undeà
__MATH_PRECNAME


461 #undeà
__MATH_DECLARING_DOUBLE


462 #undeà
__MATH_DECLARING_FLOATN


465 #ià
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
defšed
 
_LIBC
)

466 
	#_MdoubË_
 
_Flßt128x


	)

467 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f128x
##
	)
r

468 
	#__MATH_DECLARING_DOUBLE
 0

	)

469 
	#__MATH_DECLARING_FLOATN
 1

	)

470 #ià
__HAVE_DISTINCT_FLOAT128X


471 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

473 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

474 
	~<b™s/m©hÿÎs.h
>

476 #undeà
_MdoubË_


477 #undeà
__MATH_PRECNAME


478 #undeà
__MATH_DECLARING_DOUBLE


479 #undeà
__MATH_DECLARING_FLOATN


482 #undeà
__MATHDECL_1


483 #undeà
__MATHDECL


484 #undeà
__MATHCALL


487 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


489 
signgam
;

492 #ià(
__HAVE_DISTINCT_FLOAT16
 \

493 || 
__HAVE_DISTINCT_FLOAT32
 \

494 || 
__HAVE_DISTINCT_FLOAT64
 \

495 || 
__HAVE_DISTINCT_FLOAT32X
 \

496 || 
__HAVE_DISTINCT_FLOAT64X
 \

497 || 
__HAVE_DISTINCT_FLOAT128X
)

510 #ifdeà
__NO_LONG_DOUBLE_MATH


511 #ià
__HAVE_DISTINCT_FLOAT128


514 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

515 ( (
TG_ARG
è=ğ (è? 
FUNC
 ## 
f
 
ARGS
 : FUNC ARGS)

	)

516 #–ià
__HAVE_DISTINCT_FLOAT128


517 #ià
__HAVE_GENERIC_SELECTION


518 #ià
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT32


519 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
è
_Flßt32
: FUNC ## 
f
 ARGS,

	)

521 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
)

	)

523 #ià
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT64X


524 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


525 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
è
_Flßt64x
: FUNC ## 
l
 ARGS,

	)

527 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
è
_Flßt64x
: FUNC ## 
f128
 ARGS,

	)

530 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
)

	)

532 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

533 
	`_G’”ic
 ((
TG_ARG
), \

534 : 
FUNC
 ## 
f
 
ARGS
, \

535 
	`__MATH_TG_F32
 (
FUNC
, 
ARGS
) \

536 : 
FUNC
 
ARGS
, \

537 : 
FUNC
 ## 
l
 
ARGS
, \

538 
	`__MATH_TG_F64X
 (
FUNC
, 
ARGS
) \

539 
_Flßt128
: 
FUNC
 ## 
f128
 
ARGS
)

	)

541 #ià
__HAVE_FLOATN_NOT_TYPEDEF


544 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

545 
__butš_choo£_ex´
 \

546 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

547 
FUNC
 ## 
f
 
ARGS
, \

548 
__butš_choo£_ex´
 \

549 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

550 
FUNC
 
ARGS
, \

551 
__butš_choo£_ex´
 \

552 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

553 
FUNC
 ## 
l
 
ARGS
, \

554 
FUNC
 ## 
f128
 
ARGS
)))

	)

557 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

558 ( (
TG_ARG
) ==  () \

559 ? 
FUNC
 ## 
f
 
ARGS
 \

560 :  (
TG_ARG
) ==  () \

561 ? 
FUNC
 
ARGS
 \

562 : 
FUNC
 ## 
l
 
ARGS
)

	)

566 #ifdeà
__USE_ISOC99


571 
FP_NAN
 =

572 
	#FP_NAN
 0

	)

573 
FP_NAN
,

574 
FP_INFINITE
 =

575 
	#FP_INFINITE
 1

	)

576 
FP_INFINITE
,

577 
FP_ZERO
 =

578 
	#FP_ZERO
 2

	)

579 
FP_ZERO
,

580 
FP_SUBNORMAL
 =

581 
	#FP_SUBNORMAL
 3

	)

582 
FP_SUBNORMAL
,

583 
FP_NORMAL
 =

584 
	#FP_NORMAL
 4

	)

585 
FP_NORMAL


593 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__
 \

594 && (!
defšed
 
__OPTIMIZE_SIZE__
 || defšed 
__ılu¥lus
)

601 
	#åşassify
(
x
è
	`__butš_åşassify
 (
FP_NAN
, 
FP_INFINITE
, \

602 
FP_NORMAL
, 
FP_SUBNORMAL
, 
FP_ZERO
, 
x
)

	)

604 
	#åşassify
(
x
è
	`__MATH_TG
 ((x), 
__åşassify
, (x))

	)

608 #ià
	`__GNUC_PREREQ
 (6,0)

609 
	#signb™
(
x
è
	`__butš_signb™
 (x)

	)

610 #–ià
defšed
 
__ılu¥lus


618 
	#signb™
(
x
è
	`__butš_signb™l
 (x)

	)

619 #–ià
	`__GNUC_PREREQ
 (4,0)

620 
	#signb™
(
x
è
	`__MATH_TG
 ((x), 
__butš_signb™
, (x))

	)

622 
	#signb™
(
x
è
	`__MATH_TG
 ((x), 
__signb™
, (x))

	)

626 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


627 
	#isfš™e
(
x
è
	`__butš_isfš™e
 (x)

	)

629 
	#isfš™e
(
x
è
	`__MATH_TG
 ((x), 
__fš™e
, (x))

	)

633 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


634 
	#i¢Üm®
(
x
è
	`__butš_i¢Üm®
 (x)

	)

636 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

641 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


642 
	#i¢ª
(
x
è
	`__butš_i¢ª
 (x)

	)

644 
	#i¢ª
(
x
è
	`__MATH_TG
 ((x), 
__i¢ª
, (x))

	)

648 #ià
__HAVE_DISTINCT_FLOAT128
 && !
	`__GNUC_PREREQ
 (7,0) \

649 && !
defšed
 
__SUPPORT_SNAN__
 && !defšed 
__ılu¥lus


655 
	#isšf
(
x
) \

656 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
x
), 
_Flßt128
) \

657 ? 
	`__isšff128
 (
x
è: 
	`__butš_isšf_sign
 (x))

	)

658 #–ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


659 
	#isšf
(
x
è
	`__butš_isšf_sign
 (x)

	)

661 
	#isšf
(
x
è
	`__MATH_TG
 ((x), 
__isšf
, (x))

	)

665 
	#MATH_ERRNO
 1

	)

666 
	#MATH_ERREXCEPT
 2

	)

673 #ifdeà
__FAST_MATH__


674 
	#m©h_”rhªdlšg
 0

	)

675 #–ià
defšed
 
__NO_MATH_ERRNO__


676 
	#m©h_”rhªdlšg
 (
MATH_ERREXCEPT
)

	)

678 
	#m©h_”rhªdlšg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

683 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

684 
	~<b™s/isÿnÚiÿl.h
>

687 #iâdeà
__ılu¥lus


688 
	#issigÇlšg
(
x
è
	`__MATH_TG
 ((x), 
__issigÇlšg
, (x))

	)

697 
šlše
 
	`issigÇlšg
 (
__v®
è{  
	`__issigÇlšgf
 (__val); }

698 
šlše
 
	`issigÇlšg
 (
__v®
è{  
	`__issigÇlšg
 (__val); }

699 
šlše
 

700 
	`issigÇlšg
 (
__v®
)

702 #ifdeà
__NO_LONG_DOUBLE_MATH


703  
	`__issigÇlšg
 (
__v®
);

705  
	`__issigÇlšgl
 (
__v®
);

708 #ià
__HAVE_DISTINCT_FLOAT128


709 
šlše
 
	`issigÇlšg
 (
_Flßt128
 
__v®
è{  
	`__issigÇlšgf128
 (__val); }

711 
	}
}

715 
	#issubnÜm®
(
x
è(
	`åşassify
 (xè=ğ
FP_SUBNORMAL
)

	)

718 #iâdeà
__ılu¥lus


719 #ifdeà
__SUPPORT_SNAN__


720 
	#isz”o
(
x
è(
	`åşassify
 (xè=ğ
FP_ZERO
)

	)

722 
	#isz”o
(
x
è(((
	`__ty³of
 (x)è(x)è=ğ0)

	)

726 #ifdeà
__SUPPORT_SNAN__


727 
šlše
 

728 
isz”o
 (
__v®
)

730  
__åşassifyf
 (
__v®
è=ğ
FP_ZERO
;

732 
šlše
 

733 
isz”o
 (
__v®
)

735  
__åşassify
 (
__v®
è=ğ
FP_ZERO
;

737 
šlše
 

738 
isz”o
 (
__v®
)

740 #ifdeà
__NO_LONG_DOUBLE_MATH


741  
__åşassify
 (
__v®
è=ğ
FP_ZERO
;

743  
__åşassifyl
 (
__v®
è=ğ
FP_ZERO
;

746 #ià
__HAVE_DISTINCT_FLOAT128


747 
šlše
 

748 
isz”o
 (
_Flßt128
 
__v®
)

750  
__åşassifyf128
 (
__v®
è=ğ
FP_ZERO
;

754 
‹m¶©e
 <
şass
 
__T
> 
šlše
 
boŞ


755 
isz”o
 (
__T
 
__v®
)

757  
__v®
 == 0;

764 #ifdeà
__USE_XOPEN


766 
	#MAXFLOAT
 3.40282347e+38F

	)

771 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


772 
	#M_E
 2.7182818284590452354

	)

773 
	#M_LOG2E
 1.4426950408889634074

	)

774 
	#M_LOG10E
 0.43429448190325182765

	)

775 
	#M_LN2
 0.69314718055994530942

	)

776 
	#M_LN10
 2.30258509299404568402

	)

777 
	#M_PI
 3.14159265358979323846

	)

778 
	#M_PI_2
 1.57079632679489661923

	)

779 
	#M_PI_4
 0.78539816339744830962

	)

780 
	#M_1_PI
 0.31830988618379067154

	)

781 
	#M_2_PI
 0.63661977236758134308

	)

782 
	#M_2_SQRTPI
 1.12837916709551257390

	)

783 
	#M_SQRT2
 1.41421356237309504880

	)

784 
	#M_SQRT1_2
 0.70710678118654752440

	)

790 #ifdeà
__USE_GNU


791 
	#M_El
 2.718281828459045235360287471352662498L

	)

792 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

793 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

794 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

795 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

796 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

797 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

798 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

799 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

800 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

801 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

802 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

803 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

806 #ià
__HAVE_FLOAT16
 && 
defšed
 
__USE_GNU


807 
	#M_Ef16
 
	`__f16
 (2.718281828459045235360287471352662498è

	)

808 
	#M_LOG2Ef16
 
	`__f16
 (1.442695040888963407359924681001892137è

	)

809 
	#M_LOG10Ef16
 
	`__f16
 (0.434294481903251827651128918916605082è

	)

810 
	#M_LN2f16
 
	`__f16
 (0.693147180559945309417232121458176568è

	)

811 
	#M_LN10f16
 
	`__f16
 (2.302585092994045684017991454684364208è

	)

812 
	#M_PIf16
 
	`__f16
 (3.141592653589793238462643383279502884è

	)

813 
	#M_PI_2f16
 
	`__f16
 (1.570796326794896619231321691639751442è

	)

814 
	#M_PI_4f16
 
	`__f16
 (0.785398163397448309615660845819875721è

	)

815 
	#M_1_PIf16
 
	`__f16
 (0.318309886183790671537767526745028724è

	)

816 
	#M_2_PIf16
 
	`__f16
 (0.636619772367581343075535053490057448è

	)

817 
	#M_2_SQRTPIf16
 
	`__f16
 (1.128379167095512573896158903121545172è

	)

818 
	#M_SQRT2f16
 
	`__f16
 (1.414213562373095048801688724209698079è

	)

819 
	#M_SQRT1_2f16
 
	`__f16
 (0.707106781186547524400844362104849039è

	)

822 #ià
__HAVE_FLOAT32
 && 
defšed
 
__USE_GNU


823 
	#M_Ef32
 
	`__f32
 (2.718281828459045235360287471352662498è

	)

824 
	#M_LOG2Ef32
 
	`__f32
 (1.442695040888963407359924681001892137è

	)

825 
	#M_LOG10Ef32
 
	`__f32
 (0.434294481903251827651128918916605082è

	)

826 
	#M_LN2f32
 
	`__f32
 (0.693147180559945309417232121458176568è

	)

827 
	#M_LN10f32
 
	`__f32
 (2.302585092994045684017991454684364208è

	)

828 
	#M_PIf32
 
	`__f32
 (3.141592653589793238462643383279502884è

	)

829 
	#M_PI_2f32
 
	`__f32
 (1.570796326794896619231321691639751442è

	)

830 
	#M_PI_4f32
 
	`__f32
 (0.785398163397448309615660845819875721è

	)

831 
	#M_1_PIf32
 
	`__f32
 (0.318309886183790671537767526745028724è

	)

832 
	#M_2_PIf32
 
	`__f32
 (0.636619772367581343075535053490057448è

	)

833 
	#M_2_SQRTPIf32
 
	`__f32
 (1.128379167095512573896158903121545172è

	)

834 
	#M_SQRT2f32
 
	`__f32
 (1.414213562373095048801688724209698079è

	)

835 
	#M_SQRT1_2f32
 
	`__f32
 (0.707106781186547524400844362104849039è

	)

838 #ià
__HAVE_FLOAT64
 && 
defšed
 
__USE_GNU


839 
	#M_Ef64
 
	`__f64
 (2.718281828459045235360287471352662498è

	)

840 
	#M_LOG2Ef64
 
	`__f64
 (1.442695040888963407359924681001892137è

	)

841 
	#M_LOG10Ef64
 
	`__f64
 (0.434294481903251827651128918916605082è

	)

842 
	#M_LN2f64
 
	`__f64
 (0.693147180559945309417232121458176568è

	)

843 
	#M_LN10f64
 
	`__f64
 (2.302585092994045684017991454684364208è

	)

844 
	#M_PIf64
 
	`__f64
 (3.141592653589793238462643383279502884è

	)

845 
	#M_PI_2f64
 
	`__f64
 (1.570796326794896619231321691639751442è

	)

846 
	#M_PI_4f64
 
	`__f64
 (0.785398163397448309615660845819875721è

	)

847 
	#M_1_PIf64
 
	`__f64
 (0.318309886183790671537767526745028724è

	)

848 
	#M_2_PIf64
 
	`__f64
 (0.636619772367581343075535053490057448è

	)

849 
	#M_2_SQRTPIf64
 
	`__f64
 (1.128379167095512573896158903121545172è

	)

850 
	#M_SQRT2f64
 
	`__f64
 (1.414213562373095048801688724209698079è

	)

851 
	#M_SQRT1_2f64
 
	`__f64
 (0.707106781186547524400844362104849039è

	)

854 #ià
__HAVE_FLOAT128
 && 
defšed
 
__USE_GNU


855 
	#M_Ef128
 
	`__f128
 (2.718281828459045235360287471352662498è

	)

856 
	#M_LOG2Ef128
 
	`__f128
 (1.442695040888963407359924681001892137è

	)

857 
	#M_LOG10Ef128
 
	`__f128
 (0.434294481903251827651128918916605082è

	)

858 
	#M_LN2f128
 
	`__f128
 (0.693147180559945309417232121458176568è

	)

859 
	#M_LN10f128
 
	`__f128
 (2.302585092994045684017991454684364208è

	)

860 
	#M_PIf128
 
	`__f128
 (3.141592653589793238462643383279502884è

	)

861 
	#M_PI_2f128
 
	`__f128
 (1.570796326794896619231321691639751442è

	)

862 
	#M_PI_4f128
 
	`__f128
 (0.785398163397448309615660845819875721è

	)

863 
	#M_1_PIf128
 
	`__f128
 (0.318309886183790671537767526745028724è

	)

864 
	#M_2_PIf128
 
	`__f128
 (0.636619772367581343075535053490057448è

	)

865 
	#M_2_SQRTPIf128
 
	`__f128
 (1.128379167095512573896158903121545172è

	)

866 
	#M_SQRT2f128
 
	`__f128
 (1.414213562373095048801688724209698079è

	)

867 
	#M_SQRT1_2f128
 
	`__f128
 (0.707106781186547524400844362104849039è

	)

870 #ià
__HAVE_FLOAT32X
 && 
defšed
 
__USE_GNU


871 
	#M_Ef32x
 
	`__f32x
 (2.718281828459045235360287471352662498è

	)

872 
	#M_LOG2Ef32x
 
	`__f32x
 (1.442695040888963407359924681001892137è

	)

873 
	#M_LOG10Ef32x
 
	`__f32x
 (0.434294481903251827651128918916605082è

	)

874 
	#M_LN2f32x
 
	`__f32x
 (0.693147180559945309417232121458176568è

	)

875 
	#M_LN10f32x
 
	`__f32x
 (2.302585092994045684017991454684364208è

	)

876 
	#M_PIf32x
 
	`__f32x
 (3.141592653589793238462643383279502884è

	)

877 
	#M_PI_2f32x
 
	`__f32x
 (1.570796326794896619231321691639751442è

	)

878 
	#M_PI_4f32x
 
	`__f32x
 (0.785398163397448309615660845819875721è

	)

879 
	#M_1_PIf32x
 
	`__f32x
 (0.318309886183790671537767526745028724è

	)

880 
	#M_2_PIf32x
 
	`__f32x
 (0.636619772367581343075535053490057448è

	)

881 
	#M_2_SQRTPIf32x
 
	`__f32x
 (1.128379167095512573896158903121545172è

	)

882 
	#M_SQRT2f32x
 
	`__f32x
 (1.414213562373095048801688724209698079è

	)

883 
	#M_SQRT1_2f32x
 
	`__f32x
 (0.707106781186547524400844362104849039è

	)

886 #ià
__HAVE_FLOAT64X
 && 
defšed
 
__USE_GNU


887 
	#M_Ef64x
 
	`__f64x
 (2.718281828459045235360287471352662498è

	)

888 
	#M_LOG2Ef64x
 
	`__f64x
 (1.442695040888963407359924681001892137è

	)

889 
	#M_LOG10Ef64x
 
	`__f64x
 (0.434294481903251827651128918916605082è

	)

890 
	#M_LN2f64x
 
	`__f64x
 (0.693147180559945309417232121458176568è

	)

891 
	#M_LN10f64x
 
	`__f64x
 (2.302585092994045684017991454684364208è

	)

892 
	#M_PIf64x
 
	`__f64x
 (3.141592653589793238462643383279502884è

	)

893 
	#M_PI_2f64x
 
	`__f64x
 (1.570796326794896619231321691639751442è

	)

894 
	#M_PI_4f64x
 
	`__f64x
 (0.785398163397448309615660845819875721è

	)

895 
	#M_1_PIf64x
 
	`__f64x
 (0.318309886183790671537767526745028724è

	)

896 
	#M_2_PIf64x
 
	`__f64x
 (0.636619772367581343075535053490057448è

	)

897 
	#M_2_SQRTPIf64x
 
	`__f64x
 (1.128379167095512573896158903121545172è

	)

898 
	#M_SQRT2f64x
 
	`__f64x
 (1.414213562373095048801688724209698079è

	)

899 
	#M_SQRT1_2f64x
 
	`__f64x
 (0.707106781186547524400844362104849039è

	)

902 #ià
__HAVE_FLOAT128X
 && 
defšed
 
__USE_GNU


909 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


910 
	#__NO_MATH_INLINES
 1

	)

913 #ifdeà
__USE_ISOC99


914 #ià
__GNUC_PREREQ
 (3, 1)

921 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

922 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

923 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

924 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

925 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

926 
	#isunÜd”ed
(
x
, 
y
è
	`__butš_isunÜd”ed
(x, y)

	)

928 
	#isg»©”
(
x
, 
y
) \

929 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

930 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; }))

	)

931 
	#isg»©”equ®
(
x
, 
y
) \

932 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

933 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

934 
	#i¦ess
(
x
, 
y
) \

935 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

936 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

937 
	#i¦es£qu®
(
x
, 
y
) \

938 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

939 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

940 
	#i¦essg»©”
(
x
, 
y
) \

941 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

942 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x !ğ__y; }))

	)

944 
	#isunÜd”ed
(
x
, 
y
) \

945 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__u
 = (x); __ty³of__ (
y
è
__v
 = (y); \

946 
__u
 !ğ
__v
 && (__u !ğ__u || __v !ğ__v); }))

	)

951 #ifdeà
__USE_EXTERN_INLINES


952 
	~<b™s/m©hšlše.h
>

957 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

960 
	#_MdoubË_
 

	)

961 
	#__MATH_DECLARING_DOUBLE
 1

	)

962 
	#__MATH_DECLARING_FLOATN
 0

	)

963 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

964 
funùiÚ
 ## 
»’Œªt


	)

965 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

966 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

967 
	~<b™s/m©h-fš™e.h
>

968 #undeà
_MdoubË_


969 #undeà
__MATH_DECLARING_DOUBLE


970 #undeà
__MATH_DECLARING_FLOATN


971 #undeà
__REDIRFROM_X


972 #undeà
__REDIRTO_X


976 #ifdeà
__USE_ISOC99


979 
	#_MdoubË_
 

	)

980 
	#__MATH_DECLARING_DOUBLE
 0

	)

981 
	#__MATH_DECLARING_FLOATN
 0

	)

982 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

983 
funùiÚ
 ## 
f
 ## 
»’Œªt


	)

984 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

985 
__
 ## 
funùiÚ
 ## 
f
 ## 
»’Œªt
 ## 
_fš™e


	)

986 
	~<b™s/m©h-fš™e.h
>

987 #undeà
_MdoubË_


988 #undeà
__MATH_DECLARING_DOUBLE


989 #undeà
__MATH_DECLARING_FLOATN


990 #undeà
__REDIRFROM_X


991 #undeà
__REDIRTO_X


994 #ifdeà
__MATH_DECLARE_LDOUBLE


995 
	#_MdoubË_
 

	)

996 
	#__MATH_DECLARING_DOUBLE
 0

	)

997 
	#__MATH_DECLARING_FLOATN
 0

	)

998 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

999 
funùiÚ
 ## 
l
 ## 
»’Œªt


	)

1000 #ifdeà
__NO_LONG_DOUBLE_MATH


1001 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1002 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1004 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1005 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1007 
	~<b™s/m©h-fš™e.h
>

1008 #undeà
_MdoubË_


1009 #undeà
__MATH_DECLARING_DOUBLE


1010 #undeà
__MATH_DECLARING_FLOATN


1011 #undeà
__REDIRFROM_X


1012 #undeà
__REDIRTO_X


1019 #ià(
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
defšed
 
_LIBC
)) \

1020 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1021 
	#_MdoubË_
 
_Flßt16


	)

1022 
	#__MATH_DECLARING_DOUBLE
 0

	)

1023 
	#__MATH_DECLARING_FLOATN
 1

	)

1024 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1025 
funùiÚ
 ## 
f16
 ## 
»’Œªt


	)

1026 #ià
__HAVE_DISTINCT_FLOAT16


1027 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1028 
__
 ## 
funùiÚ
 ## 
f16
 ## 
»’Œªt
 ## 
_fš™e


	)

1032 
	~<b™s/m©h-fš™e.h
>

1033 #undeà
_MdoubË_


1034 #undeà
__MATH_DECLARING_DOUBLE


1035 #undeà
__MATH_DECLARING_FLOATN


1036 #undeà
__REDIRFROM_X


1037 #undeà
__REDIRTO_X


1040 #ià(
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
defšed
 
_LIBC
)) \

1041 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1042 
	#_MdoubË_
 
_Flßt32


	)

1043 
	#__MATH_DECLARING_DOUBLE
 0

	)

1044 
	#__MATH_DECLARING_FLOATN
 1

	)

1045 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1046 
funùiÚ
 ## 
f32
 ## 
»’Œªt


	)

1047 #ià
__HAVE_DISTINCT_FLOAT32


1048 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1049 
__
 ## 
funùiÚ
 ## 
f32
 ## 
»’Œªt
 ## 
_fš™e


	)

1051 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1052 
__
 ## 
funùiÚ
 ## 
f
 ## 
»’Œªt
 ## 
_fš™e


	)

1054 
	~<b™s/m©h-fš™e.h
>

1055 #undeà
_MdoubË_


1056 #undeà
__MATH_DECLARING_DOUBLE


1057 #undeà
__MATH_DECLARING_FLOATN


1058 #undeà
__REDIRFROM_X


1059 #undeà
__REDIRTO_X


1062 #ià(
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
defšed
 
_LIBC
)) \

1063 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1064 
	#_MdoubË_
 
_Flßt64


	)

1065 
	#__MATH_DECLARING_DOUBLE
 0

	)

1066 
	#__MATH_DECLARING_FLOATN
 1

	)

1067 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1068 
funùiÚ
 ## 
f64
 ## 
»’Œªt


	)

1069 #ià
__HAVE_DISTINCT_FLOAT64


1070 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1071 
__
 ## 
funùiÚ
 ## 
f64
 ## 
»’Œªt
 ## 
_fš™e


	)

1073 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1074 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1076 
	~<b™s/m©h-fš™e.h
>

1077 #undeà
_MdoubË_


1078 #undeà
__MATH_DECLARING_DOUBLE


1079 #undeà
__MATH_DECLARING_FLOATN


1080 #undeà
__REDIRFROM_X


1081 #undeà
__REDIRTO_X


1084 #ià(
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
defšed
 
_LIBC
)) \

1085 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1086 
	#_MdoubË_
 
_Flßt128


	)

1087 
	#__MATH_DECLARING_DOUBLE
 0

	)

1088 
	#__MATH_DECLARING_FLOATN
 1

	)

1089 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1090 
funùiÚ
 ## 
f128
 ## 
»’Œªt


	)

1091 #ià
__HAVE_DISTINCT_FLOAT128


1092 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1093 
__
 ## 
funùiÚ
 ## 
f128
 ## 
»’Œªt
 ## 
_fš™e


	)

1095 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1096 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1098 
	~<b™s/m©h-fš™e.h
>

1099 #undeà
_MdoubË_


1100 #undeà
__MATH_DECLARING_DOUBLE


1101 #undeà
__MATH_DECLARING_FLOATN


1102 #undeà
__REDIRFROM_X


1103 #undeà
__REDIRTO_X


1106 #ià(
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
defšed
 
_LIBC
)) \

1107 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1108 
	#_MdoubË_
 
_Flßt32x


	)

1109 
	#__MATH_DECLARING_DOUBLE
 0

	)

1110 
	#__MATH_DECLARING_FLOATN
 1

	)

1111 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1112 
funùiÚ
 ## 
f32x
 ## 
»’Œªt


	)

1113 #ià
__HAVE_DISTINCT_FLOAT32X


1114 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1115 
__
 ## 
funùiÚ
 ## 
f32x
 ## 
»’Œªt
 ## 
_fš™e


	)

1117 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1118 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1120 
	~<b™s/m©h-fš™e.h
>

1121 #undeà
_MdoubË_


1122 #undeà
__MATH_DECLARING_DOUBLE


1123 #undeà
__MATH_DECLARING_FLOATN


1124 #undeà
__REDIRFROM_X


1125 #undeà
__REDIRTO_X


1128 #ià(
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
defšed
 
_LIBC
)) \

1129 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1130 
	#_MdoubË_
 
_Flßt64x


	)

1131 
	#__MATH_DECLARING_DOUBLE
 0

	)

1132 
	#__MATH_DECLARING_FLOATN
 1

	)

1133 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1134 
funùiÚ
 ## 
f64x
 ## 
»’Œªt


	)

1135 #ià
__HAVE_DISTINCT_FLOAT64X


1136 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1137 
__
 ## 
funùiÚ
 ## 
f64x
 ## 
»’Œªt
 ## 
_fš™e


	)

1138 #–ià
__HAVE_FLOAT64X_LONG_DOUBLE


1139 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1140 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1142 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1143 
__
 ## 
funùiÚ
 ## 
f128
 ## 
»’Œªt
 ## 
_fš™e


	)

1145 
	~<b™s/m©h-fš™e.h
>

1146 #undeà
_MdoubË_


1147 #undeà
__MATH_DECLARING_DOUBLE


1148 #undeà
__MATH_DECLARING_FLOATN


1149 #undeà
__REDIRFROM_X


1150 #undeà
__REDIRTO_X


1153 #ià(
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
defšed
 
_LIBC
)) \

1154 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1155 
	#_MdoubË_
 
_Flßt128x


	)

1156 
	#__MATH_DECLARING_DOUBLE
 0

	)

1157 
	#__MATH_DECLARING_FLOATN
 1

	)

1158 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1159 
funùiÚ
 ## 
f128x
 ## 
»’Œªt


	)

1160 #ià
__HAVE_DISTINCT_FLOAT128X


1161 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1162 
__
 ## 
funùiÚ
 ## 
f128x
 ## 
»’Œªt
 ## 
_fš™e


	)

1166 
	~<b™s/m©h-fš™e.h
>

1167 #undeà
_MdoubË_


1168 #undeà
__MATH_DECLARING_DOUBLE


1169 #undeà
__MATH_DECLARING_FLOATN


1170 #undeà
__REDIRFROM_X


1171 #undeà
__REDIRTO_X


1176 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

1179 #ià
__FLT_EVAL_METHOD__
 == 2 || __FLT_EVAL_METHOD__ > 64

1180 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0L)

	)

1181 #–ià
__FLT_EVAL_METHOD__
 == 1 || __FLT_EVAL_METHOD__ > 32

1182 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0)

	)

1183 #–ià
__FLT_EVAL_METHOD__
 == 0 || __FLT_EVAL_METHOD__ == 32

1184 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0f)

	)

1186 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (y))

	)

1191 #ià!
defšed
 
__ılu¥lus
 || (__ılu¥lu < 201103L && !defšed 
__GNUC__
)

1192 
	#i£qsig
(
x
, 
y
) \

1193 
	`__MATH_TG
 (
	`__MATH_EVAL_FMT2
 (
x
, 
y
), 
__i£qsig
, ((x), (y)))

	)

1206 
‹m¶©e
<
ty³Çme
> 
__i£qsig_ty³
;

1208 
‹m¶©e
<> 
__i£qsig_ty³
<>

1210 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1212  
	`__i£qsigf
 (
__x
, 
__y
);

1216 
‹m¶©e
<> 
__i£qsig_ty³
<>

1218 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1220  
	`__i£qsig
 (
__x
, 
__y
);

1224 
‹m¶©e
<> 
__i£qsig_ty³
<>

1226 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1228 #iâdeà
__NO_LONG_DOUBLE_MATH


1229  
	`__i£qsigl
 (
__x
, 
__y
);

1231  
	`__i£qsig
 (
__x
, 
__y
);

1236 #ià
__HAVE_DISTINCT_FLOAT128


1237 
‹m¶©e
<> 
__i£qsig_ty³
<
_Flßt128
>

1239 
	`__ÿÎ
 (
_Flßt128
 
__x
, _Flßt128 
__y
è
	`throw
 ()

1241  
	`__i£qsigf128
 (
__x
, 
__y
);

1246 
‹m¶©e
<
ty³Çme
 
_T1
,y³Çm
_T2
>

1247 
šlše
 

1248 
	`i£qsig
 (
_T1
 
__x
, 
_T2
 
__y
è
	`throw
 ()

1250 #ià
__ılu¥lus
 >= 201103L

1251 
	`deşty³
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)è
	t_T3
;

1253 
	`__ty³of
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)è
	t_T3
;

1255  
__i£qsig_ty³
<
_T3
>::
	`__ÿÎ
 (
__x
, 
__y
);

1258 
	}
}

1263 
__END_DECLS


	@/usr/include/netdb.h

22 #iâdef 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<b™s/¡dšt-ušŠ.h
>

29 #ifdeà
__USE_MISC


32 
	~<½c/Ãtdb.h
>

35 #ifdeà
__USE_GNU


36 
	~<b™s/ty³s/sigev’t_t.h
>

37 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

40 
	~<b™s/Ãtdb.h
>

43 
	#_PATH_HEQUIV
 "/‘c/ho¡s.equiv"

	)

44 
	#_PATH_HOSTS
 "/‘c/ho¡s"

	)

45 
	#_PATH_NETWORKS
 "/‘c/ÃtwÜks"

	)

46 
	#_PATH_NSSWITCH_CONF
 "/‘c/nssw™ch.cÚf"

	)

47 
	#_PATH_PROTOCOLS
 "/‘c/´ÙocŞs"

	)

48 
	#_PATH_SERVICES
 "/‘c/£rviûs"

	)

51 
	g__BEGIN_DECLS


53 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


56 
	#h_”ºo
 (*
	`__h_”ºo_loÿtiÚ
 ())

	)

59 *
	$__h_”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

63 
	#HOST_NOT_FOUND
 1

	)

64 
	#TRY_AGAIN
 2

	)

66 
	#NO_RECOVERY
 3

	)

68 
	#NO_DATA
 4

	)

71 #ifdeà
__USE_MISC


72 
	#NETDB_INTERNAL
 -1

	)

73 
	#NETDB_SUCCESS
 0

	)

74 
	#NO_ADDRESS
 
NO_DATA


	)

77 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_XOPEN_EXTENDED


79 
	#IPPORT_RESERVED
 1024

	)

82 #ifdeà
__USE_GNU


84 
	#SCOPE_DELIMITER
 '%'

	)

87 #ifdeà
__USE_MISC


90 
	$h”rÜ
 (cÚ¡ *
__¡r
è
__THROW
;

93 cÚ¡ *
	$h¡»¼Ü
 (
__”r_num
è
__THROW
;

98 
	sho¡’t


100 *
h_Çme
;

101 **
h_®Ÿ£s
;

102 
h_add¹y³
;

103 
h_Ëngth
;

104 **
h_addr_li¡
;

105 #ifdeà
__USE_MISC


106 
	#h_addr
 
h_addr_li¡
[0]

	)

115 
	`£tho¡’t
 (
__¡ay_İ’
);

121 
	`’dho¡’t
 ();

128 
ho¡’t
 *
	`g‘ho¡’t
 ();

135 
ho¡’t
 *
	`g‘ho¡byaddr
 (cÚ¡ *
__addr
, 
__sockËn_t
 
__Ën
,

136 
__ty³
);

142 
ho¡’t
 *
	`g‘ho¡byÇme
 (cÚ¡ *
__Çme
);

144 #ifdeà
__USE_MISC


153 
ho¡’t
 *
	`g‘ho¡byÇme2
 (cÚ¡ *
__Çme
, 
__af
);

165 
	`g‘ho¡’t_r
 (
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

166 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

167 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

168 *
__»¡riù
 
__h_”ºİ
);

170 
	`g‘ho¡byaddr_r
 (cÚ¡ *
__»¡riù
 
__addr
, 
__sockËn_t
 
__Ën
,

171 
__ty³
,

172 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

173 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

174 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

175 *
__»¡riù
 
__h_”ºİ
);

177 
	`g‘ho¡byÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

178 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

179 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

180 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

181 *
__»¡riù
 
__h_”ºİ
);

183 
	`g‘ho¡byÇme2_r
 (cÚ¡ *
__»¡riù
 
__Çme
, 
__af
,

184 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

185 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

186 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

187 *
__»¡riù
 
__h_”ºİ
);

196 
	`£Š‘’t
 (
__¡ay_İ’
);

202 
	`’dÃ‹Á
 ();

209 
Ã‹Á
 *
	`g‘Ã‹Á
 ();

216 
Ã‹Á
 *
	`g‘Ãtbyaddr
 (
ušt32_t
 
__Ãt
, 
__ty³
);

222 
Ã‹Á
 *
	`g‘ÃtbyÇme
 (cÚ¡ *
__Çme
);

224 #ifdef 
__USE_MISC


235 
	`g‘Ã‹Á_r
 (
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

236 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

237 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

238 *
__»¡riù
 
__h_”ºİ
);

240 
	`g‘Ãtbyaddr_r
 (
ušt32_t
 
__Ãt
, 
__ty³
,

241 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

242 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

243 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

244 *
__»¡riù
 
__h_”ºİ
);

246 
	`g‘ÃtbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

247 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

248 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

249 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

250 *
__»¡riù
 
__h_”ºİ
);

255 
	s£rv’t


257 *
s_Çme
;

258 **
s_®Ÿ£s
;

259 
s_pÜt
;

260 *
s_´Ùo
;

268 
	`£t£rv’t
 (
__¡ay_İ’
);

274 
	`’d£rv’t
 ();

281 
£rv’t
 *
	`g‘£rv’t
 ();

288 
£rv’t
 *
	`g‘£rvbyÇme
 (cÚ¡ *
__Çme
, cÚ¡ *
__´Ùo
);

295 
£rv’t
 *
	`g‘£rvbypÜt
 (
__pÜt
, cÚ¡ *
__´Ùo
);

298 #ifdef 
__USE_MISC


306 
	`g‘£rv’t_r
 (
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

307 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

308 
£rv’t
 **
__»¡riù
 
__»suÉ
);

310 
	`g‘£rvbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

311 cÚ¡ *
__»¡riù
 
__´Ùo
,

312 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

313 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

314 
£rv’t
 **
__»¡riù
 
__»suÉ
);

316 
	`g‘£rvbypÜt_r
 (
__pÜt
, cÚ¡ *
__»¡riù
 
__´Ùo
,

317 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

318 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

319 
£rv’t
 **
__»¡riù
 
__»suÉ
);

324 
	s´ÙÛÁ


326 *
p_Çme
;

327 **
p_®Ÿ£s
;

328 
p_´Ùo
;

336 
	`£rÙÛÁ
 (
__¡ay_İ’
);

342 
	`’d´ÙÛÁ
 ();

349 
´ÙÛÁ
 *
	`g‘´ÙÛÁ
 ();

355 
´ÙÛÁ
 *
	`g‘´ÙobyÇme
 (cÚ¡ *
__Çme
);

361 
´ÙÛÁ
 *
	`g‘´Ùobynumb”
 (
__´Ùo
);

364 #ifdef 
__USE_MISC


372 
	`g‘´ÙÛÁ_r
 (
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

373 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

374 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

376 
	`g‘´ÙobyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

377 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

378 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

379 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

381 
	`g‘´Ùobynumb”_r
 (
__´Ùo
,

382 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

383 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

384 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

393 
	`£Š‘g»Á
 (cÚ¡ *
__Ãtgroup
);

401 
	`’dÃtg»Á
 ();

410 
	`g‘Ãtg»Á
 (**
__»¡riù
 
__ho¡p
,

411 **
__»¡riù
 
__u£½
,

412 **
__»¡riù
 
__domašp
);

421 
	`šÃtgr
 (cÚ¡ *
__Ãtgroup
, cÚ¡ *
__ho¡
,

422 cÚ¡ *
__u£r
, cÚ¡ *
__domaš
);

430 
	`g‘Ãtg»Á_r
 (**
__»¡riù
 
__ho¡p
,

431 **
__»¡riù
 
__u£½
,

432 **
__»¡riù
 
__domašp
,

433 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
);

437 #ifdeà
__USE_MISC


449 
	`rcmd
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

450 cÚ¡ *
__»¡riù
 
__locu£r
,

451 cÚ¡ *
__»¡riù
 
__»mu£r
,

452 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

461 
	`rcmd_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

462 cÚ¡ *
__»¡riù
 
__locu£r
,

463 cÚ¡ *
__»¡riù
 
__»mu£r
,

464 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

465 
§_çmy_t
 
__af
);

477 
	`»xec
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

478 cÚ¡ *
__»¡riù
 
__Çme
,

479 cÚ¡ *
__»¡riù
 
__·ss
,

480 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

489 
	`»xec_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

490 cÚ¡ *
__»¡riù
 
__Çme
,

491 cÚ¡ *
__»¡riù
 
__·ss
,

492 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

493 
§_çmy_t
 
__af
);

503 
	`ru£rok
 (cÚ¡ *
__rho¡
, 
__su£r
,

504 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

513 
	`ru£rok_af
 (cÚ¡ *
__rho¡
, 
__su£r
,

514 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

515 
§_çmy_t
 
__af
);

526 
	`œu£rok
 (
ušt32_t
 
__¿ddr
, 
__su£r
,

527 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

537 
	`œu£rok_af
 (cÚ¡ *
__¿ddr
, 
__su£r
,

538 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

539 
§_çmy_t
 
__af
);

549 
	`¼esvpÜt
 (*
__®pÜt
);

558 
	`¼esvpÜt_af
 (*
__®pÜt
, 
§_çmy_t
 
__af
);

563 #ifdeà
__USE_XOPEN2K


565 
	saddršfo


567 
ai_æags
;

568 
ai_çmy
;

569 
ai_sockty³
;

570 
ai_´ÙocŞ
;

571 
sockËn_t
 
ai_add¾’
;

572 
sockaddr
 *
ai_addr
;

573 *
ai_ÿnÚÇme
;

574 
addršfo
 *
ai_Ãxt
;

577 #ifdeà
__USE_GNU


579 
	sgaicb


581 cÚ¡ *
¬_Çme
;

582 cÚ¡ *
¬_£rviû
;

583 cÚ¡ 
addršfo
 *
¬_»que¡
;

584 
addršfo
 *
¬_»suÉ
;

586 
__»tuº
;

587 
__glibc_»£rved
[5];

591 
	#GAI_WAIT
 0

	)

592 
	#GAI_NOWAIT
 1

	)

596 
	#AI_PASSIVE
 0x0001

	)

597 
	#AI_CANONNAME
 0x0002

	)

598 
	#AI_NUMERICHOST
 0x0004

	)

599 
	#AI_V4MAPPED
 0x0008

	)

600 
	#AI_ALL
 0x0010

	)

601 
	#AI_ADDRCONFIG
 0x0020

	)

603 #ifdeà
__USE_GNU


604 
	#AI_IDN
 0x0040

	)

607 
	#AI_CANONIDN
 0x0080

	)

608 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

610 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

613 
	#AI_NUMERICSERV
 0x0400

	)

616 
	#EAI_BADFLAGS
 -1

	)

617 
	#EAI_NONAME
 -2

	)

618 
	#EAI_AGAIN
 -3

	)

619 
	#EAI_FAIL
 -4

	)

620 
	#EAI_FAMILY
 -6

	)

621 
	#EAI_SOCKTYPE
 -7

	)

622 
	#EAI_SERVICE
 -8

	)

623 
	#EAI_MEMORY
 -10

	)

624 
	#EAI_SYSTEM
 -11

	)

625 
	#EAI_OVERFLOW
 -12

	)

626 #ifdeà
__USE_GNU


627 
	#EAI_NODATA
 -5

	)

628 
	#EAI_ADDRFAMILY
 -9

	)

629 
	#EAI_INPROGRESS
 -100

	)

630 
	#EAI_CANCELED
 -101

	)

631 
	#EAI_NOTCANCELED
 -102

	)

632 
	#EAI_ALLDONE
 -103

	)

633 
	#EAI_INTR
 -104

	)

634 
	#EAI_IDN_ENCODE
 -105

	)

637 #ifdeà
__USE_MISC


638 
	#NI_MAXHOST
 1025

	)

639 
	#NI_MAXSERV
 32

	)

642 
	#NI_NUMERICHOST
 1

	)

643 
	#NI_NUMERICSERV
 2

	)

644 
	#NI_NOFQDN
 4

	)

645 
	#NI_NAMEREQD
 8

	)

646 
	#NI_DGRAM
 16

	)

647 #ifdeà
__USE_GNU


648 
	#NI_IDN
 32

	)

649 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

651 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

660 
	`g‘addršfo
 (cÚ¡ *
__»¡riù
 
__Çme
,

661 cÚ¡ *
__»¡riù
 
__£rviû
,

662 cÚ¡ 
addršfo
 *
__»¡riù
 
__»q
,

663 
addršfo
 **
__»¡riù
 
__·i
);

666 
	$ä“addršfo
 (
addršfo
 *
__ai
è
__THROW
;

669 cÚ¡ *
	$gai_¡»¼Ü
 (
__ecode
è
__THROW
;

675 
	`g‘Çmešfo
 (cÚ¡ 
sockaddr
 *
__»¡riù
 
__§
,

676 
sockËn_t
 
__§Ën
, *
__»¡riù
 
__ho¡
,

677 
sockËn_t
 
__ho¡Ën
, *
__»¡riù
 
__£rv
,

678 
sockËn_t
 
__£rvËn
, 
__æags
);

681 #ifdeà
__USE_GNU


690 
	`g‘addršfo_a
 (
__mode
, 
gaicb
 *
__li¡
[
__»¡riù_¬r
],

691 
__’t
, 
sigev’t
 *
__»¡riù
 
__sig
);

701 
	`gai_su¥’d
 (cÚ¡ 
gaicb
 *cÚ¡ 
__li¡
[], 
__’t
,

702 cÚ¡ 
time¥ec
 *
__timeout
);

705 
	$gai_”rÜ
 (
gaicb
 *
__»q
è
__THROW
;

708 
	$gai_ÿnûl
 (
gaicb
 *
__gaicbp
è
__THROW
;

711 
__END_DECLS


	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<b™s/¡dšt-ušŠ.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_MPLS
 = 137,

89 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


98 #ià!
__USE_KERNEL_IPV6_DEFS


101 
	mIPPROTO_HOPOPTS
 = 0,

102 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

103 
	mIPPROTO_ROUTING
 = 43,

104 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

105 
	mIPPROTO_FRAGMENT
 = 44,

106 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

107 
	mIPPROTO_ICMPV6
 = 58,

108 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

109 
	mIPPROTO_NONE
 = 59,

110 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

111 
	mIPPROTO_DSTOPTS
 = 60,

112 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

113 
	mIPPROTO_MH
 = 135

114 
	#IPPROTO_MH
 
IPPROTO_MH


	)

119 
ušt16_t
 
	tš_pÜt_t
;

124 
	mIPPORT_ECHO
 = 7,

125 
	mIPPORT_DISCARD
 = 9,

126 
	mIPPORT_SYSTAT
 = 11,

127 
	mIPPORT_DAYTIME
 = 13,

128 
	mIPPORT_NETSTAT
 = 15,

129 
	mIPPORT_FTP
 = 21,

130 
	mIPPORT_TELNET
 = 23,

131 
	mIPPORT_SMTP
 = 25,

132 
	mIPPORT_TIMESERVER
 = 37,

133 
	mIPPORT_NAMESERVER
 = 42,

134 
	mIPPORT_WHOIS
 = 43,

135 
	mIPPORT_MTP
 = 57,

137 
	mIPPORT_TFTP
 = 69,

138 
	mIPPORT_RJE
 = 77,

139 
	mIPPORT_FINGER
 = 79,

140 
	mIPPORT_TTYLINK
 = 87,

141 
	mIPPORT_SUPDUP
 = 95,

144 
	mIPPORT_EXECSERVER
 = 512,

145 
	mIPPORT_LOGINSERVER
 = 513,

146 
	mIPPORT_CMDSERVER
 = 514,

147 
	mIPPORT_EFSSERVER
 = 520,

150 
	mIPPORT_BIFFUDP
 = 512,

151 
	mIPPORT_WHOSERVER
 = 513,

152 
	mIPPORT_ROUTESERVER
 = 520,

155 
	mIPPORT_RESERVED
 = 1024,

158 
	mIPPORT_USERRESERVED
 = 5000

166 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

167 
	#IN_CLASSA_NET
 0xff000000

	)

168 
	#IN_CLASSA_NSHIFT
 24

	)

169 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

170 
	#IN_CLASSA_MAX
 128

	)

172 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

173 
	#IN_CLASSB_NET
 0xffff0000

	)

174 
	#IN_CLASSB_NSHIFT
 16

	)

175 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

176 
	#IN_CLASSB_MAX
 65536

	)

178 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

179 
	#IN_CLASSC_NET
 0xffffff00

	)

180 
	#IN_CLASSC_NSHIFT
 8

	)

181 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

183 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

184 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

186 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

187 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

190 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

192 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

194 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

197 
	#IN_LOOPBACKNET
 127

	)

199 #iâdeà
INADDR_LOOPBACK


200 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

204 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

205 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

206 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

207 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

209 #ià!
__USE_KERNEL_IPV6_DEFS


211 
	sš6_addr


215 
ušt8_t
 
	m__u6_addr8
[16];

216 
ušt16_t
 
	m__u6_addr16
[8];

217 
ušt32_t
 
	m__u6_addr32
[4];

218 } 
	m__š6_u
;

219 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

220 #ifdeà
__USE_MISC


221 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

227 cÚ¡ 
š6_addr
 
š6addr_ªy
;

228 cÚ¡ 
š6_addr
 
š6addr_loİback
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_š


239 
__SOCKADDR_COMMON
 (
sš_
);

240 
š_pÜt_t
 
	msš_pÜt
;

241 
š_addr
 
	msš_addr
;

244 
	msš_z”o
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
š_pÜt_t
) -

247  (
š_addr
)];

250 #ià!
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_š6


254 
__SOCKADDR_COMMON
 (
sš6_
);

255 
š_pÜt_t
 
	msš6_pÜt
;

256 
ušt32_t
 
	msš6_æowšfo
;

257 
š6_addr
 
	msš6_addr
;

258 
ušt32_t
 
	msš6_scİe_id
;

262 #ifdeà
__USE_MISC


264 
	s_m»q


267 
š_addr
 
	mimr_muÉŸddr
;

270 
š_addr
 
	mimr_š‹rçû
;

273 
	s_m»q_sourû


276 
š_addr
 
	mimr_muÉŸddr
;

279 
š_addr
 
	mimr_š‹rçû
;

282 
š_addr
 
	mimr_sourûaddr
;

286 #ià!
__USE_KERNEL_IPV6_DEFS


288 
	sv6_m»q


291 
š6_addr
 
	mv6mr_muÉŸddr
;

294 
	mv6mr_š‹rçû
;

298 #ifdeà
__USE_MISC


300 
	sgroup_»q


303 
ušt32_t
 
	mgr_š‹rçû
;

306 
sockaddr_¡Üage
 
	mgr_group
;

309 
	sgroup_sourû_»q


312 
ušt32_t
 
	mg¤_š‹rçû
;

315 
sockaddr_¡Üage
 
	mg¤_group
;

318 
sockaddr_¡Üage
 
	mg¤_sourû
;

323 
	s_msf‹r


326 
š_addr
 
	mimsf_muÉŸddr
;

329 
š_addr
 
	mimsf_š‹rçû
;

332 
ušt32_t
 
	mimsf_fmode
;

335 
ušt32_t
 
	mimsf_num¤c
;

337 
š_addr
 
	mimsf_¦i¡
[1];

340 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

341 -  (
š_addr
) \

342 + (
num¤c
è*  (
š_addr
))

	)

344 
	sgroup_f‹r


347 
ušt32_t
 
	mgf_š‹rçû
;

350 
sockaddr_¡Üage
 
	mgf_group
;

353 
ušt32_t
 
	mgf_fmode
;

356 
ušt32_t
 
	mgf_num¤c
;

358 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

361 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

362 -  (
sockaddr_¡Üage
) \

363 + ((
num¤c
) \

364 *  (
sockaddr_¡Üage
)))

	)

374 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

375 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

376 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

382 
	~<’dŸn.h
>

385 
	~<b™s/by‹sw­.h
>

386 
	~<b™s/ušŠ-id’t™y.h
>

388 #ifdeà
__OPTIMIZE__


392 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


395 
	#Áohl
(
x
è
	`__ušt32_id’t™y
 (x)

	)

396 
	#Áohs
(
x
è
	`__ušt16_id’t™y
 (x)

	)

397 
	#htÚl
(
x
è
	`__ušt32_id’t™y
 (x)

	)

398 
	#htÚs
(
x
è
	`__ušt16_id’t™y
 (x)

	)

400 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


401 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

402 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

403 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

404 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

409 #ifdeà
__GNUC__


410 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

411 (
__ex‹nsiÚ__
 \

412 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

413 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

414 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

415 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

416 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ0; 
	}
}))

	)

418 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

419 (
__ex‹nsiÚ__
 \

420 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

421 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

422 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

423 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

424 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

426 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

427 (
__ex‹nsiÚ__
 \

428 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

429 (
__a
->
__š6_u
.
__u6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

431 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

432 (
__ex‹nsiÚ__
 \

433 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

434 (
__a
->
__š6_u
.
__u6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

436 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

437 (
__ex‹nsiÚ__
 \

438 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

439 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

440 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

441 && 
__a
->
__š6_u
.
__u6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

443 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

444 (
__ex‹nsiÚ__
 \

445 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

446 
__a
->
__š6_u
.
__u6_addr32
[0] == 0 \

447 && 
__a
->
__š6_u
.
__u6_addr32
[1] == 0 \

448 && 
__a
->
__š6_u
.
__u6_addr32
[2] == 0 \

449 && 
	`Áohl
 (
__a
->
__š6_u
.
__u6_addr32
[3]è> 1; }))

	)

451 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

452 (
__ex‹nsiÚ__
 \

453 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

454 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

455 
__a
->
__š6_u
.
__u6_addr32
[0] =ğ
__b
->__in6_u.__u6_addr32[0] \

456 && 
__a
->
__š6_u
.
__u6_addr32
[1] =ğ
__b
->__in6_u.__u6_addr32[1] \

457 && 
__a
->
__š6_u
.
__u6_addr32
[2] =ğ
__b
->__in6_u.__u6_addr32[2] \

458 && 
__a
->
__š6_u
.
__u6_addr32
[3] =ğ
__b
->__š6_u.__u6_addr32[3]; }))

	)

460 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

461 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

462 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

464 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

466 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

467 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

468 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

470 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

472 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

473 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

474 =ğ
	`htÚl
 (0xã800000))

	)

476 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

477 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

478 =ğ
	`htÚl
 (0xãc00000))

	)

480 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

481 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

482 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

483 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

485 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

486 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

487 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

488 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

489 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

491 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

492 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

493 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

495 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

498 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

500 #ifdeà
__USE_MISC


502 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

505 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

506 
__THROW
;

510 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

511 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

512 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

514 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

515 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

516 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

518 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

519 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

520 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

522 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

523 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

524 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

526 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

527 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

528 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

531 #ifdeà
__USE_GNU


532 
cmsghdr
;

534 #ià!
__USE_KERNEL_IPV6_DEFS


536 
	sš6_pktšfo


538 
š6_addr
 
i6_addr
;

539 
i6_ifšdex
;

543 
	s6_mtušfo


545 
sockaddr_š6
 
6m_addr
;

546 
ušt32_t
 
6m_mtu
;

551 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

552 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

553 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

554 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

555 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

556 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

557 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

558 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

559 
__muÉx
, 
__¶usy
)

560 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

561 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

562 
ušt8_t
 **
__Œp
)

563 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

564 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

565 
ušt8_t
 **
__Œp
, 
__ty³
)

566 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

570 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

571 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

572 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

573 **
__d©abuå
è
__THROW
;

574 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

575 
__THROW
;

576 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

577 
sockËn_t
 
__v®Ën
è
__THROW
;

578 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

579 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

580 **
__d©abuå
è
__THROW
;

581 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

582 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

583 **
__d©abuå
è
__THROW
;

584 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

585 
sockËn_t
 
__v®Ën
è
__THROW
;

589 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

590 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

591 
__£gm’ts
è
__THROW
;

592 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

593 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

594 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

595 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

596 
__THROW
;

602 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

603 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

604 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

605 
__THROW
;

608 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

609 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

610 
ušt32_t
 
__num¤c
,

611 cÚ¡ 
š_addr
 *
__¦i¡
)

612 
__THROW
;

616 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

617 cÚ¡ 
sockaddr
 *
__group
,

618 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

619 
ušt32_t
 *
__num¤c
,

620 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

623 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

624 cÚ¡ 
sockaddr
 *
__group
,

625 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

626 
ušt32_t
 
__num¤c
,

627 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

630 
__END_DECLS


	@/usr/include/netinet/tcp.h

32 #iâdeà
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<ã©u»s.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

54 
	#TCP_COOKIE_TRANSACTIONS
 15

	)

55 
	#TCP_THIN_LINEAR_TIMEOUTS
 16

	)

56 
	#TCP_THIN_DUPACK
 17

	)

57 
	#TCP_USER_TIMEOUT
 18

	)

58 
	#TCP_REPAIR
 19

	)

59 
	#TCP_REPAIR_QUEUE
 20

	)

60 
	#TCP_QUEUE_SEQ
 21

	)

61 
	#TCP_REPAIR_OPTIONS
 22

	)

62 
	#TCP_FASTOPEN
 23

	)

63 
	#TCP_TIMESTAMP
 24

	)

64 
	#TCP_NOTSENT_LOWAT
 25

	)

66 
	#TCP_CC_INFO
 26

	)

68 
	#TCP_SAVE_SYN
 27

	)

70 
	#TCP_SAVED_SYN
 28

	)

72 
	#TCP_REPAIR_WINDOW
 29

	)

73 
	#TCP_FASTOPEN_CONNECT
 30

	)

74 
	#TCP_ULP
 31

	)

75 
	#TCP_MD5SIG_EXT
 32

	)

77 #ifdeà
__USE_MISC


78 
	~<sys/ty³s.h
>

79 
	~<sys/sock‘.h
>

80 
	~<¡dšt.h
>

82 
ušt32_t
 
	ttı_£q
;

87 
	stıhdr


89 
__ex‹nsiÚ__
 union

93 
ušt16_t
 
	mth_¥Üt
;

94 
ušt16_t
 
	mth_dpÜt
;

95 
tı_£q
 
	mth_£q
;

96 
tı_£q
 
	mth_ack
;

97 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


98 
ušt8_t
 
	mth_x2
:4;

99 
ušt8_t
 
	mth_off
:4;

101 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


102 
ušt8_t
 
	mth_off
:4;

103 
ušt8_t
 
	mth_x2
:4;

105 
ušt8_t
 
	mth_æags
;

106 
	#TH_FIN
 0x01

	)

107 
	#TH_SYN
 0x02

	)

108 
	#TH_RST
 0x04

	)

109 
	#TH_PUSH
 0x08

	)

110 
	#TH_ACK
 0x10

	)

111 
	#TH_URG
 0x20

	)

112 
ušt16_t
 
	mth_wš
;

113 
ušt16_t
 
	mth_sum
;

114 
ušt16_t
 
	mth_u½
;

118 
ušt16_t
 
	msourû
;

119 
ušt16_t
 
	mde¡
;

120 
ušt32_t
 
	m£q
;

121 
ušt32_t
 
	mack_£q
;

122 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


123 
ušt16_t
 
	m»s1
:4;

124 
ušt16_t
 
	mdoff
:4;

125 
ušt16_t
 
	mfš
:1;

126 
ušt16_t
 
	msyn
:1;

127 
ušt16_t
 
	mr¡
:1;

128 
ušt16_t
 
	mpsh
:1;

129 
ušt16_t
 
	mack
:1;

130 
ušt16_t
 
	murg
:1;

131 
ušt16_t
 
	m»s2
:2;

132 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


133 
ušt16_t
 
	mdoff
:4;

134 
ušt16_t
 
	m»s1
:4;

135 
ušt16_t
 
	m»s2
:2;

136 
ušt16_t
 
	murg
:1;

137 
ušt16_t
 
	mack
:1;

138 
ušt16_t
 
	mpsh
:1;

139 
ušt16_t
 
	mr¡
:1;

140 
ušt16_t
 
	msyn
:1;

141 
ušt16_t
 
	mfš
:1;

145 
ušt16_t
 
	mwšdow
;

146 
ušt16_t
 
	mcheck
;

147 
ušt16_t
 
	murg_±r
;

154 
	mTCP_ESTABLISHED
 = 1,

155 
	mTCP_SYN_SENT
,

156 
	mTCP_SYN_RECV
,

157 
	mTCP_FIN_WAIT1
,

158 
	mTCP_FIN_WAIT2
,

159 
	mTCP_TIME_WAIT
,

160 
	mTCP_CLOSE
,

161 
	mTCP_CLOSE_WAIT
,

162 
	mTCP_LAST_ACK
,

163 
	mTCP_LISTEN
,

164 
	mTCP_CLOSING


167 
	#TCPOPT_EOL
 0

	)

168 
	#TCPOPT_NOP
 1

	)

169 
	#TCPOPT_MAXSEG
 2

	)

170 
	#TCPOLEN_MAXSEG
 4

	)

171 
	#TCPOPT_WINDOW
 3

	)

172 
	#TCPOLEN_WINDOW
 3

	)

173 
	#TCPOPT_SACK_PERMITTED
 4

	)

174 
	#TCPOLEN_SACK_PERMITTED
 2

	)

175 
	#TCPOPT_SACK
 5

	)

176 
	#TCPOPT_TIMESTAMP
 8

	)

177 
	#TCPOLEN_TIMESTAMP
 10

	)

178 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2è

	)

180 
	#TCPOPT_TSTAMP_HDR
 \

181 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

189 
	#TCP_MSS
 512

	)

191 
	#TCP_MAXWIN
 65535

	)

193 
	#TCP_MAX_WINSHIFT
 14

	)

195 
	#SOL_TCP
 6

	)

198 
	#TCPI_OPT_TIMESTAMPS
 1

	)

199 
	#TCPI_OPT_SACK
 2

	)

200 
	#TCPI_OPT_WSCALE
 4

	)

201 
	#TCPI_OPT_ECN
 8

	)

202 
	#TCPI_OPT_ECN_SEEN
 16

	)

203 
	#TCPI_OPT_SYN_DATA
 32

	)

206 
	etı_ÿ_¡©e


208 
	mTCP_CA_O³n
 = 0,

209 
	mTCP_CA_DisÜd”
 = 1,

210 
	mTCP_CA_CWR
 = 2,

211 
	mTCP_CA_Recov”y
 = 3,

212 
	mTCP_CA_Loss
 = 4

215 
	stı_šfo


217 
ušt8_t
 
	mtıi_¡©e
;

218 
ušt8_t
 
	mtıi_ÿ_¡©e
;

219 
ušt8_t
 
	mtıi_»Œªsm™s
;

220 
ušt8_t
 
	mtıi_´obes
;

221 
ušt8_t
 
	mtıi_backoff
;

222 
ušt8_t
 
	mtıi_İtiÚs
;

223 
ušt8_t
 
	mtıi_¢d_wsÿË
 : 4, 
	mtıi_rcv_wsÿË
 : 4;

225 
ušt32_t
 
	mtıi_¹o
;

226 
ušt32_t
 
	mtıi_©o
;

227 
ušt32_t
 
	mtıi_¢d_mss
;

228 
ušt32_t
 
	mtıi_rcv_mss
;

230 
ušt32_t
 
	mtıi_uÇcked
;

231 
ušt32_t
 
	mtıi_§cked
;

232 
ušt32_t
 
	mtıi_lo¡
;

233 
ušt32_t
 
	mtıi_»Œªs
;

234 
ušt32_t
 
	mtıi_çck‘s
;

237 
ušt32_t
 
	mtıi_Ï¡_d©a_£Á
;

238 
ušt32_t
 
	mtıi_Ï¡_ack_£Á
;

239 
ušt32_t
 
	mtıi_Ï¡_d©a_»cv
;

240 
ušt32_t
 
	mtıi_Ï¡_ack_»cv
;

243 
ušt32_t
 
	mtıi_pmtu
;

244 
ušt32_t
 
	mtıi_rcv_s¡h»sh
;

245 
ušt32_t
 
	mtıi_¹t
;

246 
ušt32_t
 
	mtıi_¹tv¬
;

247 
ušt32_t
 
	mtıi_¢d_s¡h»sh
;

248 
ušt32_t
 
	mtıi_¢d_cwnd
;

249 
ušt32_t
 
	mtıi_advmss
;

250 
ušt32_t
 
	mtıi_»Üd”šg
;

252 
ušt32_t
 
	mtıi_rcv_¹t
;

253 
ušt32_t
 
	mtıi_rcv_¥aû
;

255 
ušt32_t
 
	mtıi_tÙ®_»Œªs
;

260 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

263 
	#TCP_MD5SIG_FLAG_PREFIX
 1

	)

265 
	stı_md5sig


267 
sockaddr_¡Üage
 
	mtım_addr
;

268 
ušt8_t
 
	mtım_æags
;

269 
ušt8_t
 
	mtım_´efixËn
;

270 
ušt16_t
 
	mtım_keyËn
;

271 
ušt32_t
 
	m__tım_·d
;

272 
ušt8_t
 
	mtım_key
[
TCP_MD5SIG_MAXKEYLEN
];

276 
	stı_»·œ_İt


278 
ušt32_t
 
	mİt_code
;

279 
ušt32_t
 
	mİt_v®
;

285 
	mTCP_NO_QUEUE
,

286 
	mTCP_RECV_QUEUE
,

287 
	mTCP_SEND_QUEUE
,

288 
	mTCP_QUEUES_NR
,

292 
	#TCP_COOKIE_MIN
 8

	)

293 
	#TCP_COOKIE_MAX
 16

	)

294 
	#TCP_COOKIE_PAIR_SIZE
 (2*
TCP_COOKIE_MAX
)

	)

297 
	#TCP_COOKIE_IN_ALWAYS
 (1 << 0è

	)

298 
	#TCP_COOKIE_OUT_NEVER
 (1 << 1è

	)

302 
	#TCP_S_DATA_IN
 (1 << 2è

	)

303 
	#TCP_S_DATA_OUT
 (1 << 3è

	)

305 
	#TCP_MSS_DEFAULT
 536U

	)

306 
	#TCP_MSS_DESIRED
 1220U

	)

308 
	stı_cook›_Œª§ùiÚs


310 
ušt16_t
 
	mtıù_æags
;

311 
ušt8_t
 
	m__tıù_·d1
;

312 
ušt8_t
 
	mtıù_cook›_desœed
;

313 
ušt16_t
 
	mtıù_s_d©a_desœed
;

314 
ušt16_t
 
	mtıù_u£d
;

315 
ušt8_t
 
	mtıù_v®ue
[
TCP_MSS_DEFAULT
];

319 
	stı_»·œ_wšdow


321 
ušt32_t
 
	m¢d_wl1
;

322 
ušt32_t
 
	m¢d_wnd
;

323 
ušt32_t
 
	mmax_wšdow
;

324 
ušt32_t
 
	mrcv_wnd
;

325 
ušt32_t
 
	mrcv_wup
;

	@/usr/include/poll.h

1 
	~<sys/pŞl.h
>

	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

29 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

35 
	mPTHREAD_CREATE_JOINABLE
,

36 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

37 
	mPTHREAD_CREATE_DETACHED


38 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

45 
	mPTHREAD_MUTEX_TIMED_NP
,

46 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

47 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

48 
	mPTHREAD_MUTEX_ADAPTIVE_NP


49 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


51 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

52 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

53 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

54 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


56 #ifdeà
__USE_GNU


58 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


63 #ifdeà
__USE_XOPEN2K


67 
	mPTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

69 
	mPTHREAD_MUTEX_ROBUST
,

70 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


75 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


79 
	mPTHREAD_PRIO_NONE
,

80 
	mPTHREAD_PRIO_INHERIT
,

81 
	mPTHREAD_PRIO_PROTECT


86 #ià
__PTHREAD_MUTEX_HAVE_PREV


87 
	#PTHREAD_MUTEX_INITIALIZER
 \

88 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

89 #ifdeà
__USE_GNU


90 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

91 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

92 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

93 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

94 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

99 
	#PTHREAD_MUTEX_INITIALIZER
 \

100 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

101 #ifdeà
__USE_GNU


102 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

104 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

106 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

107 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


117 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

119 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

120 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


126 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


127 #ià
__WORDSIZE
 == 64

128 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

133 
	#PTHREAD_RWLOCK_INITIALIZER
 \

134 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

135 #ifdeà
__USE_GNU


136 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

138 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, \

139 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

141 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


142 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

143 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

144 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

146 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

147 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

148 0 } }

	)

158 
	mPTHREAD_INHERIT_SCHED
,

159 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

160 
	mPTHREAD_EXPLICIT_SCHED


161 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

168 
	mPTHREAD_SCOPE_SYSTEM
,

169 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

170 
	mPTHREAD_SCOPE_PROCESS


171 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

178 
	mPTHREAD_PROCESS_PRIVATE
,

179 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

180 
	mPTHREAD_PROCESS_SHARED


181 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

187 
	#PTHREAD_COND_INITIALIZER
 { { {0}, {0}, {0, 0}, {0, 0}, 0, 0, {0, 0} } }

	)

191 
	s_±h»ad_ş—nup_bufãr


193 (*
	m__routše
) (*);

194 *
	m__¬g
;

195 
	m__ÿnûÉy³
;

196 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

202 
	mPTHREAD_CANCEL_ENABLE
,

203 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

204 
	mPTHREAD_CANCEL_DISABLE


205 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

209 
	mPTHREAD_CANCEL_DEFERRED
,

210 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

211 
	mPTHREAD_CANCEL_ASYNCHRONOUS


212 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

214 
	#PTHREAD_CANCELED
 ((*è-1)

	)

218 
	#PTHREAD_ONCE_INIT
 0

	)

221 #ifdeà
__USE_XOPEN2K


225 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

229 
__BEGIN_DECLS


234 
	$±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

235 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

236 *(*
__¡¬t_routše
) (*),

237 *
__»¡riù
 
__¬g
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 3));

243 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

251 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

253 #ifdeà
__USE_GNU


256 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

264 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

265 cÚ¡ 
time¥ec
 *
__ab¡ime
);

272 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

276 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

279 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

280 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

288 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

291 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

292 
__THROW
 
	`__nÚnuÎ
 ((1));

295 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

296 *
__d‘ach¡©e
)

297 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

300 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

301 
__d‘ach¡©e
)

302 
__THROW
 
	`__nÚnuÎ
 ((1));

306 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

307 
size_t
 *
__gu¬dsize
)

308 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

311 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

312 
size_t
 
__gu¬dsize
)

313 
__THROW
 
	`__nÚnuÎ
 ((1));

317 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

318 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

319 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

322 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

323 cÚ¡ 
sched_·¿m
 *
__»¡riù


324 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

327 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


328 
__©Œ
, *
__»¡riù
 
__pŞicy
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

333 
__THROW
 
	`__nÚnuÎ
 ((1));

336 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


337 
__©Œ
, *
__»¡riù
 
__šh”™
)

338 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

341 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

342 
__šh”™
)

343 
__THROW
 
	`__nÚnuÎ
 ((1));

347 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

348 *
__»¡riù
 
__scİe
)

349 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

352 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

353 
__THROW
 
	`__nÚnuÎ
 ((1));

356 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


357 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

358 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

364 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

365 *
__¡ackaddr
)

366 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

369 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


370 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

371 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

376 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

377 
size_t
 
__¡acksize
)

378 
__THROW
 
	`__nÚnuÎ
 ((1));

380 #ifdeà
__USE_XOPEN2K


382 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

383 **
__»¡riù
 
__¡ackaddr
,

384 
size_t
 *
__»¡riù
 
__¡acksize
)

385 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

390 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

391 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

394 #ifdeà
__USE_GNU


397 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

398 
size_t
 
__ıu£tsize
,

399 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

400 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

404 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

405 
size_t
 
__ıu£tsize
,

406 
ıu_£t_t
 *
__ıu£t
)

407 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

410 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

411 
__THROW
 
	`__nÚnuÎ
 ((1));

415 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

416 
__THROW
 
	`__nÚnuÎ
 ((1));

421 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

422 
__THROW
 
	`__nÚnuÎ
 ((2));

430 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

431 cÚ¡ 
sched_·¿m
 *
__·¿m
)

432 
__THROW
 
	`__nÚnuÎ
 ((3));

435 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

436 *
__»¡riù
 
__pŞicy
,

437 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

438 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

441 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

442 
__THROW
;

445 #ifdeà
__USE_GNU


447 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

448 
size_t
 
__buæ’
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

452 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

453 
__THROW
 
	`__nÚnuÎ
 ((2));

457 #ifdeà
__USE_UNIX98


459 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

462 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

465 #ifdeà
__USE_GNU


470 
	$±h»ad_y›ld
 (è
__THROW
;

475 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

476 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

477 
__THROW
 
	`__nÚnuÎ
 ((3));

480 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

481 
ıu_£t_t
 *
__ıu£t
)

482 
__THROW
 
	`__nÚnuÎ
 ((3));

495 
	$±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

496 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

507 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

511 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

514 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

519 
	`±h»ad_‹¡ÿnûl
 ();

528 
__jmp_buf
 
__ÿnûl_jmp_buf
;

529 
__mask_was_§ved
;

530 } 
__ÿnûl_jmp_buf
[1];

531 *
__·d
[4];

532 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

535 #iâdeà
__ş—nup_fù_©Œibu‹


536 
	#__ş—nup_fù_©Œibu‹


	)

541 
	s__±h»ad_ş—nup_äame


543 (*
__ÿnûl_routše
) (*);

544 *
__ÿnûl_¬g
;

545 
__do_™
;

546 
__ÿnûl_ty³
;

549 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


550 #ifdeà
__ılu¥lus


552 şas 
	c__±h»ad_ş—nup_şass


554 (*
__ÿnûl_routše
) (*);

555 *
__ÿnûl_¬g
;

556 
__do_™
;

557 
__ÿnûl_ty³
;

559 
public
:

560 
	$__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

561 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

562 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

563 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

564 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

565 &
__ÿnûl_ty³
); 
	}
}

566 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

576 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

578 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

582 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

583 
__şäame
.
	`__£tdo™
 (
execu‹
); \

584 } 0)

	)

586 #ifdeà
__USE_GNU


590 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

592 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

593 
__şäame
.
	`__deãr
 ()

	)

598 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

599 
__şäame
.
	`__»¡Üe
 (); \

600 
__şäame
.
	`__£tdo™
 (
execu‹
); \

601 } 0)

	)

608 
__ex‹º_šlše
 

609 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

611 ià(
__äame
->
__do_™
)

612 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

613 
	}
}

622 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

624 
__±h»ad_ş—nup_äame
 
__şäame
 \

625 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

626 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

627 .
__do_™
 = 1 };

	)

631 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

632 
__şäame
.
__do_™
 = (
execu‹
); \

633 } 0)

	)

635 #ifdeà
__USE_GNU


639 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

641 
__±h»ad_ş—nup_äame
 
__şäame
 \

642 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

643 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

644 .
__do_™
 = 1 }; \

645 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

646 &
__şäame
.
__ÿnûl_ty³
)

	)

651 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

652 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

653 
__şäame
.
__do_™
 = (
execu‹
); \

654 } 0)

	)

665 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

667 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

668 (*
__ÿnûl_routše
è(*èğ(
routše
); \

669 *
__ÿnûl_¬g
 = (
¬g
); \

670 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

671 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

672 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

674 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

675 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

679 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

680 dØ{

	)

681 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

682 
__ş—nup_fù_©Œibu‹
;

686 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

689 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

690 ià(
execu‹
) \

691 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

692 } 0)

	)

693 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

694 
__ş—nup_fù_©Œibu‹
;

696 #ifdeà
__USE_GNU


700 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

702 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

703 (*
__ÿnûl_routše
è(*èğ(
routše
); \

704 *
__ÿnûl_¬g
 = (
¬g
); \

705 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

706 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

707 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

709 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

710 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

714 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

715 dØ{

	)

716 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

717 
__ş—nup_fù_©Œibu‹
;

722 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

725 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

726 ià(
execu‹
) \

727 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

728 
	}
} 0)

	)

729 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

730 
__ş—nup_fù_©Œibu‹
;

734 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

735 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

736 #iâdeà
SHARED


737 
	`__©Œibu‹__
 ((
__w—k__
))

743 
__jmp_buf_g
;

744 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

750 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

751 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

752 
__THROW
 
	`__nÚnuÎ
 ((1));

755 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

756 
__THROW
 
	`__nÚnuÎ
 ((1));

759 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

760 
__THROWNL
 
	`__nÚnuÎ
 ((1));

763 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

764 
__THROWNL
 
	`__nÚnuÎ
 ((1));

766 #ifdeà
__USE_XOPEN2K


768 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

769 cÚ¡ 
time¥ec
 *
__»¡riù


770 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

774 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

775 
__THROWNL
 
	`__nÚnuÎ
 ((1));

779 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

780 
__»¡riù
 
__mu‹x
,

781 *
__»¡riù
 
__´ioûšg
)

782 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

786 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

787 
__´ioûšg
,

788 *
__»¡riù
 
__Şd_ûšg
)

789 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

792 #ifdeà
__USE_XOPEN2K8


794 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

795 
__THROW
 
	`__nÚnuÎ
 ((1));

796 #ifdeà
__USE_GNU


797 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

798 
__THROW
 
	`__nÚnuÎ
 ((1));

807 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

808 
__THROW
 
	`__nÚnuÎ
 ((1));

811 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

812 
__THROW
 
	`__nÚnuÎ
 ((1));

815 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

816 
__»¡riù
 
__©Œ
,

817 *
__»¡riù
 
__psh¬ed
)

818 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

821 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

822 
__psh¬ed
)

823 
__THROW
 
	`__nÚnuÎ
 ((1));

825 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


827 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


828 
__©Œ
, *
__»¡riù
 
__kšd
)

829 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

834 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

835 
__THROW
 
	`__nÚnuÎ
 ((1));

839 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

840 
__»¡riù
 
__©Œ
,

841 *
__»¡riù
 
__´ÙocŞ
)

842 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

846 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

847 
__´ÙocŞ
)

848 
__THROW
 
	`__nÚnuÎ
 ((1));

851 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

852 
__»¡riù
 
__©Œ
,

853 *
__»¡riù
 
__´ioûšg
)

854 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

857 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

858 
__´ioûšg
)

859 
__THROW
 
	`__nÚnuÎ
 ((1));

861 #ifdeà
__USE_XOPEN2K


863 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

864 *
__robu¡Ãss
)

865 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

866 #ifdeà
__USE_GNU


867 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

868 *
__robu¡Ãss
)

869 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

873 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

874 
__robu¡Ãss
)

875 
__THROW
 
	`__nÚnuÎ
 ((1));

876 #ifdeà
__USE_GNU


877 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

878 
__robu¡Ãss
)

879 
__THROW
 
	`__nÚnuÎ
 ((1));

884 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


889 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

890 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


891 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

894 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

895 
__THROW
 
	`__nÚnuÎ
 ((1));

898 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

899 
__THROWNL
 
	`__nÚnuÎ
 ((1));

902 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

903 
__THROWNL
 
	`__nÚnuÎ
 ((1));

905 #ifdeà
__USE_XOPEN2K


907 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

908 cÚ¡ 
time¥ec
 *
__»¡riù


909 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

913 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

914 
__THROWNL
 
	`__nÚnuÎ
 ((1));

917 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

918 
__THROWNL
 
	`__nÚnuÎ
 ((1));

920 #ifdeà
__USE_XOPEN2K


922 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

923 cÚ¡ 
time¥ec
 *
__»¡riù


924 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

928 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

929 
__THROWNL
 
	`__nÚnuÎ
 ((1));

935 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

936 
__THROW
 
	`__nÚnuÎ
 ((1));

939 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

940 
__THROW
 
	`__nÚnuÎ
 ((1));

943 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

944 
__»¡riù
 
__©Œ
,

945 *
__»¡riù
 
__psh¬ed
)

946 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

949 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

950 
__psh¬ed
)

951 
__THROW
 
	`__nÚnuÎ
 ((1));

954 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

955 
__»¡riù
 
__©Œ
,

956 *
__»¡riù
 
__´ef
)

957 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

960 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

961 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

969 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

970 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

971 
__THROW
 
	`__nÚnuÎ
 ((1));

974 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

975 
__THROW
 
	`__nÚnuÎ
 ((1));

978 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

979 
__THROWNL
 
	`__nÚnuÎ
 ((1));

982 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

983 
__THROWNL
 
	`__nÚnuÎ
 ((1));

990 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

991 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

992 
	`__nÚnuÎ
 ((1, 2));

1001 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1002 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1003 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1004 
	`__nÚnuÎ
 ((1, 2, 3));

1009 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1010 
__THROW
 
	`__nÚnuÎ
 ((1));

1013 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1014 
__THROW
 
	`__nÚnuÎ
 ((1));

1017 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1018 
__»¡riù
 
__©Œ
,

1019 *
__»¡riù
 
__psh¬ed
)

1020 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1023 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1024 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1026 #ifdeà
__USE_XOPEN2K


1028 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1029 
__»¡riù
 
__©Œ
,

1030 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1031 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1034 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1035 
__şockid_t
 
__şock_id
)

1036 
__THROW
 
	`__nÚnuÎ
 ((1));

1040 #ifdeà
__USE_XOPEN2K


1045 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1046 
__THROW
 
	`__nÚnuÎ
 ((1));

1049 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1050 
__THROW
 
	`__nÚnuÎ
 ((1));

1053 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1054 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1057 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1058 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1061 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1062 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1069 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1070 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1071 
__©Œ
, 
__couÁ
)

1072 
__THROW
 
	`__nÚnuÎ
 ((1));

1075 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1076 
__THROW
 
	`__nÚnuÎ
 ((1));

1079 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1080 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1084 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1085 
__THROW
 
	`__nÚnuÎ
 ((1));

1088 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1089 
__THROW
 
	`__nÚnuÎ
 ((1));

1092 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1093 
__»¡riù
 
__©Œ
,

1094 *
__»¡riù
 
__psh¬ed
)

1095 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1098 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1099 
__psh¬ed
)

1100 
__THROW
 
	`__nÚnuÎ
 ((1));

1112 
	$±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1113 (*
__de¡r_funùiÚ
) (*))

1114 
__THROW
 
	`__nÚnuÎ
 ((1));

1117 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1120 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1123 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1124 cÚ¡ *
__poš‹r
è
__THROW
 ;

1127 #ifdeà
__USE_XOPEN2K


1129 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1130 
__şockid_t
 *
__şock_id
)

1131 
__THROW
 
	`__nÚnuÎ
 ((2));

1146 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1147 (*
__·»Á
) (),

1148 (*
__chd
è()è
__THROW
;

1151 #ifdeà
__USE_EXTERN_INLINES


1153 
__ex‹º_šlše
 

1154 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1156  
__th»ad1
 =ğ
__th»ad2
;

1157 
	}
}

1160 
	g__END_DECLS


	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

31 
	~<b™s/ty³s/time_t.h
>

32 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

33 #iâdeà
__USE_XOPEN2K


34 
	~<time.h
>

37 #iâdeà
__pid_t_defšed


38 
__pid_t
 
	tpid_t
;

39 
	#__pid_t_defšed


	)

43 
	~<b™s/sched.h
>

44 
	~<b™s/ıu-£t.h
>

47 
	#sched_´iÜ™y
 
sched_´iÜ™y


	)

48 
	#__sched_´iÜ™y
 
sched_´iÜ™y


	)

51 
__BEGIN_DECLS


54 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

55 
__THROW
;

58 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

61 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

62 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

65 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

68 
	$sched_y›ld
 (è
__THROW
;

71 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

74 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

77 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

80 #ifdeà
__USE_GNU


82 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

83 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

84 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

86 
ıu£
)

	)

87 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

88 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

90 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

91 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

92 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

93 
ıu£
)

	)

94 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

95 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

97 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

98 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

99 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

100 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

102 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

103 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

104 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

105 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

106 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

107 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

108 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

109 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

110 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

111 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

112 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

113 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

115 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

116 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

117 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

121 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

122 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

125 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

126 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

129 
__END_DECLS


	@/usr/include/setjmp.h

22 #iâdef 
_SETJMP_H


23 
	#_SETJMP_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/£tjmp.h
>

30 
	~<b™s/ty³s/__sig£t_t.h
>

33 
	s__jmp_buf_g


39 
__jmp_buf
 
	m__jmpbuf
;

40 
	m__mask_was_§ved
;

41 
__sig£t_t
 
	m__§ved_mask
;

45 
__jmp_buf_g
 
	tjmp_buf
[1];

49 
	$£tjmp
 (
jmp_buf
 
__’v
è
__THROWNL
;

54 
	$__sig£tjmp
 (
__jmp_buf_g
 
__’v
[1], 
__§vemask
è
__THROWNL
;

58 
	$_£tjmp
 (
__jmp_buf_g
 
__’v
[1]è
__THROWNL
;

62 
	#£tjmp
(
’v
è
	`_£tjmp
 (’v)

	)

67 
	$lÚgjmp
 (
__jmp_buf_g
 
__’v
[1], 
__v®
)

68 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

70 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


74 
	$_lÚgjmp
 (
__jmp_buf_g
 
__’v
[1], 
__v®
)

75 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

79 #ifdef 
__USE_POSIX


83 
__jmp_buf_g
 
	tsigjmp_buf
[1];

87 
	#sig£tjmp
(
’v
, 
§vemask
è
	`__sig£tjmp
 (’v, savemask)

	)

93 
	$siglÚgjmp
 (
sigjmp_buf
 
__’v
, 
__v®
)

94 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

99 #ià
__USE_FORTIFY_LEVEL
 > 0

100 
	~<b™s/£tjmp2.h
>

103 
__END_DECLS


	@/usr/include/signal.h

22 #iâdef 
_SIGNAL_H


23 
	#_SIGNAL_H


	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

30 
	~<b™s/signum.h
>

32 
	~<b™s/ty³s/sig_©omic_t.h
>

34 #ià
defšed
 
__USE_POSIX


35 
	~<b™s/ty³s/sig£t_t.h
>

38 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


39 #iâdeà
__pid_t_defšed


40 
__pid_t
 
	tpid_t
;

41 
	#__pid_t_defšed


	)

43 #ifdeà
__USE_XOPEN


45 #iâdeà
__uid_t_defšed


46 
__uid_t
 
	tuid_t
;

47 
	#__uid_t_defšed


	)

51 #ifdeà
__USE_POSIX199309


53 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

56 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


57 
	~<b™s/ty³s/sigšfo_t.h
>

58 
	~<b™s/sigšfo-cÚ¡s.h
>

61 #ifdeà
__USE_MISC


62 
	~<b™s/ty³s/sigv®_t.h
>

65 #ifdeà
__USE_POSIX199309


66 
	~<b™s/ty³s/sigev’t_t.h
>

67 
	~<b™s/sigev’t-cÚ¡s.h
>

72 (*
	t__sighªdËr_t
) ();

77 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

78 
__THROW
;

79 #ifdeà
__USE_GNU


80 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

81 
__THROW
;

87 #ifdeà
__USE_MISC


88 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

89 
__THROW
;

92 #ifdeà
__REDIRECT_NTH


93 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

94 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

95 
__sysv_sigÇl
);

97 
	#sigÇl
 
__sysv_sigÇl


	)

101 #ià
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8


104 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

105 
__THROW
;

111 #ifdeà
__USE_POSIX


112 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

115 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


119 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

123 
	$¿i£
 (
__sig
è
__THROW
;

125 #ifdeà
__USE_MISC


127 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

128 
__THROW
;

129 
	$gsigÇl
 (
__sig
è
__THROW
;

132 #ifdeà
__USE_XOPEN2K8


134 
	`psigÇl
 (
__sig
, cÚ¡ *
__s
);

137 
	`psigšfo
 (cÚ¡ 
sigšfo_t
 *
__pšfo
, cÚ¡ *
__s
);

149 #ifdeà
__USE_XOPEN_EXTENDED


150 #ifdeà
__GNUC__


151 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

153 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

155 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

160 #ifdeà
__USE_MISC


167 
	#sigmask
(
sig
è(()(1u << ((sigè- 1)))

	)

170 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

173 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

176 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

180 #ifdeà
__USE_MISC


181 
	#NSIG
 
_NSIG


	)

184 #ifdeà
__USE_GNU


185 
__sighªdËr_t
 
	tsighªdËr_t
;

189 #ifdeà
__USE_MISC


190 
__sighªdËr_t
 
	tsig_t
;

193 #ifdeà
__USE_POSIX


196 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

199 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

202 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

205 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

208 
	$sigismemb”
 (cÚ¡ 
sig£t_t
 *
__£t
, 
__signo
)

209 
__THROW
 
	`__nÚnuÎ
 ((1));

211 #ifdeà
__USE_GNU


213 
	$sigi£m±y£t
 (cÚ¡ 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

216 
	$sigªd£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

217 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

220 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

221 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

226 
	~<b™s/sigaùiÚ.h
>

229 
	$sig´ocmask
 (
__how
, cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

230 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

237 
	$sigsu¥’d
 (cÚ¡ 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

240 
	$sigaùiÚ
 (
__sig
, cÚ¡ 
sigaùiÚ
 *
__»¡riù
 
__aù
,

241 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

244 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

247 #ifdeà
__USE_POSIX199506


252 
	$sigwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

253 
	`__nÚnuÎ
 ((1, 2));

256 #ifdeà
__USE_POSIX199309


261 
	$sigwa™šfo
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

262 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

269 
	$sigtimedwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

270 
sigšfo_t
 *
__»¡riù
 
__šfo
,

271 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
)

272 
	`__nÚnuÎ
 ((1));

276 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cÚ¡ 
sigv®
 
__v®
)

277 
__THROW
;

282 #ifdeà
__USE_MISC


286 cÚ¡ *cÚ¡ 
_sys_sigli¡
[
_NSIG
];

287 cÚ¡ *cÚ¡ 
sys_sigli¡
[
_NSIG
];

291 
	~<b™s/sigcÚ‹xt.h
>

294 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

299 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


300 
	#__Ãed_size_t


	)

301 
	~<¡ddef.h
>

303 
	~<b™s/ty³s/¡ack_t.h
>

304 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


306 
	~<sys/ucÚ‹xt.h
>

310 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_MISC


314 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

316 
	~<b™s/sig¡ack.h
>

317 
	~<b™s/ss_æags.h
>

321 
	$sig®t¡ack
 (cÚ¡ 
¡ack_t
 *
__»¡riù
 
__ss
,

322 
¡ack_t
 *
__»¡riù
 
__oss
è
__THROW
;

325 #ià((
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

326 || 
defšed
 
__USE_MISC
)

327 
	~<b™s/ty³s/¡ruù_sig¡ack.h
>

330 #ià((
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

331 || 
defšed
 
__USE_MISC
)

335 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

336 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

339 #ifdeà
__USE_XOPEN_EXTENDED


343 
	$sighŞd
 (
__sig
è
__THROW
;

346 
	$sig»l£
 (
__sig
è
__THROW
;

349 
	$sigignÜe
 (
__sig
è
__THROW
;

352 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

355 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


358 
	~<b™s/±h»adty³s.h
>

359 
	~<b™s/sigth»ad.h
>

366 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

368 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

370 
	#SIGRTMIN
 (
	`__libc_cu¼’t_sig¹mš
 ())

	)

371 
	#SIGRTMAX
 (
	`__libc_cu¼’t_sig¹max
 ())

	)

373 
__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

27 
	~<b™s/ty³s.h
>

28 
	~<b™s/wch¬.h
>

29 
	~<b™s/wÜdsize.h
>

34 
	~<b™s/¡dšt-šŠ.h
>

37 
	~<b™s/¡dšt-ušŠ.h
>

43 sigÃd 
	tšt_Ëa¡8_t
;

44 
	tšt_Ëa¡16_t
;

45 
	tšt_Ëa¡32_t
;

46 #ià
__WORDSIZE
 == 64

47 
	tšt_Ëa¡64_t
;

49 
__ex‹nsiÚ__


50 
	tšt_Ëa¡64_t
;

54 
	tušt_Ëa¡8_t
;

55 
	tušt_Ëa¡16_t
;

56 
	tušt_Ëa¡32_t
;

57 #ià
__WORDSIZE
 == 64

58 
	tušt_Ëa¡64_t
;

60 
__ex‹nsiÚ__


61 
	tušt_Ëa¡64_t
;

68 sigÃd 
	tšt_ç¡8_t
;

69 #ià
__WORDSIZE
 == 64

70 
	tšt_ç¡16_t
;

71 
	tšt_ç¡32_t
;

72 
	tšt_ç¡64_t
;

74 
	tšt_ç¡16_t
;

75 
	tšt_ç¡32_t
;

76 
__ex‹nsiÚ__


77 
	tšt_ç¡64_t
;

81 
	tušt_ç¡8_t
;

82 #ià
__WORDSIZE
 == 64

83 
	tušt_ç¡16_t
;

84 
	tušt_ç¡32_t
;

85 
	tušt_ç¡64_t
;

87 
	tušt_ç¡16_t
;

88 
	tušt_ç¡32_t
;

89 
__ex‹nsiÚ__


90 
	tušt_ç¡64_t
;

95 #ià
__WORDSIZE
 == 64

96 #iâdeà
__šŒ_t_defšed


97 
	tšŒ_t
;

98 
	#__šŒ_t_defšed


	)

100 
	tušŒ_t
;

102 #iâdeà
__šŒ_t_defšed


103 
	tšŒ_t
;

104 
	#__šŒ_t_defšed


	)

106 
	tušŒ_t
;

111 
__štmax_t
 
	tštmax_t
;

112 
__uštmax_t
 
	tuštmax_t
;

115 #ià
__WORDSIZE
 == 64

116 
	#__INT64_C
(
c
èø## 
L


	)

117 
	#__UINT64_C
(
c
èø## 
UL


	)

119 
	#__INT64_C
(
c
èø## 
LL


	)

120 
	#__UINT64_C
(
c
èø## 
ULL


	)

126 
	#INT8_MIN
 (-128)

	)

127 
	#INT16_MIN
 (-32767-1)

	)

128 
	#INT32_MIN
 (-2147483647-1)

	)

129 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

131 
	#INT8_MAX
 (127)

	)

132 
	#INT16_MAX
 (32767)

	)

133 
	#INT32_MAX
 (2147483647)

	)

134 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

137 
	#UINT8_MAX
 (255)

	)

138 
	#UINT16_MAX
 (65535)

	)

139 
	#UINT32_MAX
 (4294967295U)

	)

140 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

144 
	#INT_LEAST8_MIN
 (-128)

	)

145 
	#INT_LEAST16_MIN
 (-32767-1)

	)

146 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

147 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

149 
	#INT_LEAST8_MAX
 (127)

	)

150 
	#INT_LEAST16_MAX
 (32767)

	)

151 
	#INT_LEAST32_MAX
 (2147483647)

	)

152 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

155 
	#UINT_LEAST8_MAX
 (255)

	)

156 
	#UINT_LEAST16_MAX
 (65535)

	)

157 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

158 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

162 
	#INT_FAST8_MIN
 (-128)

	)

163 #ià
__WORDSIZE
 == 64

164 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

165 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

167 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

168 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

170 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

172 
	#INT_FAST8_MAX
 (127)

	)

173 #ià
__WORDSIZE
 == 64

174 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

175 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

177 
	#INT_FAST16_MAX
 (2147483647)

	)

178 
	#INT_FAST32_MAX
 (2147483647)

	)

180 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

183 
	#UINT_FAST8_MAX
 (255)

	)

184 #ià
__WORDSIZE
 == 64

185 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

186 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

188 
	#UINT_FAST16_MAX
 (4294967295U)

	)

189 
	#UINT_FAST32_MAX
 (4294967295U)

	)

191 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

195 #ià
__WORDSIZE
 == 64

196 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

197 
	#INTPTR_MAX
 (9223372036854775807L)

	)

198 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

200 
	#INTPTR_MIN
 (-2147483647-1)

	)

201 
	#INTPTR_MAX
 (2147483647)

	)

202 
	#UINTPTR_MAX
 (4294967295U)

	)

207 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

209 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

218 #ià
__WORDSIZE
 == 64

219 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

220 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

222 #ià
__WORDSIZE32_PTRDIFF_LONG


223 
	#PTRDIFF_MIN
 (-2147483647L-1)

	)

224 
	#PTRDIFF_MAX
 (2147483647L)

	)

226 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

227 
	#PTRDIFF_MAX
 (2147483647)

	)

232 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

233 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

236 #ià
__WORDSIZE
 == 64

237 
	#SIZE_MAX
 (18446744073709551615UL)

	)

239 #ià
__WORDSIZE32_SIZE_ULONG


240 
	#SIZE_MAX
 (4294967295UL)

	)

242 
	#SIZE_MAX
 (4294967295U)

	)

247 #iâdeà
WCHAR_MIN


249 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

250 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

254 
	#WINT_MIN
 (0u)

	)

255 
	#WINT_MAX
 (4294967295u)

	)

258 
	#INT8_C
(
c
è
	)
c

259 
	#INT16_C
(
c
è
	)
c

260 
	#INT32_C
(
c
è
	)
c

261 #ià
__WORDSIZE
 == 64

262 
	#INT64_C
(
c
èø## 
L


	)

264 
	#INT64_C
(
c
èø## 
LL


	)

268 
	#UINT8_C
(
c
è
	)
c

269 
	#UINT16_C
(
c
è
	)
c

270 
	#UINT32_C
(
c
èø## 
U


	)

271 #ià
__WORDSIZE
 == 64

272 
	#UINT64_C
(
c
èø## 
UL


	)

274 
	#UINT64_C
(
c
èø## 
ULL


	)

278 #ià
__WORDSIZE
 == 64

279 
	#INTMAX_C
(
c
èø## 
L


	)

280 
	#UINTMAX_C
(
c
èø## 
UL


	)

282 
	#INTMAX_C
(
c
èø## 
LL


	)

283 
	#UINTMAX_C
(
c
èø## 
ULL


	)

286 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

288 
	#INT8_WIDTH
 8

	)

289 
	#UINT8_WIDTH
 8

	)

290 
	#INT16_WIDTH
 16

	)

291 
	#UINT16_WIDTH
 16

	)

292 
	#INT32_WIDTH
 32

	)

293 
	#UINT32_WIDTH
 32

	)

294 
	#INT64_WIDTH
 64

	)

295 
	#UINT64_WIDTH
 64

	)

297 
	#INT_LEAST8_WIDTH
 8

	)

298 
	#UINT_LEAST8_WIDTH
 8

	)

299 
	#INT_LEAST16_WIDTH
 16

	)

300 
	#UINT_LEAST16_WIDTH
 16

	)

301 
	#INT_LEAST32_WIDTH
 32

	)

302 
	#UINT_LEAST32_WIDTH
 32

	)

303 
	#INT_LEAST64_WIDTH
 64

	)

304 
	#UINT_LEAST64_WIDTH
 64

	)

306 
	#INT_FAST8_WIDTH
 8

	)

307 
	#UINT_FAST8_WIDTH
 8

	)

308 
	#INT_FAST16_WIDTH
 
__WORDSIZE


	)

309 
	#UINT_FAST16_WIDTH
 
__WORDSIZE


	)

310 
	#INT_FAST32_WIDTH
 
__WORDSIZE


	)

311 
	#UINT_FAST32_WIDTH
 
__WORDSIZE


	)

312 
	#INT_FAST64_WIDTH
 64

	)

313 
	#UINT_FAST64_WIDTH
 64

	)

315 
	#INTPTR_WIDTH
 
__WORDSIZE


	)

316 
	#UINTPTR_WIDTH
 
__WORDSIZE


	)

318 
	#INTMAX_WIDTH
 64

	)

319 
	#UINTMAX_WIDTH
 64

	)

321 
	#PTRDIFF_WIDTH
 
__WORDSIZE


	)

322 
	#SIG_ATOMIC_WIDTH
 32

	)

323 
	#SIZE_WIDTH
 
__WORDSIZE


	)

324 
	#WCHAR_WIDTH
 32

	)

325 
	#WINT_WIDTH
 32

	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	~<b™s/ty³s/__FILE.h
>

37 
	~<b™s/ty³s/FILE.h
>

39 
	#_STDIO_USES_IOSTREAM


	)

41 
	~<b™s/libio.h
>

43 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


44 #ifdeà
__GNUC__


45 #iâdeà
_VA_LIST_DEFINED


46 
_G_va_li¡
 
	tva_li¡
;

47 
	#_VA_LIST_DEFINED


	)

50 
	~<¡d¬g.h
>

54 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


55 #iâdeà
__off_t_defšed


56 #iâdeà
__USE_FILE_OFFSET64


57 
__off_t
 
	toff_t
;

59 
__off64_t
 
	toff_t
;

61 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

69 #ifdeà
__USE_XOPEN2K8


70 #iâdeà
__ssize_t_defšed


71 
__ssize_t
 
	tssize_t
;

72 
	#__ssize_t_defšed


	)

77 #iâdeà
__USE_FILE_OFFSET64


78 
_G_åos_t
 
	tåos_t
;

80 
_G_åos64_t
 
	tåos_t
;

82 #ifdeà
__USE_LARGEFILE64


83 
_G_åos64_t
 
	tåos64_t
;

87 
	#_IOFBF
 0

	)

88 
	#_IOLBF
 1

	)

89 
	#_IONBF
 2

	)

93 #iâdeà
BUFSIZ


94 
	#BUFSIZ
 
_IO_BUFSIZ


	)

100 #iâdeà
EOF


101 
	#EOF
 (-1)

	)

107 
	#SEEK_SET
 0

	)

108 
	#SEEK_CUR
 1

	)

109 
	#SEEK_END
 2

	)

110 #ifdeà
__USE_GNU


111 
	#SEEK_DATA
 3

	)

112 
	#SEEK_HOLE
 4

	)

116 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


118 
	#P_tmpdœ
 "/tmp"

	)

131 
	~<b™s/¡dio_lim.h
>

135 
_IO_FILE
 *
¡dš
;

136 
_IO_FILE
 *
¡dout
;

137 
_IO_FILE
 *
¡d”r
;

139 
	#¡dš
 
¡dš


	)

140 
	#¡dout
 
¡dout


	)

141 
	#¡d”r
 
¡d”r


	)

144 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

146 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

148 #ifdeà
__USE_ATFILE


150 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

151 cÚ¡ *
__Ãw
è
__THROW
;

158 #iâdeà
__USE_FILE_OFFSET64


159 
FILE
 *
	$tmpfe
 (è
__wur
;

161 #ifdeà
__REDIRECT


162 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

164 
	#tmpfe
 
tmpfe64


	)

168 #ifdeà
__USE_LARGEFILE64


169 
FILE
 *
	$tmpfe64
 (è
__wur
;

173 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

175 #ifdeà
__USE_MISC


178 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

182 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


190 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

191 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

199 
	`fşo£
 (
FILE
 *
__¡»am
);

204 
	`fæush
 (
FILE
 *
__¡»am
);

206 #ifdeà
__USE_MISC


213 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

216 #ifdeà
__USE_GNU


223 
	`fşo£®l
 ();

227 #iâdeà
__USE_FILE_OFFSET64


232 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

233 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

238 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

239 cÚ¡ *
__»¡riù
 
__modes
,

240 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

242 #ifdeà
__REDIRECT


243 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

244 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

245 
__wur
;

246 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

247 cÚ¡ *
__»¡riù
 
__modes
,

248 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

249 
__wur
;

251 
	#fİ’
 
fİ’64


	)

252 
	#äeİ’
 
äeİ’64


	)

255 #ifdeà
__USE_LARGEFILE64


256 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

257 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

258 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

259 cÚ¡ *
__»¡riù
 
__modes
,

260 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

263 #ifdef 
__USE_POSIX


265 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

268 #ifdef 
__USE_GNU


271 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

272 cÚ¡ *
__»¡riù
 
__modes
,

273 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

276 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

278 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

279 
__THROW
 
__wur
;

284 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

290 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

294 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

295 
__modes
, 
size_t
 
__n
è
__THROW
;

297 #ifdef 
__USE_MISC


300 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

301 
size_t
 
__size
è
__THROW
;

304 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

312 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

313 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

318 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

320 
	$¥rštf
 (*
__»¡riù
 
__s
,

321 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

327 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

328 
_G_va_li¡
 
__¬g
);

333 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

335 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

336 
_G_va_li¡
 
__¬g
è
__THROWNL
;

338 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


340 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

341 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

342 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

344 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

345 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

346 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

349 #ià
	`__GLIBC_USE
 (
LIB_EXT2
)

352 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

353 
_G_va_li¡
 
__¬g
)

354 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

355 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

356 cÚ¡ *
__»¡riù
 
__fmt
, ...)

357 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

358 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

359 cÚ¡ *
__»¡riù
 
__fmt
, ...)

360 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

363 #ifdeà
__USE_XOPEN2K8


365 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

366 
_G_va_li¡
 
__¬g
)

367 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

368 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

369 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

377 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

378 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

383 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

385 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

386 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

388 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

389 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

390 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

391 #ifdeà
__REDIRECT


395 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

396 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

397 
__isoc99_fsÿnf
è
__wur
;

398 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

399 
__isoc99_sÿnf
è
__wur
;

400 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

401 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

402 
__isoc99_ssÿnf
);

404 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

405 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

406 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

407 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

408 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

409 
	#fsÿnf
 
__isoc99_fsÿnf


	)

410 
	#sÿnf
 
__isoc99_sÿnf


	)

411 
	#ssÿnf
 
__isoc99_ssÿnf


	)

415 #ifdef 
__USE_ISOC99


420 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

421 
_G_va_li¡
 
__¬g
)

422 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

428 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

429 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

432 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

433 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

434 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

436 #ià!
defšed
 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
vfsÿnf
,

444 (
FILE
 *
__»¡riù
 
__s
,

445 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

446 
__isoc99_vfsÿnf
)

447 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

448 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

449 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

450 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

451 
	`__REDIRECT_NTH
 (
vssÿnf
,

452 (cÚ¡ *
__»¡riù
 
__s
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
,

454 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

455 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

457 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

458 cÚ¡ *
__»¡riù
 
__fÜm©
,

459 
_G_va_li¡
 
__¬g
è
__wur
;

460 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

461 
_G_va_li¡
 
__¬g
è
__wur
;

462 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

463 cÚ¡ *
__»¡riù
 
__fÜm©
,

464 
_G_va_li¡
 
__¬g
è
__THROW
;

465 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

466 
	#vsÿnf
 
__isoc99_vsÿnf


	)

467 
	#vssÿnf
 
__isoc99_vssÿnf


	)

477 
	`fg‘c
 (
FILE
 *
__¡»am
);

478 
	`g‘c
 (
FILE
 *
__¡»am
);

484 
	`g‘ch¬
 ();

488 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

490 #ifdeà
__USE_POSIX199506


495 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

496 
	`g‘ch¬_uÆocked
 ();

499 #ifdeà
__USE_MISC


506 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

517 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

518 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

524 
	`putch¬
 (
__c
);

528 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

530 #ifdeà
__USE_MISC


537 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

540 #ifdeà
__USE_POSIX199506


545 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

546 
	`putch¬_uÆocked
 (
__c
);

550 #ià
defšed
 
__USE_MISC
 \

551 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

553 
	`g‘w
 (
FILE
 *
__¡»am
);

556 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

564 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

565 
__wur
;

567 #ià
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

577 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

580 #ifdeà
__USE_GNU


587 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

588 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

592 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

603 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

604 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

605 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

606 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

607 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

608 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

616 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

617 
size_t
 *
__»¡riù
 
__n
,

618 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

626 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

632 
	`puts
 (cÚ¡ *
__s
);

639 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

646 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

647 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

652 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

653 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

655 #ifdeà
__USE_GNU


662 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

663 
FILE
 *
__»¡riù
 
__¡»am
);

666 #ifdeà
__USE_MISC


673 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

674 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

675 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

676 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

684 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

689 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

694 
	`»wšd
 (
FILE
 *
__¡»am
);

701 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


702 #iâdeà
__USE_FILE_OFFSET64


707 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

712 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

714 #ifdeà
__REDIRECT


715 
	`__REDIRECT
 (
f£eko
,

716 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

717 
f£eko64
);

718 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

720 
	#f£eko
 
f£eko64


	)

721 
	#á–lo
 
á–lo64


	)

726 #iâdeà
__USE_FILE_OFFSET64


731 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

736 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

738 #ifdeà
__REDIRECT


739 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

740 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

741 
	`__REDIRECT
 (
f£os
,

742 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

744 
	#fg‘pos
 
fg‘pos64


	)

745 
	#f£os
 
f£os64


	)

749 #ifdeà
__USE_LARGEFILE64


750 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

751 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

752 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

753 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

757 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

759 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

761 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

763 #ifdeà
__USE_MISC


765 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

766 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

767 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

775 
	`³¼Ü
 (cÚ¡ *
__s
);

781 
	~<b™s/sys_”¾i¡.h
>

784 #ifdef 
__USE_POSIX


786 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

789 #ifdeà
__USE_MISC


791 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

795 #ifdeà
__USE_POSIX2


800 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

806 
	`pşo£
 (
FILE
 *
__¡»am
);

810 #ifdef 
__USE_POSIX


812 *
	$ù”mid
 (*
__s
è
__THROW
;

816 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
è|| defšed 
__USE_GNU


818 *
	`cu£rid
 (*
__s
);

822 #ifdef 
__USE_GNU


823 
ob¡ack
;

826 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

827 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

828 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

829 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

830 cÚ¡ *
__»¡riù
 
__fÜm©
,

831 
_G_va_li¡
 
__¬gs
)

832 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

836 #ifdeà
__USE_POSIX199506


840 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

844 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

847 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

850 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


853 
	~<b™s/g‘İt_posix.h
>

858 #ifdeà
__USE_EXTERN_INLINES


859 
	~<b™s/¡dio.h
>

861 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


862 
	~<b™s/¡dio2.h
>

864 #ifdeà
__LDBL_COMPAT


865 
	~<b™s/¡dio-ldbl.h
>

868 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

25 
	~<b™s/libc-h—d”-¡¬t.h
>

28 
	#__Ãed_size_t


	)

29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

31 
	~<¡ddef.h
>

33 
	g__BEGIN_DECLS


35 
	#_STDLIB_H
 1

	)

37 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


39 
	~<b™s/wa™æags.h
>

40 
	~<b™s/wa™¡©us.h
>

43 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (¡©us)

	)

44 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (¡©us)

	)

45 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (¡©us)

	)

46 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (¡©us)

	)

47 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (¡©us)

	)

48 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (¡©us)

	)

49 #ifdeà
__WIFCONTINUED


50 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (¡©us)

	)

55 
	~<b™s/æßŠ.h
>

60 
	mquÙ
;

61 
	m»m
;

62 } 
	tdiv_t
;

65 #iâdeà
__ldiv_t_defšed


68 
	mquÙ
;

69 
	m»m
;

70 } 
	tldiv_t
;

71 
	#__ldiv_t_defšed
 1

	)

74 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


76 
__ex‹nsiÚ__
 struct

78 
	mquÙ
;

79 
	m»m
;

80 } 
	tÎdiv_t
;

81 
	#__Îdiv_t_defšed
 1

	)

86 
	#RAND_MAX
 2147483647

	)

91 
	#EXIT_FAILURE
 1

	)

92 
	#EXIT_SUCCESS
 0

	)

96 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

97 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

101 
	$©of
 (cÚ¡ *
__ÅŒ
)

102 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

104 
	$©oi
 (cÚ¡ *
__ÅŒ
)

105 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

107 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

108 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

110 #ifdeà
__USE_ISOC99


112 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

113 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

117 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

118 **
__»¡riù
 
__’d±r
)

119 
__THROW
 
	`__nÚnuÎ
 ((1));

121 #ifdef 
__USE_ISOC99


123 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

124 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

126 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

127 **
__»¡riù
 
__’d±r
)

128 
__THROW
 
	`__nÚnuÎ
 ((1));

133 #ià
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
_Flßt16
 
	$¡¹of16
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

135 **
__»¡riù
 
__’d±r
)

136 
__THROW
 
	`__nÚnuÎ
 ((1));

139 #ià
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

140 
_Flßt32
 
	$¡¹of32
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

141 **
__»¡riù
 
__’d±r
)

142 
__THROW
 
	`__nÚnuÎ
 ((1));

145 #ià
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

146 
_Flßt64
 
	$¡¹of64
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

147 **
__»¡riù
 
__’d±r
)

148 
__THROW
 
	`__nÚnuÎ
 ((1));

151 #ià
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

152 
_Flßt128
 
	$¡¹of128
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

153 **
__»¡riù
 
__’d±r
)

154 
__THROW
 
	`__nÚnuÎ
 ((1));

157 #ià
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

158 
_Flßt32x
 
	$¡¹of32x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

159 **
__»¡riù
 
__’d±r
)

160 
__THROW
 
	`__nÚnuÎ
 ((1));

163 #ià
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

164 
_Flßt64x
 
	$¡¹of64x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

169 #ià
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

170 
_Flßt128x
 
	$¡¹of128x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

171 **
__»¡riù
 
__’d±r
)

172 
__THROW
 
	`__nÚnuÎ
 ((1));

176 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

177 **
__»¡riù
 
__’d±r
, 
__ba£
)

178 
__THROW
 
	`__nÚnuÎ
 ((1));

180 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

181 **
__»¡riù
 
__’d±r
, 
__ba£
)

182 
__THROW
 
	`__nÚnuÎ
 ((1));

184 #ifdeà
__USE_MISC


186 
__ex‹nsiÚ__


187 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

191 
__ex‹nsiÚ__


192 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

193 **
__»¡riù
 
__’d±r
, 
__ba£
)

194 
__THROW
 
	`__nÚnuÎ
 ((1));

197 #ifdeà
__USE_ISOC99


199 
__ex‹nsiÚ__


200 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

204 
__ex‹nsiÚ__


205 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

206 **
__»¡riù
 
__’d±r
, 
__ba£
)

207 
__THROW
 
	`__nÚnuÎ
 ((1));

211 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

212 
	$¡räomd
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

213 
__f
)

214 
__THROW
 
	`__nÚnuÎ
 ((3));

216 
	$¡räomf
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

217 
__f
)

218 
__THROW
 
	`__nÚnuÎ
 ((3));

220 
	$¡räoml
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

221 
__f
)

222 
__THROW
 
	`__nÚnuÎ
 ((3));

225 #ià
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

226 
	$¡räomf16
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

227 
_Flßt16
 
__f
)

228 
__THROW
 
	`__nÚnuÎ
 ((3));

231 #ià
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

232 
	$¡räomf32
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

233 
_Flßt32
 
__f
)

234 
__THROW
 
	`__nÚnuÎ
 ((3));

237 #ià
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

238 
	$¡räomf64
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

239 
_Flßt64
 
__f
)

240 
__THROW
 
	`__nÚnuÎ
 ((3));

243 #ià
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

244 
	$¡räomf128
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

245 
_Flßt128
 
__f
)

246 
__THROW
 
	`__nÚnuÎ
 ((3));

249 #ià
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

250 
	$¡räomf32x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

251 
_Flßt32x
 
__f
)

252 
__THROW
 
	`__nÚnuÎ
 ((3));

255 #ià
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

256 
	$¡räomf64x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

257 
_Flßt64x
 
__f
)

258 
__THROW
 
	`__nÚnuÎ
 ((3));

261 #ià
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

262 
	$¡räomf128x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

263 
_Flßt128x
 
__f
)

264 
__THROW
 
	`__nÚnuÎ
 ((3));

268 #ifdeà
__USE_GNU


272 
	~<b™s/ty³s/loÿË_t.h
>

274 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

275 **
__»¡riù
 
__’d±r
, 
__ba£
,

276 
loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

278 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

279 **
__»¡riù
 
__’d±r
,

280 
__ba£
, 
loÿË_t
 
__loc
)

281 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

283 
__ex‹nsiÚ__


284 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

285 **
__»¡riù
 
__’d±r
, 
__ba£
,

286 
loÿË_t
 
__loc
)

287 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

289 
__ex‹nsiÚ__


290 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

291 **
__»¡riù
 
__’d±r
,

292 
__ba£
, 
loÿË_t
 
__loc
)

293 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

295 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

296 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

297 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

299 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

300 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

301 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

303 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

304 **
__»¡riù
 
__’d±r
,

305 
loÿË_t
 
__loc
)

306 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

308 #ià
__HAVE_FLOAT16


309 
_Flßt16
 
	$¡¹of16_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

310 **
__»¡riù
 
__’d±r
,

311 
loÿË_t
 
__loc
)

312 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

315 #ià
__HAVE_FLOAT32


316 
_Flßt32
 
	$¡¹of32_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

317 **
__»¡riù
 
__’d±r
,

318 
loÿË_t
 
__loc
)

319 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

322 #ià
__HAVE_FLOAT64


323 
_Flßt64
 
	$¡¹of64_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

324 **
__»¡riù
 
__’d±r
,

325 
loÿË_t
 
__loc
)

326 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

329 #ià
__HAVE_FLOAT128


330 
_Flßt128
 
	$¡¹of128_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 **
__»¡riù
 
__’d±r
,

332 
loÿË_t
 
__loc
)

333 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

336 #ià
__HAVE_FLOAT32X


337 
_Flßt32x
 
	$¡¹of32x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

338 **
__»¡riù
 
__’d±r
,

339 
loÿË_t
 
__loc
)

340 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

343 #ià
__HAVE_FLOAT64X


344 
_Flßt64x
 
	$¡¹of64x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

345 **
__»¡riù
 
__’d±r
,

346 
loÿË_t
 
__loc
)

347 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

350 #ià
__HAVE_FLOAT128X


351 
_Flßt128x
 
	$¡¹of128x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

352 **
__»¡riù
 
__’d±r
,

353 
loÿË_t
 
__loc
)

354 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

359 #ifdeà
__USE_EXTERN_INLINES


360 
__ex‹º_šlše
 

361 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

363  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

364 
	}
}

365 
__ex‹º_šlše
 

366 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

368  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

369 
	}
}

371 #ifdeà
__USE_ISOC99


372 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

373 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

375  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

376 
	}
}

381 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


385 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

388 
	$a64l
 (cÚ¡ *
__s
)

389 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

393 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


394 
	~<sys/ty³s.h
>

401 
	$¿ndom
 (è
__THROW
;

404 
	$¤ªdom
 (
__£ed
è
__THROW
;

410 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

411 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

415 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

418 #ifdeà
__USE_MISC


423 
	s¿ndom_d©a


425 
št32_t
 *
åŒ
;

426 
št32_t
 *
½Œ
;

427 
št32_t
 *
¡©e
;

428 
¿nd_ty³
;

429 
¿nd_deg
;

430 
¿nd_£p
;

431 
št32_t
 *
’d_±r
;

434 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

435 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

437 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

438 
__THROW
 
	`__nÚnuÎ
 ((2));

440 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

441 
size_t
 
__¡©–’
,

442 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

443 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

445 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

446 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

447 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

453 
	$¿nd
 (è
__THROW
;

455 
	$¤ªd
 (
__£ed
è
__THROW
;

457 #ifdeà
__USE_POSIX199506


459 
	$¿nd_r
 (*
__£ed
è
__THROW
;

463 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


467 
	$d¿nd48
 (è
__THROW
;

468 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

471 
	$Ìªd48
 (è
__THROW
;

472 
	$Äªd48
 (
__xsubi
[3])

473 
__THROW
 
	`__nÚnuÎ
 ((1));

476 
	$m¿nd48
 (è
__THROW
;

477 
	$j¿nd48
 (
__xsubi
[3])

478 
__THROW
 
	`__nÚnuÎ
 ((1));

481 
	$¤ªd48
 (
__£edv®
è
__THROW
;

482 *
	$£ed48
 (
__£ed16v
[3])

483 
__THROW
 
	`__nÚnuÎ
 ((1));

484 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

486 #ifdeà
__USE_MISC


490 
	sd¿nd48_d©a


492 
__x
[3];

493 
__Şd_x
[3];

494 
__c
;

495 
__š™
;

496 
__ex‹nsiÚ__
 
__a
;

501 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

502 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

503 
	$”ªd48_r
 (
__xsubi
[3],

504 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

505 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

508 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

509 *
__»¡riù
 
__»suÉ
)

510 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

511 
	$Äªd48_r
 (
__xsubi
[3],

512 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

513 *
__»¡riù
 
__»suÉ
)

514 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

517 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

518 *
__»¡riù
 
__»suÉ
)

519 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

520 
	$j¿nd48_r
 (
__xsubi
[3],

521 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

522 *
__»¡riù
 
__»suÉ
)

523 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

526 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

527 
__THROW
 
	`__nÚnuÎ
 ((2));

529 
	$£ed48_r
 (
__£ed16v
[3],

530 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

532 
	$lcÚg48_r
 (
__·¿m
[7],

533 
d¿nd48_d©a
 *
__bufãr
)

534 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

539 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

541 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

542 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

549 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

550 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

552 #ifdeà
__USE_GNU


558 *
	$»®loÿ¼ay
 (*
__±r
, 
size_t
 
__nmemb
, size_ˆ
__size
)

559 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

563 
	$ä“
 (*
__±r
è
__THROW
;

565 #ifdeà
__USE_MISC


566 
	~<®loÿ.h
>

569 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

570 || 
defšed
 
__USE_MISC


572 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

575 #ifdeà
__USE_XOPEN2K


577 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

578 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

581 #ifdeà
__USE_ISOC11


583 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

584 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

588 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

592 
	$©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

594 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


596 #ifdeà
__ılu¥lus


597 "C++" 
	$©_quick_ex™
 ((*
__func
) ())

598 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

600 
	$©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

604 #ifdef 
__USE_MISC


607 
	$Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

608 
__THROW
 
	`__nÚnuÎ
 ((1));

614 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

616 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


620 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

623 #ifdeà
__USE_ISOC99


626 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

631 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

633 #ifdeà
__USE_GNU


636 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

637 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

640 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


644 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

647 #ifdeà
__USE_XOPEN2K


650 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

651 
__THROW
 
	`__nÚnuÎ
 ((2));

654 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

657 #ifdef 
__USE_MISC


661 
	$ş—»nv
 (è
__THROW
;

665 #ià
defšed
 
__USE_MISC
 \

666 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

672 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

675 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


684 #iâdeà
__USE_FILE_OFFSET64


685 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

687 #ifdeà
__REDIRECT


688 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

689 
	`__nÚnuÎ
 ((1)è
__wur
;

691 
	#mk¡emp
 
mk¡emp64


	)

694 #ifdeà
__USE_LARGEFILE64


695 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

699 #ifdeà
__USE_MISC


706 #iâdeà
__USE_FILE_OFFSET64


707 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

711 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

713 
	#mk¡emps
 
mk¡emps64


	)

716 #ifdeà
__USE_LARGEFILE64


717 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

718 
	`__nÚnuÎ
 ((1)è
__wur
;

722 #ifdeà
__USE_XOPEN2K8


728 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

731 #ifdeà
__USE_GNU


738 #iâdeà
__USE_FILE_OFFSET64


739 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

741 #ifdeà
__REDIRECT


742 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

743 
	`__nÚnuÎ
 ((1)è
__wur
;

745 
	#mko¡emp
 
mko¡emp64


	)

748 #ifdeà
__USE_LARGEFILE64


749 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

758 #iâdeà
__USE_FILE_OFFSET64


759 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

760 
	`__nÚnuÎ
 ((1)è
__wur
;

762 #ifdeà
__REDIRECT


763 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

764 
__æags
), 
mko¡emps64
)

765 
	`__nÚnuÎ
 ((1)è
__wur
;

767 
	#mko¡emps
 
mko¡emps64


	)

770 #ifdeà
__USE_LARGEFILE64


771 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

772 
	`__nÚnuÎ
 ((1)è
__wur
;

781 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

784 #ifdef 
__USE_GNU


787 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

788 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

791 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


797 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

798 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

803 #iâdeà
__COMPAR_FN_T


804 
	#__COMPAR_FN_T


	)

805 (*
	t__com·r_â_t
) (const *, const *);

807 #ifdef 
__USE_GNU


808 
__com·r_â_t
 
	tcom·risÚ_â_t
;

811 #ifdeà
__USE_GNU


812 (*
	t__com·r_d_â_t
) (const *, const *, *);

817 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

818 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

819 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

821 #ifdeà
__USE_EXTERN_INLINES


822 
	~<b™s/¡dlib-b£¬ch.h
>

827 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

828 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

829 #ifdeà
__USE_GNU


830 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

831 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

832 
	`__nÚnuÎ
 ((1, 4));

837 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

838 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

840 #ifdeà
__USE_ISOC99


841 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

842 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

849 
div_t
 
	$div
 (
__num”
, 
__d’om
)

850 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

851 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

852 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

854 #ifdeà
__USE_ISOC99


855 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

856 
__d’om
)

857 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

861 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

862 || 
defšed
 
__USE_MISC


869 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

870 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

875 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

876 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

881 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

882 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

885 #ifdeà
__USE_MISC


887 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

888 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

889 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

890 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

891 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

892 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

893 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

894 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

899 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

900 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

901 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

902 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

903 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

904 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

906 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

907 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

908 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

909 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

910 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

911 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

912 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

913 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

919 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

922 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

923 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

926 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

930 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

931 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

933 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

934 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

935 
__THROW
;

938 #ifdeà
__USE_MISC


943 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

947 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


954 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

955 *cÚ¡ *
__»¡riù
 
__tok’s
,

956 **
__»¡riù
 
__v®u•
)

957 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

961 #ifdeà
__USE_XOPEN


963 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

969 #ifdeà
__USE_XOPEN2KXSI


971 
	$posix_İ’±
 (
__oæag
è
__wur
;

974 #ifdeà
__USE_XOPEN_EXTENDED


979 
	$g¿Á±
 (
__fd
è
__THROW
;

983 
	$uÆock±
 (
__fd
è
__THROW
;

988 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

991 #ifdeà
__USE_GNU


995 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

996 
__THROW
 
	`__nÚnuÎ
 ((2));

999 
	`g‘±
 ();

1002 #ifdeà
__USE_MISC


1006 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

1007 
__THROW
 
	`__nÚnuÎ
 ((1));

1010 #ià
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K


1013 
	$‰y¦Ù
 (è
__THROW
;

1016 
	~<b™s/¡dlib-æßt.h
>

1019 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1020 
	~<b™s/¡dlib.h
>

1022 #ifdeà
__LDBL_COMPAT


1023 
	~<b™s/¡dlib-ldbl.h
>

1026 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

28 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

36 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

37 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

43 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

46 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

47 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


53 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

54 
__c
, 
size_t
 
__n
)

55 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

60 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

63 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

64 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

67 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


70 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

71 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

72 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

75 #ifdeà
__OPTIMIZE__


76 
__ex‹º_®ways_šlše
 *

77 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


79  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

82 
__ex‹º_®ways_šlše
 const *

83 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
	}
}

90 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

91 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

94 #ifdeà
__USE_GNU


97 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


98 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

99 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

100 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

101 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

103 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

104 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

108 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


109 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

110 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

111 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

112 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

114 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

122 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

124 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

125 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

129 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

133 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

136 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

137 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

139 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

140 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

143 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

144 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

146 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

147 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

148 
__THROW
 
	`__nÚnuÎ
 ((2));

150 #ifdeà
__USE_XOPEN2K8


152 
	~<b™s/ty³s/loÿË_t.h
>

155 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__l
)

156 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

159 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

160 
loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

163 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8
 \

164 || 
	$__GLIBC_USE
 (
LIB_EXT2
))

166 *
	$¡rdup
 (cÚ¡ *
__s
)

167 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

173 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

174 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

175 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

178 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


180 
	#¡rdu·
(
s
) \

181 (
__ex‹nsiÚ__
 \

183 cÚ¡ *
__Şd
 = (
s
); \

184 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

185 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

186 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

187 
	}
}))

	)

190 
	#¡ºdu·
(
s
, 
n
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

196 
__Ãw
[
__Ën
] = '\0'; \

197 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

198 }))

	)

202 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


205 *
¡rchr
 (*
__s
, 
__c
)

206 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

207 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

208 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

210 #ifdeà
__OPTIMIZE__


211 
__ex‹º_®ways_šlše
 *

212 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


214  
__butš_¡rchr
 (
__s
, 
__c
);

217 
__ex‹º_®ways_šlše
 const *

218 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


220  
__butš_¡rchr
 (
__s
, 
__c
);

225 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

226 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

229 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


232 *
	`¡¼chr
 (*
__s
, 
__c
)

233 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

234 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

235 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

237 #ifdeà
__OPTIMIZE__


238 
__ex‹º_®ways_šlše
 *

239 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


241  
	`__butš_¡¼chr
 (
__s
, 
__c
);

244 
__ex‹º_®ways_šlše
 const *

245 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


247  
	`__butš_¡¼chr
 (
__s
, 
__c
);

250 
	}
}

252 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

253 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

256 #ifdeà
__USE_GNU


259 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


260 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

261 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

262 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

263 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

265 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

266 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

272 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

273 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

276 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

277 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

279 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


282 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

283 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

284 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

285 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

287 #ifdeà
__OPTIMIZE__


288 
__ex‹º_®ways_šlše
 *

289 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


291  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

294 
__ex‹º_®ways_šlše
 const *

295 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


297  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

300 
	}
}

302 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

303 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

306 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


309 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

310 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

311 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

312 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

314 #ifdeà
__OPTIMIZE__


315 
__ex‹º_®ways_šlše
 *

316 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


318  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

321 
__ex‹º_®ways_šlše
 const *

322 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


324  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

327 
	}
}

329 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

330 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

335 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

336 
__THROW
 
	`__nÚnuÎ
 ((2));

340 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

341 cÚ¡ *
__»¡riù
 
__d–im
,

342 **
__»¡riù
 
__§ve_±r
)

343 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

344 #ifdeà
__USE_POSIX


345 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

346 **
__»¡riù
 
__§ve_±r
)

347 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

350 #ifdeà
__USE_GNU


352 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


353 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

354 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

355 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

356 cÚ¡ *
__ÃedË
)

357 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

359 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

360 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

364 #ifdeà
__USE_GNU


368 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

369 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

370 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

374 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

375 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

376 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

377 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

378 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

379 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

384 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

385 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

387 #ifdef 
__USE_XOPEN2K8


390 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

391 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

396 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

397 #ifdeà
__USE_XOPEN2K


405 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


408 #ifdeà
__REDIRECT_NTH


409 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

410 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

411 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

413 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

414 
__THROW
 
	`__nÚnuÎ
 ((2));

415 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

420 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

421 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

425 #ifdeà
__USE_XOPEN2K8


427 *
	$¡»¼Ü_l
 (
__”ºum
, 
loÿË_t
 
__l
è
__THROW
;

430 #ifdeà
__USE_MISC


431 
	~<¡ršgs.h
>

435 
	$ex¶ic™_bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

439 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

440 cÚ¡ *
__»¡riù
 
__d–im
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

444 #ifdef 
__USE_XOPEN2K8


446 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

449 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

450 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

451 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

452 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

456 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

457 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

458 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

460 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

461 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

464 #ifdef 
__USE_GNU


466 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

467 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

470 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

473 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

475 #iâdeà
ba£Çme


480 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


481 "C++" *
	$ba£Çme
 (*
__f’ame
)

482 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

483 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

484 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

486 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

491 #ià
	`__GNUC_PREREQ
 (3,4)

492 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


494 
	~<b™s/¡ršg_fÜtif›d.h
>

498 
__END_DECLS


	@/usr/include/strings.h

18 #iâdef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

26 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

27 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

30 
	g__BEGIN_DECLS


32 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


34 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

38 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

39 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

42 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

45 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


48 *
	`šdex
 (*
__s
, 
__c
)

49 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

50 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

51 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

53 #ià
defšed
 
__OPTIMIZE__


54 
__ex‹º_®ways_šlše
 *

55 
	`šdex
 (*
__s
, 
__c
è
__THROW


57  
	`__butš_šdex
 (
__s
, 
__c
);

60 
__ex‹º_®ways_šlše
 const *

61 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


63  
	`__butš_šdex
 (
__s
, 
__c
);

66 
	}
}

68 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

69 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

73 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


76 *
	`ršdex
 (*
__s
, 
__c
)

77 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

79 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ià
defšed
 
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`ršdex
 (*
__s
, 
__c
è
__THROW


85  
	`__butš_ršdex
 (
__s
, 
__c
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


91  
	`__butš_ršdex
 (
__s
, 
__c
);

94 
	}
}

96 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

101 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8
 || defšed 
__USE_XOPEN2K8XSI


104 
	$ffs
 (
__i
è
__THROW
 
__©Œibu‹_cÚ¡__
;

109 #ifdef 
__USE_MISC


110 
	$ff¦
 (
__l
è
__THROW
 
__©Œibu‹_cÚ¡__
;

111 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

112 
__THROW
 
__©Œibu‹_cÚ¡__
;

116 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

117 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

120 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

123 #ifdef 
__USE_XOPEN2K8


125 
	~<b™s/ty³s/loÿË_t.h
>

128 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__loc
)

129 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

133 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

134 
size_t
 
__n
, 
loÿË_t
 
__loc
)

135 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

138 
__END_DECLS


140 #ià
	`__GNUC_PREREQ
 (3,4è&& 
__USE_FORTIFY_LEVEL
 > 0 \

141 && 
defšed
 
__fÜtify_funùiÚ


143 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


144 
	~<b™s/¡ršgs_fÜtif›d.h
>

	@/usr/include/stropts.h

18 #iâdeà
_STROPTS_H


19 
	#_STROPTS_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<b™s/ty³s.h
>

23 
	~<b™s/xt™y³s.h
>

25 #iâdeà
__gid_t_defšed


26 
__gid_t
 
	tgid_t
;

27 
	#__gid_t_defšed


	)

30 #iâdeà
__uid_t_defšed


31 
__uid_t
 
	tuid_t
;

32 
	#__uid_t_defšed


	)

35 
__t_sÿÏr_t
 
	tt_sÿÏr_t
;

36 
__t_usÿÏr_t
 
	tt_usÿÏr_t
;

39 
	~<b™s/¡rİts.h
>

42 
__BEGIN_DECLS


45 
	$i§¡»am
 (
__fdes
è
__THROW
;

51 
	`g‘msg
 (
__fdes
, 
¡rbuf
 *
__»¡riù
 
__ùÍŒ
,

52 
¡rbuf
 *
__»¡riù
 
__d©­Œ
,

53 *
__»¡riù
 
__æag¥
);

60 
	`g‘pmsg
 (
__fdes
, 
¡rbuf
 *
__»¡riù
 
__ùÍŒ
,

61 
¡rbuf
 *
__»¡riù
 
__d©­Œ
,

62 *
__»¡riù
 
__bªdp
, *__»¡riù 
__æag¥
);

67 
	$ioùl
 (
__fd
, 
__»que¡
, ...è
__THROW
;

73 
	`putmsg
 (
__fdes
, cÚ¡ 
¡rbuf
 *
__ùÍŒ
,

74 cÚ¡ 
¡rbuf
 *
__d©­Œ
, 
__æags
);

80 
	`pumsg
 (
__fdes
, cÚ¡ 
¡rbuf
 *
__ùÍŒ
,

81 cÚ¡ 
¡rbuf
 *
__d©­Œ
, 
__bªd
, 
__æags
);

85 
	$ç‰ach
 (
__fdes
, cÚ¡ *
__·th
è
__THROW
;

88 
	$fd‘ach
 (cÚ¡ *
__·th
è
__THROW
;

90 
__END_DECLS


	@/usr/include/sys/epoll.h

18 #iâdef 
_SYS_EPOLL_H


19 
	#_SYS_EPOLL_H
 1

	)

21 
	~<¡dšt.h
>

22 
	~<sys/ty³s.h
>

24 
	~<b™s/ty³s/sig£t_t.h
>

27 
	~<b™s/•Şl.h
>

29 #iâdeà
__EPOLL_PACKED


30 
	#__EPOLL_PACKED


	)

34 
	eEPOLL_EVENTS


36 
	mEPOLLIN
 = 0x001,

37 
	#EPOLLIN
 
EPOLLIN


	)

38 
	mEPOLLPRI
 = 0x002,

39 
	#EPOLLPRI
 
EPOLLPRI


	)

40 
	mEPOLLOUT
 = 0x004,

41 
	#EPOLLOUT
 
EPOLLOUT


	)

42 
	mEPOLLRDNORM
 = 0x040,

43 
	#EPOLLRDNORM
 
EPOLLRDNORM


	)

44 
	mEPOLLRDBAND
 = 0x080,

45 
	#EPOLLRDBAND
 
EPOLLRDBAND


	)

46 
	mEPOLLWRNORM
 = 0x100,

47 
	#EPOLLWRNORM
 
EPOLLWRNORM


	)

48 
	mEPOLLWRBAND
 = 0x200,

49 
	#EPOLLWRBAND
 
EPOLLWRBAND


	)

50 
	mEPOLLMSG
 = 0x400,

51 
	#EPOLLMSG
 
EPOLLMSG


	)

52 
	mEPOLLERR
 = 0x008,

53 
	#EPOLLERR
 
EPOLLERR


	)

54 
	mEPOLLHUP
 = 0x010,

55 
	#EPOLLHUP
 
EPOLLHUP


	)

56 
	mEPOLLRDHUP
 = 0x2000,

57 
	#EPOLLRDHUP
 
EPOLLRDHUP


	)

58 
	mEPOLLEXCLUSIVE
 = 1u << 28,

59 
	#EPOLLEXCLUSIVE
 
EPOLLEXCLUSIVE


	)

60 
	mEPOLLWAKEUP
 = 1u << 29,

61 
	#EPOLLWAKEUP
 
EPOLLWAKEUP


	)

62 
	mEPOLLONESHOT
 = 1u << 30,

63 
	#EPOLLONESHOT
 
EPOLLONESHOT


	)

64 
	mEPOLLET
 = 1u << 31

65 
	#EPOLLET
 
EPOLLET


	)

70 
	#EPOLL_CTL_ADD
 1

	)

71 
	#EPOLL_CTL_DEL
 2

	)

72 
	#EPOLL_CTL_MOD
 3

	)

75 
	u•Şl_d©a


77 *
	m±r
;

78 
	mfd
;

79 
ušt32_t
 
	mu32
;

80 
ušt64_t
 
	mu64
;

81 } 
	t•Şl_d©a_t
;

83 
	s•Şl_ev’t


85 
ušt32_t
 
	mev’ts
;

86 
•Şl_d©a_t
 
	md©a
;

87 } 
	g__EPOLL_PACKED
;

90 
__BEGIN_DECLS


96 
	$•Şl_ü—‹
 (
__size
è
__THROW
;

100 
	$•Şl_ü—‹1
 (
__æags
è
__THROW
;

109 
	$•Şl_ùl
 (
__•fd
, 
__İ
, 
__fd
,

110 
•Şl_ev’t
 *
__ev’t
è
__THROW
;

123 
	`•Şl_wa™
 (
__•fd
, 
•Şl_ev’t
 *
__ev’ts
,

124 
__maxev’ts
, 
__timeout
);

132 
	`•Şl_pwa™
 (
__•fd
, 
•Şl_ev’t
 *
__ev’ts
,

133 
__maxev’ts
, 
__timeout
,

134 cÚ¡ 
__sig£t_t
 *
__ss
);

136 
__END_DECLS


	@/usr/include/sys/file.h

18 #iâdef 
_SYS_FILE_H


19 
	#_SYS_FILE_H
 1

	)

21 
	~<ã©u»s.h
>

23 #iâdef 
_FCNTL_H


24 
	~<fú.h
>

27 
	g__BEGIN_DECLS


32 #iâdeà
L_SET


33 
	#L_SET
 0

	)

34 
	#L_INCR
 1

	)

35 
	#L_XTND
 2

	)

40 
	#LOCK_SH
 1

	)

41 
	#LOCK_EX
 2

	)

42 
	#LOCK_UN
 8

	)

43 
	#__LOCK_ATOMIC
 16

	)

46 
	#LOCK_NB
 4

	)

51 
	$æock
 (
__fd
, 
__İ”©iÚ
è
__THROW
;

54 
__END_DECLS


	@/usr/include/sys/ioctl.h

18 #iâdef 
_SYS_IOCTL_H


19 
	#_SYS_IOCTL_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	g__BEGIN_DECLS


26 
	~<b™s/ioùls.h
>

29 
	~<b™s/ioùl-ty³s.h
>

36 
	~<sys/‰ydeçuÉs.h
>

41 
	$ioùl
 (
__fd
, 
__»que¡
, ...è
__THROW
;

43 
__END_DECLS


	@/usr/include/sys/mman.h

19 #iâdef 
_SYS_MMAN_H


20 
	#_SYS_MMAN_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<b™s/ty³s.h
>

24 
	#__Ãed_size_t


	)

25 
	~<¡ddef.h
>

27 #iâdeà
__off_t_defšed


28 #iâdeà
__USE_FILE_OFFSET64


29 
__off_t
 
	toff_t
;

31 
__off64_t
 
	toff_t
;

33 
	#__off_t_defšed


	)

36 #iâdeà
__mode_t_defšed


37 
__mode_t
 
	tmode_t
;

38 
	#__mode_t_defšed


	)

41 
	~<b™s/mmª.h
>

44 
	#MAP_FAILED
 ((*è-1)

	)

46 
	g__BEGIN_DECLS


56 #iâdeà
__USE_FILE_OFFSET64


57 *
	$mm­
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

58 
__æags
, 
__fd
, 
__off_t
 
__off£t
è
__THROW
;

60 #ifdeà
__REDIRECT_NTH


61 * 
	`__REDIRECT_NTH
 (
mm­
,

62 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

63 
__æags
, 
__fd
, 
__off64_t
 
__off£t
),

64 
mm­64
);

66 
	#mm­
 
mm­64


	)

69 #ifdeà
__USE_LARGEFILE64


70 *
	$mm­64
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

71 
__æags
, 
__fd
, 
__off64_t
 
__off£t
è
__THROW
;

76 
	$munm­
 (*
__addr
, 
size_t
 
__Ën
è
__THROW
;

81 
	$m´Ùeù
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
è
__THROW
;

89 
	`msync
 (*
__addr
, 
size_t
 
__Ën
, 
__æags
);

91 #ifdeà
__USE_MISC


94 
	$madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

96 #ifdeà
__USE_XOPEN2K


98 
	$posix_madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

103 
	$mlock
 (cÚ¡ *
__addr
, 
size_t
 
__Ën
è
__THROW
;

106 
	$muÆock
 (cÚ¡ *
__addr
, 
size_t
 
__Ën
è
__THROW
;

111 
	$mlock®l
 (
__æags
è
__THROW
;

115 
	$muÆock®l
 (è
__THROW
;

117 #ifdeà
__USE_MISC


123 
	$mšcÜe
 (*
__¡¬t
, 
size_t
 
__Ën
, *
__vec
)

124 
__THROW
;

127 #ifdeà
__USE_GNU


133 *
	$m»m­
 (*
__addr
, 
size_t
 
__Şd_Ën
, size_ˆ
__Ãw_Ën
,

134 
__æags
, ...è
__THROW
;

138 
	$»m­_fe_·ges
 (*
__¡¬t
, 
size_t
 
__size
, 
__´Ù
,

139 
size_t
 
__pgoff
, 
__æags
è
__THROW
;

144 
	`shm_İ’
 (cÚ¡ *
__Çme
, 
__oæag
, 
mode_t
 
__mode
);

147 
	`shm_uÆšk
 (cÚ¡ *
__Çme
);

149 
__END_DECLS


	@/usr/include/sys/param.h

19 #iâdeà
_SYS_PARAM_H


20 
	#_SYS_PARAM_H
 1

	)

22 
	#__Ãed_NULL


	)

23 
	~<¡ddef.h
>

25 
	~<sys/ty³s.h
>

26 
	~<lim™s.h
>

27 
	~<’dŸn.h
>

28 
	~<sigÇl.h
>

31 
	~<b™s/·¿m.h
>

36 
	#NBBY
 
CHAR_BIT


	)

38 #ià!
defšed
 
NGROUPS
 && defšed 
NGROUPS_MAX


39 
	#NGROUPS
 
NGROUPS_MAX


	)

41 #ià!
defšed
 
MAXSYMLINKS
 && defšed 
SYMLOOP_MAX


42 
	#MAXSYMLINKS
 
SYMLOOP_MAX


	)

44 #ià!
defšed
 
CANBSIZ
 && defšed 
MAX_CANON


45 
	#CANBSIZ
 
MAX_CANON


	)

47 #ià!
defšed
 
MAXPATHLEN
 && defšed 
PATH_MAX


48 
	#MAXPATHLEN
 
PATH_MAX


	)

50 #ià!
defšed
 
NOFILE
 && defšed 
OPEN_MAX


51 
	#NOFILE
 
OPEN_MAX


	)

53 #ià!
defšed
 
MAXHOSTNAMELEN
 && defšed 
HOST_NAME_MAX


54 
	#MAXHOSTNAMELEN
 
HOST_NAME_MAX


	)

56 #iâdeà
NCARGS


57 #ifdeà
ARG_MAX


58 
	#NCARGS
 
ARG_MAX


	)

62 
	#NCARGS
 
INT_MAX


	)

68 #iâdeà
NOGROUP


69 
	#NOGROUP
 65535

	)

71 #iâdeà
NODEV


72 
	#NODEV
 ((
dev_t
è-1è

	)

77 #iâdeà
DEV_BSIZE


78 
	#DEV_BSIZE
 512

	)

83 
	#£tb™
(
a
,
i
è(×)[(i)/
NBBY
] |ğ1<<((i)%NBBY))

	)

84 
	#şrb™
(
a
,
i
è(×)[(i)/
NBBY
] &ğ~(1<<((i)%NBBY)))

	)

85 
	#is£t
(
a
,
i
è(×)[(i)/
NBBY
] & (1<<((i)%NBBY)))

	)

86 
	#isşr
(
a
,
i
è((×)[(i)/
NBBY
] & (1<<((i)%NBBY))è=ğ0)

	)

89 #iâdeà
howmªy


90 
	#howmªy
(
x
, 
y
è(((xè+ ((yè- 1)è/ (y))

	)

92 #ifdeà
__GNUC__


93 
	#roundup
(
x
, 
y
è(
	`__butš_cÚ¡ªt_p
 (yè&& 
	`pow”of2
 (y) \

94 ? (((
x
è+ (
y
) - 1) & ~((y) - 1)) \

95 : ((((
x
è+ ((
y
è- 1)è/ (y)è* (y)))

	)

97 
	#roundup
(
x
, 
y
è((((xè+ ((yè- 1)è/ (y)è* (y))

	)

99 
	#pow”of2
(
x
è((((xè- 1è& (x)è=ğ0)

	)

102 
	#MIN
(
a
,
b
è((×)<(b))?×):(b))

	)

103 
	#MAX
(
a
,
b
è((×)>(b))?×):(b))

	)

	@/usr/include/sys/queue.h

32 #iâdef 
_SYS_QUEUE_H_


33 
	#_SYS_QUEUE_H_


	)

84 
	#LIST_HEAD
(
Çme
, 
ty³
) \

85 
	sÇme
 { \

86 
ty³
 *
lh_fœ¡
; \

87 }

	)

89 
	#LIST_HEAD_INITIALIZER
(
h—d
) \

90 { 
NULL
 }

	)

92 
	#LIST_ENTRY
(
ty³
) \

94 
ty³
 *
Ë_Ãxt
; \

95 
ty³
 **
Ë_´ev
; \

96 }

	)

101 
	#LIST_INIT
(
h—d
) do { \

102 (
h—d
)->
lh_fœ¡
 = 
NULL
; \

103 }  0)

	)

105 
	#LIST_INSERT_AFTER
(
li¡–m
, 
–m
, 
f›ld
) do { \

106 ià(((
–m
)->
f›ld
.
Ë_Ãxt
 = (
li¡–m
)->f›ld.Ë_Ãxtè!ğ
NULL
) \

107 (
li¡–m
)->
f›ld
.
Ë_Ãxt
->f›ld.
Ë_´ev
 = \

108 &(
–m
)->
f›ld
.
Ë_Ãxt
; \

109 (
li¡–m
)->
f›ld
.
Ë_Ãxt
 = (
–m
); \

110 (
–m
)->
f›ld
.
Ë_´ev
 = &(
li¡–m
)->f›ld.
Ë_Ãxt
; \

111 }  0)

	)

113 
	#LIST_INSERT_BEFORE
(
li¡–m
, 
–m
, 
f›ld
) do { \

114 (
–m
)->
f›ld
.
Ë_´ev
 = (
li¡–m
)->field.le_prev; \

115 (
–m
)->
f›ld
.
Ë_Ãxt
 = (
li¡–m
); \

116 *(
li¡–m
)->
f›ld
.
Ë_´ev
 = (
–m
); \

117 (
li¡–m
)->
f›ld
.
Ë_´ev
 = &(
–m
)->f›ld.
Ë_Ãxt
; \

118 }  0)

	)

120 
	#LIST_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

121 ià(((
–m
)->
f›ld
.
Ë_Ãxt
 = (
h—d
)->
lh_fœ¡
è!ğ
NULL
) \

122 (
h—d
)->
lh_fœ¡
->
f›ld
.
Ë_´ev
 = &(
–m
)->f›ld.
Ë_Ãxt
;\

123 (
h—d
)->
lh_fœ¡
 = (
–m
); \

124 (
–m
)->
f›ld
.
Ë_´ev
 = &(
h—d
)->
lh_fœ¡
; \

125 }  0)

	)

127 
	#LIST_REMOVE
(
–m
, 
f›ld
) do { \

128 ià((
–m
)->
f›ld
.
Ë_Ãxt
 !ğ
NULL
) \

129 (
–m
)->
f›ld
.
Ë_Ãxt
->f›ld.
Ë_´ev
 = \

130 (
–m
)->
f›ld
.
Ë_´ev
; \

131 *(
–m
)->
f›ld
.
Ë_´ev
 = (–m)->f›ld.
Ë_Ãxt
; \

132 }  0)

	)

134 
	#LIST_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

135 (
v¬
èğ((
h—d
)->
lh_fœ¡
); \

136 (
v¬
); \

137 (
v¬
èğ((v¬)->
f›ld
.
Ë_Ãxt
))

	)

142 
	#LIST_EMPTY
(
h—d
è((h—d)->
lh_fœ¡
 =ğ
NULL
)

	)

143 
	#LIST_FIRST
(
h—d
è((h—d)->
lh_fœ¡
)

	)

144 
	#LIST_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
Ë_Ãxt
)

	)

150 
	#SLIST_HEAD
(
Çme
, 
ty³
) \

151 
	sÇme
 { \

152 
ty³
 *
¦h_fœ¡
; \

153 }

	)

155 
	#SLIST_HEAD_INITIALIZER
(
h—d
) \

156 { 
NULL
 }

	)

158 
	#SLIST_ENTRY
(
ty³
) \

160 
ty³
 *
¦e_Ãxt
; \

161 }

	)

166 
	#SLIST_INIT
(
h—d
) do { \

167 (
h—d
)->
¦h_fœ¡
 = 
NULL
; \

168 }  0)

	)

170 
	#SLIST_INSERT_AFTER
(
¦i¡–m
, 
–m
, 
f›ld
) do { \

171 (
–m
)->
f›ld
.
¦e_Ãxt
 = (
¦i¡–m
)->field.sle_next; \

172 (
¦i¡–m
)->
f›ld
.
¦e_Ãxt
 = (
–m
); \

173 }  0)

	)

175 
	#SLIST_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

176 (
–m
)->
f›ld
.
¦e_Ãxt
 = (
h—d
)->
¦h_fœ¡
; \

177 (
h—d
)->
¦h_fœ¡
 = (
–m
); \

178 }  0)

	)

180 
	#SLIST_REMOVE_HEAD
(
h—d
, 
f›ld
) do { \

181 (
h—d
)->
¦h_fœ¡
 = (h—d)->¦h_fœ¡->
f›ld
.
¦e_Ãxt
; \

182 }  0)

	)

184 
	#SLIST_REMOVE
(
h—d
, 
–m
, 
ty³
, 
f›ld
) do { \

185 ià((
h—d
)->
¦h_fœ¡
 =ğ(
–m
)) { \

186 
	`SLIST_REMOVE_HEAD
((
h—d
), 
f›ld
); \

189 
ty³
 *
cu»lm
 = (
h—d
)->
¦h_fœ¡
; \

190 
cu»lm
->
f›ld
.
¦e_Ãxt
 !ğ(
–m
)) \

191 
cu»lm
 = cu»lm->
f›ld
.
¦e_Ãxt
; \

192 
cu»lm
->
f›ld
.
¦e_Ãxt
 = \

193 
cu»lm
->
f›ld
.
¦e_Ãxt
->field.sle_next; \

195 }  0)

	)

197 
	#SLIST_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

198 (
v¬
èğ(
h—d
)->
¦h_fœ¡
; (v¬); (v¬èğ(v¬)->
f›ld
.
¦e_Ãxt
)

	)

203 
	#SLIST_EMPTY
(
h—d
è((h—d)->
¦h_fœ¡
 =ğ
NULL
)

	)

204 
	#SLIST_FIRST
(
h—d
è((h—d)->
¦h_fœ¡
)

	)

205 
	#SLIST_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
¦e_Ãxt
)

	)

211 
	#STAILQ_HEAD
(
Çme
, 
ty³
) \

212 
	sÇme
 { \

213 
ty³
 *
¡qh_fœ¡
; \

214 
ty³
 **
¡qh_Ï¡
; \

215 }

	)

217 
	#STAILQ_HEAD_INITIALIZER
(
h—d
) \

218 { 
NULL
, &(
h—d
).
¡qh_fœ¡
 }

	)

220 
	#STAILQ_ENTRY
(
ty³
) \

222 
ty³
 *
¡qe_Ãxt
; \

223 }

	)

228 
	#STAILQ_INIT
(
h—d
) do { \

229 (
h—d
)->
¡qh_fœ¡
 = 
NULL
; \

230 (
h—d
)->
¡qh_Ï¡
 = &(h—d)->
¡qh_fœ¡
; \

231 }  0)

	)

233 
	#STAILQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

234 ià(((
–m
)->
f›ld
.
¡qe_Ãxt
 = (
h—d
)->
¡qh_fœ¡
è=ğ
NULL
) \

235 (
h—d
)->
¡qh_Ï¡
 = &(
–m
)->
f›ld
.
¡qe_Ãxt
; \

236 (
h—d
)->
¡qh_fœ¡
 = (
–m
); \

237 }  0)

	)

239 
	#STAILQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

240 (
–m
)->
f›ld
.
¡qe_Ãxt
 = 
NULL
; \

241 *(
h—d
)->
¡qh_Ï¡
 = (
–m
); \

242 (
h—d
)->
¡qh_Ï¡
 = &(
–m
)->
f›ld
.
¡qe_Ãxt
; \

243 }  0)

	)

245 
	#STAILQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

246 ià(((
–m
)->
f›ld
.
¡qe_Ãxt
 = (
li¡–m
)->f›ld.¡qe_Ãxtè=ğ
NULL
)\

247 (
h—d
)->
¡qh_Ï¡
 = &(
–m
)->
f›ld
.
¡qe_Ãxt
; \

248 (
li¡–m
)->
f›ld
.
¡qe_Ãxt
 = (
–m
); \

249 }  0)

	)

251 
	#STAILQ_REMOVE_HEAD
(
h—d
, 
f›ld
) do { \

252 ià(((
h—d
)->
¡qh_fœ¡
 = (h—d)->¡qh_fœ¡->
f›ld
.
¡qe_Ãxt
è=ğ
NULL
) \

253 (
h—d
)->
¡qh_Ï¡
 = &(h—d)->
¡qh_fœ¡
; \

254 }  0)

	)

256 
	#STAILQ_REMOVE
(
h—d
, 
–m
, 
ty³
, 
f›ld
) do { \

257 ià((
h—d
)->
¡qh_fœ¡
 =ğ(
–m
)) { \

258 
	`STAILQ_REMOVE_HEAD
((
h—d
), 
f›ld
); \

260 
ty³
 *
cu»lm
 = (
h—d
)->
¡qh_fœ¡
; \

261 
cu»lm
->
f›ld
.
¡qe_Ãxt
 !ğ(
–m
)) \

262 
cu»lm
 = cu»lm->
f›ld
.
¡qe_Ãxt
; \

263 ià((
cu»lm
->
f›ld
.
¡qe_Ãxt
 = \

264 
cu»lm
->
f›ld
.
¡qe_Ãxt
->f›ld.¡qe_Ãxtè=ğ
NULL
) \

265 (
h—d
)->
¡qh_Ï¡
 = &(
cu»lm
)->
f›ld
.
¡qe_Ãxt
; \

267 }  0)

	)

269 
	#STAILQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

270 (
v¬
èğ((
h—d
)->
¡qh_fœ¡
); \

271 (
v¬
); \

272 (
v¬
èğ((v¬)->
f›ld
.
¡qe_Ãxt
))

	)

274 
	#STAILQ_CONCAT
(
h—d1
, 
h—d2
) do { \

275 ià(!
	`STAILQ_EMPTY
((
h—d2
))) { \

276 *(
h—d1
)->
¡qh_Ï¡
 = (
h—d2
)->
¡qh_fœ¡
; \

277 (
h—d1
)->
¡qh_Ï¡
 = (
h—d2
)->stqh_last; \

278 
	`STAILQ_INIT
((
h—d2
)); \

280 }  0)

	)

285 
	#STAILQ_EMPTY
(
h—d
è((h—d)->
¡qh_fœ¡
 =ğ
NULL
)

	)

286 
	#STAILQ_FIRST
(
h—d
è((h—d)->
¡qh_fœ¡
)

	)

287 
	#STAILQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
¡qe_Ãxt
)

	)

293 
	#SIMPLEQ_HEAD
(
Çme
, 
ty³
) \

294 
	sÇme
 { \

295 
ty³
 *
sqh_fœ¡
; \

296 
ty³
 **
sqh_Ï¡
; \

297 }

	)

299 
	#SIMPLEQ_HEAD_INITIALIZER
(
h—d
) \

300 { 
NULL
, &(
h—d
).
sqh_fœ¡
 }

	)

302 
	#SIMPLEQ_ENTRY
(
ty³
) \

304 
ty³
 *
sqe_Ãxt
; \

305 }

	)

310 
	#SIMPLEQ_INIT
(
h—d
) do { \

311 (
h—d
)->
sqh_fœ¡
 = 
NULL
; \

312 (
h—d
)->
sqh_Ï¡
 = &(h—d)->
sqh_fœ¡
; \

313 }  0)

	)

315 
	#SIMPLEQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

316 ià(((
–m
)->
f›ld
.
sqe_Ãxt
 = (
h—d
)->
sqh_fœ¡
è=ğ
NULL
) \

317 (
h—d
)->
sqh_Ï¡
 = &(
–m
)->
f›ld
.
sqe_Ãxt
; \

318 (
h—d
)->
sqh_fœ¡
 = (
–m
); \

319 }  0)

	)

321 
	#SIMPLEQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

322 (
–m
)->
f›ld
.
sqe_Ãxt
 = 
NULL
; \

323 *(
h—d
)->
sqh_Ï¡
 = (
–m
); \

324 (
h—d
)->
sqh_Ï¡
 = &(
–m
)->
f›ld
.
sqe_Ãxt
; \

325 }  0)

	)

327 
	#SIMPLEQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

328 ià(((
–m
)->
f›ld
.
sqe_Ãxt
 = (
li¡–m
)->f›ld.sqe_Ãxtè=ğ
NULL
)\

329 (
h—d
)->
sqh_Ï¡
 = &(
–m
)->
f›ld
.
sqe_Ãxt
; \

330 (
li¡–m
)->
f›ld
.
sqe_Ãxt
 = (
–m
); \

331 }  0)

	)

333 
	#SIMPLEQ_REMOVE_HEAD
(
h—d
, 
f›ld
) do { \

334 ià(((
h—d
)->
sqh_fœ¡
 = (h—d)->sqh_fœ¡->
f›ld
.
sqe_Ãxt
è=ğ
NULL
) \

335 (
h—d
)->
sqh_Ï¡
 = &(h—d)->
sqh_fœ¡
; \

336 }  0)

	)

338 
	#SIMPLEQ_REMOVE
(
h—d
, 
–m
, 
ty³
, 
f›ld
) do { \

339 ià((
h—d
)->
sqh_fœ¡
 =ğ(
–m
)) { \

340 
	`SIMPLEQ_REMOVE_HEAD
((
h—d
), 
f›ld
); \

342 
ty³
 *
cu»lm
 = (
h—d
)->
sqh_fœ¡
; \

343 
cu»lm
->
f›ld
.
sqe_Ãxt
 !ğ(
–m
)) \

344 
cu»lm
 = cu»lm->
f›ld
.
sqe_Ãxt
; \

345 ià((
cu»lm
->
f›ld
.
sqe_Ãxt
 = \

346 
cu»lm
->
f›ld
.
sqe_Ãxt
->f›ld.sqe_Ãxtè=ğ
NULL
) \

347 (
h—d
)->
sqh_Ï¡
 = &(
cu»lm
)->
f›ld
.
sqe_Ãxt
; \

349 }  0)

	)

351 
	#SIMPLEQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

352 (
v¬
èğ((
h—d
)->
sqh_fœ¡
); \

353 (
v¬
); \

354 (
v¬
èğ((v¬)->
f›ld
.
sqe_Ãxt
))

	)

359 
	#SIMPLEQ_EMPTY
(
h—d
è((h—d)->
sqh_fœ¡
 =ğ
NULL
)

	)

360 
	#SIMPLEQ_FIRST
(
h—d
è((h—d)->
sqh_fœ¡
)

	)

361 
	#SIMPLEQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
sqe_Ãxt
)

	)

367 
	#_TAILQ_HEAD
(
Çme
, 
ty³
, 
qu®
) \

368 
	sÇme
 { \

369 
qu®
 
ty³
 *
tqh_fœ¡
; \

370 
qu®
 
ty³
 *qu® *
tqh_Ï¡
; \

371 }

	)

372 
	#TAILQ_HEAD
(
Çme
, 
ty³
è
	`_TAILQ_HEAD
Òame, ty³,)

	)

374 
	#TAILQ_HEAD_INITIALIZER
(
h—d
) \

375 { 
NULL
, &(
h—d
).
tqh_fœ¡
 }

	)

377 
	#_TAILQ_ENTRY
(
ty³
, 
qu®
) \

379 
qu®
 
ty³
 *
tqe_Ãxt
; \

380 
qu®
 
ty³
 *qu® *
tqe_´ev
; \

381 }

	)

382 
	#TAILQ_ENTRY
(
ty³
è
	`_TAILQ_ENTRY
(ty³,)

	)

387 
	#TAILQ_INIT
(
h—d
) do { \

388 (
h—d
)->
tqh_fœ¡
 = 
NULL
; \

389 (
h—d
)->
tqh_Ï¡
 = &(h—d)->
tqh_fœ¡
; \

390 }  0)

	)

392 
	#TAILQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

393 ià(((
–m
)->
f›ld
.
tqe_Ãxt
 = (
h—d
)->
tqh_fœ¡
è!ğ
NULL
) \

394 (
h—d
)->
tqh_fœ¡
->
f›ld
.
tqe_´ev
 = \

395 &(
–m
)->
f›ld
.
tqe_Ãxt
; \

397 (
h—d
)->
tqh_Ï¡
 = &(
–m
)->
f›ld
.
tqe_Ãxt
; \

398 (
h—d
)->
tqh_fœ¡
 = (
–m
); \

399 (
–m
)->
f›ld
.
tqe_´ev
 = &(
h—d
)->
tqh_fœ¡
; \

400 }  0)

	)

402 
	#TAILQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

403 (
–m
)->
f›ld
.
tqe_Ãxt
 = 
NULL
; \

404 (
–m
)->
f›ld
.
tqe_´ev
 = (
h—d
)->
tqh_Ï¡
; \

405 *(
h—d
)->
tqh_Ï¡
 = (
–m
); \

406 (
h—d
)->
tqh_Ï¡
 = &(
–m
)->
f›ld
.
tqe_Ãxt
; \

407 }  0)

	)

409 
	#TAILQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

410 ià(((
–m
)->
f›ld
.
tqe_Ãxt
 = (
li¡–m
)->f›ld.tqe_Ãxtè!ğ
NULL
)\

411 (
–m
)->
f›ld
.
tqe_Ãxt
->f›ld.
tqe_´ev
 = \

412 &(
–m
)->
f›ld
.
tqe_Ãxt
; \

414 (
h—d
)->
tqh_Ï¡
 = &(
–m
)->
f›ld
.
tqe_Ãxt
; \

415 (
li¡–m
)->
f›ld
.
tqe_Ãxt
 = (
–m
); \

416 (
–m
)->
f›ld
.
tqe_´ev
 = &(
li¡–m
)->f›ld.
tqe_Ãxt
; \

417 }  0)

	)

419 
	#TAILQ_INSERT_BEFORE
(
li¡–m
, 
–m
, 
f›ld
) do { \

420 (
–m
)->
f›ld
.
tqe_´ev
 = (
li¡–m
)->field.tqe_prev; \

421 (
–m
)->
f›ld
.
tqe_Ãxt
 = (
li¡–m
); \

422 *(
li¡–m
)->
f›ld
.
tqe_´ev
 = (
–m
); \

423 (
li¡–m
)->
f›ld
.
tqe_´ev
 = &(
–m
)->f›ld.
tqe_Ãxt
; \

424 }  0)

	)

426 
	#TAILQ_REMOVE
(
h—d
, 
–m
, 
f›ld
) do { \

427 ià(((
–m
)->
f›ld
.
tqe_Ãxt
è!ğ
NULL
) \

428 (
–m
)->
f›ld
.
tqe_Ãxt
->f›ld.
tqe_´ev
 = \

429 (
–m
)->
f›ld
.
tqe_´ev
; \

431 (
h—d
)->
tqh_Ï¡
 = (
–m
)->
f›ld
.
tqe_´ev
; \

432 *(
–m
)->
f›ld
.
tqe_´ev
 = (–m)->f›ld.
tqe_Ãxt
; \

433 }  0)

	)

435 
	#TAILQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

436 (
v¬
èğ((
h—d
)->
tqh_fœ¡
); \

437 (
v¬
); \

438 (
v¬
èğ((v¬)->
f›ld
.
tqe_Ãxt
))

	)

440 
	#TAILQ_FOREACH_REVERSE
(
v¬
, 
h—d
, 
h—dÇme
, 
f›ld
) \

441 (
v¬
èğ(*(((
h—dÇme
 *)((
h—d
)->
tqh_Ï¡
))->tqh_last)); \

442 (
v¬
); \

443 (
v¬
èğ(*(((
h—dÇme
 *)((v¬)->
f›ld
.
tqe_´ev
))->
tqh_Ï¡
)))

	)

445 
	#TAILQ_CONCAT
(
h—d1
, 
h—d2
, 
f›ld
) do { \

446 ià(!
	`TAILQ_EMPTY
(
h—d2
)) { \

447 *(
h—d1
)->
tqh_Ï¡
 = (
h—d2
)->
tqh_fœ¡
; \

448 (
h—d2
)->
tqh_fœ¡
->
f›ld
.
tqe_´ev
 = (
h—d1
)->
tqh_Ï¡
; \

449 (
h—d1
)->
tqh_Ï¡
 = (
h—d2
)->tqh_last; \

450 
	`TAILQ_INIT
((
h—d2
)); \

452 }  0)

	)

457 
	#TAILQ_EMPTY
(
h—d
è((h—d)->
tqh_fœ¡
 =ğ
NULL
)

	)

458 
	#TAILQ_FIRST
(
h—d
è((h—d)->
tqh_fœ¡
)

	)

459 
	#TAILQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
tqe_Ãxt
)

	)

461 
	#TAILQ_LAST
(
h—d
, 
h—dÇme
) \

462 (*(((
h—dÇme
 *)((
h—d
)->
tqh_Ï¡
))->tqh_Ï¡))

	)

463 
	#TAILQ_PREV
(
–m
, 
h—dÇme
, 
f›ld
) \

464 (*(((
h—dÇme
 *)((
–m
)->
f›ld
.
tqe_´ev
))->
tqh_Ï¡
))

	)

470 
	#CIRCLEQ_HEAD
(
Çme
, 
ty³
) \

471 
	sÇme
 { \

472 
ty³
 *
cqh_fœ¡
; \

473 
ty³
 *
cqh_Ï¡
; \

474 }

	)

476 
	#CIRCLEQ_HEAD_INITIALIZER
(
h—d
) \

477 { (*)&
h—d
, (*)&h—d }

	)

479 
	#CIRCLEQ_ENTRY
(
ty³
) \

481 
ty³
 *
cqe_Ãxt
; \

482 
ty³
 *
cqe_´ev
; \

483 }

	)

488 
	#CIRCLEQ_INIT
(
h—d
) do { \

489 (
h—d
)->
cqh_fœ¡
 = (*)(head); \

490 (
h—d
)->
cqh_Ï¡
 = (*)(head); \

491 }  0)

	)

493 
	#CIRCLEQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

494 (
–m
)->
f›ld
.
cqe_Ãxt
 = (
li¡–m
)->field.cqe_next; \

495 (
–m
)->
f›ld
.
cqe_´ev
 = (
li¡–m
); \

496 ià((
li¡–m
)->
f›ld
.
cqe_Ãxt
 =ğ(*)(
h—d
)) \

497 (
h—d
)->
cqh_Ï¡
 = (
–m
); \

499 (
li¡–m
)->
f›ld
.
cqe_Ãxt
->f›ld.
cqe_´ev
 = (
–m
); \

500 (
li¡–m
)->
f›ld
.
cqe_Ãxt
 = (
–m
); \

501 }  0)

	)

503 
	#CIRCLEQ_INSERT_BEFORE
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

504 (
–m
)->
f›ld
.
cqe_Ãxt
 = (
li¡–m
); \

505 (
–m
)->
f›ld
.
cqe_´ev
 = (
li¡–m
)->field.cqe_prev; \

506 ià((
li¡–m
)->
f›ld
.
cqe_´ev
 =ğ(*)(
h—d
)) \

507 (
h—d
)->
cqh_fœ¡
 = (
–m
); \

509 (
li¡–m
)->
f›ld
.
cqe_´ev
->f›ld.
cqe_Ãxt
 = (
–m
); \

510 (
li¡–m
)->
f›ld
.
cqe_´ev
 = (
–m
); \

511 }  0)

	)

513 
	#CIRCLEQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

514 (
–m
)->
f›ld
.
cqe_Ãxt
 = (
h—d
)->
cqh_fœ¡
; \

515 (
–m
)->
f›ld
.
cqe_´ev
 = (*)(
h—d
); \

516 ià((
h—d
)->
cqh_Ï¡
 == (*)(head)) \

517 (
h—d
)->
cqh_Ï¡
 = (
–m
); \

519 (
h—d
)->
cqh_fœ¡
->
f›ld
.
cqe_´ev
 = (
–m
); \

520 (
h—d
)->
cqh_fœ¡
 = (
–m
); \

521 }  0)

	)

523 
	#CIRCLEQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

524 (
–m
)->
f›ld
.
cqe_Ãxt
 = (*)(
h—d
); \

525 (
–m
)->
f›ld
.
cqe_´ev
 = (
h—d
)->
cqh_Ï¡
; \

526 ià((
h—d
)->
cqh_fœ¡
 == (*)(head)) \

527 (
h—d
)->
cqh_fœ¡
 = (
–m
); \

529 (
h—d
)->
cqh_Ï¡
->
f›ld
.
cqe_Ãxt
 = (
–m
); \

530 (
h—d
)->
cqh_Ï¡
 = (
–m
); \

531 }  0)

	)

533 
	#CIRCLEQ_REMOVE
(
h—d
, 
–m
, 
f›ld
) do { \

534 ià((
–m
)->
f›ld
.
cqe_Ãxt
 =ğ(*)(
h—d
)) \

535 (
h—d
)->
cqh_Ï¡
 = (
–m
)->
f›ld
.
cqe_´ev
; \

537 (
–m
)->
f›ld
.
cqe_Ãxt
->f›ld.
cqe_´ev
 = \

538 (
–m
)->
f›ld
.
cqe_´ev
; \

539 ià((
–m
)->
f›ld
.
cqe_´ev
 =ğ(*)(
h—d
)) \

540 (
h—d
)->
cqh_fœ¡
 = (
–m
)->
f›ld
.
cqe_Ãxt
; \

542 (
–m
)->
f›ld
.
cqe_´ev
->f›ld.
cqe_Ãxt
 = \

543 (
–m
)->
f›ld
.
cqe_Ãxt
; \

544 }  0)

	)

546 
	#CIRCLEQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

547 (
v¬
èğ((
h—d
)->
cqh_fœ¡
); \

548 (
v¬
è!ğ(cÚ¡ *)(
h—d
); \

549 (
v¬
èğ((v¬)->
f›ld
.
cqe_Ãxt
))

	)

551 
	#CIRCLEQ_FOREACH_REVERSE
(
v¬
, 
h—d
, 
f›ld
) \

552 (
v¬
èğ((
h—d
)->
cqh_Ï¡
); \

553 (
v¬
è!ğ(cÚ¡ *)(
h—d
); \

554 (
v¬
èğ((v¬)->
f›ld
.
cqe_´ev
))

	)

559 
	#CIRCLEQ_EMPTY
(
h—d
è((h—d)->
cqh_fœ¡
 =ğ(*)(h—d))

	)

560 
	#CIRCLEQ_FIRST
(
h—d
è((h—d)->
cqh_fœ¡
)

	)

561 
	#CIRCLEQ_LAST
(
h—d
è((h—d)->
cqh_Ï¡
)

	)

562 
	#CIRCLEQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
cqe_Ãxt
)

	)

563 
	#CIRCLEQ_PREV
(
–m
, 
f›ld
è(Ólm)->f›ld.
cqe_´ev
)

	)

565 
	#CIRCLEQ_LOOP_NEXT
(
h—d
, 
–m
, 
f›ld
) \

566 (((
–m
)->
f›ld
.
cqe_Ãxt
 =ğ(*)(
h—d
)) \

567 ? ((
h—d
)->
cqh_fœ¡
) \

568 : (
–m
->
f›ld
.
cqe_Ãxt
))

	)

569 
	#CIRCLEQ_LOOP_PREV
(
h—d
, 
–m
, 
f›ld
) \

570 (((
–m
)->
f›ld
.
cqe_´ev
 =ğ(*)(
h—d
)) \

571 ? ((
h—d
)->
cqh_Ï¡
) \

572 : (
–m
->
f›ld
.
cqe_´ev
))

	)

	@/usr/include/sys/resource.h

18 #iâdef 
_SYS_RESOURCE_H


19 
	#_SYS_RESOURCE_H
 1

	)

21 
	~<ã©u»s.h
>

24 
	~<b™s/»sourû.h
>

26 #iâdeà
__id_t_defšed


27 
__id_t
 
	tid_t
;

28 
	#__id_t_defšed


	)

31 
	g__BEGIN_DECLS


37 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


38 
__¾im™_»sourû
 
	t__¾im™_»sourû_t
;

39 
__ru§ge_who
 
	t__ru§ge_who_t
;

40 
__´iÜ™y_which
 
	t__´iÜ™y_which_t
;

42 
	t__¾im™_»sourû_t
;

43 
	t__ru§ge_who_t
;

44 
	t__´iÜ™y_which_t
;

49 #iâdeà
__USE_FILE_OFFSET64


50 
	$g‘¾im™
 (
__¾im™_»sourû_t
 
__»sourû
,

51 
¾im™
 *
__¾im™s
è
__THROW
;

53 #ifdeà
__REDIRECT_NTH


54 
	`__REDIRECT_NTH
 (
g‘¾im™
, (
__¾im™_»sourû_t
 
__»sourû
,

55 
¾im™
 *
__¾im™s
), 
g‘¾im™64
);

57 
	#g‘¾im™
 
g‘¾im™64


	)

60 #ifdeà
__USE_LARGEFILE64


61 
	$g‘¾im™64
 (
__¾im™_»sourû_t
 
__»sourû
,

62 
¾im™64
 *
__¾im™s
è
__THROW
;

68 #iâdeà
__USE_FILE_OFFSET64


69 
	$£Œlim™
 (
__¾im™_»sourû_t
 
__»sourû
,

70 cÚ¡ 
¾im™
 *
__¾im™s
è
__THROW
;

72 #ifdeà
__REDIRECT_NTH


73 
	`__REDIRECT_NTH
 (
£Œlim™
, (
__¾im™_»sourû_t
 
__»sourû
,

74 cÚ¡ 
¾im™
 *
__¾im™s
),

75 
£Œlim™64
);

77 
	#£Œlim™
 
£Œlim™64


	)

80 #ifdeà
__USE_LARGEFILE64


81 
	$£Œlim™64
 (
__¾im™_»sourû_t
 
__»sourû
,

82 cÚ¡ 
¾im™64
 *
__¾im™s
è
__THROW
;

87 
	$g‘ru§ge
 (
__ru§ge_who_t
 
__who
, 
ru§ge
 *
__u§ge
è
__THROW
;

93 
	$g‘´iÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
è
__THROW
;

97 
	$£riÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
, 
__´io
)

98 
__THROW
;

100 
__END_DECLS


	@/usr/include/sys/select.h

21 #iâdeà
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

30 
	~<b™s/£Ëù.h
>

33 
	~<b™s/ty³s/sig£t_t.h
>

36 
	~<b™s/ty³s/time_t.h
>

37 
	~<b™s/ty³s/¡ruù_timev®.h
>

38 #ifdeà
__USE_XOPEN2K


39 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

42 #iâdeà
__su£cÚds_t_defšed


43 
__su£cÚds_t
 
	tsu£cÚds_t
;

44 
	#__su£cÚds_t_defšed


	)

49 
	t__fd_mask
;

52 #undeà
__NFDBITS


54 
	#__NFDBITS
 (8 * (è (
__fd_mask
))

	)

55 
	#__FD_ELT
(
d
è((dè/ 
__NFDBITS
)

	)

56 
	#__FD_MASK
(
d
è((
__fd_mask
è(1UL << ((dè% 
__NFDBITS
)))

	)

63 #ifdeà
__USE_XOPEN


64 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

65 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

67 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

68 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

70 } 
	tfd_£t
;

73 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

75 #ifdeà
__USE_MISC


77 
__fd_mask
 
	tfd_mask
;

80 
	#NFDBITS
 
__NFDBITS


	)

85 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

86 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

87 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

88 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

91 
__BEGIN_DECLS


101 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

102 
fd_£t
 *
__»¡riù
 
__wr™efds
,

103 
fd_£t
 *
__»¡riù
 
__exû±fds
,

104 
timev®
 *
__»¡riù
 
__timeout
);

106 #ifdeà
__USE_XOPEN2K


113 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

114 
fd_£t
 *
__»¡riù
 
__wr™efds
,

115 
fd_£t
 *
__»¡riù
 
__exû±fds
,

116 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

117 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

122 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__GNUC__


123 
	~<b™s/£Ëù2.h
>

126 
	g__END_DECLS


	@/usr/include/sys/socket.h

19 #iâdef 
_SYS_SOCKET_H


20 
	#_SYS_SOCKET_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	g__BEGIN_DECLS


26 
	~<b™s/ty³s/¡ruù_iovec.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

33 
	~<b™s/sock‘.h
>

35 #ifdeà
__USE_MISC


36 
	~<b™s/ty³s/¡ruù_osockaddr.h
>

43 
	mSHUT_RD
 = 0,

44 
	#SHUT_RD
 
SHUT_RD


	)

45 
	mSHUT_WR
,

46 
	#SHUT_WR
 
SHUT_WR


	)

47 
	mSHUT_RDWR


48 
	#SHUT_RDWR
 
SHUT_RDWR


	)

57 #ià
defšed
 
__ılu¥lus
 || !
__GNUC_PREREQ
 (2, 7è|| !defšed 
__USE_GNU


58 
	#__SOCKADDR_ARG
 
sockaddr
 *
__»¡riù


	)

59 
	#__CONST_SOCKADDR_ARG
 cÚ¡ 
sockaddr
 *

	)

63 
	#__SOCKADDR_ALLTYPES
 \

64 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

65 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

66 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

67 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

68 
	`__SOCKADDR_ONETYPE
 (
sockaddr_eÚ
) \

69 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š
) \

70 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š6
) \

71 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š¬p
) \

72 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x
) \

73 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

74 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

75 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

76 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

78 
	#__SOCKADDR_ONETYPE
(
ty³
èty³ *
__»¡riù
 
__
##ty³##__;

	)

79 uniÚ { 
	m__SOCKADDR_ALLTYPES


80 } 
	t__SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

81 #undeà
__SOCKADDR_ONETYPE


82 
	#__SOCKADDR_ONETYPE
(
ty³
ècÚ¡ ty³ *
__»¡riù
 
__
##ty³##__;

	)

83 uniÚ { 
	m__SOCKADDR_ALLTYPES


84 } 
	t__CONST_SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

85 #undeà
__SOCKADDR_ONETYPE


88 #ifdeà
__USE_GNU


90 
	smmsghdr


92 
msghdr
 
	mmsg_hdr
;

93 
	mmsg_Ën
;

102 
	$sock‘
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
è
__THROW
;

108 
	$sock‘·œ
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
,

109 
__fds
[2]è
__THROW
;

112 
	$bšd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
)

113 
__THROW
;

116 
	$g‘sockÇme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

117 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

126 
	`cÚÃù
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
);

130 
	$g‘³”Çme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

131 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

138 
ssize_t
 
	`£nd
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
, 
__æags
);

145 
ssize_t
 
	`»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
);

152 
ssize_t
 
	`£ndto
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

153 
__æags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

154 
sockËn_t
 
__addr_Ën
);

163 
ssize_t
 
	`»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

164 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

165 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

173 
ssize_t
 
	`£ndmsg
 (
__fd
, cÚ¡ 
msghdr
 *
__mes§ge
,

174 
__æags
);

176 #ifdeà
__USE_GNU


182 
	`£ndmmsg
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

183 
__vËn
, 
__æags
);

191 
ssize_t
 
	`»cvmsg
 (
__fd
, 
msghdr
 *
__mes§ge
, 
__æags
);

193 #ifdeà
__USE_GNU


199 
	`»cvmmsg
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

200 
__vËn
, 
__æags
,

201 
time¥ec
 *
__tmo
);

208 
	$g‘sockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

209 *
__»¡riù
 
__İtv®
,

210 
sockËn_t
 *
__»¡riù
 
__İ’
è
__THROW
;

215 
	$£tsockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

216 cÚ¡ *
__İtv®
, 
sockËn_t
 
__İ’
è
__THROW
;

222 
	$li¡’
 (
__fd
, 
__n
è
__THROW
;

232 
	`acû±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

233 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

235 #ifdeà
__USE_GNU


240 
	`acû±4
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

241 
sockËn_t
 *
__»¡riù
 
__addr_Ën
, 
__æags
);

250 
	$shutdown
 (
__fd
, 
__how
è
__THROW
;

253 #ifdeà
__USE_XOPEN2K


255 
	$sock©m¬k
 (
__fd
è
__THROW
;

259 #ifdeà
__USE_MISC


263 
	$isfdty³
 (
__fd
, 
__fdty³
è
__THROW
;

268 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


269 
	~<b™s/sock‘2.h
>

272 
__END_DECLS


	@/usr/include/sys/stat.h

22 #iâdef 
_SYS_STAT_H


23 
	#_SYS_STAT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

29 #ifdeà
__USE_XOPEN2K8


30 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

33 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


37 
	~<b™s/ty³s/time_t.h
>

39 #iâdeà
__dev_t_defšed


40 
__dev_t
 
	tdev_t
;

41 
	#__dev_t_defšed


	)

44 #iâdeà
__gid_t_defšed


45 
__gid_t
 
	tgid_t
;

46 
	#__gid_t_defšed


	)

49 #iâdeà
__šo_t_defšed


50 #iâdeà
__USE_FILE_OFFSET64


51 
__šo_t
 
	tšo_t
;

53 
__šo64_t
 
	tšo_t
;

55 
	#__šo_t_defšed


	)

58 #iâdeà
__mode_t_defšed


59 
__mode_t
 
	tmode_t
;

60 
	#__mode_t_defšed


	)

63 #iâdeà
__Æšk_t_defšed


64 
__Æšk_t
 
	tÆšk_t
;

65 
	#__Æšk_t_defšed


	)

68 #iâdeà
__off_t_defšed


69 #iâdeà
__USE_FILE_OFFSET64


70 
__off_t
 
	toff_t
;

72 
__off64_t
 
	toff_t
;

74 
	#__off_t_defšed


	)

77 #iâdeà
__uid_t_defšed


78 
__uid_t
 
	tuid_t
;

79 
	#__uid_t_defšed


	)

83 #ifdeà
__USE_UNIX98


84 #iâdeà
__blkút_t_defšed


85 #iâdeà
__USE_FILE_OFFSET64


86 
__blkút_t
 
	tblkút_t
;

88 
__blkút64_t
 
	tblkút_t
;

90 
	#__blkút_t_defšed


	)

93 #iâdeà
__blksize_t_defšed


94 
__blksize_t
 
	tblksize_t
;

95 
	#__blksize_t_defšed


	)

99 
	g__BEGIN_DECLS


101 
	~<b™s/¡©.h
>

103 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


104 
	#S_IFMT
 
__S_IFMT


	)

105 
	#S_IFDIR
 
__S_IFDIR


	)

106 
	#S_IFCHR
 
__S_IFCHR


	)

107 
	#S_IFBLK
 
__S_IFBLK


	)

108 
	#S_IFREG
 
__S_IFREG


	)

109 #ifdeà
__S_IFIFO


110 
	#S_IFIFO
 
__S_IFIFO


	)

112 #ifdeà
__S_IFLNK


113 
	#S_IFLNK
 
__S_IFLNK


	)

115 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
) \

116 && 
defšed
 
	g__S_IFSOCK


117 
	#S_IFSOCK
 
__S_IFSOCK


	)

123 
	#__S_ISTYPE
(
mode
, 
mask
è(((modeè& 
__S_IFMT
è=ğ(mask))

	)

125 
	#S_ISDIR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFDIR
)

	)

126 
	#S_ISCHR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFCHR
)

	)

127 
	#S_ISBLK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFBLK
)

	)

128 
	#S_ISREG
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFREG
)

	)

129 #ifdeà
__S_IFIFO


130 
	#S_ISFIFO
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFIFO
)

	)

132 #ifdeà
__S_IFLNK


133 
	#S_ISLNK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFLNK
)

	)

136 #ià
defšed
 
__USE_MISC
 && !defšed 
__S_IFLNK


137 
	#S_ISLNK
(
mode
è0

	)

140 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K
) \

141 && 
defšed
 
	g__S_IFSOCK


142 
	#S_ISSOCK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFSOCK
)

	)

143 #–ià
defšed
 
__USE_XOPEN2K


144 
	#S_ISSOCK
(
mode
è0

	)

151 #ifdef 
__USE_POSIX199309


152 
	#S_TYPEISMQ
(
buf
è
	`__S_TYPEISMQ
(buf)

	)

153 
	#S_TYPEISSEM
(
buf
è
	`__S_TYPEISSEM
(buf)

	)

154 
	#S_TYPEISSHM
(
buf
è
	`__S_TYPEISSHM
(buf)

	)

160 
	#S_ISUID
 
__S_ISUID


	)

161 
	#S_ISGID
 
__S_ISGID


	)

163 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


165 
	#S_ISVTX
 
__S_ISVTX


	)

168 
	#S_IRUSR
 
__S_IREAD


	)

169 
	#S_IWUSR
 
__S_IWRITE


	)

170 
	#S_IXUSR
 
__S_IEXEC


	)

172 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

174 #ifdeà
__USE_MISC


175 
	#S_IREAD
 
S_IRUSR


	)

176 
	#S_IWRITE
 
S_IWUSR


	)

177 
	#S_IEXEC
 
S_IXUSR


	)

180 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

181 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

182 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

184 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

186 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

187 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

188 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

190 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

193 #ifdef 
__USE_MISC


195 
	#ACCESSPERMS
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
è

	)

196 
	#ALLPERMS
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

197 
	#DEFFILEMODE
 (
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
)

	)

199 
	#S_BLKSIZE
 512

	)

203 #iâdeà
__USE_FILE_OFFSET64


205 
	$¡©
 (cÚ¡ *
__»¡riù
 
__fe
,

206 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

210 
	$f¡©
 (
__fd
, 
¡©
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

212 #ifdeà
__REDIRECT_NTH


213 
	`__REDIRECT_NTH
 (
¡©
, (cÚ¡ *
__»¡riù
 
__fe
,

214 
¡©
 *
__»¡riù
 
__buf
), 
¡©64
)

215 
	`__nÚnuÎ
 ((1, 2));

216 
	`__REDIRECT_NTH
 (
f¡©
, (
__fd
, 
¡©
 *
__buf
), 
f¡©64
)

217 
	`__nÚnuÎ
 ((2));

219 
	#¡©
 
¡©64


	)

220 
	#f¡©
 
f¡©64


	)

223 #ifdeà
__USE_LARGEFILE64


224 
	$¡©64
 (cÚ¡ *
__»¡riù
 
__fe
,

225 
¡©64
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

226 
	$f¡©64
 (
__fd
, 
¡©64
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

229 #ifdeà
__USE_ATFILE


233 #iâdeà
__USE_FILE_OFFSET64


234 
	$f¡©©
 (
__fd
, cÚ¡ *
__»¡riù
 
__fe
,

235 
¡©
 *
__»¡riù
 
__buf
, 
__æag
)

236 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

238 #ifdeà
__REDIRECT_NTH


239 
	`__REDIRECT_NTH
 (
f¡©©
, (
__fd
, cÚ¡ *
__»¡riù
 
__fe
,

240 
¡©
 *
__»¡riù
 
__buf
,

241 
__æag
),

242 
f¡©©64
è
	`__nÚnuÎ
 ((2, 3));

244 
	#f¡©©
 
f¡©©64


	)

248 #ifdeà
__USE_LARGEFILE64


249 
	$f¡©©64
 (
__fd
, cÚ¡ *
__»¡riù
 
__fe
,

250 
¡©64
 *
__»¡riù
 
__buf
, 
__æag
)

251 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

255 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


256 #iâdeà
__USE_FILE_OFFSET64


259 
	$l¡©
 (cÚ¡ *
__»¡riù
 
__fe
,

260 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

262 #ifdeà
__REDIRECT_NTH


263 
	`__REDIRECT_NTH
 (
l¡©
,

264 (cÚ¡ *
__»¡riù
 
__fe
,

265 
¡©
 *
__»¡riù
 
__buf
), 
l¡©64
)

266 
	`__nÚnuÎ
 ((1, 2));

268 
	#l¡©
 
l¡©64


	)

271 #ifdeà
__USE_LARGEFILE64


272 
	$l¡©64
 (cÚ¡ *
__»¡riù
 
__fe
,

273 
¡©64
 *
__»¡riù
 
__buf
)

274 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

280 
	$chmod
 (cÚ¡ *
__fe
, 
__mode_t
 
__mode
)

281 
__THROW
 
	`__nÚnuÎ
 ((1));

283 #ifdeà
__USE_MISC


287 
	$lchmod
 (cÚ¡ *
__fe
, 
__mode_t
 
__mode
)

288 
__THROW
 
	`__nÚnuÎ
 ((1));

292 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


293 
	$fchmod
 (
__fd
, 
__mode_t
 
__mode
è
__THROW
;

296 #ifdeà
__USE_ATFILE


299 
	$fchmod©
 (
__fd
, cÚ¡ *
__fe
, 
__mode_t
 
__mode
,

300 
__æag
)

301 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

308 
__mode_t
 
	$umask
 (
__mode_t
 
__mask
è
__THROW
;

310 #ifdef 
__USE_GNU


313 
__mode_t
 
	$g‘umask
 (è
__THROW
;

317 
	$mkdœ
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

318 
__THROW
 
	`__nÚnuÎ
 ((1));

320 #ifdeà
__USE_ATFILE


324 
	$mkdœ©
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

325 
__THROW
 
	`__nÚnuÎ
 ((2));

331 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


332 
	$mknod
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
)

333 
__THROW
 
	`__nÚnuÎ
 ((1));

335 #ifdeà
__USE_ATFILE


339 
	$mknod©
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
,

340 
__dev_t
 
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2));

346 
	$mkfifo
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

347 
__THROW
 
	`__nÚnuÎ
 ((1));

349 #ifdeà
__USE_ATFILE


353 
	$mkfifßt
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

354 
__THROW
 
	`__nÚnuÎ
 ((2));

357 #ifdeà
__USE_ATFILE


360 
	$utim’§t
 (
__fd
, cÚ¡ *
__·th
,

361 cÚ¡ 
time¥ec
 
__times
[2],

362 
__æags
)

363 
__THROW
 
	`__nÚnuÎ
 ((2));

366 #ifdeà
__USE_XOPEN2K8


368 
	$futim’s
 (
__fd
, cÚ¡ 
time¥ec
 
__times
[2]è
__THROW
;

386 #iâdeà
_STAT_VER


387 
	#_STAT_VER
 0

	)

389 #iâdeà
_MKNOD_VER


390 
	#_MKNOD_VER
 0

	)

394 #iâdeà
__USE_FILE_OFFSET64


395 
	$__fx¡©
 (
__v”
, 
__fdes
, 
¡©
 *
__¡©_buf
)

396 
__THROW
 
	`__nÚnuÎ
 ((3));

397 
	$__x¡©
 (
__v”
, cÚ¡ *
__f’ame
,

398 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

399 
	$__lx¡©
 (
__v”
, cÚ¡ *
__f’ame
,

400 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

401 
	$__fx¡©©
 (
__v”
, 
__fdes
, cÚ¡ *
__f’ame
,

402 
¡©
 *
__¡©_buf
, 
__æag
)

403 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

405 #ifdeà
__REDIRECT_NTH


406 
	`__REDIRECT_NTH
 (
__fx¡©
, (
__v”
, 
__fdes
,

407 
¡©
 *
__¡©_buf
), 
__fx¡©64
)

408 
	`__nÚnuÎ
 ((3));

409 
	`__REDIRECT_NTH
 (
__x¡©
, (
__v”
, cÚ¡ *
__f’ame
,

410 
¡©
 *
__¡©_buf
), 
__x¡©64
)

411 
	`__nÚnuÎ
 ((2, 3));

412 
	`__REDIRECT_NTH
 (
__lx¡©
, (
__v”
, cÚ¡ *
__f’ame
,

413 
¡©
 *
__¡©_buf
), 
__lx¡©64
)

414 
	`__nÚnuÎ
 ((2, 3));

415 
	`__REDIRECT_NTH
 (
__fx¡©©
, (
__v”
, 
__fdes
,

416 cÚ¡ *
__f’ame
,

417 
¡©
 *
__¡©_buf
, 
__æag
),

418 
__fx¡©©64
è
	`__nÚnuÎ
 ((3, 4));

421 
	#__fx¡©
 
__fx¡©64


	)

422 
	#__x¡©
 
__x¡©64


	)

423 
	#__lx¡©
 
__lx¡©64


	)

427 #ifdeà
__USE_LARGEFILE64


428 
	$__fx¡©64
 (
__v”
, 
__fdes
, 
¡©64
 *
__¡©_buf
)

429 
__THROW
 
	`__nÚnuÎ
 ((3));

430 
	$__x¡©64
 (
__v”
, cÚ¡ *
__f’ame
,

431 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

432 
	$__lx¡©64
 (
__v”
, cÚ¡ *
__f’ame
,

433 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

434 
	$__fx¡©©64
 (
__v”
, 
__fdes
, cÚ¡ *
__f’ame
,

435 
¡©64
 *
__¡©_buf
, 
__æag
)

436 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

438 
	$__xmknod
 (
__v”
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
,

439 
__dev_t
 *
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

441 
	$__xmknod©
 (
__v”
, 
__fd
, cÚ¡ *
__·th
,

442 
__mode_t
 
__mode
, 
__dev_t
 *
__dev
)

443 
__THROW
 
	`__nÚnuÎ
 ((3, 5));

445 #ifdeà
__USE_EXTERN_INLINES


448 
__ex‹º_šlše
 

449 
	`__NTH
 (
	$¡©
 (cÚ¡ *
__·th
, 
¡©
 *
__¡©buf
))

451  
	`__x¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

452 
	}
}

454 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


455 
__ex‹º_šlše
 

456 
__NTH
 (
	$l¡©
 (cÚ¡ *
__·th
, 
¡©
 *
__¡©buf
))

458  
	`__lx¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

459 
	}
}

462 
__ex‹º_šlše
 

463 
__NTH
 (
	$f¡©
 (
__fd
, 
¡©
 *
__¡©buf
))

465  
	`__fx¡©
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

466 
	}
}

468 #ifdeà
__USE_ATFILE


469 
__ex‹º_šlše
 

470 
__NTH
 (
	$f¡©©
 (
__fd
, cÚ¡ *
__f’ame
, 
¡©
 *
__¡©buf
,

471 
__æag
))

473  
	`__fx¡©©
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

474 
	}
}

477 #ifdeà
__USE_MISC


478 
__ex‹º_šlše
 

479 
__NTH
 (
	$mknod
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
))

481  
	`__xmknod
 (
_MKNOD_VER
, 
__·th
, 
__mode
, &
__dev
);

482 
	}
}

485 #ifdeà
__USE_ATFILE


486 
__ex‹º_šlše
 

487 
__NTH
 (
	$mknod©
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
,

488 
__dev_t
 
__dev
))

490  
	`__xmknod©
 (
_MKNOD_VER
, 
__fd
, 
__·th
, 
__mode
, &
__dev
);

491 
	}
}

494 #ià
defšed
 
__USE_LARGEFILE64
 \

495 && (! 
defšed
 
	g__USE_FILE_OFFSET64
 \

496 || (
defšed
 
	g__REDIRECT_NTH
 && defšed 
	g__OPTIMIZE__
))

497 
__ex‹º_šlše
 

498 
__NTH
 (
	$¡©64
 (cÚ¡ *
__·th
, 
¡©64
 *
__¡©buf
))

500  
	`__x¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

501 
	}
}

503 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


504 
__ex‹º_šlše
 

505 
__NTH
 (
	$l¡©64
 (cÚ¡ *
__·th
, 
¡©64
 *
__¡©buf
))

507  
	`__lx¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

508 
	}
}

511 
__ex‹º_šlše
 

512 
__NTH
 (
	$f¡©64
 (
__fd
, 
¡©64
 *
__¡©buf
))

514  
	`__fx¡©64
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

515 
	}
}

517 #ifdeà
__USE_ATFILE


518 
__ex‹º_šlše
 

519 
__NTH
 (
	$f¡©©64
 (
__fd
, cÚ¡ *
__f’ame
, 
¡©64
 *
__¡©buf
,

520 
__æag
))

522  
	`__fx¡©©64
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

523 
	}
}

530 
	g__END_DECLS


	@/usr/include/sys/syscall.h

18 #iâdeà
_SYSCALL_H


19 
	#_SYSCALL_H
 1

	)

24 
	~<asm/uni¡d.h
>

26 #iâdeà
_LIBC


31 
	~<b™s/sysÿÎ.h
>

	@/usr/include/sys/sysctl.h

18 #iâdef 
_SYS_SYSCTL_H


19 
	#_SYS_SYSCTL_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

25 #iâdeà
_LINUX_KERNEL_H


26 
	#_LINUX_KERNEL_H
 1

	)

27 
	#__undef_LINUX_KERNEL_H


	)

29 #iâdeà
_LINUX_TYPES_H


30 
	#_LINUX_TYPES_H
 1

	)

31 
	#__undef_LINUX_TYPES_H


	)

33 #iâdeà
_LINUX_LIST_H


34 
	#_LINUX_LIST_H
 1

	)

35 
	#__undef_LINUX_LIST_H


	)

37 #iâdeà
__LINUX_COMPILER_H


38 
	#__LINUX_COMPILER_H
 1

	)

39 
	#__u£r


	)

40 
	#__undef__LINUX_COMPILER_H


	)

43 
	~<lšux/sysùl.h
>

45 #ifdeà
__undef_LINUX_KERNEL_H


46 #undeà
_LINUX_KERNEL_H


47 #undeà
__undef_LINUX_KERNEL_H


49 #ifdeà
__undef_LINUX_TYPES_H


50 #undeà
_LINUX_TYPES_H


51 #undeà
__undef_LINUX_TYPES_H


53 #ifdeà
__undef_LINUX_LIST_H


54 #undeà
_LINUX_LIST_H


55 #undeà
__undef_LINUX_LIST_H


57 #ifdeà
__undef__LINUX_COMPILER_H


58 #undeà
__LINUX_COMPILER_H


59 #undeà
__u£r


60 #undeà
__undef__LINUX_COMPILER_H


63 
	~<b™s/sysùl.h
>

65 
__BEGIN_DECLS


68 
	$sysùl
 (*
__Çme
, 
__Æ’
, *
__Şdv®
,

69 
size_t
 *
__ŞdËÅ
, *
__Ãwv®
, size_ˆ
__ÃwËn
è
__THROW
;

71 
__END_DECLS


	@/usr/include/sys/time.h

18 #iâdeà
_SYS_TIME_H


19 
	#_SYS_TIME_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	~<b™s/ty³s.h
>

24 
	~<b™s/ty³s/time_t.h
>

25 
	~<b™s/ty³s/¡ruù_timev®.h
>

27 #iâdeà
__su£cÚds_t_defšed


28 
__su£cÚds_t
 
	tsu£cÚds_t
;

29 
	#__su£cÚds_t_defšed


	)

32 
	~<sys/£Ëù.h
>

34 
	g__BEGIN_DECLS


36 #ifdeà
__USE_GNU


38 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

39 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

40 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

41 }

	)

42 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) { \

43 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

44 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

45 }

	)

49 #ifdeà
__USE_MISC


52 
	stimezÚe


54 
	mtz_mšu‹swe¡
;

55 
	mtz_d¡time
;

58 
timezÚe
 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

60 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

68 
	$g‘timeofday
 (
timev®
 *
__»¡riù
 
__tv
,

69 
__timezÚe_±r_t
 
__tz
è
__THROW
 
	`__nÚnuÎ
 ((1));

71 #ifdeà
__USE_MISC


74 
	$£‰imeofday
 (cÚ¡ 
timev®
 *
__tv
,

75 cÚ¡ 
timezÚe
 *
__tz
)

76 
__THROW
;

82 
	$adjtime
 (cÚ¡ 
timev®
 *
__d–
,

83 
timev®
 *
__Şdd–
è
__THROW
;

88 
	e__™im”_which


91 
ITIMER_REAL
 = 0,

92 
	#ITIMER_REAL
 
ITIMER_REAL


	)

94 
ITIMER_VIRTUAL
 = 1,

95 
	#ITIMER_VIRTUAL
 
ITIMER_VIRTUAL


	)

98 
ITIMER_PROF
 = 2

99 
	#ITIMER_PROF
 
ITIMER_PROF


	)

104 
	s™im”v®


107 
timev®
 
™_š‹rv®
;

109 
timev®
 
™_v®ue
;

112 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


115 
__™im”_which
 
	t__™im”_which_t
;

117 
	t__™im”_which_t
;

122 
	$g‘™im”
 (
__™im”_which_t
 
__which
,

123 
™im”v®
 *
__v®ue
è
__THROW
;

128 
	$£t™im”
 (
__™im”_which_t
 
__which
,

129 cÚ¡ 
™im”v®
 *
__»¡riù
 
__Ãw
,

130 
™im”v®
 *
__»¡riù
 
__Şd
è
__THROW
;

135 
	$utimes
 (cÚ¡ *
__fe
, cÚ¡ 
timev®
 
__tvp
[2])

136 
__THROW
 
	`__nÚnuÎ
 ((1));

138 #ifdeà
__USE_MISC


140 
	$lutimes
 (cÚ¡ *
__fe
, cÚ¡ 
timev®
 
__tvp
[2])

141 
__THROW
 
	`__nÚnuÎ
 ((1));

144 
	$futimes
 (
__fd
, cÚ¡ 
timev®
 
__tvp
[2]è
__THROW
;

147 #ifdeà
__USE_GNU


151 
	$futime§t
 (
__fd
, cÚ¡ *
__fe
,

152 cÚ¡ 
timev®
 
__tvp
[2]è
__THROW
;

156 #ifdeà
__USE_MISC


159 
	#tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

160 
	#tim”ş—r
(
tvp
è(Ñvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

161 
	#tim”cmp
(
a
, 
b
, 
CMP
) \

162 (((
a
)->
tv_£c
 =ğ(
b
)->tv_sec) ? \

163 ((
a
)->
tv_u£c
 
	`CMP
 (
b
)->tv_usec) : \

164 ((
a
)->
tv_£c
 
	`CMP
 (
b
)->tv_£c))

	)

165 
	#tim”add
(
a
, 
b
, 
»suÉ
) \

167 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø+ (
b
)->tv_sec; \

168 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø+ (
b
)->tv_usec; \

169 ià((
»suÉ
)->
tv_u£c
 >= 1000000) \

171 ++(
»suÉ
)->
tv_£c
; \

172 (
»suÉ
)->
tv_u£c
 -= 1000000; \

174 
	}
} 0)

	)

175 
	#tim”sub
(
a
, 
b
, 
»suÉ
) \

177 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø- (
b
)->tv_sec; \

178 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø- (
b
)->tv_usec; \

179 ià((
»suÉ
)->
tv_u£c
 < 0) { \

180 --(
»suÉ
)->
tv_£c
; \

181 (
»suÉ
)->
tv_u£c
 += 1000000; \

183 } 0)

	)

186 
	g__END_DECLS


	@/usr/include/sys/types.h

22 #iâdef 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdef 
__USE_MISC


32 #iâdeà
__u_ch¬_defšed


33 
__u_ch¬
 
	tu_ch¬
;

34 
__u_shÜt
 
	tu_shÜt
;

35 
__u_št
 
	tu_št
;

36 
__u_lÚg
 
	tu_lÚg
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¬_defšed


	)

44 
__loff_t
 
	tloff_t
;

46 #iâdeà
__šo_t_defšed


47 #iâdeà
__USE_FILE_OFFSET64


48 
__šo_t
 
	tšo_t
;

50 
__šo64_t
 
	tšo_t
;

52 
	#__šo_t_defšed


	)

54 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


55 
__šo64_t
 
	tšo64_t
;

56 
	#__šo64_t_defšed


	)

59 #iâdeà
__dev_t_defšed


60 
__dev_t
 
	tdev_t
;

61 
	#__dev_t_defšed


	)

64 #iâdeà
__gid_t_defšed


65 
__gid_t
 
	tgid_t
;

66 
	#__gid_t_defšed


	)

69 #iâdeà
__mode_t_defšed


70 
__mode_t
 
	tmode_t
;

71 
	#__mode_t_defšed


	)

74 #iâdeà
__Æšk_t_defšed


75 
__Æšk_t
 
	tÆšk_t
;

76 
	#__Æšk_t_defšed


	)

79 #iâdeà
__uid_t_defšed


80 
__uid_t
 
	tuid_t
;

81 
	#__uid_t_defšed


	)

84 #iâdeà
__off_t_defšed


85 #iâdeà
__USE_FILE_OFFSET64


86 
__off_t
 
	toff_t
;

88 
__off64_t
 
	toff_t
;

90 
	#__off_t_defšed


	)

92 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


93 
__off64_t
 
	toff64_t
;

94 
	#__off64_t_defšed


	)

97 #iâdeà
__pid_t_defšed


98 
__pid_t
 
	tpid_t
;

99 
	#__pid_t_defšed


	)

102 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
) \

103 && !
defšed
 
__id_t_defšed


104 
__id_t
 
	tid_t
;

105 
	#__id_t_defšed


	)

108 #iâdeà
__ssize_t_defšed


109 
__ssize_t
 
	tssize_t
;

110 
	#__ssize_t_defšed


	)

113 #ifdef 
__USE_MISC


114 #iâdeà
__daddr_t_defšed


115 
__daddr_t
 
	tdaddr_t
;

116 
__ÿddr_t
 
	tÿddr_t
;

117 
	#__daddr_t_defšed


	)

121 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


122 
__key_t
 
	tkey_t
;

123 
	#__key_t_defšed


	)

126 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


127 
	~<b™s/ty³s/şock_t.h
>

129 
	~<b™s/ty³s/şockid_t.h
>

130 
	~<b™s/ty³s/time_t.h
>

131 
	~<b™s/ty³s/tim”_t.h
>

133 #ifdeà
__USE_XOPEN


134 #iâdeà
__u£cÚds_t_defšed


135 
__u£cÚds_t
 
	tu£cÚds_t
;

136 
	#__u£cÚds_t_defšed


	)

138 #iâdeà
__su£cÚds_t_defšed


139 
__su£cÚds_t
 
	tsu£cÚds_t
;

140 
	#__su£cÚds_t_defšed


	)

144 
	#__Ãed_size_t


	)

145 
	~<¡ddef.h
>

147 #ifdeà
__USE_MISC


149 
	tulÚg
;

150 
	tushÜt
;

151 
	tušt
;

156 
	~<b™s/¡dšt-šŠ.h
>

158 #ià!
__GNUC_PREREQ
 (2, 7)

161 
	tu_št8_t
;

162 
	tu_št16_t
;

163 
	tu_št32_t
;

164 #ià
__WORDSIZE
 == 64

165 
	tu_št64_t
;

167 
__ex‹nsiÚ__
 
	tu_št64_t
;

170 
	t»gi¡”_t
;

175 
	#__u_štN_t
(
N
, 
MODE
) \

176 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

178 
	t__u_štN_t
 (8, 
	t__QI__
);

179 
__u_štN_t
 (16, 
__HI__
);

180 
__u_štN_t
 (32, 
__SI__
);

181 
__u_štN_t
 (64, 
__DI__
);

183 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

189 
	#__BIT_TYPES_DEFINED__
 1

	)

192 #ifdef 
__USE_MISC


194 
	~<’dŸn.h
>

197 
	~<sys/£Ëù.h
>

204 
	#__SYSMACROS_DEPRECATED_INCLUSION


	)

205 
	~<sys/sysmaüos.h
>

206 #undeà
__SYSMACROS_DEPRECATED_INCLUSION


210 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
) \

211 && !
defšed
 
__blksize_t_defšed


212 
__blksize_t
 
	tblksize_t
;

213 
	#__blksize_t_defšed


	)

217 #iâdeà
__USE_FILE_OFFSET64


218 #iâdeà
__blkút_t_defšed


219 
__blkút_t
 
	tblkút_t
;

220 
	#__blkút_t_defšed


	)

222 #iâdeà
__fsblkút_t_defšed


223 
__fsblkút_t
 
	tfsblkút_t
;

224 
	#__fsblkút_t_defšed


	)

226 #iâdeà
__fsfút_t_defšed


227 
__fsfút_t
 
	tfsfút_t
;

228 
	#__fsfút_t_defšed


	)

231 #iâdeà
__blkút_t_defšed


232 
__blkút64_t
 
	tblkút_t
;

233 
	#__blkút_t_defšed


	)

235 #iâdeà
__fsblkút_t_defšed


236 
__fsblkút64_t
 
	tfsblkút_t
;

237 
	#__fsblkút_t_defšed


	)

239 #iâdeà
__fsfút_t_defšed


240 
__fsfút64_t
 
	tfsfút_t
;

241 
	#__fsfút_t_defšed


	)

245 #ifdeà
__USE_LARGEFILE64


246 
__blkút64_t
 
	tblkút64_t
;

247 
__fsblkút64_t
 
	tfsblkút64_t
;

248 
__fsfút64_t
 
	tfsfút64_t
;

253 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


254 
	~<b™s/±h»adty³s.h
>

257 
	g__END_DECLS


	@/usr/include/sys/uio.h

18 #iâdeà
_SYS_UIO_H


19 
	#_SYS_UIO_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<sys/ty³s.h
>

23 
	~<b™s/ty³s/¡ruù_iovec.h
>

24 
	~<b™s/uio_lim.h
>

25 #ifdeà
__IOV_MAX


26 
	#UIO_MAXIOV
 
__IOV_MAX


	)

28 #undeà
UIO_MAXIOV


31 
__BEGIN_DECLS


41 
ssize_t
 
	$»adv
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
)

42 
__wur
;

52 
ssize_t
 
	$wr™ev
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
)

53 
__wur
;

56 #ifdeà
__USE_MISC


57 #iâdeà
__USE_FILE_OFFSET64


67 
ssize_t
 
	$´—dv
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

68 
__off_t
 
__off£t
è
__wur
;

79 
ssize_t
 
	$pwr™ev
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

80 
__off_t
 
__off£t
è
__wur
;

83 #ifdeà
__REDIRECT


84 
ssize_t
 
	`__REDIRECT
 (
´—dv
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

85 
__couÁ
, 
__off64_t
 
__off£t
),

86 
´—dv64
è
__wur
;

87 
ssize_t
 
	`__REDIRECT
 (
pwr™ev
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

88 
__couÁ
, 
__off64_t
 
__off£t
),

89 
pwr™ev64
è
__wur
;

91 
	#´—dv
 
´—dv64


	)

92 
	#pwr™ev
 
pwr™ev64


	)

96 #ifdeà
__USE_LARGEFILE64


106 
ssize_t
 
	$´—dv64
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

107 
__off64_t
 
__off£t
è
__wur
;

118 
ssize_t
 
	$pwr™ev64
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

119 
__off64_t
 
__off£t
è
__wur
;

124 #ifdeà
__USE_GNU


125 #iâdeà
__USE_FILE_OFFSET64


127 
ssize_t
 
	$´—dv2
 (
__å
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

128 
__off_t
 
__off£t
, 
___æags
è
__wur
;

131 
ssize_t
 
	$pwr™ev2
 (
__fd
, cÚ¡ 
iovec
 *
__iodev
, 
__couÁ
,

132 
__off_t
 
__off£t
, 
__æags
è
__wur
;

135 #ifdeà
__REDIRECT


136 
ssize_t
 
	`__REDIRECT
 (
pwr™ev2
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

137 
__couÁ
, 
__off64_t
 
__off£t
,

138 
__æags
),

139 
pwr™ev64v2
è
__wur
;

140 
ssize_t
 
	`__REDIRECT
 (
´—dv2
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

141 
__couÁ
, 
__off64_t
 
__off£t
,

142 
__æags
),

143 
´—dv64v2
è
__wur
;

145 
	#´—dv2
 
´—dv64v2


	)

146 
	#pwr™ev2
 
pwr™ev64v2


	)

150 #ifdeà
__USE_LARGEFILE64


152 
ssize_t
 
	$´—dv64v2
 (
__å
, cÚ¡ 
iovec
 *
__iovec
,

153 
__couÁ
, 
__off64_t
 
__off£t
,

154 
___æags
è
__wur
;

157 
ssize_t
 
	$pwr™ev64v2
 (
__fd
, cÚ¡ 
iovec
 *
__iodev
,

158 
__couÁ
, 
__off64_t
 
__off£t
,

159 
__æags
è
__wur
;

163 
__END_DECLS


167 #ifdeà
__USE_GNU


168 
	~<b™s/uio-ext.h
>

	@/usr/include/sys/un.h

18 #iâdef 
_SYS_UN_H


19 
	#_SYS_UN_H
 1

	)

21 
	~<sys/cdefs.h
>

24 
	~<b™s/sockaddr.h
>

26 
__BEGIN_DECLS


29 
	ssockaddr_un


31 
__SOCKADDR_COMMON
 (
sun_
);

32 
	msun_·th
[108];

36 #ifdeà
__USE_MISC


37 
	~<¡ršg.h
>

40 
	#SUN_LEN
(
±r
è((
size_t
è(((
sockaddr_un
 *è0)->
sun_·th
) \

41 + 
	`¡¾’
 ((
±r
)->
sun_·th
))

	)

44 
	g__END_DECLS


	@/usr/include/sys/utsname.h

22 #iâdef 
_SYS_UTSNAME_H


23 
	#_SYS_UTSNAME_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ut¢ame.h
>

31 #iâdeà
_UTSNAME_SYSNAME_LENGTH


32 
	#_UTSNAME_SYSNAME_LENGTH
 
_UTSNAME_LENGTH


	)

34 #iâdeà
_UTSNAME_NODENAME_LENGTH


35 
	#_UTSNAME_NODENAME_LENGTH
 
_UTSNAME_LENGTH


	)

37 #iâdeà
_UTSNAME_RELEASE_LENGTH


38 
	#_UTSNAME_RELEASE_LENGTH
 
_UTSNAME_LENGTH


	)

40 #iâdeà
_UTSNAME_VERSION_LENGTH


41 
	#_UTSNAME_VERSION_LENGTH
 
_UTSNAME_LENGTH


	)

43 #iâdeà
_UTSNAME_MACHINE_LENGTH


44 
	#_UTSNAME_MACHINE_LENGTH
 
_UTSNAME_LENGTH


	)

48 
	sut¢ame


51 
	msy¢ame
[
_UTSNAME_SYSNAME_LENGTH
];

54 
	mnod’ame
[
_UTSNAME_NODENAME_LENGTH
];

57 
	m»Ëa£
[
_UTSNAME_RELEASE_LENGTH
];

59 
	mv”siÚ
[
_UTSNAME_VERSION_LENGTH
];

62 
	mmachše
[
_UTSNAME_MACHINE_LENGTH
];

64 #ià
_UTSNAME_DOMAIN_LENGTH
 - 0

66 #ifdeà
__USE_GNU


67 
	mdomašÇme
[
_UTSNAME_DOMAIN_LENGTH
];

69 
	m__domašÇme
[
_UTSNAME_DOMAIN_LENGTH
];

74 #ifdeà
__USE_MISC


76 
	#SYS_NMLN
 
_UTSNAME_LENGTH


	)

81 
	$uÇme
 (
ut¢ame
 *
__Çme
è
__THROW
;

84 
__END_DECLS


	@/usr/include/sys/wait.h

22 #iâdef 
_SYS_WAIT_H


23 
	#_SYS_WAIT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

30 #iâdeà
__pid_t_defšed


31 
__pid_t
 
	tpid_t
;

32 
	#__pid_t_defšed


	)

35 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


36 
	~<sigÇl.h
>

39 #ià
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8


42 
	~<b™s/ty³s/¡ruù_ru§ge.h
>

46 #ià!
defšed
 
_STDLIB_H
 || (!defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K8
)

49 
	~<b™s/wa™æags.h
>

52 
	~<b™s/wa™¡©us.h
>

54 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (¡©us)

	)

55 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (¡©us)

	)

56 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (¡©us)

	)

57 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (¡©us)

	)

58 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (¡©us)

	)

59 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (¡©us)

	)

60 #ifdeà
__WIFCONTINUED


61 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (¡©us)

	)

65 #ifdef 
__USE_MISC


66 
	#WCOREFLAG
 
__WCOREFLAG


	)

67 
	#WCOREDUMP
(
¡©us
è
	`__WCOREDUMP
 (¡©us)

	)

68 
	#W_EXITCODE
(
»t
, 
sig
è
	`__W_EXITCODE
 (»t, sig)

	)

69 
	#W_STOPCODE
(
sig
è
	`__W_STOPCODE
 (sig)

	)

77 
__pid_t
 
wa™
 (*
__¡©_loc
);

79 #ifdef 
__USE_MISC


81 
	#WAIT_ANY
 (-1è

	)

82 
	#WAIT_MYPGRP
 0

	)

100 
__pid_t
 
wa™pid
 (__pid_ˆ
__pid
, *
__¡©_loc
, 
__İtiÚs
);

102 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


103 #iâdeà
__id_t_defšed


104 
__id_t
 
	tid_t
;

105 
	#__id_t_defšed


	)

108 
	~<b™s/ty³s/sigšfo_t.h
>

121 
wa™id
 (
idty³_t
 
__idty³
, 
__id_t
 
__id
, 
sigšfo_t
 *
__šfİ
,

122 
__İtiÚs
);

125 #ià
defšed
 
__USE_MISC
 \

126 || (
defšed
 
	g__USE_XOPEN_EXTENDED
 && !defšed 
	g__USE_XOPEN2K
)

129 
	gru§ge
;

136 
__pid_t
 
	$wa™3
 (*
__¡©_loc
, 
__İtiÚs
,

137 
ru§ge
 * 
__u§ge
è
__THROWNL
;

140 #ifdeà
__USE_MISC


142 
__pid_t
 
	$wa™4
 (
__pid_t
 
__pid
, *
__¡©_loc
, 
__İtiÚs
,

143 
ru§ge
 *
__u§ge
è
__THROWNL
;

147 
__END_DECLS


	@/usr/include/syslog.h

1 
	~<sys/sy¦og.h
>

	@/usr/include/termios.h

22 #iâdef 
_TERMIOS_H


23 
	#_TERMIOS_H
 1

	)

25 
	~<ã©u»s.h
>

26 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


28 
	~<b™s/ty³s.h
>

29 #iâdeà
__pid_t_defšed


30 
__pid_t
 
	tpid_t
;

31 
	#__pid_t_defšed


	)

35 
	g__BEGIN_DECLS


39 
	~<b™s/‹rmios.h
>

41 #ifdeà
__USE_MISC


44 
	#CCEQ
(
v®
, 
c
è((cè=ğ(v®è&& (v®è!ğ
_POSIX_VDISABLE
)

	)

48 
¥“d_t
 
	$cfg‘o¥“d
 (cÚ¡ 
‹rmios
 *
__‹rmios_p
è
__THROW
;

51 
¥“d_t
 
	$cfg‘i¥“d
 (cÚ¡ 
‹rmios
 *
__‹rmios_p
è
__THROW
;

54 
	$cf£to¥“d
 (
‹rmios
 *
__‹rmios_p
, 
¥“d_t
 
__¥“d
è
__THROW
;

57 
	$cf£ti¥“d
 (
‹rmios
 *
__‹rmios_p
, 
¥“d_t
 
__¥“d
è
__THROW
;

59 #ifdef 
__USE_MISC


61 
	$cf£t¥“d
 (
‹rmios
 *
__‹rmios_p
, 
¥“d_t
 
__¥“d
è
__THROW
;

66 
	$tcg‘©Œ
 (
__fd
, 
‹rmios
 *
__‹rmios_p
è
__THROW
;

70 
	$tc£‰r
 (
__fd
, 
__İtiÚ®_aùiÚs
,

71 cÚ¡ 
‹rmios
 *
__‹rmios_p
è
__THROW
;

74 #ifdef 
__USE_MISC


76 
	$cfmak”aw
 (
‹rmios
 *
__‹rmios_p
è
__THROW
;

80 
	$tc£ndb»ak
 (
__fd
, 
__du¿tiÚ
è
__THROW
;

86 
	`tcd¿š
 (
__fd
);

90 
	$tcæush
 (
__fd
, 
__queue_£ËùÜ
è
__THROW
;

94 
	$tcæow
 (
__fd
, 
__aùiÚ
è
__THROW
;

97 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


99 
__pid_t
 
	$tcg‘sid
 (
__fd
è
__THROW
;

103 #ifdeà
__USE_MISC


104 
	~<sys/‰ydeçuÉs.h
>

107 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


23 
	#_TIME_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

33 
	~<b™s/time.h
>

37 
	~<b™s/ty³s/şock_t.h
>

38 
	~<b™s/ty³s/time_t.h
>

39 
	~<b™s/ty³s/¡ruù_tm.h
>

41 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_ISOC11


42 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

45 #ifdeà
__USE_POSIX199309


46 
	~<b™s/ty³s/şockid_t.h
>

47 
	~<b™s/ty³s/tim”_t.h
>

48 
	~<b™s/ty³s/¡ruù_™im”¥ec.h
>

49 
	gsigev’t
;

52 #ifdeà
__USE_XOPEN2K


53 #iâdeà
__pid_t_defšed


54 
__pid_t
 
	tpid_t
;

55 
	#__pid_t_defšed


	)

59 #ifdeà
__USE_XOPEN2K8


60 
	~<b™s/ty³s/loÿË_t.h
>

63 #ifdeà
__USE_ISOC11


65 
	#TIME_UTC
 1

	)

68 
__BEGIN_DECLS


72 
şock_t
 
	$şock
 (è
__THROW
;

75 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

78 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

79 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

82 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

88 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

89 cÚ¡ *
__»¡riù
 
__fÜm©
,

90 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

92 #ifdeà
__USE_XOPEN


95 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

96 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

97 
__THROW
;

100 #ifdeà
__USE_XOPEN2K8


104 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

105 cÚ¡ *
__»¡riù
 
__fÜm©
,

106 cÚ¡ 
tm
 *
__»¡riù
 
__
,

107 
loÿË_t
 
__loc
è
__THROW
;

110 #ifdeà
__USE_GNU


111 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

112 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

113 
loÿË_t
 
__loc
è
__THROW
;

119 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

123 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

125 #ifdeà
__USE_POSIX


128 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

129 
tm
 *
__»¡riù
 
__
è
__THROW
;

133 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

134 
tm
 *
__»¡riù
 
__
è
__THROW
;

139 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

142 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

144 #ifdeà
__USE_POSIX


149 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

150 *
__»¡riù
 
__buf
è
__THROW
;

153 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

154 *
__»¡riù
 
__buf
è
__THROW
;

159 *
__tzÇme
[2];

160 
__daylight
;

161 
__timezÚe
;

164 #ifdef 
__USE_POSIX


166 *
tzÇme
[2];

170 
	$tz£t
 (è
__THROW
;

173 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


174 
daylight
;

175 
timezÚe
;

178 #ifdeà
__USE_MISC


181 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

187 
	#__i¦—p
(
y—r
) \

188 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

191 #ifdeà
__USE_MISC


196 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

199 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

202 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

206 #ifdeà
__USE_POSIX199309


211 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

212 
time¥ec
 *
__»maššg
);

216 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

219 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

222 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

223 
__THROW
;

225 #ifdeà
__USE_XOPEN2K


230 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

231 cÚ¡ 
time¥ec
 *
__»q
,

232 
time¥ec
 *
__»m
);

235 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

240 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

241 
sigev’t
 *
__»¡riù
 
__evp
,

242 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

245 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

248 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

249 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

250 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

253 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

254 
__THROW
;

257 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

261 #ifdeà
__USE_ISOC11


263 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

264 
__THROW
 
	`__nÚnuÎ
 ((1));

268 #ifdeà
__USE_XOPEN_EXTENDED


280 
g‘d©e_”r
;

289 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

292 #ifdeà
__USE_GNU


303 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

304 
tm
 *
__»¡riù
 
__»sbuå
);

307 
__END_DECLS


	@/usr/include/ucontext.h

20 #iâdeà
_UCONTEXT_H


21 
	#_UCONTEXT_H
 1

	)

23 
	~<ã©u»s.h
>

26 
	~<sys/ucÚ‹xt.h
>

28 
__BEGIN_DECLS


31 
	$g‘cÚ‹xt
 (
ucÚ‹xt_t
 *
__uı
è
__THROWNL
;

34 
	$£tcÚ‹xt
 (cÚ¡ 
ucÚ‹xt_t
 *
__uı
è
__THROWNL
;

38 
	$sw­cÚ‹xt
 (
ucÚ‹xt_t
 *
__»¡riù
 
__ouı
,

39 cÚ¡ 
ucÚ‹xt_t
 *
__»¡riù
 
__uı
è
__THROWNL
;

47 
	$makecÚ‹xt
 (
ucÚ‹xt_t
 *
__uı
, (*
__func
) (),

48 
__¬gc
, ...è
__THROW
;

50 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifdeà
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #–ià
defšed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #–ià
defšed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

111 
	#_XOPEN_CRYPT
 1

	)

115 
	#_XOPEN_ENH_I18N
 1

	)

118 
	#_XOPEN_LEGACY
 1

	)

205 
	~<b™s/posix_İt.h
>

208 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


209 
	~<b™s/’vœÚm’ts.h
>

213 
	#STDIN_FILENO
 0

	)

214 
	#STDOUT_FILENO
 1

	)

215 
	#STDERR_FILENO
 2

	)

220 
	~<b™s/ty³s.h
>

222 #iâdef 
__ssize_t_defšed


223 
__ssize_t
 
	tssize_t
;

224 
	#__ssize_t_defšed


	)

227 
	#__Ãed_size_t


	)

228 
	#__Ãed_NULL


	)

229 
	~<¡ddef.h
>

231 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


234 #iâdeà
__gid_t_defšed


235 
__gid_t
 
	tgid_t
;

236 
	#__gid_t_defšed


	)

239 #iâdeà
__uid_t_defšed


240 
__uid_t
 
	tuid_t
;

241 
	#__uid_t_defšed


	)

244 #iâdeà
__off_t_defšed


245 #iâdeà
__USE_FILE_OFFSET64


246 
__off_t
 
	toff_t
;

248 
__off64_t
 
	toff_t
;

250 
	#__off_t_defšed


	)

252 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


253 
__off64_t
 
	toff64_t
;

254 
	#__off64_t_defšed


	)

257 #iâdeà
__u£cÚds_t_defšed


258 
__u£cÚds_t
 
	tu£cÚds_t
;

259 
	#__u£cÚds_t_defšed


	)

262 #iâdeà
__pid_t_defšed


263 
__pid_t
 
	tpid_t
;

264 
	#__pid_t_defšed


	)

268 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


269 #iâdeà
__šŒ_t_defšed


270 
__šŒ_t
 
	tšŒ_t
;

271 
	#__šŒ_t_defšed


	)

275 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


276 #iâdeà
__sockËn_t_defšed


277 
__sockËn_t
 
	tsockËn_t
;

278 
	#__sockËn_t_defšed


	)

284 
	#R_OK
 4

	)

285 
	#W_OK
 2

	)

286 
	#X_OK
 1

	)

287 
	#F_OK
 0

	)

290 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

292 #ifdeà
__USE_GNU


295 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

296 
__THROW
 
	`__nÚnuÎ
 ((1));

299 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

300 
__THROW
 
	`__nÚnuÎ
 ((1));

303 #ifdeà
__USE_ATFILE


307 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

308 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

313 #iâdef 
_STDIO_H


314 
	#SEEK_SET
 0

	)

315 
	#SEEK_CUR
 1

	)

316 
	#SEEK_END
 2

	)

317 #ifdeà
__USE_GNU


318 
	#SEEK_DATA
 3

	)

319 
	#SEEK_HOLE
 4

	)

323 #ià
defšed
 
__USE_MISC
 && !defšed 
L_SET


325 
	#L_SET
 
SEEK_SET


	)

326 
	#L_INCR
 
SEEK_CUR


	)

327 
	#L_XTND
 
SEEK_END


	)

336 #iâdeà
__USE_FILE_OFFSET64


337 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

339 #ifdeà
__REDIRECT_NTH


340 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

341 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

342 
l£ek64
);

344 
	#l£ek
 
l£ek64


	)

347 #ifdeà
__USE_LARGEFILE64


348 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

349 
__THROW
;

356 
	`şo£
 (
__fd
);

363 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

369 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

371 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


372 #iâdeà
__USE_FILE_OFFSET64


379 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

380 
__off_t
 
__off£t
è
__wur
;

387 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

388 
__off_t
 
__off£t
è
__wur
;

390 #ifdeà
__REDIRECT


391 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

392 
__off64_t
 
__off£t
),

393 
´—d64
è
__wur
;

394 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

395 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

396 
pwr™e64
è
__wur
;

398 
	#´—d
 
´—d64


	)

399 
	#pwr™e
 
pwr™e64


	)

403 #ifdeà
__USE_LARGEFILE64


407 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

408 
__off64_t
 
__off£t
è
__wur
;

411 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

412 
__off64_t
 
__off£t
è
__wur
;

420 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

422 #ifdeà
__USE_GNU


425 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

435 
	$®¬m
 (
__£cÚds
è
__THROW
;

447 
	`¦“p
 (
__£cÚds
);

449 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

450 || 
defšed
 
__USE_MISC


455 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

456 
__THROW
;

463 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

472 
	`·u£
 ();

476 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

477 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

479 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


481 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

486 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

487 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

491 #ifdeà
__USE_ATFILE


494 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

495 
__gid_t
 
__group
, 
__æag
)

496 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

500 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

502 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


504 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

514 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

516 #ifdef 
__USE_GNU


520 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

523 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

524 || 
defšed
 
__USE_MISC


528 *
	$g‘wd
 (*
__buf
)

529 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

534 
	$dup
 (
__fd
è
__THROW
 
__wur
;

537 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

539 #ifdeà
__USE_GNU


542 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

546 **
__’vœÚ
;

547 #ifdeà
__USE_GNU


548 **
’vœÚ
;

554 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

555 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

557 #ifdeà
__USE_XOPEN2K8


560 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

561 
__THROW
 
	`__nÚnuÎ
 ((2));

566 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

567 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

571 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

572 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

576 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

577 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

581 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

582 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

588 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

590 #ifdeà
__USE_GNU


593 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

594 *cÚ¡ 
__’vp
[])

595 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

599 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


601 
	$niû
 (
__šc
è
__THROW
 
__wur
;

606 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

612 
	~<b™s/cÚâame.h
>

615 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

616 
__THROW
 
	`__nÚnuÎ
 ((1));

619 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

622 
	$syscÚf
 (
__Çme
è
__THROW
;

624 #ifdef 
__USE_POSIX2


626 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

631 
__pid_t
 
	$g‘pid
 (è
__THROW
;

634 
__pid_t
 
	$g‘µid
 (è
__THROW
;

637 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

640 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

641 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


642 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

649 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

651 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


663 
	$£g½
 (è
__THROW
;

670 
__pid_t
 
	$£tsid
 (è
__THROW
;

672 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


674 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

678 
__uid_t
 
	$g‘uid
 (è
__THROW
;

681 
__uid_t
 
	$g‘euid
 (è
__THROW
;

684 
__gid_t
 
	$g‘gid
 (è
__THROW
;

687 
__gid_t
 
	$g‘egid
 (è
__THROW
;

692 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

694 #ifdef 
__USE_GNU


696 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

703 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

705 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


708 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

711 #ifdeà
__USE_XOPEN2K


713 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

720 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

722 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


725 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

728 #ifdeà
__USE_XOPEN2K


730 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

733 #ifdeà
__USE_GNU


736 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

737 
__THROW
;

741 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

742 
__THROW
;

746 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

747 
__THROW
 
__wur
;

751 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

752 
__THROW
 
__wur
;

759 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

761 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

762 || 
defšed
 
__USE_MISC


767 
__pid_t
 
	$vfÜk
 (è
__THROW
;

773 *
	$‰yÇme
 (
__fd
è
__THROW
;

777 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

778 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

782 
	$i§‰y
 (
__fd
è
__THROW
;

784 #ifdeà
__USE_MISC


787 
	$‰y¦Ù
 (è
__THROW
;

792 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

793 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

795 #ifdeà
__USE_ATFILE


798 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

799 cÚ¡ *
__to
, 
__æags
)

800 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

803 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


805 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

806 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

811 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

812 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

813 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

816 #ifdeà
__USE_ATFILE


818 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

819 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

822 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

823 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

824 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

828 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

830 #ifdeà
__USE_ATFILE


832 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

833 
__THROW
 
	`__nÚnuÎ
 ((2));

837 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

841 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

844 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

851 *
	`g‘logš
 ();

852 #ifdeà
__USE_POSIX199506


859 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

862 #ifdef 
__USE_MISC


864 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

868 #ifdef 
__USE_POSIX2


872 
	~<b™s/g‘İt_posix.h
>

876 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


880 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

884 #ià
defšed
 
__USE_MISC


887 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

888 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

898 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

899 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

900 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

901 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

907 
	$vhªgup
 (è
__THROW
;

910 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

918 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

919 
size_t
 
__off£t
, 
__sÿË
)

920 
__THROW
 
	`__nÚnuÎ
 ((1));

926 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

930 *
	$g‘u£rsh–l
 (è
__THROW
;

931 
	$’du£rsh–l
 (è
__THROW
;

932 
	$£tu£rsh–l
 (è
__THROW
;

938 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

942 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

945 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

949 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

957 
	`fsync
 (
__fd
);

960 #ifdeà
__USE_GNU


963 
	$syncfs
 (
__fd
è
__THROW
;

967 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


970 
	`g‘ho¡id
 ();

973 
	$sync
 (è
__THROW
;

976 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K


979 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

984 
	$g‘dbËsize
 (è
__THROW
;

990 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


993 #iâdeà
__USE_FILE_OFFSET64


994 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

995 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

997 #ifdeà
__REDIRECT_NTH


998 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

999 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

1000 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1002 
	#Œunÿ‹
 
Œunÿ‹64


	)

1005 #ifdeà
__USE_LARGEFILE64


1006 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1007 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1012 #ià
defšed
 
__USE_POSIX199309
 \

1013 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1016 #iâdeà
__USE_FILE_OFFSET64


1017 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1019 #ifdeà
__REDIRECT_NTH


1020 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1021 
árunÿ‹64
è
__wur
;

1023 
	#árunÿ‹
 
árunÿ‹64


	)

1026 #ifdeà
__USE_LARGEFILE64


1027 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1033 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1034 || 
defšed
 
__USE_MISC


1038 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1044 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1048 #ifdeà
__USE_MISC


1059 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1064 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1076 
	#F_ULOCK
 0

	)

1077 
	#F_LOCK
 1

	)

1078 
	#F_TLOCK
 2

	)

1079 
	#F_TEST
 3

	)

1081 #iâdeà
__USE_FILE_OFFSET64


1082 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1084 #ifdeà
__REDIRECT


1085 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1086 
lockf64
è
__wur
;

1088 
	#lockf
 
lockf64


	)

1091 #ifdeà
__USE_LARGEFILE64


1092 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1097 #ifdeà
__USE_GNU


1102 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1103 (
__ex‹nsiÚ__
 \

1104 ({ 
__»suÉ
; \

1105 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1106 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1107 
__»suÉ
; 
	}
}))

	)

1110 
ssize_t
 
cİy_fe_¿nge
 (
__šfd
, 
__off64_t
 *
__pšoff
,

1111 
__outfd
, 
__off64_t
 *
__poutoff
,

1112 
size_t
 
__Ëngth
, 
__æags
);

1115 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1118 
fd©async
 (
__fdes
);

1124 #ifdef 
__USE_XOPEN


1126 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1127 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1131 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1132 
__THROW
 
	`__nÚnuÎ
 ((1));

1139 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1140 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1147 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1149 *
	$ù”mid
 (*
__s
è
__THROW
;

1152 *
	`cu£rid
 (*
__s
);

1158 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_XOPEN2K


1159 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1160 (*
__·»Á
) (),

1161 (*
__chd
è()è
__THROW
;

1164 #ifdeà
__USE_MISC


1167 
	$g‘’Œİy
 (*
__bufãr
, 
size_t
 
__Ëngth
è
__wur
;

1171 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1172 
	~<b™s/uni¡d.h
>

1175 
__END_DECLS


	@/usr/include/valgrind/memcheck.h

60 #iâdeà
__MEMCHECK_H


61 
	#__MEMCHECK_H


	)

72 
	~"v®gršd.h
"

80 
	mVG_USERREQ__MAKE_MEM_NOACCESS
 = 
VG_USERREQ_TOOL_BASE
('M','C'),

81 
	mVG_USERREQ__MAKE_MEM_UNDEFINED
,

82 
	mVG_USERREQ__MAKE_MEM_DEFINED
,

83 
	mVG_USERREQ__DISCARD
,

84 
	mVG_USERREQ__CHECK_MEM_IS_ADDRESSABLE
,

85 
	mVG_USERREQ__CHECK_MEM_IS_DEFINED
,

86 
	mVG_USERREQ__DO_LEAK_CHECK
,

87 
	mVG_USERREQ__COUNT_LEAKS
,

89 
	mVG_USERREQ__GET_VBITS
,

90 
	mVG_USERREQ__SET_VBITS
,

92 
	mVG_USERREQ__CREATE_BLOCK
,

94 
	mVG_USERREQ__MAKE_MEM_DEFINED_IF_ADDRESSABLE
,

97 
	mVG_USERREQ__COUNT_LEAK_BLOCKS
,

99 
	mVG_USERREQ__ENABLE_ADDR_ERROR_REPORTING_IN_RANGE
,

100 
	mVG_USERREQ__DISABLE_ADDR_ERROR_REPORTING_IN_RANGE
,

103 
	m_VG_USERREQ__MEMCHECK_RECORD_OVERLAP_ERROR


104 ğ
VG_USERREQ_TOOL_BASE
('M','C') + 256

105 } 
	tVg_MemCheckCl›ÁReque¡
;

112 
	#VALGRIND_MAKE_MEM_NOACCESS
(
_qzz_addr
,
_qzz_Ën
) \

113 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

114 
VG_USERREQ__MAKE_MEM_NOACCESS
, \

115 (
_qzz_addr
), (
_qzz_Ën
), 0, 0, 0)

	)

119 
	#VALGRIND_MAKE_MEM_UNDEFINED
(
_qzz_addr
,
_qzz_Ën
) \

120 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

121 
VG_USERREQ__MAKE_MEM_UNDEFINED
, \

122 (
_qzz_addr
), (
_qzz_Ën
), 0, 0, 0)

	)

126 
	#VALGRIND_MAKE_MEM_DEFINED
(
_qzz_addr
,
_qzz_Ën
) \

127 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

128 
VG_USERREQ__MAKE_MEM_DEFINED
, \

129 (
_qzz_addr
), (
_qzz_Ën
), 0, 0, 0)

	)

134 
	#VALGRIND_MAKE_MEM_DEFINED_IF_ADDRESSABLE
(
_qzz_addr
,
_qzz_Ën
) \

135 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

136 
VG_USERREQ__MAKE_MEM_DEFINED_IF_ADDRESSABLE
, \

137 (
_qzz_addr
), (
_qzz_Ën
), 0, 0, 0)

	)

143 
	#VALGRIND_CREATE_BLOCK
(
_qzz_addr
,
_qzz_Ën
, 
_qzz_desc
) \

144 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

145 
VG_USERREQ__CREATE_BLOCK
, \

146 (
_qzz_addr
), (
_qzz_Ën
), (
_qzz_desc
), \

147 0, 0)

	)

151 
	#VALGRIND_DISCARD
(
_qzz_blkšdex
) \

152 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

153 
VG_USERREQ__DISCARD
, \

154 0, (
_qzz_blkšdex
), 0, 0, 0)

	)

163 
	#VALGRIND_CHECK_MEM_IS_ADDRESSABLE
(
_qzz_addr
,
_qzz_Ën
) \

164 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

165 
VG_USERREQ__CHECK_MEM_IS_ADDRESSABLE
, \

166 (
_qzz_addr
), (
_qzz_Ën
), 0, 0, 0)

	)

172 
	#VALGRIND_CHECK_MEM_IS_DEFINED
(
_qzz_addr
,
_qzz_Ën
) \

173 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

174 
VG_USERREQ__CHECK_MEM_IS_DEFINED
, \

175 (
_qzz_addr
), (
_qzz_Ën
), 0, 0, 0)

	)

182 
	#VALGRIND_CHECK_VALUE_IS_DEFINED
(
__lv®ue
) \

183 
	`VALGRIND_CHECK_MEM_IS_DEFINED
( \

184 (vŞ©*)&(
__lv®ue
), \

185 ()( (
__lv®ue
)))

	)

189 
	#VALGRIND_DO_LEAK_CHECK
 \

190 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__DO_LEAK_CHECK
, \

191 0, 0, 0, 0, 0)

	)

196 
	#VALGRIND_DO_ADDED_LEAK_CHECK
 \

197 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__DO_LEAK_CHECK
, \

198 0, 1, 0, 0, 0)

	)

203 
	#VALGRIND_DO_CHANGED_LEAK_CHECK
 \

204 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__DO_LEAK_CHECK
, \

205 0, 2, 0, 0, 0)

	)

208 
	#VALGRIND_DO_QUICK_LEAK_CHECK
 \

209 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__DO_LEAK_CHECK
, \

210 1, 0, 0, 0, 0)

	)

214 
	#VALGRIND_COUNT_LEAKS
(
Ëaked
, 
dubious
, 
»achabË
, 
suµ»s£d
) \

222 
_qzz_Ëaked
 = 0, 
_qzz_dubious
 = 0; \

223 
_qzz_»achabË
 = 0, 
_qzz_suµ»s£d
 = 0; \

224 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
( \

225 
VG_USERREQ__COUNT_LEAKS
, \

226 &
_qzz_Ëaked
, &
_qzz_dubious
, \

227 &
_qzz_»achabË
, &
_qzz_suµ»s£d
, 0); \

228 
Ëaked
 = 
_qzz_Ëaked
; \

229 
dubious
 = 
_qzz_dubious
; \

230 
»achabË
 = 
_qzz_»achabË
; \

231 
suµ»s£d
 = 
_qzz_suµ»s£d
; \

232 }

	)

236 
	#VALGRIND_COUNT_LEAK_BLOCKS
(
Ëaked
, 
dubious
, 
»achabË
, 
suµ»s£d
) \

244 
_qzz_Ëaked
 = 0, 
_qzz_dubious
 = 0; \

245 
_qzz_»achabË
 = 0, 
_qzz_suµ»s£d
 = 0; \

246 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
( \

247 
VG_USERREQ__COUNT_LEAK_BLOCKS
, \

248 &
_qzz_Ëaked
, &
_qzz_dubious
, \

249 &
_qzz_»achabË
, &
_qzz_suµ»s£d
, 0); \

250 
Ëaked
 = 
_qzz_Ëaked
; \

251 
dubious
 = 
_qzz_dubious
; \

252 
»achabË
 = 
_qzz_»achabË
; \

253 
suµ»s£d
 = 
_qzz_suµ»s£d
; \

254 }

	)

266 
	#VALGRIND_GET_VBITS
(
zza
,
zzvb™s
,
zznby‹s
) \

267 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

268 
VG_USERREQ__GET_VBITS
, \

269 (cÚ¡ *)(
zza
), \

270 (*)(
zzvb™s
), \

271 (
zznby‹s
), 0, 0)

	)

282 
	#VALGRIND_SET_VBITS
(
zza
,
zzvb™s
,
zznby‹s
) \

283 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

284 
VG_USERREQ__SET_VBITS
, \

285 (cÚ¡ *)(
zza
), \

286 (cÚ¡ *)(
zzvb™s
), \

287 (
zznby‹s
), 0, 0 )

	)

291 
	#VALGRIND_DISABLE_ADDR_ERROR_REPORTING_IN_RANGE
(
_qzz_addr
,
_qzz_Ën
) \

292 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

293 
VG_USERREQ__DISABLE_ADDR_ERROR_REPORTING_IN_RANGE
, \

294 (
_qzz_addr
), (
_qzz_Ën
), 0, 0, 0)

	)

296 
	#VALGRIND_ENABLE_ADDR_ERROR_REPORTING_IN_RANGE
(
_qzz_addr
,
_qzz_Ën
) \

297 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

298 
VG_USERREQ__ENABLE_ADDR_ERROR_REPORTING_IN_RANGE
, \

299 (
_qzz_addr
), (
_qzz_Ën
), 0, 0, 0)

	)

	@/usr/include/valgrind/valgrind.h

73 #iâdeà
__VALGRIND_H


74 
	#__VALGRIND_H


	)

91 
	#__VALGRIND_MAJOR__
 3

	)

92 
	#__VALGRIND_MINOR__
 13

	)

95 
	~<¡d¬g.h
>

111 #undeà
PLAT_x86_d¬wš


112 #undeà
PLAT_amd64_d¬wš


113 #undeà
PLAT_x86_wš32


114 #undeà
PLAT_amd64_wš64


115 #undeà
PLAT_x86_lšux


116 #undeà
PLAT_amd64_lšux


117 #undeà
PLAT_µc32_lšux


118 #undeà
PLAT_µc64be_lšux


119 #undeà
PLAT_µc64Ë_lšux


120 #undeà
PLAT_¬m_lšux


121 #undeà
PLAT_¬m64_lšux


122 #undeà
PLAT_s390x_lšux


123 #undeà
PLAT_ms32_lšux


124 #undeà
PLAT_ms64_lšux


125 #undeà
PLAT_x86_sŞ¬is


126 #undeà
PLAT_amd64_sŞ¬is


129 #ià
defšed
(
__APPLE__
è&& defšed(
__i386__
)

130 
	#PLAT_x86_d¬wš
 1

	)

131 #–ià
defšed
(
__APPLE__
è&& defšed(
__x86_64__
)

132 
	#PLAT_amd64_d¬wš
 1

	)

133 #–ià(
defšed
(
__MINGW32__
è&& !defšed(
__MINGW64__
)) \

134 || 
defšed
(
__CYGWIN32__
) \

135 || (
defšed
(
_WIN32
è&& 
	$defšed
(
_M_IX86
))

136 
	#PLAT_x86_wš32
 1

	)

137 #–ià
	`defšed
(
__MINGW64__
) \

138 || (
	`defšed
(
_WIN64
è&& 
	$defšed
(
_M_X64
))

139 
	#PLAT_amd64_wš64
 1

	)

140 #–ià
	`defšed
(
__lšux__
è&& defšed(
__i386__
)

141 
	#PLAT_x86_lšux
 1

	)

142 #–ià
	`defšed
(
__lšux__
è&& defšed(
__x86_64__
è&& !defšed(
__ILP32__
)

143 
	#PLAT_amd64_lšux
 1

	)

144 #–ià
	`defšed
(
__lšux__
è&& defšed(
__pow”pc__
è&& !defšed(
__pow”pc64__
)

145 
	#PLAT_µc32_lšux
 1

	)

146 #–ià
	`defšed
(
__lšux__
è&& defšed(
__pow”pc__
è&& defšed(
__pow”pc64__
è&& 
_CALL_ELF
 != 2

148 
	#PLAT_µc64be_lšux
 1

	)

149 #–ià
	`defšed
(
__lšux__
è&& defšed(
__pow”pc__
è&& defšed(
__pow”pc64__
è&& 
_CALL_ELF
 == 2

151 
	#PLAT_µc64Ë_lšux
 1

	)

152 #–ià
	`defšed
(
__lšux__
è&& defšed(
__¬m__
è&& !defšed(
__¯rch64__
)

153 
	#PLAT_¬m_lšux
 1

	)

154 #–ià
	`defšed
(
__lšux__
è&& defšed(
__¯rch64__
è&& !defšed(
__¬m__
)

155 
	#PLAT_¬m64_lšux
 1

	)

156 #–ià
	`defšed
(
__lšux__
è&& defšed(
__s390__
è&& defšed(
__s390x__
)

157 
	#PLAT_s390x_lšux
 1

	)

158 #–ià
	`defšed
(
__lšux__
è&& defšed(
__ms__
è&& (
__ms
==64)

159 
	#PLAT_ms64_lšux
 1

	)

160 #–ià
	`defšed
(
__lšux__
è&& defšed(
__ms__
è&& (
__ms
!=64)

161 
	#PLAT_ms32_lšux
 1

	)

162 #–ià
	`defšed
(
__sun
è&& defšed(
__i386__
)

163 
	#PLAT_x86_sŞ¬is
 1

	)

164 #–ià
	`defšed
(
__sun
è&& defšed(
__x86_64__
)

165 
	#PLAT_amd64_sŞ¬is
 1

	)

169 #ià!
	`defšed
(
NVALGRIND
)

170 
	#NVALGRIND
 1

	)

193 
	#VALGRIND_DO_CLIENT_REQUEST
(
_zzq_¾v®
, 
_zzq_deçuÉ
, \

194 
_zzq_»que¡
, 
_zzq_¬g1
, 
_zzq_¬g2
, \

195 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

196 dØ{ (
_zzq_¾v®
èğ
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
((
_zzq_deçuÉ
), \

197 (
_zzq_»que¡
), (
_zzq_¬g1
), (
_zzq_¬g2
), \

198 (
_zzq_¬g3
), (
_zzq_¬g4
), (
_zzq_¬g5
)); 
	}
} 0)

	)

200 
	#VALGRIND_DO_CLIENT_REQUEST_STMT
(
_zzq_»que¡
, 
_zzq_¬g1
, \

201 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

202 dØ{ (è
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

203 (
_zzq_»que¡
), (
_zzq_¬g1
), (
_zzq_¬g2
), \

204 (
_zzq_¬g3
), (
_zzq_¬g4
), (
_zzq_¬g5
)); } 0)

	)

206 #ià
defšed
(
NVALGRIND
)

211 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

212 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

213 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

214 (
_zzq_deçuÉ
)

	)

255 #ià
defšed
(
PLAT_x86_lšux
è|| defšed(
PLAT_x86_d¬wš
) \

256 || (
defšed
(
PLAT_x86_wš32
è&& defšed(
__GNUC__
)) \

257 || 
	$defšed
(
PLAT_x86_sŞ¬is
)

261 
Äaddr
;

263 
	tOrigFn
;

265 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

267 "rŞÈ$29, %%ed˜;„ŞÈ$19, %%edi\n\t"

	)

269 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

270 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

271 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

272 
__ex‹nsiÚ__
 \

273 ({vŞ©
_zzq_¬gs
[6]; \

274 vŞ©
_zzq_»suÉ
; \

275 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

276 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

277 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

278 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

279 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

280 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

281 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

284 : "=d" (
_zzq_»suÉ
) \

285 : "a" (&
_zzq_¬gs
[0]), "0" (
_zzq_deçuÉ
) \

288 
_zzq_»suÉ
; \

289 
	}
})

	)

291 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

292 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

293 vŞ©
__addr
; \

294 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

297 : "÷" (
__addr
) \

301 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

302 }

	)

304 
	#VALGRIND_CALL_NOREDIR_EAX
 \

305 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

307 "xchgÈ%%edx,%%edx\n\t"

	)

309 
	#VALGRIND_VEX_INJECT_IR
() \

311 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

315 } 0)

	)

318 || 
	gPLAT_x86_sŞ¬is
 */

322 #ià
defšed
(
PLAT_x86_wš32
è&& !defšed(
__GNUC__
)

326 
	mÄaddr
;

328 
	tOrigFn
;

330 #ià
defšed
(
_MSC_VER
)

332 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

333 
__asm
 
rŞ
 
edi
, 3 __asm„olƒdi, 13 \

334 
__asm
 
rŞ
 
edi
, 29 __asm„Şƒdi, 19

	)

336 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

337 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

338 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

339 
	`v®gršd_do_ş›Á_»que¡_ex´
((
ušŒ_t
)(
_zzq_deçuÉ
), \

340 (
ušŒ_t
)(
_zzq_»que¡
), (ušŒ_t)(
_zzq_¬g1
), \

341 (
ušŒ_t
)(
_zzq_¬g2
), (ušŒ_t)(
_zzq_¬g3
), \

342 (
ušŒ_t
)(
_zzq_¬g4
), (ušŒ_t)(
_zzq_¬g5
))

	)

344 
__šlše
 
ušŒ_t


345 
	$v®gršd_do_ş›Á_»que¡_ex´
(
ušŒ_t
 
_zzq_deçuÉ
, ušŒ_ˆ
_zzq_»que¡
,

346 
ušŒ_t
 
_zzq_¬g1
, ušŒ_ˆ
_zzq_¬g2
,

347 
ušŒ_t
 
_zzq_¬g3
, ušŒ_ˆ
_zzq_¬g4
,

348 
ušŒ_t
 
_zzq_¬g5
)

350 vŞ©
ušŒ_t
 
_zzq_¬gs
[6];

351 vŞ©
_zzq_»suÉ
;

352 
_zzq_¬gs
[0] = (
ušŒ_t
)(
_zzq_»que¡
);

353 
_zzq_¬gs
[1] = (
ušŒ_t
)(
_zzq_¬g1
);

354 
_zzq_¬gs
[2] = (
ušŒ_t
)(
_zzq_¬g2
);

355 
_zzq_¬gs
[3] = (
ušŒ_t
)(
_zzq_¬g3
);

356 
_zzq_¬gs
[4] = (
ušŒ_t
)(
_zzq_¬g4
);

357 
_zzq_¬gs
[5] = (
ušŒ_t
)(
_zzq_¬g5
);

358 
__asm
 { __asm 
Ëa
 
—x
, 
_zzq_¬gs
 __asm 
mov
 
edx
, 
_zzq_deçuÉ


359 
__SPECIAL_INSTRUCTION_PREAMBLE


361 
__asm
 
xchg
 
ebx
,ebx

362 
__asm
 
mov
 
_zzq_»suÉ
, 
edx


364  
_zzq_»suÉ
;

365 
	}
}

367 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

368 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

369 vŞ©
__addr
; \

370 
__asm
 { 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

372 
__asm
 
xchg
 
ecx
,ecx \

373 
__asm
 
mov
 
__addr
, 
—x
 \

375 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

376 }

	)

378 
	#VALGRIND_CALL_NOREDIR_EAX
 
ERROR


	)

380 
	#VALGRIND_VEX_INJECT_IR
() \

382 
__asm
 { 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

383 
__asm
 
xchg
 
edi
,edi \

385 } 0)

	)

388 #”rÜ 
UnsuµÜ‹d
 
comp”
.

395 #ià
defšed
(
PLAT_amd64_lšux
è|| defšed(
PLAT_amd64_d¬wš
) \

396 || 
defšed
(
PLAT_amd64_sŞ¬is
) \

397 || (
defšed
(
PLAT_amd64_wš64
è&& 
	$defšed
(
__GNUC__
))

401 
Äaddr
;

403 
	tOrigFn
;

405 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

407 "rŞq $61, %%rd˜;„Şq $51, %%rdi\n\t"

	)

409 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

410 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

411 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

412 
__ex‹nsiÚ__
 \

413 ({ vŞ©
_zzq_¬gs
[6]; \

414 vŞ©
_zzq_»suÉ
; \

415 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

416 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

417 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

418 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

419 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

420 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

421 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

424 : "=d" (
_zzq_»suÉ
) \

425 : "a" (&
_zzq_¬gs
[0]), "0" (
_zzq_deçuÉ
) \

428 
_zzq_»suÉ
; \

429 
	}
})

	)

431 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

432 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

433 vŞ©
__addr
; \

434 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

437 : "÷" (
__addr
) \

441 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

442 }

	)

444 
	#VALGRIND_CALL_NOREDIR_RAX
 \

445 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

447 "xchgq %%rdx,%%rdx\n\t"

	)

449 
	#VALGRIND_VEX_INJECT_IR
() \

451 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

455 } 0)

	)

461 #ià
defšed
(
PLAT_amd64_wš64
è&& !defšed(
__GNUC__
)

463 #”rÜ 
UnsuµÜ‹d
 
comp”
.

469 #ià
defšed
(
PLAT_µc32_lšux
)

473 
	mÄaddr
;

475 
	tOrigFn
;

477 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

479 "¾wšm 0,0,29,0,31 ;„lwšm 0,0,19,0,31\n\t"

	)

481 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

482 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

483 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

485 
__ex‹nsiÚ__
 \

486 ({ 
_zzq_¬gs
[6]; \

487 
_zzq_»suÉ
; \

488 * 
_zzq_±r
; \

489 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

490 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

491 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

492 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

493 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

494 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

495 
_zzq_±r
 = 
_zzq_¬gs
; \

496 
__asm__
 volatile("mr 3,%1\n\t" \

498 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

502 : "=b" (
_zzq_»suÉ
) \

503 : "b" (
_zzq_deçuÉ
), "b" (
_zzq_±r
) \

505 
_zzq_»suÉ
; \

506 })

	)

508 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

509 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

510 
__addr
; \

511 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

515 : "=b" (
__addr
) \

519 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

520 }

	)

522 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

523 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

525 "Ü 3,3,3\n\t"

	)

527 
	#VALGRIND_VEX_INJECT_IR
() \

529 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

532 } 0)

	)

538 #ià
defšed
(
PLAT_µc64be_lšux
)

542 
	mÄaddr
;

543 
	mr2
;

545 
	tOrigFn
;

547 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

549 "rÙld˜0,0,61 ;„Ùld˜0,0,51\n\t"

	)

551 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

552 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

553 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

555 
__ex‹nsiÚ__
 \

556 ({ 
_zzq_¬gs
[6]; \

557 
_zzq_»suÉ
; \

558 * 
_zzq_±r
; \

559 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

560 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

561 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

562 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

563 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

564 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

565 
_zzq_±r
 = 
_zzq_¬gs
; \

566 
__asm__
 volatile("mr 3,%1\n\t" \

568 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

572 : "=b" (
_zzq_»suÉ
) \

573 : "b" (
_zzq_deçuÉ
), "b" (
_zzq_±r
) \

575 
_zzq_»suÉ
; \

576 })

	)

578 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

579 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

580 
__addr
; \

581 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

585 : "=b" (
__addr
) \

589 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

590 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

594 : "=b" (
__addr
) \

598 
_zzq_Üig
->
r2
 = 
__addr
; \

599 }

	)

601 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

602 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

604 "Ü 3,3,3\n\t"

	)

606 
	#VALGRIND_VEX_INJECT_IR
() \

608 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

611 } 0)

	)

615 #ià
defšed
(
PLAT_µc64Ë_lšux
)

619 
	mÄaddr
;

620 
	mr2
;

622 
	tOrigFn
;

624 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

626 "rÙld˜0,0,61 ;„Ùld˜0,0,51\n\t"

	)

628 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

629 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

630 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

632 
__ex‹nsiÚ__
 \

633 ({ 
_zzq_¬gs
[6]; \

634 
_zzq_»suÉ
; \

635 * 
_zzq_±r
; \

636 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

637 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

638 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

639 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

640 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

641 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

642 
_zzq_±r
 = 
_zzq_¬gs
; \

643 
__asm__
 volatile("mr 3,%1\n\t" \

645 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

649 : "=b" (
_zzq_»suÉ
) \

650 : "b" (
_zzq_deçuÉ
), "b" (
_zzq_±r
) \

652 
_zzq_»suÉ
; \

653 })

	)

655 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

656 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

657 
__addr
; \

658 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

662 : "=b" (
__addr
) \

666 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

667 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

671 : "=b" (
__addr
) \

675 
_zzq_Üig
->
r2
 = 
__addr
; \

676 }

	)

678 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

679 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

681 "Ü 3,3,3\n\t"

	)

683 
	#VALGRIND_VEX_INJECT_IR
() \

685 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

688 } 0)

	)

694 #ià
defšed
(
PLAT_¬m_lšux
)

698 
	mÄaddr
;

700 
	tOrigFn
;

702 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

704 "mov„12,„12,„Ü #29 ; mov„12,„12,„Ü #19 \n\t"

	)

706 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

707 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

708 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

710 
__ex‹nsiÚ__
 \

711 ({vŞ©
_zzq_¬gs
[6]; \

712 vŞ©
_zzq_»suÉ
; \

713 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

714 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

715 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

716 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

717 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

718 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

719 
__asm__
 volatile("mov„3, %1\n\t" \

721 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

725 : "ô" (
_zzq_»suÉ
) \

726 : "r" (
_zzq_deçuÉ
), "r" (&
_zzq_¬gs
[0]) \

728 
_zzq_»suÉ
; \

729 })

	)

731 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

732 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

733 
__addr
; \

734 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

738 : "ô" (
__addr
) \

742 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

743 }

	)

745 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

746 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

748 "Ü¸r12,„12,„12\n\t"

	)

750 
	#VALGRIND_VEX_INJECT_IR
() \

752 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

756 } 0)

	)

762 #ià
defšed
(
PLAT_¬m64_lšux
)

766 
	mÄaddr
;

768 
	tOrigFn
;

770 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

772 "rÜ x12, x12, #51 ;„Ü x12, x12, #61 \n\t"

	)

774 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

775 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

776 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

778 
__ex‹nsiÚ__
 \

779 ({vŞ©
_zzq_¬gs
[6]; \

780 vŞ©
_zzq_»suÉ
; \

781 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

782 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

783 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

784 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

785 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

786 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

787 
__asm__
 volatile("mov x3, %1\n\t" \

789 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

793 : "ô" (
_zzq_»suÉ
) \

794 : "r" (()(
_zzq_deçuÉ
)), \

795 "r" (&
_zzq_¬gs
[0]) \

797 
_zzq_»suÉ
; \

798 })

	)

800 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

801 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

802 
__addr
; \

803 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

807 : "ô" (
__addr
) \

811 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

812 }

	)

814 
	#VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

815 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

817 "Ü¸x12, x12, x12\n\t"

	)

819 
	#VALGRIND_VEX_INJECT_IR
() \

821 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

825 } 0)

	)

831 #ià
defšed
(
PLAT_s390x_lšux
)

835 
	mÄaddr
;

837 
	tOrigFn
;

843 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

847 "Ì 3,3\n\t"

	)

849 
	#__CLIENT_REQUEST_CODE
 "Ì 2,2\n\t"

	)

850 
	#__GET_NR_CONTEXT_CODE
 "Ì 3,3\n\t"

	)

851 
	#__CALL_NO_REDIR_CODE
 "Ì 4,4\n\t"

	)

852 
	#__VEX_INJECT_IR_CODE
 "Ì 5,5\n\t"

	)

854 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

855 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

856 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

857 
__ex‹nsiÚ__
 \

858 ({vŞ©
_zzq_¬gs
[6]; \

859 vŞ©
_zzq_»suÉ
; \

860 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

861 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

862 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

863 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

864 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

865 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

866 
__asm__
 volatile( \

870 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

871 
__CLIENT_REQUEST_CODE
 \

874 : "=d" (
_zzq_»suÉ
) \

875 : "a" (&
_zzq_¬gs
[0]), "0" (
_zzq_deçuÉ
) \

878 
_zzq_»suÉ
; \

879 })

	)

881 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

882 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

883 vŞ©
__addr
; \

884 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

885 
__GET_NR_CONTEXT_CODE
 \

887 : "÷" (
__addr
) \

891 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

892 }

	)

894 
	#VALGRIND_CALL_NOREDIR_R1
 \

895 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

896 
__CALL_NO_REDIR_CODE


	)

898 
	#VALGRIND_VEX_INJECT_IR
() \

900 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

901 
__VEX_INJECT_IR_CODE
); \

902 } 0)

	)

908 #ià
defšed
(
PLAT_ms32_lšux
)

912 
	mÄaddr
;

914 
	tOrigFn
;

920 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

924 "¤È$0, $0, 19\n\t"

	)

926 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

927 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

928 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

929 
__ex‹nsiÚ__
 \

930 ({ vŞ©
_zzq_¬gs
[6]; \

931 vŞ©
_zzq_»suÉ
; \

932 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

933 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

934 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

935 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

936 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

937 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

938 
__asm__
 volatile("move $11, %1\n\t" \

940 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

944 : "ô" (
_zzq_»suÉ
) \

945 : "r" (
_zzq_deçuÉ
), "r" (&
_zzq_¬gs
[0]) \

947 
_zzq_»suÉ
; \

948 })

	)

950 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

951 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

952 vŞ©
__addr
; \

953 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

957 : "ô" (
__addr
) \

961 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

962 }

	)

964 
	#VALGRIND_CALL_NOREDIR_T9
 \

965 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

967 "Ü $15, $15, $15\n\t"

	)

969 
	#VALGRIND_VEX_INJECT_IR
() \

971 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

974 } 0)

	)

981 #ià
defšed
(
PLAT_ms64_lšux
)

985 
	mÄaddr
;

987 
	tOrigFn
;

993 
	#__SPECIAL_INSTRUCTION_PREAMBLE
 \

995 "d¦È$0,$0,29 ; d¦È$0,$0,19\n\t"

	)

997 
	#VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

998 
_zzq_deçuÉ
, 
_zzq_»que¡
, \

999 
_zzq_¬g1
, 
_zzq_¬g2
, 
_zzq_¬g3
, 
_zzq_¬g4
, 
_zzq_¬g5
) \

1000 
__ex‹nsiÚ__
 \

1001 ({ vŞ©
_zzq_¬gs
[6]; \

1002 vŞ©
_zzq_»suÉ
; \

1003 
_zzq_¬gs
[0] = ()(
_zzq_»que¡
); \

1004 
_zzq_¬gs
[1] = ()(
_zzq_¬g1
); \

1005 
_zzq_¬gs
[2] = ()(
_zzq_¬g2
); \

1006 
_zzq_¬gs
[3] = ()(
_zzq_¬g3
); \

1007 
_zzq_¬gs
[4] = ()(
_zzq_¬g4
); \

1008 
_zzq_¬gs
[5] = ()(
_zzq_¬g5
); \

1009 
__asm__
 volatile("move $11, %1\n\t" \

1011 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

1015 : "ô" (
_zzq_»suÉ
) \

1016 : "r" (
_zzq_deçuÉ
), "r" (&
_zzq_¬gs
[0]) \

1018 
_zzq_»suÉ
; \

1019 })

	)

1021 
	#VALGRIND_GET_NR_CONTEXT
(
_zzq_¾v®
) \

1022 { vŞ©
OrigFn
* 
_zzq_Üig
 = &(
_zzq_¾v®
); \

1023 vŞ©
__addr
; \

1024 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

1028 : "ô" (
__addr
) \

1031 
_zzq_Üig
->
Äaddr
 = 
__addr
; \

1032 }

	)

1034 
	#VALGRIND_CALL_NOREDIR_T9
 \

1035 
__SPECIAL_INSTRUCTION_PREAMBLE
 \

1037 "Ü $15, $15, $15\n\t"

	)

1039 
	#VALGRIND_VEX_INJECT_IR
() \

1041 
__asm__
 vŞ©e(
__SPECIAL_INSTRUCTION_PREAMBLE
 \

1044 } 0)

	)

1084 
	#VG_CONCAT4
(
_¯
,
_bb
,
_cc
,
_dd
è_¯##_bb##_cc##
	)
_dd

1086 
	#I_WRAP_SONAME_FNNAME_ZU
(
sÚame
,
âÇme
) \

1087 
	`VG_CONCAT4
(
_vgw00000ZU_
,
sÚame
,
_
,
âÇme
)

	)

1089 
	#I_WRAP_SONAME_FNNAME_ZZ
(
sÚame
,
âÇme
) \

1090 
	`VG_CONCAT4
(
_vgw00000ZZ_
,
sÚame
,
_
,
âÇme
)

	)

1096 
	#VALGRIND_GET_ORIG_FN
(
_lv®
è
	`VALGRIND_GET_NR_CONTEXT
(_lv®)

	)

1104 
	#I_REPLACE_SONAME_FNNAME_ZU
(
sÚame
,
âÇme
) \

1105 
	`VG_CONCAT4
(
_vgr00000ZU_
,
sÚame
,
_
,
âÇme
)

	)

1107 
	#I_REPLACE_SONAME_FNNAME_ZZ
(
sÚame
,
âÇme
) \

1108 
	`VG_CONCAT4
(
_vgr00000ZZ_
,
sÚame
,
_
,
âÇme
)

	)

1113 
	#CALL_FN_v_v
(
â±r
) \

1114 dØ{ vŞ©
_junk
; \

1115 
	`CALL_FN_W_v
(
_junk
,
â±r
); } 0)

	)

1117 
	#CALL_FN_v_W
(
â±r
, 
¬g1
) \

1118 dØ{ vŞ©
_junk
; \

1119 
	`CALL_FN_W_W
(
_junk
,
â±r
,
¬g1
); } 0)

	)

1121 
	#CALL_FN_v_WW
(
â±r
, 
¬g1
,
¬g2
) \

1122 dØ{ vŞ©
_junk
; \

1123 
	`CALL_FN_W_WW
(
_junk
,
â±r
,
¬g1
,
¬g2
); } 0)

	)

1125 
	#CALL_FN_v_WWW
(
â±r
, 
¬g1
,
¬g2
,
¬g3
) \

1126 dØ{ vŞ©
_junk
; \

1127 
	`CALL_FN_W_WWW
(
_junk
,
â±r
,
¬g1
,
¬g2
,
¬g3
); } 0)

	)

1129 
	#CALL_FN_v_WWWW
(
â±r
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

1130 dØ{ vŞ©
_junk
; \

1131 
	`CALL_FN_W_WWWW
(
_junk
,
â±r
,
¬g1
,
¬g2
,
¬g3
,
¬g4
); } 0)

	)

1133 
	#CALL_FN_v_5W
(
â±r
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

1134 dØ{ vŞ©
_junk
; \

1135 
	`CALL_FN_W_5W
(
_junk
,
â±r
,
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
); } 0)

	)

1137 
	#CALL_FN_v_6W
(
â±r
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

1138 dØ{ vŞ©
_junk
; \

1139 
	`CALL_FN_W_6W
(
_junk
,
â±r
,
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
); } 0)

	)

1141 
	#CALL_FN_v_7W
(
â±r
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
,
¬g7
) \

1142 dØ{ vŞ©
_junk
; \

1143 
	`CALL_FN_W_7W
(
_junk
,
â±r
,
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
,
¬g7
); } 0)

	)

1147 #ià
defšed
(
PLAT_x86_lšux
è|| defšed(
PLAT_x86_d¬wš
) \

1148 || 
	$defšed
(
PLAT_x86_sŞ¬is
)

1152 
	#__CALLER_SAVED_REGS
 "ecx", "edx"

	)

1159 
	#VALGRIND_ALIGN_STACK
 \

1161 "ªdÈ$0xfffffff0,%%e¥\n\t"

	)

1162 
	#VALGRIND_RESTORE_STACK
 \

1163 "movÈ%%edi,%%e¥\n\t"

	)

1168 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

1170 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1171 vŞ©
_¬gvec
[1]; \

1172 vŞ©
_»s
; \

1173 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1174 
__asm__
 volatile( \

1175 
VALGRIND_ALIGN_STACK
 \

1177 
VALGRIND_CALL_NOREDIR_EAX
 \

1178 
VALGRIND_RESTORE_STACK
 \

1179 : "÷" (
_»s
) \

1180 : "a" (&
_¬gvec
[0]) \

1181 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1183 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1184 
	}
} 0)

	)

1186 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

1188 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1189 vŞ©
_¬gvec
[2]; \

1190 vŞ©
_»s
; \

1191 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1192 
_¬gvec
[1] = ()(
¬g1
); \

1193 
__asm__
 volatile( \

1194 
VALGRIND_ALIGN_STACK
 \

1198 
VALGRIND_CALL_NOREDIR_EAX
 \

1199 
VALGRIND_RESTORE_STACK
 \

1200 : "÷" (
_»s
) \

1201 : "a" (&
_¬gvec
[0]) \

1202 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1204 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1205 } 0)

	)

1207 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
) \

1209 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1210 vŞ©
_¬gvec
[3]; \

1211 vŞ©
_»s
; \

1212 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1213 
_¬gvec
[1] = ()(
¬g1
); \

1214 
_¬gvec
[2] = ()(
¬g2
); \

1215 
__asm__
 volatile( \

1216 
VALGRIND_ALIGN_STACK
 \

1221 
VALGRIND_CALL_NOREDIR_EAX
 \

1222 
VALGRIND_RESTORE_STACK
 \

1223 : "÷" (
_»s
) \

1224 : "a" (&
_¬gvec
[0]) \

1225 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1227 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1228 } 0)

	)

1230 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
) \

1232 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1233 vŞ©
_¬gvec
[4]; \

1234 vŞ©
_»s
; \

1235 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1236 
_¬gvec
[1] = ()(
¬g1
); \

1237 
_¬gvec
[2] = ()(
¬g2
); \

1238 
_¬gvec
[3] = ()(
¬g3
); \

1239 
__asm__
 volatile( \

1240 
VALGRIND_ALIGN_STACK
 \

1246 
VALGRIND_CALL_NOREDIR_EAX
 \

1247 
VALGRIND_RESTORE_STACK
 \

1248 : "÷" (
_»s
) \

1249 : "a" (&
_¬gvec
[0]) \

1250 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1252 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1253 } 0)

	)

1255 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

1257 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1258 vŞ©
_¬gvec
[5]; \

1259 vŞ©
_»s
; \

1260 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1261 
_¬gvec
[1] = ()(
¬g1
); \

1262 
_¬gvec
[2] = ()(
¬g2
); \

1263 
_¬gvec
[3] = ()(
¬g3
); \

1264 
_¬gvec
[4] = ()(
¬g4
); \

1265 
__asm__
 volatile( \

1266 
VALGRIND_ALIGN_STACK
 \

1272 
VALGRIND_CALL_NOREDIR_EAX
 \

1273 
VALGRIND_RESTORE_STACK
 \

1274 : "÷" (
_»s
) \

1275 : "a" (&
_¬gvec
[0]) \

1276 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1278 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1279 } 0)

	)

1281 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

1283 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1284 vŞ©
_¬gvec
[6]; \

1285 vŞ©
_»s
; \

1286 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1287 
_¬gvec
[1] = ()(
¬g1
); \

1288 
_¬gvec
[2] = ()(
¬g2
); \

1289 
_¬gvec
[3] = ()(
¬g3
); \

1290 
_¬gvec
[4] = ()(
¬g4
); \

1291 
_¬gvec
[5] = ()(
¬g5
); \

1292 
__asm__
 volatile( \

1293 
VALGRIND_ALIGN_STACK
 \

1301 
VALGRIND_CALL_NOREDIR_EAX
 \

1302 
VALGRIND_RESTORE_STACK
 \

1303 : "÷" (
_»s
) \

1304 : "a" (&
_¬gvec
[0]) \

1305 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1307 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1308 } 0)

	)

1310 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

1312 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1313 vŞ©
_¬gvec
[7]; \

1314 vŞ©
_»s
; \

1315 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1316 
_¬gvec
[1] = ()(
¬g1
); \

1317 
_¬gvec
[2] = ()(
¬g2
); \

1318 
_¬gvec
[3] = ()(
¬g3
); \

1319 
_¬gvec
[4] = ()(
¬g4
); \

1320 
_¬gvec
[5] = ()(
¬g5
); \

1321 
_¬gvec
[6] = ()(
¬g6
); \

1322 
__asm__
 volatile( \

1323 
VALGRIND_ALIGN_STACK
 \

1332 
VALGRIND_CALL_NOREDIR_EAX
 \

1333 
VALGRIND_RESTORE_STACK
 \

1334 : "÷" (
_»s
) \

1335 : "a" (&
_¬gvec
[0]) \

1336 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1338 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1339 } 0)

	)

1341 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

1342 
¬g7
) \

1344 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1345 vŞ©
_¬gvec
[8]; \

1346 vŞ©
_»s
; \

1347 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1348 
_¬gvec
[1] = ()(
¬g1
); \

1349 
_¬gvec
[2] = ()(
¬g2
); \

1350 
_¬gvec
[3] = ()(
¬g3
); \

1351 
_¬gvec
[4] = ()(
¬g4
); \

1352 
_¬gvec
[5] = ()(
¬g5
); \

1353 
_¬gvec
[6] = ()(
¬g6
); \

1354 
_¬gvec
[7] = ()(
¬g7
); \

1355 
__asm__
 volatile( \

1356 
VALGRIND_ALIGN_STACK
 \

1366 
VALGRIND_CALL_NOREDIR_EAX
 \

1367 
VALGRIND_RESTORE_STACK
 \

1368 : "÷" (
_»s
) \

1369 : "a" (&
_¬gvec
[0]) \

1370 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1372 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1373 } 0)

	)

1375 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

1376 
¬g7
,
¬g8
) \

1378 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1379 vŞ©
_¬gvec
[9]; \

1380 vŞ©
_»s
; \

1381 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1382 
_¬gvec
[1] = ()(
¬g1
); \

1383 
_¬gvec
[2] = ()(
¬g2
); \

1384 
_¬gvec
[3] = ()(
¬g3
); \

1385 
_¬gvec
[4] = ()(
¬g4
); \

1386 
_¬gvec
[5] = ()(
¬g5
); \

1387 
_¬gvec
[6] = ()(
¬g6
); \

1388 
_¬gvec
[7] = ()(
¬g7
); \

1389 
_¬gvec
[8] = ()(
¬g8
); \

1390 
__asm__
 volatile( \

1391 
VALGRIND_ALIGN_STACK
 \

1401 
VALGRIND_CALL_NOREDIR_EAX
 \

1402 
VALGRIND_RESTORE_STACK
 \

1403 : "÷" (
_»s
) \

1404 : "a" (&
_¬gvec
[0]) \

1405 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1407 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1408 } 0)

	)

1410 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

1411 
¬g7
,
¬g8
,
¬g9
) \

1413 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1414 vŞ©
_¬gvec
[10]; \

1415 vŞ©
_»s
; \

1416 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1417 
_¬gvec
[1] = ()(
¬g1
); \

1418 
_¬gvec
[2] = ()(
¬g2
); \

1419 
_¬gvec
[3] = ()(
¬g3
); \

1420 
_¬gvec
[4] = ()(
¬g4
); \

1421 
_¬gvec
[5] = ()(
¬g5
); \

1422 
_¬gvec
[6] = ()(
¬g6
); \

1423 
_¬gvec
[7] = ()(
¬g7
); \

1424 
_¬gvec
[8] = ()(
¬g8
); \

1425 
_¬gvec
[9] = ()(
¬g9
); \

1426 
__asm__
 volatile( \

1427 
VALGRIND_ALIGN_STACK
 \

1439 
VALGRIND_CALL_NOREDIR_EAX
 \

1440 
VALGRIND_RESTORE_STACK
 \

1441 : "÷" (
_»s
) \

1442 : "a" (&
_¬gvec
[0]) \

1443 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1445 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1446 } 0)

	)

1448 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

1449 
¬g7
,
¬g8
,
¬g9
,
¬g10
) \

1451 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1452 vŞ©
_¬gvec
[11]; \

1453 vŞ©
_»s
; \

1454 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1455 
_¬gvec
[1] = ()(
¬g1
); \

1456 
_¬gvec
[2] = ()(
¬g2
); \

1457 
_¬gvec
[3] = ()(
¬g3
); \

1458 
_¬gvec
[4] = ()(
¬g4
); \

1459 
_¬gvec
[5] = ()(
¬g5
); \

1460 
_¬gvec
[6] = ()(
¬g6
); \

1461 
_¬gvec
[7] = ()(
¬g7
); \

1462 
_¬gvec
[8] = ()(
¬g8
); \

1463 
_¬gvec
[9] = ()(
¬g9
); \

1464 
_¬gvec
[10] = ()(
¬g10
); \

1465 
__asm__
 volatile( \

1466 
VALGRIND_ALIGN_STACK
 \

1479 
VALGRIND_CALL_NOREDIR_EAX
 \

1480 
VALGRIND_RESTORE_STACK
 \

1481 : "÷" (
_»s
) \

1482 : "a" (&
_¬gvec
[0]) \

1483 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1485 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1486 } 0)

	)

1488 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
, \

1489 
¬g6
,
¬g7
,
¬g8
,
¬g9
,
¬g10
, \

1490 
¬g11
) \

1492 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1493 vŞ©
_¬gvec
[12]; \

1494 vŞ©
_»s
; \

1495 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1496 
_¬gvec
[1] = ()(
¬g1
); \

1497 
_¬gvec
[2] = ()(
¬g2
); \

1498 
_¬gvec
[3] = ()(
¬g3
); \

1499 
_¬gvec
[4] = ()(
¬g4
); \

1500 
_¬gvec
[5] = ()(
¬g5
); \

1501 
_¬gvec
[6] = ()(
¬g6
); \

1502 
_¬gvec
[7] = ()(
¬g7
); \

1503 
_¬gvec
[8] = ()(
¬g8
); \

1504 
_¬gvec
[9] = ()(
¬g9
); \

1505 
_¬gvec
[10] = ()(
¬g10
); \

1506 
_¬gvec
[11] = ()(
¬g11
); \

1507 
__asm__
 volatile( \

1508 
VALGRIND_ALIGN_STACK
 \

1522 
VALGRIND_CALL_NOREDIR_EAX
 \

1523 
VALGRIND_RESTORE_STACK
 \

1524 : "÷" (
_»s
) \

1525 : "a" (&
_¬gvec
[0]) \

1526 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1528 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1529 } 0)

	)

1531 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
, \

1532 
¬g6
,
¬g7
,
¬g8
,
¬g9
,
¬g10
, \

1533 
¬g11
,
¬g12
) \

1535 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1536 vŞ©
_¬gvec
[13]; \

1537 vŞ©
_»s
; \

1538 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1539 
_¬gvec
[1] = ()(
¬g1
); \

1540 
_¬gvec
[2] = ()(
¬g2
); \

1541 
_¬gvec
[3] = ()(
¬g3
); \

1542 
_¬gvec
[4] = ()(
¬g4
); \

1543 
_¬gvec
[5] = ()(
¬g5
); \

1544 
_¬gvec
[6] = ()(
¬g6
); \

1545 
_¬gvec
[7] = ()(
¬g7
); \

1546 
_¬gvec
[8] = ()(
¬g8
); \

1547 
_¬gvec
[9] = ()(
¬g9
); \

1548 
_¬gvec
[10] = ()(
¬g10
); \

1549 
_¬gvec
[11] = ()(
¬g11
); \

1550 
_¬gvec
[12] = ()(
¬g12
); \

1551 
__asm__
 volatile( \

1552 
VALGRIND_ALIGN_STACK
 \

1566 
VALGRIND_CALL_NOREDIR_EAX
 \

1567 
VALGRIND_RESTORE_STACK
 \

1568 : "÷" (
_»s
) \

1569 : "a" (&
_¬gvec
[0]) \

1570 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "edi" \

1572 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1573 } 0)

	)

1579 #ià
defšed
(
PLAT_amd64_lšux
è|| defšed(
PLAT_amd64_d¬wš
) \

1580 || 
	$defšed
(
PLAT_amd64_sŞ¬is
)

1585 
	#__CALLER_SAVED_REGS
 "rcx", "rdx", "rsi", \

1586 "rdi", "r8", "r9", "r10", "r11"

	)

1642 #ià
	`defšed
(
__GNUC__
è&& defšed(
__GCC_HAVE_DWARF2_CFI_ASM
)

1643 
	#__FRAME_POINTER
 \

1644 ,"r"(
	`__butš_dw¬f_cç
())

	)

1645 
	#VALGRIND_CFI_PROLOGUE
 \

1649 ".cfi_def_cç„bp, 0\n\t"

	)

1650 
	#VALGRIND_CFI_EPILOGUE
 \

1652 ".cfi_»¡Üe_¡©e\n\t"

	)

1654 
	#__FRAME_POINTER


	)

1655 
	#VALGRIND_CFI_PROLOGUE


	)

1656 
	#VALGRIND_CFI_EPILOGUE


	)

1664 
	#VALGRIND_ALIGN_STACK
 \

1666 "ªdq $0xfffffffffffffff0,%%r¥\n\t"

	)

1667 
	#VALGRIND_RESTORE_STACK
 \

1668 "movq %%r14,%%r¥\n\t"

	)

1694 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

1696 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1697 vŞ©
_¬gvec
[1]; \

1698 vŞ©
_»s
; \

1699 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1700 
__asm__
 volatile( \

1701 
VALGRIND_CFI_PROLOGUE
 \

1702 
VALGRIND_ALIGN_STACK
 \

1705 
VALGRIND_CALL_NOREDIR_RAX
 \

1706 
VALGRIND_RESTORE_STACK
 \

1707 
VALGRIND_CFI_EPILOGUE
 \

1708 : "÷" (
_»s
) \

1709 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1710 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1712 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1713 
	}
} 0)

	)

1715 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

1717 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1718 vŞ©
_¬gvec
[2]; \

1719 vŞ©
_»s
; \

1720 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1721 
_¬gvec
[1] = ()(
¬g1
); \

1722 
__asm__
 volatile( \

1723 
VALGRIND_CFI_PROLOGUE
 \

1724 
VALGRIND_ALIGN_STACK
 \

1728 
VALGRIND_CALL_NOREDIR_RAX
 \

1729 
VALGRIND_RESTORE_STACK
 \

1730 
VALGRIND_CFI_EPILOGUE
 \

1731 : "÷" (
_»s
) \

1732 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1733 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1735 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1736 } 0)

	)

1738 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
) \

1740 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1741 vŞ©
_¬gvec
[3]; \

1742 vŞ©
_»s
; \

1743 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1744 
_¬gvec
[1] = ()(
¬g1
); \

1745 
_¬gvec
[2] = ()(
¬g2
); \

1746 
__asm__
 volatile( \

1747 
VALGRIND_CFI_PROLOGUE
 \

1748 
VALGRIND_ALIGN_STACK
 \

1753 
VALGRIND_CALL_NOREDIR_RAX
 \

1754 
VALGRIND_RESTORE_STACK
 \

1755 
VALGRIND_CFI_EPILOGUE
 \

1756 : "÷" (
_»s
) \

1757 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1758 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1760 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1761 } 0)

	)

1763 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
) \

1765 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1766 vŞ©
_¬gvec
[4]; \

1767 vŞ©
_»s
; \

1768 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1769 
_¬gvec
[1] = ()(
¬g1
); \

1770 
_¬gvec
[2] = ()(
¬g2
); \

1771 
_¬gvec
[3] = ()(
¬g3
); \

1772 
__asm__
 volatile( \

1773 
VALGRIND_CFI_PROLOGUE
 \

1774 
VALGRIND_ALIGN_STACK
 \

1780 
VALGRIND_CALL_NOREDIR_RAX
 \

1781 
VALGRIND_RESTORE_STACK
 \

1782 
VALGRIND_CFI_EPILOGUE
 \

1783 : "÷" (
_»s
) \

1784 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1785 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1787 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1788 } 0)

	)

1790 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

1792 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1793 vŞ©
_¬gvec
[5]; \

1794 vŞ©
_»s
; \

1795 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1796 
_¬gvec
[1] = ()(
¬g1
); \

1797 
_¬gvec
[2] = ()(
¬g2
); \

1798 
_¬gvec
[3] = ()(
¬g3
); \

1799 
_¬gvec
[4] = ()(
¬g4
); \

1800 
__asm__
 volatile( \

1801 
VALGRIND_CFI_PROLOGUE
 \

1802 
VALGRIND_ALIGN_STACK
 \

1809 
VALGRIND_CALL_NOREDIR_RAX
 \

1810 
VALGRIND_RESTORE_STACK
 \

1811 
VALGRIND_CFI_EPILOGUE
 \

1812 : "÷" (
_»s
) \

1813 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1814 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1816 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1817 } 0)

	)

1819 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

1821 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1822 vŞ©
_¬gvec
[6]; \

1823 vŞ©
_»s
; \

1824 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1825 
_¬gvec
[1] = ()(
¬g1
); \

1826 
_¬gvec
[2] = ()(
¬g2
); \

1827 
_¬gvec
[3] = ()(
¬g3
); \

1828 
_¬gvec
[4] = ()(
¬g4
); \

1829 
_¬gvec
[5] = ()(
¬g5
); \

1830 
__asm__
 volatile( \

1831 
VALGRIND_CFI_PROLOGUE
 \

1832 
VALGRIND_ALIGN_STACK
 \

1840 
VALGRIND_CALL_NOREDIR_RAX
 \

1841 
VALGRIND_RESTORE_STACK
 \

1842 
VALGRIND_CFI_EPILOGUE
 \

1843 : "÷" (
_»s
) \

1844 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1845 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1847 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1848 } 0)

	)

1850 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

1852 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1853 vŞ©
_¬gvec
[7]; \

1854 vŞ©
_»s
; \

1855 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1856 
_¬gvec
[1] = ()(
¬g1
); \

1857 
_¬gvec
[2] = ()(
¬g2
); \

1858 
_¬gvec
[3] = ()(
¬g3
); \

1859 
_¬gvec
[4] = ()(
¬g4
); \

1860 
_¬gvec
[5] = ()(
¬g5
); \

1861 
_¬gvec
[6] = ()(
¬g6
); \

1862 
__asm__
 volatile( \

1863 
VALGRIND_CFI_PROLOGUE
 \

1864 
VALGRIND_ALIGN_STACK
 \

1873 
VALGRIND_CALL_NOREDIR_RAX
 \

1874 
VALGRIND_RESTORE_STACK
 \

1875 
VALGRIND_CFI_EPILOGUE
 \

1876 : "÷" (
_»s
) \

1877 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1878 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1880 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1881 } 0)

	)

1883 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

1884 
¬g7
) \

1886 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1887 vŞ©
_¬gvec
[8]; \

1888 vŞ©
_»s
; \

1889 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1890 
_¬gvec
[1] = ()(
¬g1
); \

1891 
_¬gvec
[2] = ()(
¬g2
); \

1892 
_¬gvec
[3] = ()(
¬g3
); \

1893 
_¬gvec
[4] = ()(
¬g4
); \

1894 
_¬gvec
[5] = ()(
¬g5
); \

1895 
_¬gvec
[6] = ()(
¬g6
); \

1896 
_¬gvec
[7] = ()(
¬g7
); \

1897 
__asm__
 volatile( \

1898 
VALGRIND_CFI_PROLOGUE
 \

1899 
VALGRIND_ALIGN_STACK
 \

1909 
VALGRIND_CALL_NOREDIR_RAX
 \

1910 
VALGRIND_RESTORE_STACK
 \

1911 
VALGRIND_CFI_EPILOGUE
 \

1912 : "÷" (
_»s
) \

1913 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1914 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1916 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1917 } 0)

	)

1919 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

1920 
¬g7
,
¬g8
) \

1922 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1923 vŞ©
_¬gvec
[9]; \

1924 vŞ©
_»s
; \

1925 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1926 
_¬gvec
[1] = ()(
¬g1
); \

1927 
_¬gvec
[2] = ()(
¬g2
); \

1928 
_¬gvec
[3] = ()(
¬g3
); \

1929 
_¬gvec
[4] = ()(
¬g4
); \

1930 
_¬gvec
[5] = ()(
¬g5
); \

1931 
_¬gvec
[6] = ()(
¬g6
); \

1932 
_¬gvec
[7] = ()(
¬g7
); \

1933 
_¬gvec
[8] = ()(
¬g8
); \

1934 
__asm__
 volatile( \

1935 
VALGRIND_CFI_PROLOGUE
 \

1936 
VALGRIND_ALIGN_STACK
 \

1947 
VALGRIND_CALL_NOREDIR_RAX
 \

1948 
VALGRIND_RESTORE_STACK
 \

1949 
VALGRIND_CFI_EPILOGUE
 \

1950 : "÷" (
_»s
) \

1951 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1952 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1954 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1955 } 0)

	)

1957 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

1958 
¬g7
,
¬g8
,
¬g9
) \

1960 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

1961 vŞ©
_¬gvec
[10]; \

1962 vŞ©
_»s
; \

1963 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

1964 
_¬gvec
[1] = ()(
¬g1
); \

1965 
_¬gvec
[2] = ()(
¬g2
); \

1966 
_¬gvec
[3] = ()(
¬g3
); \

1967 
_¬gvec
[4] = ()(
¬g4
); \

1968 
_¬gvec
[5] = ()(
¬g5
); \

1969 
_¬gvec
[6] = ()(
¬g6
); \

1970 
_¬gvec
[7] = ()(
¬g7
); \

1971 
_¬gvec
[8] = ()(
¬g8
); \

1972 
_¬gvec
[9] = ()(
¬g9
); \

1973 
__asm__
 volatile( \

1974 
VALGRIND_CFI_PROLOGUE
 \

1975 
VALGRIND_ALIGN_STACK
 \

1987 
VALGRIND_CALL_NOREDIR_RAX
 \

1988 
VALGRIND_RESTORE_STACK
 \

1989 
VALGRIND_CFI_EPILOGUE
 \

1990 : "÷" (
_»s
) \

1991 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

1992 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

1994 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

1995 } 0)

	)

1997 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

1998 
¬g7
,
¬g8
,
¬g9
,
¬g10
) \

2000 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2001 vŞ©
_¬gvec
[11]; \

2002 vŞ©
_»s
; \

2003 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2004 
_¬gvec
[1] = ()(
¬g1
); \

2005 
_¬gvec
[2] = ()(
¬g2
); \

2006 
_¬gvec
[3] = ()(
¬g3
); \

2007 
_¬gvec
[4] = ()(
¬g4
); \

2008 
_¬gvec
[5] = ()(
¬g5
); \

2009 
_¬gvec
[6] = ()(
¬g6
); \

2010 
_¬gvec
[7] = ()(
¬g7
); \

2011 
_¬gvec
[8] = ()(
¬g8
); \

2012 
_¬gvec
[9] = ()(
¬g9
); \

2013 
_¬gvec
[10] = ()(
¬g10
); \

2014 
__asm__
 volatile( \

2015 
VALGRIND_CFI_PROLOGUE
 \

2016 
VALGRIND_ALIGN_STACK
 \

2029 
VALGRIND_CALL_NOREDIR_RAX
 \

2030 
VALGRIND_RESTORE_STACK
 \

2031 
VALGRIND_CFI_EPILOGUE
 \

2032 : "÷" (
_»s
) \

2033 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

2034 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

2036 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2037 } 0)

	)

2039 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2040 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
) \

2042 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2043 vŞ©
_¬gvec
[12]; \

2044 vŞ©
_»s
; \

2045 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2046 
_¬gvec
[1] = ()(
¬g1
); \

2047 
_¬gvec
[2] = ()(
¬g2
); \

2048 
_¬gvec
[3] = ()(
¬g3
); \

2049 
_¬gvec
[4] = ()(
¬g4
); \

2050 
_¬gvec
[5] = ()(
¬g5
); \

2051 
_¬gvec
[6] = ()(
¬g6
); \

2052 
_¬gvec
[7] = ()(
¬g7
); \

2053 
_¬gvec
[8] = ()(
¬g8
); \

2054 
_¬gvec
[9] = ()(
¬g9
); \

2055 
_¬gvec
[10] = ()(
¬g10
); \

2056 
_¬gvec
[11] = ()(
¬g11
); \

2057 
__asm__
 volatile( \

2058 
VALGRIND_CFI_PROLOGUE
 \

2059 
VALGRIND_ALIGN_STACK
 \

2073 
VALGRIND_CALL_NOREDIR_RAX
 \

2074 
VALGRIND_RESTORE_STACK
 \

2075 
VALGRIND_CFI_EPILOGUE
 \

2076 : "÷" (
_»s
) \

2077 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

2078 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

2080 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2081 } 0)

	)

2083 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2084 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
,
¬g12
) \

2086 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2087 vŞ©
_¬gvec
[13]; \

2088 vŞ©
_»s
; \

2089 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2090 
_¬gvec
[1] = ()(
¬g1
); \

2091 
_¬gvec
[2] = ()(
¬g2
); \

2092 
_¬gvec
[3] = ()(
¬g3
); \

2093 
_¬gvec
[4] = ()(
¬g4
); \

2094 
_¬gvec
[5] = ()(
¬g5
); \

2095 
_¬gvec
[6] = ()(
¬g6
); \

2096 
_¬gvec
[7] = ()(
¬g7
); \

2097 
_¬gvec
[8] = ()(
¬g8
); \

2098 
_¬gvec
[9] = ()(
¬g9
); \

2099 
_¬gvec
[10] = ()(
¬g10
); \

2100 
_¬gvec
[11] = ()(
¬g11
); \

2101 
_¬gvec
[12] = ()(
¬g12
); \

2102 
__asm__
 volatile( \

2103 
VALGRIND_CFI_PROLOGUE
 \

2104 
VALGRIND_ALIGN_STACK
 \

2119 
VALGRIND_CALL_NOREDIR_RAX
 \

2120 
VALGRIND_RESTORE_STACK
 \

2121 
VALGRIND_CFI_EPILOGUE
 \

2122 : "÷" (
_»s
) \

2123 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

2124 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r14", "r15" \

2126 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2127 } 0)

	)

2133 #ià
defšed
(
PLAT_µc32_lšux
)

2159 
	#__CALLER_SAVED_REGS
 \

2163 "r11", "r12", "r13"

	)

2170 
	#VALGRIND_ALIGN_STACK
 \

2172 "¾wšm 1,1,0,0,27\n\t"

	)

2173 
	#VALGRIND_RESTORE_STACK
 \

2174 "m¸1,28\n\t"

	)

2179 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

2181 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2182 vŞ©
_¬gvec
[1]; \

2183 vŞ©
_»s
; \

2184 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2185 
__asm__
 volatile( \

2186 
VALGRIND_ALIGN_STACK
 \

2189 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2190 
VALGRIND_RESTORE_STACK
 \

2192 : "ô" (
_»s
) \

2193 : "r" (&
_¬gvec
[0]) \

2194 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2196 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2197 } 0)

	)

2199 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

2201 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2202 vŞ©
_¬gvec
[2]; \

2203 vŞ©
_»s
; \

2204 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2205 
_¬gvec
[1] = ()
¬g1
; \

2206 
__asm__
 volatile( \

2207 
VALGRIND_ALIGN_STACK
 \

2211 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2212 
VALGRIND_RESTORE_STACK
 \

2214 : "ô" (
_»s
) \

2215 : "r" (&
_¬gvec
[0]) \

2216 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2218 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2219 } 0)

	)

2221 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
) \

2223 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2224 vŞ©
_¬gvec
[3]; \

2225 vŞ©
_»s
; \

2226 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2227 
_¬gvec
[1] = ()
¬g1
; \

2228 
_¬gvec
[2] = ()
¬g2
; \

2229 
__asm__
 volatile( \

2230 
VALGRIND_ALIGN_STACK
 \

2235 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2236 
VALGRIND_RESTORE_STACK
 \

2238 : "ô" (
_»s
) \

2239 : "r" (&
_¬gvec
[0]) \

2240 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2242 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2243 } 0)

	)

2245 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
) \

2247 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2248 vŞ©
_¬gvec
[4]; \

2249 vŞ©
_»s
; \

2250 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2251 
_¬gvec
[1] = ()
¬g1
; \

2252 
_¬gvec
[2] = ()
¬g2
; \

2253 
_¬gvec
[3] = ()
¬g3
; \

2254 
__asm__
 volatile( \

2255 
VALGRIND_ALIGN_STACK
 \

2261 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2262 
VALGRIND_RESTORE_STACK
 \

2264 : "ô" (
_»s
) \

2265 : "r" (&
_¬gvec
[0]) \

2266 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2268 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2269 } 0)

	)

2271 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

2273 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2274 vŞ©
_¬gvec
[5]; \

2275 vŞ©
_»s
; \

2276 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2277 
_¬gvec
[1] = ()
¬g1
; \

2278 
_¬gvec
[2] = ()
¬g2
; \

2279 
_¬gvec
[3] = ()
¬g3
; \

2280 
_¬gvec
[4] = ()
¬g4
; \

2281 
__asm__
 volatile( \

2282 
VALGRIND_ALIGN_STACK
 \

2289 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2290 
VALGRIND_RESTORE_STACK
 \

2292 : "ô" (
_»s
) \

2293 : "r" (&
_¬gvec
[0]) \

2294 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2296 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2297 } 0)

	)

2299 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

2301 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2302 vŞ©
_¬gvec
[6]; \

2303 vŞ©
_»s
; \

2304 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2305 
_¬gvec
[1] = ()
¬g1
; \

2306 
_¬gvec
[2] = ()
¬g2
; \

2307 
_¬gvec
[3] = ()
¬g3
; \

2308 
_¬gvec
[4] = ()
¬g4
; \

2309 
_¬gvec
[5] = ()
¬g5
; \

2310 
__asm__
 volatile( \

2311 
VALGRIND_ALIGN_STACK
 \

2319 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2320 
VALGRIND_RESTORE_STACK
 \

2322 : "ô" (
_»s
) \

2323 : "r" (&
_¬gvec
[0]) \

2324 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2326 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2327 } 0)

	)

2329 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

2331 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2332 vŞ©
_¬gvec
[7]; \

2333 vŞ©
_»s
; \

2334 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2335 
_¬gvec
[1] = ()
¬g1
; \

2336 
_¬gvec
[2] = ()
¬g2
; \

2337 
_¬gvec
[3] = ()
¬g3
; \

2338 
_¬gvec
[4] = ()
¬g4
; \

2339 
_¬gvec
[5] = ()
¬g5
; \

2340 
_¬gvec
[6] = ()
¬g6
; \

2341 
__asm__
 volatile( \

2342 
VALGRIND_ALIGN_STACK
 \

2351 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2352 
VALGRIND_RESTORE_STACK
 \

2354 : "ô" (
_»s
) \

2355 : "r" (&
_¬gvec
[0]) \

2356 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2358 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2359 } 0)

	)

2361 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2362 
¬g7
) \

2364 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2365 vŞ©
_¬gvec
[8]; \

2366 vŞ©
_»s
; \

2367 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2368 
_¬gvec
[1] = ()
¬g1
; \

2369 
_¬gvec
[2] = ()
¬g2
; \

2370 
_¬gvec
[3] = ()
¬g3
; \

2371 
_¬gvec
[4] = ()
¬g4
; \

2372 
_¬gvec
[5] = ()
¬g5
; \

2373 
_¬gvec
[6] = ()
¬g6
; \

2374 
_¬gvec
[7] = ()
¬g7
; \

2375 
__asm__
 volatile( \

2376 
VALGRIND_ALIGN_STACK
 \

2386 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2387 
VALGRIND_RESTORE_STACK
 \

2389 : "ô" (
_»s
) \

2390 : "r" (&
_¬gvec
[0]) \

2391 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2393 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2394 } 0)

	)

2396 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2397 
¬g7
,
¬g8
) \

2399 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2400 vŞ©
_¬gvec
[9]; \

2401 vŞ©
_»s
; \

2402 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2403 
_¬gvec
[1] = ()
¬g1
; \

2404 
_¬gvec
[2] = ()
¬g2
; \

2405 
_¬gvec
[3] = ()
¬g3
; \

2406 
_¬gvec
[4] = ()
¬g4
; \

2407 
_¬gvec
[5] = ()
¬g5
; \

2408 
_¬gvec
[6] = ()
¬g6
; \

2409 
_¬gvec
[7] = ()
¬g7
; \

2410 
_¬gvec
[8] = ()
¬g8
; \

2411 
__asm__
 volatile( \

2412 
VALGRIND_ALIGN_STACK
 \

2423 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2424 
VALGRIND_RESTORE_STACK
 \

2426 : "ô" (
_»s
) \

2427 : "r" (&
_¬gvec
[0]) \

2428 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2430 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2431 } 0)

	)

2433 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2434 
¬g7
,
¬g8
,
¬g9
) \

2436 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2437 vŞ©
_¬gvec
[10]; \

2438 vŞ©
_»s
; \

2439 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2440 
_¬gvec
[1] = ()
¬g1
; \

2441 
_¬gvec
[2] = ()
¬g2
; \

2442 
_¬gvec
[3] = ()
¬g3
; \

2443 
_¬gvec
[4] = ()
¬g4
; \

2444 
_¬gvec
[5] = ()
¬g5
; \

2445 
_¬gvec
[6] = ()
¬g6
; \

2446 
_¬gvec
[7] = ()
¬g7
; \

2447 
_¬gvec
[8] = ()
¬g8
; \

2448 
_¬gvec
[9] = ()
¬g9
; \

2449 
__asm__
 volatile( \

2450 
VALGRIND_ALIGN_STACK
 \

2466 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2467 
VALGRIND_RESTORE_STACK
 \

2469 : "ô" (
_»s
) \

2470 : "r" (&
_¬gvec
[0]) \

2471 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2473 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2474 } 0)

	)

2476 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2477 
¬g7
,
¬g8
,
¬g9
,
¬g10
) \

2479 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2480 vŞ©
_¬gvec
[11]; \

2481 vŞ©
_»s
; \

2482 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2483 
_¬gvec
[1] = ()
¬g1
; \

2484 
_¬gvec
[2] = ()
¬g2
; \

2485 
_¬gvec
[3] = ()
¬g3
; \

2486 
_¬gvec
[4] = ()
¬g4
; \

2487 
_¬gvec
[5] = ()
¬g5
; \

2488 
_¬gvec
[6] = ()
¬g6
; \

2489 
_¬gvec
[7] = ()
¬g7
; \

2490 
_¬gvec
[8] = ()
¬g8
; \

2491 
_¬gvec
[9] = ()
¬g9
; \

2492 
_¬gvec
[10] = ()
¬g10
; \

2493 
__asm__
 volatile( \

2494 
VALGRIND_ALIGN_STACK
 \

2513 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2514 
VALGRIND_RESTORE_STACK
 \

2516 : "ô" (
_»s
) \

2517 : "r" (&
_¬gvec
[0]) \

2518 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2520 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2521 } 0)

	)

2523 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2524 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
) \

2526 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2527 vŞ©
_¬gvec
[12]; \

2528 vŞ©
_»s
; \

2529 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2530 
_¬gvec
[1] = ()
¬g1
; \

2531 
_¬gvec
[2] = ()
¬g2
; \

2532 
_¬gvec
[3] = ()
¬g3
; \

2533 
_¬gvec
[4] = ()
¬g4
; \

2534 
_¬gvec
[5] = ()
¬g5
; \

2535 
_¬gvec
[6] = ()
¬g6
; \

2536 
_¬gvec
[7] = ()
¬g7
; \

2537 
_¬gvec
[8] = ()
¬g8
; \

2538 
_¬gvec
[9] = ()
¬g9
; \

2539 
_¬gvec
[10] = ()
¬g10
; \

2540 
_¬gvec
[11] = ()
¬g11
; \

2541 
__asm__
 volatile( \

2542 
VALGRIND_ALIGN_STACK
 \

2564 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2565 
VALGRIND_RESTORE_STACK
 \

2567 : "ô" (
_»s
) \

2568 : "r" (&
_¬gvec
[0]) \

2569 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2571 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2572 } 0)

	)

2574 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2575 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
,
¬g12
) \

2577 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2578 vŞ©
_¬gvec
[13]; \

2579 vŞ©
_»s
; \

2580 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

2581 
_¬gvec
[1] = ()
¬g1
; \

2582 
_¬gvec
[2] = ()
¬g2
; \

2583 
_¬gvec
[3] = ()
¬g3
; \

2584 
_¬gvec
[4] = ()
¬g4
; \

2585 
_¬gvec
[5] = ()
¬g5
; \

2586 
_¬gvec
[6] = ()
¬g6
; \

2587 
_¬gvec
[7] = ()
¬g7
; \

2588 
_¬gvec
[8] = ()
¬g8
; \

2589 
_¬gvec
[9] = ()
¬g9
; \

2590 
_¬gvec
[10] = ()
¬g10
; \

2591 
_¬gvec
[11] = ()
¬g11
; \

2592 
_¬gvec
[12] = ()
¬g12
; \

2593 
__asm__
 volatile( \

2594 
VALGRIND_ALIGN_STACK
 \

2619 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2620 
VALGRIND_RESTORE_STACK
 \

2622 : "ô" (
_»s
) \

2623 : "r" (&
_¬gvec
[0]) \

2624 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2626 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2627 } 0)

	)

2633 #ià
defšed
(
PLAT_µc64be_lšux
)

2638 
	#__CALLER_SAVED_REGS
 \

2642 "r11", "r12", "r13"

	)

2649 
	#VALGRIND_ALIGN_STACK
 \

2651 "¾diü 1,1,0,59\n\t"

	)

2652 
	#VALGRIND_RESTORE_STACK
 \

2653 "m¸1,28\n\t"

	)

2658 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

2660 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2661 vŞ©
_¬gvec
[3+0]; \

2662 vŞ©
_»s
; \

2664 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2665 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2666 
__asm__
 volatile( \

2667 
VALGRIND_ALIGN_STACK
 \

2672 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2676 
VALGRIND_RESTORE_STACK
 \

2677 : "ô" (
_»s
) \

2678 : "r" (&
_¬gvec
[2]) \

2679 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2681 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2682 } 0)

	)

2684 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

2686 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2687 vŞ©
_¬gvec
[3+1]; \

2688 vŞ©
_»s
; \

2690 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2691 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2692 
_¬gvec
[2+1] = ()
¬g1
; \

2693 
__asm__
 volatile( \

2694 
VALGRIND_ALIGN_STACK
 \

2700 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2704 
VALGRIND_RESTORE_STACK
 \

2705 : "ô" (
_»s
) \

2706 : "r" (&
_¬gvec
[2]) \

2707 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2709 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2710 } 0)

	)

2712 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
) \

2714 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2715 vŞ©
_¬gvec
[3+2]; \

2716 vŞ©
_»s
; \

2718 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2719 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2720 
_¬gvec
[2+1] = ()
¬g1
; \

2721 
_¬gvec
[2+2] = ()
¬g2
; \

2722 
__asm__
 volatile( \

2723 
VALGRIND_ALIGN_STACK
 \

2730 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2734 
VALGRIND_RESTORE_STACK
 \

2735 : "ô" (
_»s
) \

2736 : "r" (&
_¬gvec
[2]) \

2737 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2739 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2740 } 0)

	)

2742 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
) \

2744 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2745 vŞ©
_¬gvec
[3+3]; \

2746 vŞ©
_»s
; \

2748 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2749 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2750 
_¬gvec
[2+1] = ()
¬g1
; \

2751 
_¬gvec
[2+2] = ()
¬g2
; \

2752 
_¬gvec
[2+3] = ()
¬g3
; \

2753 
__asm__
 volatile( \

2754 
VALGRIND_ALIGN_STACK
 \

2762 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2766 
VALGRIND_RESTORE_STACK
 \

2767 : "ô" (
_»s
) \

2768 : "r" (&
_¬gvec
[2]) \

2769 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2771 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2772 } 0)

	)

2774 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

2776 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2777 vŞ©
_¬gvec
[3+4]; \

2778 vŞ©
_»s
; \

2780 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2781 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2782 
_¬gvec
[2+1] = ()
¬g1
; \

2783 
_¬gvec
[2+2] = ()
¬g2
; \

2784 
_¬gvec
[2+3] = ()
¬g3
; \

2785 
_¬gvec
[2+4] = ()
¬g4
; \

2786 
__asm__
 volatile( \

2787 
VALGRIND_ALIGN_STACK
 \

2796 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2800 
VALGRIND_RESTORE_STACK
 \

2801 : "ô" (
_»s
) \

2802 : "r" (&
_¬gvec
[2]) \

2803 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2805 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2806 } 0)

	)

2808 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

2810 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2811 vŞ©
_¬gvec
[3+5]; \

2812 vŞ©
_»s
; \

2814 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2815 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2816 
_¬gvec
[2+1] = ()
¬g1
; \

2817 
_¬gvec
[2+2] = ()
¬g2
; \

2818 
_¬gvec
[2+3] = ()
¬g3
; \

2819 
_¬gvec
[2+4] = ()
¬g4
; \

2820 
_¬gvec
[2+5] = ()
¬g5
; \

2821 
__asm__
 volatile( \

2822 
VALGRIND_ALIGN_STACK
 \

2832 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2836 
VALGRIND_RESTORE_STACK
 \

2837 : "ô" (
_»s
) \

2838 : "r" (&
_¬gvec
[2]) \

2839 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2841 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2842 } 0)

	)

2844 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

2846 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2847 vŞ©
_¬gvec
[3+6]; \

2848 vŞ©
_»s
; \

2850 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2851 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2852 
_¬gvec
[2+1] = ()
¬g1
; \

2853 
_¬gvec
[2+2] = ()
¬g2
; \

2854 
_¬gvec
[2+3] = ()
¬g3
; \

2855 
_¬gvec
[2+4] = ()
¬g4
; \

2856 
_¬gvec
[2+5] = ()
¬g5
; \

2857 
_¬gvec
[2+6] = ()
¬g6
; \

2858 
__asm__
 volatile( \

2859 
VALGRIND_ALIGN_STACK
 \

2870 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2874 
VALGRIND_RESTORE_STACK
 \

2875 : "ô" (
_»s
) \

2876 : "r" (&
_¬gvec
[2]) \

2877 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2879 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2880 } 0)

	)

2882 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2883 
¬g7
) \

2885 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2886 vŞ©
_¬gvec
[3+7]; \

2887 vŞ©
_»s
; \

2889 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2890 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2891 
_¬gvec
[2+1] = ()
¬g1
; \

2892 
_¬gvec
[2+2] = ()
¬g2
; \

2893 
_¬gvec
[2+3] = ()
¬g3
; \

2894 
_¬gvec
[2+4] = ()
¬g4
; \

2895 
_¬gvec
[2+5] = ()
¬g5
; \

2896 
_¬gvec
[2+6] = ()
¬g6
; \

2897 
_¬gvec
[2+7] = ()
¬g7
; \

2898 
__asm__
 volatile( \

2899 
VALGRIND_ALIGN_STACK
 \

2911 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2915 
VALGRIND_RESTORE_STACK
 \

2916 : "ô" (
_»s
) \

2917 : "r" (&
_¬gvec
[2]) \

2918 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2920 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2921 } 0)

	)

2923 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2924 
¬g7
,
¬g8
) \

2926 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2927 vŞ©
_¬gvec
[3+8]; \

2928 vŞ©
_»s
; \

2930 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2931 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2932 
_¬gvec
[2+1] = ()
¬g1
; \

2933 
_¬gvec
[2+2] = ()
¬g2
; \

2934 
_¬gvec
[2+3] = ()
¬g3
; \

2935 
_¬gvec
[2+4] = ()
¬g4
; \

2936 
_¬gvec
[2+5] = ()
¬g5
; \

2937 
_¬gvec
[2+6] = ()
¬g6
; \

2938 
_¬gvec
[2+7] = ()
¬g7
; \

2939 
_¬gvec
[2+8] = ()
¬g8
; \

2940 
__asm__
 volatile( \

2941 
VALGRIND_ALIGN_STACK
 \

2954 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

2958 
VALGRIND_RESTORE_STACK
 \

2959 : "ô" (
_»s
) \

2960 : "r" (&
_¬gvec
[2]) \

2961 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

2963 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

2964 } 0)

	)

2966 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

2967 
¬g7
,
¬g8
,
¬g9
) \

2969 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

2970 vŞ©
_¬gvec
[3+9]; \

2971 vŞ©
_»s
; \

2973 
_¬gvec
[1] = ()
_Üig
.
r2
; \

2974 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

2975 
_¬gvec
[2+1] = ()
¬g1
; \

2976 
_¬gvec
[2+2] = ()
¬g2
; \

2977 
_¬gvec
[2+3] = ()
¬g3
; \

2978 
_¬gvec
[2+4] = ()
¬g4
; \

2979 
_¬gvec
[2+5] = ()
¬g5
; \

2980 
_¬gvec
[2+6] = ()
¬g6
; \

2981 
_¬gvec
[2+7] = ()
¬g7
; \

2982 
_¬gvec
[2+8] = ()
¬g8
; \

2983 
_¬gvec
[2+9] = ()
¬g9
; \

2984 
__asm__
 volatile( \

2985 
VALGRIND_ALIGN_STACK
 \

3003 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

3007 
VALGRIND_RESTORE_STACK
 \

3008 : "ô" (
_»s
) \

3009 : "r" (&
_¬gvec
[2]) \

3010 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3012 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3013 } 0)

	)

3015 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3016 
¬g7
,
¬g8
,
¬g9
,
¬g10
) \

3018 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3019 vŞ©
_¬gvec
[3+10]; \

3020 vŞ©
_»s
; \

3022 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3023 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3024 
_¬gvec
[2+1] = ()
¬g1
; \

3025 
_¬gvec
[2+2] = ()
¬g2
; \

3026 
_¬gvec
[2+3] = ()
¬g3
; \

3027 
_¬gvec
[2+4] = ()
¬g4
; \

3028 
_¬gvec
[2+5] = ()
¬g5
; \

3029 
_¬gvec
[2+6] = ()
¬g6
; \

3030 
_¬gvec
[2+7] = ()
¬g7
; \

3031 
_¬gvec
[2+8] = ()
¬g8
; \

3032 
_¬gvec
[2+9] = ()
¬g9
; \

3033 
_¬gvec
[2+10] = ()
¬g10
; \

3034 
__asm__
 volatile( \

3035 
VALGRIND_ALIGN_STACK
 \

3056 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

3060 
VALGRIND_RESTORE_STACK
 \

3061 : "ô" (
_»s
) \

3062 : "r" (&
_¬gvec
[2]) \

3063 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3065 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3066 } 0)

	)

3068 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3069 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
) \

3071 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3072 vŞ©
_¬gvec
[3+11]; \

3073 vŞ©
_»s
; \

3075 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3076 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3077 
_¬gvec
[2+1] = ()
¬g1
; \

3078 
_¬gvec
[2+2] = ()
¬g2
; \

3079 
_¬gvec
[2+3] = ()
¬g3
; \

3080 
_¬gvec
[2+4] = ()
¬g4
; \

3081 
_¬gvec
[2+5] = ()
¬g5
; \

3082 
_¬gvec
[2+6] = ()
¬g6
; \

3083 
_¬gvec
[2+7] = ()
¬g7
; \

3084 
_¬gvec
[2+8] = ()
¬g8
; \

3085 
_¬gvec
[2+9] = ()
¬g9
; \

3086 
_¬gvec
[2+10] = ()
¬g10
; \

3087 
_¬gvec
[2+11] = ()
¬g11
; \

3088 
__asm__
 volatile( \

3089 
VALGRIND_ALIGN_STACK
 \

3113 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

3117 
VALGRIND_RESTORE_STACK
 \

3118 : "ô" (
_»s
) \

3119 : "r" (&
_¬gvec
[2]) \

3120 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3122 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3123 } 0)

	)

3125 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3126 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
,
¬g12
) \

3128 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3129 vŞ©
_¬gvec
[3+12]; \

3130 vŞ©
_»s
; \

3132 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3133 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3134 
_¬gvec
[2+1] = ()
¬g1
; \

3135 
_¬gvec
[2+2] = ()
¬g2
; \

3136 
_¬gvec
[2+3] = ()
¬g3
; \

3137 
_¬gvec
[2+4] = ()
¬g4
; \

3138 
_¬gvec
[2+5] = ()
¬g5
; \

3139 
_¬gvec
[2+6] = ()
¬g6
; \

3140 
_¬gvec
[2+7] = ()
¬g7
; \

3141 
_¬gvec
[2+8] = ()
¬g8
; \

3142 
_¬gvec
[2+9] = ()
¬g9
; \

3143 
_¬gvec
[2+10] = ()
¬g10
; \

3144 
_¬gvec
[2+11] = ()
¬g11
; \

3145 
_¬gvec
[2+12] = ()
¬g12
; \

3146 
__asm__
 volatile( \

3147 
VALGRIND_ALIGN_STACK
 \

3174 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R11
 \

3178 
VALGRIND_RESTORE_STACK
 \

3179 : "ô" (
_»s
) \

3180 : "r" (&
_¬gvec
[2]) \

3181 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3183 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3184 } 0)

	)

3189 #ià
defšed
(
PLAT_µc64Ë_lšux
)

3194 
	#__CALLER_SAVED_REGS
 \

3198 "r11", "r12", "r13"

	)

3205 
	#VALGRIND_ALIGN_STACK
 \

3207 "¾diü 1,1,0,59\n\t"

	)

3208 
	#VALGRIND_RESTORE_STACK
 \

3209 "m¸1,28\n\t"

	)

3214 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

3216 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3217 vŞ©
_¬gvec
[3+0]; \

3218 vŞ©
_»s
; \

3220 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3221 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3222 
__asm__
 volatile( \

3223 
VALGRIND_ALIGN_STACK
 \

3228 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3232 
VALGRIND_RESTORE_STACK
 \

3233 : "ô" (
_»s
) \

3234 : "r" (&
_¬gvec
[2]) \

3235 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3237 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3238 } 0)

	)

3240 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

3242 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3243 vŞ©
_¬gvec
[3+1]; \

3244 vŞ©
_»s
; \

3246 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3247 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3248 
_¬gvec
[2+1] = ()
¬g1
; \

3249 
__asm__
 volatile( \

3250 
VALGRIND_ALIGN_STACK
 \

3256 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3260 
VALGRIND_RESTORE_STACK
 \

3261 : "ô" (
_»s
) \

3262 : "r" (&
_¬gvec
[2]) \

3263 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3265 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3266 } 0)

	)

3268 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
) \

3270 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3271 vŞ©
_¬gvec
[3+2]; \

3272 vŞ©
_»s
; \

3274 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3275 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3276 
_¬gvec
[2+1] = ()
¬g1
; \

3277 
_¬gvec
[2+2] = ()
¬g2
; \

3278 
__asm__
 volatile( \

3279 
VALGRIND_ALIGN_STACK
 \

3286 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3290 
VALGRIND_RESTORE_STACK
 \

3291 : "ô" (
_»s
) \

3292 : "r" (&
_¬gvec
[2]) \

3293 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3295 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3296 } 0)

	)

3298 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
) \

3300 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3301 vŞ©
_¬gvec
[3+3]; \

3302 vŞ©
_»s
; \

3304 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3305 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3306 
_¬gvec
[2+1] = ()
¬g1
; \

3307 
_¬gvec
[2+2] = ()
¬g2
; \

3308 
_¬gvec
[2+3] = ()
¬g3
; \

3309 
__asm__
 volatile( \

3310 
VALGRIND_ALIGN_STACK
 \

3318 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3322 
VALGRIND_RESTORE_STACK
 \

3323 : "ô" (
_»s
) \

3324 : "r" (&
_¬gvec
[2]) \

3325 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3327 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3328 } 0)

	)

3330 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

3332 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3333 vŞ©
_¬gvec
[3+4]; \

3334 vŞ©
_»s
; \

3336 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3337 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3338 
_¬gvec
[2+1] = ()
¬g1
; \

3339 
_¬gvec
[2+2] = ()
¬g2
; \

3340 
_¬gvec
[2+3] = ()
¬g3
; \

3341 
_¬gvec
[2+4] = ()
¬g4
; \

3342 
__asm__
 volatile( \

3343 
VALGRIND_ALIGN_STACK
 \

3352 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3356 
VALGRIND_RESTORE_STACK
 \

3357 : "ô" (
_»s
) \

3358 : "r" (&
_¬gvec
[2]) \

3359 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3361 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3362 } 0)

	)

3364 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

3366 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3367 vŞ©
_¬gvec
[3+5]; \

3368 vŞ©
_»s
; \

3370 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3371 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3372 
_¬gvec
[2+1] = ()
¬g1
; \

3373 
_¬gvec
[2+2] = ()
¬g2
; \

3374 
_¬gvec
[2+3] = ()
¬g3
; \

3375 
_¬gvec
[2+4] = ()
¬g4
; \

3376 
_¬gvec
[2+5] = ()
¬g5
; \

3377 
__asm__
 volatile( \

3378 
VALGRIND_ALIGN_STACK
 \

3388 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3392 
VALGRIND_RESTORE_STACK
 \

3393 : "ô" (
_»s
) \

3394 : "r" (&
_¬gvec
[2]) \

3395 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3397 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3398 } 0)

	)

3400 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

3402 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3403 vŞ©
_¬gvec
[3+6]; \

3404 vŞ©
_»s
; \

3406 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3407 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3408 
_¬gvec
[2+1] = ()
¬g1
; \

3409 
_¬gvec
[2+2] = ()
¬g2
; \

3410 
_¬gvec
[2+3] = ()
¬g3
; \

3411 
_¬gvec
[2+4] = ()
¬g4
; \

3412 
_¬gvec
[2+5] = ()
¬g5
; \

3413 
_¬gvec
[2+6] = ()
¬g6
; \

3414 
__asm__
 volatile( \

3415 
VALGRIND_ALIGN_STACK
 \

3426 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3430 
VALGRIND_RESTORE_STACK
 \

3431 : "ô" (
_»s
) \

3432 : "r" (&
_¬gvec
[2]) \

3433 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3435 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3436 } 0)

	)

3438 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3439 
¬g7
) \

3441 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3442 vŞ©
_¬gvec
[3+7]; \

3443 vŞ©
_»s
; \

3445 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3446 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3447 
_¬gvec
[2+1] = ()
¬g1
; \

3448 
_¬gvec
[2+2] = ()
¬g2
; \

3449 
_¬gvec
[2+3] = ()
¬g3
; \

3450 
_¬gvec
[2+4] = ()
¬g4
; \

3451 
_¬gvec
[2+5] = ()
¬g5
; \

3452 
_¬gvec
[2+6] = ()
¬g6
; \

3453 
_¬gvec
[2+7] = ()
¬g7
; \

3454 
__asm__
 volatile( \

3455 
VALGRIND_ALIGN_STACK
 \

3467 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3471 
VALGRIND_RESTORE_STACK
 \

3472 : "ô" (
_»s
) \

3473 : "r" (&
_¬gvec
[2]) \

3474 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3476 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3477 } 0)

	)

3479 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3480 
¬g7
,
¬g8
) \

3482 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3483 vŞ©
_¬gvec
[3+8]; \

3484 vŞ©
_»s
; \

3486 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3487 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3488 
_¬gvec
[2+1] = ()
¬g1
; \

3489 
_¬gvec
[2+2] = ()
¬g2
; \

3490 
_¬gvec
[2+3] = ()
¬g3
; \

3491 
_¬gvec
[2+4] = ()
¬g4
; \

3492 
_¬gvec
[2+5] = ()
¬g5
; \

3493 
_¬gvec
[2+6] = ()
¬g6
; \

3494 
_¬gvec
[2+7] = ()
¬g7
; \

3495 
_¬gvec
[2+8] = ()
¬g8
; \

3496 
__asm__
 volatile( \

3497 
VALGRIND_ALIGN_STACK
 \

3510 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3514 
VALGRIND_RESTORE_STACK
 \

3515 : "ô" (
_»s
) \

3516 : "r" (&
_¬gvec
[2]) \

3517 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3519 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3520 } 0)

	)

3522 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3523 
¬g7
,
¬g8
,
¬g9
) \

3525 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3526 vŞ©
_¬gvec
[3+9]; \

3527 vŞ©
_»s
; \

3529 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3530 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3531 
_¬gvec
[2+1] = ()
¬g1
; \

3532 
_¬gvec
[2+2] = ()
¬g2
; \

3533 
_¬gvec
[2+3] = ()
¬g3
; \

3534 
_¬gvec
[2+4] = ()
¬g4
; \

3535 
_¬gvec
[2+5] = ()
¬g5
; \

3536 
_¬gvec
[2+6] = ()
¬g6
; \

3537 
_¬gvec
[2+7] = ()
¬g7
; \

3538 
_¬gvec
[2+8] = ()
¬g8
; \

3539 
_¬gvec
[2+9] = ()
¬g9
; \

3540 
__asm__
 volatile( \

3541 
VALGRIND_ALIGN_STACK
 \

3559 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3563 
VALGRIND_RESTORE_STACK
 \

3564 : "ô" (
_»s
) \

3565 : "r" (&
_¬gvec
[2]) \

3566 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3568 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3569 } 0)

	)

3571 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3572 
¬g7
,
¬g8
,
¬g9
,
¬g10
) \

3574 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3575 vŞ©
_¬gvec
[3+10]; \

3576 vŞ©
_»s
; \

3578 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3579 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3580 
_¬gvec
[2+1] = ()
¬g1
; \

3581 
_¬gvec
[2+2] = ()
¬g2
; \

3582 
_¬gvec
[2+3] = ()
¬g3
; \

3583 
_¬gvec
[2+4] = ()
¬g4
; \

3584 
_¬gvec
[2+5] = ()
¬g5
; \

3585 
_¬gvec
[2+6] = ()
¬g6
; \

3586 
_¬gvec
[2+7] = ()
¬g7
; \

3587 
_¬gvec
[2+8] = ()
¬g8
; \

3588 
_¬gvec
[2+9] = ()
¬g9
; \

3589 
_¬gvec
[2+10] = ()
¬g10
; \

3590 
__asm__
 volatile( \

3591 
VALGRIND_ALIGN_STACK
 \

3612 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3616 
VALGRIND_RESTORE_STACK
 \

3617 : "ô" (
_»s
) \

3618 : "r" (&
_¬gvec
[2]) \

3619 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3621 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3622 } 0)

	)

3624 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3625 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
) \

3627 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3628 vŞ©
_¬gvec
[3+11]; \

3629 vŞ©
_»s
; \

3631 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3632 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3633 
_¬gvec
[2+1] = ()
¬g1
; \

3634 
_¬gvec
[2+2] = ()
¬g2
; \

3635 
_¬gvec
[2+3] = ()
¬g3
; \

3636 
_¬gvec
[2+4] = ()
¬g4
; \

3637 
_¬gvec
[2+5] = ()
¬g5
; \

3638 
_¬gvec
[2+6] = ()
¬g6
; \

3639 
_¬gvec
[2+7] = ()
¬g7
; \

3640 
_¬gvec
[2+8] = ()
¬g8
; \

3641 
_¬gvec
[2+9] = ()
¬g9
; \

3642 
_¬gvec
[2+10] = ()
¬g10
; \

3643 
_¬gvec
[2+11] = ()
¬g11
; \

3644 
__asm__
 volatile( \

3645 
VALGRIND_ALIGN_STACK
 \

3669 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3673 
VALGRIND_RESTORE_STACK
 \

3674 : "ô" (
_»s
) \

3675 : "r" (&
_¬gvec
[2]) \

3676 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3678 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3679 } 0)

	)

3681 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3682 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
,
¬g12
) \

3684 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3685 vŞ©
_¬gvec
[3+12]; \

3686 vŞ©
_»s
; \

3688 
_¬gvec
[1] = ()
_Üig
.
r2
; \

3689 
_¬gvec
[2] = ()
_Üig
.
Äaddr
; \

3690 
_¬gvec
[2+1] = ()
¬g1
; \

3691 
_¬gvec
[2+2] = ()
¬g2
; \

3692 
_¬gvec
[2+3] = ()
¬g3
; \

3693 
_¬gvec
[2+4] = ()
¬g4
; \

3694 
_¬gvec
[2+5] = ()
¬g5
; \

3695 
_¬gvec
[2+6] = ()
¬g6
; \

3696 
_¬gvec
[2+7] = ()
¬g7
; \

3697 
_¬gvec
[2+8] = ()
¬g8
; \

3698 
_¬gvec
[2+9] = ()
¬g9
; \

3699 
_¬gvec
[2+10] = ()
¬g10
; \

3700 
_¬gvec
[2+11] = ()
¬g11
; \

3701 
_¬gvec
[2+12] = ()
¬g12
; \

3702 
__asm__
 volatile( \

3703 
VALGRIND_ALIGN_STACK
 \

3730 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R12
 \

3734 
VALGRIND_RESTORE_STACK
 \

3735 : "ô" (
_»s
) \

3736 : "r" (&
_¬gvec
[2]) \

3737 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r28" \

3739 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3740 } 0)

	)

3746 #ià
defšed
(
PLAT_¬m_lšux
)

3749 
	#__CALLER_SAVED_REGS
 "r0", "r1", "r2", "r3","r4", "r12", "r14"

	)

3764 
	#VALGRIND_ALIGN_STACK
 \

3768 "mov sp,„4\n\t"

	)

3769 
	#VALGRIND_RESTORE_STACK
 \

3770 "mov sp,„10\n\t"

	)

3775 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

3777 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3778 vŞ©
_¬gvec
[1]; \

3779 vŞ©
_»s
; \

3780 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

3781 
__asm__
 volatile( \

3782 
VALGRIND_ALIGN_STACK
 \

3784 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3785 
VALGRIND_RESTORE_STACK
 \

3787 : "ô" (
_»s
) \

3788 : "0" (&
_¬gvec
[0]) \

3789 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

3791 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3792 } 0)

	)

3794 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

3796 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3797 vŞ©
_¬gvec
[2]; \

3798 vŞ©
_»s
; \

3799 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

3800 
_¬gvec
[1] = ()(
¬g1
); \

3801 
__asm__
 volatile( \

3802 
VALGRIND_ALIGN_STACK
 \

3805 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3806 
VALGRIND_RESTORE_STACK
 \

3808 : "ô" (
_»s
) \

3809 : "0" (&
_¬gvec
[0]) \

3810 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

3812 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3813 } 0)

	)

3815 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
) \

3817 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3818 vŞ©
_¬gvec
[3]; \

3819 vŞ©
_»s
; \

3820 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

3821 
_¬gvec
[1] = ()(
¬g1
); \

3822 
_¬gvec
[2] = ()(
¬g2
); \

3823 
__asm__
 volatile( \

3824 
VALGRIND_ALIGN_STACK
 \

3828 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3829 
VALGRIND_RESTORE_STACK
 \

3831 : "ô" (
_»s
) \

3832 : "0" (&
_¬gvec
[0]) \

3833 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

3835 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3836 } 0)

	)

3838 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
) \

3840 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3841 vŞ©
_¬gvec
[4]; \

3842 vŞ©
_»s
; \

3843 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

3844 
_¬gvec
[1] = ()(
¬g1
); \

3845 
_¬gvec
[2] = ()(
¬g2
); \

3846 
_¬gvec
[3] = ()(
¬g3
); \

3847 
__asm__
 volatile( \

3848 
VALGRIND_ALIGN_STACK
 \

3853 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3854 
VALGRIND_RESTORE_STACK
 \

3856 : "ô" (
_»s
) \

3857 : "0" (&
_¬gvec
[0]) \

3858 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

3860 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3861 } 0)

	)

3863 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

3865 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3866 vŞ©
_¬gvec
[5]; \

3867 vŞ©
_»s
; \

3868 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

3869 
_¬gvec
[1] = ()(
¬g1
); \

3870 
_¬gvec
[2] = ()(
¬g2
); \

3871 
_¬gvec
[3] = ()(
¬g3
); \

3872 
_¬gvec
[4] = ()(
¬g4
); \

3873 
__asm__
 volatile( \

3874 
VALGRIND_ALIGN_STACK
 \

3880 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3881 
VALGRIND_RESTORE_STACK
 \

3883 : "ô" (
_»s
) \

3884 : "0" (&
_¬gvec
[0]) \

3885 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

3887 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3888 } 0)

	)

3890 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

3892 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3893 vŞ©
_¬gvec
[6]; \

3894 vŞ©
_»s
; \

3895 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

3896 
_¬gvec
[1] = ()(
¬g1
); \

3897 
_¬gvec
[2] = ()(
¬g2
); \

3898 
_¬gvec
[3] = ()(
¬g3
); \

3899 
_¬gvec
[4] = ()(
¬g4
); \

3900 
_¬gvec
[5] = ()(
¬g5
); \

3901 
__asm__
 volatile( \

3902 
VALGRIND_ALIGN_STACK
 \

3911 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3912 
VALGRIND_RESTORE_STACK
 \

3914 : "ô" (
_»s
) \

3915 : "0" (&
_¬gvec
[0]) \

3916 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

3918 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3919 } 0)

	)

3921 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

3923 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3924 vŞ©
_¬gvec
[7]; \

3925 vŞ©
_»s
; \

3926 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

3927 
_¬gvec
[1] = ()(
¬g1
); \

3928 
_¬gvec
[2] = ()(
¬g2
); \

3929 
_¬gvec
[3] = ()(
¬g3
); \

3930 
_¬gvec
[4] = ()(
¬g4
); \

3931 
_¬gvec
[5] = ()(
¬g5
); \

3932 
_¬gvec
[6] = ()(
¬g6
); \

3933 
__asm__
 volatile( \

3934 
VALGRIND_ALIGN_STACK
 \

3943 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3944 
VALGRIND_RESTORE_STACK
 \

3946 : "ô" (
_»s
) \

3947 : "0" (&
_¬gvec
[0]) \

3948 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

3950 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3951 } 0)

	)

3953 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3954 
¬g7
) \

3956 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3957 vŞ©
_¬gvec
[8]; \

3958 vŞ©
_»s
; \

3959 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

3960 
_¬gvec
[1] = ()(
¬g1
); \

3961 
_¬gvec
[2] = ()(
¬g2
); \

3962 
_¬gvec
[3] = ()(
¬g3
); \

3963 
_¬gvec
[4] = ()(
¬g4
); \

3964 
_¬gvec
[5] = ()(
¬g5
); \

3965 
_¬gvec
[6] = ()(
¬g6
); \

3966 
_¬gvec
[7] = ()(
¬g7
); \

3967 
__asm__
 volatile( \

3968 
VALGRIND_ALIGN_STACK
 \

3979 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

3980 
VALGRIND_RESTORE_STACK
 \

3982 : "ô" (
_»s
) \

3983 : "0" (&
_¬gvec
[0]) \

3984 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

3986 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

3987 } 0)

	)

3989 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

3990 
¬g7
,
¬g8
) \

3992 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

3993 vŞ©
_¬gvec
[9]; \

3994 vŞ©
_»s
; \

3995 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

3996 
_¬gvec
[1] = ()(
¬g1
); \

3997 
_¬gvec
[2] = ()(
¬g2
); \

3998 
_¬gvec
[3] = ()(
¬g3
); \

3999 
_¬gvec
[4] = ()(
¬g4
); \

4000 
_¬gvec
[5] = ()(
¬g5
); \

4001 
_¬gvec
[6] = ()(
¬g6
); \

4002 
_¬gvec
[7] = ()(
¬g7
); \

4003 
_¬gvec
[8] = ()(
¬g8
); \

4004 
__asm__
 volatile( \

4005 
VALGRIND_ALIGN_STACK
 \

4016 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4017 
VALGRIND_RESTORE_STACK
 \

4019 : "ô" (
_»s
) \

4020 : "0" (&
_¬gvec
[0]) \

4021 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

4023 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4024 } 0)

	)

4026 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

4027 
¬g7
,
¬g8
,
¬g9
) \

4029 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4030 vŞ©
_¬gvec
[10]; \

4031 vŞ©
_»s
; \

4032 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4033 
_¬gvec
[1] = ()(
¬g1
); \

4034 
_¬gvec
[2] = ()(
¬g2
); \

4035 
_¬gvec
[3] = ()(
¬g3
); \

4036 
_¬gvec
[4] = ()(
¬g4
); \

4037 
_¬gvec
[5] = ()(
¬g5
); \

4038 
_¬gvec
[6] = ()(
¬g6
); \

4039 
_¬gvec
[7] = ()(
¬g7
); \

4040 
_¬gvec
[8] = ()(
¬g8
); \

4041 
_¬gvec
[9] = ()(
¬g9
); \

4042 
__asm__
 volatile( \

4043 
VALGRIND_ALIGN_STACK
 \

4056 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4057 
VALGRIND_RESTORE_STACK
 \

4059 : "ô" (
_»s
) \

4060 : "0" (&
_¬gvec
[0]) \

4061 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

4063 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4064 } 0)

	)

4066 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

4067 
¬g7
,
¬g8
,
¬g9
,
¬g10
) \

4069 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4070 vŞ©
_¬gvec
[11]; \

4071 vŞ©
_»s
; \

4072 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4073 
_¬gvec
[1] = ()(
¬g1
); \

4074 
_¬gvec
[2] = ()(
¬g2
); \

4075 
_¬gvec
[3] = ()(
¬g3
); \

4076 
_¬gvec
[4] = ()(
¬g4
); \

4077 
_¬gvec
[5] = ()(
¬g5
); \

4078 
_¬gvec
[6] = ()(
¬g6
); \

4079 
_¬gvec
[7] = ()(
¬g7
); \

4080 
_¬gvec
[8] = ()(
¬g8
); \

4081 
_¬gvec
[9] = ()(
¬g9
); \

4082 
_¬gvec
[10] = ()(
¬g10
); \

4083 
__asm__
 volatile( \

4084 
VALGRIND_ALIGN_STACK
 \

4098 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4099 
VALGRIND_RESTORE_STACK
 \

4101 : "ô" (
_»s
) \

4102 : "0" (&
_¬gvec
[0]) \

4103 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

4105 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4106 } 0)

	)

4108 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
, \

4109 
¬g6
,
¬g7
,
¬g8
,
¬g9
,
¬g10
, \

4110 
¬g11
) \

4112 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4113 vŞ©
_¬gvec
[12]; \

4114 vŞ©
_»s
; \

4115 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4116 
_¬gvec
[1] = ()(
¬g1
); \

4117 
_¬gvec
[2] = ()(
¬g2
); \

4118 
_¬gvec
[3] = ()(
¬g3
); \

4119 
_¬gvec
[4] = ()(
¬g4
); \

4120 
_¬gvec
[5] = ()(
¬g5
); \

4121 
_¬gvec
[6] = ()(
¬g6
); \

4122 
_¬gvec
[7] = ()(
¬g7
); \

4123 
_¬gvec
[8] = ()(
¬g8
); \

4124 
_¬gvec
[9] = ()(
¬g9
); \

4125 
_¬gvec
[10] = ()(
¬g10
); \

4126 
_¬gvec
[11] = ()(
¬g11
); \

4127 
__asm__
 volatile( \

4128 
VALGRIND_ALIGN_STACK
 \

4144 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4145 
VALGRIND_RESTORE_STACK
 \

4147 : "ô" (
_»s
) \

4148 : "0" (&
_¬gvec
[0]) \

4149 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

4151 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4152 } 0)

	)

4154 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
, \

4155 
¬g6
,
¬g7
,
¬g8
,
¬g9
,
¬g10
, \

4156 
¬g11
,
¬g12
) \

4158 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4159 vŞ©
_¬gvec
[13]; \

4160 vŞ©
_»s
; \

4161 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4162 
_¬gvec
[1] = ()(
¬g1
); \

4163 
_¬gvec
[2] = ()(
¬g2
); \

4164 
_¬gvec
[3] = ()(
¬g3
); \

4165 
_¬gvec
[4] = ()(
¬g4
); \

4166 
_¬gvec
[5] = ()(
¬g5
); \

4167 
_¬gvec
[6] = ()(
¬g6
); \

4168 
_¬gvec
[7] = ()(
¬g7
); \

4169 
_¬gvec
[8] = ()(
¬g8
); \

4170 
_¬gvec
[9] = ()(
¬g9
); \

4171 
_¬gvec
[10] = ()(
¬g10
); \

4172 
_¬gvec
[11] = ()(
¬g11
); \

4173 
_¬gvec
[12] = ()(
¬g12
); \

4174 
__asm__
 volatile( \

4175 
VALGRIND_ALIGN_STACK
 \

4191 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_R4
 \

4192 
VALGRIND_RESTORE_STACK
 \

4194 : "ô" (
_»s
) \

4195 : "0" (&
_¬gvec
[0]) \

4196 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "r10" \

4198 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4199 } 0)

	)

4205 #ià
defšed
(
PLAT_¬m64_lšux
)

4208 
	#__CALLER_SAVED_REGS
 \

4215 "v26", "v27", "v28", "v29", "v30", "v31"

	)

4219 
	#VALGRIND_ALIGN_STACK
 \

4221 "biø¥, x21, #15\n\t"

	)

4222 
	#VALGRIND_RESTORE_STACK
 \

4223 "mov sp, x21\n\t"

	)

4228 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

4230 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4231 vŞ©
_¬gvec
[1]; \

4232 vŞ©
_»s
; \

4233 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4234 
__asm__
 volatile( \

4235 
VALGRIND_ALIGN_STACK
 \

4237 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4238 
VALGRIND_RESTORE_STACK
 \

4240 : "ô" (
_»s
) \

4241 : "0" (&
_¬gvec
[0]) \

4242 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4244 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4245 } 0)

	)

4247 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

4249 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4250 vŞ©
_¬gvec
[2]; \

4251 vŞ©
_»s
; \

4252 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4253 
_¬gvec
[1] = ()(
¬g1
); \

4254 
__asm__
 volatile( \

4255 
VALGRIND_ALIGN_STACK
 \

4258 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4259 
VALGRIND_RESTORE_STACK
 \

4261 : "ô" (
_»s
) \

4262 : "0" (&
_¬gvec
[0]) \

4263 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4265 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4266 } 0)

	)

4268 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
) \

4270 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4271 vŞ©
_¬gvec
[3]; \

4272 vŞ©
_»s
; \

4273 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4274 
_¬gvec
[1] = ()(
¬g1
); \

4275 
_¬gvec
[2] = ()(
¬g2
); \

4276 
__asm__
 volatile( \

4277 
VALGRIND_ALIGN_STACK
 \

4281 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4282 
VALGRIND_RESTORE_STACK
 \

4284 : "ô" (
_»s
) \

4285 : "0" (&
_¬gvec
[0]) \

4286 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4288 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4289 } 0)

	)

4291 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
) \

4293 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4294 vŞ©
_¬gvec
[4]; \

4295 vŞ©
_»s
; \

4296 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4297 
_¬gvec
[1] = ()(
¬g1
); \

4298 
_¬gvec
[2] = ()(
¬g2
); \

4299 
_¬gvec
[3] = ()(
¬g3
); \

4300 
__asm__
 volatile( \

4301 
VALGRIND_ALIGN_STACK
 \

4306 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4307 
VALGRIND_RESTORE_STACK
 \

4309 : "ô" (
_»s
) \

4310 : "0" (&
_¬gvec
[0]) \

4311 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4313 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4314 } 0)

	)

4316 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

4318 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4319 vŞ©
_¬gvec
[5]; \

4320 vŞ©
_»s
; \

4321 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4322 
_¬gvec
[1] = ()(
¬g1
); \

4323 
_¬gvec
[2] = ()(
¬g2
); \

4324 
_¬gvec
[3] = ()(
¬g3
); \

4325 
_¬gvec
[4] = ()(
¬g4
); \

4326 
__asm__
 volatile( \

4327 
VALGRIND_ALIGN_STACK
 \

4333 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4334 
VALGRIND_RESTORE_STACK
 \

4336 : "ô" (
_»s
) \

4337 : "0" (&
_¬gvec
[0]) \

4338 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4340 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4341 } 0)

	)

4343 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

4345 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4346 vŞ©
_¬gvec
[6]; \

4347 vŞ©
_»s
; \

4348 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4349 
_¬gvec
[1] = ()(
¬g1
); \

4350 
_¬gvec
[2] = ()(
¬g2
); \

4351 
_¬gvec
[3] = ()(
¬g3
); \

4352 
_¬gvec
[4] = ()(
¬g4
); \

4353 
_¬gvec
[5] = ()(
¬g5
); \

4354 
__asm__
 volatile( \

4355 
VALGRIND_ALIGN_STACK
 \

4362 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4363 
VALGRIND_RESTORE_STACK
 \

4365 : "ô" (
_»s
) \

4366 : "0" (&
_¬gvec
[0]) \

4367 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4369 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4370 } 0)

	)

4372 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

4374 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4375 vŞ©
_¬gvec
[7]; \

4376 vŞ©
_»s
; \

4377 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4378 
_¬gvec
[1] = ()(
¬g1
); \

4379 
_¬gvec
[2] = ()(
¬g2
); \

4380 
_¬gvec
[3] = ()(
¬g3
); \

4381 
_¬gvec
[4] = ()(
¬g4
); \

4382 
_¬gvec
[5] = ()(
¬g5
); \

4383 
_¬gvec
[6] = ()(
¬g6
); \

4384 
__asm__
 volatile( \

4385 
VALGRIND_ALIGN_STACK
 \

4393 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4394 
VALGRIND_RESTORE_STACK
 \

4396 : "ô" (
_»s
) \

4397 : "0" (&
_¬gvec
[0]) \

4398 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4400 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4401 } 0)

	)

4403 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

4404 
¬g7
) \

4406 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4407 vŞ©
_¬gvec
[8]; \

4408 vŞ©
_»s
; \

4409 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4410 
_¬gvec
[1] = ()(
¬g1
); \

4411 
_¬gvec
[2] = ()(
¬g2
); \

4412 
_¬gvec
[3] = ()(
¬g3
); \

4413 
_¬gvec
[4] = ()(
¬g4
); \

4414 
_¬gvec
[5] = ()(
¬g5
); \

4415 
_¬gvec
[6] = ()(
¬g6
); \

4416 
_¬gvec
[7] = ()(
¬g7
); \

4417 
__asm__
 volatile( \

4418 
VALGRIND_ALIGN_STACK
 \

4427 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4428 
VALGRIND_RESTORE_STACK
 \

4430 : "ô" (
_»s
) \

4431 : "0" (&
_¬gvec
[0]) \

4432 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4434 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4435 } 0)

	)

4437 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

4438 
¬g7
,
¬g8
) \

4440 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4441 vŞ©
_¬gvec
[9]; \

4442 vŞ©
_»s
; \

4443 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4444 
_¬gvec
[1] = ()(
¬g1
); \

4445 
_¬gvec
[2] = ()(
¬g2
); \

4446 
_¬gvec
[3] = ()(
¬g3
); \

4447 
_¬gvec
[4] = ()(
¬g4
); \

4448 
_¬gvec
[5] = ()(
¬g5
); \

4449 
_¬gvec
[6] = ()(
¬g6
); \

4450 
_¬gvec
[7] = ()(
¬g7
); \

4451 
_¬gvec
[8] = ()(
¬g8
); \

4452 
__asm__
 volatile( \

4453 
VALGRIND_ALIGN_STACK
 \

4463 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4464 
VALGRIND_RESTORE_STACK
 \

4466 : "ô" (
_»s
) \

4467 : "0" (&
_¬gvec
[0]) \

4468 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4470 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4471 } 0)

	)

4473 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

4474 
¬g7
,
¬g8
,
¬g9
) \

4476 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4477 vŞ©
_¬gvec
[10]; \

4478 vŞ©
_»s
; \

4479 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4480 
_¬gvec
[1] = ()(
¬g1
); \

4481 
_¬gvec
[2] = ()(
¬g2
); \

4482 
_¬gvec
[3] = ()(
¬g3
); \

4483 
_¬gvec
[4] = ()(
¬g4
); \

4484 
_¬gvec
[5] = ()(
¬g5
); \

4485 
_¬gvec
[6] = ()(
¬g6
); \

4486 
_¬gvec
[7] = ()(
¬g7
); \

4487 
_¬gvec
[8] = ()(
¬g8
); \

4488 
_¬gvec
[9] = ()(
¬g9
); \

4489 
__asm__
 volatile( \

4490 
VALGRIND_ALIGN_STACK
 \

4503 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4504 
VALGRIND_RESTORE_STACK
 \

4506 : "ô" (
_»s
) \

4507 : "0" (&
_¬gvec
[0]) \

4508 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4510 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4511 } 0)

	)

4513 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

4514 
¬g7
,
¬g8
,
¬g9
,
¬g10
) \

4516 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4517 vŞ©
_¬gvec
[11]; \

4518 vŞ©
_»s
; \

4519 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4520 
_¬gvec
[1] = ()(
¬g1
); \

4521 
_¬gvec
[2] = ()(
¬g2
); \

4522 
_¬gvec
[3] = ()(
¬g3
); \

4523 
_¬gvec
[4] = ()(
¬g4
); \

4524 
_¬gvec
[5] = ()(
¬g5
); \

4525 
_¬gvec
[6] = ()(
¬g6
); \

4526 
_¬gvec
[7] = ()(
¬g7
); \

4527 
_¬gvec
[8] = ()(
¬g8
); \

4528 
_¬gvec
[9] = ()(
¬g9
); \

4529 
_¬gvec
[10] = ()(
¬g10
); \

4530 
__asm__
 volatile( \

4531 
VALGRIND_ALIGN_STACK
 \

4546 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4547 
VALGRIND_RESTORE_STACK
 \

4549 : "ô" (
_»s
) \

4550 : "0" (&
_¬gvec
[0]) \

4551 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4553 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4554 } 0)

	)

4556 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

4557 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
) \

4559 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4560 vŞ©
_¬gvec
[12]; \

4561 vŞ©
_»s
; \

4562 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4563 
_¬gvec
[1] = ()(
¬g1
); \

4564 
_¬gvec
[2] = ()(
¬g2
); \

4565 
_¬gvec
[3] = ()(
¬g3
); \

4566 
_¬gvec
[4] = ()(
¬g4
); \

4567 
_¬gvec
[5] = ()(
¬g5
); \

4568 
_¬gvec
[6] = ()(
¬g6
); \

4569 
_¬gvec
[7] = ()(
¬g7
); \

4570 
_¬gvec
[8] = ()(
¬g8
); \

4571 
_¬gvec
[9] = ()(
¬g9
); \

4572 
_¬gvec
[10] = ()(
¬g10
); \

4573 
_¬gvec
[11] = ()(
¬g11
); \

4574 
__asm__
 volatile( \

4575 
VALGRIND_ALIGN_STACK
 \

4592 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4593 
VALGRIND_RESTORE_STACK
 \

4595 : "ô" (
_»s
) \

4596 : "0" (&
_¬gvec
[0]) \

4597 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4599 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4600 } 0)

	)

4602 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

4603 
¬g7
,
¬g8
,
¬g9
,
¬g10
,
¬g11
, \

4604 
¬g12
) \

4606 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4607 vŞ©
_¬gvec
[13]; \

4608 vŞ©
_»s
; \

4609 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4610 
_¬gvec
[1] = ()(
¬g1
); \

4611 
_¬gvec
[2] = ()(
¬g2
); \

4612 
_¬gvec
[3] = ()(
¬g3
); \

4613 
_¬gvec
[4] = ()(
¬g4
); \

4614 
_¬gvec
[5] = ()(
¬g5
); \

4615 
_¬gvec
[6] = ()(
¬g6
); \

4616 
_¬gvec
[7] = ()(
¬g7
); \

4617 
_¬gvec
[8] = ()(
¬g8
); \

4618 
_¬gvec
[9] = ()(
¬g9
); \

4619 
_¬gvec
[10] = ()(
¬g10
); \

4620 
_¬gvec
[11] = ()(
¬g11
); \

4621 
_¬gvec
[12] = ()(
¬g12
); \

4622 
__asm__
 volatile( \

4623 
VALGRIND_ALIGN_STACK
 \

4642 
VALGRIND_BRANCH_AND_LINK_TO_NOREDIR_X8
 \

4643 
VALGRIND_RESTORE_STACK
 \

4645 : "ô" (
_»s
) \

4646 : "0" (&
_¬gvec
[0]) \

4647 : "cc", "memÜy", 
__CALLER_SAVED_REGS
, "x21" \

4649 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4650 } 0)

	)

4656 #ià
defšed
(
PLAT_s390x_lšux
)

4662 #ià
defšed
(
__GNUC__
è&& defšed(
__GCC_HAVE_DWARF2_CFI_ASM
)

4663 
	#__FRAME_POINTER
 \

4664 ,"d"(
	`__butš_dw¬f_cç
())

	)

4665 
	#VALGRIND_CFI_PROLOGUE
 \

4670 ".cfi_def_cç„11, 0\n\t"

	)

4671 
	#VALGRIND_CFI_EPILOGUE
 \

4673 ".cfi_»¡Üe_¡©e\n\t"

	)

4675 
	#__FRAME_POINTER


	)

4676 
	#VALGRIND_CFI_PROLOGUE
 \

4677 "lg¸1,%1\n\t"

	)

4678 
	#VALGRIND_CFI_EPILOGUE


	)

4690 
	#__CALLER_SAVED_REGS
 "0","1","2","3","4","5","14", \

4691 "f0","f1","f2","f3","f4","f5","f6","f7"

	)

4702 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

4704 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4705 vŞ©
_¬gvec
[1]; \

4706 vŞ©
_»s
; \

4707 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4708 
__asm__
 volatile( \

4709 
VALGRIND_CFI_PROLOGUE
 \

4712 
VALGRIND_CALL_NOREDIR_R1
 \

4715 
VALGRIND_CFI_EPILOGUE
 \

4716 : "=d" (
_»s
) \

4717 : "d" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

4718 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"7" \

4720 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4721 } 0)

	)

4724 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

4726 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4727 vŞ©
_¬gvec
[2]; \

4728 vŞ©
_»s
; \

4729 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4730 
_¬gvec
[1] = ()
¬g1
; \

4731 
__asm__
 volatile( \

4732 
VALGRIND_CFI_PROLOGUE
 \

4736 
VALGRIND_CALL_NOREDIR_R1
 \

4739 
VALGRIND_CFI_EPILOGUE
 \

4740 : "=d" (
_»s
) \

4741 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

4742 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"7" \

4744 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4745 } 0)

	)

4747 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
) \

4749 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4750 vŞ©
_¬gvec
[3]; \

4751 vŞ©
_»s
; \

4752 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4753 
_¬gvec
[1] = ()
¬g1
; \

4754 
_¬gvec
[2] = ()
¬g2
; \

4755 
__asm__
 volatile( \

4756 
VALGRIND_CFI_PROLOGUE
 \

4761 
VALGRIND_CALL_NOREDIR_R1
 \

4764 
VALGRIND_CFI_EPILOGUE
 \

4765 : "=d" (
_»s
) \

4766 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

4767 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"7" \

4769 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4770 } 0)

	)

4772 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
) \

4774 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4775 vŞ©
_¬gvec
[4]; \

4776 vŞ©
_»s
; \

4777 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4778 
_¬gvec
[1] = ()
¬g1
; \

4779 
_¬gvec
[2] = ()
¬g2
; \

4780 
_¬gvec
[3] = ()
¬g3
; \

4781 
__asm__
 volatile( \

4782 
VALGRIND_CFI_PROLOGUE
 \

4788 
VALGRIND_CALL_NOREDIR_R1
 \

4791 
VALGRIND_CFI_EPILOGUE
 \

4792 : "=d" (
_»s
) \

4793 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

4794 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"7" \

4796 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4797 } 0)

	)

4799 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
) \

4801 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4802 vŞ©
_¬gvec
[5]; \

4803 vŞ©
_»s
; \

4804 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4805 
_¬gvec
[1] = ()
¬g1
; \

4806 
_¬gvec
[2] = ()
¬g2
; \

4807 
_¬gvec
[3] = ()
¬g3
; \

4808 
_¬gvec
[4] = ()
¬g4
; \

4809 
__asm__
 volatile( \

4810 
VALGRIND_CFI_PROLOGUE
 \

4817 
VALGRIND_CALL_NOREDIR_R1
 \

4820 
VALGRIND_CFI_EPILOGUE
 \

4821 : "=d" (
_»s
) \

4822 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

4823 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"7" \

4825 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4826 } 0)

	)

4828 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
, 
¬g5
) \

4830 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4831 vŞ©
_¬gvec
[6]; \

4832 vŞ©
_»s
; \

4833 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4834 
_¬gvec
[1] = ()
¬g1
; \

4835 
_¬gvec
[2] = ()
¬g2
; \

4836 
_¬gvec
[3] = ()
¬g3
; \

4837 
_¬gvec
[4] = ()
¬g4
; \

4838 
_¬gvec
[5] = ()
¬g5
; \

4839 
__asm__
 volatile( \

4840 
VALGRIND_CFI_PROLOGUE
 \

4848 
VALGRIND_CALL_NOREDIR_R1
 \

4851 
VALGRIND_CFI_EPILOGUE
 \

4852 : "=d" (
_»s
) \

4853 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

4854 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"6","7" \

4856 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4857 } 0)

	)

4859 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
, 
¬g5
, \

4860 
¬g6
) \

4862 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4863 vŞ©
_¬gvec
[7]; \

4864 vŞ©
_»s
; \

4865 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4866 
_¬gvec
[1] = ()
¬g1
; \

4867 
_¬gvec
[2] = ()
¬g2
; \

4868 
_¬gvec
[3] = ()
¬g3
; \

4869 
_¬gvec
[4] = ()
¬g4
; \

4870 
_¬gvec
[5] = ()
¬g5
; \

4871 
_¬gvec
[6] = ()
¬g6
; \

4872 
__asm__
 volatile( \

4873 
VALGRIND_CFI_PROLOGUE
 \

4882 
VALGRIND_CALL_NOREDIR_R1
 \

4885 
VALGRIND_CFI_EPILOGUE
 \

4886 : "=d" (
_»s
) \

4887 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

4888 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"6","7" \

4890 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4891 } 0)

	)

4893 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
, 
¬g5
, \

4894 
¬g6
, 
¬g7
) \

4896 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4897 vŞ©
_¬gvec
[8]; \

4898 vŞ©
_»s
; \

4899 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4900 
_¬gvec
[1] = ()
¬g1
; \

4901 
_¬gvec
[2] = ()
¬g2
; \

4902 
_¬gvec
[3] = ()
¬g3
; \

4903 
_¬gvec
[4] = ()
¬g4
; \

4904 
_¬gvec
[5] = ()
¬g5
; \

4905 
_¬gvec
[6] = ()
¬g6
; \

4906 
_¬gvec
[7] = ()
¬g7
; \

4907 
__asm__
 volatile( \

4908 
VALGRIND_CFI_PROLOGUE
 \

4918 
VALGRIND_CALL_NOREDIR_R1
 \

4921 
VALGRIND_CFI_EPILOGUE
 \

4922 : "=d" (
_»s
) \

4923 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

4924 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"6","7" \

4926 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4927 } 0)

	)

4929 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
, 
¬g5
, \

4930 
¬g6
, 
¬g7
 ,
¬g8
) \

4932 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4933 vŞ©
_¬gvec
[9]; \

4934 vŞ©
_»s
; \

4935 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4936 
_¬gvec
[1] = ()
¬g1
; \

4937 
_¬gvec
[2] = ()
¬g2
; \

4938 
_¬gvec
[3] = ()
¬g3
; \

4939 
_¬gvec
[4] = ()
¬g4
; \

4940 
_¬gvec
[5] = ()
¬g5
; \

4941 
_¬gvec
[6] = ()
¬g6
; \

4942 
_¬gvec
[7] = ()
¬g7
; \

4943 
_¬gvec
[8] = ()
¬g8
; \

4944 
__asm__
 volatile( \

4945 
VALGRIND_CFI_PROLOGUE
 \

4956 
VALGRIND_CALL_NOREDIR_R1
 \

4959 
VALGRIND_CFI_EPILOGUE
 \

4960 : "=d" (
_»s
) \

4961 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

4962 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"6","7" \

4964 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

4965 } 0)

	)

4967 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
, 
¬g5
, \

4968 
¬g6
, 
¬g7
 ,
¬g8
, 
¬g9
) \

4970 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

4971 vŞ©
_¬gvec
[10]; \

4972 vŞ©
_»s
; \

4973 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

4974 
_¬gvec
[1] = ()
¬g1
; \

4975 
_¬gvec
[2] = ()
¬g2
; \

4976 
_¬gvec
[3] = ()
¬g3
; \

4977 
_¬gvec
[4] = ()
¬g4
; \

4978 
_¬gvec
[5] = ()
¬g5
; \

4979 
_¬gvec
[6] = ()
¬g6
; \

4980 
_¬gvec
[7] = ()
¬g7
; \

4981 
_¬gvec
[8] = ()
¬g8
; \

4982 
_¬gvec
[9] = ()
¬g9
; \

4983 
__asm__
 volatile( \

4984 
VALGRIND_CFI_PROLOGUE
 \

4996 
VALGRIND_CALL_NOREDIR_R1
 \

4999 
VALGRIND_CFI_EPILOGUE
 \

5000 : "=d" (
_»s
) \

5001 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

5002 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"6","7" \

5004 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5005 } 0)

	)

5007 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
, 
¬g5
, \

5008 
¬g6
, 
¬g7
 ,
¬g8
, 
¬g9
, 
¬g10
) \

5010 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5011 vŞ©
_¬gvec
[11]; \

5012 vŞ©
_»s
; \

5013 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5014 
_¬gvec
[1] = ()
¬g1
; \

5015 
_¬gvec
[2] = ()
¬g2
; \

5016 
_¬gvec
[3] = ()
¬g3
; \

5017 
_¬gvec
[4] = ()
¬g4
; \

5018 
_¬gvec
[5] = ()
¬g5
; \

5019 
_¬gvec
[6] = ()
¬g6
; \

5020 
_¬gvec
[7] = ()
¬g7
; \

5021 
_¬gvec
[8] = ()
¬g8
; \

5022 
_¬gvec
[9] = ()
¬g9
; \

5023 
_¬gvec
[10] = ()
¬g10
; \

5024 
__asm__
 volatile( \

5025 
VALGRIND_CFI_PROLOGUE
 \

5038 
VALGRIND_CALL_NOREDIR_R1
 \

5041 
VALGRIND_CFI_EPILOGUE
 \

5042 : "=d" (
_»s
) \

5043 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

5044 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"6","7" \

5046 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5047 } 0)

	)

5049 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
, 
¬g5
, \

5050 
¬g6
, 
¬g7
 ,
¬g8
, 
¬g9
, 
¬g10
, 
¬g11
) \

5052 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5053 vŞ©
_¬gvec
[12]; \

5054 vŞ©
_»s
; \

5055 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5056 
_¬gvec
[1] = ()
¬g1
; \

5057 
_¬gvec
[2] = ()
¬g2
; \

5058 
_¬gvec
[3] = ()
¬g3
; \

5059 
_¬gvec
[4] = ()
¬g4
; \

5060 
_¬gvec
[5] = ()
¬g5
; \

5061 
_¬gvec
[6] = ()
¬g6
; \

5062 
_¬gvec
[7] = ()
¬g7
; \

5063 
_¬gvec
[8] = ()
¬g8
; \

5064 
_¬gvec
[9] = ()
¬g9
; \

5065 
_¬gvec
[10] = ()
¬g10
; \

5066 
_¬gvec
[11] = ()
¬g11
; \

5067 
__asm__
 volatile( \

5068 
VALGRIND_CFI_PROLOGUE
 \

5082 
VALGRIND_CALL_NOREDIR_R1
 \

5085 
VALGRIND_CFI_EPILOGUE
 \

5086 : "=d" (
_»s
) \

5087 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

5088 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"6","7" \

5090 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5091 } 0)

	)

5093 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
, 
¬g5
, \

5094 
¬g6
, 
¬g7
 ,
¬g8
, 
¬g9
, 
¬g10
, 
¬g11
, 
¬g12
)\

5096 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5097 vŞ©
_¬gvec
[13]; \

5098 vŞ©
_»s
; \

5099 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5100 
_¬gvec
[1] = ()
¬g1
; \

5101 
_¬gvec
[2] = ()
¬g2
; \

5102 
_¬gvec
[3] = ()
¬g3
; \

5103 
_¬gvec
[4] = ()
¬g4
; \

5104 
_¬gvec
[5] = ()
¬g5
; \

5105 
_¬gvec
[6] = ()
¬g6
; \

5106 
_¬gvec
[7] = ()
¬g7
; \

5107 
_¬gvec
[8] = ()
¬g8
; \

5108 
_¬gvec
[9] = ()
¬g9
; \

5109 
_¬gvec
[10] = ()
¬g10
; \

5110 
_¬gvec
[11] = ()
¬g11
; \

5111 
_¬gvec
[12] = ()
¬g12
; \

5112 
__asm__
 volatile( \

5113 
VALGRIND_CFI_PROLOGUE
 \

5128 
VALGRIND_CALL_NOREDIR_R1
 \

5131 
VALGRIND_CFI_EPILOGUE
 \

5132 : "=d" (
_»s
) \

5133 : "a" (&
_¬gvec
[0]è
__FRAME_POINTER
 \

5134 : "cc", "memÜy", 
__CALLER_SAVED_REGS
,"6","7" \

5136 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5137 } 0)

	)

5144 #ià
defšed
(
PLAT_ms32_lšux
)

5147 
	#__CALLER_SAVED_REGS
 "$2", "$3", "$4", "$5", "$6", \

5149 "$25", "$31"

	)

5154 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

5156 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5157 vŞ©
_¬gvec
[1]; \

5158 vŞ©
_»s
; \

5159 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5160 
__asm__
 volatile( \

5166 
VALGRIND_CALL_NOREDIR_T9
 \

5172 : "ô" (
_»s
) \

5173 : "0" (&
_¬gvec
[0]) \

5174 : "memÜy", 
__CALLER_SAVED_REGS
 \

5176 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5177 } 0)

	)

5179 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

5181 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5182 vŞ©
_¬gvec
[2]; \

5183 vŞ©
_»s
; \

5184 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5185 
_¬gvec
[1] = ()(
¬g1
); \

5186 
__asm__
 volatile( \

5193 
VALGRIND_CALL_NOREDIR_T9
 \

5199 : "ô" (
_»s
) \

5200 : "0" (&
_¬gvec
[0]) \

5201 : "memÜy", 
__CALLER_SAVED_REGS
 \

5203 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5204 } 0)

	)

5206 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
) \

5208 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5209 vŞ©
_¬gvec
[3]; \

5210 vŞ©
_»s
; \

5211 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5212 
_¬gvec
[1] = ()(
¬g1
); \

5213 
_¬gvec
[2] = ()(
¬g2
); \

5214 
__asm__
 volatile( \

5222 
VALGRIND_CALL_NOREDIR_T9
 \

5228 : "ô" (
_»s
) \

5229 : "0" (&
_¬gvec
[0]) \

5230 : "memÜy", 
__CALLER_SAVED_REGS
 \

5232 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5233 } 0)

	)

5235 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
) \

5237 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5238 vŞ©
_¬gvec
[4]; \

5239 vŞ©
_»s
; \

5240 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5241 
_¬gvec
[1] = ()(
¬g1
); \

5242 
_¬gvec
[2] = ()(
¬g2
); \

5243 
_¬gvec
[3] = ()(
¬g3
); \

5244 
__asm__
 volatile( \

5253 
VALGRIND_CALL_NOREDIR_T9
 \

5259 : "ô" (
_»s
) \

5260 : "0" (&
_¬gvec
[0]) \

5261 : "memÜy", 
__CALLER_SAVED_REGS
 \

5263 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5264 } 0)

	)

5266 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

5268 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5269 vŞ©
_¬gvec
[5]; \

5270 vŞ©
_»s
; \

5271 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5272 
_¬gvec
[1] = ()(
¬g1
); \

5273 
_¬gvec
[2] = ()(
¬g2
); \

5274 
_¬gvec
[3] = ()(
¬g3
); \

5275 
_¬gvec
[4] = ()(
¬g4
); \

5276 
__asm__
 volatile( \

5286 
VALGRIND_CALL_NOREDIR_T9
 \

5292 : "ô" (
_»s
) \

5293 : "0" (&
_¬gvec
[0]) \

5294 : "memÜy", 
__CALLER_SAVED_REGS
 \

5296 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5297 } 0)

	)

5299 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

5301 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5302 vŞ©
_¬gvec
[6]; \

5303 vŞ©
_»s
; \

5304 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5305 
_¬gvec
[1] = ()(
¬g1
); \

5306 
_¬gvec
[2] = ()(
¬g2
); \

5307 
_¬gvec
[3] = ()(
¬g3
); \

5308 
_¬gvec
[4] = ()(
¬g4
); \

5309 
_¬gvec
[5] = ()(
¬g5
); \

5310 
__asm__
 volatile( \

5322 
VALGRIND_CALL_NOREDIR_T9
 \

5328 : "ô" (
_»s
) \

5329 : "0" (&
_¬gvec
[0]) \

5330 : "memÜy", 
__CALLER_SAVED_REGS
 \

5332 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5333 } 0)

	)

5334 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

5336 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5337 vŞ©
_¬gvec
[7]; \

5338 vŞ©
_»s
; \

5339 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5340 
_¬gvec
[1] = ()(
¬g1
); \

5341 
_¬gvec
[2] = ()(
¬g2
); \

5342 
_¬gvec
[3] = ()(
¬g3
); \

5343 
_¬gvec
[4] = ()(
¬g4
); \

5344 
_¬gvec
[5] = ()(
¬g5
); \

5345 
_¬gvec
[6] = ()(
¬g6
); \

5346 
__asm__
 volatile( \

5361 
VALGRIND_CALL_NOREDIR_T9
 \

5367 : "ô" (
_»s
) \

5368 : "0" (&
_¬gvec
[0]) \

5369 : "memÜy", 
__CALLER_SAVED_REGS
 \

5371 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5372 } 0)

	)

5374 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

5375 
¬g7
) \

5377 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5378 vŞ©
_¬gvec
[8]; \

5379 vŞ©
_»s
; \

5380 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5381 
_¬gvec
[1] = ()(
¬g1
); \

5382 
_¬gvec
[2] = ()(
¬g2
); \

5383 
_¬gvec
[3] = ()(
¬g3
); \

5384 
_¬gvec
[4] = ()(
¬g4
); \

5385 
_¬gvec
[5] = ()(
¬g5
); \

5386 
_¬gvec
[6] = ()(
¬g6
); \

5387 
_¬gvec
[7] = ()(
¬g7
); \

5388 
__asm__
 volatile( \

5404 
VALGRIND_CALL_NOREDIR_T9
 \

5410 : "ô" (
_»s
) \

5411 : "0" (&
_¬gvec
[0]) \

5412 : "memÜy", 
__CALLER_SAVED_REGS
 \

5414 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5415 } 0)

	)

5417 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

5418 
¬g7
,
¬g8
) \

5420 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5421 vŞ©
_¬gvec
[9]; \

5422 vŞ©
_»s
; \

5423 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5424 
_¬gvec
[1] = ()(
¬g1
); \

5425 
_¬gvec
[2] = ()(
¬g2
); \

5426 
_¬gvec
[3] = ()(
¬g3
); \

5427 
_¬gvec
[4] = ()(
¬g4
); \

5428 
_¬gvec
[5] = ()(
¬g5
); \

5429 
_¬gvec
[6] = ()(
¬g6
); \

5430 
_¬gvec
[7] = ()(
¬g7
); \

5431 
_¬gvec
[8] = ()(
¬g8
); \

5432 
__asm__
 volatile( \

5450 
VALGRIND_CALL_NOREDIR_T9
 \

5456 : "ô" (
_»s
) \

5457 : "0" (&
_¬gvec
[0]) \

5458 : "memÜy", 
__CALLER_SAVED_REGS
 \

5460 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5461 } 0)

	)

5463 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

5464 
¬g7
,
¬g8
,
¬g9
) \

5466 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5467 vŞ©
_¬gvec
[10]; \

5468 vŞ©
_»s
; \

5469 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5470 
_¬gvec
[1] = ()(
¬g1
); \

5471 
_¬gvec
[2] = ()(
¬g2
); \

5472 
_¬gvec
[3] = ()(
¬g3
); \

5473 
_¬gvec
[4] = ()(
¬g4
); \

5474 
_¬gvec
[5] = ()(
¬g5
); \

5475 
_¬gvec
[6] = ()(
¬g6
); \

5476 
_¬gvec
[7] = ()(
¬g7
); \

5477 
_¬gvec
[8] = ()(
¬g8
); \

5478 
_¬gvec
[9] = ()(
¬g9
); \

5479 
__asm__
 volatile( \

5499 
VALGRIND_CALL_NOREDIR_T9
 \

5505 : "ô" (
_»s
) \

5506 : "0" (&
_¬gvec
[0]) \

5507 : "memÜy", 
__CALLER_SAVED_REGS
 \

5509 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5510 } 0)

	)

5512 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

5513 
¬g7
,
¬g8
,
¬g9
,
¬g10
) \

5515 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5516 vŞ©
_¬gvec
[11]; \

5517 vŞ©
_»s
; \

5518 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5519 
_¬gvec
[1] = ()(
¬g1
); \

5520 
_¬gvec
[2] = ()(
¬g2
); \

5521 
_¬gvec
[3] = ()(
¬g3
); \

5522 
_¬gvec
[4] = ()(
¬g4
); \

5523 
_¬gvec
[5] = ()(
¬g5
); \

5524 
_¬gvec
[6] = ()(
¬g6
); \

5525 
_¬gvec
[7] = ()(
¬g7
); \

5526 
_¬gvec
[8] = ()(
¬g8
); \

5527 
_¬gvec
[9] = ()(
¬g9
); \

5528 
_¬gvec
[10] = ()(
¬g10
); \

5529 
__asm__
 volatile( \

5551 
VALGRIND_CALL_NOREDIR_T9
 \

5557 : "ô" (
_»s
) \

5558 : "0" (&
_¬gvec
[0]) \

5559 : "memÜy", 
__CALLER_SAVED_REGS
 \

5561 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5562 } 0)

	)

5564 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
, \

5565 
¬g6
,
¬g7
,
¬g8
,
¬g9
,
¬g10
, \

5566 
¬g11
) \

5568 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5569 vŞ©
_¬gvec
[12]; \

5570 vŞ©
_»s
; \

5571 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5572 
_¬gvec
[1] = ()(
¬g1
); \

5573 
_¬gvec
[2] = ()(
¬g2
); \

5574 
_¬gvec
[3] = ()(
¬g3
); \

5575 
_¬gvec
[4] = ()(
¬g4
); \

5576 
_¬gvec
[5] = ()(
¬g5
); \

5577 
_¬gvec
[6] = ()(
¬g6
); \

5578 
_¬gvec
[7] = ()(
¬g7
); \

5579 
_¬gvec
[8] = ()(
¬g8
); \

5580 
_¬gvec
[9] = ()(
¬g9
); \

5581 
_¬gvec
[10] = ()(
¬g10
); \

5582 
_¬gvec
[11] = ()(
¬g11
); \

5583 
__asm__
 volatile( \

5607 
VALGRIND_CALL_NOREDIR_T9
 \

5613 : "ô" (
_»s
) \

5614 : "0" (&
_¬gvec
[0]) \

5615 : "memÜy", 
__CALLER_SAVED_REGS
 \

5617 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5618 } 0)

	)

5620 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
, \

5621 
¬g6
,
¬g7
,
¬g8
,
¬g9
,
¬g10
, \

5622 
¬g11
,
¬g12
) \

5624 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5625 vŞ©
_¬gvec
[13]; \

5626 vŞ©
_»s
; \

5627 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5628 
_¬gvec
[1] = ()(
¬g1
); \

5629 
_¬gvec
[2] = ()(
¬g2
); \

5630 
_¬gvec
[3] = ()(
¬g3
); \

5631 
_¬gvec
[4] = ()(
¬g4
); \

5632 
_¬gvec
[5] = ()(
¬g5
); \

5633 
_¬gvec
[6] = ()(
¬g6
); \

5634 
_¬gvec
[7] = ()(
¬g7
); \

5635 
_¬gvec
[8] = ()(
¬g8
); \

5636 
_¬gvec
[9] = ()(
¬g9
); \

5637 
_¬gvec
[10] = ()(
¬g10
); \

5638 
_¬gvec
[11] = ()(
¬g11
); \

5639 
_¬gvec
[12] = ()(
¬g12
); \

5640 
__asm__
 volatile( \

5666 
VALGRIND_CALL_NOREDIR_T9
 \

5672 : "ô" (
_»s
) \

5673 : "r" (&
_¬gvec
[0]) \

5674 : "memÜy", 
__CALLER_SAVED_REGS
 \

5676 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5677 } 0)

	)

5683 #ià
defšed
(
PLAT_ms64_lšux
)

5686 
	#__CALLER_SAVED_REGS
 "$2", "$3", "$4", "$5", "$6", \

5688 "$25", "$31"

	)

5693 
	#CALL_FN_W_v
(
lv®
, 
Üig
) \

5695 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5696 vŞ©
_¬gvec
[1]; \

5697 vŞ©
_»s
; \

5698 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5699 
__asm__
 volatile( \

5701 
VALGRIND_CALL_NOREDIR_T9
 \

5703 : "ô" (
_»s
) \

5704 : "0" (&
_¬gvec
[0]) \

5705 : "memÜy", 
__CALLER_SAVED_REGS
 \

5707 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5708 } 0)

	)

5710 
	#CALL_FN_W_W
(
lv®
, 
Üig
, 
¬g1
) \

5712 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5713 vŞ©
_¬gvec
[2]; \

5714 vŞ©
_»s
; \

5715 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5716 
_¬gvec
[1] = ()(
¬g1
); \

5717 
__asm__
 volatile( \

5720 
VALGRIND_CALL_NOREDIR_T9
 \

5722 : "ô" (
_»s
) \

5723 : "r" (&
_¬gvec
[0]) \

5724 : "memÜy", 
__CALLER_SAVED_REGS
 \

5726 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5727 } 0)

	)

5729 
	#CALL_FN_W_WW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
) \

5731 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5732 vŞ©
_¬gvec
[3]; \

5733 vŞ©
_»s
; \

5734 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5735 
_¬gvec
[1] = ()(
¬g1
); \

5736 
_¬gvec
[2] = ()(
¬g2
); \

5737 
__asm__
 volatile( \

5741 
VALGRIND_CALL_NOREDIR_T9
 \

5743 : "ô" (
_»s
) \

5744 : "r" (&
_¬gvec
[0]) \

5745 : "memÜy", 
__CALLER_SAVED_REGS
 \

5747 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5748 } 0)

	)

5750 
	#CALL_FN_W_WWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
) \

5752 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5753 vŞ©
_¬gvec
[4]; \

5754 vŞ©
_»s
; \

5755 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5756 
_¬gvec
[1] = ()(
¬g1
); \

5757 
_¬gvec
[2] = ()(
¬g2
); \

5758 
_¬gvec
[3] = ()(
¬g3
); \

5759 
__asm__
 volatile( \

5764 
VALGRIND_CALL_NOREDIR_T9
 \

5766 : "ô" (
_»s
) \

5767 : "r" (&
_¬gvec
[0]) \

5768 : "memÜy", 
__CALLER_SAVED_REGS
 \

5770 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5771 } 0)

	)

5773 
	#CALL_FN_W_WWWW
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
) \

5775 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5776 vŞ©
_¬gvec
[5]; \

5777 vŞ©
_»s
; \

5778 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5779 
_¬gvec
[1] = ()(
¬g1
); \

5780 
_¬gvec
[2] = ()(
¬g2
); \

5781 
_¬gvec
[3] = ()(
¬g3
); \

5782 
_¬gvec
[4] = ()(
¬g4
); \

5783 
__asm__
 volatile( \

5789 
VALGRIND_CALL_NOREDIR_T9
 \

5791 : "ô" (
_»s
) \

5792 : "r" (&
_¬gvec
[0]) \

5793 : "memÜy", 
__CALLER_SAVED_REGS
 \

5795 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5796 } 0)

	)

5798 
	#CALL_FN_W_5W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
) \

5800 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5801 vŞ©
_¬gvec
[6]; \

5802 vŞ©
_»s
; \

5803 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5804 
_¬gvec
[1] = ()(
¬g1
); \

5805 
_¬gvec
[2] = ()(
¬g2
); \

5806 
_¬gvec
[3] = ()(
¬g3
); \

5807 
_¬gvec
[4] = ()(
¬g4
); \

5808 
_¬gvec
[5] = ()(
¬g5
); \

5809 
__asm__
 volatile( \

5816 
VALGRIND_CALL_NOREDIR_T9
 \

5818 : "ô" (
_»s
) \

5819 : "r" (&
_¬gvec
[0]) \

5820 : "memÜy", 
__CALLER_SAVED_REGS
 \

5822 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5823 } 0)

	)

5825 
	#CALL_FN_W_6W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
) \

5827 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5828 vŞ©
_¬gvec
[7]; \

5829 vŞ©
_»s
; \

5830 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5831 
_¬gvec
[1] = ()(
¬g1
); \

5832 
_¬gvec
[2] = ()(
¬g2
); \

5833 
_¬gvec
[3] = ()(
¬g3
); \

5834 
_¬gvec
[4] = ()(
¬g4
); \

5835 
_¬gvec
[5] = ()(
¬g5
); \

5836 
_¬gvec
[6] = ()(
¬g6
); \

5837 
__asm__
 volatile( \

5845 
VALGRIND_CALL_NOREDIR_T9
 \

5847 : "ô" (
_»s
) \

5848 : "r" (&
_¬gvec
[0]) \

5849 : "memÜy", 
__CALLER_SAVED_REGS
 \

5851 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5852 } 0)

	)

5854 
	#CALL_FN_W_7W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

5855 
¬g7
) \

5857 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5858 vŞ©
_¬gvec
[8]; \

5859 vŞ©
_»s
; \

5860 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5861 
_¬gvec
[1] = ()(
¬g1
); \

5862 
_¬gvec
[2] = ()(
¬g2
); \

5863 
_¬gvec
[3] = ()(
¬g3
); \

5864 
_¬gvec
[4] = ()(
¬g4
); \

5865 
_¬gvec
[5] = ()(
¬g5
); \

5866 
_¬gvec
[6] = ()(
¬g6
); \

5867 
_¬gvec
[7] = ()(
¬g7
); \

5868 
__asm__
 volatile( \

5877 
VALGRIND_CALL_NOREDIR_T9
 \

5879 : "ô" (
_»s
) \

5880 : "r" (&
_¬gvec
[0]) \

5881 : "memÜy", 
__CALLER_SAVED_REGS
 \

5883 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5884 } 0)

	)

5886 
	#CALL_FN_W_8W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

5887 
¬g7
,
¬g8
) \

5889 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5890 vŞ©
_¬gvec
[9]; \

5891 vŞ©
_»s
; \

5892 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5893 
_¬gvec
[1] = ()(
¬g1
); \

5894 
_¬gvec
[2] = ()(
¬g2
); \

5895 
_¬gvec
[3] = ()(
¬g3
); \

5896 
_¬gvec
[4] = ()(
¬g4
); \

5897 
_¬gvec
[5] = ()(
¬g5
); \

5898 
_¬gvec
[6] = ()(
¬g6
); \

5899 
_¬gvec
[7] = ()(
¬g7
); \

5900 
_¬gvec
[8] = ()(
¬g8
); \

5901 
__asm__
 volatile( \

5911 
VALGRIND_CALL_NOREDIR_T9
 \

5913 : "ô" (
_»s
) \

5914 : "r" (&
_¬gvec
[0]) \

5915 : "memÜy", 
__CALLER_SAVED_REGS
 \

5917 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5918 } 0)

	)

5920 
	#CALL_FN_W_9W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

5921 
¬g7
,
¬g8
,
¬g9
) \

5923 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5924 vŞ©
_¬gvec
[10]; \

5925 vŞ©
_»s
; \

5926 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5927 
_¬gvec
[1] = ()(
¬g1
); \

5928 
_¬gvec
[2] = ()(
¬g2
); \

5929 
_¬gvec
[3] = ()(
¬g3
); \

5930 
_¬gvec
[4] = ()(
¬g4
); \

5931 
_¬gvec
[5] = ()(
¬g5
); \

5932 
_¬gvec
[6] = ()(
¬g6
); \

5933 
_¬gvec
[7] = ()(
¬g7
); \

5934 
_¬gvec
[8] = ()(
¬g8
); \

5935 
_¬gvec
[9] = ()(
¬g9
); \

5936 
__asm__
 volatile( \

5949 
VALGRIND_CALL_NOREDIR_T9
 \

5952 : "ô" (
_»s
) \

5953 : "r" (&
_¬gvec
[0]) \

5954 : "memÜy", 
__CALLER_SAVED_REGS
 \

5956 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5957 } 0)

	)

5959 
	#CALL_FN_W_10W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
,
¬g6
, \

5960 
¬g7
,
¬g8
,
¬g9
,
¬g10
) \

5962 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

5963 vŞ©
_¬gvec
[11]; \

5964 vŞ©
_»s
; \

5965 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

5966 
_¬gvec
[1] = ()(
¬g1
); \

5967 
_¬gvec
[2] = ()(
¬g2
); \

5968 
_¬gvec
[3] = ()(
¬g3
); \

5969 
_¬gvec
[4] = ()(
¬g4
); \

5970 
_¬gvec
[5] = ()(
¬g5
); \

5971 
_¬gvec
[6] = ()(
¬g6
); \

5972 
_¬gvec
[7] = ()(
¬g7
); \

5973 
_¬gvec
[8] = ()(
¬g8
); \

5974 
_¬gvec
[9] = ()(
¬g9
); \

5975 
_¬gvec
[10] = ()(
¬g10
); \

5976 
__asm__
 volatile( \

5991 
VALGRIND_CALL_NOREDIR_T9
 \

5994 : "ô" (
_»s
) \

5995 : "r" (&
_¬gvec
[0]) \

5996 : "memÜy", 
__CALLER_SAVED_REGS
 \

5998 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

5999 } 0)

	)

6001 
	#CALL_FN_W_11W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
, \

6002 
¬g6
,
¬g7
,
¬g8
,
¬g9
,
¬g10
, \

6003 
¬g11
) \

6005 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

6006 vŞ©
_¬gvec
[12]; \

6007 vŞ©
_»s
; \

6008 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

6009 
_¬gvec
[1] = ()(
¬g1
); \

6010 
_¬gvec
[2] = ()(
¬g2
); \

6011 
_¬gvec
[3] = ()(
¬g3
); \

6012 
_¬gvec
[4] = ()(
¬g4
); \

6013 
_¬gvec
[5] = ()(
¬g5
); \

6014 
_¬gvec
[6] = ()(
¬g6
); \

6015 
_¬gvec
[7] = ()(
¬g7
); \

6016 
_¬gvec
[8] = ()(
¬g8
); \

6017 
_¬gvec
[9] = ()(
¬g9
); \

6018 
_¬gvec
[10] = ()(
¬g10
); \

6019 
_¬gvec
[11] = ()(
¬g11
); \

6020 
__asm__
 volatile( \

6037 
VALGRIND_CALL_NOREDIR_T9
 \

6040 : "ô" (
_»s
) \

6041 : "r" (&
_¬gvec
[0]) \

6042 : "memÜy", 
__CALLER_SAVED_REGS
 \

6044 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

6045 } 0)

	)

6047 
	#CALL_FN_W_12W
(
lv®
, 
Üig
, 
¬g1
,
¬g2
,
¬g3
,
¬g4
,
¬g5
, \

6048 
¬g6
,
¬g7
,
¬g8
,
¬g9
,
¬g10
, \

6049 
¬g11
,
¬g12
) \

6051 vŞ©
OrigFn
 
_Üig
 = (
Üig
); \

6052 vŞ©
_¬gvec
[13]; \

6053 vŞ©
_»s
; \

6054 
_¬gvec
[0] = ()
_Üig
.
Äaddr
; \

6055 
_¬gvec
[1] = ()(
¬g1
); \

6056 
_¬gvec
[2] = ()(
¬g2
); \

6057 
_¬gvec
[3] = ()(
¬g3
); \

6058 
_¬gvec
[4] = ()(
¬g4
); \

6059 
_¬gvec
[5] = ()(
¬g5
); \

6060 
_¬gvec
[6] = ()(
¬g6
); \

6061 
_¬gvec
[7] = ()(
¬g7
); \

6062 
_¬gvec
[8] = ()(
¬g8
); \

6063 
_¬gvec
[9] = ()(
¬g9
); \

6064 
_¬gvec
[10] = ()(
¬g10
); \

6065 
_¬gvec
[11] = ()(
¬g11
); \

6066 
_¬gvec
[12] = ()(
¬g12
); \

6067 
__asm__
 volatile( \

6086 
VALGRIND_CALL_NOREDIR_T9
 \

6089 : "ô" (
_»s
) \

6090 : "r" (&
_¬gvec
[0]) \

6091 : "memÜy", 
__CALLER_SAVED_REGS
 \

6093 
lv®
 = (
	`__ty³of__
Öv®)è
_»s
; \

6094 } 0)

	)

6113 
	#VG_USERREQ_TOOL_BASE
(
a
,
b
) \

6114 (()(((
a
)&0xffè<< 24 | ((
b
)&0xffè<< 16))

	)

6115 
	#VG_IS_TOOL_USERREQ
(
a
, 
b
, 
v
) \

6116 (
	`VG_USERREQ_TOOL_BASE
(
a
,
b
è=ğ((
v
è& 0xffff0000))

	)

6124 ’um { 
	mVG_USERREQ__RUNNING_ON_VALGRIND
 = 0x1001,

6125 
	mVG_USERREQ__DISCARD_TRANSLATIONS
 = 0x1002,

6132 
	mVG_USERREQ__CLIENT_CALL0
 = 0x1101,

6133 
	mVG_USERREQ__CLIENT_CALL1
 = 0x1102,

6134 
	mVG_USERREQ__CLIENT_CALL2
 = 0x1103,

6135 
	mVG_USERREQ__CLIENT_CALL3
 = 0x1104,

6140 
	mVG_USERREQ__COUNT_ERRORS
 = 0x1201,

6144 
	mVG_USERREQ__GDB_MONITOR_COMMAND
 = 0x1202,

6148 
	mVG_USERREQ__MALLOCLIKE_BLOCK
 = 0x1301,

6149 
	mVG_USERREQ__RESIZEINPLACE_BLOCK
 = 0x130b,

6150 
	mVG_USERREQ__FREELIKE_BLOCK
 = 0x1302,

6152 
	mVG_USERREQ__CREATE_MEMPOOL
 = 0x1303,

6153 
	mVG_USERREQ__DESTROY_MEMPOOL
 = 0x1304,

6154 
	mVG_USERREQ__MEMPOOL_ALLOC
 = 0x1305,

6155 
	mVG_USERREQ__MEMPOOL_FREE
 = 0x1306,

6156 
	mVG_USERREQ__MEMPOOL_TRIM
 = 0x1307,

6157 
	mVG_USERREQ__MOVE_MEMPOOL
 = 0x1308,

6158 
	mVG_USERREQ__MEMPOOL_CHANGE
 = 0x1309,

6159 
	mVG_USERREQ__MEMPOOL_EXISTS
 = 0x130a,

6168 
	mVG_USERREQ__PRINTF
 = 0x1401,

6169 
	mVG_USERREQ__PRINTF_BACKTRACE
 = 0x1402,

6171 
	mVG_USERREQ__PRINTF_VALIST_BY_REF
 = 0x1403,

6172 
	mVG_USERREQ__PRINTF_BACKTRACE_VALIST_BY_REF
 = 0x1404,

6175 
	mVG_USERREQ__STACK_REGISTER
 = 0x1501,

6176 
	mVG_USERREQ__STACK_DEREGISTER
 = 0x1502,

6177 
	mVG_USERREQ__STACK_CHANGE
 = 0x1503,

6180 
	mVG_USERREQ__LOAD_PDB_DEBUGINFO
 = 0x1601,

6183 
	mVG_USERREQ__MAP_IP_TO_SRCLOC
 = 0x1701,

6190 
	mVG_USERREQ__CHANGE_ERR_DISABLEMENT
 = 0x1801,

6195 
	mVG_USERREQ__VEX_INIT_FOR_IRI
 = 0x1901,

6198 
	mVG_USERREQ__INNER_THREADS
 = 0x1902

6199 } 
	tVg_Cl›ÁReque¡
;

6201 #ià!
defšed
(
__GNUC__
)

6202 
	#__ex‹nsiÚ__


	)

6210 
	#RUNNING_ON_VALGRIND
 \

6211 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6212 
VG_USERREQ__RUNNING_ON_VALGRIND
, \

6214 

	)

6220 
	#VALGRIND_DISCARD_TRANSLATIONS
(
_qzz_addr
,
_qzz_Ën
) \

6221 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__DISCARD_TRANSLATIONS
, \

6222 
_qzz_addr
, 
_qzz_Ën
, 0, 0, 0)

	)

6224 
	#VALGRIND_INNER_THREADS
(
_qzz_addr
) \

6225 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__INNER_THREADS
, \

6226 
_qzz_addr
, 0, 0, 0, 0)

	)

6234 #ià
defšed
(
__GNUC__
è|| defšed(
__INTEL_COMPILER
è&& !defšed(
_MSC_VER
)

6237 
	$VALGRIND_PRINTF
(cÚ¡ *
fÜm©
, ...)

6238 
	`__©Œibu‹__
((
	`fÜm©
(
__´štf__
, 1, 2), 
__unu£d__
));

6241 #ià
	`defšed
(
_MSC_VER
)

6242 
__šlše


6244 
	$VALGRIND_PRINTF
(cÚ¡ *
fÜm©
, ...)

6246 #ià
	`defšed
(
NVALGRIND
)

6247 ()
fÜm©
;

6250 #ià
	`defšed
(
_MSC_VER
è|| defšed(
__MINGW64__
)

6251 
ušŒ_t
 
_qzz_»s
;

6253 
_qzz_»s
;

6255 
va_li¡
 
v¬gs
;

6256 
	`va_¡¬t
(
v¬gs
, 
fÜm©
);

6257 #ià
	`defšed
(
_MSC_VER
è|| defšed(
__MINGW64__
)

6258 
_qzz_»s
 = 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0,

6259 
VG_USERREQ__PRINTF_VALIST_BY_REF
,

6260 (
ušŒ_t
)
fÜm©
,

6261 (
ušŒ_t
)&
v¬gs
,

6264 
_qzz_»s
 = 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0,

6265 
VG_USERREQ__PRINTF_VALIST_BY_REF
,

6266 ()
fÜm©
,

6267 ()&
v¬gs
,

6270 
	`va_’d
(
v¬gs
);

6271  ()
_qzz_»s
;

6273 
	}
}

6275 #ià
defšed
(
__GNUC__
è|| defšed(
__INTEL_COMPILER
è&& !defšed(
_MSC_VER
)

6276 
	$VALGRIND_PRINTF_BACKTRACE
(cÚ¡ *
fÜm©
, ...)

6277 
	`__©Œibu‹__
((
	`fÜm©
(
__´štf__
, 1, 2), 
__unu£d__
));

6280 #ià
	`defšed
(
_MSC_VER
)

6281 
__šlše


6283 
	$VALGRIND_PRINTF_BACKTRACE
(cÚ¡ *
fÜm©
, ...)

6285 #ià
	`defšed
(
NVALGRIND
)

6286 ()
fÜm©
;

6289 #ià
	`defšed
(
_MSC_VER
è|| defšed(
__MINGW64__
)

6290 
ušŒ_t
 
_qzz_»s
;

6292 
_qzz_»s
;

6294 
va_li¡
 
v¬gs
;

6295 
	`va_¡¬t
(
v¬gs
, 
fÜm©
);

6296 #ià
	`defšed
(
_MSC_VER
è|| defšed(
__MINGW64__
)

6297 
_qzz_»s
 = 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0,

6298 
VG_USERREQ__PRINTF_BACKTRACE_VALIST_BY_REF
,

6299 (
ušŒ_t
)
fÜm©
,

6300 (
ušŒ_t
)&
v¬gs
,

6303 
_qzz_»s
 = 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0,

6304 
VG_USERREQ__PRINTF_BACKTRACE_VALIST_BY_REF
,

6305 ()
fÜm©
,

6306 ()&
v¬gs
,

6309 
	`va_’d
(
v¬gs
);

6310  ()
_qzz_»s
;

6312 
	}
}

6338 
	#VALGRIND_NON_SIMD_CALL0
(
_qyy_â
) \

6339 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6340 
VG_USERREQ__CLIENT_CALL0
, \

6341 
_qyy_â
, \

6342 0, 0, 0, 0)

	)

6344 
	#VALGRIND_NON_SIMD_CALL1
(
_qyy_â
, 
_qyy_¬g1
) \

6345 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6346 
VG_USERREQ__CLIENT_CALL1
, \

6347 
_qyy_â
, \

6348 
_qyy_¬g1
, 0, 0, 0)

	)

6350 
	#VALGRIND_NON_SIMD_CALL2
(
_qyy_â
, 
_qyy_¬g1
, 
_qyy_¬g2
) \

6351 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6352 
VG_USERREQ__CLIENT_CALL2
, \

6353 
_qyy_â
, \

6354 
_qyy_¬g1
, 
_qyy_¬g2
, 0, 0)

	)

6356 
	#VALGRIND_NON_SIMD_CALL3
(
_qyy_â
, 
_qyy_¬g1
, 
_qyy_¬g2
, 
_qyy_¬g3
) \

6357 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0 , \

6358 
VG_USERREQ__CLIENT_CALL3
, \

6359 
_qyy_â
, \

6360 
_qyy_¬g1
, 
_qyy_¬g2
, \

6361 
_qyy_¬g3
, 0)

	)

6367 
	#VALGRIND_COUNT_ERRORS
 \

6368 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
( \

6370 
VG_USERREQ__COUNT_ERRORS
, \

6371 0, 0, 0, 0, 0)

	)

6474 
	#VALGRIND_MALLOCLIKE_BLOCK
(
addr
, 
sizeB
, 
rzB
, 
is_z”Ûd
) \

6475 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MALLOCLIKE_BLOCK
, \

6476 
addr
, 
sizeB
, 
rzB
, 
is_z”Ûd
, 0)

	)

6481 
	#VALGRIND_RESIZEINPLACE_BLOCK
(
addr
, 
ŞdSizeB
, 
ÃwSizeB
, 
rzB
) \

6482 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__RESIZEINPLACE_BLOCK
, \

6483 
addr
, 
ŞdSizeB
, 
ÃwSizeB
, 
rzB
, 0)

	)

6488 
	#VALGRIND_FREELIKE_BLOCK
(
addr
, 
rzB
) \

6489 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__FREELIKE_BLOCK
, \

6490 
addr
, 
rzB
, 0, 0, 0)

	)

6493 
	#VALGRIND_CREATE_MEMPOOL
(
poŞ
, 
rzB
, 
is_z”Ûd
) \

6494 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__CREATE_MEMPOOL
, \

6495 
poŞ
, 
rzB
, 
is_z”Ûd
, 0, 0)

	)

6523 
	#VALGRIND_MEMPOOL_AUTO_FREE
 1

	)

6524 
	#VALGRIND_MEMPOOL_METAPOOL
 2

	)

6525 
	#VALGRIND_CREATE_MEMPOOL_EXT
(
poŞ
, 
rzB
, 
is_z”Ûd
, 
æags
) \

6526 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__CREATE_MEMPOOL
, \

6527 
poŞ
, 
rzB
, 
is_z”Ûd
, 
æags
, 0)

	)

6530 
	#VALGRIND_DESTROY_MEMPOOL
(
poŞ
) \

6531 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__DESTROY_MEMPOOL
, \

6532 
poŞ
, 0, 0, 0, 0)

	)

6535 
	#VALGRIND_MEMPOOL_ALLOC
(
poŞ
, 
addr
, 
size
) \

6536 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MEMPOOL_ALLOC
, \

6537 
poŞ
, 
addr
, 
size
, 0, 0)

	)

6540 
	#VALGRIND_MEMPOOL_FREE
(
poŞ
, 
addr
) \

6541 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MEMPOOL_FREE
, \

6542 
poŞ
, 
addr
, 0, 0, 0)

	)

6545 
	#VALGRIND_MEMPOOL_TRIM
(
poŞ
, 
addr
, 
size
) \

6546 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MEMPOOL_TRIM
, \

6547 
poŞ
, 
addr
, 
size
, 0, 0)

	)

6550 
	#VALGRIND_MOVE_MEMPOOL
(
poŞA
, 
poŞB
) \

6551 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MOVE_MEMPOOL
, \

6552 
poŞA
, 
poŞB
, 0, 0, 0)

	)

6555 
	#VALGRIND_MEMPOOL_CHANGE
(
poŞ
, 
addrA
, 
addrB
, 
size
) \

6556 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__MEMPOOL_CHANGE
, \

6557 
poŞ
, 
addrA
, 
addrB
, 
size
, 0)

	)

6560 
	#VALGRIND_MEMPOOL_EXISTS
(
poŞ
) \

6561 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

6562 
VG_USERREQ__MEMPOOL_EXISTS
, \

6563 
poŞ
, 0, 0, 0, 0)

	)

6568 
	#VALGRIND_STACK_REGISTER
(
¡¬t
, 
’d
) \

6569 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

6570 
VG_USERREQ__STACK_REGISTER
, \

6571 
¡¬t
, 
’d
, 0, 0, 0)

	)

6575 
	#VALGRIND_STACK_DEREGISTER
(
id
) \

6576 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__STACK_DEREGISTER
, \

6577 
id
, 0, 0, 0, 0)

	)

6582 
	#VALGRIND_STACK_CHANGE
(
id
, 
¡¬t
, 
’d
) \

6583 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__STACK_CHANGE
, \

6584 
id
, 
¡¬t
, 
’d
, 0, 0)

	)

6587 
	#VALGRIND_LOAD_PDB_DEBUGINFO
(
fd
, 
±r
, 
tÙ®_size
, 
d–
) \

6588 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__LOAD_PDB_DEBUGINFO
, \

6589 
fd
, 
±r
, 
tÙ®_size
, 
d–
, 0)

	)

6595 
	#VALGRIND_MAP_IP_TO_SRCLOC
(
addr
, 
buf64
) \

6596 ()
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, \

6597 
VG_USERREQ__MAP_IP_TO_SRCLOC
, \

6598 
addr
, 
buf64
, 0, 0, 0)

	)

6608 
	#VALGRIND_DISABLE_ERROR_REPORTING
 \

6609 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__CHANGE_ERR_DISABLEMENT
, \

6610 1, 0, 0, 0, 0)

	)

6614 
	#VALGRIND_ENABLE_ERROR_REPORTING
 \

6615 
	`VALGRIND_DO_CLIENT_REQUEST_STMT
(
VG_USERREQ__CHANGE_ERR_DISABLEMENT
, \

6616 -1, 0, 0, 0, 0)

	)

6623 
	#VALGRIND_MONITOR_COMMAND
(
commªd
) \

6624 
	`VALGRIND_DO_CLIENT_REQUEST_EXPR
(0, 
VG_USERREQ__GDB_MONITOR_COMMAND
, \

6625 
commªd
, 0, 0, 0, 0)

	)

6628 #undeà
PLAT_x86_d¬wš


6629 #undeà
PLAT_amd64_d¬wš


6630 #undeà
PLAT_x86_wš32


6631 #undeà
PLAT_amd64_wš64


6632 #undeà
PLAT_x86_lšux


6633 #undeà
PLAT_amd64_lšux


6634 #undeà
PLAT_µc32_lšux


6635 #undeà
PLAT_µc64be_lšux


6636 #undeà
PLAT_µc64Ë_lšux


6637 #undeà
PLAT_¬m_lšux


6638 #undeà
PLAT_s390x_lšux


6639 #undeà
PLAT_ms32_lšux


6640 #undeà
PLAT_ms64_lšux


6641 #undeà
PLAT_x86_sŞ¬is


6642 #undeà
PLAT_amd64_sŞ¬is


	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


24 
	#_WCHAR_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

30 
	~<b™s/æßŠ.h
>

32 
	#__Ãed_size_t


	)

33 
	#__Ãed_wch¬_t


	)

34 
	#__Ãed_NULL


	)

35 
	~<¡ddef.h
>

37 
	#__Ãed___va_li¡


	)

38 
	~<¡d¬g.h
>

40 
	~<b™s/wch¬.h
>

41 
	~<b™s/ty³s/wšt_t.h
>

42 
	~<b™s/ty³s/mb¡©e_t.h
>

43 
	~<b™s/ty³s/__FILE.h
>

45 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


46 
	~<b™s/ty³s/FILE.h
>

48 #ifdeà
__USE_XOPEN2K8


49 
	~<b™s/ty³s/loÿË_t.h
>

53 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

54 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

57 #iâdeà
WCHAR_MIN


59 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

60 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

63 #iâdeà
WEOF


64 
	#WEOF
 (0xffffffffu)

	)

74 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_GNU
 \

75 && !(
defšed
 
	g__USE_XOPEN2K
 && !defšed 
	g__USE_XOPEN2KXSI
))

76 
	~<b™s/wùy³-wch¬.h
>

79 
__BEGIN_DECLS


83 
	gtm
;

87 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

88 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

89 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

92 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

93 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

94 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

97 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

98 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

99 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

101 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

102 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

103 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

106 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

107 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

109 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

110 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

112 #ifdeà
__USE_XOPEN2K8


114 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

117 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

118 
size_t
 
__n
è
__THROW
;

122 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

123 
loÿË_t
 
__loc
è
__THROW
;

125 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

126 
size_t
 
__n
, 
loÿË_t
 
__loc
è
__THROW
;

131 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

135 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

136 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

138 #ifdeà
__USE_XOPEN2K8


144 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

145 
loÿË_t
 
__loc
è
__THROW
;

150 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

151 
size_t
 
__n
, 
loÿË_t
 
__loc
è
__THROW
;

154 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

158 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


159 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

160 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

161 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

162 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

164 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

165 
__THROW
 
__©Œibu‹_pu»__
;

168 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


169 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

170 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

171 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

172 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

174 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

175 
__THROW
 
__©Œibu‹_pu»__
;

178 #ifdeà
__USE_GNU


181 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

182 
__THROW
 
__©Œibu‹_pu»__
;

187 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

188 
__THROW
 
__©Œibu‹_pu»__
;

191 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

192 
__THROW
 
__©Œibu‹_pu»__
;

194 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


195 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

196 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

197 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

198 cÚ¡ 
wch¬_t
 *
__acû±
)

199 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

201 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

202 
__THROW
 
__©Œibu‹_pu»__
;

205 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


206 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

207 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

208 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

209 cÚ¡ 
wch¬_t
 *
__ÃedË
)

210 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

212 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

213 
__THROW
 
__©Œibu‹_pu»__
;

217 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

218 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

219 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

222 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

224 #ifdeà
__USE_XOPEN


226 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


227 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

228 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

229 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

230 cÚ¡ 
wch¬_t
 *
__ÃedË
)

231 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

233 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

234 
__THROW
 
__©Œibu‹_pu»__
;

238 #ifdeà
__USE_XOPEN2K8


240 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

241 
__THROW
 
__©Œibu‹_pu»__
;

246 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


247 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

248 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

249 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

250 
size_t
 
__n
)

251 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

253 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

254 
__THROW
 
__©Œibu‹_pu»__
;

258 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

259 
__THROW
 
__©Œibu‹_pu»__
;

262 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

263 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

267 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

268 
__THROW
;

271 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

273 #ifdeà
__USE_GNU


276 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

277 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

278 
__THROW
;

284 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

288 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

292 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

296 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

297 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

298 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

301 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

302 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

305 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

306 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

307 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

308 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

310 #ifdeà
__USE_EXTERN_INLINES


316 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

317 
__ex‹º_šlše
 
wšt_t


318 
	`__NTH
 (
	$btowc
 (
__c
))

319 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

320 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

322 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

323 
__ex‹º_šlše
 

324 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

325 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

326 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

328 
__ex‹º_šlše
 
size_t


329 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

330 
mb¡©e_t
 *
__»¡riù
 
__ps
))

331 {  (
__ps
 !ğ
NULL


332 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

337 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

338 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

339 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

343 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

344 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

345 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

348 #ifdef 
__USE_XOPEN2K8


351 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

352 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

353 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

357 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

358 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

359 
size_t
 
__nwc
, size_ˆ
__Ën
,

360 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

365 #ifdeà
__USE_XOPEN


367 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

371 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

377 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

378 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

380 #ifdeà
__USE_ISOC99


382 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

383 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

384 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

385 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

390 #ià
__HAVE_FLOAT16
 && 
defšed
 
__USE_GNU


391 
_Flßt16
 
	$wc¡of16
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

392 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

395 #ià
__HAVE_FLOAT32
 && 
defšed
 
__USE_GNU


396 
_Flßt32
 
	$wc¡of32
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

397 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

400 #ià
__HAVE_FLOAT64
 && 
defšed
 
__USE_GNU


401 
_Flßt64
 
	$wc¡of64
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

402 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

405 #ià
__HAVE_FLOAT128
 && 
defšed
 
__USE_GNU


406 
_Flßt128
 
	$wc¡of128
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

407 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

410 #ià
__HAVE_FLOAT32X
 && 
defšed
 
__USE_GNU


411 
_Flßt32x
 
	$wc¡of32x
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

412 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

415 #ià
__HAVE_FLOAT64X
 && 
defšed
 
__USE_GNU


416 
_Flßt64x
 
	$wc¡of64x
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

417 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

420 #ià
__HAVE_FLOAT128X
 && 
defšed
 
__USE_GNU


421 
_Flßt128x
 
	$wc¡of128x
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

422 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

428 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

429 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

433 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

434 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

435 
__THROW
;

437 #ifdeà
__USE_ISOC99


440 
__ex‹nsiÚ__


441 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

442 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

443 
__THROW
;

447 
__ex‹nsiÚ__


448 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

449 
wch¬_t
 **
__»¡riù
 
__’d±r
,

450 
__ba£
è
__THROW
;

453 #ifdeà
__USE_GNU


456 
__ex‹nsiÚ__


457 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

459 
__THROW
;

463 
__ex‹nsiÚ__


464 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

465 
wch¬_t
 **
__»¡riù
 
__’d±r
,

466 
__ba£
è
__THROW
;

469 #ifdeà
__USE_GNU


473 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

474 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

475 
loÿË_t
 
__loc
è
__THROW
;

477 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

478 
wch¬_t
 **
__»¡riù
 
__’d±r
,

479 
__ba£
, 
loÿË_t
 
__loc
è
__THROW
;

481 
__ex‹nsiÚ__


482 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

483 
wch¬_t
 **
__»¡riù
 
__’d±r
,

484 
__ba£
, 
loÿË_t
 
__loc
è
__THROW
;

486 
__ex‹nsiÚ__


487 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

488 
wch¬_t
 **
__»¡riù
 
__’d±r
,

489 
__ba£
, 
loÿË_t
 
__loc
)

490 
__THROW
;

492 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

493 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

494 
__THROW
;

496 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

497 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

498 
__THROW
;

500 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
,

502 
loÿË_t
 
__loc
è
__THROW
;

504 #ià
__HAVE_FLOAT16


505 
_Flßt16
 
	$wc¡of16_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

506 
wch¬_t
 **
__»¡riù
 
__’d±r
,

507 
loÿË_t
 
__loc
è
__THROW
;

510 #ià
__HAVE_FLOAT32


511 
_Flßt32
 
	$wc¡of32_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

512 
wch¬_t
 **
__»¡riù
 
__’d±r
,

513 
loÿË_t
 
__loc
è
__THROW
;

516 #ià
__HAVE_FLOAT64


517 
_Flßt64
 
	$wc¡of64_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

518 
wch¬_t
 **
__»¡riù
 
__’d±r
,

519 
loÿË_t
 
__loc
è
__THROW
;

522 #ià
__HAVE_FLOAT128


523 
_Flßt128
 
	$wc¡of128_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

524 
wch¬_t
 **
__»¡riù
 
__’d±r
,

525 
loÿË_t
 
__loc
è
__THROW
;

528 #ià
__HAVE_FLOAT32X


529 
_Flßt32x
 
	$wc¡of32x_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

530 
wch¬_t
 **
__»¡riù
 
__’d±r
,

531 
loÿË_t
 
__loc
è
__THROW
;

534 #ià
__HAVE_FLOAT64X


535 
_Flßt64x
 
	$wc¡of64x_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

536 
wch¬_t
 **
__»¡riù
 
__’d±r
,

537 
loÿË_t
 
__loc
è
__THROW
;

540 #ià
__HAVE_FLOAT128X


541 
_Flßt128x
 
	$wc¡of128x_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

542 
wch¬_t
 **
__»¡riù
 
__’d±r
,

543 
loÿË_t
 
__loc
è
__THROW
;

548 #ifdeà
__USE_XOPEN2K8


551 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

552 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

556 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

557 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

558 
__THROW
;

564 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

567 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

570 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


573 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

580 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

581 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

587 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

590 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

591 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

592 
__THROW
 ;

598 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

599 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

600 
__gnuc_va_li¡
 
__¬g
)

606 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

607 
__gnuc_va_li¡
 
__¬g
)

611 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

612 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

613 
__gnuc_va_li¡
 
__¬g
)

614 
__THROW
 ;

621 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

622 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

628 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

631 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

632 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

633 
__THROW
 ;

635 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

636 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

637 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

638 #ifdeà
__REDIRECT


642 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

643 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

644 
__isoc99_fwsÿnf
)

646 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

647 
__isoc99_wsÿnf
)

649 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

650 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

651 ...), 
__isoc99_swsÿnf
)

654 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

655 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

656 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

657 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

658 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

659 
__THROW
;

660 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

661 
	#wsÿnf
 
__isoc99_wsÿnf


	)

662 
	#swsÿnf
 
__isoc99_swsÿnf


	)

668 #ifdeà
__USE_ISOC99


673 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

674 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

675 
__gnuc_va_li¡
 
__¬g
)

681 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

682 
__gnuc_va_li¡
 
__¬g
)

685 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

686 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

687 
__gnuc_va_li¡
 
__¬g
)

688 
__THROW
 ;

690 #ià!
defšed
 
__USE_GNU
 \

691 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

692 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

693 #ifdeà
__REDIRECT


694 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

695 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

696 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

698 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

699 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

701 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

702 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

703 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

706 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

707 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

708 
__gnuc_va_li¡
 
__¬g
);

709 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

710 
__gnuc_va_li¡
 
__¬g
);

711 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

712 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

713 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

714 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

715 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

716 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

727 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

728 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

734 
wšt_t
 
	`g‘wch¬
 ();

741 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

742 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

748 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

756 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

757 
__FILE
 *
__»¡riù
 
__¡»am
);

763 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

764 
__FILE
 *
__»¡riù
 
__¡»am
);

771 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

774 #ifdeà
__USE_GNU


782 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

783 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

791 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

799 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

808 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

809 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

818 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

819 
__FILE
 *
__»¡riù
 
__¡»am
);

827 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

828 
__FILE
 *
__»¡riù
 
__¡»am
);

835 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

836 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

837 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

839 #ifdeà
__USE_GNU


842 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

843 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

844 cÚ¡ 
tm
 *
__»¡riù
 
__
,

845 
loÿË_t
 
__loc
è
__THROW
;

849 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


850 
	~<b™s/wch¬2.h
>

853 #ifdeà
__LDBL_COMPAT


854 
	~<b™s/wch¬-ldbl.h
>

857 
__END_DECLS


	@/usr/include/asm/unistd.h

2 #iâdeà
_ASM_X86_UNISTD_H


3 
	#_ASM_X86_UNISTD_H


	)

6 
	#__X32_SYSCALL_BIT
 0x40000000

	)

8 #ifdeà
__i386__


9 
	~<asm/uni¡d_32.h
>

10 #–ià
defšed
(
__ILP32__
)

11 
	~<asm/uni¡d_x32.h
>

13 
	~<asm/uni¡d_64.h
>

	@/usr/include/bits/byteswap.h

19 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


23 #iâdeà
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((è((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8)))

	)

35 
	~<b™s/by‹sw­-16.h
>

38 
	#__bsw­_cÚ¡ªt_32
(
x
) \

39 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

40 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

42 #ifdeà
__GNUC__


43 #ià
__GNUC_PREREQ
 (4, 3)

44 
__šlše
 

45 
	$__bsw­_32
 (
__bsx
)

47  
	`__butš_bsw­32
 (
__bsx
);

48 
	}
}

49 #–ià
__GNUC__
 >= 2

50 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

51 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

52 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

53 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

54 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

55 || 
defšed
 
	g__amdçm10__
)

58 
	#__bsw­_32
(
x
) \

59 (
__ex‹nsiÚ__
 \

60 ({ 
__v
, 
__x
 = (
x
); \

61 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

62 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

64 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

65 
__v
; }))

	)

67 
	#__bsw­_32
(
x
) \

68 (
__ex‹nsiÚ__
 \

69 ({ 
__v
, 
__x
 = (
x
); \

70 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

71 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

73 
	`__asm__
 ("rorw $8, %w0;" \

76 : "ô" (
__v
) \

77 : "0" (
__x
) \

79 
__v
; }))

	)

82 
	#__bsw­_32
(
x
) \

83 (
__ex‹nsiÚ__
 \

84 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

87 
__šlše
 

88 
	$__bsw­_32
 (
__bsx
)

90  
	`__bsw­_cÚ¡ªt_32
 (
__bsx
);

91 
	}
}

95 #ià
__GNUC_PREREQ
 (2, 0)

97 
	#__bsw­_cÚ¡ªt_64
(
x
) \

98 (
	`__ex‹nsiÚ__
 ((((
x
) & 0xff00000000000000ull) >> 56) \

99 | (((
x
) & 0x00ff000000000000ull) >> 40) \

100 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

101 | (((
x
) & 0x000000ff00000000ull) >> 8) \

102 | (((
x
) & 0x00000000ff000000ull) << 8) \

103 | (((
x
) & 0x0000000000ff0000ull) << 24) \

104 | (((
x
) & 0x000000000000ff00ull) << 40) \

105 | (((
x
è& 0x00000000000000ffuÎè<< 56)))

	)

107 #ià
__GNUC_PREREQ
 (4, 3)

108 
__šlše
 
__ušt64_t


109 
	$__bsw­_64
 (
__ušt64_t
 
__bsx
)

111  
	`__butš_bsw­64
 (
__bsx
);

112 
	}
}

113 #–ià
__WORDSIZE
 == 64

114 
	#__bsw­_64
(
x
) \

115 (
__ex‹nsiÚ__
 \

116 ({ 
__ušt64_t
 
__v
, 
__x
 = (
x
); \

117 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

118 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

120 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

121 
__v
; }))

	)

123 
	#__bsw­_64
(
x
) \

124 (
__ex‹nsiÚ__
 \

125 ({ uniÚ { 
__ex‹nsiÚ__
 
__ušt64_t
 
__Î
; \

126 
__l
[2]; } 
__w
, 
__r
; \

127 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

128 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

131 
__w
.
__Î
 = (
x
); \

132 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

133 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

135 
__r
.
__Î
; }))

	)

138 
	#__bsw­_cÚ¡ªt_64
(
x
) \

139 ((((
x
) & 0xff00000000000000ull) >> 56) \

140 | (((
x
) & 0x00ff000000000000ull) >> 40) \

141 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

142 | (((
x
) & 0x000000ff00000000ull) >> 8) \

143 | (((
x
) & 0x00000000ff000000ull) << 8) \

144 | (((
x
) & 0x0000000000ff0000ull) << 24) \

145 | (((
x
) & 0x000000000000ff00ull) << 40) \

146 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

148 
__šlše
 
__ušt64_t


149 
	$__bsw­_64
 (
__ušt64_t
 
__bsx
)

151  
	`__bsw­_cÚ¡ªt_64
 (
__bsx
);

152 
	}
}

	@/usr/include/bits/confname.h

19 #iâdeà
_UNISTD_H


26 
	m_PC_LINK_MAX
,

27 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

28 
	m_PC_MAX_CANON
,

29 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

30 
	m_PC_MAX_INPUT
,

31 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

32 
	m_PC_NAME_MAX
,

33 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

34 
	m_PC_PATH_MAX
,

35 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

36 
	m_PC_PIPE_BUF
,

37 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

38 
	m_PC_CHOWN_RESTRICTED
,

39 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

40 
	m_PC_NO_TRUNC
,

41 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

42 
	m_PC_VDISABLE
,

43 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

44 
	m_PC_SYNC_IO
,

45 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

46 
	m_PC_ASYNC_IO
,

47 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

48 
	m_PC_PRIO_IO
,

49 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

50 
	m_PC_SOCK_MAXBUF
,

51 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

52 
	m_PC_FILESIZEBITS
,

53 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

54 
	m_PC_REC_INCR_XFER_SIZE
,

55 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

56 
	m_PC_REC_MAX_XFER_SIZE
,

57 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

58 
	m_PC_REC_MIN_XFER_SIZE
,

59 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

60 
	m_PC_REC_XFER_ALIGN
,

61 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

62 
	m_PC_ALLOC_SIZE_MIN
,

63 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

64 
	m_PC_SYMLINK_MAX
,

65 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

66 
	m_PC_2_SYMLINKS


67 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

73 
	m_SC_ARG_MAX
,

74 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

75 
	m_SC_CHILD_MAX
,

76 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

77 
	m_SC_CLK_TCK
,

78 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

79 
	m_SC_NGROUPS_MAX
,

80 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

81 
	m_SC_OPEN_MAX
,

82 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

83 
	m_SC_STREAM_MAX
,

84 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

85 
	m_SC_TZNAME_MAX
,

86 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

87 
	m_SC_JOB_CONTROL
,

88 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

89 
	m_SC_SAVED_IDS
,

90 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

91 
	m_SC_REALTIME_SIGNALS
,

92 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

93 
	m_SC_PRIORITY_SCHEDULING
,

94 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

95 
	m_SC_TIMERS
,

96 
	#_SC_TIMERS
 
_SC_TIMERS


	)

97 
	m_SC_ASYNCHRONOUS_IO
,

98 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

99 
	m_SC_PRIORITIZED_IO
,

100 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

101 
	m_SC_SYNCHRONIZED_IO
,

102 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

103 
	m_SC_FSYNC
,

104 
	#_SC_FSYNC
 
_SC_FSYNC


	)

105 
	m_SC_MAPPED_FILES
,

106 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

107 
	m_SC_MEMLOCK
,

108 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

109 
	m_SC_MEMLOCK_RANGE
,

110 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

111 
	m_SC_MEMORY_PROTECTION
,

112 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

113 
	m_SC_MESSAGE_PASSING
,

114 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

115 
	m_SC_SEMAPHORES
,

116 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

117 
	m_SC_SHARED_MEMORY_OBJECTS
,

118 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

119 
	m_SC_AIO_LISTIO_MAX
,

120 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

121 
	m_SC_AIO_MAX
,

122 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

123 
	m_SC_AIO_PRIO_DELTA_MAX
,

124 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

125 
	m_SC_DELAYTIMER_MAX
,

126 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

127 
	m_SC_MQ_OPEN_MAX
,

128 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

129 
	m_SC_MQ_PRIO_MAX
,

130 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

131 
	m_SC_VERSION
,

132 
	#_SC_VERSION
 
_SC_VERSION


	)

133 
	m_SC_PAGESIZE
,

134 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

135 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

136 
	m_SC_RTSIG_MAX
,

137 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

138 
	m_SC_SEM_NSEMS_MAX
,

139 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

140 
	m_SC_SEM_VALUE_MAX
,

141 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

142 
	m_SC_SIGQUEUE_MAX
,

143 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

144 
	m_SC_TIMER_MAX
,

145 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

149 
	m_SC_BC_BASE_MAX
,

150 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

151 
	m_SC_BC_DIM_MAX
,

152 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

153 
	m_SC_BC_SCALE_MAX
,

154 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

155 
	m_SC_BC_STRING_MAX
,

156 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

157 
	m_SC_COLL_WEIGHTS_MAX
,

158 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

159 
	m_SC_EQUIV_CLASS_MAX
,

160 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

161 
	m_SC_EXPR_NEST_MAX
,

162 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

163 
	m_SC_LINE_MAX
,

164 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

165 
	m_SC_RE_DUP_MAX
,

166 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

167 
	m_SC_CHARCLASS_NAME_MAX
,

168 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

170 
	m_SC_2_VERSION
,

171 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

172 
	m_SC_2_C_BIND
,

173 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

174 
	m_SC_2_C_DEV
,

175 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

176 
	m_SC_2_FORT_DEV
,

177 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

178 
	m_SC_2_FORT_RUN
,

179 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

180 
	m_SC_2_SW_DEV
,

181 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

182 
	m_SC_2_LOCALEDEF
,

183 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

185 
	m_SC_PII
,

186 
	#_SC_PII
 
_SC_PII


	)

187 
	m_SC_PII_XTI
,

188 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

189 
	m_SC_PII_SOCKET
,

190 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

191 
	m_SC_PII_INTERNET
,

192 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

193 
	m_SC_PII_OSI
,

194 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

195 
	m_SC_POLL
,

196 
	#_SC_POLL
 
_SC_POLL


	)

197 
	m_SC_SELECT
,

198 
	#_SC_SELECT
 
_SC_SELECT


	)

199 
	m_SC_UIO_MAXIOV
,

200 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

201 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

202 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

203 
	m_SC_PII_INTERNET_STREAM
,

204 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

205 
	m_SC_PII_INTERNET_DGRAM
,

206 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

207 
	m_SC_PII_OSI_COTS
,

208 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

209 
	m_SC_PII_OSI_CLTS
,

210 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

211 
	m_SC_PII_OSI_M
,

212 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

213 
	m_SC_T_IOV_MAX
,

214 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

217 
	m_SC_THREADS
,

218 
	#_SC_THREADS
 
_SC_THREADS


	)

219 
	m_SC_THREAD_SAFE_FUNCTIONS
,

220 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

221 
	m_SC_GETGR_R_SIZE_MAX
,

222 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

223 
	m_SC_GETPW_R_SIZE_MAX
,

224 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

225 
	m_SC_LOGIN_NAME_MAX
,

226 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

227 
	m_SC_TTY_NAME_MAX
,

228 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

229 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

230 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

231 
	m_SC_THREAD_KEYS_MAX
,

232 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

233 
	m_SC_THREAD_STACK_MIN
,

234 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

235 
	m_SC_THREAD_THREADS_MAX
,

236 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

237 
	m_SC_THREAD_ATTR_STACKADDR
,

238 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

239 
	m_SC_THREAD_ATTR_STACKSIZE
,

240 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

241 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

242 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

243 
	m_SC_THREAD_PRIO_INHERIT
,

244 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

245 
	m_SC_THREAD_PRIO_PROTECT
,

246 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

247 
	m_SC_THREAD_PROCESS_SHARED
,

248 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

250 
	m_SC_NPROCESSORS_CONF
,

251 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

252 
	m_SC_NPROCESSORS_ONLN
,

253 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

254 
	m_SC_PHYS_PAGES
,

255 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

256 
	m_SC_AVPHYS_PAGES
,

257 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

258 
	m_SC_ATEXIT_MAX
,

259 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

260 
	m_SC_PASS_MAX
,

261 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

263 
	m_SC_XOPEN_VERSION
,

264 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

265 
	m_SC_XOPEN_XCU_VERSION
,

266 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

267 
	m_SC_XOPEN_UNIX
,

268 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

269 
	m_SC_XOPEN_CRYPT
,

270 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

271 
	m_SC_XOPEN_ENH_I18N
,

272 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

273 
	m_SC_XOPEN_SHM
,

274 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

276 
	m_SC_2_CHAR_TERM
,

277 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

278 
	m_SC_2_C_VERSION
,

279 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

280 
	m_SC_2_UPE
,

281 
	#_SC_2_UPE
 
_SC_2_UPE


	)

283 
	m_SC_XOPEN_XPG2
,

284 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

285 
	m_SC_XOPEN_XPG3
,

286 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

287 
	m_SC_XOPEN_XPG4
,

288 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

290 
	m_SC_CHAR_BIT
,

291 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

292 
	m_SC_CHAR_MAX
,

293 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

294 
	m_SC_CHAR_MIN
,

295 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

296 
	m_SC_INT_MAX
,

297 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

298 
	m_SC_INT_MIN
,

299 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

300 
	m_SC_LONG_BIT
,

301 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

302 
	m_SC_WORD_BIT
,

303 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

304 
	m_SC_MB_LEN_MAX
,

305 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

306 
	m_SC_NZERO
,

307 
	#_SC_NZERO
 
_SC_NZERO


	)

308 
	m_SC_SSIZE_MAX
,

309 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

310 
	m_SC_SCHAR_MAX
,

311 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

312 
	m_SC_SCHAR_MIN
,

313 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

314 
	m_SC_SHRT_MAX
,

315 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

316 
	m_SC_SHRT_MIN
,

317 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

318 
	m_SC_UCHAR_MAX
,

319 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

320 
	m_SC_UINT_MAX
,

321 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

322 
	m_SC_ULONG_MAX
,

323 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

324 
	m_SC_USHRT_MAX
,

325 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

327 
	m_SC_NL_ARGMAX
,

328 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

329 
	m_SC_NL_LANGMAX
,

330 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

331 
	m_SC_NL_MSGMAX
,

332 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

333 
	m_SC_NL_NMAX
,

334 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

335 
	m_SC_NL_SETMAX
,

336 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

337 
	m_SC_NL_TEXTMAX
,

338 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

340 
	m_SC_XBS5_ILP32_OFF32
,

341 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

342 
	m_SC_XBS5_ILP32_OFFBIG
,

343 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

344 
	m_SC_XBS5_LP64_OFF64
,

345 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

346 
	m_SC_XBS5_LPBIG_OFFBIG
,

347 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

349 
	m_SC_XOPEN_LEGACY
,

350 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

351 
	m_SC_XOPEN_REALTIME
,

352 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

353 
	m_SC_XOPEN_REALTIME_THREADS
,

354 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

356 
	m_SC_ADVISORY_INFO
,

357 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

358 
	m_SC_BARRIERS
,

359 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

360 
	m_SC_BASE
,

361 
	#_SC_BASE
 
_SC_BASE


	)

362 
	m_SC_C_LANG_SUPPORT
,

363 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

364 
	m_SC_C_LANG_SUPPORT_R
,

365 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

366 
	m_SC_CLOCK_SELECTION
,

367 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

368 
	m_SC_CPUTIME
,

369 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

370 
	m_SC_THREAD_CPUTIME
,

371 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

372 
	m_SC_DEVICE_IO
,

373 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

374 
	m_SC_DEVICE_SPECIFIC
,

375 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

376 
	m_SC_DEVICE_SPECIFIC_R
,

377 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

378 
	m_SC_FD_MGMT
,

379 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

380 
	m_SC_FIFO
,

381 
	#_SC_FIFO
 
_SC_FIFO


	)

382 
	m_SC_PIPE
,

383 
	#_SC_PIPE
 
_SC_PIPE


	)

384 
	m_SC_FILE_ATTRIBUTES
,

385 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

386 
	m_SC_FILE_LOCKING
,

387 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

388 
	m_SC_FILE_SYSTEM
,

389 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

390 
	m_SC_MONOTONIC_CLOCK
,

391 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

392 
	m_SC_MULTI_PROCESS
,

393 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

394 
	m_SC_SINGLE_PROCESS
,

395 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

396 
	m_SC_NETWORKING
,

397 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

398 
	m_SC_READER_WRITER_LOCKS
,

399 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

400 
	m_SC_SPIN_LOCKS
,

401 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

402 
	m_SC_REGEXP
,

403 
	#_SC_REGEXP
 
_SC_REGEXP


	)

404 
	m_SC_REGEX_VERSION
,

405 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

406 
	m_SC_SHELL
,

407 
	#_SC_SHELL
 
_SC_SHELL


	)

408 
	m_SC_SIGNALS
,

409 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

410 
	m_SC_SPAWN
,

411 
	#_SC_SPAWN
 
_SC_SPAWN


	)

412 
	m_SC_SPORADIC_SERVER
,

413 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

414 
	m_SC_THREAD_SPORADIC_SERVER
,

415 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

416 
	m_SC_SYSTEM_DATABASE
,

417 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

418 
	m_SC_SYSTEM_DATABASE_R
,

419 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

420 
	m_SC_TIMEOUTS
,

421 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

422 
	m_SC_TYPED_MEMORY_OBJECTS
,

423 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

424 
	m_SC_USER_GROUPS
,

425 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

426 
	m_SC_USER_GROUPS_R
,

427 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

428 
	m_SC_2_PBS
,

429 
	#_SC_2_PBS
 
_SC_2_PBS


	)

430 
	m_SC_2_PBS_ACCOUNTING
,

431 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

432 
	m_SC_2_PBS_LOCATE
,

433 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

434 
	m_SC_2_PBS_MESSAGE
,

435 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

436 
	m_SC_2_PBS_TRACK
,

437 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

438 
	m_SC_SYMLOOP_MAX
,

439 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

440 
	m_SC_STREAMS
,

441 
	#_SC_STREAMS
 
_SC_STREAMS


	)

442 
	m_SC_2_PBS_CHECKPOINT
,

443 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

445 
	m_SC_V6_ILP32_OFF32
,

446 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

447 
	m_SC_V6_ILP32_OFFBIG
,

448 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

449 
	m_SC_V6_LP64_OFF64
,

450 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

451 
	m_SC_V6_LPBIG_OFFBIG
,

452 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

454 
	m_SC_HOST_NAME_MAX
,

455 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

456 
	m_SC_TRACE
,

457 
	#_SC_TRACE
 
_SC_TRACE


	)

458 
	m_SC_TRACE_EVENT_FILTER
,

459 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

460 
	m_SC_TRACE_INHERIT
,

461 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

462 
	m_SC_TRACE_LOG
,

463 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

465 
	m_SC_LEVEL1_ICACHE_SIZE
,

466 
	#_SC_LEVEL1_ICACHE_SIZE
 
_SC_LEVEL1_ICACHE_SIZE


	)

467 
	m_SC_LEVEL1_ICACHE_ASSOC
,

468 
	#_SC_LEVEL1_ICACHE_ASSOC
 
_SC_LEVEL1_ICACHE_ASSOC


	)

469 
	m_SC_LEVEL1_ICACHE_LINESIZE
,

470 
	#_SC_LEVEL1_ICACHE_LINESIZE
 
_SC_LEVEL1_ICACHE_LINESIZE


	)

471 
	m_SC_LEVEL1_DCACHE_SIZE
,

472 
	#_SC_LEVEL1_DCACHE_SIZE
 
_SC_LEVEL1_DCACHE_SIZE


	)

473 
	m_SC_LEVEL1_DCACHE_ASSOC
,

474 
	#_SC_LEVEL1_DCACHE_ASSOC
 
_SC_LEVEL1_DCACHE_ASSOC


	)

475 
	m_SC_LEVEL1_DCACHE_LINESIZE
,

476 
	#_SC_LEVEL1_DCACHE_LINESIZE
 
_SC_LEVEL1_DCACHE_LINESIZE


	)

477 
	m_SC_LEVEL2_CACHE_SIZE
,

478 
	#_SC_LEVEL2_CACHE_SIZE
 
_SC_LEVEL2_CACHE_SIZE


	)

479 
	m_SC_LEVEL2_CACHE_ASSOC
,

480 
	#_SC_LEVEL2_CACHE_ASSOC
 
_SC_LEVEL2_CACHE_ASSOC


	)

481 
	m_SC_LEVEL2_CACHE_LINESIZE
,

482 
	#_SC_LEVEL2_CACHE_LINESIZE
 
_SC_LEVEL2_CACHE_LINESIZE


	)

483 
	m_SC_LEVEL3_CACHE_SIZE
,

484 
	#_SC_LEVEL3_CACHE_SIZE
 
_SC_LEVEL3_CACHE_SIZE


	)

485 
	m_SC_LEVEL3_CACHE_ASSOC
,

486 
	#_SC_LEVEL3_CACHE_ASSOC
 
_SC_LEVEL3_CACHE_ASSOC


	)

487 
	m_SC_LEVEL3_CACHE_LINESIZE
,

488 
	#_SC_LEVEL3_CACHE_LINESIZE
 
_SC_LEVEL3_CACHE_LINESIZE


	)

489 
	m_SC_LEVEL4_CACHE_SIZE
,

490 
	#_SC_LEVEL4_CACHE_SIZE
 
_SC_LEVEL4_CACHE_SIZE


	)

491 
	m_SC_LEVEL4_CACHE_ASSOC
,

492 
	#_SC_LEVEL4_CACHE_ASSOC
 
_SC_LEVEL4_CACHE_ASSOC


	)

493 
	m_SC_LEVEL4_CACHE_LINESIZE
,

494 
	#_SC_LEVEL4_CACHE_LINESIZE
 
_SC_LEVEL4_CACHE_LINESIZE


	)

497 
	m_SC_IPV6
 = 
_SC_LEVEL1_ICACHE_SIZE
 + 50,

498 
	#_SC_IPV6
 
_SC_IPV6


	)

499 
	m_SC_RAW_SOCKETS
,

500 
	#_SC_RAW_SOCKETS
 
_SC_RAW_SOCKETS


	)

502 
	m_SC_V7_ILP32_OFF32
,

503 
	#_SC_V7_ILP32_OFF32
 
_SC_V7_ILP32_OFF32


	)

504 
	m_SC_V7_ILP32_OFFBIG
,

505 
	#_SC_V7_ILP32_OFFBIG
 
_SC_V7_ILP32_OFFBIG


	)

506 
	m_SC_V7_LP64_OFF64
,

507 
	#_SC_V7_LP64_OFF64
 
_SC_V7_LP64_OFF64


	)

508 
	m_SC_V7_LPBIG_OFFBIG
,

509 
	#_SC_V7_LPBIG_OFFBIG
 
_SC_V7_LPBIG_OFFBIG


	)

511 
	m_SC_SS_REPL_MAX
,

512 
	#_SC_SS_REPL_MAX
 
_SC_SS_REPL_MAX


	)

514 
	m_SC_TRACE_EVENT_NAME_MAX
,

515 
	#_SC_TRACE_EVENT_NAME_MAX
 
_SC_TRACE_EVENT_NAME_MAX


	)

516 
	m_SC_TRACE_NAME_MAX
,

517 
	#_SC_TRACE_NAME_MAX
 
_SC_TRACE_NAME_MAX


	)

518 
	m_SC_TRACE_SYS_MAX
,

519 
	#_SC_TRACE_SYS_MAX
 
_SC_TRACE_SYS_MAX


	)

520 
	m_SC_TRACE_USER_EVENT_MAX
,

521 
	#_SC_TRACE_USER_EVENT_MAX
 
_SC_TRACE_USER_EVENT_MAX


	)

523 
	m_SC_XOPEN_STREAMS
,

524 
	#_SC_XOPEN_STREAMS
 
_SC_XOPEN_STREAMS


	)

526 
	m_SC_THREAD_ROBUST_PRIO_INHERIT
,

527 
	#_SC_THREAD_ROBUST_PRIO_INHERIT
 
_SC_THREAD_ROBUST_PRIO_INHERIT


	)

528 
	m_SC_THREAD_ROBUST_PRIO_PROTECT


529 
	#_SC_THREAD_ROBUST_PRIO_PROTECT
 
_SC_THREAD_ROBUST_PRIO_PROTECT


	)

535 
	m_CS_PATH
,

536 
	#_CS_PATH
 
_CS_PATH


	)

538 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

539 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

540 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

542 
	m_CS_GNU_LIBC_VERSION
,

543 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

544 
	m_CS_GNU_LIBPTHREAD_VERSION
,

545 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

547 
	m_CS_V5_WIDTH_RESTRICTED_ENVS
,

548 
	#_CS_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

549 
	#_CS_POSIX_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

551 
	m_CS_V7_WIDTH_RESTRICTED_ENVS
,

552 
	#_CS_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

553 
	#_CS_POSIX_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

555 
	m_CS_LFS_CFLAGS
 = 1000,

556 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

557 
	m_CS_LFS_LDFLAGS
,

558 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

559 
	m_CS_LFS_LIBS
,

560 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

561 
	m_CS_LFS_LINTFLAGS
,

562 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

563 
	m_CS_LFS64_CFLAGS
,

564 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

565 
	m_CS_LFS64_LDFLAGS
,

566 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

567 
	m_CS_LFS64_LIBS
,

568 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

569 
	m_CS_LFS64_LINTFLAGS
,

570 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

572 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

573 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

574 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

575 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

576 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

577 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

578 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

579 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

580 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

581 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

582 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

583 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

584 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

585 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

586 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

587 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

588 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

589 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

590 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

591 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

592 
	m_CS_XBS5_LP64_OFF64_LIBS
,

593 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

594 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

595 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

596 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

597 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

598 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

599 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

600 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

601 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

602 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

603 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

605 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

606 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

607 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

608 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

609 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

610 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

611 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

612 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

613 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

614 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

615 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

616 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

617 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

618 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

619 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

620 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

621 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

622 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

623 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

624 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

625 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

626 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

627 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

628 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

629 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

630 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

631 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

632 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

633 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

634 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

635 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
,

636 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

638 
	m_CS_POSIX_V7_ILP32_OFF32_CFLAGS
,

639 
	#_CS_POSIX_V7_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_CFLAGS


	)

640 
	m_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
,

641 
	#_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LDFLAGS


	)

642 
	m_CS_POSIX_V7_ILP32_OFF32_LIBS
,

643 
	#_CS_POSIX_V7_ILP32_OFF32_LIBS
 
_CS_POSIX_V7_ILP32_OFF32_LIBS


	)

644 
	m_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
,

645 
	#_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS


	)

646 
	m_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
,

647 
	#_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS


	)

648 
	m_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
,

649 
	#_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS


	)

650 
	m_CS_POSIX_V7_ILP32_OFFBIG_LIBS
,

651 
	#_CS_POSIX_V7_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V7_ILP32_OFFBIG_LIBS


	)

652 
	m_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
,

653 
	#_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS


	)

654 
	m_CS_POSIX_V7_LP64_OFF64_CFLAGS
,

655 
	#_CS_POSIX_V7_LP64_OFF64_CFLAGS
 
_CS_POSIX_V7_LP64_OFF64_CFLAGS


	)

656 
	m_CS_POSIX_V7_LP64_OFF64_LDFLAGS
,

657 
	#_CS_POSIX_V7_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LDFLAGS


	)

658 
	m_CS_POSIX_V7_LP64_OFF64_LIBS
,

659 
	#_CS_POSIX_V7_LP64_OFF64_LIBS
 
_CS_POSIX_V7_LP64_OFF64_LIBS


	)

660 
	m_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
,

661 
	#_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LINTFLAGS


	)

662 
	m_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
,

663 
	#_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS


	)

664 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
,

665 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS


	)

666 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
,

667 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LIBS


	)

668 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
,

669 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS


	)

671 
	m_CS_V6_ENV
,

672 
	#_CS_V6_ENV
 
_CS_V6_ENV


	)

673 
	m_CS_V7_ENV


674 
	#_CS_V7_ENV
 
_CS_V7_ENV


	)

	@/usr/include/bits/cpu-set.h

20 #iâdeà
_BITS_CPU_SET_H


21 
	#_BITS_CPU_SET_H
 1

	)

23 #iâdeà
_SCHED_H


28 
	#__CPU_SETSIZE
 1024

	)

29 
	#__NCPUBITS
 (8 *  (
__ıu_mask
))

	)

32 
__CPU_MASK_TYPE
 
	t__ıu_mask
;

35 
	#__CPUELT
(
ıu
è((ıuè/ 
__NCPUBITS
)

	)

36 
	#__CPUMASK
(
ıu
è((
__ıu_mask
è1 << ((ıuè% 
__NCPUBITS
))

	)

41 
__ıu_mask
 
	m__b™s
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

42 } 
	tıu_£t_t
;

45 #ià
__GNUC_PREREQ
 (2, 91)

46 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

47 dØ
	`__butš_mem£t
 (
ıu£
, '\0', 
£tsize
); 0)

	)

49 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

51 
size_t
 
__i
; \

52 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

53 
__ıu_mask
 *
__b™s
 = (
ıu£
)->__bits; \

54 
__i
 = 0; __˜< 
__imax
; ++__i) \

55 
__b™s
[
__i
] = 0; \

56 } 0)

	)

58 
	#__CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
) \

59 (
__ex‹nsiÚ__
 \

60 ({ 
size_t
 
__ıu
 = (
ıu
); \

61 
__ıu
 / 8 < (
£tsize
) \

62 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

63 |ğ
	`__CPUMASK
 (
__ıu
)) \

64 : 0; }))

	)

65 
	#__CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
) \

66 (
__ex‹nsiÚ__
 \

67 ({ 
size_t
 
__ıu
 = (
ıu
); \

68 
__ıu
 / 8 < (
£tsize
) \

69 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

70 &ğ~
	`__CPUMASK
 (
__ıu
)) \

71 : 0; }))

	)

72 
	#__CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
) \

73 (
__ex‹nsiÚ__
 \

74 ({ 
size_t
 
__ıu
 = (
ıu
); \

75 
__ıu
 / 8 < (
£tsize
) \

76 ? ((((cÚ¡ 
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

77 & 
	`__CPUMASK
 (
__ıu
))) != 0 \

78 : 0; }))

	)

80 
	#__CPU_COUNT_S
(
£tsize
, 
ıu£
) \

81 
	`__sched_ıucouÁ
 (
£tsize
, 
ıu£
)

	)

83 #ià
__GNUC_PREREQ
 (2, 91)

84 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

85 (
	`__butš_memcmp
 (
ıu£1
, 
ıu£2
, 
£tsize
è=ğ0)

	)

87 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

88 (
__ex‹nsiÚ__
 \

89 ({ cÚ¡ 
__ıu_mask
 *
__¬r1
 = (
ıu£1
)->
__b™s
; \

90 cÚ¡ 
__ıu_mask
 *
__¬r2
 = (
ıu£2
)->
__b™s
; \

91 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

92 
size_t
 
__i
; \

93 
__i
 = 0; __˜< 
__imax
; ++__i) \

94 ià(
__¬r1
[
__i
] !ğ
__¬r2
[__i]) \

96 
__i
 =ğ
__imax
; }))

	)

99 
	#__CPU_OP_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, 
İ
) \

100 (
__ex‹nsiÚ__
 \

101 ({ 
ıu_£t_t
 *
__de¡
 = (
de¡£t
); \

102 cÚ¡ 
__ıu_mask
 *
__¬r1
 = (
¤c£t1
)->
__b™s
; \

103 cÚ¡ 
__ıu_mask
 *
__¬r2
 = (
¤c£t2
)->
__b™s
; \

104 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

105 
size_t
 
__i
; \

106 
__i
 = 0; __˜< 
__imax
; ++__i) \

107 ((
__ıu_mask
 *è
__de¡
->
__b™s
)[
__i
] = 
__¬r1
[__i] 
İ
 
__¬r2
[__i]; \

108 
__de¡
; }))

	)

110 
	#__CPU_ALLOC_SIZE
(
couÁ
) \

111 ((((
couÁ
è+ 
__NCPUBITS
 - 1è/ __NCPUBITSè*  (
__ıu_mask
))

	)

112 
	#__CPU_ALLOC
(
couÁ
è
	`__sched_ıu®loc
 (couÁ)

	)

113 
	#__CPU_FREE
(
ıu£t
è
	`__sched_ıuä“
 (ıu£t)

	)

115 
__BEGIN_DECLS


117 
	$__sched_ıucouÁ
 (
size_t
 
__£tsize
, cÚ¡ 
ıu_£t_t
 *
__£
)

118 
__THROW
;

119 
ıu_£t_t
 *
	$__sched_ıu®loc
 (
size_t
 
__couÁ
è
__THROW
 
__wur
;

120 
	$__sched_ıuä“
 (
ıu_£t_t
 *
__£t
è
__THROW
;

122 
__END_DECLS


	@/usr/include/bits/dlfcn.h

19 #iâdeà
_DLFCN_H


24 
	#RTLD_LAZY
 0x00001

	)

25 
	#RTLD_NOW
 0x00002

	)

26 
	#RTLD_BINDING_MASK
 0x3

	)

27 
	#RTLD_NOLOAD
 0x00004

	)

28 
	#RTLD_DEEPBIND
 0x00008

	)

33 
	#RTLD_GLOBAL
 0x00100

	)

38 
	#RTLD_LOCAL
 0

	)

41 
	#RTLD_NODELETE
 0x01000

	)

43 #ifdeà
__USE_GNU


54 
	#DL_CALL_FCT
(
fùp
, 
¬gs
) \

55 (
	`_dl_mcouÁ_w¿µ”_check
 ((*è(
fùp
)), (*(fùp)è
¬gs
)

	)

57 
__BEGIN_DECLS


60 
	$_dl_mcouÁ_w¿µ”_check
 (*
__£låc
è
__THROW
;

62 
__END_DECLS


	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/environments.h

18 #iâdeà
_UNISTD_H


22 
	~<b™s/wÜdsize.h
>

42 #ià
__WORDSIZE
 == 64

56 
	#_POSIX_V7_LPBIG_OFFBIG
 -1

	)

57 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

58 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

61 
	#_POSIX_V7_LP64_OFF64
 1

	)

62 
	#_POSIX_V6_LP64_OFF64
 1

	)

63 
	#_XBS5_LP64_OFF64
 1

	)

69 
	#_POSIX_V7_ILP32_OFFBIG
 1

	)

70 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

71 
	#_XBS5_ILP32_OFFBIG
 1

	)

73 #iâdeà
__x86_64__


75 
	#_POSIX_V7_ILP32_OFF32
 1

	)

76 
	#_POSIX_V6_ILP32_OFF32
 1

	)

77 
	#_XBS5_ILP32_OFF32
 1

	)

95 
	#__ILP32_OFF32_CFLAGS
 "-m32"

	)

96 
	#__ILP32_OFF32_LDFLAGS
 "-m32"

	)

97 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


98 
	#__ILP32_OFFBIG_CFLAGS
 "-mx32"

	)

99 
	#__ILP32_OFFBIG_LDFLAGS
 "-mx32"

	)

101 
	#__ILP32_OFFBIG_CFLAGS
 "-m32 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	)

102 
	#__ILP32_OFFBIG_LDFLAGS
 "-m32"

	)

104 
	#__LP64_OFF64_CFLAGS
 "-m64"

	)

105 
	#__LP64_OFF64_LDFLAGS
 "-m64"

	)

	@/usr/include/bits/epoll.h

18 #iâdef 
_SYS_EPOLL_H


25 
	mEPOLL_CLOEXEC
 = 02000000

26 
	#EPOLL_CLOEXEC
 
EPOLL_CLOEXEC


	)

29 
	#__EPOLL_PACKED
 
	`__©Œibu‹__
 ((
__·cked__
))

	)

	@/usr/include/bits/errno.h

19 #iâdeà
_BITS_ERRNO_H


20 
	#_BITS_ERRNO_H
 1

	)

22 #ià!
defšed
 
_ERRNO_H


26 
	~<lšux/”ºo.h
>

29 #iâdeà
ENOTSUP


30 
	#ENOTSUP
 
EOPNOTSUPP


	)

33 #iâdeà
ECANCELED


34 
	#ECANCELED
 125

	)

37 #iâdeà
EOWNERDEAD


38 
	#EOWNERDEAD
 130

	)

41 #iâdeà
ENOTRECOVERABLE


42 
	#ENOTRECOVERABLE
 131

	)

45 #iâdeà
ERFKILL


46 
	#ERFKILL
 132

	)

49 #iâdeà
EHWPOISON


50 
	#EHWPOISON
 133

	)

	@/usr/include/bits/fcntl.h

19 #iâdeà
_FCNTL_H


23 #ifdeà
__x86_64__


24 
	#__O_LARGEFILE
 0

	)

27 #ifdeà
__x86_64__


29 
	#F_GETLK64
 5

	)

30 
	#F_SETLK64
 6

	)

31 
	#F_SETLKW64
 7

	)

35 
	sæock


37 
	ml_ty³
;

38 
	ml_wh’û
;

39 #iâdeà
__USE_FILE_OFFSET64


40 
__off_t
 
	ml_¡¬t
;

41 
__off_t
 
	ml_Ën
;

43 
__off64_t
 
	ml_¡¬t
;

44 
__off64_t
 
	ml_Ën
;

46 
__pid_t
 
	ml_pid
;

49 #ifdeà
__USE_LARGEFILE64


50 
	sæock64


52 
	ml_ty³
;

53 
	ml_wh’û
;

54 
__off64_t
 
	ml_¡¬t
;

55 
__off64_t
 
	ml_Ën
;

56 
__pid_t
 
	ml_pid
;

61 
	~<b™s/fú-lšux.h
>

	@/usr/include/bits/fcntl2.h

19 #iâdef 
_FCNTL_H


25 #iâdeà
__USE_FILE_OFFSET64


26 
	$__İ’_2
 (cÚ¡ *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

27 
	`__REDIRECT
 (
__İ’_®Ÿs
, (cÚ¡ *
__·th
, 
__oæag
, ...),

28 
İ’
è
	`__nÚnuÎ
 ((1));

30 
	`__REDIRECT
 (
__İ’_2
, (cÚ¡ *
__·th
, 
__oæag
),

31 
__İ’64_2
è
	`__nÚnuÎ
 ((1));

32 
	`__REDIRECT
 (
__İ’_®Ÿs
, (cÚ¡ *
__·th
, 
__oæag
, ...),

33 
İ’64
è
	`__nÚnuÎ
 ((1));

35 
	`__”rÜdeş
 (
__İ’_too_mªy_¬gs
,

37 
	`__”rÜdeş
 (
__İ’_missšg_mode
,

40 
__fÜtify_funùiÚ
 

41 
	$İ’
 (cÚ¡ *
__·th
, 
__oæag
, ...)

43 ià(
	`__va_¬g_·ck_Ën
 () > 1)

44 
	`__İ’_too_mªy_¬gs
 ();

46 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

48 ià(
	`__OPEN_NEEDS_MODE
 (
__oæag
è&& 
	`__va_¬g_·ck_Ën
 () < 1)

50 
	`__İ’_missšg_mode
 ();

51  
	`__İ’_2
 (
__·th
, 
__oæag
);

53  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

56 ià(
	`__va_¬g_·ck_Ën
 () < 1)

57  
	`__İ’_2
 (
__·th
, 
__oæag
);

59  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

60 
	}
}

63 #ifdeà
__USE_LARGEFILE64


64 
	$__İ’64_2
 (cÚ¡ *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

65 
	`__REDIRECT
 (
__İ’64_®Ÿs
, (cÚ¡ *
__·th
, 
__oæag
,

66 ...), 
İ’64
è
	`__nÚnuÎ
 ((1));

67 
	`__”rÜdeş
 (
__İ’64_too_mªy_¬gs
,

69 
	`__”rÜdeş
 (
__İ’64_missšg_mode
,

72 
__fÜtify_funùiÚ
 

73 
	$İ’64
 (cÚ¡ *
__·th
, 
__oæag
, ...)

75 ià(
	`__va_¬g_·ck_Ën
 () > 1)

76 
	`__İ’64_too_mªy_¬gs
 ();

78 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

80 ià(
	`__OPEN_NEEDS_MODE
 (
__oæag
è&& 
	`__va_¬g_·ck_Ën
 () < 1)

82 
	`__İ’64_missšg_mode
 ();

83  
	`__İ’64_2
 (
__·th
, 
__oæag
);

85  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

88 ià(
	`__va_¬g_·ck_Ën
 () < 1)

89  
	`__İ’64_2
 (
__·th
, 
__oæag
);

91  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

92 
	}
}

96 #ifdeà
__USE_ATFILE


97 #iâdeà
__USE_FILE_OFFSET64


98 
	$__İ’©_2
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
)

99 
	`__nÚnuÎ
 ((2));

100 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, cÚ¡ *
__·th
,

101 
__oæag
, ...), 
İ’©
)

102 
	`__nÚnuÎ
 ((2));

104 
	`__REDIRECT
 (
__İ’©_2
, (
__fd
, cÚ¡ *
__·th
,

105 
__oæag
), 
__İ’©64_2
)

106 
	`__nÚnuÎ
 ((2));

107 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, cÚ¡ *
__·th
,

108 
__oæag
, ...), 
İ’©64
)

109 
	`__nÚnuÎ
 ((2));

111 
	`__”rÜdeş
 (
__İ’©_too_mªy_¬gs
,

113 
	`__”rÜdeş
 (
__İ’©_missšg_mode
,

116 
__fÜtify_funùiÚ
 

117 
	$İ’©
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
, ...)

119 ià(
	`__va_¬g_·ck_Ën
 () > 1)

120 
	`__İ’©_too_mªy_¬gs
 ();

122 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

124 ià(
	`__OPEN_NEEDS_MODE
 (
__oæag
è&& 
	`__va_¬g_·ck_Ën
 () < 1)

126 
	`__İ’©_missšg_mode
 ();

127  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

129  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

132 ià(
	`__va_¬g_·ck_Ën
 () < 1)

133  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

135  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

136 
	}
}

139 #ifdeà
__USE_LARGEFILE64


140 
	$__İ’©64_2
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
)

141 
	`__nÚnuÎ
 ((2));

142 
	`__REDIRECT
 (
__İ’©64_®Ÿs
, (
__fd
, cÚ¡ *
__·th
,

143 
__oæag
, ...), 
İ’©64
)

144 
	`__nÚnuÎ
 ((2));

145 
	`__”rÜdeş
 (
__İ’©64_too_mªy_¬gs
,

147 
	`__”rÜdeş
 (
__İ’©64_missšg_mode
,

150 
__fÜtify_funùiÚ
 

151 
	$İ’©64
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
, ...)

153 ià(
	`__va_¬g_·ck_Ën
 () > 1)

154 
	`__İ’©64_too_mªy_¬gs
 ();

156 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

158 ià(
	`__OPEN_NEEDS_MODE
 (
__oæag
è&& 
	`__va_¬g_·ck_Ën
 () < 1)

160 
	`__İ’©64_missšg_mode
 ();

161  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

163  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

166 ià(
	`__va_¬g_·ck_Ën
 () < 1)

167  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

169  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

170 
	}
}

	@/usr/include/bits/floatn.h

19 #iâdeà
_BITS_FLOATN_H


20 
	#_BITS_FLOATN_H


	)

22 
	~<ã©u»s.h
>

29 #ià(
defšed
 
__x86_64__
 \

30 ? 
__GNUC_PREREQ
 (4, 3) \

31 : (
defšed
 
__GNU__
 ? 
	$__GNUC_PREREQ
 (4, 5è: 
	`__GNUC_PREREQ
 (4, 4))) \

32 && !
	`defšed
(
__CUDACC__
è&& !
	$defšed
(
__ICC
)

33 
	#__HAVE_FLOAT128
 1

	)

35 
	#__HAVE_FLOAT128
 0

	)

40 #ià
__HAVE_FLOAT128


41 
	#__HAVE_DISTINCT_FLOAT128
 1

	)

43 
	#__HAVE_DISTINCT_FLOAT128
 0

	)

49 
	#__HAVE_FLOAT64X
 1

	)

55 
	#__HAVE_FLOAT64X_LONG_DOUBLE
 1

	)

57 #iâdeà
__ASSEMBLER__


61 #ià
__HAVE_FLOAT128


62 #ià!
	`__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


64 
	#__f128
(
x
èx##
q


	)

66 
	#__f128
(
x
èx##
f128


	)

71 #ià
__HAVE_FLOAT128


72 #ià!
	`__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


75 
_Com¶ex
 
	t__cæßt128
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__TC__
)));

76 
	#__CFLOAT128
 
__cæßt128


	)

78 
	#__CFLOAT128
 
_Com¶ex
 
_Flßt128


	)

83 #ià
__HAVE_FLOAT128


86 #ià!
	`__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


87 
__æßt128
 
	t_Flßt128
;

91 #ià!
	`__GNUC_PREREQ
 (7, 0)

92 
	#__butš_huge_v®f128
(è((
_Flßt128
è
	`__butš_huge_v®
 ())

	)

100 #ià!
	`__GNUC_PREREQ
 (7, 0)

101 
	#__butš_cİysignf128
 
__butš_cİysignq


	)

102 
	#__butš_çbsf128
 
__butš_çbsq


	)

103 
	#__butš_šff128
(è((
_Flßt128
è
	`__butš_šf
 ())

	)

104 
	#__butš_Çnf128
(
x
è((
_Flßt128
è
	`__butš_Çn
 (x))

	)

105 
	#__butš_Çnsf128
(
x
è((
_Flßt128
è
	`__butš_Çns
 (x))

	)

112 #ià!
	`__GNUC_PREREQ
 (6, 0)

113 
	#__butš_signb™f128
 
__signb™f128


	)

120 
	~<b™s/æßŠ-commÚ.h
>

	@/usr/include/bits/flt-eval-method.h

19 #iâdeà
_MATH_H


23 #ifdeà
__FLT_EVAL_METHOD__


24 #ià
__FLT_EVAL_METHOD__
 == -1

25 
	#__GLIBC_FLT_EVAL_METHOD
 2

	)

27 
	#__GLIBC_FLT_EVAL_METHOD
 
__FLT_EVAL_METHOD__


	)

29 #–ià
defšed
 
__x86_64__


30 
	#__GLIBC_FLT_EVAL_METHOD
 0

	)

32 
	#__GLIBC_FLT_EVAL_METHOD
 2

	)

	@/usr/include/bits/fp-fast.h

19 #iâdeà
_MATH_H


23 #ifdeà
__USE_ISOC99


27 #ifdeà
__FP_FAST_FMA


28 
	#FP_FAST_FMA
 1

	)

31 #ifdeà
__FP_FAST_FMAF


32 
	#FP_FAST_FMAF
 1

	)

35 #ifdeà
__FP_FAST_FMAL


36 
	#FP_FAST_FMAL
 1

	)

	@/usr/include/bits/fp-logb.h

19 #iâdeà
_MATH_H


23 
	#__FP_LOGB0_IS_MIN
 1

	)

24 
	#__FP_LOGBNAN_IS_MIN
 1

	)

	@/usr/include/bits/getopt_posix.h

20 #iâdeà
_GETOPT_POSIX_H


21 
	#_GETOPT_POSIX_H
 1

	)

23 #ià!
defšed
 
_UNISTD_H
 && !defšed 
_STDIO_H


27 
	~<b™s/g‘İt_cÜe.h
>

29 
	g__BEGIN_DECLS


31 #ià
defšed
 
__USE_POSIX2
 && !defšed 
__USE_POSIX_IMPLICITLY
 \

32 && !
defšed
 
	g__USE_GNU
 && !defšed 
	g_GETOPT_H


37 #ifdeà
__REDIRECT


38 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

39 cÚ¡ *
__shÜtİts
),

40 
__posix_g‘İt
);

42 
	$__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

43 cÚ¡ *
__shÜtİts
)

44 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

45 
	#g‘İt
 
__posix_g‘İt


	)

49 
__END_DECLS


	@/usr/include/bits/in.h

20 #iâdeà
_NETINET_IN_H


32 #ià
defšed
 
_UAPI_LINUX_IN6_H
 \

33 || 
defšed
 
	g_UAPI_IPV6_H
 \

34 || 
defšed
 
	g_LINUX_IN6_H
 \

35 || 
defšed
 
	g_IPV6_H


39 
	#__USE_KERNEL_IPV6_DEFS
 1

	)

41 
	#__USE_KERNEL_IPV6_DEFS
 0

	)

47 
	#IP_OPTIONS
 4

	)

48 
	#IP_HDRINCL
 3

	)

49 
	#IP_TOS
 1

	)

50 
	#IP_TTL
 2

	)

51 
	#IP_RECVOPTS
 6

	)

53 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

54 
	#IP_RETOPTS
 7

	)

55 
	#IP_MULTICAST_IF
 32

	)

56 
	#IP_MULTICAST_TTL
 33

	)

57 
	#IP_MULTICAST_LOOP
 34

	)

58 
	#IP_ADD_MEMBERSHIP
 35

	)

59 
	#IP_DROP_MEMBERSHIP
 36

	)

60 
	#IP_UNBLOCK_SOURCE
 37

	)

61 
	#IP_BLOCK_SOURCE
 38

	)

62 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

63 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

64 
	#IP_MSFILTER
 41

	)

65 #ifdeà
__USE_MISC


66 
	#MCAST_JOIN_GROUP
 42

	)

67 
	#MCAST_BLOCK_SOURCE
 43

	)

68 
	#MCAST_UNBLOCK_SOURCE
 44

	)

69 
	#MCAST_LEAVE_GROUP
 45

	)

70 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

71 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

72 
	#MCAST_MSFILTER
 48

	)

73 
	#IP_MULTICAST_ALL
 49

	)

74 
	#IP_UNICAST_IF
 50

	)

76 
	#MCAST_EXCLUDE
 0

	)

77 
	#MCAST_INCLUDE
 1

	)

80 
	#IP_ROUTER_ALERT
 5

	)

81 
	#IP_PKTINFO
 8

	)

82 
	#IP_PKTOPTIONS
 9

	)

83 
	#IP_PMTUDISC
 10

	)

84 
	#IP_MTU_DISCOVER
 10

	)

85 
	#IP_RECVERR
 11

	)

86 
	#IP_RECVTTL
 12

	)

87 
	#IP_RECVTOS
 13

	)

88 
	#IP_MTU
 14

	)

89 
	#IP_FREEBIND
 15

	)

90 
	#IP_IPSEC_POLICY
 16

	)

91 
	#IP_XFRM_POLICY
 17

	)

92 
	#IP_PASSSEC
 18

	)

93 
	#IP_TRANSPARENT
 19

	)

94 
	#IP_MULTICAST_ALL
 49

	)

97 
	#IP_ORIGDSTADDR
 20

	)

98 
	#IP_RECVORIGDSTADDR
 
IP_ORIGDSTADDR


	)

100 
	#IP_MINTTL
 21

	)

101 
	#IP_NODEFRAG
 22

	)

102 
	#IP_CHECKSUM
 23

	)

103 
	#IP_BIND_ADDRESS_NO_PORT
 24

	)

104 
	#IP_RECVFRAGSIZE
 25

	)

107 
	#IP_PMTUDISC_DONT
 0

	)

108 
	#IP_PMTUDISC_WANT
 1

	)

109 
	#IP_PMTUDISC_DO
 2

	)

110 
	#IP_PMTUDISC_PROBE
 3

	)

114 
	#IP_PMTUDISC_INTERFACE
 4

	)

116 
	#IP_PMTUDISC_OMIT
 5

	)

118 
	#IP_MULTICAST_IF
 32

	)

119 
	#IP_MULTICAST_TTL
 33

	)

120 
	#IP_MULTICAST_LOOP
 34

	)

121 
	#IP_ADD_MEMBERSHIP
 35

	)

122 
	#IP_DROP_MEMBERSHIP
 36

	)

123 
	#IP_UNBLOCK_SOURCE
 37

	)

124 
	#IP_BLOCK_SOURCE
 38

	)

125 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

126 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

127 
	#IP_MSFILTER
 41

	)

128 
	#IP_MULTICAST_ALL
 49

	)

129 
	#IP_UNICAST_IF
 50

	)

132 
	#SOL_IP
 0

	)

134 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

135 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

136 
	#IP_MAX_MEMBERSHIPS
 20

	)

138 #ifdeà
__USE_MISC


142 
	s_İts


144 
š_addr
 
	m_d¡
;

145 
	m_İts
[40];

149 
	s_m»qn


151 
š_addr
 
	mimr_muÉŸddr
;

152 
š_addr
 
	mimr_add»ss
;

153 
	mimr_ifšdex
;

157 
	sš_pktšfo


159 
	mi_ifšdex
;

160 
š_addr
 
	mi_¥ec_d¡
;

161 
š_addr
 
	mi_addr
;

168 
	#IPV6_ADDRFORM
 1

	)

169 
	#IPV6_2292PKTINFO
 2

	)

170 
	#IPV6_2292HOPOPTS
 3

	)

171 
	#IPV6_2292DSTOPTS
 4

	)

172 
	#IPV6_2292RTHDR
 5

	)

173 
	#IPV6_2292PKTOPTIONS
 6

	)

174 
	#IPV6_CHECKSUM
 7

	)

175 
	#IPV6_2292HOPLIMIT
 8

	)

177 
	#SCM_SRCRT
 
IPV6_RXSRCRT


	)

179 
	#IPV6_NEXTHOP
 9

	)

180 
	#IPV6_AUTHHDR
 10

	)

181 
	#IPV6_UNICAST_HOPS
 16

	)

182 
	#IPV6_MULTICAST_IF
 17

	)

183 
	#IPV6_MULTICAST_HOPS
 18

	)

184 
	#IPV6_MULTICAST_LOOP
 19

	)

185 
	#IPV6_JOIN_GROUP
 20

	)

186 
	#IPV6_LEAVE_GROUP
 21

	)

187 
	#IPV6_ROUTER_ALERT
 22

	)

188 
	#IPV6_MTU_DISCOVER
 23

	)

189 
	#IPV6_MTU
 24

	)

190 
	#IPV6_RECVERR
 25

	)

191 
	#IPV6_V6ONLY
 26

	)

192 
	#IPV6_JOIN_ANYCAST
 27

	)

193 
	#IPV6_LEAVE_ANYCAST
 28

	)

194 
	#IPV6_IPSEC_POLICY
 34

	)

195 
	#IPV6_XFRM_POLICY
 35

	)

196 
	#IPV6_HDRINCL
 36

	)

199 
	#IPV6_RECVPKTINFO
 49

	)

200 
	#IPV6_PKTINFO
 50

	)

201 
	#IPV6_RECVHOPLIMIT
 51

	)

202 
	#IPV6_HOPLIMIT
 52

	)

203 
	#IPV6_RECVHOPOPTS
 53

	)

204 
	#IPV6_HOPOPTS
 54

	)

205 
	#IPV6_RTHDRDSTOPTS
 55

	)

206 
	#IPV6_RECVRTHDR
 56

	)

207 
	#IPV6_RTHDR
 57

	)

208 
	#IPV6_RECVDSTOPTS
 58

	)

209 
	#IPV6_DSTOPTS
 59

	)

210 
	#IPV6_RECVPATHMTU
 60

	)

211 
	#IPV6_PATHMTU
 61

	)

212 
	#IPV6_DONTFRAG
 62

	)

215 
	#IPV6_RECVTCLASS
 66

	)

216 
	#IPV6_TCLASS
 67

	)

218 
	#IPV6_AUTOFLOWLABEL
 70

	)

221 
	#IPV6_ADDR_PREFERENCES
 72

	)

224 
	#IPV6_MINHOPCOUNT
 73

	)

226 
	#IPV6_ORIGDSTADDR
 74

	)

227 
	#IPV6_RECVORIGDSTADDR
 
IPV6_ORIGDSTADDR


	)

228 
	#IPV6_TRANSPARENT
 75

	)

229 
	#IPV6_UNICAST_IF
 76

	)

230 
	#IPV6_RECVFRAGSIZE
 77

	)

233 #ià!
__USE_KERNEL_IPV6_DEFS


234 
	#IPV6_ADD_MEMBERSHIP
 
IPV6_JOIN_GROUP


	)

235 
	#IPV6_DROP_MEMBERSHIP
 
IPV6_LEAVE_GROUP


	)

237 
	#IPV6_RXHOPOPTS
 
IPV6_HOPOPTS


	)

238 
	#IPV6_RXDSTOPTS
 
IPV6_DSTOPTS


	)

241 
	#IPV6_PMTUDISC_DONT
 0

	)

242 
	#IPV6_PMTUDISC_WANT
 1

	)

243 
	#IPV6_PMTUDISC_DO
 2

	)

244 
	#IPV6_PMTUDISC_PROBE
 3

	)

245 
	#IPV6_PMTUDISC_INTERFACE
 4

	)

246 
	#IPV6_PMTUDISC_OMIT
 5

	)

249 
	#SOL_IPV6
 41

	)

250 
	#SOL_ICMPV6
 58

	)

253 
	#IPV6_RTHDR_LOOSE
 0

	)

254 
	#IPV6_RTHDR_STRICT
 1

	)

256 
	#IPV6_RTHDR_TYPE_0
 0

	)

	@/usr/include/bits/ioctl-types.h

19 #iâdeà
_SYS_IOCTL_H


24 
	~<asm/ioùls.h
>

27 
	swšsize


29 
	mws_row
;

30 
	mws_cŞ
;

31 
	mws_xpix–
;

32 
	mws_ypix–
;

35 
	#NCC
 8

	)

36 
	s‹rmio


38 
	mc_iæag
;

39 
	mc_oæag
;

40 
	mc_cæag
;

41 
	mc_læag
;

42 
	mc_lše
;

43 
	mc_cc
[
NCC
];

47 
	#TIOCM_LE
 0x001

	)

48 
	#TIOCM_DTR
 0x002

	)

49 
	#TIOCM_RTS
 0x004

	)

50 
	#TIOCM_ST
 0x008

	)

51 
	#TIOCM_SR
 0x010

	)

52 
	#TIOCM_CTS
 0x020

	)

53 
	#TIOCM_CAR
 0x040

	)

54 
	#TIOCM_RNG
 0x080

	)

55 
	#TIOCM_DSR
 0x100

	)

56 
	#TIOCM_CD
 
TIOCM_CAR


	)

57 
	#TIOCM_RI
 
TIOCM_RNG


	)

62 
	#N_TTY
 0

	)

63 
	#N_SLIP
 1

	)

64 
	#N_MOUSE
 2

	)

65 
	#N_PPP
 3

	)

66 
	#N_STRIP
 4

	)

67 
	#N_AX25
 5

	)

68 
	#N_X25
 6

	)

69 
	#N_6PACK
 7

	)

70 
	#N_MASC
 8

	)

71 
	#N_R3964
 9

	)

72 
	#N_PROFIBUS_FDL
 10

	)

73 
	#N_IRDA
 11

	)

74 
	#N_SMSBLOCK
 12

	)

75 
	#N_HDLC
 13

	)

76 
	#N_SYNC_PPP
 14

	)

77 
	#N_HCI
 15

	)

	@/usr/include/bits/ioctls.h

18 #iâdeà
_SYS_IOCTL_H


23 
	~<asm/ioùls.h
>

26 
	#SIOCADDRT
 0x890B

	)

27 
	#SIOCDELRT
 0x890C

	)

28 
	#SIOCRTMSG
 0x890D

	)

31 
	#SIOCGIFNAME
 0x8910

	)

32 
	#SIOCSIFLINK
 0x8911

	)

33 
	#SIOCGIFCONF
 0x8912

	)

34 
	#SIOCGIFFLAGS
 0x8913

	)

35 
	#SIOCSIFFLAGS
 0x8914

	)

36 
	#SIOCGIFADDR
 0x8915

	)

37 
	#SIOCSIFADDR
 0x8916

	)

38 
	#SIOCGIFDSTADDR
 0x8917

	)

39 
	#SIOCSIFDSTADDR
 0x8918

	)

40 
	#SIOCGIFBRDADDR
 0x8919

	)

41 
	#SIOCSIFBRDADDR
 0x891¨

	)

42 
	#SIOCGIFNETMASK
 0x891b

	)

43 
	#SIOCSIFNETMASK
 0x891ø

	)

44 
	#SIOCGIFMETRIC
 0x891d

	)

45 
	#SIOCSIFMETRIC
 0x891

	)

46 
	#SIOCGIFMEM
 0x891à

	)

47 
	#SIOCSIFMEM
 0x8920

	)

48 
	#SIOCGIFMTU
 0x8921

	)

49 
	#SIOCSIFMTU
 0x8922

	)

50 
	#SIOCSIFNAME
 0x8923

	)

51 
	#SIOCSIFHWADDR
 0x8924

	)

52 
	#SIOCGIFENCAP
 0x8925

	)

53 
	#SIOCSIFENCAP
 0x8926

	)

54 
	#SIOCGIFHWADDR
 0x8927

	)

55 
	#SIOCGIFSLAVE
 0x8929

	)

56 
	#SIOCSIFSLAVE
 0x8930

	)

57 
	#SIOCADDMULTI
 0x8931

	)

58 
	#SIOCDELMULTI
 0x8932

	)

59 
	#SIOCGIFINDEX
 0x8933

	)

60 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

61 
	#SIOCSIFPFLAGS
 0x8934

	)

62 
	#SIOCGIFPFLAGS
 0x8935

	)

63 
	#SIOCDIFADDR
 0x8936

	)

64 
	#SIOCSIFHWBROADCAST
 0x8937

	)

65 
	#SIOCGIFCOUNT
 0x8938

	)

67 
	#SIOCGIFBR
 0x8940

	)

68 
	#SIOCSIFBR
 0x8941

	)

70 
	#SIOCGIFTXQLEN
 0x8942

	)

71 
	#SIOCSIFTXQLEN
 0x8943

	)

76 
	#SIOCDARP
 0x8953

	)

77 
	#SIOCGARP
 0x8954

	)

78 
	#SIOCSARP
 0x8955

	)

81 
	#SIOCDRARP
 0x8960

	)

82 
	#SIOCGRARP
 0x8961

	)

83 
	#SIOCSRARP
 0x8962

	)

87 
	#SIOCGIFMAP
 0x8970

	)

88 
	#SIOCSIFMAP
 0x8971

	)

92 
	#SIOCADDDLCI
 0x8980

	)

93 
	#SIOCDELDLCI
 0x8981

	)

102 
	#SIOCDEVPRIVATE
 0x89F0

	)

108 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/bits/iscanonical.h

19 #iâdeà
_MATH_H


23 
	$__isÿnÚiÿÎ
 (
__x
)

24 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

25 
	#__isÿnÚiÿlf
(
x
è((è(
	`__ty³of
 (x)è(x), 1)

	)

26 
	#__isÿnÚiÿl
(
x
è((è(
	`__ty³of
 (x)è(x), 1)

	)

27 #ià
__HAVE_DISTINCT_FLOAT128


28 
	#__isÿnÚiÿlf128
(
x
è((è(
	`__ty³of
 (x)è(x), 1)

	)

37 #iâdeà
__ılu¥lus


38 
	#isÿnÚiÿl
(
x
è
	`__MATH_TG
 ((x), 
__isÿnÚiÿl
, (x))

	)

47 
šlše
 
	`isÿnÚiÿl
 (
__v®
è{  
	`__isÿnÚiÿlf
 (__val); }

48 
šlše
 
	`isÿnÚiÿl
 (
__v®
è{  
	`__isÿnÚiÿl
 (__val); }

49 
šlše
 
	`isÿnÚiÿl
 (
__v®
è{  
	`__isÿnÚiÿÎ
 (__val); }

50 #ià
__HAVE_DISTINCT_FLOAT128


51 
šlše
 
	`isÿnÚiÿl
 (
_Flßt128
 
__v®
è{  
	`__isÿnÚiÿlf128
 (__val); }

53 
	}
}

	@/usr/include/bits/libc-header-start.h

27 #iâdeà
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


31 #undeà
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


33 
	~<ã©u»s.h
>

37 #undeà
__GLIBC_USE_LIB_EXT2


38 #ià(
defšed
 
__USE_GNU
 \

39 || (
defšed
 
	g__STDC_WANT_LIB_EXT2__
 && __STDC_WANT_LIB_EXT2__ > 0))

40 
	#__GLIBC_USE_LIB_EXT2
 1

	)

42 
	#__GLIBC_USE_LIB_EXT2
 0

	)

47 #undeà
__GLIBC_USE_IEC_60559_BFP_EXT


48 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_BFP_EXT__


49 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 1

	)

51 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 0

	)

56 #undeà
__GLIBC_USE_IEC_60559_FUNCS_EXT


57 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_FUNCS_EXT__


58 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 1

	)

60 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 0

	)

65 #undeà
__GLIBC_USE_IEC_60559_TYPES_EXT


66 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_TYPES_EXT__


67 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 1

	)

69 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 0

	)

	@/usr/include/bits/libio.h

28 #iâdeà
_BITS_LIBIO_H


29 
	#_BITS_LIBIO_H
 1

	)

31 #ià!
defšed
 
_STDIO_H
 && !defšed 
_LIBIO_H


35 
	~<b™s/_G_cÚfig.h
>

37 
	#_IO_åos_t
 
_G_åos_t


	)

38 
	#_IO_åos64_t
 
_G_åos64_t


	)

39 
	#_IO_size_t
 
size_t


	)

40 
	#_IO_ssize_t
 
__ssize_t


	)

41 
	#_IO_off_t
 
__off_t


	)

42 
	#_IO_off64_t
 
__off64_t


	)

43 
	#_IO_pid_t
 
__pid_t


	)

44 
	#_IO_uid_t
 
__uid_t


	)

45 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

46 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

47 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

48 
	#_IO_va_li¡
 
_G_va_li¡


	)

49 
	#_IO_wšt_t
 
wšt_t


	)

52 
	#__Ãed___va_li¡


	)

53 
	~<¡d¬g.h
>

54 #ifdeà
__GNUC_VA_LIST


55 #undeà
_IO_va_li¡


56 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

59 #iâdeà
__P


60 
	~<sys/cdefs.h
>

63 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

65 #iâdeà
EOF


66 
	#EOF
 (-1)

	)

68 #iâdeà
NULL


69 #ià
defšed
 
__GNUG__
 && \

70 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

71 
	#NULL
 (
__nuÎ
)

	)

73 #ià!
defšed
(
__ılu¥lus
)

74 
	#NULL
 ((*)0)

	)

76 
	#NULL
 (0)

	)

81 
	#_IOS_INPUT
 1

	)

82 
	#_IOS_OUTPUT
 2

	)

83 
	#_IOS_ATEND
 4

	)

84 
	#_IOS_APPEND
 8

	)

85 
	#_IOS_TRUNC
 16

	)

86 
	#_IOS_NOCREATE
 32

	)

87 
	#_IOS_NOREPLACE
 64

	)

88 
	#_IOS_BIN
 128

	)

96 
	#_IO_MAGIC
 0xFBAD0000

	)

97 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

98 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

99 
	#_IO_USER_BUF
 1

	)

100 
	#_IO_UNBUFFERED
 2

	)

101 
	#_IO_NO_READS
 4

	)

102 
	#_IO_NO_WRITES
 8

	)

103 
	#_IO_EOF_SEEN
 0x10

	)

104 
	#_IO_ERR_SEEN
 0x20

	)

105 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

106 
	#_IO_LINKED
 0x80

	)

107 
	#_IO_IN_BACKUP
 0x100

	)

108 
	#_IO_LINE_BUF
 0x200

	)

109 
	#_IO_TIED_PUT_GET
 0x400

	)

110 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

111 
	#_IO_IS_APPENDING
 0x1000

	)

112 
	#_IO_IS_FILEBUF
 0x2000

	)

113 
	#_IO_BAD_SEEN
 0x4000

	)

114 
	#_IO_USER_LOCK
 0x8000

	)

116 
	#_IO_FLAGS2_MMAP
 1

	)

117 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_FORTIFY
 4

	)

121 
	#_IO_FLAGS2_USER_WBUF
 8

	)

122 #ifdeà
_LIBC


123 
	#_IO_FLAGS2_SCANF_STD
 16

	)

124 
	#_IO_FLAGS2_NOCLOSE
 32

	)

125 
	#_IO_FLAGS2_CLOEXEC
 64

	)

126 
	#_IO_FLAGS2_NEED_LOCK
 128

	)

130 
	#_IO_SKIPWS
 01

	)

131 
	#_IO_LEFT
 02

	)

132 
	#_IO_RIGHT
 04

	)

133 
	#_IO_INTERNAL
 010

	)

134 
	#_IO_DEC
 020

	)

135 
	#_IO_OCT
 040

	)

136 
	#_IO_HEX
 0100

	)

137 
	#_IO_SHOWBASE
 0200

	)

138 
	#_IO_SHOWPOINT
 0400

	)

139 
	#_IO_UPPERCASE
 01000

	)

140 
	#_IO_SHOWPOS
 02000

	)

141 
	#_IO_SCIENTIFIC
 04000

	)

142 
	#_IO_FIXED
 010000

	)

143 
	#_IO_UNITBUF
 020000

	)

144 
	#_IO_STDIO
 040000

	)

145 
	#_IO_DONT_CLOSE
 0100000

	)

146 
	#_IO_BOOLALPHA
 0200000

	)

149 
_IO_jump_t
; 
	g_IO_FILE
;

153 #iâdeà
_IO_lock_t_defšed


154 
	t_IO_lock_t
;

160 
	s_IO_m¬k”
 {

161 
_IO_m¬k”
 *
	m_Ãxt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

169 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

170 
	mpublic
:

171 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

172 ~
¡»amm¬k”
();

173 
§všg
(è{  
	m_¥os
 == -2; }

174 
d–
(
¡»amm¬k”
&);

175 
d–
();

180 
	e__codecvt_»suÉ


182 
	m__codecvt_ok
,

183 
	m__codecvt_·¹Ÿl
,

184 
	m__codecvt_”rÜ
,

185 
	m__codecvt_nocÚv


188 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

194 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

195 
	m__mb¡©e_t
 *,

196 cÚ¡ 
	mwch¬_t
 *,

197 cÚ¡ 
	mwch¬_t
 *,

198 cÚ¡ 
	mwch¬_t
 **, *,

200 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

201 
	m__mb¡©e_t
 *, *,

203 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

204 
	m__mb¡©e_t
 *,

206 cÚ¡ **, 
	mwch¬_t
 *,

207 
	mwch¬_t
 *, wchar_t **);

208 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

211 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

214 
_IO_icÚv_t
 
	m__cd_š
;

215 
_IO_icÚv_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¬_t
 *
	m_IO_»ad_±r
;

222 
wch¬_t
 *
	m_IO_»ad_’d
;

223 
wch¬_t
 *
	m_IO_»ad_ba£
;

224 
wch¬_t
 *
	m_IO_wr™e_ba£
;

225 
wch¬_t
 *
	m_IO_wr™e_±r
;

226 
wch¬_t
 *
	m_IO_wr™e_’d
;

227 
wch¬_t
 *
	m_IO_buf_ba£
;

228 
wch¬_t
 *
	m_IO_buf_’d
;

230 
wch¬_t
 *
	m_IO_§ve_ba£
;

231 
wch¬_t
 *
	m_IO_backup_ba£
;

233 
wch¬_t
 *
	m_IO_§ve_’d
;

235 
__mb¡©e_t
 
	m_IO_¡©e
;

236 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¬_t
 
	m_shÜtbuf
[1];

241 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

245 
	s_IO_FILE
 {

246 
	m_æags
;

247 
	#_IO_fe_æags
 
_æags


	)

251 * 
	m_IO_»ad_±r
;

252 * 
	m_IO_»ad_’d
;

253 * 
	m_IO_»ad_ba£
;

254 * 
	m_IO_wr™e_ba£
;

255 * 
	m_IO_wr™e_±r
;

256 * 
	m_IO_wr™e_’d
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_’d
;

260 *
	m_IO_§ve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_§ve_’d
;

264 
_IO_m¬k”
 *
	m_m¬k”s
;

266 
_IO_FILE
 *
	m_chaš
;

268 
	m_f’o
;

270 
	m_blksize
;

272 
	m_æags2
;

274 
_IO_off_t
 
	m_Şd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cŞumn
;

279 sigÃd 
	m_vbË_off£t
;

280 
	m_shÜtbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifdeà
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com¶‘e


290 
_IO_FILE
 
	m_fe
;

292 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_ä“»s_li¡
;

299 *
	m_ä“»s_buf
;

301 *
	m__·d1
;

302 *
	m__·d2
;

303 *
	m__·d3
;

304 *
	m__·d4
;

306 
size_t
 
	m__·d5
;

307 
	m_mode
;

309 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

313 #iâdeà
__ılu¥lus


314 
_IO_FILE
 
	t_IO_FILE
;

317 
	g_IO_FILE_¶us
;

319 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

320 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

321 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

322 #iâdeà
_LIBC


323 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

324 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

325 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

327 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

328 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

329 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

337 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

345 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

346 
	tsize_t
 
	t__n
);

354 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

357 
	t__io_şo£_â
 (*
	t__cook›
);

360 #ifdeà
__USE_GNU


362 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

363 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

364 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

365 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

370 
__io_»ad_â
 *
	m»ad
;

371 
__io_wr™e_â
 *
	mwr™e
;

372 
__io_£ek_â
 *
	m£ek
;

373 
__io_şo£_â
 *
	mşo£
;

374 } 
	t_IO_cook›_io_funùiÚs_t
;

375 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

377 
	g_IO_cook›_fe
;

380 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

381 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

385 #ifdeà
__ılu¥lus


389 
__und”æow
 (
_IO_FILE
 *);

390 
__uæow
 (
_IO_FILE
 *);

391 
__ov”æow
 (
_IO_FILE
 *, );

392 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


393 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

394 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

395 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

398 #ià 
__GNUC__
 >= 3

399 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

401 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

404 
	#_IO_g‘c_uÆocked
(
_å
) \

405 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

406 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

407 
	#_IO_³ekc_uÆocked
(
_å
) \

408 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

409 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

410 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

411 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

412 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

413 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

414 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

416 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


417 
	#_IO_g‘wc_uÆocked
(
_å
) \

418 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

419 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

420 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

421 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

422 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

423 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

424 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

425 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

426 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

427 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

430 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

431 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

433 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

434 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

435 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

436 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

438 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

441 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

442 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

444 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

445 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

446 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

448 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

449 
	#_IO_æockfe
(
_å
è

	)

450 
	#_IO_fuÆockfe
(
_å
è

	)

451 
	#_IO_árylockfe
(
_å
è

	)

452 #iâdeà
_IO_ş—nup_»giÚ_¡¬t


453 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

455 #iâdeà
_IO_ş—nup_»giÚ_’d


456 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

459 
	#_IO_Ãed_lock
(
_å
) \

460 (((
_å
)->
_æags2
 & 
_IO_FLAGS2_NEED_LOCK
è!ğ0)

	)

462 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

463 
_IO_va_li¡
, *
__»¡riù
);

464 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

465 
_IO_va_li¡
);

466 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

467 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

469 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

470 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

472 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

474 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


475 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

476 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

477 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

478 #ià
__GNUC__
 >= 2

481 #ià
defšed
 
_LIBC
 && defšed 
SHARED


482 
	~<shlib-com·t.h
>

483 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

484 
	#_IO_fwide_maybe_šcom·tibË
 \

485 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

486 cÚ¡ 
_IO_¡dš_u£d
;

487 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

490 #iâdeà
_IO_fwide_maybe_šcom·tibË


491 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

495 
	#_IO_fwide
(
__å
, 
__mode
) \

496 ({ 
__»suÉ
 = (
__mode
); \

497 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

499 ià((
__å
)->
_mode
 == 0) \

501 (
__å
)->
_mode
 = -1; \

502 
__»suÉ
 = (
__å
)->
_mode
; \

504 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

505 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

507 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

508 
__»suÉ
; })

	)

511 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

512 
_IO_va_li¡
, *
__»¡riù
);

513 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

514 
_IO_va_li¡
);

515 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

516 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

519 #ifdeà
__LDBL_COMPAT


520 
	~<b™s/libio-ldbl.h
>

523 #ifdeà
__ılu¥lus


	@/usr/include/bits/locale.h

19 #ià!
defšed
 
_LOCALE_H
 && !defšed 
_LANGINFO_H


23 #iâdeà
_BITS_LOCALE_H


24 
	#_BITS_LOCALE_H
 1

	)

26 
	#__LC_CTYPE
 0

	)

27 
	#__LC_NUMERIC
 1

	)

28 
	#__LC_TIME
 2

	)

29 
	#__LC_COLLATE
 3

	)

30 
	#__LC_MONETARY
 4

	)

31 
	#__LC_MESSAGES
 5

	)

32 
	#__LC_ALL
 6

	)

33 
	#__LC_PAPER
 7

	)

34 
	#__LC_NAME
 8

	)

35 
	#__LC_ADDRESS
 9

	)

36 
	#__LC_TELEPHONE
 10

	)

37 
	#__LC_MEASUREMENT
 11

	)

38 
	#__LC_IDENTIFICATION
 12

	)

	@/usr/include/bits/math-finite.h

19 #iâdeà
_MATH_H


23 
	#__REDIRFROM
(...è
	`__REDIRFROM_X
(
__VA_ARGS__
)

	)

25 
	#__REDIRTO
(...è
	`__REDIRTO_X
(
__VA_ARGS__
)

	)

27 
	#__MATH_REDIRCALL_X
(
äom
, 
¬gs
, 
to
) \

28 
_MdoubË_
 
	`__REDIRECT_NTH
 (
äom
, 
¬gs
, 
to
)

	)

29 
	#__MATH_REDIRCALL
(
funùiÚ
, 
»’Œªt
, 
¬gs
) \

30 
__MATH_REDIRCALL_X
 \

31 (
	`__REDIRFROM
 (
funùiÚ
, 
»’Œªt
), 
¬gs
, \

32 
	`__REDIRTO
 (
funùiÚ
, 
»’Œªt
))

	)

33 
	#__MATH_REDIRCALL_2
(
äom
, 
»’Œªt
, 
¬gs
, 
to
) \

34 
__MATH_REDIRCALL_X
 \

35 (
	`__REDIRFROM
 (
äom
, 
»’Œªt
), 
¬gs
, \

36 
	`__REDIRTO
 (
to
, 
»’Œªt
))

	)

38 
	#__MATH_REDIRCALL_INTERNAL
(
funùiÚ
, 
»’Œªt
, 
¬gs
) \

39 
__MATH_REDIRCALL_X
 \

40 (
	`__REDIRFROM
 (
	`__CONCAT
 (
__
, 
funùiÚ
), \

41 
	`__CONCAT
 (
»’Œªt
, 
_fš™e
)), \

42 
¬gs
, 
	`__REDIRTO
 (
funùiÚ
, 
_r
))

	)

46 
__MATH_REDIRCALL
 (
acos
, , (
_MdoubË_
));

48 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


50 
__MATH_REDIRCALL
 (
acosh
, , (
_MdoubË_
));

54 
__MATH_REDIRCALL
 (
asš
, , (
_MdoubË_
));

57 
__MATH_REDIRCALL
 (
©ª2
, , (
_MdoubË_
, _Mdouble_));

59 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


61 
__MATH_REDIRCALL
 (
©ªh
, , (
_MdoubË_
));

65 
__MATH_REDIRCALL
 (
cosh
, , (
_MdoubË_
));

68 
__MATH_REDIRCALL
 (
exp
, , (
_MdoubË_
));

70 #ià
__GLIBC_USE
 (
IEC_60559_FUNCS_EXT
)

72 
__MATH_REDIRCALL
 (
exp10
, , (
_MdoubË_
));

75 #ifdeà
__USE_ISOC99


77 
__MATH_REDIRCALL
 (
exp2
, , (
_MdoubË_
));

81 
__MATH_REDIRCALL
 (
fmod
, , (
_MdoubË_
, _Mdouble_));

83 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_ISOC99


85 
__MATH_REDIRCALL
 (
hypÙ
, , (
_MdoubË_
, _Mdouble_));

88 #ià(
__MATH_DECLARING_DOUBLE
 && (
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
)) \

89 || (!
	g__MATH_DECLARING_DOUBLE
 && 
defšed
 
	g__USE_MISC
)

91 
__MATH_REDIRCALL
 (
j0
, , (
_MdoubË_
));

94 
__MATH_REDIRCALL
 (
y0
, , (
_MdoubË_
));

97 
__MATH_REDIRCALL
 (
j1
, , (
_MdoubË_
));

100 
__MATH_REDIRCALL
 (
y1
, , (
_MdoubË_
));

103 
__MATH_REDIRCALL
 (
jn
, , (, 
_MdoubË_
));

106 
__MATH_REDIRCALL
 (
yn
, , (, 
_MdoubË_
));

109 #ifdeà
__USE_MISC


111 
__MATH_REDIRCALL
 (
lgamma
, 
_r
, (
_MdoubË_
, *));

117 
__MATH_REDIRCALL_INTERNAL
 (
lgamma
, 
_r
, (
_MdoubË_
, *));

119 #ià((
defšed
 
__USE_XOPEN
 || defšed 
__USE_ISOC99
) \

120 && 
defšed
 
	g__ex‹º_®ways_šlše
)

122 
__ex‹º_®ways_šlše
 
_MdoubË_


123 
__NTH
 (
	$__REDIRFROM
 (
lgamma
, ) (
_MdoubË_
 
__d
))

125 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


126  
	`__REDIRTO
 (
lgamma
, 
_r
è(
__d
, &
signgam
);

128 
__loÿl_signgam
 = 0;

129  
	`__REDIRTO
 (
lgamma
, 
_r
è(
__d
, &
__loÿl_signgam
);

131 
	}
}

134 #ià((
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)) \

135 && 
defšed
 
	g__ex‹º_®ways_šlše
è&& !
__MATH_DECLARING_FLOATN


137 
__ex‹º_®ways_šlše
 
_MdoubË_


138 
__NTH
 (
	$__REDIRFROM
 (
gamma
, ) (
_MdoubË_
 
__d
))

140  
	`__REDIRTO
 (
lgamma
, 
_r
è(
__d
, &
signgam
);

141 
	}
}

145 
__MATH_REDIRCALL
 (
log
, , (
_MdoubË_
));

148 
__MATH_REDIRCALL
 (
log10
, , (
_MdoubË_
));

150 #ifdeà
__USE_ISOC99


152 
__MATH_REDIRCALL
 (
log2
, , (
_MdoubË_
));

156 
__MATH_REDIRCALL
 (
pow
, , (
_MdoubË_
, _Mdouble_));

158 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


160 
__MATH_REDIRCALL
 (
»mašd”
, , (
_MdoubË_
, _Mdouble_));

163 #ià((
__MATH_DECLARING_DOUBLE
 \

164 && (
defšed
 
	g__USE_MISC
 \

165 || (
defšed
 
	g__USE_XOPEN_EXTENDED
 && !defšed 
	g__USE_XOPEN2K8
))) \

166 || (!
defšed
 
	g__MATH_DECLARE_LDOUBLE
 && defšed 
	g__USE_MISC
)) \

167 && !
__MATH_DECLARING_FLOATN


169 
__MATH_REDIRCALL
 (
sÿlb
, , (
_MdoubË_
, _Mdouble_));

173 
__MATH_REDIRCALL
 (
sšh
, , (
_MdoubË_
));

176 
__MATH_REDIRCALL
 (
sq¹
, , (
_MdoubË_
));

178 #ià
defšed
 
__USE_ISOC99
 && defšed 
__ex‹º_®ways_šlše


180 
_MdoubË_


181 
	$__REDIRFROM
 (
__gamma
, 
_r_fš™e
è(
_MdoubË_
, *);

183 
__ex‹º_®ways_šlše
 
_MdoubË_


184 
	`__NTH
 (
	$__REDIRFROM
 (
tgamma
, ) (
_MdoubË_
 
__d
))

186 
__loÿl_signgam
 = 0;

187 
_MdoubË_
 
__»s
 = 
	`__REDIRTO
 (
gamma
, 
_r
è(
__d
, &
__loÿl_signgam
);

188  
__loÿl_signgam
 < 0 ? -
__»s
 : __res;

189 
	}
}

192 #undeà
__REDIRFROM


193 #undeà
__REDIRTO


194 #undeà
__MATH_REDIRCALL


195 #undeà
__MATH_REDIRCALL_2


196 #undeà
__MATH_REDIRCALL_INTERNAL


197 #undeà
__MATH_REDIRCALL_X


	@/usr/include/bits/math-vector.h

19 #iâdeà
_MATH_H


25 
	~<b™s/libm-simd-deş-¡ubs.h
>

27 #ià
defšed
 
__x86_64__
 && defšed 
__FAST_MATH__


28 #ià
defšed
 
_OPENMP
 && _OPENMP >= 201307

30 
	#__DECL_SIMD_x86_64
 
	`_P¿gma
 ("om°deş¬simd‚Ùšb¿nch")

	)

31 #–ià
__GNUC_PREREQ
 (6,0)

33 
	#__DECL_SIMD_x86_64
 
	`__©Œibu‹__
 ((
	`__simd__
 ("nÙšb¿nch")))

	)

36 #ifdeà
__DECL_SIMD_x86_64


37 #undeà
__DECL_SIMD_cos


38 
	#__DECL_SIMD_cos
 
__DECL_SIMD_x86_64


	)

39 #undeà
__DECL_SIMD_cosf


40 
	#__DECL_SIMD_cosf
 
__DECL_SIMD_x86_64


	)

41 #undeà
__DECL_SIMD_sš


42 
	#__DECL_SIMD_sš
 
__DECL_SIMD_x86_64


	)

43 #undeà
__DECL_SIMD_sšf


44 
	#__DECL_SIMD_sšf
 
__DECL_SIMD_x86_64


	)

45 #undeà
__DECL_SIMD_sšcos


46 
	#__DECL_SIMD_sšcos
 
__DECL_SIMD_x86_64


	)

47 #undeà
__DECL_SIMD_sšcosf


48 
	#__DECL_SIMD_sšcosf
 
__DECL_SIMD_x86_64


	)

49 #undeà
__DECL_SIMD_log


50 
	#__DECL_SIMD_log
 
__DECL_SIMD_x86_64


	)

51 #undeà
__DECL_SIMD_logf


52 
	#__DECL_SIMD_logf
 
__DECL_SIMD_x86_64


	)

53 #undeà
__DECL_SIMD_exp


54 
	#__DECL_SIMD_exp
 
__DECL_SIMD_x86_64


	)

55 #undeà
__DECL_SIMD_expf


56 
	#__DECL_SIMD_expf
 
__DECL_SIMD_x86_64


	)

57 #undeà
__DECL_SIMD_pow


58 
	#__DECL_SIMD_pow
 
__DECL_SIMD_x86_64


	)

59 #undeà
__DECL_SIMD_powf


60 
	#__DECL_SIMD_powf
 
__DECL_SIMD_x86_64


	)

	@/usr/include/bits/mathcalls-helper-functions.h

21 
__MATHDECL_1
 (, 
__åşassify
,, (
_MdoubË_
 
__v®ue
))

22 
__©Œibu‹__
 ((
__cÚ¡__
));

25 
__MATHDECL_1
 (, 
__signb™
,, (
_MdoubË_
 
__v®ue
))

26 
__©Œibu‹__
 ((
__cÚ¡__
));

30 
__MATHDECL_1
 (, 
__isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

33 
__MATHDECL_1
 (, 
__fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

36 
__MATHDECL_1
 (, 
__i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

39 
__MATHDECL_1
 (, 
__i£qsig
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

42 
__MATHDECL_1
 (, 
__issigÇlšg
,, (
_MdoubË_
 
__v®ue
))

43 
__©Œibu‹__
 ((
__cÚ¡__
));

	@/usr/include/bits/mathcalls.h

45 #iâdeà
_MATH_H


53 
__MATHCALL
 (
acos
,, (
_MdoubË_
 
__x
));

55 
__MATHCALL
 (
asš
,, (
_MdoubË_
 
__x
));

57 
__MATHCALL
 (
©ª
,, (
_MdoubË_
 
__x
));

59 
__MATHCALL
 (
©ª2
,, (
_MdoubË_
 
__y
, _MdoubË_ 
__x
));

62 
__MATHCALL_VEC
 (
cos
,, (
_MdoubË_
 
__x
));

64 
__MATHCALL_VEC
 (
sš
,, (
_MdoubË_
 
__x
));

66 
__MATHCALL
 (
n
,, (
_MdoubË_
 
__x
));

71 
__MATHCALL
 (
cosh
,, (
_MdoubË_
 
__x
));

73 
__MATHCALL
 (
sšh
,, (
_MdoubË_
 
__x
));

75 
__MATHCALL
 (
nh
,, (
_MdoubË_
 
__x
));

77 #ifdeà
__USE_GNU


79 
__MATHDECL_VEC
 (,
sšcos
,,

80 (
_MdoubË_
 
__x
, _MdoubË_ *
__sšx
, _MdoubË_ *
__cosx
));

83 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


85 
__MATHCALL
 (
acosh
,, (
_MdoubË_
 
__x
));

87 
__MATHCALL
 (
asšh
,, (
_MdoubË_
 
__x
));

89 
__MATHCALL
 (
©ªh
,, (
_MdoubË_
 
__x
));

95 
__MATHCALL_VEC
 (
exp
,, (
_MdoubË_
 
__x
));

98 
__MATHCALL
 (
äexp
,, (
_MdoubË_
 
__x
, *
__expÚ’t
));

101 
__MATHCALL
 (
ldexp
,, (
_MdoubË_
 
__x
, 
__expÚ’t
));

104 
__MATHCALL_VEC
 (
log
,, (
_MdoubË_
 
__x
));

107 
__MATHCALL
 (
log10
,, (
_MdoubË_
 
__x
));

110 
__MATHCALL
 (
modf
,, (
_MdoubË_
 
__x
, _MdoubË_ *
__Œ
)è
__nÚnuÎ
 ((2));

112 #ià
__GLIBC_USE
 (
IEC_60559_FUNCS_EXT
)

114 
__MATHCALL
 (
exp10
,, (
_MdoubË_
 
__x
));

117 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


119 
__MATHCALL
 (
expm1
,, (
_MdoubË_
 
__x
));

122 
__MATHCALL
 (
log1p
,, (
_MdoubË_
 
__x
));

125 
__MATHCALL
 (
logb
,, (
_MdoubË_
 
__x
));

128 #ifdeà
__USE_ISOC99


130 
__MATHCALL
 (
exp2
,, (
_MdoubË_
 
__x
));

133 
__MATHCALL
 (
log2
,, (
_MdoubË_
 
__x
));

140 
__MATHCALL_VEC
 (
pow
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

143 
__MATHCALL
 (
sq¹
,, (
_MdoubË_
 
__x
));

145 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_ISOC99


147 
__MATHCALL
 (
hypÙ
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

150 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


152 
__MATHCALL
 (
cb¹
,, (
_MdoubË_
 
__x
));

159 
__MATHCALLX
 (
û
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

162 
__MATHCALLX
 (
çbs
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

165 
__MATHCALLX
 (
æoÜ
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

168 
__MATHCALL
 (
fmod
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

170 #ifdeà
__USE_MISC


171 #ià((!
defšed
 
__ılu¥lus
 \

172 || 
	g__ılu¥lus
 < 201103L \

173 || 
	g__MATH_DECLARING_DOUBLE
 == 0)) \

174 && !
__MATH_DECLARING_FLOATN


177 
__MATHDECL_1
 (,
isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

180 #ià!
__MATH_DECLARING_FLOATN


182 
__MATHDECL_1
 (,
fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

185 
__MATHCALL
 (
d»m
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

189 
__MATHCALL
 (
signifiÿnd
,, (
_MdoubË_
 
__x
));

194 #ifdeà
__USE_ISOC99


196 
__MATHCALLX
 (
cİysign
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

199 #ifdeà
__USE_ISOC99


201 
__MATHCALLX
 (
Çn
,, (cÚ¡ *
__gb
), (
__cÚ¡__
));

205 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

206 #ià((!
defšed
 
__ılu¥lus
 \

207 || 
	g__ılu¥lus
 < 201103L \

208 || 
	g__MATH_DECLARING_DOUBLE
 == 0)) \

209 && !
__MATH_DECLARING_FLOATN


211 
__MATHDECL_1
 (,
i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

215 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && 
__MATH_DECLARING_DOUBLE
)

217 
__MATHCALL
 (
j0
,, (
_MdoubË_
));

218 
__MATHCALL
 (
j1
,, (
_MdoubË_
));

219 
__MATHCALL
 (
jn
,, (, 
_MdoubË_
));

220 
__MATHCALL
 (
y0
,, (
_MdoubË_
));

221 
__MATHCALL
 (
y1
,, (
_MdoubË_
));

222 
__MATHCALL
 (
yn
,, (, 
_MdoubË_
));

226 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_ISOC99


228 
__MATHCALL
 (
”f
,, (
_MdoubË_
));

229 
__MATHCALL
 (
”fc
,, (
_MdoubË_
));

230 
__MATHCALL
 (
lgamma
,, (
_MdoubË_
));

233 #ifdeà
__USE_ISOC99


235 
__MATHCALL
 (
tgamma
,, (
_MdoubË_
));

238 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

239 #ià!
__MATH_DECLARING_FLOATN


241 
__MATHCALL
 (
gamma
,, (
_MdoubË_
));

245 #ifdeà
__USE_MISC


249 
__MATHCALL
 (
lgamma
,
_r
, (
_MdoubË_
, *
__signgamp
));

253 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


256 
__MATHCALL
 (
ršt
,, (
_MdoubË_
 
__x
));

259 
__MATHCALL
 (
Ãxá”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

260 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__LDBL_COMPAT
 && !
__MATH_DECLARING_FLOATN


261 
__MATHCALL
 (
Ãx‰ow¬d
,, (
_MdoubË_
 
__x
, 
__y
));

264 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
è|| 
__MATH_DECLARING_FLOATN


266 
__MATHCALL
 (
Ãxtdown
,, (
_MdoubË_
 
__x
));

268 
__MATHCALL
 (
Ãxtup
,, (
_MdoubË_
 
__x
));

272 
__MATHCALL
 (
»mašd”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

274 #ifdeà
__USE_ISOC99


276 
__MATHCALL
 (
sÿlbn
,, (
_MdoubË_
 
__x
, 
__n
));

280 
__MATHDECL
 (,
ogb
,, (
_MdoubË_
 
__x
));

283 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
è|| 
__MATH_DECLARING_FLOATN


285 
__MATHDECL
 (, 
Îogb
,, (
_MdoubË_
 
__x
));

288 #ifdeà
__USE_ISOC99


290 
__MATHCALL
 (
sÿlbÊ
,, (
_MdoubË_
 
__x
, 
__n
));

294 
__MATHCALL
 (
Ã¬byšt
,, (
_MdoubË_
 
__x
));

298 
__MATHCALLX
 (
round
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

302 
__MATHCALLX
 (
Œunc
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

307 
__MATHCALL
 (
»mquo
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, *
__quo
));

314 
__MATHDECL
 (,
Ìšt
,, (
_MdoubË_
 
__x
));

315 
__ex‹nsiÚ__


316 
__MATHDECL
 (,
Îršt
,, (
_MdoubË_
 
__x
));

320 
__MATHDECL
 (,
Ìound
,, (
_MdoubË_
 
__x
));

321 
__ex‹nsiÚ__


322 
__MATHDECL
 (,
Îround
,, (
_MdoubË_
 
__x
));

326 
__MATHCALL
 (
fdim
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

329 
__MATHCALLX
 (
fmax
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

332 
__MATHCALLX
 (
fmš
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

335 
__MATHCALL
 (
fma
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, _MdoubË_ 
__z
));

338 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
è|| 
__MATH_DECLARING_FLOATN


340 
__MATHCALLX
 (
roundev’
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

344 
__MATHDECL
 (
__štmax_t
, 
äomå
,, (
_MdoubË_
 
__x
, 
__round
,

345 
__width
));

349 
__MATHDECL
 (
__uštmax_t
, 
uäomå
,, (
_MdoubË_
 
__x
, 
__round
,

350 
__width
));

355 
__MATHDECL
 (
__štmax_t
, 
äomåx
,, (
_MdoubË_
 
__x
, 
__round
,

356 
__width
));

361 
__MATHDECL
 (
__uštmax_t
, 
uäomåx
,, (
_MdoubË_
 
__x
, 
__round
,

362 
__width
));

365 
__MATHCALLX
 (
fmaxmag
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

368 
__MATHCALLX
 (
fmšmag
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

371 
__MATHDECL_1
 (, 
tÙ®Üd”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
))

372 
__©Œibu‹__
 ((
__cÚ¡__
));

375 
__MATHDECL_1
 (, 
tÙ®Üd”mag
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
))

376 
__©Œibu‹__
 ((
__cÚ¡__
));

379 
__MATHDECL_1
 (, 
ÿnÚiÿlize
,, (
_MdoubË_
 *
__cx
, cÚ¡ _MdoubË_ *
__x
));

382 
__MATHCALL
 (
g‘·ylßd
,, (cÚ¡ 
_MdoubË_
 *
__x
));

385 
__MATHDECL_1
 (, 
£aylßd
,, (
_MdoubË_
 *
__x
, _MdoubË_ 
__·ylßd
));

388 
__MATHDECL_1
 (, 
£aylßdsig
,, (
_MdoubË_
 *
__x
, _MdoubË_ 
__·ylßd
));

391 #ià(
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

392 && 
	g__MATH_DECLARING_DOUBLE
 \

393 && !
defšed
 
	g__USE_XOPEN2K8
)) \

394 && !
__MATH_DECLARING_FLOATN


396 
__MATHCALL
 (
sÿlb
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__n
));

	@/usr/include/bits/mathinline.h

19 #iâdeà
_MATH_H


23 #iâdeà
__ex‹º_®ways_šlše


24 
	#__MATH_INLINE
 
__šlše


	)

26 
	#__MATH_INLINE
 
__ex‹º_®ways_šlše


	)

31 #ià
__GNUC_PREREQ
 (2, 8)

32 #ià!
__GNUC_PREREQ
 (3, 4è&& !
defšed
 
__NO_MATH_INLINES
 \

33 && 
defšed
 
	g__OPTIMIZE__


37 #ifdeà
__USE_ISOC99


40 #ifdeà
__SSE_MATH__


41 
__MATH_INLINE
 

42 
__NTH
 (
	$Ìštf
 (
__x
))

44 
__»s
;

49 
__asm
 
	`__vŞ©e__
 ("cvtss2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

50  
__»s
;

51 
	}
}

53 #ifdeà
__SSE2_MATH__


54 
__MATH_INLINE
 

55 
__NTH
 (
	$Ìšt
 (
__x
))

57 
__»s
;

62 
__asm
 
	`__vŞ©e__
 ("cvtsd2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

63  
__»s
;

64 
	}
}

66 #ifdeà
__x86_64__


67 
__ex‹nsiÚ__


68 
__MATH_INLINE
 

69 
__NTH
 (
	$Îrštf
 (
__x
))

71 
__»s
;

76 
__asm
 
	`__vŞ©e__
 ("cvtss2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

77  
__»s
;

78 
	}
}

79 
__ex‹nsiÚ__


80 
__MATH_INLINE
 

81 
__NTH
 (
	$Îršt
 (
__x
))

83 
__»s
;

88 
__asm
 
	`__vŞ©e__
 ("cvtsd2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

89  
__»s
;

90 
	}
}

93 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0 \

94 && 
defšed
 
__SSE2_MATH__


96 
__MATH_INLINE
 

97 
__NTH
 (
	$fmaxf
 (
__x
, 
__y
))

99 #ifdeà
__AVX__


100 
__»s
;

101 
	`__asm
 ("vmaxs %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

102  
__»s
;

104 
	`__asm
 ("maxs %1, %0" : "+x" (
__x
è: "xm" (
__y
));

105  
__x
;

107 
	}
}

108 
__MATH_INLINE
 

109 
__NTH
 (
	$fmax
 (
__x
, 
__y
))

111 #ifdeà
__AVX__


112 
__»s
;

113 
	`__asm
 ("vmaxsd %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

114  
__»s
;

116 
	`__asm
 ("maxsd %1, %0" : "+x" (
__x
è: "xm" (
__y
));

117  
__x
;

119 
	}
}

122 
__MATH_INLINE
 

123 
__NTH
 (
	$fmšf
 (
__x
, 
__y
))

125 #ifdeà
__AVX__


126 
__»s
;

127 
	`__asm
 ("vmšs %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

128  
__»s
;

130 
	`__asm
 ("mšs %1, %0" : "+x" (
__x
è: "xm" (
__y
));

131  
__x
;

133 
	}
}

134 
__MATH_INLINE
 

135 
__NTH
 (
	$fmš
 (
__x
, 
__y
))

137 #ifdeà
__AVX__


138 
__»s
;

139 
	`__asm
 ("vmšsd %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

140  
__»s
;

142 
	`__asm
 ("mšsd %1, %0" : "+x" (
__x
è: "xm" (
__y
));

143  
__x
;

145 
	}
}

150 #ià
defšed
 
__SSE4_1__
 && defšed 
__SSE2_MATH__


151 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


154 
__MATH_INLINE
 

155 
__NTH
 (
	$ršt
 (
__x
))

157 
__»s
;

162 
__asm
 
	`__vŞ©e__
 ("roundsd $4, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

163  
__»s
;

164 
	}
}

165 
__MATH_INLINE
 

166 
__NTH
 (
	$rštf
 (
__x
))

168 
__»s
;

173 
__asm
 
	`__vŞ©e__
 ("rounds $4, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

174  
__»s
;

175 
	}
}

177 #ifdeà
__USE_ISOC99


179 
__MATH_INLINE
 

180 
__NTH
 (
	$Ã¬byšt
 (
__x
))

182 
__»s
;

187 
__asm
 
	`__vŞ©e__
 ("roundsd $0xc, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

188  
__»s
;

189 
	}
}

190 
__MATH_INLINE
 

191 
__NTH
 (
	$Ã¬byštf
 (
__x
))

193 
__»s
;

198 
__asm
 
	`__vŞ©e__
 ("rounds $0xc, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

199  
__»s
;

200 
	}
}

206 
__MATH_INLINE
 

207 
__NTH
 (
	$û
 (
__x
))

209 
__»s
;

210 
	`__asm
 ("roundsd $2, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

211  
__»s
;

212 
	}
}

214 
__MATH_INLINE
 

215 
__NTH
 (
	$ûf
 (
__x
))

217 
__»s
;

218 
	`__asm
 ("rounds $2, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

219  
__»s
;

220 
	}
}

223 
__MATH_INLINE
 

224 
__NTH
 (
	$æoÜ
 (
__x
))

226 
__»s
;

227 
	`__asm
 ("roundsd $1, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

228  
__»s
;

229 
	}
}

231 
__MATH_INLINE
 

232 
__NTH
 (
	$æoÜf
 (
__x
))

234 
__»s
;

235 
	`__asm
 ("rounds $1, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

236  
__»s
;

237 
	}
}

245 #ià!
defšed
 
__SSE2_MATH__
 && !defšed 
__x86_64__


246 #ià((!
defšed
 
__NO_MATH_INLINES
 || defšed 
__LIBC_INTERNAL_MATH_INLINES
) \

247 && 
defšed
 
	g__OPTIMIZE__
)

251 #undeà
m©h_”rhªdlšg


260 #ifdeà
__USE_ISOC99


261 
	#__šlše_m©hİ
(
func
, 
İ
) \

262 
	`__šlše_m©hİ_
 (, 
func
, 
İ
) \

263 
	`__šlše_m©hİ_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
) \

264 
	`__šlše_m©hİ_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
)

	)

265 
	#__šlše_m©hİNP
(
func
, 
İ
) \

266 
	`__šlše_m©hİNP_
 (, 
func
, 
İ
) \

267 
	`__šlše_m©hİNP_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
) \

268 
	`__šlše_m©hİNP_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
)

	)

270 
	#__šlše_m©hİ
(
func
, 
İ
) \

271 
	`__šlše_m©hİ_
 (, 
func
, 
İ
)

	)

272 
	#__šlše_m©hİNP
(
func
, 
İ
) \

273 
	`__šlše_m©hİNP_
 (, 
func
, 
İ
)

	)

276 
	#__šlše_m©hİ_
(
æßt_ty³
, 
func
, 
İ
) \

277 
	`__šlše_m©hİ_deş_
 (
æßt_ty³
, 
func
, 
İ
, "0" (
__x
))

	)

278 
	#__šlše_m©hİNP_
(
æßt_ty³
, 
func
, 
İ
) \

279 
	`__šlše_m©hİ_deşNP_
 (
æßt_ty³
, 
func
, 
İ
, "0" (
__x
))

	)

282 #ifdeà
__USE_ISOC99


283 
	#__šlše_m©hİ_deş
(
func
, 
İ
, 
·¿ms
...) \

284 
	`__šlše_m©hİ_deş_
 (, 
func
, 
İ
, 
·¿ms
) \

285 
	`__šlše_m©hİ_deş_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
, 
·¿ms
) \

286 
	`__šlše_m©hİ_deş_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
, 
·¿ms
)

	)

287 
	#__šlše_m©hİ_deşNP
(
func
, 
İ
, 
·¿ms
...) \

288 
	`__šlše_m©hİ_deşNP_
 (, 
func
, 
İ
, 
·¿ms
) \

289 
	`__šlše_m©hİ_deşNP_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
, 
·¿ms
) \

290 
	`__šlše_m©hİ_deşNP_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
, 
·¿ms
)

	)

292 
	#__šlše_m©hİ_deş
(
func
, 
İ
, 
·¿ms
...) \

293 
	`__šlše_m©hİ_deş_
 (, 
func
, 
İ
, 
·¿ms
)

	)

294 
	#__šlše_m©hİ_deşNP
(
func
, 
İ
, 
·¿ms
...) \

295 
	`__šlše_m©hİ_deşNP_
 (, 
func
, 
İ
, 
·¿ms
)

	)

298 
	#__šlše_m©hİ_deş_
(
æßt_ty³
, 
func
, 
İ
, 
·¿ms
...) \

299 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³è
__THROW
; \

300 
	`__šlše_m©hİ_deşNP_
 (
æßt_ty³
, 
func
, 
İ
, 
·¿ms
)

	)

302 
	#__šlše_m©hİ_deşNP_
(
æßt_ty³
, 
func
, 
İ
, 
·¿ms
...) \

303 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
__x
)) \

305 
æßt_ty³
 
__»suÉ
; \

306 
__asm
 
	`__vŞ©e__
 (
İ
 : "ñ" (
__»suÉ
è: 
·¿ms
); \

307  
__»suÉ
; \

308 }

	)

311 #ifdeà
__USE_ISOC99


312 
	#__šlše_m©hcode
(
func
, 
¬g
, 
code
) \

313 
	`__šlše_m©hcode_
 (, 
func
, 
¬g
, 
code
) \

314 
	`__šlše_m©hcode_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g
, 
code
) \

315 
	`__šlše_m©hcode_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g
, 
code
)

	)

316 
	#__šlše_m©hcodeNP
(
func
, 
¬g
, 
code
) \

317 
	`__šlše_m©hcodeNP_
 (, 
func
, 
¬g
, 
code
) \

318 
	`__šlše_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g
, 
code
) \

319 
	`__šlše_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g
, 
code
)

	)

320 
	#__šlše_m©hcode2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

321 
	`__šlše_m©hcode2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
) \

322 
	`__šlše_m©hcode2_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
code
) \

323 
	`__šlše_m©hcode2_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
code
)

	)

324 
	#__šlše_m©hcodeNP2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

325 
	`__šlše_m©hcodeNP2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
) \

326 
	`__šlše_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
code
) \

327 
	`__šlše_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
code
)

	)

328 
	#__šlše_m©hcode3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

329 
	`__šlše_m©hcode3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

330 
	`__šlše_m©hcode3_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

331 
	`__šlše_m©hcode3_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

332 
	#__šlše_m©hcodeNP3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

333 
	`__šlše_m©hcodeNP3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

334 
	`__šlše_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

335 
	`__šlše_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

337 
	#__šlše_m©hcode
(
func
, 
¬g
, 
code
) \

338 
	`__šlše_m©hcode_
 (, 
func
, (
¬g
), 
code
)

	)

339 
	#__šlše_m©hcodeNP
(
func
, 
¬g
, 
code
) \

340 
	`__šlše_m©hcodeNP_
 (, 
func
, (
¬g
), 
code
)

	)

341 
	#__šlše_m©hcode2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

342 
	`__šlše_m©hcode2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
)

	)

343 
	#__šlše_m©hcodeNP2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

344 
	`__šlše_m©hcodeNP2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
)

	)

345 
	#__šlše_m©hcode3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

346 
	`__šlše_m©hcode3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

347 
	#__šlše_m©hcodeNP3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

348 
	`__šlše_m©hcodeNP3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

351 
	#__šlše_m©hcode_
(
æßt_ty³
, 
func
, 
¬g
, 
code
) \

352 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³è
__THROW
; \

353 
	`__šlše_m©hcodeNP_
(
æßt_ty³
, 
func
, 
¬g
, 
code
)

	)

355 
	#__šlše_m©hcodeNP_
(
æßt_ty³
, 
func
, 
¬g
, 
code
) \

356 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
¬g
)) \

358 
code
; \

359 }

	)

362 
	#__šlše_m©hcode2_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
code
) \

363 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³, flßt_ty³è
__THROW
; \

364 
	`__šlše_m©hcodeNP2_
 (
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
code
)

	)

366 
	#__šlše_m©hcodeNP2_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
code
) \

367 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
¬g1
, flßt_ty³ 
¬g2
)) \

369 
code
; \

370 }

	)

372 
	#__šlše_m©hcode3_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

373 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³, flßt_ty³, flßt_ty³è
__THROW
; \

374 
	`__šlše_m©hcodeNP3_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

376 
	#__šlše_m©hcodeNP3_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

377 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
¬g1
, flßt_ty³ 
¬g2
, \

378 
æßt_ty³
 
¬g3
)) \

380 
code
; \

381 }

	)

385 #ià!
defšed
 
__NO_MATH_INLINES
 && defšed 
__OPTIMIZE__


389 #ifdeà
__FAST_MATH__


390 #ifdeà
__USE_GNU


391 
	#__sšcos_code
 \

392 
__co¤
; \

393 
__sšr
; \

394 
__swtmp
; \

395 
__asm
 
__vŞ©e__
 \

410 : "ñ" (
__co¤
), "=u" (
__sšr
), "÷" (
__swtmp
è: "0" (
__x
)); \

411 *
__sšx
 = 
__sšr
; \

412 *
__cosx
 = 
__co¤


	)

414 
__MATH_INLINE
 

415 
__NTH
 (
	$__sšcos
 (
__x
, *
__sšx
, *
__cosx
))

417 
__sšcos_code
;

418 
	}
}

420 
__MATH_INLINE
 

421 
__NTH
 (
	$__sšcosf
 (
__x
, *
__sšx
, *
__cosx
))

423 
__sšcos_code
;

424 
	}
}

426 
__MATH_INLINE
 

427 
__NTH
 (
	$__sšco¦
 (
__x
, *
__sšx
, *
__cosx
))

429 
__sšcos_code
;

430 
	}
}

437 #ià
__GNUC_PREREQ
 (3, 5)

438 
	#__expm1_code
 \

439 
__‹mp
; \

440 
__‹mp
 = 
	`__butš_expm1l
 (
__x
); \

441  
__‹mp
 ? __‹m°: 
__x


	)

443 
	#__expm1_code
 \

444 
__v®ue
; \

445 
__expÚ’t
; \

446 
__‹mp
; \

447 
__asm
 
__vŞ©e__
 \

456 : "ñ" (
__v®ue
), "=u" (
__expÚ’t
è: "0" (
__x
)); \

457 
__asm
 
__vŞ©e__
 \

459 : "ñ" (
__‹mp
è: "0" (1.0), "u" (
__expÚ’t
)); \

460 
__‹mp
 -= 1.0; \

461 
__‹mp
 +ğ
__v®ue
; \

462  
__‹mp
 ? __‹m°: 
__x


	)

464 
	$__šlše_m©hcodeNP_
 (, 
__expm1l
, 
__x
, 
__expm1_code
)

466 #ià
	`__GNUC_PREREQ
 (3, 4)

467 
	`__šlše_m©hcodeNP_
 (, 
__ex¶
, 
__x
,  
	$__butš_ex¶
 (
__x
))

469 
	#__exp_code
 \

470 
__v®ue
; \

471 
__expÚ’t
; \

472 
__asm
 
__vŞ©e__
 \

480 : "ñ" (
__v®ue
), "=u" (
__expÚ’t
è: "0" (
__x
)); \

481 
__v®ue
 += 1.0; \

482 
__asm
 
__vŞ©e__
 \

484 : "ñ" (
__v®ue
è: "0" (__v®ue), "u" (
__expÚ’t
)); \

485  
__v®ue


	)

486 
	$__šlše_m©hcodeNP
 (
exp
, 
__x
, 
__exp_code
)

487 
	$__šlše_m©hcodeNP_
 (, 
__ex¶
, 
__x
, 
__exp_code
)

491 #ià!
	`__GNUC_PREREQ
 (3, 5)

492 
	`__šlše_m©hcodeNP
 (
n
, 
__x
, \

493 
__v®ue
; \

494 
__v®ue2
 
	`__©Œibu‹__
 ((
__unu£d__
)); \

495 
__asm
 
__vŞ©e__
 \

497 : "ñ" (
__v®ue2
), "=u" (
__v®ue
è: "0" (
__x
)); \

498  
__v®ue
)

503 #ià
	`__GNUC_PREREQ
 (3, 4)

504 
	`__šlše_m©hcodeNP2_
 (, 
__©ª2l
, 
__y
, 
__x
,

505  
	$__butš_©ª2l
 (
__y
, 
__x
))

507 
	#__©ª2_code
 \

508 
__v®ue
; \

509 
__asm
 
__vŞ©e__
 \

511 : "ñ" (
__v®ue
è: "0" (
__x
), "u" (
__y
) : "st(1)"); \

512  
__v®ue


	)

513 #ifdeà
__FAST_MATH__


514 
	$__šlše_m©hcodeNP2
 (
©ª2
, 
__y
, 
__x
, 
__©ª2_code
)

516 
	$__šlše_m©hcodeNP2_
 (, 
__©ª2l
, 
__y
, 
__x
, 
__©ª2_code
)

520 #ià
defšed
 
__FAST_MATH__
 && !
	`__GNUC_PREREQ
 (3, 5)

521 
	`__šlše_m©hcodeNP2
 (
fmod
, 
__x
, 
__y
, \

522 
__v®ue
; \

523 
__asm
 
__vŞ©e__
 \

528 : "ñ" (
__v®ue
è: "0" (
__x
), "u" (
__y
) : "ax", "cc"); \

529  
__v®ue
)

533 #ifdeà
__FAST_MATH__


534 #ià!
	`__GNUC_PREREQ
 (3,3)

535 
	`__šlše_m©hİNP
 (
sq¹
, "fsqrt")

536 
	`__šlše_m©hİNP_
 (, 
__sq¹l
, "fsqrt")

537 
	#__libc_sq¹l
(
n
è
	`__sq¹l
 (n)

	)

539 
	#__libc_sq¹l
(
n
è
	`__butš_sq¹l
 (n)

	)

543 #ià
	`__GNUC_PREREQ
 (2, 8)

544 
	`__šlše_m©hcodeNP_
 (, 
çbs
, 
__x
,  
	$__butš_çbs
 (
__x
))

545 #ifdeà
__USE_ISOC99


546 
	`__šlše_m©hcodeNP_
 (, 
çbsf
, 
__x
,  
	$__butš_çbsf
 (
__x
))

547 
	`__šlše_m©hcodeNP_
 (, 
çb¦
, 
__x
,  
	$__butš_çb¦
 (
__x
))

549 
	`__šlše_m©hcodeNP_
 (, 
__çb¦
, 
__x
,  
	$__butš_çb¦
 (
__x
))

551 
	`__šlše_m©hİ
 (
çbs
, "fabs")

552 
	`__šlše_m©hİ_
 (, 
__çb¦
, "fabs")

555 #ifdeà
__FAST_MATH__


556 #ià!
	`__GNUC_PREREQ
 (3, 4)

558 
	`__šlše_m©hİNP
 (
sš
, "fsin")

560 
	`__šlše_m©hİNP
 (
cos
, "fcos")

562 
	`__šlše_m©hİ_deşNP
 (
log
, "ædÊ2; fxch; fyl2x", "0" (
__x
) : "st(1)")

565 #ià!
	`__GNUC_PREREQ
 (3, 5)

566 
	`__šlše_m©hİ_deşNP
 (
log10
, "ædlg2; fxch; fyl2x", "0" (
__x
) : "st(1)")

568 
	`__šlše_m©hcodeNP
 (
asš
, 
__x
,  
	`__©ª2l
 (__x, 
	`__libc_sq¹l
 (1.0 - __x * __x)))

569 
	`__šlše_m©hcodeNP
 (
acos
, 
__x
,  
	`__©ª2l
 (
	`__libc_sq¹l
 (1.0 - __x * __x), __x))

572 #ià!
	`__GNUC_PREREQ
 (3, 4)

573 
	`__šlše_m©hİ_deşNP
 (
©ª
, "æd1; f·n", "0" (
__x
) : "st(1)")

577 
	`__šlše_m©hcode_
 (, 
__sgn1l
, 
__x
, \

578 
__ex‹nsiÚ__
 uniÚ { 
__xld
; 
__xi
[3]; } 
__n
 = \

579 { 
__xld
: 
__x
 
	}
}; \

580 
	g__n
.
	g__xi
[2] = (
__n
.
__xi
[2] & 0x8000) | 0x3fff; \

581 
	g__n
.
	g__xi
[1] = 0x80000000; \

582 
	g__n
.
	g__xi
[0] = 0; \

583  
	g__n
.
	g__xld
)

586 #ifdeà
__FAST_MATH__


588 
__šlše_m©hcodeNP
 (
sšh
, 
__x
, \

589 
__exm1
 = 
__expm1l
 (
__çb¦
 (
__x
)); \

590  0.5 * (
__exm1
 / (__exm1 + 1.0è+ __exm1è* 
	$__sgn1l
 (
__x
))

592 
	`__šlše_m©hcodeNP
 (
cosh
, 
__x
, \

593 
__ex
 = 
	`__ex¶
 (
__x
); \

594  0.5 * (
__ex
 + 1.0 / __ex))

596 
	`__šlše_m©hcodeNP
 (
nh
, 
__x
, \

597 
__exm1
 = 
	`__expm1l
 (-
	`__çb¦
 (
__x
 + __x)); \

598  
__exm1
 / (__exm1 + 2.0è* 
	`__sgn1l
 (-
__x
))

601 
	`__šlše_m©hcodeNP
 (
æoÜ
, 
__x
, \

602 
__v®ue
; \

603 
__ignÜe
; \

604 
__cw
; \

605 
__cwtmp
; \

606 
__asm
 
	`__vŞ©e
 ("fnstcw %3\n\t" \

614 : "ñ" (
__v®ue
), "=&q" (
__ignÜe
), "=m" (
__cwtmp
), \

615 "=m" (
__cw
) \

616 : "0" (
__x
)); \

617  
__v®ue
)

619 
	`__šlše_m©hcodeNP
 (
û
, 
__x
, \

620 
__v®ue
; \

621 
__ignÜe
; \

622 
__cw
; \

623 
__cwtmp
; \

624 
__asm
 
	`__vŞ©e
 ("fnstcw %3\n\t" \

632 : "ñ" (
__v®ue
), "=&q" (
__ignÜe
), "=m" (
__cwtmp
), \

633 "=m" (
__cw
) \

634 : "0" (
__x
)); \

635  
__v®ue
)

637 #ifdeà
__FAST_MATH__


638 
	#__ldexp_code
 \

639 
__v®ue
; \

640 
__asm
 
__vŞ©e__
 \

642 : "ñ" (
__v®ue
è: "0" (
__x
), "u" ((è
__y
)); \

643  
__v®ue


	)

645 
__MATH_INLINE
 

646 
	`__NTH
 (
	$ldexp
 (
__x
, 
__y
))

648 
__ldexp_code
;

649 
	}
}

654 #ifdeà
__USE_ISOC99


656 #ifdeà
__FAST_MATH__


657 
	$__šlše_m©hcodeNP
 (
expm1
, 
__x
, 
__expm1_code
)

661 
	#__M_SQRT2
 1.41421356237309504880L

	)

663 #ià!
	`__GNUC_PREREQ
 (3, 5)

664 
	`__šlše_m©hcodeNP
 (
log1p
, 
__x
, \

665 
__v®ue
; \

666 ià(
	`__çb¦
 (
__x
è>ğ1.0 - 0.5 * 
__M_SQRT2
) \

667 
__v®ue
 = 
	`logl
 (1.0 + 
__x
); \

669 
__asm
 
__vŞ©e__
 \

673 : "ñ" (
__v®ue
è: "0" (
__x
) : "st(1)"); \

674  
__v®ue
)

679 
	`__šlše_m©hcodeNP
 (
asšh
, 
__x
, \

680 
__y
 = 
	`__çb¦
 (
__x
); \

681  (
	`log1¶
 (
__y
 * __y / (
	`__libc_sq¹l
 (__y * __y + 1.0) + 1.0) + __y) \

682 * 
	$__sgn1l
 (
__x
)))

684 
	`__šlše_m©hcodeNP
 (
acosh
, 
__x
, \

685  
	`logl
 (
__x
 + 
	`__libc_sq¹l
 (__x - 1.0) * __libc_sqrtl (__x + 1.0)))

687 
	`__šlše_m©hcodeNP
 (
©ªh
, 
__x
, \

688 
__y
 = 
	`__çb¦
 (
__x
); \

689  -0.5 * 
	`log1¶
 (-(
__y
 + __yè/ (1.0 + __y)è* 
	$__sgn1l
 (
__x
))

692 
	`__šlše_m©hcodeNP2
 (
hypÙ
, 
__x
, 
__y
,

693  
	`__libc_sq¹l
 (
__x
 * __x + 
__y
 * __y))

695 #ià!
	`__GNUC_PREREQ
 (3, 5)

696 
	`__šlše_m©hcodeNP
(
logb
, 
__x
, \

697 
__v®ue
; \

698 
__junk
; \

699 
__asm
 
__vŞ©e__
 \

701 : "ñ" (
__junk
), "=u" (
__v®ue
è: "0" (
__x
)); \

702  
__v®ue
)

708 #ifdeà
__USE_ISOC99


709 #ifdeà
__FAST_MATH__


711 #ià!
	`__GNUC_PREREQ
 (3, 5)

712 
	`__šlše_m©hİ_deşNP
 (
log2
, "æd1; fxch; fyl2x", "0" (
__x
) : "st(1)")

715 
__MATH_INLINE
 

716 
	`__NTH
 (
	$ldexpf
 (
__x
, 
__y
))

718 
__ldexp_code
;

719 
	}
}

721 
__MATH_INLINE
 

722 
__NTH
 (
	$ldex¶
 (
__x
, 
__y
))

724 
__ldexp_code
;

725 
	}
}

727 
__šlše_m©hİNP
 (
ršt
, "frndint")

730 
	#__Ìšt_code
 \

731 
__ÌšŒes
; \

732 
__asm__
 
__vŞ©e__
 \

734 : "=m" (
__ÌšŒes
è: "t" (
__x
) : "st"); \

735  
__ÌšŒes


	)

736 
__MATH_INLINE
 

737 
__NTH
 (
	$Ìštf
 (
__x
))

739 
__Ìšt_code
;

740 
	}
}

741 
__MATH_INLINE
 

742 
__NTH
 (
	$Ìšt
 (
__x
))

744 
__Ìšt_code
;

745 
	}
}

746 
__MATH_INLINE
 

747 
__NTH
 (
	$Ìš
 (
__x
))

749 
__Ìšt_code
;

750 
	}
}

751 #undeà
__Ìšt_code


753 
	#__Îršt_code
 \

754 
__ÎršŒes
; \

755 
__asm__
 
__vŞ©e__
 \

757 : "=m" (
__ÎršŒes
è: "t" (
__x
) : "st"); \

758  
__ÎršŒes


	)

759 
__ex‹nsiÚ__


760 
__MATH_INLINE
 

761 
__NTH
 (
	$Îrštf
 (
__x
))

763 
__Îršt_code
;

764 
	}
}

765 
__ex‹nsiÚ__


766 
__MATH_INLINE
 

767 
__NTH
 (
	$Îršt
 (
__x
))

769 
__Îršt_code
;

770 
	}
}

771 
__ex‹nsiÚ__


772 
__MATH_INLINE
 

773 
__NTH
 (
	$Îrš
 (
__x
))

775 
__Îršt_code
;

776 
	}
}

777 #undeà
__Îršt_code


782 #ifdeà
__USE_MISC


784 #ià
defšed
 
__FAST_MATH__
 && !
__GNUC_PREREQ
 (3, 5)

785 
__šlše_m©hcodeNP2
 (
d»m
, 
__x
, 
__y
, \

786 
__v®ue
; \

787 
__şobb”ed
; \

788 
__asm
 
__vŞ©e__
 \

793 : "ñ" (
__v®ue
), "=&a" (
__şobb”ed
è: "0" (
__x
), "u" (
__y
) : "cc"); \

794  
__v®ue
)

799 
__MATH_INLINE
 

800 
__NTH
 (
	$__fš™e
 (
__x
))

802  (
__ex‹nsiÚ__


803 (((((uniÚ { 
__d
; 
__i
[2]; }è{__d: 
__x
}).__i[1]

805 
	}
}

810 #undeà
__©ª2_code


811 #ifdeà
__FAST_MATH__


812 #undeà
__expm1_code


813 #undeà
__exp_code


814 #undeà
__sšcos_code


821 #ifdeà
__LIBC_INTERNAL_MATH_INLINES


822 
__šlše_m©hİ
 (
__›“754_sq¹
, "fsqrt")

823 
__šlše_m©hcode2_
 (, 
__›“754_©ª2l
, 
__y
, 
__x
,

824 
__v®ue
;

825 
__asm
 
__vŞ©e__
 ("fpatan\n\t"

826 : "ñ" (
__v®ue
)

827 : "0" (
__x
), "u" (
__y
) : "st(1)");

828  
__v®ue
;)

	@/usr/include/bits/mman.h

19 #iâdeà
_SYS_MMAN_H


27 #ifdeà
__USE_MISC


28 
	#MAP_32BIT
 0x40

	)

32 #ifdeà
__USE_MISC


33 
	#MAP_GROWSDOWN
 0x00100

	)

34 
	#MAP_DENYWRITE
 0x00800

	)

35 
	#MAP_EXECUTABLE
 0x01000

	)

36 
	#MAP_LOCKED
 0x02000

	)

37 
	#MAP_NORESERVE
 0x04000

	)

38 
	#MAP_POPULATE
 0x08000

	)

39 
	#MAP_NONBLOCK
 0x10000

	)

40 
	#MAP_STACK
 0x20000

	)

41 
	#MAP_HUGETLB
 0x40000

	)

45 
	~<b™s/mmª-lšux.h
>

	@/usr/include/bits/netdb.h

18 #iâdeà
_NETDB_H


26 
	sÃ‹Á


28 *
	mn_Çme
;

29 **
	mn_®Ÿ£s
;

30 
	mn_add¹y³
;

31 
ušt32_t
 
	mn_Ãt
;

	@/usr/include/bits/param.h

19 #iâdeà
_SYS_PARAM_H


23 #iâdeà
ARG_MAX


24 
	#__undef_ARG_MAX


	)

27 
	~<lšux/lim™s.h
>

28 
	~<lšux/·¿m.h
>

31 #ifdeà
__undef_ARG_MAX


32 #undeà
ARG_MAX


33 #undeà
__undef_ARG_MAX


36 
	#MAXSYMLINKS
 20

	)

41 
	#NOFILE
 256

	)

42 
	#NCARGS
 131072

	)

	@/usr/include/bits/posix1_lim.h

24 #iâdef 
_BITS_POSIX1_LIM_H


25 
	#_BITS_POSIX1_LIM_H
 1

	)

31 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

34 
	#_POSIX_AIO_MAX
 1

	)

37 
	#_POSIX_ARG_MAX
 4096

	)

40 #ifdeà
__USE_XOPEN2K


41 
	#_POSIX_CHILD_MAX
 25

	)

43 
	#_POSIX_CHILD_MAX
 6

	)

47 
	#_POSIX_DELAYTIMER_MAX
 32

	)

51 
	#_POSIX_HOST_NAME_MAX
 255

	)

54 
	#_POSIX_LINK_MAX
 8

	)

57 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

60 
	#_POSIX_MAX_CANON
 255

	)

64 
	#_POSIX_MAX_INPUT
 255

	)

67 
	#_POSIX_MQ_OPEN_MAX
 8

	)

70 
	#_POSIX_MQ_PRIO_MAX
 32

	)

73 
	#_POSIX_NAME_MAX
 14

	)

76 #ifdeà
__USE_XOPEN2K


77 
	#_POSIX_NGROUPS_MAX
 8

	)

79 
	#_POSIX_NGROUPS_MAX
 0

	)

83 #ifdeà
__USE_XOPEN2K


84 
	#_POSIX_OPEN_MAX
 20

	)

86 
	#_POSIX_OPEN_MAX
 16

	)

89 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


92 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

96 
	#_POSIX_PATH_MAX
 256

	)

99 
	#_POSIX_PIPE_BUF
 512

	)

103 
	#_POSIX_RE_DUP_MAX
 255

	)

106 
	#_POSIX_RTSIG_MAX
 8

	)

109 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

112 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

115 
	#_POSIX_SIGQUEUE_MAX
 32

	)

118 
	#_POSIX_SSIZE_MAX
 32767

	)

121 
	#_POSIX_STREAM_MAX
 8

	)

124 
	#_POSIX_SYMLINK_MAX
 255

	)

128 
	#_POSIX_SYMLOOP_MAX
 8

	)

131 
	#_POSIX_TIMER_MAX
 32

	)

134 
	#_POSIX_TTY_NAME_MAX
 9

	)

137 #ifdeà
__USE_XOPEN2K


138 
	#_POSIX_TZNAME_MAX
 6

	)

140 
	#_POSIX_TZNAME_MAX
 3

	)

143 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


145 
	#_POSIX_QLIMIT
 1

	)

149 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

152 
	#_POSIX_UIO_MAXIOV
 16

	)

156 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

160 
	~<b™s/loÿl_lim.h
>

163 #iâdef 
SSIZE_MAX


164 
	#SSIZE_MAX
 
LONG_MAX


	)

171 #iâdef 
NGROUPS_MAX


172 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix2_lim.h

22 #iâdef 
_BITS_POSIX2_LIM_H


23 
	#_BITS_POSIX2_LIM_H
 1

	)

27 
	#_POSIX2_BC_BASE_MAX
 99

	)

30 
	#_POSIX2_BC_DIM_MAX
 2048

	)

33 
	#_POSIX2_BC_SCALE_MAX
 99

	)

36 
	#_POSIX2_BC_STRING_MAX
 1000

	)

40 
	#_POSIX2_COLL_WEIGHTS_MAX
 2

	)

44 
	#_POSIX2_EXPR_NEST_MAX
 32

	)

47 
	#_POSIX2_LINE_MAX
 2048

	)

51 
	#_POSIX2_RE_DUP_MAX
 255

	)

55 
	#_POSIX2_CHARCLASS_NAME_MAX
 14

	)

62 #iâdef 
BC_BASE_MAX


63 
	#BC_BASE_MAX
 
_POSIX2_BC_BASE_MAX


	)

65 #iâdef 
BC_DIM_MAX


66 
	#BC_DIM_MAX
 
_POSIX2_BC_DIM_MAX


	)

68 #iâdef 
BC_SCALE_MAX


69 
	#BC_SCALE_MAX
 
_POSIX2_BC_SCALE_MAX


	)

71 #iâdef 
BC_STRING_MAX


72 
	#BC_STRING_MAX
 
_POSIX2_BC_STRING_MAX


	)

74 #iâdef 
COLL_WEIGHTS_MAX


75 
	#COLL_WEIGHTS_MAX
 255

	)

77 #iâdef 
EXPR_NEST_MAX


78 
	#EXPR_NEST_MAX
 
_POSIX2_EXPR_NEST_MAX


	)

80 #iâdef 
LINE_MAX


81 
	#LINE_MAX
 
_POSIX2_LINE_MAX


	)

83 #iâdef 
CHARCLASS_NAME_MAX


84 
	#CHARCLASS_NAME_MAX
 2048

	)

88 
	#RE_DUP_MAX
 (0x7fff)

	)

	@/usr/include/bits/posix_opt.h

19 #iâdef 
_BITS_POSIX_OPT_H


20 
	#_BITS_POSIX_OPT_H
 1

	)

23 
	#_POSIX_JOB_CONTROL
 1

	)

26 
	#_POSIX_SAVED_IDS
 1

	)

29 
	#_POSIX_PRIORITY_SCHEDULING
 200809L

	)

32 
	#_POSIX_SYNCHRONIZED_IO
 200809L

	)

35 
	#_POSIX_FSYNC
 200809L

	)

38 
	#_POSIX_MAPPED_FILES
 200809L

	)

41 
	#_POSIX_MEMLOCK
 200809L

	)

44 
	#_POSIX_MEMLOCK_RANGE
 200809L

	)

47 
	#_POSIX_MEMORY_PROTECTION
 200809L

	)

50 
	#_POSIX_CHOWN_RESTRICTED
 0

	)

54 
	#_POSIX_VDISABLE
 '\0'

	)

57 
	#_POSIX_NO_TRUNC
 1

	)

60 
	#_XOPEN_REALTIME
 1

	)

63 
	#_XOPEN_REALTIME_THREADS
 1

	)

66 
	#_XOPEN_SHM
 1

	)

69 
	#_POSIX_THREADS
 200809L

	)

72 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

73 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200809L

	)

76 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200809L

	)

79 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200809L

	)

82 
	#_POSIX_THREAD_ATTR_STACKADDR
 200809L

	)

85 
	#_POSIX_THREAD_PRIO_INHERIT
 200809L

	)

89 
	#_POSIX_THREAD_PRIO_PROTECT
 200809L

	)

91 #ifdeà
__USE_XOPEN2K8


93 
	#_POSIX_THREAD_ROBUST_PRIO_INHERIT
 200809L

	)

96 
	#_POSIX_THREAD_ROBUST_PRIO_PROTECT
 -1

	)

100 
	#_POSIX_SEMAPHORES
 200809L

	)

103 
	#_POSIX_REALTIME_SIGNALS
 200809L

	)

106 
	#_POSIX_ASYNCHRONOUS_IO
 200809L

	)

107 
	#_POSIX_ASYNC_IO
 1

	)

109 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

111 
	#_POSIX_PRIORITIZED_IO
 200809L

	)

114 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

117 
	#_LFS_LARGEFILE
 1

	)

118 
	#_LFS64_LARGEFILE
 1

	)

119 
	#_LFS64_STDIO
 1

	)

122 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200809L

	)

125 
	#_POSIX_CPUTIME
 0

	)

128 
	#_POSIX_THREAD_CPUTIME
 0

	)

131 
	#_POSIX_REGEXP
 1

	)

134 
	#_POSIX_READER_WRITER_LOCKS
 200809L

	)

137 
	#_POSIX_SHELL
 1

	)

140 
	#_POSIX_TIMEOUTS
 200809L

	)

143 
	#_POSIX_SPIN_LOCKS
 200809L

	)

146 
	#_POSIX_SPAWN
 200809L

	)

149 
	#_POSIX_TIMERS
 200809L

	)

152 
	#_POSIX_BARRIERS
 200809L

	)

155 
	#_POSIX_MESSAGE_PASSING
 200809L

	)

158 
	#_POSIX_THREAD_PROCESS_SHARED
 200809L

	)

161 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

164 
	#_POSIX_CLOCK_SELECTION
 200809L

	)

167 
	#_POSIX_ADVISORY_INFO
 200809L

	)

170 
	#_POSIX_IPV6
 200809L

	)

173 
	#_POSIX_RAW_SOCKETS
 200809L

	)

176 
	#_POSIX2_CHAR_TERM
 200809L

	)

179 
	#_POSIX_SPORADIC_SERVER
 -1

	)

180 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

183 
	#_POSIX_TRACE
 -1

	)

184 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

185 
	#_POSIX_TRACE_INHERIT
 -1

	)

186 
	#_POSIX_TRACE_LOG
 -1

	)

189 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

	@/usr/include/bits/pthreadtypes.h

19 #iâdeà
_BITS_PTHREADTYPES_COMMON_H


20 
	#_BITS_PTHREADTYPES_COMMON_H
 1

	)

23 
	~<b™s/th»ad-sh¬ed-ty³s.h
>

27 
	t±h»ad_t
;

34 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

35 
	m__®ign
;

36 } 
	t±h»ad_mu‹x©Œ_t
;

43 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

44 
	m__®ign
;

45 } 
	t±h»ad_cÚd©Œ_t
;

49 
	t±h»ad_key_t
;

53 
	t__ONCE_ALIGNMENT
 
	t±h»ad_Úû_t
;

56 
	u±h»ad_©Œ_t


58 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

59 
	m__®ign
;

61 #iâdeà
__have_±h»ad_©Œ_t


62 
±h»ad_©Œ_t
 
	t±h»ad_©Œ_t
;

63 
	#__have_±h»ad_©Œ_t
 1

	)

69 
__±h»ad_mu‹x_s
 
	m__d©a
;

70 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

71 
	m__®ign
;

72 } 
	t±h»ad_mu‹x_t
;

77 
__±h»ad_cÚd_s
 
	m__d©a
;

78 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

79 
__ex‹nsiÚ__
 
	m__®ign
;

80 } 
	t±h»ad_cÚd_t
;

83 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


88 
__±h»ad_rwlock_¬ch_t
 
	m__d©a
;

89 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

90 
	m__®ign
;

91 } 
	t±h»ad_rwlock_t
;

95 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

96 
	m__®ign
;

97 } 
	t±h»ad_rwlock©Œ_t
;

101 #ifdeà
__USE_XOPEN2K


103 vŞ©
	t±h»ad_¥šlock_t
;

110 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

111 
	m__®ign
;

112 } 
	t±h»ad_b¬r›r_t
;

116 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

117 
	m__®ign
;

118 } 
	t±h»ad_b¬r›¿‰r_t
;

	@/usr/include/bits/resource.h

19 #iâdeà
_SYS_RESOURCE_H


23 
	~<b™s/ty³s.h
>

31 
	e__¾im™_»sourû


34 
	mRLIMIT_CPU
 = 0,

35 
	#RLIMIT_CPU
 
RLIMIT_CPU


	)

38 
	mRLIMIT_FSIZE
 = 1,

39 
	#RLIMIT_FSIZE
 
RLIMIT_FSIZE


	)

42 
	mRLIMIT_DATA
 = 2,

43 
	#RLIMIT_DATA
 
RLIMIT_DATA


	)

46 
	mRLIMIT_STACK
 = 3,

47 
	#RLIMIT_STACK
 
RLIMIT_STACK


	)

50 
	mRLIMIT_CORE
 = 4,

51 
	#RLIMIT_CORE
 
RLIMIT_CORE


	)

57 
	m__RLIMIT_RSS
 = 5,

58 
	#RLIMIT_RSS
 
__RLIMIT_RSS


	)

61 
	mRLIMIT_NOFILE
 = 7,

62 
	m__RLIMIT_OFILE
 = 
RLIMIT_NOFILE
,

63 
	#RLIMIT_NOFILE
 
RLIMIT_NOFILE


	)

64 
	#RLIMIT_OFILE
 
__RLIMIT_OFILE


	)

67 
	mRLIMIT_AS
 = 9,

68 
	#RLIMIT_AS
 
RLIMIT_AS


	)

71 
	m__RLIMIT_NPROC
 = 6,

72 
	#RLIMIT_NPROC
 
__RLIMIT_NPROC


	)

75 
	m__RLIMIT_MEMLOCK
 = 8,

76 
	#RLIMIT_MEMLOCK
 
__RLIMIT_MEMLOCK


	)

79 
	m__RLIMIT_LOCKS
 = 10,

80 
	#RLIMIT_LOCKS
 
__RLIMIT_LOCKS


	)

83 
	m__RLIMIT_SIGPENDING
 = 11,

84 
	#RLIMIT_SIGPENDING
 
__RLIMIT_SIGPENDING


	)

87 
	m__RLIMIT_MSGQUEUE
 = 12,

88 
	#RLIMIT_MSGQUEUE
 
__RLIMIT_MSGQUEUE


	)

93 
	m__RLIMIT_NICE
 = 13,

94 
	#RLIMIT_NICE
 
__RLIMIT_NICE


	)

98 
	m__RLIMIT_RTPRIO
 = 14,

99 
	#RLIMIT_RTPRIO
 
__RLIMIT_RTPRIO


	)

104 
	m__RLIMIT_RTTIME
 = 15,

105 
	#RLIMIT_RTTIME
 
__RLIMIT_RTTIME


	)

107 
	m__RLIMIT_NLIMITS
 = 16,

108 
	m__RLIM_NLIMITS
 = 
__RLIMIT_NLIMITS


109 
	#RLIMIT_NLIMITS
 
__RLIMIT_NLIMITS


	)

110 
	#RLIM_NLIMITS
 
__RLIM_NLIMITS


	)

114 #iâdeà
__USE_FILE_OFFSET64


115 
	#RLIM_INFINITY
 ((
__¾im_t
è-1)

	)

117 
	#RLIM_INFINITY
 0xffffffffffffffffuLL

	)

120 #ifdeà
__USE_LARGEFILE64


121 
	#RLIM64_INFINITY
 0xffffffffffffffffuLL

	)

125 
	#RLIM_SAVED_MAX
 
RLIM_INFINITY


	)

126 
	#RLIM_SAVED_CUR
 
RLIM_INFINITY


	)

130 #iâdeà
__USE_FILE_OFFSET64


131 
__¾im_t
 
	t¾im_t
;

133 
__¾im64_t
 
	t¾im_t
;

135 #ifdeà
__USE_LARGEFILE64


136 
__¾im64_t
 
	t¾im64_t
;

139 
	s¾im™


142 
¾im_t
 
	m¾im_cur
;

144 
¾im_t
 
	m¾im_max
;

147 #ifdeà
__USE_LARGEFILE64


148 
	s¾im™64


151 
¾im64_t
 
	m¾im_cur
;

153 
¾im64_t
 
	m¾im_max
;

158 
	e__ru§ge_who


161 
	mRUSAGE_SELF
 = 0,

162 
	#RUSAGE_SELF
 
RUSAGE_SELF


	)

165 
	mRUSAGE_CHILDREN
 = -1

166 
	#RUSAGE_CHILDREN
 
RUSAGE_CHILDREN


	)

168 #ifdeà
__USE_GNU


171 
	mRUSAGE_THREAD
 = 1

172 
	#RUSAGE_THREAD
 
RUSAGE_THREAD


	)

174 
	#RUSAGE_LWP
 
RUSAGE_THREAD


	)

178 
	~<b™s/ty³s/¡ruù_timev®.h
>

179 
	~<b™s/ty³s/¡ruù_ru§ge.h
>

182 
	#PRIO_MIN
 -20

	)

183 
	#PRIO_MAX
 20

	)

187 
	e__´iÜ™y_which


189 
	mPRIO_PROCESS
 = 0,

190 
	#PRIO_PROCESS
 
PRIO_PROCESS


	)

191 
	mPRIO_PGRP
 = 1,

192 
	#PRIO_PGRP
 
PRIO_PGRP


	)

193 
	mPRIO_USER
 = 2

194 
	#PRIO_USER
 
PRIO_USER


	)

198 
	g__BEGIN_DECLS


200 #ifdeà
__USE_GNU


202 #iâdeà
__USE_FILE_OFFSET64


203 
	$´lim™
 (
__pid_t
 
__pid
, 
__¾im™_»sourû
 
__»sourû
,

204 cÚ¡ 
¾im™
 *
__Ãw_lim™
,

205 
¾im™
 *
__Şd_lim™
è
__THROW
;

207 #ifdeà
__REDIRECT_NTH


208 
	`__REDIRECT_NTH
 (
´lim™
, (
__pid_t
 
__pid
,

209 
__¾im™_»sourû
 
__»sourû
,

210 cÚ¡ 
¾im™
 *
__Ãw_lim™
,

211 
¾im™
 *
__Şd_lim™
), 
´lim™64
);

213 
	#´lim™
 
´lim™64


	)

216 #ifdeà
__USE_LARGEFILE64


217 
	$´lim™64
 (
__pid_t
 
__pid
, 
__¾im™_»sourû
 
__»sourû
,

218 cÚ¡ 
¾im™64
 *
__Ãw_lim™
,

219 
¾im™64
 *
__Şd_lim™
è
__THROW
;

223 
__END_DECLS


	@/usr/include/bits/sched.h

20 #iâdeà
_BITS_SCHED_H


21 
	#_BITS_SCHED_H
 1

	)

23 #iâdeà
_SCHED_H


28 
	#SCHED_OTHER
 0

	)

29 
	#SCHED_FIFO
 1

	)

30 
	#SCHED_RR
 2

	)

31 #ifdeà
__USE_GNU


32 
	#SCHED_BATCH
 3

	)

33 
	#SCHED_ISO
 4

	)

34 
	#SCHED_IDLE
 5

	)

35 
	#SCHED_DEADLINE
 6

	)

37 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

40 #ifdeà
__USE_GNU


42 
	#CSIGNAL
 0x000000fà

	)

43 
	#CLONE_VM
 0x00000100

	)

44 
	#CLONE_FS
 0x00000200

	)

45 
	#CLONE_FILES
 0x00000400

	)

46 
	#CLONE_SIGHAND
 0x00000800

	)

47 
	#CLONE_PTRACE
 0x00002000

	)

48 
	#CLONE_VFORK
 0x00004000

	)

50 
	#CLONE_PARENT
 0x00008000

	)

52 
	#CLONE_THREAD
 0x00010000

	)

53 
	#CLONE_NEWNS
 0x00020000

	)

54 
	#CLONE_SYSVSEM
 0x00040000

	)

55 
	#CLONE_SETTLS
 0x00080000

	)

56 
	#CLONE_PARENT_SETTID
 0x00100000

	)

58 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

60 
	#CLONE_DETACHED
 0x00400000

	)

61 
	#CLONE_UNTRACED
 0x00800000

	)

63 
	#CLONE_CHILD_SETTID
 0x01000000

	)

65 
	#CLONE_NEWCGROUP
 0x02000000

	)

66 
	#CLONE_NEWUTS
 0x04000000

	)

67 
	#CLONE_NEWIPC
 0x08000000

	)

68 
	#CLONE_NEWUSER
 0x10000000

	)

69 
	#CLONE_NEWPID
 0x20000000

	)

70 
	#CLONE_NEWNET
 0x40000000

	)

71 
	#CLONE_IO
 0x80000000

	)

75 
	ssched_·¿m


77 
	msched_´iÜ™y
;

80 
	g__BEGIN_DECLS


82 #ifdeà
__USE_GNU


84 
	$şÚe
 ((*
__â
è(*
__¬g
), *
__chd_¡ack
,

85 
__æags
, *
__¬g
, ...è
__THROW
;

88 
	$unsh¬e
 (
__æags
è
__THROW
;

91 
	$sched_g‘ıu
 (è
__THROW
;

94 
	$£Šs
 (
__fd
, 
__n¡y³
è
__THROW
;

97 
__END_DECLS


	@/usr/include/bits/select.h

18 #iâdeà
_SYS_SELECT_H


22 
	~<b™s/wÜdsize.h
>

25 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

27 #ià
__WORDSIZE
 == 64

28 
	#__FD_ZERO_STOS
 "¡osq"

	)

30 
	#__FD_ZERO_STOS
 "¡o¦"

	)

33 
	#__FD_ZERO
(
fd¥
) \

35 
__d0
, 
__d1
; \

36 
__asm__
 
	`__vŞ©e__
 ("şd;„•; " 
__FD_ZERO_STOS
 \

37 : "=c" (
__d0
), "=D" (
__d1
) \

38 : "a" (0), "0" ( (
fd_£t
) \

39 /  (
__fd_mask
)), \

40 "1" (&
	`__FDS_BITS
 (
fd¥
)[0]) \

42 } 0)

	)

48 
	#__FD_ZERO
(
£t
) \

50 
__i
; \

51 
fd_£t
 *
__¬r
 = (
£t
); \

52 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

53 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

54 } 0)

	)

58 
	#__FD_SET
(
d
, 
£t
) \

59 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |ğ
	`__FD_MASK
 (d)))

	)

60 
	#__FD_CLR
(
d
, 
£t
) \

61 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &ğ~
	`__FD_MASK
 (d)))

	)

62 
	#__FD_ISSET
(
d
, 
£t
) \

63 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)è!ğ0)

	)

	@/usr/include/bits/select2.h

19 #iâdeà
_SYS_SELECT_H


24 
__fd–t_chk
 (
__d
);

25 
	$__fd–t_w¬n
 (
__d
)

26 
	`__w¬Ç‰r
 ("bit outside of fd_set selected");

27 #undeà
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__ex‹nsiÚ__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__butš_cÚ¡ªt_p
 (
__d
) \

32 ? (0 <ğ
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fd–t_w¬n
 (
__d
)) \

35 : 
	`__fd–t_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/setjmp.h

19 #iâdeà
_BITS_SETJMP_H


20 
	#_BITS_SETJMP_H
 1

	)

22 #ià!
defšed
 
_SETJMP_H
 && !defšed 
_PTHREAD_H


26 
	~<b™s/wÜdsize.h
>

28 #iâdeà
_ASM


30 #ià
__WORDSIZE
 == 64

31 
	t__jmp_buf
[8];

32 #–ià
defšed
 
__x86_64__


33 
__ex‹nsiÚ__
 
	t__jmp_buf
[8];

35 
	t__jmp_buf
[6];

	@/usr/include/bits/setjmp2.h

19 #iâdeà
_SETJMP_H


24 #ifdeà
__REDIRECT_NTH


25 
__REDIRECT_NTHNL
 (
lÚgjmp
,

26 (
__jmp_buf_g
 
__’v
[1], 
__v®
),

27 
__lÚgjmp_chk
è
__©Œibu‹__
 ((
__nÜ‘uº__
));

28 
__REDIRECT_NTHNL
 (
_lÚgjmp
,

29 (
__jmp_buf_g
 
__’v
[1], 
__v®
),

30 
__lÚgjmp_chk
è
__©Œibu‹__
 ((
__nÜ‘uº__
));

31 
__REDIRECT_NTHNL
 (
siglÚgjmp
,

32 (
__jmp_buf_g
 
__’v
[1], 
__v®
),

33 
__lÚgjmp_chk
è
__©Œibu‹__
 ((
__nÜ‘uº__
));

35 
__lÚgjmp_chk
 (
__jmp_buf_g
 
__’v
[1], 
__v®
),

36 
__THROWNL
 
__©Œibu‹__
 ((
__nÜ‘uº__
));

37 
	#lÚgjmp
 
__lÚgjmp_chk


	)

38 
	#_lÚgjmp
 
__lÚgjmp_chk


	)

39 
	#siglÚgjmp
 
__lÚgjmp_chk


	)

	@/usr/include/bits/sigaction.h

19 #iâdeà
_SIGNAL_H


24 
	ssigaùiÚ


27 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


31 
__sighªdËr_t
 
	m§_hªdËr
;

33 (*
	m§_sigaùiÚ
è(, 
	msigšfo_t
 *, *);

35 
	m__sigaùiÚ_hªdËr
;

36 
	#§_hªdËr
 
__sigaùiÚ_hªdËr
.
§_hªdËr


	)

37 
	#§_sigaùiÚ
 
__sigaùiÚ_hªdËr
.
§_sigaùiÚ


	)

39 
__sighªdËr_t
 
	m§_hªdËr
;

43 
__sig£t_t
 
	m§_mask
;

46 
	m§_æags
;

49 (*
	m§_»¡Ü”
) ();

53 
	#SA_NOCLDSTOP
 1

	)

54 
	#SA_NOCLDWAIT
 2

	)

55 
	#SA_SIGINFO
 4

	)

57 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_MISC


58 
	#SA_ONSTACK
 0x08000000

	)

60 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


61 
	#SA_RESTART
 0x10000000

	)

62 
	#SA_NODEFER
 0x40000000

	)

64 
	#SA_RESETHAND
 0x80000000

	)

66 #ifdeà
__USE_MISC


67 
	#SA_INTERRUPT
 0x20000000

	)

70 
	#SA_NOMASK
 
SA_NODEFER


	)

71 
	#SA_ONESHOT
 
SA_RESETHAND


	)

72 
	#SA_STACK
 
SA_ONSTACK


	)

76 
	#SIG_BLOCK
 0

	)

77 
	#SIG_UNBLOCK
 1

	)

78 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

18 #iâdeà
_BITS_SIGCONTEXT_H


19 
	#_BITS_SIGCONTEXT_H
 1

	)

21 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_SYS_UCONTEXT_H


25 
	~<b™s/ty³s.h
>

27 
	#FP_XSTATE_MAGIC1
 0x46505853U

	)

28 
	#FP_XSTATE_MAGIC2
 0x46505845U

	)

29 
	#FP_XSTATE_MAGIC2_SIZE
 (
FP_XSTATE_MAGIC2
)

	)

31 
	s_åx_sw_by‹s


33 
__ušt32_t
 
	mmagic1
;

34 
__ušt32_t
 
	mex‹nded_size
;

35 
__ušt64_t
 
	mx¡©e_bv
;

36 
__ušt32_t
 
	mx¡©e_size
;

37 
__ušt32_t
 
	m__glibc_»£rved1
[7];

40 
	s_å»g


42 
	msignifiÿnd
[4];

43 
	mexpÚ’t
;

46 
	s_åx»g


48 
	msignifiÿnd
[4];

49 
	mexpÚ’t
;

50 
	m__glibc_»£rved1
[3];

53 
	s_xmm»g


55 
__ušt32_t
 
	m–em’t
[4];

60 #iâdeà
__x86_64__


62 
	s_å¡©e


65 
__ušt32_t
 
	mcw
;

66 
__ušt32_t
 
	msw
;

67 
__ušt32_t
 
	mg
;

68 
__ušt32_t
 
	moff
;

69 
__ušt32_t
 
	mcs£l
;

70 
__ušt32_t
 
	md©aoff
;

71 
__ušt32_t
 
	md©a£l
;

72 
_å»g
 
	m_¡
[8];

73 
	m¡©us
;

74 
	mmagic
;

77 
__ušt32_t
 
	m_fx¤_’v
[6];

78 
__ušt32_t
 
	mmxc¤
;

79 
__ušt32_t
 
	m__glibc_»£rved1
;

80 
_åx»g
 
	m_fx¤_¡
[8];

81 
_xmm»g
 
	m_xmm
[8];

82 
__ušt32_t
 
	m__glibc_»£rved2
[56];

85 #iâdeà
sigcÚ‹xt_¡ruù


90 
	#sigcÚ‹xt_¡ruù
 
sigcÚ‹xt


	)

93 
	#X86_FXSR_MAGIC
 0x0000

	)

95 
	ssigcÚ‹xt


97 
	mgs
, 
	m__gsh
;

98 
	mfs
, 
	m__fsh
;

99 
	mes
, 
	m__esh
;

100 
	mds
, 
	m__dsh
;

101 
	medi
;

102 
	mesi
;

103 
	mebp
;

104 
	me¥
;

105 
	mebx
;

106 
	medx
;

107 
	mecx
;

108 
	m—x
;

109 
	mŒ­no
;

110 
	m”r
;

111 
	me
;

112 
	mcs
, 
	m__csh
;

113 
	meæags
;

114 
	me¥_©_sigÇl
;

115 
	mss
, 
	m__ssh
;

116 
_å¡©e
 * 
	må¡©e
;

117 
	mŞdmask
;

118 
	mü2
;

123 
	s_å¡©e


126 
__ušt16_t
 
	mcwd
;

127 
__ušt16_t
 
	mswd
;

128 
__ušt16_t
 
	máw
;

129 
__ušt16_t
 
	mfİ
;

130 
__ušt64_t
 
	mr
;

131 
__ušt64_t
 
	mrdp
;

132 
__ušt32_t
 
	mmxc¤
;

133 
__ušt32_t
 
	mmxü_mask
;

134 
_åx»g
 
	m_¡
[8];

135 
_xmm»g
 
	m_xmm
[16];

136 
__ušt32_t
 
	m__glibc_»£rved1
[24];

139 
	ssigcÚ‹xt


141 
__ušt64_t
 
	mr8
;

142 
__ušt64_t
 
	mr9
;

143 
__ušt64_t
 
	mr10
;

144 
__ušt64_t
 
	mr11
;

145 
__ušt64_t
 
	mr12
;

146 
__ušt64_t
 
	mr13
;

147 
__ušt64_t
 
	mr14
;

148 
__ušt64_t
 
	mr15
;

149 
__ušt64_t
 
	mrdi
;

150 
__ušt64_t
 
	mrsi
;

151 
__ušt64_t
 
	mrbp
;

152 
__ušt64_t
 
	mrbx
;

153 
__ušt64_t
 
	mrdx
;

154 
__ušt64_t
 
	m¿x
;

155 
__ušt64_t
 
	mrcx
;

156 
__ušt64_t
 
	mr¥
;

157 
__ušt64_t
 
	mr
;

158 
__ušt64_t
 
	meæags
;

159 
	mcs
;

160 
	mgs
;

161 
	mfs
;

162 
	m__·d0
;

163 
__ušt64_t
 
	m”r
;

164 
__ušt64_t
 
	mŒ­no
;

165 
__ušt64_t
 
	mŞdmask
;

166 
__ušt64_t
 
	mü2
;

167 
__ex‹nsiÚ__
 union

169 
_å¡©e
 * 
	må¡©e
;

170 
__ušt64_t
 
	m__å¡©e_wÜd
;

172 
__ušt64_t
 
	m__»£rved1
 [8];

177 
	s_x§ve_hdr


179 
__ušt64_t
 
	mx¡©e_bv
;

180 
__ušt64_t
 
	m__glibc_»£rved1
[2];

181 
__ušt64_t
 
	m__glibc_»£rved2
[5];

184 
	s_ymmh_¡©e


186 
__ušt32_t
 
	mymmh_¥aû
[64];

189 
	s_x¡©e


191 
_å¡©e
 
	må¡©e
;

192 
_x§ve_hdr
 
	mx¡©e_hdr
;

193 
_ymmh_¡©e
 
	mymmh
;

	@/usr/include/bits/sigevent-consts.h

19 #iâdeà
_BITS_SIGEVENT_CONSTS_H


20 
	#_BITS_SIGEVENT_CONSTS_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_AIO_H


29 
	mSIGEV_SIGNAL
 = 0,

30 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

31 
	mSIGEV_NONE
,

32 
	#SIGEV_NONE
 
SIGEV_NONE


	)

33 
	mSIGEV_THREAD
,

34 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

36 
	mSIGEV_THREAD_ID
 = 4

38 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/siginfo-consts.h

19 #iâdeà
_BITS_SIGINFO_CONSTS_H


20 
	#_BITS_SIGINFO_CONSTS_H
 1

	)

22 #iâdeà
_SIGNAL_H


28 
	~<b™s/sigšfo-¬ch.h
>

29 #iâdeà
__SI_ASYNCIO_AFTER_SIGIO


30 
	#__SI_ASYNCIO_AFTER_SIGIO
 1

	)

37 
	mSI_ASYNCNL
 = -60,

38 
	mSI_TKILL
 = -6,

39 
	mSI_SIGIO
,

40 #ià
__SI_ASYNCIO_AFTER_SIGIO


41 
	mSI_ASYNCIO
,

42 
	mSI_MESGQ
,

43 
	mSI_TIMER
,

45 
	mSI_MESGQ
,

46 
	mSI_TIMER
,

47 
	mSI_ASYNCIO
,

49 
	mSI_QUEUE
,

50 
	mSI_USER
,

51 
	mSI_KERNEL
 = 0x80

53 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

54 
	#SI_TKILL
 
SI_TKILL


	)

55 
	#SI_SIGIO
 
SI_SIGIO


	)

56 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

57 
	#SI_MESGQ
 
SI_MESGQ


	)

58 
	#SI_TIMER
 
SI_TIMER


	)

59 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

60 
	#SI_QUEUE
 
SI_QUEUE


	)

61 
	#SI_USER
 
SI_USER


	)

62 
	#SI_KERNEL
 
SI_KERNEL


	)

66 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


70 
	mILL_ILLOPC
 = 1,

71 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

72 
	mILL_ILLOPN
,

73 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

74 
	mILL_ILLADR
,

75 
	#ILL_ILLADR
 
ILL_ILLADR


	)

76 
	mILL_ILLTRP
,

77 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

78 
	mILL_PRVOPC
,

79 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

80 
	mILL_PRVREG
,

81 
	#ILL_PRVREG
 
ILL_PRVREG


	)

82 
	mILL_COPROC
,

83 
	#ILL_COPROC
 
ILL_COPROC


	)

84 
	mILL_BADSTK


85 
	#ILL_BADSTK
 
ILL_BADSTK


	)

91 
	mFPE_INTDIV
 = 1,

92 
	#FPE_INTDIV
 
FPE_INTDIV


	)

93 
	mFPE_INTOVF
,

94 
	#FPE_INTOVF
 
FPE_INTOVF


	)

95 
	mFPE_FLTDIV
,

96 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

97 
	mFPE_FLTOVF
,

98 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

99 
	mFPE_FLTUND
,

100 
	#FPE_FLTUND
 
FPE_FLTUND


	)

101 
	mFPE_FLTRES
,

102 
	#FPE_FLTRES
 
FPE_FLTRES


	)

103 
	mFPE_FLTINV
,

104 
	#FPE_FLTINV
 
FPE_FLTINV


	)

105 
	mFPE_FLTSUB


106 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

112 
	mSEGV_MAPERR
 = 1,

113 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

114 
	mSEGV_ACCERR
,

115 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

116 
	mSEGV_BNDERR
,

117 
	#SEGV_BNDERR
 
SEGV_BNDERR


	)

118 
	mSEGV_PKUERR


119 
	#SEGV_PKUERR
 
SEGV_PKUERR


	)

125 
	mBUS_ADRALN
 = 1,

126 
	#BUS_ADRALN
 
BUS_ADRALN


	)

127 
	mBUS_ADRERR
,

128 
	#BUS_ADRERR
 
BUS_ADRERR


	)

129 
	mBUS_OBJERR
,

130 
	#BUS_OBJERR
 
BUS_OBJERR


	)

131 
	mBUS_MCEERR_AR
,

132 
	#BUS_MCEERR_AR
 
BUS_MCEERR_AR


	)

133 
	mBUS_MCEERR_AO


134 
	#BUS_MCEERR_AO
 
BUS_MCEERR_AO


	)

138 #ifdeà
__USE_XOPEN_EXTENDED


142 
	mTRAP_BRKPT
 = 1,

143 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

144 
	mTRAP_TRACE


145 
	#TRAP_TRACE
 
TRAP_TRACE


	)

149 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


153 
	mCLD_EXITED
 = 1,

154 
	#CLD_EXITED
 
CLD_EXITED


	)

155 
	mCLD_KILLED
,

156 
	#CLD_KILLED
 
CLD_KILLED


	)

157 
	mCLD_DUMPED
,

158 
	#CLD_DUMPED
 
CLD_DUMPED


	)

159 
	mCLD_TRAPPED
,

160 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

161 
	mCLD_STOPPED
,

162 
	#CLD_STOPPED
 
CLD_STOPPED


	)

163 
	mCLD_CONTINUED


164 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

170 
	mPOLL_IN
 = 1,

171 
	#POLL_IN
 
POLL_IN


	)

172 
	mPOLL_OUT
,

173 
	#POLL_OUT
 
POLL_OUT


	)

174 
	mPOLL_MSG
,

175 
	#POLL_MSG
 
POLL_MSG


	)

176 
	mPOLL_ERR
,

177 
	#POLL_ERR
 
POLL_ERR


	)

178 
	mPOLL_PRI
,

179 
	#POLL_PRI
 
POLL_PRI


	)

180 
	mPOLL_HUP


181 
	#POLL_HUP
 
POLL_HUP


	)

187 #ifdeà
__USE_GNU


188 
	~<b™s/sigšfo-cÚ¡s-¬ch.h
>

	@/usr/include/bits/signum.h

19 #iâdeà
_BITS_SIGNUM_H


20 
	#_BITS_SIGNUM_H
 1

	)

22 #iâdeà
_SIGNAL_H


26 
	~<b™s/signum-g’”ic.h
>

31 
	#SIGSTKFLT
 16

	)

32 
	#SIGPWR
 30

	)

34 #undeà
SIGBUS


35 
	#SIGBUS
 7

	)

36 #undeà
SIGUSR1


37 
	#SIGUSR1
 10

	)

38 #undeà
SIGUSR2


39 
	#SIGUSR2
 12

	)

40 #undeà
SIGCHLD


41 
	#SIGCHLD
 17

	)

42 #undeà
SIGCONT


43 
	#SIGCONT
 18

	)

44 #undeà
SIGSTOP


45 
	#SIGSTOP
 19

	)

46 #undeà
SIGTSTP


47 
	#SIGTSTP
 20

	)

48 #undeà
SIGURG


49 
	#SIGURG
 23

	)

50 #undeà
SIGPOLL


51 
	#SIGPOLL
 29

	)

52 #undeà
SIGSYS


53 
	#SIGSYS
 31

	)

55 #undeà
__SIGRTMAX


56 
	#__SIGRTMAX
 64

	)

	@/usr/include/bits/sigstack.h

19 #iâdeà
_BITS_SIGSTACK_H


20 
	#_BITS_SIGSTACK_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_SYS_UCONTEXT_H


27 
	#MINSIGSTKSZ
 2048

	)

30 
	#SIGSTKSZ
 8192

	)

	@/usr/include/bits/sigthread.h

19 #iâdeà
_BITS_SIGTHREAD_H


20 
	#_BITS_SIGTHREAD_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_PTHREAD_H


27 
	~<b™s/ty³s/__sig£t_t.h
>

31 
	$±h»ad_sigmask
 (
__how
,

32 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__Ãwmask
,

33 
__sig£t_t
 *
__»¡riù
 
__Şdmask
)
__THROW
;

36 
	$±h»ad_kl
 (
±h»ad_t
 
__th»adid
, 
__signo
è
__THROW
;

38 #ifdeà
__USE_GNU


40 
	$±h»ad_sigqueue
 (
±h»ad_t
 
__th»adid
, 
__signo
,

41 cÚ¡ 
sigv®
 
__v®ue
è
__THROW
;

	@/usr/include/bits/sockaddr.h

23 #iâdeà
_BITS_SOCKADDR_H


24 
	#_BITS_SOCKADDR_H
 1

	)

28 
	t§_çmy_t
;

34 
	#__SOCKADDR_COMMON
(
§_´efix
) \

35 
§_çmy_t
 
§_´efix
##
çmy


	)

37 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

40 
	#_SS_SIZE
 128

	)

	@/usr/include/bits/socket.h

19 #iâdeà
__BITS_SOCKET_H


20 
	#__BITS_SOCKET_H


	)

22 #iâdeà
_SYS_SOCKET_H


26 
	#__Ãed_size_t


	)

27 
	~<¡ddef.h
>

29 
	~<sys/ty³s.h
>

32 #iâdeà
__sockËn_t_defšed


33 
__sockËn_t
 
	tsockËn_t
;

34 
	#__sockËn_t_defšed


	)

38 
	~<b™s/sock‘_ty³.h
>

41 
	#PF_UNSPEC
 0

	)

42 
	#PF_LOCAL
 1

	)

43 
	#PF_UNIX
 
PF_LOCAL


	)

44 
	#PF_FILE
 
PF_LOCAL


	)

45 
	#PF_INET
 2

	)

46 
	#PF_AX25
 3

	)

47 
	#PF_IPX
 4

	)

48 
	#PF_APPLETALK
 5

	)

49 
	#PF_NETROM
 6

	)

50 
	#PF_BRIDGE
 7

	)

51 
	#PF_ATMPVC
 8

	)

52 
	#PF_X25
 9

	)

53 
	#PF_INET6
 10

	)

54 
	#PF_ROSE
 11

	)

55 
	#PF_DECÃt
 12

	)

56 
	#PF_NETBEUI
 13

	)

57 
	#PF_SECURITY
 14

	)

58 
	#PF_KEY
 15

	)

59 
	#PF_NETLINK
 16

	)

60 
	#PF_ROUTE
 
PF_NETLINK


	)

61 
	#PF_PACKET
 17

	)

62 
	#PF_ASH
 18

	)

63 
	#PF_ECONET
 19

	)

64 
	#PF_ATMSVC
 20

	)

65 
	#PF_RDS
 21

	)

66 
	#PF_SNA
 22

	)

67 
	#PF_IRDA
 23

	)

68 
	#PF_PPPOX
 24

	)

69 
	#PF_WANPIPE
 25

	)

70 
	#PF_LLC
 26

	)

71 
	#PF_IB
 27

	)

72 
	#PF_MPLS
 28

	)

73 
	#PF_CAN
 29

	)

74 
	#PF_TIPC
 30

	)

75 
	#PF_BLUETOOTH
 31

	)

76 
	#PF_IUCV
 32

	)

77 
	#PF_RXRPC
 33

	)

78 
	#PF_ISDN
 34

	)

79 
	#PF_PHONET
 35

	)

80 
	#PF_IEEE802154
 36

	)

81 
	#PF_CAIF
 37

	)

82 
	#PF_ALG
 38

	)

83 
	#PF_NFC
 39

	)

84 
	#PF_VSOCK
 40

	)

85 
	#PF_KCM
 41

	)

86 
	#PF_QIPCRTR
 42

	)

87 
	#PF_SMC
 43

	)

88 
	#PF_MAX
 44

	)

91 
	#AF_UNSPEC
 
PF_UNSPEC


	)

92 
	#AF_LOCAL
 
PF_LOCAL


	)

93 
	#AF_UNIX
 
PF_UNIX


	)

94 
	#AF_FILE
 
PF_FILE


	)

95 
	#AF_INET
 
PF_INET


	)

96 
	#AF_AX25
 
PF_AX25


	)

97 
	#AF_IPX
 
PF_IPX


	)

98 
	#AF_APPLETALK
 
PF_APPLETALK


	)

99 
	#AF_NETROM
 
PF_NETROM


	)

100 
	#AF_BRIDGE
 
PF_BRIDGE


	)

101 
	#AF_ATMPVC
 
PF_ATMPVC


	)

102 
	#AF_X25
 
PF_X25


	)

103 
	#AF_INET6
 
PF_INET6


	)

104 
	#AF_ROSE
 
PF_ROSE


	)

105 
	#AF_DECÃt
 
PF_DECÃt


	)

106 
	#AF_NETBEUI
 
PF_NETBEUI


	)

107 
	#AF_SECURITY
 
PF_SECURITY


	)

108 
	#AF_KEY
 
PF_KEY


	)

109 
	#AF_NETLINK
 
PF_NETLINK


	)

110 
	#AF_ROUTE
 
PF_ROUTE


	)

111 
	#AF_PACKET
 
PF_PACKET


	)

112 
	#AF_ASH
 
PF_ASH


	)

113 
	#AF_ECONET
 
PF_ECONET


	)

114 
	#AF_ATMSVC
 
PF_ATMSVC


	)

115 
	#AF_RDS
 
PF_RDS


	)

116 
	#AF_SNA
 
PF_SNA


	)

117 
	#AF_IRDA
 
PF_IRDA


	)

118 
	#AF_PPPOX
 
PF_PPPOX


	)

119 
	#AF_WANPIPE
 
PF_WANPIPE


	)

120 
	#AF_LLC
 
PF_LLC


	)

121 
	#AF_IB
 
PF_IB


	)

122 
	#AF_MPLS
 
PF_MPLS


	)

123 
	#AF_CAN
 
PF_CAN


	)

124 
	#AF_TIPC
 
PF_TIPC


	)

125 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

126 
	#AF_IUCV
 
PF_IUCV


	)

127 
	#AF_RXRPC
 
PF_RXRPC


	)

128 
	#AF_ISDN
 
PF_ISDN


	)

129 
	#AF_PHONET
 
PF_PHONET


	)

130 
	#AF_IEEE802154
 
PF_IEEE802154


	)

131 
	#AF_CAIF
 
PF_CAIF


	)

132 
	#AF_ALG
 
PF_ALG


	)

133 
	#AF_NFC
 
PF_NFC


	)

134 
	#AF_VSOCK
 
PF_VSOCK


	)

135 
	#AF_KCM
 
PF_KCM


	)

136 
	#AF_QIPCRTR
 
PF_QIPCRTR


	)

137 
	#AF_SMC
 
PF_SMC


	)

138 
	#AF_MAX
 
PF_MAX


	)

144 
	#SOL_RAW
 255

	)

145 
	#SOL_DECNET
 261

	)

146 
	#SOL_X25
 262

	)

147 
	#SOL_PACKET
 263

	)

148 
	#SOL_ATM
 264

	)

149 
	#SOL_AAL
 265

	)

150 
	#SOL_IRDA
 266

	)

151 
	#SOL_NETBEUI
 267

	)

152 
	#SOL_LLC
 268

	)

153 
	#SOL_DCCP
 269

	)

154 
	#SOL_NETLINK
 270

	)

155 
	#SOL_TIPC
 271

	)

156 
	#SOL_RXRPC
 272

	)

157 
	#SOL_PPPOL2TP
 273

	)

158 
	#SOL_BLUETOOTH
 274

	)

159 
	#SOL_PNPIPE
 275

	)

160 
	#SOL_RDS
 276

	)

161 
	#SOL_IUCV
 277

	)

162 
	#SOL_CAIF
 278

	)

163 
	#SOL_ALG
 279

	)

164 
	#SOL_NFC
 280

	)

165 
	#SOL_KCM
 281

	)

166 
	#SOL_TLS
 282

	)

169 
	#SOMAXCONN
 128

	)

172 
	~<b™s/sockaddr.h
>

175 
	ssockaddr


177 
__SOCKADDR_COMMON
 (
§_
);

178 
	m§_d©a
[14];

184 
	#__ss_®igÁy³
 

	)

185 
	#_SS_PADSIZE
 \

186 (
_SS_SIZE
 - 
__SOCKADDR_COMMON_SIZE
 -  (
__ss_®igÁy³
))

	)

188 
	ssockaddr_¡Üage


190 
__SOCKADDR_COMMON
 (
ss_
);

191 
	m__ss_·ddšg
[
_SS_PADSIZE
];

192 
__ss_®igÁy³
 
	m__ss_®ign
;

199 
	mMSG_OOB
 = 0x01,

200 
	#MSG_OOB
 
MSG_OOB


	)

201 
	mMSG_PEEK
 = 0x02,

202 
	#MSG_PEEK
 
MSG_PEEK


	)

203 
	mMSG_DONTROUTE
 = 0x04,

204 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

205 #ifdeà
__USE_GNU


207 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

208 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

210 
	mMSG_CTRUNC
 = 0x08,

211 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

212 
	mMSG_PROXY
 = 0x10,

213 
	#MSG_PROXY
 
MSG_PROXY


	)

214 
	mMSG_TRUNC
 = 0x20,

215 
	#MSG_TRUNC
 
MSG_TRUNC


	)

216 
	mMSG_DONTWAIT
 = 0x40,

217 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

218 
	mMSG_EOR
 = 0x80,

219 
	#MSG_EOR
 
MSG_EOR


	)

220 
	mMSG_WAITALL
 = 0x100,

221 
	#MSG_WAITALL
 
MSG_WAITALL


	)

222 
	mMSG_FIN
 = 0x200,

223 
	#MSG_FIN
 
MSG_FIN


	)

224 
	mMSG_SYN
 = 0x400,

225 
	#MSG_SYN
 
MSG_SYN


	)

226 
	mMSG_CONFIRM
 = 0x800,

227 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

228 
	mMSG_RST
 = 0x1000,

229 
	#MSG_RST
 
MSG_RST


	)

230 
	mMSG_ERRQUEUE
 = 0x2000,

231 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

232 
	mMSG_NOSIGNAL
 = 0x4000,

233 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

234 
	mMSG_MORE
 = 0x8000,

235 
	#MSG_MORE
 
MSG_MORE


	)

236 
	mMSG_WAITFORONE
 = 0x10000,

237 
	#MSG_WAITFORONE
 
MSG_WAITFORONE


	)

238 
	mMSG_BATCH
 = 0x40000,

239 
	#MSG_BATCH
 
MSG_BATCH


	)

240 
	mMSG_ZEROCOPY
 = 0x4000000,

241 
	#MSG_ZEROCOPY
 
MSG_ZEROCOPY


	)

242 
	mMSG_FASTOPEN
 = 0x20000000,

243 
	#MSG_FASTOPEN
 
MSG_FASTOPEN


	)

245 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

248 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

254 
	smsghdr


256 *
	mmsg_Çme
;

257 
sockËn_t
 
	mmsg_Çm–’
;

259 
iovec
 *
	mmsg_iov
;

260 
size_t
 
	mmsg_iovËn
;

262 *
	mmsg_cÚŒŞ
;

263 
size_t
 
	mmsg_cÚŒŞËn
;

268 
	mmsg_æags
;

272 
	scmsghdr


274 
size_t
 
	mcmsg_Ën
;

279 
	mcmsg_Ëv–
;

280 
	mcmsg_ty³
;

281 #ià
__glibc_c99_æex¬r_avaabË


282 
__ex‹nsiÚ__
 
__cmsg_d©a
 
	m__æex¬r
;

287 #ià
__glibc_c99_æex¬r_avaabË


288 
	#CMSG_DATA
(
cmsg
è((cmsg)->
__cmsg_d©a
)

	)

290 
	#CMSG_DATA
(
cmsg
è((*è((
cmsghdr
 *è(cmsgè+ 1))

	)

292 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
è
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

293 
	#CMSG_FIRSTHDR
(
mhdr
) \

294 ((
size_t
è(
mhdr
)->
msg_cÚŒŞËn
 >ğ (
cmsghdr
) \

295 ? (
cmsghdr
 *è(
mhdr
)->
msg_cÚŒŞ
 : (cmsghd¸*è0)

	)

296 
	#CMSG_ALIGN
(
Ën
è((Ö’è+  (
size_t
) - 1) \

297 & (
size_t
è~( (size_tè- 1))

	)

298 
	#CMSG_SPACE
(
Ën
è(
	`CMSG_ALIGN
 (len) \

299 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

300 
	#CMSG_LEN
(
Ën
è(
	`CMSG_ALIGN
 ( (
cmsghdr
)è+ (Ën))

	)

302 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

303 
cmsghdr
 *
__cmsg
è
__THROW
;

304 #ifdeà
__USE_EXTERN_INLINES


305 #iâdeà
_EXTERN_INLINE


306 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

308 
_EXTERN_INLINE
 
cmsghdr
 *

309 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

311 ià((
size_t
è
__cmsg
->
cmsg_Ën
 <  (
cmsghdr
))

313  (
cmsghdr
 *) 0;

315 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

316 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Ën
));

317 ià((*è(
__cmsg
 + 1è> ((*è
__mhdr
->
msg_cÚŒŞ


318 + 
__mhdr
->
msg_cÚŒŞËn
)

319 || ((*è
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Ën
)

320 > ((*è
__mhdr
->
msg_cÚŒŞ
 + __mhdr->
msg_cÚŒŞËn
)))

322  (
cmsghdr
 *) 0;

323  
__cmsg
;

324 
	}
}

331 
	mSCM_RIGHTS
 = 0x01

332 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

333 #ifdeà
__USE_GNU


334 , 
	mSCM_CREDENTIALS
 = 0x02

335 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

339 #ifdeà
__USE_GNU


341 
	suüed


343 
pid_t
 
	mpid
;

344 
uid_t
 
	muid
;

345 
gid_t
 
	mgid
;

350 #iâdeà
__USE_MISC


351 #iâdeà
FIOGETOWN


352 
	#__SYS_SOCKET_H_undef_FIOGETOWN


	)

354 #iâdeà
FIOSETOWN


355 
	#__SYS_SOCKET_H_undef_FIOSETOWN


	)

357 #iâdeà
SIOCATMARK


358 
	#__SYS_SOCKET_H_undef_SIOCATMARK


	)

360 #iâdeà
SIOCGPGRP


361 
	#__SYS_SOCKET_H_undef_SIOCGPGRP


	)

363 #iâdeà
SIOCGSTAMP


364 
	#__SYS_SOCKET_H_undef_SIOCGSTAMP


	)

366 #iâdeà
SIOCGSTAMPNS


367 
	#__SYS_SOCKET_H_undef_SIOCGSTAMPNS


	)

369 #iâdeà
SIOCSPGRP


370 
	#__SYS_SOCKET_H_undef_SIOCSPGRP


	)

373 #iâdeà
IOCSIZE_MASK


374 
	#__SYS_SOCKET_H_undef_IOCSIZE_MASK


	)

376 #iâdeà
IOCSIZE_SHIFT


377 
	#__SYS_SOCKET_H_undef_IOCSIZE_SHIFT


	)

379 #iâdeà
IOC_IN


380 
	#__SYS_SOCKET_H_undef_IOC_IN


	)

382 #iâdeà
IOC_INOUT


383 
	#__SYS_SOCKET_H_undef_IOC_INOUT


	)

385 #iâdeà
IOC_OUT


386 
	#__SYS_SOCKET_H_undef_IOC_OUT


	)

390 
	~<asm/sock‘.h
>

392 #iâdeà
__USE_MISC


393 #ifdeà
__SYS_SOCKET_H_undef_FIOGETOWN


394 #undeà
__SYS_SOCKET_H_undef_FIOGETOWN


395 #undeà
FIOGETOWN


397 #ifdeà
__SYS_SOCKET_H_undef_FIOSETOWN


398 #undeà
__SYS_SOCKET_H_undef_FIOSETOWN


399 #undeà
FIOSETOWN


401 #ifdeà
__SYS_SOCKET_H_undef_SIOCATMARK


402 #undeà
__SYS_SOCKET_H_undef_SIOCATMARK


403 #undeà
SIOCATMARK


405 #ifdeà
__SYS_SOCKET_H_undef_SIOCGPGRP


406 #undeà
__SYS_SOCKET_H_undef_SIOCGPGRP


407 #undeà
SIOCGPGRP


409 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


410 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


411 #undeà
SIOCGSTAMP


413 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


414 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


415 #undeà
SIOCGSTAMPNS


417 #ifdeà
__SYS_SOCKET_H_undef_SIOCSPGRP


418 #undeà
__SYS_SOCKET_H_undef_SIOCSPGRP


419 #undeà
SIOCSPGRP


422 #ifdeà
__SYS_SOCKET_H_undef_IOCSIZE_MASK


423 #undeà
__SYS_SOCKET_H_undef_IOCSIZE_MASK


424 #undeà
IOCSIZE_MASK


426 #ifdeà
__SYS_SOCKET_H_undef_IOCSIZE_SHIFT


427 #undeà
__SYS_SOCKET_H_undef_IOCSIZE_SHIFT


428 #undeà
IOCSIZE_SHIFT


430 #ifdeà
__SYS_SOCKET_H_undef_IOC_IN


431 #undeà
__SYS_SOCKET_H_undef_IOC_IN


432 #undeà
IOC_IN


434 #ifdeà
__SYS_SOCKET_H_undef_IOC_INOUT


435 #undeà
__SYS_SOCKET_H_undef_IOC_INOUT


436 #undeà
IOC_INOUT


438 #ifdeà
__SYS_SOCKET_H_undef_IOC_OUT


439 #undeà
__SYS_SOCKET_H_undef_IOC_OUT


440 #undeà
IOC_OUT


444 
	slšg”


446 
	ml_Úoff
;

447 
	ml_lšg”
;

	@/usr/include/bits/socket2.h

19 #iâdeà
_SYS_SOCKET_H


23 
ssize_t
 
__»cv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

24 
__æags
);

25 
ssize_t
 
__REDIRECT
 (
__»cv_®Ÿs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

26 
__æags
), 
»cv
);

27 
ssize_t
 
__REDIRECT
 (
__»cv_chk_w¬n
,

28 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

29 
__æags
), 
__»cv_chk
)

30 
__w¬Ç‰r
 ("recv called with bigger†engthhan size of destination "

33 
__fÜtify_funùiÚ
 
ssize_t


34 
	$»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
)

36 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

38 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

39  
	`__»cv_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

41 ià(
__n
 > 
	`__bos0
 (
__buf
))

42  
	`__»cv_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

44  
	`__»cv_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
);

45 
	}
}

47 
ssize_t
 
__»cväom_chk
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

48 
size_t
 
__buæ’
, 
__æags
,

49 
__SOCKADDR_ARG
 
__addr
,

50 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

51 
ssize_t
 
__REDIRECT
 (
__»cväom_®Ÿs
,

52 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

53 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

54 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
»cväom
);

55 
ssize_t
 
__REDIRECT
 (
__»cväom_chk_w¬n
,

56 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

57 
size_t
 
__buæ’
, 
__æags
,

58 
__SOCKADDR_ARG
 
__addr
,

59 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
__»cväom_chk
)

60 
__w¬Ç‰r
 ("recvfrom called with bigger†engthhan size of "

63 
__fÜtify_funùiÚ
 
ssize_t


64 
	$»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
, 
__æags
,

65 
__SOCKADDR_ARG
 
__addr
, 
sockËn_t
 *
__»¡riù
 
__addr_Ën
)

67 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

69 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

70  
	`__»cväom_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

71 
__addr
, 
__addr_Ën
);

72 ià(
__n
 > 
	`__bos0
 (
__buf
))

73  
	`__»cväom_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

74 
__addr
, 
__addr_Ën
);

76  
	`__»cväom_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
, 
__addr
, 
__addr_Ën
);

77 
	}
}

	@/usr/include/bits/ss_flags.h

19 #iâdeà
_BITS_SS_FLAGS_H


20 
	#_BITS_SS_FLAGS_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_SYS_UCONTEXT_H


29 
	mSS_ONSTACK
 = 1,

30 
	#SS_ONSTACK
 
SS_ONSTACK


	)

31 
	mSS_DISABLE


32 
	#SS_DISABLE
 
SS_DISABLE


	)

	@/usr/include/bits/stat.h

18 #ià!
defšed
 
_SYS_STAT_H
 && !defšed 
_FCNTL_H


22 #iâdeà
_BITS_STAT_H


23 
	#_BITS_STAT_H
 1

	)

26 #iâdeà
__x86_64__


27 
	#_STAT_VER_LINUX_OLD
 1

	)

28 
	#_STAT_VER_KERNEL
 1

	)

29 
	#_STAT_VER_SVR4
 2

	)

30 
	#_STAT_VER_LINUX
 3

	)

33 
	#_MKNOD_VER_LINUX
 1

	)

34 
	#_MKNOD_VER_SVR4
 2

	)

35 
	#_MKNOD_VER
 
_MKNOD_VER_LINUX


	)

37 
	#_STAT_VER_KERNEL
 0

	)

38 
	#_STAT_VER_LINUX
 1

	)

41 
	#_MKNOD_VER_LINUX
 0

	)

44 
	#_STAT_VER
 
_STAT_VER_LINUX


	)

46 
	s¡©


48 
__dev_t
 
	m¡_dev
;

49 #iâdeà
__x86_64__


50 
	m__·d1
;

52 #ià
defšed
 
__x86_64__
 || !defšed 
__USE_FILE_OFFSET64


53 
__šo_t
 
	m¡_šo
;

55 
__šo_t
 
	m__¡_šo
;

57 #iâdeà
__x86_64__


58 
__mode_t
 
	m¡_mode
;

59 
__Æšk_t
 
	m¡_Æšk
;

61 
__Æšk_t
 
	m¡_Æšk
;

62 
__mode_t
 
	m¡_mode
;

64 
__uid_t
 
	m¡_uid
;

65 
__gid_t
 
	m¡_gid
;

66 #ifdeà
__x86_64__


67 
	m__·d0
;

69 
__dev_t
 
	m¡_rdev
;

70 #iâdeà
__x86_64__


71 
	m__·d2
;

73 #ià
defšed
 
__x86_64__
 || !defšed 
__USE_FILE_OFFSET64


74 
__off_t
 
	m¡_size
;

76 
__off64_t
 
	m¡_size
;

78 
__blksize_t
 
	m¡_blksize
;

79 #ià
defšed
 
__x86_64__
 || !defšed 
__USE_FILE_OFFSET64


80 
__blkút_t
 
	m¡_blocks
;

82 
__blkút64_t
 
	m¡_blocks
;

84 #ifdeà
__USE_XOPEN2K8


91 
time¥ec
 
	m¡_©im
;

92 
time¥ec
 
	m¡_mtim
;

93 
time¥ec
 
	m¡_ùim
;

94 
	#¡_©ime
 
¡_©im
.
tv_£c


	)

95 
	#¡_mtime
 
¡_mtim
.
tv_£c


	)

96 
	#¡_ùime
 
¡_ùim
.
tv_£c


	)

98 
__time_t
 
	m¡_©ime
;

99 
__sysÿÎ_ulÚg_t
 
	m¡_©im’£c
;

100 
__time_t
 
	m¡_mtime
;

101 
__sysÿÎ_ulÚg_t
 
	m¡_mtim’£c
;

102 
__time_t
 
	m¡_ùime
;

103 
__sysÿÎ_ulÚg_t
 
	m¡_ùim’£c
;

105 #ifdeà
__x86_64__


106 
__sysÿÎ_¦Úg_t
 
	m__glibc_»£rved
[3];

108 #iâdeà
__USE_FILE_OFFSET64


109 
	m__glibc_»£rved4
;

110 
	m__glibc_»£rved5
;

112 
__šo64_t
 
	m¡_šo
;

117 #ifdeà
__USE_LARGEFILE64


119 
	s¡©64


121 
__dev_t
 
	m¡_dev
;

122 #ifdeà
__x86_64__


123 
__šo64_t
 
	m¡_šo
;

124 
__Æšk_t
 
	m¡_Æšk
;

125 
__mode_t
 
	m¡_mode
;

127 
	m__·d1
;

128 
__šo_t
 
	m__¡_šo
;

129 
__mode_t
 
	m¡_mode
;

130 
__Æšk_t
 
	m¡_Æšk
;

132 
__uid_t
 
	m¡_uid
;

133 
__gid_t
 
	m¡_gid
;

134 #ifdeà
__x86_64__


135 
	m__·d0
;

136 
__dev_t
 
	m¡_rdev
;

137 
__off_t
 
	m¡_size
;

139 
__dev_t
 
	m¡_rdev
;

140 
	m__·d2
;

141 
__off64_t
 
	m¡_size
;

143 
__blksize_t
 
	m¡_blksize
;

144 
__blkút64_t
 
	m¡_blocks
;

145 #ifdeà
__USE_XOPEN2K8


152 
time¥ec
 
	m¡_©im
;

153 
time¥ec
 
	m¡_mtim
;

154 
time¥ec
 
	m¡_ùim
;

156 
__time_t
 
	m¡_©ime
;

157 
__sysÿÎ_ulÚg_t
 
	m¡_©im’£c
;

158 
__time_t
 
	m¡_mtime
;

159 
__sysÿÎ_ulÚg_t
 
	m¡_mtim’£c
;

160 
__time_t
 
	m¡_ùime
;

161 
__sysÿÎ_ulÚg_t
 
	m¡_ùim’£c
;

163 #ifdeà
__x86_64__


164 
__sysÿÎ_¦Úg_t
 
	m__glibc_»£rved
[3];

166 
__šo64_t
 
	m¡_šo
;

172 
	#_STATBUF_ST_BLKSIZE


	)

173 
	#_STATBUF_ST_RDEV


	)

175 
	#_STATBUF_ST_NSEC


	)

179 
	#__S_IFMT
 0170000

	)

182 
	#__S_IFDIR
 0040000

	)

183 
	#__S_IFCHR
 0020000

	)

184 
	#__S_IFBLK
 0060000

	)

185 
	#__S_IFREG
 0100000

	)

186 
	#__S_IFIFO
 0010000

	)

187 
	#__S_IFLNK
 0120000

	)

188 
	#__S_IFSOCK
 0140000

	)

192 
	#__S_TYPEISMQ
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

193 
	#__S_TYPEISSEM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

194 
	#__S_TYPEISSHM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

198 
	#__S_ISUID
 04000

	)

199 
	#__S_ISGID
 02000

	)

200 
	#__S_ISVTX
 01000

	)

201 
	#__S_IREAD
 0400

	)

202 
	#__S_IWRITE
 0200

	)

203 
	#__S_IEXEC
 0100

	)

205 #ifdeà
__USE_ATFILE


206 
	#UTIME_NOW
 ((1È<< 30è- 1l)

	)

207 
	#UTIME_OMIT
 ((1È<< 30è- 2l)

	)

	@/usr/include/bits/stdint-intn.h

19 #iâdeà
_BITS_STDINT_INTN_H


20 
	#_BITS_STDINT_INTN_H
 1

	)

22 
	~<b™s/ty³s.h
>

24 
__št8_t
 
	tšt8_t
;

25 
__št16_t
 
	tšt16_t
;

26 
__št32_t
 
	tšt32_t
;

27 
__št64_t
 
	tšt64_t
;

	@/usr/include/bits/stdint-uintn.h

19 #iâdeà
_BITS_STDINT_UINTN_H


20 
	#_BITS_STDINT_UINTN_H
 1

	)

22 
	~<b™s/ty³s.h
>

24 
__ušt8_t
 
	tušt8_t
;

25 
__ušt16_t
 
	tušt16_t
;

26 
__ušt32_t
 
	tušt32_t
;

27 
__ušt64_t
 
	tušt64_t
;

	@/usr/include/bits/stdio-ldbl.h

19 #iâdeà
_STDIO_H


23 
	$__LDBL_REDIR_DECL
 (
årštf
)

24 
	$__LDBL_REDIR_DECL
 (
´štf
)

25 
	$__LDBL_REDIR_DECL
 (
¥rštf
)

26 
	$__LDBL_REDIR_DECL
 (
vårštf
)

27 
	$__LDBL_REDIR_DECL
 (
v´štf
)

28 
	$__LDBL_REDIR_DECL
 (
v¥rštf
)

29 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

30 && !
defšed
 
__REDIRECT
 \

31 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

32 
	$__LDBL_REDIR1_DECL
 (
fsÿnf
, 
__Ædbl___isoc99_fsÿnf
)

33 
	$__LDBL_REDIR1_DECL
 (
sÿnf
, 
__Ædbl___isoc99_sÿnf
)

34 
	$__LDBL_REDIR1_DECL
 (
ssÿnf
, 
__Ædbl___isoc99_ssÿnf
)

36 
	$__LDBL_REDIR_DECL
 (
fsÿnf
)

37 
	$__LDBL_REDIR_DECL
 (
sÿnf
)

38 
	$__LDBL_REDIR_DECL
 (
ssÿnf
)

41 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


42 
	$__LDBL_REDIR_DECL
 (
¢´štf
)

43 
	$__LDBL_REDIR_DECL
 (
v¢´štf
)

46 #ifdef 
__USE_ISOC99


47 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

48 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

49 
	$__LDBL_REDIR1_DECL
 (
vfsÿnf
, 
__Ædbl___isoc99_vfsÿnf
)

50 
	$__LDBL_REDIR1_DECL
 (
vsÿnf
, 
__Ædbl___isoc99_vsÿnf
)

51 
	$__LDBL_REDIR1_DECL
 (
vssÿnf
, 
__Ædbl___isoc99_vssÿnf
)

53 
	$__LDBL_REDIR_DECL
 (
vfsÿnf
)

54 
	$__LDBL_REDIR_DECL
 (
vssÿnf
)

55 
	$__LDBL_REDIR_DECL
 (
vsÿnf
)

59 #ifdeà
__USE_XOPEN2K8


60 
	$__LDBL_REDIR_DECL
 (
vd´štf
)

61 
	$__LDBL_REDIR_DECL
 (
d´štf
)

64 #ifdeà
__USE_GNU


65 
	$__LDBL_REDIR_DECL
 (
va¥rštf
)

66 
	$__LDBL_REDIR_DECL
 (
__a¥rštf
)

67 
	$__LDBL_REDIR_DECL
 (
a¥rštf
)

68 
	$__LDBL_REDIR_DECL
 (
ob¡ack_´štf
)

69 
	$__LDBL_REDIR_DECL
 (
ob¡ack_v´štf
)

72 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


73 
	$__LDBL_REDIR_DECL
 (
__¥rštf_chk
)

74 
	$__LDBL_REDIR_DECL
 (
__v¥rštf_chk
)

75 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


76 
	$__LDBL_REDIR_DECL
 (
__¢´štf_chk
)

77 
	$__LDBL_REDIR_DECL
 (
__v¢´štf_chk
)

79 #ià
__USE_FORTIFY_LEVEL
 > 1

80 
	$__LDBL_REDIR_DECL
 (
__årštf_chk
)

81 
	$__LDBL_REDIR_DECL
 (
__´štf_chk
)

82 
	$__LDBL_REDIR_DECL
 (
__vårštf_chk
)

83 
	$__LDBL_REDIR_DECL
 (
__v´štf_chk
)

84 #ifdeà
__USE_XOPEN2K8


85 
	$__LDBL_REDIR_DECL
 (
__d´štf_chk
)

86 
	$__LDBL_REDIR_DECL
 (
__vd´štf_chk
)

88 #ifdeà
__USE_GNU


89 
	$__LDBL_REDIR_DECL
 (
__a¥rštf_chk
)

90 
	$__LDBL_REDIR_DECL
 (
__va¥rštf_chk
)

91 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_´štf_chk
)

92 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_v´štf_chk
)

	@/usr/include/bits/stdio.h

19 #iâdeà
_STDIO_H


23 #iâdeà
__ex‹º_šlše


24 
	#__STDIO_INLINE
 
šlše


	)

26 
	#__STDIO_INLINE
 
__ex‹º_šlše


	)

30 #ifdeà
__USE_EXTERN_INLINES


33 #ià!(
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
)

35 
__STDIO_INLINE
 

36 
	$v´štf
 (cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

38  
	`vårštf
 (
¡dout
, 
__fmt
, 
__¬g
);

39 
	}
}

43 
__STDIO_INLINE
 

44 
	$g‘ch¬
 ()

46  
	`_IO_g‘c
 (
¡dš
);

47 
	}
}

50 #ifdeà
__USE_MISC


52 
__STDIO_INLINE
 

53 
	$fg‘c_uÆocked
 (
FILE
 *
__å
)

55  
	`_IO_g‘c_uÆocked
 (
__å
);

56 
	}
}

60 #ifdeà
__USE_POSIX


62 
__STDIO_INLINE
 

63 
	$g‘c_uÆocked
 (
FILE
 *
__å
)

65  
	`_IO_g‘c_uÆocked
 (
__å
);

66 
	}
}

69 
__STDIO_INLINE
 

70 
	$g‘ch¬_uÆocked
 ()

72  
	`_IO_g‘c_uÆocked
 (
¡dš
);

73 
	}
}

78 
__STDIO_INLINE
 

79 
	$putch¬
 (
__c
)

81  
	`_IO_putc
 (
__c
, 
¡dout
);

82 
	}
}

85 #ifdeà
__USE_MISC


87 
__STDIO_INLINE
 

88 
	$åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

90  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

91 
	}
}

95 #ifdeà
__USE_POSIX


97 
__STDIO_INLINE
 

98 
	$putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

100  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

101 
	}
}

104 
__STDIO_INLINE
 

105 
	$putch¬_uÆocked
 (
__c
)

107  
	`_IO_putc_uÆocked
 (
__c
, 
¡dout
);

108 
	}
}

112 #ifdef 
__USE_GNU


114 
__STDIO_INLINE
 
_IO_ssize_t


115 
	$g‘lše
 (**
__lš•Œ
, 
size_t
 *
__n
, 
FILE
 *
__¡»am
)

117  
	`__g‘d–im
 (
__lš•Œ
, 
__n
, '\n', 
__¡»am
);

118 
	}
}

122 #ifdeà
__USE_MISC


124 
__STDIO_INLINE
 

125 
__NTH
 (
	$ãof_uÆocked
 (
FILE
 *
__¡»am
))

127  
	`_IO_ãof_uÆocked
 (
__¡»am
);

128 
	}
}

131 
__STDIO_INLINE
 

132 
__NTH
 (
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
))

134  
	`_IO_ã¼Ü_uÆocked
 (
__¡»am
);

135 
	}
}

141 #ià
defšed
 
__USE_MISC
 && defšed 
__GNUC__
 && defšed 
__OPTIMIZE__
 \

142 && !
defšed
 
	g__ılu¥lus


144 
	#ä—d_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

145 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

146 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

147 && (
size_t
è(
size
) != 0) \

148 ? ({ *
__±r
 = (*è(
±r
); \

149 
FILE
 *
__¡»am
 = (
¡»am
); \

150 
size_t
 
__út
; \

151 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

152 
__út
 > 0; --__cnt) \

154 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
); \

155 ià(
__c
 =ğ
EOF
) \

157 *
__±r
++ = 
__c
; \

159 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

160 / (
size_t
è(
size
); }) \

161 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

162 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

164 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

165 (è(
n
), (
size_t
) 0) \

166 : 
	`ä—d_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

168 
	#fwr™e_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

169 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

170 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

171 && (
size_t
è(
size
) != 0) \

172 ? ({ cÚ¡ *
__±r
 = (cÚ¡ *è(
±r
); \

173 
FILE
 *
__¡»am
 = (
¡»am
); \

174 
size_t
 
__út
; \

175 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

176 
__út
 > 0; --__cnt) \

177 ià(
	`_IO_putc_uÆocked
 (*
__±r
++, 
__¡»am
è=ğ
EOF
) \

179 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

180 / (
size_t
è(
size
); }) \

181 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

182 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

184 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

185 (è(
n
), (
size_t
) 0) \

186 : 
	`fwr™e_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

190 #undeà
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

19 #iâdeà
_STDIO_H


23 
	$__¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

24 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

25 
	$__v¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

26 cÚ¡ *
__»¡riù
 
__fÜm©
,

27 
_G_va_li¡
 
__­
è
__THROW
;

29 #ifdeà
__va_¬g_·ck


30 
__fÜtify_funùiÚ
 

31 
	`__NTH
 (
	$¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fmt
, ...))

33  
	`__butš___¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

34 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

35 
	}
}

36 #–ià!
defšed
 
__ılu¥lus


37 
	#¥rštf
(
¡r
, ...) \

38 
	`__butš___¥rštf_chk
 (
¡r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

39 
__VA_ARGS__
)

	)

42 
__fÜtify_funùiÚ
 

43 
__NTH
 (
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fmt
,

44 
_G_va_li¡
 
__­
))

46  
	`__butš___v¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

47 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

48 
	}
}

50 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


52 
	$__¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

53 
size_t
 
__¦’
, cÚ¡ *
__»¡riù
 
__fÜm©
,

54 ...è
__THROW
;

55 
	$__v¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

56 
size_t
 
__¦’
, cÚ¡ *
__»¡riù
 
__fÜm©
,

57 
_G_va_li¡
 
__­
è
__THROW
;

59 #ifdeà
__va_¬g_·ck


60 
__fÜtify_funùiÚ
 

61 
	`__NTH
 (
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

62 cÚ¡ *
__»¡riù
 
__fmt
, ...))

64  
	`__butš___¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

65 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

66 
	}
}

67 #–ià!
defšed
 
__ılu¥lus


68 
	#¢´štf
(
¡r
, 
Ën
, ...) \

69 
	`__butš___¢´štf_chk
 (
¡r
, 
Ën
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

70 
__VA_ARGS__
)

	)

73 
__fÜtify_funùiÚ
 

74 
__NTH
 (
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

75 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

77  
	`__butš___v¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

78 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

79 
	}
}

83 #ià
__USE_FORTIFY_LEVEL
 > 1

85 
__årštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

86 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

87 
__´štf_chk
 (
__æag
, cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

88 
__vårštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

89 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__­
);

90 
__v´štf_chk
 (
__æag
, cÚ¡ *
__»¡riù
 
__fÜm©
,

91 
_G_va_li¡
 
__­
);

93 #ifdeà
__va_¬g_·ck


94 
__fÜtify_funùiÚ
 

95 
	$årštf
 (
FILE
 *
__»¡riù
 
__¡»am
, cÚ¡ *__»¡riù 
__fmt
, ...)

97  
	`__årštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

98 
	`__va_¬g_·ck
 ());

99 
	}
}

101 
__fÜtify_funùiÚ
 

102 
	$´štf
 (cÚ¡ *
__»¡riù
 
__fmt
, ...)

104  
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

105 
	}
}

106 #–ià!
defšed
 
__ılu¥lus


107 
	#´štf
(...) \

108 
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

109 
	#årštf
(
¡»am
, ...) \

110 
	`__årštf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

113 
__fÜtify_funùiÚ
 

114 
	$v´štf
 (cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

116 #ifdeà
__USE_EXTERN_INLINES


117  
	`__vårštf_chk
 (
¡dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

119  
	`__v´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

121 
	}
}

123 
__fÜtify_funùiÚ
 

124 
	$vårštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

125 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

127  
	`__vårštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

128 
	}
}

130 #ifdeà
__USE_XOPEN2K8


131 
	$__d´štf_chk
 (
__fd
, 
__æag
, cÚ¡ *
__»¡riù
 
__fmt
,

132 ...è
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

133 
	$__vd´štf_chk
 (
__fd
, 
__æag
,

134 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

135 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

137 #ifdeà
__va_¬g_·ck


138 
__fÜtify_funùiÚ
 

139 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

141  
	`__d´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

142 
	`__va_¬g_·ck
 ());

143 
	}
}

144 #–ià!
defšed
 
__ılu¥lus


145 
	#d´štf
(
fd
, ...) \

146 
	`__d´štf_chk
 (
fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

149 
__fÜtify_funùiÚ
 

150 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

152  
	`__vd´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

153 
	}
}

156 #ifdeà
__USE_GNU


158 
	$__a¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

159 cÚ¡ *
__»¡riù
 
__fmt
, ...)

160 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 4))è
__wur
;

161 
	$__va¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

162 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

163 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 0))è
__wur
;

164 
	$__ob¡ack_´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

165 
__æag
, cÚ¡ *
__»¡riù
 
__fÜm©
,

167 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

168 
	$__ob¡ack_v´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

169 
__æag
,

170 cÚ¡ *
__»¡riù
 
__fÜm©
,

171 
_G_va_li¡
 
__¬gs
)

172 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

174 #ifdeà
__va_¬g_·ck


175 
__fÜtify_funùiÚ
 

176 
	`__NTH
 (
	$a¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__fmt
, ...))

178  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

179 
	`__va_¬g_·ck
 ());

180 
	}
}

182 
__fÜtify_funùiÚ
 

183 
__NTH
 (
	$__a¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__fmt
,

186  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

187 
	`__va_¬g_·ck
 ());

188 
	}
}

190 
__fÜtify_funùiÚ
 

191 
__NTH
 (
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

192 cÚ¡ *
__»¡riù
 
__fmt
, ...))

194  
	`__ob¡ack_´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

195 
	`__va_¬g_·ck
 ());

196 
	}
}

197 #–ià!
defšed
 
__ılu¥lus


198 
	#a¥rštf
(
±r
, ...) \

199 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

200 
	#__a¥rštf
(
±r
, ...) \

201 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

202 
	#ob¡ack_´štf
(
ob¡ack
, ...) \

203 
	`__ob¡ack_´štf_chk
 (
ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

206 
__fÜtify_funùiÚ
 

207 
__NTH
 (
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__fmt
,

208 
_G_va_li¡
 
__­
))

210  
	`__va¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

211 
	}
}

213 
__fÜtify_funùiÚ
 

214 
__NTH
 (
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

215 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

217  
	`__ob¡ack_v´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

218 
__­
);

219 
	}
}

225 #ià
__GLIBC_USE
 (
DEPRECATED_GETS
)

226 *
	$__g‘s_chk
 (*
__¡r
, 
size_t
è
__wur
;

227 *
	`__REDIRECT
 (
__g‘s_w¬n
, (*
__¡r
), 
g‘s
)

228 
__wur
 
	`__w¬Ç‰r
 ("please use fgets or getline instead, gets can't "

231 
__fÜtify_funùiÚ
 
__wur
 *

232 
	$g‘s
 (*
__¡r
)

234 ià(
	`__bos
 (
__¡r
è!ğ(
size_t
) -1)

235  
	`__g‘s_chk
 (
__¡r
, 
	`__bos
 (__str));

236  
	`__g‘s_w¬n
 (
__¡r
);

237 
	}
}

240 *
	$__fg‘s_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

241 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

242 *
	`__REDIRECT
 (
__fg‘s_®Ÿs
,

243 (*
__»¡riù
 
__s
, 
__n
,

244 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s
è
__wur
;

245 *
	`__REDIRECT
 (
__fg‘s_chk_w¬n
,

246 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

247 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_chk
)

248 
__wur
 
	`__w¬Ç‰r
 ("fgets called with bigger sizehan†ength "

251 
__fÜtify_funùiÚ
 
__wur
 *

252 
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

254 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

256 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

257  
	`__fg‘s_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

259 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

260  
	`__fg‘s_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

262  
	`__fg‘s_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

263 
	}
}

265 
size_t
 
	$__ä—d_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

266 
size_t
 
__size
, size_ˆ
__n
,

267 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

268 
size_t
 
	`__REDIRECT
 (
__ä—d_®Ÿs
,

269 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

270 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

271 
ä—d
è
__wur
;

272 
size_t
 
	`__REDIRECT
 (
__ä—d_chk_w¬n
,

273 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

274 
size_t
 
__size
, size_ˆ
__n
,

275 
FILE
 *
__»¡riù
 
__¡»am
),

276 
__ä—d_chk
)

277 
__wur
 
	`__w¬Ç‰r
 ("fread called with bigger size *‚membhan†ength "

280 
__fÜtify_funùiÚ
 
__wur
 
size_t


281 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

282 
FILE
 *
__»¡riù
 
__¡»am
)

284 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

286 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

287 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

288 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

289  
	`__ä—d_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

291 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

292  
	`__ä—d_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

294  
	`__ä—d_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

295 
	}
}

297 #ifdeà
__USE_GNU


298 *
	$__fg‘s_uÆocked_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
,

299 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

300 *
	`__REDIRECT
 (
__fg‘s_uÆocked_®Ÿs
,

301 (*
__»¡riù
 
__s
, 
__n
,

302 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s_uÆocked
è
__wur
;

303 *
	`__REDIRECT
 (
__fg‘s_uÆocked_chk_w¬n
,

304 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

305 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_uÆocked_chk
)

306 
__wur
 
	`__w¬Ç‰r
 ("fgets_unlocked called with bigger sizehan†ength "

309 
__fÜtify_funùiÚ
 
__wur
 *

310 
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

312 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

314 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

315  
	`__fg‘s_uÆocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

317 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

318  
	`__fg‘s_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

320  
	`__fg‘s_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

321 
	}
}

324 #ifdeà
__USE_MISC


325 #undeà
ä—d_uÆocked


326 
size_t
 
	$__ä—d_uÆocked_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

327 
size_t
 
__size
, size_ˆ
__n
,

328 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

329 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_®Ÿs
,

330 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

331 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

332 
ä—d_uÆocked
è
__wur
;

333 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_chk_w¬n
,

334 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

335 
size_t
 
__size
, size_ˆ
__n
,

336 
FILE
 *
__»¡riù
 
__¡»am
),

337 
__ä—d_uÆocked_chk
)

338 
__wur
 
	`__w¬Ç‰r
 ("fread_unlocked called with bigger size *‚membhan "

341 
__fÜtify_funùiÚ
 
__wur
 
size_t


342 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

343 
FILE
 *
__»¡riù
 
__¡»am
)

345 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

347 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

348 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

349 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

350  
	`__ä—d_uÆocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

351 
__¡»am
);

353 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

354  
	`__ä—d_uÆocked_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

355 
__¡»am
);

358 #ifdeà
__USE_EXTERN_INLINES


359 ià(
	`__butš_cÚ¡ªt_p
 (
__size
)

360 && 
	`__butš_cÚ¡ªt_p
 (
__n
)

361 && (
__size
 | 
__n
è< (((
size_t
) 1) << (8 *  (size_t) / 2))

362 && 
__size
 * 
__n
 <= 8)

364 
size_t
 
__út
 = 
__size
 * 
__n
;

365 *
__ıŒ
 = (*è
__±r
;

366 ià(
__út
 == 0)

369 ; 
__út
 > 0; --__cnt)

371 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
);

372 ià(
__c
 =ğ
EOF
)

374 *
__ıŒ
++ = 
__c
;

376  (
__ıŒ
 - (*è
__±r
è/ 
__size
;

379  
	`__ä—d_uÆocked_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

380 
	}
}

	@/usr/include/bits/stdio_lim.h

18 #iâdeà
_BITS_STDIO_LIM_H


19 
	#_BITS_STDIO_LIM_H
 1

	)

21 #iâdeà
_STDIO_H


25 
	#L_tm²am
 20

	)

26 
	#TMP_MAX
 238328

	)

27 
	#FILENAME_MAX
 4096

	)

29 #ifdeà
__USE_POSIX


30 
	#L_ù”mid
 9

	)

31 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


32 
	#L_cu£rid
 9

	)

36 #undeà
FOPEN_MAX


37 
	#FOPEN_MAX
 16

	)

	@/usr/include/bits/stdlib-bsearch.h

19 
__ex‹º_šlše
 *

20 
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

21 
__com·r_â_t
 
__com·r
)

23 
size_t
 
__l
, 
__u
, 
__idx
;

24 cÚ¡ *
__p
;

25 
__com·risÚ
;

27 
__l
 = 0;

28 
__u
 = 
__nmemb
;

29 
__l
 < 
__u
)

31 
__idx
 = (
__l
 + 
__u
) / 2;

32 
__p
 = (*è(((cÚ¡ *è
__ba£
è+ (
__idx
 * 
__size
));

33 
__com·risÚ
 = (*
__com·r
è(
__key
, 
__p
);

34 ià(
__com·risÚ
 < 0)

35 
__u
 = 
__idx
;

36 ià(
__com·risÚ
 > 0)

37 
__l
 = 
__idx
 + 1;

39  (*è
__p
;

42  
NULL
;

43 
	}
}

	@/usr/include/bits/stdlib-float.h

19 #iâdeà
_STDLIB_H


23 #ifdeà
__USE_EXTERN_INLINES


24 
__ex‹º_šlše
 

25 
__NTH
 (
	$©of
 (cÚ¡ *
__ÅŒ
))

27  
	`¡¹od
 (
__ÅŒ
, (**è
NULL
);

28 
	}
}

	@/usr/include/bits/stdlib-ldbl.h

19 #iâdeà
_STDLIB_H


23 #ifdef 
__USE_ISOC99


24 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd
, 
¡¹od
)

27 #ifdeà
__USE_GNU


28 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd_l
, 
¡¹od_l
)

31 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

32 
	$__LDBL_REDIR1_DECL
 (
¡räoml
, 
¡räomd
)

35 #ifdeà
__USE_MISC


36 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

39 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

40 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

19 #iâdeà
_STDLIB_H


23 *
	$__»®·th_chk
 (cÚ¡ *
__»¡riù
 
__Çme
,

24 *
__»¡riù
 
__»sŞved
,

25 
size_t
 
__»sŞvedËn
è
__THROW
 
__wur
;

26 *
	`__REDIRECT_NTH
 (
__»®·th_®Ÿs
,

27 (cÚ¡ *
__»¡riù
 
__Çme
,

28 *
__»¡riù
 
__»sŞved
), 
»®·th
è
__wur
;

29 *
	`__REDIRECT_NTH
 (
__»®·th_chk_w¬n
,

30 (cÚ¡ *
__»¡riù
 
__Çme
,

31 *
__»¡riù
 
__»sŞved
,

32 
size_t
 
__»sŞvedËn
), 
__»®·th_chk
è
__wur


33 
	`__w¬Ç‰r
 ("second‡rgument of„ealpath must beƒither NULL or‡t "

36 
__fÜtify_funùiÚ
 
__wur
 *

37 
	`__NTH
 (
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
, *__»¡riù 
__»sŞved
))

39 ià(
	`__bos
 (
__»sŞved
è!ğ(
size_t
) -1)

41 #ià
defšed
 
_LIBC_LIMITS_H_
 && defšed 
PATH_MAX


42 ià(
	`__bos
 (
__»sŞved
è< 
PATH_MAX
)

43  
	`__»®·th_chk_w¬n
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

45  
	`__»®·th_chk
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

48  
	`__»®·th_®Ÿs
 (
__Çme
, 
__»sŞved
);

49 
	}
}

52 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

53 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

54 
	`__REDIRECT_NTH
 (
__±¢ame_r_®Ÿs
, (
__fd
, *
__buf
,

55 
size_t
 
__buæ’
), 
±¢ame_r
)

56 
	`__nÚnuÎ
 ((2));

57 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¬n
,

58 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

59 
size_t
 
__Ä—l
), 
__±¢ame_r_chk
)

60 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ptsname_r called with buflen biggerhan "

63 
__fÜtify_funùiÚ
 

64 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

66 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

68 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

69  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

70 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

71  
	`__±¢ame_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

73  
	`__±¢ame_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

74 
	}
}

77 
	$__wùomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
size_t
 
__buæ’
)

78 
__THROW
 
__wur
;

79 
	`__REDIRECT_NTH
 (
__wùomb_®Ÿs
, (*
__s
, 
wch¬_t
 
__wch¬
),

80 
wùomb
è
__wur
;

82 
__fÜtify_funùiÚ
 
__wur
 

83 
	`__NTH
 (
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
))

88 
	#__STDLIB_MB_LEN_MAX
 16

	)

89 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__STDLIB_MB_LEN_MAX


92 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

93  
	`__wùomb_chk
 (
__s
, 
__wch¬
, 
	`__bos
 (__s));

94  
	`__wùomb_®Ÿs
 (
__s
, 
__wch¬
);

95 
	}
}

98 
size_t
 
	$__mb¡owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

99 cÚ¡ *
__»¡riù
 
__¤c
,

100 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

101 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_®Ÿs
,

102 (
wch¬_t
 *
__»¡riù
 
__d¡
,

103 cÚ¡ *
__»¡riù
 
__¤c
,

104 
size_t
 
__Ën
), 
mb¡owcs
);

105 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_chk_w¬n
,

106 (
wch¬_t
 *
__»¡riù
 
__d¡
,

107 cÚ¡ *
__»¡riù
 
__¤c
,

108 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__mb¡owcs_chk
)

109 
	`__w¬Ç‰r
 ("mbstowcs called with dst buffer smallerhan†en "

112 
__fÜtify_funùiÚ
 
size_t


113 
	`__NTH
 (
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, cÚ¡ *__»¡riù 
__¤c
,

114 
size_t
 
__Ën
))

116 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

118 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

119  
	`__mb¡owcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
,

120 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

122 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

123  
	`__mb¡owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
,

124 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

126  
	`__mb¡owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

127 
	}
}

130 
size_t
 
	$__wc¡ombs_chk
 (*
__»¡riù
 
__d¡
,

131 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

132 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

133 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_®Ÿs
,

134 (*
__»¡riù
 
__d¡
,

135 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

136 
size_t
 
__Ën
), 
wc¡ombs
);

137 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_chk_w¬n
,

138 (*
__»¡riù
 
__d¡
,

139 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

140 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__wc¡ombs_chk
)

141 
	`__w¬Ç‰r
 ("wcstombs called with dst buffer smallerhan†en");

143 
__fÜtify_funùiÚ
 
size_t


144 
	`__NTH
 (
	$wc¡ombs
 (*
__»¡riù
 
__d¡
, cÚ¡ 
wch¬_t
 *__»¡riù 
__¤c
,

145 
size_t
 
__Ën
))

147 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

149 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

150  
	`__wc¡ombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

151 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

152  
	`__wc¡ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

154  
	`__wc¡ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

155 
	}
}

	@/usr/include/bits/string_fortified.h

18 #iâdeà
_BITS_STRING_FORTIFIED_H


19 
	#_BITS_STRING_FORTIFIED_H
 1

	)

21 #iâdeà
_STRING_H


25 #ià!
__GNUC_PREREQ
 (5,0)

26 
__w¬ndeş
 (
__w¬n_mem£t_z”o_Ën
,

30 
__fÜtify_funùiÚ
 *

31 
__NTH
 (
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

32 
size_t
 
__Ën
))

34  
	`__butš___memıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

35 
	}
}

37 
__fÜtify_funùiÚ
 *

38 
__NTH
 (
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__Ën
))

40  
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

41 
	}
}

43 #ifdeà
__USE_GNU


44 
__fÜtify_funùiÚ
 *

45 
__NTH
 (
	$mempıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

46 
size_t
 
__Ën
))

48  
	`__butš___mempıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

49 
	}
}

58 
__fÜtify_funùiÚ
 *

59 
__NTH
 (
	$mem£t
 (*
__de¡
, 
__ch
, 
size_t
 
__Ën
))

63 #ià!
	`__GNUC_PREREQ
 (5,0)

64 ià(
	`__butš_cÚ¡ªt_p
 (
__Ën
) && __len == 0

65 && (!
	`__butš_cÚ¡ªt_p
 (
__ch
) || __ch != 0))

67 
	`__w¬n_mem£t_z”o_Ën
 ();

68  
__de¡
;

71  
	`__butš___mem£t_chk
 (
__de¡
, 
__ch
, 
__Ën
, 
	`__bos0
 (__dest));

72 
	}
}

74 #ifdeà
__USE_MISC


75 
	~<b™s/¡ršgs_fÜtif›d.h
>

77 
	$__ex¶ic™_bz”o_chk
 (*
__de¡
, 
size_t
 
__Ën
, size_ˆ
__de¡Ën
)

78 
__THROW
 
	`__nÚnuÎ
 ((1));

80 
__fÜtify_funùiÚ
 

81 
	`__NTH
 (
	$ex¶ic™_bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

83 
	`__ex¶ic™_bz”o_chk
 (
__de¡
, 
__Ën
, 
	`__bos0
 (__dest));

84 
	}
}

87 
__fÜtify_funùiÚ
 *

88 
__NTH
 (
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

90  
	`__butš___¡rıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

91 
	}
}

93 #ifdeà
__USE_GNU


94 
__fÜtify_funùiÚ
 *

95 
__NTH
 (
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

97  
	`__butš___¡pıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

98 
	}
}

102 
__fÜtify_funùiÚ
 *

103 
__NTH
 (
	$¡ºıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

104 
size_t
 
__Ën
))

106  
	`__butš___¡ºıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

107 
	}
}

110 *
	$__¡²ıy_chk
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

111 
size_t
 
__de¡Ën
è
__THROW
;

112 *
	`__REDIRECT_NTH
 (
__¡²ıy_®Ÿs
, (*
__de¡
, cÚ¡ *
__¤c
,

113 
size_t
 
__n
), 
¡²ıy
);

115 
__fÜtify_funùiÚ
 *

116 
	`__NTH
 (
	$¡²ıy
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
))

118 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1

119 && (!
	`__butš_cÚ¡ªt_p
 (
__n
è|| __À> 
	`__bos
 (
__de¡
)))

120  
	`__¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
, 
	`__bos
 (__dest));

121  
	`__¡²ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

122 
	}
}

125 
__fÜtify_funùiÚ
 *

126 
__NTH
 (
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

128  
	`__butš___¡rÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

129 
	}
}

132 
__fÜtify_funùiÚ
 *

133 
__NTH
 (
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

134 
size_t
 
__Ën
))

136  
	`__butš___¡ºÿt_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

137 
	}
}

	@/usr/include/bits/strings_fortified.h

19 #iâdeà
__STRINGS_FORTIFIED


20 
	#__STRINGS_FORTIFIED
 1

	)

22 
__fÜtify_funùiÚ
 

23 
__NTH
 (
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__Ën
))

25 (è
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

26 
	}
}

28 
__fÜtify_funùiÚ
 

29 
__NTH
 (
	$bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

31 (è
	`__butš___mem£t_chk
 (
__de¡
, '\0', 
__Ën
, 
	`__bos0
 (__dest));

32 
	}
}

	@/usr/include/bits/stropts.h

18 #iâdeà
_STROPTS_H


22 #iâdeà
_BITS_STROPTS_H


23 
	#_BITS_STROPTS_H
 1

	)

25 
	~<b™s/ty³s.h
>

28 
	#__SID
 ('S' << 8)

	)

30 
	#I_NREAD
 (
__SID
 | 1è

	)

32 
	#I_PUSH
 (
__SID
 | 2è

	)

34 
	#I_POP
 (
__SID
 | 3è

	)

36 
	#I_LOOK
 (
__SID
 | 4è

	)

39 
	#I_FLUSH
 (
__SID
 | 5è

	)

40 
	#I_SRDOPT
 (
__SID
 | 6è

	)

41 
	#I_GRDOPT
 (
__SID
 | 7è

	)

42 
	#I_STR
 (
__SID
 | 8è

	)

44 
	#I_SETSIG
 (
__SID
 | 9è

	)

46 
	#I_GETSIG
 (
__SID
 |10è

	)

49 
	#I_FIND
 (
__SID
 |11è

	)

52 
	#I_LINK
 (
__SID
 |12è

	)

53 
	#I_UNLINK
 (
__SID
 |13è

	)

54 
	#I_PEEK
 (
__SID
 |15è

	)

58 
	#I_FDINSERT
 (
__SID
 |16è

	)

61 
	#I_SENDFD
 (
__SID
 |17è

	)

65 
	#I_RECVFD
 (
__SID
 |14è

	)

66 
	#I_SWROPT
 (
__SID
 |19è

	)

67 
	#I_GWROPT
 (
__SID
 |20è

	)

68 
	#I_LIST
 (
__SID
 |21è

	)

70 
	#I_PLINK
 (
__SID
 |22è

	)

72 
	#I_PUNLINK
 (
__SID
 |23è

	)

74 
	#I_FLUSHBAND
 (
__SID
 |28è

	)

75 
	#I_CKBAND
 (
__SID
 |29è

	)

78 
	#I_GETBAND
 (
__SID
 |30è

	)

80 
	#I_ATMARK
 (
__SID
 |31è

	)

83 
	#I_SETCLTIME
 (
__SID
 |32è

	)

86 
	#I_GETCLTIME
 (
__SID
 |33è

	)

87 
	#I_CANPUT
 (
__SID
 |34è

	)

91 
	#FMNAMESZ
 8

	)

94 
	#FLUSHR
 0x01

	)

95 
	#FLUSHW
 0x02

	)

96 
	#FLUSHRW
 0x03

	)

97 #ifdeà
__USE_GNU


98 
	#FLUSHBAND
 0x04

	)

102 
	#S_INPUT
 0x0001

	)

104 
	#S_HIPRI
 0x0002

	)

105 
	#S_OUTPUT
 0x0004

	)

107 
	#S_MSG
 0x0008

	)

110 
	#S_ERROR
 0x0010

	)

111 
	#S_HANGUP
 0x0020

	)

112 
	#S_RDNORM
 0x0040

	)

113 
	#S_WRNORM
 
S_OUTPUT


	)

114 
	#S_RDBAND
 0x0080

	)

116 
	#S_WRBAND
 0x0100

	)

118 
	#S_BANDURG
 0x0200

	)

124 
	#RS_HIPRI
 0x01

	)

127 
	#RNORM
 0x0000

	)

128 
	#RMSGD
 0x0001

	)

129 
	#RMSGN
 0x0002

	)

130 
	#RPROTDAT
 0x0004

	)

132 
	#RPROTDIS
 0x0008

	)

134 
	#RPROTNORM
 0x0010

	)

137 #ifdeà
__USE_GNU


138 
	#RPROTMASK
 0x001C

	)

142 
	#SNDZERO
 0x001

	)

144 #ifdeà
__USE_GNU


145 
	#SNDPIPE
 0x002

	)

150 
	#ANYMARK
 0x01

	)

151 
	#LASTMARK
 0x02

	)

155 #ifdeà
__USE_GNU


156 
	#MUXID_ALL
 (-1è

	)

162 
	#MSG_HIPRI
 0x01

	)

163 
	#MSG_ANY
 0x02

	)

164 
	#MSG_BAND
 0x04

	)

167 
	#MORECTL
 1

	)

169 
	#MOREDATA
 2

	)

173 
	sbªdšfo


175 
	mbi_´i
;

176 
	mbi_æag
;

179 
	s¡rbuf


181 
	mmaxËn
;

182 
	mËn
;

183 *
	mbuf
;

186 
	s¡½“k


188 
¡rbuf
 
	mùlbuf
;

189 
¡rbuf
 
	md©abuf
;

190 
t_usÿÏr_t
 
	mæags
;

193 
	s¡rfdš£¹


195 
¡rbuf
 
	mùlbuf
;

196 
¡rbuf
 
	md©abuf
;

197 
t_usÿÏr_t
 
	mæags
;

198 
	mfdes
;

199 
	moff£t
;

202 
	s¡rioùl


204 
	mic_cmd
;

205 
	mic_timout
;

206 
	mic_Ën
;

207 *
	mic_dp
;

210 
	s¡¼ecvfd


212 
	mfd
;

213 
uid_t
 
	muid
;

214 
gid_t
 
	mgid
;

215 
	m__fl
[8];

219 
	s¡r_mli¡


221 
	ml_Çme
[
FMNAMESZ
 + 1];

224 
	s¡r_li¡


226 
	m¦_nmods
;

227 
¡r_mli¡
 *
	m¦_modli¡
;

	@/usr/include/bits/sys_errlist.h

19 #iâdeà
_STDIO_H


25 #ifdeà 
__USE_MISC


26 
sys_Ã¼
;

27 cÚ¡ *cÚ¡ 
sys_”¾i¡
[];

29 #ifdeà 
__USE_GNU


30 
_sys_Ã¼
;

31 cÚ¡ *cÚ¡ 
_sys_”¾i¡
[];

	@/usr/include/bits/syscall.h

4 #iâdeà
_SYSCALL_H


8 
	#__GLIBC_LINUX_VERSION_CODE
 265728

	)

10 #ifdeà
__NR_FAST_©omic_upd©e


11 
	#SYS_FAST_©omic_upd©e
 
__NR_FAST_©omic_upd©e


	)

14 #ifdeà
__NR_FAST_cmpxchg


15 
	#SYS_FAST_cmpxchg
 
__NR_FAST_cmpxchg


	)

18 #ifdeà
__NR_FAST_cmpxchg64


19 
	#SYS_FAST_cmpxchg64
 
__NR_FAST_cmpxchg64


	)

22 #ifdeà
__NR__Î£ek


23 
	#SYS__Î£ek
 
__NR__Î£ek


	)

26 #ifdeà
__NR__Ãw£Ëù


27 
	#SYS__Ãw£Ëù
 
__NR__Ãw£Ëù


	)

30 #ifdeà
__NR__sysùl


31 
	#SYS__sysùl
 
__NR__sysùl


	)

34 #ifdeà
__NR_acû±


35 
	#SYS_acû±
 
__NR_acû±


	)

38 #ifdeà
__NR_acû±4


39 
	#SYS_acû±4
 
__NR_acû±4


	)

42 #ifdeà
__NR_acûss


43 
	#SYS_acûss
 
__NR_acûss


	)

46 #ifdeà
__NR_acù


47 
	#SYS_acù
 
__NR_acù


	)

50 #ifdeà
__NR_aş_g‘


51 
	#SYS_aş_g‘
 
__NR_aş_g‘


	)

54 #ifdeà
__NR_aş_£t


55 
	#SYS_aş_£t
 
__NR_aş_£t


	)

58 #ifdeà
__NR_add_key


59 
	#SYS_add_key
 
__NR_add_key


	)

62 #ifdeà
__NR_adjtimex


63 
	#SYS_adjtimex
 
__NR_adjtimex


	)

66 #ifdeà
__NR_afs_sysÿÎ


67 
	#SYS_afs_sysÿÎ
 
__NR_afs_sysÿÎ


	)

70 #ifdeà
__NR_®¬m


71 
	#SYS_®¬m
 
__NR_®¬m


	)

74 #ifdeà
__NR_®loc_hug•ages


75 
	#SYS_®loc_hug•ages
 
__NR_®loc_hug•ages


	)

78 #ifdeà
__NR_¬ch_´ùl


79 
	#SYS_¬ch_´ùl
 
__NR_¬ch_´ùl


	)

82 #ifdeà
__NR_¬m_çdvi£64_64


83 
	#SYS_¬m_çdvi£64_64
 
__NR_¬m_çdvi£64_64


	)

86 #ifdeà
__NR_¬m_sync_fe_¿nge


87 
	#SYS_¬m_sync_fe_¿nge
 
__NR_¬m_sync_fe_¿nge


	)

90 #ifdeà
__NR_©omic_b¬r›r


91 
	#SYS_©omic_b¬r›r
 
__NR_©omic_b¬r›r


	)

94 #ifdeà
__NR_©omic_cmpxchg_32


95 
	#SYS_©omic_cmpxchg_32
 
__NR_©omic_cmpxchg_32


	)

98 #ifdeà
__NR_©Œùl


99 
	#SYS_©Œùl
 
__NR_©Œùl


	)

102 #ifdeà
__NR_bdæush


103 
	#SYS_bdæush
 
__NR_bdæush


	)

106 #ifdeà
__NR_bšd


107 
	#SYS_bšd
 
__NR_bšd


	)

110 #ifdeà
__NR_bpf


111 
	#SYS_bpf
 
__NR_bpf


	)

114 #ifdeà
__NR_b»ak


115 
	#SYS_b»ak
 
__NR_b»ak


	)

118 #ifdeà
__NR_brk


119 
	#SYS_brk
 
__NR_brk


	)

122 #ifdeà
__NR_ÿcheùl


123 
	#SYS_ÿcheùl
 
__NR_ÿcheùl


	)

126 #ifdeà
__NR_ÿcheæush


127 
	#SYS_ÿcheæush
 
__NR_ÿcheæush


	)

130 #ifdeà
__NR_ÿpg‘


131 
	#SYS_ÿpg‘
 
__NR_ÿpg‘


	)

134 #ifdeà
__NR_ÿp£t


135 
	#SYS_ÿp£t
 
__NR_ÿp£t


	)

138 #ifdeà
__NR_chdœ


139 
	#SYS_chdœ
 
__NR_chdœ


	)

142 #ifdeà
__NR_chmod


143 
	#SYS_chmod
 
__NR_chmod


	)

146 #ifdeà
__NR_chown


147 
	#SYS_chown
 
__NR_chown


	)

150 #ifdeà
__NR_chown32


151 
	#SYS_chown32
 
__NR_chown32


	)

154 #ifdeà
__NR_chroÙ


155 
	#SYS_chroÙ
 
__NR_chroÙ


	)

158 #ifdeà
__NR_şock_adjtime


159 
	#SYS_şock_adjtime
 
__NR_şock_adjtime


	)

162 #ifdeà
__NR_şock_g‘»s


163 
	#SYS_şock_g‘»s
 
__NR_şock_g‘»s


	)

166 #ifdeà
__NR_şock_g‘time


167 
	#SYS_şock_g‘time
 
__NR_şock_g‘time


	)

170 #ifdeà
__NR_şock_Çno¦“p


171 
	#SYS_şock_Çno¦“p
 
__NR_şock_Çno¦“p


	)

174 #ifdeà
__NR_şock_£‰ime


175 
	#SYS_şock_£‰ime
 
__NR_şock_£‰ime


	)

178 #ifdeà
__NR_şÚe


179 
	#SYS_şÚe
 
__NR_şÚe


	)

182 #ifdeà
__NR_şÚe2


183 
	#SYS_şÚe2
 
__NR_şÚe2


	)

186 #ifdeà
__NR_şo£


187 
	#SYS_şo£
 
__NR_şo£


	)

190 #ifdeà
__NR_cmpxchg_badaddr


191 
	#SYS_cmpxchg_badaddr
 
__NR_cmpxchg_badaddr


	)

194 #ifdeà
__NR_cÚÃù


195 
	#SYS_cÚÃù
 
__NR_cÚÃù


	)

198 #ifdeà
__NR_cİy_fe_¿nge


199 
	#SYS_cİy_fe_¿nge
 
__NR_cİy_fe_¿nge


	)

202 #ifdeà
__NR_ü—t


203 
	#SYS_ü—t
 
__NR_ü—t


	)

206 #ifdeà
__NR_ü—‹_moduË


207 
	#SYS_ü—‹_moduË
 
__NR_ü—‹_moduË


	)

210 #ifdeà
__NR_d–‘e_moduË


211 
	#SYS_d–‘e_moduË
 
__NR_d–‘e_moduË


	)

214 #ifdeà
__NR_dc


215 
	#SYS_dc
 
__NR_dc


	)

218 #ifdeà
__NR_dup


219 
	#SYS_dup
 
__NR_dup


	)

222 #ifdeà
__NR_dup2


223 
	#SYS_dup2
 
__NR_dup2


	)

226 #ifdeà
__NR_dup3


227 
	#SYS_dup3
 
__NR_dup3


	)

230 #ifdeà
__NR_•Şl_ü—‹


231 
	#SYS_•Şl_ü—‹
 
__NR_•Şl_ü—‹


	)

234 #ifdeà
__NR_•Şl_ü—‹1


235 
	#SYS_•Şl_ü—‹1
 
__NR_•Şl_ü—‹1


	)

238 #ifdeà
__NR_•Şl_ùl


239 
	#SYS_•Şl_ùl
 
__NR_•Şl_ùl


	)

242 #ifdeà
__NR_•Şl_ùl_Şd


243 
	#SYS_•Şl_ùl_Şd
 
__NR_•Şl_ùl_Şd


	)

246 #ifdeà
__NR_•Şl_pwa™


247 
	#SYS_•Şl_pwa™
 
__NR_•Şl_pwa™


	)

250 #ifdeà
__NR_•Şl_wa™


251 
	#SYS_•Şl_wa™
 
__NR_•Şl_wa™


	)

254 #ifdeà
__NR_•Şl_wa™_Şd


255 
	#SYS_•Şl_wa™_Şd
 
__NR_•Şl_wa™_Şd


	)

258 #ifdeà
__NR_ev’tfd


259 
	#SYS_ev’tfd
 
__NR_ev’tfd


	)

262 #ifdeà
__NR_ev’tfd2


263 
	#SYS_ev’tfd2
 
__NR_ev’tfd2


	)

266 #ifdeà
__NR_exec_w™h_lßd”


267 
	#SYS_exec_w™h_lßd”
 
__NR_exec_w™h_lßd”


	)

270 #ifdeà
__NR_execv


271 
	#SYS_execv
 
__NR_execv


	)

274 #ifdeà
__NR_execve


275 
	#SYS_execve
 
__NR_execve


	)

278 #ifdeà
__NR_execv—t


279 
	#SYS_execv—t
 
__NR_execv—t


	)

282 #ifdeà
__NR_ex™


283 
	#SYS_ex™
 
__NR_ex™


	)

286 #ifdeà
__NR_ex™_group


287 
	#SYS_ex™_group
 
__NR_ex™_group


	)

290 #ifdeà
__NR_çcûs§t


291 
	#SYS_çcûs§t
 
__NR_çcûs§t


	)

294 #ifdeà
__NR_çdvi£64


295 
	#SYS_çdvi£64
 
__NR_çdvi£64


	)

298 #ifdeà
__NR_çdvi£64_64


299 
	#SYS_çdvi£64_64
 
__NR_çdvi£64_64


	)

302 #ifdeà
__NR_çÎoÿ‹


303 
	#SYS_çÎoÿ‹
 
__NR_çÎoÿ‹


	)

306 #ifdeà
__NR_çnÙify_š™


307 
	#SYS_çnÙify_š™
 
__NR_çnÙify_š™


	)

310 #ifdeà
__NR_çnÙify_m¬k


311 
	#SYS_çnÙify_m¬k
 
__NR_çnÙify_m¬k


	)

314 #ifdeà
__NR_fchdœ


315 
	#SYS_fchdœ
 
__NR_fchdœ


	)

318 #ifdeà
__NR_fchmod


319 
	#SYS_fchmod
 
__NR_fchmod


	)

322 #ifdeà
__NR_fchmod©


323 
	#SYS_fchmod©
 
__NR_fchmod©


	)

326 #ifdeà
__NR_fchown


327 
	#SYS_fchown
 
__NR_fchown


	)

330 #ifdeà
__NR_fchown32


331 
	#SYS_fchown32
 
__NR_fchown32


	)

334 #ifdeà
__NR_fchowÇt


335 
	#SYS_fchowÇt
 
__NR_fchowÇt


	)

338 #ifdeà
__NR_fú


339 
	#SYS_fú
 
__NR_fú


	)

342 #ifdeà
__NR_fú64


343 
	#SYS_fú64
 
__NR_fú64


	)

346 #ifdeà
__NR_fd©async


347 
	#SYS_fd©async
 
__NR_fd©async


	)

350 #ifdeà
__NR_fg‘x©Œ


351 
	#SYS_fg‘x©Œ
 
__NR_fg‘x©Œ


	)

354 #ifdeà
__NR_fš™_moduË


355 
	#SYS_fš™_moduË
 
__NR_fš™_moduË


	)

358 #ifdeà
__NR_æi¡x©Œ


359 
	#SYS_æi¡x©Œ
 
__NR_æi¡x©Œ


	)

362 #ifdeà
__NR_æock


363 
	#SYS_æock
 
__NR_æock


	)

366 #ifdeà
__NR_fÜk


367 
	#SYS_fÜk
 
__NR_fÜk


	)

370 #ifdeà
__NR_ä“_hug•ages


371 
	#SYS_ä“_hug•ages
 
__NR_ä“_hug•ages


	)

374 #ifdeà
__NR_äemovex©Œ


375 
	#SYS_äemovex©Œ
 
__NR_äemovex©Œ


	)

378 #ifdeà
__NR_f£tx©Œ


379 
	#SYS_f£tx©Œ
 
__NR_f£tx©Œ


	)

382 #ifdeà
__NR_f¡©


383 
	#SYS_f¡©
 
__NR_f¡©


	)

386 #ifdeà
__NR_f¡©64


387 
	#SYS_f¡©64
 
__NR_f¡©64


	)

390 #ifdeà
__NR_f¡©©64


391 
	#SYS_f¡©©64
 
__NR_f¡©©64


	)

394 #ifdeà
__NR_f¡©fs


395 
	#SYS_f¡©fs
 
__NR_f¡©fs


	)

398 #ifdeà
__NR_f¡©fs64


399 
	#SYS_f¡©fs64
 
__NR_f¡©fs64


	)

402 #ifdeà
__NR_fsync


403 
	#SYS_fsync
 
__NR_fsync


	)

406 #ifdeà
__NR_áime


407 
	#SYS_áime
 
__NR_áime


	)

410 #ifdeà
__NR_árunÿ‹


411 
	#SYS_árunÿ‹
 
__NR_árunÿ‹


	)

414 #ifdeà
__NR_árunÿ‹64


415 
	#SYS_árunÿ‹64
 
__NR_árunÿ‹64


	)

418 #ifdeà
__NR_fu‹x


419 
	#SYS_fu‹x
 
__NR_fu‹x


	)

422 #ifdeà
__NR_futime§t


423 
	#SYS_futime§t
 
__NR_futime§t


	)

426 #ifdeà
__NR_g‘_k”Ãl_syms


427 
	#SYS_g‘_k”Ãl_syms
 
__NR_g‘_k”Ãl_syms


	)

430 #ifdeà
__NR_g‘_mempŞicy


431 
	#SYS_g‘_mempŞicy
 
__NR_g‘_mempŞicy


	)

434 #ifdeà
__NR_g‘_robu¡_li¡


435 
	#SYS_g‘_robu¡_li¡
 
__NR_g‘_robu¡_li¡


	)

438 #ifdeà
__NR_g‘_th»ad_¬—


439 
	#SYS_g‘_th»ad_¬—
 
__NR_g‘_th»ad_¬—


	)

442 #ifdeà
__NR_g‘ıu


443 
	#SYS_g‘ıu
 
__NR_g‘ıu


	)

446 #ifdeà
__NR_g‘cwd


447 
	#SYS_g‘cwd
 
__NR_g‘cwd


	)

450 #ifdeà
__NR_g‘d’ts


451 
	#SYS_g‘d’ts
 
__NR_g‘d’ts


	)

454 #ifdeà
__NR_g‘d’ts64


455 
	#SYS_g‘d’ts64
 
__NR_g‘d’ts64


	)

458 #ifdeà
__NR_g‘domašÇme


459 
	#SYS_g‘domašÇme
 
__NR_g‘domašÇme


	)

462 #ifdeà
__NR_g‘dbËsize


463 
	#SYS_g‘dbËsize
 
__NR_g‘dbËsize


	)

466 #ifdeà
__NR_g‘egid


467 
	#SYS_g‘egid
 
__NR_g‘egid


	)

470 #ifdeà
__NR_g‘egid32


471 
	#SYS_g‘egid32
 
__NR_g‘egid32


	)

474 #ifdeà
__NR_g‘euid


475 
	#SYS_g‘euid
 
__NR_g‘euid


	)

478 #ifdeà
__NR_g‘euid32


479 
	#SYS_g‘euid32
 
__NR_g‘euid32


	)

482 #ifdeà
__NR_g‘gid


483 
	#SYS_g‘gid
 
__NR_g‘gid


	)

486 #ifdeà
__NR_g‘gid32


487 
	#SYS_g‘gid32
 
__NR_g‘gid32


	)

490 #ifdeà
__NR_g‘groups


491 
	#SYS_g‘groups
 
__NR_g‘groups


	)

494 #ifdeà
__NR_g‘groups32


495 
	#SYS_g‘groups32
 
__NR_g‘groups32


	)

498 #ifdeà
__NR_g‘ho¡Çme


499 
	#SYS_g‘ho¡Çme
 
__NR_g‘ho¡Çme


	)

502 #ifdeà
__NR_g‘™im”


503 
	#SYS_g‘™im”
 
__NR_g‘™im”


	)

506 #ifdeà
__NR_g‘·gesize


507 
	#SYS_g‘·gesize
 
__NR_g‘·gesize


	)

510 #ifdeà
__NR_g‘³”Çme


511 
	#SYS_g‘³”Çme
 
__NR_g‘³”Çme


	)

514 #ifdeà
__NR_g‘pgid


515 
	#SYS_g‘pgid
 
__NR_g‘pgid


	)

518 #ifdeà
__NR_g‘pg½


519 
	#SYS_g‘pg½
 
__NR_g‘pg½


	)

522 #ifdeà
__NR_g‘pid


523 
	#SYS_g‘pid
 
__NR_g‘pid


	)

526 #ifdeà
__NR_g‘pmsg


527 
	#SYS_g‘pmsg
 
__NR_g‘pmsg


	)

530 #ifdeà
__NR_g‘µid


531 
	#SYS_g‘µid
 
__NR_g‘µid


	)

534 #ifdeà
__NR_g‘´iÜ™y


535 
	#SYS_g‘´iÜ™y
 
__NR_g‘´iÜ™y


	)

538 #ifdeà
__NR_g‘¿ndom


539 
	#SYS_g‘¿ndom
 
__NR_g‘¿ndom


	)

542 #ifdeà
__NR_g‘»sgid


543 
	#SYS_g‘»sgid
 
__NR_g‘»sgid


	)

546 #ifdeà
__NR_g‘»sgid32


547 
	#SYS_g‘»sgid32
 
__NR_g‘»sgid32


	)

550 #ifdeà
__NR_g‘»suid


551 
	#SYS_g‘»suid
 
__NR_g‘»suid


	)

554 #ifdeà
__NR_g‘»suid32


555 
	#SYS_g‘»suid32
 
__NR_g‘»suid32


	)

558 #ifdeà
__NR_g‘¾im™


559 
	#SYS_g‘¾im™
 
__NR_g‘¾im™


	)

562 #ifdeà
__NR_g‘ru§ge


563 
	#SYS_g‘ru§ge
 
__NR_g‘ru§ge


	)

566 #ifdeà
__NR_g‘sid


567 
	#SYS_g‘sid
 
__NR_g‘sid


	)

570 #ifdeà
__NR_g‘sockÇme


571 
	#SYS_g‘sockÇme
 
__NR_g‘sockÇme


	)

574 #ifdeà
__NR_g‘sockİt


575 
	#SYS_g‘sockİt
 
__NR_g‘sockİt


	)

578 #ifdeà
__NR_g‘tid


579 
	#SYS_g‘tid
 
__NR_g‘tid


	)

582 #ifdeà
__NR_g‘timeofday


583 
	#SYS_g‘timeofday
 
__NR_g‘timeofday


	)

586 #ifdeà
__NR_g‘uid


587 
	#SYS_g‘uid
 
__NR_g‘uid


	)

590 #ifdeà
__NR_g‘uid32


591 
	#SYS_g‘uid32
 
__NR_g‘uid32


	)

594 #ifdeà
__NR_g‘unwšd


595 
	#SYS_g‘unwšd
 
__NR_g‘unwšd


	)

598 #ifdeà
__NR_g‘x©Œ


599 
	#SYS_g‘x©Œ
 
__NR_g‘x©Œ


	)

602 #ifdeà
__NR_g‘xgid


603 
	#SYS_g‘xgid
 
__NR_g‘xgid


	)

606 #ifdeà
__NR_g‘xpid


607 
	#SYS_g‘xpid
 
__NR_g‘xpid


	)

610 #ifdeà
__NR_g‘xuid


611 
	#SYS_g‘xuid
 
__NR_g‘xuid


	)

614 #ifdeà
__NR_g‰y


615 
	#SYS_g‰y
 
__NR_g‰y


	)

618 #ifdeà
__NR_idË


619 
	#SYS_idË
 
__NR_idË


	)

622 #ifdeà
__NR_š™_moduË


623 
	#SYS_š™_moduË
 
__NR_š™_moduË


	)

626 #ifdeà
__NR_šÙify_add_w©ch


627 
	#SYS_šÙify_add_w©ch
 
__NR_šÙify_add_w©ch


	)

630 #ifdeà
__NR_šÙify_š™


631 
	#SYS_šÙify_š™
 
__NR_šÙify_š™


	)

634 #ifdeà
__NR_šÙify_š™1


635 
	#SYS_šÙify_š™1
 
__NR_šÙify_š™1


	)

638 #ifdeà
__NR_šÙify_rm_w©ch


639 
	#SYS_šÙify_rm_w©ch
 
__NR_šÙify_rm_w©ch


	)

642 #ifdeà
__NR_io_ÿnûl


643 
	#SYS_io_ÿnûl
 
__NR_io_ÿnûl


	)

646 #ifdeà
__NR_io_de¡roy


647 
	#SYS_io_de¡roy
 
__NR_io_de¡roy


	)

650 #ifdeà
__NR_io_g‘ev’ts


651 
	#SYS_io_g‘ev’ts
 
__NR_io_g‘ev’ts


	)

654 #ifdeà
__NR_io_£tup


655 
	#SYS_io_£tup
 
__NR_io_£tup


	)

658 #ifdeà
__NR_io_subm™


659 
	#SYS_io_subm™
 
__NR_io_subm™


	)

662 #ifdeà
__NR_ioùl


663 
	#SYS_ioùl
 
__NR_ioùl


	)

666 #ifdeà
__NR_iİ”m


667 
	#SYS_iİ”m
 
__NR_iİ”m


	)

670 #ifdeà
__NR_iİl


671 
	#SYS_iİl
 
__NR_iİl


	)

674 #ifdeà
__NR_iİrio_g‘


675 
	#SYS_iİrio_g‘
 
__NR_iİrio_g‘


	)

678 #ifdeà
__NR_iİrio_£t


679 
	#SYS_iİrio_£t
 
__NR_iİrio_£t


	)

682 #ifdeà
__NR_c


683 
	#SYS_c
 
__NR_c


	)

686 #ifdeà
__NR_kcmp


687 
	#SYS_kcmp
 
__NR_kcmp


	)

690 #ifdeà
__NR_k”n_ã©u»s


691 
	#SYS_k”n_ã©u»s
 
__NR_k”n_ã©u»s


	)

694 #ifdeà
__NR_kexec_fe_lßd


695 
	#SYS_kexec_fe_lßd
 
__NR_kexec_fe_lßd


	)

698 #ifdeà
__NR_kexec_lßd


699 
	#SYS_kexec_lßd
 
__NR_kexec_lßd


	)

702 #ifdeà
__NR_keyùl


703 
	#SYS_keyùl
 
__NR_keyùl


	)

706 #ifdeà
__NR_kl


707 
	#SYS_kl
 
__NR_kl


	)

710 #ifdeà
__NR_lchown


711 
	#SYS_lchown
 
__NR_lchown


	)

714 #ifdeà
__NR_lchown32


715 
	#SYS_lchown32
 
__NR_lchown32


	)

718 #ifdeà
__NR_lg‘x©Œ


719 
	#SYS_lg‘x©Œ
 
__NR_lg‘x©Œ


	)

722 #ifdeà
__NR_lšk


723 
	#SYS_lšk
 
__NR_lšk


	)

726 #ifdeà
__NR_lšk©


727 
	#SYS_lšk©
 
__NR_lšk©


	)

730 #ifdeà
__NR_li¡’


731 
	#SYS_li¡’
 
__NR_li¡’


	)

734 #ifdeà
__NR_li¡x©Œ


735 
	#SYS_li¡x©Œ
 
__NR_li¡x©Œ


	)

738 #ifdeà
__NR_Îi¡x©Œ


739 
	#SYS_Îi¡x©Œ
 
__NR_Îi¡x©Œ


	)

742 #ifdeà
__NR_Î£ek


743 
	#SYS_Î£ek
 
__NR_Î£ek


	)

746 #ifdeà
__NR_lock


747 
	#SYS_lock
 
__NR_lock


	)

750 #ifdeà
__NR_lookup_dcook›


751 
	#SYS_lookup_dcook›
 
__NR_lookup_dcook›


	)

754 #ifdeà
__NR_Ìemovex©Œ


755 
	#SYS_Ìemovex©Œ
 
__NR_Ìemovex©Œ


	)

758 #ifdeà
__NR_l£ek


759 
	#SYS_l£ek
 
__NR_l£ek


	)

762 #ifdeà
__NR_l£tx©Œ


763 
	#SYS_l£tx©Œ
 
__NR_l£tx©Œ


	)

766 #ifdeà
__NR_l¡©


767 
	#SYS_l¡©
 
__NR_l¡©


	)

770 #ifdeà
__NR_l¡©64


771 
	#SYS_l¡©64
 
__NR_l¡©64


	)

774 #ifdeà
__NR_madvi£


775 
	#SYS_madvi£
 
__NR_madvi£


	)

778 #ifdeà
__NR_mbšd


779 
	#SYS_mbšd
 
__NR_mbšd


	)

782 #ifdeà
__NR_memb¬r›r


783 
	#SYS_memb¬r›r
 
__NR_memb¬r›r


	)

786 #ifdeà
__NR_memfd_ü—‹


787 
	#SYS_memfd_ü—‹
 
__NR_memfd_ü—‹


	)

790 #ifdeà
__NR_memÜy_Üd”šg


791 
	#SYS_memÜy_Üd”šg
 
__NR_memÜy_Üd”šg


	)

794 #ifdeà
__NR_mig¿‹_·ges


795 
	#SYS_mig¿‹_·ges
 
__NR_mig¿‹_·ges


	)

798 #ifdeà
__NR_mšcÜe


799 
	#SYS_mšcÜe
 
__NR_mšcÜe


	)

802 #ifdeà
__NR_mkdœ


803 
	#SYS_mkdœ
 
__NR_mkdœ


	)

806 #ifdeà
__NR_mkdœ©


807 
	#SYS_mkdœ©
 
__NR_mkdœ©


	)

810 #ifdeà
__NR_mknod


811 
	#SYS_mknod
 
__NR_mknod


	)

814 #ifdeà
__NR_mknod©


815 
	#SYS_mknod©
 
__NR_mknod©


	)

818 #ifdeà
__NR_mlock


819 
	#SYS_mlock
 
__NR_mlock


	)

822 #ifdeà
__NR_mlock2


823 
	#SYS_mlock2
 
__NR_mlock2


	)

826 #ifdeà
__NR_mlock®l


827 
	#SYS_mlock®l
 
__NR_mlock®l


	)

830 #ifdeà
__NR_mm­


831 
	#SYS_mm­
 
__NR_mm­


	)

834 #ifdeà
__NR_mm­2


835 
	#SYS_mm­2
 
__NR_mm­2


	)

838 #ifdeà
__NR_modify_ldt


839 
	#SYS_modify_ldt
 
__NR_modify_ldt


	)

842 #ifdeà
__NR_mouÁ


843 
	#SYS_mouÁ
 
__NR_mouÁ


	)

846 #ifdeà
__NR_move_·ges


847 
	#SYS_move_·ges
 
__NR_move_·ges


	)

850 #ifdeà
__NR_m´Ùeù


851 
	#SYS_m´Ùeù
 
__NR_m´Ùeù


	)

854 #ifdeà
__NR_mpx


855 
	#SYS_mpx
 
__NR_mpx


	)

858 #ifdeà
__NR_mq_g‘£‰r


859 
	#SYS_mq_g‘£‰r
 
__NR_mq_g‘£‰r


	)

862 #ifdeà
__NR_mq_nÙify


863 
	#SYS_mq_nÙify
 
__NR_mq_nÙify


	)

866 #ifdeà
__NR_mq_İ’


867 
	#SYS_mq_İ’
 
__NR_mq_İ’


	)

870 #ifdeà
__NR_mq_timed»ûive


871 
	#SYS_mq_timed»ûive
 
__NR_mq_timed»ûive


	)

874 #ifdeà
__NR_mq_timed£nd


875 
	#SYS_mq_timed£nd
 
__NR_mq_timed£nd


	)

878 #ifdeà
__NR_mq_uÆšk


879 
	#SYS_mq_uÆšk
 
__NR_mq_uÆšk


	)

882 #ifdeà
__NR_m»m­


883 
	#SYS_m»m­
 
__NR_m»m­


	)

886 #ifdeà
__NR_msgùl


887 
	#SYS_msgùl
 
__NR_msgùl


	)

890 #ifdeà
__NR_msgg‘


891 
	#SYS_msgg‘
 
__NR_msgg‘


	)

894 #ifdeà
__NR_msgrcv


895 
	#SYS_msgrcv
 
__NR_msgrcv


	)

898 #ifdeà
__NR_msg¢d


899 
	#SYS_msg¢d
 
__NR_msg¢d


	)

902 #ifdeà
__NR_msync


903 
	#SYS_msync
 
__NR_msync


	)

906 #ifdeà
__NR_muÉËx”


907 
	#SYS_muÉËx”
 
__NR_muÉËx”


	)

910 #ifdeà
__NR_muÆock


911 
	#SYS_muÆock
 
__NR_muÆock


	)

914 #ifdeà
__NR_muÆock®l


915 
	#SYS_muÆock®l
 
__NR_muÆock®l


	)

918 #ifdeà
__NR_munm­


919 
	#SYS_munm­
 
__NR_munm­


	)

922 #ifdeà
__NR_Çme_to_hªdË_©


923 
	#SYS_Çme_to_hªdË_©
 
__NR_Çme_to_hªdË_©


	)

926 #ifdeà
__NR_Çno¦“p


927 
	#SYS_Çno¦“p
 
__NR_Çno¦“p


	)

930 #ifdeà
__NR_Ãwf¡©©


931 
	#SYS_Ãwf¡©©
 
__NR_Ãwf¡©©


	)

934 #ifdeà
__NR_nfs£rvùl


935 
	#SYS_nfs£rvùl
 
__NR_nfs£rvùl


	)

938 #ifdeà
__NR_ni_sysÿÎ


939 
	#SYS_ni_sysÿÎ
 
__NR_ni_sysÿÎ


	)

942 #ifdeà
__NR_niû


943 
	#SYS_niû
 
__NR_niû


	)

946 #ifdeà
__NR_Şd_adjtimex


947 
	#SYS_Şd_adjtimex
 
__NR_Şd_adjtimex


	)

950 #ifdeà
__NR_Şdf¡©


951 
	#SYS_Şdf¡©
 
__NR_Şdf¡©


	)

954 #ifdeà
__NR_Şdl¡©


955 
	#SYS_Şdl¡©
 
__NR_Şdl¡©


	)

958 #ifdeà
__NR_ŞdŞduÇme


959 
	#SYS_ŞdŞduÇme
 
__NR_ŞdŞduÇme


	)

962 #ifdeà
__NR_Şd¡©


963 
	#SYS_Şd¡©
 
__NR_Şd¡©


	)

966 #ifdeà
__NR_ŞdumouÁ


967 
	#SYS_ŞdumouÁ
 
__NR_ŞdumouÁ


	)

970 #ifdeà
__NR_ŞduÇme


971 
	#SYS_ŞduÇme
 
__NR_ŞduÇme


	)

974 #ifdeà
__NR_İ’


975 
	#SYS_İ’
 
__NR_İ’


	)

978 #ifdeà
__NR_İ’_by_hªdË_©


979 
	#SYS_İ’_by_hªdË_©
 
__NR_İ’_by_hªdË_©


	)

982 #ifdeà
__NR_İ’©


983 
	#SYS_İ’©
 
__NR_İ’©


	)

986 #ifdeà
__NR_osf_adjtime


987 
	#SYS_osf_adjtime
 
__NR_osf_adjtime


	)

990 #ifdeà
__NR_osf_afs_sysÿÎ


991 
	#SYS_osf_afs_sysÿÎ
 
__NR_osf_afs_sysÿÎ


	)

994 #ifdeà
__NR_osf_®t_¶ock


995 
	#SYS_osf_®t_¶ock
 
__NR_osf_®t_¶ock


	)

998 #ifdeà
__NR_osf_®t_£tsid


999 
	#SYS_osf_®t_£tsid
 
__NR_osf_®t_£tsid


	)

1002 #ifdeà
__NR_osf_®t_sig³ndšg


1003 
	#SYS_osf_®t_sig³ndšg
 
__NR_osf_®t_sig³ndšg


	)

1006 #ifdeà
__NR_osf_asynch_d«mÚ


1007 
	#SYS_osf_asynch_d«mÚ
 
__NR_osf_asynch_d«mÚ


	)

1010 #ifdeà
__NR_osf_audú


1011 
	#SYS_osf_audú
 
__NR_osf_audú


	)

1014 #ifdeà
__NR_osf_audg’


1015 
	#SYS_osf_audg’
 
__NR_osf_audg’


	)

1018 #ifdeà
__NR_osf_chæags


1019 
	#SYS_osf_chæags
 
__NR_osf_chæags


	)

1022 #ifdeà
__NR_osf_execve


1023 
	#SYS_osf_execve
 
__NR_osf_execve


	)

1026 #ifdeà
__NR_osf_expÜtfs


1027 
	#SYS_osf_expÜtfs
 
__NR_osf_expÜtfs


	)

1030 #ifdeà
__NR_osf_fchæags


1031 
	#SYS_osf_fchæags
 
__NR_osf_fchæags


	)

1034 #ifdeà
__NR_osf_fd©async


1035 
	#SYS_osf_fd©async
 
__NR_osf_fd©async


	)

1038 #ifdeà
__NR_osf_å©hcÚf


1039 
	#SYS_osf_å©hcÚf
 
__NR_osf_å©hcÚf


	)

1042 #ifdeà
__NR_osf_f¡©


1043 
	#SYS_osf_f¡©
 
__NR_osf_f¡©


	)

1046 #ifdeà
__NR_osf_f¡©fs


1047 
	#SYS_osf_f¡©fs
 
__NR_osf_f¡©fs


	)

1050 #ifdeà
__NR_osf_f¡©fs64


1051 
	#SYS_osf_f¡©fs64
 
__NR_osf_f¡©fs64


	)

1054 #ifdeà
__NR_osf_fu£r


1055 
	#SYS_osf_fu£r
 
__NR_osf_fu£r


	)

1058 #ifdeà
__NR_osf_g‘add»sscÚf


1059 
	#SYS_osf_g‘add»sscÚf
 
__NR_osf_g‘add»sscÚf


	)

1062 #ifdeà
__NR_osf_g‘dœ’Œ›s


1063 
	#SYS_osf_g‘dœ’Œ›s
 
__NR_osf_g‘dœ’Œ›s


	)

1066 #ifdeà
__NR_osf_g‘domašÇme


1067 
	#SYS_osf_g‘domašÇme
 
__NR_osf_g‘domašÇme


	)

1070 #ifdeà
__NR_osf_g‘fh


1071 
	#SYS_osf_g‘fh
 
__NR_osf_g‘fh


	)

1074 #ifdeà
__NR_osf_g‘fs¡©


1075 
	#SYS_osf_g‘fs¡©
 
__NR_osf_g‘fs¡©


	)

1078 #ifdeà
__NR_osf_g‘ho¡id


1079 
	#SYS_osf_g‘ho¡id
 
__NR_osf_g‘ho¡id


	)

1082 #ifdeà
__NR_osf_g‘™im”


1083 
	#SYS_osf_g‘™im”
 
__NR_osf_g‘™im”


	)

1086 #ifdeà
__NR_osf_g‘logš


1087 
	#SYS_osf_g‘logš
 
__NR_osf_g‘logš


	)

1090 #ifdeà
__NR_osf_g‘mÁ


1091 
	#SYS_osf_g‘mÁ
 
__NR_osf_g‘mÁ


	)

1094 #ifdeà
__NR_osf_g‘ru§ge


1095 
	#SYS_osf_g‘ru§ge
 
__NR_osf_g‘ru§ge


	)

1098 #ifdeà
__NR_osf_g‘sysšfo


1099 
	#SYS_osf_g‘sysšfo
 
__NR_osf_g‘sysšfo


	)

1102 #ifdeà
__NR_osf_g‘timeofday


1103 
	#SYS_osf_g‘timeofday
 
__NR_osf_g‘timeofday


	)

1106 #ifdeà
__NR_osf_klßdÿÎ


1107 
	#SYS_osf_klßdÿÎ
 
__NR_osf_klßdÿÎ


	)

1110 #ifdeà
__NR_osf_kmodÿÎ


1111 
	#SYS_osf_kmodÿÎ
 
__NR_osf_kmodÿÎ


	)

1114 #ifdeà
__NR_osf_l¡©


1115 
	#SYS_osf_l¡©
 
__NR_osf_l¡©


	)

1118 #ifdeà
__NR_osf_memú


1119 
	#SYS_osf_memú
 
__NR_osf_memú


	)

1122 #ifdeà
__NR_osf_mšcÜe


1123 
	#SYS_osf_mšcÜe
 
__NR_osf_mšcÜe


	)

1126 #ifdeà
__NR_osf_mouÁ


1127 
	#SYS_osf_mouÁ
 
__NR_osf_mouÁ


	)

1130 #ifdeà
__NR_osf_m»m­


1131 
	#SYS_osf_m»m­
 
__NR_osf_m»m­


	)

1134 #ifdeà
__NR_osf_msfs_sysÿÎ


1135 
	#SYS_osf_msfs_sysÿÎ
 
__NR_osf_msfs_sysÿÎ


	)

1138 #ifdeà
__NR_osf_m¦“p


1139 
	#SYS_osf_m¦“p
 
__NR_osf_m¦“p


	)

1142 #ifdeà
__NR_osf_mv®id


1143 
	#SYS_osf_mv®id
 
__NR_osf_mv®id


	)

1146 #ifdeà
__NR_osf_mwakeup


1147 
	#SYS_osf_mwakeup
 
__NR_osf_mwakeup


	)

1150 #ifdeà
__NR_osf_Çcû±


1151 
	#SYS_osf_Çcû±
 
__NR_osf_Çcû±


	)

1154 #ifdeà
__NR_osf_nfssvc


1155 
	#SYS_osf_nfssvc
 
__NR_osf_nfssvc


	)

1158 #ifdeà
__NR_osf_ng‘³”Çme


1159 
	#SYS_osf_ng‘³”Çme
 
__NR_osf_ng‘³”Çme


	)

1162 #ifdeà
__NR_osf_ng‘sockÇme


1163 
	#SYS_osf_ng‘sockÇme
 
__NR_osf_ng‘sockÇme


	)

1166 #ifdeà
__NR_osf_Äecväom


1167 
	#SYS_osf_Äecväom
 
__NR_osf_Äecväom


	)

1170 #ifdeà
__NR_osf_Äecvmsg


1171 
	#SYS_osf_Äecvmsg
 
__NR_osf_Äecvmsg


	)

1174 #ifdeà
__NR_osf_n£ndmsg


1175 
	#SYS_osf_n£ndmsg
 
__NR_osf_n£ndmsg


	)

1178 #ifdeà
__NR_osf_Áp_adjtime


1179 
	#SYS_osf_Áp_adjtime
 
__NR_osf_Áp_adjtime


	)

1182 #ifdeà
__NR_osf_Áp_g‘time


1183 
	#SYS_osf_Áp_g‘time
 
__NR_osf_Áp_g‘time


	)

1186 #ifdeà
__NR_osf_Şd_ü—t


1187 
	#SYS_osf_Şd_ü—t
 
__NR_osf_Şd_ü—t


	)

1190 #ifdeà
__NR_osf_Şd_f¡©


1191 
	#SYS_osf_Şd_f¡©
 
__NR_osf_Şd_f¡©


	)

1194 #ifdeà
__NR_osf_Şd_g‘pg½


1195 
	#SYS_osf_Şd_g‘pg½
 
__NR_osf_Şd_g‘pg½


	)

1198 #ifdeà
__NR_osf_Şd_kÍg


1199 
	#SYS_osf_Şd_kÍg
 
__NR_osf_Şd_kÍg


	)

1202 #ifdeà
__NR_osf_Şd_l¡©


1203 
	#SYS_osf_Şd_l¡©
 
__NR_osf_Şd_l¡©


	)

1206 #ifdeà
__NR_osf_Şd_İ’


1207 
	#SYS_osf_Şd_İ’
 
__NR_osf_Şd_İ’


	)

1210 #ifdeà
__NR_osf_Şd_sigaùiÚ


1211 
	#SYS_osf_Şd_sigaùiÚ
 
__NR_osf_Şd_sigaùiÚ


	)

1214 #ifdeà
__NR_osf_Şd_sigblock


1215 
	#SYS_osf_Şd_sigblock
 
__NR_osf_Şd_sigblock


	)

1218 #ifdeà
__NR_osf_Şd_sig»tuº


1219 
	#SYS_osf_Şd_sig»tuº
 
__NR_osf_Şd_sig»tuº


	)

1222 #ifdeà
__NR_osf_Şd_sig£tmask


1223 
	#SYS_osf_Şd_sig£tmask
 
__NR_osf_Şd_sig£tmask


	)

1226 #ifdeà
__NR_osf_Şd_sigvec


1227 
	#SYS_osf_Şd_sigvec
 
__NR_osf_Şd_sigvec


	)

1230 #ifdeà
__NR_osf_Şd_¡©


1231 
	#SYS_osf_Şd_¡©
 
__NR_osf_Şd_¡©


	)

1234 #ifdeà
__NR_osf_Şd_vadvi£


1235 
	#SYS_osf_Şd_vadvi£
 
__NR_osf_Şd_vadvi£


	)

1238 #ifdeà
__NR_osf_Şd_vŒaû


1239 
	#SYS_osf_Şd_vŒaû
 
__NR_osf_Şd_vŒaû


	)

1242 #ifdeà
__NR_osf_Şd_wa™


1243 
	#SYS_osf_Şd_wa™
 
__NR_osf_Şd_wa™


	)

1246 #ifdeà
__NR_osf_ŞdquÙa


1247 
	#SYS_osf_ŞdquÙa
 
__NR_osf_ŞdquÙa


	)

1250 #ifdeà
__NR_osf_·thcÚf


1251 
	#SYS_osf_·thcÚf
 
__NR_osf_·thcÚf


	)

1254 #ifdeà
__NR_osf_pid_block


1255 
	#SYS_osf_pid_block
 
__NR_osf_pid_block


	)

1258 #ifdeà
__NR_osf_pid_unblock


1259 
	#SYS_osf_pid_unblock
 
__NR_osf_pid_unblock


	)

1262 #ifdeà
__NR_osf_¶ock


1263 
	#SYS_osf_¶ock
 
__NR_osf_¶ock


	)

1266 #ifdeà
__NR_osf_´ioú£t


1267 
	#SYS_osf_´ioú£t
 
__NR_osf_´ioú£t


	)

1270 #ifdeà
__NR_osf_´of


1271 
	#SYS_osf_´of
 
__NR_osf_´of


	)

1274 #ifdeà
__NR_osf_´İli¡_sysÿÎ


1275 
	#SYS_osf_´İli¡_sysÿÎ
 
__NR_osf_´İli¡_sysÿÎ


	)

1278 #ifdeà
__NR_osf_»boÙ


1279 
	#SYS_osf_»boÙ
 
__NR_osf_»boÙ


	)

1282 #ifdeà
__NR_osf_»voke


1283 
	#SYS_osf_»voke
 
__NR_osf_»voke


	)

1286 #ifdeà
__NR_osf_sbrk


1287 
	#SYS_osf_sbrk
 
__NR_osf_sbrk


	)

1290 #ifdeà
__NR_osf_£cur™y


1291 
	#SYS_osf_£cur™y
 
__NR_osf_£cur™y


	)

1294 #ifdeà
__NR_osf_£Ëù


1295 
	#SYS_osf_£Ëù
 
__NR_osf_£Ëù


	)

1298 #ifdeà
__NR_osf_£t_´og¿m_©Œibu‹s


1299 
	#SYS_osf_£t_´og¿m_©Œibu‹s
 
__NR_osf_£t_´og¿m_©Œibu‹s


	)

1302 #ifdeà
__NR_osf_£t_¥ecuÏtive


1303 
	#SYS_osf_£t_¥ecuÏtive
 
__NR_osf_£t_¥ecuÏtive


	)

1306 #ifdeà
__NR_osf_£tho¡id


1307 
	#SYS_osf_£tho¡id
 
__NR_osf_£tho¡id


	)

1310 #ifdeà
__NR_osf_£t™im”


1311 
	#SYS_osf_£t™im”
 
__NR_osf_£t™im”


	)

1314 #ifdeà
__NR_osf_£ogš


1315 
	#SYS_osf_£ogš
 
__NR_osf_£ogš


	)

1318 #ifdeà
__NR_osf_£tsysšfo


1319 
	#SYS_osf_£tsysšfo
 
__NR_osf_£tsysšfo


	)

1322 #ifdeà
__NR_osf_£‰imeofday


1323 
	#SYS_osf_£‰imeofday
 
__NR_osf_£‰imeofday


	)

1326 #ifdeà
__NR_osf_shm©


1327 
	#SYS_osf_shm©
 
__NR_osf_shm©


	)

1330 #ifdeà
__NR_osf_sigÇl


1331 
	#SYS_osf_sigÇl
 
__NR_osf_sigÇl


	)

1334 #ifdeà
__NR_osf_sig´ocmask


1335 
	#SYS_osf_sig´ocmask
 
__NR_osf_sig´ocmask


	)

1338 #ifdeà
__NR_osf_sig£nd£t


1339 
	#SYS_osf_sig£nd£t
 
__NR_osf_sig£nd£t


	)

1342 #ifdeà
__NR_osf_sig¡ack


1343 
	#SYS_osf_sig¡ack
 
__NR_osf_sig¡ack


	)

1346 #ifdeà
__NR_osf_sigwa™´im


1347 
	#SYS_osf_sigwa™´im
 
__NR_osf_sigwa™´im


	)

1350 #ifdeà
__NR_osf_s¡k


1351 
	#SYS_osf_s¡k
 
__NR_osf_s¡k


	)

1354 #ifdeà
__NR_osf_¡©


1355 
	#SYS_osf_¡©
 
__NR_osf_¡©


	)

1358 #ifdeà
__NR_osf_¡©fs


1359 
	#SYS_osf_¡©fs
 
__NR_osf_¡©fs


	)

1362 #ifdeà
__NR_osf_¡©fs64


1363 
	#SYS_osf_¡©fs64
 
__NR_osf_¡©fs64


	)

1366 #ifdeà
__NR_osf_subsys_šfo


1367 
	#SYS_osf_subsys_šfo
 
__NR_osf_subsys_šfo


	)

1370 #ifdeà
__NR_osf_sw­ùl


1371 
	#SYS_osf_sw­ùl
 
__NR_osf_sw­ùl


	)

1374 #ifdeà
__NR_osf_sw­Ú


1375 
	#SYS_osf_sw­Ú
 
__NR_osf_sw­Ú


	)

1378 #ifdeà
__NR_osf_sysÿÎ


1379 
	#SYS_osf_sysÿÎ
 
__NR_osf_sysÿÎ


	)

1382 #ifdeà
__NR_osf_sysšfo


1383 
	#SYS_osf_sysšfo
 
__NR_osf_sysšfo


	)

1386 #ifdeà
__NR_osf_bË


1387 
	#SYS_osf_bË
 
__NR_osf_bË


	)

1390 #ifdeà
__NR_osf_uadmš


1391 
	#SYS_osf_uadmš
 
__NR_osf_uadmš


	)

1394 #ifdeà
__NR_osf_u¦“p_th»ad


1395 
	#SYS_osf_u¦“p_th»ad
 
__NR_osf_u¦“p_th»ad


	)

1398 #ifdeà
__NR_osf_usw™ch


1399 
	#SYS_osf_usw™ch
 
__NR_osf_usw™ch


	)

1402 #ifdeà
__NR_osf_utc_adjtime


1403 
	#SYS_osf_utc_adjtime
 
__NR_osf_utc_adjtime


	)

1406 #ifdeà
__NR_osf_utc_g‘time


1407 
	#SYS_osf_utc_g‘time
 
__NR_osf_utc_g‘time


	)

1410 #ifdeà
__NR_osf_utimes


1411 
	#SYS_osf_utimes
 
__NR_osf_utimes


	)

1414 #ifdeà
__NR_osf_ut¢ame


1415 
	#SYS_osf_ut¢ame
 
__NR_osf_ut¢ame


	)

1418 #ifdeà
__NR_osf_wa™4


1419 
	#SYS_osf_wa™4
 
__NR_osf_wa™4


	)

1422 #ifdeà
__NR_osf_wa™id


1423 
	#SYS_osf_wa™id
 
__NR_osf_wa™id


	)

1426 #ifdeà
__NR_·u£


1427 
	#SYS_·u£
 
__NR_·u£


	)

1430 #ifdeà
__NR_pcicÚfig_ioba£


1431 
	#SYS_pcicÚfig_ioba£
 
__NR_pcicÚfig_ioba£


	)

1434 #ifdeà
__NR_pcicÚfig_»ad


1435 
	#SYS_pcicÚfig_»ad
 
__NR_pcicÚfig_»ad


	)

1438 #ifdeà
__NR_pcicÚfig_wr™e


1439 
	#SYS_pcicÚfig_wr™e
 
__NR_pcicÚfig_wr™e


	)

1442 #ifdeà
__NR_³rf_ev’t_İ’


1443 
	#SYS_³rf_ev’t_İ’
 
__NR_³rf_ev’t_İ’


	)

1446 #ifdeà
__NR_³rfùr


1447 
	#SYS_³rfùr
 
__NR_³rfùr


	)

1450 #ifdeà
__NR_³rfmÚùl


1451 
	#SYS_³rfmÚùl
 
__NR_³rfmÚùl


	)

1454 #ifdeà
__NR_³rsÚ®™y


1455 
	#SYS_³rsÚ®™y
 
__NR_³rsÚ®™y


	)

1458 #ifdeà
__NR_pe


1459 
	#SYS_pe
 
__NR_pe


	)

1462 #ifdeà
__NR_pe2


1463 
	#SYS_pe2
 
__NR_pe2


	)

1466 #ifdeà
__NR_pivÙ_roÙ


1467 
	#SYS_pivÙ_roÙ
 
__NR_pivÙ_roÙ


	)

1470 #ifdeà
__NR_pkey_®loc


1471 
	#SYS_pkey_®loc
 
__NR_pkey_®loc


	)

1474 #ifdeà
__NR_pkey_ä“


1475 
	#SYS_pkey_ä“
 
__NR_pkey_ä“


	)

1478 #ifdeà
__NR_pkey_m´Ùeù


1479 
	#SYS_pkey_m´Ùeù
 
__NR_pkey_m´Ùeù


	)

1482 #ifdeà
__NR_pŞl


1483 
	#SYS_pŞl
 
__NR_pŞl


	)

1486 #ifdeà
__NR_µŞl


1487 
	#SYS_µŞl
 
__NR_µŞl


	)

1490 #ifdeà
__NR_´ùl


1491 
	#SYS_´ùl
 
__NR_´ùl


	)

1494 #ifdeà
__NR_´—d64


1495 
	#SYS_´—d64
 
__NR_´—d64


	)

1498 #ifdeà
__NR_´—dv


1499 
	#SYS_´—dv
 
__NR_´—dv


	)

1502 #ifdeà
__NR_´—dv2


1503 
	#SYS_´—dv2
 
__NR_´—dv2


	)

1506 #ifdeà
__NR_´lim™64


1507 
	#SYS_´lim™64
 
__NR_´lim™64


	)

1510 #ifdeà
__NR_´oûss_vm_»adv


1511 
	#SYS_´oûss_vm_»adv
 
__NR_´oûss_vm_»adv


	)

1514 #ifdeà
__NR_´oûss_vm_wr™ev


1515 
	#SYS_´oûss_vm_wr™ev
 
__NR_´oûss_vm_wr™ev


	)

1518 #ifdeà
__NR_´of


1519 
	#SYS_´of
 
__NR_´of


	)

1522 #ifdeà
__NR_´of


1523 
	#SYS_´of
 
__NR_´of


	)

1526 #ifdeà
__NR_p£Ëù6


1527 
	#SYS_p£Ëù6
 
__NR_p£Ëù6


	)

1530 #ifdeà
__NR_±¿û


1531 
	#SYS_±¿û
 
__NR_±¿û


	)

1534 #ifdeà
__NR_pumsg


1535 
	#SYS_pumsg
 
__NR_pumsg


	)

1538 #ifdeà
__NR_pwr™e64


1539 
	#SYS_pwr™e64
 
__NR_pwr™e64


	)

1542 #ifdeà
__NR_pwr™ev


1543 
	#SYS_pwr™ev
 
__NR_pwr™ev


	)

1546 #ifdeà
__NR_pwr™ev2


1547 
	#SYS_pwr™ev2
 
__NR_pwr™ev2


	)

1550 #ifdeà
__NR_qu”y_moduË


1551 
	#SYS_qu”y_moduË
 
__NR_qu”y_moduË


	)

1554 #ifdeà
__NR_quÙaùl


1555 
	#SYS_quÙaùl
 
__NR_quÙaùl


	)

1558 #ifdeà
__NR_»ad


1559 
	#SYS_»ad
 
__NR_»ad


	)

1562 #ifdeà
__NR_»adah—d


1563 
	#SYS_»adah—d
 
__NR_»adah—d


	)

1566 #ifdeà
__NR_»addœ


1567 
	#SYS_»addœ
 
__NR_»addœ


	)

1570 #ifdeà
__NR_»adlšk


1571 
	#SYS_»adlšk
 
__NR_»adlšk


	)

1574 #ifdeà
__NR_»adlšk©


1575 
	#SYS_»adlšk©
 
__NR_»adlšk©


	)

1578 #ifdeà
__NR_»adv


1579 
	#SYS_»adv
 
__NR_»adv


	)

1582 #ifdeà
__NR_»boÙ


1583 
	#SYS_»boÙ
 
__NR_»boÙ


	)

1586 #ifdeà
__NR_»cv


1587 
	#SYS_»cv
 
__NR_»cv


	)

1590 #ifdeà
__NR_»cväom


1591 
	#SYS_»cväom
 
__NR_»cväom


	)

1594 #ifdeà
__NR_»cvmmsg


1595 
	#SYS_»cvmmsg
 
__NR_»cvmmsg


	)

1598 #ifdeà
__NR_»cvmsg


1599 
	#SYS_»cvmsg
 
__NR_»cvmsg


	)

1602 #ifdeà
__NR_»m­_fe_·ges


1603 
	#SYS_»m­_fe_·ges
 
__NR_»m­_fe_·ges


	)

1606 #ifdeà
__NR_»movex©Œ


1607 
	#SYS_»movex©Œ
 
__NR_»movex©Œ


	)

1610 #ifdeà
__NR_»Çme


1611 
	#SYS_»Çme
 
__NR_»Çme


	)

1614 #ifdeà
__NR_»Çm—t


1615 
	#SYS_»Çm—t
 
__NR_»Çm—t


	)

1618 #ifdeà
__NR_»Çm—t2


1619 
	#SYS_»Çm—t2
 
__NR_»Çm—t2


	)

1622 #ifdeà
__NR_»que¡_key


1623 
	#SYS_»que¡_key
 
__NR_»que¡_key


	)

1626 #ifdeà
__NR_»¡¬t_sysÿÎ


1627 
	#SYS_»¡¬t_sysÿÎ
 
__NR_»¡¬t_sysÿÎ


	)

1630 #ifdeà
__NR_rmdœ


1631 
	#SYS_rmdœ
 
__NR_rmdœ


	)

1634 #ifdeà
__NR_¹_sigaùiÚ


1635 
	#SYS_¹_sigaùiÚ
 
__NR_¹_sigaùiÚ


	)

1638 #ifdeà
__NR_¹_sig³ndšg


1639 
	#SYS_¹_sig³ndšg
 
__NR_¹_sig³ndšg


	)

1642 #ifdeà
__NR_¹_sig´ocmask


1643 
	#SYS_¹_sig´ocmask
 
__NR_¹_sig´ocmask


	)

1646 #ifdeà
__NR_¹_sigqueuešfo


1647 
	#SYS_¹_sigqueuešfo
 
__NR_¹_sigqueuešfo


	)

1650 #ifdeà
__NR_¹_sig»tuº


1651 
	#SYS_¹_sig»tuº
 
__NR_¹_sig»tuº


	)

1654 #ifdeà
__NR_¹_sigsu¥’d


1655 
	#SYS_¹_sigsu¥’d
 
__NR_¹_sigsu¥’d


	)

1658 #ifdeà
__NR_¹_sigtimedwa™


1659 
	#SYS_¹_sigtimedwa™
 
__NR_¹_sigtimedwa™


	)

1662 #ifdeà
__NR_¹_tgsigqueuešfo


1663 
	#SYS_¹_tgsigqueuešfo
 
__NR_¹_tgsigqueuešfo


	)

1666 #ifdeà
__NR_¹as


1667 
	#SYS_¹as
 
__NR_¹as


	)

1670 #ifdeà
__NR_s390_gu¬ded_¡Üage


1671 
	#SYS_s390_gu¬ded_¡Üage
 
__NR_s390_gu¬ded_¡Üage


	)

1674 #ifdeà
__NR_s390_pci_mmio_»ad


1675 
	#SYS_s390_pci_mmio_»ad
 
__NR_s390_pci_mmio_»ad


	)

1678 #ifdeà
__NR_s390_pci_mmio_wr™e


1679 
	#SYS_s390_pci_mmio_wr™e
 
__NR_s390_pci_mmio_wr™e


	)

1682 #ifdeà
__NR_s390_ruÁime_š¡r


1683 
	#SYS_s390_ruÁime_š¡r
 
__NR_s390_ruÁime_š¡r


	)

1686 #ifdeà
__NR_sched_g‘_affš™y


1687 
	#SYS_sched_g‘_affš™y
 
__NR_sched_g‘_affš™y


	)

1690 #ifdeà
__NR_sched_g‘_´iÜ™y_max


1691 
	#SYS_sched_g‘_´iÜ™y_max
 
__NR_sched_g‘_´iÜ™y_max


	)

1694 #ifdeà
__NR_sched_g‘_´iÜ™y_mš


1695 
	#SYS_sched_g‘_´iÜ™y_mš
 
__NR_sched_g‘_´iÜ™y_mš


	)

1698 #ifdeà
__NR_sched_g‘affš™y


1699 
	#SYS_sched_g‘affš™y
 
__NR_sched_g‘affš™y


	)

1702 #ifdeà
__NR_sched_g‘©Œ


1703 
	#SYS_sched_g‘©Œ
 
__NR_sched_g‘©Œ


	)

1706 #ifdeà
__NR_sched_g‘·¿m


1707 
	#SYS_sched_g‘·¿m
 
__NR_sched_g‘·¿m


	)

1710 #ifdeà
__NR_sched_g‘scheduËr


1711 
	#SYS_sched_g‘scheduËr
 
__NR_sched_g‘scheduËr


	)

1714 #ifdeà
__NR_sched_¼_g‘_š‹rv®


1715 
	#SYS_sched_¼_g‘_š‹rv®
 
__NR_sched_¼_g‘_š‹rv®


	)

1718 #ifdeà
__NR_sched_£t_affš™y


1719 
	#SYS_sched_£t_affš™y
 
__NR_sched_£t_affš™y


	)

1722 #ifdeà
__NR_sched_£ffš™y


1723 
	#SYS_sched_£ffš™y
 
__NR_sched_£ffš™y


	)

1726 #ifdeà
__NR_sched_£‰r


1727 
	#SYS_sched_£‰r
 
__NR_sched_£‰r


	)

1730 #ifdeà
__NR_sched_£¬am


1731 
	#SYS_sched_£¬am
 
__NR_sched_£¬am


	)

1734 #ifdeà
__NR_sched_£tscheduËr


1735 
	#SYS_sched_£tscheduËr
 
__NR_sched_£tscheduËr


	)

1738 #ifdeà
__NR_sched_y›ld


1739 
	#SYS_sched_y›ld
 
__NR_sched_y›ld


	)

1742 #ifdeà
__NR_£ccomp


1743 
	#SYS_£ccomp
 
__NR_£ccomp


	)

1746 #ifdeà
__NR_£cur™y


1747 
	#SYS_£cur™y
 
__NR_£cur™y


	)

1750 #ifdeà
__NR_£Ëù


1751 
	#SYS_£Ëù
 
__NR_£Ëù


	)

1754 #ifdeà
__NR_£mùl


1755 
	#SYS_£mùl
 
__NR_£mùl


	)

1758 #ifdeà
__NR_£mg‘


1759 
	#SYS_£mg‘
 
__NR_£mg‘


	)

1762 #ifdeà
__NR_£mİ


1763 
	#SYS_£mİ
 
__NR_£mİ


	)

1766 #ifdeà
__NR_£mtimedİ


1767 
	#SYS_£mtimedİ
 
__NR_£mtimedİ


	)

1770 #ifdeà
__NR_£nd


1771 
	#SYS_£nd
 
__NR_£nd


	)

1774 #ifdeà
__NR_£ndfe


1775 
	#SYS_£ndfe
 
__NR_£ndfe


	)

1778 #ifdeà
__NR_£ndfe64


1779 
	#SYS_£ndfe64
 
__NR_£ndfe64


	)

1782 #ifdeà
__NR_£ndmmsg


1783 
	#SYS_£ndmmsg
 
__NR_£ndmmsg


	)

1786 #ifdeà
__NR_£ndmsg


1787 
	#SYS_£ndmsg
 
__NR_£ndmsg


	)

1790 #ifdeà
__NR_£ndto


1791 
	#SYS_£ndto
 
__NR_£ndto


	)

1794 #ifdeà
__NR_£t_mempŞicy


1795 
	#SYS_£t_mempŞicy
 
__NR_£t_mempŞicy


	)

1798 #ifdeà
__NR_£t_robu¡_li¡


1799 
	#SYS_£t_robu¡_li¡
 
__NR_£t_robu¡_li¡


	)

1802 #ifdeà
__NR_£t_th»ad_¬—


1803 
	#SYS_£t_th»ad_¬—
 
__NR_£t_th»ad_¬—


	)

1806 #ifdeà
__NR_£t_tid_add»ss


1807 
	#SYS_£t_tid_add»ss
 
__NR_£t_tid_add»ss


	)

1810 #ifdeà
__NR_£tdomašÇme


1811 
	#SYS_£tdomašÇme
 
__NR_£tdomašÇme


	)

1814 #ifdeà
__NR_£tfsgid


1815 
	#SYS_£tfsgid
 
__NR_£tfsgid


	)

1818 #ifdeà
__NR_£tfsgid32


1819 
	#SYS_£tfsgid32
 
__NR_£tfsgid32


	)

1822 #ifdeà
__NR_£tfsuid


1823 
	#SYS_£tfsuid
 
__NR_£tfsuid


	)

1826 #ifdeà
__NR_£tfsuid32


1827 
	#SYS_£tfsuid32
 
__NR_£tfsuid32


	)

1830 #ifdeà
__NR_£tgid


1831 
	#SYS_£tgid
 
__NR_£tgid


	)

1834 #ifdeà
__NR_£tgid32


1835 
	#SYS_£tgid32
 
__NR_£tgid32


	)

1838 #ifdeà
__NR_£tgroups


1839 
	#SYS_£tgroups
 
__NR_£tgroups


	)

1842 #ifdeà
__NR_£tgroups32


1843 
	#SYS_£tgroups32
 
__NR_£tgroups32


	)

1846 #ifdeà
__NR_£th«


1847 
	#SYS_£th«
 
__NR_£th«


	)

1850 #ifdeà
__NR_£tho¡Çme


1851 
	#SYS_£tho¡Çme
 
__NR_£tho¡Çme


	)

1854 #ifdeà
__NR_£t™im”


1855 
	#SYS_£t™im”
 
__NR_£t™im”


	)

1858 #ifdeà
__NR_£Šs


1859 
	#SYS_£Šs
 
__NR_£Šs


	)

1862 #ifdeà
__NR_£gid


1863 
	#SYS_£gid
 
__NR_£gid


	)

1866 #ifdeà
__NR_£g½


1867 
	#SYS_£g½
 
__NR_£g½


	)

1870 #ifdeà
__NR_£riÜ™y


1871 
	#SYS_£riÜ™y
 
__NR_£riÜ™y


	)

1874 #ifdeà
__NR_£Œegid


1875 
	#SYS_£Œegid
 
__NR_£Œegid


	)

1878 #ifdeà
__NR_£Œegid32


1879 
	#SYS_£Œegid32
 
__NR_£Œegid32


	)

1882 #ifdeà
__NR_£Œesgid


1883 
	#SYS_£Œesgid
 
__NR_£Œesgid


	)

1886 #ifdeà
__NR_£Œesgid32


1887 
	#SYS_£Œesgid32
 
__NR_£Œesgid32


	)

1890 #ifdeà
__NR_£Œesuid


1891 
	#SYS_£Œesuid
 
__NR_£Œesuid


	)

1894 #ifdeà
__NR_£Œesuid32


1895 
	#SYS_£Œesuid32
 
__NR_£Œesuid32


	)

1898 #ifdeà
__NR_£Œeuid


1899 
	#SYS_£Œeuid
 
__NR_£Œeuid


	)

1902 #ifdeà
__NR_£Œeuid32


1903 
	#SYS_£Œeuid32
 
__NR_£Œeuid32


	)

1906 #ifdeà
__NR_£Œlim™


1907 
	#SYS_£Œlim™
 
__NR_£Œlim™


	)

1910 #ifdeà
__NR_£tsid


1911 
	#SYS_£tsid
 
__NR_£tsid


	)

1914 #ifdeà
__NR_£tsockİt


1915 
	#SYS_£tsockİt
 
__NR_£tsockİt


	)

1918 #ifdeà
__NR_£‰imeofday


1919 
	#SYS_£‰imeofday
 
__NR_£‰imeofday


	)

1922 #ifdeà
__NR_£tuid


1923 
	#SYS_£tuid
 
__NR_£tuid


	)

1926 #ifdeà
__NR_£tuid32


1927 
	#SYS_£tuid32
 
__NR_£tuid32


	)

1930 #ifdeà
__NR_£tx©Œ


1931 
	#SYS_£tx©Œ
 
__NR_£tx©Œ


	)

1934 #ifdeà
__NR_sg‘mask


1935 
	#SYS_sg‘mask
 
__NR_sg‘mask


	)

1938 #ifdeà
__NR_shm©


1939 
	#SYS_shm©
 
__NR_shm©


	)

1942 #ifdeà
__NR_shmùl


1943 
	#SYS_shmùl
 
__NR_shmùl


	)

1946 #ifdeà
__NR_shmdt


1947 
	#SYS_shmdt
 
__NR_shmdt


	)

1950 #ifdeà
__NR_shmg‘


1951 
	#SYS_shmg‘
 
__NR_shmg‘


	)

1954 #ifdeà
__NR_shutdown


1955 
	#SYS_shutdown
 
__NR_shutdown


	)

1958 #ifdeà
__NR_sigaùiÚ


1959 
	#SYS_sigaùiÚ
 
__NR_sigaùiÚ


	)

1962 #ifdeà
__NR_sig®t¡ack


1963 
	#SYS_sig®t¡ack
 
__NR_sig®t¡ack


	)

1966 #ifdeà
__NR_sigÇl


1967 
	#SYS_sigÇl
 
__NR_sigÇl


	)

1970 #ifdeà
__NR_sigÇlfd


1971 
	#SYS_sigÇlfd
 
__NR_sigÇlfd


	)

1974 #ifdeà
__NR_sigÇlfd4


1975 
	#SYS_sigÇlfd4
 
__NR_sigÇlfd4


	)

1978 #ifdeà
__NR_sig³ndšg


1979 
	#SYS_sig³ndšg
 
__NR_sig³ndšg


	)

1982 #ifdeà
__NR_sig´ocmask


1983 
	#SYS_sig´ocmask
 
__NR_sig´ocmask


	)

1986 #ifdeà
__NR_sig»tuº


1987 
	#SYS_sig»tuº
 
__NR_sig»tuº


	)

1990 #ifdeà
__NR_sigsu¥’d


1991 
	#SYS_sigsu¥’d
 
__NR_sigsu¥’d


	)

1994 #ifdeà
__NR_sock‘


1995 
	#SYS_sock‘
 
__NR_sock‘


	)

1998 #ifdeà
__NR_sock‘ÿÎ


1999 
	#SYS_sock‘ÿÎ
 
__NR_sock‘ÿÎ


	)

2002 #ifdeà
__NR_sock‘·œ


2003 
	#SYS_sock‘·œ
 
__NR_sock‘·œ


	)

2006 #ifdeà
__NR_¥liû


2007 
	#SYS_¥liû
 
__NR_¥liû


	)

2010 #ifdeà
__NR_¥u_ü—‹


2011 
	#SYS_¥u_ü—‹
 
__NR_¥u_ü—‹


	)

2014 #ifdeà
__NR_¥u_run


2015 
	#SYS_¥u_run
 
__NR_¥u_run


	)

2018 #ifdeà
__NR_s£tmask


2019 
	#SYS_s£tmask
 
__NR_s£tmask


	)

2022 #ifdeà
__NR_¡©


2023 
	#SYS_¡©
 
__NR_¡©


	)

2026 #ifdeà
__NR_¡©64


2027 
	#SYS_¡©64
 
__NR_¡©64


	)

2030 #ifdeà
__NR_¡©fs


2031 
	#SYS_¡©fs
 
__NR_¡©fs


	)

2034 #ifdeà
__NR_¡©fs64


2035 
	#SYS_¡©fs64
 
__NR_¡©fs64


	)

2038 #ifdeà
__NR_¡©x


2039 
	#SYS_¡©x
 
__NR_¡©x


	)

2042 #ifdeà
__NR_¡ime


2043 
	#SYS_¡ime
 
__NR_¡ime


	)

2046 #ifdeà
__NR_¡ty


2047 
	#SYS_¡ty
 
__NR_¡ty


	)

2050 #ifdeà
__NR_sub·ge_´Ù


2051 
	#SYS_sub·ge_´Ù
 
__NR_sub·ge_´Ù


	)

2054 #ifdeà
__NR_sw­cÚ‹xt


2055 
	#SYS_sw­cÚ‹xt
 
__NR_sw­cÚ‹xt


	)

2058 #ifdeà
__NR_sw­off


2059 
	#SYS_sw­off
 
__NR_sw­off


	)

2062 #ifdeà
__NR_sw­Ú


2063 
	#SYS_sw­Ú
 
__NR_sw­Ú


	)

2066 #ifdeà
__NR_sw™ch_’dŸn


2067 
	#SYS_sw™ch_’dŸn
 
__NR_sw™ch_’dŸn


	)

2070 #ifdeà
__NR_symlšk


2071 
	#SYS_symlšk
 
__NR_symlšk


	)

2074 #ifdeà
__NR_symlšk©


2075 
	#SYS_symlšk©
 
__NR_symlšk©


	)

2078 #ifdeà
__NR_sync


2079 
	#SYS_sync
 
__NR_sync


	)

2082 #ifdeà
__NR_sync_fe_¿nge


2083 
	#SYS_sync_fe_¿nge
 
__NR_sync_fe_¿nge


	)

2086 #ifdeà
__NR_sync_fe_¿nge2


2087 
	#SYS_sync_fe_¿nge2
 
__NR_sync_fe_¿nge2


	)

2090 #ifdeà
__NR_syncfs


2091 
	#SYS_syncfs
 
__NR_syncfs


	)

2094 #ifdeà
__NR_sys_debug_£tcÚ‹xt


2095 
	#SYS_sys_debug_£tcÚ‹xt
 
__NR_sys_debug_£tcÚ‹xt


	)

2098 #ifdeà
__NR_sys_•Şl_ü—‹


2099 
	#SYS_sys_•Şl_ü—‹
 
__NR_sys_•Şl_ü—‹


	)

2102 #ifdeà
__NR_sys_•Şl_ùl


2103 
	#SYS_sys_•Şl_ùl
 
__NR_sys_•Şl_ùl


	)

2106 #ifdeà
__NR_sys_•Şl_wa™


2107 
	#SYS_sys_•Şl_wa™
 
__NR_sys_•Şl_wa™


	)

2110 #ifdeà
__NR_sysÿÎ


2111 
	#SYS_sysÿÎ
 
__NR_sysÿÎ


	)

2114 #ifdeà
__NR_sysfs


2115 
	#SYS_sysfs
 
__NR_sysfs


	)

2118 #ifdeà
__NR_sysšfo


2119 
	#SYS_sysšfo
 
__NR_sysšfo


	)

2122 #ifdeà
__NR_sy¦og


2123 
	#SYS_sy¦og
 
__NR_sy¦og


	)

2126 #ifdeà
__NR_sysms


2127 
	#SYS_sysms
 
__NR_sysms


	)

2130 #ifdeà
__NR_‹e


2131 
	#SYS_‹e
 
__NR_‹e


	)

2134 #ifdeà
__NR_tgkl


2135 
	#SYS_tgkl
 
__NR_tgkl


	)

2138 #ifdeà
__NR_time


2139 
	#SYS_time
 
__NR_time


	)

2142 #ifdeà
__NR_tim”_ü—‹


2143 
	#SYS_tim”_ü—‹
 
__NR_tim”_ü—‹


	)

2146 #ifdeà
__NR_tim”_d–‘e


2147 
	#SYS_tim”_d–‘e
 
__NR_tim”_d–‘e


	)

2150 #ifdeà
__NR_tim”_g‘ov”run


2151 
	#SYS_tim”_g‘ov”run
 
__NR_tim”_g‘ov”run


	)

2154 #ifdeà
__NR_tim”_g‘time


2155 
	#SYS_tim”_g‘time
 
__NR_tim”_g‘time


	)

2158 #ifdeà
__NR_tim”_£‰ime


2159 
	#SYS_tim”_£‰ime
 
__NR_tim”_£‰ime


	)

2162 #ifdeà
__NR_tim”fd


2163 
	#SYS_tim”fd
 
__NR_tim”fd


	)

2166 #ifdeà
__NR_tim”fd_ü—‹


2167 
	#SYS_tim”fd_ü—‹
 
__NR_tim”fd_ü—‹


	)

2170 #ifdeà
__NR_tim”fd_g‘time


2171 
	#SYS_tim”fd_g‘time
 
__NR_tim”fd_g‘time


	)

2174 #ifdeà
__NR_tim”fd_£‰ime


2175 
	#SYS_tim”fd_£‰ime
 
__NR_tim”fd_£‰ime


	)

2178 #ifdeà
__NR_times


2179 
	#SYS_times
 
__NR_times


	)

2182 #ifdeà
__NR_tkl


2183 
	#SYS_tkl
 
__NR_tkl


	)

2186 #ifdeà
__NR_Œunÿ‹


2187 
	#SYS_Œunÿ‹
 
__NR_Œunÿ‹


	)

2190 #ifdeà
__NR_Œunÿ‹64


2191 
	#SYS_Œunÿ‹64
 
__NR_Œunÿ‹64


	)

2194 #ifdeà
__NR_tuxÿÎ


2195 
	#SYS_tuxÿÎ
 
__NR_tuxÿÎ


	)

2198 #ifdeà
__NR_ug‘¾im™


2199 
	#SYS_ug‘¾im™
 
__NR_ug‘¾im™


	)

2202 #ifdeà
__NR_ulim™


2203 
	#SYS_ulim™
 
__NR_ulim™


	)

2206 #ifdeà
__NR_umask


2207 
	#SYS_umask
 
__NR_umask


	)

2210 #ifdeà
__NR_umouÁ


2211 
	#SYS_umouÁ
 
__NR_umouÁ


	)

2214 #ifdeà
__NR_umouÁ2


2215 
	#SYS_umouÁ2
 
__NR_umouÁ2


	)

2218 #ifdeà
__NR_uÇme


2219 
	#SYS_uÇme
 
__NR_uÇme


	)

2222 #ifdeà
__NR_uÆšk


2223 
	#SYS_uÆšk
 
__NR_uÆšk


	)

2226 #ifdeà
__NR_uÆšk©


2227 
	#SYS_uÆšk©
 
__NR_uÆšk©


	)

2230 #ifdeà
__NR_unsh¬e


2231 
	#SYS_unsh¬e
 
__NR_unsh¬e


	)

2234 #ifdeà
__NR_u£lib


2235 
	#SYS_u£lib
 
__NR_u£lib


	)

2238 #ifdeà
__NR_u£rçuÉfd


2239 
	#SYS_u£rçuÉfd
 
__NR_u£rçuÉfd


	)

2242 #ifdeà
__NR_u¡©


2243 
	#SYS_u¡©
 
__NR_u¡©


	)

2246 #ifdeà
__NR_utime


2247 
	#SYS_utime
 
__NR_utime


	)

2250 #ifdeà
__NR_utim’§t


2251 
	#SYS_utim’§t
 
__NR_utim’§t


	)

2254 #ifdeà
__NR_utimes


2255 
	#SYS_utimes
 
__NR_utimes


	)

2258 #ifdeà
__NR_uŒ­_š¡®l


2259 
	#SYS_uŒ­_š¡®l
 
__NR_uŒ­_š¡®l


	)

2262 #ifdeà
__NR_vfÜk


2263 
	#SYS_vfÜk
 
__NR_vfÜk


	)

2266 #ifdeà
__NR_vhªgup


2267 
	#SYS_vhªgup
 
__NR_vhªgup


	)

2270 #ifdeà
__NR_vm86


2271 
	#SYS_vm86
 
__NR_vm86


	)

2274 #ifdeà
__NR_vm86Şd


2275 
	#SYS_vm86Şd
 
__NR_vm86Şd


	)

2278 #ifdeà
__NR_vm¥liû


2279 
	#SYS_vm¥liû
 
__NR_vm¥liû


	)

2282 #ifdeà
__NR_v£rv”


2283 
	#SYS_v£rv”
 
__NR_v£rv”


	)

2286 #ifdeà
__NR_wa™4


2287 
	#SYS_wa™4
 
__NR_wa™4


	)

2290 #ifdeà
__NR_wa™id


2291 
	#SYS_wa™id
 
__NR_wa™id


	)

2294 #ifdeà
__NR_wa™pid


2295 
	#SYS_wa™pid
 
__NR_wa™pid


	)

2298 #ifdeà
__NR_wr™e


2299 
	#SYS_wr™e
 
__NR_wr™e


	)

2302 #ifdeà
__NR_wr™ev


2303 
	#SYS_wr™ev
 
__NR_wr™ev


	)

	@/usr/include/bits/sysctl.h

18 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


	@/usr/include/bits/termios.h

19 #iâdeà
_TERMIOS_H


23 
	tcc_t
;

24 
	t¥“d_t
;

25 
	ttcæag_t
;

27 
	#NCCS
 32

	)

28 
	s‹rmios


30 
tcæag_t
 
	mc_iæag
;

31 
tcæag_t
 
	mc_oæag
;

32 
tcæag_t
 
	mc_cæag
;

33 
tcæag_t
 
	mc_læag
;

34 
cc_t
 
	mc_lše
;

35 
cc_t
 
	mc_cc
[
NCCS
];

36 
¥“d_t
 
	mc_i¥“d
;

37 
¥“d_t
 
	mc_o¥“d
;

38 
	#_HAVE_STRUCT_TERMIOS_C_ISPEED
 1

	)

39 
	#_HAVE_STRUCT_TERMIOS_C_OSPEED
 1

	)

43 
	#VINTR
 0

	)

44 
	#VQUIT
 1

	)

45 
	#VERASE
 2

	)

46 
	#VKILL
 3

	)

47 
	#VEOF
 4

	)

48 
	#VTIME
 5

	)

49 
	#VMIN
 6

	)

50 
	#VSWTC
 7

	)

51 
	#VSTART
 8

	)

52 
	#VSTOP
 9

	)

53 
	#VSUSP
 10

	)

54 
	#VEOL
 11

	)

55 
	#VREPRINT
 12

	)

56 
	#VDISCARD
 13

	)

57 
	#VWERASE
 14

	)

58 
	#VLNEXT
 15

	)

59 
	#VEOL2
 16

	)

62 
	#IGNBRK
 0000001

	)

63 
	#BRKINT
 0000002

	)

64 
	#IGNPAR
 0000004

	)

65 
	#PARMRK
 0000010

	)

66 
	#INPCK
 0000020

	)

67 
	#ISTRIP
 0000040

	)

68 
	#INLCR
 0000100

	)

69 
	#IGNCR
 0000200

	)

70 
	#ICRNL
 0000400

	)

71 
	#IUCLC
 0001000

	)

72 
	#IXON
 0002000

	)

73 
	#IXANY
 0004000

	)

74 
	#IXOFF
 0010000

	)

75 
	#IMAXBEL
 0020000

	)

76 
	#IUTF8
 0040000

	)

79 
	#OPOST
 0000001

	)

80 
	#OLCUC
 0000002

	)

81 
	#ONLCR
 0000004

	)

82 
	#OCRNL
 0000010

	)

83 
	#ONOCR
 0000020

	)

84 
	#ONLRET
 0000040

	)

85 
	#OFILL
 0000100

	)

86 
	#OFDEL
 0000200

	)

87 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


88 
	#NLDLY
 0000400

	)

89 
	#NL0
 0000000

	)

90 
	#NL1
 0000400

	)

91 
	#CRDLY
 0003000

	)

92 
	#CR0
 0000000

	)

93 
	#CR1
 0001000

	)

94 
	#CR2
 0002000

	)

95 
	#CR3
 0003000

	)

96 
	#TABDLY
 0014000

	)

97 
	#TAB0
 0000000

	)

98 
	#TAB1
 0004000

	)

99 
	#TAB2
 0010000

	)

100 
	#TAB3
 0014000

	)

101 
	#BSDLY
 0020000

	)

102 
	#BS0
 0000000

	)

103 
	#BS1
 0020000

	)

104 
	#FFDLY
 0100000

	)

105 
	#FF0
 0000000

	)

106 
	#FF1
 0100000

	)

109 
	#VTDLY
 0040000

	)

110 
	#VT0
 0000000

	)

111 
	#VT1
 0040000

	)

113 #ifdeà
__USE_MISC


114 
	#XTABS
 0014000

	)

118 #ifdeà
__USE_MISC


119 
	#CBAUD
 0010017

	)

121 
	#B0
 0000000

	)

122 
	#B50
 0000001

	)

123 
	#B75
 0000002

	)

124 
	#B110
 0000003

	)

125 
	#B134
 0000004

	)

126 
	#B150
 0000005

	)

127 
	#B200
 0000006

	)

128 
	#B300
 0000007

	)

129 
	#B600
 0000010

	)

130 
	#B1200
 0000011

	)

131 
	#B1800
 0000012

	)

132 
	#B2400
 0000013

	)

133 
	#B4800
 0000014

	)

134 
	#B9600
 0000015

	)

135 
	#B19200
 0000016

	)

136 
	#B38400
 0000017

	)

137 #ifdeà
__USE_MISC


138 
	#EXTA
 
B19200


	)

139 
	#EXTB
 
B38400


	)

141 
	#CSIZE
 0000060

	)

142 
	#CS5
 0000000

	)

143 
	#CS6
 0000020

	)

144 
	#CS7
 0000040

	)

145 
	#CS8
 0000060

	)

146 
	#CSTOPB
 0000100

	)

147 
	#CREAD
 0000200

	)

148 
	#PARENB
 0000400

	)

149 
	#PARODD
 0001000

	)

150 
	#HUPCL
 0002000

	)

151 
	#CLOCAL
 0004000

	)

152 #ifdeà
__USE_MISC


153 
	#CBAUDEX
 0010000

	)

155 
	#B57600
 0010001

	)

156 
	#B115200
 0010002

	)

157 
	#B230400
 0010003

	)

158 
	#B460800
 0010004

	)

159 
	#B500000
 0010005

	)

160 
	#B576000
 0010006

	)

161 
	#B921600
 0010007

	)

162 
	#B1000000
 0010010

	)

163 
	#B1152000
 0010011

	)

164 
	#B1500000
 0010012

	)

165 
	#B2000000
 0010013

	)

166 
	#B2500000
 0010014

	)

167 
	#B3000000
 0010015

	)

168 
	#B3500000
 0010016

	)

169 
	#B4000000
 0010017

	)

170 
	#__MAX_BAUD
 
B4000000


	)

171 #ifdeà
__USE_MISC


172 
	#CIBAUD
 002003600000

	)

173 
	#CMSPAR
 010000000000

	)

174 
	#CRTSCTS
 020000000000

	)

178 
	#ISIG
 0000001

	)

179 
	#ICANON
 0000002

	)

180 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

181 
	#XCASE
 0000004

	)

183 
	#ECHO
 0000010

	)

184 
	#ECHOE
 0000020

	)

185 
	#ECHOK
 0000040

	)

186 
	#ECHONL
 0000100

	)

187 
	#NOFLSH
 0000200

	)

188 
	#TOSTOP
 0000400

	)

189 #ifdeà
__USE_MISC


190 
	#ECHOCTL
 0001000

	)

191 
	#ECHOPRT
 0002000

	)

192 
	#ECHOKE
 0004000

	)

193 
	#FLUSHO
 0010000

	)

194 
	#PENDIN
 0040000

	)

196 
	#IEXTEN
 0100000

	)

197 #ifdeà
__USE_MISC


198 
	#EXTPROC
 0200000

	)

202 
	#TCOOFF
 0

	)

203 
	#TCOON
 1

	)

204 
	#TCIOFF
 2

	)

205 
	#TCION
 3

	)

208 
	#TCIFLUSH
 0

	)

209 
	#TCOFLUSH
 1

	)

210 
	#TCIOFLUSH
 2

	)

213 
	#TCSANOW
 0

	)

214 
	#TCSADRAIN
 1

	)

215 
	#TCSAFLUSH
 2

	)

218 
	#_IOT_‹rmios
 \

219 
	`_IOT
 (
	`_IOTS
 (
cæag_t
), 4, _IOTS (
cc_t
), 
NCCS
, _IOTS (
¥“d_t
), 2)

	)

	@/usr/include/bits/time.h

23 #iâdeà
_BITS_TIME_H


24 
	#_BITS_TIME_H
 1

	)

26 
	~<b™s/ty³s.h
>

34 
	#CLOCKS_PER_SEC
 ((
__şock_t
è1000000)

	)

36 #ià(!
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_POSIX
) \

37 && !
defšed
 
__USE_XOPEN2K


40 
__syscÚf
 ();

41 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

44 #ifdeà
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

54 
	#CLOCK_MONOTONIC_RAW
 4

	)

56 
	#CLOCK_REALTIME_COARSE
 5

	)

58 
	#CLOCK_MONOTONIC_COARSE
 6

	)

60 
	#CLOCK_BOOTTIME
 7

	)

62 
	#CLOCK_REALTIME_ALARM
 8

	)

64 
	#CLOCK_BOOTTIME_ALARM
 9

	)

66 
	#CLOCK_TAI
 11

	)

69 
	#TIMER_ABSTIME
 1

	)

72 #ifdeà
__USE_GNU


73 
	~<b™s/timex.h
>

75 
__BEGIN_DECLS


78 
	$şock_adjtime
 (
__şockid_t
 
__şock_id
, 
timex
 *
__utx
è
__THROW
;

80 
__END_DECLS


	@/usr/include/bits/types.h

23 #iâdef 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wÜdsize.h
>

30 
	t__u_ch¬
;

31 
	t__u_shÜt
;

32 
	t__u_št
;

33 
	t__u_lÚg
;

36 sigÃd 
	t__št8_t
;

37 
	t__ušt8_t
;

38 sigÃd 
	t__št16_t
;

39 
	t__ušt16_t
;

40 sigÃd 
	t__št32_t
;

41 
	t__ušt32_t
;

42 #ià
__WORDSIZE
 == 64

43 sigÃd 
	t__št64_t
;

44 
	t__ušt64_t
;

46 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

47 
__ex‹nsiÚ__
 
	t__ušt64_t
;

51 #ià
__WORDSIZE
 == 64

52 
	t__quad_t
;

53 
	t__u_quad_t
;

55 
__ex‹nsiÚ__
 
	t__quad_t
;

56 
__ex‹nsiÚ__
 
	t__u_quad_t
;

60 #ià
__WORDSIZE
 == 64

61 
	t__štmax_t
;

62 
	t__uštmax_t
;

64 
__ex‹nsiÚ__
 
	t__štmax_t
;

65 
__ex‹nsiÚ__
 
	t__uštmax_t
;

98 
	#__S16_TYPE
 

	)

99 
	#__U16_TYPE
 

	)

100 
	#__S32_TYPE
 

	)

101 
	#__U32_TYPE
 

	)

102 
	#__SLONGWORD_TYPE
 

	)

103 
	#__ULONGWORD_TYPE
 

	)

104 #ià
__WORDSIZE
 == 32

105 
	#__SQUAD_TYPE
 
__quad_t


	)

106 
	#__UQUAD_TYPE
 
__u_quad_t


	)

107 
	#__SWORD_TYPE
 

	)

108 
	#__UWORD_TYPE
 

	)

109 
	#__SLONG32_TYPE
 

	)

110 
	#__ULONG32_TYPE
 

	)

111 
	#__S64_TYPE
 
__quad_t


	)

112 
	#__U64_TYPE
 
__u_quad_t


	)

115 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

116 #–ià
__WORDSIZE
 == 64

117 
	t__SQUAD_TYPE
 

	)

118 
	t__UQUAD_TYPE
 

	)

119 
	t__SWORD_TYPE
 

	)

120 
	t__UWORD_TYPE
 

	)

121 
	t__SLONG32_TYPE
 

	)

122 
	t__ULONG32_TYPE
 

	)

123 
	t__S64_TYPE
 

	)

124 
	t__U64_TYPE
 

	)

126 
	t__STD_TYPE
 

	)

130 
	~<b™s/ty³sizes.h
>

133 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

134 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

135 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

136 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

137 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

138 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

139 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

140 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

141 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

142 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

143 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

144 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

145 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

146 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

147 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

148 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

149 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

150 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

152 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

153 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

156 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

159 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

162 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

167 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

168 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

171 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

172 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

175 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

176 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

179 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fswÜd_t
;

181 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysÿÎ_¦Úg_t
;

186 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysÿÎ_ulÚg_t
;

190 
__off64_t
 
	t__loff_t
;

191 *
	t__ÿddr_t
;

194 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

197 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

202 
	t__sig_©omic_t
;

204 #undeà
__STD_TYPE


	@/usr/include/bits/types/FILE.h

1 #iâdeà
__FILE_defšed


2 
	#__FILE_defšed
 1

	)

4 
	g_IO_FILE
;

7 
_IO_FILE
 
	tFILE
;

	@/usr/include/bits/types/__FILE.h

1 #iâdeà
____FILE_defšed


2 
	#____FILE_defšed
 1

	)

4 
	g_IO_FILE
;

5 
_IO_FILE
 
	t__FILE
;

	@/usr/include/bits/types/__sigset_t.h

1 #iâdeà
____sig£t_t_defšed


2 
	#____sig£t_t_defšed


	)

4 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

7 
	m__v®
[
_SIGSET_NWORDS
];

8 } 
	t__sig£t_t
;

	@/usr/include/bits/types/clock_t.h

1 #iâdeà
__şock_t_defšed


2 
	#__şock_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__şock_t
 
	tşock_t
;

	@/usr/include/bits/types/clockid_t.h

1 #iâdeà
__şockid_t_defšed


2 
	#__şockid_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__şockid_t
 
	tşockid_t
;

	@/usr/include/bits/types/locale_t.h

19 #iâdeà
_BITS_TYPES_LOCALE_T_H


20 
	#_BITS_TYPES_LOCALE_T_H
 1

	)

22 
	~<b™s/ty³s/__loÿË_t.h
>

24 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/bits/types/mbstate_t.h

1 #iâdeà
__mb¡©e_t_defšed


2 
	#__mb¡©e_t_defšed
 1

	)

4 
	~<b™s/ty³s/__mb¡©e_t.h
>

6 
__mb¡©e_t
 
	tmb¡©e_t
;

	@/usr/include/bits/types/sig_atomic_t.h

1 #iâdeà
__sig_©omic_t_defšed


2 
	#__sig_©omic_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

8 
__sig_©omic_t
 
	tsig_©omic_t
;

	@/usr/include/bits/types/sigevent_t.h

1 #iâdeà
__sigev’t_t_defšed


2 
	#__sigev’t_t_defšed
 1

	)

4 
	~<b™s/wÜdsize.h
>

5 
	~<b™s/ty³s.h
>

6 
	~<b™s/ty³s/__sigv®_t.h
>

8 
	#__SIGEV_MAX_SIZE
 64

	)

9 #ià
__WORDSIZE
 == 64

10 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 4)

	)

12 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 3)

	)

16 #iâdeà
__have_±h»ad_©Œ_t


17 
±h»ad_©Œ_t
 
	t±h»ad_©Œ_t
;

18 
	#__have_±h»ad_©Œ_t
 1

	)

22 
	ssigev’t


24 
__sigv®_t
 
	msigev_v®ue
;

25 
	msigev_signo
;

26 
	msigev_nÙify
;

30 
	m_·d
[
__SIGEV_PAD_SIZE
];

34 
__pid_t
 
	m_tid
;

38 (*
	m_funùiÚ
è(
	m__sigv®_t
);

39 
±h»ad_©Œ_t
 *
	m_©Œibu‹
;

40 } 
	m_sigev_th»ad
;

41 } 
	m_sigev_un
;

42 } 
	tsigev’t_t
;

45 
	#sigev_nÙify_funùiÚ
 
_sigev_un
.
_sigev_th»ad
.
_funùiÚ


	)

46 
	#sigev_nÙify_©Œibu‹s
 
_sigev_un
.
_sigev_th»ad
.
_©Œibu‹


	)

	@/usr/include/bits/types/siginfo_t.h

1 #iâdeà
__sigšfo_t_defšed


2 
	#__sigšfo_t_defšed
 1

	)

4 
	~<b™s/wÜdsize.h
>

5 
	~<b™s/ty³s.h
>

6 
	~<b™s/ty³s/__sigv®_t.h
>

8 
	#__SI_MAX_SIZE
 128

	)

9 #ià
__WORDSIZE
 == 64

10 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 4)

	)

12 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 3)

	)

16 
	~<b™s/sigšfo-¬ch.h
>

17 #iâdeà
__SI_ALIGNMENT


18 
	#__SI_ALIGNMENT


	)

20 #iâdeà
__SI_BAND_TYPE


21 
	#__SI_BAND_TYPE
 

	)

23 #iâdeà
__SI_CLOCK_T


24 
	#__SI_CLOCK_T
 
__şock_t


	)

26 #iâdeà
__SI_ERRNO_THEN_CODE


27 
	#__SI_ERRNO_THEN_CODE
 1

	)

29 #iâdeà
__SI_HAVE_SIGSYS


30 
	#__SI_HAVE_SIGSYS
 1

	)

32 #iâdeà
__SI_SIGFAULT_ADDL


33 
	#__SI_SIGFAULT_ADDL


	)

38 
	msi_signo
;

39 #ià
__SI_ERRNO_THEN_CODE


40 
	msi_”ºo
;

42 
	msi_code
;

44 
	msi_code
;

45 
	msi_”ºo
;

47 #ià
__WORDSIZE
 == 64

48 
	m__·d0
;

53 
	m_·d
[
__SI_PAD_SIZE
];

58 
__pid_t
 
	msi_pid
;

59 
__uid_t
 
	msi_uid
;

60 } 
	m_kl
;

65 
	msi_tid
;

66 
	msi_ov”run
;

67 
__sigv®_t
 
	msi_sigv®
;

68 } 
	m_tim”
;

73 
__pid_t
 
	msi_pid
;

74 
__uid_t
 
	msi_uid
;

75 
__sigv®_t
 
	msi_sigv®
;

76 } 
	m_¹
;

81 
__pid_t
 
	msi_pid
;

82 
__uid_t
 
	msi_uid
;

83 
	msi_¡©us
;

84 
__SI_CLOCK_T
 
	msi_utime
;

85 
__SI_CLOCK_T
 
	msi_¡ime
;

86 } 
	m_sigchld
;

91 *
	msi_addr
;

92 
__SI_SIGFAULT_ADDL


93 
	msi_addr_lsb
;

99 *
	m_low”
;

100 *
	m_uµ”
;

101 } 
	m_addr_bnd
;

103 
__ušt32_t
 
	m_pkey
;

104 } 
	m_bounds
;

105 } 
	m_sigçuÉ
;

110 
__SI_BAND_TYPE
 
	msi_bªd
;

111 
	msi_fd
;

112 } 
	m_sigpŞl
;

115 #ià
__SI_HAVE_SIGSYS


118 *
	m_ÿÎ_addr
;

119 
	m_sysÿÎ
;

120 
	m_¬ch
;

121 } 
	m_sigsys
;

123 } 
	m_sif›lds
;

124 } 
	tsigšfo_t
 
	t__SI_ALIGNMENT
;

128 
	#si_pid
 
_sif›lds
.
_kl
.
si_pid


	)

129 
	#si_uid
 
_sif›lds
.
_kl
.
si_uid


	)

130 
	#si_tim”id
 
_sif›lds
.
_tim”
.
si_tid


	)

131 
	#si_ov”run
 
_sif›lds
.
_tim”
.
si_ov”run


	)

132 
	#si_¡©us
 
_sif›lds
.
_sigchld
.
si_¡©us


	)

133 
	#si_utime
 
_sif›lds
.
_sigchld
.
si_utime


	)

134 
	#si_¡ime
 
_sif›lds
.
_sigchld
.
si_¡ime


	)

135 
	#si_v®ue
 
_sif›lds
.
_¹
.
si_sigv®


	)

136 
	#si_št
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_št


	)

137 
	#si_±r
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_±r


	)

138 
	#si_addr
 
_sif›lds
.
_sigçuÉ
.
si_addr


	)

139 
	#si_addr_lsb
 
_sif›lds
.
_sigçuÉ
.
si_addr_lsb


	)

140 
	#si_low”
 
_sif›lds
.
_sigçuÉ
.
_bounds
.
_addr_bnd
.
_low”


	)

141 
	#si_uµ”
 
_sif›lds
.
_sigçuÉ
.
_bounds
.
_addr_bnd
.
_uµ”


	)

142 
	#si_pkey
 
_sif›lds
.
_sigçuÉ
.
_bounds
.
_pkey


	)

143 
	#si_bªd
 
_sif›lds
.
_sigpŞl
.
si_bªd


	)

144 
	#si_fd
 
_sif›lds
.
_sigpŞl
.
si_fd


	)

145 #ià
__SI_HAVE_SIGSYS


146 
	#si_ÿÎ_addr
 
_sif›lds
.
_sigsys
.
_ÿÎ_addr


	)

147 
	#si_sysÿÎ
 
_sif›lds
.
_sigsys
.
_sysÿÎ


	)

148 
	#si_¬ch
 
_sif›lds
.
_sigsys
.
_¬ch


	)

	@/usr/include/bits/types/sigset_t.h

1 #iâdeà
__sig£t_t_defšed


2 
	#__sig£t_t_defšed
 1

	)

4 
	~<b™s/ty³s/__sig£t_t.h
>

7 
__sig£t_t
 
	tsig£t_t
;

	@/usr/include/bits/types/sigval_t.h

1 #iâdeà
__sigv®_t_defšed


2 
	#__sigv®_t_defšed


	)

4 
	~<b™s/ty³s/__sigv®_t.h
>

12 #iâdeà
__USE_POSIX199309


16 
__sigv®_t
 
	tsigv®_t
;

	@/usr/include/bits/types/stack_t.h

19 #iâdeà
__¡ack_t_defšed


20 
	#__¡ack_t_defšed
 1

	)

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

28 *
	mss_¥
;

29 
	mss_æags
;

30 
size_t
 
	mss_size
;

31 } 
	t¡ack_t
;

	@/usr/include/bits/types/struct_iovec.h

19 #iâdeà
__iovec_defšed


20 
	#__iovec_defšed
 1

	)

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

26 
	siovec


28 *
	miov_ba£
;

29 
size_t
 
	miov_Ën
;

	@/usr/include/bits/types/struct_itimerspec.h

1 #iâdeà
__™im”¥ec_defšed


2 
	#__™im”¥ec_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

5 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

8 
	s™im”¥ec


10 
time¥ec
 
	m™_š‹rv®
;

11 
time¥ec
 
	m™_v®ue
;

	@/usr/include/bits/types/struct_osockaddr.h

1 #iâdeà
__osockaddr_defšed


2 
	#__osockaddr_defšed
 1

	)

6 
	sosockaddr


8 
	m§_çmy
;

9 
	m§_d©a
[14];

	@/usr/include/bits/types/struct_rusage.h

19 #iâdeà
__ru§ge_defšed


20 
	#__ru§ge_defšed
 1

	)

22 
	~<b™s/ty³s.h
>

23 
	~<b™s/ty³s/¡ruù_timev®.h
>

31 
	sru§ge


34 
timev®
 
	mru_utime
;

36 
timev®
 
	mru_¡ime
;

38 
__ex‹nsiÚ__
 union

40 
	mru_maxrss
;

41 
__sysÿÎ_¦Úg_t
 
	m__ru_maxrss_wÜd
;

46 
__ex‹nsiÚ__
 union

48 
	mru_ixrss
;

49 
__sysÿÎ_¦Úg_t
 
	m__ru_ixrss_wÜd
;

52 
__ex‹nsiÚ__
 union

54 
	mru_idrss
;

55 
__sysÿÎ_¦Úg_t
 
	m__ru_idrss_wÜd
;

58 
__ex‹nsiÚ__
 union

60 
	mru_i¤ss
;

61 
__sysÿÎ_¦Úg_t
 
	m__ru_i¤ss_wÜd
;

65 
__ex‹nsiÚ__
 union

67 
	mru_mšæt
;

68 
__sysÿÎ_¦Úg_t
 
	m__ru_mšæt_wÜd
;

71 
__ex‹nsiÚ__
 union

73 
	mru_majæt
;

74 
__sysÿÎ_¦Úg_t
 
	m__ru_majæt_wÜd
;

77 
__ex‹nsiÚ__
 union

79 
	mru_nsw­
;

80 
__sysÿÎ_¦Úg_t
 
	m__ru_nsw­_wÜd
;

84 
__ex‹nsiÚ__
 union

86 
	mru_šblock
;

87 
__sysÿÎ_¦Úg_t
 
	m__ru_šblock_wÜd
;

90 
__ex‹nsiÚ__
 union

92 
	mru_oublock
;

93 
__sysÿÎ_¦Úg_t
 
	m__ru_oublock_wÜd
;

96 
__ex‹nsiÚ__
 union

98 
	mru_msg¢d
;

99 
__sysÿÎ_¦Úg_t
 
	m__ru_msg¢d_wÜd
;

102 
__ex‹nsiÚ__
 union

104 
	mru_msgrcv
;

105 
__sysÿÎ_¦Úg_t
 
	m__ru_msgrcv_wÜd
;

108 
__ex‹nsiÚ__
 union

110 
	mru_nsigÇls
;

111 
__sysÿÎ_¦Úg_t
 
	m__ru_nsigÇls_wÜd
;

116 
__ex‹nsiÚ__
 union

118 
	mru_nvcsw
;

119 
__sysÿÎ_¦Úg_t
 
	m__ru_nvcsw_wÜd
;

123 
__ex‹nsiÚ__
 union

125 
	mru_nivcsw
;

126 
__sysÿÎ_¦Úg_t
 
	m__ru_nivcsw_wÜd
;

	@/usr/include/bits/types/struct_sigstack.h

19 #iâdeà
__sig¡ack_defšed


20 
	#__sig¡ack_defšed
 1

	)

23 
	ssig¡ack


25 *
	mss_¥
;

26 
	mss_Ú¡ack
;

	@/usr/include/bits/types/struct_timespec.h

2 #iâdeà
_STRUCT_TIMESPEC


3 
	#_STRUCT_TIMESPEC
 1

	)

5 
	~<b™s/ty³s.h
>

9 
	stime¥ec


11 
__time_t
 
	mtv_£c
;

12 
__sysÿÎ_¦Úg_t
 
	mtv_n£c
;

	@/usr/include/bits/types/struct_timeval.h

1 #iâdeà
__timev®_defšed


2 
	#__timev®_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

8 
	stimev®


10 
__time_t
 
	mtv_£c
;

11 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/bits/types/struct_tm.h

1 #iâdeà
__¡ruù_tm_defšed


2 
	#__¡ruù_tm_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
	stm


9 
	mtm_£c
;

10 
	mtm_mš
;

11 
	mtm_hour
;

12 
	mtm_mday
;

13 
	mtm_mÚ
;

14 
	mtm_y—r
;

15 
	mtm_wday
;

16 
	mtm_yday
;

17 
	mtm_isd¡
;

19 #ifdef 
__USE_MISC


20 
	mtm_gmtoff
;

21 cÚ¡ *
	mtm_zÚe
;

23 
	m__tm_gmtoff
;

24 cÚ¡ *
	m__tm_zÚe
;

	@/usr/include/bits/types/time_t.h

1 #iâdeà
__time_t_defšed


2 
	#__time_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__time_t
 
	ttime_t
;

	@/usr/include/bits/types/timer_t.h

1 #iâdeà
__tim”_t_defšed


2 
	#__tim”_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__tim”_t
 
	ttim”_t
;

	@/usr/include/bits/types/wint_t.h

1 #iâdeà
__wšt_t_defšed


2 
	#__wšt_t_defšed
 1

	)

9 #iâdeà
_WINT_T


10 
	#_WINT_T
 1

	)

16 #iâdeà
__WINT_TYPE__


17 
	#__WINT_TYPE__
 

	)

20 
__WINT_TYPE__
 
	twšt_t
;

	@/usr/include/bits/uintn-identity.h

19 #ià!
defšed
 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


23 #iâdeà
_BITS_UINTN_IDENTITY_H


24 
	#_BITS_UINTN_IDENTITY_H
 1

	)

26 
	~<b™s/ty³s.h
>

32 
__šlše
 
__ušt16_t


33 
	$__ušt16_id’t™y
 (
__ušt16_t
 
__x
)

35  
__x
;

36 
	}
}

38 
__šlše
 
__ušt32_t


39 
	$__ušt32_id’t™y
 (
__ušt32_t
 
__x
)

41  
__x
;

42 
	}
}

44 
__šlše
 
__ušt64_t


45 
	$__ušt64_id’t™y
 (
__ušt64_t
 
__x
)

47  
__x
;

48 
	}
}

	@/usr/include/bits/uio-ext.h

19 #iâdeà
_BITS_UIO_EXT_H


20 
	#_BITS_UIO_EXT_H
 1

	)

22 #iâdeà
_SYS_UIO_H


26 
__BEGIN_DECLS


29 
ssize_t
 
	$´oûss_vm_»adv
 (
pid_t
 
__pid
, cÚ¡ 
iovec
 *
__lvec
,

30 
__liovút
,

31 cÚ¡ 
iovec
 *
__rvec
,

32 
__riovút
,

33 
__æags
)

34 
__THROW
;

37 
ssize_t
 
	$´oûss_vm_wr™ev
 (
pid_t
 
__pid
, cÚ¡ 
iovec
 *
__lvec
,

38 
__liovút
,

39 cÚ¡ 
iovec
 *
__rvec
,

40 
__riovút
,

41 
__æags
)

42 
__THROW
;

45 
	#RWF_HIPRI
 0x00000001

	)

46 
	#RWF_DSYNC
 0x00000002

	)

47 
	#RWF_SYNC
 0x00000004

	)

48 
	#RWF_NOWAIT
 0x00000008

	)

49 
	#RWF_APPEND
 0x00000010

	)

51 
__END_DECLS


	@/usr/include/bits/uio_lim.h

19 #iâdeà
_BITS_UIO_LIM_H


20 
	#_BITS_UIO_LIM_H
 1

	)

30 
	#__IOV_MAX
 1024

	)

	@/usr/include/bits/unistd.h

19 #iâdeà
_UNISTD_H


23 
ssize_t
 
	$__»ad_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

24 
size_t
 
__buæ’
è
__wur
;

25 
ssize_t
 
	`__REDIRECT
 (
__»ad_®Ÿs
, (
__fd
, *
__buf
,

26 
size_t
 
__nby‹s
), 
»ad
è
__wur
;

27 
ssize_t
 
	`__REDIRECT
 (
__»ad_chk_w¬n
,

28 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

29 
size_t
 
__buæ’
), 
__»ad_chk
)

30 
__wur
 
	`__w¬Ç‰r
 ("read called with bigger†engthhan size of "

33 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


34 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
)

36 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

38 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

39  
	`__»ad_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

41 ià(
__nby‹s
 > 
	`__bos0
 (
__buf
))

42  
	`__»ad_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

44  
	`__»ad_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
);

45 
	}
}

47 #ifdeà
__USE_UNIX98


48 
ssize_t
 
	$__´—d_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

49 
__off_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

50 
ssize_t
 
	$__´—d64_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

51 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

52 
ssize_t
 
	`__REDIRECT
 (
__´—d_®Ÿs
,

53 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

54 
__off_t
 
__off£t
), 
´—d
è
__wur
;

55 
ssize_t
 
	`__REDIRECT
 (
__´—d64_®Ÿs
,

56 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

57 
__off64_t
 
__off£t
), 
´—d64
è
__wur
;

58 
ssize_t
 
	`__REDIRECT
 (
__´—d_chk_w¬n
,

59 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

60 
__off_t
 
__off£t
, 
size_t
 
__bufsize
), 
__´—d_chk
)

61 
__wur
 
	`__w¬Ç‰r
 ("pread called with bigger†engthhan size of "

63 
ssize_t
 
	`__REDIRECT
 (
__´—d64_chk_w¬n
,

64 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

65 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
),

66 
__´—d64_chk
)

67 
__wur
 
	`__w¬Ç‰r
 ("pread64 called with bigger†engthhan size of "

70 #iâdeà
__USE_FILE_OFFSET64


71 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


72 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off_t
 
__off£t
)

74 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

76 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

77  
	`__´—d_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

79 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

80  
	`__´—d_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

81 
	`__bos0
 (
__buf
));

83  
	`__´—d_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

84 
	}
}

86 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


87 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

89 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

91 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

92  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

94 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

95  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

96 
	`__bos0
 (
__buf
));

99  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

100 
	}
}

103 #ifdeà
__USE_LARGEFILE64


104 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


105 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

107 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

109 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

110  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

112 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

113  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

114 
	`__bos0
 (
__buf
));

117  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

118 
	}
}

122 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


123 
ssize_t
 
	$__»adlšk_chk
 (cÚ¡ *
__»¡riù
 
__·th
,

124 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

125 
size_t
 
__buæ’
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

127 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_®Ÿs
,

128 (cÚ¡ *
__»¡riù
 
__·th
,

129 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
), 
»adlšk
)

130 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

131 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_chk_w¬n
,

132 (cÚ¡ *
__»¡riù
 
__·th
,

133 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

134 
size_t
 
__buæ’
), 
__»adlšk_chk
)

135 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
	`__w¬Ç‰r
 ("readlink called with bigger†ength "

138 
__fÜtify_funùiÚ
 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
ssize_t


139 
	`__NTH
 (
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
, *__»¡riù 
__buf
,

140 
size_t
 
__Ën
))

142 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

144 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

145  
	`__»adlšk_chk
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

147 iàĞ
__Ën
 > 
	`__bos
 (
__buf
))

148  
	`__»adlšk_chk_w¬n
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

150  
	`__»adlšk_®Ÿs
 (
__·th
, 
__buf
, 
__Ën
);

151 
	}
}

154 #ifdeà
__USE_ATFILE


155 
ssize_t
 
	$__»adlšk©_chk
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

156 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

157 
size_t
 
__buæ’
)

158 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

159 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_®Ÿs
,

160 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

161 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
),

162 
»adlšk©
)

163 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

164 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_chk_w¬n
,

165 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

166 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

167 
size_t
 
__buæ’
), 
__»adlšk©_chk
)

168 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
	`__w¬Ç‰r
 ("readlinkat called with bigger "

172 
__fÜtify_funùiÚ
 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
ssize_t


173 
	`__NTH
 (
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

174 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
))

176 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

178 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

179  
	`__»adlšk©_chk
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

181 ià(
__Ën
 > 
	`__bos
 (
__buf
))

182  
	`__»adlšk©_chk_w¬n
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
,

183 
	`__bos
 (
__buf
));

185  
	`__»adlšk©_®Ÿs
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
);

186 
	}
}

189 *
	$__g‘cwd_chk
 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
)

190 
__THROW
 
__wur
;

191 *
	`__REDIRECT_NTH
 (
__g‘cwd_®Ÿs
,

192 (*
__buf
, 
size_t
 
__size
), 
g‘cwd
è
__wur
;

193 *
	`__REDIRECT_NTH
 (
__g‘cwd_chk_w¬n
,

194 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
),

195 
__g‘cwd_chk
)

196 
__wur
 
	`__w¬Ç‰r
 ("getcwd caller with bigger†engthhan size of "

199 
__fÜtify_funùiÚ
 
__wur
 *

200 
	`__NTH
 (
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
))

202 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

204 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
))

205  
	`__g‘cwd_chk
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

207 ià(
__size
 > 
	`__bos
 (
__buf
))

208  
	`__g‘cwd_chk_w¬n
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

210  
	`__g‘cwd_®Ÿs
 (
__buf
, 
__size
);

211 
	}
}

213 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


214 *
	$__g‘wd_chk
 (*
__buf
, 
size_t
 
buæ’
)

215 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

216 *
	`__REDIRECT_NTH
 (
__g‘wd_w¬n
, (*
__buf
), 
g‘wd
)

217 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("please use getcwd instead,‡s getwd "

220 
__fÜtify_funùiÚ
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
 *

221 
	`__NTH
 (
	$g‘wd
 (*
__buf
))

223 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

224  
	`__g‘wd_chk
 (
__buf
, 
	`__bos
 (__buf));

225  
	`__g‘wd_w¬n
 (
__buf
);

226 
	}
}

229 
size_t
 
	$__cÚf¡r_chk
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

230 
size_t
 
__buæ’
è
__THROW
;

231 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_®Ÿs
, (
__Çme
, *
__buf
,

232 
size_t
 
__Ën
), 
cÚf¡r
);

233 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_chk_w¬n
,

234 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

235 
size_t
 
__buæ’
), 
__cÚf¡r_chk
)

236 
	`__w¬Ç‰r
 ("confstr called with bigger†engthhan size of destination "

239 
__fÜtify_funùiÚ
 
size_t


240 
	`__NTH
 (
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
))

242 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

244 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

245  
	`__cÚf¡r_chk
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

247 ià(
	`__bos
 (
__buf
è< 
__Ën
)

248  
	`__cÚf¡r_chk_w¬n
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

250  
	`__cÚf¡r_®Ÿs
 (
__Çme
, 
__buf
, 
__Ën
);

251 
	}
}

254 
	$__g‘groups_chk
 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
)

255 
__THROW
 
__wur
;

256 
	`__REDIRECT_NTH
 (
__g‘groups_®Ÿs
, (
__size
, 
__gid_t
 
__li¡
[]),

257 
g‘groups
è
__wur
;

258 
	`__REDIRECT_NTH
 (
__g‘groups_chk_w¬n
,

259 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
),

260 
__g‘groups_chk
)

261 
__wur
 
	`__w¬Ç‰r
 ("getgroups called with bigger group counthan what "

264 
__fÜtify_funùiÚ
 

265 
	`__NTH
 (
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]))

267 ià(
	`__bos
 (
__li¡
è!ğ(
size_t
) -1)

269 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
) || __size < 0)

270  
	`__g‘groups_chk
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

272 ià(
__size
 *  (
__gid_t
è> 
	`__bos
 (
__li¡
))

273  
	`__g‘groups_chk_w¬n
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

275  
	`__g‘groups_®Ÿs
 (
__size
, 
__li¡
);

276 
	}
}

279 
	$__‰yÇme_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

280 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

281 
	`__REDIRECT_NTH
 (
__‰yÇme_r_®Ÿs
, (
__fd
, *
__buf
,

282 
size_t
 
__buæ’
), 
‰yÇme_r
)

283 
	`__nÚnuÎ
 ((2));

284 
	`__REDIRECT_NTH
 (
__‰yÇme_r_chk_w¬n
,

285 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

286 
size_t
 
__Ä—l
), 
__‰yÇme_r_chk
)

287 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ttyname_r called with bigger buflenhan "

290 
__fÜtify_funùiÚ
 

291 
	`__NTH
 (
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

293 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

295 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

296  
	`__‰yÇme_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

298 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

299  
	`__‰yÇme_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

301  
	`__‰yÇme_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

302 
	}
}

305 #ifdeà
__USE_POSIX199506


306 
	$__g‘logš_r_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

307 
	`__nÚnuÎ
 ((1));

308 
	`__REDIRECT
 (
__g‘logš_r_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

309 
g‘logš_r
è
	`__nÚnuÎ
 ((1));

310 
	`__REDIRECT
 (
__g‘logš_r_chk_w¬n
,

311 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

312 
__g‘logš_r_chk
)

313 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("getlogin_r called with bigger buflenhan "

316 
__fÜtify_funùiÚ
 

317 
	$g‘logš_r
 (*
__buf
, 
size_t
 
__buæ’
)

319 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

321 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

322  
	`__g‘logš_r_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

324 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

325  
	`__g‘logš_r_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

327  
	`__g‘logš_r_®Ÿs
 (
__buf
, 
__buæ’
);

328 
	}
}

332 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_UNIX98


333 
	$__g‘ho¡Çme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

334 
__THROW
 
	`__nÚnuÎ
 ((1));

335 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

336 
g‘ho¡Çme
è
	`__nÚnuÎ
 ((1));

337 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_chk_w¬n
,

338 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

339 
__g‘ho¡Çme_chk
)

340 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("gethostname called with bigger buflenhan "

343 
__fÜtify_funùiÚ
 

344 
	`__NTH
 (
	$g‘ho¡Çme
 (*
__buf
, 
size_t
 
__buæ’
))

346 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

348 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

349  
	`__g‘ho¡Çme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

351 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

352  
	`__g‘ho¡Çme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

354  
	`__g‘ho¡Çme_®Ÿs
 (
__buf
, 
__buæ’
);

355 
	}
}

359 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

360 
	$__g‘domašÇme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

361 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

362 
	`__REDIRECT_NTH
 (
__g‘domašÇme_®Ÿs
, (*
__buf
,

363 
size_t
 
__buæ’
),

364 
g‘domašÇme
è
	`__nÚnuÎ
 ((1)è
__wur
;

365 
	`__REDIRECT_NTH
 (
__g‘domašÇme_chk_w¬n
,

366 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

367 
__g‘domašÇme_chk
)

368 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("getdomainname called with bigger "

372 
__fÜtify_funùiÚ
 

373 
	`__NTH
 (
	$g‘domašÇme
 (*
__buf
, 
size_t
 
__buæ’
))

375 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

377 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

378  
	`__g‘domašÇme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

380 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

381  
	`__g‘domašÇme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

383  
	`__g‘domašÇme_®Ÿs
 (
__buf
, 
__buæ’
);

384 
	}
}

	@/usr/include/bits/utsname.h

18 #iâdeà
_SYS_UTSNAME_H


23 
	#_UTSNAME_LENGTH
 65

	)

28 
	#_UTSNAME_DOMAIN_LENGTH
 
_UTSNAME_LENGTH


	)

	@/usr/include/bits/waitflags.h

19 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


25 
	#WNOHANG
 1

	)

26 
	#WUNTRACED
 2

	)

29 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


30 
	#WSTOPPED
 2

	)

31 
	#WEXITED
 4

	)

32 
	#WCONTINUED
 8

	)

33 
	#WNOWAIT
 0x01000000

	)

36 
	#__WNOTHREAD
 0x20000000

	)

38 
	#__WALL
 0x40000000

	)

39 
	#__WCLONE
 0x80000000

	)

42 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


43 #iâdeà
__ENUM_IDTYPE_T


44 
	#__ENUM_IDTYPE_T
 1

	)

48 #undeà
P_ALL


49 #undeà
P_PID


50 #undeà
P_PGID


54 
	mP_ALL
,

55 
	mP_PID
,

56 
	mP_PGID


57 } 
	tidty³_t
;

	@/usr/include/bits/waitstatus.h

19 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


28 
	#__WEXITSTATUS
(
¡©us
è(((¡©usè& 0xff00è>> 8)

	)

31 
	#__WTERMSIG
(
¡©us
è((¡©usè& 0x7f)

	)

34 
	#__WSTOPSIG
(
¡©us
è
	`__WEXITSTATUS
(¡©us)

	)

37 
	#__WIFEXITED
(
¡©us
è(
	`__WTERMSIG
(¡©usè=ğ0)

	)

40 
	#__WIFSIGNALED
(
¡©us
) \

41 (((sigÃd è(((
¡©us
è& 0x7fè+ 1è>> 1è> 0)

	)

44 
	#__WIFSTOPPED
(
¡©us
è(((¡©usè& 0xffè=ğ0x7f)

	)

48 #ifdeà
WCONTINUED


49 
	#__WIFCONTINUED
(
¡©us
è((¡©usè=ğ
__W_CONTINUED
)

	)

53 
	#__WCOREDUMP
(
¡©us
è((¡©usè& 
__WCOREFLAG
)

	)

56 
	#__W_EXITCODE
(
»t
, 
sig
è(Ô‘è<< 8 | (sig))

	)

57 
	#__W_STOPCODE
(
sig
è((sigè<< 8 | 0x7f)

	)

58 
	#__W_CONTINUED
 0xffff

	)

59 
	#__WCOREFLAG
 0x80

	)

	@/usr/include/bits/wchar-ldbl.h

19 #iâdeà
_WCHAR_H


23 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


24 
__LDBL_REDIR_DECL
 (
fw´štf
);

25 
__LDBL_REDIR_DECL
 (
w´štf
);

26 
__LDBL_REDIR_DECL
 (
sw´štf
);

27 
__LDBL_REDIR_DECL
 (
vfw´štf
);

28 
__LDBL_REDIR_DECL
 (
vw´štf
);

29 
__LDBL_REDIR_DECL
 (
vsw´štf
);

30 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

31 && !
defšed
 
	g__REDIRECT
 \

32 && (
defšed
 
	g__STRICT_ANSI__
 || defšed 
	g__USE_XOPEN2K
)

33 
	$__LDBL_REDIR1_DECL
 (
fwsÿnf
, 
__Ædbl___isoc99_fwsÿnf
)

34 
	$__LDBL_REDIR1_DECL
 (
wsÿnf
, 
__Ædbl___isoc99_wsÿnf
)

35 
	$__LDBL_REDIR1_DECL
 (
swsÿnf
, 
__Ædbl___isoc99_swsÿnf
)

37 
	`__LDBL_REDIR_DECL
 (
fwsÿnf
);

38 
	`__LDBL_REDIR_DECL
 (
wsÿnf
);

39 
	`__LDBL_REDIR_DECL
 (
swsÿnf
);

43 #ifdeà
__USE_ISOC99


44 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd
, 
wc¡od
);

45 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

46 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

47 
	$__LDBL_REDIR1_DECL
 (
vfwsÿnf
, 
__Ædbl___isoc99_vfwsÿnf
)

48 
	$__LDBL_REDIR1_DECL
 (
vwsÿnf
, 
__Ædbl___isoc99_vwsÿnf
)

49 
	$__LDBL_REDIR1_DECL
 (
vswsÿnf
, 
__Ædbl___isoc99_vswsÿnf
)

51 
	`__LDBL_REDIR_DECL
 (
vfwsÿnf
);

52 
	`__LDBL_REDIR_DECL
 (
vwsÿnf
);

53 
	`__LDBL_REDIR_DECL
 (
vswsÿnf
);

57 #ifdeà
__USE_GNU


58 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd_l
, 
wc¡od_l
);

61 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


62 
	$__LDBL_REDIR_DECL
 (
__sw´štf_chk
)

63 
	$__LDBL_REDIR_DECL
 (
__vsw´štf_chk
)

64 #ià
__USE_FORTIFY_LEVEL
 > 1

65 
	$__LDBL_REDIR_DECL
 (
__fw´štf_chk
)

66 
	$__LDBL_REDIR_DECL
 (
__w´štf_chk
)

67 
	$__LDBL_REDIR_DECL
 (
__vfw´štf_chk
)

68 
	$__LDBL_REDIR_DECL
 (
__vw´štf_chk
)

	@/usr/include/bits/wchar.h

19 #iâdeà
_BITS_WCHAR_H


20 
	#_BITS_WCHAR_H
 1

	)

33 #ifdeà
__WCHAR_MAX__


34 
	#__WCHAR_MAX
 
__WCHAR_MAX__


	)

35 #–ià
L
'\0' - 1 > 0

36 
	#__WCHAR_MAX
 (0xffffffffu + 
L
'\0')

	)

38 
	#__WCHAR_MAX
 (0x7ffffffà+ 
L
'\0')

	)

41 #ifdeà
__WCHAR_MIN__


42 
	#__WCHAR_MIN
 
__WCHAR_MIN__


	)

43 #–ià
L
'\0' - 1 > 0

44 
	#__WCHAR_MIN
 (
L
'\0' + 0)

	)

46 
	#__WCHAR_MIN
 (-
__WCHAR_MAX
 - 1)

	)

	@/usr/include/bits/wchar2.h

19 #iâdeà
_WCHAR_H


24 
wch¬_t
 *
	$__wmemıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

25 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

26 
size_t
 
__ns1
è
__THROW
;

27 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_®Ÿs
,

28 (
wch¬_t
 *
__»¡riù
 
__s1
,

29 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
),

30 
wmemıy
);

31 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_chk_w¬n
,

32 (
wch¬_t
 *
__»¡riù
 
__s1
,

33 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

34 
size_t
 
__ns1
), 
__wmemıy_chk
)

35 
	`__w¬Ç‰r
 ("wmemcpy called with†ength biggerhan size of destination "

38 
__fÜtify_funùiÚ
 
wch¬_t
 *

39 
	`__NTH
 (
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, cÚ¡ wch¬_ˆ*__»¡riù 
__s2
,

40 
size_t
 
__n
))

42 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

44 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

45  
	`__wmemıy_chk
 (
__s1
, 
__s2
, 
__n
,

46 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

48 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

49  
	`__wmemıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

50 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

52  
	`__wmemıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

53 
	}
}

56 
wch¬_t
 *
	$__wmemmove_chk
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

57 
size_t
 
__n
, size_ˆ
__ns1
è
__THROW
;

58 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_®Ÿs
, (wch¬_ˆ*
__s1
,

59 cÚ¡ 
wch¬_t
 *
__s2
,

60 
size_t
 
__n
), 
wmemmove
);

61 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_chk_w¬n
,

62 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

63 
size_t
 
__n
, size_ˆ
__ns1
), 
__wmemmove_chk
)

64 
	`__w¬Ç‰r
 ("wmemmove called with†ength biggerhan size of destination "

67 
__fÜtify_funùiÚ
 
wch¬_t
 *

68 
	`__NTH
 (
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
))

70 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

72 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

73  
	`__wmemmove_chk
 (
__s1
, 
__s2
, 
__n
,

74 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

76 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

77  
	`__wmemmove_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

78 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

80  
	`__wmemmove_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

81 
	}
}

84 #ifdeà
__USE_GNU


85 
wch¬_t
 *
	$__wmempıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

86 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

87 
size_t
 
__ns1
è
__THROW
;

88 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_®Ÿs
,

89 (
wch¬_t
 *
__»¡riù
 
__s1
,

90 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
,

91 
size_t
 
__n
), 
wmempıy
);

92 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_chk_w¬n
,

93 (
wch¬_t
 *
__»¡riù
 
__s1
,

94 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

95 
size_t
 
__ns1
), 
__wmempıy_chk
)

96 
	`__w¬Ç‰r
 ("wmempcpy called with†ength biggerhan size of destination "

99 
__fÜtify_funùiÚ
 
wch¬_t
 *

100 
	`__NTH
 (
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, cÚ¡ wch¬_ˆ*__»¡riù 
__s2
,

101 
size_t
 
__n
))

103 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

105 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

106  
	`__wmempıy_chk
 (
__s1
, 
__s2
, 
__n
,

107 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

109 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

110  
	`__wmempıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

111 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

113  
	`__wmempıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

114 
	}
}

118 
wch¬_t
 *
	$__wmem£t_chk
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

119 
size_t
 
__ns
è
__THROW
;

120 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_®Ÿs
, (wch¬_ˆ*
__s
, wch¬_ˆ
__c
,

121 
size_t
 
__n
), 
wmem£t
);

122 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_chk_w¬n
,

123 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

124 
size_t
 
__ns
), 
__wmem£t_chk
)

125 
	`__w¬Ç‰r
 ("wmemset called with†ength biggerhan size of destination "

128 
__fÜtify_funùiÚ
 
wch¬_t
 *

129 
	`__NTH
 (
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
))

131 ià(
	`__bos0
 (
__s
è!ğ(
size_t
) -1)

133 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

134  
	`__wmem£t_chk
 (
__s
, 
__c
, 
__n
, 
	`__bos0
 (__sè/  (
wch¬_t
));

136 ià(
__n
 > 
	`__bos0
 (
__s
è/  (
wch¬_t
))

137  
	`__wmem£t_chk_w¬n
 (
__s
, 
__c
, 
__n
,

138 
	`__bos0
 (
__s
è/  (
wch¬_t
));

140  
	`__wmem£t_®Ÿs
 (
__s
, 
__c
, 
__n
);

141 
	}
}

144 
wch¬_t
 *
	$__wcsıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

145 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

146 
size_t
 
__n
è
__THROW
;

147 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsıy_®Ÿs
,

148 (
wch¬_t
 *
__»¡riù
 
__de¡
,

149 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsıy
);

151 
__fÜtify_funùiÚ
 
wch¬_t
 *

152 
	`__NTH
 (
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
))

154 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

155  
	`__wcsıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

156  
	`__wcsıy_®Ÿs
 (
__de¡
, 
__¤c
);

157 
	}
}

160 
wch¬_t
 *
	$__wııy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

161 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

162 
size_t
 
__de¡Ën
è
__THROW
;

163 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wııy_®Ÿs
,

164 (
wch¬_t
 *
__»¡riù
 
__de¡
,

165 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wııy
);

167 
__fÜtify_funùiÚ
 
wch¬_t
 *

168 
	`__NTH
 (
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
))

170 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

171  
	`__wııy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

172  
	`__wııy_®Ÿs
 (
__de¡
, 
__¤c
);

173 
	}
}

176 
wch¬_t
 *
	$__wc¢ıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

177 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

178 
size_t
 
__de¡Ën
è
__THROW
;

179 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_®Ÿs
,

180 (
wch¬_t
 *
__»¡riù
 
__de¡
,

181 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

182 
size_t
 
__n
), 
wc¢ıy
);

183 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_chk_w¬n
,

184 (
wch¬_t
 *
__»¡riù
 
__de¡
,

185 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

186 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wc¢ıy_chk
)

187 
	`__w¬Ç‰r
 ("wcsncpy called with†ength biggerhan size of destination "

190 
__fÜtify_funùiÚ
 
wch¬_t
 *

191 
	`__NTH
 (
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
,

192 
size_t
 
__n
))

194 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

196 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

197  
	`__wc¢ıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

198 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

199 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

200  
	`__wc¢ıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

201 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

203  
	`__wc¢ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

204 
	}
}

207 
wch¬_t
 *
	$__wınıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

208 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

209 
size_t
 
__de¡Ën
è
__THROW
;

210 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_®Ÿs
,

211 (
wch¬_t
 *
__»¡riù
 
__de¡
,

212 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

213 
size_t
 
__n
), 
wınıy
);

214 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_chk_w¬n
,

215 (
wch¬_t
 *
__»¡riù
 
__de¡
,

216 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

217 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wınıy_chk
)

218 
	`__w¬Ç‰r
 ("wcpncpy called with†ength biggerhan size of destination "

221 
__fÜtify_funùiÚ
 
wch¬_t
 *

222 
	`__NTH
 (
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
,

223 
size_t
 
__n
))

225 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

227 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

228  
	`__wınıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

229 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

230 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

231  
	`__wınıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

232 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

234  
	`__wınıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

235 
	}
}

238 
wch¬_t
 *
	$__wcsÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

239 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

240 
size_t
 
__de¡Ën
è
__THROW
;

241 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsÿt_®Ÿs
,

242 (
wch¬_t
 *
__»¡riù
 
__de¡
,

243 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsÿt
);

245 
__fÜtify_funùiÚ
 
wch¬_t
 *

246 
	`__NTH
 (
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
))

248 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

249  
	`__wcsÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

250  
	`__wcsÿt_®Ÿs
 (
__de¡
, 
__¤c
);

251 
	}
}

254 
wch¬_t
 *
	$__wc¢ÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

255 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

256 
size_t
 
__n
, size_ˆ
__de¡Ën
è
__THROW
;

257 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ÿt_®Ÿs
,

258 (
wch¬_t
 *
__»¡riù
 
__de¡
,

259 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

260 
size_t
 
__n
), 
wc¢ÿt
);

262 
__fÜtify_funùiÚ
 
wch¬_t
 *

263 
	`__NTH
 (
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
, cÚ¡ wch¬_ˆ*__»¡riù 
__¤c
,

264 
size_t
 
__n
))

266 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

267  
	`__wc¢ÿt_chk
 (
__de¡
, 
__¤c
, 
__n
,

268 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

269  
	`__wc¢ÿt_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

270 
	}
}

273 
	$__sw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

274 
__æag
, 
size_t
 
__s_Ën
,

275 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

276 
__THROW
 ;

278 
	`__REDIRECT_NTH_LDBL
 (
__sw´štf_®Ÿs
,

279 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

280 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, ...),

281 
sw´štf
);

283 #ifdeà
__va_¬g_·ck


284 
__fÜtify_funùiÚ
 

285 
	`__NTH
 (
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

286 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, ...))

288 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

289  
	`__sw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

290 
	`__bos
 (
__s
è/  (
wch¬_t
),

291 
__fmt
, 
	`__va_¬g_·ck
 ());

292  
	`__sw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
	`__va_¬g_·ck
 ());

293 
	}
}

294 #–ià!
defšed
 
__ılu¥lus


296 
	#sw´štf
(
s
, 
n
, ...) \

297 (
	`__bos
 (
s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1 \

298 ? 
	`__sw´štf_chk
 (
s
, 
n
, 
__USE_FORTIFY_LEVEL
 - 1, \

299 
	`__bos
 (
s
è/  (
wch¬_t
), 
__VA_ARGS__
) \

300 : 
	`sw´štf
 (
s
, 
n
, 
__VA_ARGS__
))

	)

303 
	$__vsw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

304 
__æag
, 
size_t
 
__s_Ën
,

305 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

306 
__gnuc_va_li¡
 
__¬g
)

307 
__THROW
 ;

309 
	`__REDIRECT_NTH_LDBL
 (
__vsw´štf_®Ÿs
,

310 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

311 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
,

312 
__gnuc_va_li¡
 
__­
), 
vsw´štf
);

314 
__fÜtify_funùiÚ
 

315 
	`__NTH
 (
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

316 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
))

318 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

319  
	`__vsw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

320 
	`__bos
 (
__s
è/  (
wch¬_t
), 
__fmt
, 
__­
);

321  
	`__vsw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
__­
);

322 
	}
}

325 #ià
__USE_FORTIFY_LEVEL
 > 1

327 
__fw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

328 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

329 
__w´štf_chk
 (
__æag
, cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

331 
__vfw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

332 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

333 
__gnuc_va_li¡
 
__­
);

334 
__vw´štf_chk
 (
__æag
, cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

335 
__gnuc_va_li¡
 
__­
);

337 #ifdeà
__va_¬g_·ck


338 
__fÜtify_funùiÚ
 

339 
	$w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, ...)

341  
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

342 
	}
}

344 
__fÜtify_funùiÚ
 

345 
	$fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
, cÚ¡ 
wch¬_t
 *__»¡riù 
__fmt
, ...)

347  
	`__fw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

348 
	`__va_¬g_·ck
 ());

349 
	}
}

350 #–ià!
defšed
 
__ılu¥lus


351 
	#w´štf
(...) \

352 
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

353 
	#fw´štf
(
¡»am
, ...) \

354 
	`__fw´štf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

357 
__fÜtify_funùiÚ
 

358 
	$vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

360  
	`__vw´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

361 
	}
}

363 
__fÜtify_funùiÚ
 

364 
	$vfw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

365 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

367  
	`__vfw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

368 
	}
}

372 
wch¬_t
 *
	$__fg‘ws_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

373 
__FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

374 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_®Ÿs
,

375 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

376 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws
è
__wur
;

377 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_chk_w¬n
,

378 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

379 
__FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘ws_chk
)

380 
__wur
 
	`__w¬Ç‰r
 ("fgetws called with bigger sizehan†ength "

383 
__fÜtify_funùiÚ
 
__wur
 
wch¬_t
 *

384 
	$fg‘ws
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

386 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

388 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

389  
	`__fg‘ws_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

390 
__n
, 
__¡»am
);

392 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

393  
	`__fg‘ws_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

394 
__n
, 
__¡»am
);

396  
	`__fg‘ws_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

397 
	}
}

399 #ifdeà
__USE_GNU


400 
wch¬_t
 *
	$__fg‘ws_uÆocked_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
,

401 
__n
, 
__FILE
 *
__»¡riù
 
__¡»am
)

402 
__wur
;

403 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_®Ÿs
,

404 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

405 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws_uÆocked
)

406 
__wur
;

407 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_chk_w¬n
,

408 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

409 
__FILE
 *
__»¡riù
 
__¡»am
),

410 
__fg‘ws_uÆocked_chk
)

411 
__wur
 
	`__w¬Ç‰r
 ("fgetws_unlocked called with bigger sizehan†ength "

414 
__fÜtify_funùiÚ
 
__wur
 
wch¬_t
 *

415 
	$fg‘ws_uÆocked
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

417 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

419 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

420  
	`__fg‘ws_uÆocked_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

421 
__n
, 
__¡»am
);

423 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

424  
	`__fg‘ws_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

425 
__n
, 
__¡»am
);

427  
	`__fg‘ws_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

428 
	}
}

432 
size_t
 
	$__wütomb_chk
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

433 
mb¡©e_t
 *
__»¡riù
 
__p
,

434 
size_t
 
__buæ’
è
__THROW
 
__wur
;

435 
size_t
 
	`__REDIRECT_NTH
 (
__wütomb_®Ÿs
,

436 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

437 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wütomb
è
__wur
;

439 
__fÜtify_funùiÚ
 
__wur
 
size_t


440 
	`__NTH
 (
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

441 
mb¡©e_t
 *
__»¡riù
 
__ps
))

446 
	#__WCHAR_MB_LEN_MAX
 16

	)

447 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__WCHAR_MB_LEN_MAX


450 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__WCHAR_MB_LEN_MAX
 > __bos (__s))

451  
	`__wütomb_chk
 (
__s
, 
__wch¬
, 
__ps
, 
	`__bos
 (__s));

452  
	`__wütomb_®Ÿs
 (
__s
, 
__wch¬
, 
__ps
);

453 
	}
}

456 
size_t
 
	$__mb¤towcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

457 cÚ¡ **
__»¡riù
 
__¤c
,

458 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

459 
size_t
 
__d¡Ën
è
__THROW
;

460 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_®Ÿs
,

461 (
wch¬_t
 *
__»¡riù
 
__d¡
,

462 cÚ¡ **
__»¡riù
 
__¤c
,

463 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

464 
mb¤towcs
);

465 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_chk_w¬n
,

466 (
wch¬_t
 *
__»¡riù
 
__d¡
,

467 cÚ¡ **
__»¡riù
 
__¤c
,

468 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

469 
size_t
 
__d¡Ën
), 
__mb¤towcs_chk
)

470 
	`__w¬Ç‰r
 ("mbsrtowcs called with dst buffer smallerhan†en "

473 
__fÜtify_funùiÚ
 
size_t


474 
	`__NTH
 (
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, cÚ¡ **__»¡riù 
__¤c
,

475 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

477 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

479 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

480  
	`__mb¤towcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

481 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

483 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

484  
	`__mb¤towcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

485 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

487  
	`__mb¤towcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

488 
	}
}

491 
size_t
 
	$__wc¤tombs_chk
 (*
__»¡riù
 
__d¡
,

492 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

493 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

494 
size_t
 
__d¡Ën
è
__THROW
;

495 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_®Ÿs
,

496 (*
__»¡riù
 
__d¡
,

497 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

498 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

499 
wc¤tombs
);

500 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_chk_w¬n
,

501 (*
__»¡riù
 
__d¡
,

502 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

503 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

504 
size_t
 
__d¡Ën
), 
__wc¤tombs_chk
)

505 
	`__w¬Ç‰r
 ("wcsrtombs called with dst buffer smallerhan†en");

507 
__fÜtify_funùiÚ
 
size_t


508 
	`__NTH
 (
	$wc¤tombs
 (*
__»¡riù
 
__d¡
, cÚ¡ 
wch¬_t
 **__»¡riù 
__¤c
,

509 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

511 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

513 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

514  
	`__wc¤tombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

516 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

517  
	`__wc¤tombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

519  
	`__wc¤tombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

520 
	}
}

523 #ifdeà
__USE_GNU


524 
size_t
 
	$__mb¢¹owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

525 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

526 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

527 
size_t
 
__d¡Ën
è
__THROW
;

528 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_®Ÿs
,

529 (
wch¬_t
 *
__»¡riù
 
__d¡
,

530 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

531 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

532 
mb¢¹owcs
);

533 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_chk_w¬n
,

534 (
wch¬_t
 *
__»¡riù
 
__d¡
,

535 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

536 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

537 
size_t
 
__d¡Ën
), 
__mb¢¹owcs_chk
)

538 
	`__w¬Ç‰r
 ("mbsnrtowcs called with dst buffer smallerhan†en "

541 
__fÜtify_funùiÚ
 
size_t


542 
	`__NTH
 (
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, cÚ¡ **__»¡riù 
__¤c
,

543 
size_t
 
__nmc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

545 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

547 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

548  
	`__mb¢¹owcs_chk
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

549 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

551 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

552  
	`__mb¢¹owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

553 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

555  
	`__mb¢¹owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
);

556 
	}
}

559 
size_t
 
	$__wc¢¹ombs_chk
 (*
__»¡riù
 
__d¡
,

560 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

561 
size_t
 
__nwc
, size_ˆ
__Ën
,

562 
mb¡©e_t
 *
__»¡riù
 
__ps
, 
size_t
 
__d¡Ën
)

563 
__THROW
;

564 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_®Ÿs
,

565 (*
__»¡riù
 
__d¡
,

566 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

567 
size_t
 
__nwc
, size_ˆ
__Ën
,

568 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wc¢¹ombs
);

569 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_chk_w¬n
,

570 (*
__»¡riù
 
__d¡
,

571 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

572 
size_t
 
__nwc
, size_ˆ
__Ën
,

573 
mb¡©e_t
 *
__»¡riù
 
__ps
,

574 
size_t
 
__d¡Ën
), 
__wc¢¹ombs_chk
)

575 
	`__w¬Ç‰r
 ("wcsnrtombs called with dst buffer smallerhan†en");

577 
__fÜtify_funùiÚ
 
size_t


578 
	`__NTH
 (
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
, cÚ¡ 
wch¬_t
 **__»¡riù 
__¤c
,

579 
size_t
 
__nwc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

581 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

583 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

584  
	`__wc¢¹ombs_chk
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

585 
	`__bos
 (
__d¡
));

587 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

588  
	`__wc¢¹ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

589 
	`__bos
 (
__d¡
));

591  
	`__wc¢¹ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
);

592 
	}
}

	@/usr/include/bits/wctype-wchar.h

23 #iâdeà
_BITS_WCTYPE_WCHAR_H


24 
	#_BITS_WCTYPE_WCHAR_H
 1

	)

26 #ià!
defšed
 
_WCTYPE_H
 && !defšed 
_WCHAR_H


30 
	~<b™s/ty³s.h
>

31 
	~<b™s/ty³s/wšt_t.h
>

38 
	twùy³_t
;

40 #iâdeà
_ISwb™


45 
	~<’dŸn.h
>

46 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


47 
	#_ISwb™
(
b™
è(1 << (b™))

	)

49 
	#_ISwb™
(
b™
) \

50 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

51 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

52 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

53 : (è((1UL << (
b™
)è>> 24))))

	)

58 
	m__ISwuµ”
 = 0,

59 
	m__ISwlow”
 = 1,

60 
	m__ISw®pha
 = 2,

61 
	m__ISwdig™
 = 3,

62 
	m__ISwxdig™
 = 4,

63 
	m__ISw¥aû
 = 5,

64 
	m__ISw´št
 = 6,

65 
	m__ISwg¿ph
 = 7,

66 
	m__ISwbÏnk
 = 8,

67 
	m__ISwúŒl
 = 9,

68 
	m__ISwpunù
 = 10,

69 
	m__ISw®num
 = 11,

71 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

72 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

73 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

74 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

75 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

76 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

77 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

78 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

79 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

80 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

81 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

82 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

87 
__BEGIN_DECLS


95 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

101 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

104 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

108 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

112 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

117 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

120 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

125 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

130 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

135 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

140 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

145 #ifdeà
__USE_ISOC99


146 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

155 
wùy³_t
 
	$wùy³
 (cÚ¡ *
__´İ”ty
è
__THROW
;

159 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

166 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

169 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

171 
__END_DECLS


	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__
 && !defšed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

7 
	#__WORDSIZE32_SIZE_ULONG
 0

	)

8 
	#__WORDSIZE32_PTRDIFF_LONG
 0

	)

11 #ifdeà
__x86_64__


12 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

14 
	#__SYSCALL_WORDSIZE
 64

	)

16 
	#__WORDSIZE_TIME64_COMPAT32
 0

	)

	@/usr/include/bits/xopen_lim.h

29 #iâdeà
_XOPEN_LIM_H


30 
	#_XOPEN_LIM_H
 1

	)

62 
	#_XOPEN_IOV_MAX
 
_POSIX_UIO_MAXIOV


	)

64 
	~<b™s/uio_lim.h
>

65 #ifdeà
__IOV_MAX


66 
	#IOV_MAX
 
__IOV_MAX


	)

68 #undeà
IOV_MAX


73 
	#NL_ARGMAX
 
_POSIX_ARG_MAX


	)

76 
	#NL_LANGMAX
 
_POSIX2_LINE_MAX


	)

79 
	#NL_MSGMAX
 
INT_MAX


	)

83 #ià
defšed
 
__USE_GNU
 || !defšed 
__USE_XOPEN2K8


84 
	#NL_NMAX
 
INT_MAX


	)

88 
	#NL_SETMAX
 
INT_MAX


	)

91 
	#NL_TEXTMAX
 
INT_MAX


	)

94 
	#NZERO
 20

	)

98 #ifdeà
INT_MAX


99 #ià
INT_MAX
 == 32767

100 
	#WORD_BIT
 16

	)

102 #ià
INT_MAX
 == 2147483647

103 
	#WORD_BIT
 32

	)

106 
	#WORD_BIT
 64

	)

109 #–ià
defšed
 
__INT_MAX__


110 #ià
__INT_MAX__
 == 32767

111 
	#WORD_BIT
 16

	)

113 #ià
__INT_MAX__
 == 2147483647

114 
	#WORD_BIT
 32

	)

117 
	#WORD_BIT
 64

	)

121 
	#WORD_BIT
 32

	)

125 #ifdeà
LONG_MAX


126 #ià
LONG_MAX
 == 2147483647

127 
	#LONG_BIT
 32

	)

130 
	#LONG_BIT
 64

	)

132 #–ià
defšed
 
__LONG_MAX__


133 #ià
__LONG_MAX__
 == 2147483647

134 
	#LONG_BIT
 32

	)

137 
	#LONG_BIT
 64

	)

140 
	~<b™s/wÜdsize.h
>

141 #ià
__WORDSIZE
 == 64

142 
	#LONG_BIT
 64

	)

144 
	#LONG_BIT
 32

	)

	@/usr/include/bits/xtitypes.h

19 #iâdeà
_STROPTS_H


23 #iâdeà
_BITS_XTITYPES_H


24 
	#_BITS_XTITYPES_H
 1

	)

26 
	~<b™s/ty³s.h
>

29 
__SLONG32_TYPE
 
	t__t_sÿÏr_t
;

30 
__ULONG32_TYPE
 
	t__t_usÿÏr_t
;

	@/usr/include/event2/buffer.h

26 #iâdeà
EVENT2_BUFFER_H_INCLUDED_


27 
	#EVENT2_BUFFER_H_INCLUDED_


	)

75 
	~<ev’t2/visib™y.h
>

77 #ifdeà
__ılu¥lus


81 
	~<ev’t2/ev’t-cÚfig.h
>

82 
	~<¡d¬g.h
>

83 #ifdeà
EVENT__HAVE_SYS_TYPES_H


84 
	~<sys/ty³s.h
>

86 #ifdeà
EVENT__HAVE_SYS_UIO_H


87 
	~<sys/uio.h
>

89 
	~<ev’t2/ut.h
>

97 
evbufãr


98 #ifdeà
EVENT_IN_DOXYGEN_


116 
	sevbufãr_±r
 {

117 
ev_ssize_t
 
pos
;

122 *
chaš
;

123 
size_t
 
pos_š_chaš
;

124 } 
š‹º®_
;

132 #ifdeà
EVENT__HAVE_SYS_UIO_H


133 
	#evbufãr_iovec
 
iovec


	)

135 
	#EVBUFFER_IOVEC_IS_NATIVE_


	)

137 
	sevbufãr_iovec
 {

139 *
iov_ba£
;

141 
size_t
 
iov_Ën
;

151 
EVENT2_EXPORT_SYMBOL


152 
evbufãr
 *
evbufãr_Ãw
();

158 
EVENT2_EXPORT_SYMBOL


159 
evbufãr_ä“
(
evbufãr
 *
buf
);

173 
EVENT2_EXPORT_SYMBOL


174 
evbufãr_’abË_lockšg
(
evbufãr
 *
buf
, *
lock
);

180 
EVENT2_EXPORT_SYMBOL


181 
evbufãr_lock
(
evbufãr
 *
buf
);

187 
EVENT2_EXPORT_SYMBOL


188 
evbufãr_uÆock
(
evbufãr
 *
buf
);

206 
	#EVBUFFER_FLAG_DRAINS_TO_FD
 1

	)

215 
EVENT2_EXPORT_SYMBOL


216 
evbufãr_£t_æags
(
evbufãr
 *
buf
, 
ev_ušt64_t
 
æags
);

224 
EVENT2_EXPORT_SYMBOL


225 
evbufãr_ş—r_æags
(
evbufãr
 *
buf
, 
ev_ušt64_t
 
æags
);

233 
EVENT2_EXPORT_SYMBOL


234 
size_t
 
evbufãr_g‘_Ëngth
(cÚ¡ 
evbufãr
 *
buf
);

248 
EVENT2_EXPORT_SYMBOL


249 
size_t
 
evbufãr_g‘_cÚtiguous_¥aû
(cÚ¡ 
evbufãr
 *
buf
);

261 
EVENT2_EXPORT_SYMBOL


262 
evbufãr_ex·nd
(
evbufãr
 *
buf
, 
size_t
 
d©Ën
);

297 
EVENT2_EXPORT_SYMBOL


299 
evbufãr_»£rve_¥aû
(
evbufãr
 *
buf
, 
ev_ssize_t
 
size
,

300 
evbufãr_iovec
 *
vec
, 
n_vec
);

323 
EVENT2_EXPORT_SYMBOL


324 
evbufãr_comm™_¥aû
(
evbufãr
 *
buf
,

325 
evbufãr_iovec
 *
vec
, 
n_vecs
);

335 
EVENT2_EXPORT_SYMBOL


336 
evbufãr_add
(
evbufãr
 *
buf
, cÚ¡ *
d©a
, 
size_t
 
d©Ën
);

350 
EVENT2_EXPORT_SYMBOL


351 
evbufãr_»move
(
evbufãr
 *
buf
, *
d©a
, 
size_t
 
d©Ën
);

364 
EVENT2_EXPORT_SYMBOL


365 
ev_ssize_t
 
evbufãr_cİyout
(
evbufãr
 *
buf
, *
d©a_out
, 
size_t
 
d©Ën
);

379 
EVENT2_EXPORT_SYMBOL


380 
ev_ssize_t
 
evbufãr_cİyout_äom
(
evbufãr
 *
buf
, cÚ¡ 
evbufãr_±r
 *
pos
, *
d©a_out
, 
size_t
 
d©Ën
);

395 
EVENT2_EXPORT_SYMBOL


396 
evbufãr_»move_bufãr
(
evbufãr
 *
¤c
, evbufã¸*
d¡
,

397 
size_t
 
d©Ën
);

401 
	eevbufãr_eŞ_¡yË
 {

411 
EVBUFFER_EOL_ANY
,

414 
EVBUFFER_EOL_CRLF
,

416 
EVBUFFER_EOL_CRLF_STRICT
,

418 
EVBUFFER_EOL_LF
,

420 
EVBUFFER_EOL_NUL


437 
EVENT2_EXPORT_SYMBOL


438 *
evbufãr_»adÊ
(
evbufãr
 *
bufãr
, 
size_t
 *
n_»ad_out
,

439 
evbufãr_eŞ_¡yË
 
eŞ_¡yË
);

453 
EVENT2_EXPORT_SYMBOL


454 
evbufãr_add_bufãr
(
evbufãr
 *
outbuf
, evbufã¸*
šbuf
);

469 
EVENT2_EXPORT_SYMBOL


470 
evbufãr_add_bufãr_»ã»nû
(
evbufãr
 *
outbuf
,

471 
evbufãr
 *
šbuf
);

479 (*
evbufãr_»f_ş—nup_cb
)(cÚ¡ *
	td©a
,

480 
	tsize_t
 
	td©®’
, *
	texŒa
);

497 
EVENT2_EXPORT_SYMBOL


498 
evbufãr_add_»ã»nû
(
evbufãr
 *
outbuf
,

499 cÚ¡ *
d©a
, 
size_t
 
d©Ën
,

500 
evbufãr_»f_ş—nup_cb
 
ş—nupâ
, *
ş—nupâ_¬g
);

526 
EVENT2_EXPORT_SYMBOL


527 
evbufãr_add_fe
(
evbufãr
 *
outbuf
, 
fd
, 
ev_off_t
 
off£t
,

528 
ev_off_t
 
Ëngth
);

538 
evbufãr_fe_£gm’t
;

545 
	#EVBUF_FS_CLOSE_ON_FREE
 0x01

	)

550 
	#EVBUF_FS_DISABLE_MMAP
 0x02

	)

560 
	#EVBUF_FS_DISABLE_SENDFILE
 0x04

	)

567 
	#EVBUF_FS_DISABLE_LOCKING
 0x08

	)

573 (*
evbufãr_fe_£gm’t_ş—nup_cb
)(

574 
	tevbufãr_fe_£gm’t
 cÚ¡* 
	t£g
, 
	tæags
, * 
	t¬g
);

598 
EVENT2_EXPORT_SYMBOL


599 
evbufãr_fe_£gm’t
 *
evbufãr_fe_£gm’t_Ãw
(

600 
fd
, 
ev_off_t
 
off£t
,ƒv_off_ˆ
Ëngth
, 
æags
);

609 
EVENT2_EXPORT_SYMBOL


610 
evbufãr_fe_£gm’t_ä“
(
evbufãr_fe_£gm’t
 *
£g
);

619 
EVENT2_EXPORT_SYMBOL


620 
evbufãr_fe_£gm’t_add_ş—nup_cb
(
evbufãr_fe_£gm’t
 *
£g
,

621 
evbufãr_fe_£gm’t_ş—nup_cb
 
cb
, * 
¬g
);

645 
EVENT2_EXPORT_SYMBOL


646 
evbufãr_add_fe_£gm’t
(
evbufãr
 *
buf
,

647 
evbufãr_fe_£gm’t
 *
£g
, 
ev_off_t
 
off£t
,ƒv_off_ˆ
Ëngth
);

661 
EVENT2_EXPORT_SYMBOL


662 
evbufãr_add_´štf
(
evbufãr
 *
buf
, cÚ¡ *
fmt
, ...)

663 #ifdeà
__GNUC__


664 
__©Œibu‹__
((
fÜm©
(
´štf
, 2, 3)))

676 
EVENT2_EXPORT_SYMBOL


677 
evbufãr_add_v´štf
(
evbufãr
 *
buf
, cÚ¡ *
fmt
, 
va_li¡
 
­
)

678 #ifdeà
__GNUC__


679 
__©Œibu‹__
((
fÜm©
(
´štf
, 2, 0)))

691 
EVENT2_EXPORT_SYMBOL


692 
evbufãr_d¿š
(
evbufãr
 *
buf
, 
size_t
 
Ën
);

705 
EVENT2_EXPORT_SYMBOL


706 
evbufãr_wr™e
(
evbufãr
 *
bufãr
, 
evut_sock‘_t
 
fd
);

720 
EVENT2_EXPORT_SYMBOL


721 
evbufãr_wr™e_©mo¡
(
evbufãr
 *
bufãr
, 
evut_sock‘_t
 
fd
,

722 
ev_ssize_t
 
howmuch
);

733 
EVENT2_EXPORT_SYMBOL


734 
evbufãr_»ad
(
evbufãr
 *
bufãr
, 
evut_sock‘_t
 
fd
, 
howmuch
);

747 
EVENT2_EXPORT_SYMBOL


748 
evbufãr_±r
 
evbufãr_£¬ch
(
evbufãr
 *
bufãr
, cÚ¡ *
wh©
, 
size_t
 
Ën
, cÚ¡ evbufãr_±¸*
¡¬t
);

764 
EVENT2_EXPORT_SYMBOL


765 
evbufãr_±r
 
evbufãr_£¬ch_¿nge
(
evbufãr
 *
bufãr
, cÚ¡ *
wh©
, 
size_t
 
Ën
, cÚ¡ evbufãr_±¸*
¡¬t
, cÚ¡ evbufãr_±¸*
’d
);

771 
	eevbufãr_±r_how
 {

774 
EVBUFFER_PTR_SET
,

776 
EVBUFFER_PTR_ADD


800 
EVENT2_EXPORT_SYMBOL


802 
evbufãr_±r_£t
(
evbufãr
 *
bufãr
, 
evbufãr_±r
 *
±r
,

803 
size_t
 
pos™iÚ
, 
evbufãr_±r_how
 
how
);

819 
EVENT2_EXPORT_SYMBOL


820 
evbufãr_±r
 
evbufãr_£¬ch_eŞ
(
evbufãr
 *
bufãr
,

821 
evbufãr_±r
 *
¡¬t
, 
size_t
 *
eŞ_Ën_out
,

822 
evbufãr_eŞ_¡yË
 
eŞ_¡yË
);

852 
EVENT2_EXPORT_SYMBOL


853 
evbufãr_³ek
(
evbufãr
 *
bufãr
, 
ev_ssize_t
 
Ën
,

854 
evbufãr_±r
 *
¡¬t_©
,

855 
evbufãr_iovec
 *
vec_out
, 
n_vec
);

862 
	sevbufãr_cb_šfo
 {

865 
size_t
 
Üig_size
;

867 
size_t
 
n_added
;

869 
size_t
 
n_d–‘ed
;

891 (*
evbufãr_cb_func
)(
	tevbufãr
 *
	tbufãr
, cÚ¡ 
	tevbufãr_cb_šfo
 *
	tšfo
, *
	t¬g
);

893 
evbufãr_cb_’Œy
;

905 
EVENT2_EXPORT_SYMBOL


906 
evbufãr_cb_’Œy
 *
evbufãr_add_cb
(
evbufãr
 *
bufãr
, 
evbufãr_cb_func
 
cb
, *
cb¬g
);

916 
EVENT2_EXPORT_SYMBOL


917 
evbufãr_»move_cb_’Œy
(
evbufãr
 *
bufãr
,

918 
evbufãr_cb_’Œy
 *
’t
);

926 
EVENT2_EXPORT_SYMBOL


927 
evbufãr_»move_cb
(
evbufãr
 *
bufãr
, 
evbufãr_cb_func
 
cb
, *
cb¬g
);

934 
	#EVBUFFER_CB_ENABLED
 1

	)

943 
EVENT2_EXPORT_SYMBOL


944 
evbufãr_cb_£t_æags
(
evbufãr
 *
bufãr
,

945 
evbufãr_cb_’Œy
 *
cb
, 
ev_ušt32_t
 
æags
);

954 
EVENT2_EXPORT_SYMBOL


955 
evbufãr_cb_ş—r_æags
(
evbufãr
 *
bufãr
,

956 
evbufãr_cb_’Œy
 *
cb
, 
ev_ušt32_t
 
æags
);

968 
EVENT2_EXPORT_SYMBOL


969 
evbufãr_cb_su¥’d
(
evbufãr
 *
bufãr
, 
evbufãr_cb_’Œy
 *
cb
);

978 
EVENT2_EXPORT_SYMBOL


979 
evbufãr_cb_unsu¥’d
(
evbufãr
 *
bufãr
, 
evbufãr_cb_’Œy
 *
cb
);

992 
EVENT2_EXPORT_SYMBOL


993 *
evbufãr_puÎup
(
evbufãr
 *
buf
, 
ev_ssize_t
 
size
);

1004 
EVENT2_EXPORT_SYMBOL


1005 
evbufãr_´•’d
(
evbufãr
 *
buf
, cÚ¡ *
d©a
, 
size_t
 
size
);

1015 
EVENT2_EXPORT_SYMBOL


1016 
evbufãr_´•’d_bufãr
(
evbufãr
 *
d¡
, evbufãr* 
¤c
);

1032 
EVENT2_EXPORT_SYMBOL


1033 
evbufãr_ä“ze
(
evbufãr
 *
buf
, 
©_äÚt
);

1042 
EVENT2_EXPORT_SYMBOL


1043 
evbufãr_unä“ze
(
evbufãr
 *
buf
, 
©_äÚt
);

1045 
ev’t_ba£
;

1053 
EVENT2_EXPORT_SYMBOL


1054 
evbufãr_deãr_ÿÎbacks
(
evbufãr
 *
bufãr
, 
ev’t_ba£
 *
ba£
);

1069 
EVENT2_EXPORT_SYMBOL


1070 
size_t
 
evbufãr_add_iovec
(
evbufãr
 * 
bufãr
, 
evbufãr_iovec
 * 
vec
, 
n_vec
);

1072 #ifdeà
__ılu¥lus


	@/usr/include/event2/buffer_compat.h

27 #iâdeà
EVENT2_BUFFER_COMPAT_H_INCLUDED_


28 
	#EVENT2_BUFFER_COMPAT_H_INCLUDED_


	)

30 
	~<ev’t2/visib™y.h
>

50 
EVENT2_EXPORT_SYMBOL


51 *
evbufãr_»adlše
(
evbufãr
 *
bufãr
);

73 (*
	tevbufãr_cb
)(
	tevbufãr
 *
	tbufãr
, 
	tsize_t
 
	tŞd_Ën
, size_ˆ
	tÃw_Ën
, *
	t¬g
);

94 
EVENT2_EXPORT_SYMBOL


95 
	`evbufãr_£tcb
(
evbufãr
 *
bufãr
, 
evbufãr_cb
 
cb
, *
cb¬g
);

106 
EVENT2_EXPORT_SYMBOL


107 *
	`evbufãr_fšd
(
evbufãr
 *
bufãr
, cÚ¡ *
wh©
, 
size_t
 
Ën
);

110 
	#EVBUFFER_LENGTH
(
x
è
	`evbufãr_g‘_Ëngth
(x)

	)

112 
	#EVBUFFER_DATA
(
x
è
	`evbufãr_puÎup
((x), -1)

	)

	@/usr/include/event2/bufferevent.h

27 #iâdeà
EVENT2_BUFFEREVENT_H_INCLUDED_


28 
	#EVENT2_BUFFEREVENT_H_INCLUDED_


	)

77 
	~<ev’t2/visib™y.h
>

79 #ifdeà
__ılu¥lus


83 
	~<ev’t2/ev’t-cÚfig.h
>

84 #ifdeà
EVENT__HAVE_SYS_TYPES_H


85 
	~<sys/ty³s.h
>

87 #ifdeà
EVENT__HAVE_SYS_TIME_H


88 
	~<sys/time.h
>

92 
	~<ev’t2/ut.h
>

100 
	#BEV_EVENT_READING
 0x01

	)

101 
	#BEV_EVENT_WRITING
 0x02

	)

102 
	#BEV_EVENT_EOF
 0x10

	)

103 
	#BEV_EVENT_ERROR
 0x20

	)

104 
	#BEV_EVENT_TIMEOUT
 0x40

	)

105 
	#BEV_EVENT_CONNECTED
 0x80

	)

113 
bufã»v’t


114 #ifdeà
EVENT_IN_DOXYGEN_


118 
ev’t_ba£
;

119 
evbufãr
;

120 
sockaddr
;

135 (*
bufã»v’t_d©a_cb
)(
	tbufã»v’t
 *
	tbev
, *
	tùx
);

154 (*
bufã»v’t_ev’t_cb
)(
	tbufã»v’t
 *
	tbev
, 
	twh©
, *
	tùx
);

157 
	ebufã»v’t_İtiÚs
 {

160 
BEV_OPT_CLOSE_ON_FREE
 = (1<<0),

164 
BEV_OPT_THREADSAFE
 = (1<<1),

167 
BEV_OPT_DEFER_CALLBACKS
 = (1<<2),

173 
BEV_OPT_UNLOCK_CALLBACKS
 = (1<<3)

189 
EVENT2_EXPORT_SYMBOL


190 
bufã»v’t
 *
bufã»v’t_sock‘_Ãw
(
ev’t_ba£
 *
ba£
, 
evut_sock‘_t
 
fd
, 
İtiÚs
);

211 
EVENT2_EXPORT_SYMBOL


212 
bufã»v’t_sock‘_cÚÃù
(
bufã»v’t
 *, cÚ¡ 
sockaddr
 *, );

214 
evdns_ba£
;

241 
EVENT2_EXPORT_SYMBOL


242 
bufã»v’t_sock‘_cÚÃù_ho¡Çme
(
bufã»v’t
 *,

243 
evdns_ba£
 *, , const *, );

253 
EVENT2_EXPORT_SYMBOL


254 
bufã»v’t_sock‘_g‘_dns_”rÜ
(
bufã»v’t
 *
bev
);

267 
EVENT2_EXPORT_SYMBOL


268 
bufã»v’t_ba£_£t
(
ev’t_ba£
 *
ba£
, 
bufã»v’t
 *
buãv
);

273 
EVENT2_EXPORT_SYMBOL


274 
ev’t_ba£
 *
bufã»v’t_g‘_ba£
(
bufã»v’t
 *
bev
);

285 
EVENT2_EXPORT_SYMBOL


286 
bufã»v’t_´iÜ™y_£t
(
bufã»v’t
 *
buãv
, 
´i
);

293 
EVENT2_EXPORT_SYMBOL


294 
bufã»v’t_g‘_´iÜ™y
(cÚ¡ 
bufã»v’t
 *
buãv
);

304 
EVENT2_EXPORT_SYMBOL


305 
bufã»v’t_ä“
(
bufã»v’t
 *
buãv
);

322 
EVENT2_EXPORT_SYMBOL


323 
bufã»v’t_£tcb
(
bufã»v’t
 *
buãv
,

324 
bufã»v’t_d©a_cb
 
»adcb
, bufã»v’t_d©a_cb 
wr™ecb
,

325 
bufã»v’t_ev’t_cb
 
ev’tcb
, *
cb¬g
);

341 
EVENT2_EXPORT_SYMBOL


342 
bufã»v’t_g‘cb
(
bufã»v’t
 *
buãv
,

343 
bufã»v’t_d©a_cb
 *
»adcb_±r
,

344 
bufã»v’t_d©a_cb
 *
wr™ecb_±r
,

345 
bufã»v’t_ev’t_cb
 *
ev’tcb_±r
,

346 **
cb¬g_±r
);

355 
EVENT2_EXPORT_SYMBOL


356 
bufã»v’t_£tfd
(
bufã»v’t
 *
buãv
, 
evut_sock‘_t
 
fd
);

362 
EVENT2_EXPORT_SYMBOL


363 
evut_sock‘_t
 
bufã»v’t_g‘fd
(
bufã»v’t
 *
buãv
);

369 
EVENT2_EXPORT_SYMBOL


370 
bufã»v’t
 *
bufã»v’t_g‘_und”lyšg
(bufã»v’ˆ*
buãv
);

385 
EVENT2_EXPORT_SYMBOL


386 
bufã»v’t_wr™e
(
bufã»v’t
 *
buãv
,

387 cÚ¡ *
d©a
, 
size_t
 
size
);

399 
EVENT2_EXPORT_SYMBOL


400 
bufã»v’t_wr™e_bufãr
(
bufã»v’t
 *
buãv
, 
evbufãr
 *
buf
);

413 
EVENT2_EXPORT_SYMBOL


414 
size_t
 
bufã»v’t_»ad
(
bufã»v’t
 *
buãv
, *
d©a
, size_ˆ
size
);

424 
EVENT2_EXPORT_SYMBOL


425 
bufã»v’t_»ad_bufãr
(
bufã»v’t
 *
buãv
, 
evbufãr
 *
buf
);

436 
EVENT2_EXPORT_SYMBOL


437 
evbufãr
 *
bufã»v’t_g‘_šput
(
bufã»v’t
 *
buãv
);

451 
EVENT2_EXPORT_SYMBOL


452 
evbufãr
 *
bufã»v’t_g‘_ouut
(
bufã»v’t
 *
buãv
);

462 
EVENT2_EXPORT_SYMBOL


463 
bufã»v’t_’abË
(
bufã»v’t
 *
buãv
, 
ev’t
);

473 
EVENT2_EXPORT_SYMBOL


474 
bufã»v’t_di§bË
(
bufã»v’t
 *
buãv
, 
ev’t
);

482 
EVENT2_EXPORT_SYMBOL


483 
bufã»v’t_g‘_’abËd
(
bufã»v’t
 *
buãv
);

511 
EVENT2_EXPORT_SYMBOL


512 
bufã»v’t_£t_timeouts
(
bufã»v’t
 *
buãv
,

513 cÚ¡ 
timev®
 *
timeout_»ad
, cÚ¡ timev® *
timeout_wr™e
);

533 
EVENT2_EXPORT_SYMBOL


534 
bufã»v’t_£tw©”m¬k
(
bufã»v’t
 *
buãv
, 
ev’ts
,

535 
size_t
 
lowm¬k
, size_ˆ
highm¬k
);

547 
EVENT2_EXPORT_SYMBOL


548 
bufã»v’t_g‘w©”m¬k
(
bufã»v’t
 *
buãv
, 
ev’ts
,

549 
size_t
 *
lowm¬k
, size_ˆ*
highm¬k
);

555 
EVENT2_EXPORT_SYMBOL


556 
bufã»v’t_lock
(
bufã»v’t
 *
buãv
);

562 
EVENT2_EXPORT_SYMBOL


563 
bufã»v’t_uÆock
(
bufã»v’t
 *
buãv
);

574 
EVENT2_EXPORT_SYMBOL


575 
bufã»v’t_šüef
(
bufã»v’t
 *
buãv
);

588 
EVENT2_EXPORT_SYMBOL


589 
bufã»v’t_deüef
(
bufã»v’t
 *
buãv
);

595 
	ebufã»v’t_æush_mode
 {

597 
BEV_NORMAL
 = 0,

600 
BEV_FLUSH
 = 1,

603 
BEV_FINISHED
 = 2

614 
EVENT2_EXPORT_SYMBOL


615 
bufã»v’t_æush
(
bufã»v’t
 *
buãv
,

616 
iÙy³
,

617 
bufã»v’t_æush_mode
 
mode
);

623 
	ebufã»v’t_Œigg”_İtiÚs
 {

625 
BEV_TRIG_IGNORE_WATERMARKS
 = (1<<16),

628 
BEV_TRIG_DEFER_CALLBACKS
 = 
BEV_OPT_DEFER_CALLBACKS


645 
EVENT2_EXPORT_SYMBOL


646 
bufã»v’t_Œigg”
(
bufã»v’t
 *
buãv
, 
iÙy³
,

647 
İtiÚs
);

658 
EVENT2_EXPORT_SYMBOL


659 
bufã»v’t_Œigg”_ev’t
(
bufã»v’t
 *
buãv
, 
wh©
,

660 
İtiÚs
);

670 
	ebufã»v’t_f‹r_»suÉ
 {

672 
BEV_OK
 = 0,

675 
BEV_NEED_MORE
 = 1,

679 
BEV_ERROR
 = 2

700 
bufã»v’t_f‹r_»suÉ
 (*
	tbufã»v’t_f‹r_cb
)(

701 
	tevbufãr
 *
	t¤c
, evbufã¸*
	td¡
, 
	tev_ssize_t
 
	td¡_lim™
,

702 
	tbufã»v’t_æush_mode
 
	tmode
, *
	tùx
);

717 
EVENT2_EXPORT_SYMBOL


718 
bufã»v’t
 *

719 
bufã»v’t_f‹r_Ãw
(
bufã»v’t
 *
und”lyšg
,

720 
bufã»v’t_f‹r_cb
 
šput_f‹r
,

721 
bufã»v’t_f‹r_cb
 
ouut_f‹r
,

722 
İtiÚs
,

723 (*
ä“_cÚ‹xt
)(*),

724 *
ùx
);

737 
EVENT2_EXPORT_SYMBOL


738 
bufã»v’t_·œ_Ãw
(
ev’t_ba£
 *
ba£
, 
İtiÚs
,

739 
bufã»v’t
 *
·œ
[2]);

745 
EVENT2_EXPORT_SYMBOL


746 
bufã»v’t
 *
bufã»v’t_·œ_g‘_·¹Ãr
(bufã»v’ˆ*
bev
);

752 
ev_tok’_buck‘_cfg
;

758 
bufã»v’t_¿‹_lim™_group
;

761 
	#EV_RATE_LIMIT_MAX
 
EV_SSIZE_MAX


	)

779 
EVENT2_EXPORT_SYMBOL


780 
ev_tok’_buck‘_cfg
 *
ev_tok’_buck‘_cfg_Ãw
(

781 
size_t
 
»ad_¿‹
, size_ˆ
»ad_bur¡
,

782 
size_t
 
wr™e_¿‹
, size_ˆ
wr™e_bur¡
,

783 cÚ¡ 
timev®
 *
tick_Ën
);

790 
EVENT2_EXPORT_SYMBOL


791 
ev_tok’_buck‘_cfg_ä“
(
ev_tok’_buck‘_cfg
 *
cfg
);

804 
EVENT2_EXPORT_SYMBOL


805 
bufã»v’t_£t_¿‹_lim™
(
bufã»v’t
 *
bev
,

806 
ev_tok’_buck‘_cfg
 *
cfg
);

825 
EVENT2_EXPORT_SYMBOL


826 
bufã»v’t_¿‹_lim™_group
 *
bufã»v’t_¿‹_lim™_group_Ãw
(

827 
ev’t_ba£
 *
ba£
,

828 cÚ¡ 
ev_tok’_buck‘_cfg
 *
cfg
);

834 
EVENT2_EXPORT_SYMBOL


835 
bufã»v’t_¿‹_lim™_group_£t_cfg
(

836 
bufã»v’t_¿‹_lim™_group
 *,

837 cÚ¡ 
ev_tok’_buck‘_cfg
 *);

855 
EVENT2_EXPORT_SYMBOL


856 
bufã»v’t_¿‹_lim™_group_£t_mš_sh¬e
(

857 
bufã»v’t_¿‹_lim™_group
 *, 
size_t
);

863 
EVENT2_EXPORT_SYMBOL


864 
bufã»v’t_¿‹_lim™_group_ä“
(
bufã»v’t_¿‹_lim™_group
 *);

876 
EVENT2_EXPORT_SYMBOL


877 
bufã»v’t_add_to_¿‹_lim™_group
(
bufã»v’t
 *
bev
,

878 
bufã»v’t_¿‹_lim™_group
 *
g
);

881 
EVENT2_EXPORT_SYMBOL


882 
bufã»v’t_»move_äom_¿‹_lim™_group
(
bufã»v’t
 *
bev
);

891 
EVENT2_EXPORT_SYMBOL


892 
bufã»v’t_£t_max_sšgË_»ad
(
bufã»v’t
 *
bev
, 
size_t
 
size
);

901 
EVENT2_EXPORT_SYMBOL


902 
bufã»v’t_£t_max_sšgË_wr™e
(
bufã»v’t
 *
bev
, 
size_t
 
size
);

905 
EVENT2_EXPORT_SYMBOL


906 
ev_ssize_t
 
bufã»v’t_g‘_max_sšgË_»ad
(
bufã»v’t
 *
bev
);

909 
EVENT2_EXPORT_SYMBOL


910 
ev_ssize_t
 
bufã»v’t_g‘_max_sšgË_wr™e
(
bufã»v’t
 *
bev
);

923 
EVENT2_EXPORT_SYMBOL


924 
ev_ssize_t
 
bufã»v’t_g‘_»ad_lim™
(
bufã»v’t
 *
bev
);

925 
EVENT2_EXPORT_SYMBOL


926 
ev_ssize_t
 
bufã»v’t_g‘_wr™e_lim™
(
bufã»v’t
 *
bev
);

929 
EVENT2_EXPORT_SYMBOL


930 
ev_ssize_t
 
bufã»v’t_g‘_max_to_»ad
(
bufã»v’t
 *
bev
);

931 
EVENT2_EXPORT_SYMBOL


932 
ev_ssize_t
 
bufã»v’t_g‘_max_to_wr™e
(
bufã»v’t
 *
bev
);

934 
EVENT2_EXPORT_SYMBOL


935 cÚ¡ 
ev_tok’_buck‘_cfg
 *
bufã»v’t_g‘_tok’_buck‘_cfg
(cÚ¡ 
bufã»v’t
 * 
bev
);

946 
EVENT2_EXPORT_SYMBOL


947 
ev_ssize_t
 
bufã»v’t_¿‹_lim™_group_g‘_»ad_lim™
(

948 
bufã»v’t_¿‹_lim™_group
 *);

949 
EVENT2_EXPORT_SYMBOL


950 
ev_ssize_t
 
bufã»v’t_¿‹_lim™_group_g‘_wr™e_lim™
(

951 
bufã»v’t_¿‹_lim™_group
 *);

968 
EVENT2_EXPORT_SYMBOL


969 
bufã»v’t_deüem’t_»ad_lim™
(
bufã»v’t
 *
bev
, 
ev_ssize_t
 
deü
);

970 
EVENT2_EXPORT_SYMBOL


971 
bufã»v’t_deüem’t_wr™e_lim™
(
bufã»v’t
 *
bev
, 
ev_ssize_t
 
deü
);

987 
EVENT2_EXPORT_SYMBOL


988 
bufã»v’t_¿‹_lim™_group_deüem’t_»ad
(

989 
bufã»v’t_¿‹_lim™_group
 *, 
ev_ssize_t
);

990 
EVENT2_EXPORT_SYMBOL


991 
bufã»v’t_¿‹_lim™_group_deüem’t_wr™e
(

992 
bufã»v’t_¿‹_lim™_group
 *, 
ev_ssize_t
);

1002 
EVENT2_EXPORT_SYMBOL


1003 
bufã»v’t_¿‹_lim™_group_g‘_tÙ®s
(

1004 
bufã»v’t_¿‹_lim™_group
 *
g½
,

1005 
ev_ušt64_t
 *
tÙ®_»ad_out
,ƒv_ušt64_ˆ*
tÙ®_wr™‹n_out
);

1012 
EVENT2_EXPORT_SYMBOL


1014 
bufã»v’t_¿‹_lim™_group_»£t_tÙ®s
(

1015 
bufã»v’t_¿‹_lim™_group
 *
g½
);

1017 #ifdeà
__ılu¥lus


	@/usr/include/event2/bufferevent_compat.h

28 #iâdeà
EVENT2_BUFFEREVENT_COMPAT_H_INCLUDED_


29 
	#EVENT2_BUFFEREVENT_COMPAT_H_INCLUDED_


	)

31 
	#evbufãrcb
 
bufã»v’t_d©a_cb


	)

32 
	#ev”rÜcb
 
bufã»v’t_ev’t_cb


	)

75 
bufã»v’t
 *
bufã»v’t_Ãw
(
evut_sock‘_t
 
fd
,

76 
evbufãrcb
 
»adcb
,ƒvbufãrcb 
wr™ecb
, 
ev”rÜcb
 
”rÜcb
, *
cb¬g
);

86 
bufã»v’t_£‰imeout
(
bufã»v’t
 *
buãv
,

87 
timeout_»ad
, 
timeout_wr™e
);

89 
	#EVBUFFER_READ
 
BEV_EVENT_READING


	)

90 
	#EVBUFFER_WRITE
 
BEV_EVENT_WRITING


	)

91 
	#EVBUFFER_EOF
 
BEV_EVENT_EOF


	)

92 
	#EVBUFFER_ERROR
 
BEV_EVENT_ERROR


	)

93 
	#EVBUFFER_TIMEOUT
 
BEV_EVENT_TIMEOUT


	)

96 
	#EVBUFFER_INPUT
(
x
è
	`bufã»v’t_g‘_šput
(x)

	)

98 
	#EVBUFFER_OUTPUT
(
x
è
	`bufã»v’t_g‘_ouut
(x)

	)

	@/usr/include/event2/bufferevent_struct.h

27 #iâdeà
EVENT2_BUFFEREVENT_STRUCT_H_INCLUDED_


28 
	#EVENT2_BUFFEREVENT_STRUCT_H_INCLUDED_


	)

40 #ifdeà
__ılu¥lus


44 
	~<ev’t2/ev’t-cÚfig.h
>

45 #ifdeà
EVENT__HAVE_SYS_TYPES_H


46 
	~<sys/ty³s.h
>

48 #ifdeà
EVENT__HAVE_SYS_TIME_H


49 
	~<sys/time.h
>

53 
	~<ev’t2/ut.h
>

55 
	~<ev’t2/ev’t_¡ruù.h
>

57 
	sev’t_w©”m¬k
 {

58 
size_t
 
low
;

59 
size_t
 
high
;

70 
	sbufã»v’t
 {

72 
ev’t_ba£
 *
ev_ba£
;

75 cÚ¡ 
bufã»v’t_İs
 *
be_İs
;

80 
ev’t
 
ev_»ad
;

84 
ev’t
 
ev_wr™e
;

88 
evbufãr
 *
šput
;

92 
evbufãr
 *
ouut
;

94 
ev’t_w©”m¬k
 
wm_»ad
;

95 
ev’t_w©”m¬k
 
wm_wr™e
;

97 
bufã»v’t_d©a_cb
 
»adcb
;

98 
bufã»v’t_d©a_cb
 
wr™ecb
;

101 
bufã»v’t_ev’t_cb
 
”rÜcb
;

102 *
cb¬g
;

104 
timev®
 
timeout_»ad
;

105 
timev®
 
timeout_wr™e
;

109 
’abËd
;

112 #ifdeà
__ılu¥lus


	@/usr/include/event2/event-config.h

11 #iâdeà
EVENT2_EVENT_CONFIG_H_INCLUDED_


12 
	#EVENT2_EVENT_CONFIG_H_INCLUDED_


	)

27 
	#EVENT__HAVE_ACCEPT4
 1

	)

36 
	#EVENT__HAVE_ARPA_INET_H
 1

	)

39 
	#EVENT__HAVE_CLOCK_GETTIME
 1

	)

43 
	#EVENT__HAVE_DECL_CTL_KERN
 1

	)

47 
	#EVENT__HAVE_DECL_KERN_ARND
 0

	)

51 
	#EVENT__HAVE_DECL_KERN_RANDOM
 1

	)

55 
	#EVENT__HAVE_DECL_RANDOM_UUID
 1

	)

61 
	#EVENT__HAVE_DLFCN_H
 1

	)

64 
	#EVENT__HAVE_EPOLL
 1

	)

67 
	#EVENT__HAVE_EPOLL_CREATE1
 1

	)

70 
	#EVENT__HAVE_EPOLL_CTL
 1

	)

73 
	#EVENT__HAVE_ERRNO_H
 1

	)

76 
	#EVENT__HAVE_EVENTFD
 1

	)

82 
	#EVENT__HAVE_FCNTL
 1

	)

85 
	#EVENT__HAVE_FCNTL_H
 1

	)

88 
	#EVENT__HAVE_FD_MASK
 1

	)

91 
	#EVENT__HAVE_GETADDRINFO
 1

	)

94 
	#EVENT__HAVE_GETEGID
 1

	)

97 
	#EVENT__HAVE_GETEUID
 1

	)

112 
	#EVENT__HAVE_GETIFADDRS
 1

	)

115 
	#EVENT__HAVE_GETNAMEINFO
 1

	)

118 
	#EVENT__HAVE_GETPROTOBYNUMBER
 1

	)

121 
	#EVENT__HAVE_GETSERVBYNAME
 1

	)

124 
	#EVENT__HAVE_GETTIMEOFDAY
 1

	)

127 
	#EVENT__HAVE_IFADDRS_H
 1

	)

130 
	#EVENT__HAVE_INET_NTOP
 1

	)

133 
	#EVENT__HAVE_INET_PTON
 1

	)

136 
	#EVENT__HAVE_INTTYPES_H
 1

	)

154 
	#EVENT__HAVE_MEMORY_H
 1

	)

157 
	#EVENT__HAVE_MMAP
 1

	)

160 
	#EVENT__HAVE_NANOSLEEP
 1

	)

163 
	#EVENT__HAVE_NETDB_H
 1

	)

169 
	#EVENT__HAVE_NETINET_IN_H
 1

	)

172 
	#EVENT__HAVE_NETINET_TCP_H
 1

	)

175 
	#EVENT__HAVE_OPENSSL
 1

	)

178 
	#EVENT__HAVE_PIPE
 1

	)

181 
	#EVENT__HAVE_PIPE2
 1

	)

184 
	#EVENT__HAVE_POLL
 1

	)

187 
	#EVENT__HAVE_POLL_H
 1

	)

199 
	#EVENT__HAVE_PTHREADS
 1

	)

202 
	#EVENT__HAVE_PUTENV
 1

	)

205 
	#EVENT__HAVE_SA_FAMILY_T
 1

	)

208 
	#EVENT__HAVE_SELECT
 1

	)

211 
	#EVENT__HAVE_SENDFILE
 1

	)

214 
	#EVENT__HAVE_SETENV
 1

	)

217 
	#EVENT__HAVE_SETFD
 1

	)

220 
	#EVENT__HAVE_SETRLIMIT
 1

	)

223 
	#EVENT__HAVE_SIGACTION
 1

	)

226 
	#EVENT__HAVE_SIGNAL
 1

	)

229 
	#EVENT__HAVE_SPLICE
 1

	)

232 
	#EVENT__HAVE_STDARG_H
 1

	)

235 
	#EVENT__HAVE_STDDEF_H
 1

	)

238 
	#EVENT__HAVE_STDINT_H
 1

	)

241 
	#EVENT__HAVE_STDLIB_H
 1

	)

244 
	#EVENT__HAVE_STRINGS_H
 1

	)

247 
	#EVENT__HAVE_STRING_H
 1

	)

253 
	#EVENT__HAVE_STRSEP
 1

	)

256 
	#EVENT__HAVE_STRTOK_R
 1

	)

259 
	#EVENT__HAVE_STRTOLL
 1

	)

262 
	#EVENT__HAVE_STRUCT_ADDRINFO
 1

	)

265 
	#EVENT__HAVE_STRUCT_IN6_ADDR
 1

	)

268 
	#EVENT__HAVE_STRUCT_IN6_ADDR_S6_ADDR16
 1

	)

271 
	#EVENT__HAVE_STRUCT_IN6_ADDR_S6_ADDR32
 1

	)

274 
	#EVENT__HAVE_STRUCT_SOCKADDR_IN6
 1

	)

283 
	#EVENT__HAVE_STRUCT_SOCKADDR_STORAGE
 1

	)

286 
	#EVENT__HAVE_STRUCT_SOCKADDR_STORAGE_SS_FAMILY
 1

	)

295 
	#EVENT__HAVE_SYSCTL
 1

	)

301 
	#EVENT__HAVE_SYS_EPOLL_H
 1

	)

304 
	#EVENT__HAVE_SYS_EVENTFD_H
 1

	)

310 
	#EVENT__HAVE_SYS_IOCTL_H
 1

	)

313 
	#EVENT__HAVE_SYS_MMAN_H
 1

	)

316 
	#EVENT__HAVE_SYS_PARAM_H
 1

	)

319 
	#EVENT__HAVE_SYS_QUEUE_H
 1

	)

322 
	#EVENT__HAVE_SYS_RESOURCE_H
 1

	)

325 
	#EVENT__HAVE_SYS_SELECT_H
 1

	)

328 
	#EVENT__HAVE_SYS_SENDFILE_H
 1

	)

331 
	#EVENT__HAVE_SYS_SOCKET_H
 1

	)

334 
	#EVENT__HAVE_SYS_STAT_H
 1

	)

337 
	#EVENT__HAVE_SYS_SYSCTL_H
 1

	)

340 
	#EVENT__HAVE_SYS_TIMERFD_H
 1

	)

343 
	#EVENT__HAVE_SYS_TIME_H
 1

	)

346 
	#EVENT__HAVE_SYS_TYPES_H
 1

	)

349 
	#EVENT__HAVE_SYS_UIO_H
 1

	)

352 
	#EVENT__HAVE_SYS_WAIT_H
 1

	)

355 
	#EVENT__HAVE_TAILQFOREACH
 1

	)

358 
	#EVENT__HAVE_TIMERADD
 1

	)

361 
	#EVENT__HAVE_TIMERCLEAR
 1

	)

364 
	#EVENT__HAVE_TIMERCMP
 1

	)

367 
	#EVENT__HAVE_TIMERFD_CREATE
 1

	)

370 
	#EVENT__HAVE_TIMERISSET
 1

	)

373 
	#EVENT__HAVE_UINT16_T
 1

	)

376 
	#EVENT__HAVE_UINT32_T
 1

	)

379 
	#EVENT__HAVE_UINT64_T
 1

	)

382 
	#EVENT__HAVE_UINT8_T
 1

	)

385 
	#EVENT__HAVE_UINTPTR_T
 1

	)

388 
	#EVENT__HAVE_UMASK
 1

	)

391 
	#EVENT__HAVE_UNISTD_H
 1

	)

394 
	#EVENT__HAVE_UNSETENV
 1

	)

397 
	#EVENT__HAVE_USLEEP
 1

	)

400 
	#EVENT__HAVE_VASPRINTF
 1

	)

412 
	#EVENT__LT_OBJDIR
 ".libs/"

	)

415 
	#EVENT__NUMERIC_VERSION
 0x02010800

	)

418 
	#EVENT__PACKAGE
 "libev’t"

	)

421 
	#EVENT__PACKAGE_BUGREPORT
 ""

	)

424 
	#EVENT__PACKAGE_NAME
 "libev’t"

	)

427 
	#EVENT__PACKAGE_STRING
 "libev’ˆ2.1.8-¡abË"

	)

430 
	#EVENT__PACKAGE_TARNAME
 "libev’t"

	)

433 
	#EVENT__PACKAGE_URL
 ""

	)

436 
	#EVENT__PACKAGE_VERSION
 "2.1.8-¡abË"

	)

443 
	#EVENT__SIZEOF_INT
 4

	)

446 
	#EVENT__SIZEOF_LONG
 8

	)

449 
	#EVENT__SIZEOF_LONG_LONG
 8

	)

452 
	#EVENT__SIZEOF_OFF_T
 8

	)

455 
	#EVENT__SIZEOF_PTHREAD_T
 8

	)

458 
	#EVENT__SIZEOF_SHORT
 2

	)

461 
	#EVENT__SIZEOF_SIZE_T
 8

	)

464 
	#EVENT__SIZEOF_VOID_P
 8

	)

467 
	#EVENT__STDC_HEADERS
 1

	)

470 
	#EVENT__TIME_WITH_SYS_TIME
 1

	)

473 #iâdeà
EVENT___ALL_SOURCE


474 
	#EVENT___ALL_SOURCE
 1

	)

477 #iâdeà
EVENT___GNU_SOURCE


478 
	#EVENT___GNU_SOURCE
 1

	)

481 #iâdeà
EVENT___POSIX_PTHREAD_SEMANTICS


482 
	#EVENT___POSIX_PTHREAD_SEMANTICS
 1

	)

485 #iâdeà
EVENT___TANDEM_SOURCE


486 
	#EVENT___TANDEM_SOURCE
 1

	)

489 #iâdeà
EVENT____EXTENSIONS__


490 
	#EVENT____EXTENSIONS__
 1

	)

495 
	#EVENT__VERSION
 "2.1.8-¡abË"

	)

498 #iâdeà
EVENT___DARWIN_USE_64_BIT_INODE


499 
	#EVENT___DARWIN_USE_64_BIT_INODE
 1

	)

526 #iâdeà
EVENT____ılu¥lus


	@/usr/include/event2/event.h

27 #iâdeà
EVENT2_EVENT_H_INCLUDED_


28 
	#EVENT2_EVENT_H_INCLUDED_


	)

185 
	~<ev’t2/visib™y.h
>

187 #ifdeà
__ılu¥lus


191 
	~<ev’t2/ev’t-cÚfig.h
>

192 #ifdeà
EVENT__HAVE_SYS_TYPES_H


193 
	~<sys/ty³s.h
>

195 #ifdeà
EVENT__HAVE_SYS_TIME_H


196 
	~<sys/time.h
>

199 
	~<¡dio.h
>

202 
	~<ev’t2/ut.h
>

217 
ev’t_ba£


218 #ifdeà
EVENT_IN_DOXYGEN_


276 
ev’t


277 #ifdeà
EVENT_IN_DOXYGEN_


295 
ev’t_cÚfig


296 #ifdeà
EVENT_IN_DOXYGEN_


321 
EVENT2_EXPORT_SYMBOL


322 
ev’t_’abË_debug_mode
();

333 
EVENT2_EXPORT_SYMBOL


334 
ev’t_debug_uÇssign
(
ev’t
 *);

343 
EVENT2_EXPORT_SYMBOL


344 
ev’t_ba£
 *
ev’t_ba£_Ãw
();

356 
EVENT2_EXPORT_SYMBOL


357 
ev’t_»š™
(
ev’t_ba£
 *
ba£
);

372 
EVENT2_EXPORT_SYMBOL


373 
ev’t_ba£_di¥©ch
(
ev’t_ba£
 *);

381 
EVENT2_EXPORT_SYMBOL


382 cÚ¡ *
ev’t_ba£_g‘_m‘hod
(cÚ¡ 
ev’t_ba£
 *);

396 
EVENT2_EXPORT_SYMBOL


397 cÚ¡ **
ev’t_g‘_suµÜ‹d_m‘hods
();

402 
EVENT2_EXPORT_SYMBOL


403 
ev’t_g‘time_mÚÙÚic
(
ev’t_ba£
 *
ba£
, 
timev®
 *

);

413 
	#EVENT_BASE_COUNT_ACTIVE
 1U

	)

416 
	#EVENT_BASE_COUNT_VIRTUAL
 2U

	)

419 
	#EVENT_BASE_COUNT_ADDED
 4U

	)

440 
EVENT2_EXPORT_SYMBOL


441 
ev’t_ba£_g‘_num_ev’ts
(
ev’t_ba£
 *, );

453 
EVENT2_EXPORT_SYMBOL


454 
ev’t_ba£_g‘_max_ev’ts
(
ev’t_ba£
 *, , );

466 
EVENT2_EXPORT_SYMBOL


467 
ev’t_cÚfig
 *
ev’t_cÚfig_Ãw
();

474 
EVENT2_EXPORT_SYMBOL


475 
ev’t_cÚfig_ä“
(
ev’t_cÚfig
 *
cfg
);

489 
EVENT2_EXPORT_SYMBOL


490 
ev’t_cÚfig_avoid_m‘hod
(
ev’t_cÚfig
 *
cfg
, cÚ¡ *
m‘hod
);

501 
	eev’t_m‘hod_ã©u»
 {

503 
EV_FEATURE_ET
 = 0x01,

508 
EV_FEATURE_O1
 = 0x02,

511 
EV_FEATURE_FDS
 = 0x04,

518 
EV_FEATURE_EARLY_CLOSE
 = 0x08

529 
	eev’t_ba£_cÚfig_æag
 {

536 
EVENT_BASE_FLAG_NOLOCK
 = 0x01,

539 
EVENT_BASE_FLAG_IGNORE_ENV
 = 0x02,

546 
EVENT_BASE_FLAG_STARTUP_IOCP
 = 0x04,

550 
EVENT_BASE_FLAG_NO_CACHE_TIME
 = 0x08,

566 
EVENT_BASE_FLAG_EPOLL_USE_CHANGELIST
 = 0x10,

573 
EVENT_BASE_FLAG_PRECISE_TIMER
 = 0x20

583 
EVENT2_EXPORT_SYMBOL


584 
ev’t_ba£_g‘_ã©u»s
(cÚ¡ 
ev’t_ba£
 *
ba£
);

608 
EVENT2_EXPORT_SYMBOL


609 
ev’t_cÚfig_»quœe_ã©u»s
(
ev’t_cÚfig
 *
cfg
, 
ã©u»
);

617 
EVENT2_EXPORT_SYMBOL


618 
ev’t_cÚfig_£t_æag
(
ev’t_cÚfig
 *
cfg
, 
æag
);

629 
EVENT2_EXPORT_SYMBOL


630 
ev’t_cÚfig_£t_num_ıus_hšt
(
ev’t_cÚfig
 *
cfg
, 
ıus
);

660 
EVENT2_EXPORT_SYMBOL


661 
ev’t_cÚfig_£t_max_di¥©ch_š‹rv®
(
ev’t_cÚfig
 *
cfg
,

662 cÚ¡ 
timev®
 *
max_š‹rv®
, 
max_ÿÎbacks
,

663 
mš_´iÜ™y
);

677 
EVENT2_EXPORT_SYMBOL


678 
ev’t_ba£
 *
ev’t_ba£_Ãw_w™h_cÚfig
(cÚ¡ 
ev’t_cÚfig
 *);

691 
EVENT2_EXPORT_SYMBOL


692 
ev’t_ba£_ä“
(
ev’t_ba£
 *);

700 
EVENT2_EXPORT_SYMBOL


701 
ev’t_ba£_ä“_nofš®ize
(
ev’t_ba£
 *);

706 
	#EVENT_LOG_DEBUG
 0

	)

707 
	#EVENT_LOG_MSG
 1

	)

708 
	#EVENT_LOG_WARN
 2

	)

709 
	#EVENT_LOG_ERR
 3

	)

714 
	#_EVENT_LOG_DEBUG
 
EVENT_LOG_DEBUG


	)

715 
	#_EVENT_LOG_MSG
 
EVENT_LOG_MSG


	)

716 
	#_EVENT_LOG_WARN
 
EVENT_LOG_WARN


	)

717 
	#_EVENT_LOG_ERR
 
EVENT_LOG_ERR


	)

724 (*
ev’t_log_cb
)(
	t£v”™y
, cÚ¡ *
	tmsg
);

735 
EVENT2_EXPORT_SYMBOL


736 
ev’t_£t_log_ÿÎback
(
ev’t_log_cb
 
cb
);

743 (*
ev’t_çl_cb
)(
	t”r
);

757 
EVENT2_EXPORT_SYMBOL


758 
ev’t_£t_çl_ÿÎback
(
ev’t_çl_cb
 
cb
);

760 
	#EVENT_DBG_ALL
 0xffffffffu

	)

761 
	#EVENT_DBG_NONE
 0

	)

777 
EVENT2_EXPORT_SYMBOL


778 
ev’t_’abË_debug_loggšg
(
ev_ušt32_t
 
which
);

789 
EVENT2_EXPORT_SYMBOL


790 
ev’t_ba£_£t
(
ev’t_ba£
 *, 
ev’t
 *);

799 
	#EVLOOP_ONCE
 0x01

	)

802 
	#EVLOOP_NONBLOCK
 0x02

	)

807 
	#EVLOOP_NO_EXIT_ON_EMPTY
 0x04

	)

828 
EVENT2_EXPORT_SYMBOL


829 
ev’t_ba£_loİ
(
ev’t_ba£
 *, );

846 
EVENT2_EXPORT_SYMBOL


847 
ev’t_ba£_loİex™
(
ev’t_ba£
 *, cÚ¡ 
timev®
 *);

862 
EVENT2_EXPORT_SYMBOL


863 
ev’t_ba£_loİb»ak
(
ev’t_ba£
 *);

882 
EVENT2_EXPORT_SYMBOL


883 
ev’t_ba£_loİcÚtšue
(
ev’t_ba£
 *);

897 
EVENT2_EXPORT_SYMBOL


898 
ev’t_ba£_gÙ_ex™
(
ev’t_ba£
 *);

912 
EVENT2_EXPORT_SYMBOL


913 
ev’t_ba£_gÙ_b»ak
(
ev’t_ba£
 *);

924 
	#EV_TIMEOUT
 0x01

	)

926 
	#EV_READ
 0x02

	)

928 
	#EV_WRITE
 0x04

	)

930 
	#EV_SIGNAL
 0x08

	)

937 
	#EV_PERSIST
 0x10

	)

939 
	#EV_ET
 0x20

	)

951 
	#EV_FINALIZE
 0x40

	)

960 
	#EV_CLOSED
 0x80

	)

968 
	#evtim”_assign
(
ev
, 
b
, 
cb
, 
¬g
) \

969 
	`ev’t_assign
((
ev
), (
b
), -1, 0, (
cb
), (
¬g
))

	)

970 
	#evtim”_Ãw
(
b
, 
cb
, 
¬g
è
	`ev’t_Ãw
((b), -1, 0, (cb), (¬g))

	)

971 
	#evtim”_add
(
ev
, 
tv
è
	`ev’t_add
(Óv), (tv))

	)

972 
	#evtim”_d–
(
ev
è
	`ev’t_d–
Óv)

	)

973 
	#evtim”_³ndšg
(
ev
, 
tv
è
	`ev’t_³ndšg
(Óv), 
EV_TIMEOUT
, (tv))

	)

974 
	#evtim”_š™Ÿlized
(
ev
è
	`ev’t_š™Ÿlized
Óv)

	)

983 
	#evsigÇl_add
(
ev
, 
tv
è
	`ev’t_add
(Óv), (tv))

	)

984 
	#evsigÇl_assign
(
ev
, 
b
, 
x
, 
cb
, 
¬g
) \

985 
	`ev’t_assign
((
ev
), (
b
), (
x
), 
EV_SIGNAL
|
EV_PERSIST
, 
cb
, (
¬g
))

	)

986 
	#evsigÇl_Ãw
(
b
, 
x
, 
cb
, 
¬g
) \

987 
	`ev’t_Ãw
((
b
), (
x
), 
EV_SIGNAL
|
EV_PERSIST
, (
cb
), (
¬g
))

	)

988 
	#evsigÇl_d–
(
ev
è
	`ev’t_d–
Óv)

	)

989 
	#evsigÇl_³ndšg
(
ev
, 
tv
è
	`ev’t_³ndšg
(Óv), 
EV_SIGNAL
, (tv))

	)

990 
	#evsigÇl_š™Ÿlized
(
ev
è
	`ev’t_š™Ÿlized
Óv)

	)

1004 (*
ev’t_ÿÎback_â
)(
	tevut_sock‘_t
, , *);

1028 
EVENT2_EXPORT_SYMBOL


1029 *
ev’t_£lf_cb¬g
();

1079 
EVENT2_EXPORT_SYMBOL


1080 
ev’t
 *
ev’t_Ãw
(
ev’t_ba£
 *, 
evut_sock‘_t
, , 
ev’t_ÿÎback_â
, *);

1121 
EVENT2_EXPORT_SYMBOL


1122 
ev’t_assign
(
ev’t
 *, 
ev’t_ba£
 *, 
evut_sock‘_t
, , 
ev’t_ÿÎback_â
, *);

1130 
EVENT2_EXPORT_SYMBOL


1131 
ev’t_ä“
(
ev’t
 *);

1140 (*
ev’t_fš®ize_ÿÎback_â
)(
	tev’t
 *, *);

1175 
EVENT2_EXPORT_SYMBOL


1176 
ev’t_fš®ize
(, 
ev’t
 *, 
ev’t_fš®ize_ÿÎback_â
);

1177 
EVENT2_EXPORT_SYMBOL


1178 
ev’t_ä“_fš®ize
(, 
ev’t
 *, 
ev’t_fš®ize_ÿÎback_â
);

1205 
EVENT2_EXPORT_SYMBOL


1206 
ev’t_ba£_Úû
(
ev’t_ba£
 *, 
evut_sock‘_t
, , 
ev’t_ÿÎback_â
, *, cÚ¡ 
timev®
 *);

1229 
EVENT2_EXPORT_SYMBOL


1230 
ev’t_add
(
ev’t
 *
ev
, cÚ¡ 
timev®
 *
timeout
);

1241 
EVENT2_EXPORT_SYMBOL


1242 
ev’t_»move_tim”
(
ev’t
 *
ev
);

1255 
EVENT2_EXPORT_SYMBOL


1256 
ev’t_d–
(
ev’t
 *);

1266 
EVENT2_EXPORT_SYMBOL


1267 
ev’t_d–_noblock
(
ev’t
 *
ev
);

1276 
EVENT2_EXPORT_SYMBOL


1277 
ev’t_d–_block
(
ev’t
 *
ev
);

1293 
EVENT2_EXPORT_SYMBOL


1294 
ev’t_aùive
(
ev’t
 *
ev
, 
»s
, 
nÿÎs
);

1309 
EVENT2_EXPORT_SYMBOL


1310 
ev’t_³ndšg
(cÚ¡ 
ev’t
 *
ev
, 
ev’ts
, 
timev®
 *
tv
);

1318 
EVENT2_EXPORT_SYMBOL


1319 
ev’t
 *
ev’t_ba£_g‘_ruÂšg_ev’t
(
ev’t_ba£
 *
ba£
);

1336 
EVENT2_EXPORT_SYMBOL


1337 
ev’t_š™Ÿlized
(cÚ¡ 
ev’t
 *
ev
);

1342 
	#ev’t_g‘_sigÇl
(
ev
è(()
	`ev’t_g‘_fd
Óv))

	)

1348 
EVENT2_EXPORT_SYMBOL


1349 
evut_sock‘_t
 
ev’t_g‘_fd
(cÚ¡ 
ev’t
 *
ev
);

1354 
EVENT2_EXPORT_SYMBOL


1355 
ev’t_ba£
 *
ev’t_g‘_ba£
(cÚ¡ 
ev’t
 *
ev
);

1360 
EVENT2_EXPORT_SYMBOL


1361 
ev’t_g‘_ev’ts
(cÚ¡ 
ev’t
 *
ev
);

1366 
EVENT2_EXPORT_SYMBOL


1367 
ev’t_ÿÎback_â
 
ev’t_g‘_ÿÎback
(cÚ¡ 
ev’t
 *
ev
);

1372 
EVENT2_EXPORT_SYMBOL


1373 *
ev’t_g‘_ÿÎback_¬g
(cÚ¡ 
ev’t
 *
ev
);

1379 
EVENT2_EXPORT_SYMBOL


1380 
ev’t_g‘_´iÜ™y
(cÚ¡ 
ev’t
 *
ev
);

1389 
EVENT2_EXPORT_SYMBOL


1390 
ev’t_g‘_assignm’t
(cÚ¡ 
ev’t
 *event,

1391 
ev’t_ba£
 **
ba£_out
, 
evut_sock‘_t
 *
fd_out
, *
ev’ts_out
,

1392 
ev’t_ÿÎback_â
 *
ÿÎback_out
, **
¬g_out
);

1407 
EVENT2_EXPORT_SYMBOL


1408 
size_t
 
ev’t_g‘_¡ruù_ev’t_size
();

1419 
EVENT2_EXPORT_SYMBOL


1420 cÚ¡ *
ev’t_g‘_v”siÚ
();

1433 
EVENT2_EXPORT_SYMBOL


1434 
ev_ušt32_t
 
ev’t_g‘_v”siÚ_numb”
();

1437 
	#LIBEVENT_VERSION
 
EVENT__VERSION


	)

1440 
	#LIBEVENT_VERSION_NUMBER
 
EVENT__NUMERIC_VERSION


	)

1443 
	#EVENT_MAX_PRIORITIES
 256

	)

1471 
EVENT2_EXPORT_SYMBOL


1472 
ev’t_ba£_´iÜ™y_š™
(
ev’t_ba£
 *, );

1481 
EVENT2_EXPORT_SYMBOL


1482 
ev’t_ba£_g‘_ÅriÜ™›s
(
ev’t_ba£
 *
eb
);

1492 
EVENT2_EXPORT_SYMBOL


1493 
ev’t_´iÜ™y_£t
(
ev’t
 *, );

1514 
EVENT2_EXPORT_SYMBOL


1515 cÚ¡ 
timev®
 *
ev’t_ba£_š™_commÚ_timeout
(
ev’t_ba£
 *
ba£
,

1516 cÚ¡ 
timev®
 *
du¿tiÚ
);

1518 #ià!
defšed
(
EVENT__DISABLE_MM_REPLACEMENT
è|| defšed(
EVENT_IN_DOXYGEN_
)

1541 
EVENT2_EXPORT_SYMBOL


1542 
ev’t_£t_mem_funùiÚs
(

1543 *(*
m®loc_â
)(
size_t
 
sz
),

1544 *(*
»®loc_â
)(*
±r
, 
size_t
 
sz
),

1545 (*
ä“_â
)(*
±r
));

1548 
	#EVENT_SET_MEM_FUNCTIONS_IMPLEMENTED


	)

1561 
EVENT2_EXPORT_SYMBOL


1562 
ev’t_ba£_dump_ev’ts
(
ev’t_ba£
 *, 
FILE
 *);

1575 
EVENT2_EXPORT_SYMBOL


1576 
ev’t_ba£_aùive_by_fd
(
ev’t_ba£
 *
ba£
, 
evut_sock‘_t
 
fd
, 
ev’ts
);

1587 
EVENT2_EXPORT_SYMBOL


1588 
ev’t_ba£_aùive_by_sigÇl
(
ev’t_ba£
 *
ba£
, 
sig
);

1593 (*
ev’t_ba£_fÜ—ch_ev’t_cb
)(cÚ¡ 
	tev’t_ba£
 *, cÚ¡ 
	tev’t
 *, *);

1620 
EVENT2_EXPORT_SYMBOL


1621 
ev’t_ba£_fÜ—ch_ev’t
(
ev’t_ba£
 *
ba£
, 
ev’t_ba£_fÜ—ch_ev’t_cb
 
â
, *
¬g
);

1635 
EVENT2_EXPORT_SYMBOL


1636 
ev’t_ba£_g‘timeofday_ÿched
(
ev’t_ba£
 *
ba£
,

1637 
timev®
 *
tv
);

1651 
EVENT2_EXPORT_SYMBOL


1652 
ev’t_ba£_upd©e_ÿche_time
(
ev’t_ba£
 *
ba£
);

1668 
EVENT2_EXPORT_SYMBOL


1669 
libev’t_glob®_shutdown
();

1671 #ifdeà
__ılu¥lus


	@/usr/include/event2/event_compat.h

27 #iâdeà
EVENT2_EVENT_COMPAT_H_INCLUDED_


28 
	#EVENT2_EVENT_COMPAT_H_INCLUDED_


	)

44 
	~<ev’t2/visib™y.h
>

46 #ifdeà
__ılu¥lus


50 
	~<ev’t2/ev’t-cÚfig.h
>

51 #ifdeà
EVENT__HAVE_SYS_TYPES_H


52 
	~<sys/ty³s.h
>

54 #ifdeà
EVENT__HAVE_SYS_TIME_H


55 
	~<sys/time.h
>

59 
	~<ev’t2/ut.h
>

74 
EVENT2_EXPORT_SYMBOL


75 
ev’t_ba£
 *
ev’t_š™
();

88 
EVENT2_EXPORT_SYMBOL


89 
ev’t_di¥©ch
();

102 
EVENT2_EXPORT_SYMBOL


103 
ev’t_loİ
();

118 
EVENT2_EXPORT_SYMBOL


119 
ev’t_loİex™
(cÚ¡ 
timev®
 *);

134 
EVENT2_EXPORT_SYMBOL


135 
ev’t_loİb»ak
();

146 
EVENT2_EXPORT_SYMBOL


147 
ev’t_Úû
(
evut_sock‘_t
 , ,

148 (*)(
evut_sock‘_t
, , *), *, cÚ¡ 
timev®
 *);

160 
EVENT2_EXPORT_SYMBOL


161 cÚ¡ *
ev’t_g‘_m‘hod
();

173 
EVENT2_EXPORT_SYMBOL


174 
ev’t_´iÜ™y_š™
();

183 
EVENT2_EXPORT_SYMBOL


184 
ev’t_£t
(
ev’t
 *, 
evut_sock‘_t
, , (*)(evutil_socket_t, , *), *);

186 
	#evtim”_£t
(
ev
, 
cb
, 
¬g
è
	`ev’t_£t
(Óv), -1, 0, (cb), (¬g))

	)

187 
	#evsigÇl_£t
(
ev
, 
x
, 
cb
, 
¬g
) \

188 
	`ev’t_£t
((
ev
), (
x
), 
EV_SIGNAL
|
EV_PERSIST
, (
cb
), (
¬g
))

	)

198 
	#timeout_add
(
ev
, 
tv
è
	`ev’t_add
(Óv), (tv))

	)

199 
	#timeout_£t
(
ev
, 
cb
, 
¬g
è
	`ev’t_£t
(Óv), -1, 0, (cb), (¬g))

	)

200 
	#timeout_d–
(
ev
è
	`ev’t_d–
Óv)

	)

201 
	#timeout_³ndšg
(
ev
, 
tv
è
	`ev’t_³ndšg
(Óv), 
EV_TIMEOUT
, (tv))

	)

202 
	#timeout_š™Ÿlized
(
ev
è
	`ev’t_š™Ÿlized
Óv)

	)

212 
	#sigÇl_add
(
ev
, 
tv
è
	`ev’t_add
(Óv), (tv))

	)

213 
	#sigÇl_£t
(
ev
, 
x
, 
cb
, 
¬g
) \

214 
	`ev’t_£t
((
ev
), (
x
), 
EV_SIGNAL
|
EV_PERSIST
, (
cb
), (
¬g
))

	)

215 
	#sigÇl_d–
(
ev
è
	`ev’t_d–
Óv)

	)

216 
	#sigÇl_³ndšg
(
ev
, 
tv
è
	`ev’t_³ndšg
(Óv), 
EV_SIGNAL
, (tv))

	)

217 
	#sigÇl_š™Ÿlized
(
ev
è
	`ev’t_š™Ÿlized
Óv)

	)

220 #iâdeà
EVENT_FD


222 
	#EVENT_FD
(
ev
è(()
	`ev’t_g‘_fd
Óv))

	)

223 
	#EVENT_SIGNAL
(
ev
è
	`ev’t_g‘_sigÇl
Óv)

	)

226 #ifdeà
__ılu¥lus


	@/usr/include/event2/event_struct.h

27 #iâdeà
EVENT2_EVENT_STRUCT_H_INCLUDED_


28 
	#EVENT2_EVENT_STRUCT_H_INCLUDED_


	)

39 #ifdeà
__ılu¥lus


43 
	~<ev’t2/ev’t-cÚfig.h
>

44 #ifdeà
EVENT__HAVE_SYS_TYPES_H


45 
	~<sys/ty³s.h
>

47 #ifdeà
EVENT__HAVE_SYS_TIME_H


48 
	~<sys/time.h
>

52 
	~<ev’t2/ut.h
>

55 
	~<ev’t2/keyv®q_¡ruù.h
>

57 
	#EVLIST_TIMEOUT
 0x01

	)

58 
	#EVLIST_INSERTED
 0x02

	)

59 
	#EVLIST_SIGNAL
 0x04

	)

60 
	#EVLIST_ACTIVE
 0x08

	)

61 
	#EVLIST_INTERNAL
 0x10

	)

62 
	#EVLIST_ACTIVE_LATER
 0x20

	)

63 
	#EVLIST_FINALIZING
 0x40

	)

64 
	#EVLIST_INIT
 0x80

	)

66 
	#EVLIST_ALL
 0xff

	)

69 #iâdeà
TAILQ_ENTRY


70 
	#EVENT_DEFINED_TQENTRY_


	)

71 
	#TAILQ_ENTRY
(
ty³
) \

73 
ty³
 *
tqe_Ãxt
; \

74 
ty³
 **
tqe_´ev
; \

75 }

	)

78 #iâdeà
TAILQ_HEAD


79 
	#EVENT_DEFINED_TQHEAD_


	)

80 
	#TAILQ_HEAD
(
Çme
, 
ty³
) \

81 
	sÇme
 { \

82 
ty³
 *
tqh_fœ¡
; \

83 
ty³
 **
tqh_Ï¡
; \

84 }

	)

88 #iâdeà
LIST_ENTRY


89 
	#EVENT_DEFINED_LISTENTRY_


	)

90 
	#LIST_ENTRY
(
ty³
) \

92 
ty³
 *
Ë_Ãxt
; \

93 
ty³
 **
Ë_´ev
; \

94 }

	)

97 #iâdeà
LIST_HEAD


98 
	#EVENT_DEFINED_LISTHEAD_


	)

99 
	#LIST_HEAD
(
Çme
, 
ty³
) \

100 
	sÇme
 { \

101 
ty³
 *
lh_fœ¡
; \

102 }

	)

105 
ev’t
;

107 
	sev’t_ÿÎback
 {

108 
TAILQ_ENTRY
(
ev’t_ÿÎback
è
evcb_aùive_Ãxt
;

109 
evcb_æags
;

110 
ev_ušt8_t
 
evcb_´i
;

111 
ev_ušt8_t
 
evcb_şosu»
;

114 (*
evcb_ÿÎback
)(
evut_sock‘_t
, , *);

115 (*
evcb_£lfcb
)(
ev’t_ÿÎback
 *, *);

116 (*
evcb_evfš®ize
)(
ev’t
 *, *);

117 (*
evcb_cbfš®ize
)(
ev’t_ÿÎback
 *, *);

118 } 
evcb_cb_uniÚ
;

119 *
evcb_¬g
;

122 
ev’t_ba£
;

123 
	sev’t
 {

124 
ev’t_ÿÎback
 
ev_evÿÎback
;

128 
TAILQ_ENTRY
(
ev’t
è
ev_Ãxt_w™h_commÚ_timeout
;

129 
mš_h—p_idx
;

130 } 
ev_timeout_pos
;

131 
evut_sock‘_t
 
ev_fd
;

133 
ev’t_ba£
 *
ev_ba£
;

138 
LIST_ENTRY
 (
ev’t
è
ev_io_Ãxt
;

139 
timev®
 
ev_timeout
;

140 } 
ev_io
;

144 
LIST_ENTRY
 (
ev’t
è
ev_sigÇl_Ãxt
;

145 
ev_nÿÎs
;

147 *
ev_²ÿÎs
;

148 } 
ev_sigÇl
;

149 } 
ev_
;

151 
ev_ev’ts
;

152 
ev_»s
;

153 
timev®
 
ev_timeout
;

156 
TAILQ_HEAD
 (
ev’t_li¡
, 
ev’t
);

158 #ifdeà
EVENT_DEFINED_TQENTRY_


159 #undeà
TAILQ_ENTRY


162 #ifdeà
EVENT_DEFINED_TQHEAD_


163 #undeà
TAILQ_HEAD


166 
LIST_HEAD
 (
ev’t_dli¡
, 
ev’t
);

168 #ifdeà
EVENT_DEFINED_LISTENTRY_


169 #undeà
LIST_ENTRY


172 #ifdeà
EVENT_DEFINED_LISTHEAD_


173 #undeà
LIST_HEAD


176 #ifdeà
__ılu¥lus


	@/usr/include/event2/tag.h

27 #iâdeà
EVENT2_TAG_H_INCLUDED_


28 
	#EVENT2_TAG_H_INCLUDED_


	)

36 
	~<ev’t2/visib™y.h
>

38 #ifdeà
__ılu¥lus


42 
	~<ev’t2/ev’t-cÚfig.h
>

43 #ifdeà
EVENT__HAVE_SYS_TYPES_H


44 
	~<sys/ty³s.h
>

46 #ifdeà
EVENT__HAVE_SYS_TIME_H


47 
	~<sys/time.h
>

51 
	~<ev’t2/ut.h
>

53 
evbufãr
;

61 
EVENT2_EXPORT_SYMBOL


62 
evg_š™
();

71 
EVENT2_EXPORT_SYMBOL


72 
evg_unm¬sh®_h—d”
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 *
±ag
);

74 
EVENT2_EXPORT_SYMBOL


75 
evg_m¬sh®
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
g
, cÚ¡ *
d©a
,

76 
ev_ušt32_t
 
Ën
);

77 
EVENT2_EXPORT_SYMBOL


78 
evg_m¬sh®_bufãr
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
g
,

79 
evbufãr
 *
d©a
);

91 
EVENT2_EXPORT_SYMBOL


92 
evg_’code_št
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
numb”
);

93 
EVENT2_EXPORT_SYMBOL


94 
evg_’code_št64
(
evbufãr
 *
evbuf
, 
ev_ušt64_t
 
numb”
);

96 
EVENT2_EXPORT_SYMBOL


97 
evg_m¬sh®_št
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
g
,

98 
ev_ušt32_t
 
š‹g”
);

99 
EVENT2_EXPORT_SYMBOL


100 
evg_m¬sh®_št64
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
g
,

101 
ev_ušt64_t
 
š‹g”
);

103 
EVENT2_EXPORT_SYMBOL


104 
evg_m¬sh®_¡ršg
(
evbufãr
 *
buf
, 
ev_ušt32_t
 
g
,

105 cÚ¡ *
¡ršg
);

107 
EVENT2_EXPORT_SYMBOL


108 
evg_m¬sh®_timev®
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
g
,

109 
timev®
 *
tv
);

111 
EVENT2_EXPORT_SYMBOL


112 
evg_unm¬sh®
(
evbufãr
 *
¤c
, 
ev_ušt32_t
 *
±ag
,

113 
evbufãr
 *
d¡
);

114 
EVENT2_EXPORT_SYMBOL


115 
evg_³ek
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 *
±ag
);

116 
EVENT2_EXPORT_SYMBOL


117 
evg_³ek_Ëngth
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 *
¶’gth
);

118 
EVENT2_EXPORT_SYMBOL


119 
evg_·ylßd_Ëngth
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 *
¶’gth
);

120 
EVENT2_EXPORT_SYMBOL


121 
evg_cÚsume
(
evbufãr
 *
evbuf
);

123 
EVENT2_EXPORT_SYMBOL


124 
evg_unm¬sh®_št
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
Ãed_g
,

125 
ev_ušt32_t
 *
pš‹g”
);

126 
EVENT2_EXPORT_SYMBOL


127 
evg_unm¬sh®_št64
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
Ãed_g
,

128 
ev_ušt64_t
 *
pš‹g”
);

130 
EVENT2_EXPORT_SYMBOL


131 
evg_unm¬sh®_fixed
(
evbufãr
 *
¤c
, 
ev_ušt32_t
 
Ãed_g
,

132 *
d©a
, 
size_t
 
Ën
);

134 
EVENT2_EXPORT_SYMBOL


135 
evg_unm¬sh®_¡ršg
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
Ãed_g
,

136 **
p¡ršg
);

138 
EVENT2_EXPORT_SYMBOL


139 
evg_unm¬sh®_timev®
(
evbufãr
 *
evbuf
, 
ev_ušt32_t
 
Ãed_g
,

140 
timev®
 *
±v
);

142 #ifdeà
__ılu¥lus


	@/usr/include/event2/tag_compat.h

27 #iâdeà
EVENT2_TAG_COMPAT_H_INCLUDED_


28 
	#EVENT2_TAG_COMPAT_H_INCLUDED_


	)

45 
	#’code_št
(
evbuf
, 
numb”
è
	`evg_’code_št
(Óvbuf), (numb”))

	)

46 
	#’code_št64
(
evbuf
, 
numb”
è
	`evg_’code_št64
(Óvbuf), (numb”))

	)

	@/usr/include/evutil.h

26 #iâdeà
EVENT1_EVUTIL_H_INCLUDED_


27 
	#EVENT1_EVUTIL_H_INCLUDED_


	)

37 
	~<ev’t2/ut.h
>

	@/usr/include/gnu/stubs.h

6 #ià!
defšed
 
__x86_64__


7 
	~<gnu/¡ubs-32.h
>

9 #ià
defšed
 
__x86_64__
 && defšed 
__LP64__


10 
	~<gnu/¡ubs-64.h
>

12 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


13 
	~<gnu/¡ubs-x32.h
>

	@/usr/include/linux/sysctl.h

23 #iâdeà
_LINUX_SYSCTL_H


24 
	#_LINUX_SYSCTL_H


	)

26 
	~<lšux/k”Ãl.h
>

27 
	~<lšux/ty³s.h
>

30 
	#CTL_MAXNAME
 10

	)

35 
	s__sysùl_¬gs
 {

36 *
	mÇme
;

37 
	mÆ’
;

38 *
	mŞdv®
;

39 
size_t
 *
	mŞdËÅ
;

40 *
	mÃwv®
;

41 
size_t
 
	mÃwËn
;

42 
	m__unu£d
[4];

51 
	mCTL_KERN
=1,

52 
	mCTL_VM
=2,

53 
	mCTL_NET
=3,

54 
	mCTL_PROC
=4,

55 
	mCTL_FS
=5,

56 
	mCTL_DEBUG
=6,

57 
	mCTL_DEV
=7,

58 
	mCTL_BUS
=8,

59 
	mCTL_ABI
=9,

60 
	mCTL_CPU
=10,

61 
	mCTL_ARLAN
=254,

62 
	mCTL_S390DBF
=5677,

63 
	mCTL_SUNRPC
=7249,

64 
	mCTL_PM
=9899,

65 
	mCTL_FRV
=9898,

71 
	mCTL_BUS_ISA
=1

77 
	mINOTIFY_MAX_USER_INSTANCES
=1,

78 
	mINOTIFY_MAX_USER_WATCHES
=2,

79 
	mINOTIFY_MAX_QUEUED_EVENTS
=3

85 
	mKERN_OSTYPE
=1,

86 
	mKERN_OSRELEASE
=2,

87 
	mKERN_OSREV
=3,

88 
	mKERN_VERSION
=4,

89 
	mKERN_SECUREMASK
=5,

90 
	mKERN_PROF
=6,

91 
	mKERN_NODENAME
=7,

92 
	mKERN_DOMAINNAME
=8,

94 
	mKERN_PANIC
=15,

95 
	mKERN_REALROOTDEV
=16,

97 
	mKERN_SPARC_REBOOT
=21,

98 
	mKERN_CTLALTDEL
=22,

99 
	mKERN_PRINTK
=23,

100 
	mKERN_NAMETRANS
=24,

101 
	mKERN_PPC_HTABRECLAIM
=25,

102 
	mKERN_PPC_ZEROPAGED
=26,

103 
	mKERN_PPC_POWERSAVE_NAP
=27,

104 
	mKERN_MODPROBE
=28,

105 
	mKERN_SG_BIG_BUFF
=29,

106 
	mKERN_ACCT
=30,

107 
	mKERN_PPC_L2CR
=31,

109 
	mKERN_RTSIGNR
=32,

110 
	mKERN_RTSIGMAX
=33,

112 
	mKERN_SHMMAX
=34,

113 
	mKERN_MSGMAX
=35,

114 
	mKERN_MSGMNB
=36,

115 
	mKERN_MSGPOOL
=37,

116 
	mKERN_SYSRQ
=38,

117 
	mKERN_MAX_THREADS
=39,

118 
	mKERN_RANDOM
=40,

119 
	mKERN_SHMALL
=41,

120 
	mKERN_MSGMNI
=42,

121 
	mKERN_SEM
=43,

122 
	mKERN_SPARC_STOP_A
=44,

123 
	mKERN_SHMMNI
=45,

124 
	mKERN_OVERFLOWUID
=46,

125 
	mKERN_OVERFLOWGID
=47,

126 
	mKERN_SHMPATH
=48,

127 
	mKERN_HOTPLUG
=49,

128 
	mKERN_IEEE_EMULATION_WARNINGS
=50,

129 
	mKERN_S390_USER_DEBUG_LOGGING
=51,

130 
	mKERN_CORE_USES_PID
=52,

131 
	mKERN_TAINTED
=53,

132 
	mKERN_CADPID
=54,

133 
	mKERN_PIDMAX
=55,

134 
	mKERN_CORE_PATTERN
=56,

135 
	mKERN_PANIC_ON_OOPS
=57,

136 
	mKERN_HPPA_PWRSW
=58,

137 
	mKERN_HPPA_UNALIGNED
=59,

138 
	mKERN_PRINTK_RATELIMIT
=60,

139 
	mKERN_PRINTK_RATELIMIT_BURST
=61,

140 
	mKERN_PTY
=62,

141 
	mKERN_NGROUPS_MAX
=63,

142 
	mKERN_SPARC_SCONS_PWROFF
=64,

143 
	mKERN_HZ_TIMER
=65,

144 
	mKERN_UNKNOWN_NMI_PANIC
=66,

145 
	mKERN_BOOTLOADER_TYPE
=67,

146 
	mKERN_RANDOMIZE
=68,

147 
	mKERN_SETUID_DUMPABLE
=69,

148 
	mKERN_SPIN_RETRY
=70,

149 
	mKERN_ACPI_VIDEO_FLAGS
=71,

150 
	mKERN_IA64_UNALIGNED
=72,

151 
	mKERN_COMPAT_LOG
=73,

152 
	mKERN_MAX_LOCK_DEPTH
=74,

153 
	mKERN_NMI_WATCHDOG
=75,

154 
	mKERN_PANIC_ON_NMI
=76,

155 
	mKERN_PANIC_ON_WARN
=77,

163 
	mVM_UNUSED1
=1,

164 
	mVM_UNUSED2
=2,

165 
	mVM_UNUSED3
=3,

166 
	mVM_UNUSED4
=4,

167 
	mVM_OVERCOMMIT_MEMORY
=5,

168 
	mVM_UNUSED5
=6,

169 
	mVM_UNUSED7
=7,

170 
	mVM_UNUSED8
=8,

171 
	mVM_UNUSED9
=9,

172 
	mVM_PAGE_CLUSTER
=10,

173 
	mVM_DIRTY_BACKGROUND
=11,

174 
	mVM_DIRTY_RATIO
=12,

175 
	mVM_DIRTY_WB_CS
=13,

176 
	mVM_DIRTY_EXPIRE_CS
=14,

177 
	mVM_NR_PDFLUSH_THREADS
=15,

178 
	mVM_OVERCOMMIT_RATIO
=16,

179 
	mVM_PAGEBUF
=17,

180 
	mVM_HUGETLB_PAGES
=18,

181 
	mVM_SWAPPINESS
=19,

182 
	mVM_LOWMEM_RESERVE_RATIO
=20,

183 
	mVM_MIN_FREE_KBYTES
=21,

184 
	mVM_MAX_MAP_COUNT
=22,

185 
	mVM_LAPTOP_MODE
=23,

186 
	mVM_BLOCK_DUMP
=24,

187 
	mVM_HUGETLB_GROUP
=25,

188 
	mVM_VFS_CACHE_PRESSURE
=26,

189 
	mVM_LEGACY_VA_LAYOUT
=27,

190 
	mVM_SWAP_TOKEN_TIMEOUT
=28,

191 
	mVM_DROP_PAGECACHE
=29,

192 
	mVM_PERCPU_PAGELIST_FRACTION
=30,

193 
	mVM_ZONE_RECLAIM_MODE
=31,

194 
	mVM_MIN_UNMAPPED
=32,

195 
	mVM_PANIC_ON_OOM
=33,

196 
	mVM_VDSO_ENABLED
=34,

197 
	mVM_MIN_SLAB
=35,

204 
	mNET_CORE
=1,

205 
	mNET_ETHER
=2,

206 
	mNET_802
=3,

207 
	mNET_UNIX
=4,

208 
	mNET_IPV4
=5,

209 
	mNET_IPX
=6,

210 
	mNET_ATALK
=7,

211 
	mNET_NETROM
=8,

212 
	mNET_AX25
=9,

213 
	mNET_BRIDGE
=10,

214 
	mNET_ROSE
=11,

215 
	mNET_IPV6
=12,

216 
	mNET_X25
=13,

217 
	mNET_TR
=14,

218 
	mNET_DECNET
=15,

219 
	mNET_ECONET
=16,

220 
	mNET_SCTP
=17,

221 
	mNET_LLC
=18,

222 
	mNET_NETFILTER
=19,

223 
	mNET_DCCP
=20,

224 
	mNET_IRDA
=412,

230 
	mRANDOM_POOLSIZE
=1,

231 
	mRANDOM_ENTROPY_COUNT
=2,

232 
	mRANDOM_READ_THRESH
=3,

233 
	mRANDOM_WRITE_THRESH
=4,

234 
	mRANDOM_BOOT_ID
=5,

235 
	mRANDOM_UUID
=6

241 
	mPTY_MAX
=1,

242 
	mPTY_NR
=2

248 
	mBUS_ISA_MEM_BASE
=1,

249 
	mBUS_ISA_PORT_BASE
=2,

250 
	mBUS_ISA_PORT_SHIFT
=3

256 
	mNET_CORE_WMEM_MAX
=1,

257 
	mNET_CORE_RMEM_MAX
=2,

258 
	mNET_CORE_WMEM_DEFAULT
=3,

259 
	mNET_CORE_RMEM_DEFAULT
=4,

261 
	mNET_CORE_MAX_BACKLOG
=6,

262 
	mNET_CORE_FASTROUTE
=7,

263 
	mNET_CORE_MSG_COST
=8,

264 
	mNET_CORE_MSG_BURST
=9,

265 
	mNET_CORE_OPTMEM_MAX
=10,

266 
	mNET_CORE_HOT_LIST_LENGTH
=11,

267 
	mNET_CORE_DIVERT_VERSION
=12,

268 
	mNET_CORE_NO_CONG_THRESH
=13,

269 
	mNET_CORE_NO_CONG
=14,

270 
	mNET_CORE_LO_CONG
=15,

271 
	mNET_CORE_MOD_CONG
=16,

272 
	mNET_CORE_DEV_WEIGHT
=17,

273 
	mNET_CORE_SOMAXCONN
=18,

274 
	mNET_CORE_BUDGET
=19,

275 
	mNET_CORE_AEVENT_ETIME
=20,

276 
	mNET_CORE_AEVENT_RSEQTH
=21,

277 
	mNET_CORE_WARNINGS
=22,

288 
	mNET_UNIX_DESTROY_DELAY
=1,

289 
	mNET_UNIX_DELETE_DELAY
=2,

290 
	mNET_UNIX_MAX_DGRAM_QLEN
=3,

296 
	mNET_NF_CONNTRACK_MAX
=1,

297 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

298 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

299 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

300 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

301 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

302 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

303 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

304 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

305 
	mNET_NF_CONNTRACK_UDP_TIMEOUT
=10,

306 
	mNET_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

307 
	mNET_NF_CONNTRACK_ICMP_TIMEOUT
=12,

308 
	mNET_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

309 
	mNET_NF_CONNTRACK_BUCKETS
=14,

310 
	mNET_NF_CONNTRACK_LOG_INVALID
=15,

311 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

312 
	mNET_NF_CONNTRACK_TCP_LOOSE
=17,

313 
	mNET_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

314 
	mNET_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

315 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

316 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

317 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

318 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

319 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

320 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

321 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

322 
	mNET_NF_CONNTRACK_COUNT
=27,

323 
	mNET_NF_CONNTRACK_ICMPV6_TIMEOUT
=28,

324 
	mNET_NF_CONNTRACK_FRAG6_TIMEOUT
=29,

325 
	mNET_NF_CONNTRACK_FRAG6_LOW_THRESH
=30,

326 
	mNET_NF_CONNTRACK_FRAG6_HIGH_THRESH
=31,

327 
	mNET_NF_CONNTRACK_CHECKSUM
=32,

334 
	mNET_IPV4_FORWARD
=8,

335 
	mNET_IPV4_DYNADDR
=9,

337 
	mNET_IPV4_CONF
=16,

338 
	mNET_IPV4_NEIGH
=17,

339 
	mNET_IPV4_ROUTE
=18,

340 
	mNET_IPV4_FIB_HASH
=19,

341 
	mNET_IPV4_NETFILTER
=20,

343 
	mNET_IPV4_TCP_TIMESTAMPS
=33,

344 
	mNET_IPV4_TCP_WINDOW_SCALING
=34,

345 
	mNET_IPV4_TCP_SACK
=35,

346 
	mNET_IPV4_TCP_RETRANS_COLLAPSE
=36,

347 
	mNET_IPV4_DEFAULT_TTL
=37,

348 
	mNET_IPV4_AUTOCONFIG
=38,

349 
	mNET_IPV4_NO_PMTU_DISC
=39,

350 
	mNET_IPV4_TCP_SYN_RETRIES
=40,

351 
	mNET_IPV4_IPFRAG_HIGH_THRESH
=41,

352 
	mNET_IPV4_IPFRAG_LOW_THRESH
=42,

353 
	mNET_IPV4_IPFRAG_TIME
=43,

354 
	mNET_IPV4_TCP_MAX_KA_PROBES
=44,

355 
	mNET_IPV4_TCP_KEEPALIVE_TIME
=45,

356 
	mNET_IPV4_TCP_KEEPALIVE_PROBES
=46,

357 
	mNET_IPV4_TCP_RETRIES1
=47,

358 
	mNET_IPV4_TCP_RETRIES2
=48,

359 
	mNET_IPV4_TCP_FIN_TIMEOUT
=49,

360 
	mNET_IPV4_IP_MASQ_DEBUG
=50,

361 
	mNET_TCP_SYNCOOKIES
=51,

362 
	mNET_TCP_STDURG
=52,

363 
	mNET_TCP_RFC1337
=53,

364 
	mNET_TCP_SYN_TAILDROP
=54,

365 
	mNET_TCP_MAX_SYN_BACKLOG
=55,

366 
	mNET_IPV4_LOCAL_PORT_RANGE
=56,

367 
	mNET_IPV4_ICMP_ECHO_IGNORE_ALL
=57,

368 
	mNET_IPV4_ICMP_ECHO_IGNORE_BROADCASTS
=58,

369 
	mNET_IPV4_ICMP_SOURCEQUENCH_RATE
=59,

370 
	mNET_IPV4_ICMP_DESTUNREACH_RATE
=60,

371 
	mNET_IPV4_ICMP_TIMEEXCEED_RATE
=61,

372 
	mNET_IPV4_ICMP_PARAMPROB_RATE
=62,

373 
	mNET_IPV4_ICMP_ECHOREPLY_RATE
=63,

374 
	mNET_IPV4_ICMP_IGNORE_BOGUS_ERROR_RESPONSES
=64,

375 
	mNET_IPV4_IGMP_MAX_MEMBERSHIPS
=65,

376 
	mNET_TCP_TW_RECYCLE
=66,

377 
	mNET_IPV4_ALWAYS_DEFRAG
=67,

378 
	mNET_IPV4_TCP_KEEPALIVE_INTVL
=68,

379 
	mNET_IPV4_INET_PEER_THRESHOLD
=69,

380 
	mNET_IPV4_INET_PEER_MINTTL
=70,

381 
	mNET_IPV4_INET_PEER_MAXTTL
=71,

382 
	mNET_IPV4_INET_PEER_GC_MINTIME
=72,

383 
	mNET_IPV4_INET_PEER_GC_MAXTIME
=73,

384 
	mNET_TCP_ORPHAN_RETRIES
=74,

385 
	mNET_TCP_ABORT_ON_OVERFLOW
=75,

386 
	mNET_TCP_SYNACK_RETRIES
=76,

387 
	mNET_TCP_MAX_ORPHANS
=77,

388 
	mNET_TCP_MAX_TW_BUCKETS
=78,

389 
	mNET_TCP_FACK
=79,

390 
	mNET_TCP_REORDERING
=80,

391 
	mNET_TCP_ECN
=81,

392 
	mNET_TCP_DSACK
=82,

393 
	mNET_TCP_MEM
=83,

394 
	mNET_TCP_WMEM
=84,

395 
	mNET_TCP_RMEM
=85,

396 
	mNET_TCP_APP_WIN
=86,

397 
	mNET_TCP_ADV_WIN_SCALE
=87,

398 
	mNET_IPV4_NONLOCAL_BIND
=88,

399 
	mNET_IPV4_ICMP_RATELIMIT
=89,

400 
	mNET_IPV4_ICMP_RATEMASK
=90,

401 
	mNET_TCP_TW_REUSE
=91,

402 
	mNET_TCP_FRTO
=92,

403 
	mNET_TCP_LOW_LATENCY
=93,

404 
	mNET_IPV4_IPFRAG_SECRET_INTERVAL
=94,

405 
	mNET_IPV4_IGMP_MAX_MSF
=96,

406 
	mNET_TCP_NO_METRICS_SAVE
=97,

407 
	mNET_TCP_DEFAULT_WIN_SCALE
=105,

408 
	mNET_TCP_MODERATE_RCVBUF
=106,

409 
	mNET_TCP_TSO_WIN_DIVISOR
=107,

410 
	mNET_TCP_BIC_BETA
=108,

411 
	mNET_IPV4_ICMP_ERRORS_USE_INBOUND_IFADDR
=109,

412 
	mNET_TCP_CONG_CONTROL
=110,

413 
	mNET_TCP_ABC
=111,

414 
	mNET_IPV4_IPFRAG_MAX_DIST
=112,

415 
	mNET_TCP_MTU_PROBING
=113,

416 
	mNET_TCP_BASE_MSS
=114,

417 
	mNET_IPV4_TCP_WORKAROUND_SIGNED_WINDOWS
=115,

418 
	mNET_TCP_DMA_COPYBREAK
=116,

419 
	mNET_TCP_SLOW_START_AFTER_IDLE
=117,

420 
	mNET_CIPSOV4_CACHE_ENABLE
=118,

421 
	mNET_CIPSOV4_CACHE_BUCKET_SIZE
=119,

422 
	mNET_CIPSOV4_RBM_OPTFMT
=120,

423 
	mNET_CIPSOV4_RBM_STRICTVALID
=121,

424 
	mNET_TCP_AVAIL_CONG_CONTROL
=122,

425 
	mNET_TCP_ALLOWED_CONG_CONTROL
=123,

426 
	mNET_TCP_MAX_SSTHRESH
=124,

427 
	mNET_TCP_FRTO_RESPONSE
=125,

431 
	mNET_IPV4_ROUTE_FLUSH
=1,

432 
	mNET_IPV4_ROUTE_MIN_DELAY
=2,

433 
	mNET_IPV4_ROUTE_MAX_DELAY
=3,

434 
	mNET_IPV4_ROUTE_GC_THRESH
=4,

435 
	mNET_IPV4_ROUTE_MAX_SIZE
=5,

436 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL
=6,

437 
	mNET_IPV4_ROUTE_GC_TIMEOUT
=7,

438 
	mNET_IPV4_ROUTE_GC_INTERVAL
=8,

439 
	mNET_IPV4_ROUTE_REDIRECT_LOAD
=9,

440 
	mNET_IPV4_ROUTE_REDIRECT_NUMBER
=10,

441 
	mNET_IPV4_ROUTE_REDIRECT_SILENCE
=11,

442 
	mNET_IPV4_ROUTE_ERROR_COST
=12,

443 
	mNET_IPV4_ROUTE_ERROR_BURST
=13,

444 
	mNET_IPV4_ROUTE_GC_ELASTICITY
=14,

445 
	mNET_IPV4_ROUTE_MTU_EXPIRES
=15,

446 
	mNET_IPV4_ROUTE_MIN_PMTU
=16,

447 
	mNET_IPV4_ROUTE_MIN_ADVMSS
=17,

448 
	mNET_IPV4_ROUTE_SECRET_INTERVAL
=18,

449 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL_MS
=19,

454 
	mNET_PROTO_CONF_ALL
=-2,

455 
	mNET_PROTO_CONF_DEFAULT
=-3

462 
	mNET_IPV4_CONF_FORWARDING
=1,

463 
	mNET_IPV4_CONF_MC_FORWARDING
=2,

464 
	mNET_IPV4_CONF_PROXY_ARP
=3,

465 
	mNET_IPV4_CONF_ACCEPT_REDIRECTS
=4,

466 
	mNET_IPV4_CONF_SECURE_REDIRECTS
=5,

467 
	mNET_IPV4_CONF_SEND_REDIRECTS
=6,

468 
	mNET_IPV4_CONF_SHARED_MEDIA
=7,

469 
	mNET_IPV4_CONF_RP_FILTER
=8,

470 
	mNET_IPV4_CONF_ACCEPT_SOURCE_ROUTE
=9,

471 
	mNET_IPV4_CONF_BOOTP_RELAY
=10,

472 
	mNET_IPV4_CONF_LOG_MARTIANS
=11,

473 
	mNET_IPV4_CONF_TAG
=12,

474 
	mNET_IPV4_CONF_ARPFILTER
=13,

475 
	mNET_IPV4_CONF_MEDIUM_ID
=14,

476 
	mNET_IPV4_CONF_NOXFRM
=15,

477 
	mNET_IPV4_CONF_NOPOLICY
=16,

478 
	mNET_IPV4_CONF_FORCE_IGMP_VERSION
=17,

479 
	mNET_IPV4_CONF_ARP_ANNOUNCE
=18,

480 
	mNET_IPV4_CONF_ARP_IGNORE
=19,

481 
	mNET_IPV4_CONF_PROMOTE_SECONDARIES
=20,

482 
	mNET_IPV4_CONF_ARP_ACCEPT
=21,

483 
	mNET_IPV4_CONF_ARP_NOTIFY
=22,

489 
	mNET_IPV4_NF_CONNTRACK_MAX
=1,

490 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

491 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

492 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

493 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

494 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

495 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

496 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

497 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

498 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT
=10,

499 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

500 
	mNET_IPV4_NF_CONNTRACK_ICMP_TIMEOUT
=12,

501 
	mNET_IPV4_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

502 
	mNET_IPV4_NF_CONNTRACK_BUCKETS
=14,

503 
	mNET_IPV4_NF_CONNTRACK_LOG_INVALID
=15,

504 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

505 
	mNET_IPV4_NF_CONNTRACK_TCP_LOOSE
=17,

506 
	mNET_IPV4_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

507 
	mNET_IPV4_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

508 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

509 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

510 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

511 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

512 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

513 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

514 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

515 
	mNET_IPV4_NF_CONNTRACK_COUNT
=27,

516 
	mNET_IPV4_NF_CONNTRACK_CHECKSUM
=28,

521 
	mNET_IPV6_CONF
=16,

522 
	mNET_IPV6_NEIGH
=17,

523 
	mNET_IPV6_ROUTE
=18,

524 
	mNET_IPV6_ICMP
=19,

525 
	mNET_IPV6_BINDV6ONLY
=20,

526 
	mNET_IPV6_IP6FRAG_HIGH_THRESH
=21,

527 
	mNET_IPV6_IP6FRAG_LOW_THRESH
=22,

528 
	mNET_IPV6_IP6FRAG_TIME
=23,

529 
	mNET_IPV6_IP6FRAG_SECRET_INTERVAL
=24,

530 
	mNET_IPV6_MLD_MAX_MSF
=25,

534 
	mNET_IPV6_ROUTE_FLUSH
=1,

535 
	mNET_IPV6_ROUTE_GC_THRESH
=2,

536 
	mNET_IPV6_ROUTE_MAX_SIZE
=3,

537 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL
=4,

538 
	mNET_IPV6_ROUTE_GC_TIMEOUT
=5,

539 
	mNET_IPV6_ROUTE_GC_INTERVAL
=6,

540 
	mNET_IPV6_ROUTE_GC_ELASTICITY
=7,

541 
	mNET_IPV6_ROUTE_MTU_EXPIRES
=8,

542 
	mNET_IPV6_ROUTE_MIN_ADVMSS
=9,

543 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL_MS
=10

547 
	mNET_IPV6_FORWARDING
=1,

548 
	mNET_IPV6_HOP_LIMIT
=2,

549 
	mNET_IPV6_MTU
=3,

550 
	mNET_IPV6_ACCEPT_RA
=4,

551 
	mNET_IPV6_ACCEPT_REDIRECTS
=5,

552 
	mNET_IPV6_AUTOCONF
=6,

553 
	mNET_IPV6_DAD_TRANSMITS
=7,

554 
	mNET_IPV6_RTR_SOLICITS
=8,

555 
	mNET_IPV6_RTR_SOLICIT_INTERVAL
=9,

556 
	mNET_IPV6_RTR_SOLICIT_DELAY
=10,

557 
	mNET_IPV6_USE_TEMPADDR
=11,

558 
	mNET_IPV6_TEMP_VALID_LFT
=12,

559 
	mNET_IPV6_TEMP_PREFERED_LFT
=13,

560 
	mNET_IPV6_REGEN_MAX_RETRY
=14,

561 
	mNET_IPV6_MAX_DESYNC_FACTOR
=15,

562 
	mNET_IPV6_MAX_ADDRESSES
=16,

563 
	mNET_IPV6_FORCE_MLD_VERSION
=17,

564 
	mNET_IPV6_ACCEPT_RA_DEFRTR
=18,

565 
	mNET_IPV6_ACCEPT_RA_PINFO
=19,

566 
	mNET_IPV6_ACCEPT_RA_RTR_PREF
=20,

567 
	mNET_IPV6_RTR_PROBE_INTERVAL
=21,

568 
	mNET_IPV6_ACCEPT_RA_RT_INFO_MAX_PLEN
=22,

569 
	mNET_IPV6_PROXY_NDP
=23,

570 
	mNET_IPV6_ACCEPT_SOURCE_ROUTE
=25,

571 
	mNET_IPV6_ACCEPT_RA_FROM_LOCAL
=26,

572 
	mNET_IPV6_ACCEPT_RA_RT_INFO_MIN_PLEN
=27,

573 
	m__NET_IPV6_MAX


578 
	mNET_IPV6_ICMP_RATELIMIT
=1

583 
	mNET_NEIGH_MCAST_SOLICIT
=1,

584 
	mNET_NEIGH_UCAST_SOLICIT
=2,

585 
	mNET_NEIGH_APP_SOLICIT
=3,

586 
	mNET_NEIGH_RETRANS_TIME
=4,

587 
	mNET_NEIGH_REACHABLE_TIME
=5,

588 
	mNET_NEIGH_DELAY_PROBE_TIME
=6,

589 
	mNET_NEIGH_GC_STALE_TIME
=7,

590 
	mNET_NEIGH_UNRES_QLEN
=8,

591 
	mNET_NEIGH_PROXY_QLEN
=9,

592 
	mNET_NEIGH_ANYCAST_DELAY
=10,

593 
	mNET_NEIGH_PROXY_DELAY
=11,

594 
	mNET_NEIGH_LOCKTIME
=12,

595 
	mNET_NEIGH_GC_INTERVAL
=13,

596 
	mNET_NEIGH_GC_THRESH1
=14,

597 
	mNET_NEIGH_GC_THRESH2
=15,

598 
	mNET_NEIGH_GC_THRESH3
=16,

599 
	mNET_NEIGH_RETRANS_TIME_MS
=17,

600 
	mNET_NEIGH_REACHABLE_TIME_MS
=18,

605 
	mNET_DCCP_DEFAULT
=1,

610 
	mNET_IPX_PPROP_BROADCASTING
=1,

611 
	mNET_IPX_FORWARDING
=2

616 
	mNET_LLC2
=1,

617 
	mNET_LLC_STATION
=2,

622 
	mNET_LLC2_TIMEOUT
=1,

627 
	mNET_LLC_STATION_ACK_TIMEOUT
=1,

632 
	mNET_LLC2_ACK_TIMEOUT
=1,

633 
	mNET_LLC2_P_TIMEOUT
=2,

634 
	mNET_LLC2_REJ_TIMEOUT
=3,

635 
	mNET_LLC2_BUSY_TIMEOUT
=4,

640 
	mNET_ATALK_AARP_EXPIRY_TIME
=1,

641 
	mNET_ATALK_AARP_TICK_TIME
=2,

642 
	mNET_ATALK_AARP_RETRANSMIT_LIMIT
=3,

643 
	mNET_ATALK_AARP_RESOLVE_TIME
=4

649 
	mNET_NETROM_DEFAULT_PATH_QUALITY
=1,

650 
	mNET_NETROM_OBSOLESCENCE_COUNT_INITIALISER
=2,

651 
	mNET_NETROM_NETWORK_TTL_INITIALISER
=3,

652 
	mNET_NETROM_TRANSPORT_TIMEOUT
=4,

653 
	mNET_NETROM_TRANSPORT_MAXIMUM_TRIES
=5,

654 
	mNET_NETROM_TRANSPORT_ACKNOWLEDGE_DELAY
=6,

655 
	mNET_NETROM_TRANSPORT_BUSY_DELAY
=7,

656 
	mNET_NETROM_TRANSPORT_REQUESTED_WINDOW_SIZE
=8,

657 
	mNET_NETROM_TRANSPORT_NO_ACTIVITY_TIMEOUT
=9,

658 
	mNET_NETROM_ROUTING_CONTROL
=10,

659 
	mNET_NETROM_LINK_FAILS_COUNT
=11,

660 
	mNET_NETROM_RESET
=12

665 
	mNET_AX25_IP_DEFAULT_MODE
=1,

666 
	mNET_AX25_DEFAULT_MODE
=2,

667 
	mNET_AX25_BACKOFF_TYPE
=3,

668 
	mNET_AX25_CONNECT_MODE
=4,

669 
	mNET_AX25_STANDARD_WINDOW
=5,

670 
	mNET_AX25_EXTENDED_WINDOW
=6,

671 
	mNET_AX25_T1_TIMEOUT
=7,

672 
	mNET_AX25_T2_TIMEOUT
=8,

673 
	mNET_AX25_T3_TIMEOUT
=9,

674 
	mNET_AX25_IDLE_TIMEOUT
=10,

675 
	mNET_AX25_N2
=11,

676 
	mNET_AX25_PACLEN
=12,

677 
	mNET_AX25_PROTOCOL
=13,

678 
	mNET_AX25_DAMA_SLAVE_TIMEOUT
=14

683 
	mNET_ROSE_RESTART_REQUEST_TIMEOUT
=1,

684 
	mNET_ROSE_CALL_REQUEST_TIMEOUT
=2,

685 
	mNET_ROSE_RESET_REQUEST_TIMEOUT
=3,

686 
	mNET_ROSE_CLEAR_REQUEST_TIMEOUT
=4,

687 
	mNET_ROSE_ACK_HOLD_BACK_TIMEOUT
=5,

688 
	mNET_ROSE_ROUTING_CONTROL
=6,

689 
	mNET_ROSE_LINK_FAIL_TIMEOUT
=7,

690 
	mNET_ROSE_MAX_VCS
=8,

691 
	mNET_ROSE_WINDOW_SIZE
=9,

692 
	mNET_ROSE_NO_ACTIVITY_TIMEOUT
=10

697 
	mNET_X25_RESTART_REQUEST_TIMEOUT
=1,

698 
	mNET_X25_CALL_REQUEST_TIMEOUT
=2,

699 
	mNET_X25_RESET_REQUEST_TIMEOUT
=3,

700 
	mNET_X25_CLEAR_REQUEST_TIMEOUT
=4,

701 
	mNET_X25_ACK_HOLD_BACK_TIMEOUT
=5,

702 
	mNET_X25_FORWARD
=6

708 
	mNET_TR_RIF_TIMEOUT
=1

713 
	mNET_DECNET_NODE_TYPE
 = 1,

714 
	mNET_DECNET_NODE_ADDRESS
 = 2,

715 
	mNET_DECNET_NODE_NAME
 = 3,

716 
	mNET_DECNET_DEFAULT_DEVICE
 = 4,

717 
	mNET_DECNET_TIME_WAIT
 = 5,

718 
	mNET_DECNET_DN_COUNT
 = 6,

719 
	mNET_DECNET_DI_COUNT
 = 7,

720 
	mNET_DECNET_DR_COUNT
 = 8,

721 
	mNET_DECNET_DST_GC_INTERVAL
 = 9,

722 
	mNET_DECNET_CONF
 = 10,

723 
	mNET_DECNET_NO_FC_MAX_CWND
 = 11,

724 
	mNET_DECNET_MEM
 = 12,

725 
	mNET_DECNET_RMEM
 = 13,

726 
	mNET_DECNET_WMEM
 = 14,

727 
	mNET_DECNET_DEBUG_LEVEL
 = 255

732 
	mNET_DECNET_CONF_LOOPBACK
 = -2,

733 
	mNET_DECNET_CONF_DDCMP
 = -3,

734 
	mNET_DECNET_CONF_PPP
 = -4,

735 
	mNET_DECNET_CONF_X25
 = -5,

736 
	mNET_DECNET_CONF_GRE
 = -6,

737 
	mNET_DECNET_CONF_ETHER
 = -7

744 
	mNET_DECNET_CONF_DEV_PRIORITY
 = 1,

745 
	mNET_DECNET_CONF_DEV_T1
 = 2,

746 
	mNET_DECNET_CONF_DEV_T2
 = 3,

747 
	mNET_DECNET_CONF_DEV_T3
 = 4,

748 
	mNET_DECNET_CONF_DEV_FORWARDING
 = 5,

749 
	mNET_DECNET_CONF_DEV_BLKSIZE
 = 6,

750 
	mNET_DECNET_CONF_DEV_STATE
 = 7

755 
	mNET_SCTP_RTO_INITIAL
 = 1,

756 
	mNET_SCTP_RTO_MIN
 = 2,

757 
	mNET_SCTP_RTO_MAX
 = 3,

758 
	mNET_SCTP_RTO_ALPHA
 = 4,

759 
	mNET_SCTP_RTO_BETA
 = 5,

760 
	mNET_SCTP_VALID_COOKIE_LIFE
 = 6,

761 
	mNET_SCTP_ASSOCIATION_MAX_RETRANS
 = 7,

762 
	mNET_SCTP_PATH_MAX_RETRANS
 = 8,

763 
	mNET_SCTP_MAX_INIT_RETRANSMITS
 = 9,

764 
	mNET_SCTP_HB_INTERVAL
 = 10,

765 
	mNET_SCTP_PRESERVE_ENABLE
 = 11,

766 
	mNET_SCTP_MAX_BURST
 = 12,

767 
	mNET_SCTP_ADDIP_ENABLE
 = 13,

768 
	mNET_SCTP_PRSCTP_ENABLE
 = 14,

769 
	mNET_SCTP_SNDBUF_POLICY
 = 15,

770 
	mNET_SCTP_SACK_TIMEOUT
 = 16,

771 
	mNET_SCTP_RCVBUF_POLICY
 = 17,

776 
	mNET_BRIDGE_NF_CALL_ARPTABLES
 = 1,

777 
	mNET_BRIDGE_NF_CALL_IPTABLES
 = 2,

778 
	mNET_BRIDGE_NF_CALL_IP6TABLES
 = 3,

779 
	mNET_BRIDGE_NF_FILTER_VLAN_TAGGED
 = 4,

780 
	mNET_BRIDGE_NF_FILTER_PPPOE_TAGGED
 = 5,

785 
	mNET_IRDA_DISCOVERY
=1,

786 
	mNET_IRDA_DEVNAME
=2,

787 
	mNET_IRDA_DEBUG
=3,

788 
	mNET_IRDA_FAST_POLL
=4,

789 
	mNET_IRDA_DISCOVERY_SLOTS
=5,

790 
	mNET_IRDA_DISCOVERY_TIMEOUT
=6,

791 
	mNET_IRDA_SLOT_TIMEOUT
=7,

792 
	mNET_IRDA_MAX_BAUD_RATE
=8,

793 
	mNET_IRDA_MIN_TX_TURN_TIME
=9,

794 
	mNET_IRDA_MAX_TX_DATA_SIZE
=10,

795 
	mNET_IRDA_MAX_TX_WINDOW
=11,

796 
	mNET_IRDA_MAX_NOREPLY_TIME
=12,

797 
	mNET_IRDA_WARN_NOREPLY_TIME
=13,

798 
	mNET_IRDA_LAP_KEEPALIVE_TIME
=14,

805 
	mFS_NRINODE
=1,

806 
	mFS_STATINODE
=2,

807 
	mFS_MAXINODE
=3,

808 
	mFS_NRDQUOT
=4,

809 
	mFS_MAXDQUOT
=5,

810 
	mFS_NRFILE
=6,

811 
	mFS_MAXFILE
=7,

812 
	mFS_DENTRY
=8,

813 
	mFS_NRSUPER
=9,

814 
	mFS_MAXSUPER
=10,

815 
	mFS_OVERFLOWUID
=11,

816 
	mFS_OVERFLOWGID
=12,

817 
	mFS_LEASES
=13,

818 
	mFS_DIR_NOTIFY
=14,

819 
	mFS_LEASE_TIME
=15,

820 
	mFS_DQSTATS
=16,

821 
	mFS_XFS
=17,

822 
	mFS_AIO_NR
=18,

823 
	mFS_AIO_MAX_NR
=19,

824 
	mFS_INOTIFY
=20,

825 
	mFS_OCFS2
=988,

830 
	mFS_DQ_LOOKUPS
 = 1,

831 
	mFS_DQ_DROPS
 = 2,

832 
	mFS_DQ_READS
 = 3,

833 
	mFS_DQ_WRITES
 = 4,

834 
	mFS_DQ_CACHE_HITS
 = 5,

835 
	mFS_DQ_ALLOCATED
 = 6,

836 
	mFS_DQ_FREE
 = 7,

837 
	mFS_DQ_SYNCS
 = 8,

838 
	mFS_DQ_WARNINGS
 = 9,

845 
	mDEV_CDROM
=1,

846 
	mDEV_HWMON
=2,

847 
	mDEV_PARPORT
=3,

848 
	mDEV_RAID
=4,

849 
	mDEV_MAC_HID
=5,

850 
	mDEV_SCSI
=6,

851 
	mDEV_IPMI
=7,

856 
	mDEV_CDROM_INFO
=1,

857 
	mDEV_CDROM_AUTOCLOSE
=2,

858 
	mDEV_CDROM_AUTOEJECT
=3,

859 
	mDEV_CDROM_DEBUG
=4,

860 
	mDEV_CDROM_LOCK
=5,

861 
	mDEV_CDROM_CHECK_MEDIA
=6

866 
	mDEV_PARPORT_DEFAULT
=-3

871 
	mDEV_RAID_SPEED_LIMIT_MIN
=1,

872 
	mDEV_RAID_SPEED_LIMIT_MAX
=2

877 
	mDEV_PARPORT_DEFAULT_TIMESLICE
=1,

878 
	mDEV_PARPORT_DEFAULT_SPINTIME
=2

883 
	mDEV_PARPORT_SPINTIME
=1,

884 
	mDEV_PARPORT_BASE_ADDR
=2,

885 
	mDEV_PARPORT_IRQ
=3,

886 
	mDEV_PARPORT_DMA
=4,

887 
	mDEV_PARPORT_MODES
=5,

888 
	mDEV_PARPORT_DEVICES
=6,

889 
	mDEV_PARPORT_AUTOPROBE
=16

894 
	mDEV_PARPORT_DEVICES_ACTIVE
=-3,

899 
	mDEV_PARPORT_DEVICE_TIMESLICE
=1,

904 
	mDEV_MAC_HID_KEYBOARD_SENDS_LINUX_KEYCODES
=1,

905 
	mDEV_MAC_HID_KEYBOARD_LOCK_KEYCODES
=2,

906 
	mDEV_MAC_HID_MOUSE_BUTTON_EMULATION
=3,

907 
	mDEV_MAC_HID_MOUSE_BUTTON2_KEYCODE
=4,

908 
	mDEV_MAC_HID_MOUSE_BUTTON3_KEYCODE
=5,

909 
	mDEV_MAC_HID_ADB_MOUSE_SENDS_KEYCODES
=6

914 
	mDEV_SCSI_LOGGING_LEVEL
=1,

919 
	mDEV_IPMI_POWEROFF_POWERCYCLE
=1,

925 
	mABI_DEFHANDLER_COFF
=1,

926 
	mABI_DEFHANDLER_ELF
=2,

927 
	mABI_DEFHANDLER_LCALL7
=3,

928 
	mABI_DEFHANDLER_LIBCSO
=4,

929 
	mABI_TRACE
=5,

930 
	mABI_FAKE_UTSNAME
=6,

	@/usr/include/rpc/netdb.h

36 #iâdeà
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<ã©u»s.h
>

41 
	#__Ãed_size_t


	)

42 
	~<¡ddef.h
>

44 
__BEGIN_DECLS


46 
	s½ûÁ


48 *
	mr_Çme
;

49 **
	mr_®Ÿ£s
;

50 
	mr_numb”
;

53 
	$£ŒpûÁ
 (
__¡ayİ’
è
__THROW
;

54 
	$’d½ûÁ
 (è
__THROW
;

55 
½ûÁ
 *
	$g‘½cbyÇme
 (cÚ¡ *
__Çme
è
__THROW
;

56 
½ûÁ
 *
	$g‘½cbynumb”
 (
__numb”
è
__THROW
;

57 
½ûÁ
 *
	$g‘½ûÁ
 (è
__THROW
;

59 #ifdeà
__USE_MISC


60 
	$g‘½cbyÇme_r
 (cÚ¡ *
__Çme
, 
½ûÁ
 *
__»suÉ_buf
,

61 *
__bufãr
, 
size_t
 
__buæ’
,

62 
½ûÁ
 **
__»suÉ
è
__THROW
;

64 
	$g‘½cbynumb”_r
 (
__numb”
, 
½ûÁ
 *
__»suÉ_buf
,

65 *
__bufãr
, 
size_t
 
__buæ’
,

66 
½ûÁ
 **
__»suÉ
è
__THROW
;

68 
	$g‘½ûÁ_r
 (
½ûÁ
 *
__»suÉ_buf
, *
__bufãr
,

69 
size_t
 
__buæ’
, 
½ûÁ
 **
__»suÉ
è
__THROW
;

72 
__END_DECLS


	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

61 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/sys/cdefs.h

18 #iâdef 
_SYS_CDEFS_H


19 
	#_SYS_CDEFS_H
 1

	)

22 #iâdeà
_FEATURES_H


23 
	~<ã©u»s.h
>

29 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


34 #undeà
__P


35 #undeà
__PMT


37 #ifdeà
__GNUC__


41 #ià
__GNUC_PREREQ
 (4, 6è&& !
defšed
 
_LIBC


42 
	#__LEAF
 , 
__Ëaf__


	)

43 
	#__LEAF_ATTR
 
	`__©Œibu‹__
 ((
__Ëaf__
))

	)

45 
	#__LEAF


	)

46 
	#__LEAF_ATTR


	)

54 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

55 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
))

	)

56 
	#__THROWNL
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

57 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
)è
	)
fct

58 
	#__NTHNL
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

60 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

61 
	#__THROW
 
	`throw
 ()

	)

62 
	#__THROWNL
 
	`throw
 ()

	)

63 
	#__NTH
(
fù
è
__LEAF_ATTR
 fù 
	`throw
 ()

	)

64 
	#__NTHNL
(
fù
èfù 
	`throw
 ()

	)

66 
	#__THROW


	)

67 
	#__THROWNL


	)

68 
	#__NTH
(
fù
è
	)
fct

69 
	#__NTHNL
(
fù
è
	)
fct

75 
	#__šlše


	)

77 
	#__THROW


	)

78 
	#__THROWNL


	)

79 
	#__NTH
(
fù
è
	)
fct

86 #ià
defšed
 
__şªg__
 && defšed 
__has_ex‹nsiÚ


87 
	#__glibc_şªg_has_ex‹nsiÚ
(
ext
è
	`__has_ex‹nsiÚ
 (ext)

	)

89 
	#__glibc_şªg_has_ex‹nsiÚ
(
ext
è0

	)

94 
	#__P
(
¬gs
è
	)
args

95 
	#__PMT
(
¬gs
è
	)
args

100 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

101 
	#__STRING
(
x
è#x

	)

104 
	#__±r_t
 *

	)

108 #ifdef 
__ılu¥lus


109 
	#__BEGIN_DECLS
 "C" {

	)

110 
	#__END_DECLS
 }

	)

112 
	#__BEGIN_DECLS


	)

113 
	#__END_DECLS


	)

118 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

119 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

121 #ià
__GNUC_PREREQ
 (4,3)

122 
	#__w¬ndeş
(
Çme
, 
msg
) \

123 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

124 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

125 
	#__”rÜdeş
(
Çme
, 
msg
) \

126 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

128 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

129 
	#__w¬Ç‰r
(
msg
)

	)

130 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

137 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

138 
	#__æex¬r
 []

	)

139 
	#__glibc_c99_æex¬r_avaabË
 1

	)

140 #–ià
__GNUC_PREREQ
 (2,97)

143 
	#__æex¬r
 []

	)

144 
	#__glibc_c99_æex¬r_avaabË
 1

	)

145 #–ià
defšed
 
__GNUC__


148 
	#__æex¬r
 [0]

	)

149 
	#__glibc_c99_æex¬r_avaabË
 1

	)

152 
	#__æex¬r
 [1]

	)

153 
	#__glibc_c99_æex¬r_avaabË
 0

	)

167 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

169 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

170 #ifdeà
__ılu¥lus


171 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

172 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

173 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

174 
Çme
 
´Ùo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

176 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

177 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

178 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

179 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROWNL


	)

181 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

182 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

195 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

196 
	#__©Œibu‹__
(
xyz
è

	)

202 #ià
__GNUC_PREREQ
 (2,96)

203 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

205 
	#__©Œibu‹_m®loc__


	)

210 #ià
__GNUC_PREREQ
 (4, 3)

211 
	#__©Œibu‹_®loc_size__
(
·¿ms
) \

212 
	`__©Œibu‹__
 ((
__®loc_size__
 
·¿ms
))

	)

214 
	#__©Œibu‹_®loc_size__
(
·¿ms
è

	)

220 #ià
__GNUC_PREREQ
 (2,96)

221 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

223 
	#__©Œibu‹_pu»__


	)

227 #ià
__GNUC_PREREQ
 (2,5)

228 
	#__©Œibu‹_cÚ¡__
 
	`__©Œibu‹__
 ((
__cÚ¡__
))

	)

230 
	#__©Œibu‹_cÚ¡__


	)

236 #ià
__GNUC_PREREQ
 (3,1)

237 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

238 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

240 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

241 
	#__©Œibu‹_nošlše__


	)

245 #ià
__GNUC_PREREQ
 (3,2)

246 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

248 
	#__©Œibu‹_d•»ÿ‹d__


	)

254 #ià
__GNUC_PREREQ
 (4,5) || \

255 
	$__glibc_şªg_has_ex‹nsiÚ
 (
__©Œibu‹_d•»ÿ‹d_w™h_mes§ge__
)

256 
	#__©Œibu‹_d•»ÿ‹d_msg__
(
msg
) \

257 
	`__©Œibu‹__
 ((
	`__d•»ÿ‹d__
 (
msg
)))

	)

259 
	#__©Œibu‹_d•»ÿ‹d_msg__
(
msg
è
__©Œibu‹_d•»ÿ‹d__


	)

268 #ià
	`__GNUC_PREREQ
 (2,8)

269 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

271 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

278 #ià
	`__GNUC_PREREQ
 (2,97)

279 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

280 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

282 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

287 #ià
	`__GNUC_PREREQ
 (3,3)

288 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

290 
	#__nÚnuÎ
(
·¿ms
)

	)

295 #ià
	`__GNUC_PREREQ
 (3,4)

296 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

297 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

298 #ià
__USE_FORTIFY_LEVEL
 > 0

299 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

302 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

304 #iâdeà
__wur


305 
	#__wur


	)

309 #ià
	`__GNUC_PREREQ
 (3,2)

313 #undeà
__®ways_šlše


314 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

316 #undeà
__®ways_šlše


317 
	#__®ways_šlše
 
__šlše


	)

322 #ià
	`__GNUC_PREREQ
 (4,3)

323 
	#__©Œibu‹_¬tificŸl__
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

325 
	#__©Œibu‹_¬tificŸl__


	)

337 #ià(!
defšed
 
__ılu¥lus
 || 
	`__GNUC_PREREQ
 (4,3) \

338 || (
defšed
 
__şªg__
 && (defšed 
__GNUC_STDC_INLINE__
 \

339 || 
defšed
 
__GNUC_GNU_INLINE__
)))

340 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


341 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

342 
	#__ex‹º_®ways_šlše
 \

343 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

345 
	#__ex‹º_šlše
 
__šlše


	)

346 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

350 #ifdeà
__ex‹º_®ways_šlše


351 
	#__fÜtify_funùiÚ
 
__ex‹º_®ways_šlše
 
__©Œibu‹_¬tificŸl__


	)

356 #ià
	`__GNUC_PREREQ
 (4,3)

357 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

358 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

365 #ià!
	`__GNUC_PREREQ
 (2,8)

366 
	#__ex‹nsiÚ__


	)

370 #ià!
	`__GNUC_PREREQ
 (2,92)

371 
	#__»¡riù


	)

377 #ià
	`__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


378 
	#__»¡riù_¬r
 
__»¡riù


	)

380 #ifdeà
__GNUC__


381 
	#__»¡riù_¬r


	)

383 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

384 
	#__»¡riù_¬r
 
»¡riù


	)

387 
	#__»¡riù_¬r


	)

392 #ià
__GNUC__
 >= 3

393 
	#__glibc_uÆik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 0)

	)

394 
	#__glibc_lik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 1)

	)

396 
	#__glibc_uÆik–y
(
cÚd
è(cÚd)

	)

397 
	#__glibc_lik–y
(
cÚd
è(cÚd)

	)

400 #ià(!
defšed
 
_NÜ‘uº
 \

401 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

402 && !
	$__GNUC_PREREQ
 (4,7))

403 #ià
	`__GNUC_PREREQ
 (2,8)

404 
	#_NÜ‘uº
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

	)

406 
	#_NÜ‘uº


	)

410 #ià
	`__GNUC_PREREQ
 (8, 0)

414 
	#__©Œibu‹_nÚ¡ršg__
 
	`__©Œibu‹__
 ((
__nÚ¡ršg__
))

	)

416 
	#__©Œibu‹_nÚ¡ršg__


	)

419 #ià(!
defšed
 
_Stic_as£¹
 && !defšed 
__ılu¥lus
 \

420 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

421 && (!
	`__GNUC_PREREQ
 (4, 6è|| 
defšed
 
__STRICT_ANSI__
))

422 
	#_Stic_as£¹
(
ex´
, 
dŸgno¡ic
) \

423 (*
	`__Stic_as£¹_funùiÚ
 ()) \

424 [!! (¡ruù { 
__”rÜ_if_Ãg©ive
: (
ex´
è? 2 : -1; })]

	)

427 
	~<b™s/wÜdsize.h
>

428 
	~<b™s/lÚg-doubË.h
>

430 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


431 
	#__LDBL_COMPAT
 1

	)

432 #ifdeà
__REDIRECT


433 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

434 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

435 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

436 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

437 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

438 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

439 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

440 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

441 
	#__LDBL_REDIR_DECL
(
Çme
) \

442 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

443 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

444 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

445 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

446 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

449 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


450 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

451 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

452 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

453 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

454 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

455 #ifdeà
__REDIRECT


456 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

457 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

458 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

467 #ià
	`__GNUC_PREREQ
 (4,8è|| 
	`__glibc_şªg_´”eq
 (3,5)

468 
	#__glibc_maüo_w¬nšg1
(
mes§ge
è
	`_P¿gma
 (#mes§ge)

	)

469 
	#__glibc_maüo_w¬nšg
(
mes§ge
) \

470 
	`__glibc_maüo_w¬nšg1
 (
GCC
 
w¬nšg
 
mes§ge
)

	)

472 
	#__glibc_maüo_w¬nšg
(
msg
)

	)

482 #ià!
defšed
 
__ılu¥lus
 \

483 && (
	`__GNUC_PREREQ
 (4, 9) \

484 || 
	`__glibc_şªg_has_ex‹nsiÚ
 (
c_g’”ic_£ËùiÚs
) \

485 || (!
defšed
 
__GNUC__
 && defšed 
__STDC_VERSION__
 \

486 && 
__STDC_VERSION__
 >= 201112L))

487 
	#__HAVE_GENERIC_SELECTION
 1

	)

489 
	#__HAVE_GENERIC_SELECTION
 0

	)

	@/usr/include/sys/poll.h

19 #iâdef 
_SYS_POLL_H


20 
	#_SYS_POLL_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/pŞl.h
>

26 #ifdeà
__USE_GNU


27 
	~<b™s/ty³s/__sig£t_t.h
>

28 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

33 
	tnfds_t
;

36 
	spŞlfd


38 
	mfd
;

39 
	mev’ts
;

40 
	m»v’ts
;

44 
__BEGIN_DECLS


54 
pŞl
 (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
, 
__timeout
);

56 #ifdeà
__USE_GNU


63 
µŞl
 (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
,

64 cÚ¡ 
time¥ec
 *
__timeout
,

65 cÚ¡ 
__sig£t_t
 *
__ss
);

68 
	g__END_DECLS


72 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


73 
	~<b™s/pŞl2.h
>

	@/usr/include/sys/syslog.h

32 #iâdeà
_SYS_SYSLOG_H


33 
	#_SYS_SYSLOG_H
 1

	)

35 
	~<ã©u»s.h
>

36 
	#__Ãed___va_li¡


	)

37 
	~<¡d¬g.h
>

40 
	~<b™s/sy¦og-·th.h
>

51 
	#LOG_EMERG
 0

	)

52 
	#LOG_ALERT
 1

	)

53 
	#LOG_CRIT
 2

	)

54 
	#LOG_ERR
 3

	)

55 
	#LOG_WARNING
 4

	)

56 
	#LOG_NOTICE
 5

	)

57 
	#LOG_INFO
 6

	)

58 
	#LOG_DEBUG
 7

	)

60 
	#LOG_PRIMASK
 0x07

	)

62 
	#LOG_PRI
(
p
è(Õè& 
LOG_PRIMASK
)

	)

63 
	#LOG_MAKEPRI
(
çc
, 
´i
è((çcè| (´i))

	)

65 #ifdeà
SYSLOG_NAMES


66 
	#INTERNAL_NOPRI
 0x10

	)

68 
	#INTERNAL_MARK
 
	`LOG_MAKEPRI
(
LOG_NFACILITIES
 << 3, 0)

	)

69 
	s_code
 {

70 *
	mc_Çme
;

71 
	mc_v®
;

72 } 
	tCODE
;

74 
CODE
 
	g´iÜ™yÇmes
[] =

76 { "®”t", 
LOG_ALERT
 },

77 { "ü™", 
LOG_CRIT
 },

78 { "debug", 
LOG_DEBUG
 },

79 { "em”g", 
LOG_EMERG
 },

80 { "”r", 
LOG_ERR
 },

81 { "”rÜ", 
LOG_ERR
 },

82 { "šfo", 
LOG_INFO
 },

83 { "nÚe", 
INTERNAL_NOPRI
 },

84 { "nÙiû", 
LOG_NOTICE
 },

85 { "·nic", 
LOG_EMERG
 },

86 { "w¬n", 
LOG_WARNING
 },

87 { "w¬nšg", 
LOG_WARNING
 },

88 { 
NULL
, -1 }

93 
	#LOG_KERN
 (0<<3è

	)

94 
	#LOG_USER
 (1<<3è

	)

95 
	#LOG_MAIL
 (2<<3è

	)

96 
	#LOG_DAEMON
 (3<<3è

	)

97 
	#LOG_AUTH
 (4<<3è

	)

98 
	#LOG_SYSLOG
 (5<<3è

	)

99 
	#LOG_LPR
 (6<<3è

	)

100 
	#LOG_NEWS
 (7<<3è

	)

101 
	#LOG_UUCP
 (8<<3è

	)

102 
	#LOG_CRON
 (9<<3è

	)

103 
	#LOG_AUTHPRIV
 (10<<3è

	)

104 
	#LOG_FTP
 (11<<3è

	)

107 
	#LOG_LOCAL0
 (16<<3è

	)

108 
	#LOG_LOCAL1
 (17<<3è

	)

109 
	#LOG_LOCAL2
 (18<<3è

	)

110 
	#LOG_LOCAL3
 (19<<3è

	)

111 
	#LOG_LOCAL4
 (20<<3è

	)

112 
	#LOG_LOCAL5
 (21<<3è

	)

113 
	#LOG_LOCAL6
 (22<<3è

	)

114 
	#LOG_LOCAL7
 (23<<3è

	)

116 
	#LOG_NFACILITIES
 24

	)

117 
	#LOG_FACMASK
 0x03f8

	)

119 
	#LOG_FAC
(
p
è((Õè& 
LOG_FACMASK
è>> 3)

	)

121 #ifdeà
SYSLOG_NAMES


122 
CODE
 
	gçc™yÇmes
[] =

124 { "auth", 
LOG_AUTH
 },

125 { "auth´iv", 
LOG_AUTHPRIV
 },

126 { "üÚ", 
LOG_CRON
 },

127 { "d«mÚ", 
LOG_DAEMON
 },

128 { "áp", 
LOG_FTP
 },

129 { "k”n", 
LOG_KERN
 },

130 { "Ír", 
LOG_LPR
 },

131 { "ma", 
LOG_MAIL
 },

132 { "m¬k", 
INTERNAL_MARK
 },

133 { "Ãws", 
LOG_NEWS
 },

134 { "£cur™y", 
LOG_AUTH
 },

135 { "sy¦og", 
LOG_SYSLOG
 },

136 { "u£r", 
LOG_USER
 },

137 { "uuı", 
LOG_UUCP
 },

138 { "loÿl0", 
LOG_LOCAL0
 },

139 { "loÿl1", 
LOG_LOCAL1
 },

140 { "loÿl2", 
LOG_LOCAL2
 },

141 { "loÿl3", 
LOG_LOCAL3
 },

142 { "loÿl4", 
LOG_LOCAL4
 },

143 { "loÿl5", 
LOG_LOCAL5
 },

144 { "loÿl6", 
LOG_LOCAL6
 },

145 { "loÿl7", 
LOG_LOCAL7
 },

146 { 
NULL
, -1 }

153 
	#LOG_MASK
(
´i
è(1 << (´i)è

	)

154 
	#LOG_UPTO
(
´i
è((1 << (Õri)+1)è- 1è

	)

162 
	#LOG_PID
 0x01

	)

163 
	#LOG_CONS
 0x02

	)

164 
	#LOG_ODELAY
 0x04

	)

165 
	#LOG_NDELAY
 0x08

	)

166 
	#LOG_NOWAIT
 0x10

	)

167 
	#LOG_PERROR
 0x20

	)

169 
__BEGIN_DECLS


175 
şo£log
 ();

181 
İ’log
 (cÚ¡ *
__id’t
, 
__İtiÚ
, 
__çc™y
);

184 
	$£ogmask
 (
__mask
è
__THROW
;

190 
	$sy¦og
 (
__´i
, cÚ¡ *
__fmt
, ...)

191 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

193 #ifdeà
__USE_MISC


200 
	$vsy¦og
 (
__´i
, cÚ¡ *
__fmt
, 
__gnuc_va_li¡
 
__­
)

201 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

206 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


207 
	~<b™s/sy¦og.h
>

209 #ifdeà
__LDBL_COMPAT


210 
	~<b™s/sy¦og-ldbl.h
>

213 
__END_DECLS


	@/usr/include/sys/sysmacros.h

19 #iâdeà
_SYS_SYSMACROS_H_OUTER


21 #iâdeà
__SYSMACROS_DEPRECATED_INCLUSION


22 
	#_SYS_SYSMACROS_H_OUTER
 1

	)

30 #undeà
majÜ


31 #undeà
mšÜ


32 #undeà
makedev


36 #iâdeà
_SYS_SYSMACROS_H


37 
	#_SYS_SYSMACROS_H
 1

	)

39 
	~<ã©u»s.h
>

40 
	~<b™s/ty³s.h
>

41 
	~<b™s/sysmaüos.h
>

52 
	#__SYSMACROS_DM
(
symbŞ
è
__SYSMACROS_DM1
 \

53 (
In
 
the
 
GNU
 
C
 
Lib¿ry
, #symbŞ 
is
 
defšed
\
n
\

54 
by
 <
sys
/
sysmaüos
.
h
>. 
FÜ
 
hi¡Üiÿl
 
com·tib™y
, 
™
 
is
\
n
\

55 
cu¼’y
 
defšed
 
by
 <
sys
/
ty³s
.
h
> 
as
 
w–l
, 
but
 
we
 
¶ª
 
to
\
n
\

56 
»move
 
this
 
soÚ
. 
To
 
u£
 #symbŞ, 
šşude
 <
sys
/
sysmaüos
.
h
>\
n
\

57 
dœeùly
. 
If
 
you
 
did
 
nÙ
 
š‹nd
 
to
 
u£
 
a
 
sy¡em
-
defšed
 
maüo
\
n
\

58 #symbŞ, 
you
 
should
 
undefše
 
™
 
aá”
 
šşudšg
 <
sys
/
ty³s
.
h
>.)

	)

62 
	#__SYSMACROS_DM1
(...è
	`__glibc_maüo_w¬nšg
 (#__VA_ARGS__)

	)

64 
	#__SYSMACROS_DECL_TEMPL
(
¹y³
, 
Çme
, 
´Ùo
) \

65 
¹y³
 
gnu_dev_
##
Çme
 
´Ùo
 
__THROW
 
__©Œibu‹_cÚ¡__
;

	)

67 
	#__SYSMACROS_IMPL_TEMPL
(
¹y³
, 
Çme
, 
´Ùo
) \

68 
__ex‹nsiÚ__
 
__ex‹º_šlše
 
__©Œibu‹_cÚ¡__
 
¹y³
 \

69 
	`__NTH
 (
gnu_dev_
##
Çme
 
´Ùo
)

	)

71 
__BEGIN_DECLS


73 
	$__SYSMACROS_DECLARE_MAJOR
 (
__SYSMACROS_DECL_TEMPL
)

74 
	$__SYSMACROS_DECLARE_MINOR
 (
__SYSMACROS_DECL_TEMPL
)

75 
	$__SYSMACROS_DECLARE_MAKEDEV
 (
__SYSMACROS_DECL_TEMPL
)

77 #ifdeà
__USE_EXTERN_INLINES


79 
	$__SYSMACROS_DEFINE_MAJOR
 (
__SYSMACROS_IMPL_TEMPL
)

80 
	$__SYSMACROS_DEFINE_MINOR
 (
__SYSMACROS_IMPL_TEMPL
)

81 
	$__SYSMACROS_DEFINE_MAKEDEV
 (
__SYSMACROS_IMPL_TEMPL
)

85 
__END_DECLS


89 #iâdeà
__SYSMACROS_NEED_IMPLEMENTATION


90 #undeà
__SYSMACROS_DECL_TEMPL


91 #undeà
__SYSMACROS_IMPL_TEMPL


92 #undeà
__SYSMACROS_DECLARE_MAJOR


93 #undeà
__SYSMACROS_DECLARE_MINOR


94 #undeà
__SYSMACROS_DECLARE_MAKEDEV


95 #undeà
__SYSMACROS_DEFINE_MAJOR


96 #undeà
__SYSMACROS_DEFINE_MINOR


97 #undeà
__SYSMACROS_DEFINE_MAKEDEV


100 #ifdeà
__SYSMACROS_DEPRECATED_INCLUSION


101 
	#majÜ
(
dev
è
	`__SYSMACROS_DM
 (
majÜ
è
	`gnu_dev_majÜ
 (dev)

	)

102 
	#mšÜ
(
dev
è
	`__SYSMACROS_DM
 (
mšÜ
è
	`gnu_dev_mšÜ
 (dev)

	)

103 
	#makedev
(
maj
, 
mš
è
	`__SYSMACROS_DM
 (
makedev
è
	`gnu_dev_makedev
 (maj, mš)

	)

105 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

106 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

107 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/sys/ttydefaults.h

40 #iâdeà
_SYS_TTYDEFAULTS_H_


41 
	#_SYS_TTYDEFAULTS_H_


	)

46 
	#TTYDEF_IFLAG
 (
BRKINT
 | 
ISTRIP
 | 
ICRNL
 | 
IMAXBEL
 | 
IXON
 | 
IXANY
)

	)

47 
	#TTYDEF_OFLAG
 (
OPOST
 | 
ONLCR
 | 
XTABS
)

	)

48 
	#TTYDEF_LFLAG
 (
ECHO
 | 
ICANON
 | 
ISIG
 | 
IEXTEN
 | 
ECHOE
|
ECHOKE
|
ECHOCTL
)

	)

49 
	#TTYDEF_CFLAG
 (
CREAD
 | 
CS7
 | 
PARENB
 | 
HUPCL
)

	)

50 
	#TTYDEF_SPEED
 (
B9600
)

	)

55 
	#CTRL
(
x
è(x&037)

	)

56 
	#CEOF
 
	`CTRL
('d')

	)

57 #ifdeà
_POSIX_VDISABLE


58 
	#CEOL
 
_POSIX_VDISABLE


	)

60 
	#CEOL
 '\0'

	)

62 
	#CERASE
 0177

	)

63 
	#CINTR
 
	`CTRL
('c')

	)

64 #ifdeà
_POSIX_VDISABLE


65 
	#CSTATUS
 
_POSIX_VDISABLE


	)

67 
	#CSTATUS
 '\0'

	)

69 
	#CKILL
 
	`CTRL
('u')

	)

70 
	#CMIN
 1

	)

71 
	#CQUIT
 034

	)

72 
	#CSUSP
 
	`CTRL
('z')

	)

73 
	#CTIME
 0

	)

74 
	#CDSUSP
 
	`CTRL
('y')

	)

75 
	#CSTART
 
	`CTRL
('q')

	)

76 
	#CSTOP
 
	`CTRL
('s')

	)

77 
	#CLNEXT
 
	`CTRL
('v')

	)

78 
	#CDISCARD
 
	`CTRL
('o')

	)

79 
	#CWERASE
 
	`CTRL
('w')

	)

80 
	#CREPRINT
 
	`CTRL
('r')

	)

81 
	#CEOT
 
CEOF


	)

83 
	#CBRK
 
CEOL


	)

84 
	#CRPRNT
 
CREPRINT


	)

85 
	#CFLUSH
 
CDISCARD


	)

93 #ifdeà
TTYDEFCHARS


94 
cc_t
 
	g‰ydefch¬s
[
NCCS
] = {

95 
CEOF
, 
CEOL
, CEOL, 
CERASE
, 
CWERASE
, 
CKILL
, 
CREPRINT
,

96 
_POSIX_VDISABLE
, 
CINTR
, 
CQUIT
, 
CSUSP
, 
CDSUSP
, 
CSTART
, 
CSTOP
, 
CLNEXT
,

97 
CDISCARD
, 
CMIN
, 
CTIME
, 
CSTATUS
, 
_POSIX_VDISABLE


99 #undeà
TTYDEFCHARS


	@/usr/include/sys/ucontext.h

18 #iâdeà
_SYS_UCONTEXT_H


19 
	#_SYS_UCONTEXT_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	~<b™s/ty³s.h
>

24 
	~<b™s/ty³s/sig£t_t.h
>

25 
	~<b™s/ty³s/¡ack_t.h
>

28 #ifdeà
__USE_MISC


29 
	#__ùx
(
æd
è
	)
fld

31 
	#__ùx
(
æd
è
__
 ## 
	)
fld

34 #ifdeà
__x86_64__


37 
__ex‹nsiÚ__
 
	tg»g_t
;

40 
	#__NGREG
 23

	)

41 #ifdeà
__USE_MISC


42 
	#NGREG
 
__NGREG


	)

46 
g»g_t
 
	tg»g£t_t
[
__NGREG
];

48 #ifdeà
__USE_GNU


52 
	mREG_R8
 = 0,

53 
	#REG_R8
 
REG_R8


	)

54 
	mREG_R9
,

55 
	#REG_R9
 
REG_R9


	)

56 
	mREG_R10
,

57 
	#REG_R10
 
REG_R10


	)

58 
	mREG_R11
,

59 
	#REG_R11
 
REG_R11


	)

60 
	mREG_R12
,

61 
	#REG_R12
 
REG_R12


	)

62 
	mREG_R13
,

63 
	#REG_R13
 
REG_R13


	)

64 
	mREG_R14
,

65 
	#REG_R14
 
REG_R14


	)

66 
	mREG_R15
,

67 
	#REG_R15
 
REG_R15


	)

68 
	mREG_RDI
,

69 
	#REG_RDI
 
REG_RDI


	)

70 
	mREG_RSI
,

71 
	#REG_RSI
 
REG_RSI


	)

72 
	mREG_RBP
,

73 
	#REG_RBP
 
REG_RBP


	)

74 
	mREG_RBX
,

75 
	#REG_RBX
 
REG_RBX


	)

76 
	mREG_RDX
,

77 
	#REG_RDX
 
REG_RDX


	)

78 
	mREG_RAX
,

79 
	#REG_RAX
 
REG_RAX


	)

80 
	mREG_RCX
,

81 
	#REG_RCX
 
REG_RCX


	)

82 
	mREG_RSP
,

83 
	#REG_RSP
 
REG_RSP


	)

84 
	mREG_RIP
,

85 
	#REG_RIP
 
REG_RIP


	)

86 
	mREG_EFL
,

87 
	#REG_EFL
 
REG_EFL


	)

88 
	mREG_CSGSFS
,

89 
	#REG_CSGSFS
 
REG_CSGSFS


	)

90 
	mREG_ERR
,

91 
	#REG_ERR
 
REG_ERR


	)

92 
	mREG_TRAPNO
,

93 
	#REG_TRAPNO
 
REG_TRAPNO


	)

94 
	mREG_OLDMASK
,

95 
	#REG_OLDMASK
 
REG_OLDMASK


	)

96 
	mREG_CR2


97 
	#REG_CR2
 
REG_CR2


	)

101 
	s_libc_åx»g


103 
__ùx
(
signifiÿnd
)[4];

104 
__ùx
(
expÚ’t
);

105 
	m__glibc_»£rved1
[3];

108 
	s_libc_xmm»g


110 
__ušt32_t
 
__ùx
(
–em’t
)[4];

113 
	s_libc_å¡©e


116 
__ušt16_t
 
__ùx
(
cwd
);

117 
__ušt16_t
 
__ùx
(
swd
);

118 
__ušt16_t
 
__ùx
(
áw
);

119 
__ušt16_t
 
__ùx
(
fİ
);

120 
__ušt64_t
 
__ùx
(
r
);

121 
__ušt64_t
 
__ùx
(
rdp
);

122 
__ušt32_t
 
__ùx
(
mxc¤
);

123 
__ušt32_t
 
__ùx
(
mxü_mask
);

124 
_libc_åx»g
 
	m_¡
[8];

125 
_libc_xmm»g
 
	m_xmm
[16];

126 
__ušt32_t
 
	m__glibc_»£rved1
[24];

130 
_libc_å¡©e
 *
	tå»g£t_t
;

135 
g»g£t_t
 
__ùx
(
g»gs
);

137 
å»g£t_t
 
__ùx
(
å»gs
);

138 
__ex‹nsiÚ__
 
	m__»£rved1
 [8];

139 } 
	tmcÚ‹xt_t
;

142 
	sucÚ‹xt_t


144 
__ùx
(
uc_æags
);

145 
ucÚ‹xt_t
 *
	muc_lšk
;

146 
¡ack_t
 
	muc_¡ack
;

147 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

148 
sig£t_t
 
	muc_sigmask
;

149 
_libc_å¡©e
 
	m__å»gs_mem
;

150 } 
	tucÚ‹xt_t
;

155 
	tg»g_t
;

158 
	#__NGREG
 19

	)

159 #ifdeà
__USE_MISC


160 
	#NGREG
 
__NGREG


	)

164 
g»g_t
 
	tg»g£t_t
[
__NGREG
];

166 #ifdeà
__USE_GNU


170 
	mREG_GS
 = 0,

171 
	#REG_GS
 
REG_GS


	)

172 
	mREG_FS
,

173 
	#REG_FS
 
REG_FS


	)

174 
	mREG_ES
,

175 
	#REG_ES
 
REG_ES


	)

176 
	mREG_DS
,

177 
	#REG_DS
 
REG_DS


	)

178 
	mREG_EDI
,

179 
	#REG_EDI
 
REG_EDI


	)

180 
	mREG_ESI
,

181 
	#REG_ESI
 
REG_ESI


	)

182 
	mREG_EBP
,

183 
	#REG_EBP
 
REG_EBP


	)

184 
	mREG_ESP
,

185 
	#REG_ESP
 
REG_ESP


	)

186 
	mREG_EBX
,

187 
	#REG_EBX
 
REG_EBX


	)

188 
	mREG_EDX
,

189 
	#REG_EDX
 
REG_EDX


	)

190 
	mREG_ECX
,

191 
	#REG_ECX
 
REG_ECX


	)

192 
	mREG_EAX
,

193 
	#REG_EAX
 
REG_EAX


	)

194 
	mREG_TRAPNO
,

195 
	#REG_TRAPNO
 
REG_TRAPNO


	)

196 
	mREG_ERR
,

197 
	#REG_ERR
 
REG_ERR


	)

198 
	mREG_EIP
,

199 
	#REG_EIP
 
REG_EIP


	)

200 
	mREG_CS
,

201 
	#REG_CS
 
REG_CS


	)

202 
	mREG_EFL
,

203 
	#REG_EFL
 
REG_EFL


	)

204 
	mREG_UESP
,

205 
	#REG_UESP
 
REG_UESP


	)

206 
	mREG_SS


207 
	#REG_SS
 
REG_SS


	)

212 
	s_libc_å»g


214 
__ùx
(
signifiÿnd
)[4];

215 
__ùx
(
expÚ’t
);

218 
	s_libc_å¡©e


220 
__ùx
(
cw
);

221 
__ùx
(
sw
);

222 
__ùx
(
g
);

223 
__ùx
(
off
);

224 
__ùx
(
cs£l
);

225 
__ùx
(
d©aoff
);

226 
__ùx
(
d©a£l
);

227 
_libc_å»g
 
	m_¡
[8];

228 
__ùx
(
¡©us
);

232 
_libc_å¡©e
 *
	tå»g£t_t
;

237 
g»g£t_t
 
__ùx
(
g»gs
);

240 
å»g£t_t
 
__ùx
(
å»gs
);

241 
__ùx
(
Şdmask
);

242 
__ùx
(
ü2
);

243 } 
	tmcÚ‹xt_t
;

246 
	sucÚ‹xt_t


248 
__ùx
(
uc_æags
);

249 
ucÚ‹xt_t
 *
	muc_lšk
;

250 
¡ack_t
 
	muc_¡ack
;

251 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

252 
sig£t_t
 
	muc_sigmask
;

253 
_libc_å¡©e
 
	m__å»gs_mem
;

254 } 
	tucÚ‹xt_t
;

258 #undeà
__ùx


	@/usr/include/asm/ioctls.h

1 
	~<asm-g’”ic/ioùls.h
>

	@/usr/include/asm/socket.h

1 
	~<asm-g’”ic/sock‘.h
>

	@/usr/include/asm/unistd_32.h

1 #iâdeà
_ASM_X86_UNISTD_32_H


2 
	#_ASM_X86_UNISTD_32_H
 1

	)

4 
	#__NR_»¡¬t_sysÿÎ
 0

	)

5 
	#__NR_ex™
 1

	)

6 
	#__NR_fÜk
 2

	)

7 
	#__NR_»ad
 3

	)

8 
	#__NR_wr™e
 4

	)

9 
	#__NR_İ’
 5

	)

10 
	#__NR_şo£
 6

	)

11 
	#__NR_wa™pid
 7

	)

12 
	#__NR_ü—t
 8

	)

13 
	#__NR_lšk
 9

	)

14 
	#__NR_uÆšk
 10

	)

15 
	#__NR_execve
 11

	)

16 
	#__NR_chdœ
 12

	)

17 
	#__NR_time
 13

	)

18 
	#__NR_mknod
 14

	)

19 
	#__NR_chmod
 15

	)

20 
	#__NR_lchown
 16

	)

21 
	#__NR_b»ak
 17

	)

22 
	#__NR_Şd¡©
 18

	)

23 
	#__NR_l£ek
 19

	)

24 
	#__NR_g‘pid
 20

	)

25 
	#__NR_mouÁ
 21

	)

26 
	#__NR_umouÁ
 22

	)

27 
	#__NR_£tuid
 23

	)

28 
	#__NR_g‘uid
 24

	)

29 
	#__NR_¡ime
 25

	)

30 
	#__NR_±¿û
 26

	)

31 
	#__NR_®¬m
 27

	)

32 
	#__NR_Şdf¡©
 28

	)

33 
	#__NR_·u£
 29

	)

34 
	#__NR_utime
 30

	)

35 
	#__NR_¡ty
 31

	)

36 
	#__NR_g‰y
 32

	)

37 
	#__NR_acûss
 33

	)

38 
	#__NR_niû
 34

	)

39 
	#__NR_áime
 35

	)

40 
	#__NR_sync
 36

	)

41 
	#__NR_kl
 37

	)

42 
	#__NR_»Çme
 38

	)

43 
	#__NR_mkdœ
 39

	)

44 
	#__NR_rmdœ
 40

	)

45 
	#__NR_dup
 41

	)

46 
	#__NR_pe
 42

	)

47 
	#__NR_times
 43

	)

48 
	#__NR_´of
 44

	)

49 
	#__NR_brk
 45

	)

50 
	#__NR_£tgid
 46

	)

51 
	#__NR_g‘gid
 47

	)

52 
	#__NR_sigÇl
 48

	)

53 
	#__NR_g‘euid
 49

	)

54 
	#__NR_g‘egid
 50

	)

55 
	#__NR_acù
 51

	)

56 
	#__NR_umouÁ2
 52

	)

57 
	#__NR_lock
 53

	)

58 
	#__NR_ioùl
 54

	)

59 
	#__NR_fú
 55

	)

60 
	#__NR_mpx
 56

	)

61 
	#__NR_£gid
 57

	)

62 
	#__NR_ulim™
 58

	)

63 
	#__NR_ŞdŞduÇme
 59

	)

64 
	#__NR_umask
 60

	)

65 
	#__NR_chroÙ
 61

	)

66 
	#__NR_u¡©
 62

	)

67 
	#__NR_dup2
 63

	)

68 
	#__NR_g‘µid
 64

	)

69 
	#__NR_g‘pg½
 65

	)

70 
	#__NR_£tsid
 66

	)

71 
	#__NR_sigaùiÚ
 67

	)

72 
	#__NR_sg‘mask
 68

	)

73 
	#__NR_s£tmask
 69

	)

74 
	#__NR_£Œeuid
 70

	)

75 
	#__NR_£Œegid
 71

	)

76 
	#__NR_sigsu¥’d
 72

	)

77 
	#__NR_sig³ndšg
 73

	)

78 
	#__NR_£tho¡Çme
 74

	)

79 
	#__NR_£Œlim™
 75

	)

80 
	#__NR_g‘¾im™
 76

	)

81 
	#__NR_g‘ru§ge
 77

	)

82 
	#__NR_g‘timeofday
 78

	)

83 
	#__NR_£‰imeofday
 79

	)

84 
	#__NR_g‘groups
 80

	)

85 
	#__NR_£tgroups
 81

	)

86 
	#__NR_£Ëù
 82

	)

87 
	#__NR_symlšk
 83

	)

88 
	#__NR_Şdl¡©
 84

	)

89 
	#__NR_»adlšk
 85

	)

90 
	#__NR_u£lib
 86

	)

91 
	#__NR_sw­Ú
 87

	)

92 
	#__NR_»boÙ
 88

	)

93 
	#__NR_»addœ
 89

	)

94 
	#__NR_mm­
 90

	)

95 
	#__NR_munm­
 91

	)

96 
	#__NR_Œunÿ‹
 92

	)

97 
	#__NR_árunÿ‹
 93

	)

98 
	#__NR_fchmod
 94

	)

99 
	#__NR_fchown
 95

	)

100 
	#__NR_g‘´iÜ™y
 96

	)

101 
	#__NR_£riÜ™y
 97

	)

102 
	#__NR_´of
 98

	)

103 
	#__NR_¡©fs
 99

	)

104 
	#__NR_f¡©fs
 100

	)

105 
	#__NR_iİ”m
 101

	)

106 
	#__NR_sock‘ÿÎ
 102

	)

107 
	#__NR_sy¦og
 103

	)

108 
	#__NR_£t™im”
 104

	)

109 
	#__NR_g‘™im”
 105

	)

110 
	#__NR_¡©
 106

	)

111 
	#__NR_l¡©
 107

	)

112 
	#__NR_f¡©
 108

	)

113 
	#__NR_ŞduÇme
 109

	)

114 
	#__NR_iİl
 110

	)

115 
	#__NR_vhªgup
 111

	)

116 
	#__NR_idË
 112

	)

117 
	#__NR_vm86Şd
 113

	)

118 
	#__NR_wa™4
 114

	)

119 
	#__NR_sw­off
 115

	)

120 
	#__NR_sysšfo
 116

	)

121 
	#__NR_c
 117

	)

122 
	#__NR_fsync
 118

	)

123 
	#__NR_sig»tuº
 119

	)

124 
	#__NR_şÚe
 120

	)

125 
	#__NR_£tdomašÇme
 121

	)

126 
	#__NR_uÇme
 122

	)

127 
	#__NR_modify_ldt
 123

	)

128 
	#__NR_adjtimex
 124

	)

129 
	#__NR_m´Ùeù
 125

	)

130 
	#__NR_sig´ocmask
 126

	)

131 
	#__NR_ü—‹_moduË
 127

	)

132 
	#__NR_š™_moduË
 128

	)

133 
	#__NR_d–‘e_moduË
 129

	)

134 
	#__NR_g‘_k”Ãl_syms
 130

	)

135 
	#__NR_quÙaùl
 131

	)

136 
	#__NR_g‘pgid
 132

	)

137 
	#__NR_fchdœ
 133

	)

138 
	#__NR_bdæush
 134

	)

139 
	#__NR_sysfs
 135

	)

140 
	#__NR_³rsÚ®™y
 136

	)

141 
	#__NR_afs_sysÿÎ
 137

	)

142 
	#__NR_£tfsuid
 138

	)

143 
	#__NR_£tfsgid
 139

	)

144 
	#__NR__Î£ek
 140

	)

145 
	#__NR_g‘d’ts
 141

	)

146 
	#__NR__Ãw£Ëù
 142

	)

147 
	#__NR_æock
 143

	)

148 
	#__NR_msync
 144

	)

149 
	#__NR_»adv
 145

	)

150 
	#__NR_wr™ev
 146

	)

151 
	#__NR_g‘sid
 147

	)

152 
	#__NR_fd©async
 148

	)

153 
	#__NR__sysùl
 149

	)

154 
	#__NR_mlock
 150

	)

155 
	#__NR_muÆock
 151

	)

156 
	#__NR_mlock®l
 152

	)

157 
	#__NR_muÆock®l
 153

	)

158 
	#__NR_sched_£¬am
 154

	)

159 
	#__NR_sched_g‘·¿m
 155

	)

160 
	#__NR_sched_£tscheduËr
 156

	)

161 
	#__NR_sched_g‘scheduËr
 157

	)

162 
	#__NR_sched_y›ld
 158

	)

163 
	#__NR_sched_g‘_´iÜ™y_max
 159

	)

164 
	#__NR_sched_g‘_´iÜ™y_mš
 160

	)

165 
	#__NR_sched_¼_g‘_š‹rv®
 161

	)

166 
	#__NR_Çno¦“p
 162

	)

167 
	#__NR_m»m­
 163

	)

168 
	#__NR_£Œesuid
 164

	)

169 
	#__NR_g‘»suid
 165

	)

170 
	#__NR_vm86
 166

	)

171 
	#__NR_qu”y_moduË
 167

	)

172 
	#__NR_pŞl
 168

	)

173 
	#__NR_nfs£rvùl
 169

	)

174 
	#__NR_£Œesgid
 170

	)

175 
	#__NR_g‘»sgid
 171

	)

176 
	#__NR_´ùl
 172

	)

177 
	#__NR_¹_sig»tuº
 173

	)

178 
	#__NR_¹_sigaùiÚ
 174

	)

179 
	#__NR_¹_sig´ocmask
 175

	)

180 
	#__NR_¹_sig³ndšg
 176

	)

181 
	#__NR_¹_sigtimedwa™
 177

	)

182 
	#__NR_¹_sigqueuešfo
 178

	)

183 
	#__NR_¹_sigsu¥’d
 179

	)

184 
	#__NR_´—d64
 180

	)

185 
	#__NR_pwr™e64
 181

	)

186 
	#__NR_chown
 182

	)

187 
	#__NR_g‘cwd
 183

	)

188 
	#__NR_ÿpg‘
 184

	)

189 
	#__NR_ÿp£t
 185

	)

190 
	#__NR_sig®t¡ack
 186

	)

191 
	#__NR_£ndfe
 187

	)

192 
	#__NR_g‘pmsg
 188

	)

193 
	#__NR_pumsg
 189

	)

194 
	#__NR_vfÜk
 190

	)

195 
	#__NR_ug‘¾im™
 191

	)

196 
	#__NR_mm­2
 192

	)

197 
	#__NR_Œunÿ‹64
 193

	)

198 
	#__NR_árunÿ‹64
 194

	)

199 
	#__NR_¡©64
 195

	)

200 
	#__NR_l¡©64
 196

	)

201 
	#__NR_f¡©64
 197

	)

202 
	#__NR_lchown32
 198

	)

203 
	#__NR_g‘uid32
 199

	)

204 
	#__NR_g‘gid32
 200

	)

205 
	#__NR_g‘euid32
 201

	)

206 
	#__NR_g‘egid32
 202

	)

207 
	#__NR_£Œeuid32
 203

	)

208 
	#__NR_£Œegid32
 204

	)

209 
	#__NR_g‘groups32
 205

	)

210 
	#__NR_£tgroups32
 206

	)

211 
	#__NR_fchown32
 207

	)

212 
	#__NR_£Œesuid32
 208

	)

213 
	#__NR_g‘»suid32
 209

	)

214 
	#__NR_£Œesgid32
 210

	)

215 
	#__NR_g‘»sgid32
 211

	)

216 
	#__NR_chown32
 212

	)

217 
	#__NR_£tuid32
 213

	)

218 
	#__NR_£tgid32
 214

	)

219 
	#__NR_£tfsuid32
 215

	)

220 
	#__NR_£tfsgid32
 216

	)

221 
	#__NR_pivÙ_roÙ
 217

	)

222 
	#__NR_mšcÜe
 218

	)

223 
	#__NR_madvi£
 219

	)

224 
	#__NR_g‘d’ts64
 220

	)

225 
	#__NR_fú64
 221

	)

226 
	#__NR_g‘tid
 224

	)

227 
	#__NR_»adah—d
 225

	)

228 
	#__NR_£tx©Œ
 226

	)

229 
	#__NR_l£tx©Œ
 227

	)

230 
	#__NR_f£tx©Œ
 228

	)

231 
	#__NR_g‘x©Œ
 229

	)

232 
	#__NR_lg‘x©Œ
 230

	)

233 
	#__NR_fg‘x©Œ
 231

	)

234 
	#__NR_li¡x©Œ
 232

	)

235 
	#__NR_Îi¡x©Œ
 233

	)

236 
	#__NR_æi¡x©Œ
 234

	)

237 
	#__NR_»movex©Œ
 235

	)

238 
	#__NR_Ìemovex©Œ
 236

	)

239 
	#__NR_äemovex©Œ
 237

	)

240 
	#__NR_tkl
 238

	)

241 
	#__NR_£ndfe64
 239

	)

242 
	#__NR_fu‹x
 240

	)

243 
	#__NR_sched_£ffš™y
 241

	)

244 
	#__NR_sched_g‘affš™y
 242

	)

245 
	#__NR_£t_th»ad_¬—
 243

	)

246 
	#__NR_g‘_th»ad_¬—
 244

	)

247 
	#__NR_io_£tup
 245

	)

248 
	#__NR_io_de¡roy
 246

	)

249 
	#__NR_io_g‘ev’ts
 247

	)

250 
	#__NR_io_subm™
 248

	)

251 
	#__NR_io_ÿnûl
 249

	)

252 
	#__NR_çdvi£64
 250

	)

253 
	#__NR_ex™_group
 252

	)

254 
	#__NR_lookup_dcook›
 253

	)

255 
	#__NR_•Şl_ü—‹
 254

	)

256 
	#__NR_•Şl_ùl
 255

	)

257 
	#__NR_•Şl_wa™
 256

	)

258 
	#__NR_»m­_fe_·ges
 257

	)

259 
	#__NR_£t_tid_add»ss
 258

	)

260 
	#__NR_tim”_ü—‹
 259

	)

261 
	#__NR_tim”_£‰ime
 260

	)

262 
	#__NR_tim”_g‘time
 261

	)

263 
	#__NR_tim”_g‘ov”run
 262

	)

264 
	#__NR_tim”_d–‘e
 263

	)

265 
	#__NR_şock_£‰ime
 264

	)

266 
	#__NR_şock_g‘time
 265

	)

267 
	#__NR_şock_g‘»s
 266

	)

268 
	#__NR_şock_Çno¦“p
 267

	)

269 
	#__NR_¡©fs64
 268

	)

270 
	#__NR_f¡©fs64
 269

	)

271 
	#__NR_tgkl
 270

	)

272 
	#__NR_utimes
 271

	)

273 
	#__NR_çdvi£64_64
 272

	)

274 
	#__NR_v£rv”
 273

	)

275 
	#__NR_mbšd
 274

	)

276 
	#__NR_g‘_mempŞicy
 275

	)

277 
	#__NR_£t_mempŞicy
 276

	)

278 
	#__NR_mq_İ’
 277

	)

279 
	#__NR_mq_uÆšk
 278

	)

280 
	#__NR_mq_timed£nd
 279

	)

281 
	#__NR_mq_timed»ûive
 280

	)

282 
	#__NR_mq_nÙify
 281

	)

283 
	#__NR_mq_g‘£‰r
 282

	)

284 
	#__NR_kexec_lßd
 283

	)

285 
	#__NR_wa™id
 284

	)

286 
	#__NR_add_key
 286

	)

287 
	#__NR_»que¡_key
 287

	)

288 
	#__NR_keyùl
 288

	)

289 
	#__NR_iİrio_£t
 289

	)

290 
	#__NR_iİrio_g‘
 290

	)

291 
	#__NR_šÙify_š™
 291

	)

292 
	#__NR_šÙify_add_w©ch
 292

	)

293 
	#__NR_šÙify_rm_w©ch
 293

	)

294 
	#__NR_mig¿‹_·ges
 294

	)

295 
	#__NR_İ’©
 295

	)

296 
	#__NR_mkdœ©
 296

	)

297 
	#__NR_mknod©
 297

	)

298 
	#__NR_fchowÇt
 298

	)

299 
	#__NR_futime§t
 299

	)

300 
	#__NR_f¡©©64
 300

	)

301 
	#__NR_uÆšk©
 301

	)

302 
	#__NR_»Çm—t
 302

	)

303 
	#__NR_lšk©
 303

	)

304 
	#__NR_symlšk©
 304

	)

305 
	#__NR_»adlšk©
 305

	)

306 
	#__NR_fchmod©
 306

	)

307 
	#__NR_çcûs§t
 307

	)

308 
	#__NR_p£Ëù6
 308

	)

309 
	#__NR_µŞl
 309

	)

310 
	#__NR_unsh¬e
 310

	)

311 
	#__NR_£t_robu¡_li¡
 311

	)

312 
	#__NR_g‘_robu¡_li¡
 312

	)

313 
	#__NR_¥liû
 313

	)

314 
	#__NR_sync_fe_¿nge
 314

	)

315 
	#__NR_‹e
 315

	)

316 
	#__NR_vm¥liû
 316

	)

317 
	#__NR_move_·ges
 317

	)

318 
	#__NR_g‘ıu
 318

	)

319 
	#__NR_•Şl_pwa™
 319

	)

320 
	#__NR_utim’§t
 320

	)

321 
	#__NR_sigÇlfd
 321

	)

322 
	#__NR_tim”fd_ü—‹
 322

	)

323 
	#__NR_ev’tfd
 323

	)

324 
	#__NR_çÎoÿ‹
 324

	)

325 
	#__NR_tim”fd_£‰ime
 325

	)

326 
	#__NR_tim”fd_g‘time
 326

	)

327 
	#__NR_sigÇlfd4
 327

	)

328 
	#__NR_ev’tfd2
 328

	)

329 
	#__NR_•Şl_ü—‹1
 329

	)

330 
	#__NR_dup3
 330

	)

331 
	#__NR_pe2
 331

	)

332 
	#__NR_šÙify_š™1
 332

	)

333 
	#__NR_´—dv
 333

	)

334 
	#__NR_pwr™ev
 334

	)

335 
	#__NR_¹_tgsigqueuešfo
 335

	)

336 
	#__NR_³rf_ev’t_İ’
 336

	)

337 
	#__NR_»cvmmsg
 337

	)

338 
	#__NR_çnÙify_š™
 338

	)

339 
	#__NR_çnÙify_m¬k
 339

	)

340 
	#__NR_´lim™64
 340

	)

341 
	#__NR_Çme_to_hªdË_©
 341

	)

342 
	#__NR_İ’_by_hªdË_©
 342

	)

343 
	#__NR_şock_adjtime
 343

	)

344 
	#__NR_syncfs
 344

	)

345 
	#__NR_£ndmmsg
 345

	)

346 
	#__NR_£Šs
 346

	)

347 
	#__NR_´oûss_vm_»adv
 347

	)

348 
	#__NR_´oûss_vm_wr™ev
 348

	)

349 
	#__NR_kcmp
 349

	)

350 
	#__NR_fš™_moduË
 350

	)

351 
	#__NR_sched_£‰r
 351

	)

352 
	#__NR_sched_g‘©Œ
 352

	)

353 
	#__NR_»Çm—t2
 353

	)

354 
	#__NR_£ccomp
 354

	)

355 
	#__NR_g‘¿ndom
 355

	)

356 
	#__NR_memfd_ü—‹
 356

	)

357 
	#__NR_bpf
 357

	)

358 
	#__NR_execv—t
 358

	)

359 
	#__NR_sock‘
 359

	)

360 
	#__NR_sock‘·œ
 360

	)

361 
	#__NR_bšd
 361

	)

362 
	#__NR_cÚÃù
 362

	)

363 
	#__NR_li¡’
 363

	)

364 
	#__NR_acû±4
 364

	)

365 
	#__NR_g‘sockİt
 365

	)

366 
	#__NR_£tsockİt
 366

	)

367 
	#__NR_g‘sockÇme
 367

	)

368 
	#__NR_g‘³”Çme
 368

	)

369 
	#__NR_£ndto
 369

	)

370 
	#__NR_£ndmsg
 370

	)

371 
	#__NR_»cväom
 371

	)

372 
	#__NR_»cvmsg
 372

	)

373 
	#__NR_shutdown
 373

	)

374 
	#__NR_u£rçuÉfd
 374

	)

375 
	#__NR_memb¬r›r
 375

	)

376 
	#__NR_mlock2
 376

	)

377 
	#__NR_cİy_fe_¿nge
 377

	)

378 
	#__NR_´—dv2
 378

	)

379 
	#__NR_pwr™ev2
 379

	)

380 
	#__NR_pkey_m´Ùeù
 380

	)

381 
	#__NR_pkey_®loc
 381

	)

382 
	#__NR_pkey_ä“
 382

	)

383 
	#__NR_¡©x
 383

	)

384 
	#__NR_¬ch_´ùl
 384

	)

	@/usr/include/asm/unistd_64.h

1 #iâdeà
_ASM_X86_UNISTD_64_H


2 
	#_ASM_X86_UNISTD_64_H
 1

	)

4 
	#__NR_»ad
 0

	)

5 
	#__NR_wr™e
 1

	)

6 
	#__NR_İ’
 2

	)

7 
	#__NR_şo£
 3

	)

8 
	#__NR_¡©
 4

	)

9 
	#__NR_f¡©
 5

	)

10 
	#__NR_l¡©
 6

	)

11 
	#__NR_pŞl
 7

	)

12 
	#__NR_l£ek
 8

	)

13 
	#__NR_mm­
 9

	)

14 
	#__NR_m´Ùeù
 10

	)

15 
	#__NR_munm­
 11

	)

16 
	#__NR_brk
 12

	)

17 
	#__NR_¹_sigaùiÚ
 13

	)

18 
	#__NR_¹_sig´ocmask
 14

	)

19 
	#__NR_¹_sig»tuº
 15

	)

20 
	#__NR_ioùl
 16

	)

21 
	#__NR_´—d64
 17

	)

22 
	#__NR_pwr™e64
 18

	)

23 
	#__NR_»adv
 19

	)

24 
	#__NR_wr™ev
 20

	)

25 
	#__NR_acûss
 21

	)

26 
	#__NR_pe
 22

	)

27 
	#__NR_£Ëù
 23

	)

28 
	#__NR_sched_y›ld
 24

	)

29 
	#__NR_m»m­
 25

	)

30 
	#__NR_msync
 26

	)

31 
	#__NR_mšcÜe
 27

	)

32 
	#__NR_madvi£
 28

	)

33 
	#__NR_shmg‘
 29

	)

34 
	#__NR_shm©
 30

	)

35 
	#__NR_shmùl
 31

	)

36 
	#__NR_dup
 32

	)

37 
	#__NR_dup2
 33

	)

38 
	#__NR_·u£
 34

	)

39 
	#__NR_Çno¦“p
 35

	)

40 
	#__NR_g‘™im”
 36

	)

41 
	#__NR_®¬m
 37

	)

42 
	#__NR_£t™im”
 38

	)

43 
	#__NR_g‘pid
 39

	)

44 
	#__NR_£ndfe
 40

	)

45 
	#__NR_sock‘
 41

	)

46 
	#__NR_cÚÃù
 42

	)

47 
	#__NR_acû±
 43

	)

48 
	#__NR_£ndto
 44

	)

49 
	#__NR_»cväom
 45

	)

50 
	#__NR_£ndmsg
 46

	)

51 
	#__NR_»cvmsg
 47

	)

52 
	#__NR_shutdown
 48

	)

53 
	#__NR_bšd
 49

	)

54 
	#__NR_li¡’
 50

	)

55 
	#__NR_g‘sockÇme
 51

	)

56 
	#__NR_g‘³”Çme
 52

	)

57 
	#__NR_sock‘·œ
 53

	)

58 
	#__NR_£tsockİt
 54

	)

59 
	#__NR_g‘sockİt
 55

	)

60 
	#__NR_şÚe
 56

	)

61 
	#__NR_fÜk
 57

	)

62 
	#__NR_vfÜk
 58

	)

63 
	#__NR_execve
 59

	)

64 
	#__NR_ex™
 60

	)

65 
	#__NR_wa™4
 61

	)

66 
	#__NR_kl
 62

	)

67 
	#__NR_uÇme
 63

	)

68 
	#__NR_£mg‘
 64

	)

69 
	#__NR_£mİ
 65

	)

70 
	#__NR_£mùl
 66

	)

71 
	#__NR_shmdt
 67

	)

72 
	#__NR_msgg‘
 68

	)

73 
	#__NR_msg¢d
 69

	)

74 
	#__NR_msgrcv
 70

	)

75 
	#__NR_msgùl
 71

	)

76 
	#__NR_fú
 72

	)

77 
	#__NR_æock
 73

	)

78 
	#__NR_fsync
 74

	)

79 
	#__NR_fd©async
 75

	)

80 
	#__NR_Œunÿ‹
 76

	)

81 
	#__NR_árunÿ‹
 77

	)

82 
	#__NR_g‘d’ts
 78

	)

83 
	#__NR_g‘cwd
 79

	)

84 
	#__NR_chdœ
 80

	)

85 
	#__NR_fchdœ
 81

	)

86 
	#__NR_»Çme
 82

	)

87 
	#__NR_mkdœ
 83

	)

88 
	#__NR_rmdœ
 84

	)

89 
	#__NR_ü—t
 85

	)

90 
	#__NR_lšk
 86

	)

91 
	#__NR_uÆšk
 87

	)

92 
	#__NR_symlšk
 88

	)

93 
	#__NR_»adlšk
 89

	)

94 
	#__NR_chmod
 90

	)

95 
	#__NR_fchmod
 91

	)

96 
	#__NR_chown
 92

	)

97 
	#__NR_fchown
 93

	)

98 
	#__NR_lchown
 94

	)

99 
	#__NR_umask
 95

	)

100 
	#__NR_g‘timeofday
 96

	)

101 
	#__NR_g‘¾im™
 97

	)

102 
	#__NR_g‘ru§ge
 98

	)

103 
	#__NR_sysšfo
 99

	)

104 
	#__NR_times
 100

	)

105 
	#__NR_±¿û
 101

	)

106 
	#__NR_g‘uid
 102

	)

107 
	#__NR_sy¦og
 103

	)

108 
	#__NR_g‘gid
 104

	)

109 
	#__NR_£tuid
 105

	)

110 
	#__NR_£tgid
 106

	)

111 
	#__NR_g‘euid
 107

	)

112 
	#__NR_g‘egid
 108

	)

113 
	#__NR_£gid
 109

	)

114 
	#__NR_g‘µid
 110

	)

115 
	#__NR_g‘pg½
 111

	)

116 
	#__NR_£tsid
 112

	)

117 
	#__NR_£Œeuid
 113

	)

118 
	#__NR_£Œegid
 114

	)

119 
	#__NR_g‘groups
 115

	)

120 
	#__NR_£tgroups
 116

	)

121 
	#__NR_£Œesuid
 117

	)

122 
	#__NR_g‘»suid
 118

	)

123 
	#__NR_£Œesgid
 119

	)

124 
	#__NR_g‘»sgid
 120

	)

125 
	#__NR_g‘pgid
 121

	)

126 
	#__NR_£tfsuid
 122

	)

127 
	#__NR_£tfsgid
 123

	)

128 
	#__NR_g‘sid
 124

	)

129 
	#__NR_ÿpg‘
 125

	)

130 
	#__NR_ÿp£t
 126

	)

131 
	#__NR_¹_sig³ndšg
 127

	)

132 
	#__NR_¹_sigtimedwa™
 128

	)

133 
	#__NR_¹_sigqueuešfo
 129

	)

134 
	#__NR_¹_sigsu¥’d
 130

	)

135 
	#__NR_sig®t¡ack
 131

	)

136 
	#__NR_utime
 132

	)

137 
	#__NR_mknod
 133

	)

138 
	#__NR_u£lib
 134

	)

139 
	#__NR_³rsÚ®™y
 135

	)

140 
	#__NR_u¡©
 136

	)

141 
	#__NR_¡©fs
 137

	)

142 
	#__NR_f¡©fs
 138

	)

143 
	#__NR_sysfs
 139

	)

144 
	#__NR_g‘´iÜ™y
 140

	)

145 
	#__NR_£riÜ™y
 141

	)

146 
	#__NR_sched_£¬am
 142

	)

147 
	#__NR_sched_g‘·¿m
 143

	)

148 
	#__NR_sched_£tscheduËr
 144

	)

149 
	#__NR_sched_g‘scheduËr
 145

	)

150 
	#__NR_sched_g‘_´iÜ™y_max
 146

	)

151 
	#__NR_sched_g‘_´iÜ™y_mš
 147

	)

152 
	#__NR_sched_¼_g‘_š‹rv®
 148

	)

153 
	#__NR_mlock
 149

	)

154 
	#__NR_muÆock
 150

	)

155 
	#__NR_mlock®l
 151

	)

156 
	#__NR_muÆock®l
 152

	)

157 
	#__NR_vhªgup
 153

	)

158 
	#__NR_modify_ldt
 154

	)

159 
	#__NR_pivÙ_roÙ
 155

	)

160 
	#__NR__sysùl
 156

	)

161 
	#__NR_´ùl
 157

	)

162 
	#__NR_¬ch_´ùl
 158

	)

163 
	#__NR_adjtimex
 159

	)

164 
	#__NR_£Œlim™
 160

	)

165 
	#__NR_chroÙ
 161

	)

166 
	#__NR_sync
 162

	)

167 
	#__NR_acù
 163

	)

168 
	#__NR_£‰imeofday
 164

	)

169 
	#__NR_mouÁ
 165

	)

170 
	#__NR_umouÁ2
 166

	)

171 
	#__NR_sw­Ú
 167

	)

172 
	#__NR_sw­off
 168

	)

173 
	#__NR_»boÙ
 169

	)

174 
	#__NR_£tho¡Çme
 170

	)

175 
	#__NR_£tdomašÇme
 171

	)

176 
	#__NR_iİl
 172

	)

177 
	#__NR_iİ”m
 173

	)

178 
	#__NR_ü—‹_moduË
 174

	)

179 
	#__NR_š™_moduË
 175

	)

180 
	#__NR_d–‘e_moduË
 176

	)

181 
	#__NR_g‘_k”Ãl_syms
 177

	)

182 
	#__NR_qu”y_moduË
 178

	)

183 
	#__NR_quÙaùl
 179

	)

184 
	#__NR_nfs£rvùl
 180

	)

185 
	#__NR_g‘pmsg
 181

	)

186 
	#__NR_pumsg
 182

	)

187 
	#__NR_afs_sysÿÎ
 183

	)

188 
	#__NR_tuxÿÎ
 184

	)

189 
	#__NR_£cur™y
 185

	)

190 
	#__NR_g‘tid
 186

	)

191 
	#__NR_»adah—d
 187

	)

192 
	#__NR_£tx©Œ
 188

	)

193 
	#__NR_l£tx©Œ
 189

	)

194 
	#__NR_f£tx©Œ
 190

	)

195 
	#__NR_g‘x©Œ
 191

	)

196 
	#__NR_lg‘x©Œ
 192

	)

197 
	#__NR_fg‘x©Œ
 193

	)

198 
	#__NR_li¡x©Œ
 194

	)

199 
	#__NR_Îi¡x©Œ
 195

	)

200 
	#__NR_æi¡x©Œ
 196

	)

201 
	#__NR_»movex©Œ
 197

	)

202 
	#__NR_Ìemovex©Œ
 198

	)

203 
	#__NR_äemovex©Œ
 199

	)

204 
	#__NR_tkl
 200

	)

205 
	#__NR_time
 201

	)

206 
	#__NR_fu‹x
 202

	)

207 
	#__NR_sched_£ffš™y
 203

	)

208 
	#__NR_sched_g‘affš™y
 204

	)

209 
	#__NR_£t_th»ad_¬—
 205

	)

210 
	#__NR_io_£tup
 206

	)

211 
	#__NR_io_de¡roy
 207

	)

212 
	#__NR_io_g‘ev’ts
 208

	)

213 
	#__NR_io_subm™
 209

	)

214 
	#__NR_io_ÿnûl
 210

	)

215 
	#__NR_g‘_th»ad_¬—
 211

	)

216 
	#__NR_lookup_dcook›
 212

	)

217 
	#__NR_•Şl_ü—‹
 213

	)

218 
	#__NR_•Şl_ùl_Şd
 214

	)

219 
	#__NR_•Şl_wa™_Şd
 215

	)

220 
	#__NR_»m­_fe_·ges
 216

	)

221 
	#__NR_g‘d’ts64
 217

	)

222 
	#__NR_£t_tid_add»ss
 218

	)

223 
	#__NR_»¡¬t_sysÿÎ
 219

	)

224 
	#__NR_£mtimedİ
 220

	)

225 
	#__NR_çdvi£64
 221

	)

226 
	#__NR_tim”_ü—‹
 222

	)

227 
	#__NR_tim”_£‰ime
 223

	)

228 
	#__NR_tim”_g‘time
 224

	)

229 
	#__NR_tim”_g‘ov”run
 225

	)

230 
	#__NR_tim”_d–‘e
 226

	)

231 
	#__NR_şock_£‰ime
 227

	)

232 
	#__NR_şock_g‘time
 228

	)

233 
	#__NR_şock_g‘»s
 229

	)

234 
	#__NR_şock_Çno¦“p
 230

	)

235 
	#__NR_ex™_group
 231

	)

236 
	#__NR_•Şl_wa™
 232

	)

237 
	#__NR_•Şl_ùl
 233

	)

238 
	#__NR_tgkl
 234

	)

239 
	#__NR_utimes
 235

	)

240 
	#__NR_v£rv”
 236

	)

241 
	#__NR_mbšd
 237

	)

242 
	#__NR_£t_mempŞicy
 238

	)

243 
	#__NR_g‘_mempŞicy
 239

	)

244 
	#__NR_mq_İ’
 240

	)

245 
	#__NR_mq_uÆšk
 241

	)

246 
	#__NR_mq_timed£nd
 242

	)

247 
	#__NR_mq_timed»ûive
 243

	)

248 
	#__NR_mq_nÙify
 244

	)

249 
	#__NR_mq_g‘£‰r
 245

	)

250 
	#__NR_kexec_lßd
 246

	)

251 
	#__NR_wa™id
 247

	)

252 
	#__NR_add_key
 248

	)

253 
	#__NR_»que¡_key
 249

	)

254 
	#__NR_keyùl
 250

	)

255 
	#__NR_iİrio_£t
 251

	)

256 
	#__NR_iİrio_g‘
 252

	)

257 
	#__NR_šÙify_š™
 253

	)

258 
	#__NR_šÙify_add_w©ch
 254

	)

259 
	#__NR_šÙify_rm_w©ch
 255

	)

260 
	#__NR_mig¿‹_·ges
 256

	)

261 
	#__NR_İ’©
 257

	)

262 
	#__NR_mkdœ©
 258

	)

263 
	#__NR_mknod©
 259

	)

264 
	#__NR_fchowÇt
 260

	)

265 
	#__NR_futime§t
 261

	)

266 
	#__NR_Ãwf¡©©
 262

	)

267 
	#__NR_uÆšk©
 263

	)

268 
	#__NR_»Çm—t
 264

	)

269 
	#__NR_lšk©
 265

	)

270 
	#__NR_symlšk©
 266

	)

271 
	#__NR_»adlšk©
 267

	)

272 
	#__NR_fchmod©
 268

	)

273 
	#__NR_çcûs§t
 269

	)

274 
	#__NR_p£Ëù6
 270

	)

275 
	#__NR_µŞl
 271

	)

276 
	#__NR_unsh¬e
 272

	)

277 
	#__NR_£t_robu¡_li¡
 273

	)

278 
	#__NR_g‘_robu¡_li¡
 274

	)

279 
	#__NR_¥liû
 275

	)

280 
	#__NR_‹e
 276

	)

281 
	#__NR_sync_fe_¿nge
 277

	)

282 
	#__NR_vm¥liû
 278

	)

283 
	#__NR_move_·ges
 279

	)

284 
	#__NR_utim’§t
 280

	)

285 
	#__NR_•Şl_pwa™
 281

	)

286 
	#__NR_sigÇlfd
 282

	)

287 
	#__NR_tim”fd_ü—‹
 283

	)

288 
	#__NR_ev’tfd
 284

	)

289 
	#__NR_çÎoÿ‹
 285

	)

290 
	#__NR_tim”fd_£‰ime
 286

	)

291 
	#__NR_tim”fd_g‘time
 287

	)

292 
	#__NR_acû±4
 288

	)

293 
	#__NR_sigÇlfd4
 289

	)

294 
	#__NR_ev’tfd2
 290

	)

295 
	#__NR_•Şl_ü—‹1
 291

	)

296 
	#__NR_dup3
 292

	)

297 
	#__NR_pe2
 293

	)

298 
	#__NR_šÙify_š™1
 294

	)

299 
	#__NR_´—dv
 295

	)

300 
	#__NR_pwr™ev
 296

	)

301 
	#__NR_¹_tgsigqueuešfo
 297

	)

302 
	#__NR_³rf_ev’t_İ’
 298

	)

303 
	#__NR_»cvmmsg
 299

	)

304 
	#__NR_çnÙify_š™
 300

	)

305 
	#__NR_çnÙify_m¬k
 301

	)

306 
	#__NR_´lim™64
 302

	)

307 
	#__NR_Çme_to_hªdË_©
 303

	)

308 
	#__NR_İ’_by_hªdË_©
 304

	)

309 
	#__NR_şock_adjtime
 305

	)

310 
	#__NR_syncfs
 306

	)

311 
	#__NR_£ndmmsg
 307

	)

312 
	#__NR_£Šs
 308

	)

313 
	#__NR_g‘ıu
 309

	)

314 
	#__NR_´oûss_vm_»adv
 310

	)

315 
	#__NR_´oûss_vm_wr™ev
 311

	)

316 
	#__NR_kcmp
 312

	)

317 
	#__NR_fš™_moduË
 313

	)

318 
	#__NR_sched_£‰r
 314

	)

319 
	#__NR_sched_g‘©Œ
 315

	)

320 
	#__NR_»Çm—t2
 316

	)

321 
	#__NR_£ccomp
 317

	)

322 
	#__NR_g‘¿ndom
 318

	)

323 
	#__NR_memfd_ü—‹
 319

	)

324 
	#__NR_kexec_fe_lßd
 320

	)

325 
	#__NR_bpf
 321

	)

326 
	#__NR_execv—t
 322

	)

327 
	#__NR_u£rçuÉfd
 323

	)

328 
	#__NR_memb¬r›r
 324

	)

329 
	#__NR_mlock2
 325

	)

330 
	#__NR_cİy_fe_¿nge
 326

	)

331 
	#__NR_´—dv2
 327

	)

332 
	#__NR_pwr™ev2
 328

	)

333 
	#__NR_pkey_m´Ùeù
 329

	)

334 
	#__NR_pkey_®loc
 330

	)

335 
	#__NR_pkey_ä“
 331

	)

336 
	#__NR_¡©x
 332

	)

	@/usr/include/asm/unistd_x32.h

1 #iâdeà
_ASM_X86_UNISTD_X32_H


2 
	#_ASM_X86_UNISTD_X32_H
 1

	)

4 
	#__NR_»ad
 (
__X32_SYSCALL_BIT
 + 0)

	)

5 
	#__NR_wr™e
 (
__X32_SYSCALL_BIT
 + 1)

	)

6 
	#__NR_İ’
 (
__X32_SYSCALL_BIT
 + 2)

	)

7 
	#__NR_şo£
 (
__X32_SYSCALL_BIT
 + 3)

	)

8 
	#__NR_¡©
 (
__X32_SYSCALL_BIT
 + 4)

	)

9 
	#__NR_f¡©
 (
__X32_SYSCALL_BIT
 + 5)

	)

10 
	#__NR_l¡©
 (
__X32_SYSCALL_BIT
 + 6)

	)

11 
	#__NR_pŞl
 (
__X32_SYSCALL_BIT
 + 7)

	)

12 
	#__NR_l£ek
 (
__X32_SYSCALL_BIT
 + 8)

	)

13 
	#__NR_mm­
 (
__X32_SYSCALL_BIT
 + 9)

	)

14 
	#__NR_m´Ùeù
 (
__X32_SYSCALL_BIT
 + 10)

	)

15 
	#__NR_munm­
 (
__X32_SYSCALL_BIT
 + 11)

	)

16 
	#__NR_brk
 (
__X32_SYSCALL_BIT
 + 12)

	)

17 
	#__NR_¹_sig´ocmask
 (
__X32_SYSCALL_BIT
 + 14)

	)

18 
	#__NR_´—d64
 (
__X32_SYSCALL_BIT
 + 17)

	)

19 
	#__NR_pwr™e64
 (
__X32_SYSCALL_BIT
 + 18)

	)

20 
	#__NR_acûss
 (
__X32_SYSCALL_BIT
 + 21)

	)

21 
	#__NR_pe
 (
__X32_SYSCALL_BIT
 + 22)

	)

22 
	#__NR_£Ëù
 (
__X32_SYSCALL_BIT
 + 23)

	)

23 
	#__NR_sched_y›ld
 (
__X32_SYSCALL_BIT
 + 24)

	)

24 
	#__NR_m»m­
 (
__X32_SYSCALL_BIT
 + 25)

	)

25 
	#__NR_msync
 (
__X32_SYSCALL_BIT
 + 26)

	)

26 
	#__NR_mšcÜe
 (
__X32_SYSCALL_BIT
 + 27)

	)

27 
	#__NR_madvi£
 (
__X32_SYSCALL_BIT
 + 28)

	)

28 
	#__NR_shmg‘
 (
__X32_SYSCALL_BIT
 + 29)

	)

29 
	#__NR_shm©
 (
__X32_SYSCALL_BIT
 + 30)

	)

30 
	#__NR_shmùl
 (
__X32_SYSCALL_BIT
 + 31)

	)

31 
	#__NR_dup
 (
__X32_SYSCALL_BIT
 + 32)

	)

32 
	#__NR_dup2
 (
__X32_SYSCALL_BIT
 + 33)

	)

33 
	#__NR_·u£
 (
__X32_SYSCALL_BIT
 + 34)

	)

34 
	#__NR_Çno¦“p
 (
__X32_SYSCALL_BIT
 + 35)

	)

35 
	#__NR_g‘™im”
 (
__X32_SYSCALL_BIT
 + 36)

	)

36 
	#__NR_®¬m
 (
__X32_SYSCALL_BIT
 + 37)

	)

37 
	#__NR_£t™im”
 (
__X32_SYSCALL_BIT
 + 38)

	)

38 
	#__NR_g‘pid
 (
__X32_SYSCALL_BIT
 + 39)

	)

39 
	#__NR_£ndfe
 (
__X32_SYSCALL_BIT
 + 40)

	)

40 
	#__NR_sock‘
 (
__X32_SYSCALL_BIT
 + 41)

	)

41 
	#__NR_cÚÃù
 (
__X32_SYSCALL_BIT
 + 42)

	)

42 
	#__NR_acû±
 (
__X32_SYSCALL_BIT
 + 43)

	)

43 
	#__NR_£ndto
 (
__X32_SYSCALL_BIT
 + 44)

	)

44 
	#__NR_shutdown
 (
__X32_SYSCALL_BIT
 + 48)

	)

45 
	#__NR_bšd
 (
__X32_SYSCALL_BIT
 + 49)

	)

46 
	#__NR_li¡’
 (
__X32_SYSCALL_BIT
 + 50)

	)

47 
	#__NR_g‘sockÇme
 (
__X32_SYSCALL_BIT
 + 51)

	)

48 
	#__NR_g‘³”Çme
 (
__X32_SYSCALL_BIT
 + 52)

	)

49 
	#__NR_sock‘·œ
 (
__X32_SYSCALL_BIT
 + 53)

	)

50 
	#__NR_şÚe
 (
__X32_SYSCALL_BIT
 + 56)

	)

51 
	#__NR_fÜk
 (
__X32_SYSCALL_BIT
 + 57)

	)

52 
	#__NR_vfÜk
 (
__X32_SYSCALL_BIT
 + 58)

	)

53 
	#__NR_ex™
 (
__X32_SYSCALL_BIT
 + 60)

	)

54 
	#__NR_wa™4
 (
__X32_SYSCALL_BIT
 + 61)

	)

55 
	#__NR_kl
 (
__X32_SYSCALL_BIT
 + 62)

	)

56 
	#__NR_uÇme
 (
__X32_SYSCALL_BIT
 + 63)

	)

57 
	#__NR_£mg‘
 (
__X32_SYSCALL_BIT
 + 64)

	)

58 
	#__NR_£mİ
 (
__X32_SYSCALL_BIT
 + 65)

	)

59 
	#__NR_£mùl
 (
__X32_SYSCALL_BIT
 + 66)

	)

60 
	#__NR_shmdt
 (
__X32_SYSCALL_BIT
 + 67)

	)

61 
	#__NR_msgg‘
 (
__X32_SYSCALL_BIT
 + 68)

	)

62 
	#__NR_msg¢d
 (
__X32_SYSCALL_BIT
 + 69)

	)

63 
	#__NR_msgrcv
 (
__X32_SYSCALL_BIT
 + 70)

	)

64 
	#__NR_msgùl
 (
__X32_SYSCALL_BIT
 + 71)

	)

65 
	#__NR_fú
 (
__X32_SYSCALL_BIT
 + 72)

	)

66 
	#__NR_æock
 (
__X32_SYSCALL_BIT
 + 73)

	)

67 
	#__NR_fsync
 (
__X32_SYSCALL_BIT
 + 74)

	)

68 
	#__NR_fd©async
 (
__X32_SYSCALL_BIT
 + 75)

	)

69 
	#__NR_Œunÿ‹
 (
__X32_SYSCALL_BIT
 + 76)

	)

70 
	#__NR_árunÿ‹
 (
__X32_SYSCALL_BIT
 + 77)

	)

71 
	#__NR_g‘d’ts
 (
__X32_SYSCALL_BIT
 + 78)

	)

72 
	#__NR_g‘cwd
 (
__X32_SYSCALL_BIT
 + 79)

	)

73 
	#__NR_chdœ
 (
__X32_SYSCALL_BIT
 + 80)

	)

74 
	#__NR_fchdœ
 (
__X32_SYSCALL_BIT
 + 81)

	)

75 
	#__NR_»Çme
 (
__X32_SYSCALL_BIT
 + 82)

	)

76 
	#__NR_mkdœ
 (
__X32_SYSCALL_BIT
 + 83)

	)

77 
	#__NR_rmdœ
 (
__X32_SYSCALL_BIT
 + 84)

	)

78 
	#__NR_ü—t
 (
__X32_SYSCALL_BIT
 + 85)

	)

79 
	#__NR_lšk
 (
__X32_SYSCALL_BIT
 + 86)

	)

80 
	#__NR_uÆšk
 (
__X32_SYSCALL_BIT
 + 87)

	)

81 
	#__NR_symlšk
 (
__X32_SYSCALL_BIT
 + 88)

	)

82 
	#__NR_»adlšk
 (
__X32_SYSCALL_BIT
 + 89)

	)

83 
	#__NR_chmod
 (
__X32_SYSCALL_BIT
 + 90)

	)

84 
	#__NR_fchmod
 (
__X32_SYSCALL_BIT
 + 91)

	)

85 
	#__NR_chown
 (
__X32_SYSCALL_BIT
 + 92)

	)

86 
	#__NR_fchown
 (
__X32_SYSCALL_BIT
 + 93)

	)

87 
	#__NR_lchown
 (
__X32_SYSCALL_BIT
 + 94)

	)

88 
	#__NR_umask
 (
__X32_SYSCALL_BIT
 + 95)

	)

89 
	#__NR_g‘timeofday
 (
__X32_SYSCALL_BIT
 + 96)

	)

90 
	#__NR_g‘¾im™
 (
__X32_SYSCALL_BIT
 + 97)

	)

91 
	#__NR_g‘ru§ge
 (
__X32_SYSCALL_BIT
 + 98)

	)

92 
	#__NR_sysšfo
 (
__X32_SYSCALL_BIT
 + 99)

	)

93 
	#__NR_times
 (
__X32_SYSCALL_BIT
 + 100)

	)

94 
	#__NR_g‘uid
 (
__X32_SYSCALL_BIT
 + 102)

	)

95 
	#__NR_sy¦og
 (
__X32_SYSCALL_BIT
 + 103)

	)

96 
	#__NR_g‘gid
 (
__X32_SYSCALL_BIT
 + 104)

	)

97 
	#__NR_£tuid
 (
__X32_SYSCALL_BIT
 + 105)

	)

98 
	#__NR_£tgid
 (
__X32_SYSCALL_BIT
 + 106)

	)

99 
	#__NR_g‘euid
 (
__X32_SYSCALL_BIT
 + 107)

	)

100 
	#__NR_g‘egid
 (
__X32_SYSCALL_BIT
 + 108)

	)

101 
	#__NR_£gid
 (
__X32_SYSCALL_BIT
 + 109)

	)

102 
	#__NR_g‘µid
 (
__X32_SYSCALL_BIT
 + 110)

	)

103 
	#__NR_g‘pg½
 (
__X32_SYSCALL_BIT
 + 111)

	)

104 
	#__NR_£tsid
 (
__X32_SYSCALL_BIT
 + 112)

	)

105 
	#__NR_£Œeuid
 (
__X32_SYSCALL_BIT
 + 113)

	)

106 
	#__NR_£Œegid
 (
__X32_SYSCALL_BIT
 + 114)

	)

107 
	#__NR_g‘groups
 (
__X32_SYSCALL_BIT
 + 115)

	)

108 
	#__NR_£tgroups
 (
__X32_SYSCALL_BIT
 + 116)

	)

109 
	#__NR_£Œesuid
 (
__X32_SYSCALL_BIT
 + 117)

	)

110 
	#__NR_g‘»suid
 (
__X32_SYSCALL_BIT
 + 118)

	)

111 
	#__NR_£Œesgid
 (
__X32_SYSCALL_BIT
 + 119)

	)

112 
	#__NR_g‘»sgid
 (
__X32_SYSCALL_BIT
 + 120)

	)

113 
	#__NR_g‘pgid
 (
__X32_SYSCALL_BIT
 + 121)

	)

114 
	#__NR_£tfsuid
 (
__X32_SYSCALL_BIT
 + 122)

	)

115 
	#__NR_£tfsgid
 (
__X32_SYSCALL_BIT
 + 123)

	)

116 
	#__NR_g‘sid
 (
__X32_SYSCALL_BIT
 + 124)

	)

117 
	#__NR_ÿpg‘
 (
__X32_SYSCALL_BIT
 + 125)

	)

118 
	#__NR_ÿp£t
 (
__X32_SYSCALL_BIT
 + 126)

	)

119 
	#__NR_¹_sigsu¥’d
 (
__X32_SYSCALL_BIT
 + 130)

	)

120 
	#__NR_utime
 (
__X32_SYSCALL_BIT
 + 132)

	)

121 
	#__NR_mknod
 (
__X32_SYSCALL_BIT
 + 133)

	)

122 
	#__NR_³rsÚ®™y
 (
__X32_SYSCALL_BIT
 + 135)

	)

123 
	#__NR_u¡©
 (
__X32_SYSCALL_BIT
 + 136)

	)

124 
	#__NR_¡©fs
 (
__X32_SYSCALL_BIT
 + 137)

	)

125 
	#__NR_f¡©fs
 (
__X32_SYSCALL_BIT
 + 138)

	)

126 
	#__NR_sysfs
 (
__X32_SYSCALL_BIT
 + 139)

	)

127 
	#__NR_g‘´iÜ™y
 (
__X32_SYSCALL_BIT
 + 140)

	)

128 
	#__NR_£riÜ™y
 (
__X32_SYSCALL_BIT
 + 141)

	)

129 
	#__NR_sched_£¬am
 (
__X32_SYSCALL_BIT
 + 142)

	)

130 
	#__NR_sched_g‘·¿m
 (
__X32_SYSCALL_BIT
 + 143)

	)

131 
	#__NR_sched_£tscheduËr
 (
__X32_SYSCALL_BIT
 + 144)

	)

132 
	#__NR_sched_g‘scheduËr
 (
__X32_SYSCALL_BIT
 + 145)

	)

133 
	#__NR_sched_g‘_´iÜ™y_max
 (
__X32_SYSCALL_BIT
 + 146)

	)

134 
	#__NR_sched_g‘_´iÜ™y_mš
 (
__X32_SYSCALL_BIT
 + 147)

	)

135 
	#__NR_sched_¼_g‘_š‹rv®
 (
__X32_SYSCALL_BIT
 + 148)

	)

136 
	#__NR_mlock
 (
__X32_SYSCALL_BIT
 + 149)

	)

137 
	#__NR_muÆock
 (
__X32_SYSCALL_BIT
 + 150)

	)

138 
	#__NR_mlock®l
 (
__X32_SYSCALL_BIT
 + 151)

	)

139 
	#__NR_muÆock®l
 (
__X32_SYSCALL_BIT
 + 152)

	)

140 
	#__NR_vhªgup
 (
__X32_SYSCALL_BIT
 + 153)

	)

141 
	#__NR_modify_ldt
 (
__X32_SYSCALL_BIT
 + 154)

	)

142 
	#__NR_pivÙ_roÙ
 (
__X32_SYSCALL_BIT
 + 155)

	)

143 
	#__NR_´ùl
 (
__X32_SYSCALL_BIT
 + 157)

	)

144 
	#__NR_¬ch_´ùl
 (
__X32_SYSCALL_BIT
 + 158)

	)

145 
	#__NR_adjtimex
 (
__X32_SYSCALL_BIT
 + 159)

	)

146 
	#__NR_£Œlim™
 (
__X32_SYSCALL_BIT
 + 160)

	)

147 
	#__NR_chroÙ
 (
__X32_SYSCALL_BIT
 + 161)

	)

148 
	#__NR_sync
 (
__X32_SYSCALL_BIT
 + 162)

	)

149 
	#__NR_acù
 (
__X32_SYSCALL_BIT
 + 163)

	)

150 
	#__NR_£‰imeofday
 (
__X32_SYSCALL_BIT
 + 164)

	)

151 
	#__NR_mouÁ
 (
__X32_SYSCALL_BIT
 + 165)

	)

152 
	#__NR_umouÁ2
 (
__X32_SYSCALL_BIT
 + 166)

	)

153 
	#__NR_sw­Ú
 (
__X32_SYSCALL_BIT
 + 167)

	)

154 
	#__NR_sw­off
 (
__X32_SYSCALL_BIT
 + 168)

	)

155 
	#__NR_»boÙ
 (
__X32_SYSCALL_BIT
 + 169)

	)

156 
	#__NR_£tho¡Çme
 (
__X32_SYSCALL_BIT
 + 170)

	)

157 
	#__NR_£tdomašÇme
 (
__X32_SYSCALL_BIT
 + 171)

	)

158 
	#__NR_iİl
 (
__X32_SYSCALL_BIT
 + 172)

	)

159 
	#__NR_iİ”m
 (
__X32_SYSCALL_BIT
 + 173)

	)

160 
	#__NR_š™_moduË
 (
__X32_SYSCALL_BIT
 + 175)

	)

161 
	#__NR_d–‘e_moduË
 (
__X32_SYSCALL_BIT
 + 176)

	)

162 
	#__NR_quÙaùl
 (
__X32_SYSCALL_BIT
 + 179)

	)

163 
	#__NR_g‘pmsg
 (
__X32_SYSCALL_BIT
 + 181)

	)

164 
	#__NR_pumsg
 (
__X32_SYSCALL_BIT
 + 182)

	)

165 
	#__NR_afs_sysÿÎ
 (
__X32_SYSCALL_BIT
 + 183)

	)

166 
	#__NR_tuxÿÎ
 (
__X32_SYSCALL_BIT
 + 184)

	)

167 
	#__NR_£cur™y
 (
__X32_SYSCALL_BIT
 + 185)

	)

168 
	#__NR_g‘tid
 (
__X32_SYSCALL_BIT
 + 186)

	)

169 
	#__NR_»adah—d
 (
__X32_SYSCALL_BIT
 + 187)

	)

170 
	#__NR_£tx©Œ
 (
__X32_SYSCALL_BIT
 + 188)

	)

171 
	#__NR_l£tx©Œ
 (
__X32_SYSCALL_BIT
 + 189)

	)

172 
	#__NR_f£tx©Œ
 (
__X32_SYSCALL_BIT
 + 190)

	)

173 
	#__NR_g‘x©Œ
 (
__X32_SYSCALL_BIT
 + 191)

	)

174 
	#__NR_lg‘x©Œ
 (
__X32_SYSCALL_BIT
 + 192)

	)

175 
	#__NR_fg‘x©Œ
 (
__X32_SYSCALL_BIT
 + 193)

	)

176 
	#__NR_li¡x©Œ
 (
__X32_SYSCALL_BIT
 + 194)

	)

177 
	#__NR_Îi¡x©Œ
 (
__X32_SYSCALL_BIT
 + 195)

	)

178 
	#__NR_æi¡x©Œ
 (
__X32_SYSCALL_BIT
 + 196)

	)

179 
	#__NR_»movex©Œ
 (
__X32_SYSCALL_BIT
 + 197)

	)

180 
	#__NR_Ìemovex©Œ
 (
__X32_SYSCALL_BIT
 + 198)

	)

181 
	#__NR_äemovex©Œ
 (
__X32_SYSCALL_BIT
 + 199)

	)

182 
	#__NR_tkl
 (
__X32_SYSCALL_BIT
 + 200)

	)

183 
	#__NR_time
 (
__X32_SYSCALL_BIT
 + 201)

	)

184 
	#__NR_fu‹x
 (
__X32_SYSCALL_BIT
 + 202)

	)

185 
	#__NR_sched_£ffš™y
 (
__X32_SYSCALL_BIT
 + 203)

	)

186 
	#__NR_sched_g‘affš™y
 (
__X32_SYSCALL_BIT
 + 204)

	)

187 
	#__NR_io_de¡roy
 (
__X32_SYSCALL_BIT
 + 207)

	)

188 
	#__NR_io_g‘ev’ts
 (
__X32_SYSCALL_BIT
 + 208)

	)

189 
	#__NR_io_ÿnûl
 (
__X32_SYSCALL_BIT
 + 210)

	)

190 
	#__NR_lookup_dcook›
 (
__X32_SYSCALL_BIT
 + 212)

	)

191 
	#__NR_•Şl_ü—‹
 (
__X32_SYSCALL_BIT
 + 213)

	)

192 
	#__NR_»m­_fe_·ges
 (
__X32_SYSCALL_BIT
 + 216)

	)

193 
	#__NR_g‘d’ts64
 (
__X32_SYSCALL_BIT
 + 217)

	)

194 
	#__NR_£t_tid_add»ss
 (
__X32_SYSCALL_BIT
 + 218)

	)

195 
	#__NR_»¡¬t_sysÿÎ
 (
__X32_SYSCALL_BIT
 + 219)

	)

196 
	#__NR_£mtimedİ
 (
__X32_SYSCALL_BIT
 + 220)

	)

197 
	#__NR_çdvi£64
 (
__X32_SYSCALL_BIT
 + 221)

	)

198 
	#__NR_tim”_£‰ime
 (
__X32_SYSCALL_BIT
 + 223)

	)

199 
	#__NR_tim”_g‘time
 (
__X32_SYSCALL_BIT
 + 224)

	)

200 
	#__NR_tim”_g‘ov”run
 (
__X32_SYSCALL_BIT
 + 225)

	)

201 
	#__NR_tim”_d–‘e
 (
__X32_SYSCALL_BIT
 + 226)

	)

202 
	#__NR_şock_£‰ime
 (
__X32_SYSCALL_BIT
 + 227)

	)

203 
	#__NR_şock_g‘time
 (
__X32_SYSCALL_BIT
 + 228)

	)

204 
	#__NR_şock_g‘»s
 (
__X32_SYSCALL_BIT
 + 229)

	)

205 
	#__NR_şock_Çno¦“p
 (
__X32_SYSCALL_BIT
 + 230)

	)

206 
	#__NR_ex™_group
 (
__X32_SYSCALL_BIT
 + 231)

	)

207 
	#__NR_•Şl_wa™
 (
__X32_SYSCALL_BIT
 + 232)

	)

208 
	#__NR_•Şl_ùl
 (
__X32_SYSCALL_BIT
 + 233)

	)

209 
	#__NR_tgkl
 (
__X32_SYSCALL_BIT
 + 234)

	)

210 
	#__NR_utimes
 (
__X32_SYSCALL_BIT
 + 235)

	)

211 
	#__NR_mbšd
 (
__X32_SYSCALL_BIT
 + 237)

	)

212 
	#__NR_£t_mempŞicy
 (
__X32_SYSCALL_BIT
 + 238)

	)

213 
	#__NR_g‘_mempŞicy
 (
__X32_SYSCALL_BIT
 + 239)

	)

214 
	#__NR_mq_İ’
 (
__X32_SYSCALL_BIT
 + 240)

	)

215 
	#__NR_mq_uÆšk
 (
__X32_SYSCALL_BIT
 + 241)

	)

216 
	#__NR_mq_timed£nd
 (
__X32_SYSCALL_BIT
 + 242)

	)

217 
	#__NR_mq_timed»ûive
 (
__X32_SYSCALL_BIT
 + 243)

	)

218 
	#__NR_mq_g‘£‰r
 (
__X32_SYSCALL_BIT
 + 245)

	)

219 
	#__NR_add_key
 (
__X32_SYSCALL_BIT
 + 248)

	)

220 
	#__NR_»que¡_key
 (
__X32_SYSCALL_BIT
 + 249)

	)

221 
	#__NR_keyùl
 (
__X32_SYSCALL_BIT
 + 250)

	)

222 
	#__NR_iİrio_£t
 (
__X32_SYSCALL_BIT
 + 251)

	)

223 
	#__NR_iİrio_g‘
 (
__X32_SYSCALL_BIT
 + 252)

	)

224 
	#__NR_šÙify_š™
 (
__X32_SYSCALL_BIT
 + 253)

	)

225 
	#__NR_šÙify_add_w©ch
 (
__X32_SYSCALL_BIT
 + 254)

	)

226 
	#__NR_šÙify_rm_w©ch
 (
__X32_SYSCALL_BIT
 + 255)

	)

227 
	#__NR_mig¿‹_·ges
 (
__X32_SYSCALL_BIT
 + 256)

	)

228 
	#__NR_İ’©
 (
__X32_SYSCALL_BIT
 + 257)

	)

229 
	#__NR_mkdœ©
 (
__X32_SYSCALL_BIT
 + 258)

	)

230 
	#__NR_mknod©
 (
__X32_SYSCALL_BIT
 + 259)

	)

231 
	#__NR_fchowÇt
 (
__X32_SYSCALL_BIT
 + 260)

	)

232 
	#__NR_futime§t
 (
__X32_SYSCALL_BIT
 + 261)

	)

233 
	#__NR_Ãwf¡©©
 (
__X32_SYSCALL_BIT
 + 262)

	)

234 
	#__NR_uÆšk©
 (
__X32_SYSCALL_BIT
 + 263)

	)

235 
	#__NR_»Çm—t
 (
__X32_SYSCALL_BIT
 + 264)

	)

236 
	#__NR_lšk©
 (
__X32_SYSCALL_BIT
 + 265)

	)

237 
	#__NR_symlšk©
 (
__X32_SYSCALL_BIT
 + 266)

	)

238 
	#__NR_»adlšk©
 (
__X32_SYSCALL_BIT
 + 267)

	)

239 
	#__NR_fchmod©
 (
__X32_SYSCALL_BIT
 + 268)

	)

240 
	#__NR_çcûs§t
 (
__X32_SYSCALL_BIT
 + 269)

	)

241 
	#__NR_p£Ëù6
 (
__X32_SYSCALL_BIT
 + 270)

	)

242 
	#__NR_µŞl
 (
__X32_SYSCALL_BIT
 + 271)

	)

243 
	#__NR_unsh¬e
 (
__X32_SYSCALL_BIT
 + 272)

	)

244 
	#__NR_¥liû
 (
__X32_SYSCALL_BIT
 + 275)

	)

245 
	#__NR_‹e
 (
__X32_SYSCALL_BIT
 + 276)

	)

246 
	#__NR_sync_fe_¿nge
 (
__X32_SYSCALL_BIT
 + 277)

	)

247 
	#__NR_utim’§t
 (
__X32_SYSCALL_BIT
 + 280)

	)

248 
	#__NR_•Şl_pwa™
 (
__X32_SYSCALL_BIT
 + 281)

	)

249 
	#__NR_sigÇlfd
 (
__X32_SYSCALL_BIT
 + 282)

	)

250 
	#__NR_tim”fd_ü—‹
 (
__X32_SYSCALL_BIT
 + 283)

	)

251 
	#__NR_ev’tfd
 (
__X32_SYSCALL_BIT
 + 284)

	)

252 
	#__NR_çÎoÿ‹
 (
__X32_SYSCALL_BIT
 + 285)

	)

253 
	#__NR_tim”fd_£‰ime
 (
__X32_SYSCALL_BIT
 + 286)

	)

254 
	#__NR_tim”fd_g‘time
 (
__X32_SYSCALL_BIT
 + 287)

	)

255 
	#__NR_acû±4
 (
__X32_SYSCALL_BIT
 + 288)

	)

256 
	#__NR_sigÇlfd4
 (
__X32_SYSCALL_BIT
 + 289)

	)

257 
	#__NR_ev’tfd2
 (
__X32_SYSCALL_BIT
 + 290)

	)

258 
	#__NR_•Şl_ü—‹1
 (
__X32_SYSCALL_BIT
 + 291)

	)

259 
	#__NR_dup3
 (
__X32_SYSCALL_BIT
 + 292)

	)

260 
	#__NR_pe2
 (
__X32_SYSCALL_BIT
 + 293)

	)

261 
	#__NR_šÙify_š™1
 (
__X32_SYSCALL_BIT
 + 294)

	)

262 
	#__NR_³rf_ev’t_İ’
 (
__X32_SYSCALL_BIT
 + 298)

	)

263 
	#__NR_çnÙify_š™
 (
__X32_SYSCALL_BIT
 + 300)

	)

264 
	#__NR_çnÙify_m¬k
 (
__X32_SYSCALL_BIT
 + 301)

	)

265 
	#__NR_´lim™64
 (
__X32_SYSCALL_BIT
 + 302)

	)

266 
	#__NR_Çme_to_hªdË_©
 (
__X32_SYSCALL_BIT
 + 303)

	)

267 
	#__NR_İ’_by_hªdË_©
 (
__X32_SYSCALL_BIT
 + 304)

	)

268 
	#__NR_şock_adjtime
 (
__X32_SYSCALL_BIT
 + 305)

	)

269 
	#__NR_syncfs
 (
__X32_SYSCALL_BIT
 + 306)

	)

270 
	#__NR_£Šs
 (
__X32_SYSCALL_BIT
 + 308)

	)

271 
	#__NR_g‘ıu
 (
__X32_SYSCALL_BIT
 + 309)

	)

272 
	#__NR_kcmp
 (
__X32_SYSCALL_BIT
 + 312)

	)

273 
	#__NR_fš™_moduË
 (
__X32_SYSCALL_BIT
 + 313)

	)

274 
	#__NR_sched_£‰r
 (
__X32_SYSCALL_BIT
 + 314)

	)

275 
	#__NR_sched_g‘©Œ
 (
__X32_SYSCALL_BIT
 + 315)

	)

276 
	#__NR_»Çm—t2
 (
__X32_SYSCALL_BIT
 + 316)

	)

277 
	#__NR_£ccomp
 (
__X32_SYSCALL_BIT
 + 317)

	)

278 
	#__NR_g‘¿ndom
 (
__X32_SYSCALL_BIT
 + 318)

	)

279 
	#__NR_memfd_ü—‹
 (
__X32_SYSCALL_BIT
 + 319)

	)

280 
	#__NR_kexec_fe_lßd
 (
__X32_SYSCALL_BIT
 + 320)

	)

281 
	#__NR_bpf
 (
__X32_SYSCALL_BIT
 + 321)

	)

282 
	#__NR_u£rçuÉfd
 (
__X32_SYSCALL_BIT
 + 323)

	)

283 
	#__NR_memb¬r›r
 (
__X32_SYSCALL_BIT
 + 324)

	)

284 
	#__NR_mlock2
 (
__X32_SYSCALL_BIT
 + 325)

	)

285 
	#__NR_cİy_fe_¿nge
 (
__X32_SYSCALL_BIT
 + 326)

	)

286 
	#__NR_pkey_m´Ùeù
 (
__X32_SYSCALL_BIT
 + 329)

	)

287 
	#__NR_pkey_®loc
 (
__X32_SYSCALL_BIT
 + 330)

	)

288 
	#__NR_pkey_ä“
 (
__X32_SYSCALL_BIT
 + 331)

	)

289 
	#__NR_¡©x
 (
__X32_SYSCALL_BIT
 + 332)

	)

290 
	#__NR_¹_sigaùiÚ
 (
__X32_SYSCALL_BIT
 + 512)

	)

291 
	#__NR_¹_sig»tuº
 (
__X32_SYSCALL_BIT
 + 513)

	)

292 
	#__NR_ioùl
 (
__X32_SYSCALL_BIT
 + 514)

	)

293 
	#__NR_»adv
 (
__X32_SYSCALL_BIT
 + 515)

	)

294 
	#__NR_wr™ev
 (
__X32_SYSCALL_BIT
 + 516)

	)

295 
	#__NR_»cväom
 (
__X32_SYSCALL_BIT
 + 517)

	)

296 
	#__NR_£ndmsg
 (
__X32_SYSCALL_BIT
 + 518)

	)

297 
	#__NR_»cvmsg
 (
__X32_SYSCALL_BIT
 + 519)

	)

298 
	#__NR_execve
 (
__X32_SYSCALL_BIT
 + 520)

	)

299 
	#__NR_±¿û
 (
__X32_SYSCALL_BIT
 + 521)

	)

300 
	#__NR_¹_sig³ndšg
 (
__X32_SYSCALL_BIT
 + 522)

	)

301 
	#__NR_¹_sigtimedwa™
 (
__X32_SYSCALL_BIT
 + 523)

	)

302 
	#__NR_¹_sigqueuešfo
 (
__X32_SYSCALL_BIT
 + 524)

	)

303 
	#__NR_sig®t¡ack
 (
__X32_SYSCALL_BIT
 + 525)

	)

304 
	#__NR_tim”_ü—‹
 (
__X32_SYSCALL_BIT
 + 526)

	)

305 
	#__NR_mq_nÙify
 (
__X32_SYSCALL_BIT
 + 527)

	)

306 
	#__NR_kexec_lßd
 (
__X32_SYSCALL_BIT
 + 528)

	)

307 
	#__NR_wa™id
 (
__X32_SYSCALL_BIT
 + 529)

	)

308 
	#__NR_£t_robu¡_li¡
 (
__X32_SYSCALL_BIT
 + 530)

	)

309 
	#__NR_g‘_robu¡_li¡
 (
__X32_SYSCALL_BIT
 + 531)

	)

310 
	#__NR_vm¥liû
 (
__X32_SYSCALL_BIT
 + 532)

	)

311 
	#__NR_move_·ges
 (
__X32_SYSCALL_BIT
 + 533)

	)

312 
	#__NR_´—dv
 (
__X32_SYSCALL_BIT
 + 534)

	)

313 
	#__NR_pwr™ev
 (
__X32_SYSCALL_BIT
 + 535)

	)

314 
	#__NR_¹_tgsigqueuešfo
 (
__X32_SYSCALL_BIT
 + 536)

	)

315 
	#__NR_»cvmmsg
 (
__X32_SYSCALL_BIT
 + 537)

	)

316 
	#__NR_£ndmmsg
 (
__X32_SYSCALL_BIT
 + 538)

	)

317 
	#__NR_´oûss_vm_»adv
 (
__X32_SYSCALL_BIT
 + 539)

	)

318 
	#__NR_´oûss_vm_wr™ev
 (
__X32_SYSCALL_BIT
 + 540)

	)

319 
	#__NR_£tsockİt
 (
__X32_SYSCALL_BIT
 + 541)

	)

320 
	#__NR_g‘sockİt
 (
__X32_SYSCALL_BIT
 + 542)

	)

321 
	#__NR_io_£tup
 (
__X32_SYSCALL_BIT
 + 543)

	)

322 
	#__NR_io_subm™
 (
__X32_SYSCALL_BIT
 + 544)

	)

323 
	#__NR_execv—t
 (
__X32_SYSCALL_BIT
 + 545)

	)

324 
	#__NR_´—dv2
 (
__X32_SYSCALL_BIT
 + 546)

	)

325 
	#__NR_pwr™ev2
 (
__X32_SYSCALL_BIT
 + 547)

	)

	@/usr/include/bits/_G_config.h

4 #iâdeà
_BITS_G_CONFIG_H


5 
	#_BITS_G_CONFIG_H
 1

	)

7 #ià!
defšed
 
_BITS_LIBIO_H
 && !defšed 
_G_CONFIG_H


13 
	~<b™s/ty³s.h
>

14 
	#__Ãed_size_t


	)

15 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


16 
	#__Ãed_wch¬_t


	)

18 
	#__Ãed_NULL


	)

19 
	~<¡ddef.h
>

21 
	~<b™s/ty³s/__mb¡©e_t.h
>

22 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


23 
	~<b™s/ty³s/wšt_t.h
>

28 
__off_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos_t
;

33 
__off64_t
 
	m__pos
;

34 
__mb¡©e_t
 
	m__¡©e
;

35 } 
	t_G_åos64_t
;

36 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


37 
	~<gcÚv.h
>

40 
__gcÚv_šfo
 
	m__cd
;

43 
__gcÚv_šfo
 
	m__cd
;

44 
__gcÚv_¡•_d©a
 
	m__d©a
;

45 } 
	m__combšed
;

46 } 
	t_G_icÚv_t
;

51 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

53 
	#_G_HAVE_MMAP
 1

	)

54 
	#_G_HAVE_MREMAP
 1

	)

56 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

59 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

61 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/bits/byteswap-16.h

19 #iâdeà
_BITS_BYTESWAP_H


23 #ifdeà
__GNUC__


24 #ià
__GNUC__
 >= 2

25 
	#__bsw­_16
(
x
) \

26 (
__ex‹nsiÚ__
 \

27 ({ 
__v
, 
__x
 = (è(
x
); \

28 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

29 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

31 
	`__asm__
 ("rorw $8, %w0" \

32 : "ô" (
__v
) \

33 : "0" (
__x
) \

35 
__v
; }))

	)

38 
	#__bsw­_16
(
x
) \

39 (
__ex‹nsiÚ__
 \

40 ({ 
__x
 = (è(
x
); \

41 
	`__bsw­_cÚ¡ªt_16
 (
__x
); }))

	)

44 
__šlše
 

45 
	$__bsw­_16
 (
__bsx
)

47  
	`__bsw­_cÚ¡ªt_16
 (
__bsx
);

48 
	}
}

	@/usr/include/bits/fcntl-linux.h

19 #iâdef 
_FCNTL_H


37 #ifdeà
__USE_GNU


38 
	~<b™s/ty³s/¡ruù_iovec.h
>

42 
	#O_ACCMODE
 0003

	)

43 
	#O_RDONLY
 00

	)

44 
	#O_WRONLY
 01

	)

45 
	#O_RDWR
 02

	)

46 #iâdeà
O_CREAT


47 
	#O_CREAT
 0100

	)

49 #iâdeà
O_EXCL


50 
	#O_EXCL
 0200

	)

52 #iâdeà
O_NOCTTY


53 
	#O_NOCTTY
 0400

	)

55 #iâdeà
O_TRUNC


56 
	#O_TRUNC
 01000

	)

58 #iâdeà
O_APPEND


59 
	#O_APPEND
 02000

	)

61 #iâdeà
O_NONBLOCK


62 
	#O_NONBLOCK
 04000

	)

64 #iâdeà
O_NDELAY


65 
	#O_NDELAY
 
O_NONBLOCK


	)

67 #iâdeà
O_SYNC


68 
	#O_SYNC
 04010000

	)

70 
	#O_FSYNC
 
O_SYNC


	)

71 #iâdeà
O_ASYNC


72 
	#O_ASYNC
 020000

	)

74 #iâdeà
__O_LARGEFILE


75 
	#__O_LARGEFILE
 0100000

	)

78 #iâdeà
__O_DIRECTORY


79 
	#__O_DIRECTORY
 0200000

	)

81 #iâdeà
__O_NOFOLLOW


82 
	#__O_NOFOLLOW
 0400000

	)

84 #iâdeà
__O_CLOEXEC


85 
	#__O_CLOEXEC
 02000000

	)

87 #iâdeà
__O_DIRECT


88 
	#__O_DIRECT
 040000

	)

90 #iâdeà
__O_NOATIME


91 
	#__O_NOATIME
 01000000

	)

93 #iâdeà
__O_PATH


94 
	#__O_PATH
 010000000

	)

96 #iâdeà
__O_DSYNC


97 
	#__O_DSYNC
 010000

	)

99 #iâdeà
__O_TMPFILE


100 
	#__O_TMPFILE
 (020000000 | 
__O_DIRECTORY
)

	)

103 #iâdeà
F_GETLK


104 #iâdeà
__USE_FILE_OFFSET64


105 
	#F_GETLK
 5

	)

106 
	#F_SETLK
 6

	)

107 
	#F_SETLKW
 7

	)

109 
	#F_GETLK
 
F_GETLK64


	)

110 
	#F_SETLK
 
F_SETLK64


	)

111 
	#F_SETLKW
 
F_SETLKW64


	)

114 #iâdeà
F_GETLK64


115 
	#F_GETLK64
 12

	)

116 
	#F_SETLK64
 13

	)

117 
	#F_SETLKW64
 14

	)

131 #ifdeà
__USE_GNU


132 
	#F_OFD_GETLK
 36

	)

133 
	#F_OFD_SETLK
 37

	)

134 
	#F_OFD_SETLKW
 38

	)

137 #ifdeà
__USE_LARGEFILE64


138 
	#O_LARGEFILE
 
__O_LARGEFILE


	)

141 #ifdeà
__USE_XOPEN2K8


142 
	#O_DIRECTORY
 
__O_DIRECTORY


	)

143 
	#O_NOFOLLOW
 
__O_NOFOLLOW


	)

144 
	#O_CLOEXEC
 
__O_CLOEXEC


	)

147 #ifdeà
__USE_GNU


148 
	#O_DIRECT
 
__O_DIRECT


	)

149 
	#O_NOATIME
 
__O_NOATIME


	)

150 
	#O_PATH
 
__O_PATH


	)

151 
	#O_TMPFILE
 
__O_TMPFILE


	)

157 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


158 
	#O_DSYNC
 
__O_DSYNC


	)

159 #ià
defšed
 
__O_RSYNC


160 
	#O_RSYNC
 
__O_RSYNC


	)

162 
	#O_RSYNC
 
O_SYNC


	)

167 
	#F_DUPFD
 0

	)

168 
	#F_GETFD
 1

	)

169 
	#F_SETFD
 2

	)

170 
	#F_GETFL
 3

	)

171 
	#F_SETFL
 4

	)

173 #iâdeà
__F_SETOWN


174 
	#__F_SETOWN
 8

	)

175 
	#__F_GETOWN
 9

	)

178 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


179 
	#F_SETOWN
 
__F_SETOWN


	)

180 
	#F_GETOWN
 
__F_GETOWN


	)

183 #iâdeà
__F_SETSIG


184 
	#__F_SETSIG
 10

	)

185 
	#__F_GETSIG
 11

	)

187 #iâdeà
__F_SETOWN_EX


188 
	#__F_SETOWN_EX
 15

	)

189 
	#__F_GETOWN_EX
 16

	)

192 #ifdeà
__USE_GNU


193 
	#F_SETSIG
 
__F_SETSIG


	)

194 
	#F_GETSIG
 
__F_GETSIG


	)

195 
	#F_SETOWN_EX
 
__F_SETOWN_EX


	)

196 
	#F_GETOWN_EX
 
__F_GETOWN_EX


	)

199 #ifdeà
__USE_GNU


200 
	#F_SETLEASE
 1024

	)

201 
	#F_GETLEASE
 1025

	)

202 
	#F_NOTIFY
 1026

	)

203 
	#F_SETPIPE_SZ
 1031

	)

204 
	#F_GETPIPE_SZ
 1032

	)

205 
	#F_ADD_SEALS
 1033

	)

206 
	#F_GET_SEALS
 1034

	)

208 
	#F_GET_RW_HINT
 1035

	)

209 
	#F_SET_RW_HINT
 1036

	)

210 
	#F_GET_FILE_RW_HINT
 1037

	)

211 
	#F_SET_FILE_RW_HINT
 1038

	)

213 #ifdeà
__USE_XOPEN2K8


214 
	#F_DUPFD_CLOEXEC
 1030

	)

219 
	#FD_CLOEXEC
 1

	)

221 #iâdeà
F_RDLCK


223 
	#F_RDLCK
 0

	)

224 
	#F_WRLCK
 1

	)

225 
	#F_UNLCK
 2

	)

230 #iâdeà
F_EXLCK


231 
	#F_EXLCK
 4

	)

232 
	#F_SHLCK
 8

	)

235 #ifdeà
__USE_MISC


237 
	#LOCK_SH
 1

	)

238 
	#LOCK_EX
 2

	)

239 
	#LOCK_NB
 4

	)

241 
	#LOCK_UN
 8

	)

244 #ifdeà
__USE_GNU


245 
	#LOCK_MAND
 32

	)

246 
	#LOCK_READ
 64

	)

247 
	#LOCK_WRITE
 128

	)

248 
	#LOCK_RW
 192

	)

251 #ifdeà
__USE_GNU


253 
	#DN_ACCESS
 0x00000001

	)

254 
	#DN_MODIFY
 0x00000002

	)

255 
	#DN_CREATE
 0x00000004

	)

256 
	#DN_DELETE
 0x00000008

	)

257 
	#DN_RENAME
 0x00000010

	)

258 
	#DN_ATTRIB
 0x00000020

	)

259 
	#DN_MULTISHOT
 0x80000000

	)

263 #ifdeà
__USE_GNU


265 
	e__pid_ty³


267 
	mF_OWNER_TID
 = 0,

268 
	mF_OWNER_PID
,

269 
	mF_OWNER_PGRP
,

270 
	mF_OWNER_GID
 = 
F_OWNER_PGRP


274 
	sf_owÃr_ex


276 
__pid_ty³
 
	mty³
;

277 
__pid_t
 
	mpid
;

281 #ifdeà
__USE_GNU


283 
	#F_SEAL_SEAL
 0x0001

	)

284 
	#F_SEAL_SHRINK
 0x0002

	)

285 
	#F_SEAL_GROW
 0x0004

	)

286 
	#F_SEAL_WRITE
 0x0008

	)

289 #ifdeà
__USE_GNU


291 
	#RWF_WRITE_LIFE_NOT_SET
 0

	)

292 
	#RWH_WRITE_LIFE_NONE
 1

	)

293 
	#RWH_WRITE_LIFE_SHORT
 2

	)

294 
	#RWH_WRITE_LIFE_MEDIUM
 3

	)

295 
	#RWH_WRITE_LIFE_LONG
 4

	)

296 
	#RWH_WRITE_LIFE_EXTREME
 5

	)

301 #ifdef 
__USE_MISC


302 
	#FAPPEND
 
O_APPEND


	)

303 
	#FFSYNC
 
O_FSYNC


	)

304 
	#FASYNC
 
O_ASYNC


	)

305 
	#FNONBLOCK
 
O_NONBLOCK


	)

306 
	#FNDELAY
 
O_NDELAY


	)

309 #iâdeà
__POSIX_FADV_DONTNEED


310 
	#__POSIX_FADV_DONTNEED
 4

	)

311 
	#__POSIX_FADV_NOREUSE
 5

	)

314 #ifdeà
__USE_XOPEN2K


315 
	#POSIX_FADV_NORMAL
 0

	)

316 
	#POSIX_FADV_RANDOM
 1

	)

317 
	#POSIX_FADV_SEQUENTIAL
 2

	)

318 
	#POSIX_FADV_WILLNEED
 3

	)

319 
	#POSIX_FADV_DONTNEED
 
__POSIX_FADV_DONTNEED


	)

320 
	#POSIX_FADV_NOREUSE
 
__POSIX_FADV_NOREUSE


	)

324 #ifdeà
__USE_GNU


326 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

329 
	#SYNC_FILE_RANGE_WRITE
 2

	)

332 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

337 
	#SPLICE_F_MOVE
 1

	)

338 
	#SPLICE_F_NONBLOCK
 2

	)

341 
	#SPLICE_F_MORE
 4

	)

342 
	#SPLICE_F_GIFT
 8

	)

346 
	~<lšux/çÎoc.h
>

350 
	sfe_hªdË


352 
	mhªdË_by‹s
;

353 
	mhªdË_ty³
;

355 
	mf_hªdË
[0];

359 
	#MAX_HANDLE_SZ
 128

	)

363 #ifdeà
__USE_ATFILE


364 
	#AT_FDCWD
 -100

	)

367 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

368 
	#AT_REMOVEDIR
 0x200

	)

370 
	#AT_SYMLINK_FOLLOW
 0x400

	)

371 #ifdeà
__USE_GNU


372 
	#AT_NO_AUTOMOUNT
 0x800

	)

374 
	#AT_EMPTY_PATH
 0x1000

	)

376 
	#AT_EACCESS
 0x200

	)

380 
	g__BEGIN_DECLS


382 #ifdeà
__USE_GNU


385 
__ssize_t
 
	$»adah—d
 (
__fd
, 
__off64_t
 
__off£t
, 
size_t
 
__couÁ
)

386 
__THROW
;

393 
	`sync_fe_¿nge
 (
__fd
, 
__off64_t
 
__off£t
, __off64_ˆ
__couÁ
,

394 
__æags
);

401 
__ssize_t
 
	`vm¥liû
 (
__fdout
, cÚ¡ 
iovec
 *
__iov
,

402 
size_t
 
__couÁ
, 
__æags
);

408 
__ssize_t
 
	`¥liû
 (
__fdš
, 
__off64_t
 *
__offš
, 
__fdout
,

409 
__off64_t
 *
__offout
, 
size_t
 
__Ën
,

410 
__æags
);

416 
__ssize_t
 
	`‹e
 (
__fdš
, 
__fdout
, 
size_t
 
__Ën
,

417 
__æags
);

423 #iâdeà
__USE_FILE_OFFSET64


424 
	`çÎoÿ‹
 (
__fd
, 
__mode
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
);

426 #ifdeà
__REDIRECT


427 
	`__REDIRECT
 (
çÎoÿ‹
, (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

428 
__off64_t
 
__Ën
),

429 
çÎoÿ‹64
);

431 
	#çÎoÿ‹
 
çÎoÿ‹64


	)

434 #ifdeà
__USE_LARGEFILE64


435 
	`çÎoÿ‹64
 (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

436 
__off64_t
 
__Ën
);

441 
	$Çme_to_hªdË_©
 (
__dfd
, cÚ¡ *
__Çme
,

442 
fe_hªdË
 *
__hªdË
, *
__mÁ_id
,

443 
__æags
è
__THROW
;

449 
	`İ’_by_hªdË_©
 (
__mouÁdœfd
, 
fe_hªdË
 *
__hªdË
,

450 
__æags
);

454 
__END_DECLS


	@/usr/include/bits/floatn-common.h

20 #iâdeà
_BITS_FLOATN_COMMON_H


21 
	#_BITS_FLOATN_COMMON_H


	)

23 
	~<ã©u»s.h
>

24 
	~<b™s/lÚg-doubË.h
>

34 
	#__HAVE_FLOAT16
 0

	)

35 
	#__HAVE_FLOAT32
 1

	)

36 
	#__HAVE_FLOAT64
 1

	)

37 
	#__HAVE_FLOAT32X
 1

	)

38 
	#__HAVE_FLOAT128X
 0

	)

52 
	#__HAVE_DISTINCT_FLOAT16
 
__HAVE_FLOAT16


	)

53 
	#__HAVE_DISTINCT_FLOAT32
 0

	)

54 
	#__HAVE_DISTINCT_FLOAT64
 0

	)

55 
	#__HAVE_DISTINCT_FLOAT32X
 0

	)

56 
	#__HAVE_DISTINCT_FLOAT64X
 0

	)

57 
	#__HAVE_DISTINCT_FLOAT128X
 
__HAVE_FLOAT128X


	)

62 #ià
__GNUC_PREREQ
 (7, 0è&& !
defšed
 
__ılu¥lus


63 
	#__HAVE_FLOATN_NOT_TYPEDEF
 1

	)

65 
	#__HAVE_FLOATN_NOT_TYPEDEF
 0

	)

68 #iâdeà
__ASSEMBLER__


73 #ià
__HAVE_FLOAT16


74 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


76 
	#__f16
(
x
è((
_Flßt16
èx##
f
)

	)

78 
	#__f16
(
x
èx##
f16


	)

82 #ià
__HAVE_FLOAT32


83 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


84 
	#__f32
(
x
èx##
f


	)

86 
	#__f32
(
x
èx##
f32


	)

90 #ià
__HAVE_FLOAT64


91 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


92 #ifdeà
__NO_LONG_DOUBLE_MATH


93 
	#__f64
(
x
èx##
l


	)

95 
	#__f64
(
x
è
	)
x

98 
	#__f64
(
x
èx##
f64


	)

102 #ià
__HAVE_FLOAT32X


103 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


104 
	#__f32x
(
x
è
	)
x

106 
	#__f32x
(
x
èx##
f32x


	)

110 #ià
__HAVE_FLOAT64X


111 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


112 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


113 
	#__f64x
(
x
èx##
l


	)

115 
	#__f64x
(
x
è
	`__f128
 (x)

	)

118 
	#__f64x
(
x
èx##
f64x


	)

122 #ià
__HAVE_FLOAT128X


123 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


126 
	#__f128x
(
x
èx##
f128x


	)

131 #ià
__HAVE_FLOAT16


132 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


133 
_Com¶ex
 
	t__cæßt16
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HC__
)));

134 
	#__CFLOAT16
 
__cæßt16


	)

136 
	#__CFLOAT16
 
_Com¶ex
 
_Flßt16


	)

140 #ià
__HAVE_FLOAT32


141 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


142 
	#__CFLOAT32
 
_Com¶ex
 

	)

144 
	#__CFLOAT32
 
_Com¶ex
 
_Flßt32


	)

148 #ià
__HAVE_FLOAT64


149 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


150 #ifdeà
__NO_LONG_DOUBLE_MATH


151 
	#__CFLOAT64
 
_Com¶ex
 

	)

153 
	#__CFLOAT64
 
_Com¶ex
 

	)

156 
	#__CFLOAT64
 
_Com¶ex
 
_Flßt64


	)

160 #ià
__HAVE_FLOAT32X


161 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


162 
	#__CFLOAT32X
 
_Com¶ex
 

	)

164 
	#__CFLOAT32X
 
_Com¶ex
 
_Flßt32x


	)

168 #ià
__HAVE_FLOAT64X


169 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


170 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


171 
	#__CFLOAT64X
 
_Com¶ex
 

	)

173 
	#__CFLOAT64X
 
__CFLOAT128


	)

176 
	#__CFLOAT64X
 
_Com¶ex
 
_Flßt64x


	)

180 #ià
__HAVE_FLOAT128X


181 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


184 
	#__CFLOAT128X
 
_Com¶ex
 
_Flßt128x


	)

189 #ià
__HAVE_FLOAT16


191 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


192 
	t_Flßt16
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HF__
)));

195 #ià!
__GNUC_PREREQ
 (7, 0)

196 
	#__butš_huge_v®f16
(è((
_Flßt16
è
	`__butš_huge_v®
 ())

	)

197 
	#__butš_šff16
(è((
_Flßt16
è
	`__butš_šf
 ())

	)

198 
	#__butš_Çnf16
(
x
è((
_Flßt16
è
	`__butš_Çn
 (x))

	)

199 
	#__butš_Çnsf16
(
x
è((
_Flßt16
è
	`__butš_Çns
 (x))

	)

204 #ià
__HAVE_FLOAT32


206 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


207 
	t_Flßt32
;

210 #ià!
__GNUC_PREREQ
 (7, 0)

211 
	#__butš_huge_v®f32
(è(
	`__butš_huge_v®f
 ())

	)

212 
	#__butš_šff32
(è(
	`__butš_šff
 ())

	)

213 
	#__butš_Çnf32
(
x
è(
	`__butš_Çnf
 (x))

	)

214 
	#__butš_Çnsf32
(
x
è(
	`__butš_Çnsf
 (x))

	)

219 #ià
__HAVE_FLOAT64


228 #ifdeà
__NO_LONG_DOUBLE_MATH


230 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


231 
	t_Flßt64
;

234 #ià!
__GNUC_PREREQ
 (7, 0)

235 
	#__butš_huge_v®f64
(è(
	`__butš_huge_v®l
 ())

	)

236 
	#__butš_šff64
(è(
	`__butš_šæ
 ())

	)

237 
	#__butš_Çnf64
(
x
è(
	`__butš_ÇÆ
 (x))

	)

238 
	#__butš_Çnsf64
(
x
è(
	`__butš_Çn¦
 (x))

	)

243 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


244 
	t_Flßt64
;

247 #ià!
__GNUC_PREREQ
 (7, 0)

248 
	#__butš_huge_v®f64
(è(
	`__butš_huge_v®
 ())

	)

249 
	#__butš_šff64
(è(
	`__butš_šf
 ())

	)

250 
	#__butš_Çnf64
(
x
è(
	`__butš_Çn
 (x))

	)

251 
	#__butš_Çnsf64
(
x
è(
	`__butš_Çns
 (x))

	)

258 #ià
__HAVE_FLOAT32X


260 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


261 
	t_Flßt32x
;

264 #ià!
__GNUC_PREREQ
 (7, 0)

265 
	#__butš_huge_v®f32x
(è(
	`__butš_huge_v®
 ())

	)

266 
	#__butš_šff32x
(è(
	`__butš_šf
 ())

	)

267 
	#__butš_Çnf32x
(
x
è(
	`__butš_Çn
 (x))

	)

268 
	#__butš_Çnsf32x
(
x
è(
	`__butš_Çns
 (x))

	)

273 #ià
__HAVE_FLOAT64X


275 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


277 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


278 
	t_Flßt64x
;

281 #ià!
__GNUC_PREREQ
 (7, 0)

282 
	#__butš_huge_v®f64x
(è(
	`__butš_huge_v®l
 ())

	)

283 
	#__butš_šff64x
(è(
	`__butš_šæ
 ())

	)

284 
	#__butš_Çnf64x
(
x
è(
	`__butš_ÇÆ
 (x))

	)

285 
	#__butš_Çnsf64x
(
x
è(
	`__butš_Çn¦
 (x))

	)

290 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


291 
_Flßt128
 
	t_Flßt64x
;

294 #ià!
__GNUC_PREREQ
 (7, 0)

295 
	#__butš_huge_v®f64x
(è(
	`__butš_huge_v®f128
 ())

	)

296 
	#__butš_šff64x
(è(
	`__butš_šff128
 ())

	)

297 
	#__butš_Çnf64x
(
x
è(
	`__butš_Çnf128
 (x))

	)

298 
	#__butš_Çnsf64x
(
x
è(
	`__butš_Çnsf128
 (x))

	)

305 #ià
__HAVE_FLOAT128X


307 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


311 #ià!
__GNUC_PREREQ
 (7, 0)

312 
	#__butš_huge_v®f128x
(è((
_Flßt128x
è
	`__butš_huge_v®
 ())

	)

313 
	#__butš_šff128x
(è((
_Flßt128x
è
	`__butš_šf
 ())

	)

314 
	#__butš_Çnf128x
(
x
è((
_Flßt128x
è
	`__butš_Çn
 (x))

	)

315 
	#__butš_Çnsf128x
(
x
è((
_Flßt128x
è
	`__butš_Çns
 (x))

	)

	@/usr/include/bits/getopt_core.h

20 #iâdeà
_GETOPT_CORE_H


21 
	#_GETOPT_CORE_H
 1

	)

28 
__BEGIN_DECLS


36 *
İrg
;

50 
İtšd
;

55 
İ‹¼
;

59 
İtİt
;

91 
	$g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

92 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

94 
__END_DECLS


	@/usr/include/bits/libio-ldbl.h

19 #iâdeà
_BITS_LIBIO_LDBL_H


20 
	#_BITS_LIBIO_LDBL_H
 1

	)

22 #iâdeà
_BITS_LIBIO_H


26 
	$__LDBL_REDIR_DECL
 (
_IO_vfsÿnf
)

27 
	$__LDBL_REDIR_DECL
 (
_IO_vårštf
)

	@/usr/include/bits/libm-simd-decl-stubs.h

19 #iâdeà
_MATH_H


33 #iâdeà
_BITS_LIBM_SIMD_DECL_STUBS_H


34 
	#_BITS_LIBM_SIMD_DECL_STUBS_H
 1

	)

36 
	#__DECL_SIMD_cos


	)

37 
	#__DECL_SIMD_cosf


	)

38 
	#__DECL_SIMD_co¦


	)

39 
	#__DECL_SIMD_cosf16


	)

40 
	#__DECL_SIMD_cosf32


	)

41 
	#__DECL_SIMD_cosf64


	)

42 
	#__DECL_SIMD_cosf128


	)

43 
	#__DECL_SIMD_cosf32x


	)

44 
	#__DECL_SIMD_cosf64x


	)

45 
	#__DECL_SIMD_cosf128x


	)

47 
	#__DECL_SIMD_sš


	)

48 
	#__DECL_SIMD_sšf


	)

49 
	#__DECL_SIMD_sšl


	)

50 
	#__DECL_SIMD_sšf16


	)

51 
	#__DECL_SIMD_sšf32


	)

52 
	#__DECL_SIMD_sšf64


	)

53 
	#__DECL_SIMD_sšf128


	)

54 
	#__DECL_SIMD_sšf32x


	)

55 
	#__DECL_SIMD_sšf64x


	)

56 
	#__DECL_SIMD_sšf128x


	)

58 
	#__DECL_SIMD_sšcos


	)

59 
	#__DECL_SIMD_sšcosf


	)

60 
	#__DECL_SIMD_sšco¦


	)

61 
	#__DECL_SIMD_sšcosf16


	)

62 
	#__DECL_SIMD_sšcosf32


	)

63 
	#__DECL_SIMD_sšcosf64


	)

64 
	#__DECL_SIMD_sšcosf128


	)

65 
	#__DECL_SIMD_sšcosf32x


	)

66 
	#__DECL_SIMD_sšcosf64x


	)

67 
	#__DECL_SIMD_sšcosf128x


	)

69 
	#__DECL_SIMD_log


	)

70 
	#__DECL_SIMD_logf


	)

71 
	#__DECL_SIMD_logl


	)

72 
	#__DECL_SIMD_logf16


	)

73 
	#__DECL_SIMD_logf32


	)

74 
	#__DECL_SIMD_logf64


	)

75 
	#__DECL_SIMD_logf128


	)

76 
	#__DECL_SIMD_logf32x


	)

77 
	#__DECL_SIMD_logf64x


	)

78 
	#__DECL_SIMD_logf128x


	)

80 
	#__DECL_SIMD_exp


	)

81 
	#__DECL_SIMD_expf


	)

82 
	#__DECL_SIMD_ex¶


	)

83 
	#__DECL_SIMD_expf16


	)

84 
	#__DECL_SIMD_expf32


	)

85 
	#__DECL_SIMD_expf64


	)

86 
	#__DECL_SIMD_expf128


	)

87 
	#__DECL_SIMD_expf32x


	)

88 
	#__DECL_SIMD_expf64x


	)

89 
	#__DECL_SIMD_expf128x


	)

91 
	#__DECL_SIMD_pow


	)

92 
	#__DECL_SIMD_powf


	)

93 
	#__DECL_SIMD_powl


	)

94 
	#__DECL_SIMD_powf16


	)

95 
	#__DECL_SIMD_powf32


	)

96 
	#__DECL_SIMD_powf64


	)

97 
	#__DECL_SIMD_powf128


	)

98 
	#__DECL_SIMD_powf32x


	)

99 
	#__DECL_SIMD_powf64x


	)

100 
	#__DECL_SIMD_powf128x


	)

	@/usr/include/bits/local_lim.h

24 #iâdeà
NR_OPEN


25 
	#__undef_NR_OPEN


	)

27 #iâdeà
LINK_MAX


28 
	#__undef_LINK_MAX


	)

30 #iâdeà
OPEN_MAX


31 
	#__undef_OPEN_MAX


	)

33 #iâdeà
ARG_MAX


34 
	#__undef_ARG_MAX


	)

38 
	~<lšux/lim™s.h
>

41 #ifdeà
__undef_NR_OPEN


42 #undeà
NR_OPEN


43 #undeà
__undef_NR_OPEN


46 #ifdeà
__undef_LINK_MAX


47 #undeà
LINK_MAX


48 #undeà
__undef_LINK_MAX


51 #ifdeà
__undef_OPEN_MAX


52 #undeà
OPEN_MAX


53 #undeà
__undef_OPEN_MAX


56 #ifdeà
__undef_ARG_MAX


57 #undeà
ARG_MAX


58 #undeà
__undef_ARG_MAX


62 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

64 
	#PTHREAD_KEYS_MAX
 1024

	)

67 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

69 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

72 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

74 #undeà
PTHREAD_THREADS_MAX


78 
	#AIO_PRIO_DELTA_MAX
 20

	)

81 
	#PTHREAD_STACK_MIN
 16384

	)

84 
	#DELAYTIMER_MAX
 2147483647

	)

87 
	#TTY_NAME_MAX
 32

	)

90 
	#LOGIN_NAME_MAX
 256

	)

93 
	#HOST_NAME_MAX
 64

	)

96 
	#MQ_PRIO_MAX
 32768

	)

99 
	#SEM_VALUE_MAX
 (2147483647)

	)

	@/usr/include/bits/long-double.h

	@/usr/include/bits/mman-linux.h

19 #iâdeà
_SYS_MMAN_H


32 
	#PROT_READ
 0x1

	)

33 
	#PROT_WRITE
 0x2

	)

34 
	#PROT_EXEC
 0x4

	)

35 
	#PROT_NONE
 0x0

	)

36 
	#PROT_GROWSDOWN
 0x01000000

	)

38 
	#PROT_GROWSUP
 0x02000000

	)

42 
	#MAP_SHARED
 0x01

	)

43 
	#MAP_PRIVATE
 0x02

	)

44 #ifdeà
__USE_MISC


45 
	#MAP_TYPE
 0x0à

	)

49 
	#MAP_FIXED
 0x10

	)

50 #ifdeà
__USE_MISC


51 
	#MAP_FILE
 0

	)

52 #ifdeà
__MAP_ANONYMOUS


53 
	#MAP_ANONYMOUS
 
__MAP_ANONYMOUS


	)

55 
	#MAP_ANONYMOUS
 0x20

	)

57 
	#MAP_ANON
 
MAP_ANONYMOUS


	)

59 
	#MAP_HUGE_SHIFT
 26

	)

60 
	#MAP_HUGE_MASK
 0x3f

	)

64 
	#MS_ASYNC
 1

	)

65 
	#MS_SYNC
 4

	)

66 
	#MS_INVALIDATE
 2

	)

69 #ifdeà
__USE_GNU


70 
	#MREMAP_MAYMOVE
 1

	)

71 
	#MREMAP_FIXED
 2

	)

75 #ifdeà
__USE_MISC


76 
	#MADV_NORMAL
 0

	)

77 
	#MADV_RANDOM
 1

	)

78 
	#MADV_SEQUENTIAL
 2

	)

79 
	#MADV_WILLNEED
 3

	)

80 
	#MADV_DONTNEED
 4

	)

81 
	#MADV_FREE
 8

	)

82 
	#MADV_REMOVE
 9

	)

83 
	#MADV_DONTFORK
 10

	)

84 
	#MADV_DOFORK
 11

	)

85 
	#MADV_MERGEABLE
 12

	)

86 
	#MADV_UNMERGEABLE
 13

	)

87 
	#MADV_HUGEPAGE
 14

	)

88 
	#MADV_NOHUGEPAGE
 15

	)

89 
	#MADV_DONTDUMP
 16

	)

91 
	#MADV_DODUMP
 17

	)

92 
	#MADV_WIPEONFORK
 18

	)

93 
	#MADV_KEEPONFORK
 19

	)

94 
	#MADV_HWPOISON
 100

	)

98 #ifdeà
__USE_XOPEN2K


99 
	#POSIX_MADV_NORMAL
 0

	)

100 
	#POSIX_MADV_RANDOM
 1

	)

101 
	#POSIX_MADV_SEQUENTIAL
 2

	)

102 
	#POSIX_MADV_WILLNEED
 3

	)

103 
	#POSIX_MADV_DONTNEED
 4

	)

107 #iâdeà
MCL_CURRENT


108 
	#MCL_CURRENT
 1

	)

109 
	#MCL_FUTURE
 2

	)

111 
	#MCL_ONFAULT
 4

	)

115 
	~<b™s/mmª-sh¬ed.h
>

	@/usr/include/bits/poll.h

18 #iâdeà
_SYS_POLL_H


25 
	#POLLIN
 0x001

	)

26 
	#POLLPRI
 0x002

	)

27 
	#POLLOUT
 0x004

	)

29 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


31 
	#POLLRDNORM
 0x040

	)

32 
	#POLLRDBAND
 0x080

	)

33 
	#POLLWRNORM
 0x100

	)

34 
	#POLLWRBAND
 0x200

	)

37 #ifdeà
__USE_GNU


39 
	#POLLMSG
 0x400

	)

40 
	#POLLREMOVE
 0x1000

	)

41 
	#POLLRDHUP
 0x2000

	)

47 
	#POLLERR
 0x008

	)

48 
	#POLLHUP
 0x010

	)

49 
	#POLLNVAL
 0x020

	)

	@/usr/include/bits/poll2.h

19 #iâdeà
_SYS_POLL_H


24 
__BEGIN_DECLS


26 
__REDIRECT
 (
__pŞl_®Ÿs
, (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
,

27 
__timeout
), 
pŞl
);

28 
__pŞl_chk
 (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
, 
__timeout
,

29 
__SIZE_TYPE__
 
__fd¦’
);

30 
__REDIRECT
 (
__pŞl_chk_w¬n
, (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
,

31 
__timeout
, 
__SIZE_TYPE__
 
__fd¦’
),

32 
__pŞl_chk
)

33 
__w¬Ç‰r
 ("poll called with fds bufferoo small file‚fdsƒntries");

35 
__fÜtify_funùiÚ
 

36 
	$pŞl
 (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
, 
__timeout
)

38 ià(
	`__bos
 (
__fds
è!ğ(
__SIZE_TYPE__
) -1)

40 ià(! 
	`__butš_cÚ¡ªt_p
 (
__nfds
))

41  
	`__pŞl_chk
 (
__fds
, 
__nfds
, 
__timeout
, 
	`__bos
 (__fds));

42 ià(
	`__bos
 (
__fds
è/  (*__fdsè< 
__nfds
)

43  
	`__pŞl_chk_w¬n
 (
__fds
, 
__nfds
, 
__timeout
, 
	`__bos
 (__fds));

46  
	`__pŞl_®Ÿs
 (
__fds
, 
__nfds
, 
__timeout
);

47 
	}
}

50 #ifdeà
__USE_GNU


51 
__REDIRECT
 (
__µŞl_®Ÿs
, (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
,

52 cÚ¡ 
time¥ec
 *
__timeout
,

53 cÚ¡ 
__sig£t_t
 *
__ss
), 
µŞl
);

54 
__µŞl_chk
 (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
,

55 cÚ¡ 
time¥ec
 *
__timeout
,

56 cÚ¡ 
__sig£t_t
 *
__ss
, 
__SIZE_TYPE__
 
__fd¦’
);

57 
__REDIRECT
 (
__µŞl_chk_w¬n
, (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
,

58 cÚ¡ 
time¥ec
 *
__timeout
,

59 cÚ¡ 
__sig£t_t
 *
__ss
,

60 
__SIZE_TYPE__
 
__fd¦’
),

61 
__µŞl_chk
)

62 
__w¬Ç‰r
 ("ppoll called with fds bufferoo small file‚fdsƒntries");

64 
__fÜtify_funùiÚ
 

65 
	$µŞl
 (
pŞlfd
 *
__fds
, 
nfds_t
 
__nfds
, cÚ¡ 
time¥ec
 *
__timeout
,

66 cÚ¡ 
__sig£t_t
 *
__ss
)

68 ià(
	`__bos
 (
__fds
è!ğ(
__SIZE_TYPE__
) -1)

70 ià(! 
	`__butš_cÚ¡ªt_p
 (
__nfds
))

71  
	`__µŞl_chk
 (
__fds
, 
__nfds
, 
__timeout
, 
__ss
, 
	`__bos
 (__fds));

72 ià(
	`__bos
 (
__fds
è/  (*__fdsè< 
__nfds
)

73  
	`__µŞl_chk_w¬n
 (
__fds
, 
__nfds
, 
__timeout
, 
__ss
,

74 
	`__bos
 (
__fds
));

77  
	`__µŞl_®Ÿs
 (
__fds
, 
__nfds
, 
__timeout
, 
__ss
);

78 
	}
}

81 
	g__END_DECLS


	@/usr/include/bits/siginfo-arch.h

2 #iâdeà
_BITS_SIGINFO_ARCH_H


3 
	#_BITS_SIGINFO_ARCH_H
 1

	)

5 #ià
defšed
 
__x86_64__
 && 
__WORDSIZE
 == 32

12 
__şock_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
 (4))è
	t__sigchld_şock_t
;

13 
	#__SI_ALIGNMENT
 
	`__©Œibu‹__
 ((
	`__®igÃd__
 (8)))

	)

14 
	#__SI_CLOCK_T
 
__sigchld_şock_t


	)

	@/usr/include/bits/siginfo-consts-arch.h

2 #iâdeà
_BITS_SIGINFO_CONSTS_ARCH_H


3 
	#_BITS_SIGINFO_CONSTS_ARCH_H
 1

	)

	@/usr/include/bits/signum-generic.h

19 #iâdef 
_BITS_SIGNUM_GENERIC_H


20 
	#_BITS_SIGNUM_GENERIC_H
 1

	)

22 #iâdeà
_SIGNAL_H


28 
	#SIG_ERR
 ((
__sighªdËr_t
è-1è

	)

29 
	#SIG_DFL
 ((
__sighªdËr_t
è0è

	)

30 
	#SIG_IGN
 ((
__sighªdËr_t
è1è

	)

32 #ifdeà
__USE_XOPEN


33 
	#SIG_HOLD
 ((
__sighªdËr_t
è2è

	)

48 
	#SIGINT
 2

	)

49 
	#SIGILL
 4

	)

50 
	#SIGABRT
 6

	)

51 
	#SIGFPE
 8

	)

52 
	#SIGSEGV
 11

	)

53 
	#SIGTERM
 15

	)

56 
	#SIGHUP
 1

	)

57 
	#SIGQUIT
 3

	)

58 
	#SIGTRAP
 5

	)

59 
	#SIGKILL
 9

	)

60 
	#SIGBUS
 10

	)

61 
	#SIGSYS
 12

	)

62 
	#SIGPIPE
 13

	)

63 
	#SIGALRM
 14

	)

66 
	#SIGURG
 16

	)

67 
	#SIGSTOP
 17

	)

68 
	#SIGTSTP
 18

	)

69 
	#SIGCONT
 19

	)

70 
	#SIGCHLD
 20

	)

71 
	#SIGTTIN
 21

	)

72 
	#SIGTTOU
 22

	)

73 
	#SIGPOLL
 23

	)

74 
	#SIGXCPU
 24

	)

75 
	#SIGXFSZ
 25

	)

76 
	#SIGVTALRM
 26

	)

77 
	#SIGPROF
 27

	)

78 
	#SIGUSR1
 30

	)

79 
	#SIGUSR2
 31

	)

83 
	#SIGWINCH
 28

	)

86 
	#SIGIO
 
SIGPOLL


	)

87 
	#SIGIOT
 
SIGABRT


	)

88 
	#SIGCLD
 
SIGCHLD


	)

96 
	#__SIGRTMIN
 32

	)

97 
	#__SIGRTMAX
 
__SIGRTMIN


	)

100 
	#_NSIG
 (
__SIGRTMAX
 + 1)

	)

	@/usr/include/bits/socket_type.h

19 #iâdeà
_SYS_SOCKET_H


24 
	e__sock‘_ty³


26 
	mSOCK_STREAM
 = 1,

28 
	#SOCK_STREAM
 
SOCK_STREAM


	)

29 
	mSOCK_DGRAM
 = 2,

31 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

32 
	mSOCK_RAW
 = 3,

33 
	#SOCK_RAW
 
SOCK_RAW


	)

34 
	mSOCK_RDM
 = 4,

35 
	#SOCK_RDM
 
SOCK_RDM


	)

36 
	mSOCK_SEQPACKET
 = 5,

38 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

39 
	mSOCK_DCCP
 = 6,

40 
	#SOCK_DCCP
 
SOCK_DCCP


	)

41 
	mSOCK_PACKET
 = 10,

44 
	#SOCK_PACKET
 
SOCK_PACKET


	)

49 
	mSOCK_CLOEXEC
 = 02000000,

51 
	#SOCK_CLOEXEC
 
SOCK_CLOEXEC


	)

52 
	mSOCK_NONBLOCK
 = 00004000

54 
	#SOCK_NONBLOCK
 
SOCK_NONBLOCK


	)

	@/usr/include/bits/syslog-ldbl.h

19 #iâdeà
_SYS_SYSLOG_H


23 
	$__LDBL_REDIR_DECL
 (
sy¦og
)

25 #ifdeà
__USE_MISC


26 
	$__LDBL_REDIR_DECL
 (
vsy¦og
)

29 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


30 
	$__LDBL_REDIR_DECL
 (
__sy¦og_chk
)

32 #ifdeà
__USE_MISC


33 
	$__LDBL_REDIR_DECL
 (
__vsy¦og_chk
)

	@/usr/include/bits/syslog-path.h

19 #iâdeà
_SYS_SYSLOG_H


23 #iâdeà
_BITS_SYSLOG_PATH_H


24 
	#_BITS_SYSLOG_PATH_H
 1

	)

26 
	#_PATH_LOG
 "/dev/log"

	)

	@/usr/include/bits/syslog.h

19 #iâdeà
_SYS_SYSLOG_H


24 
	$__sy¦og_chk
 (
__´i
, 
__æag
, cÚ¡ *
__fmt
, ...)

25 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

27 #ifdeà
__va_¬g_·ck


28 
__fÜtify_funùiÚ
 

29 
	$sy¦og
 (
__´i
, cÚ¡ *
__fmt
, ...)

31 
	`__sy¦og_chk
 (
__´i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

32 
	}
}

33 #–ià!
defšed
 
__ılu¥lus


34 
	#sy¦og
(
´i
, ...) \

35 
	`__sy¦og_chk
 (
´i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

39 #ifdeà
__USE_MISC


40 
	$__vsy¦og_chk
 (
__´i
, 
__æag
, cÚ¡ *
__fmt
,

41 
__gnuc_va_li¡
 
__­
)

42 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

44 
__fÜtify_funùiÚ
 

45 
	$vsy¦og
 (
__´i
, cÚ¡ *
__fmt
, 
__gnuc_va_li¡
 
__­
)

47 
	`__vsy¦og_chk
 (
__´i
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

48 
	}
}

	@/usr/include/bits/sysmacros.h

19 #iâdeà
_BITS_SYSMACROS_H


20 
	#_BITS_SYSMACROS_H
 1

	)

22 #iâdeà
_SYS_SYSMACROS_H


36 
	#__SYSMACROS_DECLARE_MAJOR
(
DECL_TEMPL
) \

37 
	`DECL_TEMPL
(, 
majÜ
, (
__dev_t
 
__dev
))

	)

39 
	#__SYSMACROS_DEFINE_MAJOR
(
DECL_TEMPL
) \

40 
	`__SYSMACROS_DECLARE_MAJOR
 (
DECL_TEMPL
) \

42 
__majÜ
; \

43 
__majÜ
 = ((
__dev
 & (
__dev_t
) 0x00000000000fff00u) >> 8); \

44 
__majÜ
 |ğ((
__dev
 & (
__dev_t
) 0xfffff00000000000u) >> 32); \

45  
__majÜ
; \

46 }

	)

48 
	#__SYSMACROS_DECLARE_MINOR
(
DECL_TEMPL
) \

49 
	`DECL_TEMPL
(, 
mšÜ
, (
__dev_t
 
__dev
))

	)

51 
	#__SYSMACROS_DEFINE_MINOR
(
DECL_TEMPL
) \

52 
	`__SYSMACROS_DECLARE_MINOR
 (
DECL_TEMPL
) \

54 
__mšÜ
; \

55 
__mšÜ
 = ((
__dev
 & (
__dev_t
) 0x00000000000000ffu) >> 0); \

56 
__mšÜ
 |ğ((
__dev
 & (
__dev_t
) 0x00000ffffff00000u) >> 12); \

57  
__mšÜ
; \

58 }

	)

60 
	#__SYSMACROS_DECLARE_MAKEDEV
(
DECL_TEMPL
) \

61 
	`DECL_TEMPL
(
__dev_t
, 
makedev
, (
__majÜ
, 
__mšÜ
))

	)

63 
	#__SYSMACROS_DEFINE_MAKEDEV
(
DECL_TEMPL
) \

64 
	`__SYSMACROS_DECLARE_MAKEDEV
 (
DECL_TEMPL
) \

66 
__dev_t
 
__dev
; \

67 
__dev
 = (((
__dev_t
è(
__majÜ
 & 0x00000fffu)) << 8); \

68 
__dev
 |ğ(((
__dev_t
è(
__majÜ
 & 0xfffff000u)) << 32); \

69 
__dev
 |ğ(((
__dev_t
è(
__mšÜ
 & 0x000000ffu)) << 0); \

70 
__dev
 |ğ(((
__dev_t
è(
__mšÜ
 & 0xffffff00u)) << 12); \

71  
__dev
; \

72 }

	)

	@/usr/include/bits/thread-shared-types.h

19 #iâdeà
_THREAD_SHARED_TYPES_H


20 
	#_THREAD_SHARED_TYPES_H
 1

	)

77 
	~<b™s/±h»adty³s-¬ch.h
>

81 #ià!
__PTHREAD_MUTEX_USE_UNION


82 
	s__±h»ad_š‹º®_li¡


84 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

85 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

86 } 
	t__±h»ad_li¡_t
;

88 
	s__±h»ad_š‹º®_¦i¡


90 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

91 } 
	t__±h»ad_¦i¡_t
;

95 #ià
__PTHREAD_MUTEX_LOCK_ELISION


96 #ià!
__PTHREAD_MUTEX_USE_UNION


97 
	#__PTHREAD_SPINS_DATA
 \

98 
__¥šs
; \

99 
__–isiÚ


	)

100 
	#__PTHREAD_SPINS
 0, 0

	)

102 
	#__PTHREAD_SPINS_DATA
 \

105 
__e¥šs
; \

106 
__“lisiÚ
; \

107 } 
__–isiÚ_d©a


	)

108 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

109 
	#__¥šs
 
__–isiÚ_d©a
.
__e¥šs


	)

110 
	#__–isiÚ
 
__–isiÚ_d©a
.
__“lisiÚ


	)

113 
	#__PTHREAD_SPINS_DATA
 
__¥šs


	)

115 
	#__PTHREAD_SPINS
 0

	)

118 
	s__±h»ad_mu‹x_s


120 
__lock
 
	m__LOCK_ALIGNMENT
;

121 
	m__couÁ
;

122 
	m__owÃr
;

123 #ià!
__PTHREAD_MUTEX_NUSERS_AFTER_KIND


124 
	m__nu£rs
;

148 
	m__kšd
;

149 
	m__PTHREAD_COMPAT_PADDING_MID


150 #ià
__PTHREAD_MUTEX_NUSERS_AFTER_KIND


151 
	m__nu£rs
;

153 #ià!
__PTHREAD_MUTEX_USE_UNION


154 
	m__PTHREAD_SPINS_DATA
;

155 
__±h»ad_li¡_t
 
	m__li¡
;

156 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

158 
__ex‹nsiÚ__
 union

160 
	m__PTHREAD_SPINS_DATA
;

161 
__±h»ad_¦i¡_t
 
	m__li¡
;

163 
	#__PTHREAD_MUTEX_HAVE_PREV
 0

	)

165 
	m__PTHREAD_COMPAT_PADDING_END


171 
	s__±h»ad_cÚd_s


173 
__ex‹nsiÚ__
 union

175 
__ex‹nsiÚ__
 
	m__w£q
;

178 
	m__low
;

179 
	m__high
;

180 } 
	m__w£q32
;

182 
__ex‹nsiÚ__
 union

184 
__ex‹nsiÚ__
 
	m__g1_¡¬t
;

187 
	m__low
;

188 
	m__high
;

189 } 
	m__g1_¡¬t32
;

191 
	m__g_»fs
[2] 
	m__LOCK_ALIGNMENT
;

192 
	m__g_size
[2];

193 
	m__g1_Üig_size
;

194 
	m__w»fs
;

195 
	m__g_sigÇls
[2];

	@/usr/include/bits/timex.h

18 #iâdef 
_BITS_TIMEX_H


19 
	#_BITS_TIMEX_H
 1

	)

21 
	~<b™s/ty³s.h
>

22 
	~<b™s/ty³s/¡ruù_timev®.h
>

26 
	stimex


28 
	mmodes
;

29 
__sysÿÎ_¦Úg_t
 
	moff£t
;

30 
__sysÿÎ_¦Úg_t
 
	mäeq
;

31 
__sysÿÎ_¦Úg_t
 
	mmax”rÜ
;

32 
__sysÿÎ_¦Úg_t
 
	me¡”rÜ
;

33 
	m¡©us
;

34 
__sysÿÎ_¦Úg_t
 
	mcÚ¡ªt
;

35 
__sysÿÎ_¦Úg_t
 
	m´ecisiÚ
;

36 
__sysÿÎ_¦Úg_t
 
	mtŞ”ªû
;

37 
timev®
 
	mtime
;

38 
__sysÿÎ_¦Úg_t
 
	mtick
;

39 
__sysÿÎ_¦Úg_t
 
	mµsäeq
;

40 
__sysÿÎ_¦Úg_t
 
	mj™‹r
;

41 
	mshiá
;

42 
__sysÿÎ_¦Úg_t
 
	m¡ab
;

43 
__sysÿÎ_¦Úg_t
 
	mj™út
;

44 
__sysÿÎ_¦Úg_t
 
	mÿlút
;

45 
__sysÿÎ_¦Úg_t
 
	m”rút
;

46 
__sysÿÎ_¦Úg_t
 
	m¡bút
;

48 
	mi
;

57 
	#ADJ_OFFSET
 0x0001

	)

58 
	#ADJ_FREQUENCY
 0x0002

	)

59 
	#ADJ_MAXERROR
 0x0004

	)

60 
	#ADJ_ESTERROR
 0x0008

	)

61 
	#ADJ_STATUS
 0x0010

	)

62 
	#ADJ_TIMECONST
 0x0020

	)

63 
	#ADJ_TAI
 0x0080

	)

64 
	#ADJ_SETOFFSET
 0x0100

	)

65 
	#ADJ_MICRO
 0x1000

	)

66 
	#ADJ_NANO
 0x2000

	)

67 
	#ADJ_TICK
 0x4000

	)

68 
	#ADJ_OFFSET_SINGLESHOT
 0x8001

	)

69 
	#ADJ_OFFSET_SS_READ
 0xa001

	)

72 
	#MOD_OFFSET
 
ADJ_OFFSET


	)

73 
	#MOD_FREQUENCY
 
ADJ_FREQUENCY


	)

74 
	#MOD_MAXERROR
 
ADJ_MAXERROR


	)

75 
	#MOD_ESTERROR
 
ADJ_ESTERROR


	)

76 
	#MOD_STATUS
 
ADJ_STATUS


	)

77 
	#MOD_TIMECONST
 
ADJ_TIMECONST


	)

78 
	#MOD_CLKB
 
ADJ_TICK


	)

79 
	#MOD_CLKA
 
ADJ_OFFSET_SINGLESHOT


	)

80 
	#MOD_TAI
 
ADJ_TAI


	)

81 
	#MOD_MICRO
 
ADJ_MICRO


	)

82 
	#MOD_NANO
 
ADJ_NANO


	)

86 
	#STA_PLL
 0x0001

	)

87 
	#STA_PPSFREQ
 0x0002

	)

88 
	#STA_PPSTIME
 0x0004

	)

89 
	#STA_FLL
 0x0008

	)

91 
	#STA_INS
 0x0010

	)

92 
	#STA_DEL
 0x0020

	)

93 
	#STA_UNSYNC
 0x0040

	)

94 
	#STA_FREQHOLD
 0x0080

	)

96 
	#STA_PPSSIGNAL
 0x0100

	)

97 
	#STA_PPSJITTER
 0x0200

	)

98 
	#STA_PPSWANDER
 0x0400

	)

99 
	#STA_PPSERROR
 0x0800

	)

101 
	#STA_CLOCKERR
 0x1000

	)

102 
	#STA_NANO
 0x2000

	)

103 
	#STA_MODE
 0x4000

	)

104 
	#STA_CLK
 0x8000

	)

107 
	#STA_RONLY
 (
STA_PPSSIGNAL
 | 
STA_PPSJITTER
 | 
STA_PPSWANDER
 | \

108 
STA_PPSERROR
 | 
STA_CLOCKERR
 | 
STA_NANO
 | 
STA_MODE
 | 
STA_CLK
)

	)

	@/usr/include/bits/types/__locale_t.h

20 #iâdeà
_BITS_TYPES___LOCALE_T_H


21 
	#_BITS_TYPES___LOCALE_T_H
 1

	)

28 
	s__loÿË_¡ruù


31 
__loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

42 
__loÿË_¡ruù
 *
	t__loÿË_t
;

	@/usr/include/bits/types/__mbstate_t.h

1 #iâdeà
____mb¡©e_t_defšed


2 
	#____mb¡©e_t_defšed
 1

	)

8 #iâdeà
__WINT_TYPE__


9 
	#__WINT_TYPE__
 

	)

15 
	m__couÁ
;

18 
__WINT_TYPE__
 
	m__wch
;

19 
	m__wchb
[4];

20 } 
	m__v®ue
;

21 } 
	t__mb¡©e_t
;

	@/usr/include/bits/types/__sigval_t.h

19 #iâdeà
____sigv®_t_defšed


20 
	#____sigv®_t_defšed


	)

23 #ifdeà
__USE_POSIX199309


24 
	usigv®


26 
	msiv®_št
;

27 *
	msiv®_±r
;

30 
sigv®
 
	t__sigv®_t
;

32 
	u__sigv®


34 
	m__siv®_št
;

35 *
	m__siv®_±r
;

38 
__sigv®
 
	t__sigv®_t
;

	@/usr/include/bits/typesizes.h

19 #iâdeà
_BITS_TYPES_H


23 #iâdef 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifdeà
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

68 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

69 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

70 
	#__TIMER_T_TYPE
 *

	)

71 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

72 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

73 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

74 
	#__CPU_MASK_TYPE
 
__SYSCALL_ULONG_TYPE


	)

76 #ifdeà
__x86_64__


80 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

83 
	#__INO_T_MATCHES_INO64_T
 1

	)

86 
	#__RLIM_T_MATCHES_RLIM64_T
 1

	)

88 
	#__RLIM_T_MATCHES_RLIM64_T
 0

	)

92 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/event2/keyvalq_struct.h

27 #iâdeà
EVENT2_KEYVALQ_STRUCT_H_INCLUDED_


28 
	#EVENT2_KEYVALQ_STRUCT_H_INCLUDED_


	)

30 #ifdeà
__ılu¥lus


36 #iâdeà
TAILQ_ENTRY


37 
	#EVENT_DEFINED_TQENTRY_


	)

38 
	#TAILQ_ENTRY
(
ty³
) \

40 
ty³
 *
tqe_Ãxt
; \

41 
ty³
 **
tqe_´ev
; \

42 }

	)

45 #iâdeà
TAILQ_HEAD


46 
	#EVENT_DEFINED_TQHEAD_


	)

47 
	#TAILQ_HEAD
(
Çme
, 
ty³
) \

48 
	sÇme
 { \

49 
ty³
 *
tqh_fœ¡
; \

50 
ty³
 **
tqh_Ï¡
; \

51 }

	)

58 
	sevkeyv®
 {

59 
TAILQ_ENTRY
(
evkeyv®
è
Ãxt
;

61 *
key
;

62 *
v®ue
;

65 
TAILQ_HEAD
 (
evkeyv®q
, 
evkeyv®
);

68 #ifdeà
EVENT_DEFINED_TQENTRY_


69 #undeà
TAILQ_ENTRY


72 #ifdeà
EVENT_DEFINED_TQHEAD_


73 #undeà
TAILQ_HEAD


76 #ifdeà
__ılu¥lus


	@/usr/include/event2/util.h

26 #iâdeà
EVENT2_UTIL_H_INCLUDED_


27 
	#EVENT2_UTIL_H_INCLUDED_


	)

35 
	~<ev’t2/visib™y.h
>

37 #ifdeà
__ılu¥lus


41 
	~<ev’t2/ev’t-cÚfig.h
>

42 #ifdeà
EVENT__HAVE_SYS_TIME_H


43 
	~<sys/time.h
>

45 #ifdeà
EVENT__HAVE_STDINT_H


46 
	~<¡dšt.h
>

47 #–ià
defšed
(
EVENT__HAVE_INTTYPES_H
)

48 
	~<š‰y³s.h
>

50 #ifdeà
EVENT__HAVE_SYS_TYPES_H


51 
	~<sys/ty³s.h
>

53 #ifdeà
EVENT__HAVE_STDDEF_H


54 
	~<¡ddef.h
>

56 #ifdeà
_MSC_VER


57 
	~<Ba£Tsd.h
>

59 
	~<¡d¬g.h
>

60 #ifdeà
EVENT__HAVE_NETDB_H


61 #ià!
defšed
(
_GNU_SOURCE
)

62 
	#_GNU_SOURCE


	)

64 
	~<Ãtdb.h
>

67 #ifdeà
_WIN32


68 
	~<wšsock2.h
>

69 #ifdeà
EVENT__HAVE_GETADDRINFO


71 
	~<ws2tı.h
>

74 #ifdeà
EVENT__HAVE_ERRNO_H


75 
	~<”ºo.h
>

77 
	~<sys/sock‘.h
>

80 
	~<time.h
>

83 #ià
defšed
(
EVENT__SIZEOF_VOID__
è&& !defšed(
EVENT__SIZEOF_VOID_P
)

84 
	#EVENT__SIZEOF_VOID_P
 
EVENT__SIZEOF_VOID__


	)

116 #ifdeà
EVENT__HAVE_UINT64_T


117 
	#ev_ušt64_t
 
ušt64_t


	)

118 
	#ev_št64_t
 
št64_t


	)

119 #–ià
defšed
(
_WIN32
)

120 
	#ev_ušt64_t
 
__št64


	)

121 
	#ev_št64_t
 sigÃd 
__št64


	)

122 #–ià
EVENT__SIZEOF_LONG_LONG
 == 8

123 
	#ev_ušt64_t
 

	)

124 
	#ev_št64_t
 

	)

125 #–ià
EVENT__SIZEOF_LONG
 == 8

126 
	#ev_ušt64_t
 

	)

127 
	#ev_št64_t
 

	)

128 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

129 
	#ev_ušt64_t
 ...

	)

130 
	#ev_št64_t
 ...

	)

135 #ifdeà
EVENT__HAVE_UINT32_T


136 
	#ev_ušt32_t
 
ušt32_t


	)

137 
	#ev_št32_t
 
št32_t


	)

138 #–ià
defšed
(
_WIN32
)

139 
	#ev_ušt32_t
 

	)

140 
	#ev_št32_t
 sigÃd 

	)

141 #–ià
EVENT__SIZEOF_LONG
 == 4

142 
	#ev_ušt32_t
 

	)

143 
	#ev_št32_t
 sigÃd 

	)

144 #–ià
EVENT__SIZEOF_INT
 == 4

145 
	#ev_ušt32_t
 

	)

146 
	#ev_št32_t
 sigÃd 

	)

147 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

148 
	#ev_ušt32_t
 ...

	)

149 
	#ev_št32_t
 ...

	)

154 #ifdeà
EVENT__HAVE_UINT16_T


155 
	#ev_ušt16_t
 
ušt16_t


	)

156 
	#ev_št16_t
 
št16_t


	)

157 #–ià
defšed
(
_WIN32
)

158 
	#ev_ušt16_t
 

	)

159 
	#ev_št16_t
 sigÃd 

	)

160 #–ià
EVENT__SIZEOF_INT
 == 2

161 
	#ev_ušt16_t
 

	)

162 
	#ev_št16_t
 sigÃd 

	)

163 #–ià
EVENT__SIZEOF_SHORT
 == 2

164 
	#ev_ušt16_t
 

	)

165 
	#ev_št16_t
 sigÃd 

	)

166 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

167 
	#ev_ušt16_t
 ...

	)

168 
	#ev_št16_t
 ...

	)

173 #ifdeà
EVENT__HAVE_UINT8_T


174 
	#ev_ušt8_t
 
ušt8_t


	)

175 
	#ev_št8_t
 
št8_t


	)

176 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

177 
	#ev_ušt8_t
 ...

	)

178 
	#ev_št8_t
 ...

	)

180 
	#ev_ušt8_t
 

	)

181 
	#ev_št8_t
 sigÃd 

	)

184 #ifdeà
EVENT__HAVE_UINTPTR_T


185 
	#ev_ušŒ_t
 
ušŒ_t


	)

186 
	#ev_šŒ_t
 
šŒ_t


	)

187 #–ià
EVENT__SIZEOF_VOID_P
 <= 4

188 
	#ev_ušŒ_t
 
ev_ušt32_t


	)

189 
	#ev_šŒ_t
 
ev_št32_t


	)

190 #–ià
EVENT__SIZEOF_VOID_P
 <= 8

191 
	#ev_ušŒ_t
 
ev_ušt64_t


	)

192 
	#ev_šŒ_t
 
ev_št64_t


	)

193 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

194 
	#ev_ušŒ_t
 ...

	)

195 
	#ev_šŒ_t
 ...

	)

200 #ifdeà
EVENT__ssize_t


201 
	#ev_ssize_t
 
EVENT__ssize_t


	)

203 
	#ev_ssize_t
 
ssize_t


	)

213 #ifdeà
_WIN32


214 
	#ev_off_t
 
ev_št64_t


	)

215 #–ià
EVENT__SIZEOF_OFF_T
 == 8

216 
	#ev_off_t
 
ev_št64_t


	)

217 #–ià
EVENT__SIZEOF_OFF_T
 == 4

218 
	#ev_off_t
 
ev_št32_t


	)

219 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

220 
	#ev_off_t
 ...

	)

222 
	#ev_off_t
 
off_t


	)

241 #iâdeà
EVENT__HAVE_STDINT_H


242 
	#EV_UINT64_MAX
 ((((
ev_ušt64_t
)0xffffffffULè<< 32è| 0xffffffffUL)

	)

243 
	#EV_INT64_MAX
 ((((
ev_št64_t
è0x7fffffffLè<< 32è| 0xffffffffL)

	)

244 
	#EV_INT64_MIN
 ((-
EV_INT64_MAX
è- 1)

	)

245 
	#EV_UINT32_MAX
 ((
ev_ušt32_t
)0xffffffffUL)

	)

246 
	#EV_INT32_MAX
 ((
ev_št32_t
è0x7fffffffL)

	)

247 
	#EV_INT32_MIN
 ((-
EV_INT32_MAX
è- 1)

	)

248 
	#EV_UINT16_MAX
 ((
ev_ušt16_t
)0xffffUL)

	)

249 
	#EV_INT16_MAX
 ((
ev_št16_t
è0x7fffL)

	)

250 
	#EV_INT16_MIN
 ((-
EV_INT16_MAX
è- 1)

	)

251 
	#EV_UINT8_MAX
 255

	)

252 
	#EV_INT8_MAX
 127

	)

253 
	#EV_INT8_MIN
 ((-
EV_INT8_MAX
è- 1)

	)

255 
	#EV_UINT64_MAX
 
UINT64_MAX


	)

256 
	#EV_INT64_MAX
 
INT64_MAX


	)

257 
	#EV_INT64_MIN
 
INT64_MIN


	)

258 
	#EV_UINT32_MAX
 
UINT32_MAX


	)

259 
	#EV_INT32_MAX
 
INT32_MAX


	)

260 
	#EV_INT32_MIN
 
INT32_MIN


	)

261 
	#EV_UINT16_MAX
 
UINT16_MAX


	)

262 
	#EV_INT16_MAX
 
INT16_MAX


	)

263 
	#EV_UINT8_MAX
 
UINT8_MAX


	)

264 
	#EV_INT8_MAX
 
INT8_MAX


	)

265 
	#EV_INT8_MIN
 
INT8_MIN


	)

275 #ià
EVENT__SIZEOF_SIZE_T
 == 8

276 
	#EV_SIZE_MAX
 
EV_UINT64_MAX


	)

277 
	#EV_SSIZE_MAX
 
EV_INT64_MAX


	)

278 #–ià
EVENT__SIZEOF_SIZE_T
 == 4

279 
	#EV_SIZE_MAX
 
EV_UINT32_MAX


	)

280 
	#EV_SSIZE_MAX
 
EV_INT32_MAX


	)

281 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

282 
	#EV_SIZE_MAX
 ...

	)

283 
	#EV_SSIZE_MAX
 ...

	)

288 
	#EV_SSIZE_MIN
 ((-
EV_SSIZE_MAX
è- 1)

	)

291 #ifdeà
_WIN32


292 
	#ev_sockËn_t
 

	)

293 #–ià
defšed
(
EVENT__sockËn_t
)

294 
	#ev_sockËn_t
 
EVENT__sockËn_t


	)

296 
	#ev_sockËn_t
 
sockËn_t


	)

299 #ifdeà
EVENT__HAVE_STRUCT_SOCKADDR_STORAGE___SS_FAMILY


300 #ià!
defšed
(
EVENT__HAVE_STRUCT_SOCKADDR_STORAGE_SS_FAMILY
) \

301 && !
defšed
(
ss_çmy
)

302 
	#ss_çmy
 
__ss_çmy


	)

309 #ifdeà
_WIN32


310 
	#evut_sock‘_t
 
šŒ_t


	)

312 
	#evut_sock‘_t
 

	)

327 
evut_mÚÙÚic_tim”


328 #ifdeà
EVENT_IN_DOXYGEN_


333 
	#EV_MONOT_PRECISE
 1

	)

334 
	#EV_MONOT_FALLBACK
 2

	)

342 
EVENT2_EXPORT_SYMBOL
 

343 
evut_d©e_rfc1123
(*
d©e
, cÚ¡ 
size_t
 
d©–’
, cÚ¡ 
tm
 *tm);

350 
EVENT2_EXPORT_SYMBOL


351 
evut_mÚÙÚic_tim”
 * 
evut_mÚÙÚic_tim”_Ãw
();

356 
EVENT2_EXPORT_SYMBOL


357 
evut_mÚÙÚic_tim”_ä“
(
evut_mÚÙÚic_tim”
 *
tim”
);

362 
EVENT2_EXPORT_SYMBOL


363 
evut_cÚfigu»_mÚÙÚic_time
(
evut_mÚÙÚic_tim”
 *
tim”
,

364 
æags
);

376 
EVENT2_EXPORT_SYMBOL


377 
evut_g‘time_mÚÙÚic
(
evut_mÚÙÚic_tim”
 *
tim”
,

378 
timev®
 *

);

391 
EVENT2_EXPORT_SYMBOL


392 
evut_sock‘·œ
(
d
, 
ty³
, 
´ÙocŞ
, 
evut_sock‘_t
 
sv
[2]);

398 
EVENT2_EXPORT_SYMBOL


399 
evut_make_sock‘_nÚblockšg
(
evut_sock‘_t
 
sock
);

412 
EVENT2_EXPORT_SYMBOL


413 
evut_make_li¡’_sock‘_»u£abË
(
evut_sock‘_t
 
sock
);

425 
EVENT2_EXPORT_SYMBOL


426 
evut_make_li¡’_sock‘_»u£abË_pÜt
(
evut_sock‘_t
 
sock
);

434 
EVENT2_EXPORT_SYMBOL


435 
evut_make_sock‘_şo£Úexec
(
evut_sock‘_t
 
sock
);

443 
EVENT2_EXPORT_SYMBOL


444 
evut_şo£sock‘
(
evut_sock‘_t
 
sock
);

445 
	#EVUTIL_CLOSESOCKET
(
s
è
	`evut_şo£sock‘
(s)

	)

458 
EVENT2_EXPORT_SYMBOL


459 
evut_make_tı_li¡’_sock‘_deã¼ed
(
evut_sock‘_t
 
sock
);

461 #ifdeà
_WIN32


463 
	#EVUTIL_SOCKET_ERROR
(è
	`WSAG‘La¡E¼Ü
()

	)

465 
	#EVUTIL_SET_SOCKET_ERROR
(
”rcode
) \

466 dØ{ 
	`WSAS‘La¡E¼Ü
(
”rcode
); } 0)

	)

468 
EVENT2_EXPORT_SYMBOL


469 
evut_sock‘_g‘”rÜ
(
evut_sock‘_t
 
sock
);

471 
EVENT2_EXPORT_SYMBOL


472 cÚ¡ *
evut_sock‘_”rÜ_to_¡ršg
(
”rcode
);

473 #–ià
defšed
(
EVENT_IN_DOXYGEN_
)

489 
	#EVUTIL_SOCKET_ERROR
(è...

	)

491 
	#EVUTIL_SET_SOCKET_ERROR
(
”rcode
è...

	)

493 
	#evut_sock‘_g‘”rÜ
(
sock
è...

	)

495 
	#evut_sock‘_”rÜ_to_¡ršg
(
”rcode
è...

	)

498 
	#EVUTIL_SOCKET_ERROR
(è(
”ºo
)

	)

499 
	#EVUTIL_SET_SOCKET_ERROR
(
”rcode
) \

500 dØ{ 
”ºo
 = (
”rcode
); } 0)

	)

501 
	#evut_sock‘_g‘”rÜ
(
sock
è(
”ºo
)

	)

502 
	#evut_sock‘_”rÜ_to_¡ršg
(
”rcode
è(
	`¡»¼Ü
Ó¼code))

	)

514 #ifdeà
EVENT__HAVE_TIMERADD


515 
	#evut_tim”add
(
tvp
, 
uvp
, 
vvp
è
	`tim”add
(Ñvp), (uvp), (vvp))

	)

516 
	#evut_tim”sub
(
tvp
, 
uvp
, 
vvp
è
	`tim”sub
(Ñvp), (uvp), (vvp))

	)

518 
	#evut_tim”add
(
tvp
, 
uvp
, 
vvp
) \

520 (
vvp
)->
tv_£c
 = (
tvp
)->tv_£ø+ (
uvp
)->tv_sec; \

521 (
vvp
)->
tv_u£c
 = (
tvp
)->tv_u£ø+ (
uvp
)->tv_usec; \

522 ià((
vvp
)->
tv_u£c
 >= 1000000) { \

523 (
vvp
)->
tv_£c
++; \

524 (
vvp
)->
tv_u£c
 -= 1000000; \

526 } 0)

	)

527 
	#evut_tim”sub
(
tvp
, 
uvp
, 
vvp
) \

529 (
vvp
)->
tv_£c
 = (
tvp
)->tv_£ø- (
uvp
)->tv_sec; \

530 (
vvp
)->
tv_u£c
 = (
tvp
)->tv_u£ø- (
uvp
)->tv_usec; \

531 ià((
vvp
)->
tv_u£c
 < 0) { \

532 (
vvp
)->
tv_£c
--; \

533 (
vvp
)->
tv_u£c
 += 1000000; \

535 } 0)

	)

538 #ifdeà
EVENT__HAVE_TIMERCLEAR


539 
	#evut_tim”ş—r
(
tvp
è
	`tim”ş—r
Ñvp)

	)

541 
	#evut_tim”ş—r
(
tvp
èÑvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0

	)

547 
	#evut_tim”cmp
(
tvp
, 
uvp
, 
cmp
) \

548 (((
tvp
)->
tv_£c
 =ğ(
uvp
)->tv_sec) ? \

549 ((
tvp
)->
tv_u£c
 
	`cmp
 (
uvp
)->tv_usec) : \

550 ((
tvp
)->
tv_£c
 
	`cmp
 (
uvp
)->tv_£c))

	)

552 #ifdeà
EVENT__HAVE_TIMERISSET


553 
	#evut_tim”is£t
(
tvp
è
	`tim”is£t
Ñvp)

	)

555 
	#evut_tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

559 #ifdeà
off£tof


560 
	#evut_off£tof
(
ty³
, 
f›ld
è
	`off£tof
Ñy³, f›ld)

	)

562 
	#evut_off£tof
(
ty³
, 
f›ld
è((
off_t
)(&(Ñy³ *)0)->f›ld))

	)

567 
EVENT2_EXPORT_SYMBOL


568 
ev_št64_t
 
evut_¡¹Şl
(cÚ¡ *
s
, **
’d±r
, 
ba£
);

571 #ifdeà
EVENT__HAVE_GETTIMEOFDAY


572 
	#evut_g‘timeofday
(
tv
, 
tz
è
	`g‘timeofday
(Ñv), (tz))

	)

574 
timezÚe
;

575 
EVENT2_EXPORT_SYMBOL


576 
evut_g‘timeofday
(
timev®
 *
tv
, 
timezÚe
 *
tz
);

582 
EVENT2_EXPORT_SYMBOL


583 
evut_¢´štf
(*
buf
, 
size_t
 
buæ’
, cÚ¡ *
fÜm©
, ...)

584 #ifdeà
__GNUC__


585 
__©Œibu‹__
((
fÜm©
(
´štf
, 3, 4)))

591 
EVENT2_EXPORT_SYMBOL


592 
evut_v¢´štf
(*
buf
, 
size_t
 
buæ’
, cÚ¡ *
fÜm©
, 
va_li¡
 
­
)

593 #ifdeà
__GNUC__


594 
__©Œibu‹__
((
fÜm©
(
´štf
, 3, 0)))

599 
EVENT2_EXPORT_SYMBOL


600 cÚ¡ *
evut_š‘_Áİ
(
af
, cÚ¡ *
¤c
, *
d¡
, 
size_t
 
Ën
);

602 
EVENT2_EXPORT_SYMBOL


603 
evut_š‘_±Ú
(
af
, cÚ¡ *
¤c
, *
d¡
);

604 
sockaddr
;

626 
EVENT2_EXPORT_SYMBOL


627 
evut_·r£_sockaddr_pÜt
(cÚ¡ *
¡r
, 
sockaddr
 *
out
, *
ou’
);

634 
EVENT2_EXPORT_SYMBOL


635 
evut_sockaddr_cmp
(cÚ¡ 
sockaddr
 *
§1
, cÚ¡ sockadd¸*
§2
,

636 
šşude_pÜt
);

641 
EVENT2_EXPORT_SYMBOL


642 
evut_ascii_¡rÿ£cmp
(cÚ¡ *
¡r1
, cÚ¡ *
¡r2
);

646 
EVENT2_EXPORT_SYMBOL


647 
evut_ascii_¡ºÿ£cmp
(cÚ¡ *
¡r1
, cÚ¡ *
¡r2
, 
size_t
 
n
);

651 #ifdeà
EVENT__HAVE_STRUCT_ADDRINFO


652 
	#evut_addršfo
 
addršfo


	)

659 
	sevut_addršfo
 {

660 
ai_æags
;

661 
ai_çmy
;

662 
ai_sockty³
;

663 
ai_´ÙocŞ
;

664 
size_t
 
ai_add¾’
;

665 *
ai_ÿnÚÇme
;

666 
sockaddr
 *
ai_addr
;

667 
evut_addršfo
 *
ai_Ãxt
;

677 #ià
defšed
(
EAI_ADDRFAMILY
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

678 
	#EVUTIL_EAI_ADDRFAMILY
 
EAI_ADDRFAMILY


	)

680 
	#EVUTIL_EAI_ADDRFAMILY
 -901

	)

682 #ià
defšed
(
EAI_AGAIN
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

683 
	#EVUTIL_EAI_AGAIN
 
EAI_AGAIN


	)

685 
	#EVUTIL_EAI_AGAIN
 -902

	)

687 #ià
defšed
(
EAI_BADFLAGS
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

688 
	#EVUTIL_EAI_BADFLAGS
 
EAI_BADFLAGS


	)

690 
	#EVUTIL_EAI_BADFLAGS
 -903

	)

692 #ià
defšed
(
EAI_FAIL
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

693 
	#EVUTIL_EAI_FAIL
 
EAI_FAIL


	)

695 
	#EVUTIL_EAI_FAIL
 -904

	)

697 #ià
defšed
(
EAI_FAMILY
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

698 
	#EVUTIL_EAI_FAMILY
 
EAI_FAMILY


	)

700 
	#EVUTIL_EAI_FAMILY
 -905

	)

702 #ià
defšed
(
EAI_MEMORY
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

703 
	#EVUTIL_EAI_MEMORY
 
EAI_MEMORY


	)

705 
	#EVUTIL_EAI_MEMORY
 -906

	)

710 #ià
defšed
(
EAI_NODATA
è&& defšed(
EVENT__HAVE_GETADDRINFO
è&& (!defšed(
EAI_NONAME
) || EAI_NODATA != EAI_NONAME)

711 
	#EVUTIL_EAI_NODATA
 
EAI_NODATA


	)

713 
	#EVUTIL_EAI_NODATA
 -907

	)

715 #ià
defšed
(
EAI_NONAME
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

716 
	#EVUTIL_EAI_NONAME
 
EAI_NONAME


	)

718 
	#EVUTIL_EAI_NONAME
 -908

	)

720 #ià
defšed
(
EAI_SERVICE
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

721 
	#EVUTIL_EAI_SERVICE
 
EAI_SERVICE


	)

723 
	#EVUTIL_EAI_SERVICE
 -909

	)

725 #ià
defšed
(
EAI_SOCKTYPE
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

726 
	#EVUTIL_EAI_SOCKTYPE
 
EAI_SOCKTYPE


	)

728 
	#EVUTIL_EAI_SOCKTYPE
 -910

	)

730 #ià
defšed
(
EAI_SYSTEM
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

731 
	#EVUTIL_EAI_SYSTEM
 
EAI_SYSTEM


	)

733 
	#EVUTIL_EAI_SYSTEM
 -911

	)

736 
	#EVUTIL_EAI_CANCEL
 -90001

	)

738 #ià
defšed
(
AI_PASSIVE
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

739 
	#EVUTIL_AI_PASSIVE
 
AI_PASSIVE


	)

741 
	#EVUTIL_AI_PASSIVE
 0x1000

	)

743 #ià
defšed
(
AI_CANONNAME
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

744 
	#EVUTIL_AI_CANONNAME
 
AI_CANONNAME


	)

746 
	#EVUTIL_AI_CANONNAME
 0x2000

	)

748 #ià
defšed
(
AI_NUMERICHOST
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

749 
	#EVUTIL_AI_NUMERICHOST
 
AI_NUMERICHOST


	)

751 
	#EVUTIL_AI_NUMERICHOST
 0x4000

	)

753 #ià
defšed
(
AI_NUMERICSERV
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

754 
	#EVUTIL_AI_NUMERICSERV
 
AI_NUMERICSERV


	)

756 
	#EVUTIL_AI_NUMERICSERV
 0x8000

	)

758 #ià
defšed
(
AI_V4MAPPED
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

759 
	#EVUTIL_AI_V4MAPPED
 
AI_V4MAPPED


	)

761 
	#EVUTIL_AI_V4MAPPED
 0x10000

	)

763 #ià
defšed
(
AI_ALL
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

764 
	#EVUTIL_AI_ALL
 
AI_ALL


	)

766 
	#EVUTIL_AI_ALL
 0x20000

	)

768 #ià
defšed
(
AI_ADDRCONFIG
è&& defšed(
EVENT__HAVE_GETADDRINFO
)

769 
	#EVUTIL_AI_ADDRCONFIG
 
AI_ADDRCONFIG


	)

771 
	#EVUTIL_AI_ADDRCONFIG
 0x40000

	)

775 
evut_addršfo
;

787 
EVENT2_EXPORT_SYMBOL


788 
evut_g‘addršfo
(cÚ¡ *
nod’ame
, cÚ¡ *
£rvÇme
,

789 cÚ¡ 
evut_addršfo
 *
hšts_š
, evut_addršfØ**
»s
);

792 
EVENT2_EXPORT_SYMBOL


793 
evut_ä“addršfo
(
evut_addršfo
 *
ai
);

795 
EVENT2_EXPORT_SYMBOL


796 cÚ¡ *
evut_gai_¡»¼Ü
(
”r
);

807 
EVENT2_EXPORT_SYMBOL


808 
evut_£cu»_ºg_g‘_by‹s
(*
buf
, 
size_t
 
n
);

826 
EVENT2_EXPORT_SYMBOL


827 
evut_£cu»_ºg_š™
();

842 
EVENT2_EXPORT_SYMBOL


843 
evut_£cu»_ºg_£t_u¿ndom_deviû_fe
(*
âame
);

859 
EVENT2_EXPORT_SYMBOL


860 
evut_£cu»_ºg_add_by‹s
(cÚ¡ *
d©
, 
size_t
 
d©Ën
);

862 #ifdeà
__ılu¥lus


	@/usr/include/event2/visibility.h

27 #iâdeà
EVENT2_VISIBILITY_H_INCLUDED_


28 
	#EVENT2_VISIBILITY_H_INCLUDED_


	)

30 
	~<ev’t2/ev’t-cÚfig.h
>

32 #ià
defšed
(
ev’t_EXPORTS
è|| defšed(
ev’t_exŒa_EXPORTS
è|| defšed(
ev’t_cÜe_EXPORTS
)

33 #ià
defšed
 (
__SUNPRO_C
) && (__SUNPRO_C >= 0x550)

34 
	#EVENT2_EXPORT_SYMBOL
 
__glob®


	)

35 #–ià
defšed
 
__GNUC__


36 
	#EVENT2_EXPORT_SYMBOL
 
	`__©Œibu‹__
 ((
	`visib™y
("deçuÉ")))

	)

37 #–ià
defšed
(
_MSC_VER
)

38 
	#EVENT2_EXPORT_SYMBOL
 
	`__deş¥ec
(
dÎexpÜt
)

	)

40 
	#EVENT2_EXPORT_SYMBOL


	)

43 #ià
defšed
(
EVENT__NEED_DLLIMPORT
è&& defšed(
_MSC_VER
è&& !defšed(
EVENT_BUILDING_REGRESS_TEST
)

44 
	#EVENT2_EXPORT_SYMBOL
 
	`__deş¥ec
(
dÎimpÜt
)

	)

46 
	#EVENT2_EXPORT_SYMBOL


	)

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_chæags


	)

11 
	#__¡ub_ç‰ach


	)

12 
	#__¡ub_fchæags


	)

13 
	#__¡ub_fd‘ach


	)

14 
	#__¡ub_g‰y


	)

15 
	#__¡ub_lchmod


	)

16 
	#__¡ub_»voke


	)

17 
	#__¡ub_£ogš


	)

18 
	#__¡ub_sig»tuº


	)

19 
	#__¡ub_s¡k


	)

20 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___com·t_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_ç‰ach


	)

13 
	#__¡ub_fchæags


	)

14 
	#__¡ub_fd‘ach


	)

15 
	#__¡ub_g‘msg


	)

16 
	#__¡ub_g‰y


	)

17 
	#__¡ub_lchmod


	)

18 
	#__¡ub_putmsg


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-x32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___com·t_bdæush


	)

11 
	#__¡ub___com·t_ü—‹_moduË


	)

12 
	#__¡ub___com·t_g‘_k”Ãl_syms


	)

13 
	#__¡ub___com·t_qu”y_moduË


	)

14 
	#__¡ub___com·t_u£lib


	)

15 
	#__¡ub_chæags


	)

16 
	#__¡ub_ç‰ach


	)

17 
	#__¡ub_fchæags


	)

18 
	#__¡ub_fd‘ach


	)

19 
	#__¡ub_g‘msg


	)

20 
	#__¡ub_g‰y


	)

21 
	#__¡ub_lchmod


	)

22 
	#__¡ub_nfs£rvùl


	)

23 
	#__¡ub_putmsg


	)

24 
	#__¡ub_»voke


	)

25 
	#__¡ub_£ogš


	)

26 
	#__¡ub_sig»tuº


	)

27 
	#__¡ub_s¡k


	)

28 
	#__¡ub_¡ty


	)

	@/usr/include/linux/errno.h

1 
	~<asm/”ºo.h
>

	@/usr/include/linux/kernel.h

2 #iâdeà
_LINUX_KERNEL_H


3 
	#_LINUX_KERNEL_H


	)

5 
	~<lšux/sysšfo.h
>

10 
	#__ALIGN_KERNEL
(
x
, 
a
è
	`__ALIGN_KERNEL_MASK
(x, (
	`ty³of
(x))×è- 1)

	)

11 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
è(((xè+ (mask)è& ~(mask))

	)

13 
	#__KERNEL_DIV_ROUND_UP
(
n
, 
d
è((Òè+ (dè- 1è/ (d))

	)

	@/usr/include/linux/limits.h

2 #iâdeà
_LINUX_LIMITS_H


3 
	#_LINUX_LIMITS_H


	)

5 
	#NR_OPEN
 1024

	)

7 
	#NGROUPS_MAX
 65536

	)

8 
	#ARG_MAX
 131072

	)

9 
	#LINK_MAX
 127

	)

10 
	#MAX_CANON
 255

	)

11 
	#MAX_INPUT
 255

	)

12 
	#NAME_MAX
 255

	)

13 
	#PATH_MAX
 4096

	)

14 
	#PIPE_BUF
 4096

	)

15 
	#XATTR_NAME_MAX
 255

	)

16 
	#XATTR_SIZE_MAX
 65536

	)

17 
	#XATTR_LIST_MAX
 65536

	)

19 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/param.h

2 #iâdeà
_LINUX_PARAM_H


3 
	#_LINUX_PARAM_H


	)

5 
	~<asm/·¿m.h
>

	@/usr/include/linux/types.h

2 #iâdeà
_LINUX_TYPES_H


3 
	#_LINUX_TYPES_H


	)

5 
	~<asm/ty³s.h
>

7 #iâdeà
__ASSEMBLY__


9 
	~<lšux/posix_ty³s.h
>

17 #ifdeà
__CHECKER__


18 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

20 
	#__b™wi£__


	)

22 
	#__b™wi£
 
__b™wi£__


	)

24 
__u16
 
	t__b™wi£
 
	t__Ë16
;

25 
__u16
 
	t__b™wi£
 
	t__be16
;

26 
__u32
 
	t__b™wi£
 
	t__Ë32
;

27 
__u32
 
	t__b™wi£
 
	t__be32
;

28 
__u64
 
	t__b™wi£
 
	t__Ë64
;

29 
__u64
 
	t__b™wi£
 
	t__be64
;

31 
__u16
 
	t__b™wi£
 
	t__sum16
;

32 
__u32
 
	t__b™wi£
 
	t__wsum
;

43 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

44 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

45 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/asm-generic/ioctls.h

2 #iâdeà
__ASM_GENERIC_IOCTLS_H


3 
	#__ASM_GENERIC_IOCTLS_H


	)

5 
	~<lšux/ioùl.h
>

20 
	#TCGETS
 0x5401

	)

21 
	#TCSETS
 0x5402

	)

22 
	#TCSETSW
 0x5403

	)

23 
	#TCSETSF
 0x5404

	)

24 
	#TCGETA
 0x5405

	)

25 
	#TCSETA
 0x5406

	)

26 
	#TCSETAW
 0x5407

	)

27 
	#TCSETAF
 0x5408

	)

28 
	#TCSBRK
 0x5409

	)

29 
	#TCXONC
 0x540A

	)

30 
	#TCFLSH
 0x540B

	)

31 
	#TIOCEXCL
 0x540C

	)

32 
	#TIOCNXCL
 0x540D

	)

33 
	#TIOCSCTTY
 0x540E

	)

34 
	#TIOCGPGRP
 0x540F

	)

35 
	#TIOCSPGRP
 0x5410

	)

36 
	#TIOCOUTQ
 0x5411

	)

37 
	#TIOCSTI
 0x5412

	)

38 
	#TIOCGWINSZ
 0x5413

	)

39 
	#TIOCSWINSZ
 0x5414

	)

40 
	#TIOCMGET
 0x5415

	)

41 
	#TIOCMBIS
 0x5416

	)

42 
	#TIOCMBIC
 0x5417

	)

43 
	#TIOCMSET
 0x5418

	)

44 
	#TIOCGSOFTCAR
 0x5419

	)

45 
	#TIOCSSOFTCAR
 0x541A

	)

46 
	#FIONREAD
 0x541B

	)

47 
	#TIOCINQ
 
FIONREAD


	)

48 
	#TIOCLINUX
 0x541C

	)

49 
	#TIOCCONS
 0x541D

	)

50 
	#TIOCGSERIAL
 0x541E

	)

51 
	#TIOCSSERIAL
 0x541F

	)

52 
	#TIOCPKT
 0x5420

	)

53 
	#FIONBIO
 0x5421

	)

54 
	#TIOCNOTTY
 0x5422

	)

55 
	#TIOCSETD
 0x5423

	)

56 
	#TIOCGETD
 0x5424

	)

57 
	#TCSBRKP
 0x5425

	)

58 
	#TIOCSBRK
 0x5427

	)

59 
	#TIOCCBRK
 0x5428

	)

60 
	#TIOCGSID
 0x5429

	)

61 
	#TCGETS2
 
	`_IOR
('T', 0x2A, 
‹rmios2
)

	)

62 
	#TCSETS2
 
	`_IOW
('T', 0x2B, 
‹rmios2
)

	)

63 
	#TCSETSW2
 
	`_IOW
('T', 0x2C, 
‹rmios2
)

	)

64 
	#TCSETSF2
 
	`_IOW
('T', 0x2D, 
‹rmios2
)

	)

65 
	#TIOCGRS485
 0x542E

	)

66 #iâdeà
TIOCSRS485


67 
	#TIOCSRS485
 0x542F

	)

69 
	#TIOCGPTN
 
	`_IOR
('T', 0x30, è

	)

70 
	#TIOCSPTLCK
 
	`_IOW
('T', 0x31, è

	)

71 
	#TIOCGDEV
 
	`_IOR
('T', 0x32, è

	)

72 
	#TCGETX
 0x5432

	)

73 
	#TCSETX
 0x5433

	)

74 
	#TCSETXF
 0x5434

	)

75 
	#TCSETXW
 0x5435

	)

76 
	#TIOCSIG
 
	`_IOW
('T', 0x36, è

	)

77 
	#TIOCVHANGUP
 0x5437

	)

78 
	#TIOCGPKT
 
	`_IOR
('T', 0x38, è

	)

79 
	#TIOCGPTLCK
 
	`_IOR
('T', 0x39, è

	)

80 
	#TIOCGEXCL
 
	`_IOR
('T', 0x40, è

	)

81 
	#TIOCGPTPEER
 
	`_IO
('T', 0x41è

	)

83 
	#FIONCLEX
 0x5450

	)

84 
	#FIOCLEX
 0x5451

	)

85 
	#FIOASYNC
 0x5452

	)

86 
	#TIOCSERCONFIG
 0x5453

	)

87 
	#TIOCSERGWILD
 0x5454

	)

88 
	#TIOCSERSWILD
 0x5455

	)

89 
	#TIOCGLCKTRMIOS
 0x5456

	)

90 
	#TIOCSLCKTRMIOS
 0x5457

	)

91 
	#TIOCSERGSTRUCT
 0x5458

	)

92 
	#TIOCSERGETLSR
 0x5459

	)

93 
	#TIOCSERGETMULTI
 0x545A

	)

94 
	#TIOCSERSETMULTI
 0x545B

	)

96 
	#TIOCMIWAIT
 0x545C

	)

97 
	#TIOCGICOUNT
 0x545D

	)

103 #iâdeà
FIOQSIZE


104 
	#FIOQSIZE
 0x5460

	)

108 
	#TIOCPKT_DATA
 0

	)

109 
	#TIOCPKT_FLUSHREAD
 1

	)

110 
	#TIOCPKT_FLUSHWRITE
 2

	)

111 
	#TIOCPKT_STOP
 4

	)

112 
	#TIOCPKT_START
 8

	)

113 
	#TIOCPKT_NOSTOP
 16

	)

114 
	#TIOCPKT_DOSTOP
 32

	)

115 
	#TIOCPKT_IOCTL
 64

	)

117 
	#TIOCSER_TEMT
 0x01

	)

	@/usr/include/asm-generic/socket.h

2 #iâdeà
__ASM_GENERIC_SOCKET_H


3 
	#__ASM_GENERIC_SOCKET_H


	)

5 
	~<asm/sockios.h
>

8 
	#SOL_SOCKET
 1

	)

10 
	#SO_DEBUG
 1

	)

11 
	#SO_REUSEADDR
 2

	)

12 
	#SO_TYPE
 3

	)

13 
	#SO_ERROR
 4

	)

14 
	#SO_DONTROUTE
 5

	)

15 
	#SO_BROADCAST
 6

	)

16 
	#SO_SNDBUF
 7

	)

17 
	#SO_RCVBUF
 8

	)

18 
	#SO_SNDBUFFORCE
 32

	)

19 
	#SO_RCVBUFFORCE
 33

	)

20 
	#SO_KEEPALIVE
 9

	)

21 
	#SO_OOBINLINE
 10

	)

22 
	#SO_NO_CHECK
 11

	)

23 
	#SO_PRIORITY
 12

	)

24 
	#SO_LINGER
 13

	)

25 
	#SO_BSDCOMPAT
 14

	)

26 
	#SO_REUSEPORT
 15

	)

27 #iâdeà
SO_PASSCRED


28 
	#SO_PASSCRED
 16

	)

29 
	#SO_PEERCRED
 17

	)

30 
	#SO_RCVLOWAT
 18

	)

31 
	#SO_SNDLOWAT
 19

	)

32 
	#SO_RCVTIMEO
 20

	)

33 
	#SO_SNDTIMEO
 21

	)

37 
	#SO_SECURITY_AUTHENTICATION
 22

	)

38 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

39 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

41 
	#SO_BINDTODEVICE
 25

	)

44 
	#SO_ATTACH_FILTER
 26

	)

45 
	#SO_DETACH_FILTER
 27

	)

46 
	#SO_GET_FILTER
 
SO_ATTACH_FILTER


	)

48 
	#SO_PEERNAME
 28

	)

49 
	#SO_TIMESTAMP
 29

	)

50 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

52 
	#SO_ACCEPTCONN
 30

	)

54 
	#SO_PEERSEC
 31

	)

55 
	#SO_PASSSEC
 34

	)

56 
	#SO_TIMESTAMPNS
 35

	)

57 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

59 
	#SO_MARK
 36

	)

61 
	#SO_TIMESTAMPING
 37

	)

62 
	#SCM_TIMESTAMPING
 
SO_TIMESTAMPING


	)

64 
	#SO_PROTOCOL
 38

	)

65 
	#SO_DOMAIN
 39

	)

67 
	#SO_RXQ_OVFL
 40

	)

69 
	#SO_WIFI_STATUS
 41

	)

70 
	#SCM_WIFI_STATUS
 
SO_WIFI_STATUS


	)

71 
	#SO_PEEK_OFF
 42

	)

74 
	#SO_NOFCS
 43

	)

76 
	#SO_LOCK_FILTER
 44

	)

78 
	#SO_SELECT_ERR_QUEUE
 45

	)

80 
	#SO_BUSY_POLL
 46

	)

82 
	#SO_MAX_PACING_RATE
 47

	)

84 
	#SO_BPF_EXTENSIONS
 48

	)

86 
	#SO_INCOMING_CPU
 49

	)

88 
	#SO_ATTACH_BPF
 50

	)

89 
	#SO_DETACH_BPF
 
SO_DETACH_FILTER


	)

91 
	#SO_ATTACH_REUSEPORT_CBPF
 51

	)

92 
	#SO_ATTACH_REUSEPORT_EBPF
 52

	)

94 
	#SO_CNX_ADVICE
 53

	)

96 
	#SCM_TIMESTAMPING_OPT_STATS
 54

	)

98 
	#SO_MEMINFO
 55

	)

100 
	#SO_INCOMING_NAPI_ID
 56

	)

102 
	#SO_COOKIE
 57

	)

104 
	#SCM_TIMESTAMPING_PKTINFO
 58

	)

106 
	#SO_PEERGROUPS
 59

	)

108 
	#SO_ZEROCOPY
 60

	)

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/asm/param.h

1 
	~<asm-g’”ic/·¿m.h
>

	@/usr/include/asm/types.h

2 #iâdeà
_ASM_X86_TYPES_H


3 
	#_ASM_X86_TYPES_H


	)

5 
	~<asm-g’”ic/ty³s.h
>

	@/usr/include/bits/mman-shared.h

19 #iâdeà
_SYS_MMAN_H


23 #ifdeà
__USE_GNU


25 #iâdeà
MFD_CLOEXEC


26 
	#MFD_CLOEXEC
 1U

	)

27 
	#MFD_ALLOW_SEALING
 2U

	)

28 
	#MFD_HUGETLB
 4U

	)

32 #iâdeà
MLOCK_ONFAULT


33 
	#MLOCK_ONFAULT
 1U

	)

37 #iâdeà
PKEY_DISABLE_ACCESS


38 
	#PKEY_DISABLE_ACCESS
 0x1

	)

39 
	#PKEY_DISABLE_WRITE
 0x2

	)

42 
__BEGIN_DECLS


46 
	$memfd_ü—‹
 (cÚ¡ *
__Çme
, 
__æags
è
__THROW
;

50 
	$mlock2
 (cÚ¡ *
__addr
, 
size_t
 
__Ëngth
, 
__æags
è
__THROW
;

56 
	$pkey_®loc
 (
__æags
, 
__acûss_rights
è
__THROW
;

60 
	$pkey_£t
 (
__key
, 
__acûss_rights
è
__THROW
;

64 
	$pkey_g‘
 (
__key
è
__THROW
;

68 
	$pkey_ä“
 (
__key
è
__THROW
;

72 
	$pkey_m´Ùeù
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
, 
__pkey
è
__THROW
;

74 
__END_DECLS


	@/usr/include/bits/pthreadtypes-arch.h

18 #iâdeà
_BITS_PTHREADTYPES_ARCH_H


19 
	#_BITS_PTHREADTYPES_ARCH_H
 1

	)

21 
	~<b™s/wÜdsize.h
>

23 #ifdeà
__x86_64__


24 #ià
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

29 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

31 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

32 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

33 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

34 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

35 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

38 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

39 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

40 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

45 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

46 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

47 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

48 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

51 
	#__PTHREAD_COMPAT_PADDING_MID


	)

52 
	#__PTHREAD_COMPAT_PADDING_END


	)

53 
	#__PTHREAD_MUTEX_LOCK_ELISION
 1

	)

54 #ifdeà
__x86_64__


55 
	#__PTHREAD_MUTEX_NUSERS_AFTER_KIND
 0

	)

56 
	#__PTHREAD_MUTEX_USE_UNION
 0

	)

58 
	#__PTHREAD_MUTEX_NUSERS_AFTER_KIND
 1

	)

59 
	#__PTHREAD_MUTEX_USE_UNION
 1

	)

62 
	#__LOCK_ALIGNMENT


	)

63 
	#__ONCE_ALIGNMENT


	)

65 
	s__±h»ad_rwlock_¬ch_t


67 
	m__»ad”s
;

68 
	m__wr™”s
;

69 
	m__w½ha£_fu‹x
;

70 
	m__wr™”s_fu‹x
;

71 
	m__·d3
;

72 
	m__·d4
;

73 #ifdeà
__x86_64__


74 
	m__cur_wr™”
;

75 
	m__sh¬ed
;

76 sigÃd 
	m__rw–isiÚ
;

77 #ifdeà 
__ILP32__


78 
	m__·d1
[3];

79 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0 }

	)

81 
	m__·d1
[7];

82 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0, 0, 0, 0, 0 }

	)

84 
	m__·d2
;

87 
	m__æags
;

88 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

92 
	m__æags
;

93 
	m__sh¬ed
;

94 sigÃd 
	m__rw–isiÚ
;

95 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0

	)

96 
	m__·d2
;

97 
	m__cur_wr™”
;

101 #iâdeà
__x86_64__


103 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s/__mb¡©e_t.h
>

27 
	~<b™s/ty³s/wšt_t.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004,

60 
	m__GCONV_TRANSLIT
 = 0x0008

65 
	g__gcÚv_¡•
;

66 
	g__gcÚv_¡•_d©a
;

67 
	g__gcÚv_lßded_objeù
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 
	s__gcÚv_¡•


86 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

87 cÚ¡ *
__modÇme
;

89 
__couÁ”
;

91 *
__äom_Çme
;

92 *
__to_Çme
;

94 
__gcÚv_fù
 
__fù
;

95 
__gcÚv_btowc_fù
 
__btowc_fù
;

96 
__gcÚv_š™_fù
 
__š™_fù
;

97 
__gcÚv_’d_fù
 
__’d_fù
;

101 
__mš_Ãeded_äom
;

102 
__max_Ãeded_äom
;

103 
__mš_Ãeded_to
;

104 
__max_Ãeded_to
;

107 
__¡©eful
;

109 *
__d©a
;

114 
	s__gcÚv_¡•_d©a


116 *
__outbuf
;

117 *
__outbuãnd
;

121 
__æags
;

125 
__švoÿtiÚ_couÁ”
;

129 
__š‹º®_u£
;

131 
__mb¡©e_t
 *
__¡©•
;

132 
__mb¡©e_t
 
__¡©e
;

138 
	s__gcÚv_šfo


140 
size_t
 
__n¡•s
;

141 
__gcÚv_¡•
 *
__¡•s
;

142 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
[0];

143 } *
	t__gcÚv_t
;

146 
	`__gcÚv_Œª¦™”©e
 (
__gcÚv_¡•
 *
¡•
,

147 
__gcÚv_¡•_d©a
 *
¡•_d©a
,

148 cÚ¡ *
šbuf¡¬t
,

149 cÚ¡ **
šbuå
,

150 cÚ¡ *
šbuãnd
,

151 **
outbuf¡¬t
,

152 
size_t
 *
œ»v”sibË
);

	@/usr/include/linux/falloc.h

2 #iâdeà
_FALLOC_H_


3 
	#_FALLOC_H_


	)

5 
	#FALLOC_FL_KEEP_SIZE
 0x01

	)

6 
	#FALLOC_FL_PUNCH_HOLE
 0x02

	)

7 
	#FALLOC_FL_NO_HIDE_STALE
 0x04

	)

29 
	#FALLOC_FL_COLLAPSE_RANGE
 0x08

	)

43 
	#FALLOC_FL_ZERO_RANGE
 0x10

	)

60 
	#FALLOC_FL_INSERT_RANGE
 0x20

	)

78 
	#FALLOC_FL_UNSHARE_RANGE
 0x40

	)

	@/usr/include/linux/posix_types.h

2 #iâdeà
_LINUX_POSIX_TYPES_H


3 
	#_LINUX_POSIX_TYPES_H


	)

5 
	~<lšux/¡ddef.h
>

22 #undeà
__FD_SETSIZE


23 
	#__FD_SETSIZE
 1024

	)

26 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

27 } 
	t__k”Ãl_fd_£t
;

30 (*
	t__k”Ãl_sighªdËr_t
)();

33 
	t__k”Ãl_key_t
;

34 
	t__k”Ãl_mqd_t
;

36 
	~<asm/posix_ty³s.h
>

	@/usr/include/linux/sysinfo.h

2 #iâdeà
_LINUX_SYSINFO_H


3 
	#_LINUX_SYSINFO_H


	)

5 
	~<lšux/ty³s.h
>

7 
	#SI_LOAD_SHIFT
 16

	)

8 
	ssysšfo
 {

9 
__k”Ãl_lÚg_t
 
	mu±ime
;

10 
__k”Ãl_ulÚg_t
 
	mlßds
[3];

11 
__k”Ãl_ulÚg_t
 
	mtÙ®¿m
;

12 
__k”Ãl_ulÚg_t
 
	mä“¿m
;

13 
__k”Ãl_ulÚg_t
 
	msh¬ed¿m
;

14 
__k”Ãl_ulÚg_t
 
	mbufã¼am
;

15 
__k”Ãl_ulÚg_t
 
	mtÙ®sw­
;

16 
__k”Ãl_ulÚg_t
 
	mä“sw­
;

17 
__u16
 
	m´ocs
;

18 
__u16
 
	m·d
;

19 
__k”Ãl_ulÚg_t
 
	mtÙ®high
;

20 
__k”Ãl_ulÚg_t
 
	mä“high
;

21 
__u32
 
	mmem_un™
;

22 
	m_f
[20-2*(
__k”Ãl_ulÚg_t
)-(
__u32
)];

	@/usr/include/asm-generic/errno.h

2 #iâdeà
_ASM_GENERIC_ERRNO_H


3 
	#_ASM_GENERIC_ERRNO_H


	)

5 
	~<asm-g’”ic/”ºo-ba£.h
>

7 
	#EDEADLK
 35

	)

8 
	#ENAMETOOLONG
 36

	)

9 
	#ENOLCK
 37

	)

18 
	#ENOSYS
 38

	)

20 
	#ENOTEMPTY
 39

	)

21 
	#ELOOP
 40

	)

22 
	#EWOULDBLOCK
 
EAGAIN


	)

23 
	#ENOMSG
 42

	)

24 
	#EIDRM
 43

	)

25 
	#ECHRNG
 44

	)

26 
	#EL2NSYNC
 45

	)

27 
	#EL3HLT
 46

	)

28 
	#EL3RST
 47

	)

29 
	#ELNRNG
 48

	)

30 
	#EUNATCH
 49

	)

31 
	#ENOCSI
 50

	)

32 
	#EL2HLT
 51

	)

33 
	#EBADE
 52

	)

34 
	#EBADR
 53

	)

35 
	#EXFULL
 54

	)

36 
	#ENOANO
 55

	)

37 
	#EBADRQC
 56

	)

38 
	#EBADSLT
 57

	)

40 
	#EDEADLOCK
 
EDEADLK


	)

42 
	#EBFONT
 59

	)

43 
	#ENOSTR
 60

	)

44 
	#ENODATA
 61

	)

45 
	#ETIME
 62

	)

46 
	#ENOSR
 63

	)

47 
	#ENONET
 64

	)

48 
	#ENOPKG
 65

	)

49 
	#EREMOTE
 66

	)

50 
	#ENOLINK
 67

	)

51 
	#EADV
 68

	)

52 
	#ESRMNT
 69

	)

53 
	#ECOMM
 70

	)

54 
	#EPROTO
 71

	)

55 
	#EMULTIHOP
 72

	)

56 
	#EDOTDOT
 73

	)

57 
	#EBADMSG
 74

	)

58 
	#EOVERFLOW
 75

	)

59 
	#ENOTUNIQ
 76

	)

60 
	#EBADFD
 77

	)

61 
	#EREMCHG
 78

	)

62 
	#ELIBACC
 79

	)

63 
	#ELIBBAD
 80

	)

64 
	#ELIBSCN
 81

	)

65 
	#ELIBMAX
 82

	)

66 
	#ELIBEXEC
 83

	)

67 
	#EILSEQ
 84

	)

68 
	#ERESTART
 85

	)

69 
	#ESTRPIPE
 86

	)

70 
	#EUSERS
 87

	)

71 
	#ENOTSOCK
 88

	)

72 
	#EDESTADDRREQ
 89

	)

73 
	#EMSGSIZE
 90

	)

74 
	#EPROTOTYPE
 91

	)

75 
	#ENOPROTOOPT
 92

	)

76 
	#EPROTONOSUPPORT
 93

	)

77 
	#ESOCKTNOSUPPORT
 94

	)

78 
	#EOPNOTSUPP
 95

	)

79 
	#EPFNOSUPPORT
 96

	)

80 
	#EAFNOSUPPORT
 97

	)

81 
	#EADDRINUSE
 98

	)

82 
	#EADDRNOTAVAIL
 99

	)

83 
	#ENETDOWN
 100

	)

84 
	#ENETUNREACH
 101

	)

85 
	#ENETRESET
 102

	)

86 
	#ECONNABORTED
 103

	)

87 
	#ECONNRESET
 104

	)

88 
	#ENOBUFS
 105

	)

89 
	#EISCONN
 106

	)

90 
	#ENOTCONN
 107

	)

91 
	#ESHUTDOWN
 108

	)

92 
	#ETOOMANYREFS
 109

	)

93 
	#ETIMEDOUT
 110

	)

94 
	#ECONNREFUSED
 111

	)

95 
	#EHOSTDOWN
 112

	)

96 
	#EHOSTUNREACH
 113

	)

97 
	#EALREADY
 114

	)

98 
	#EINPROGRESS
 115

	)

99 
	#ESTALE
 116

	)

100 
	#EUCLEAN
 117

	)

101 
	#ENOTNAM
 118

	)

102 
	#ENAVAIL
 119

	)

103 
	#EISNAM
 120

	)

104 
	#EREMOTEIO
 121

	)

105 
	#EDQUOT
 122

	)

107 
	#ENOMEDIUM
 123

	)

108 
	#EMEDIUMTYPE
 124

	)

109 
	#ECANCELED
 125

	)

110 
	#ENOKEY
 126

	)

111 
	#EKEYEXPIRED
 127

	)

112 
	#EKEYREVOKED
 128

	)

113 
	#EKEYREJECTED
 129

	)

116 
	#EOWNERDEAD
 130

	)

117 
	#ENOTRECOVERABLE
 131

	)

119 
	#ERFKILL
 132

	)

121 
	#EHWPOISON
 133

	)

	@/usr/include/asm-generic/param.h

2 #iâdeà
__ASM_GENERIC_PARAM_H


3 
	#__ASM_GENERIC_PARAM_H


	)

5 #iâdeà
HZ


6 
	#HZ
 100

	)

9 #iâdeà
EXEC_PAGESIZE


10 
	#EXEC_PAGESIZE
 4096

	)

13 #iâdeà
NOGROUP


14 
	#NOGROUP
 (-1)

	)

17 
	#MAXHOSTNAMELEN
 64

	)

	@/usr/include/asm-generic/types.h

2 #iâdeà
_ASM_GENERIC_TYPES_H


3 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-g’”ic/št-Î64.h
>

	@/usr/include/asm/posix_types.h

2 #ifdeà
__i386__


3 
	~<asm/posix_ty³s_32.h
>

4 #–ià
defšed
(
__ILP32__
)

5 
	~<asm/posix_ty³s_x32.h
>

7 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/asm/sockios.h

1 
	~<asm-g’”ic/sockios.h
>

	@/usr/include/linux/ioctl.h

2 #iâdeà
_LINUX_IOCTL_H


3 
	#_LINUX_IOCTL_H


	)

5 
	~<asm/ioùl.h
>

	@/usr/include/linux/stddef.h

4 #iâdeà
__®ways_šlše


5 
	#__®ways_šlše
 
__šlše__


	)

	@/usr/include/asm-generic/errno-base.h

2 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


3 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

5 
	#EPERM
 1

	)

6 
	#ENOENT
 2

	)

7 
	#ESRCH
 3

	)

8 
	#EINTR
 4

	)

9 
	#EIO
 5

	)

10 
	#ENXIO
 6

	)

11 
	#E2BIG
 7

	)

12 
	#ENOEXEC
 8

	)

13 
	#EBADF
 9

	)

14 
	#ECHILD
 10

	)

15 
	#EAGAIN
 11

	)

16 
	#ENOMEM
 12

	)

17 
	#EACCES
 13

	)

18 
	#EFAULT
 14

	)

19 
	#ENOTBLK
 15

	)

20 
	#EBUSY
 16

	)

21 
	#EEXIST
 17

	)

22 
	#EXDEV
 18

	)

23 
	#ENODEV
 19

	)

24 
	#ENOTDIR
 20

	)

25 
	#EISDIR
 21

	)

26 
	#EINVAL
 22

	)

27 
	#ENFILE
 23

	)

28 
	#EMFILE
 24

	)

29 
	#ENOTTY
 25

	)

30 
	#ETXTBSY
 26

	)

31 
	#EFBIG
 27

	)

32 
	#ENOSPC
 28

	)

33 
	#ESPIPE
 29

	)

34 
	#EROFS
 30

	)

35 
	#EMLINK
 31

	)

36 
	#EPIPE
 32

	)

37 
	#EDOM
 33

	)

38 
	#ERANGE
 34

	)

	@/usr/include/asm-generic/int-ll64.h

9 #iâdeà
_ASM_GENERIC_INT_LL64_H


10 
	#_ASM_GENERIC_INT_LL64_H


	)

12 
	~<asm/b™¥”lÚg.h
>

14 #iâdeà
__ASSEMBLY__


20 
__sigÃd__
 
	t__s8
;

21 
	t__u8
;

23 
__sigÃd__
 
	t__s16
;

24 
	t__u16
;

26 
__sigÃd__
 
	t__s32
;

27 
	t__u32
;

29 #ifdeà
__GNUC__


30 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

31 
__ex‹nsiÚ__
 
	t__u64
;

33 
__sigÃd__
 
	t__s64
;

34 
	t__u64
;

	@/usr/include/asm-generic/sockios.h

2 #iâdeà
__ASM_GENERIC_SOCKIOS_H


3 
	#__ASM_GENERIC_SOCKIOS_H


	)

6 
	#FIOSETOWN
 0x8901

	)

7 
	#SIOCSPGRP
 0x8902

	)

8 
	#FIOGETOWN
 0x8903

	)

9 
	#SIOCGPGRP
 0x8904

	)

10 
	#SIOCATMARK
 0x8905

	)

11 
	#SIOCGSTAMP
 0x8906

	)

12 
	#SIOCGSTAMPNS
 0x8907

	)

	@/usr/include/asm/ioctl.h

1 
	~<asm-g’”ic/ioùl.h
>

	@/usr/include/asm/posix_types_32.h

2 #iâdeà
_ASM_X86_POSIX_TYPES_32_H


3 
	#_ASM_X86_POSIX_TYPES_32_H


	)

11 
	t__k”Ãl_mode_t
;

12 
	#__k”Ãl_mode_t
 
__k”Ãl_mode_t


	)

14 
	t__k”Ãl_c_pid_t
;

15 
	#__k”Ãl_c_pid_t
 
__k”Ãl_c_pid_t


	)

17 
	t__k”Ãl_uid_t
;

18 
	t__k”Ãl_gid_t
;

19 
	#__k”Ãl_uid_t
 
__k”Ãl_uid_t


	)

21 
	t__k”Ãl_Şd_dev_t
;

22 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

24 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_64.h

2 #iâdeà
_ASM_X86_POSIX_TYPES_64_H


3 
	#_ASM_X86_POSIX_TYPES_64_H


	)

11 
	t__k”Ãl_Şd_uid_t
;

12 
	t__k”Ãl_Şd_gid_t
;

13 
	#__k”Ãl_Şd_uid_t
 
__k”Ãl_Şd_uid_t


	)

15 
	t__k”Ãl_Şd_dev_t
;

16 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

18 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_x32.h

2 #iâdeà
_ASM_X86_POSIX_TYPES_X32_H


3 
	#_ASM_X86_POSIX_TYPES_X32_H


	)

14 
	t__k”Ãl_lÚg_t
;

15 
	t__k”Ãl_ulÚg_t
;

16 
	#__k”Ãl_lÚg_t
 
__k”Ãl_lÚg_t


	)

18 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/asm-generic/ioctl.h

2 #iâdeà
_ASM_GENERIC_IOCTL_H


3 
	#_ASM_GENERIC_IOCTL_H


	)

23 
	#_IOC_NRBITS
 8

	)

24 
	#_IOC_TYPEBITS
 8

	)

31 #iâdeà
_IOC_SIZEBITS


32 
	#_IOC_SIZEBITS
 14

	)

35 #iâdeà
_IOC_DIRBITS


36 
	#_IOC_DIRBITS
 2

	)

39 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

40 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

41 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

42 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

44 
	#_IOC_NRSHIFT
 0

	)

45 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

46 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

47 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

57 #iâdeà
_IOC_NONE


58 
	#_IOC_NONE
 0U

	)

61 #iâdeà
_IOC_WRITE


62 
	#_IOC_WRITE
 1U

	)

65 #iâdeà
_IOC_READ


66 
	#_IOC_READ
 2U

	)

69 
	#_IOC
(
dœ
,
ty³
,
Ä
,
size
) \

70 (((
dœ
è<< 
_IOC_DIRSHIFT
) | \

71 ((
ty³
è<< 
_IOC_TYPESHIFT
) | \

72 ((
Ä
è<< 
_IOC_NRSHIFT
) | \

73 ((
size
è<< 
_IOC_SIZESHIFT
))

	)

75 
	#_IOC_TYPECHECK
(
t
è(Ñ))

	)

83 
	#_IO
(
ty³
,
Ä
è
	`_IOC
(
_IOC_NONE
,Ñy³),Òr),0)

	)

84 
	#_IOR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

85 
	#_IOW
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

86 
	#_IOWR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

87 
	#_IOR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(size))

	)

88 
	#_IOW_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(size))

	)

89 
	#_IOWR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(size))

	)

92 
	#_IOC_DIR
(
Ä
è((Òrè>> 
_IOC_DIRSHIFT
è& 
_IOC_DIRMASK
)

	)

93 
	#_IOC_TYPE
(
Ä
è((Òrè>> 
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
)

	)

94 
	#_IOC_NR
(
Ä
è((Òrè>> 
_IOC_NRSHIFT
è& 
_IOC_NRMASK
)

	)

95 
	#_IOC_SIZE
(
Ä
è((Òrè>> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
)

	)

99 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

100 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

101 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
è<< 
_IOC_DIRSHIFT
)

	)

102 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

103 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm-generic/posix_types.h

2 #iâdeà
__ASM_GENERIC_POSIX_TYPES_H


3 
	#__ASM_GENERIC_POSIX_TYPES_H


	)

5 
	~<asm/b™¥”lÚg.h
>

14 #iâdeà
__k”Ãl_lÚg_t


15 
	t__k”Ãl_lÚg_t
;

16 
	t__k”Ãl_ulÚg_t
;

19 #iâdeà
__k”Ãl_šo_t


20 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_šo_t
;

23 #iâdeà
__k”Ãl_mode_t


24 
	t__k”Ãl_mode_t
;

27 #iâdeà
__k”Ãl_pid_t


28 
	t__k”Ãl_pid_t
;

31 #iâdeà
__k”Ãl_c_pid_t


32 
	t__k”Ãl_c_pid_t
;

35 #iâdeà
__k”Ãl_uid_t


36 
	t__k”Ãl_uid_t
;

37 
	t__k”Ãl_gid_t
;

40 #iâdeà
__k”Ãl_su£cÚds_t


41 
__k”Ãl_lÚg_t
 
	t__k”Ãl_su£cÚds_t
;

44 #iâdeà
__k”Ãl_daddr_t


45 
	t__k”Ãl_daddr_t
;

48 #iâdeà
__k”Ãl_uid32_t


49 
	t__k”Ãl_uid32_t
;

50 
	t__k”Ãl_gid32_t
;

53 #iâdeà
__k”Ãl_Şd_uid_t


54 
__k”Ãl_uid_t
 
	t__k”Ãl_Şd_uid_t
;

55 
__k”Ãl_gid_t
 
	t__k”Ãl_Şd_gid_t
;

58 #iâdeà
__k”Ãl_Şd_dev_t


59 
	t__k”Ãl_Şd_dev_t
;

66 #iâdeà
__k”Ãl_size_t


67 #ià
__BITS_PER_LONG
 != 64

68 
	t__k”Ãl_size_t
;

69 
	t__k”Ãl_ssize_t
;

70 
	t__k”Ãl_±rdiff_t
;

72 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_size_t
;

73 
__k”Ãl_lÚg_t
 
	t__k”Ãl_ssize_t
;

74 
__k”Ãl_lÚg_t
 
	t__k”Ãl_±rdiff_t
;

78 #iâdeà
__k”Ãl_fsid_t


80 
	mv®
[2];

81 } 
	t__k”Ãl_fsid_t
;

87 
__k”Ãl_lÚg_t
 
	t__k”Ãl_off_t
;

88 
	t__k”Ãl_loff_t
;

89 
__k”Ãl_lÚg_t
 
	t__k”Ãl_time_t
;

90 
__k”Ãl_lÚg_t
 
	t__k”Ãl_şock_t
;

91 
	t__k”Ãl_tim”_t
;

92 
	t__k”Ãl_şockid_t
;

93 * 
	t__k”Ãl_ÿddr_t
;

94 
	t__k”Ãl_uid16_t
;

95 
	t__k”Ãl_gid16_t
;

	@/usr/include/asm/bitsperlong.h

2 #iâdeà
__ASM_X86_BITSPERLONG_H


3 
	#__ASM_X86_BITSPERLONG_H


	)

5 #ià
defšed
(
__x86_64__
è&& !defšed(
__ILP32__
)

6 
	#__BITS_PER_LONG
 64

	)

8 
	#__BITS_PER_LONG
 32

	)

11 
	~<asm-g’”ic/b™¥”lÚg.h
>

	@/usr/include/asm-generic/bitsperlong.h

2 #iâdeà
__ASM_GENERIC_BITS_PER_LONG


3 
	#__ASM_GENERIC_BITS_PER_LONG


	)

12 #iâdeà
__BITS_PER_LONG


13 
	#__BITS_PER_LONG
 32

	)

	@
1
.
1
/usr/include
637
18449
deps/geohash-int/geohash.c
deps/geohash-int/geohash.h
deps/geohash-int/geohash_helper.c
deps/geohash-int/geohash_helper.h
deps/hiredis/adapters/ae.h
deps/hiredis/adapters/libev.h
deps/hiredis/adapters/libevent.h
deps/hiredis/adapters/libuv.h
deps/hiredis/async.c
deps/hiredis/async.h
deps/hiredis/dict.c
deps/hiredis/dict.h
deps/hiredis/examples/example-ae.c
deps/hiredis/examples/example-libev.c
deps/hiredis/examples/example-libevent.c
deps/hiredis/examples/example-libuv.c
deps/hiredis/examples/example.c
deps/hiredis/fmacros.h
deps/hiredis/hiredis.c
deps/hiredis/hiredis.h
deps/hiredis/net.c
deps/hiredis/net.h
deps/hiredis/sds.c
deps/hiredis/sds.h
deps/hiredis/sdsalloc.h
deps/hiredis/test.c
deps/hiredis/zmalloc.h
deps/jemalloc/include/jemalloc/internal/arena.h
deps/jemalloc/include/jemalloc/internal/assert.h
deps/jemalloc/include/jemalloc/internal/atomic.h
deps/jemalloc/include/jemalloc/internal/base.h
deps/jemalloc/include/jemalloc/internal/bitmap.h
deps/jemalloc/include/jemalloc/internal/chunk.h
deps/jemalloc/include/jemalloc/internal/chunk_dss.h
deps/jemalloc/include/jemalloc/internal/chunk_mmap.h
deps/jemalloc/include/jemalloc/internal/ckh.h
deps/jemalloc/include/jemalloc/internal/ctl.h
deps/jemalloc/include/jemalloc/internal/extent.h
deps/jemalloc/include/jemalloc/internal/hash.h
deps/jemalloc/include/jemalloc/internal/huge.h
deps/jemalloc/include/jemalloc/internal/jemalloc_internal.h
deps/jemalloc/include/jemalloc/internal/jemalloc_internal_decls.h
deps/jemalloc/include/jemalloc/internal/jemalloc_internal_defs.h
deps/jemalloc/include/jemalloc/internal/jemalloc_internal_macros.h
deps/jemalloc/include/jemalloc/internal/mb.h
deps/jemalloc/include/jemalloc/internal/mutex.h
deps/jemalloc/include/jemalloc/internal/nstime.h
deps/jemalloc/include/jemalloc/internal/pages.h
deps/jemalloc/include/jemalloc/internal/ph.h
deps/jemalloc/include/jemalloc/internal/private_namespace.h
deps/jemalloc/include/jemalloc/internal/private_unnamespace.h
deps/jemalloc/include/jemalloc/internal/prng.h
deps/jemalloc/include/jemalloc/internal/prof.h
deps/jemalloc/include/jemalloc/internal/public_namespace.h
deps/jemalloc/include/jemalloc/internal/public_unnamespace.h
deps/jemalloc/include/jemalloc/internal/ql.h
deps/jemalloc/include/jemalloc/internal/qr.h
deps/jemalloc/include/jemalloc/internal/quarantine.h
deps/jemalloc/include/jemalloc/internal/rb.h
deps/jemalloc/include/jemalloc/internal/rtree.h
deps/jemalloc/include/jemalloc/internal/size_classes.h
deps/jemalloc/include/jemalloc/internal/smoothstep.h
deps/jemalloc/include/jemalloc/internal/spin.h
deps/jemalloc/include/jemalloc/internal/stats.h
deps/jemalloc/include/jemalloc/internal/tcache.h
deps/jemalloc/include/jemalloc/internal/ticker.h
deps/jemalloc/include/jemalloc/internal/tsd.h
deps/jemalloc/include/jemalloc/internal/util.h
deps/jemalloc/include/jemalloc/internal/valgrind.h
deps/jemalloc/include/jemalloc/internal/witness.h
deps/jemalloc/include/jemalloc/jemalloc.h
deps/jemalloc/include/jemalloc/jemalloc_defs.h
deps/jemalloc/include/jemalloc/jemalloc_macros.h
deps/jemalloc/include/jemalloc/jemalloc_mangle.h
deps/jemalloc/include/jemalloc/jemalloc_mangle_jet.h
deps/jemalloc/include/jemalloc/jemalloc_protos.h
deps/jemalloc/include/jemalloc/jemalloc_protos_jet.h
deps/jemalloc/include/jemalloc/jemalloc_rename.h
deps/jemalloc/include/jemalloc/jemalloc_typedefs.h
deps/jemalloc/include/msvc_compat/C99/stdbool.h
deps/jemalloc/include/msvc_compat/C99/stdint.h
deps/jemalloc/include/msvc_compat/strings.h
deps/jemalloc/include/msvc_compat/windows_extra.h
deps/jemalloc/msvc/projects/vc2015/test_threads/test_threads.cpp
deps/jemalloc/msvc/projects/vc2015/test_threads/test_threads.h
deps/jemalloc/msvc/projects/vc2015/test_threads/test_threads_main.cpp
deps/jemalloc/src/arena.c
deps/jemalloc/src/atomic.c
deps/jemalloc/src/base.c
deps/jemalloc/src/bitmap.c
deps/jemalloc/src/chunk.c
deps/jemalloc/src/chunk_dss.c
deps/jemalloc/src/chunk_mmap.c
deps/jemalloc/src/ckh.c
deps/jemalloc/src/ctl.c
deps/jemalloc/src/extent.c
deps/jemalloc/src/hash.c
deps/jemalloc/src/huge.c
deps/jemalloc/src/jemalloc.c
deps/jemalloc/src/mb.c
deps/jemalloc/src/mutex.c
deps/jemalloc/src/nstime.c
deps/jemalloc/src/pages.c
deps/jemalloc/src/prng.c
deps/jemalloc/src/prof.c
deps/jemalloc/src/quarantine.c
deps/jemalloc/src/rtree.c
deps/jemalloc/src/spin.c
deps/jemalloc/src/stats.c
deps/jemalloc/src/tcache.c
deps/jemalloc/src/ticker.c
deps/jemalloc/src/tsd.c
deps/jemalloc/src/util.c
deps/jemalloc/src/valgrind.c
deps/jemalloc/src/witness.c
deps/jemalloc/src/zone.c
deps/jemalloc/test/include/test/SFMT-alti.h
deps/jemalloc/test/include/test/SFMT-params.h
deps/jemalloc/test/include/test/SFMT-params11213.h
deps/jemalloc/test/include/test/SFMT-params1279.h
deps/jemalloc/test/include/test/SFMT-params132049.h
deps/jemalloc/test/include/test/SFMT-params19937.h
deps/jemalloc/test/include/test/SFMT-params216091.h
deps/jemalloc/test/include/test/SFMT-params2281.h
deps/jemalloc/test/include/test/SFMT-params4253.h
deps/jemalloc/test/include/test/SFMT-params44497.h
deps/jemalloc/test/include/test/SFMT-params607.h
deps/jemalloc/test/include/test/SFMT-params86243.h
deps/jemalloc/test/include/test/SFMT-sse2.h
deps/jemalloc/test/include/test/SFMT.h
deps/jemalloc/test/include/test/btalloc.h
deps/jemalloc/test/include/test/jemalloc_test.h
deps/jemalloc/test/include/test/jemalloc_test_defs.h
deps/jemalloc/test/include/test/math.h
deps/jemalloc/test/include/test/mq.h
deps/jemalloc/test/include/test/mtx.h
deps/jemalloc/test/include/test/test.h
deps/jemalloc/test/include/test/thd.h
deps/jemalloc/test/include/test/timer.h
deps/jemalloc/test/integration/MALLOCX_ARENA.c
deps/jemalloc/test/integration/aligned_alloc.c
deps/jemalloc/test/integration/allocated.c
deps/jemalloc/test/integration/chunk.c
deps/jemalloc/test/integration/mallocx.c
deps/jemalloc/test/integration/overflow.c
deps/jemalloc/test/integration/posix_memalign.c
deps/jemalloc/test/integration/rallocx.c
deps/jemalloc/test/integration/sdallocx.c
deps/jemalloc/test/integration/thread_arena.c
deps/jemalloc/test/integration/thread_tcache_enabled.c
deps/jemalloc/test/integration/xallocx.c
deps/jemalloc/test/src/SFMT.c
deps/jemalloc/test/src/btalloc.c
deps/jemalloc/test/src/btalloc_0.c
deps/jemalloc/test/src/btalloc_1.c
deps/jemalloc/test/src/math.c
deps/jemalloc/test/src/mq.c
deps/jemalloc/test/src/mtx.c
deps/jemalloc/test/src/test.c
deps/jemalloc/test/src/thd.c
deps/jemalloc/test/src/timer.c
deps/jemalloc/test/stress/microbench.c
deps/jemalloc/test/unit/SFMT.c
deps/jemalloc/test/unit/a0.c
deps/jemalloc/test/unit/arena_reset.c
deps/jemalloc/test/unit/atomic.c
deps/jemalloc/test/unit/bitmap.c
deps/jemalloc/test/unit/ckh.c
deps/jemalloc/test/unit/decay.c
deps/jemalloc/test/unit/fork.c
deps/jemalloc/test/unit/hash.c
deps/jemalloc/test/unit/junk.c
deps/jemalloc/test/unit/junk_alloc.c
deps/jemalloc/test/unit/junk_free.c
deps/jemalloc/test/unit/lg_chunk.c
deps/jemalloc/test/unit/mallctl.c
deps/jemalloc/test/unit/math.c
deps/jemalloc/test/unit/mq.c
deps/jemalloc/test/unit/mtx.c
deps/jemalloc/test/unit/nstime.c
deps/jemalloc/test/unit/pack.c
deps/jemalloc/test/unit/pages.c
deps/jemalloc/test/unit/ph.c
deps/jemalloc/test/unit/prng.c
deps/jemalloc/test/unit/prof_accum.c
deps/jemalloc/test/unit/prof_active.c
deps/jemalloc/test/unit/prof_gdump.c
deps/jemalloc/test/unit/prof_idump.c
deps/jemalloc/test/unit/prof_reset.c
deps/jemalloc/test/unit/prof_thread_name.c
deps/jemalloc/test/unit/ql.c
deps/jemalloc/test/unit/qr.c
deps/jemalloc/test/unit/quarantine.c
deps/jemalloc/test/unit/rb.c
deps/jemalloc/test/unit/rtree.c
deps/jemalloc/test/unit/run_quantize.c
deps/jemalloc/test/unit/size_classes.c
deps/jemalloc/test/unit/smoothstep.c
deps/jemalloc/test/unit/stats.c
deps/jemalloc/test/unit/ticker.c
deps/jemalloc/test/unit/tsd.c
deps/jemalloc/test/unit/util.c
deps/jemalloc/test/unit/witness.c
deps/jemalloc/test/unit/zero.c
deps/linenoise/example.c
deps/linenoise/linenoise.c
deps/linenoise/linenoise.h
deps/lua/etc/all.c
deps/lua/etc/lua.hpp
deps/lua/etc/min.c
deps/lua/etc/noparser.c
deps/lua/src/fpconv.c
deps/lua/src/fpconv.h
deps/lua/src/lapi.c
deps/lua/src/lapi.h
deps/lua/src/lauxlib.c
deps/lua/src/lauxlib.h
deps/lua/src/lbaselib.c
deps/lua/src/lcode.c
deps/lua/src/lcode.h
deps/lua/src/ldblib.c
deps/lua/src/ldebug.c
deps/lua/src/ldebug.h
deps/lua/src/ldo.c
deps/lua/src/ldo.h
deps/lua/src/ldump.c
deps/lua/src/lfunc.c
deps/lua/src/lfunc.h
deps/lua/src/lgc.c
deps/lua/src/lgc.h
deps/lua/src/linit.c
deps/lua/src/liolib.c
deps/lua/src/llex.c
deps/lua/src/llex.h
deps/lua/src/llimits.h
deps/lua/src/lmathlib.c
deps/lua/src/lmem.c
deps/lua/src/lmem.h
deps/lua/src/loadlib.c
deps/lua/src/lobject.c
deps/lua/src/lobject.h
deps/lua/src/lopcodes.c
deps/lua/src/lopcodes.h
deps/lua/src/loslib.c
deps/lua/src/lparser.c
deps/lua/src/lparser.h
deps/lua/src/lstate.c
deps/lua/src/lstate.h
deps/lua/src/lstring.c
deps/lua/src/lstring.h
deps/lua/src/lstrlib.c
deps/lua/src/ltable.c
deps/lua/src/ltable.h
deps/lua/src/ltablib.c
deps/lua/src/ltm.c
deps/lua/src/ltm.h
deps/lua/src/lua.c
deps/lua/src/lua.h
deps/lua/src/lua_bit.c
deps/lua/src/lua_cjson.c
deps/lua/src/lua_cmsgpack.c
deps/lua/src/lua_struct.c
deps/lua/src/luac.c
deps/lua/src/luaconf.h
deps/lua/src/lualib.h
deps/lua/src/lundump.c
deps/lua/src/lundump.h
deps/lua/src/lvm.c
deps/lua/src/lvm.h
deps/lua/src/lzio.c
deps/lua/src/lzio.h
deps/lua/src/print.c
deps/lua/src/strbuf.c
deps/lua/src/strbuf.h
src/adlist.c
src/adlist.h
src/ae.c
src/ae.h
src/ae_epoll.c
src/ae_evport.c
src/ae_kqueue.c
src/ae_select.c
src/anet.c
src/anet.h
src/aof.c
src/asciilogo.h
src/bio.c
src/bio.h
src/bitops.c
src/blocked.c
src/cluster.c
src/cluster.h
src/config.c
src/config.h
src/crc16.c
src/crc64.c
src/crc64.h
src/db.c
src/debug.c
src/debugmacro.h
src/dict.c
src/dict.h
src/endianconv.c
src/endianconv.h
src/fmacros.h
src/geo.c
src/geo.h
src/help.h
src/hyperloglog.c
src/intset.c
src/intset.h
src/latency.c
src/latency.h
src/lzf.h
src/lzfP.h
src/lzf_c.c
src/lzf_d.c
src/memtest.c
src/multi.c
src/networking.c
src/notify.c
src/object.c
src/pmem.c
src/pmem.h
src/pqsort.c
src/pqsort.h
src/pubsub.c
src/quicklist.c
src/quicklist.h
src/rand.c
src/rand.h
src/rdb.c
src/rdb.h
src/redis-benchmark.c
src/redis-check-aof.c
src/redis-check-rdb.c
src/redis-cli.c
src/redisassert.h
src/release.c
src/release.h
src/replication.c
src/rio.c
src/rio.h
src/scripting.c
src/sds.c
src/sds.h
src/sdsalloc.h
src/sentinel.c
src/server.c
src/server.h
src/setproctitle.c
src/sha1.c
src/sha1.h
src/slowlog.c
src/slowlog.h
src/solarisfixes.h
src/sort.c
src/sparkline.c
src/sparkline.h
src/syncio.c
src/t_hash.c
src/t_list.c
src/t_set.c
src/t_string.c
src/t_zset.c
src/testhelp.h
src/util.c
src/util.h
src/version.h
src/ziplist.c
src/ziplist.h
src/zipmap.c
src/zipmap.h
src/zmalloc.c
src/zmalloc.h
utils/corrupt_rdb.c
utils/hashtable/rehashing.c
/usr/include/alloca.h
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/dlfcn.h
/usr/include/endian.h
/usr/include/errno.h
/usr/include/event.h
/usr/include/execinfo.h
/usr/include/fcntl.h
/usr/include/features.h
/usr/include/inttypes.h
/usr/include/limits.h
/usr/include/linux/version.h
/usr/include/locale.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/netinet/tcp.h
/usr/include/poll.h
/usr/include/pthread.h
/usr/include/sched.h
/usr/include/setjmp.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/stropts.h
/usr/include/sys/epoll.h
/usr/include/sys/file.h
/usr/include/sys/ioctl.h
/usr/include/sys/mman.h
/usr/include/sys/param.h
/usr/include/sys/queue.h
/usr/include/sys/resource.h
/usr/include/sys/select.h
/usr/include/sys/socket.h
/usr/include/sys/stat.h
/usr/include/sys/syscall.h
/usr/include/sys/sysctl.h
/usr/include/sys/time.h
/usr/include/sys/types.h
/usr/include/sys/uio.h
/usr/include/sys/un.h
/usr/include/sys/utsname.h
/usr/include/sys/wait.h
/usr/include/syslog.h
/usr/include/termios.h
/usr/include/time.h
/usr/include/ucontext.h
/usr/include/unistd.h
/usr/include/valgrind/memcheck.h
/usr/include/valgrind/valgrind.h
/usr/include/wchar.h
/usr/include/asm/unistd.h
/usr/include/bits/byteswap.h
/usr/include/bits/confname.h
/usr/include/bits/cpu-set.h
/usr/include/bits/dlfcn.h
/usr/include/bits/endian.h
/usr/include/bits/environments.h
/usr/include/bits/epoll.h
/usr/include/bits/errno.h
/usr/include/bits/fcntl.h
/usr/include/bits/fcntl2.h
/usr/include/bits/floatn.h
/usr/include/bits/flt-eval-method.h
/usr/include/bits/fp-fast.h
/usr/include/bits/fp-logb.h
/usr/include/bits/getopt_posix.h
/usr/include/bits/in.h
/usr/include/bits/ioctl-types.h
/usr/include/bits/ioctls.h
/usr/include/bits/iscanonical.h
/usr/include/bits/libc-header-start.h
/usr/include/bits/libio.h
/usr/include/bits/locale.h
/usr/include/bits/math-finite.h
/usr/include/bits/math-vector.h
/usr/include/bits/mathcalls-helper-functions.h
/usr/include/bits/mathcalls.h
/usr/include/bits/mathinline.h
/usr/include/bits/mman.h
/usr/include/bits/netdb.h
/usr/include/bits/param.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix2_lim.h
/usr/include/bits/posix_opt.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/resource.h
/usr/include/bits/sched.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/setjmp.h
/usr/include/bits/setjmp2.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/sigevent-consts.h
/usr/include/bits/siginfo-consts.h
/usr/include/bits/signum.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/bits/sockaddr.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/ss_flags.h
/usr/include/bits/stat.h
/usr/include/bits/stdint-intn.h
/usr/include/bits/stdint-uintn.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/stdlib-bsearch.h
/usr/include/bits/stdlib-float.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/string_fortified.h
/usr/include/bits/strings_fortified.h
/usr/include/bits/stropts.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/syscall.h
/usr/include/bits/sysctl.h
/usr/include/bits/termios.h
/usr/include/bits/time.h
/usr/include/bits/types.h
/usr/include/bits/types/FILE.h
/usr/include/bits/types/__FILE.h
/usr/include/bits/types/__sigset_t.h
/usr/include/bits/types/clock_t.h
/usr/include/bits/types/clockid_t.h
/usr/include/bits/types/locale_t.h
/usr/include/bits/types/mbstate_t.h
/usr/include/bits/types/sig_atomic_t.h
/usr/include/bits/types/sigevent_t.h
/usr/include/bits/types/siginfo_t.h
/usr/include/bits/types/sigset_t.h
/usr/include/bits/types/sigval_t.h
/usr/include/bits/types/stack_t.h
/usr/include/bits/types/struct_iovec.h
/usr/include/bits/types/struct_itimerspec.h
/usr/include/bits/types/struct_osockaddr.h
/usr/include/bits/types/struct_rusage.h
/usr/include/bits/types/struct_sigstack.h
/usr/include/bits/types/struct_timespec.h
/usr/include/bits/types/struct_timeval.h
/usr/include/bits/types/struct_tm.h
/usr/include/bits/types/time_t.h
/usr/include/bits/types/timer_t.h
/usr/include/bits/types/wint_t.h
/usr/include/bits/uintn-identity.h
/usr/include/bits/uio-ext.h
/usr/include/bits/uio_lim.h
/usr/include/bits/unistd.h
/usr/include/bits/utsname.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/bits/wchar-ldbl.h
/usr/include/bits/wchar.h
/usr/include/bits/wchar2.h
/usr/include/bits/wctype-wchar.h
/usr/include/bits/wordsize.h
/usr/include/bits/xopen_lim.h
/usr/include/bits/xtitypes.h
/usr/include/event2/buffer.h
/usr/include/event2/buffer_compat.h
/usr/include/event2/bufferevent.h
/usr/include/event2/bufferevent_compat.h
/usr/include/event2/bufferevent_struct.h
/usr/include/event2/event-config.h
/usr/include/event2/event.h
/usr/include/event2/event_compat.h
/usr/include/event2/event_struct.h
/usr/include/event2/tag.h
/usr/include/event2/tag_compat.h
/usr/include/evutil.h
/usr/include/gnu/stubs.h
/usr/include/linux/sysctl.h
/usr/include/rpc/netdb.h
/usr/include/stdc-predef.h
/usr/include/sys/cdefs.h
/usr/include/sys/poll.h
/usr/include/sys/syslog.h
/usr/include/sys/sysmacros.h
/usr/include/sys/ttydefaults.h
/usr/include/sys/ucontext.h
/usr/include/asm/ioctls.h
/usr/include/asm/socket.h
/usr/include/asm/unistd_32.h
/usr/include/asm/unistd_64.h
/usr/include/asm/unistd_x32.h
/usr/include/bits/_G_config.h
/usr/include/bits/byteswap-16.h
/usr/include/bits/fcntl-linux.h
/usr/include/bits/floatn-common.h
/usr/include/bits/getopt_core.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/libm-simd-decl-stubs.h
/usr/include/bits/local_lim.h
/usr/include/bits/long-double.h
/usr/include/bits/mman-linux.h
/usr/include/bits/poll.h
/usr/include/bits/poll2.h
/usr/include/bits/siginfo-arch.h
/usr/include/bits/siginfo-consts-arch.h
/usr/include/bits/signum-generic.h
/usr/include/bits/socket_type.h
/usr/include/bits/syslog-ldbl.h
/usr/include/bits/syslog-path.h
/usr/include/bits/syslog.h
/usr/include/bits/sysmacros.h
/usr/include/bits/thread-shared-types.h
/usr/include/bits/timex.h
/usr/include/bits/types/__locale_t.h
/usr/include/bits/types/__mbstate_t.h
/usr/include/bits/types/__sigval_t.h
/usr/include/bits/typesizes.h
/usr/include/event2/keyvalq_struct.h
/usr/include/event2/util.h
/usr/include/event2/visibility.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/gnu/stubs-x32.h
/usr/include/linux/errno.h
/usr/include/linux/kernel.h
/usr/include/linux/limits.h
/usr/include/linux/param.h
/usr/include/linux/types.h
/usr/include/asm-generic/ioctls.h
/usr/include/asm-generic/socket.h
/usr/include/asm/errno.h
/usr/include/asm/param.h
/usr/include/asm/types.h
/usr/include/bits/mman-shared.h
/usr/include/bits/pthreadtypes-arch.h
/usr/include/gconv.h
/usr/include/linux/falloc.h
/usr/include/linux/posix_types.h
/usr/include/linux/sysinfo.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/param.h
/usr/include/asm-generic/types.h
/usr/include/asm/posix_types.h
/usr/include/asm/sockios.h
/usr/include/linux/ioctl.h
/usr/include/linux/stddef.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm-generic/sockios.h
/usr/include/asm/ioctl.h
/usr/include/asm/posix_types_32.h
/usr/include/asm/posix_types_64.h
/usr/include/asm/posix_types_x32.h
/usr/include/asm-generic/ioctl.h
/usr/include/asm-generic/posix_types.h
/usr/include/asm/bitsperlong.h
/usr/include/asm-generic/bitsperlong.h
